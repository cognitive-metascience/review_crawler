<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">26410</article-id><article-id pub-id-type="doi">10.7554/eLife.26410</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Dynamic structure of locomotor behavior in walking fruit flies</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-11190"><name><surname>Katsov</surname><given-names>Alexander Y</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2155-3790</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="fn" rid="pa2">‡</xref></contrib><contrib contrib-type="author" id="author-11484"><name><surname>Freifeld</surname><given-names>Limor</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa3">§</xref></contrib><contrib contrib-type="author" id="author-82889"><name><surname>Horowitz</surname><given-names>Mark</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-27277"><name><surname>Kuehn</surname><given-names>Seppe</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4130-6845</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-4720"><name><surname>Clandinin</surname><given-names>Thomas R</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6277-6849</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-4"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Neurobiology</institution>, <institution>Stanford University</institution>, <addr-line><named-content content-type="city">Stanford</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Electrical Engineering</institution>, <institution>Stanford University</institution>, <addr-line><named-content content-type="city">Stanford</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Research Laboratory of Electronics</institution>, <institution>MIT Electrical Engineering and Computer Science Department</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Center for the Physics of Living Cells</institution>, <institution>University of Illinois at Urbana-Champaign</institution>, <addr-line><named-content content-type="city">Urbana</named-content></addr-line>, <country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Center for Biophysics and Quantitative Biology</institution>, <institution>University of Illinois at Urbana-Champaign</institution>, <addr-line><named-content content-type="city">Urbana</named-content></addr-line>, <country>United States</country></aff><aff id="aff6"><label>6</label><institution content-type="dept">Department of Physics</institution>, <institution>University of Illinois at Urbana-Champaign</institution>, <addr-line><named-content content-type="city">Urbana</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing editor</role><aff><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>akatsov@rockefeller.edu</email></corresp><fn fn-type="present-address" id="pa1"><label>†</label><p>Laboratory of Neural Circuits and Behavior, The Rockefeller University, New York, United States</p></fn><fn fn-type="present-address" id="pa2"><label>‡</label><p>Laboratory of Living Matter, The Rockefeller University, New York, United States</p></fn><fn fn-type="present-address" id="pa3"><label>§</label><p>Department of Neurobiology, Tel Aviv University, Tel Aviv, Israel</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>25</day><month>07</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e26410</elocation-id><history><date date-type="received"><day>28</day><month>02</month><year>2017</year></date><date date-type="accepted"><day>08</day><month>06</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Katsov et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Katsov et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-26410-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.26410.001</object-id><p>The function of the brain is unlikely to be understood without an accurate description of its output, yet the nature of movement elements and their organization remains an open problem. Here, movement elements are identified from dynamics of walking in flies, using unbiased criteria. On one time scale, dynamics of walking are consistent over hundreds of milliseconds, allowing elementary features to be defined. Over longer periods, walking is well described by a stochastic process composed of these elementary features, and a generative model of this process reproduces individual behavior sequences accurately over seconds or longer. Within elementary features, velocities diverge, suggesting that dynamical stability of movement elements is a weak behavioral constraint. Rather, long-term instability can be limited by the finite memory between these elementary features. This structure suggests how complex dynamics may arise in biological systems from elements whose combination need not be tuned for dynamic stability.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.001">http://dx.doi.org/10.7554/eLife.26410.001</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>locomotion</kwd><kwd>statistical segmentation</kwd><kwd>behavior units</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100005492</institution-id><institution>Stanford University</institution></institution-wrap></funding-source><award-id>Stanford Graduate Fellowship</award-id><principal-award-recipient><name><surname>Katsov</surname><given-names>Alexander Y</given-names></name><name><surname>Freifeld</surname><given-names>Limor</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100001033</institution-id><institution>Jane Coffin Childs Memorial Fund for Medical Research</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Katsov</surname><given-names>Alexander Y</given-names></name></principal-award-recipient></award-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000052</institution-id><institution>NIH Office of the Director</institution></institution-wrap></funding-source><award-id>DP1 OD003530</award-id><principal-award-recipient><name><surname>Clandinin</surname><given-names>Thomas R</given-names></name></principal-award-recipient></award-group><award-group id="par-4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01 EY022638</award-id><principal-award-recipient><name><surname>Clandinin</surname><given-names>Thomas R</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A principled statistical segmentation of fruit fly walking leads to a compact model of immediate actions that can reproduce the unique behavioral sequences of individual flies.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Behaving animals can act as quickly as their nervous systems allow, as slowly as their environments fluctuate, or over intervals determined by some task. For instance, behaviors may change quickly to avoid predators, slowly to adjust to seasons, or at the intervals of locomotor steps, song phrases, or nest-building stages. How different behaviors between these limits fit together remains poorly understood.</p><p>Classical ethological studies examined different stereotyped, goal-driven behaviors including feeding, courtship rituals, aggressive encounters, and escape sequences (<xref ref-type="bibr" rid="bib71">Tinbergen, 1963</xref>). To human observers, many of these behaviors consisted of recognizable movements that often occurred in characteristic sequences. These movements were inferred to be the fundamental units of behavior, and their modularity suggested a similarly modular organization in neural control (<xref ref-type="bibr" rid="bib70">Tinbergen, 1950</xref>; <xref ref-type="bibr" rid="bib59">Simmons and Young, 2010</xref>). Yet on the whole, animals can adjust their movements in both discrete and graded ways. For instance, houseflies track other flies in flight using a combination of stereotyped saccadic course corrections and smooth pursuit (<xref ref-type="bibr" rid="bib76">Wagner, 1986</xref>), and primates track small targets using both saccadic and smooth orienting movements (<xref ref-type="bibr" rid="bib22">Fuchs, 1967</xref>). While discrete movements can be imprecise, gradual velocity adjustments can be used to tune movements quickly with fine resolution. However, graded movement control, as a dynamical system, requires stability to be useful. As stable implementation of arbitrary dynamical systems is challenging (<xref ref-type="bibr" rid="bib61">Smale, 1966</xref>), graded control may impose limits on movement complexity or risk susceptibility to unpredictable behavior over time. Thus, while an intuitive description of movement has converged on modularity in both high and low level motor control (reviewed in <xref ref-type="bibr" rid="bib27">Giszter and Hart, 2013</xref>; <xref ref-type="bibr" rid="bib20">Flash and Hochner, 2005</xref>), variability and flexibility of ethological units have long been appreciated (<xref ref-type="bibr" rid="bib3">Barlow, 1968</xref>), and task-specific coordination of motor units down to individual muscles has been suggested (<xref ref-type="bibr" rid="bib41">Kutch et al., 2008</xref>; <xref ref-type="bibr" rid="bib74">Valero-Cuevas et al., 2009</xref>). It remains unclear whether degrees of freedom in movements are themselves limited by a finite set of functional modules, or may be adjusted continuously and in a task-specific manner (<xref ref-type="bibr" rid="bib73">Tresch and Jarc, 2009</xref>). In invertebrates, it has been argued that behavior modules represent about half of all behaviors (<xref ref-type="bibr" rid="bib6">Berman et al., 2014</xref>), but it has also been argued that apparent modules represent mere extremes within a continuum of behaviors (<xref ref-type="bibr" rid="bib24">Gallagher et al., 2013</xref>; <xref ref-type="bibr" rid="bib68">Szigeti et al., 2015</xref>; <xref ref-type="bibr" rid="bib31">Hums et al., 2016</xref>). Thus, the extent to which behavior is modular remains unresolved.</p><p>Recent advances in monitoring behavior, computing power, and statistical tools have encouraged efforts to examine behavioral organization in an unbiased manner. However, there is scant consensus on methods or criteria for unbiased segmentation. A variety of dimensionality reduction techniques using both linear and non-linear approaches have been applied to dissecting limb and animal movements in both vertebrates and invertebrates (<xref ref-type="bibr" rid="bib21">Fod et al., 2002</xref>; <xref ref-type="bibr" rid="bib17">Del Vecchio et al., 2003</xref>, <xref ref-type="bibr" rid="bib14">Avella and Bizzi, 2005</xref>; <xref ref-type="bibr" rid="bib64">Stephens et al., 2008</xref>; <xref ref-type="bibr" rid="bib65">2010</xref>, <xref ref-type="bibr" rid="bib9">Braun et al., 2010</xref>; <xref ref-type="bibr" rid="bib24">Gallagher et al., 2013</xref>; <xref ref-type="bibr" rid="bib48">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib6">Berman et al., 2014</xref>; <xref ref-type="bibr" rid="bib75">Vogelstein et al., 2014</xref>; <xref ref-type="bibr" rid="bib55">Schwarz et al., 2015</xref>; <xref ref-type="bibr" rid="bib78">Wiltschko et al., 2015</xref>). In addition, a number of approaches have used human observations to train statistical models to identify behavioral patterns. For example, the movements of both flies and worms have been described as sequences of behavioral events that were originally selected by human observers (<xref ref-type="bibr" rid="bib13">Croll, 1975</xref>; <xref ref-type="bibr" rid="bib51">Pierce-Shimomura et al., 1999</xref>; <xref ref-type="bibr" rid="bib8">Branson et al., 2009</xref>; <xref ref-type="bibr" rid="bib15">Dankert et al., 2009</xref>; <xref ref-type="bibr" rid="bib34">Kabra et al., 2013</xref>; <xref ref-type="bibr" rid="bib36">Kain et al., 2013</xref>). These methods have allowed human-observed behaviors to be scored more efficiently, enabling high-throughput quantification of gender and individual differences, or encounter types between individuals (<xref ref-type="bibr" rid="bib8">Branson et al., 2009</xref>; <xref ref-type="bibr" rid="bib15">Dankert et al., 2009</xref>). However, given the overall diversity of approaches that have been applied, and the corresponding differences in their conclusions, identifying principles of behavioral organization across different behaviors and organisms remains challenging. Here we develop a set of criteria for behavior segmentation that may be applied wherever time series measurements of behavior can be obtained.</p><p>As a simple model of spontaneous behavior, we studied fruit fly locomotion. Due to the fly’s relatively simple nervous systems and compact behavioral repertoire, this model system provides an opportunity for high-throughput studies of behavior that can be linked with circuit function. In this model system, a variety of behavioral sequences have been studied (<xref ref-type="bibr" rid="bib66">Strauss and Heisenberg, 1990</xref>; <xref ref-type="bibr" rid="bib50">Pick and Strauss, 2005</xref>; <xref ref-type="bibr" rid="bib8">Branson et al., 2009</xref>; <xref ref-type="bibr" rid="bib10">Chen et al., 2002</xref>; <xref ref-type="bibr" rid="bib62">Spieth, 1974</xref>), and powerful genetic tools can be used to link behavior to circuits (<xref ref-type="bibr" rid="bib60">Simpson, 2009</xref>).</p><p>To build a catalog of spontaneous behaviors, we acquired large datasets capturing the locomotor movements of freely walking animals. We then identified patterns in movement dynamics from body velocity time series using an iterative ICA procedure, and defined unique or interchangeable behavior components from their occurrence statistics. We found that walking behavior can be decomposed into a small number of patterns that occur largely independently of all but the immediately preceding behavior. Next, we developed a statistical model that captured sequences of these patterns over longer timescales, and tested the ability of this model to generate sets of synthetic behavior trajectories matching real fly behaviors. On short time scales, we find a continuum of behaviors whose variation can be captured by a small number of parameters. Over longer times, variation grows, but behavior is predictable because it resolves into a small number of distinct, finite memory episodes, corresponding to elementary walking patterns. As a result, these studies systematically connect the time scales of velocity modulation on the order of the action-perception cycle with longer time scales at which ethological units of behavior are observed.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Behavior shows consistency over short periods, describing the extent of behavior episodes</title><p>We set out to characterize walking at time scales from tens of milliseconds to a few seconds, beginning at the time scale of the fly action-perception cycle and extending to the time scale of locomotor behaviors (<xref ref-type="bibr" rid="bib16">David, 1984</xref>; <xref ref-type="bibr" rid="bib49">Nagle and Bell, 1987</xref>). Spontaneous walking behavior of female flies was examined in a uniformly illuminated environment without systematically varying visual, auditory or olfactory stimuli. We were interested in finding reproducible behaviors and sought to eliminate individual differences and behavioral changes that might emerge over extended periods of time. To minimize slow behavior changes due to fatigue, circadian phase, or age, well-fed 2–3 day-old flies (n = 7364) walking on a glass surface under dim illumination were tracked alone or in groups, in 10 minute trials during 2 hours of peak circadian activity. In aggregate, our datasets comprised over 1000 fly-hours of behavior, and contained over <inline-formula><mml:math id="inf1"><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:math></inline-formula> trajectories (<xref ref-type="bibr" rid="bib40">Katsov et al., 2017</xref>). Three datasets were collected for different purposes: a dataset of <inline-formula><mml:math id="inf2"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> trajectories that densely sampled walking behavior on short time scales (Dataset S, trajectory length <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> = 1.5 sec, <inline-formula><mml:math id="inf4"><mml:msub><mml:mi>P</mml:mi><mml:mn>95</mml:mn></mml:msub></mml:math></inline-formula> = [0.22,5.1] sec), a dataset of <inline-formula><mml:math id="inf5"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> longer trajectories in a large arena (Dataset L, <inline-formula><mml:math id="inf6"><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> = 5.22 sec, <inline-formula><mml:math id="inf7"><mml:msub><mml:mi>P</mml:mi><mml:mn>95</mml:mn></mml:msub></mml:math></inline-formula> = [0.42,14.55] sec), and a dataset of <inline-formula><mml:math id="inf8"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> trajectories from isolated individuals (Dataset A, <inline-formula><mml:math id="inf9"><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> = 2.2 sec, <inline-formula><mml:math id="inf10"><mml:msub><mml:mi>P</mml:mi><mml:mn>95</mml:mn></mml:msub></mml:math></inline-formula> = [0.63,7.2] sec). Given these large datasets, we could effectively sample a wide range of spontaneous locomotor behaviors.</p><p>Locomotor behaviors are commonly defined using simple speed heuristics. For instance, turns have been defined in several species, including flies, by setting a threshold on rotational speed, and runs and pauses have been defined by thresholds on translation (<xref ref-type="bibr" rid="bib4">Berg and Brown, 1972</xref>; <xref ref-type="bibr" rid="bib51">Pierce-Shimomura et al., 1999</xref>; <xref ref-type="bibr" rid="bib26">Geurten et al., 2010</xref>; <xref ref-type="bibr" rid="bib18">Drai et al., 2000</xref>; <xref ref-type="bibr" rid="bib80">Wolf et al., 2002</xref>). However, behavior categories are not always reflected unambiguously in instantaneous speeds. For instance, speed distributions with multiple modes can reflect distinct behaviors, each represented by a typical speed, but can also reflect biomechanical or other constraints that suppress some speeds in all behaviors, producing troughs in the distribution. To use more information, we looked at movement properties over time.</p><p>As Drosophila shows little independent head movement in walking maneuvers (<xref ref-type="bibr" rid="bib25">Geurten et al., 2014</xref>; <xref ref-type="bibr" rid="bib23">Fujiwara et al., 2017</xref>), we measured displacement of the entire animal as an oblong shape on a two dimensional surface and inferred the position of the head statistically with greater than 99.8% accuracy (<xref ref-type="fig" rid="fig1">Figure 1A</xref>; <xref ref-type="bibr" rid="bib39">Katsov and Clandinin, 2008</xref>). Three velocity components, translation, rotation, and side-slip, <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, completely describe walking at this level (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). These velocity components, plus accelerations <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="italic">v</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="italic">v</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="italic">v</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> were measured from <inline-formula><mml:math id="inf13"><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:math></inline-formula> individual trajectories (<xref ref-type="fig" rid="fig1">Figure 1C</xref>).<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.26410.002</object-id><label>Figure 1.</label><caption><title>Velocity-acceleration phase space captures aggregate constraints on behavior.</title><p>(<bold>A</bold>) An example trajectory fragment of an individual fly walking on a surface. The animal’s orientation (red arrows) and displacement (gray arrows) are tracked at 30 frames per second. (<bold>B</bold>) A schematic illustration of the three velocity components <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> around the major body axis of a fly. These three components completely describe whole-animal movement in two dimensions. (<bold>C</bold>) Example trajectory in velocity phase space parameterized by <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Red arrows denote the magnitude of the acceleration vector at each velocity. (<bold>D</bold>) A single plane in the 3-dimensional phase space, <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (black arrows), with an example trajectory (red arrows), projected into this plane (x-axis: <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>; y-axis: <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.002">http://dx.doi.org/10.7554/eLife.26410.002</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-26410-fig1-v2"/></fig></p><p>Movement properties were first examined over a small time step, 33 milliseconds, in a velocity-acceleration phase space. In this space, starting from velocity trajectories, the average acceleration at each <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, was used to construct a kinematic field (Materials and methods). This field shows average tendencies at different velocities. For example, when flies are not turning (<xref ref-type="fig" rid="fig1">Figure 1D</xref>, <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), but have high side-slip they tend to speed up (arrows up), while at low side-slip they tend to slow down (center of panel, arrows down). Altogether, this field constitutes a local description of behavior dynamics as it explicitly describes average dynamics at each velocity bin. For locomotor behavior, this description captures the mapping between observed behavior and aggregate forces due to neural control and biomechanical constraints, as indirectly represented in the accelerations observed at each velocity. If locomotor behaviors are separated by distinct combinations of velocity-acceleration pairs, different regions of this space should describe distinct behaviors well. However, in the kinematic field, mean dispersion about the average accelerations is greater than five times the local averages, many-fold greater than our measurement error (Materials and methods). This large dispersion may represent intrinsic behavior variability, or suggest that distinct behaviors are not well represented in their average tendencies at one time scale.</p><p>We considered three possible explanations for this large dispersion (<xref ref-type="fig" rid="fig2">Figure 2</xref>). First, though unlikely, the maneuvers of walking flies, like those of flying insects, may be relatively unstable (<xref ref-type="bibr" rid="bib69">Taylor and Thomas, 2003</xref>; <xref ref-type="bibr" rid="bib67">Sun and Xiong, 2005</xref>). As a consequence, two flies initiating a turn in the same way, with nearly identical velocity, might move in very different ways a short time later. A broad range of accelerations at any given velocity will result, and behavior dynamics, represented by accelerations, would appear poorly constrained. This possibility predicts that if one were to follow trajectories in velocity space, behaviors would diverge quickly from initially similar velocities (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). Second, behavior dynamics may be stable, but related trajectories can be reasonably expected to vary (<xref ref-type="bibr" rid="bib3">Barlow, 1968</xref>). Hence, even if distinct behaviors were well separated in velocity phase space, a range of accelerations at any given velocity would still be observed. However, unlike the first possibility, the second predicts that movements of one type will maintain velocities that are more similar to each other over time than to other movement types (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Related behaviors should remain close in velocity space over time, in distinct regions from other behaviors. The final possibility is that distinct movement patterns use distinct accelerations at similar velocities, and therefore overlap in velocity phase space. As a result, different patterns contribute different accelerations to the same velocity neighborhood. In this case, initially similar velocities would remain similar when behavior is committed to a particular movement type, but will diverge at other times (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, red, black squares, respectively).<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.26410.003</object-id><label>Figure 2.</label><caption><title>Trajectory divergence in velocity phase space and definition of a behavior episode around <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> extrema.</title><p>(<bold>A</bold>) Starting from a small neighborhood of similar velocities (box), diverging trajectories spread throughout velocity phase space, increasing in a measure of their spread. (<bold>B</bold>) Starting from the same neighborhood, divergence of trajectories corresponding to modal patterns is bounded for the duration of each pattern. (<bold>C</bold>) Bounded or unbounded divergence can be seen when modal patterns overlap in velocity phase space, depending on when trajectories are sampled in the course of these patterns. (<bold>D</bold>) The normalized standard deviation of trajectories at time <inline-formula><mml:math id="inf22"><mml:mi>t</mml:mi></mml:math></inline-formula> after passage through a small neighborhood, averaged over a random sample of <inline-formula><mml:math id="inf23"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula> neighborhoods, <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo accent="false" mathvariant="bold">¯</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ5">Equation 1</xref>, Materials and methods). Shaded areas represent 95% confidence intervals of the estimate of <inline-formula><mml:math id="inf25"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic"/><mml:mo mathvariant="bold">¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Neighborhoods were sampled from anywhere in velocity space, and for each neighborhood all trajectories were included (dot-solid line), or only those with a turn peak 100 ms after passing the neighborhood (dashed line). (<bold>E</bold>) An example trajectory fragment depicting <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> [° s<sup>−1</sup>], <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> [cm s<sup>−1</sup>]. (<bold>F</bold>) The autocorrelation functions of <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.003">http://dx.doi.org/10.7554/eLife.26410.003</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-26410-fig2-v2"/></fig></p><p>To test these alternatives, we randomly sampled small velocity neighborhoods, each corresponding to approximately 0.004% of velocity space, and measured divergence of trajectories from each neighborhood over time (Materials and methods). On average, trajectories quickly diverged up to the extent of the entire velocity space (<xref ref-type="fig" rid="fig2">Figure 2D</xref>, solid line), excluding the possibility that stable behaviors are well-separated in instantaneous velocities (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Of the remaining possibilities, is walking behavior unstable (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), or composed of distinct patterns that re-use similar velocities (<xref ref-type="fig" rid="fig2">Figure 2C</xref>)? We reasoned that if stable behaviors exist, they should be most consistent when behavior is committed to a particular movement type. Therefore, we looked for behavior episodes between locomotor adjustments. Whenever locomotor behavior is adjusted, some force must be applied to alter velocity. As a result, behavior adjustments will correspond to accelerations or decelerations. As flies accelerate or decelerate for finite periods of time, episodes of behavior adjustment must have extrema. Acceleration extrema correspond to inflections in velocity and hence we chose to examine trajectory intervals that included at least two velocity inflections, bounding an interval between behavior adjustments. We observed that the rotational component fluctuated throughout all trajectories, and displayed a steep autocorrelation falloff (<xref ref-type="fig" rid="fig2">Figure 2E,F</xref>). Indeed, local peaks in <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> arise frequently enough, with an inter-peak interval of <inline-formula><mml:math id="inf32"><mml:mrow><mml:mn>250</mml:mn><mml:mo>±</mml:mo><mml:mn>110</mml:mn></mml:mrow></mml:math></inline-formula> ms, that almost every trajectory can be represented in its entirety by short trajectory fragments surrounding <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks. When fragments include most of each interval before and after a peak, they are nearly guaranteed to include behavior adjustments on either side of the peak, capturing a relevant behavior interval. To test whether behavior divergence is ever bounded during these episodes, we examined behavior starting from defined times preceding velocity peaks. Specifically, we selected velocity neighborhoods randomly throughout velocity space again, but only examined divergence of trajectories where a <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peak occurred a defined time later, ranging from 70 ms to 170 ms. Divergence should be unaffected by this selection if behavior is unstable (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). To the contrary, we observed that on average divergence plateaued for up to 200 ms when trajectories were sampled up to 130 ms before <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks, but not earlier (<xref ref-type="fig" rid="fig2">Figure 2D</xref>, dashed line, and d.n.s). This period of bounded divergence suggested that there exist behavior patterns that remain consistent for about 200 ms, beginning from approximately the middle of the average interpeak interval. Taken together, our findings excluded possibilities A and B, suggesting that different movements must overlap in velocity phase space (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), while consistent behaviors may be defined with respect to <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks.</p></sec><sec id="s2-2"><title>Unbiased segmentation of trajectories defines modal movement patterns</title><p>We next sought to separate behavior patterns statistically. In walking flies, certain movement patterns stand out for human observers: for instance, stops, crabwalks, sharp turns, straight and curved walks (eg: <xref ref-type="bibr" rid="bib66">Strauss and Heisenberg, 1990</xref>; <xref ref-type="bibr" rid="bib8">Branson et al., 2009</xref>; <xref ref-type="bibr" rid="bib36">Kain et al., 2013</xref>; <xref ref-type="bibr" rid="bib25">Geurten et al., 2014</xref>). However, on closer inspection, even seemingly stereotyped patterns like sharp turns present a variety of movements, producing a range of very large to barely perceptible orientation changes. Does this range include distinct movement patterns? Conversely, are movement patterns that look similar to human observers really used by animals as if they are the same? Without explicit human guidance, approaches to behavior segmentation have been based on models of joint kinematics, movement dynamics, or muscle synergies (eg: <xref ref-type="bibr" rid="bib21">Fod et al., 2002</xref>; <xref ref-type="bibr" rid="bib17">Del Vecchio et al., 2003</xref>; <xref ref-type="bibr" rid="bib14">d'Avella and Bizzi, 2005</xref>), or on classification of movements from distributions of instantaneous velocities (<xref ref-type="bibr" rid="bib9">Braun et al., 2010</xref>; <xref ref-type="bibr" rid="bib24">Gallagher et al., 2013</xref>), or postures (<xref ref-type="bibr" rid="bib64">Stephens et al., 2008</xref>, <xref ref-type="bibr" rid="bib65">2010</xref>; <xref ref-type="bibr" rid="bib6">Berman et al., 2014</xref>; <xref ref-type="bibr" rid="bib55">Schwarz et al., 2015</xref>; <xref ref-type="bibr" rid="bib78">Wiltschko et al., 2015</xref>), or experimental activation of neuron groups (<xref ref-type="bibr" rid="bib75">Vogelstein et al., 2014</xref>). Our strategy was to identify any behaviors that may be different in dynamic structure, and then to use statistical relationships between these behaviors to determine if multiple behaviors belong in the same group, or whether one identified behavior is used in different ways so as to suggest multiple underlying states.</p><p>Distinct behaviors arise from differences in how flies accelerate or decelerate. Due to inertia, velocities cannot change instantaneously. However, as observed in <xref ref-type="fig" rid="fig2">Figure 2D</xref>, velocities may or may not remain similar over time, depending on what phase of behavior is examined. Because behaviors maintained similarity around <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks, trajectory fragments surrounding <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks were chosen for analysis. Specifically, fragments were selected including 550 ms before and after each <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peak, encompassing over 99% of all interpeak intervals (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, <xref ref-type="box" rid="B1">Box 1</xref>). This fragment length extended beyond the average period of bounded divergence to include as many full intervals between behavior adjustments as possible, allowing for extended behaviors. As a result, a series of partially overlapping fragments were extracted from each trajectory. These fragments were aligned in time to when a peak occurred in <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, thereby aligning the adjoining rising and falling <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> signals across trajectories. In this aligned dataset, distinct movement patterns would be marked by different magnitudes of <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks, different temporal patterns of changes in velocities around turn peaks, or both. The aligned dataset was represented in a matrix, where each column contained a different fragment around a unique <inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peak, and each row represented a step in time relative to that peak, for each velocity component. Different columns then contained either variants of related behaviors, or distinct movement patterns.<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.26410.004</object-id><label>Figure 3.</label><caption><title>Iterative ICA segmentation reveals dynamic submodes.</title><p>(<bold>A</bold>) Iterative ICA procedure. Local <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks are identified in a single trajectory (red dots). Fragments of trajectories are then selected around <inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (dashed lines), and all velocity components are aligned in time on <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> extrema in matrix <inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. In <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, turn direction is normalized while preserving the relative direction of side slip by multiplying <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> by <inline-formula><mml:math id="inf51"><mml:mi>c</mml:mi></mml:math></inline-formula>, the sign of <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> extremum at aligned time 0. <inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> dimensionality is then reduced and independent components are identified. In these independent components, velocity trajectories are represented by a coefficient in each component. If a multimodal coefficient distribution is found, coefficient clusters corresponding to distinct trajectory fragment subsets are separated, and the entire procedure is repeated iteratively on each fragment subset to identify distinct submodes. (<bold>B</bold>) Segmentation tree showing decision points (triangles), and submodes (dashed circles). 15 submodes were identified, but the decision tree is drawn up to branching levels supported by Markov modeling (<xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). Submodes are described in <xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.004">http://dx.doi.org/10.7554/eLife.26410.004</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-26410-fig3-v2"/></fig></p><boxed-text id="B1"><object-id pub-id-type="doi">10.7554/eLife.26410.005</object-id><label>Box 1.</label><caption><title>Segmentation of movement patterns, set-up.</title></caption><p>Starting with the full set of trajectories <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, times <inline-formula><mml:math id="inf55"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> of local extrema in <inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> were identified and trajectory fragments were isolated around each extremum, <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. These fragments, <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf59"><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, were normalized to the sign of <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, making all turns at <inline-formula><mml:math id="inf61"><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> positive but preserving side-slip direction relative to the turn. Each fragment of <inline-formula><mml:math id="inf62"><mml:mi>n</mml:mi></mml:math></inline-formula> time samples was represented as a <inline-formula><mml:math id="inf63"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> column vector:<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Then, vectors <inline-formula><mml:math id="inf64"><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo rspace="7.5pt">,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, representing <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks, were concatenated horizontally into a <inline-formula><mml:math id="inf66"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> matrix <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, such that each row <inline-formula><mml:math id="inf68"><mml:mi>i</mml:mi></mml:math></inline-formula> was a velocity <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mtext>or</mml:mtext><mml:mtext> </mml:mtext><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> at the same time <inline-formula><mml:math id="inf70"><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> from a <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peak at <inline-formula><mml:math id="inf72"><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>;<disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Correlations between rows in this matrix relate velocity components at aligned times <inline-formula><mml:math id="inf73"><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> from <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks in the dataset. Because velocity components differ in range and distributions, which can also change over time relative to <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks, rows were standardized to obtain matrix<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This matrix may contain two kinds of mixtures of movement patterns. First, each column (or a part of it in time) may represent a variant of a single movement pattern. This movement pattern may be described in terms of independently adjustable parts of its temporal structure, or independent components. Framed in terms of the standard ICA generative model (<xref ref-type="bibr" rid="bib32">Hyvärinen and Oja, 2000</xref>), it is hypothesized that vectors of this matrix can be described as:<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext>or</mml:mtext><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf76"><mml:msub><mml:mi mathvariant="bold"/><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are columns of a mixing matrix <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf78"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a coefficient of sample <inline-formula><mml:math id="inf79"><mml:mi>j</mml:mi></mml:math></inline-formula> in the <inline-formula><mml:math id="inf80"><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> basis vector, of the <inline-formula><mml:math id="inf81"><mml:mi>D</mml:mi></mml:math></inline-formula> basis vectors that span the space of independent components of <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. This basis vector set represents degrees of freedom in velocity trajectory shapes over time. <inline-formula><mml:math id="inf83"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> may take on continuous or discrete values, corresponding to continuous or discrete modes of movement control. The matrix <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> produces time-evolving trajectories by giving each scalar <inline-formula><mml:math id="inf85"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> an extent in time, and mixing these components. If movement dynamics can be represented by fewer degrees of freedom than dimensions of the standardized velocity-time vector <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, then <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>The second kind of mixture in <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> may be a mixture of distinct movement patterns, such that any given column (or part of it in time) contains one type of movement pattern, while different columns may contain qualitatively different patterns. If all movement dynamics are subject to the same degrees of freedom, then the same mixing matrix <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> applies to the entire dataset, and the space of independent components <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is spanned by the same basis vector set <inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Alternatively, different mixing matrices <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and independent components <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> describe each subset <inline-formula><mml:math id="inf94"><mml:mi>C</mml:mi></mml:math></inline-formula>, corresponding to distinct movement patterns.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.005">http://dx.doi.org/10.7554/eLife.26410.005</ext-link></p></boxed-text><p>To identify potentially different movement patterns, we looked for simple descriptors of velocity fragments, asking which fragments are well captured by the same set of descriptors, and which fragments require different sets of descriptors. These descriptors were inferred from patterns of variation in the fragment set, using independent components analysis, ICA (<xref ref-type="bibr" rid="bib33">Hyvärinen, 1999</xref>; <xref ref-type="bibr" rid="bib32">Hyvärinen and Oja, 2000</xref>; <xref ref-type="bibr" rid="bib30">Himberg et al., 2004</xref>), <xref ref-type="box" rid="B1 B2">Box 1, 2</xref>, Materials and methods). Using ICA, the shapes of trajectory fragments in velocity space were reduced to a set of independent parameters. These parameters may be thought of as degrees of freedom in the temporal structure of velocity trajectories. An individual trajectory fragment, as one trajectory shape described by a set of parameters, is represented by a coefficient in each parameter. To separate potentially unrelated fragments, we assumed that under most circumstances, parameter coefficients should be distributed unimodally if a parameter represents one degree of freedom of a single movement pattern. Alternatively, a multimodal coefficient distribution indicates that movement represented in this parameter may be impeded by some mechanical constraint, that movement is not well represented in this parameter, or that more than one movement type is present. For these reasons, coefficient distributions were examined once independent components were identified in a fragment dataset, starting from the complete dataset consisting of <inline-formula><mml:math id="inf95"><mml:mrow><mml:mn>2.9</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> trajectory fragments. Whenever a coefficient distribution showed multiple modes or inflections, raising the possibility of contributions from multiple movement patterns, data were separated by mode and the smaller pool of trajectory fragments corresponding to each subset was reanalyzed to find its own independent components. Because different movement patterns could arise at different frequencies, and require disambiguation of different velocity components on distinct time scales, the entire procedure was repeated iteratively for each subset of raw velocity trajectories corresponding to a distinct coefficient subset, until further iteration produced no separable data features, did not converge, or produced independent components that did not differ from previous iteration (<xref ref-type="box" rid="B2">Box 2</xref> and Materials and methods).</p><boxed-text id="B2"><object-id pub-id-type="doi">10.7554/eLife.26410.006</object-id><label>Box 2.</label><caption><title>Segmentation iteration.</title></caption><p>(1) Construct matrix <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> from trajectory fragments around <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks. Include all velocity components (<xref ref-type="box" rid="B1">Box 1</xref>, and Materials and methods <xref ref-type="disp-formula" rid="equ7">Equation 3</xref>). Columns are aligned in time with respect to <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks.</p><p>(2) Standardize, whiten rows of <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to obtain matrices <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively (Materials and methods <xref ref-type="disp-formula" rid="equ8 equ9">Equations 4–5</xref>). </p><p>(3) Select the largest principal components (PCs) to retain <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi/><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>85</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of total data variance. Eliminate rows corresponding to the remaining PCs from <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, obtaining a reduced matrix <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. </p><p>(4) Apply Independent Components Analysis (ICA) to <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. Repeat with random initial guesses for ICs.</p><p>(5) Examine ICs and data projected into ICs</p><p><bold>if</bold> <italic>ICs fail to converge</italic> <bold>then</bold></p><p> (5.1) Terminate procedure. Examine previous steps; reduce velocity-time points in <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>(dimensions of interest) as warranted. Proceed from step 1. </p><p><bold>else if</bold> <italic>ICs represent the same dimensions as pre-ICA</italic> <bold>then</bold></p><p> (5.2) Terminate procedure. Trajectories in matrix <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> represent a submode</p><p><bold>else</bold></p><p> (5.3) Project trajectories into ICs</p><p><bold> if</bold> <italic>Parameter distribution in ICs contains no separable features </italic><bold>then</bold></p><p>  (5.3.1) Terminate procedure. Trajectories in matrix <inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> represent a submode</p><p><bold> else</bold></p><p>  (5.3.2) Separate features in IC projections.</p><p>  (5.3.3) Identify trajectory fragments that correspond to each feature class in ICs.</p><p>  (5.3.4) Repeat, from Step 1, for each data subset.</p><p><bold> end</bold></p><p><bold>end</bold></p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.006">http://dx.doi.org/10.7554/eLife.26410.006</ext-link></p></boxed-text><p>Walking patterns classified in this way were termed submodes, as this analysis favored splitting over lumping of distinct behaviors and left open the possibility that identified behaviors may be subsets of larger behavior groups. Submodes included stops and dithers, when flies shifted around while remaining in one place, straight runs, smooth turns and several kinds of sharp turns, as well as different crabwalks marked by sideways motion. In addition, several variations of a sharp turn were found that included sideways or backward movement at high velocity (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, <xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). As no more than 5–6 parameters were needed to account for at least 85% of data variance at each iteration of the classification procedure, each movement pattern was reasonably well captured by a small number of parameters (see Materials and methods). Altogether, 15 submodes were identified that tiled individual trajectories from a dataset collected from thousands of individuals, likely accounting for all major walking patterns of female flies.<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.26410.007</object-id><label>Figure 4.</label><caption><title>Submode velocity profiles for each submode.</title><p>(1-15) Velocity distributions over time for each identified submode. The central 68% of the distribution is shown at each time point for up to 200 ms around peak <inline-formula><mml:math id="inf109"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. The time within each submode relative turn peak is color-coded. Submodes are shown in columns, by membership in modes <inline-formula><mml:math id="inf110"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5</xref>). (1’−15’) Example trajectory fragment of each submode type is illustrated. Three time points are shown per trajectory, each spaced 100 ms apart. A diagrammed fly illustrates the centroid location and orientation of an animal at each time point. Note that only one time point illustrates submode 8 because this submode consists of stops.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.007">http://dx.doi.org/10.7554/eLife.26410.007</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-26410-fig4-v2"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.26410.008</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Example trajectory fragments from each submode class.</title><p>Black arrows represent a fly’s body orientation, shown at 33 time steps. Gray horizontal scale bars = 3 mm, a representative length of an adult <italic>D. melanogaster</italic> female. Ten samples from each submode were drawn randomly. The time interval shown is between the two acceleration peaks flanking each submode, taken as a period between behavior adjustments as described in Main Text.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.008">http://dx.doi.org/10.7554/eLife.26410.008</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-26410-fig4-figsupp1-v2"/></fig></fig-group></p><p>As a whole, the submode set included movements salient for human observers (<xref ref-type="bibr" rid="bib8">Branson et al., 2009</xref>; <xref ref-type="bibr" rid="bib36">Kain et al., 2013</xref>, pers. observation), but the extent and composition of some submodes and the diversity of others was not intuitive. For instance, turns represented in <italic>submodes 7,10,</italic> and <italic>11</italic> (<xref ref-type="fig" rid="fig4">Figure 4</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) were easy to pick out as one kind of behavior, but not necessarily three. Some human calls picked out features that were not identified as individual submodes: for instance, reversals did not appear in submodes on their own, but as part of more complex movement patterns. Similarly, <italic>submode 1</italic> spanned a range of movements from clear turns to relatively straight walks, while <italic>submode 2</italic> included both average and very slow walks, sometimes but not always with a clear side-slip component. Are such different movements really associated together? Conversely, five submodes represented more or less subtle variants of sharp turns (<italic>submodes 3,6,7,10,11</italic>) and several submodes included various subtle rotations or side-slip (<italic>submodes 4,5,9,12–15</italic>). Are these similar movement patterns really used by animals in different ways?</p><p>To answer these questions, we examined submode relationships over time. One possibility is that each of the identified submodes represents a completely autonomous behavior. If this were the case, each submode would occur independently of submodes that come before or after. In all other cases, the statistics of submodes that tend to occur before or after a given submode can be used to identify submodes that share the same statistical relationships. Such submodes will be grouped into units we will call ‘modes.’</p></sec><sec id="s2-3"><title>Submode sequences demonstrate limited memory</title><p>To measure the extent of submode relationships over time, we first measured how well the identity of submodes at one time predicts the identity of their neighbors in the same trajectory. Velocity trajectories were converted to submode sequences by classifying each <inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peak and the surrounding trajectory fragment, using parameters found in the previous analysis (Materials and methods). For each trajectory <inline-formula><mml:math id="inf112"><mml:mi>j</mml:mi></mml:math></inline-formula>, we obtained a submode sequence <inline-formula><mml:math id="inf113"><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, where <inline-formula><mml:math id="inf114"><mml:mi>u</mml:mi></mml:math></inline-formula> represents submode identity, and <inline-formula><mml:math id="inf115"><mml:mi>i</mml:mi></mml:math></inline-formula> indexes time. Among all trajectories, we found that over a quarter of the uncertainty about submode identity <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is explained by the previous submode <inline-formula><mml:math id="inf117"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, indicating that submodes are not independent <inline-formula><mml:math id="inf118"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.271</mml:mn><mml:mo rspace="7.5pt">,</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mn>95</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.270</mml:mn><mml:mo>,</mml:mo><mml:mn> 0.272</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; where <inline-formula><mml:math id="inf119"><mml:mi>I</mml:mi></mml:math></inline-formula> is mutual information and <inline-formula><mml:math id="inf120"><mml:mi>H</mml:mi></mml:math></inline-formula> is Shannon entropy (<xref ref-type="bibr" rid="bib12">Cover and Thomas, 1991</xref>) ). However, after accounting for the history of one previous submode, almost none of the remaining uncertainty was explained by submodes one step further in the past, <inline-formula><mml:math id="inf121"><mml:mrow><mml:mpadded width="+5pt"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mpadded><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.015</mml:mn><mml:mo rspace="7.5pt">,</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mn>95</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.014</mml:mn><mml:mo>,</mml:mo><mml:mn> 0.015</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This result suggested that transitions between submodes depend on the current submode, and negligibly on submode history two or more steps in the past. However, it is possible that a small contribution of prior memory can accumulate over time.</p><p>To test the cumulative impact of history on submode transitions, two Markov models that neglected all but one or two-step submode history were used to generate short synthetic submode sequences that were then compared with real sequences. These two models generated nearly indistinguishable sets of submode sequences, each comparable to random sets of real sequences (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A</xref>). Specifically, synthetic sequences from a first-order Markov model matched almost the same number of real sequences as were matched between two random sets of real sequences (matched fraction = <inline-formula><mml:math id="inf122"><mml:mrow><mml:mn>0.93</mml:mn><mml:mo>±</mml:mo><mml:mn>0.009</mml:mn></mml:mrow></mml:math></inline-formula>, see Materials and methods), while sequences from a second-order Markov model matched real sequences only slightly better (matched fraction = <inline-formula><mml:math id="inf123"><mml:mrow><mml:mn>0.96</mml:mn><mml:mo>±</mml:mo><mml:mn>0.008</mml:mn></mml:mrow></mml:math></inline-formula>). Given that nearly equal data fractions were matched accurately by assuming either one or two submode history, we concluded that models conditioned on one previous submode are sufficient to capture most short submode sequences. As one submode but not prior history effectively influenced transitions to the next submode, this analysis argues that memory of past behavior must extinguish between the start of one submode and the start of the next. Hence, while individual submodes represent unique temporal correlations in velocities, submodes also correspond to periods during which memory of past behavior is effectively extinguished. In this way, velocity associations over short periods captured by submode identities also defined behavior elements that are decoupled over longer periods.</p></sec><sec id="s2-4"><title>Statistical relationships between submodes suggest groups of related submodes</title><p>Next, we asked whether the statistics of submode transitions suggested additional levels of behavior organization. In principle, there are two possibilities. Statistical relationships shared by more than one submode could indicate that these submodes are interchangeable in the context of other submodes, and therefore may be grouped, or transition statistics may indicate that more than one behavior underlies a single submode. To allow for both possibilities, we used the framework of Hidden Markov Models (HMMs) to identify statistical patterns in submode sequences. Different HMMs were constructed and evaluated using multiple criteria while systematically varying the assumed number of hidden states (Materials and methods). For each number of hidden states, multiple models were trained from random initial conditions to fit observed submode sequences. All models assumed that state transitions depend only on the current state, approximating history dependence in submode transitions. Models of equivalent complexity were evaluated using the likelihood attributed by each model to real submode sequences. Models of different complexity were compared using a variant of sampling from a generative model, testing each model’s ability to generate sets of individual behavior sequences that correctly represented the distribution of real trajectories (Materials and methods). By these criteria, it was found that 6-state models reproduced real submode sequences as well as models that used information about all 15 submodes, some 5-state models performed similarly to 6-state models, and all simpler models performed significantly more poorly (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1C</xref>). Therefore, we concluded that a five state model represented a good tradeoff between model complexity and accuracy, and chose one such model based on its performance (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1E,F</xref> and Materials and methods). This model, as all well-performing models, revealed a largely straightforward pattern: most submodes mapped predominantly to a unique underlying state (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1D</xref>). This result was surprising as by construction, HMMs allowed each submode to be associated with multiple states. As most submodes mapped to only a single state, some submodes were associated with the same state because there were more submodes than states. Submodes that mapped to the same state could be considered a group based on their shared statistical properties. An exception to this pattern was behavior at low velocities and stops (<italic>submode 8</italic>, and one or more of the rare <italic>submodes 4,5,9,14,15</italic>), which showed signatures of potentially mixed behavioral states (see Materials and methods and below). However, where evaluated, division of submodes into more underlying processes increased model complexity without substantially improving fit to data (see below). As many different models were evaluated, we observed that groupings of the most frequent submodes agreed between the best Markov models but submodes that occurred rarely in trajectories could be assigned to different groups, presumably reflecting their modest contributions to the dataset. As a result, a small number of models that grouped rare submodes in different ways performed comparably well by all model selection criteria, and could not be differentiated further (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1C,E</xref>). In addition, transition probabilities below approximately 0.005 could not be accurately determined, due to finite dataset sampling error (see Materials and methods). Nevertheless, as a 5-state Markov model could generate sets of synthetic behavior sequences that matched the distribution of real sequences nearly as well as more complex models, we concluded that five submode groups, or modes, provided a sufficient model of submode organization (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A,E</xref>, Materials and methods).</p><p>How are submodes organized? Multiple submodes may map to the same mode because each occurred between the same set of other movements, with similar transition probabilities. Provided their statistics are well-sampled, either similar or distinct movements may be legitimately grouped by these criteria. Were similar or distinct movements grouped in modes? Each mode, like each submode, can be described as a distribution in four dimensions: the three-component velocity vector <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, plus time. We call this distribution a velocity profile. Qualitatively, the velocity profiles of most submodes assigned to the same mode are similar (<xref ref-type="fig" rid="fig4">Figure 4</xref>), suggesting modes represent major groups of movements.</p><p>Movement patterns represented in two of the modes were confined to either low or high ranges of <inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf126"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<italic>Modes I, V</italic> respectively, <xref ref-type="fig" rid="fig5">Figure 5A,E</xref>). Velocity profiles of the other three modes all spanned low and high velocities in multiple velocity components (<italic>Modes II-IV</italic> <xref ref-type="fig" rid="fig5">Figure 5B–D</xref>). Movement patterns in these modes included: sharp and shallow turns accompanied by forward acceleration (<italic>Mode II</italic>), various side-slip motions at slow speeds, often but not always preceded by decelerations (<italic>Mode III</italic>), and slower, relatively straight runs with occasional side-slip (<italic>Mode IV</italic>) (<xref ref-type="fig" rid="fig5">Figure 5B–D</xref>, <xref ref-type="fig" rid="fig4">Figure 4</xref>). Individual movement patterns assigned to a mode could be largely judged by human observers to represent variations on a theme (<xref ref-type="fig" rid="fig4">Figure 4</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, and pers. obs.).<fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.26410.009</object-id><label>Figure 5.</label><caption><title>Identified movement patterns as distributions in velocity phase space.</title><p>(<bold>A–E</bold>) Top: Modes are described as velocity distributions over time, termed ‘velocity profiles.’The central 68% of the velocity distribution at each time point around peak <inline-formula><mml:math id="inf127"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is shown. The time relative to a turn peak within each mode is color-coded; green represents time of peak <inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Bottom: Example trajectory fragments from each mode are illustrated. Except for <inline-formula><mml:math id="inf129"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, two trajectories are shown per mode, three time points per trajectory, each spaced 100 ms apart. A diagrammed fly illustrates the centroid location and orientation of an animal at each time point. Note that only one time point illustrates <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> because this mode consists of stops. (<bold>F</bold>) Projection of all mode velocity profiles into a <inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> plane. Note that modes overlap in this joint velocity projection, and modes spanning smaller velocity regions are plotted on top of broader modes. (<bold>G</bold>) Residence time distributions, by mode, from real (light blue) and model-generated (black) trajectories. Two model-generated distributions are plotted for <inline-formula><mml:math id="inf132"><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> (left panel): a Markov model without hidden states captures short residence times in the real distribution, while a Markov model that included an additional, non-communicating hidden state captures both short and long residence times. (<bold>H</bold>) The chosen 5-state Markov model, <inline-formula><mml:math id="inf133"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>. Edges are labeled with transition probabilities between modes. This model does not represent hidden substates of <inline-formula><mml:math id="inf134"><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.009">http://dx.doi.org/10.7554/eLife.26410.009</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-26410-fig5-v2"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.26410.010</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Grouping submodes by kinetic criteria to define a behavioral model.</title><p>(<bold>A</bold>) Statistical relationship of submodes assessed using sampling from generative models. Short trajectory fragments generated using statistics from all 15 submodes individually (gray bars) or submode groups (orange, red bars) were compared to real trajectory fragments (<inline-formula><mml:math id="inf135"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>±</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>.</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> duration = <inline-formula><mml:math id="inf136"><mml:mrow><mml:mn>1.3</mml:mn><mml:mo>±</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> sec). To generate synthetic sequences, submode transition statistics were either estimated directly from submode sequences in real trajectories (models I,M1,M2), and then used to generate synthetic submode sequences, or transition statistics from state model fits to data were first used to generate state sequences, and then emission statistics fit by each model were used to sample submodes associated with each state, producing submode sequences (HMM,MM). In all cases, submode sequences were compared between real and model-generated sets of sequences. The matched fraction <inline-formula><mml:math id="inf137"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of real sequences, quantifying set overlap, is the average number of exact matches between synthetic and real fragment sets, normalized by the average number of matches between two randomly sampled real sets (Materials and methods sections IV and V, <xref ref-type="disp-formula" rid="equ19">Equation 10</xref>). First- and second-order Markov models (M1,M2) perform significantly better than a model that presumes independence between submodes (<bold>I</bold>) <inline-formula><mml:math id="inf138"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.58</mml:mn><mml:mo>±</mml:mo><mml:mn>0.016</mml:mn></mml:mrow></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.93</mml:mn><mml:mo>±</mml:mo><mml:mn>0.009</mml:mn></mml:mrow></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.96</mml:mn><mml:mo>±</mml:mo><mml:mn>0.008</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Five and six state Hidden Markov Models (HMM5,6), as well as 5 and 6 state Markov Models (MM5,6) without hidden states perform well on this generative test <inline-formula><mml:math id="inf139"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.91</mml:mn><mml:mo>±</mml:mo><mml:mn>0.007</mml:mn></mml:mrow></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.94</mml:mn><mml:mo>±</mml:mo><mml:mn>0.009</mml:mn></mml:mrow></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.88</mml:mn><mml:mo>±</mml:mo><mml:mn>0.010</mml:mn></mml:mrow></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.89</mml:mn><mml:mo>±</mml:mo><mml:mn>0.006</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) Illustration of the relevant difference between HMM and MM: in a MM (right) observable submodes <inline-formula><mml:math id="inf140"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> unambiguously reflect an underlying state <inline-formula><mml:math id="inf141"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> (termed a <inline-formula><mml:math id="inf142"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>). In an HMM (left) a given observed submode <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>u</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> may arise from more than one underlying state <inline-formula><mml:math id="inf144"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. (<bold>C</bold>) HMM mean log-likelihood values, plotted against performance on a generative test (fragment set matched fraction, <inline-formula><mml:math id="inf145"><mml:mi>f</mml:mi></mml:math></inline-formula>). Each HMM is represented by a dot and colored by the number of hidden states. (<bold>D</bold>) Emission probabilities, <inline-formula><mml:math id="inf146"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for a selected 5-state HMM (HMM5, starred in C). Bar colors represent emitting state <inline-formula><mml:math id="inf147"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. Legends list the submodes associated with each state. These are submodes <inline-formula><mml:math id="inf148"><mml:mi>u</mml:mi></mml:math></inline-formula> for which <inline-formula><mml:math id="inf149"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is significantly higher than 0. (<bold>E</bold>) MM performance on likelihood and generative tests as in (<bold>C</bold>). (<bold>F</bold>) Emission probabilities, <inline-formula><mml:math id="inf150"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, for the selected MM (MM5, starred in E, and E inset). Modes are colored as in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.010">http://dx.doi.org/10.7554/eLife.26410.010</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-26410-fig5-figsupp1-v2"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.26410.011</object-id><label>Figure 5—figure supplement 2.</label><caption><title>Information between modes in sequences.</title><p>The fraction of uncertainty about mode identity in sequences, explained by the previous mode <inline-formula><mml:math id="inf151"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the mode before that <inline-formula><mml:math id="inf152"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, plotted for different arbitrary models that group submodes into five groups in different ways. Each circle represents a unique grouping. The result of the actual grouping identified in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>, in MM5, is shown in red. For mode sequences of any length <inline-formula><mml:math id="inf153"><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo rspace="7.5pt">,</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi>H</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf154"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf155"><mml:mi>I</mml:mi></mml:math></inline-formula> is mutual information and <inline-formula><mml:math id="inf156"><mml:mi>H</mml:mi></mml:math></inline-formula> is Shannon entropy (<xref ref-type="bibr" rid="bib12">Cover and Thomas, 1991</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.011">http://dx.doi.org/10.7554/eLife.26410.011</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-26410-fig5-figsupp2-v2"/></fig></fig-group></p><p>However, both unexpected groupings and distinctions were found for statistically well-represented movement patterns. Fast, straight walking was grouped with smooth turning in the high velocity <italic>Mode V</italic>, while intermediate and slow straight walks, with occasional side slip, were grouped together in a different mode, <italic>IV</italic> (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). That is, in this segmentation, two apparently different behaviors, some turns and straight runs, were grouped together, and were distinguished from other types of related behaviors. On the other hand, two sharp turns (<italic>submodes 6</italic> and <italic>7</italic>) differed only subtly, but were never assigned to the same mode in any well-performing Markov model we evaluated. These groupings contrast with previous behavior segmentation efforts, where turns were deemed by human observers to be separate, a priori, from straight runs of all speeds, and sharp turns were treated as a single category (<xref ref-type="bibr" rid="bib51">Pierce-Shimomura et al., 1999</xref>; <xref ref-type="bibr" rid="bib8">Branson et al., 2009</xref>; <xref ref-type="bibr" rid="bib36">Kain et al., 2013</xref>; <xref ref-type="bibr" rid="bib25">Geurten et al., 2014</xref>). Crucially, in our segmentation distinct movements such as turns and straight walks of <italic>Mode V</italic> were not grouped because they tended to occur one after the other, but because they occurred interchangeably between other movements. Statistical relationships therefore also revealed associations beyond movement similarity. These relationships, the transition statistics between modes, showed an additional distinction. <italic>Modes I</italic> and <italic>V</italic> had high self-transition probabilities, and did not communicate with each other directly at significant frequencies (<xref ref-type="table" rid="tbl1">Table 1A</xref>). Rather, transitions between <italic>Modes I</italic> and <italic>V</italic> typically required passage through one or more of the intermediate <italic>Modes II-IV</italic> (<xref ref-type="fig" rid="fig5">Figure 5H</xref>). Due to this transition structure, <italic>Modes I</italic> and <italic>V</italic> showed longer residence times than other modes (<xref ref-type="fig" rid="fig5">Figure 5G</xref>).<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.26410.012</object-id><label>Table 1.</label><caption><p>Transition rates <inline-formula><mml:math id="inf157"><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, dataset S (uniform illumination, test tubes). Rows: ‘From’ mode; Columns: ‘To’ mode. Transitions below sampling error are gray.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.012">http://dx.doi.org/10.7554/eLife.26410.012</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>I</th><th>II</th><th>III</th><th>IV</th><th>V</th></tr></thead><tbody><tr><td>I</td><td>0.7764</td><td>0.1572</td><td>0.0608</td><td><italic><named-content content-type="author-callout-style-b8">0.0037</named-content></italic></td><td><italic><named-content content-type="author-callout-style-b8">0.0020</named-content></italic></td></tr><tr><td>II</td><td>0.0058</td><td>0.2010</td><td>0.0521</td><td>0.5598</td><td>0.1812</td></tr><tr><td>III</td><td>0.3129</td><td>0.3464</td><td>0.3082</td><td>0.0227</td><td>0.0098</td></tr><tr><td>IV</td><td><italic><named-content content-type="author-callout-style-b8">0.0029</named-content></italic></td><td>0.0353</td><td>0.0349</td><td>0.7111</td><td>0.2159</td></tr><tr><td>V</td><td>0.0248</td><td>0.1298</td><td>0.1364</td><td>0.3422</td><td>0.3668</td></tr></tbody></table></table-wrap></p><p>A critical prediction of the Markov model used to capture mode transitions is that the dwell time distribution describing the time flies spent in each mode should be fit by a single exponential. An excellent fit between real and model-generated dwell time distributions shows that the model captures most transition probabilities in all modes, although some slow transitions in modes <italic>I</italic> and <italic>III</italic> are missed (<xref ref-type="fig" rid="fig5">Figure 5G</xref>). Because <italic>mode III</italic> occurred infrequently (accounting for 7.3% of data), and its dominant, fast component is well captured by the model (<xref ref-type="fig" rid="fig5">Figure 5G</xref>) it was not segmented further. Two components in the stopped mode (<italic>I</italic>) dwell time distribution were separated using a Hidden Markov model, capturing observed dwell times that varied over 2–3 orders of magnitude (<xref ref-type="fig" rid="fig5">Figure 5G</xref>). However, the additional stopped mode (<inline-formula><mml:math id="inf158"><mml:msub><mml:mi>I</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>) that the HMM uncovered only communicated with other stops (mode <inline-formula><mml:math id="inf159"><mml:msub><mml:mi>I</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>), and did not improve model performance quantitatively (data not shown). We therefore did not consider this additional mode in our subsequent analysis, and infer that this second stopping mode, <inline-formula><mml:math id="inf160"><mml:msub><mml:mi>I</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, likely represents a generally non-responsive state, such as sleep (<xref ref-type="bibr" rid="bib57">Shaw et al., 2000</xref>; <xref ref-type="bibr" rid="bib29">Hendricks et al., 2000</xref>). However, stopped flies also engage in several non-locomotor behaviors such as eye, wing, and abdomen grooming, oviposition, and defecation that our dataset was not designed to resolve. These behaviors would then comprise subsets of <italic>mode I</italic>.</p><p>The set of observed behaviors, characterized as submodes, is also described more coarsely by the smaller number of modes, potentially eliminating information. However, in sequences, uncertainty about mode identity is explained as well by the previous mode as uncertainty about submode identity is explained by the previous submode (mode <inline-formula><mml:math id="inf161"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.303</mml:mn></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mn>95</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.302 0.304</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>). Conversely, as with submodes, almost none of the remaining uncertainty is explained between modes two steps apart (mode <inline-formula><mml:math id="inf162"><mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0069</mml:mn></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mn>95</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.0066 0.0072</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>). By contrast, when submodes are grouped arbitrarily into five elements, information can both decrease between adjacent elements in a sequence, and increase spuriously between elements two steps apart (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). These results argue that grouping submodes into modes neither lumped behaviors in a way that eliminated information, nor scrambled existing relationships.</p><p>We next sought to determine the extent to which the structure of our model was influenced by the structure of our chamber, or by trajectory length. We therefore examined whether submode segmentation, groupings, and transition structure remained adequate in another dataset collected under identical illumination, but in a large arena where longer individual trajectories were obtained (Dataset L). Altogether, stereotyped patterns were broadly preserved between datasets, as the same segmentation criteria unmixed trajectory coefficient distributions from either dataset in the same independent components at all steps (<xref ref-type="fig" rid="fig6">Figure 6</xref>). At a more detailed level, we quantified velocity profile similarity using an intuitive measure of distribution overlap, the Bhattacharyya coefficient <inline-formula><mml:math id="inf163"><mml:mi>B</mml:mi></mml:math></inline-formula> that ranges from 0 (no overlap) to 1 (complete overlap) (<xref ref-type="bibr" rid="bib35">Kailath, 1967</xref>, Materials and methods). Overlap was high between the same mode types segmented in different datasets (median overlap <inline-formula><mml:math id="inf164"><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>0.976</mml:mn></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>95</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.942 0.982</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>). By comparison, overlap was lower between different modes both within and between datasets (median <inline-formula><mml:math id="inf165"><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>0.642</mml:mn></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>95</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.190 0.822</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>). Comparable results were obtained using other metrics of similarity, as well as in a third dataset where individual flies were recorded in isolation (data not shown). Thus, modes retained over 90% identity and remained distinct, with only small shifts in their velocity profiles, across different datasets.<fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.26410.013</object-id><label>Figure 6.</label><caption><title>Submode segmentation in two datasets, S and L.</title><p>Histograms of trajectory coefficients <inline-formula><mml:math id="inf166"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> in independent component space (<xref ref-type="box" rid="B1">Box 1</xref> and Materials and methods) are shown at decision points of the iterative segmentation procedure. Heat maps show counts in two dimensions of the independent component space, and line plots show counts in one dimension. Decision points (numbered triangles) correspond to decision points labeled on the segmentation tree in <xref ref-type="fig" rid="fig3">Figure 3B</xref>. Subsets of coefficients separated at each decision point are shown in the same dimensions, as noted. Plot dimensions do not necessarily correspond to independent components, as sometimes data was rotated in IC space to visualize multimodal coefficient distributions. Trajectories from two different experimental conditions, corresponding to datasets S and L, were projected in the same independent components, and their coefficients are shown on the same or adjacent plots, as noted below. The initial decision point (1) and all terminal decision points (2,4–7) are shown. The coefficient distribution at decision point three is not shown because it could not be represented in two dimensions. Decision pt. (1). <inline-formula><mml:math id="inf167"><mml:msup><mml:mi mathvariant="bold"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> histograms in two dimensions, showing the multimodal distribution of coefficients from the entire dataset (Top plots), and coefficient clusters 1 and 2 after they were separated at this decision point (Bottom plots). Decision pt. (2) Data projection in two dimensions before segmentation, showing the segmentation cut (white oval), and the dwell time distributions for each resulting submode, along with single exponential fits. Note that dwell time distributions are consistent with one dominant component for each segmented submode, despite differences in the joint velocity distributions and dwell times between datasets S and L. Decision pts. (4-7) <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> histograms in one dimension, as used for segmentation. Note that the distribution at decision point six is plotted on a log scale, where segmentation separates the long tail. Decision pt. seven is upstream of further segmentations that were not validated by Markov models. As these submodes are very low frequency, they may represent distinct submodes that can be validated using larger datasets. The 5-state MM5 groups submodes as follows: <inline-formula><mml:math id="inf169"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>I</mml:mi><mml:mo>:</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>I</mml:mi><mml:mi>I</mml:mi><mml:mo>:</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>10</mml:mn><mml:mo>−</mml:mo><mml:mn>13</mml:mn></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>I</mml:mi><mml:mi>I</mml:mi><mml:mi>I</mml:mi><mml:mo>:</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>14</mml:mn><mml:mo>−</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:msub><mml:mo>;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula><inline-formula><mml:math id="inf170"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext> </mml:mtext><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>I</mml:mi><mml:mi>V</mml:mi><mml:mo>:</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>V</mml:mi><mml:mo>:</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.013">http://dx.doi.org/10.7554/eLife.26410.013</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-26410-fig6-v2"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.26410.014</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Model connectivity and transition frequencies in two datasets.</title><p>Transition probabilities of the 5-state Markov Model MM5 are shown for dataset S (A, same as <xref ref-type="fig" rid="fig5">Figure 5H</xref>), and dataset L (<bold>B</bold>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.014">http://dx.doi.org/10.7554/eLife.26410.014</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-26410-fig6-figsupp1-v2"/></fig></fig-group></p><p>Because trajectories are continuous and different modes must connect with each other as the fly moves, a mode’s velocity profile could include parts of transition periods between modes. Velocity profiles may thus change because the distribution of adjacent modes changes. In addition, velocities may also be modulated independently of mode structure. To investigate these possibilities, we compared transition probabilities and velocity profiles during transition periods in datasets S and L, representing two conditions. Indeed, although mode connectivity remained largely the same, transition probabilities differed between conditions (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). As modes were defined by classifying trajectory fragments around <inline-formula><mml:math id="inf171"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks, in this segmentation transition periods occurred in the intervals between <inline-formula><mml:math id="inf172"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks. Accordingly, we compared velocity profiles of the 25 possible interval types between the five modes from datasets S and L. Of these interval types, 22 were sufficiently well sampled to compare (<xref ref-type="table" rid="tbl1">Table 1</xref>), and of these, 19/22 showed velocity profiles that were statistically distinguishable between conditions (<xref ref-type="table" rid="tbl2">Table 2</xref>, <xref ref-type="table" rid="tbl3">Table 3</xref>, Materials and methods). However, interval velocity profiles of the same type overlapped to a high degree, even when they differed statistically (median overlap <inline-formula><mml:math id="inf173"><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>0.96</mml:mn></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>95</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.87 1.0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>). Hence, considering both velocity profiles and mode connectivity, model structure was broadly similar between two different experimental conditions. At the same time, transition probabilities between modes changed with condition, and velocity profiles differed subtly regardless of how they were measured. While modes can be reliably identified under different conditions, subtle velocity profile shifts may reflect altered transitions between modes, behavioral changes independent of mode structure, or both.<table-wrap id="tbl2" position="float"><object-id pub-id-type="doi">10.7554/eLife.26410.015</object-id><label>Table 2.</label><caption><p>Comparison of transition velocity profiles between datasets S and L. Overlap between mode velocity profiles is shown by transition type, comparing modes in datasets S and L. 1 = perfect overlap; 0 = no overlap. Rows: ‘From’ mode; Columns: ‘To’ mode. Gray values fail significance criteria as reported in Table 3.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.015">http://dx.doi.org/10.7554/eLife.26410.015</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>I</th><th>II</th><th>III</th><th>IV</th><th>V</th></tr></thead><tbody><tr><td>I</td><td>1.00</td><td>0.97</td><td>0.96</td><td><italic><named-content content-type="author-callout-style-b8">0.83</named-content></italic></td><td><italic><named-content content-type="author-callout-style-b8">0.83</named-content></italic><break/></td></tr><tr><td>II</td><td><italic><named-content content-type="author-callout-style-b8">0.76</named-content></italic></td><td>0.94</td><td>0.89</td><td>0.93</td><td>0.96</td></tr><tr><td>III</td><td>0.99</td><td>0.95</td><td>0.95</td><td>0.87</td><td><italic><named-content content-type="author-callout-style-b8">0.82</named-content></italic></td></tr><tr><td>IV</td><td><italic><named-content content-type="author-callout-style-b8">0.89</named-content></italic></td><td>0.94</td><td>0.95</td><td>0.94</td><td>0.97</td></tr><tr><td>V</td><td><italic><named-content content-type="author-callout-style-b8">0.99</named-content></italic></td><td>0.96</td><td>0.97</td><td>0.97</td><td>0.99</td></tr></tbody></table></table-wrap><table-wrap id="tbl3" position="float"><object-id pub-id-type="doi">10.7554/eLife.26410.016</object-id><label>Table 3.</label><caption><p>Probability that dataset L and S transitions are drawn from the same velocity profiles, by bootstrap for each transition type. <inline-formula><mml:math id="inf174"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.002</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> is significant at <inline-formula><mml:math id="inf175"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> level, using Bonferroni correction for 25 independent comparisons.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.016">http://dx.doi.org/10.7554/eLife.26410.016</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>I</th><th>II</th><th>III</th><th>IV</th><th>V</th></tr></thead><tbody><tr><td>I</td><td>0.0001</td><td>0.0001</td><td>0.0001</td><td>0.2354</td><td>0.4162</td></tr><tr><td>II</td><td>0.1739</td><td>0.0001</td><td>0.0001</td><td>0.0002</td><td>0.0001</td></tr><tr><td>III</td><td>0.0001</td><td>0.0002</td><td>0.0002</td><td>0.0003</td><td>0.0901</td></tr><tr><td>IV</td><td>0.0138</td><td>0.0001</td><td>0.0001</td><td>0.0001</td><td>0.0001</td></tr><tr><td>V</td><td>0.0284</td><td>0.0001</td><td>0.0001</td><td>0.0001</td><td>0.0001</td></tr></tbody></table></table-wrap></p><p>How well does a Markov model that ignores velocity profile shifts and lingering correlations between submodes predict real behavior? Can real, extended behaviors be reproduced by a model that abstracts velocity trajectories as modes connected by Markovian transitions? To test the model, we measured matches between real mode sequences observed in trajectories, and synthetic sequences produced by the Markov model, while varying sequence length. Real sequences were obtained by classifying sequences of <inline-formula><mml:math id="inf176"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks and their surrounding trajectory fragments in trajectories from dataset L according to the 5-mode model (Materials and methods, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). Synthetic sequences were sampled from a generative model, the 5-state Markov chain representing mode transitions (<xref ref-type="fig" rid="fig5">Figure 5H</xref>). As in previous analyses, sets of both real and synthetic sequences can be considered a random sample of all sequences flies, or the model, might generate. Accordingly, model performance was assessed by resampling sequences from real and synthetic sequence sets, then measuring the average number of exact matches between synthetic and real samples, normalized by matches between two real samples (Materials and methods). As before, this procedure was quantified by the match fraction <inline-formula><mml:math id="inf177"><mml:mi>f</mml:mi></mml:math></inline-formula>, ranging from 0 when synthetic sequences differ completely from real ones, to one when synthetic and real sequence sets are indistinguishable. Measuring <inline-formula><mml:math id="inf178"><mml:mi>f</mml:mi></mml:math></inline-formula> at increasing sequence lengths, we defined <inline-formula><mml:math id="inf179"><mml:msub><mml:mi>τ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> as the time interval over which <inline-formula><mml:math id="inf180"><mml:mrow><mml:mi>f</mml:mi><mml:mo>≥</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>, corresponding to sequence lengths over which the model performed accurately. Remarkably, the Markov model remained accurate over seconds (<inline-formula><mml:math id="inf181"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>4.3</mml:mn><mml:mo>±</mml:mo><mml:mn>0.55</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> s, <xref ref-type="fig" rid="fig7">Figure 7A</xref>). By comparison, velocity autocorrelations nearly vanish by 1 s (<xref ref-type="fig" rid="fig2">Figure 2F</xref>) and similar velocity patterns diverge throughout velocity space after about 200 ms (<xref ref-type="fig" rid="fig2">Figures 2D</xref> and <xref ref-type="fig" rid="fig7">7B</xref>). The Markov model thus reproduced samples of individual behavior beyond the time scale when patterns in velocity trajectories remain similar enough to be predictable. In fact, the Markov model was accurate across the entire time span of behavior that was well sampled in our trajectory datasets, raising the possibility that it may also describe walking behavior over longer periods.<fig-group><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.26410.017</object-id><label>Figure 7.</label><caption><title>Model prediction and trajectory divergence over time.</title><p>(<bold>A</bold>) Matched fraction <inline-formula><mml:math id="inf182"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of mode sequences from real trajectories as a function of sequence length. Synthetic mode sequences were generated using the transition component of the model MM5. Red dashed line marks <inline-formula><mml:math id="inf183"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>90</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, red tick and arrow mark the sequence length when <inline-formula><mml:math id="inf184"><mml:mi>f</mml:mi></mml:math></inline-formula> first crosses below 90%. (<bold>B</bold>) Trajectory divergence in velocity space from randomly sampled small neighborhoods, without and with information about current mode identity. Two divergence curves from <xref ref-type="fig" rid="fig2">Figure 2D</xref> are replotted over a longer time scale: starting from neighborhoods anywhere in velocity space, and including all trajectories (dot-solid line), or including only trajectories that attained a turn peak 100 ms later(dashed line), or only those with a turn peak 100 ms later corresponding to a given mode (solid line). Dashed and solid lines overlap for their durations. Note the short <inline-formula><mml:math id="inf185"><mml:mover accent="true"><mml:mi mathvariant="bold-italic"/><mml:mo mathvariant="bold">¯</mml:mo></mml:mover></mml:math></inline-formula> plateau, and rise after approximately 200 ms. (<bold>C</bold>) Predicted versus actual log-frequency of all mode sequences above measurement noise, up to trajectories that include 17 consecutive modes, covering 4.3 s. Markers are colored by sequence length, from shortest (2-mer, dark blue) to longest (17-mer, dark red). <inline-formula><mml:math id="inf186"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>1.00</mml:mn></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>60</mml:mn></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>≪</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>; Sampling error cutoff is at <inline-formula><mml:math id="inf187"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>2.58</mml:mn><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf188"><mml:mi>N</mml:mi></mml:math></inline-formula> = number of sequences in each condition. Ten of these sequences (#2–11) were randomly selected for display in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>, plus the most common sequence (#1). (<bold>D</bold>) Illustration of velocity trajectories specified by a stable dynamical system. Two trajectories starting from similar velocities (arrowheads, bottom), follow similar paths over time that show little divergence some time later (arrowheads, top). (<bold>E</bold>) Illustration of mode structure and transitions in velocity space. Trajectories from a small region of velocity phase space (black and red arrows) display bounded divergence for the duration of a mode (gray area) but display approximately no memory of past behavior at transitions (gaps between gray regions) beyond their current mode. Note divergence in the course of mode traversal may lead to path scrambling inside modes (jagged lines).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.017">http://dx.doi.org/10.7554/eLife.26410.017</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-26410-fig7-v2"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.26410.018</object-id><label>Figure 7—figure supplement 1.</label><caption><title>Examples of common mode sequences.</title><p>Arrows represent a fly’s body orientation, shown at 33 time steps. Examples are colored by membership in a mode class of Markov model MM5, with each mode center marked by a circle on the trajectory. Gray horizontal scale bars = 3 mm, a representative length of an adult <italic>D. melanogaster</italic> female. Numbers reference locations in <xref ref-type="fig" rid="fig5">Figure 5C</xref>, ascending from the most common to the rarest sequence shown.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.018">http://dx.doi.org/10.7554/eLife.26410.018</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-26410-fig7-figsupp1-v2"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.26410.019</object-id><label>Figure 7—figure supplement 2.</label><caption><title>Trajectory divergence in velocity space, measured from the center or periphery of each mode’s velocity distribution.</title><p>Trajectory divergence from small neighborhoods in velocity space (occupying 0.004% of space) was measured separately by mode, and by each neighborhood’s quartile in that mode’s velocity distribution <inline-formula><mml:math id="inf189"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, at <inline-formula><mml:math id="inf190"><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>ms. Divergence from individual neighborhoods was then averaged in the center <inline-formula><mml:math id="inf191"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>25.5</mml:mn><mml:mo>-</mml:mo><mml:mn>74.5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and in the periphery <inline-formula><mml:math id="inf192"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mpadded width="+5pt"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mn>25.5</mml:mn></mml:mrow></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mtext>and</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>74.5</mml:mn><mml:mo>-</mml:mo><mml:mn>99</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for all modes (<italic>center</italic>, dot-solid line; <italic>periphery</italic>, solid line). Shaded areas represent 95% confidence intervals for estimates of <inline-formula><mml:math id="inf193"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic"/><mml:mo mathvariant="bold">¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.019">http://dx.doi.org/10.7554/eLife.26410.019</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-26410-fig7-figsupp2-v2"/></fig></fig-group></p><p>Did the model capture the range of observed individual behaviors? In principle, a model might perform well simply by capturing the most common transitions in individual trajectories, such as self-transitions of stops and high-speed runs and turns (<italic>modes I</italic> and <italic>V</italic>), and matching only common behaviors like extended stop or run episodes. If this happened, matches evaluated in the generative test could be skewed by common behavioral sequences. To address this possibility, frequencies of real and model-predicted mode sequences were compared over increasing sequence lengths up to <inline-formula><mml:math id="inf194"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>4.3</mml:mn></mml:mrow></mml:math></inline-formula> s. Importantly, the observed frequencies of individual sequences in real trajectories were reproduced in the model-generated sequences, and thus the model did not simply describe behavior on average (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). Moreover, as common mode sequences were no better matched than rarer ones, model accuracy did not depend on a few overrepresented trajectory types (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). Finally, because frequencies of all real mode sequences above the sampling error in our data were matched by the Markov model with a Pearson Coefficient of R = 1.00, we conclude that the model captured all measurable transition types. Ten of these mode sequences were selected randomly and five random samples of each sequence type are shown in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>, along with samples of the most frequent sequence type, repeats of the high-speed runs and turns <italic>mode V</italic>. In sum, velocity patterns were distinguished by the same segmentation criteria on different conditions and Markov models captured transition probabilities specific to each condition, sufficiently to predict individual behavior sequences at least an order of magnitude longer than the extent of locally correlated velocity patterns.</p><p>Finally, we asked whether velocity trajectories become predictable over longer periods once mode identity is known. Starting from small neighborhoods in velocity space preceding each of the five modes, trajectory divergence was measured separately for each mode. We found that after the same short period over which unsegmented trajectories remain nearby, divergence in velocity space is unaffected by segmentation (<xref ref-type="fig" rid="fig2">Figures 2D</xref> and <xref ref-type="fig" rid="fig7">7B</xref>). Whether segmented by mode identity or not, similar trajectories diverged from <inline-formula><mml:math id="inf195"><mml:mrow><mml:mi/><mml:mo>&lt;</mml:mo><mml:mrow><mml:mn>0.004</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of velocity space 100 ms before <inline-formula><mml:math id="inf196"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> peaks, near mode initiation, across 15–20% of velocity space over the following 200 ms, during mode execution, and throughout velocity space afterwards (<xref ref-type="fig" rid="fig7">Figure 7B</xref>, <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>). As unbounded divergence occurred at the average time of behavior adjustments, mid-way between velocity peaks or modes, this finding raises the possibility that divergence is linked with apparent memory extinction captured by Markov models between the start of one mode and the start of the next. Intriguingly, bounded but significant divergence within modes also raises the possibility that a mechanism for memory loss can be intrinsic to mode structure: first order Markovity may be approximated as trajectory history is scrambled over the course of one mode (<xref ref-type="fig" rid="fig7">Figure 7D,E</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>This work examined dynamics of walking in a relatively complex animal, the fruit fly, using principled criteria. We find that fly movements naturally decompose into different time scales, identify major movement patterns, and characterize properties of these patterns over time. On a fast time scale, distinct movement patterns emerge from patterns of variation in trajectory fragments. Each movement pattern corresponds to a continuum of behaviors that can be described by a common set of parameters, representing stereotyped, but not invariant behaviors. On a longer time scale, sequences of these patterns can be approximated as a stochastic, finite-memory process. In all, this description captures a dynamic structure of behavior spanning tens of milliseconds to seconds.</p><sec id="s3-1"><title>Defining behavior structure from dynamics</title><p>Our behavior segmentation criteria were designed to identify subsets of trajectories that showed common dynamics within a subset, and mutually independent variation between subsets, consistent with signatures of distinct motor planning or control. Segmented by these criteria, some elementary behaviors were behaviors picked out by human observers or prior automated segmentation strategies, while others revealed surprising associations or distinctions between movement patterns. For instance, behaviors we termed submodes identified smooth turns, sharp turns, and sideways movements, all of which can be picked out by human observers (<xref ref-type="bibr" rid="bib8">Branson et al., 2009</xref>; <xref ref-type="bibr" rid="bib36">Kain et al., 2013</xref>), pers. obs.). Less intuitively, sharp turns that differed only subtly were distinguished as different behaviors (<xref ref-type="fig" rid="fig4">Figure 4</xref>: <italic>submodes 3</italic> or <italic>7</italic> vs. <italic>6</italic>), while a range of behaviors from turns to straight walks were associated in a single behavior element (<xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>: submode 1). Consistently, when statistical relationships between segmented elements were examined, subtly different sharp turns remained separate (in <italic>modes II</italic> vs. <italic>V</italic>), and turns remained grouped with some straight runs but not others (<italic>modes IV</italic> vs. <italic>V</italic>, <italic>modes II</italic> vs. <italic>III</italic>). By comparison, human observers have recognized sharp (‘saccadic’) turns as a distinct behavior, but had not recognized the spectrum of different turn types, and had culled turns from straight runs as different behaviors a priori (<xref ref-type="bibr" rid="bib13">Croll, 1975</xref>; <xref ref-type="bibr" rid="bib51">Pierce-Shimomura et al., 1999</xref>; <xref ref-type="bibr" rid="bib8">Branson et al., 2009</xref>; <xref ref-type="bibr" rid="bib36">Kain et al., 2013</xref>). Likewise, so had behavior segmentation strategies that largely removed human judgment but parsed behavior in instantaneous observable parameters, by thresholding fast versus slow velocities, or by segmenting orthogonal (mutually exclusive) animal postures (<xref ref-type="bibr" rid="bib9">Braun et al., 2010</xref>; <xref ref-type="bibr" rid="bib26">Geurten et al., 2010</xref>, <xref ref-type="bibr" rid="bib25">Geurten et al., 2014</xref>). These simple examples underscore how differently behavior dynamics may be organized relative to behavior features salient to human observers, or machine classification that collapses time scales.</p><p>Contrary to these segmentation strategies, our criteria identified distinct behavior patterns that overlap substantially in velocity space (<xref ref-type="fig" rid="fig5">Figure 5F</xref>). Because they overlap, these patterns cannot be separated from each other solely due to biomechanical constraints. At the same time, these patterns are unlikely to represent mere extremes of a behavior continuum (<xref ref-type="bibr" rid="bib24">Gallagher et al., 2013</xref>; <xref ref-type="bibr" rid="bib68">Szigeti et al., 2015</xref>), because they show mutually independent variation and approximately Markovian statistical relationships over time.</p><p>We hypothesize that dynamically independent behaviors in our segmentation reflect differences in neural control. While no comparable data yet exist in walking <italic>Drosophila</italic>, dynamics of global neural activity in <italic>C. elegans</italic> suggested that worm locomotion includes multiple, distinct turn types and forward run states that had not been uniquely identified in previous analyses of worm behavior (<xref ref-type="bibr" rid="bib38">Kato et al., 2015</xref>). In worms, however, behaviors have not yet been defined directly from the dynamics of locomotion. It remains to be seen whether neural and behavioral states correspond when both are defined from dynamics.</p></sec><sec id="s3-2"><title>Measurement</title><p>Several approaches to behavior segmentation have been developed to date, using different measurements that include parameterized models of limb or whole-animal posture (<xref ref-type="bibr" rid="bib21">Fod et al., 2002</xref>; <xref ref-type="bibr" rid="bib64">Stephens et al., 2008</xref>), two- or three-dimensional images of postures (<xref ref-type="bibr" rid="bib6">Berman et al., 2014</xref>; <xref ref-type="bibr" rid="bib78">Wiltschko et al., 2015</xref>), measures of gait (<xref ref-type="bibr" rid="bib36">Kain et al., 2013</xref>), and whole-body velocity (<xref ref-type="bibr" rid="bib9">Braun et al., 2010</xref>; <xref ref-type="bibr" rid="bib26">Geurten et al., 2010</xref>). The most comprehensive measurements could seem like the best starting point for unbiased segmentation, but which measures of behavior are informative depends on behavior organization, itself unknown. Since similar goals can be reached using different movements, and similar movements can be produced by different muscle actions (<xref ref-type="bibr" rid="bib7">Bernstein, 1967</xref>; <xref ref-type="bibr" rid="bib79">Winter, 1984</xref>), an increase in measured parameters does not guarantee a proportional increase in behavior resolution. On the other hand, to find behaviors from first principles requires searching potential combinations of parameters and their dynamics. This search space expands with the number of parameters. To aid search, two strategies have been applied. In one, the space of instantaneous postures is decomposed first, and then, in a reduced space of posture elements, dynamics are fitted to indirect measures of behavior (<xref ref-type="bibr" rid="bib64">Stephens et al., 2008</xref>, <xref ref-type="bibr" rid="bib65">2010</xref>). In other approaches, indirect measures of dynamics are included with posture measurements (<xref ref-type="bibr" rid="bib6">Berman et al., 2014</xref>; <xref ref-type="bibr" rid="bib78">Wiltschko et al., 2015</xref>). In both cases, the representation of either behavior or its dynamics is indirect at segmentation.</p><p>For this work, our aim was to analyze behavior directly from dynamics. For this reason we chose behaviors that could be represented by a small number of parameters. Walking Drosophila show multiple gaits (<xref ref-type="bibr" rid="bib66">Strauss and Heisenberg, 1990</xref>), but gait use is correlated with velocity, gaits transition smoothly with velocity changes (<xref ref-type="bibr" rid="bib48">Mendes et al., 2013</xref>), and movements of different body segments are tightly correlated during walking maneuvers (<xref ref-type="bibr" rid="bib25">Geurten et al., 2014</xref>; <xref ref-type="bibr" rid="bib23">Fujiwara et al., 2017</xref>). For these reasons, and since body displacement is the goal of locomotion, measurement of body velocities over time can provide sufficient resolution for locomotor behaviors in flies. However, many animals use more complicated limb or body segment movements during locomotion, and non-locomotor behaviors require measurements of posture (<xref ref-type="bibr" rid="bib64">Stephens et al., 2008</xref>; <xref ref-type="bibr" rid="bib78">Wiltschko et al., 2015</xref>). In spite of a long history of investigations, it remains to be seen in what ways movement is structured with respect to specific body configurations, action goals irrespective of configuration, or both.</p></sec><sec id="s3-3"><title>Experimental biases</title><p>Animal behavior bridges many types of external events and internal processes. Unsurprisingly, behaviors operate on multiple time scales, and many behavior properties are sensitive to environmental conditions. Fly locomotion shows trends on the scale of minutes to hours that are sensitive to age, sex, strain, satiety and other internal and environmental conditions (<xref ref-type="bibr" rid="bib46">Martin et al., 1999a</xref>); pers. obs.). For instance, after removal from one type of laboratory food, locomotion decreases over tens of minutes under low illumination in both genders of different strains, but activity is gender-dependent at shorter time scales, strain-dependent at longer time scales, and illumination-dependent on the scale of 1–2 hr (<xref ref-type="bibr" rid="bib46">Martin et al., 1999a</xref>). Under some conditions, fly locomotion has also been suggested to be scale-free (<xref ref-type="bibr" rid="bib11">Cole, 1995</xref>). In all, fly locomotion can show trends on multiple time scales that depend on experimental conditions.</p><p>For this work, the goal was to describe properties of behavior elements under stable conditions. Therefore, experimental conditions were chosen so as to minimize trends in locomotion over the course of experiments. In these conditions, flies kept moving over 30 min and velocities approximated steady state for the entire period. Data was then collected for 10 min to stay well within this period. In addition, a few different conditions were explored but all shared the same criterion, that flies remain active without gross trends in locomotion during the experiment (see Results). By this criterion, we tried to isolate behavior properties from other potential variables controlling behavior.</p><p>Under different conditions, trends in fly behavior were found on long time scales by <xref ref-type="bibr" rid="bib6">Berman et al. (2014)</xref>, <xref ref-type="bibr" rid="bib5">(2016)</xref>, who attributed these trends to an internal state change. In those conditions, locomotion largely stopped shortly after removal from food and behavior was then analyzed over the following hour (<xref ref-type="bibr" rid="bib6">Berman et al., 2014</xref>). As a result, over 85% of analyzed behaviors were non-locomotor movements while flies were standing, and here, Markovity was found to break down over one to a few seconds. This time scale is well-sampled in our data, where, by contrast, a generative Markov model produced excellent fits to data. In all, datasets and analyses differ between the two studies in several ways (Materials and methods). Since the majority of behaviors analyzed by Berman et al. are non-locomotor, and our studies used different genders, it is possible that non-locomotor and locomotor behaviors have different properties, or that memory in behavior is gender-specific. A likely possibility is that behavior transitions can be adjusted over time by internal or external variables (<xref ref-type="bibr" rid="bib5">Berman et al., 2016</xref>), suggesting one level at which behavior structure may be modified. Notably, the time scale of elementary behaviors may be invariant to conditions, gender, or other differences between studies to date. This time scale is seen to be a few hundred milliseconds by three different methods in different datasets: increased densities in posture time series power spectra (<xref ref-type="bibr" rid="bib6">Berman et al., 2014</xref>), mean residence times in inferred postural states (<xref ref-type="bibr" rid="bib5">Berman et al., 2016</xref>), and trajectory divergence properties in velocity phase space (this work).</p></sec><sec id="s3-4"><title>Mode structure and finite memory in behavior</title><p>We find that temporal structure, defined by correlations in velocities over short times, implies a decoupling over longer time scales. This decoupling between modes can be described as approximately Markovian, in that transitions between modes depend on the current mode with negligible contribution from prior history. Within any one mode, similar velocities diverge, up to a bound of approximately 20% of velocity space. Around the time of transition between modes, effectively unbounded velocity divergence is observed. These findings raise three possibilities: history of prior behavior can be forgotten in the course of executing a mode, during transitions between modes, or both. While it is possible that there might be specific neural circuits devoted to maintaining and forgetting prior states (<xref ref-type="bibr" rid="bib45">Martin et al., 1998</xref>, <xref ref-type="bibr" rid="bib47">1999b</xref>), we note that memory loss may also be intrinsic to the mode structure we describe, or the dynamics of neural activity underlying mode execution.</p></sec><sec id="s3-5"><title>Mode structure and stability</title><p>Behavior is relatively similar any time an animal executes the same mode. Whatever the animal does beforehand, the range of potentially different behaviors that can precede a given mode must narrow to the domain of that mode. At this level, modes can be said to show a transient stability. However, our data provides no evidence that modes show asymptotic stability, under which behaviors would tend towards some typical, canonical behavior within each mode, or more abstractly, a behavior attractor. In fact, on average, originally similar velocities diverge severely in the course of mode execution, and divergence of the more typical velocity trajectories within a mode differs little from that of the less typical (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>). If behavior can be described by attractor dynamics with noise, the attractors cannot be strong relative to noise. In all cases, similar velocities at the start of a mode are unlikely to remain similar at the time of transition to the next mode. Hence, at the level of modes, dynamic stability is a weak constraint in spontaneous behavior.</p></sec><sec id="s3-6"><title>Interface between behaviors</title><p>Many behaviors are thought to comprise sequences of relatively stereotyped movements that unfold over seconds or longer (e.g. <xref ref-type="bibr" rid="bib44">Marler and Hamilton, 1966</xref>; <xref ref-type="bibr" rid="bib2">Baerends, 1971</xref>; <xref ref-type="bibr" rid="bib62">Spieth, 1974</xref>; <xref ref-type="bibr" rid="bib42">Liu and Sternberg, 1995</xref>; <xref ref-type="bibr" rid="bib56">Seeds et al., 2014</xref>). To specify an entire sequence reproducibly would require a complex, relatively high-dimensional dynamical system. This dynamical system would need to cope with internal, neural variation and potentially different initial conditions each time a behavior is to be executed. For instance, variation in neural signals, mismatched mechanical impedances, or external forces, as well as changing behavioral goals, muscle tone, or afferent feedback all change the context in which any given movement is planned and executed (<xref ref-type="bibr" rid="bib7">Bernstein, 1967</xref>). These differences may persist or become amplified in the course of a sufficiently complex dynamical process unless it is carefully configured for stability. Yet, in theory, stable high-dimensional dynamical systems are rare (<xref ref-type="bibr" rid="bib61">Smale, 1966</xref>).</p><p>As one solution, behaviors may be stabilized using feedback between actual and predicted movement outcomes (eg. <xref ref-type="bibr" rid="bib72">Todorov and Jordan, 2002</xref>). However, some stereotyped behaviors proceed to completion irrespective of task-specific feedback (<xref ref-type="bibr" rid="bib43">Lorenz and Tinbergen, 1938</xref>; <xref ref-type="bibr" rid="bib77">Willows, 1967</xref>; <xref ref-type="bibr" rid="bib3">Barlow, 1968</xref>). Moreover, even when movement execution can be stabilized by feedback, the template of an intended movement still corresponds to a dynamical system, whose stability remains relevant.</p><p>As another solution, complex movements may be represented in terms of simpler, independently specified components, sometimes termed primitives (reviewed in: <xref ref-type="bibr" rid="bib20">Flash and Hochner, 2005</xref>), potentially composed into actions via hierarchies of motor control (<xref ref-type="bibr" rid="bib58">Sherrington, 1906</xref>; <xref ref-type="bibr" rid="bib70">Tinbergen, 1950</xref>). However, modular organization on its own does not guarantee dynamic stability over time. Behavior primitives must interface with each other. Likewise, so must different levels of control. Yet, when different dynamical systems interact, the history of one system can propagate to another. In this way, unintended deviations can also propagate over time. Long-term system stability is not guaranteed.</p><p>The properties of behavior elements described in this work suggest how potential challenges in building and maintaining complex, reproducible behaviors may be managed in nature. Broad velocity distributions associated with each behavior mode may accommodate a range of initial conditions, allowing different kinds of behaviors to follow one another. At the interface between behaviors, sensitivity to initial conditions can be minimized by memory loss observed over the course of single behaviors. In this way, subsequent behavior transitions can be insulated from past ones. Over longer times, finite memory between behavior elements can bound susceptibility of behavior to instability, allowing construction of more complex behavioral sequences. Interestingly, human and other vertebrate movements decompose into short episodes with a single velocity extremum following stroke or ablations, fusing gradually into smooth movements in the course of recovery; this suggests that normally smooth movement in vertebrates may be composed from such sub-movements (<xref ref-type="bibr" rid="bib53">Rohrer et al., 2002</xref>, <xref ref-type="bibr" rid="bib54">2004</xref>; <xref ref-type="bibr" rid="bib63">Stein, 2008</xref>). To what extent behavior properties found in this work are also found in other contexts and organisms remains to be investigated. This work suggests one possibility for how animals maintain dynamic complexity but limited susceptibility to consequences of any one behavior.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Datasets</title><p>A lab strain of wild-type Oregon-R <italic>D. melanogaster</italic> with homology to Oregon-R-mod-ENCODE (RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/BDSC_25211">BDSC_25211</ext-link>; D. Gohl, pers. comm.) was used for all data collection. Single fly trajectories were obtained as described in <xref ref-type="bibr" rid="bib39">Katsov and Clandinin (2008)</xref> and are available at the Dryad Digital Repository (<xref ref-type="bibr" rid="bib40">Katsov et al., 2017</xref>). Briefly, the centroid location and orientation of individual flies walking alone or in groups under uniform illumination from below (5.5 cd/m2) in an otherwise dark room were recorded at 30 frames per second. Flies walked either in long test tubes (25 × 150 mm, VWR 89001–458; Datasets S, A) or a large, custom-built arena (300 mm diameter; Dataset L). Behavior was recorded for 10 min under conditions where locomotion remained near steady state up to 30 min (<xref ref-type="bibr" rid="bib39">Katsov and Clandinin, 2008</xref>). Trajectories were retained only from the top, central portion of each chamber (8 × 100 mm of test tube, 200 × 200 mm of arena). The position of the head was inferred statistically with <inline-formula><mml:math id="inf197"><mml:mrow><mml:mi/><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>99.8</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> accuracy. Trajectories were filtered with a Gaussian kernel <inline-formula><mml:math id="inf198"><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.08</mml:mn></mml:mrow></mml:math></inline-formula> s (s.d.=1 camera frame), as in previous work (<xref ref-type="bibr" rid="bib39">Katsov and Clandinin, 2008</xref>).</p></sec><sec id="s4-2"><title>Velocity phase space, construction and measurements</title><p>Construction. Approx. 10<sup>6</sup> trajectories from 6930 female flies (median length 0.93 s, <italic>P<sub>2.5</sub>-P<sub>97.5</sub></italic> = [0.30, 4.5] s) were used to measure instantaneous velocity <inline-formula><mml:math id="inf199"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and acceleration <inline-formula><mml:math id="inf200"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="italic">v</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="italic">v</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="italic">v</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. These were used to construct distributions of accelerations at <inline-formula><mml:math id="inf201"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>41615</mml:mn></mml:mrow></mml:math></inline-formula> velocity component locations, <inline-formula><mml:math id="inf202"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> spanning <inline-formula><mml:math id="inf203"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> 450°s<sup>−1</sup> in 25°s<sup>−1</sup> increments, <inline-formula><mml:math id="inf204"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mn>0.6</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi mathvariant="italic">v</mml:mi><mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn mathvariant="italic">3.2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> cm s<sup>−1</sup> in 0.09 cm s<sup>−1</sup> increments, and <inline-formula><mml:math id="inf205"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> 0.94 cm s<sup>−1</sup> in 0.063 cm s<sup>−1</sup> increments. Although flies are capable of attaining velocities outside this range, these were not well sampled in our dataset and the velocity range was truncated accordingly to retain useful estimates of <inline-formula><mml:math id="inf206"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The average number of acceleration data points per velocity bin was <inline-formula><mml:math id="inf207"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>≈</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, but taking into account autocorrelation time, the effective number of data points per velocity bin was <inline-formula><mml:math id="inf208"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, with cutoff set at <inline-formula><mml:math id="inf209"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>. Acceleration distributions spanned, <inline-formula><mml:math id="inf210"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> 4640 °s<sup>−2</sup>, <inline-formula><mml:math id="inf211"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> 16.4 cm s<sup>−1</sup>, <inline-formula><mml:math id="inf212"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> 10.1 cm s<sup>−1</sup>. In all, 99.7% of recorded behavior was retained. The distribution <inline-formula><mml:math id="inf213"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> was averaged over <inline-formula><mml:math id="inf214"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> at each <inline-formula><mml:math id="inf215"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to produce <inline-formula><mml:math id="inf216"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. This expectation is a vector field, describing average changes in velocity at each combination of velocity components. Local dispersion was estimated by the mean absolute deviation, a conservative estimate of dispersion, taking expected value <inline-formula><mml:math id="inf217"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> over <inline-formula><mml:math id="inf218"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> at each <inline-formula><mml:math id="inf219"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf220"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Divergence of trajectories <inline-formula><mml:math id="inf221"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> was measured from similar initial conditions, defined as small neighborhoods in velocity space each covering 0.004% of this space. Velocity neighborhoods were randomly chosen by sampling velocity bin indices <inline-formula><mml:math id="inf222"><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> corresponding to bin locations in the 3-component velocity space. A random sample of <inline-formula><mml:math id="inf223"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula> bins was drawn. Each sampled bin <inline-formula><mml:math id="inf224"><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> produced a set of trajectories <inline-formula><mml:math id="inf225"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, that passed through this bin at time <inline-formula><mml:math id="inf226"><mml:msub><mml:mi>t</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula>, with <inline-formula><mml:math id="inf227"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Trajectory spread at time <inline-formula><mml:math id="inf228"><mml:mi>t</mml:mi></mml:math></inline-formula> was quantified by standard deviations <inline-formula><mml:math id="inf229"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, averaged over all randomly sampled neighborhoods and normalized to the standard deviations of the time-independent velocity component distributions:<disp-formula id="equ5"><label>(1)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo accent="false" mathvariant="bold">¯</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In the space of the 3 velocity components, <inline-formula><mml:math id="inf230"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> describes the dispersion of trajectories as a fraction of the range of attainable velocities. Trajectories were sampled in four ways for different analyses. First, all trajectories were included that passed the same neighborhood at <inline-formula><mml:math id="inf231"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Second, trajectories were selected that passed the same neighborhood at <inline-formula><mml:math id="inf232"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> then attained a <inline-formula><mml:math id="inf233"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> extremum at different times afterward, <inline-formula><mml:math id="inf234"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>67</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>300</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> ms. The delay <inline-formula><mml:math id="inf235"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> ms is half of the average interval between <inline-formula><mml:math id="inf236"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> extrema. Third, trajectories were selected that passed the same neighborhood at <inline-formula><mml:math id="inf237"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, attained a <inline-formula><mml:math id="inf238"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> extremum at <inline-formula><mml:math id="inf239"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> ms, and were classified as a specific mode <inline-formula><mml:math id="inf240"><mml:mi>m</mml:mi></mml:math></inline-formula> at that time. Fourth, trajectories were selected that passed the same neighborhood at <inline-formula><mml:math id="inf241"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, attained a <inline-formula><mml:math id="inf242"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> extremum at <inline-formula><mml:math id="inf243"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> ms, were classified as mode <inline-formula><mml:math id="inf244"><mml:mi>m</mml:mi></mml:math></inline-formula>, and fell in the same quartile of this mode’s velocity profile at <inline-formula><mml:math id="inf245"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf246"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>I</mml:mi><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>V</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. 95% confidence intervals were obtained by repeating the procedure 50 times to estimate the error of the mean.</p></sec><sec id="s4-3"><title>Submode segmentation</title><sec id="s4-3-1"><title>ICA setup</title><p>As described in <xref ref-type="box" rid="B1">Box 1</xref>, times <inline-formula><mml:math id="inf247"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> of local extrema in <inline-formula><mml:math id="inf248"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> were identified over <inline-formula><mml:math id="inf249"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>±</mml:mo><mml:mn>83.3</mml:mn></mml:mrow></mml:math></inline-formula> ms (±2 camera frames), and trajectory fragments <inline-formula><mml:math id="inf250"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>τ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, covering <inline-formula><mml:math id="inf251"><mml:mi>n</mml:mi></mml:math></inline-formula> camera frames were isolated around each <inline-formula><mml:math id="inf252"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>; initially <inline-formula><mml:math id="inf253"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>33</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>550</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> ms, but see below. Fragments <inline-formula><mml:math id="inf254"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> were represented as <inline-formula><mml:math id="inf255"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> column vectors concatenating the 3 velocity components, normalizing turn direction and preserving relative side-slip direction:<disp-formula id="equ6"><label>(2)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Then, these vectors <inline-formula><mml:math id="inf256"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, were concatenated horizontally and standardized row-wise:<disp-formula id="equ7"><label>(3)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ8"><label>(4)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We followed <xref ref-type="bibr" rid="bib32">Hyvärinen and Oja (2000)</xref>, <xref ref-type="bibr" rid="bib33">Hyvärinen (1999)</xref> and <xref ref-type="bibr" rid="bib30">Himberg et al. (2004)</xref> to identify robust convergence of the FastICA algorithm for decomposition <inline-formula><mml:math id="inf257"><mml:mrow><mml:mi mathvariant="bold"/><mml:mo>=</mml:mo><mml:mi mathvariant="bold"/></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf258"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is a <inline-formula><mml:math id="inf259"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> mixing matrix and <inline-formula><mml:math id="inf260"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is a <inline-formula><mml:math id="inf261"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> matrix that contains <inline-formula><mml:math id="inf262"><mml:mi>D</mml:mi></mml:math></inline-formula> independent component coefficients of sample <inline-formula><mml:math id="inf263"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, in each column. This procedure was done on the entire dataset in the first iteration, <inline-formula><mml:math id="inf264"><mml:mrow><mml:mi>N</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mn>2.9</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> trajectory fragments, and then iteratively on subsets as described below.</p><p>Treating trajectory fragments <inline-formula><mml:math id="inf265"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as mixtures of components <inline-formula><mml:math id="inf266"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> in independent components basis <inline-formula><mml:math id="inf267"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the generative model is reformulated using demixing matrix <inline-formula><mml:math id="inf268"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> as: <inline-formula><mml:math id="inf269"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mi>Z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Taking a row <inline-formula><mml:math id="inf270"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of the demixing matrix, <inline-formula><mml:math id="inf271"><mml:mrow><mml:mi mathvariant="bold"/><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold"/><mml:mi mathvariant="bold"/></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold"/></mml:mrow></mml:mrow></mml:math></inline-formula> represents a coefficient of fragment <inline-formula><mml:math id="inf272"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> in independent component <inline-formula><mml:math id="inf273"><mml:mi>i</mml:mi></mml:math></inline-formula>. Independent components are found using the expectation that coefficient distributions tend to become Gaussian when <inline-formula><mml:math id="inf274"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> projections represent sums of independent variables, and become less Gaussian as independent variables are demixed. FastICA searches for <inline-formula><mml:math id="inf275"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> projections distributed the least like Gaussians. The FastICA algorithm was used to maximize <inline-formula><mml:math id="inf276"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf277"><mml:mi>G</mml:mi></mml:math></inline-formula> is a contrast function. We used <inline-formula><mml:math id="inf278"><mml:mrow><mml:mi>G</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, in part to minimize computation time (<xref ref-type="bibr" rid="bib33">Hyvärinen, 1999</xref>; <xref ref-type="bibr" rid="bib32">Hyvärinen and Oja, 2000</xref>). To ensure robust convergence, the search was repeated from random initial guesses of <inline-formula><mml:math id="inf279"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib30">Himberg et al., 2004</xref>).</p></sec><sec id="s4-3-2"><title>Dimensionality reduction</title><p>In practice, the search is aided by lower data dimensionality and a <inline-formula><mml:math id="inf280"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> search space limited to orthogonal transformations. The matrix <inline-formula><mml:math id="inf281"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ8">Equation 4</xref>) was whitened to produce<disp-formula id="equ9"><label>(5)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow></mml:msup><mml:mo mathvariant="bold">=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold">E</mml:mi><mml:msup><mml:mi mathvariant="bold">D</mml:mi><mml:mrow><mml:mfrac><mml:mn mathvariant="bold">1</mml:mn><mml:mn mathvariant="bold">2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:mi mathvariant="normal">⊤</mml:mi></mml:mrow></mml:msup><mml:mo mathvariant="bold" stretchy="false">)</mml:mo><mml:mi mathvariant="bold">Z</mml:mi></mml:mstyle></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf282"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is a diagonal matrix of the eigenvalues of <inline-formula><mml:math id="inf283"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">⊤</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf284"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the corresponding matrix of column eigenvectors.</p><p>In preliminary data analysis, it was found that principal components corresponding to time points <inline-formula><mml:math id="inf285"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>300</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> ms accounted for a negligible fraction of total variance in the dataset. Moreover, when included, these dimensions slowed FastICA convergence and increased the spread of converged values of <inline-formula><mml:math id="inf286"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> without substantially affecting their mean. We inferred that these time points contributed more noise than signal and retained only <inline-formula><mml:math id="inf287"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula> ms in further analysis, corresponding to <inline-formula><mml:math id="inf288"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>19</mml:mn></mml:mrow></mml:math></inline-formula> camera frames per fragment.</p><p>While performing ICA on the entire dataset, it was found that FastICA convergence suffered when all 3 velocity components were included. Because <inline-formula><mml:math id="inf289"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> often correlated with <inline-formula><mml:math id="inf290"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, FastICA convergence was tested using fragments without any <inline-formula><mml:math id="inf291"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> dimensions. This improved convergence. However, we noted that when they did converge, IC solutions found from all 3 velocity components separated data features better than any solutions from fragments lacking <inline-formula><mml:math id="inf292"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. To improve ICA convergence without eliminating information contributed by <inline-formula><mml:math id="inf293"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, we substituted one velocity variable in fragment matrix <inline-formula><mml:math id="inf294"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf295"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf296"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mfrac><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. This is a combined rotational velocity corresponding to velocity of heading direction, rather than of body orientation only.</p><p>Operating on the entire dataset, the first iteration of ICA was set up using modified <xref ref-type="disp-formula" rid="equ6 equ7 equ8 equ9">Equations 2–5</xref>. Reduced <inline-formula><mml:math id="inf297"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>38</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> vectors,<disp-formula id="equ10"><label>(2A)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>_</mml:mo></mml:munder><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mn>300</mml:mn><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>were concatenated into (38 x N) matrices<disp-formula id="equ11"><label>(3A)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo>_</mml:mo></mml:munder><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:munder><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:munder><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:munder><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>and standardized to produce matrix<disp-formula id="equ12"><label>(4A)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒵</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>-</mml:mtext></mml:mstyle><mml:mspace width="-0.4em"/><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>-</mml:mtext></mml:mstyle><mml:mspace width="-0.4em"/><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>-</mml:mtext></mml:mstyle><mml:mspace width="-0.4em"/><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>-</mml:mtext></mml:mstyle><mml:mspace width="-0.4em"/><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:munder><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:munder><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:munder><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The matrix <inline-formula><mml:math id="inf298"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒵</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> was then whitened to produce<disp-formula id="equ13"><label>(5A)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒵</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold">E</mml:mi><mml:msup><mml:mi mathvariant="bold">D</mml:mi><mml:mrow><mml:mfrac><mml:mn mathvariant="bold">1</mml:mn><mml:mn mathvariant="bold">2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:mi mathvariant="normal">⊤</mml:mi></mml:mrow></mml:msup><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒵</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf299"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf300"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> are eigenvalue and eigenvector matrices of <inline-formula><mml:math id="inf301"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>-</mml:mtext></mml:mstyle><mml:mspace width="-0.4em"/><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>-</mml:mtext></mml:mstyle><mml:mspace width="-0.4em"/><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mrow><mml:mi mathvariant="script">𝒵</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒵</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">⊤</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively.</p><p>Evaluating the entire fragment dataset, it was found that six principal components account for 87% of total variance, and only the <inline-formula><mml:math id="inf302"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>6</mml:mn><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> projection <inline-formula><mml:math id="inf303"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒵</mml:mi></mml:mrow></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> into these PCs was used in the first iteration of ICA. Eliminated dimensions may contain biological noise or non-dominant contributors to total behavior variation. Non-dominant contributors were pursued by applying the procedure iteratively on data subsets after removing major components (see below).</p></sec><sec id="s4-3-3"><title>Iterative ICA, first iteration</title><p>When ICA converged on a solution <inline-formula><mml:math id="inf304"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mo mathvariant="bold">=</mml:mo><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒵</mml:mi></mml:mrow></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> , we examined joint histograms of independent component coefficients obtained in <inline-formula><mml:math id="inf305"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf306"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> specifying a row index, <inline-formula><mml:math id="inf307"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Each row in <inline-formula><mml:math id="inf308"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> corresponded to coefficients in one independent component for all trajectory fragments, and rows were examined pairwise for simplicity. After one ICA iteration, at least three clusters in the 6-dimensional space of <inline-formula><mml:math id="inf309"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> were apparent by visual inspection. As distributions with clear clusters are non-Gaussian at least in some dimensions, these components may have maximized the contrast function <inline-formula><mml:math id="inf310"><mml:mi>G</mml:mi></mml:math></inline-formula> without necessarily being independent. For this reason, clearly non-Gaussian features of IC projections were segmented iteratively. Statistical dependence of segmented components was subsequently assessed explicitly (below).</p><p>To begin the iterative procedure, the biggest cluster in <inline-formula><mml:math id="inf311"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> was separated from smaller ones along the minimum data density between these clusters (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, decision point 1). This segmentation turned out to approximately divide trajectories into patterns that graze near-zero <inline-formula><mml:math id="inf312"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (Cluster 1) and those that do not (Cluster 2).</p></sec><sec id="s4-3-4"><title>Segmentation iteration</title><p>The ICA procedure was repeated on each cluster. Matrix <inline-formula><mml:math id="inf313"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ7">Equation 3</xref>) was separated into <inline-formula><mml:math id="inf314"><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:msup><mml:mi mathvariant="bold"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mtext>and</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:msup><mml:mtext/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mpadded width="+5pt"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mtext>and</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> corresponding to column indices of velocity fragments belonging to Cluster 1 and Cluster 2, respectively, when projected to <inline-formula><mml:math id="inf315"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The rest of the procedure was repeated on each <inline-formula><mml:math id="inf316"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> subset as described above, including row-wise standardization, PCA, and ICA repeated from random initial guesses of demixing matrices <inline-formula><mml:math id="inf317"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Pairwise k-means clustering was used to separate <inline-formula><mml:math id="inf318"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> features whenever appropriate (<xref ref-type="bibr" rid="bib19">Duda et al., 2000</xref>). Like the first iteration, each subsequent iteration began with full 1.1 s fragments <inline-formula><mml:math id="inf319"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. It was found empirically, as in the first iteration, that fragment interval could be reduced in each subsequent iteration too, in some cases down to <inline-formula><mml:math id="inf320"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula> ms. All velocity components <inline-formula><mml:math id="inf321"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> contributed useful information for segmentation at decision points 4,7 and subsequent iterations (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). At each iteration, 5–6 PCs were retained prior to ICA accounting for <inline-formula><mml:math id="inf322"><mml:mrow><mml:mi/><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>90</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> variance within each subset. The total variance accounted for after all ICA iterations is a weighted sum, rather than product, of variance retained by PCs at each iteration (weighted by subset size), because each round began with the raw data subsets of velocity fragments (M columns, v). Hence, the total variance accounted for at the end of the procedure is likely <inline-formula><mml:math id="inf323"><mml:mrow><mml:mi/><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>87</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the lowest variance accounted for by PCs retained at any one step. Iteration was halted when further rounds failed to find ICs substantially different from those of the starting subset, when projection into ICs did not reveal clearly separable data features, or when ICA failed to converge from random initial conditions.</p><p>Cluster 1 was segmented over four further iterations into 13 submodes (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, decision points 3–7). These 13 submodes comprised different movement types traversing zero or near-zero <inline-formula><mml:math id="inf324"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Cluster 2 was segmented into two submodes, but not using ICA because further ICA on this subset did not converge on dimensions substantially different from the starting ones in <inline-formula><mml:math id="inf325"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Nevertheless, this subset appeared to contain a mixture of movement patterns as its joint distribution <inline-formula><mml:math id="inf326"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> showed two tails and kinetics of exit from this subset showed at least two distinct components (<xref ref-type="fig" rid="fig6">Figure 6</xref>, decision point 2 and data not shown). Furthermore, it was found that behavior switched out of this subset by two distinct sets of velocity trajectories (data not shown). Based on these observations, Cluster 2 was segmented to separate its distinct joint velocity distribution tails and transition paths, producing submodes 1 and 2 (<xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig6">6</xref>).</p></sec><sec id="s4-3-5"><title>Evaluating history dependence between submodes</title><p>Individual trajectories <inline-formula><mml:math id="inf327"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> from Dataset S were segmented using demixing matrices <inline-formula><mml:math id="inf328"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> from the iterative classification, producing submode sequences <inline-formula><mml:math id="inf329"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1..15</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, and transition probability distributions <inline-formula><mml:math id="inf330"><mml:mrow><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mi>u</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> were measured assuming history dependence on 0 to 2 previous submodes. We then constructed artificial submode sequences drawing iteratively from these distributions and compared each set with a set of real sequences. The ’matched fraction’ of real sequences, quantifying set overlap, was calculated as described below (‘sampling from a generative model’, and ‘match test’). This fraction is the average number of exact matches between synthetic and real sets, normalized by the average number of matches between two real sets (<xref ref-type="disp-formula" rid="equ19">Equation 10</xref>).</p></sec></sec><sec id="s4-4"><title>Markov models</title><p>We constructed HMMs treating submode sequences as emissions. Models were trained from random initial conditions, assuming a small number of hidden states underlying the 15 previously identified submodes. Markov model assumptions were tested via three different approaches (described below), and adequate model convergence was verified when training from different, random initial conditions converged to nearly identical models. Repeatedly converged models were evaluated in two ways. Models of the same order (same number of parameters) were compared using the log-likelihood of observed data given a particular model. In addition, models of the same and different order were compared using a variant of sampling from a generative model (described below). In well-performing HMMs, almost every submode was predominantly emitted from a single major state, with all secondary states together contributing a small fraction of total emissions per submode (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1D</xref>). Based on these observations of HMM structure, we constructed Markov Models (MM) in which underlying states were no longer hidden, significantly reducing the number of model parameters. Moreover, MMs permitted direct estimation of model parameters from submode frequencies observed in movement trajectories, rather than by inference as in HMMs. MMs were constructed by grouping submodes into the same emission class based on their proximity in the hierarchical clustering tree (<xref ref-type="fig" rid="fig3">Figure 3</xref>), or by lumping submodes constituting a dominant emission from the same hidden state in the best performing HMMs (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1E,F</xref>). Multiple MM variants were constructed and evaluated, comprising different MMs with 4–6 states.</p><sec id="s4-4-1"><title>The markov model</title><p>Starting from a set of possible states and emissions, classified at <inline-formula><mml:math id="inf331"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">v</mml:mi><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> extrema occurring at times <inline-formula><mml:math id="inf332"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf333"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> we trained HMMs with N = 2 to 6 states and MMs with N = 4 to 6 states, and used all <inline-formula><mml:math id="inf334"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula> submodes identified in segmentation as emissions in both cases. In the case of MMs, states <inline-formula><mml:math id="inf335"><mml:mi>q</mml:mi></mml:math></inline-formula> correspond to submode groups termed modes, <inline-formula><mml:math id="inf336"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-4-2"><title>Number of model parameters</title><p>The transition probability matrix <inline-formula><mml:math id="inf337"><mml:mrow><mml:msub><mml:mi mathvariant="bold"/><mml:mi mathvariant="bold"/></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for both HMM and MM models is given by: <inline-formula><mml:math id="inf338"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></p><p>Since the sum of each row in the matrix (corresponding to a specific pre-transition state) is equal to 1, there are <inline-formula><mml:math id="inf339"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> free parameters defining this matrix. The emission probability matrix <inline-formula><mml:math id="inf340"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is given by:<disp-formula id="equ14"><mml:math id="m14"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>In the HMM case, the sum of each row in the emission matrix (corresponding to a specific state) is equal to 1, and hence there are <inline-formula><mml:math id="inf341"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> free parameters defined by the matrix. In the MM case, an additional condition is that each column of the emission matrix (corresponding to a particular submode) contains only 1 non-zero. Accordingly, <inline-formula><mml:math id="inf342"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> free parameters define the matrix (provided <inline-formula><mml:math id="inf343"><mml:mrow><mml:mi>M</mml:mi><mml:mo>≥</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>). Hence, while number of states and their definitions contribute the same number of parameters in HMMs and MMs of comparable size, discrete emissions contribute <inline-formula><mml:math id="inf344"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> free parameters in the HMM case and <inline-formula><mml:math id="inf345"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> free parameters for MMs.</p></sec><sec id="s4-4-3"><title>HMM training</title><p>For a given model order, models were trained using 15 sets of randomly chosen initialization parameters and training data subsets. Random initial transition and emission probability matrices were generated by sampling from a uniform distribution on [0,1] and normalizing matrix rows, and 1500 short submode sequences were randomly chosen for training out of a set of 371775 sequences (mean sequence length = 3.32 emissions; s.d. 3.27). A constrained optimization procedure (using the MATLAB optimization toolbox function fmincon, with an interior-point algorithm) was used to find locally optimal parameters which maximize the log-likelihood of the training set (computed using the MATLAB statistics toolbox function hmmdecode) with the constraints being that all rows in the transition and emission matrices sum to 1.</p></sec><sec id="s4-4-4"><title>MM training</title><p>A set of models was assessed for each model order of 4, 5 or 6 states. Submodes were grouped based on (1) results of HMM training, (2) relationship between submodes in the classification tree, and (3) similarities between submode velocity profiles and connectivity with other submodes. The initial submode assignment to states was as follows:</p><p>for 4 states - {8,[3 10:13],[4 5 14],1};</p><p>for 5 states - {8,[3 10:13],[4 5 14],1,2};</p><p>for 6 states, 3 different initial state assignments were evaluated:</p><p>{8,[10:13],[4 5 14],1,2,3}, {8,[3 10:13],[4 5],14,1,2}, {8,[3 10:13],[4 5 14],15,1,2}.</p><p>Models were generated for all possible combinations of submode-state assignments for the unassigned submodes in each case. Maximum likelihood estimates for single and joint submode probabilities were computed from submode occurrence frequencies in the dataset, and transition and emission matrices were derived from these probability distributions:<disp-formula id="equ15"><label>(6)</label><mml:math id="m15"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ16"><label>(7)</label><mml:math id="m16"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-4-5"><title>Model comparison criteria</title><p>We computed log-likelihoods of 371775 submode sequences in the training set from Dataset S, based on each model. Ten models with the highest log-likelihood scores for each model type (4–6 states) were kept for further validation and performance testing.</p><sec id="s4-4-5-1"><title>likelihood test</title><p>For each model, ten test sets consisting of 20000 submode sequences were chosen randomly from Dataset S, likelihoods for each test set were estimated given the model, and the average likelihood of all ten test sets reported as the mean likelihood.</p></sec><sec id="s4-4-5-2"><title>sampling from a generative model</title><p>First, 11 sets of 5000 submode sequences of length 5 were randomly selected from the 83746 submode sequences in the training dataset that consisted of no less than 5 submodes. This was done by first randomly selecting a sequence from all sequences consisting of more than 5 submodes, and then randomly selecting a starting index that is at least 5 submodes away from the end of the sequence. No sequence was used more than once in any of the 11 test datasets. The number of exact matches between one set and each of the remaining 10 sets was counted as described in ‘Match Test’ below (<xref ref-type="disp-formula" rid="equ17">Equation 8</xref>). Then, 10 sets of 5000 sequences of length 5 were generated from each of the generative models evaluated.</p><p>For independent, and first and second order Markov models (models <inline-formula><mml:math id="inf346"><mml:mrow><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>), synthetic sequences were generated by iteratively sampling from submode transition probability distributions <inline-formula><mml:math id="inf347"><mml:mrow><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mi>u</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A</xref>).</p><p>For HMMs and MMs, first, state or mode sequences were drawn according to model transition probabilities, and then submode emissions were drawn according to model emission probabilities, conditioned on the state sequences sampled, to generate submode sequences (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A,C,E</xref>).</p><p>Exact matches were then counted between these synthetic sets and the first set of real sequences (<xref ref-type="disp-formula" rid="equ18">Equation 9</xref>), and matched fraction reported (<xref ref-type="disp-formula" rid="equ19">Equation 10</xref>, with N = 10).</p></sec></sec><sec id="s4-4-6"><title>Stationarity</title><p>Stationarity of submode and mode frequencies over the experimental time period was confirmed by checking their distributions in data subsets over time, and by comparing empirical distributions with equilibrium distributions estimated from <inline-formula><mml:math id="inf348"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">T</mml:mi><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mtext> </mml:mtext><mml:mtext>and</mml:mtext><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-4-7"><title>Dwell time analysis</title><p>Dwell times were calculated as follows. Trajectories were segmented according to Markov model <inline-formula><mml:math id="inf349"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> mode definitions, producing mode sequences of length <inline-formula><mml:math id="inf350"><mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and time sequences of <inline-formula><mml:math id="inf351"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> extrema associated with each mode <inline-formula><mml:math id="inf352"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Only sequences with an observed switch into and out of Mode <inline-formula><mml:math id="inf353"><mml:mi>m</mml:mi></mml:math></inline-formula> contributed to the dwell time distribution for Mode <inline-formula><mml:math id="inf354"><mml:mi>m</mml:mi></mml:math></inline-formula>. Hence, only sequences of length <inline-formula><mml:math id="inf355"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> were retained. Dwell time in Mode <inline-formula><mml:math id="inf356"><mml:mi>m</mml:mi></mml:math></inline-formula> was taken as the difference between times of last and first sequential <inline-formula><mml:math id="inf357"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> extrema classified as Mode <inline-formula><mml:math id="inf358"><mml:mi>m</mml:mi></mml:math></inline-formula>. Dwell times were also calculated by taking half the time to the <inline-formula><mml:math id="inf359"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> extremum of last Mode <inline-formula><mml:math id="inf360"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> as time of entry into mode <inline-formula><mml:math id="inf361"><mml:mi>m</mml:mi></mml:math></inline-formula>, and half the time to the <inline-formula><mml:math id="inf362"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> extremum of the next Mode <inline-formula><mml:math id="inf363"><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> as time of exit from <inline-formula><mml:math id="inf364"><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo rspace="7.5pt">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>≠</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>. This extended dwell time calculation did not affect distribution shape (data not shown). Dwell times in model-generated mode sequences were estimated the same way as in real sequences. The time base of all model-generated sequences was fixed such that the interval between modes was taken as a constant 167 ms. This time corresponds to the modal value of times between <inline-formula><mml:math id="inf365"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> extrema.</p></sec><sec id="s4-4-8"><title>Test of velocity profile changes between training and test conditions</title><p>Velocity distributions <inline-formula><mml:math id="inf366"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="italic">v</mml:mi><mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="italic">,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">R</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="italic">,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>∣</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>I</mml:mi><mml:mo>…</mml:mo><mml:mi>V</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, represent time-dependent velocity profiles for each mode <inline-formula><mml:math id="inf367"><mml:mi>m</mml:mi></mml:math></inline-formula> specified by <inline-formula><mml:math id="inf368"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>. These distributions were compared between modes classified from Dataset S and Dataset L over <inline-formula><mml:math id="inf369"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>300</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> ms. Distribution overlap was computed for each comparison using the Bhattacharya Coefficient for discrete distributions: <inline-formula><mml:math id="inf370"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib35">Kailath, 1967</xref>). Significance was estimated by bootstrap (<xref ref-type="bibr" rid="bib52">Rice, 1994</xref>): trajectory fragments representing the same transition type (same from: and to: states) were pooled from the two datasets, and resampled to generate 10000 comparisons between two randomly drawn trajectory subsets, maintaining the same sample sizes as in original sets. Each comparison produced an overlap value, and distributions of overlap values <inline-formula><mml:math id="inf371"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mi>B</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> were used to evaluate the probability that the observed differences between two conditions are due to random chance while sampling from identical <inline-formula><mml:math id="inf372"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> distributions.</p></sec></sec><sec id="s4-5"><title>Match test</title><p>Sequence subsets were sampled from a set of real behavior sequences or produced by a generative model. Subsets <inline-formula><mml:math id="inf373"><mml:mi>R</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf374"><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> were drawn independently from a set of real sequences, and subset <inline-formula><mml:math id="inf375"><mml:mi>S</mml:mi></mml:math></inline-formula> was drawn from a set of synthetic sequences. Different <inline-formula><mml:math id="inf376"><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>and</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> were drawn and compared <inline-formula><mml:math id="inf377"><mml:mi>N</mml:mi></mml:math></inline-formula> times, as described for each analysis.</p><p>Some sequences may occur more than once in the same subset. Therefore, we counted sequence matches between two sets taking into account sequence multiplicity. For each unique element <inline-formula><mml:math id="inf378"><mml:mi>x</mml:mi></mml:math></inline-formula> of multiset X, multiplicity <inline-formula><mml:math id="inf379"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the number of times element <inline-formula><mml:math id="inf380"><mml:mi>x</mml:mi></mml:math></inline-formula> occurs in X. For two multisets X and Y, <inline-formula><mml:math id="inf381"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>∩</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:=</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>For each unique sequence <inline-formula><mml:math id="inf382"><mml:mi>r</mml:mi></mml:math></inline-formula> in subset <inline-formula><mml:math id="inf383"><mml:mi>R</mml:mi></mml:math></inline-formula> and each unique sequence <inline-formula><mml:math id="inf384"><mml:mi>s</mml:mi></mml:math></inline-formula> in subset <inline-formula><mml:math id="inf385"><mml:mi>S</mml:mi></mml:math></inline-formula>, with subsets of equal size <inline-formula><mml:math id="inf386"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, define:<disp-formula id="equ17"><label>(8)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>:</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msup><mml:mo>:=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>∩</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ18"><label>(9)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>:</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msup><mml:mo>:=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>∩</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ19"><label>(10)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>f</mml:mi><mml:mo>:=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>:</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>:</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf387"><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:msub></mml:math></inline-formula> is an average over <inline-formula><mml:math id="inf388"><mml:mi>N</mml:mi></mml:math></inline-formula> comparisons. Metric <inline-formula><mml:math id="inf389"><mml:mi>f</mml:mi></mml:math></inline-formula> reports the average fraction of synthetic sequences found in a random real set, normalized to the average fraction of real sequences found in two randomly sampled real sets.</p><sec id="s4-5-1"><title>Match test as a function of time</title><p>Mode sequences of length <inline-formula><mml:math id="inf390"><mml:mrow><mml:mi>k</mml:mi><mml:mo rspace="7.5pt">,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> were sampled with replacement from sets of real or synthetic sequences. Real sequences were derived from Dataset L trajectories using the 15-submode segmentation criteria and 5-mode grouping criteria of <inline-formula><mml:math id="inf391"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>. Synthetic sequences were generated by iteratively sampling from state transition probability distributions of model <inline-formula><mml:math id="inf392"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>. The total number of sequences in each set ranged from 88434 <inline-formula><mml:math id="inf393"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, to 5159 <inline-formula><mml:math id="inf394"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. For each set of length <inline-formula><mml:math id="inf395"><mml:mi>k</mml:mi></mml:math></inline-formula> sequences, <inline-formula><mml:math id="inf396"><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> was computed for subsets <inline-formula><mml:math id="inf397"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>…</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>500</mml:mn><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>5000</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. <inline-formula><mml:math id="inf398"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>:</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> ranged from 465 (<inline-formula><mml:math id="inf399"><mml:mi>k</mml:mi></mml:math></inline-formula>=2) to 96 (<inline-formula><mml:math id="inf400"><mml:mi>k</mml:mi></mml:math></inline-formula>=20). <inline-formula><mml:math id="inf401"><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>:</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:msub></mml:math></inline-formula> ranged from 462 (<inline-formula><mml:math id="inf402"><mml:mi>k</mml:mi></mml:math></inline-formula>=2) to 76 (<inline-formula><mml:math id="inf403"><mml:mi>k</mml:mi></mml:math></inline-formula>=20).</p></sec></sec><sec id="s4-6"><title>Dataset and code availability</title><p>Full trajectory datasets and segmentation code are available at the Dryad Digital Repository (<xref ref-type="bibr" rid="bib40">Katsov et al., 2017</xref>). The datasets include raw trajectories and annotation of submodes and modes.</p></sec><sec id="s4-7"><title>Summary of dataset and analysis parameters</title><p>Materials and methods - <xref ref-type="table" rid="tbl4">Table 4</xref>.<table-wrap id="tbl4" position="float"><object-id pub-id-type="doi">10.7554/eLife.26410.020</object-id><label>Table 4.</label><caption><p>Materials and methods – Supplementary table 1. Comparison of dataset parameters, measurements, and findings.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26410.020">http://dx.doi.org/10.7554/eLife.26410.020</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th style="background: #fcfafa;">Work</th><th style="background: #fcfafa;">Fly strain</th><th style="background: #fcfafa;">Gender</th><th style="background: #fcfafa;">Age (days,p. e.)</th><th style="background: #fcfafa;">Recording Duration(min)</th><th style="background: #fcfafa;">Fly speed (median,cm/sec) <sup>[c]</sup></th><th style="background: #fcfafa;">Measure-ment</th><th style="background: #fcfafa;">Segmented behaviors, Total</th><th style="background: #fcfafa;">Segmented behaviors, Locomotor</th></tr></thead><tbody><tr><td style="author-callout-style-b8" valign="top">Berman et al. <sup>[a]</sup></td><td style="author-callout-style-b8" valign="top">Oregon-R</td><td style="author-callout-style-b8" valign="top">♂, ♀</td><td style="author-callout-style-b8" valign="top">1-14</td><td style="author-callout-style-b8" valign="top">60</td><td style="author-callout-style-b8" valign="top">0.3 (♂)</td><td style="author-callout-style-b8" valign="top">2-D image <break/>(posture)</td><td style="author-callout-style-b8" valign="top">117</td><td style="author-callout-style-b8" valign="top">17</td></tr><tr><td style="author-callout-style-b8" valign="top">Berman et al. <sup>[b]</sup></td><td style="author-callout-style-b8" valign="top">.</td><td style="author-callout-style-b8" valign="top">♂</td><td style="author-callout-style-b8" valign="top">.</td><td style="author-callout-style-b8" valign="top">.</td><td style="author-callout-style-b8" valign="top">.</td><td style="author-callout-style-b8" valign="top">.</td><td style="author-callout-style-b8" valign="top">.</td><td style="author-callout-style-b8" valign="top">.</td></tr><tr><td style="author-callout-style-b8" valign="top">Katsov et al.</td><td style="author-callout-style-b8" valign="top">Oregon-R</td><td style="author-callout-style-b8" valign="top">♀</td><td style="author-callout-style-b8" valign="top">2-3</td><td style="author-callout-style-b8" valign="top">10</td><td style="author-callout-style-b8" valign="top">2.0</td><td style="author-callout-style-b8" valign="top">body velocity</td><td style="author-callout-style-b8" valign="top">15</td><td style="author-callout-style-b8" valign="top">15<sup>[d]</sup></td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p>[ . ] same value as row above.</p></fn><fn id="tblfn2"><p>[a] (<xref ref-type="bibr" rid="bib6">Berman et al., 2014</xref>)</p></fn><fn id="tblfn3"><p>[b] (<xref ref-type="bibr" rid="bib5">Berman et al., 2016</xref>)</p></fn><fn id="tblfn4"><p>[c] <xref ref-type="bibr" rid="bib6">Berman et al. (2014)</xref> show median velocity ~0.3 mm/sec (Fig S1); the units appear to be a typographical error.</p></fn><fn id="tblfn5"><p>[d] Count includes submode 8/mode I, a mixture of locomotor and non-locomotor states (stops).</p></fn></table-wrap-foot></table-wrap></p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>The authors thank Daniel Ramot, Eran Mukamel, James Fitzgerald, and members of the Clandinin and Bargmann Labs for discussions, and Zak Frentz for comments on the manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>AYK, Conceptualization, Data curation, Software, Formal analysis, Supervision, Validation, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing, AK conceived the project and acquired data. AK, LF, MH, SK, and TC designed analyses. LF and AK performed Markov Model analysis, and AK performed all other analyses. AK, LF, SK and TC wrote the paper</p></fn><fn fn-type="con" id="con2"><p>LF, Conceptualization, Software, Formal analysis, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>MH, Supervision, Funding acquisition, Methodology</p></fn><fn fn-type="con" id="con4"><p>SK, Validation, Methodology, Writing—review and editing</p></fn><fn fn-type="con" id="con5"><p>TRC, Conceptualization, Formal analysis, Supervision, Funding acquisition, Validation, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following dataset was generated:</p><p><related-object content-type="generated-dataset" id="data-ro1" source-id="http://dx.doi.org/10.5061/dryad.854j2" source-id-type="uri"><collab>Katsov AY</collab><x>,</x> <collab>Freifeld L</collab><x>,</x> <collab>Horowitz M</collab><x>,</x> <collab>Kuehn S</collab><x>,</x> <collab>Clandinin TR</collab><x>,</x> <year>2017</year><x>,</x><source>Data from: Dynamic structure of locomotor behavior in walking fruit flies</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.854j2">http://dx.doi.org/10.5061/dryad.854j2</ext-link><x>,</x> <comment>Available at Dryad Digital Repository under a CC0 Public Domain Dedication</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>DJ</given-names></name><name><surname>Perona</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Toward a science of computational ethology</article-title><source>Neuron</source><volume>84</volume><fpage>18</fpage><lpage>31</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.09.005</pub-id><pub-id pub-id-type="pmid">25277452</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baerends</surname><given-names>GP</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>The ethological analysis of fish behavior</article-title><source>Fish Physiology</source><volume>6</volume><fpage>279</fpage><lpage>370</lpage><pub-id pub-id-type="doi">10.1016/S1546-5098(08)60150-8</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Barlow</surname><given-names>GW</given-names></name></person-group><year iso-8601-date="1968">1968</year><chapter-title>Ethological units of behavior</chapter-title><person-group person-group-type="editor"><name><surname>Ingle</surname> <given-names>D</given-names></name></person-group><source>The Central Nervous System and Fish Behavior</source><publisher-loc>Chicago</publisher-loc><publisher-name>Chicago University Press</publisher-name><fpage>217</fpage><lpage>232</lpage></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>HC</given-names></name><name><surname>Brown</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Chemotaxis in Escherichia coli analysed by three-dimensional tracking</article-title><source>Nature</source><volume>239</volume><fpage>500</fpage><lpage>504</lpage><pub-id pub-id-type="doi">10.1038/239500a0</pub-id><pub-id pub-id-type="pmid">4563019</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>GJ</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Shaevitz</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Predictability and hierarchy in Drosophila behavior</article-title><source>PNAS</source><volume>113</volume><fpage>11943</fpage><lpage>11948</lpage><pub-id pub-id-type="doi">10.1073/pnas.1607601113</pub-id><pub-id pub-id-type="pmid">27702892</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>GJ</given-names></name><name><surname>Choi</surname><given-names>DM</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Shaevitz</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mapping the stereotyped behaviour of freely moving fruit flies</article-title><source>Journal of the Royal Society Interface</source><volume>11</volume><elocation-id>20140672</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2014.0672</pub-id><pub-id pub-id-type="pmid">25142523</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bernstein</surname><given-names>N</given-names></name></person-group><year iso-8601-date="1967">1967</year><source>The Coordination and Regulation of Movements</source><publisher-loc>London</publisher-loc><publisher-name>Pergamon</publisher-name></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Branson</surname><given-names>K</given-names></name><name><surname>Robie</surname><given-names>AA</given-names></name><name><surname>Bender</surname><given-names>J</given-names></name><name><surname>Perona</surname><given-names>P</given-names></name><name><surname>Dickinson</surname><given-names>MH</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>High-throughput ethomics in large groups of Drosophila</article-title><source>Nature Methods</source><volume>6</volume><fpage>451</fpage><lpage>457</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1328</pub-id><pub-id pub-id-type="pmid">19412169</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Braun</surname><given-names>E</given-names></name><name><surname>Geurten</surname><given-names>B</given-names></name><name><surname>Egelhaaf</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Identifying prototypical components in behaviour using clustering algorithms</article-title><source>PLoS One</source><volume>5</volume><elocation-id>e9361</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0009361</pub-id><pub-id pub-id-type="pmid">20179763</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>AY</given-names></name><name><surname>Bowens</surname><given-names>NM</given-names></name><name><surname>Huber</surname><given-names>R</given-names></name><name><surname>Kravitz</surname><given-names>EA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Fighting fruit flies: a model system for the study of aggression</article-title><source>PNAS</source><volume>99</volume><fpage>5664</fpage><lpage>5668</lpage><pub-id pub-id-type="doi">10.1073/pnas.082102599</pub-id><pub-id pub-id-type="pmid">11960020</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cole</surname><given-names>BJ</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Fractal time in animal behaviour: the movement activity of Drosophila</article-title><source>Animal Behaviour</source><volume>50</volume><fpage>1317</fpage><lpage>1324</lpage><pub-id pub-id-type="doi">10.1016/0003-3472(95)80047-6</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cover</surname><given-names>TM</given-names></name><name><surname>Thomas</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="1991">1991</year><source>Elements of Information Theory</source><publisher-name>John Wiley and Sons</publisher-name><pub-id pub-id-type="doi">10.1002/0471200611</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croll</surname><given-names>NA</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Behavioural analysis of nematode movement</article-title><source>Advances in Parasitology</source><volume>13</volume><fpage>71</fpage><lpage>122</lpage><pub-id pub-id-type="doi">10.1016/S0065-308X(08)60319-X</pub-id><pub-id pub-id-type="pmid">1169872</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>d'Avella</surname><given-names>A</given-names></name><name><surname>Bizzi</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Shared and specific muscle synergies in natural motor behaviors</article-title><source>PNAS</source><volume>102</volume><fpage>3076</fpage><lpage>3081</lpage><pub-id pub-id-type="doi">10.1073/pnas.0500199102</pub-id><pub-id pub-id-type="pmid">15708969</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dankert</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Hoopfer</surname><given-names>ED</given-names></name><name><surname>Anderson</surname><given-names>DJ</given-names></name><name><surname>Perona</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Automated monitoring and analysis of social behavior in Drosophila</article-title><source>Nature Methods</source><volume>6</volume><fpage>297</fpage><lpage>303</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1310</pub-id><pub-id pub-id-type="pmid">19270697</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>David</surname><given-names>CT</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>The dynamics of height stabilization in Drosophila</article-title><source>Physiological Entomology</source><volume>9</volume><fpage>377</fpage><lpage>386</lpage><pub-id pub-id-type="doi">10.1111/j.1365-3032.1984.tb00778.x</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Del Vecchio</surname><given-names>D</given-names></name><name><surname>Murray</surname><given-names>RM</given-names></name><name><surname>Perona</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Decomposition of human motion into dynamics-based primitives with application to drawing tasks</article-title><source>Automatica</source><volume>39</volume><fpage>2085</fpage><lpage>2098</lpage><pub-id pub-id-type="doi">10.1016/S0005-1098(03)00250-4</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drai</surname><given-names>D</given-names></name><name><surname>Benjamini</surname><given-names>Y</given-names></name><name><surname>Golani</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Statistical discrimination of natural modes of motion in rat exploratory behavior</article-title><source>Journal of Neuroscience Methods</source><volume>96</volume><fpage>119</fpage><lpage>131</lpage><pub-id pub-id-type="doi">10.1016/S0165-0270(99)00194-6</pub-id><pub-id pub-id-type="pmid">10720676</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Duda</surname><given-names>RO</given-names></name><name><surname>Hart</surname><given-names>PE</given-names></name><name><surname>Stork</surname><given-names>DG</given-names></name></person-group><year iso-8601-date="2000">2000</year><source>Pattern Classification</source><publisher-name>John Wiley &amp; Sons</publisher-name></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flash</surname><given-names>T</given-names></name><name><surname>Hochner</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Motor primitives in vertebrates and invertebrates</article-title><source>Current Opinion in Neurobiology</source><volume>15</volume><fpage>660</fpage><lpage>666</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2005.10.011</pub-id><pub-id pub-id-type="pmid">16275056</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fod</surname><given-names>A</given-names></name><name><surname>Matarić</surname><given-names>MJ</given-names></name><name><surname>Jenkins</surname><given-names>OC</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Automated derivation of primitives for movement classification</article-title><source>Autonomous Robots</source><volume>12</volume><fpage>39</fpage><lpage>54</lpage><pub-id pub-id-type="doi">10.1023/A:1013254724861</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuchs</surname><given-names>AF</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>Saccadic and smooth pursuit eye movements in the monkey</article-title><source>The Journal of Physiology</source><volume>191</volume><fpage>609</fpage><lpage>631</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1967.sp008271</pub-id><pub-id pub-id-type="pmid">4963872</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fujiwara</surname><given-names>T</given-names></name><name><surname>Cruz</surname><given-names>TL</given-names></name><name><surname>Bohnslav</surname><given-names>JP</given-names></name><name><surname>Chiappe</surname><given-names>ME</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A faithful internal representation of walking movements in the Drosophila visual system</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>72</fpage><lpage>81</lpage><pub-id pub-id-type="doi">10.1038/nn.4435</pub-id><pub-id pub-id-type="pmid">27798632</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallagher</surname><given-names>T</given-names></name><name><surname>Bjorness</surname><given-names>T</given-names></name><name><surname>Greene</surname><given-names>R</given-names></name><name><surname>You</surname><given-names>YJ</given-names></name><name><surname>Avery</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The geometry of locomotive behavioral states in C. elegans</article-title><source>PLoS One</source><volume>8</volume><elocation-id>e59865</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0059865</pub-id><pub-id pub-id-type="pmid">23555813</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geurten</surname><given-names>BR</given-names></name><name><surname>Jähde</surname><given-names>P</given-names></name><name><surname>Corthals</surname><given-names>K</given-names></name><name><surname>Göpfert</surname><given-names>MC</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Saccadic body turns in walking Drosophila</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>8</volume><elocation-id>265</elocation-id><pub-id pub-id-type="doi">10.3389/fnbeh.2014.00365</pub-id><pub-id pub-id-type="pmid">25386124</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geurten</surname><given-names>BR</given-names></name><name><surname>Kern</surname><given-names>R</given-names></name><name><surname>Braun</surname><given-names>E</given-names></name><name><surname>Egelhaaf</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A syntax of hoverfly flight prototypes</article-title><source>Journal of Experimental Biology</source><volume>213</volume><fpage>2461</fpage><lpage>2475</lpage><pub-id pub-id-type="doi">10.1242/jeb.036079</pub-id><pub-id pub-id-type="pmid">20581276</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giszter</surname><given-names>SF</given-names></name><name><surname>Hart</surname><given-names>CB</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Motor primitives and synergies in the spinal cord and after injury--the current state of play</article-title><source>Annals of the New York Academy of Sciences</source><volume>1279</volume><fpage>114</fpage><lpage>126</lpage><pub-id pub-id-type="doi">10.1111/nyas.12065</pub-id><pub-id pub-id-type="pmid">23531009</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Havekes</surname><given-names>R</given-names></name><name><surname>Abel</surname><given-names>T</given-names></name><name><surname>Goodwin</surname><given-names>SF</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Genetic dissection of neural circuits and behavior in mus Musculus</article-title><source>Advances in Genetics</source><volume>65</volume><fpage>1-38</fpage><pub-id pub-id-type="doi">10.1016/S0065-2660(09)65001-X</pub-id><pub-id pub-id-type="pmid">19615530</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hendricks</surname><given-names>JC</given-names></name><name><surname>Finn</surname><given-names>SM</given-names></name><name><surname>Panckeri</surname><given-names>KA</given-names></name><name><surname>Chavkin</surname><given-names>J</given-names></name><name><surname>Williams</surname><given-names>JA</given-names></name><name><surname>Sehgal</surname><given-names>A</given-names></name><name><surname>Pack</surname><given-names>AI</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Rest in Drosophila is a sleep-like state</article-title><source>Neuron</source><volume>25</volume><fpage>129</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(00)80877-6</pub-id><pub-id pub-id-type="pmid">10707978</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Himberg</surname><given-names>J</given-names></name><name><surname>Hyvärinen</surname><given-names>A</given-names></name><name><surname>Esposito</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Validating the independent components of neuroimaging time series via clustering and visualization</article-title><source>NeuroImage</source><volume>22</volume><fpage>1214</fpage><lpage>1222</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2004.03.027</pub-id><pub-id pub-id-type="pmid">15219593</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hums</surname><given-names>I</given-names></name><name><surname>Riedl</surname><given-names>J</given-names></name><name><surname>Mende</surname><given-names>F</given-names></name><name><surname>Kato</surname><given-names>S</given-names></name><name><surname>Kaplan</surname><given-names>HS</given-names></name><name><surname>Latham</surname><given-names>R</given-names></name><name><surname>Sonntag</surname><given-names>M</given-names></name><name><surname>Traunmüller</surname><given-names>L</given-names></name><name><surname>Zimmer</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Regulation of two motor patterns enables the gradual adjustment of locomotion strategy in Caenorhabditis elegans</article-title><source>eLife</source><volume>5</volume><elocation-id>e14116</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.14116</pub-id><pub-id pub-id-type="pmid">27222228</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyvärinen</surname><given-names>A</given-names></name><name><surname>Oja</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Independent component analysis: algorithms and applications</article-title><source>Neural Networks</source><volume>13</volume><fpage>411</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1016/S0893-6080(00)00026-5</pub-id><pub-id pub-id-type="pmid">10946390</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyvärinen</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Fast and robust fixed-point algorithms for independent component analysis</article-title><source>IEEE Transactions on Neural Networks</source><volume>10</volume><fpage>626</fpage><lpage>634</lpage><pub-id pub-id-type="doi">10.1109/72.761722</pub-id><pub-id pub-id-type="pmid">18252563</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kabra</surname><given-names>M</given-names></name><name><surname>Robie</surname><given-names>AA</given-names></name><name><surname>Rivera-Alba</surname><given-names>M</given-names></name><name><surname>Branson</surname><given-names>S</given-names></name><name><surname>Branson</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>JAABA: interactive machine learning for automatic annotation of animal behavior</article-title><source>Nature Methods</source><volume>10</volume><fpage>64</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2281</pub-id><pub-id pub-id-type="pmid">23202433</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kailath</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>The divergence and Bhattacharyya Distance measures in signal selection</article-title><source>IEEE Transactions on Communications</source><volume>15</volume><fpage>52</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1109/TCOM.1967.1089532</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kain</surname><given-names>J</given-names></name><name><surname>Stokes</surname><given-names>C</given-names></name><name><surname>Gaudry</surname><given-names>Q</given-names></name><name><surname>Song</surname><given-names>X</given-names></name><name><surname>Foley</surname><given-names>J</given-names></name><name><surname>Wilson</surname><given-names>R</given-names></name><name><surname>de Bivort</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Leg-tracking and automated behavioural classification in Drosophila</article-title><source>Nature Communications</source><volume>4</volume><elocation-id>1910</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms2908</pub-id><pub-id pub-id-type="pmid">23715269</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kantz</surname><given-names>H</given-names></name><name><surname>Schreiber</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2004">2004</year><source>Nonlinear Time Series Analysis</source><volume>Vol. 7</volume><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kato</surname><given-names>S</given-names></name><name><surname>Kaplan</surname><given-names>HS</given-names></name><name><surname>Schrödel</surname><given-names>T</given-names></name><name><surname>Skora</surname><given-names>S</given-names></name><name><surname>Lindsay</surname><given-names>TH</given-names></name><name><surname>Yemini</surname><given-names>E</given-names></name><name><surname>Lockery</surname><given-names>S</given-names></name><name><surname>Zimmer</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Global brain dynamics embed the motor command sequence of Caenorhabditis elegans</article-title><source>Cell</source><volume>163</volume><fpage>656</fpage><lpage>669</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.09.034</pub-id><pub-id pub-id-type="pmid">26478179</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katsov</surname><given-names>AY</given-names></name><name><surname>Clandinin</surname><given-names>TR</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Motion processing streams in Drosophila are behaviorally specialized</article-title><source>Neuron</source><volume>59</volume><fpage>322</fpage><lpage>335</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.05.022</pub-id><pub-id pub-id-type="pmid">18667159</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="data"><person-group person-group-type="author"><name><surname>Katsov</surname><given-names>AY</given-names></name><name><surname>Freifeld</surname><given-names>L</given-names></name><name><surname>Horowitz</surname><given-names>M</given-names></name><name><surname>Kuehn</surname><given-names>S</given-names></name><name><surname>Clandinin</surname><given-names>TR</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Data from: dynamic structure of locomotor behavior in walking fruit flies</data-title><source>Dryad Digital Repository</source><pub-id pub-id-type="doi">10.5061/dryad.854j2</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kutch</surname><given-names>JJ</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name><name><surname>Bloch</surname><given-names>AM</given-names></name><name><surname>Rymer</surname><given-names>WZ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Endpoint force fluctuations reveal flexible rather than synergistic patterns of muscle cooperation</article-title><source>Journal of Neurophysiology</source><volume>100</volume><fpage>2455</fpage><lpage>2471</lpage><pub-id pub-id-type="doi">10.1152/jn.90274.2008</pub-id><pub-id pub-id-type="pmid">18799603</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>KS</given-names></name><name><surname>Sternberg</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Sensory regulation of male mating behavior in Caenorhabditis elegans</article-title><source>Neuron</source><volume>14</volume><fpage>79</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1016/0896-6273(95)90242-2</pub-id><pub-id pub-id-type="pmid">7826644</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lorenz</surname><given-names>K</given-names></name><name><surname>Tinbergen</surname><given-names>N</given-names></name></person-group><year iso-8601-date="1938">1938</year><article-title>Taxis und Instinkthandlung in der Eirollbewegung der Graugans. 1</article-title><source>Zeitschrift Für Tierpsychologie</source><volume>2</volume><fpage>1</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1111/j.1439-0310.1939.tb01558.x</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Marler</surname><given-names>PR</given-names></name><name><surname>Hamilton</surname><given-names>WJ</given-names></name></person-group><year iso-8601-date="1966">1966</year><source>Mechanisms of Animal Behavior</source><publisher-loc>Oxford</publisher-loc><publisher-name>Wiley</publisher-name></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>JR</given-names></name><name><surname>Ernst</surname><given-names>R</given-names></name><name><surname>Heisenberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Mushroom bodies suppress locomotor activity in Drosophila Melanogaster</article-title><source>Learning &amp; Memory</source><volume>5</volume><fpage>179</fpage><lpage>191</lpage><pub-id pub-id-type="doi">10.1101/lm.5.1.179</pub-id><pub-id pub-id-type="pmid">10454382</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>JR</given-names></name><name><surname>Ernst</surname><given-names>R</given-names></name><name><surname>Heisenberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1999">1999a</year><article-title>Temporal pattern of locomotor activity in Drosophila Melanogaster</article-title><source>Journal of Comparative Physiology A: Sensory, Neural, and Behavioral Physiology</source><volume>184</volume><fpage>73</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1007/s003590050307</pub-id><pub-id pub-id-type="pmid">10077864</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>JR</given-names></name><name><surname>Raabe</surname><given-names>T</given-names></name><name><surname>Heisenberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1999">1999b</year><article-title>Central complex substructures are required for the maintenance of locomotor activity in Drosophila Melanogaster</article-title><source>Journal of Comparative Physiology A: Sensory, Neural, and Behavioral Physiology</source><volume>185</volume><fpage>277</fpage><lpage>288</lpage><pub-id pub-id-type="doi">10.1007/s003590050387</pub-id><pub-id pub-id-type="pmid">10573866</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendes</surname><given-names>CS</given-names></name><name><surname>Bartos</surname><given-names>I</given-names></name><name><surname>Akay</surname><given-names>T</given-names></name><name><surname>Márka</surname><given-names>S</given-names></name><name><surname>Mann</surname><given-names>RS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Quantification of gait parameters in freely walking wild type and sensory deprived Drosophila Melanogaster</article-title><source>eLife</source><volume>2</volume><elocation-id>e00231</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00231</pub-id><pub-id pub-id-type="pmid">23326642</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagle</surname><given-names>KJ</given-names></name><name><surname>Bell</surname><given-names>WJ</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Genetic control of the search tactic of Drosophila Melanogaster: an ethometric analysis of rover/sitter traits in adult flies</article-title><source>Behavior Genetics</source><volume>17</volume><fpage>385</fpage><lpage>408</lpage><pub-id pub-id-type="doi">10.1007/BF01068138</pub-id><pub-id pub-id-type="pmid">3118865</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pick</surname><given-names>S</given-names></name><name><surname>Strauss</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Goal-driven behavioral adaptations in gap-climbing Drosophila</article-title><source>Current Biology</source><volume>15</volume><fpage>1473</fpage><lpage>1478</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2005.07.022</pub-id><pub-id pub-id-type="pmid">16111941</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierce-Shimomura</surname><given-names>JT</given-names></name><name><surname>Morse</surname><given-names>TM</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>The fundamental role of pirouettes in Caenorhabditis elegans chemotaxis</article-title><source>Journal of Neuroscience</source><volume>19</volume><fpage>9557</fpage><lpage>9569</lpage><pub-id pub-id-type="pmid">10531458</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rice</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1994">1994</year><source>Mathematical Statistics and Data Analysis</source><publisher-name>Nelson Education</publisher-name></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rohrer</surname><given-names>B</given-names></name><name><surname>Fasoli</surname><given-names>S</given-names></name><name><surname>Krebs</surname><given-names>HI</given-names></name><name><surname>Hughes</surname><given-names>R</given-names></name><name><surname>Volpe</surname><given-names>B</given-names></name><name><surname>Frontera</surname><given-names>WR</given-names></name><name><surname>Stein</surname><given-names>J</given-names></name><name><surname>Hogan</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Movement smoothness changes during stroke recovery</article-title><source>Journal of Neuroscience</source><volume>22</volume><fpage>8297</fpage><lpage>8304</lpage><pub-id pub-id-type="pmid">12223584</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rohrer</surname><given-names>B</given-names></name><name><surname>Fasoli</surname><given-names>S</given-names></name><name><surname>Krebs</surname><given-names>HI</given-names></name><name><surname>Volpe</surname><given-names>B</given-names></name><name><surname>Frontera</surname><given-names>WR</given-names></name><name><surname>Stein</surname><given-names>J</given-names></name><name><surname>Hogan</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Submovements grow larger, fewer, and more blended during stroke recovery</article-title><source>Motor Control</source><volume>8</volume><fpage>472</fpage><lpage>483</lpage><pub-id pub-id-type="doi">10.1123/mcj.8.4.472</pub-id><pub-id pub-id-type="pmid">15585902</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwarz</surname><given-names>RF</given-names></name><name><surname>Branicky</surname><given-names>R</given-names></name><name><surname>Grundy</surname><given-names>LJ</given-names></name><name><surname>Schafer</surname><given-names>WR</given-names></name><name><surname>Brown</surname><given-names>AE</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Changes in Postural Syntax characterize Sensory modulation and natural variation of C. elegans Locomotion</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004322</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004322</pub-id><pub-id pub-id-type="pmid">26295152</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seeds</surname><given-names>AM</given-names></name><name><surname>Ravbar</surname><given-names>P</given-names></name><name><surname>Chung</surname><given-names>P</given-names></name><name><surname>Hampel</surname><given-names>S</given-names></name><name><surname>Midgley</surname><given-names>FM</given-names></name><name><surname>Mensh</surname><given-names>BD</given-names></name><name><surname>Simpson</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A suppression hierarchy among competing motor programs drives sequential grooming in Drosophila</article-title><source>eLife</source><volume>3</volume><elocation-id>e02951</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.02951</pub-id><pub-id pub-id-type="pmid">25139955</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shaw</surname><given-names>PJ</given-names></name><name><surname>Cirelli</surname><given-names>C</given-names></name><name><surname>Greenspan</surname><given-names>RJ</given-names></name><name><surname>Tononi</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Correlates of sleep and waking in Drosophila melanogaster</article-title><source>Science</source><volume>287</volume><fpage>1834</fpage><lpage>1837</lpage><pub-id pub-id-type="doi">10.1126/science.287.5459.1834</pub-id><pub-id pub-id-type="pmid">10710313</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sherrington</surname><given-names>CS</given-names></name></person-group><year iso-8601-date="1906">1906</year><source>The Integrative Action of the Nervous System</source><publisher-loc>New Haven</publisher-loc><publisher-name>Yale University Press</publisher-name></element-citation></ref><ref id="bib59"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Simmons</surname><given-names>P</given-names></name><name><surname>Young</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2010">2010</year><source>Nerve Cells and Animal Behaviour</source><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9780511782138</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simpson</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Mapping and manipulating neural circuits in the fly brain</article-title><source>Advances in Genetics</source><volume>65</volume><fpage>79</fpage><lpage>143</lpage><pub-id pub-id-type="doi">10.1016/S0065-2660(09)65003-3</pub-id><pub-id pub-id-type="pmid">19615532</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smale</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1966">1966</year><article-title>Structurally stable Systems are not dense</article-title><source>American Journal of Mathematics</source><volume>88</volume><fpage>491</fpage><lpage>496</lpage><pub-id pub-id-type="doi">10.2307/2373203</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spieth</surname><given-names>HT</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>Courtship behavior in <italic>Drosophila</italic></article-title><source>Annual Review of Entomology</source><volume>19</volume><fpage>385</fpage><lpage>405</lpage><pub-id pub-id-type="doi">10.1146/annurev.en.19.010174.002125</pub-id><pub-id pub-id-type="pmid">4205689</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stein</surname><given-names>PS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Motor pattern deletions and modular organization of turtle spinal cord</article-title><source>Brain Research Reviews</source><volume>57</volume><fpage>118</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1016/j.brainresrev.2007.07.008</pub-id><pub-id pub-id-type="pmid">17826841</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>GJ</given-names></name><name><surname>Johnson-Kerner</surname><given-names>B</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Dimensionality and dynamics in the behavior of C. elegans</article-title><source>PLoS Computational Biology</source><volume>4</volume><elocation-id>e1000028</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000028</pub-id><pub-id pub-id-type="pmid">18389066</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>GJ</given-names></name><name><surname>Johnson-Kerner</surname><given-names>B</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>From modes to movement in the behavior of Caenorhabditis elegans</article-title><source>PLoS One</source><volume>5</volume><elocation-id>e13914</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0013914</pub-id><pub-id pub-id-type="pmid">21103370</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strauss</surname><given-names>R</given-names></name><name><surname>Heisenberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Coordination of legs during straight walking and turning in Drosophila Melanogaster</article-title><source>Journal of Comparative Physiology A</source><volume>167</volume><fpage>403</fpage><lpage>412</lpage><pub-id pub-id-type="doi">10.1007/BF00192575</pub-id><pub-id pub-id-type="pmid">2121965</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>M</given-names></name><name><surname>Xiong</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Dynamic flight stability of a hovering bumblebee</article-title><source>Journal of Experimental Biology</source><volume>208</volume><fpage>447</fpage><lpage>459</lpage><pub-id pub-id-type="doi">10.1242/jeb.01407</pub-id><pub-id pub-id-type="pmid">15671333</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szigeti</surname><given-names>B</given-names></name><name><surname>Deogade</surname><given-names>A</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Searching for motifs in the behaviour of larval Drosophila Melanogaster and Caenorhabditis elegans reveals continuity between behavioural states</article-title><source>Journal of the Royal Society Interface</source><volume>12</volume><elocation-id>20150899</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2015.0899</pub-id><pub-id pub-id-type="pmid">26609067</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>GK</given-names></name><name><surname>Thomas</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Dynamic flight stability in the desert locust Schistocerca gregaria</article-title><source>Journal of Experimental Biology</source><volume>206</volume><fpage>2803</fpage><lpage>2829</lpage><pub-id pub-id-type="doi">10.1242/jeb.00501</pub-id><pub-id pub-id-type="pmid">12847126</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tinbergen</surname><given-names>N</given-names></name></person-group><year iso-8601-date="1950">1950</year><article-title>The hierarchical organization of nervous mechanisms underlying instinctive behaviour</article-title><source>Symposia of the Society for Experimental Biology</source><volume>4</volume><fpage>305</fpage><lpage>312</lpage></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tinbergen</surname><given-names>N</given-names></name></person-group><year iso-8601-date="1963">1963</year><article-title>On aims and methods of ethology</article-title><source>Zeitschrift Für Tierpsychologie</source><volume>20</volume><fpage>410</fpage><lpage>433</lpage><pub-id pub-id-type="doi">10.1111/j.1439-0310.1963.tb01161.x</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Todorov</surname><given-names>E</given-names></name><name><surname>Jordan</surname><given-names>MI</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Optimal feedback control as a theory of motor coordination</article-title><source>Nature Neuroscience</source><volume>5</volume><fpage>1226</fpage><lpage>1235</lpage><pub-id pub-id-type="doi">10.1038/nn963</pub-id><pub-id pub-id-type="pmid">12404008</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tresch</surname><given-names>MC</given-names></name><name><surname>Jarc</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The case for and against muscle synergies</article-title><source>Current Opinion in Neurobiology</source><volume>19</volume><fpage>601</fpage><lpage>607</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2009.09.002</pub-id><pub-id pub-id-type="pmid">19828310</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Valero-Cuevas</surname><given-names>FJ</given-names></name><name><surname>Venkadesan</surname><given-names>M</given-names></name><name><surname>Todorov</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Structured variability of muscle activations supports the minimal intervention principle of motor control</article-title><source>Journal of Neurophysiology</source><volume>102</volume><fpage>59</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1152/jn.90324.2008</pub-id><pub-id pub-id-type="pmid">19369362</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vogelstein</surname><given-names>JT</given-names></name><name><surname>Park</surname><given-names>Y</given-names></name><name><surname>Ohyama</surname><given-names>T</given-names></name><name><surname>Kerr</surname><given-names>RA</given-names></name><name><surname>Truman</surname><given-names>JW</given-names></name><name><surname>Priebe</surname><given-names>CE</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Discovery of brainwide neural-behavioral maps via multiscale unsupervised structure learning</article-title><source>Science</source><volume>344</volume><fpage>386</fpage><lpage>392</lpage><pub-id pub-id-type="doi">10.1126/science.1250298</pub-id><pub-id pub-id-type="pmid">24674869</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Flight Performance and Visual Control of Flight of the Free-Flying Housefly (Musca Domestica L.) II. pursuit of targets</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>312</volume><fpage>553</fpage><lpage>579</lpage><pub-id pub-id-type="doi">10.1098/rstb.1986.0018</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Willows</surname><given-names>AO</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>Behavioral acts elicited by stimulation of single, identifiable brain cells</article-title><source>Science</source><volume>157</volume><fpage>570</fpage><lpage>574</lpage><pub-id pub-id-type="doi">10.1126/science.157.3788.570</pub-id><pub-id pub-id-type="pmid">6028923</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiltschko</surname><given-names>AB</given-names></name><name><surname>Johnson</surname><given-names>MJ</given-names></name><name><surname>Iurilli</surname><given-names>G</given-names></name><name><surname>Peterson</surname><given-names>RE</given-names></name><name><surname>Katon</surname><given-names>JM</given-names></name><name><surname>Pashkovski</surname><given-names>SL</given-names></name><name><surname>Abraira</surname><given-names>VE</given-names></name><name><surname>Adams</surname><given-names>RP</given-names></name><name><surname>Datta</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Mapping Sub-Second structure in mouse behavior</article-title><source>Neuron</source><volume>88</volume><fpage>1121</fpage><lpage>1135</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.11.031</pub-id><pub-id pub-id-type="pmid">26687221</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winter</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Kinematic and kinetic patterns in human gait: Variability and compensating effects</article-title><source>Human Movement Science</source><volume>3</volume><fpage>51</fpage><lpage>76</lpage><pub-id pub-id-type="doi">10.1016/0167-9457(84)90005-8</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>FW</given-names></name><name><surname>Rodan</surname><given-names>AR</given-names></name><name><surname>Tsai</surname><given-names>LT</given-names></name><name><surname>Heberlein</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>High-resolution analysis of ethanol-induced locomotor stimulation in Drosophila</article-title><source>Journal of Neuroscience</source><volume>22</volume><fpage>11035</fpage><lpage>11044</lpage><pub-id pub-id-type="pmid">12486199</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.26410.023</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing editor</role><aff><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for sending your work entitled &quot;Dynamic structure of locomotor behavior in walking fruit flies&quot; for consideration at <italic>eLife</italic>. Your article has been favorably evaluated by a Senior editor and three reviewers, one of whom, Ronald L Calabrese, is a member of our Board of Reviewing Editors.</p><p>The Reviewing editor and the other reviewer(s) discussed their comments before we reached this decision, and the Reviewing editor has assembled the following comments to help you prepare a revised submission.</p><p>In this manuscript the authors analyze an extensive data set of video recording of flies (<italic>Drosophila melanogaster</italic>) walking on flat surfaces. They analyze movements in 2 dimensions and ascertain three velocity components, translational, rotational, and side-slip. These data are then segmented and compared to a Markov model. They show that walking behavior exhibits two time scales, allowing movement dynamics to be segmented into distinct features. Bounds on velocity divergence define these elements. They conclude that over seconds, walking is a stochastic process composed of these elementary features. Within-feature divergence suggests that finite memory in stochastic behavioral sequences limits the effects of any one episode on subsequent behavior. The findings and methods are not only relevant to this important model system, but extend to other systems where analyses where a large number of behavioral sequences is recorded under normative and experimentally manipulated conditions.</p><p>Concerns:</p><p>The work is highly theoretical and very rigorous necessitating a high level of mathematical and theoretical by-in by the reader. There is a consensus that the authors should work to increase readability. All of the reviews taken together suggest that some rewriting will enhance the manuscript, and there are sufficient concrete suggestions in the original comments to guide such a revision.</p><p>Regarding finding &quot;humanly recognizable&quot; behavioral segments, as suggested by the first reviewer, it would be great if the authors could find a suitable example. On the other hand, if there are no such obvious examples of (or sequences of) modes that would have been picked up by visual inspection that in itself would be a significant finding worthy of mention, and we do not require an example. It is more important to tie sequences to particular computational principles.</p><p>There are several substantive primary and minor concerns in the reviews that the authors should address. Moreover, it seems important to address more squarely in the Discussion the issue of whether movement sequences are organized from primitive elements that act as attractors in the movement space.</p><p>Other issues to address:</p><p>Reviewer #1:</p><p>In this manuscript the authors analyze an extensive data set of video recording of flies (<italic>Drosophila melanogaster</italic>) walking on flat surfaces. They analyze movements in 2 dimensions and ascertain three velocity components, translational, rotational, and side-slip. These data are then segmented and compared to a Markov model. They show that walking behavior exhibits two time scales, allowing movement dynamics to be segmented into distinct features. Bounds on velocity divergence define these elements. They conclude that over seconds, walking is a stochastic process composed of these elementary features. Within-feature divergence suggests that finite memory in stochastic behavioral sequences limits the effects of any one episode on subsequent behavior.</p><p>Concerns:</p><p>The work is highly theoretical and very rigorous necessitating a high level of mathematical and theoretical by-in by the reader. This in itself is not bad but the authors make the paper needlessly inaccessible by failing to return to behavioral descriptions that are easily recognized and functionally meaningful. Only in paragraph four of subsection “Dynamic modes represent related submode groups, and extend behavior prediction” are we given any inkling of what humanly recognizable behavior corresponds to a mode and we are never given an example of a mode sequence in behavioral terms. The discussing is a letdown because, while it claims &quot;Practically, the discovery that this compact model can largely recapitulate the behavioral repertoire of walking flies using descriptions of movement that operate on separate time scales will enable future investigation of how behavior on each time scale interfaces with sensory stimuli and neural control.&quot; The authors do not specify how this might be done. This is beautiful analysis of behavior but it is so abstract that the general reader will not be able to take away the message about how behavior is organized as suggested by the analysis.</p><p>A major rewrite is needed to make the work more accessible to a general readership by tying the analysis step-by-step to recognizable behaviors and behavior sequences. I realize that part of the message is that there are dynamical structures in the behavior that do not map directly onto humanly described behaviors but the authors must try as much as possible to make the work more real to biologists. There is much to admire in this study but it needs to be made much more accessible for an <italic>eLife</italic> audience; on the other hand <italic>eLife</italic> should support good theory and analysis like this work.</p><p>Reviewer #2:</p><p>The authors present a statistical analysis of behavioral patterns in walking fruit flies. Using an ICA-based analysis they identify major modes which, when viewed as states in a Markovian model, describe walking dynamics well on the 10s ms – few sec timescales. The work leads to several interesting insights that are elegantly discussed in the manuscript. The findings are interesting and their implications to future studies of neural control of behavior are expected to be significant.</p><p>Substantive concerns:</p><p>1) Subsection “Unbiased segmentation of trajectories defines modal movement patterns”: the text is attempting to describe in words the construction of the dataset for the ICA analysis without explicitly using mathematical definitions. The full description is provided in the methods section, so this comment concerns style and readability and the authors may choose to keep the text as is. I found the necessity to jump back and forth between the methods, the text, and <xref ref-type="fig" rid="fig3">Figure 3</xref> to detract from the readability of this section. In my opinion, some mathematical definitions should appear in the main text and the caption of <xref ref-type="fig" rid="fig3">Figure 3</xref> should be more detailed (e.g., a definition of the sign/constant, &quot;c&quot;, is only given in the methods while it appears in the figure).</p><p>2) The authors should consider adding a page/box with the pseudocode of their various analysis steps. Having a compact, high-level, description of the logic guiding the analysis would be very convenient.</p><p>3) Making the analysis code available to researchers in the field would be useful (the comment on the availability of the datasets did not mention the analysis code).</p><p>Reviewer #3:</p><p>In the manuscript &quot;Dynamic structure of locomotor behavior in walking fruit flies&quot; the authors use the centroid and body-orientation velocity from richly sampled, two-dimensional trajectories of walking flies to quantitatively characterize fly movement. To the velocity time series, they apply an arsenal of computational techniques, including Principle Components Analysis, Independent Components Analysis, k-means clustering, hidden Markov modeling (HMM) and Markov modeling to argue that walking velocity dynamics can be broadly divided into two components; on short timescales (~100 ms), trajectories consist of relatively stereotyped bouts ultimately characterized as 5 discrete modes (<xref ref-type="fig" rid="fig6">Figure 6</xref>) while on longer timescales (~1s, about the correlation time of the velocity auto-correlation functions) the dynamics consists of transitions between modes. In support of this two-component perspective they show that the distribution of dwell times within each behavioral mode is approximately exponential with transitions to the next state mainly dependent on the current and previous state (a Markov model of order 1).</p><p>Overall, I found the manuscript and research very engaging and the problem of quantitively characterizing behavior is both topical and fundamental. However, while I believe that this work will ultimately add significantly to our understanding of natural behavior and it's analysis, the presentation needs to be substantially streamlined so as to be understandable to the widest possible audience. Perhaps most importantly is an issue of clarity. The manuscript is currently written as if to follow the analysis very much as it happens. While this can be pleasant and useful for an expert, I worry that most of the intended audience will lose track of the fundamental points. For example, the title of the first section, &quot;Behavior episodes are defined by bounded divergence&quot;, is complex and confusing. Within this section is first a finding that the &quot;phase space&quot; pair of the instantaneous velocity and acceleration (v,a) is not, by itself, a useful candidate for behavioral segmentation as the same pair is connected to multiple movement patterns. Thus the transition to looking at behavioral time traces centered on peaks in v_r. Why not just introduce the segmentation directly and then move the previous motivation to supplementary material where it won't distract from the main thrust? Indeed, I had the same feeling in the sections introducing the submode and mode sequences. There is a fundamental and primary computation here, which is how to characterize the space of velocity trajectories, sampled from short windows around peaks in v_r. But with modes and submodes and HMM's and MM's both the terminology and the story get quickly complicated.</p><p>Finally, throughout the manuscript I feel that the authors orbit obliquely around a general and fundamental question: what is the origin of complex, behavioral dynamics. In particular, and perhaps with human language as a metaphor, can complex behaviors be built from more primitive parts and, if so, what might those parts look like? Are these primitive elements attractors in the movement space? This is an appealing idea with some support in the literature. But in this system and analysis the authors argue &quot;no&quot; as attractors are uncommon in higher-dimensional spaces and their analysis suggests that trajectories represented by the primitives are unstable so that differences grow with time over the duration of the primitive. Instead, movements are &quot;stabilized&quot; by transitioning between primitives. If I've gotten that summary correct, then it needs to more clearly written and developed in the text.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for submitting your article &quot;Dynamic structure of locomotor behavior in walking fruit flies&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom, Ronald L Calabrese (Reviewer #1), is a member of our Board of Reviewing Editors and the evaluation has been overseen by Eve Marder as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: David Biron (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This is an interesting manuscript that describes a new unbiased method for behavioral segmentation of spontaneous locomotory behavior in fruit flies. After analyzing video images of ~1,000,000 behavioral trajectories in velocity phase space, the authors take time points before and after peaks in rotational velocity to identify movement trajectories. Because the dynamics of spontaneous locomotion are consistent over hundreds of milliseconds, elementary features can be defined. They align the trajectories by their rotational velocity peaks and use ICA to identify independent movement submodes, only some of which correspond to distinct behaviors recognized by human observers or machine classification. This underscores that behavior dynamics may be organized differently relative to behavior features salient to human observers, or machine classification that collapses time scales.</p><p>The submodes are then linked into modes by likelihood of sequential occurrence. A Markov model with five states is then generated that predicts movement sequences and where the five states correspond to modes comprising multiple submodes. Using this Markov model they then show that spontaneous locomotory behavior is well described by a stochastic process composed of these 5 modes. Within submodes, velocities diverge, suggesting that dynamical stability of movement submodes is a weak behavioral constraint. Rather, the effects of any one submode on subsequent behavior are limited by finite memory in a stochastic behavior sequence.</p><p>The paper is well written and the illustrations get the main data across adequately. All necessary data are presented. The experiments appear carefully analyzed and appropriate statistical methods are used. The modeling appears rigorous. The findings are novel and should be of interest to those studying how elemental motor behaviors are organized into overt behavior and behavioral sequences or who are interested in automatic methods for detecting elemental behaviors and their dynamic organization.</p><p>Essential revisions:</p><p>This submission is a bit unusual as it is a revised submission after a very prolonged hiatus. Thus this review is somewhat of a hybrid for a new submission and a revision.</p><p>The expert reviewers were in substantial agreement so that their major comments are appended to assist in revision. The authors should focus their revision on three major points.</p><p>1) The computer codes for all the modeling and analyses with appropriate documentation must be made available. <italic>eLife</italic> will assist in this process and makes Dryad available to authors.</p><p>2) A stronger attempt should be made to compare the work here to that of Berman et al., 2014, 2016 and to make explicit the implications of the difference in approach (posture vs. velocity). The expert reviews detail how this might be accomplished.</p><p>3) There is still some concern that the authors could do more to relate the submodes/modes they observe to humanly recognizable behaviors. Because it may be difficult to make convincing argument for biological relevance of behavioral features not salient to human observers and further there is no guarantee that the modes identified here will remain under different conditions (although more general features may well), the authors should also focus more on the issue of dynamic stability. Perhaps this does not come through strongly enough.</p><p>Reviewer #2:</p><p>This is a revised version of a manuscript originally submitted in 2014. The manuscript was originally favorably reviewed and it is still relevant, novel, rigorous, and engaging. The authors have responded comprehensively to the original review comments and the accessibility to a broader readership was improved.</p><p>As noted, Berman et al., 2016 is now published. The two manuscripts are complementary and may well become foundational. As things stand, fully appreciating the similarities and differences between them would require reading them side by side. The underlying reasons for the differences between the two can be subtle. Contrary to common instinct, these so-called 'discrepancies' should be put front and center. They are informative and relevant to pertinent questions in the field.</p><p>The authors' rebuttal contains a long discussion of these points. Disappointingly, the manuscript itself only hints at them in the 'Timescales in behavior&quot; Discussion section. In my opinion, the Discussion section should include a concise version of the 'Additional note' from the rebuttal. It would detail the comparison between these two sets of results and explicitly explain hypothesized reasons for differences.</p><p>Moreover, I would advocate a Table (or box) summarizing these points and their implications. Such a table would span the differences in experimental conditions that may affect physiology and experimental resolution, summarize implications of choosing posture vs. velocity, list hypothesized distinctions between locomotor and non-locomotor primitives, etc. It would be broadly useful to gain some appreciation of these subtleties and considerations at a glance.</p><p>Reviewer #3:</p><p>On the positive side:</p><p>This paper uses complex modeling techniques to segment locomotor behavior in a principled, unbiased manner.</p><p>It therefore has the potential to provide a useful approach for how the field analyzes and thinks about behavioral sequences in an unbiased way.</p><p>From previous work, there are a number of ways to segment and analyze <italic>Drosophila</italic> locomotion data, however, most depended on human-set definitions of behaviors. The most notable exception is the work from Berman et al., (2014 and 2016) in which behaviors were also characterized de novo. Of potential interest to experts in the field, the details and even some conclusions differ with the present study.</p><p>One potential advantage of this and other unbiased approaches is that it uncovers relations between behaviors that are not readily obvious to human observation.</p><p>Room for improvement:</p><p>Although equations are provided, the computer code is not (at least that I could find). This would need to be provided prior to publication, with clear documentation.</p><p>The ethological relevance of these behavioral submodes, modes, and sequences is not clear. The paper would be significantly more influential if a case could be made for why these modes help biologists understand specific behaviors. Currently, one is left with a very principled analysis that seems not well-grounded in biological reality.</p><p>A more direct comparison with previous data (e.g., the original ctrax paper comparing males and females) may help breathe some biological context into the modes and submodes defined here.</p><p>Finally, without a clearer biological application, the authors need to better justify why this approach is better than previous unbiased analyses of behavior. Although differences with Berman et al. are discussed, it is not clear if this approach is an improvement, or just a valid alternative.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.26410.024</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Concerns:</italic> </p><p><italic>The work is highly theoretical and very rigorous necessitating a high level of mathematical and theoretical by-in by the reader. There is a consensus that the authors should work to increase readability. All of the reviews taken together suggest that some rewriting will enhance the manuscript, and there are sufficient concrete suggestions in the original comments to guide such a revision.</italic></p><p>The manuscript has been revised from beginning to end. Figures have been improved, reorganized, and new figures and explanatory boxes were added. We believe that we have addressed every reviewer suggestion, and are grateful for the constructive feedback, which has significantly improved the manuscript.</p><p><italic>Regarding finding &quot;humanly recognizable&quot; behavioral segments, as suggested by the first reviewer, it would be great if the authors could find a suitable example. On the other hand, if there are no such obvious examples of (or sequences of) modes that would have been picked up by visual inspection that in itself would be a significant finding worthy of mention, and we do not require an example. It is more important to tie sequences to particular computational principles.</italic></p><p>We've added comparisons between this work's segmentation and humanly recognizable behaviors, in both the Results and Discussion sections. We've also revised <xref ref-type="fig" rid="fig4">Figure 4</xref> to illustrate humanly recognizable behaviors in individual modes and added two additional figures: Figure 3—figure supplement 2 to show samples of trajectories from each submode class, and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>) to show samples of mode sequences.</p><p><italic>There are several substantive primary and minor concerns in the reviews that the authors should address. Moreover, it seems important to address more squarely in the Discussion the issue of whether movement sequences are organized from primitive elements that act as attractors in the movement space.</italic></p><p>A Discussion section has been added (&quot;Mode structure and stability&quot;).</p><p><italic>Other issues to address:</italic></p><p><italic>Reviewer #1:</italic></p><p><italic>In this manuscript the authors analyze an extensive data set of video recording of flies (Drosophila melanogaster) walking on flat surfaces. They analyze movements in 2 dimensions and ascertain three velocity components, translational, rotational, and side-slip. These data are then segmented and compared to a Markov model. They show that walking behavior exhibits two time scales, allowing movement dynamics to be segmented into distinct features. Bounds on velocity divergence define these elements. They conclude that over seconds, walking is a stochastic process composed of these elementary features. Within-feature divergence suggests that finite memory in stochastic behavioral sequences limits the effects of any one episode on subsequent behavior.</italic></p><p><italic>Concerns:</italic></p><p><italic>The work is highly theoretical and very rigorous necessitating a high level of mathematical and theoretical by-in by the reader. This in itself is not bad but the authors make the paper needlessly inaccessible by failing to return to behavioral descriptions that are easily recognized and functionally meaningful. Only in paragraph four of subsection “Dynamic modes represent related submode groups, and extend behavior prediction” are we given any inkling of what humanly recognizable behavior corresponds to a mode and we are never given an example of a mode sequence in behavioral terms.</italic></p><p>We have now tied in behavior descriptions throughout the revised manuscript, and have provided examples of mode sequences</p><p><italic>The discussing is a letdown because, while it claims &quot;Practically, the discovery that this compact model can largely recapitulate the behavioral repertoire of walking flies using descriptions of movement that operate on separate time scales will enable future investigation of how behavior on each time scale interfaces with sensory stimuli and neural control.&quot; The authors do not specify how this might be done. This is beautiful analysis of behavior but it is so abstract that the general reader will not be able to take away the message about how behavior is organized as suggested by the analysis.</italic></p><p>The discussion has been extensively revised, adding concrete interpretations of our work throughout. Discussion of the interface between sensory stimuli and behavior structure was removed to more tightly focus discussion on the structure of behavior.</p><p><italic>A major rewrite is needed to make the work more accessible to a general readership by tying the analysis step-by-step to recognizable behaviors and behavior sequences. I realize that part of the message is that there are dynamical structures in the behavior that do not map directly onto humanly described behaviors but the authors must try as much as possible to make the work more real to biologists. There is much to admire in this study but it needs to be made much more accessible for an eLife audience; on the other hand eLife should support good theory and analysis like this work.</italic></p><p>The entire manuscript has been extensively re-written to improve accessibility.</p><p><italic>Reviewer #2:</italic></p><p><italic>Substantive concerns:</italic></p><p><italic>1) Subsection “Unbiased segmentation of trajectories defines modal movement patterns”: the text is attempting to describe in words the construction of the dataset for the ICA analysis without explicitly using mathematical definitions. The full description is provided in the methods section, so this comment concerns style and readability and the authors may choose to keep the text as is. I found the necessity to jump back and forth between the methods, the text, and <xref ref-type="fig" rid="fig3">Figure 3</xref> to detract from the readability of this section. In my opinion, some mathematical definitions should appear in the main text and the caption of <xref ref-type="fig" rid="fig3">Figure 3</xref> should be more detailed (e.g., a definition of the sign/constant, &quot;c&quot;, is only given in the methods while it appears in the figure).</italic></p><p>The legend of <xref ref-type="fig" rid="fig3">Figure 3</xref> has been expanded, and a new <xref ref-type="box" rid="B1">Box 1</xref> was added to consolidate a number of mathematical definitions inline with the main text.</p><p><italic>2) The authors should consider adding a page/box with the pseudocode of their various analysis steps. Having a compact, high-level, description of the logic guiding the analysis would be very convenient.</italic></p><p>A pseudocode box (<xref ref-type="box" rid="B2">Box 2</xref>) was added to describe all analysis steps.</p><p><italic>3) Making the analysis code available to researchers in the field would be useful (the comment on the availability of the datasets did not mention the analysis code).</italic></p><p>Analysis code is made available along with the datasets.</p><p><italic>Reviewer #3:</italic></p><p><italic>In the manuscript &quot;Dynamic structure of locomotor behavior in walking fruit flies&quot; the authors use the centroid and body-orientation velocity from richly sampled, two-dimensional trajectories of walking flies to quantitatively characterize fly movement. To the velocity time series, they apply an arsenal of computational techniques, including Principle Components Analysis, Independent Components Analysis, k-means clustering, hidden Markov modeling (HMM) and Markov modeling to argue that walking velocity dynamics can be broadly divided into two components; on short timescales (~100 ms), trajectories consist of relatively stereotyped bouts ultimately characterized as 5 discrete modes (<xref ref-type="fig" rid="fig6">Figure 6</xref>) while on longer timescales (~1s, about the correlation time of the velocity auto-correlation functions) the dynamics consists of transitions between modes. In support of this two-component perspective they show that the distribution of dwell times within each behavioral mode is approximately exponential with transitions to the next state mainly dependent on the current and previous state (a Markov model of order 1).</italic></p><p><italic>Overall, I found the manuscript and research very engaging and the problem of quantitively characterizing behavior is both topical and fundamental. However, while I believe that this work will ultimately add significantly to our understanding of natural behavior and it's analysis, the presentation needs to be substantially streamlined so as to be understandable to the widest possible audience. Perhaps most importantly is an issue of clarity. The manuscript is currently written as if to follow the analysis very much as it happens. While this can be pleasant and useful for an expert, I worry that most of the intended audience will lose track of the fundamental points. For example, the title of the first section, &quot;Behavior episodes are defined by bounded divergence&quot;, is complex and confusing. Within this section is first a finding that the &quot;phase space&quot; pair of the instantaneous velocity and acceleration (v,a) is not, by itself, a useful candidate for behavioral segmentation as the same pair is connected to multiple movement patterns. Thus the transition to looking at behavioral time traces centered on peaks in v_r. Why not just introduce the segmentation directly and then move the previous motivation to supplementary material where it won't distract from the main thrust? Indeed, I had the same feeling in the sections introducing the submode and mode sequences. There is a fundamental and primary computation here, which is how to characterize the space of velocity trajectories, sampled from short windows around peaks in v_r. But with modes and submodes and HMM's and MM's both the terminology and the story get quickly complicated.</italic></p><p>These points are both valid, and valuable. We have made a lot of effort to streamline the manuscript, and we hope the manuscript is now better integrated.</p><p>Specifically, the first Results section was revised to emphasize two important points: (<xref ref-type="bibr" rid="bib1">1</xref>) how time scales underlying the rest of the work were arrived at in a model-independent manner, and (<xref ref-type="bibr" rid="bib14">2</xref>) how behavior episodes, to which different models were applied in subsequent sections, were defined from an initial, model-independent analysis.</p><p>The section on submodes was revised to emphasize some properties of behaviour uncovered in the first stage of analysis. While subsequent analysis showed that different submodes can be statistically interchangeable within a mode, submodes are reported as a potentially distinct level of behavior organization.</p><p>The section on Markov models was revised to clarify both motivation and results. Analysis started from Hidden Markov models as a more general approach than Markov models. After obtaining results from HMM analysis, the more restrictive assumptions of Markov models were better justified for subsequent work. The text was streamlined to retain this basic point.</p><p><italic>Finally, throughout the manuscript I feel that the authors orbit obliquely around a general and fundamental question: what is the origin of complex, behavioral dynamics. In particular, and perhaps with human language as a metaphor, can complex behaviors be built from more primitive parts and, if so, what might those parts look like? Are these primitive elements attractors in the movement space? This is an appealing idea with some support in the literature. But in this system and analysis the authors argue &quot;no&quot; as attractors are uncommon in higher-dimensional spaces and their analysis suggests that trajectories represented by the primitives are unstable so that differences grow with time over the duration of the primitive. Instead, movements are &quot;stabilized&quot; by transitioning between primitives. If I've gotten that summary correct, then it needs to more clearly written and developed in the text.</italic></p><p>At the reviewer's suggestion, we developed discussion on the nature of primitive parts in behavior, and specifically the extent to which behavior elements can be described as attractors in movement space. Additional analysis was also performed to explore this point more concretely.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p><italic>Essential revisions:</italic></p><p> <italic>1) The computer codes for all the modeling and analyses with appropriate documentation must be made available. eLife will assist in this process and makes Dryad available to authors.</italic></p><p>Computer code has been deposited at Dryad, along with documentation, code parameter files, and datasets.</p><p> <italic>2) A stronger attempt should be made to compare the work here to that of Berman et al., 2014, 2016 and to make explicit the implications of the difference in approach (posture vs. velocity). The expert reviews detail how this might be accomplished.</italic></p><p>Two Discussion sections have been added to compare this work with Berman et al., 2014, 2016, and to make explicit the implications of different approaches to behavior segmentation.</p><p><italic>3) There is still some concern that the authors could do more to relate the submodes/modes they observe to humanly recognizable behaviors. Because it may be difficult to make convincing argument for biological relevance of behavioral features not salient to human observers and further there is no guarantee that the modes identified here will remain under different conditions (although more general features may well), the authors should also focus more on the issue of dynamic stability. Perhaps this does not come through strongly enough.</italic></p><p>Several sections throughout the manuscript have been re-written to emphasize biological relevance and issues pertaining to dynamic stability (Abstract, Introduction, Discussion). Also, to help relate segmented behaviors to humanly recognizable movements, illustrations have been added as suggested by reviewer 1.</p><p> <italic>Reviewer #2:</italic></p><p> <italic>This is a revised version of a manuscript originally submitted in 2014. The manuscript was originally favorably reviewed and it is still relevant, novel, rigorous, and engaging. The authors have responded comprehensively to the original review comments and the accessibility to a broader readership was improved.</italic></p><p> <italic>As noted, Berman et al., 2016 is now published. The two manuscripts are complementary and may well become foundational. As things stand, fully appreciating the similarities and differences between them would require reading them side by side. The underlying reasons for the differences between the two can be subtle. Contrary to common instinct, these so-called 'discrepancies' should be put front and center. They are informative and relevant to pertinent questions in the field.</italic></p><p> <italic>The authors' rebuttal contains a long discussion of these points. Disappointingly, the manuscript itself only hints at them in the 'Timescales in behavior&quot; Discussion section. In my opinion, the Discussion section should include a concise version of the 'Additional note' from the rebuttal. It would detail the comparison between these two sets of results and explicitly explain hypothesized reasons for differences.</italic></p><p>Two sections have been added to consider the implications of measurement type, experimental conditions, and other variables in studies of the structure of behavior dynamics. Each section contains concise comparisons with Berman et al., hypotheses about differences, and issues that can be clarified with further work.</p><p> <italic>Moreover, I would advocate a Table (or box) summarizing these points and their implications. Such a table would span the differences in experimental conditions that may affect physiology and experimental resolution, summarize implications of choosing posture vs. velocity, list hypothesized distinctions between locomotor and non-locomotor primitives, etc. It would be broadly useful to gain some appreciation of these subtleties and considerations at a glance.</italic></p><p>A table has been constructed listing specific differences between studies, but no simple way was found to present hypotheses in a table format. It is hoped that the discussion of differences is concise enough in the main text.</p><p> <italic>Reviewer #3:</italic></p><p> <italic>Room for improvement:</italic></p><p> <italic>Although equations are provided, the computer code is not (at least that I could find). This would need to be provided prior to publication, with clear documentation.</italic></p><p>Code with documentation is available at Dryad (DOI: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.854j2">http://dx.doi.org/10.5061/dryad.854j2</ext-link>). At the time of review, Dryad had two different submissions from us, one of which was associated with the previous (outdated) version of this manuscript. That version was missing code. It is now removed. We apologize for this.</p><p>Data and code are in the following categories:</p><p>1) Datasets containing all velocity trajectories and their annotation after segmentation</p><p>2) Matlab scripts and their parameter files, operating on velocity trajectories</p><p>a) to segment trajectories into submodes</p><p>b) to assign submodes to modes</p><p>3) Matlab scripts and their parameter files, operating on segmented trajectories</p><p>a) to perform match tests to compare real and synthetic trajectory distributions</p><p>b) to generate synthetic trajectories according to model</p><p> <italic>The ethological relevance of these behavioral submodes, modes, and sequences is not clear. The paper would be significantly more influential if a case could be made for why these modes help biologists understand specific behaviors. Currently, one is left with a very principled analysis that seems not well-grounded in biological reality.</italic></p><p>We have re-written parts of the text to emphasize the aims of this work. Its ultimate aim is to improve understanding of the organization of behavior, and in so doing to help constrain investigations of the neural circuits that control it. To bridge understanding of behavior with studies of neural circuits, progress needs to be made in understanding behaviors at different time scales. This is the goal of analyses begun in this work. As behaviors are examined using different approaches, including ours, it is hoped that the biological significance of both specific behaviors, and their relationships as a repertoire will be clarified.</p><p> <italic>A more direct comparison with previous data (e.g., the original ctrax paper comparing males and females) may help breathe some biological context into the modes and submodes defined here.</italic></p><p>We have expanded discussion of previous data, including the original ctrax paper.</p><p> <italic>Finally, without a clearer biological application, the authors need to better justify why this approach is better than previous unbiased analyses of behavior. Although differences with Berman et al. are discussed, it is not clear if this approach is an improvement, or just a valid alternative.</italic></p><p>We have now expanded discussion on differences between our approaches to data collection and analysis, and prior work. Our work contributes large datasets acquired at stable experimental conditions in which flies remain active for the duration of the experiment, methods for direct analysis of behavior dynamics, and preliminary findings on the structure of behavior under these experimental conditions. Ultimately, we expect that analysis of behavior and its control will benefit from an aggregate of different methods.</p></body></sub-article></article>