<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">10070</article-id><article-id pub-id-type="doi">10.7554/eLife.10070</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Developmental Biology</subject></subj-group></article-categories><title-group><article-title>Untwisting the <italic>Caenorhabditis elegans</italic> embryo</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-37984"><name><surname>Christensen</surname><given-names>Ryan Patrick</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-38371"><name><surname>Bokinsky</surname><given-names>Alexandra</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-38372"><name><surname>Santella</surname><given-names>Anthony</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-38373"><name><surname>Wu</surname><given-names>Yicong</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-38374"><name><surname>Marquina-Solis</surname><given-names>Javier</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-46026"><name><surname>Guo</surname><given-names>Min</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-38375"><name><surname>Kovacevic</surname><given-names>Ismar</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-38376"><name><surname>Kumar</surname><given-names>Abhishek</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-38377"><name><surname>Winter</surname><given-names>Peter W</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-38378"><name><surname>Tashakkori</surname><given-names>Nicole</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-38379"><name><surname>McCreedy</surname><given-names>Evan</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con11"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-46027"><name><surname>Liu</surname><given-names>Huafeng</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="par-3"/><xref ref-type="other" rid="par-4"/><xref ref-type="other" rid="par-5"/><xref ref-type="other" rid="par-6"/><xref ref-type="fn" rid="con12"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-38380"><name><surname>McAuliffe</surname><given-names>Matthew</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con13"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-38381"><name><surname>Mohler</surname><given-names>William</given-names></name><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="con14"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-1525"><name><surname>Colón-Ramos</surname><given-names>Daniel A</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="par-7"/><xref ref-type="other" rid="par-8"/><xref ref-type="other" rid="par-9"/><xref ref-type="fn" rid="con15"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-38382"><name><surname>Bao</surname><given-names>Zhirong</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="par-7"/><xref ref-type="other" rid="par-8"/><xref ref-type="other" rid="par-9"/><xref ref-type="fn" rid="con16"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-38383"><name><surname>Shroff</surname><given-names>Hari</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-7"/><xref ref-type="other" rid="par-8"/><xref ref-type="other" rid="par-9"/><xref ref-type="fn" rid="con17"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Section on High Resolution Optical Imaging, National Institute of Biomedical Imaging and Bioengineering</institution>, <institution>National Institutes of Health</institution>, <addr-line><named-content content-type="city">Bethesda</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Biomedical Imaging Research Services Section, Center for Information Technology</institution>, <institution>National Institutes of Health</institution>, <addr-line><named-content content-type="city">Bethesda</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Developmental Biology Program</institution>, <institution>Sloan-Kettering Institute</institution>, <addr-line><named-content content-type="city">New York</named-content></addr-line>, <country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Program in Cellular Neuroscience, Neurodegeneration and Repair, Department of Cell Biology</institution>, <institution>Yale University School of Medicine</institution>, <addr-line><named-content content-type="city">New Haven</named-content></addr-line>, <country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">State Key Laboratory of Modern Optical Instrumentation, College of Optical Science and Engineering</institution>, <institution>Zhejiang University</institution>, <addr-line><named-content content-type="city">Hangzhou</named-content></addr-line>, <country>China</country></aff><aff id="aff6"><label>6</label><institution content-type="dept">Department of Genetics and Developmental Biology</institution>, <institution>University of Connecticut Health Center</institution>, <addr-line><named-content content-type="city">Farmington</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Hobert</surname><given-names>Oliver</given-names></name><role>Reviewing editor</role><aff id="aff7"><institution>Columbia University</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>ryan.christensen@nih.gov</email></corresp><fn fn-type="con" id="equal-contrib"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>03</day><month>12</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e10070</elocation-id><history><date date-type="received"><day>14</day><month>07</month><year>2015</year></date><date date-type="accepted"><day>25</day><month>11</month><year>2015</year></date></history><permissions><license xlink:href="http://creativecommons.org/publicdomain/zero/1.0/"><license-p>This is an open-access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">Creative Commons CC0 public domain dedication</ext-link>.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-10070-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.10070.001</object-id><p>The nematode <italic>Caenorhabditis elegans</italic> possesses a simple embryonic nervous system with few enough neurons that the growth of each cell could be followed to provide a systems-level view of development. However, studies of single cell development have largely been conducted in fixed or pre-twitching live embryos, because of technical difficulties associated with embryo movement in late embryogenesis. We present open-source untwisting and annotation software (<ext-link ext-link-type="uri" xlink:href="http://mipav.cit.nih.gov/plugin_jws/mipav_worm_plugin.php">http://mipav.cit.nih.gov/plugin_jws/mipav_worm_plugin.php</ext-link>) that allows the investigation of neurodevelopmental events in late embryogenesis and apply it to track the 3D positions of seam cell nuclei, neurons, and neurites in multiple elongating embryos. We also provide a tutorial describing how to use the software (<xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>) and a detailed description of the untwisting algorithm (Appendix). The detailed positional information we obtained enabled us to develop a composite model showing movement of these cells and neurites in an 'average' worm embryo. The untwisting and cell tracking capabilities of our method provide a foundation on which to catalog <italic>C. elegans</italic> neurodevelopment, allowing interrogation of developmental events in previously inaccessible periods of embryogenesis.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.001">http://dx.doi.org/10.7554/eLife.10070.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.10070.002</object-id><title>eLife digest</title><p>Understanding how the brain and nervous system develops from a few cells into complex, interconnected networks is a key goal for neuroscientists. Although researchers have identified many of the genes involved in this process, how these work together to form an entire brain remains unknown.</p><p>A simple worm called <italic>Caenorhabiditis elegans</italic> is commonly used to study brain development because it has only about 300 neurons, simplifying the study of its nervous system. The worms are easy to grow in the laboratory and are transparent, allowing scientists to observe how living worms develop using a microscope. Researchers have learned a great deal about the initial growth of the nervous system in <italic>C. elegans</italic> embryos. However, it has been difficult to study the embryos once their muscles have formed because they constantly twist, fold, and move, making it hard to track the cells.</p><p>Now, Christensen, Bokinsky, Santella, Wu et al. have developed a computer program that allows scientists to virtually untwist the embryos and follow the development of the nervous system from its beginning to when the embryo hatches. First, images are taken of worm embryos that produce fluorescent proteins marking certain body parts. The program, with user input, labels the fluorescent cells in the images, which indicates how the embryo is bending and allows the program to straighten the worm. The program can also track how cells move around the embryo during development and show the positional relationships between different cells at different stages of development.</p><p>Christensen et al. have made the program freely available for other researchers to use. The next step is to increase automation, making the software faster and more straightforward for users. Ultimately, the software could help in the challenge to comprehensively examine the development of each neuron in the worm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.002">http://dx.doi.org/10.7554/eLife.10070.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>light sheet microscopy</kwd><kwd>embryonic neurodevelopment</kwd><kwd>computational biology</kwd><kwd>systems biology</kwd><kwd><italic>C</italic>.<italic>elegans</italic> embryo untwisting</kwd><kwd>embryonic morphogenesis</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd><italic>C. elegans</italic></kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000070</institution-id><institution>National Institute of Biomedical Imaging and Bioengineering</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Christensen</surname><given-names>Ryan Patrick</given-names></name><name><surname>Wu</surname><given-names>Yicong</given-names></name><name><surname>Winter</surname><given-names>Peter W</given-names></name><name><surname>Shroff</surname><given-names>Hari</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000093</institution-id><institution>Center for Information Technology</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Bokinsky</surname><given-names>Alexandra</given-names></name><name><surname>McCreedy</surname><given-names>Evan</given-names></name><name><surname>McAuliffe</surname><given-names>Matthew</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id><institution>National Natural Science Foundation of China</institution></institution-wrap></funding-source><award-id>61427807</award-id><principal-award-recipient><name><surname>Liu</surname><given-names>Huafeng</given-names></name></principal-award-recipient></award-group><award-group id="par-4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id><institution>National Natural Science Foundation of China</institution></institution-wrap></funding-source><award-id>61271083</award-id><principal-award-recipient><name><surname>Liu</surname><given-names>Huafeng</given-names></name></principal-award-recipient></award-group><award-group id="par-5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id><institution>National Natural Science Foundation of China</institution></institution-wrap></funding-source><award-id>61525106</award-id><principal-award-recipient><name><surname>Liu</surname><given-names>Huafeng</given-names></name></principal-award-recipient></award-group><award-group id="par-6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004731</institution-id><institution>Natural Science Foundation of Zhejiang Province</institution></institution-wrap></funding-source><award-id>LR12F03001</award-id><principal-award-recipient><name><surname>Liu</surname><given-names>Huafeng</given-names></name></principal-award-recipient></award-group><award-group id="par-7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100006049</institution-id><institution>Marine Biological Laboratory</institution></institution-wrap></funding-source><award-id>Whitman Research Award</award-id><principal-award-recipient><name><surname>Colón-Ramos</surname><given-names>Daniel A</given-names></name><name><surname>Bao</surname><given-names>Zhirong</given-names></name><name><surname>Shroff</surname><given-names>Hari</given-names></name></principal-award-recipient></award-group><award-group id="par-8"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>UO1 HD075602</award-id><principal-award-recipient><name><surname>Colón-Ramos</surname><given-names>Daniel A</given-names></name><name><surname>Bao</surname><given-names>Zhirong</given-names></name><name><surname>Shroff</surname><given-names>Hari</given-names></name></principal-award-recipient></award-group><award-group id="par-9"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R24OD016474</award-id><principal-award-recipient><name><surname>Colón-Ramos</surname><given-names>Daniel A</given-names></name><name><surname>Bao</surname><given-names>Zhirong</given-names></name><name><surname>Shroff</surname><given-names>Hari</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Open-source software can untwist images of live <italic>Caenorhabditis elegans</italic> embryos, allowing epidermal and neuronal cell position and morphology to be examined in previously inaccessible developmental time periods.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Understanding how complex neural circuits and entire nervous systems form is one of the fundamental goals of neuroscience. While substantial progress has been made in identifying guidance factors in neurodevelopment (<xref ref-type="bibr" rid="bib22">Kolodkin and Tessier-Lavigne, 2011</xref>; <xref ref-type="bibr" rid="bib12">Dudanova and Klein, 2013</xref>; <xref ref-type="bibr" rid="bib7">Chilton, 2006</xref>; <xref ref-type="bibr" rid="bib30">O'Donnell et al., 2009</xref>), how known factors interact to direct the formation of complex neural circuits remains mysterious (<xref ref-type="bibr" rid="bib12">Dudanova and Klein, 2013</xref>). Examining the entirety of neurodevelopment in intact, living samples would be useful in understanding larger scale principles that orchestrate nervous system formation. Unfortunately, technological limitations and inherent nervous system complexity have hindered our ability to capture a 'systems-level' view of the developing brain.</p><p>One model organism well-suited to systems-level neuroscience research is <italic>Caenorhabditis elegans</italic>, which possesses a simple nervous system comprising 302 neurons (<xref ref-type="bibr" rid="bib41">White et al., 1986</xref>), 222 of which form during embryogenesis (<xref ref-type="bibr" rid="bib36">Sulston et al., 1983</xref>). The adult connectome has been reconstructed, and the morphology of all adult neurons has been mapped at electron-microscopy resolution (<xref ref-type="bibr" rid="bib41">White et al., 1986</xref>); the genome sequenced (<xref ref-type="bibr" rid="bib6"><italic>C. elegans</italic> Sequence Consortium, 1998</xref>); and the organism is genetically tractable and transparent at all life stages, enabling investigation with light microscopy. The simplicity of the <italic>C. elegans</italic> nervous system, its experimental accessibility, and the extensive knowledge base make it a promising candidate for following the development of all neurons in the embryo, and eventually understanding associated molecular mechanisms. The resulting 'neurodevelopmental atlas' would represent the first view of how an entire nervous system forms.</p><p>Despite the potential of the nematode as a model, imaging neurodevelopment (<xref ref-type="bibr" rid="bib43">Wu et al., 2013a</xref>) throughout embryogenesis is challenging due to embryonic sensitivity to photodamage and photobleaching, limiting imaging to several hours on most systems; the need for subcellular spatial resolution due to the small size of the embryo; and motion blur caused by rapid embryo movement after muscular twitching begins. Once images are captured, data analysis poses new problems: while it would be easy to assemble an atlas of neuronal positions and morphology if all cells were easily identifiable in one animal, techniques that allow imaging with single-cell contrast (such as Brainbow [<xref ref-type="bibr" rid="bib26">Livet et al., 2007</xref>]) are unavailable in the nematode. Currently, any attempt to build a neurodevelopmental atlas would require imaging small numbers of non-overlapping, easily distinguishable neurons, and finding methods to combine the data from multiple embryos into a composite whole. To our knowledge, comprehensive solutions to these problems do not yet exist.</p><p>Recent advances in light-sheet fluorescence microscopy (LSFM [<xref ref-type="bibr" rid="bib35">Santi, 2011</xref>]) have solved many of the imaging problems outlined above. LSFM sweeps a thin sheet of light through the sample, relying on perpendicular detection of fluorescence. This geometry allows far more rapid imaging and reduced phototoxicity relative to confocal microscopy (<xref ref-type="bibr" rid="bib18">Huisken et al., 2004</xref>; <xref ref-type="bibr" rid="bib17">Holekamp et al., 2008</xref>), enabling the use of LSFM in a variety of transformative applications. These include recording whole-brain calcium signaling in larval zebrafish (<xref ref-type="bibr" rid="bib1">Ahrens et al., 2013</xref>; <xref ref-type="bibr" rid="bib19">Ito, 2013</xref>), and imaging (<xref ref-type="bibr" rid="bib44">Wu et al., 2011</xref>; <xref ref-type="bibr" rid="bib20">Keller et al., 2008</xref>) and tracking (<xref ref-type="bibr" rid="bib2">Amat et al., 2014</xref>; <xref ref-type="bibr" rid="bib4">Bao, 2006</xref>; <xref ref-type="bibr" rid="bib34">Santella et al., 2010</xref>) large numbers of cells in developing embryos. Multiple LSFM implementations now obviate the problems of motion blur and photo damage in worm embryos (<xref ref-type="bibr" rid="bib44">Wu et al., 2011</xref>; <xref ref-type="bibr" rid="bib43">Wu et al., 2013</xref>; <xref ref-type="bibr" rid="bib24">Kumar et al., 2014</xref>; <xref ref-type="bibr" rid="bib23">2015</xref>), and also offer sufficient spatiotemporal resolution (sub-μm in all three spatial dimensions, sub-second volumetric imaging [<xref ref-type="bibr" rid="bib43">Wu et al., 2013</xref>; <xref ref-type="bibr" rid="bib24">Kumar et al., 2014</xref>]) that subcellular morphology may be observed over the entire 14-hour period of embryogenesis. Despite these advances, morphological changes still pose problems when trying to follow individual cells, or when combining data from multiple embryos.</p><p>To address these problems, we have generated a nematode strain that expresses fluorescent markers within specific cells, and designed software that uses these markers to computationally 'untwist' the embryo, resulting in straightened volumes that significantly ease the tracking of developmental events in later embryonic stages (described briefly in a preliminary conference proceeding [<xref ref-type="bibr" rid="bib9">Christensen, 2015</xref>]). Our open-source software is based on the NIH’s Medical Image Processing, Analysis, and Visualization (MIPAV [<xref ref-type="bibr" rid="bib28">McAuliffe, 2001</xref>; <xref ref-type="bibr" rid="bib15">Haak et al., 2015</xref>]) platform, implemented as a standalone plugin (<ext-link ext-link-type="uri" xlink:href="http://mipav.cit.nih.gov/plugin_jws/mipav_worm_plugin.php">http://mipav.cit.nih.gov/plugin_jws/mipav_worm_plugin.php</ext-link>). Computational untwisting algorithms have previously been used to straighten images of L1 larval worms for use in tracking nuclear position (<xref ref-type="bibr" rid="bib31">Peng et al., 2008</xref>; <xref ref-type="bibr" rid="bib27">Long et al., 2009</xref>) in both two and three dimensions, but to our knowledge, these algorithms are not suitable for the nematode embryo. In addition to the untwisting capability, our plugin includes the ability to annotate and track 3D positions over time, allowing semi-automated quantification of cell and neurite positions in twisted (and untwisted) embryos. The positional data so derived also facilitate comparison and combination of information from multiple embryos, allowing us to create a composite model of development.</p><p>We demonstrate the capabilities of our method by computationally untwisting eight nematode embryos; tracking the position of seam cell nuclei, the canal-associated neuron (CAN), ALA, and AIY neuron cell bodies, and the growing neurites of the ALA neuron in the untwisted reference frame; and combining the data from multiple embryos to model the time-evolution of all these elements within the elongating embryo. We find that seam cell nuclear positions are highly stereotyped across different embryos, while the rate of elongation varies according to position along the embryo. Of the neurons we examined, ALA and AIY move in concert with neighboring seam cell nuclei, suggesting they are passively 'dragged' with the rest of the elongating worm embryo, while the CAN neurons actively migrate at a faster rate than the surrounding seam cell nuclei. Tracking ALA neurites reveals that anterior-posterior neurite outgrowth starts toward the end of elongation and continues after cells reach their final positions. Our method is the first to track cell positions in the context of the entire embryo, from the beginning of twitching until hatching. We anticipate that our software will significantly further the ability to examine <italic>C. elegans</italic> development in the post-twitching regime and lay a foundation for understanding the formation of the <italic>C. elegans</italic> nervous system.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>In order to computationally straighten an embryo, an essential first step is defining limits of the growing worm body, thus specifying how the embryo folds inside the eggshell. Nematode embryos undergo both bending and helical twisting around the nose-to-tail axis (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>) posing challenges in untwisting the embryo relative to larval or adult nematodes. Our approach uses fluorescent markers driven by cell-specific promoters to define the boundaries of the worm body. We use a seam cell marker (<italic>SCM::GFP</italic>) to label the 20–22 seam cell nuclei, identifying the left and right sides of the worm; and a <italic>dlg-1::GFP</italic> fusion protein to label apical gut junctions and hypodermal junctions, revealing the locations of the anterior tip of the pharynx (hereafter referred to as the nose), tail, midline, and hypodermal cell boundaries (<xref ref-type="fig" rid="fig1">Figure 1A,B</xref>). This combination of markers allows automated segmentation of seam cells and manual identification of the nose, tail, and sides of the worm, thus enabling us to model the twisted, bent embryo within the eggshell, and serving as a basis for computationally untwisting the worm (<xref ref-type="fig" rid="fig1">Figure 1C</xref>).<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.003</object-id><label>Figure 1.</label><caption><title>Key steps in worm untwisting.</title><p>(<bold>A</bold>) An image of a threefold embryo in the twisted state, showing the untwisting markers. (<bold>B</bold>) The same image as in (<bold>A</bold>) with the untwisting markers labeled. Asterisks mark seam cell nuclei, and the dashed line indicates the midline marker. (<bold>C</bold>) The same embryo as in (<bold>A</bold>, <bold>B</bold>), after untwisting. Asterisks and dashed line as in <bold>B</bold>. (<bold>D–F</bold>) Further detail lattice creation and splines that model embryo. (<bold>D</bold>) Left: same embryo volume as in (<bold>A</bold>). Right: accompanying schematic showing the seam cell nuclei in the twisted embryo (black circles) and midline (interior black line). (<bold>E</bold>) Lattice creation. As diagrammed in right schematic, parts (1) and (2), the user adds points to create a lattice (blue and yellow lines). After the lattice is built, the algorithm generates splines defining the edges of the worm (orange and purple lines) automatically. The midline is also defined with a spline (red line at left). (<bold>F</bold>) The embryo volume and accompanying schematic showing a completed lattice and model. (<bold>G</bold>) The embryo volume and accompanying schematic after untwisting. All scale bars: 10 μm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.003">http://dx.doi.org/10.7554/eLife.10070.003</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig1-v2"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Helical twisting in the nematode embryo.</title><p>(<bold>A</bold>) Evidence for helical twisting, highlighted on four pairs of consecutive seam cell nuclei. If no helical twisting occurs, yellow lines (connecting seam cell nucleus pairs) should appear parallel to each other when sighting down the midline of the worm (red line). If helical twisting is present, yellow lines should appear to twist about the midline. Arrows denote the direction of lines for four pairs of consecutive seam cell nuclei: note obvious and apparent angular twist between pairs 1 and 4. (<bold>B</bold>) Side view showing same data as in (<bold>A</bold>). As before, nuclei pairs 1 and 4 appear in close to perpendicular orientation to each other, despite the roughly parallel midline. Scale bar: 10 μm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.004">http://dx.doi.org/10.7554/eLife.10070.004</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig1-figsupp1-v2"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.005</object-id><label>Figure 1—figure supplement 2.</label><caption><title>DiSPIM is useful in identifying landmarks in the twisted embryo.</title><p>Coarse features such as seam cell nuclei are visible in single view iSPIM (<bold>A</bold>), but finer features such as junctions between hypodermal cells labeled with DLG-1::GFP are better resolved in the diSPIM (<bold>B</bold>), particularly in the axial direction (lower row). Scale bar: 10 μm. diSPIM, dual-view Selective Plane Illumination Microscopy; iSPIM, inverted Selective Plane Illumination Microscopy.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.005">http://dx.doi.org/10.7554/eLife.10070.005</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig1-figsupp2-v2"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.006</object-id><label>Figure 1—figure supplement 3.</label><caption><title>Effects of lattice point number on untwisting results.</title><p>(<bold>A</bold>) XZ and YZ views of an untwisted worm embryo using a lattice comprised of every other seam cell nucleus, a total of 12 points. This lattice fails to capture bends in the animal and does not create smooth left and right edges in the untwisted worm embryo. (<bold>B</bold>) Same as (<bold>A</bold>) but using a lattice built with all seam cell nuclei and the nose, a total of 22 points. This lattice still fails to capture some bends in the worm, and the extension of the tail. (<bold>C</bold>) Same as (<bold>A</bold>) but using a lattice built with all seam cell nuclei as well as additional points in highly bent regions in the worm embryo, plus a pair of points marking the tail, for a total of 28 points. Bends are accurately captured in the resulting untwisted volume. (<bold>D</bold>) Several additional lattice points were added to the lattice in (<bold>C</bold>), along the edges of the animal, for a total of 36 points. No noticeable improvements are apparent. Scale bar: 10 μm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.006">http://dx.doi.org/10.7554/eLife.10070.006</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig1-figsupp3-v2"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.007</object-id><label>Figure 1—figure supplement 4.</label><caption><title>Untwisting a larval nematode.</title><p>(<bold>A</bold>) The twisted L2 larval volume displayed in the MIPAV volume renderer. (<bold>B</bold>) The twisted L2 larva after lattice-building. (<bold>C</bold>) The L2 larval worm after untwisting. See also <xref ref-type="other" rid="media7">Video 7</xref>. MIPAV, Medical Image Processing, Analysis, and Visualization</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.007">http://dx.doi.org/10.7554/eLife.10070.007</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig1-figsupp4-v2"/></fig></fig-group></p><p>We used a dual-view selective plane illumination microscopy (diSPIM) implementation of LSFM to capture images of developing embryos (<xref ref-type="bibr" rid="bib43">Wu et al., 2013</xref>; <xref ref-type="bibr" rid="bib24">Kumar et al., 2014</xref>). The diSPIM was chosen due to the combination of high-imaging speed and isotropic resolution that it provides, making the identification of cells and cellular structures in a twisted-up embryo significantly easier than with lower resolution alternatives (such as single-view light-sheet microscopy, <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). After images are acquired in the diSPIM, registered, and deconvolved, a user begins untwisting by downloading and running our software (<ext-link ext-link-type="uri" xlink:href="http://mipav.cit.nih.gov/plugin_jws/mipav_worm_plugin.php">http://mipav.cit.nih.gov/plugin_jws/mipav_worm_plugin.php</ext-link>, <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>).</p><p>First, seam cell nuclei are automatically detected, segmented, and paired to create candidate lattices. Seam cell segmentation and lattice-building are manually verified by a user, who can also incorporate additional information derived from pharyngeal and hypodermal markers, which are difficult to automatically segment (<xref ref-type="fig" rid="fig1">Figure 1D,E</xref>). Several possible lattices are generated, and the five most likely to be correct are displayed to the user for selection and editing of the correct lattice. The resulting lattice is used to generate a 3D model of the worm volume (<xref ref-type="fig" rid="fig1">Figure 1F</xref>, <xref ref-type="other" rid="media1">Video 1</xref>). In cases where automated lattice-building fails, lattices can be built manually by marking the positions of seam cell nuclei, nose, bends in the embryo, and tail. When manually building lattices, minimally 22 +2B lattice points are recommended (22 is the number of lattice points corresponding to seam cell nuclei, plus a pair of points to mark the nose, and B is the number of bends between seam cell nuclei in the embryo). Fewer lattice points than the number of seam cell nuclei gives unphysical, short volumes, and more than ~32 points does not noticeably improve quality in the untwisted volumes (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>).<media content-type="glencoe play-in-place height-250 width-310" id="media1" mime-subtype="mp4" mimetype="video" xlink:href="elife-10070-media1.mp4"><object-id pub-id-type="doi">10.7554/eLife.10070.008</object-id><label>Video 1.</label><caption><title>Sequential steps used in the automated lattice-building plugin.</title><p>This animation provides a graphical representation of the computational steps used to segment seam cells, build a lattice, and straighten embryo volumes. For additional information refer to <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref> and Appendix.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.008">http://dx.doi.org/10.7554/eLife.10070.008</ext-link></p></caption></media></p><p>The first step in creating the 3D model is to generate curves defining the center and sides of the worm. The centerline curve is uniformly sampled to generate a series of planes extending along and normal to the curve, while avoiding overlap within the model. This series of restricted planes comprises the worm model and is updated as new lattice points are added. To generate a straightened volume, the voxels in the original image that intersect with the sampling planes in the worm model are captured, and the sampling planes and associated voxels are concatenated in the head-to-tail direction to generate a straightened volume (<xref ref-type="fig" rid="fig1">Figure 1G</xref>, <xref ref-type="other" rid="media1">Video 1</xref>). The same process can be used to straighten images of older animals (such as L2 larvae, <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). More details are provided in <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref> and Appendix.</p><p>In addition to untwisting, it is also useful to obtain the 3D position of a cell or point of interest within the nematode embryo. Thus, our software also includes an annotation capability, allowing a user to define points within the embryo for which they would like to obtain 3D coordinates both before and after untwisting (<xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>). The user adds annotations similarly to lattice points, marking the volume location where the desired point should appear. The user must also add an origin point from which the relative 3D position of all other points is calculated from. As pharyngeal labeling is consistent and bright in most diSPIM volumes, we use the nose as a standard origin in all datasets described in the paper. Once the origin and annotation points have been defined, the user can untwist the worm and obtain the 3D coordinates of each annotation point in a spreadsheet file.</p><p>In order to ensure that our algorithm did not alter the distance between portions of the embryo during the untwisting process, we compared the apparent 3D distance between, or along, landmark features within twisted and untwisted embryo volumes (embryos 1–6, <xref ref-type="fig" rid="fig2">Figure 2</xref>). First, we determined the distances between nuclei in seam cell pairs (<xref ref-type="fig" rid="fig2">Figure 2A,B</xref>). If untwisting did not effect morphology, we reasoned that these distance should be conserved regardless of whether the embryo is twisted or untwisted. We measured the difference between pair distance in twisted- and untwisted datasets at every fifth or tenth time point for both the first (H0) and last (T) pairs of seam cells in six different embryos, reasoning that the difference should be close to 0. The apparent untwisted distance between seam cell pairs H0 and T closely mirrored the values in the twisted worm, with the population average difference across timepoints and embryos (&lt;μ<sub>Difference, time</sub>&gt;<sub>embryo</sub> ± population standard deviation &lt;σ<sub>Difference, time</sub>&gt;<sub>embryo</sub>) for H0 0.4 µm ± 0.3 µm, and for T 0.3 ± 0.2 µm (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, <xref ref-type="supplementary-material" rid="SD5-data">Supplementary file 5</xref>, Materials and methods). The largest difference at any individual timepoint between twisted and untwisted values was 1.7 µm for H0 and 1.2 µm for T.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.009</object-id><label>Figure 2.</label><caption><title>The untwisting algorithm accurately preserves embryo dimensions.</title><p>Distances between seam cell nuclei (left) and pharyngeal lengths (right) were compared in twisted (<bold>A</bold>) and untwisted (<bold>B</bold>) worm embryos. All scalebars: 10 µm. (<bold>C</bold>) Comparative 3D distance measurements of seam cell nuclei pairs H0 and T (left graphs) and pharyngeal lengths (right graphs) for one representative embryo (a comparison across six different embryos is presented in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). In all cases, distance measurements in the twisted case are within 5 μm of distance measurements in the untwisted case.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.009">http://dx.doi.org/10.7554/eLife.10070.009</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig2-v2"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.010</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Untwisting does not systematically alter worm morphology</title><p>Comparative 3D distance measurements of seam cell nuclei pairs H0 and T (left graphs) and pharyngeal lengths (right graphs) for six embryos. In all cases, distance measurements in the twisted case are within 10 μm of distance measurements in the untwisted case. <xref ref-type="other" rid="media1"/></p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.010">http://dx.doi.org/10.7554/eLife.10070.010</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig2-figsupp1-v2"/></fig></fig-group></p><p>Since the model of the twisted embryo is based on positional coordinates of the seam cell nuclei, we would expect these paired distances in twisted- and untwisted embryos to agree. For a more stringent control, we also assessed the apparent distance between nose and the pharynx-gut transition (effectively the pharyngeal contour length) in twisted and untwisted embryos (<xref ref-type="fig" rid="fig2">Figure 2A,B</xref>). Although the pharynx is not used as a landmark for defining the worm model used in untwisting, we still expect its contour length to be conserved despite untwisting. Here, too, we measured a close correspondence (typically less than 5% of the total pharyngeal length). The population &lt;μ<sub>Difference, time</sub>&gt;<sub>embryo</sub> ± &lt;σ<sub>Difference, time</sub>&gt;<sub>embryo</sub> between twisted and untwisted pharyngeal lengths was 2.5 µm ± 1.6 µm (with the maximum difference between the untwisted and twisted values for any individual timepoint being 8.8 µm, <xref ref-type="fig" rid="fig2">Figure 2C</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). We conclude that our untwisting procedure accurately captures distances present in the twisted embryo.</p><p>The combination of untwisting and annotation capabilities we developed allows the analysis of overall morphological changes in a developing embryo and the precise tracking of positions for individual cells or subcellular structures. We first examined overall morphological changes in the nematode embryo. Embryos lengthened (from 86 ± 5 µm at early 1.5-fold, measured from the nose to the tail, to 162 ± 19 µm within the last 30 min before hatching, measured from the nose to the last pair of seam cells, mean ± standard deviation [SD], 5 embryos) and narrowed in width (measured diameter across the widest cross-section 22 ± 1 µm at early timepoints, and 16 ± 1 µm at late timepoints, mean ± SD, 5 embryos) as they progressed from comma stage to late-3 fold (<xref ref-type="fig" rid="fig3">Figure 3A–H</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>; <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>; <xref ref-type="other" rid="media2">Video 2</xref>). We used our software to manually annotate and extract the positional trajectories of seam cell nuclei during this time period, as they moved relative to the nose of the animal (<xref ref-type="fig" rid="fig3">Figure 3J–3L</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). We note that seam cell V5 divides late in the threefold embryo into Q and V5 daughters; in such cases, we tracked the anteriormost daughter, Q, and thus refer to V5 as Q/V5 in our paper. The motion of seam cell nuclei followed relatively simple trends that were easily evident, despite the noise present in the raw untwisted trajectories. During elongation, seam cell nuclei moved laterally (‘X’ motion, <xref ref-type="fig" rid="fig3">Figure 3J</xref>) towards the midline, while maintaining a relatively fixed dorso-ventral position (‘Y’ motion, <xref ref-type="fig" rid="fig3">Figure 3K</xref>). Along the axial, head-to-tail axis, the displacement of seam cell nuclei was biphasic, showing a fast, approximately linear dependence on time, followed by a slower plateau (‘Z’ motion, <xref ref-type="fig" rid="fig3">Figure 3L</xref>) (<xref ref-type="bibr" rid="bib32">Priess and Hirsh, 1986</xref>; <xref ref-type="bibr" rid="bib8">Chin-Sang and Chisholm, 2000</xref>; <xref ref-type="bibr" rid="bib11">Ding et al., 2004</xref>; <xref ref-type="bibr" rid="bib29">Norman and Moerman, 2002</xref>). While embryo elongation has been examined before (<xref ref-type="bibr" rid="bib32">Priess and Hirsh, 1986</xref>), our method is the first that allows 3D interrogation of whole, live, untwisted nematodes at arbitrary timepoints in embryogenesis (<xref ref-type="fig" rid="fig3">Figure 3</xref>, <xref ref-type="other" rid="media2">Video 2</xref>).<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.011</object-id><label>Figure 3.</label><caption><title>Morphological changes in embryonic development, as unveiled by untwisting algorithm.</title><p>Selected volumetric timepoints pre (<bold>A–D</bold>) and post (<bold>E–H</bold>) untwisting, with canonical state of embryo indicated at bottom. See also <xref ref-type="other" rid="media2">Video 2</xref>. (<bold>I</bold>) Cartoon of untwisted embryo, indicating coordinate system. (<bold>J–L</bold>) X, Y, and Z movements of circled seam cell nucleus in (<bold>I</bold>). Measurements are indicated relative to the animal’s nose, fixed as the origin in all untwisted datasets. All scalebars: 10 μm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.011">http://dx.doi.org/10.7554/eLife.10070.011</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig3-v2"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.012</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Comparison of untwisted 1.5-fold embryos after shifting.</title><p>Comparative timepoints were selected based on the H1R seam cell shifts. Max projections of volumetric images are shown. Note the underlying similarity in overall shape across animals. Scalebar: 5 μm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.012">http://dx.doi.org/10.7554/eLife.10070.012</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig3-figsupp1-v2"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.013</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Comparison of threefold embryos after shifting.</title><p>Comparative timepoints were selected based on the H1R seam cell shifts. Max projections of volumetric images are shown. Note the underlying similarity in overall shape and seam cell positions across animals. Scalebar: 5 μm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.013">http://dx.doi.org/10.7554/eLife.10070.013</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig3-figsupp2-v2"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.014</object-id><label>Figure 3—figure supplement 3.</label><caption><title>Data Post-processing.</title><p>Before fitting, raw data are treated to remove obvious outliers (top row) and to fill in missing data (mid, bottom rows). In both cases, outliers and ‘gaps’ within data are found manually, and replaced by averaging the data points immediately preceding or following the outlier or gap. Examples of raw data prior to this linear interpolation are shown at left, and examples of processed data at right. The example axial distance data shown here are derived from seam cell 3. Red arrows indicate outliers or gaps. Data shown are from the left H2 seam cell nucleus.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.014">http://dx.doi.org/10.7554/eLife.10070.014</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig3-figsupp3-v2"/></fig></fig-group><media content-type="glencoe play-in-place height-250 width-310" id="media2" mime-subtype="mp4" mimetype="video" xlink:href="elife-10070-media2.mp4"><object-id pub-id-type="doi">10.7554/eLife.10070.015</object-id><label>Video 2.</label><caption><title>Raw data showing an untwisted worm developing from the 1.5-fold stage until hatching.</title><p>Despite errors in individual untwisted volumes, the overall pattern of embryonic development and elongation is clear.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.015">http://dx.doi.org/10.7554/eLife.10070.015</ext-link></p></caption></media></p><p>The strong qualitative similarities in seam cell nuclear trajectories among the five embryos we inspected led us to investigate whether data from different embryos could be combined to yield a composite model of development representing growth in an 'average' embryo. Initial examination of the axial (nose-to-tail) seam cell nuclear trajectories from different embryos suggested a high degree of stereotypy; except for a relative shift in time, the trajectories displayed very similar shapes (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). We thus shifted the axial data in time until the trajectories from multiple embryos overlaid (<xref ref-type="fig" rid="fig4">Figure 4B</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). We determined the amount of shift by using a three parameter logistic function to fit the raw axial displacement data (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>, <xref ref-type="table" rid="tbl1">Tables 1</xref>, <xref ref-type="table" rid="tbl2">2</xref>, Materials and methods), overlaying the data from various embryos until the inflection points in each curve were identical.<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.016</object-id><label>Figure 4.</label><caption><title>Alignment of data from different embryos.</title><p>(<bold>A</bold>,<bold>B</bold>) Axial seam cell nuclear trajectories from different embryos are similar in shape, but shifted in time. (<bold>C</bold>,<bold>D</bold>) Shifting in time aligns the trajectories. (<bold>E</bold>, <bold>F</bold>) Averaging the shifted trajectories. (<bold>G</bold>, <bold>H</bold>) Fitting the shifted trajectories. Left graphs: cartoon schematic, Right graphs: data. For clarity, we have shown the shifting, averaging, and fitting process for two embryos, but note that to construct our 'composite' model of seam cell nucleus behavior we have applied the same process to five embryos (see '<bold>Materials and methods</bold>' for further details).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.016">http://dx.doi.org/10.7554/eLife.10070.016</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig4-v2"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.017</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Temporal alignment of embryo data.</title><p>Data from two embryos are shown before (top) and after (bottom) temporal alignment. The data derived from embryo 4 was shifted 5 timepoints to the right, following the procedure described in '<bold>Materials and methods'</bold>. Data shown are the z positions from the right V3 seam cell nucleus. Only a portion of the data, at early timepoints, is shown to highlight the shifting procedure.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.017">http://dx.doi.org/10.7554/eLife.10070.017</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig4-figsupp1-v2"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.018</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Different fits for axial displacement.</title><p>Different fitting models (see also <xref ref-type="table" rid="tbl2">Table 2</xref>) for embryonic axial displacement are plotted (red curves), against raw data (blue diamonds). Also shown on each plot are quantitative measures of goodness of fit: the squared sum of residuals (SSR), the Akaike Information Criterion (AIC), and the Schwarz Criterion (SC). Of the three-parameter fits, the three-parameter logistic provides the best overall fit, both from visual inspection and quantitatively (lowest SSR, AIC, and SC scores). The four-parameter Morgan Mercer Flodin and Logistic curves show slightly better qualitative fits, especially at early time points, but require careful tuning of the initial parameters to converge. For all axial displacement data shown elsewhere in the paper, the three-parameter logistic curve was used as a fitting function. Although the axial displacement data shown here are derived from the left seam cell nucleus H0, we observed the same trends for all seam cells.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.018">http://dx.doi.org/10.7554/eLife.10070.018</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig4-figsupp2-v2"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.019</object-id><label>Figure 4—figure supplement 3.</label><caption><title>Variability in axial distance amongst different embryos.</title><p>Comparisons in axial position vs. time for a seam cell nucleus (right H1, upper graph) and for CANL (lower graph). For most nuclei, as in the upper graph, positions were stereotyped to within 4.6 μm (as quantified by &lt;&lt;σ<sub>Z</sub>&gt;<sub>time</sub>&gt;<sub>seam cell</sub>; see also '<bold>Materials and methods</bold>'). As indicated in the lower graph, we noticed CANs in embryo 5 traveled a shorter distance than in other embryo datasets (resulting in a larger value of &lt;σ<sub>Z</sub>&gt;<sub>time</sub> for CANL, see <xref ref-type="supplementary-material" rid="SD2-data">Supplementary file 2</xref>). Data are shown after applying the shifting procedure described in '<bold>Materials and methods</bold>'.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.019">http://dx.doi.org/10.7554/eLife.10070.019</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig4-figsupp3-v2"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.020</object-id><label>Figure 4—figure supplement 4.</label><caption><title>Fits used in this paper.</title><p>Examples of raw, averaged data (derived from 4 to 5 embryos, blue dots) and fits (black lines). Linear, power, and three-parameter logistic curve examples were taken from the right H0 seam cell nucleus, the quartic polynomial example from AIYL, and the smoothing fits from CANR. See also <xref ref-type="table" rid="tbl1">Table 1</xref>. Note the different ranges in ordinate axes.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.020">http://dx.doi.org/10.7554/eLife.10070.020</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig4-figsupp4-v2"/></fig></fig-group></p><p>We applied the same time shift to the X- and Y- seam cell nuclear coordinates, finding that seam cell nuclear positions followed similar trajectories throughout elongation (average SD calculated across all 20 seam cell nuclei and all timepoints, &lt;&lt;σ<sub>X</sub>&gt;<sub>time</sub>&gt;<sub>seam cell</sub> 0.8 µm, &lt;&lt;σ<sub>Y</sub>&gt;<sub>time</sub>&gt;<sub>seam cell</sub> 0.7 µm, &lt;&lt;σ<sub>Z</sub>&gt;<sub>time</sub>&gt;<sub>seam cell</sub> 4.6 µm, see also <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>, <xref ref-type="table" rid="tbl1">Table 1</xref>, and 'Materials and methods<bold>'</bold>). After shifting, we averaged (<xref ref-type="fig" rid="fig4">Figure 4C</xref>) and fitted (<xref ref-type="fig" rid="fig4">Figure 4D</xref>, <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>, <xref ref-type="table" rid="tbl1">Table 1</xref>, <xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 2</xref>) the embryo XYZ trajectories, thus generating positions representing the noise-free time evolution of seam cell nuclei. We note that the choice of fitting functions is somewhat arbitrary. For axial positions, the growth that we and others (<xref ref-type="bibr" rid="bib32">Priess and Hirsh, 1986</xref>) have observed leads to a sigmoidal fitting function. Amongst the various three-parameter sigmoidal functions (<xref ref-type="table" rid="tbl2">Table 2</xref>), we found that the three-parameter logistic function gave the best qualitative and quantitative (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>) agreement with the data. We fitted lateral (‘X’) seam cell nuclei positions with a two parameter power law function, and dorso-ventral (‘Y’) positions with a linear function, as empirically these functions described our data well. Despite the <italic>ad hoc</italic> nature of these fits, we found that fitted values were within 1.5 µm of the X, Y averaged data, and within 7.5 µm of the Z averaged data (<xref ref-type="supplementary-material" rid="SD3-data">Supplementary file 3</xref>). For reference, the total length of the untwisted embryo at the final time point was 162.0 ± 18.7 µm (mean ± SD, 5 embryos), measured from the nose to the last pair of seam cells, and the corresponding diameter at the last time point 16.1 ± 1.3 µm, measured at the widest cross-section in the animal.<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.021</object-id><label>Table 1.</label><caption><p>Fitting functions tested for describing axial displacement. Equations are used in <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>. L: length; t: time. Other parameters and their meaning are listed in the table. For all axial coordinates in this paper, a three-parameter logistic function was used.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.021">http://dx.doi.org/10.7554/eLife.10070.021</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">Fitting type</th><th valign="top">Equation</th><th valign="top">Parameters</th></tr></thead><tbody><tr><td valign="top">von Bertalanffy</td><td valign="top">L = A(1-exp[-B(t-C)])</td><td valign="top">A: upper asymptotic length <break/>B: growth rate <break/>C: time at which L = 0</td></tr><tr><td valign="top">Exponential</td><td valign="top">L = A-(A-B)exp(-Ct)</td><td valign="top">A: upper asymptotic length <break/>B: lower asymptotic length <break/>C: growth rate</td></tr><tr><td valign="top">Three-parameter Gompertz</td><td valign="top">L = A[exp(-exp(-B(t-C)))]</td><td valign="top">A: upper asymptotic length <break/>B: growth rate <break/>C: time at which L = 0</td></tr><tr><td valign="top">Three-parameter logistic</td><td valign="top">L = A/[1+exp(-B(t-C))]</td><td valign="top">A: upper asymptotic length <break/>B: growth rate <break/>C: inflection point</td></tr><tr><td valign="top">Four-parameter Morgan Mercer Flodin</td><td valign="top">L = A – (A-B)/(1+(Ct)<sup>D</sup>)</td><td valign="top">A: upper asymptotic length <break/>B: length at t = 0 <break/>C: growth rate <break/>D: inflection parameter</td></tr><tr><td valign="top">Four-parameter logistic</td><td valign="top">L = B + (A-B)/{1+exp[(C-t)/D]}</td><td valign="top">A: upper asymptotic length <break/>B: lower asymptotic length <break/>C: growth rate <break/>D: steepness parameter</td></tr></tbody></table></table-wrap><table-wrap id="tbl2" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.022</object-id><label>Table 2.</label><caption><p>Fitting functions for each cell type. X, Y, Z trajectories were fitted as indicated functions of time (<bold>t</bold>).’ 50-point smoothing’ refers to smoothing the input data with a 50-point span, using weighted linear least squares and linear fitting.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.022">http://dx.doi.org/10.7554/eLife.10070.022</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">Cell type</th><th valign="top">X fit</th><th valign="top">Y fit</th><th valign="top">Z fit</th></tr></thead><tbody><tr><td valign="top">Seam cell nucleus</td><td valign="top">Power <break/>X = at<sup>b</sup>+c</td><td valign="top">Linear <break/>Y = p1*t + p2</td><td valign="top">Three-parameter logistic <break/>Z = A/(1+exp(-B(t-C)))</td></tr><tr><td valign="top">CANR/L</td><td valign="top">50-point smoothing</td><td valign="top">50-point smoothing</td><td valign="top">Three-parameter logistic <break/>Z = A/(1+exp(-B(t-C)))</td></tr><tr><td valign="top">AIYR/L</td><td valign="top">4<sup>th</sup> degree polynomial <break/>X = p4*t<sup>4</sup>+p3*t<sup>3</sup>+p2*t<sup>2</sup>+p1*t+p0</td><td valign="top">Linear <break/>Y = p1*t + p2</td><td valign="top">Three-parameter logistic <break/>Z = A/(1+exp(-B(t-C)))</td></tr><tr><td valign="top">ALA <break/>ALA xR1/xL1 <break/>ALA xR2/xL2</td><td valign="top">Linear <break/>X = p1*t + p2</td><td valign="top">Linear <break/>Y = p1*t + p2</td><td valign="top">Three-parameter logistic <break/>Z = A/(1+exp(-B(t-C)))</td></tr></tbody></table></table-wrap></p><p>The averaged, fitted seam cell nuclei data allowed us to inspect the relative relationships among seam cell nuclei in an elongating embryo (<xref ref-type="fig" rid="fig5">Figure 5A</xref>, <xref ref-type="other" rid="media3">Videos 3</xref>,<xref ref-type="other" rid="media4">4</xref>). Since we fixed the nose as the stationary origin in our untwisting procedure, this location does not move in 4D representations of the fitted embryo. In this 'nose-centric' reference frame, points further from the origin also appear to move faster and farther than points closer to the origin. To better understand the growth rates of individual seam cell nuclei in relation to their neighbors, and the overall length changes within the elongating embryo in a frame-independent manner, we also computed the differences in position between adjacent pairs of nearest-neighbor seam cell nuclei over time (<xref ref-type="fig" rid="fig5">Figure 5B–D</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). In ‘X’ and ‘Y’ dimensions, seam cell nuclei exhibited similar movement patterns, remaining largely stationary in ‘Y’ (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>), and moving inwards (toward the origin) in ‘X’ (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>) at similar rates. In contrast, seam cell nuclei movement along the ‘Z’ direction was more heterogeneous. For example, the distance between the origin and nuclei of seam cell pair H0, measured from the fitted data, changed from 2.4 µm to 23.8 µm over elongation (<xref ref-type="fig" rid="fig5">Figure 5B</xref>), while the distance between seam cell nuclear pairs V6 and T remained essentially constant, at 22.5 µm (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). Thus, the rate of increase in distance between the origin and H0 was significantly greater than the increase in distance between V6 and T, over the same period. Other adjacent nuclear pairs separated at roughly similar rates from start to end of elongation (these pairs increased in distance 6.8 ± 2.8 µm, mean ± SD from 7 adjacent pairs of seam cell nuclei, again derived from the fitted data in <xref ref-type="fig" rid="fig5">Figure 5C</xref>). These trends were not the results of artifacts in our fitting procedure, as they were evident also in the raw, averaged data (compare left and right graphs in <xref ref-type="fig" rid="fig5">Figure 5B-D</xref>). The apparent differences in X- and Z- pre- and post-elongating seam cell nuclei positions that we observe are consistent with the asymmetric morphology of the pre-elongating embryo. Since the embryo starts out in a tadpole-like shape with the head larger than the tail, the seam cell nuclei in the head must move a greater distance than the nuclei in the tail to achieve a uniform diameter in the elongated embryo.<media content-type="glencoe play-in-place height-250 width-310" id="media3" mime-subtype="mp4" mimetype="video" xlink:href="elife-10070-media3.mp4"><object-id pub-id-type="doi">10.7554/eLife.10070.023</object-id><label>Video 3.</label><caption><title>Rendering of seam cell nuclear positions (gray spheres) in the developing embryo viewed dorsally, from the late 1.5-fold stage until hatching.</title><p>The positions shown in the rendering are averaged, fitted values derived from five embryos, using the averaging and fitting procedure described in the text; the rendering thus represents a composite, 'best-guess' view as to seam cell evolution in a developing embryo. Times are indicated relative to the first fitted volume, and are 2.5 min apart.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.023">http://dx.doi.org/10.7554/eLife.10070.023</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="media4" mime-subtype="mp4" mimetype="video" xlink:href="elife-10070-media4.mp4"><object-id pub-id-type="doi">10.7554/eLife.10070.024</object-id><label>Video 4.</label><caption><title>The same data as in <xref ref-type="other" rid="media2">Video 2</xref>, rendered from a side view.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.024">http://dx.doi.org/10.7554/eLife.10070.024</ext-link></p></caption></media><fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.025</object-id><label>Figure 5.</label><caption><title>Variability in seam cell nucleus axial movement in the elongating embryo.</title><p>(<bold>A</bold>) Snapshots of the elongating embryo near start (Volume 30, left) and end (Volume 113) of elongation. Seam cell nuclei volumes are indicated as filled spheres, L/R axes are as indicated, seam cell nuclear identities indicated at the side of each snapshot, as is the origin (nose, ‘O’). See also <xref ref-type="other" rid="media3">Videos 3</xref>,<xref ref-type="other" rid="media4">4</xref>. Scalebar: 10 μm. (<bold>B</bold>–<bold>D</bold>) Axial differences over the course of elongation between adjacent seam cell nucleus pairs, sorted into greatest (<bold>B</bold>), intermediate (<bold>C</bold>), and least (<bold>D</bold>) bins, corresponding to red, gray, and blue coloring indicated in (<bold>A</bold>). Left graphs: raw, averaged data (as in <xref ref-type="fig" rid="fig4">Figure 4E</xref>, <xref ref-type="fig" rid="fig4">4F</xref>). Right graphs: fitted data (as in <xref ref-type="fig" rid="fig4">Figure 4G</xref>, <xref ref-type="fig" rid="fig4">4H</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.025">http://dx.doi.org/10.7554/eLife.10070.025</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig5-v2"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.026</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Seam cell nucleus XY movement in the elongating embryo.</title><p>(<bold>A</bold>–<bold>D</bold>) Snapshots of the elongating embryo at start (above dashed line) and end (below dashed line) of elongation, as shown in lateral (X motion, <bold>A</bold>) and dorsal-ventral (Y motion, <bold>C</bold>) views. Distances from the origin in X (<bold>B</bold>, <bold>C</bold>) and Y (<bold>E</bold>,<bold>F</bold>) are also shown for each seam cell nucleus. Both averaged (<bold>B</bold>, <bold>E</bold>) and fitted (<bold>C</bold>, <bold>F</bold>) distances are displayed. Scalebars: 10 μm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.026">http://dx.doi.org/10.7554/eLife.10070.026</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig5-figsupp1-v2"/></fig></fig-group></p><p>Embryo elongation is thought to be dependent on an actin-based contractile mechanism (<xref ref-type="bibr" rid="bib32">Priess and Hirsh, 1986</xref>). The complex, position-dependent motion we observed is likely inconsistent with a simple, uniform contraction, as this phenomena cannot explain our finding that different regions of the embryo elongate at markedly different rates. To our knowledge, current models of embryo elongation have not taken into account the differential elongation we observed across the worm body. We expect that incorporating additional data derived from cell positions and subcellular markers (especially cytoskeletal [<xref ref-type="bibr" rid="bib32">Priess and Hirsh, 1986</xref>; <xref ref-type="bibr" rid="bib13">Gally et al., 2009</xref>]) in the embryo would help further refine existing models (<xref ref-type="bibr" rid="bib10">Ciarletta et al., 2009</xref>) of embryo elongation.</p><p>Currently, building a composite model of neuronal positions and morphological development in the embryo depends on pooling distinct datasets from many independent embryos. Given our experience tracking seam cell nuclei, we next turned our attention to modeling the 4D motion of neurons and neurite outgrowth in the elongating worm embryo as a proof of concept for a neurodevelopmental atlas (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, <xref ref-type="other" rid="media5">Videos 5</xref>,<xref ref-type="other" rid="media6">6</xref>). Four of the five embryos used in constructing our seam cell model also had neuronal cell bodies marked with a <italic>pceh-10::GFP</italic> construct; neurons included AIYL/R, CANL/R, and ALA. We manually annotated the position of these neuronal cell bodies, then temporally aligned, averaged, and fitted the positions as we did the seam cell nuclei (<xref ref-type="fig" rid="fig4">Figure 4</xref>). The axial motion of these neurons was qualitatively similar to the seam cell nuclei and could be well described by the three parameter logistic function. However, their XY motion appeared different than the seam cell nuclei. For example, the lateral motion of CANs could not be easily described by a simple function, so we used a 50 point smoothing of the averaged data as our 'fit'. The ALA X motion was better described by a 4<sup>th</sup> degree polynomial than a power law, so we used the former function to fit the data (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>, <xref ref-type="table" rid="tbl1">Table 1</xref>). As evident by their axial displacements, ALA and AIYL/R moved similarly to nearby seam cell nuclei (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). In contrast, CANs moved faster than adjacent seam cell nuclei, suggesting a more 'active' mode of migration (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). Finally, the motion of ALA and CANs (especially CANL) were considerably more variable between datasets than the seam cell nuclei (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>, <xref ref-type="supplementary-material" rid="SD2-data">Supplementary files 2</xref>,<xref ref-type="supplementary-material" rid="SD3-data">3</xref>,<xref ref-type="supplementary-material" rid="SD4-data">4</xref>). While it is currently unclear whether this variability is strain-dependent or reflects underlying biology, this observation underscores the need to study multiple embryos and assess the degree to which cellular motion is stereotyped in elongating embryos.<media content-type="glencoe play-in-place height-250 width-310" id="media5" mime-subtype="mp4" mimetype="video" xlink:href="elife-10070-media5.mp4"><object-id pub-id-type="doi">10.7554/eLife.10070.027</object-id><label>Video 5.</label><caption><title>Rendering of neurons and neurites, in the context of seam cell nuclei shown in <xref ref-type="other" rid="media2">Videos 2</xref>,<xref ref-type="other" rid="media3">3</xref>.</title><p>As in these videos, all positions are averaged, fitted values derived from multiple embryos. View is from dorsal perspective. Red spheres represent CAN cell bodies, yellow spheres represent AIY cell bodies, and blue spheres and lines correspond to ALA and its neurites. ALA and AIY cell bodies appear to closely track neighboring seam cells during elongation, while the CAN neurons actively migrate. ALA neurite outgrowth starts toward the end of elongation and continues after most other morphological changes have ceased. Times are indicated relative to the first fitted volume, and are 2.5 min apart.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.027">http://dx.doi.org/10.7554/eLife.10070.027</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="media6" mime-subtype="mp4" mimetype="video" xlink:href="elife-10070-media6.mp4"><object-id pub-id-type="doi">10.7554/eLife.10070.028</object-id><label>Video 6.</label><caption><title>The same data as in <xref ref-type="other" rid="media4">Video 4</xref>, rendered from the side.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.028">http://dx.doi.org/10.7554/eLife.10070.028</ext-link></p></caption></media></p><p>To examine neurite outgrowth clearly, we created a two-color strain with GFP-labeled untwisting markers and a <italic>pceh-10::mCh</italic> construct to label neuronal cell bodies and neurites. We observed substantial mosaicism in terms of which cells were labeled from one embryo to the next with this strain. Although neurons were labeled with an extrachromosomal array and a certain degree of mosaicism could be anticipated, labeling differences from one animal to the next hindered our ability to track both ALA and CAN outgrowths. Nevertheless, we were able to obtain two datasets where the ALA neuron was labeled throughout most of our imaging period.</p><p>ALA is a single neuron with a cell body located in the dorsal portion of the head; a pair of long neurites extend ventrally from this cell body into the nerve ring, and then turn and extend posteriorly along the lateral nerve cord (<xref ref-type="bibr" rid="bib41">White et al., 1986</xref>). Left and right ALA outgrowths could be readily identified and annotated in both twisted and untwisted embryos (<xref ref-type="fig" rid="fig6">Figure 6D</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). In modeling the left and right neurite shapes, we simplified them by annotating them as three distinct points (ALA: cell body; AxR1 or AxL1: point at which the neurite turns to extend posteriorly; AxR2/L2: neurite terminus; <xref ref-type="fig" rid="fig6">Figure 6E</xref>). We then measured the 3D displacements (relative to the nose, as before) of each independent point, shifting, averaging and fitting the data derived from two embryos (as outlined in <xref ref-type="fig" rid="fig4">Figure 4</xref> and illustrated in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>), to yield a noise-free representation of the neurite (<xref ref-type="table" rid="tbl1">Table 1</xref>). Aligning the fitted neurites to our reference embryo allowed inspection of ALA neurite growth in the context of the elongating embryo (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, <xref ref-type="other" rid="media5">Videos 5</xref>,<xref ref-type="other" rid="media6">6</xref>), revealing that neurite outgrowth continued to occur for ~240 min after the other cells assumed their final positions at the end of elongation. We also segmented growing ALA neurites at several points in development to demonstrate that straightened images can be used to generate volumetric reconstructions of cell morphology throughout development (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>.) We are unaware of any other work that has modeled the growth and positions of neurites in the post-twitching embryonic regime (for <italic>C. elegans</italic> or any other model organism).<fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.029</object-id><label>Figure 6.</label><caption><title>Neurons and neurites in the developing embryo.</title><p>(<bold>A</bold>) Early (left) and late (snapshots) in the elongating embryo. Gray spheres: seam cell nuclei; ALA cell body: blue sphere; ALA neurites: blue lines; AIY cell bodies: yellow spheres; CAN cell bodies: red spheres. Compare to <xref ref-type="other" rid="media5">Videos 5</xref>,<xref ref-type="other" rid="media6">6</xref>. (<bold>B</bold>) ALA (top), AIYR (middle), and CANR (bottom) axial trajectories (red curves) in relation to neighboring seam cells (blue curves). ALA and AIY cells maintain their relative position with respect to the rest of the elongating body, while CANs migrate faster than neighboring seam cells. (<bold>C</bold>) ALA cell body and neurite in the twisted embryo, highlighting morphological features (ALA: ALA cell body; AxL1/R1: junction between ventral and posterior neurite extension; AxL2/R2: posterior tip of the ALA neurites). (<bold>D</bold>) Axial trajectory of ALA neurite tip in relation to indicated seam cells. (<bold>E</bold>) Top and side models of ALA in untwisted reference frame, indicating neurite bend and terminus. Compare to <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.029">http://dx.doi.org/10.7554/eLife.10070.029</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig6-v2"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.030</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Shifting, averaging and fitting procedures for modeling the ALA neurite.</title><p>(<bold>A</bold>) Axial distance (measured from the origin point) of the ALA cell body for two ALA datasets. Similar to seam cells, axial distance increases during elongation and then plateaus once elongation has finished. (<bold>B</bold>) ALA axial distance, derived from averaging the axial distances of the shifted ALA datasets. (<bold>C</bold>) A fitted curve describing axial motion of ALA, after averaging in (<bold>B</bold>). (<bold>D</bold>–<bold>F</bold>) Shifting, averaging, and fitting of axial motion for the AxR1 point in the ALA neurite (the position at which the ventral growth of the neurite changes to posterior growth). As there is little axial growth in this part of the neurite, axial movement mirrors that of the ALA cell body. (<bold>G</bold>–<bold>I</bold>) Shifting, averaging, and fitting of axial motion for AxR2, the tip of the posteriorly-growing ALA neurite. The posterior-ward axial extension of the neurite leads to a different pattern of axial movement than for the R1 point or the ALA cell body.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.030">http://dx.doi.org/10.7554/eLife.10070.030</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig6-figsupp1-v2"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10070.031</object-id><label>Figure 6—figure supplement 2.</label><caption><title>Segmentation of neurons and neurites in the untwisted embryo.</title><p>(<bold>A</bold>) Exemplary data for a twofold embryo. Left column: raw data. Right column: segmented data. The red neuron is RMED, the orange neuron is ALA, and the purple neurons are the cell bodies of the AIY neurons. At this point in embryonic development, the ALA neurites have extended ventrally and begun extending posteriorly, but have not undergone much extension. (<bold>B</bold>) Same embryo and color-scheme as in (<bold>A</bold>), but now early threefold stage. More ALA neurite extension is evident. (<bold>C</bold>) Same as in (<bold>B</bold>), but at a later stage. The ALA neurites have extended approximately 1/3 of the way to the tail at this point. In addition, neurite extension can also be observed in the AIY and RMED neurons. Scalebar: 10 μm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.031">http://dx.doi.org/10.7554/eLife.10070.031</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-fig6-figsupp2-v2"/></fig></fig-group></p></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The <italic>C. elegans</italic> cell lineage is invariant (<xref ref-type="bibr" rid="bib36">Sulston et al., 1983</xref>), and tracking cells in the L1 larva has revealed that cellular positions in post-hatching animals are relatively stereotyped (<xref ref-type="bibr" rid="bib27">Long et al., 2009</xref>). Our work suggests that this positional stereotypy extends to the cells in the late embryo as well. However, we also found that in the case of cells or structures which actively migrate, such as the CAN neurons and ALA neurites, there seems to be greater variability in terms of end position and growth rate. To some extent this is not surprising; as these cells and neurites move longer distances than most other cells, and depend on actively finding their way in a complex environment (as opposed to passive movement in response to elongation), there may be more room for variability in how they travel and reach their destinations.</p><p>On a more general level, we also observed variability in the temporal shifts necessary to align each elongating embryo to the reference dataset (embryo 1). Some of this variability may be due to relatively mundane explanations: embryos were at slightly different ages when imaging began, and temperature was moderately controlled (to within 2 to 3°C both during imaging and strain growth). Intrinsic developmental variability, caused by maternal effects or exposure to imaging could also have played a role in the slightly different patterns of development we observed across embryos.</p><p>Expanding the work we describe here to other migrating and non-migrating neurons should make clear whether there actually is a difference in positional variability between migrating and non-migrating cells. Adding additional data to our 4D model is conceptually straightforward: strains with distinguishable neurons can be crossed into the untwisting background, untwisted, trajectories of cells and outgrowths fitted, and subsequently registered with previously derived data. 'Filling in' the positions of all neurons and outgrowths in the developing embryo would form the basis of the 4D atlas of neurodevelopment, and could be combined with functional activity mapping and gene expression data to provide a more comprehensive picture of animal development in late embryogenesis.</p><p>Our untwisting and annotation plugin is designed to be flexible, so that it can be applied to most problems involving tracking position and morphology of distinguishable structures in the nematode embryo. The core of the plugin relies on defining the sides of the worm embryo; although our work uses a specific set of markers, we note that any other markers which define the edges of the worm body should also work. The annotation capability is also flexible; as it is based on manual annotation, almost any distinct structure can be annotated. Finally, while the isotropic resolution of the diSPIM is very helpful in resolving fine embryonic detail (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>), our untwisting algorithm is compatible with other high-resolution imaging methods. For example, we used a super-resolution two-photon instant structured illumination microscope (2P ISIM) (<xref ref-type="bibr" rid="bib42">Winter, 2014</xref>) to image and untwist a bent L2 larval worm, obtaining clear images of this relatively large specimen (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>, <xref ref-type="other" rid="media7">Video 7</xref>). Our plugin is designed specifically for untwisting nematode embryos, and as such is unlikely to be immediately applicable to other biological systems without substantial modification (we know of few non-nematode systems that have the same vermiform shape and degree of twisting and movement). However, some of the more general concepts we implement, such as the benefit of aligning and pooling information derived different datasets to generate an overall 4D view of development, are likely applicable to more systems than just the worm.<media content-type="glencoe play-in-place height-250 width-310" id="media7" mime-subtype="mp4" mimetype="video" xlink:href="elife-10070-media7.mp4"><object-id pub-id-type="doi">10.7554/eLife.10070.032</object-id><label>Video 7.</label><caption><title>Rotating view of an untwisted L2 worm.</title><p>The image was imported into ImageJ and the Magenta LUT was applied to the stack. The volume shown here corresponds to the untwisted volume in <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.032">http://dx.doi.org/10.7554/eLife.10070.032</ext-link></p></caption></media></p><p>Despite the power of our semi-automated approach, several areas for improvement remain. Automated lattice-building assumes the embryo has 20-22 seam cell nuclei on which the lattice is based; in early periods of elongation (especially the 1.5- to 2-fold transition) expression is absent in some seam cell nuclei, requiring manual lattice-building. In addition, time spent in editing automatic segmentation and lattice generation results in ~8 hr of manual work when untwisting an embryo spanning 100–150 timepoints. Fully automated untwisting is not currently feasible, but the development of alternative markers may enable this goal. Second, although the positions of cells and neurites in the growing embryo can be determined with micron-scale precision, and placed in context with their neighbors, additional methods are needed to place the full morphological volume of a given cell within the untwisted embryo. While our data are of sufficient quality to segment such morphology in an untwisted animal (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>, <xref ref-type="other" rid="media8">Video 8</xref>), the general question about how to combine morphological segmentations from distinct, untwisted embryos remains. New methods developed for pre-twitching embryos may prove useful in this regard (<xref ref-type="bibr" rid="bib33">Santella et al., 2015</xref>).<media content-type="glencoe play-in-place height-250 width-310" id="media8" mime-subtype="mp4" mimetype="video" xlink:href="elife-10070-media8.mp4"><object-id pub-id-type="doi">10.7554/eLife.10070.033</object-id><label>Video 8.</label><caption><title>Rotating three-dimensional view of the segmentation shown in <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>.</title><p>The volume was segmented and rendered in Imaris.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.033">http://dx.doi.org/10.7554/eLife.10070.033</ext-link></p></caption></media></p><p>A more significant and long-term set of technical problems for completing the neurodevelopmental atlas relates to the generation of fluorescent markers and strains that provide sparse, optically resolvable neurons. Most fluorescent strains label multiple neurons that are too close in space and time to be easily resolved – possible strategies to 'separate' these neurons might include 'Brainbow' (<xref ref-type="bibr" rid="bib26">Livet et al., 2007</xref>) (spectral separation of densely labeled neurons) or heat-shock-based approaches (<xref ref-type="bibr" rid="bib16">Halfon et al., 1997</xref>; <xref ref-type="bibr" rid="bib3">Bacaj and Shaham, 2007</xref>) (temporal separation of densely labeled cells). Even if such strains are built, the identity of the resulting neurons will need to be verified. As lineaging (<xref ref-type="bibr" rid="bib4">Bao, 2006</xref>) in <italic>C. elegans</italic> has been carried out to just before twitching begins (<xref ref-type="bibr" rid="bib14">Giurumescu et al., 2012</xref>), in principle neurons can be identified by matching early expression to lineage data. If expression turns on after twitching, lineaging would also need to be extended into the post-twitching regime. Such 'deep lineaging', or tracking the coordinates of all nuclei through twitching would be a valuable and complementary effort to untwisting. Finally, we note that the expression pattern of fluorescent proteins within individual neurons could be further optimized. For almost all strains (except DCR4209 which contained membrane-targeted mCherry), fluorescent proteins were expressed cytoplasmically. An improved strategy would combine such cytoplasmic labeling with membrane targeting, better filling out very thin neuronal outgrowths that otherwise might be missed due to low expression; a similar strategy was adopted in super-resolution microscopy to trace thin neurites (<xref ref-type="bibr" rid="bib25">Lakadamyali et al., 2012</xref>).</p></sec><sec id="s4" sec-type="materials|methods"><title>M<bold>aterials and m</bold>ethods</title><sec id="s4-1"><title>Strains</title><p>Nematode strains were kept at 20°C, and grown on NGM media plates seeded with <italic>E. coli</italic> OP50. The untwisting strain is SLS1 <italic>xnIS17 [dlg-1::GFP + rol-6]; wIS51 [SCM::GFP]</italic>. Strains used to construct SLS1 were FT63 [<italic>xnIS17 dlg-1::GFP + rol-6</italic>] (<xref ref-type="bibr" rid="bib39">Totong et al., 2007</xref>) and JR667 [<italic>wIS51 SCM::GFP</italic>] (<xref ref-type="bibr" rid="bib37">Terns et al., 1997</xref>; <xref ref-type="bibr" rid="bib21">Koh and Rothman, 2001</xref>). Strains were crossed together to generate an animal containing these transgenes. Strains imaged for the paper include SLS1, DCR4209, and DCR4221. Strain DCR4209 contained the following transgenes: <italic>olaex2457 [P.ceh-10::mCh-PHd</italic> (25 ng/μL) + <italic>unc122::RFP</italic> (30ng/μL)]; <italic>xnIS17 [dlg-1::GFP + rol-6]; wIS51 [SCM::GFP]</italic>. To create <italic>olaEX2457</italic>, 4132 bp upstream of the transcriptional start site were isolated using the following promoters: Forward AGC TCC TGC ACT CTT CTG ATC; Reverse CAC AAG AGA AAA GTG GCT GCT TAT C. Strain DCR4221 contained the following transgenes: <italic>lqIS4 (<xref ref-type="bibr" rid="bib40">Wenick and Hobert, 2004</xref>) [ceh-10promA::GFP]; xnIs17 [dlg-1::GFP + rol-6]; wIs51 [SCM::GFP]</italic>. Detailed subcloning information for <italic>olaex 2457</italic> can be provided upon request.</p></sec><sec id="s4-2"><title>Sample preparation</title><p>As previously described, worm samples were prepared for diSPIM (<xref ref-type="bibr" rid="bib44">Wu et al., 2011</xref>; <xref ref-type="bibr" rid="bib5">Bao and Murray, 2010</xref>; <xref ref-type="bibr" rid="bib24">Kumar et al., 2014</xref>): adult animals were placed in buffer and cut to liberate embryos, embryos transferred to poly-L-lysine-coated coverslips in the diSPIM imaging chamber, and imaged once they reached the bean-to-comma stage of embryonic development.</p></sec><sec id="s4-3"><title>Data acquisition</title><p>All data were acquired on either a first-generation diSPIM (<xref ref-type="bibr" rid="bib43">Wu et al., 2013</xref>) or a more recent fiber-coupled version (<xref ref-type="bibr" rid="bib24">Kumar et al., 2014</xref>). Dual-color data were taken sequentially (first the 488-nm excitation for the GFP channel, and then 561-nm excitation for the mCherry channel) in a plane-by-plane (5 ms GFP collection, 5 ms mCherry collection per axial position in the embryo) fashion. Given 50 planes per view, and two perpendicular views, this resulted in an acquisition time of 1 s per 2-color diSPIM volume. For most datasets in this paper (embryos 2-8, as referred to elsewhere in the text), single-color volumes were acquired every 5 min, but for one datastet (embryo 1), single-color volumes were acquired every 2.5 min. Dual-color acquisitions were used to track ALA neurite outgrowth (embryos 7 and 8). Acquisition code, written in LabVIEW, is available at <ext-link ext-link-type="uri" xlink:href="http://www.wormguides.org/dispim/dispim-downloads">http://www.wormguides.org/dispim/dispim-downloads</ext-link>.</p><p>For 2P ISIM imaging, we used 900-nm excitation and two 680-nm short-pass filters (Semrock, FF01-680/SP-25) in our emission path to filter illumination light. L2 larvae of strain SLS1 were immobilized with 50 mM levamisole (Sigma-Aldrich; St Louis, MO) and imaged on an agarose pad sandwiched between two #1.5 coverslips. Volumetric images of the entire specimen were acquired by manual XY translation of the stage between fields of view. Each raw frame was acquired in 200 ms; data used in this paper were derived by averaging six raw frames per axial position. Axial positions were spaced 0.333 μm apart. Individual 3D image stacks were stitched and overlaid to reconstruct the entire L2 stage worm using a custom plugin developed for MIPAV (available online at <ext-link ext-link-type="uri" xlink:href="http://www.cit.nih.gov/mipav">www.cit.nih.gov/mipav</ext-link>). After stitching, the reconstructed L2 stage worm volume was further processed with 40 iterations of Richardson-Lucy deconvolution.</p></sec><sec id="s4-4"><title>Shifting and averaging trajectories derived from different embryos</title><p>Cells from different embryo datasets exhibited qualitatively and quantitatively similar trajectories, so we aligned and then combined them to generate averaged, noise-free trajectories. First, coordinate trajectories (X, Y, or Z positions (<xref ref-type="fig" rid="fig3">Figure 3I</xref>) as a function of time) were 'cleaned' to remove obvious outliers, or to linearly interpolate gaps in the raw data (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). Second, the axial (‘Z’) coordinate of each cell was fitted to a three parameter logistic function (<xref ref-type="table" rid="tbl2">Table 2</xref>) using Growth II (Pisces Conservation) or MATLAB (Mathworks) software, as this function provided a better fit than other three parameter growth curves, and did not require careful tuning of initial parameter values, as did the four parameter growth curves we tested (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>, <xref ref-type="table" rid="tbl1">Table 1</xref>). Third, we aligned datasets from embryos 2-5 (volumes recorded every 5 min) to embryo 1 (volumes recorded every 2.5 min), by (i) determining the inflection time point (‘C’ in <xref ref-type="table" rid="tbl1">Table 1</xref>, <xref ref-type="table" rid="tbl2">2</xref>) for each cell’s fitted axial position and (ii) shifting the data an integral number of time points so that the inflection time points from embryos 2-5 agreed with the inflection point for embryo 1. For example, for the data shown in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> for seam cell V3R nuclei, embryo 1 had inflection point 42.6, and embryo 4 had inflection point 37.7, so the V3R trajectory for embryo 4 was shifted 42.6-37.7 = 5 timepoints to the right, to match the trajectory for embryo 1. The same integer time point shift was then applied to the corresponding ‘X’ and ‘Y’ coordinate trajectories for each cell. Fourth, after shifts were applied, coordinate trajectories were averaged. Finally, to generate noise-free trajectories, the average trajectories were fitted (functions chosen for the fits are shown in <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref> and <xref ref-type="table" rid="tbl1">Table 1</xref>).</p><p>To examine the degree to which embryo positions agreed after the shifting procedure, we computed SD between embryo positions at each time point (<xref ref-type="supplementary-material" rid="SD2-data">Supplementary file 2</xref>). With the exceptions of the CAN neurons, the X and Y positions of cells were stereotyped to within 2 μm, and the Z positions within 10 μm.</p></sec><sec id="s4-5"><title>Validating fits for each embryo</title><p>The majority of cells’ coordinate trajectories were well described by power (X coordinate), linear (Y coordinate), and three-parameter logistic (Z coordinate) functions (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>, <xref ref-type="table" rid="tbl1">Tables 1</xref>, <xref ref-type="table" rid="tbl2">2</xref>, <xref ref-type="supplementary-material" rid="SD3-data">Supplementary file 3</xref>). However, two cell types, CAN and AIY, were not well described by any of the common fitting functions we surveyed (e.g. power, exponential, Gaussian, rational functions). For these cells, we instead used 50 point smoothing (for CAN X and Y coordinates) or a quartic polynomial function (for AIY X coordinates) to reduce noise in the shifted, averaged trajectories. To estimate how well the curve fitting described the averaged trajectories, we calculated the absolute differences between averaged and fitted coordinates at each time point, and then calculated the means and SD of these differences across time. These data are recorded in <xref ref-type="supplementary-material" rid="SD3-data">Supplementary file 3</xref> as μ <sub>avg-fit, time</sub> and σ <sub>avg-fit, time</sub>. We also computed the average over all seam cell nuclei of these average differences to generate &lt;μ <sub>Xavg-Xfit, time</sub>&gt;<sub>seam cell</sub>; &lt;μ <sub>Yavg-Yfit, time</sub>&gt;<sub>seam cell</sub>; and &lt;μ <sub>Zavg-Zfit, time</sub>&gt;<sub>seam cell</sub> resulting in values of 0.5 µm, 0.6 µm, and 3.7 µm. In XY, similar average statistics were found for all cell types. In the Z coordinate, CANL stood out as more variable, as its μ <sub>Zavg-Zfit, time</sub> was 10.2 µm (with a corresponding SD of 9.3 µm). We suspect the deviation between CANL data and fit arises more from the inherent variability with CAN cells (<xref ref-type="supplementary-material" rid="SD2-data">Supplementary file 2</xref>) than inherent problems with the fitting function choice.</p></sec><sec id="s4-6"><title>Population statistics</title><p>In several locations, we report population averages taken across some combination of seam cell nuclei, time, or embryos. We use μ and s to denote mean and SD, and &lt;X&gt;<sub>Y</sub> indicates an average of quantity X, across Y. For example, &lt;μ<sub>X</sub>&gt;<sub>embryo</sub> stands for the population average across embryos, of mean X coordinate positions (each derived from an individual embryo).</p><p>For untwisting control measurements, we measured the difference between twisted and untwisted volumes for various distance metrics (between seam cells and along the pharynx). For each embryo, we computed the mean difference μ<sub>Difference,time</sub> and standard deviation σ<sub>Difference, time</sub> across time, and averaged these quantities to calculate a population &lt;μ<sub>Difference, time</sub>&gt;<sub>embryo</sub> and population &lt;σ<sub>Difference, time</sub>&gt;<sub>embryo</sub> across embryos.</p><p>To estimate inter-embryo and inter-seam cell nuclei positional (X, Y, and Z coordinates) variability over elongation, we shifted data from embryos until they overlaid in time, and next computed the SD between embryo positions at each aligned timepoint. Mean standard deviations &lt;σ<sub>X</sub>&gt;<sub>time</sub>; &lt;σ<sub>Y</sub>&gt;<sub>time</sub>; and &lt;σ<sub>Z</sub>&gt;<sub>time</sub> over all timepoints were calculated, and are reported in <xref ref-type="supplementary-material" rid="SD2-data">Supplementary file 2</xref>. To compute &lt;&lt;σ<sub>X</sub>&gt;<sub>time</sub>&gt;<sub>seam cell</sub>; &lt;&lt;σ<sub>Y</sub>&gt;<sub>time</sub>&gt;<sub>seam cell</sub> and &lt;&lt;σ<sub>Z</sub>&gt;<sub>time</sub>&gt;<sub>seam cell</sub>, we averaged mean SD across the 20 seam cell nuclei.</p></sec><sec id="s4-7"><title>Supplementary datasets</title><p>In accordance with <italic>eLife</italic> policy, we have made our raw annotation data and quality control measurements available: <xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 4</xref> contains the 3D positions of seam cell nuclei, neurons, and growing ALA axons. These data were used in <xref ref-type="fig" rid="fig3">Figures 3</xref>–<xref ref-type="fig" rid="fig6">6</xref>. Data are provided before outlier removal, shifting, and fitting. <xref ref-type="supplementary-material" rid="SD5-data">Supplementary file 5</xref> contains the quality control measurements (distances between seam cell nuclei in the H0 and T pairs before and after untwisting, and pharyngeal contour lengths before and after untwisting) used to generate <xref ref-type="fig" rid="fig2">Figure 2</xref>.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Joseph Joy for early inspiration and encouragement, Nish Pandye (CIT, NIH) for initial work on the untwisting plugin, and Andrea Zou and John Joseph for assistance with untwisting. We thank Jing Chen, Zhanghan Wu, and Jian Liu for helpful discussion on the biomechanics of embryo elongation. We also thank the Research Center for Minority Institutions program and the Institute of Neurobiology at the University of Puerto Rico for providing a meeting and brainstorming platform. This work was partially conducted at the Marine Biological Laboratories at Woods Hole, under a Whitman research award (to DAC-R, ZB and HS). This work was supported by the Intramural Research Programs of the NIH National Institute of Biomedical Imaging and Bioengineering, the Center for Information Technology, NIH grants U01 HD075602 and R24OD016474, National Natural Science Foundation of China grants 61427807, 61271083, 61525106, and by Natural Science Foundation of Zhejiang grants LR12F03001. We acknowledge Dr. Jeffrey Simske for sharing strains. Some strains were also provided by the CGC, which is funded by NIH Office of Research Infrastructure Programs (P40 OD010440). The NIH, its employees, and officers do not endorse or recommend any commercial products, processes, or services.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>RPC, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>AB, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>AS, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con4"><p>YW, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con5"><p>JM-S, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con6"><p>MG, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con7"><p>IK, Conception and design, Drafting or revising the article</p></fn><fn fn-type="con" id="con8"><p>AK, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con9"><p>PWW, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con10"><p>NT, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con11"><p>EM, Conception and design, Drafting or revising the article</p></fn><fn fn-type="con" id="con12"><p>HL, Conception and design, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con13"><p>MM, Conception and design, Drafting or revising the article</p></fn><fn fn-type="con" id="con14"><p>WM, Conception and design, Drafting or revising the article</p></fn><fn fn-type="con" id="con15"><p>DAC-R, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con16"><p>ZB, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con17"><p>HS, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.10070.034</object-id><label>Supplementary file 1.</label><caption><title>Tutorial for use of the WormUntwisting automated lattice-building plugin.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.034">http://dx.doi.org/10.7554/eLife.10070.034</ext-link></p></caption><media mime-subtype="msword" mimetype="application" xlink:href="elife-10070-supp1-v2.doc"/></supplementary-material><supplementary-material id="SD2-data"><object-id pub-id-type="doi">10.7554/eLife.10070.035</object-id><label>Supplementary file 2.</label><caption><title>Deviations between embryo datasets.</title><p>For each cell studied in this paper, data from 5 embryos were shifted as discussed in the text, and the standard deviations between embryo positions at each timepoint computed. Mean standard deviations (&lt;σ&gt;) and the maximum standard deviation (Max(σ)) over all timepoints are recorded above. For x and y coordinates, the majority of embryo positions are within 2 μm. For z coordinates, most embryo positions lie within 10 μm of each other, with the exception of CANL. See also <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref> for representative embryo trajectories. For most data displayed here, at least three embryo datasets were used in generating these values. For three datasets (red italics), only two embryo datasets were compared.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.035">http://dx.doi.org/10.7554/eLife.10070.035</ext-link></p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-10070-supp2-v2.docx"/></supplementary-material><supplementary-material id="SD3-data"><object-id pub-id-type="doi">10.7554/eLife.10070.036</object-id><label>Supplementary file 3.</label><caption><title>Deviations between fits and averaged data.</title><p>For each cell studied in this paper, the absolute differences between averaged coordinates and fits were computed at each time point. The means and standard deviations of these differences over time, in μm, are recorded in the table above. For x and y coordinates, the majority of fitted points lie within 1.5 μm of the averaged data, regardless of cell type. For z coordinates, the majority of fitted points lie within 7.5 μm of the averaged data, with the exception of CANL.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.036">http://dx.doi.org/10.7554/eLife.10070.036</ext-link></p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-10070-supp3-v2.docx"/></supplementary-material><supplementary-material id="SD4-data"><object-id pub-id-type="doi">10.7554/eLife.10070.037</object-id><label>Supplementary file 4.</label><caption><title>Raw annotation data for seam cell nuclei, neuronal cell bodies, and ALA neurites.</title><p>Supplementary data file 4 contains raw annotation data generated by the untwisting algorithm for the 20 seam cell nuclei; CAN, AIY, and ALA cell bodies; and ALA neurites. Each sheet contains positional information for one cell, broken up by embryo dataset. Embryo datasets are labeled in the form Embryo_#_X_minutes, where # corresponds to the number assigned to the dataset (1–8) and X represents the imaging frequency (between volumes) in minutes. For each embryo dataset, the volume numbers and X, Y, and Z-positions of the cell or neurite in that volume are listed.</p><p>The data are provided in raw form, after sorting by embryo, cell, and volume but before cleaning, shifting, and fitting. For some volumes annotation information was not captured, usually due to errors in the untwisting process; for these volumes the spreadsheet entries are left blank. Additionally, there is unconstrained rotation around the midline in most datasets, which can cause X and Y-values to switch between positive and negative sign. The canonical orientation of the embryo for this paper is for cells on the right side (R) of the animal to have positive X-values and Y-positions located dorsal to the midline to have positive values; in volumes where the XR values are negative the sign should be changed, as well as the corresponding sign for the YR, XL, and YL values for that volume. Z-measurements are insensitive to this rotation. All annotations are in μm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.037">http://dx.doi.org/10.7554/eLife.10070.037</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-10070-supp4-v2.xlsx"/></supplementary-material><supplementary-material id="SD5-data"><object-id pub-id-type="doi">10.7554/eLife.10070.038</object-id><label>Supplementary file 5.</label><caption><title>Quality control measurements.</title><p>The data provided in this supplementary data file correspond to the quality control measurements used to generate <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>. The data are sorted by embryo, volume, and measurement type. Embryos are named in the form Embryo_#_X_minutes, where # corresponds to the number assigned to the dataset (1–8) and X represents the imaging frequency (between volumes) in the dataset. All data are listed in μm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.038">http://dx.doi.org/10.7554/eLife.10070.038</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-10070-supp5-v2.xlsx"/></supplementary-material></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahrens</surname><given-names>MB</given-names></name><name><surname>Orger</surname><given-names>MB</given-names></name><name><surname>Robson</surname><given-names>DN</given-names></name><name><surname>Li</surname><given-names>JM</given-names></name><name><surname>Keller</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Whole-brain functional imaging at cellular resolution using light-sheet microscopy</article-title><source>Nature Methods</source><volume>10</volume><fpage>413</fpage><lpage>420</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2434</pub-id><pub-id pub-id-type="pmid">23524393</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amat</surname><given-names>F</given-names></name><name><surname>Lemon</surname><given-names>W</given-names></name><name><surname>Mossing</surname><given-names>DP</given-names></name><name><surname>McDole</surname><given-names>K</given-names></name><name><surname>Wan</surname><given-names>Y</given-names></name><name><surname>Branson</surname><given-names>K</given-names></name><name><surname>Myers</surname><given-names>EW</given-names></name><name><surname>Keller</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Fast, accurate reconstruction of cell lineages from large-scale fluorescence microscopy data</article-title><source>Nature Methods</source><volume>11</volume><fpage>951</fpage><lpage>958</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3036</pub-id><pub-id pub-id-type="pmid">25042785</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bacaj</surname><given-names>T</given-names></name><name><surname>Shaham</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Temporal control of cell-specific transgene expression in caenorhabditis elegans</article-title><source>Genetics</source><volume>176</volume><fpage>2651</fpage><lpage>2655</lpage><pub-id pub-id-type="doi">10.1534/genetics.107.074369</pub-id><pub-id pub-id-type="pmid">17603102</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bao</surname><given-names>Z</given-names></name><name><surname>Murray</surname><given-names>JI</given-names></name><name><surname>Boyle</surname><given-names>T</given-names></name><name><surname>Ooi</surname><given-names>SL</given-names></name><name><surname>Sandel</surname><given-names>MJ</given-names></name><name><surname>Waterston</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Automated cell lineage tracing in caenorhabditis elegans</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>103</volume><fpage>2707</fpage><lpage>2712</lpage><pub-id pub-id-type="doi">10.1073/pnas.0511111103</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Bao</surname><given-names>Z</given-names></name><name><surname>Murray</surname><given-names>JI</given-names></name></person-group><year iso-8601-date="2010">2010</year><chapter-title>Imaging in Developmental Biology: A Laboratory Manual</chapter-title><person-group person-group-type="editor"><name><surname>Sharpe</surname> <given-names>James</given-names></name><name><surname>Wong</surname> <given-names>Rachel</given-names></name><name><surname>Yuste</surname> <given-names>Raphael</given-names></name></person-group><publisher-loc>New York</publisher-loc><publisher-name>Cold Spring Harbor Laboratory Press</publisher-name></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>C. elegans Sequencing Consortium</collab></person-group><year iso-8601-date="1998">1998</year><article-title>Genome sequence of the nematode c. elegans: a platform for investigating biology</article-title><source>Science</source><volume>282</volume><fpage>2012</fpage><lpage>2018</lpage><pub-id pub-id-type="doi">10.1126/science.282.5396.2012</pub-id><pub-id pub-id-type="pmid">9851916</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chilton</surname><given-names>JK</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Molecular mechanisms of axon guidance</article-title><source>Developmental Biology</source><volume>292</volume><fpage>13</fpage><lpage>24</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2005.12.048</pub-id><pub-id pub-id-type="pmid">16476423</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chin-Sang</surname><given-names>I</given-names></name><name><surname>Chisholm</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Form of the worm: genetics of epidermal morphogenesis in c. elegans</article-title><source>Trends in Genetics</source><volume>16</volume><fpage>544</fpage><lpage>551</lpage><pub-id pub-id-type="doi">10.1016/S0168-9525(00)02143-0</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christensen</surname><given-names>R</given-names></name><name><surname>Bokinsky</surname><given-names>A</given-names></name><name><surname>Santella</surname><given-names>A</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Marquina</surname><given-names>J</given-names></name><name><surname>Kovacevic</surname><given-names>I</given-names></name><name><surname>Kumar</surname><given-names>A</given-names></name><name><surname>Winter</surname><given-names>P</given-names></name><name><surname>McCreedy</surname><given-names>E</given-names></name><name><surname>Mohler</surname><given-names>W</given-names></name><name><surname>Bao</surname><given-names>Z</given-names></name><name><surname>Colón-Ramos</surname><given-names>D</given-names></name><name><surname>Shroff</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>An imaging and analysis toolset for the study of caenorhabditis elegans neurodevelopment</article-title><source> SPIE BIOS</source><volume>9334</volume><fpage>93340C</fpage><lpage>93349</lpage><pub-id pub-id-type="doi">10.1117/12.2082394</pub-id><pub-id pub-id-type="doi">10.1117/12.2082394</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ciarletta</surname><given-names>P</given-names></name><name><surname>Ben Amar</surname><given-names>M</given-names></name><name><surname>Labouesse</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Continuum model of epithelial morphogenesis during caenorhabditis elegans embryonic elongation</article-title><source>Philosophical Transactions of the Royal Society A</source><volume>367</volume><fpage>3379</fpage><lpage>3400</lpage><pub-id pub-id-type="doi">10.1098/rsta.2009.0088</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>M</given-names></name><name><surname>Woo</surname><given-names>W</given-names></name><name><surname>Chisholm</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The cytoskeleton and epidermal morphogenesis in</article-title><source>Experimental Cell Research</source><volume>301</volume><fpage>84</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1016/j.yexcr.2004.08.017</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dudanova</surname><given-names>I</given-names></name><name><surname>Klein</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Integration of guidance cues: parallel signaling and crosstalk</article-title><source>Trends in Neurosciences</source><volume>36</volume><fpage>295</fpage><lpage>304</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2013.01.007</pub-id><pub-id pub-id-type="pmid">23485451</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gally</surname><given-names>C</given-names></name><name><surname>Wissler</surname><given-names>F</given-names></name><name><surname>Zahreddine</surname><given-names>H</given-names></name><name><surname>Quintin</surname><given-names>S</given-names></name><name><surname>Landmann</surname><given-names>F</given-names></name><name><surname>Labouesse</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Myosin II regulation during c. elegans embryonic elongation: LET-502/ROCK, MRCK-1 and PAK-1, three kinases with different roles</article-title><source>Development</source><volume>136</volume><fpage>3109</fpage><lpage>3119</lpage><pub-id pub-id-type="doi">10.1242/dev.039412</pub-id><pub-id pub-id-type="pmid">19675126</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giurumescu</surname><given-names>CA</given-names></name><name><surname>Kang</surname><given-names>S</given-names></name><name><surname>Planchon</surname><given-names>TA</given-names></name><name><surname>Betzig</surname><given-names>E</given-names></name><name><surname>Bloomekatz</surname><given-names>J</given-names></name><name><surname>Yelon</surname><given-names>D</given-names></name><name><surname>Cosman</surname><given-names>P</given-names></name><name><surname>Chisholm</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Quantitative semi-automated analysis of morphogenesis with single-cell resolution in complex embryos</article-title><source>Development</source><volume>139</volume><fpage>4271</fpage><lpage>4279</lpage><pub-id pub-id-type="doi">10.1242/dev.086256</pub-id><pub-id pub-id-type="pmid">23052905</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haak</surname><given-names>D</given-names></name><name><surname>Page</surname><given-names>C-E</given-names></name><name><surname>Deserno</surname><given-names>TM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A survey of DICOM viewer software to integrate clinical research and medical imaging</article-title><source>Journal of Digital Imaging</source><pub-id pub-id-type="doi">10.1007/s10278-015-9833-1</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Halfon</surname><given-names>MS</given-names></name><name><surname>Kose</surname><given-names>H</given-names></name><name><surname>Chiba</surname><given-names>A</given-names></name><name><surname>Keshishian</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Targeted gene expression without a tissue-specific promoter: creating mosaic embryos using laser-induced single-cell heat shock</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>94</volume><fpage>6255</fpage><lpage>6260</lpage><pub-id pub-id-type="doi">10.1073/pnas.94.12.6255</pub-id><pub-id pub-id-type="pmid">9177204</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holekamp</surname><given-names>TF</given-names></name><name><surname>Turaga</surname><given-names>D</given-names></name><name><surname>Holy</surname><given-names>TE</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Fast three-dimensional fluorescence imaging of activity in neural populations by objective-coupled planar illumination microscopy</article-title><source>Neuron</source><volume>57</volume><fpage>661</fpage><lpage>672</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.01.011</pub-id><pub-id pub-id-type="pmid">18341987</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huisken</surname><given-names>J</given-names></name><name><surname>Swoger</surname><given-names>J</given-names></name><name><surname>Del Bene</surname><given-names>F</given-names></name><name><surname>Wittbrodt</surname><given-names>J</given-names></name><name><surname>Stelzer</surname><given-names>EH</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Optical sectioning deep inside live embryos by selective plane illumination microscopy</article-title><source>Science</source><volume>305</volume><fpage>1007</fpage><lpage>1009</lpage><pub-id pub-id-type="doi">10.1126/science.1100035</pub-id><pub-id pub-id-type="pmid">15310904</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ito</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Error detection and representation in the olivo-cerebellar system</article-title><source>Frontiers in Neural Circuits</source><volume>7</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.3389/fncir.2013.00001</pub-id><pub-id pub-id-type="pmid">23440175</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keller</surname><given-names>PJ</given-names></name><name><surname>Schmidt</surname><given-names>AD</given-names></name><name><surname>Wittbrodt</surname><given-names>J</given-names></name><name><surname>Stelzer</surname><given-names>EH</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Reconstruction of zebrafish early embryonic development by scanned light sheet microscopy</article-title><source>Science</source><volume>322</volume><fpage>1065</fpage><lpage>1069</lpage><pub-id pub-id-type="doi">10.1126/science.1162493</pub-id><pub-id pub-id-type="pmid">18845710</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koh</surname><given-names>K</given-names></name><name><surname>Rothman</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>ELT-5 and ELT-6 are required continuously to regulate epidermal seam cell differentiation and cell fusion in C. elegans</article-title><source>Development</source><volume>128</volume><fpage>2867</fpage><lpage>2880</lpage><pub-id pub-id-type="pmid">11532911</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolodkin</surname><given-names>AL</given-names></name><name><surname>Tessier-Lavigne</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Mechanisms and molecules of neuronal wiring: a primer</article-title><source>Cold Spring Harbor Perspectives in Biology</source><volume>3</volume><fpage>a001727</fpage><pub-id pub-id-type="doi">10.1101/cshperspect.a001727</pub-id><pub-id pub-id-type="pmid">21123392</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>A</given-names></name><name><surname>Colón-Ramos</surname><given-names>DA</given-names></name><name><surname>Shroff</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Watching a roundworm develop with a sheet of light</article-title><source>Physics Today</source><volume>68</volume><fpage>58</fpage><lpage>59</lpage><pub-id pub-id-type="doi">10.1063/PT.3.2856</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>A</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Christensen</surname><given-names>R</given-names></name><name><surname>Chandris</surname><given-names>P</given-names></name><name><surname>Gandler</surname><given-names>W</given-names></name><name><surname>McCreedy</surname><given-names>E</given-names></name><name><surname>Bokinsky</surname><given-names>A</given-names></name><name><surname>Colón-Ramos</surname><given-names>DA</given-names></name><name><surname>Bao</surname><given-names>Z</given-names></name><name><surname>McAuliffe</surname><given-names>M</given-names></name><name><surname>Rondeau</surname><given-names>G</given-names></name><name><surname>Shroff</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Dual-view plane illumination microscopy for rapid and spatially isotropic imaging</article-title><source>Nature Protocols</source><volume>9</volume><fpage>2555</fpage><lpage>2573</lpage><pub-id pub-id-type="doi">10.1038/nprot.2014.172</pub-id><pub-id pub-id-type="pmid">25299154</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lakadamyali</surname><given-names>M</given-names></name><name><surname>Babcock</surname><given-names>H</given-names></name><name><surname>Bates</surname><given-names>M</given-names></name><name><surname>Zhuang</surname><given-names>X</given-names></name><name><surname>Lichtman</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>3D multicolor super-resolution imaging offers improved accuracy in neuron tracing</article-title><source>PloS One</source><volume>7</volume><fpage>e30826</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0030826</pub-id><pub-id pub-id-type="pmid">22292051</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Livet</surname><given-names>J</given-names></name><name><surname>Weissman</surname><given-names>TA</given-names></name><name><surname>Kang</surname><given-names>H</given-names></name><name><surname>Draft</surname><given-names>RW</given-names></name><name><surname>Lu</surname><given-names>J</given-names></name><name><surname>Bennis</surname><given-names>RA</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Lichtman</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Transgenic strategies for combinatorial expression of fluorescent proteins in the nervous system</article-title><source>Nature</source><volume>450</volume><fpage>56</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1038/nature06293</pub-id><pub-id pub-id-type="pmid">17972876</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Long</surname><given-names>F</given-names></name><name><surname>Peng</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Kim</surname><given-names>SK</given-names></name><name><surname>Myers</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A 3D digital atlas of C. elegans and its application to single-cell analyses</article-title><source>Nature Methods</source><volume>6</volume><fpage>667</fpage><lpage>672</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1366</pub-id><pub-id pub-id-type="pmid">19684595</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McAuliffe</surname><given-names>M</given-names> </name><name><surname>Lolande</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Medical image processing, analysis, and visualization in clinical research</article-title><source>Proc. 14th IEEE Symp. Computer-Based Medical Systems</source><fpage>381</fpage><lpage>386</lpage></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Norman</surname><given-names>KR</given-names></name><name><surname>Moerman</surname><given-names>DG</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Alpha spectrin is essential for morphogenesis and body wall muscle formation in caenorhabditis elegans</article-title><source>The Journal of Cell Biology</source><volume>157</volume><fpage>665</fpage><lpage>677</lpage><pub-id pub-id-type="doi">10.1083/jcb.200111051</pub-id><pub-id pub-id-type="pmid">11994313</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Donnell</surname><given-names>M</given-names></name><name><surname>Chance</surname><given-names>RK</given-names></name><name><surname>Bashaw</surname><given-names>GJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Axon growth and guidance: receptor regulation and signal transduction</article-title><source>Annual Review of Neuroscience</source><volume>32</volume><fpage>383</fpage><lpage>412</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.051508.135614</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>H</given-names></name><name><surname>Long</surname><given-names>F</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Kim</surname><given-names>SK</given-names></name><name><surname>Myers</surname><given-names>EW</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Straightening caenorhabditis elegans images</article-title><source>Bioinformatics</source><volume>24</volume><fpage>234</fpage><lpage>242</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btm569</pub-id><pub-id pub-id-type="pmid">18025002</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Priess</surname><given-names>JR</given-names></name><name><surname>Hirsh</surname><given-names>DI</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Caenorhabditis elegans morphogenesis: the role of the cytoskeleton in elongation of the embryo</article-title><source>Developmental Biology</source><volume>117</volume><fpage>156</fpage><lpage>173</lpage><pub-id pub-id-type="doi">10.1016/0012-1606(86)90358-1</pub-id><pub-id pub-id-type="pmid">3743895</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Santella</surname><given-names>A</given-names></name><name><surname>Catena</surname><given-names>R</given-names></name><name><surname>Kovacevic</surname><given-names>I</given-names></name><name><surname>Shah</surname><given-names>P</given-names></name><name><surname>Yu</surname><given-names>Z</given-names></name><name><surname>Marquina-Solis</surname><given-names>J</given-names></name><name><surname>Kumar</surname><given-names>A</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Schaff</surname><given-names>J</given-names></name><name><surname>Colón-Ramos</surname><given-names>D</given-names></name><name><surname>Shroff</surname><given-names>H</given-names></name><name><surname>Mohler</surname><given-names>WA</given-names></name><name><surname>Bao</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>WormGUIDES: an interactive single cell developmental atlas and tool for collaborative multidimensional data exploration</article-title><source>BMC Bioinformatics</source><volume>16</volume><fpage>189</fpage><pub-id pub-id-type="doi">10.1186/s12859-015-0627-8</pub-id><pub-id pub-id-type="pmid">26051157</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Santella</surname><given-names>A</given-names></name><name><surname>Du</surname><given-names>Z</given-names></name><name><surname>Nowotschin</surname><given-names>S</given-names></name><name><surname>Hadjantonakis</surname><given-names>AK</given-names></name><name><surname>Bao</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A hybrid blob-slice model for accurate and efficient detection of fluorescence labeled nuclei in 3D</article-title><source>BMC Bioinformatics</source><volume>11</volume><fpage>580</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-11-580</pub-id><pub-id pub-id-type="pmid">21114815</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Santi</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Light sheet fluorescence microscopy: a review</article-title><source>The Journal of Histochemistry and Cytochemistry </source><volume>59</volume><fpage>129</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1369/0022155410394857</pub-id><pub-id pub-id-type="pmid">21339178</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sulston</surname><given-names>JE</given-names></name><name><surname>Schierenberg</surname><given-names>E</given-names></name><name><surname>White</surname><given-names>JG</given-names></name><name><surname>Thomson</surname><given-names>JN</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>The embryonic cell lineage of the nematode caenorhabditis elegans</article-title><source>Developmental Biology</source><volume>100</volume><fpage>64</fpage><lpage>119</lpage><pub-id pub-id-type="doi">10.1016/0012-1606(83)90201-4</pub-id><pub-id pub-id-type="pmid">6684600</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Terns</surname><given-names>RM</given-names></name><name><surname>Kroll-Conner</surname><given-names>P</given-names></name><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Chung</surname><given-names>S</given-names></name><name><surname>Rothman</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>A deficiency screen for zygotic loci required for establishment and patterning of the epidermis in caenorhabditis elegans</article-title><source>Genetics</source><volume>146</volume><fpage>185</fpage><lpage>206</lpage><pub-id pub-id-type="pmid">9136010</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Thomson</surname><given-names>N</given-names></name></person-group><article-title>EM image 2-fold_993, from 2-fold image set</article-title><ext-link ext-link-type="uri" xlink:href="http://www.wormimage.org">www.wormimage.org</ext-link></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Totong</surname><given-names>R</given-names></name><name><surname>Achilleos</surname><given-names>A</given-names></name><name><surname>Nance</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>PAR-6 is required for junction formation but not apicobasal polarization in c. elegans embryonic epithelial cells</article-title><source>Development</source><volume>134</volume><fpage>1259</fpage><lpage>1268</lpage><pub-id pub-id-type="doi">10.1242/dev.02833</pub-id><pub-id pub-id-type="pmid">17314130</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wenick</surname><given-names>AS</given-names></name><name><surname>Hobert</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Genomic cis-regulatory architecture and trans-acting regulators of a single interneuron-specific gene battery in c. elegans</article-title><source>Developmental Cell</source><volume>6</volume><fpage>757</fpage><lpage>770</lpage><pub-id pub-id-type="doi">10.1016/j.devcel.2004.05.004</pub-id><pub-id pub-id-type="pmid">15177025</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>JG</given-names></name><name><surname>Southgate</surname><given-names>E</given-names></name><name><surname>Thomson</surname><given-names>JN</given-names></name><name><surname>Brenner</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>The structure of the nervous system of the nematode caenorhabditis elegans</article-title><source>Philosophical Transactions of the Royal Society B</source><volume>314</volume><fpage>1</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1098/rstb.1986.0056</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winter</surname><given-names>PW</given-names></name><name><surname>York</surname><given-names>AG</given-names></name><name><surname>Nogare</surname><given-names>DD</given-names></name><name><surname>Ingaramo</surname><given-names>M</given-names></name><name><surname>Christensen</surname><given-names>R</given-names></name><name><surname>Chitnis</surname><given-names>A</given-names></name><name><surname>Patterson</surname><given-names>GH</given-names></name><name><surname>Shroff</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Two-photon instant structured illumination microscopy improves the depth penetration of super-resolution imaging in thick scattering samples</article-title><source>Optica</source><volume>1</volume><fpage>181</fpage><lpage>191</lpage><pub-id pub-id-type="doi">10.1364/OPTICA.1.000181</pub-id><pub-id pub-id-type="pmid">25485291</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Christensen</surname><given-names>R</given-names></name><name><surname>Colón-Ramos</surname><given-names>D</given-names></name><name><surname>Shroff</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013a</year><article-title>Advanced optical imaging techniques for neurodevelopment</article-title><source>Current Opinion in Neurobiology</source><volume>23</volume><fpage>1090</fpage><lpage>1097</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2013.06.008</pub-id><pub-id pub-id-type="pmid">23831260</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Ghitani</surname><given-names>A</given-names></name><name><surname>Christensen</surname><given-names>R</given-names></name><name><surname>Santella</surname><given-names>A</given-names></name><name><surname>Du</surname><given-names>Z</given-names></name><name><surname>Rondeau</surname><given-names>G</given-names></name><name><surname>Bao</surname><given-names>Z</given-names></name><name><surname>Colon-Ramos</surname><given-names>D</given-names></name><name><surname>Shroff</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Inverted selective plane illumination microscopy (iSPIM) enables coupled cell identity lineaging and neurodevelopmental imaging in caenorhabditis elegans</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>108</volume><fpage>17708</fpage><lpage>17713</lpage><pub-id pub-id-type="doi">10.1073/pnas.1108494108</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Wawrzusin</surname><given-names>P</given-names></name><name><surname>Senseney</surname><given-names>J</given-names></name><name><surname>Fischer</surname><given-names>RS</given-names></name><name><surname>Christensen</surname><given-names>R</given-names></name><name><surname>Santella</surname><given-names>A</given-names></name><name><surname>York</surname><given-names>AG</given-names></name><name><surname>Winter</surname><given-names>PW</given-names></name><name><surname>Waterman</surname><given-names>CM</given-names></name><name><surname>Bao</surname><given-names>Z</given-names></name><name><surname>Colón-Ramos</surname><given-names>DA</given-names></name><name><surname>McAuliffe</surname><given-names>M</given-names></name><name><surname>Shroff</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013b</year><article-title>Spatially isotropic four-dimensional imaging with dual-view plane illumination microscopy</article-title><source>Nature Biotechnology</source><volume>31</volume><fpage>1032</fpage><lpage>1038</lpage><pub-id pub-id-type="doi">10.1038/nbt.2713</pub-id><pub-id pub-id-type="pmid">24108093</pub-id></element-citation></ref></ref-list><app-group><app id="app1"><title>Appendix</title><boxed-text><sec id="s14" sec-type="appendix"><title>Appendix, further details on lattice building, worm modeling, and untwisting</title><p>The untwisting algorithm is a semi-automatic process involving automatic segmentation of the seam cell nuclei and automatic lattice-building combined with user-interactive reviewing and editing phases. This procedure results in a lattice that bends and twists in the 3D volume, capturing the structure of the worm embryo. The lattice sets the parameters for generating the worm model, which in turn defines how the worm is untwisted.</p></sec><sec id="s15" sec-type="appendix"><title>Pipeline overview</title><p>The pipeline processes the series of volumes in batch mode, then presents the results to the user for viewing and editing. The user can quickly step through the results making changes as necessary then proceed with the next batch process. The pipeline automatically switches to the next step in the process once the current step has completed. Steps are:</p><p>1. Automatic seam cell nuclei segmentation</p><p>2. Review and edit seam cell nuclei (the user adds an optional nose marker or seam cell segmentations)</p><p>3. Automatic lattice-building</p><p>4. Review and edit lattice (the user adds optional lattice points to better follow the curvature of the worm)</p><p>5. User interactively places annotations marking points of interest</p><p>6. Automatic model-building and untwisting</p><p>7. Review straightened volumes</p></sec><sec id="s16" sec-type="appendix"><title>Automatic seam cell segmentation</title><p>Several standard segmentation and clustering algorithms have been tried; to date the most accurate segmentation algorithm clusters regions of uniform intensity into seam cell nuclei. The algorithm searches for clusters with diameters in the range of 2.5–4.8 microns. This criterion prevents regions of the worm digestive tract from being labeled as a seam cell nucleus - even though the high intensity and near-spherical appearance of the digestive tract matches the seam cell nuclei, the digestive tract is less uniform throughout its structure.</p><p>There are several challenges to producing an accurate segmentation of the seam cell nuclei. The algorithm must segment nuclei with very different intensity threshold values, sizes and shapes. Not all seam cell nuclei are spherical due to motion blur. The algorithm must distinguish between seam cell nuclei and other features of the worm similar to the seam cell nuclei, for example the valves in the worm’s digestive tract. Often the nose of the worm is labeled a seam cell nucleus while the 10<sup>th</sup> pair of seam cell nuclei, because they appear much fainter and are closer together than all other pairs, are combined into a single marker or simply not segmented at all. Accurate segmentation is complicated by division of the 8<sup>th</sup> pair of seam cell nuclei (QV5) at the later stages of the embryo’s growth. During subdivision the QV5 pair is difficult to detect, and they may divide at different times, which causes the algorithm to detect 21 cells instead of 20 or 22 (<xref ref-type="fig" rid="fig7">Appendix 1—figure 1</xref>). These factors imply that the user must review and edit the seam cell nuclei placements.</p><p>The user experience during the editing phase in turn influences the segmentation algorithm. Users have found that it is quicker and easier to add missing seam cell nuclei than to delete extra seam cell nuclei. This feedback caused us to modify the segmentation algorithm, erring on the side of more accurate segmentation that detects fewer seam cell nuclei, rather than labeling extra regions as seam cell nuclei in the attempt to detect all 20 (<xref ref-type="fig" rid="fig7">Appendix 1—figure 1</xref>).</p></sec><sec id="s17" sec-type="appendix"><title>Review and edit</title><p>When the automatic seam cell nuclei segmentation is complete, the user can view each file and edit the segmentations (<xref ref-type="fig" rid="fig8">Appendix 1—figure 2</xref>). The user also has the option to add an additional point to mark the nose of the worm, which increases the accuracy of automated lattice-building (<xref ref-type="fig" rid="fig9">Appendix 1—figure 3</xref>). Editing is accomplished by clicking in the volume view pane with the mouse.</p><p>Selecting a 3D position in the volume with the 2D mouse input device is accomplished by mapping the mouse position to a 3D position in space using the maximum intensity in the volume that falls under the mouse location. The model transformations (translations, rotations), viewing transformation (zoom), and projection transformations are used to generate a 3D ray originating at the 2D mouse position. The ray passes through the 3D volume along the viewing direction. The 3D volume position (voxel) along the ray with the maximum intensity determines the selected point in 3D.</p><p>Because the automatic lattice-building algorithm takes as input either 20 or 22 unordered seam cell nuclei, the user is encouraged to ensure that after editing the correct number of seam cell nuclei are labeled. To help the user achieve this goal, the color of the seam cell nuclei markers change to indicate if the target number has been reached. All seam cell nuclei are colored yellow when there are either 21 seam cell nuclei marked or fewer than 20 nuclei marked (<xref ref-type="fig" rid="fig7">Appendix 1—figure 1</xref>). If exactly 20 or 22 seam cell nuclei are marked they are colored green (<xref ref-type="fig" rid="fig8">Appendix 1—figure 2</xref>). Anytime more than 22 seam cell nuclei are labeled all are colored red. This feature provides a visual clue to the user if there are too few or too many seam cell nuclei, and that editing is not complete.</p><p>The following example images show results from the automatic seam cell nuclei segmentation algorithm followed by the edited segmentations:</p></sec><sec id="s18" sec-type="appendix"><title>Automatic lattice-building</title><p>The automatic lattice building algorithm generates a lattice representation of the worm. The algorithm takes as input a set of up to 22 unordered points in the 3D volume, as well as an (optional) nose point. The algorithm automatically generates lattices based on the relative positions of those points and sets of threshold values that were determined empirically from hand-generated lattices, i.e. from priors determined directly from measurements on untwisted worm volumes. The output is the 5 highest-rank lattices where the lattices are evaluated based on minimizing the overall curvature of the lattice as well as minimizing the amount each lattice self-intersects. The algorithm for automatically generating lattices from the collection of 3D points is described in detail below.</p><p>Given a set of up to 22 unordered seam cell nuclei positions in 3D, the algorithm generates pairs of seam cell nuclei and outputs an ordered sequence of those pairs. The ordered sequence forms a lattice from the head of the worm to the tail of the worm. If the nose of the worm is included in the set of points it is incorporated into the lattice and used at the evaluation and ranking stages.</p><p>The algorithm works in a stepwise fashion, first identifying the T seam cells and then working nosewards from them to build potential lattices. Lattices are checked both during construction and after completion for compliance with a series of parameters experimentally determined from hand-built lattices; lattices that pass all checks are displayed to the user for final selection and editing. The steps in the lattice-building process are described in more detail below.</p><p><bold>Step 1:</bold> Find and label all possible 10<sup>th</sup> pairs. The 10<sup>th</sup> seam cell nuclei pair is located at the tail of the worm. It is distinct from the 9 other seam cell nuclei pairs as it is much closer together. The minimum and maximum distances between seam cells for the 10<sup>th</sup> pair are set to 1 and 5 microns. In contrast, the minimum and maximum distances for all other pairs are set to 5 to 15 microns.</p><p>Pairs of points that fall within the minimum and maximum thresholds for the 10<sup>th</sup> pair are evaluated using a mid-point test. The test calculates the mid-point between the two seam cell nuclei and if there is another seam cell nucleus that is closer to the mid-point than the potential pair, the pair is ruled out. If the pair passes all mid-point tests it is labeled as a potential 10<sup>th</sup> pair.</p><p><bold>Step 2</bold>: For each potential 10<sup>th</sup> pair, build all possible sequences starting at the 10<sup>th</sup> pair and work backward to the head of the worm.</p><p>a. The first step in building sequences from a given 10<sup>th</sup> pair is to generate the set of all potential pairs with the remaining points. Pairs must fall within the minimum and maximum threshold values of 5-15 microns. In addition each pair must pass the mid-point test, ensuring that no other point is closer to the mid-point of the pair.</p><p>b. For a given set of pairs, the set is searched to determine if any point occurs only in one pair. This pair is deemed an ‘essential pair’, as not including it would mean excluding the point found only in that pair. For each essential pair the remaining pairs are examined and all pairs with the partner of the unique point are eliminated. This process of elimination can generate other essential pairs so this step is repeated until no more essential pairs are found.</p><p>c. Once the pair set is determined, sequences are built from the 10<sup>th</sup> pair until a complete lattice is formed. If at any point in the lattice-building process the lattice in progress fails to meet criteria it is eliminated from the set of potential lattices.</p><p>Given a sequence of pairs in a lattice, a new pair is added to the lattice if the following criteria (determined from analysis of hand-built lattices) are met:</p><p>i. The angle between the left-edge and right-edge from the last pair in the sequence to the current pair (the amount of twist) is less than 90 degrees.</p><p>ii. The difference in length between the left-edge and right-edge sequences is less than 12 microns.</p><p>iii. The distance from the mid-point between last pair and the mid-point of the current pair is greater than 4 microns and below 30 microns.</p><p>iv. The distance between the last left-edge point and the current left point is greater than 4 microns and less than 25 microns.</p><p>v. The distance between the last right-edge point and the current right point is greater than 4 microns and less than 25 microns.</p><p><bold>Step 3</bold>: When a sequence reaches a length of 10 (or 11) pairs it is evaluated. Sequences that fail to reach the target length are eliminated. A sequence is accepted if it meets the following criteria:</p><p>a. For each pair in the lattice no other point is closer to the pair mid-point (<xref ref-type="fig" rid="fig10">Appendix 1—figure 4</xref>).</p><p>b. The average width of the first 4 lattice pairs is wider than the average width of the last 5 lattice pairs.</p><p>c. The maximum width occurs in the first 4 lattice pairs.</p><p>d. The curvature of the lattice is between 2 (540 degrees of bend) and 4 folds.</p><p>e. The total length of the lattice, calculated by summing the mid-point distances is greater than 100 microns and less than 140 microns.</p><p>f. The distances between the mid-points of lattice pairs fall within threshold values, with a minimum distance of 5 microns and a maximum distance of 25 microns.</p><p><bold>Step 4:</bold> Lattices are ranked to determine the top 5 lattices. Ranking is determined by minimizing the following two values:</p><p>a. Lattice curvature, which is a measure of the total amount of bend as calculated by measuring the angle from one mid-point on the lattice to the next.</p><p>b. Amount of lattice self-intersection, which is approximated by intersecting the bounding boxes formed around sequential lattice pairs.</p><p>As an example, the algorithm starts with a set of 20 unordered seam cell nuclei positions in 3D. Two pairs were categorized as being a possible 10<sup>th</sup> pair. For the first of the possible 10<sup>th</sup> pairs, the remaining 18 seam cell nuclei, which unconstrained would generated a set of (18!) possible pairs, instead produced 100 pairs that fell within the minimum/maximum distance threshold, of which only 31 met the mid-point test. After eliminating pairs based on the ‘essential pair’ criteria only 27 potential pairs remained. For the second of the possible 10<sup>th</sup> pairs, with 18 remaining seam cells only 104 possible pairs met the minimum/maximum distance threshold and of those only 33 pairs satisfied the mid-point test. Eliminating pairs based on the ‘essential pair’ criteria further reduced the pool of potential pairs to 28. 27 choose 9 is 4,686,825 lattices and 28 choose 9 is 6,906,900 lattices; too many to evaluate. However, automatically eliminating lattices during the building process reduced this number to 22,916 lattices that reached the target length of 10 pairs. Of those only 21 lattices passed the evaluation phase. After ranking the 21 lattices, the correct lattice was listed at the top-ranked lattice (<xref ref-type="fig" rid="fig11">Appendix 1—figure 5</xref>).</p></sec><sec id="s19" sec-type="appendix"><title>Review and edit lattice</title><p>During the review and edit phase the user steps through the selected volumes. For each volume up to 5 of the highest-ranked lattices are presented to the user, enabling the user to select the lattice that best fits the data. In some cases the algorithm finds less than 5 lattices and presents all those found. The user has the option to modify the selected lattice by adjusting the placement of points in the lattice or by adding points to the lattice so that the model better matches the worm. Once the user has finished editing the lattice it is saved for future reference (<xref ref-type="fig" rid="fig12">Appendix 1—figure 6</xref>).</p></sec><sec id="s20" sec-type="appendix"><title>Building the lattice manually</title><p>When the automatic lattice-building algorithm fails, the user has the option to build the entire lattice by hand, marking the points of the lattice with the mouse.</p><p>The user creates a lattice for a worm volume interactively in the volume view of the plugin. The volume view enables the user to rotate the volume in 3D to view it from different angles, or to view the volume at different scales. The user selects points in the 3D volume by clicking with the mouse.</p><p>The user starts at the head of the worm and interactively selects points in the 3D volume as left-right pairs, building the lattice as they go. The left-right markers visible along the sides of the worm (consisting of fluorescently-labeled seam cells and junctions between epidermal calls) are used to build the lattice. Because the volume appears mostly transparent except for the seam cell markers, the left-right markers are easy to select in 3D. The user can also interactively move points in the lattice after they are placed to better fit the data. Undo and redo features are also part of the lattice-building interface.</p><p>There are 10 pairs of seam cells along the left and right sides of the worm body. While these cells act as the primary markers when building the lattice, they are spaced too far apart to capture every bend in the worm. Labeled contacts between epidermal cells provide another set of markers which can be selected by the user to create additional pairs. This enables the user to better define the curve of the worm. <xref ref-type="fig" rid="fig13">Appendix 1—figures 7</xref>–<xref ref-type="fig" rid="fig15">9</xref> show lattice building in progress.<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.039</object-id><label>Appendix 1—figure 1.</label><caption><title>Output of the automatic seam cell nucleus detection algorithm shown before editing starts. </title><p>The markers are yellow, indicating that fewer than 20 seam cell nuclei have been labeled.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.039">http://dx.doi.org/10.7554/eLife.10070.039</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig1-v2"/></fig><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.040</object-id><label>Appendix 1—figure 2.</label><caption><title>User editing.</title><p>The user shifts seam cell nucleus #9 over, adds markers for both of the 10<sup>th</sup> seam cell nuclei, shifts nucleus #6 over and adds nucleus #20. There are now 20 seam cell nuclei marked, as indicated by the green color.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.040">http://dx.doi.org/10.7554/eLife.10070.040</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig2-v2"/></fig><fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.041</object-id><label>Appendix 1—figure 3.</label><caption><title>Nose labeling.</title><p>The user has increased the opacity of the volume to better enhance the appearance of the nose, now labeled in yellow.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.041">http://dx.doi.org/10.7554/eLife.10070.041</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig3-v2"/></fig><fig id="fig10" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.042</object-id><label>Appendix 1—figure 4.</label><caption><title>Pairing quality control.</title><p>A potential pair is found, with the mid-point marked in red. A third seam cell nucleus is found closer to the mid-point than the pair, invalidating the pair.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.042">http://dx.doi.org/10.7554/eLife.10070.042</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig4-v2"/></fig><fig id="fig11" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.043</object-id><label>Appendix 1—figure 5.</label><caption><title>Automatic lattice-building output.</title><p>The correct lattice is listed first as it had the highest rank.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.043">http://dx.doi.org/10.7554/eLife.10070.043</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig5-v2"/></fig><fig id="fig12" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.044</object-id><label>Appendix 1—figure 6.</label><caption><title>The lattice after editing by the user.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.044">http://dx.doi.org/10.7554/eLife.10070.044</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig6-v2"/></fig><fig id="fig13" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.045</object-id><label>Appendix 1—figure 7.</label><caption><title>The user has started building the lattice starting at the head of the worm.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.045">http://dx.doi.org/10.7554/eLife.10070.045</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig7-v2"/></fig><fig id="fig14" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.046</object-id><label>Appendix 1—figure 8.</label><caption><title>More points are added to the lattice.</title><p>The user rotates the volume to get a better view during this phase. The magenta, red, and green curves represent the left- hand curve, center-line curve, and right-hand curves respectively. The curves are natural splines which are guaranteed to pass through the user-selected lattice points while minimizing bending to produce a smooth curve that matches the shape of the worm fairly accurately.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.046">http://dx.doi.org/10.7554/eLife.10070.046</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig8-v2"/></fig><fig id="fig15" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.047</object-id><label>Appendix 1—figure 9.</label><caption><title>The final lattice.</title><p>Each of the 10 seam-cell pairs is marked, and 8 additional pairs have been added to capture the curve of the worm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.047">http://dx.doi.org/10.7554/eLife.10070.047</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig9-v2"/></fig></p></sec><sec id="s21" sec-type="appendix"><title>Interactively placing annotations</title><p>The program also features the ability to add annotation points, for which the program records the X, Y, and Z-coordinate in relation to a user-defined origin point (typically the nose), and then outputs that location information in a spreadsheet file. The annotation points can be used to define the position of a cell or cellular structure in each worm volume so spatial displacement can be measured over time. Thus a user can examine the position of a specific cell or structure of interest in multiple worm volumes, to determine how stereotyped the position of that cell is during embryo development (<xref ref-type="fig" rid="fig16">Appendix 1—figure 10</xref>).<fig id="fig16" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.048</object-id><label>Appendix 1—figure 10.</label><caption><title>Annotations added to the worm volume labeling parts of the neuron.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.048">http://dx.doi.org/10.7554/eLife.10070.048</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig10-v2"/></fig></p><p>An integrated rendering capability, which graphically displays the position of the annotation points over time, enables a user to directly visualize how the various annotation points relate to each other in the developing embryo ( <xref ref-type="fig" rid="fig17">Appendix 1—figure 11</xref>). This capability allows a user to identify the position of a neuron or cell of interest throughout development, and display how that position relates to the rest of the worm and changes over time.<fig id="fig17" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.049</object-id><label>Appendix 1—figure 11.</label><caption><title>Annotation visualization tool displays changes in positions over time.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.049">http://dx.doi.org/10.7554/eLife.10070.049</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig11-v2"/></fig></p></sec><sec id="s22" sec-type="appendix"><title>Automated model-building</title><p>Once the lattice for a worm volume is created, the next step in untwisting the worm volume is to generate a 3D model of the worm from the lattice. The goal is to capture as accurately as possible the 3D shape of the worm. For places where the worm folds back on top of itself and the outer surfaces of the worm touch this is a difficult challenge due to the transparent nature of the worm and lack of a clear boundary between the inside and outside of the worm. This section describes building the worm model and algorithms that attempt to account for overlapping sections of the worm.</p><p>Modeling the worm is done automatically, but the user has the option to view the model and interactively modify the lattice to improve the model's accuracy.</p><p>To build the worm model, the algorithm interpolates between the lattice points, creating two smooth curves from head to tail along the left and right-hand sides of the worm body. A third curve down the center-line of the worm body is also generated. Eventually, the center-line curve will be used to determine the number of sample points along the length of the straightened worm, and therefore the final length of the straightened worm volume (<xref ref-type="fig" rid="fig18">Appendix 1—figure 12</xref>).<fig id="fig18" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.050</object-id><label>Appendix 1—figure 12.</label><caption><title>The initial ellipse-based model of the worm.</title><p>The ellipses fit within the boundaries of the natural spline curves.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.050">http://dx.doi.org/10.7554/eLife.10070.050</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig12-v2"/></fig></p><p>Given the center-line curve and left and right-side curves, a series of planes is defined. The center-line curve is uniformly sampled with a spacing of one voxel. This point serves as the center of the plane, while the first derivative to the curve serves as the plane normal. The plane horizontal axis is the vector between the corresponding points on the left and right-hand curves. The plane vertical axis is constrained to the axis perpendicular to both the plane normal and horizontal axis. This way the three curves fully define the sample plane in 3D.</p><p>Once 2D sampling planes have been determined, each sampling plane is constrained by an elliptical model of the worm cross-section with limits defined by the left- and right-side curves. The elliptical model is tested for regions of the worm where the ellipses overlap and all voxels that fall into overlapping areas are removed, producing a set of new contours. The new contours are then expanded outward from the center, until they either contact an expanding contour line from another region of the worm or reach the limit of the sample plane. This process defines the 2D sampling planes and contours within the planes that are used to create the worm model. <xref ref-type="fig" rid="fig18">Appendix 1—figure 12</xref> shows the original elliptical model of the worm, <xref ref-type="fig" rid="fig19">Appendix 1—figure 13</xref> shows the corrected and expanded contours, and <xref ref-type="fig" rid="fig20">Appendix 1—figures 14</xref>–<xref ref-type="fig" rid="fig22">16</xref> show a solid version of the worm model.<fig id="fig19" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.051</object-id><label>Appendix 1—figure 13.</label><caption><title>The expanded worm model.</title><p>The original ellipses are expanded until they contact an adjacent surface of the worm or they reach the boundary of the sample plane.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.051">http://dx.doi.org/10.7554/eLife.10070.051</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig13-v2"/></fig><fig id="fig20" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.052</object-id><label>Appendix 1—figure 14.</label><caption><title>A solid representation of the worm surface.</title><p>The outlines in the bottom three panels show how the surface encapsulates the volume data.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.052">http://dx.doi.org/10.7554/eLife.10070.052</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig14-v2"/></fig><fig id="fig21" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.053</object-id><label>Appendix 1—figure 15.</label><caption><title>A semi-transparent view of the worm surface model, with the lattice shown inside.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.053">http://dx.doi.org/10.7554/eLife.10070.053</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig15-v2"/></fig><fig id="fig22" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.054</object-id><label>Appendix 1—figure 16.</label><caption><title>A semi-transparent view of the worm surface model displaying lattice curves, fluorescently- labeled seam cell nuclei, and neuron.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.054">http://dx.doi.org/10.7554/eLife.10070.054</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig16-v2"/></fig></p><p>During the expansion process a segmented model of the left-right fluorescent markers is used to improve accuracy (<xref ref-type="fig" rid="fig23">Appendix 1—figure 17</xref>). The segmented marker image labels all voxels that fall inside the fluorescent markers with a unique marker ID. This helps distinguish adjacent edges of the worm where markers may come into contact, prevents one edge of the model from expanding and capturing data from a contacting surface instead of stopping at the correct surface boundary, and ensures that the entire segmented marker is included in the worm model. The image-based corrections require that data from all color channels be processed simultaneously.</p><sec id="s23"><title>Further details in a step-by-step format</title><p>1. All lattices as well as any annotation statistics are saved to file for future analysis.</p><p>2. The fluorescent markers in the worm volume are automatically labeled with a corresponding marker ID. (<xref ref-type="fig" rid="fig23">Appendix 1—figure 17</xref>)<fig id="fig23" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.055</object-id><label>Appendix 1—figure 17.</label><caption><title>Labeled fluorescent markers.</title><p>Each pair has a unique color value, indicating which pairs belong on the same slice in the final straightened image. Labeling the lattice pairs this way helps disambiguate voxels with potential conflicts.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.055">http://dx.doi.org/10.7554/eLife.10070.055</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig17-v2"/></fig></p><p>3. The center line of the worm is calculated from the midpoint between the left and right points of the lattice.</p><p>4. Three curves are generated from the three sets of points (left, center, right) using natural splines to fit the points. Natural splines generate curves that pass through the control points, have continuous first and second derivatives and minimize the bending between points (<xref ref-type="fig" rid="fig15">Appendix 1—figure 9</xref>).</p><p>5. The center curve is uniformly sampled along the length of the curve. The step size is set to be one voxel. This determines the length of the final straightened image and ensures that each slice in the straightened image is equally spaced. The points along the curve are the center-points of the output slices.</p><p>6. Each spline can be parameterized with the parameter <italic>t</italic>, where the start of the curve has <italic>t</italic> = 0 and the end of the curve has <italic>t</italic> = 1. <italic>t</italic> is calculated on the center curve, and used to determine the corresponding locations on the left and right hand curves, which may be longer or shorter than the center curve, depending on how the worm bends. Using the parameterization ensures that the left and right hand curves are sampled the same number of times as the center curve and that the points from start to end on all curves are included.</p><p>7. Given the current point on the center curve and the corresponding positions on the left and right hand curves, the 2D sampling plane can be defined. The center point of the plane is the current point on the center curve. The plane normal is the first derivative of the center line spline. The plane horizontal axis is the vector from the position on the left hand curve to the position on the right hand curve. The plane vertical axis is the cross-product of the plane normal with the plane horizontal axis. This method fully defines the sample plane location and orientation as it sweeps through the 3D volume of the worm.</p><p>8. Once the sample planes are defined, the worm cross-section within each plane needs to be determined. Without a model of the worm cross-section the sample planes will overlap in areas where the worm folds back on itself. The first step in modeling the worm cross-section is to define an ellipse within each sample plane, centered in the plane. The long axis of the ellipse is parallel to the horizontal axis of the sample plane. The length is the distance between the left and right hand points. The ellipse short axis is in the direction of the plane vertical axis; the length is set to 1/2 the length of the ellipse long axis. This ellipse-based model approximates the overall shape of the worm, however it cannot model how the worm shape changes where sections of the worm press against each other. The next step of the algorithm attempts to solve this problem. (<xref ref-type="fig" rid="fig18">Appendix 1—figure 12</xref>).</p><p>9. The set of ellipses from the head of the worm to the tail defines an approximate outer boundary of the worm in 3D. The centers of each ellipse are spaced one voxel apart along the center line curve of the worm, and each ellipse corresponds to a single output slice in the final straightened image. This step generates a model of the worm where each voxel that falls within one of the ellipses is labeled with the corresponding output slice value. Voxels where multiple ellipses intersect are labeled as conflict voxels. Once all ellipses have been evaluated, the conflict voxels are removed from the model.</p><p>10. The marker segmentation image is used to resolve conflicts where multiple ellipses overlap. Each slice in the output image should extend only to the edges of the left-right markers for the corresponding region of the worm volume. This prevents a slice from extending beyond the worm boundary and capturing the adjacent worm region. Because the marker segmentation image only segments the left-right markers, it is not possible to resolve all possible conflicts.</p><p>11. The last step is an attempt to ensure that as much of the worm data is captured by the algorithm as possible. Using the marker segmentation image where possible as a guide to the worm boundary, each slice of worm model is grown outward. The points on the boundary are expanded in an iterative process until the point comes in contact with another edge of the worm. For areas of the worm where it folds back on itself, this process results in a flattened cross-section where the folds press against each other, matching images observed in electron microscopy data (<xref ref-type="fig" rid="fig24">Appendix 1—figure 18</xref>). For areas of the worm where the cross-section does not contact other sections of the worm, the 2D contour extends outward until it reaches the edge of the sample plane, capturing as much data as possible.<fig id="fig24" position="float"><object-id pub-id-type="doi">10.7554/eLife.10070.056</object-id><label>Appendix 1—figure 18.</label><caption><title>An EM image of the worm shows the worm body is flattened where overlapping segments come into contact.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10070.056">http://dx.doi.org/10.7554/eLife.10070.056</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10070-app1-fig18-v2"/></fig></p></sec></sec><sec id="s24" sec-type="appendix"><title>Untwisting the worm</title><p>Once the 3D model of the worm is finalized, a 2D slice plane is swept through the model. At each sample-point along the 3D center spline of the worm, the 2D plane is intersected with the original 3D volume. Voxels that fall outside the updated 2D worm contour are set to the image minimum value (typically = 0). Voxels that fall inside the 2D worm contour are copied into the output slice. The set of 2D slices from the worm head to tail are concatenated to form the final 3D straightened volume.</p><p>During the straightening step, as well as during the model-building process or when the 2D sample plane is intersected with the 3D volume, steps are taken by the algorithm to minimize sampling artifacts. Due to the twisted configuration of the worm, sampling the volume along the outer-edge of a curve will cause under-sampling of the data while the inside edge of the curve will be over-sampled.</p><p>To reduce sampling artifacts, the sample planes are interpolated between sample points, using the maximum distance between points along consecutive contours to determine the amount of super-sampling. The multiple sample planes are averaged to produce the final slice in the straightened image. In addition, each contour is modeled as having the thickness of one voxel and sample points that fall between voxels in the volume are tri-linearly interpolated.</p></sec></boxed-text></app></app-group></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.10070.057</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Hobert</surname><given-names>Oliver</given-names></name><role>Reviewing editor</role><aff id="aff8"><institution>Columbia University</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your work entitled &quot;Untwisting the <italic>Caenorhabditis elegans</italic> embryo&quot; for peer review at <italic>eLife</italic>. Your submission has been favorably evaluated by K VijayRaghavan (Senior editor), a Reviewing editor, and two reviewers.</p><p>The reviewers have discussed the reviews with one another and the Reviewing editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>The manuscript by Christensen et al. describes important technical advances in image analysis that will be important in delineating late embryonic developmental events in <italic>C. elegans</italic>, especially nervous system development. Previous attempts to analyze these stages (in which many key processes of differentiation and circuit formation occur) have been obscured by factors such as muscle movements and the unpredictably folded conformation of the embryo as it elongates. Christensen et al. show that advances in imaging and image analysis can overcome these obstacles, allowing them to generate an 'untwisted' straightened view of the late embryo over time. Although this is laborious (15 h work per embryo) it is an important proof of principle and will open up this phase of development to analysis. The manuscript is thorough and well explained. This work will be of interest to the <italic>C. elegans</italic> and 'developmental imaging' communities.</p><p>Requested revisions (in no order of importance; most of them quite minor):</p><p>General points:</p><p>1) The manuscript appears quite wordy and disproportionate to the lesson that the reader should extract. Please try to provide more concise descriptions.</p><p>2) The untwisted volumetric images of multiple animals need to be compared.</p><p>Specific points:</p><p>1) Nature of the folding/twisting of the embryo: This may be a minor semantic point but are worm embryos truly twisted (helically, around their axis) or folded/bent, or both? In larval development the body can only flex in the dorsoventral axis, it would be interesting if the embryo does undergo some helical twisting. The authors now have the first accurate dataset on this and it is an omission that ether is not a clearer account of how embryos twist or flex (just a rough statement that it is 'more complex' than in larvae.</p><p>2) Seam cell marker is introduced correctly as a marker for seam cell nuclei but later on they are just 'seam cells' which could confuse non-experts. The seam cells are doing a lot that is not captured by the nuclei positions.</p><p>3) How many points must be in the lattice for this to work? Can you define a minimum number or does accuracy increase with number of lattice points?</p><p>4) Seam cell V5 (Results, sixth paragraph) is presumably Q/V5, which divides in the elongating embryo (Sulston, 1983).</p><p>5) Elongation (as displacement of seam cell nuclei) is nicely shown to be biphasic. There have been relevant analyses in some papers on alpha spectrin, e.g. Norman and Moerman, that could be cited.</p><p>6) Results, eleventh paragraph: The nose is the anterior terminus of the pharynx (well, buccal cavity) not the intestine.</p><p>7) Seam cell displacement is described in the same paragraph of the Results as being 'at variable speeds' but I think the authors mean that different seam cell nuclei separate at a variety of speeds. Although from the data mentioned in the text it is not clear if the speed is different or the duration of movement is different.</p><p>8) The authors make a key point that elongation is non uniform along the axis, in that head seam cells separate more than body seam cells. This may not have been explicitly stated before elsewhere but is a natural consequence of the morphology of the comma stage embryo, where the head is thicker than the body so must elongate more. Thus elongation is mostly of the head or H cells, in contrast to postembryonic growth which is mostly in the body. Perhaps more could be made of these data and whether this relates to H vs. V cells seam fates.</p><p>9) The authors could discuss whether the approaches developed here could be applied to any other developmental systems.</p><p>10) A link to the open-source code, compiled software, and a tutorial to use both, must be present at the start of the paper, perhaps even in the Abstract (as well as other places within the paper). Since websites can go offline for a variety of reasons, it would be best practice to make the code, software, and manuals available as supplements hosted at <italic>eLife</italic> or perhaps on the Galaxy platform.</p><p>11) The authors perform some segmentation of seam cells and the Bao lab has produced software that tracks, in semi-automated fashion, embryonic cell divisions. The authors should address why they did not implement such a method here. In other words, why must every image volume be manually annotated such that a developing embryo requires ~15 hours of manual annotation? Is it not possible to annotate the first volume, then automatically track the seam cells in subsequent volumes thereafter (requiring manual input only when necessary)?</p><p>12) <xref ref-type="fig" rid="fig1">Figure 1E–G</xref>, left side: The green spline is hard to see above the green fluorescent markers, it would be best to choose another color.</p><p>13) <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref>) refers to a larva, not an &quot;embryo&quot;. Also, it would be best practice to identify the larval stage.</p><p>14) Results, fifth paragraph: Measurement differences between twisted and untwisted seam cell pairs and the pharyngeal contour need to be quantified as variance or SEM across the 5 profiled embryos as opposed to stating &quot;typical&quot; values. The authors can include mean, max, median, mode… as well if they feel these give an additional perspective on the accuracy of their untwisting method. The same is true for the ninth paragraph and <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>, wherein we are given a qualitative term &quot;most&quot; instead of a quantifiable statistic. Some of this data is already present in <xref ref-type="supplementary-material" rid="SD4-data">Supplementary files 4</xref> and <xref ref-type="supplementary-material" rid="SD5-data">5</xref> and should be used in place of the qualitative statements. This is present again in the eleventh paragraph where the tilde symbol is used instead of quantifying the mean and some form of variance (SD or SEM). And, once again, in the Methods, last paragraph.</p><p>15) <xref ref-type="fig" rid="fig22">Appendix 1—figure 16</xref> claims that each segmented fluorescent marker pair has a unique color value but that is neither apparent, nor visible in the accompanying picture. Furthermore, algorithm detail #8 states that the short axis of the ellipses comprising the embryonic boundary is half the distance of long axis (between seam cell pairs). As shown in their accompanying EM image (<xref ref-type="fig" rid="fig24">Appendix 1—figure 18</xref>), the embryonic cross section is more rounded than this and so the estimated value appears much smaller than necessary. The authors should address this discrepancy. There is a possibility that this choice is affecting the X and Y measurements in the main <xref ref-type="fig" rid="fig3">Figure 3</xref>, the authors should address whether the choice of the ellipse's short-axis estimate changes these values.</p><p>16) <xref ref-type="fig" rid="fig3">Figure 3</xref> is a phenomenal figure, capturing the power of the authors’ technique. If possible though, it would be helpful to have, in addition to the embryonic stage, the time since the first embryonic division superimposed at the corners of these images (E–H).</p><p>17) Results, eighth paragraph: It would be helpful if the authors could discuss potential causes for the time-shifts in elongation course observed between different embryos. Were developmental conditions strictly controlled or is this perhaps a consequence of variables such as maternal effects (starvation, contamination, plate age,…), room temperature, heat from the diSPIM, etc.? This would also help to elucidate what may have caused embryo 5 to have such a radically different migration for the CANs.</p><p>18) Results, tenth paragraph: To give proper perspective on these fits, it would be best if the authors could provide the dimensions of the egg. This should be easily recoverable from their image volumes.</p><p>19) <xref ref-type="fig" rid="fig5">Figure 5</xref>: I believe the axial distance panel annotations are reversed as it appears that panel B represents the least distance and D the greatest.</p><p>20) Methods, Strains: The promoters should be identified for the SCM and Coelomocyte markers. Future papers may find that these promoters contribute to deviations from wild-type development. Moreover, for the remaining promoters, the authors should provide forward/reverse primers, genomic locations, and/or paper citations wherein this information can be found.</p><p>21) Methods, Data Acquisition: The MIPAV site has been updated and the old link appears to be dead.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.10070.058</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>General points:</italic> </p><p><italic>1) The manuscript appears quite wordy and disproportionate to the lesson that the reader should extract. Please try to provide more concise descriptions.</italic> </p><p>We have attempted to make the manuscript more concise, while still incorporating new content asked for by the reviewers. Despite this added content we were able to keep the new version of the paper approximately the same length as the old version.</p><p><italic>2) The untwisted volumetric images of multiple animals need to be compared.</italic> </p><p>We have added <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> to directly compare representative volumes from five 1.5-fold and 3-fold embryos (these new figure supplements are described in the eighth paragraph of the Results). Importantly, the images show that overall morphology and seam cell positions are similar among embryos.</p><p><italic>Specific points:</italic> </p><p><italic>1) Nature of the folding/twisting of the embryo: This may be a minor semantic point but are worm embryos truly twisted (helically, around their axis) or folded/bent, or both? In larval development the body can only flex in the dorsoventral axis, it would be interesting if the embryo does undergo some helical twisting. The authors now have the first accurate dataset on this and it is an omission that ether is not a clearer account of how embryos twist or flex (just a rough statement that it is 'more complex' than in larvae.</italic> </p><p>We have closely inspected our data and found evidence for helical twisting. We highlight evidence for this claim in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>, and mention it in the main text: “Nematode embryos undergo both bending and helical twisting around the nose-to-tail axis (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>) posing challenges in untwisting the embryo relative to larval or adult nematodes”. Although interesting, an in-depth study of helical twist is outside the scope of this work, so we have not further investigated this point in detail.</p><p><italic>2) Seam cell marker is introduced correctly as a marker for seam cell nuclei but later on they are just 'seam cells' which could confuse non-experts. The seam cells are doing a lot that is not captured by the nuclei positions.</italic> </p><p>We thank the reviewers for raising this point and have updated the text so that all previously incorrect instances of ‘seam cells’ are referred to as ‘seam cell nuclei’.</p><p><italic>3) How many points must be in the lattice for this to work? Can you define a minimum number or does accuracy increase with number of lattice points?</italic> </p><p>We thank the reviewers for raising this point, which we have now clarified in the third paragraph of the Results, and visually in <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>. The highest-quality lattices are generated when user builds a lattice that closely matches the morphology of the embryo, e.g. as quantified by the sides of the generated worm model having significant overlap with the actual sides of the embryo, the generated midline of the worm model following the actual midline of the embryo, etc. These requirements are best achieved by using as many lattice points as required to get a good match between the model and the actual data; depending on the degree of twisting/bending observed in a volume the number of required points needed to optimally capture the worm morphology may differ. In practice, lattices that match well with actual embryo morphology incorporate lattice points at each seam cell nucleus (for a total of 20-22 points), a pair of points at the nose (2 points), and as many points as required to capture bends occurring between seam cell nuclei (usually 2B, where B is the number of bends between nuclei in the volume). Hypodermal labeling past the tip of the tail is usually visible only in some volumes, but when observed, another pair of points is often placed at the tip of the tail (2 points). Thus, the minimum number of points required to generate a lattice (assuming 20 seam cell nuclei and no pair of tail points) is 22+2B. Using more points (more than 32) may provide better agreement between the generated model and the actual worm, but it usually leads only to minor changes in practice, and in our experience is not time-effective.</p><p><italic>4) Seam cell V5 (Results, sixth paragraph) is presumably Q/V5, which divides in the elongating embryo (Sulston, 1983).</italic> </p><p>We thank the reviewers for pointing this out; after division we tracked the anteriormost daughter cell Q, and have clarified this in the eighth paragraph of the Results. We now refer to this cell as Q/V5 throughout the text.</p><p><italic>5) Elongation (as displacement of seam cell nuclei) is nicely shown to be biphasic. There have been relevant analyses in some papers on alpha spectrin, e.g. Norman and Moerman, that could be cited.</italic> </p><p>In reference to this point, we have now cited:</p><p>a) Norman K.R. and Moerman, D.G. (2002). Alpha spectrin is essential for morphogenesis and body wall muscle formation in <italic>Caenorhabditis elegans</italic>. Journal of Cell Biology 157((O'Donnell et al., 2009)): 665-677.</p><p>b) Chin-Sang, I.D., and Chisholm, A.D. (2000). Form of the worm: genetics of epidermal morphogenesis in <italic>C. elegans</italic>. Trends Genetics 16((Holekamp et al., 2008)): 544-551.</p><p>c) Ding, M., Woo, W-M., Chisholm, A.D. (2004). The cytoskeleton and epidermal morphogenesis in <italic>C. elegans</italic>. Experimental Cell Research. 301((Kolodkin and Tessier-Lavigne, 2011)): 84-90.</p><p>d) Priess, J.R., and Hirsh, D.I. (1986). <italic>Caenorhabditis elegans</italic> morphogenesis: The role of the cytoskeleton in elongation of the embryo. Dev. Biol. 117((Kolodkin and Tessier-Lavigne, 2011)): 156-173.</p><p><italic>6) Results, eleventh paragraph: The nose is the anterior terminus of the pharynx (well, buccal cavity) not the intestine.</italic> </p><p>We thank the reviewers for this correction. We have fixed this mistake.</p><p><italic>7) Seam cell displacement is described in the same paragraph of the Results as being 'at variable speeds' but I think the authors mean that different seam cell nuclei separate at a variety of speeds. Although from the data mentioned in the text it is not clear if the speed is different or the duration of movement is different.</italic> </p><p>We have clarified what we meant, that over the same time period (elongation), some pairs of adjacent seam cell nuclei separate from each other over significantly greater distances than do other adjacent seam cell nuclear pairs, so that the average speed of separation of nuclei near the head is greater than the average speed of separation of nuclei near body or tail.</p><p><italic>8) The authors make a key point that elongation is non uniform along the axis, in that head seam cells separate more than body seam cells. This may not have been explicitly stated before elsewhere but is a natural consequence of the morphology of the comma stage embryo, where the head is thicker than the body so must elongate more. Thus elongation is mostly of the head or H cells, in contrast to postembryonic growth which is mostly in the body. Perhaps more could be made of these data and whether this relates to H vs. V cells seam fates.</italic> </p><p>We now mention in the eleventh paragraph of the Results that the non-uniformity of elongation along the axis is a natural consequence of morphology of the comma stage embryo. We prefer not to speculate about whether this point relates to H vs. V seam cell fates.</p><p><italic>9) The authors could discuss whether the approaches developed here could be applied to any other developmental systems.</italic> </p><p>Although the precise details of our algorithm are immediately applicable only to other systems with vermiform geometry, some of the other concepts we implement (alignment and pooling of distinct datasets derived from multiple animals) are likely more general. We have mentioned this point in the fourth paragraph of the Discussion.</p><p><italic>10) A link to the open-source code, compiled software, and a tutorial to use both, must be present at the start of the paper, perhaps even in the Abstract (as well as other places within the paper). Since websites can go offline for a variety of reasons, it would be best practice to make the code, software, and manuals available as supplements hosted at</italic> eLife <italic>or perhaps on the Galaxy platform.</italic> </p><p>The untwisting plugin has been implemented as part of MIPAV, which has been a long-running and stable (in use for the last 15 years) graphics processing program. Hosting on the MIPAV site allows basic users to download the plugin without needing to compile the code, allows advanced users access to information about how to look at the code if they are interested, and finally allows us to continue updating and improving the program without needing to change the provided link. Because of these features, we feel that the MIPAV site is best for hosting the plugin, and have made it available at <ext-link ext-link-type="uri" xlink:href="http://mipav.cit.nih.gov/plugin_jws/mipav_worm_plugin.php">http://mipav.cit.nih.gov/plugin_jws/mipav_worm_plugin.php</ext-link>. We describe the link in the Abstract, Introduction,, Results and Methods. We have also written a tutorial describing how to use the untwisting plugin, which we have included as <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref> and which we reference in the Abstract and Results.</p><p><italic>11) The authors perform some segmentation of seam cells and the Bao lab has produced software that tracks, in semi-automated fashion, embryonic cell divisions. The authors should address why they did not implement such a method here. In other words, why must every image volume be manually annotated such that a developing embryo requires ~15 hours of manual annotation? Is it not possible to annotate the first volume, then automatically track the seam cells in subsequent volumes thereafter (requiring manual input only when necessary)?</italic> </p><p>We have taken this point very seriously, and are happy to report that we have improved the automation of our approach. We now automatically detect and segment seam cells, and automatically generate a list of candidate lattices for each timepoint. The user intervenes at two editing steps, to ensure the accuracy of segmentation and lattice generation. Conservatively, we estimate this improvement results in ~1/2 as much manual user effort as before. Our improved, semi-automated approach is discussed in the Results, and <xref ref-type="supplementary-material" rid="SD2-data">Supplementary file 2</xref>. Due to the rapid post-twitching movement, automatically tracking seam cell nuclei in the same manner that histones are tracked for lineaging would require imaging rates on the order of 1 volume every 3-4 seconds, which for many applications implies an unnecessary increase in dose to the embryo, and also greatly increases the amount of data that needs to be recorded and processed.</p><p><italic>12) <xref ref-type="fig" rid="fig1">Figure 1E–G</xref>, left side: The green spline is hard to see above the green fluorescent markers, it would be best to choose another color.</italic> </p><p>We thank the reviewers for this comment and have drawn over the green spline in a more visible color.</p><p><italic>13) <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref>) refers to a larva, not an &quot;embryo&quot;. Also, it would be best practice to identify the larval stage.</italic> </p><p>We have clarified this point in the fourth paragraph of the Results and identified the larval stage as L2 explicitly in the <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref> caption.</p><p><italic>14) Results, fifth paragraph: Measurement differences between twisted and untwisted seam cell pairs and the pharyngeal contour need to be quantified as variance or SEM across the 5 profiled embryos as opposed to stating &quot;typical&quot; values. The authors can include mean, max, median, mode… as well if they feel these give an additional perspective on the accuracy of their untwisting method. The same is true for the ninth paragraph and <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>, wherein we are given a qualitative term &quot;most&quot; instead of a quantifiable statistic. Some of this data is already present in <xref ref-type="supplementary-material" rid="SD4-data">Supplementary files 4</xref> and <xref ref-type="supplementary-material" rid="SD5-data">5</xref> and should be used in place of the qualitative statements. This is present again in the eleventh paragraph where the tilde symbol is used instead of quantifying the mean and some form of variance (SD or SEM). And, once again, in the Methods, last paragraph.</italic> </p><p>We have made all such qualitative statements quantitative, by providing appropriate statistics for the requested data. Instances include:</p><p>Results, seventh paragraph: We have quantified the population average difference and standard deviation across time and embryo number (&lt;μ<sub>Difference, time</sub>&gt;<sub>embryo</sub> population standard deviation &lt;σ<sub>Difference, time</sub>&gt;<sub>embryo</sub>) of the twisted vs. untwisted difference for H0, T, and pharyngeal length.</p><p>Results, tenth paragraph: We have quantified average standard deviation calculated across all 20 seam cell nuclei and all timepoints, &lt;&lt;σ<sub>X</sub>&gt;<sub>time</sub>&gt;<sub>seam cell</sub>, &lt;&lt;σ<sub>Y</sub>&gt;<sub>time</sub>&gt;<sub>seam cell</sub>, and &lt;&lt;σ<sub>Z</sub>&gt;<sub>time</sub>&gt;<sub>seam cell</sub>.</p><p>Results, eleventh paragraph: We have quantified the mean and standard deviation of elongation rate for the non-origin-H0 and V6-T seam cell pairs.</p><p>In the subsection “Validating fits for each embryo”: We have quantified the absolute differences between averaged and fitted coordinates at each time point, and then calculated the means and standard deviations of these differences across time, reporting them as μ <sub>avg-fit, time</sub> and σ <sub>avg-fit, time</sub> in Supplementary file 6. We then computed the average over all seam cell nuclei of these average differences to generate &lt;μ <sub>Xavg-Xfit, time</sub>&gt;<sub>seam cell</sub>; &lt;μ <sub>Yavg-Yfit, time</sub>&gt;<sub>seam cell</sub>; and &lt;μ <sub>Zavg-Zfit, time</sub>&gt;<sub>seam cell</sub>.</p><p>For <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>, we have quantified in the legend axial position stereotypy across the 20 seam cells via &lt;&lt;σ<sub>Z</sub>&gt;<sub>time</sub>&gt;<sub>seam cell</sub>, and axial stereotypy for CANL via &lt;σ<sub>Z</sub>&gt;<sub>time</sub>.</p><p>We have also added a section to the Methods describing our population statistics calculations, (“Population statistics”).</p><p><italic>15) <xref ref-type="fig" rid="fig22">Appendix 1—figure 16</xref> claims that each segmented fluorescent marker pair has a unique color value but that is neither apparent, nor visible in the accompanying picture. Furthermore, algorithm detail #8 states that the short axis of the ellipses comprising the embryonic boundary is half the distance of long axis (between seam cell pairs). As shown in their accompanying EM image (<xref ref-type="fig" rid="fig24">Appendix 1—figure 18</xref>), the embryonic cross section is more rounded than this and so the estimated value appears much smaller than necessary. The authors should address this discrepancy. There is a possibility that this choice is affecting the X and Y measurements in the main <xref ref-type="fig" rid="fig3">Figure 3</xref>, the authors should address whether the choice of the ellipse's short-axis estimate changes these values.</italic></p><p>We thank the reviewers for noticing the color value issue and have fixed it in <xref ref-type="fig" rid="fig22">Appendix 1—figure 16</xref>. Regarding the elliptical cross-section, the model intentionally starts out smaller than expected, and then is expanded to capture the rest of the worm. This procedure is implemented to deal with cases where parts of the embryo are “squished” against each other, which would otherwise inappropriately capture the abutting surface of the worm. Thus, the initial elliptical cross-section itself is not directly applied to raw data. We have clarified this point in <xref ref-type="supplementary-material" rid="SD2-data">Supplementary file 2</xref>.</p><p><italic>16) <xref ref-type="fig" rid="fig3">Figure 3</xref> is a phenomenal figure, capturing the power of the authors’ technique. If possible though, it would be helpful to have, in addition to the embryonic stage, the time since the first embryonic division superimposed at the corners of these images (E-H).</italic> </p><p>We thank the reviewers for the positive feedback. Embryos were roughly staged based on morphology, but were not tracked from the two-cell stage so precisely defining time since the first embryonic division unfortunately is not practical with the reported datasets. We have therefore left this figure unchanged. However, the reviewer’s point is well taken and for future applications we agree that more rigorous assessment of timing relative to the first embryonic division is a good idea.</p><p><italic>17) Results, eighth paragraph: It would be helpful if the authors could discuss potential causes for the time-shifts in elongation course observed between different embryos. Were developmental conditions strictly controlled or is this perhaps a consequence of variables such as maternal effects (starvation, contamination, plate age,…), room temperature, heat from the diSPIM, etc.? This would also help to elucidate what may have caused embryo 5 to have such a radically different migration for the CANs.</italic> </p><p>As the reviewers suggest, the cause of the variability relating to shifting is interesting. Several potential causes suggest themselves. As described in the response to point 16, embryo development was not tracked from the two-cell stage, so it is likely that embryos were at slightly different ages at the onset of imaging. Temperature and other environmental conditions such as plate age were moderately controlled—temperature may have fluctuated by 2-3 degrees C while keeping strains and during imaging—and plates were used on consecutive days so plate ages may vary by up to a day. Finally, intrinsic variables like imaging conditions or health of the mother animal or embryo could have played a role in the variability we observed. We have described these issues in the second paragraph of the Discussion.</p><p><italic>18) Results, tenth paragraph: To give proper perspective on these fits, it would be best if the authors could provide the dimensions of the egg. This should be easily recoverable from their image volumes.</italic> </p><p>As the length of the elongating embryo is much greater than the length of the egg, and the diameter is much smaller, we believe that growing embryo dimensions are probably a better metric than egg dimensions for examining fits. We have thus provided the average length and diameter of an untwisted embryo, calculated from the final volumes of the five embryos, in the tenth paragraph of the Results.</p><p><italic>19) <xref ref-type="fig" rid="fig5">Figure 5</xref>: I believe the axial distance panel annotations are reversed as it appears that panel B represents the least distance and D the greatest.</italic> </p><p>The reviewers are correct that there is an error, but the correction is that panels B and C should be swapped. These panels show the change in distance between measured seam cells from the beginning of elongation to the end; thus graphs with a high rise indicate greatest distance and those with low rise indicate the least. Thus, origin-H0 and H1-H2 show the greatest increase in distance while V6-T shows the least increase in distance. We have adjusted the figure accordingly.</p><p><italic>20) Methods, Strains: The promoters should be identified for the SCM and Coelomocyte markers. Future papers may find that these promoters contribute to deviations from wild-type development. Moreover, for the remaining promoters, the authors should provide forward/reverse primers, genomic locations, and/or paper citations wherein this information can be found.</italic> </p><p>More detail is now provided in the subsection “Strains”. Most of the constructs used were ordered from the CGC and represent preexisting reagents/strains created by other labs. We have included primer information for <italic>olaex 2457</italic>, which was created in house, and have provided references for constructs originally created by other labs (Lakadamyali et al., 2012; Totong, Achilleos and Nance, 2007; Terns et al., 1997; Koh and Rothman, 2001). The SCM promoter, to our knowledge, has not been identified more definitively or assigned to a specific gene.</p><p><italic>21) Methods, Data Acquisition: The MIPAV site has been updated and the old link appears to be dead.</italic></p><p>We have compiled the plugin code and are hosting it on the MIPAV website. The link to it is: <ext-link ext-link-type="uri" xlink:href="http://mipav.cit.nih.gov/plugin_jws/mipav_worm_plugin.php">http://mipav.cit.nih.gov/plugin_jws/mipav_worm_plugin.php</ext-link></p></body></sub-article></article>