<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">24836</article-id><article-id pub-id-type="doi">10.7554/eLife.24836</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Genetics and Genomics</subject></subj-group></article-categories><title-group><article-title>Minimal-assumption inference from population-genomic data</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-56114"><name><surname>Weissman</surname><given-names>Daniel B</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7799-1573</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-34326"><name><surname>Hallatschek</surname><given-names>Oskar</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor2">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Physics</institution>, <institution>Emory University</institution>, <addr-line><named-content content-type="city">Atlanta</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Physics and Integrative Biology</institution>, <institution>University of California, Berkeley</institution>, <addr-line><named-content content-type="city">Berkeley</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Nordborg</surname><given-names>Magnus</given-names></name><role>Reviewing editor</role><aff><institution>Vienna Biocenter</institution>, <country>Austria</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>dbweissman@gmail.com</email> (DBW);</corresp><corresp id="cor2"><email>ohallats@berkeley.edu</email> (OH)</corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>03</day><month>07</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e24836</elocation-id><history><date date-type="received"><day>02</day><month>01</month><year>2017</year></date><date date-type="accepted"><day>01</day><month>07</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Weissman et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Weissman et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-24836-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.24836.001</object-id><p>Samples of multiple complete genome sequences contain vast amounts of information about the evolutionary history of populations, much of it in the associations among polymorphisms at different loci. We introduce a method, Minimal-Assumption Genomic Inference of Coalescence (MAGIC), that reconstructs key features of the evolutionary history, including the distribution of coalescence times, by integrating information across genomic length scales without using an explicit model of coalescence or recombination, allowing it to analyze arbitrarily large samples without phasing while making no assumptions about ancestral structure, linked selection, or gene conversion. Using simulated data, we show that the performance of MAGIC is comparable to that of PSMC’ even on single diploid samples generated with standard coalescent and recombination models. Applying MAGIC to a sample of human genomes reveals evidence of non-demographic factors driving coalescence.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.24836.001">http://dx.doi.org/10.7554/eLife.24836.001</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>inference</kwd><kwd>polymorphism</kwd><kwd>population genomics</kwd><kwd>recombination</kwd><kwd>coalescence</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000893</institution-id><institution>Simons Foundation</institution></institution-wrap></funding-source><award-id>Simons Investigator Award</award-id><principal-award-recipient><name><surname>Hallatschek</surname><given-names>Oskar</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R01GM115851</award-id><principal-award-recipient><name><surname>Hallatschek</surname><given-names>Oskar</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The coalescent history of a population can be learned just from the present genomic diversity, without having detailed prior knowledge of the pattern of recombination or the forces driving coalescence.</meta-value></custom-meta><custom-meta><meta-name>eLife Digest</meta-name><meta-value>2.5</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The continuing progress in genetic sequencing technology is enabling the collection of vast amounts of data on the genomic diversity of populations. These data are potentially our richest source of new information on evolutionary history. The challenge now is to figure out how to extract this information – how to learn as much as possible about the history of populations from modern data sets of many densely-sequenced individuals.</p><p>Perhaps the best-established approach to historical inference from genetic data is to fit demographic models to the site frequency spectrum (SFS) (e.g., <xref ref-type="bibr" rid="bib11">Gutenkunst et al. (2009)</xref>; <xref ref-type="bibr" rid="bib7">Excoffier et al. (2013)</xref>; <xref ref-type="bibr" rid="bib18">Liu and Fu (2015)</xref>). The SFS is easy to calculate, even from very large samples, and demographic models can be fit to it without a specific model of recombination, but it neglects all information about how diversity is distributed across the genome, treating each site independently. This is a natural approximation for samples sequenced only at a sparse set of weakly-linked loci, but in large whole-genome samples much of the information is contained in associations among different polymorphisms. Because SFS-based approaches cannot use this information, the number of model parameters they can reliably estimate is limited by the sample size, regardless of how much of the genome is sequenced (<xref ref-type="bibr" rid="bib22">Myers et al., 2008</xref>; <xref ref-type="bibr" rid="bib3">Bhaskar and Song, 2014</xref>).</p><p>Recently, an alternative approach has been developed in which a hidden Markov model is used to explicitly model recombination along the genome (the ‘sequential Markovian coalescent’, SMC or SMC’, <xref ref-type="bibr" rid="bib21">McVean and Cardin (2005)</xref>; <xref ref-type="bibr" rid="bib20">Marjoram and Wall (2006)</xref>; <xref ref-type="bibr" rid="bib23">Paul et al. (2011)</xref>), vastly increasing the amount of information that can be gleaned from samples of a small number of individuals (<xref ref-type="bibr" rid="bib14">Hobolth et al., 2007</xref>; <xref ref-type="bibr" rid="bib17">Li and Durbin, 2011</xref>; <xref ref-type="bibr" rid="bib12">Harris and Nielsen, 2013</xref>; <xref ref-type="bibr" rid="bib27">Sheehan et al., 2013</xref>; <xref ref-type="bibr" rid="bib25">Schiffels and Durbin, 2014</xref>; <xref ref-type="bibr" rid="bib28">Steinrücken et al., 2015</xref>). But this requires modeling coalescence and recombination throughout the analysis, and as a result becomes computationally intractable for large samples (while still being far less computationally intensive than modeling the full ancestral recombination graph). Additionally, for an increasing number of populations, we have multiple genomic sequences but know almost nothing about their natural histories, including plausible historical demographies and patterns of recombination and selection; this is true even for some model organisms (see <xref ref-type="bibr" rid="bib1">Alfred and Baldwin (2015)</xref> and other articles in series). It is generally unclear how deviations from the underlying models, e.g., past population structure or gene conversion, affect the inferences of these methods.</p><p>Here we present a method for Minimal-Assumption Genomic Inference of Coalescence (MAGIC) that infers the patterns of ancestry and recombination in an arbitrarily large sample of genomes while making only minimal, generic assumptions about recombination, selection, and demography. MAGIC finds approximate distributions of times to different common ancestors of the sample. These distributions can then be used to fit and test potential models for the history of the population, including the simplest model of a single time-dependent ‘effective population size’, <inline-formula><mml:math id="inf1"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. MAGIC strikes a balance between the SFS- and SMC-based approaches, using the distribution of diversity across genomic windows of varying size to generate a description of the single-locus coalescent process that contains far more information than the simple SFS without using a detailed model for recombination.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Approach</title><p>The key fact underlying MAGIC is that the relationship between the population parameters (such as recombination rates, historical demography, and selection) and genomic data is entirely mediated by the coalescent history of the sample (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). We therefore take it as our goal to learn the coalescence time distribution directly from the data without needing a model for the population dynamics. Once one knows the coalescent history, the genomic data typically contains no additional information about the population parameters (unless, e.g., the selective values of different alleles are known), and one can fit or evaluate a wide range of models without having to re-analyze the full data set every time. In simple cases, such as when the population is described by a single effective population size, <inline-formula><mml:math id="inf2"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, this can be done analytically (<xref ref-type="bibr" rid="bib8">Gattepaille et al., 2016</xref>), while in general it can be done via Approximate Bayesian Computation (ABC).<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.24836.002</object-id><label>Figure 1.</label><caption><title>Outline of approach.</title><p>(<bold>a</bold>) Concept: we would like to infer the history of the population (top) from the sequence data (bottom), but the causal connection between the two is entirely mediated by the coalescent history of the sample (middle). This suggests that it should be possible to extract much of the coalescent information from the data without making strong assumptions about the population dynamics. (<bold>b</bold>) Schematic algorithm: MAGIC first splits the sample into small windows and counts the polymorphisms within each window, then progressively merges pairs of adjacent windows together (bottom left). For each window length <inline-formula><mml:math id="inf3"><mml:mi>L</mml:mi></mml:math></inline-formula>, the histogram of window diversity is used to estimate parameters of the distribution of the window-averaged coalescence time <inline-formula><mml:math id="inf4"><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> (bottom right). Taking the limit of these as <inline-formula><mml:math id="inf5"><mml:mi>L</mml:mi></mml:math></inline-formula> goes to 1 gives the parameters of the distribution of the true coalescence time <inline-formula><mml:math id="inf6"><mml:mi>T</mml:mi></mml:math></inline-formula> (top right), which are then used to fit and test models for the underlying dynamics.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.24836.002">http://dx.doi.org/10.7554/eLife.24836.002</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24836-fig1-v2"/></fig></p><p>Essentially, MAGIC uses the variability in the density of polymorphisms across a wide range of length scales to learn the genome-wide distribution of coalescent histories. This technique is inspired by <xref ref-type="bibr" rid="bib17">Li and Durbin (2011)</xref>’s method, PSMC, and its successor MSMC (<xref ref-type="bibr" rid="bib25">Schiffels and Durbin, 2014</xref>), which use the fact that SNPs tend to be dense in regions with a long time to the most recent common ancestor (TMRCA), and sparse in regions with short TMRCAs (<xref ref-type="fig" rid="fig1">Figure 1</xref>, top left and middle left). Thus, the distribution of SNPs across the genome can be used to infer the distribution of <italic>local</italic> coalescence times. But while PSMC and MSMC use models for coalescence and recombination to assign a coalescence time to each locus, MAGIC estimates the genomic distribution of times directly, bypassing the need for explicit modeling. To do this, MAGIC first splits the genome into windows and finds the distribution of genetic diversity across windows, that is, the histogram of the number of polymorphic sites per window of a given length (<xref ref-type="fig" rid="fig1">Figure 1</xref>, bottom left; Figure 6, top left). (This can be seen as a simplified version of the ‘blockwise counts of SFS types (bSFS)’ introduced by (<xref ref-type="bibr" rid="bib4">Bunnefeld et al., 2015</xref>).) This histogram is then used to estimate the distribution of <italic>window-averaged</italic> coalescence times (<xref ref-type="fig" rid="fig1">Figure 1</xref>, bottom right; Figure 6, bottom). For small windows, these times are essentially the true single-locus coalescence times, but the inference is noisy due to the small number of mutations in each window. For large windows, the inference of the window-averaged distribution is more precise, but this distribution is far from the single-locus distribution because windows typically span multiple segments with different coalescence histories. The basic trick of MAGIC is that rather than choosing one window length, it integrates the information gathered from a wide range of different window lengths to find the small-length limit – the true single-locus distribution (<xref ref-type="fig" rid="fig1">Figure 1</xref>, center right).</p><p>MAGIC’s accuracy is comparable to the state-of-the-art model-driven method MSMC (<xref ref-type="bibr" rid="bib25">Schiffels and Durbin, 2014</xref>) on small data sets that conform to MSMC’s assumptions (see ‘Single diploid samples’ in ‘Results’). More importantly, it can also analyze larger samples, and can be useful in analyzing data from populations with features (such as gene conversion, ancestral structure, or linked selection) that violate MSMC’s assumptions, either as a stand-alone inference method or as a way of testing models inferred by other methods that include these features. MAGIC’s algorithm, described in ‘Methods’ below, is designed to be as simple and modular as possible, allowing one to incorporate additional assumptions in situations where more information is available. This also enables the inference of a wide range of parameters, including the distribution of map lengths of blocks of identity-by-descent across the genome (<xref ref-type="bibr" rid="bib24">Ralph and Coop, 2013</xref>). Finally, MAGIC can use the dependence of the window-averaged distributions on window size to learn about the rate of recombination and the variation in recombination rate and the coalescent process across the genome. The variation in the coalescent process is particularly interesting because it is a signature of the effects of non-demographic forces.</p><sec id="s2-1-1"><title>Representing coalescence time distributions</title><p>For single diploid samples, the coalescent history is completely described by a single time at each locus. Thus the pairwise coalescence time distribution could equivalently be described by the hazard function (the pairwise coalescence rate, as in <xref ref-type="bibr" rid="bib25">Schiffels and Durbin (2014)</xref>) or its reciprocal (the ‘effective population size’ <inline-formula><mml:math id="inf7"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, as in <xref ref-type="bibr" rid="bib17">Li and Durbin (2011)</xref>). However, when estimating the distribution from noisy data, the procedure that minimizes the error for one description will not in general minimize the error for the others. We focus on estimating the coalescence time distribution itself (rather than its hazard function or <inline-formula><mml:math id="inf8"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), primarily because it naturally generalizes to arbitrary sets of coalescent tree branch lengths for larger samples (see below). This also lets us emphasize that the idea that the full coalescent can be described by a single <inline-formula><mml:math id="inf9"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a model that can be tested (as in Figure 3 and the right panel of Figure 4). For plotting results from analyzing simulations (<xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig3">Figure 3</xref>), we show cumulative distributions rather than densities so that we can plot the actual coalescent histories of samples (black curves in <xref ref-type="fig" rid="fig2">Figure 2</xref> and left panels of <xref ref-type="fig" rid="fig3">Figure 3</xref>), which consist of discrete sets of events, and also because the density estimates are very poorly constrained by the data (<xref ref-type="bibr" rid="bib24">Ralph and Coop, 2013</xref>). For the analysis of human data, we plot the more familiar <inline-formula><mml:math id="inf10"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4</xref>, left panel).</p><p>We must also choose how to summarize coalescence time distributions within MAGIC’s analysis (<xref ref-type="fig" rid="fig1">Figure 1</xref>, right-hand side). We will use the <italic>Laplace transform</italic> of the density, <inline-formula><mml:math id="inf11"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. For a formal definition of this quantity and how we estimate it, see the section ‘Laplace transforms’ of the Methods below. Intuitively, <inline-formula><mml:math id="inf12"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> represents what the homozygosity would be if the mutation rate had been larger by a factor of <inline-formula><mml:math id="inf13"><mml:mi>z</mml:mi></mml:math></inline-formula>, e.g., <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the observed homozygosity, and <inline-formula><mml:math id="inf15"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is what it would have been if the mutation rate had been twice as high (<xref ref-type="bibr" rid="bib19">Lohse et al., 2011</xref>). This means that <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> very roughly corresponds to the probability of coalescing within <inline-formula><mml:math id="inf17"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> generations, where <inline-formula><mml:math id="inf18"><mml:mi>μ</mml:mi></mml:math></inline-formula> is the mutation rate, that is, large <inline-formula><mml:math id="inf19"><mml:mi>z</mml:mi></mml:math></inline-formula> tell us about the recent past while small <inline-formula><mml:math id="inf20"><mml:mi>z</mml:mi></mml:math></inline-formula> tell us about the distant past. The mean coalescence time corresponds to <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>z</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf22"><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the observed heterozygosity of the sample. We choose this statistic both because of this natural interpretation and because it can be obtained from the observed diversity distribution directly with only very weak assumptions, allowing us to delay introducing stronger assumptions until the very last step of the analysis, when we invert the transform to find the full coalescence time distribution (see Materials and methods below).</p></sec></sec><sec id="s2-2"><title>Single diploid samples</title><p>To validate our approach, we have tested MAGIC on single diploid samples generated under a range of coalescent models simulated with ms (<xref ref-type="bibr" rid="bib15">Hudson, 2002</xref>). MAGIC accurately infers the distribution of coalescent times from samples with map length and polymorphism density similar to that of a human genome (<xref ref-type="fig" rid="fig2">Figure 2</xref>, top two rows, solid curves; see Figure 9 and Methods for detailed parameters and additional tests). MAGIC performs nearly as well as MSMC (Kolmogorov-Smirnov distance to the true distribution of <inline-formula><mml:math id="inf23"><mml:mrow><mml:mn>5</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>11</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for the simulations shown, compared to <inline-formula><mml:math id="inf24"><mml:mrow><mml:mn>4</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>11</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for MSMC). Both methods tend to smooth out sharp transitions in the coalescence distribution as a consequence of regularization. The distribution of map lengths of blocks of identity by descent (IBD) can be inferred with very high accuracy (<xref ref-type="fig" rid="fig2">Figure 2</xref>, top two rows, dotted curves), improving on MSMC, which sometimes overestimates the amount of very deep coalescence, and correspondingly erroneously estimates a large number of very short blocks. The part of the block-length distribution estimated by MAGIC is complementary to the very long blocks that can be observed directly (as in, e.g., <xref ref-type="bibr" rid="bib24">Ralph and Coop (2013)</xref>). MAGIC is also accurate on genomes simulated with ms under a model in which recombination is dominated by gene conversion (<xref ref-type="fig" rid="fig2">Figure 2</xref>, bottom row); this can be seen as loosely corresponding to a primarily asexual population, with gene conversion representing homologous recombination. In this case, MSMC’s recombination model breaks down and MAGIC’s inferences are more reliable.<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.24836.003</object-id><label>Figure 2.</label><caption><title>MAGIC accurately infers the distribution of coalescence times (solid curves) and lengths of blocks of identity-by-descent (IBD, dotted curves) for pairwise data simulated with ms under several demographic scenarios (<xref ref-type="fig" rid="fig9">Figure 9</xref>): a single bottleneck (left column), repeated expansions and contractions (middle), and recent admixture of two diverged populations (right).</title><p>The coalescence time plots show the cumulative distribution, while the IBD block-length plots show the survival function. When crossovers are frequent and gene conversion is rare (top two rows), MAGIC and MSMC are comparably accurate for coalescence times. MAGIC very accurately infers the IBD block length distribution, while MSMC sometimes is inaccurate (e.g., ‘Bottleneck’ scenario), but otherwise produces a curve nearly indistinguishable from MAGIC’s. For frequent gene conversion and rare crossovers (bottom row), the details of the gene conversion process have a strong effect on the IBD block lengths, and neither method can infer their distribution, but MAGIC can still infer the coalescence times. All simulations are of a genome consisting of <inline-formula><mml:math id="inf25"><mml:mn>100</mml:mn></mml:math></inline-formula> independent chromosomes, each <inline-formula><mml:math id="inf26"><mml:msup><mml:mn>10</mml:mn><mml:mn>7</mml:mn></mml:msup></mml:math></inline-formula> base pairs long, with per-base mutation rate <inline-formula><mml:math id="inf27"><mml:mi>μ</mml:mi></mml:math></inline-formula> and present population size <inline-formula><mml:math id="inf28"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> such that <inline-formula><mml:math id="inf29"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Recombination is via crossovers occurring at rate <inline-formula><mml:math id="inf30"><mml:mi>ρ</mml:mi></mml:math></inline-formula> per base, and via gene conversion being initiated at rate <inline-formula><mml:math id="inf31"><mml:mi>g</mml:mi></mml:math></inline-formula> per base with mean tract length <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. See Materials and methods for values of other simulation parameters.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.24836.003">http://dx.doi.org/10.7554/eLife.24836.003</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24836-fig2-v2"/></fig></p></sec><sec id="s2-3"><title>Larger samples</title><p>For samples of more than two haplotypes, the coalescent history at each locus is described by a tree, rather than a single time. The space of possible trees grows very rapidly with the sample size, so that even with long genomes it is impossible to directly estimate the full distribution. Instead, MAGIC infers the distribution of some small set of features of the trees, such as mean pairwise distance and total branch length, chosen either because they are important in and of themselves or because they are sufficient statistics for some model of the coalescent process. For example, MAGIC can fit the basic time-dependent effective population size model by estimating the distribution of pairwise coalescence times, and then check whether the fitted model correctly predicts the distributions of other tree features. MAGIC is particularly suited for model-checking, since for all the features beyond the basic pairwise coalescence time one can skip the final, most difficult step in the algorithm – inverting the Laplace transforms – and simply compare the distributions at the level of Laplace transforms.</p><p>We test this approach on a sample of six haplotypes from a recently admixed population simulated with ms (demographic parameters in the last column of <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig9">Figure 9</xref>). MAGIC accurately estimates the distributions of pairwise coalescence times, while MSMC is relatively inaccurate (<xref ref-type="fig" rid="fig3">Figure 3</xref>, top left). MAGIC also accurately infers the Laplace transforms of the distributions of the total branch lengths and the lengths of the tips of the full coalescent trees (<xref ref-type="fig" rid="fig3">Figure 3</xref>, top right). Comparing these inferences to the predictions of the <inline-formula><mml:math id="inf33"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> models corresponding to the pairwise inferences shows that MAGIC is more accurate than MSMC but is still missing features of the tree distributions, indicating that the model is not a good description of the population history. (The differences appear small in the plot, but are far larger than the uncertainties in the inferences and correspond to substantial differences in the actual distributions.) This failure of the <inline-formula><mml:math id="inf34"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> may be why MSMC is inaccurate in this case.<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.24836.004</object-id><label>Figure 3.</label><caption><title>Coalescence time distributions and their Laplace transforms for a simulated population with ancestral structure, as inferred from samples of intermediate and large size.</title><p>Top row: sample size <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> haplotypes. MAGIC accurately estimates the distribution of the pairwise coalescence time (top left), and the Laplace transforms of the distributions of the total branch length and the lengths of the tips of the branches (top right, green and blue, respectively). The gap between the estimated Laplace transforms (circles) and that obtained by simulating the <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> estimated from the pairwise coalescence time distribution (green and blue dashed curves) suggests that the <inline-formula><mml:math id="inf37"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> model is inaccurate. The pairwise Laplace transforms are shown in gray for comparison. MSMC’s inferences are less accurate. Bottom row: sample size <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> haplotypes (too large for MSMC). The gap remains between the estimated Laplace transform of the total branch length distribution and that derived from the pairwise <inline-formula><mml:math id="inf39"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, showing that the coalescent process cannot be described by a single <inline-formula><mml:math id="inf40"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. However, the tip length distribution matches that predicted from the pairwise comparisons, showing that the <inline-formula><mml:math id="inf41"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> model has predictive power for recent times.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.24836.004">http://dx.doi.org/10.7554/eLife.24836.004</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24836-fig3-v2"/></fig></p><p>MAGIC’s running time on large samples is dominated by the time to read all the data through memory, so it grows only linearly with sample size, meaning that the method can be run on essentially arbitrarily large samples. MAGIC accurately estimates the distribution of pairwise times and the Laplace transforms of the total branch length and tip length distributions in a sample of 100 haplotypes from the same admixed population (<xref ref-type="fig" rid="fig3">Figure 3</xref>, bottom row). (Curves are not shown for MSMC because it cannot analyze large samples; a sample size of eight from this population caused it to crash.) The total branch length Laplace transform remains different from that predicted by the effective population size model, but the tip Laplace transform matches almost exactly, indicating that the <inline-formula><mml:math id="inf42"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> model is accurately describing recent times (post-admixture, <inline-formula><mml:math id="inf43"><mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, roughly corresponding to <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi><mml:mo>≳</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>) but not ancient times (pre-admixture, <inline-formula><mml:math id="inf45"><mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, roughly corresponding to <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi><mml:mo>≲</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> ), as expected.</p><p>In the example above, we have only inferred the distributions (or their Laplace transforms) of pairwise coalescence times, total branch lengths, and tip lengths. But to be able to consider a wide range of models for the population, one must be able to estimate a wide range of parameters. MAGIC can infer the distribution of the total length of any specified set of tree branches. For a given set, MAGIC first filters the polymorphisms in the original data for those that correspond to mutations on the desired branches, and then proceeds with the same analysis as in the basic case of a single diploid sample. For example, to find the distribution of total branch length, MAGIC analyzes the genomic distribution of all polymorphic sites, while to find the distribution of tip lengths, it only looks at singletons on specific haplotypes. For data with no linkage information, the tree features that can be estimated correspond to components of the site-frequency spectrum (SFS), but while the SFS just gives estimates of the <italic>means</italic> of the lengths of different sets of branches, MAGIC infers full distributions.</p></sec><sec id="s2-4"><title>Human data</title><p>We used MAGIC to analyze the nine diploid sequences from unrelated Yoruban individuals in Complete Genomics’ ‘69 genomes’ data set (<xref ref-type="bibr" rid="bib5">Drmanac et al., 2010</xref>). The pairwise coalescence time distribution inferred from the heterozygosity distribution was similar to that obtained with MSMC run on individual samples. These distributions are plotted in the left panel of <xref ref-type="fig" rid="fig4">Figure 4</xref> as ‘effective population sizes’ (solid lines), while the underlying Laplace transform estimate is plotted in the right panel. The distributions differ mainly in the distant past where the data is limited. The fact that MSMC finds results from single individuals similar to those that MAGIC finds from the whole sample shows that MSMC is the more powerful method in this case. (MAGIC does not consistently detect the hump in <inline-formula><mml:math id="inf47"><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> at <inline-formula><mml:math id="inf48"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> when run on single individuals.)</p><p>We re-ran the analysis on samples simulated with ms using the inferred <inline-formula><mml:math id="inf49"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> trajectories; the results are shown in the left panel of <xref ref-type="fig" rid="fig4">Figure 4</xref> as dotted lines. These show that MAGIC’s results are more accurate than MSMC’s for the distant past: MAGIC recaptures a simulated ancient decrease in <inline-formula><mml:math id="inf50"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (orange) and partially recaptures a large ancient <inline-formula><mml:math id="inf51"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (blue), while MSMC misses the ancient decrease in <inline-formula><mml:math id="inf52"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (black). The fine-scale fluctuations that appear in MAGIC’s inferred <inline-formula><mml:math id="inf53"><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> for <inline-formula><mml:math id="inf54"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> are somewhat puzzling. The fact that MAGIC reproduces a smooth simulated trajectory (blue) and that MSMC fails to capture simulated fluctuations (black) would seem to suggest that they are a real feature of the data, but the fact that MAGIC also fails to capture simulated fluctuations (orange) argues against this. Instead, the fluctuations may be an artifact caused by some non-demographic feature of the real data that is missing in the simulations, potentially related to biases in sequencing coverage or SNP-calling.<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.24836.005</object-id><label>Figure 4.</label><caption><title>Inferred evolutionary history of Yoruban individuals.</title><p>Left: Inferred ‘effective population size’ <inline-formula><mml:math id="inf55"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for the nine unrelated Yoruban individuals from the 69 Genomes data set (<xref ref-type="bibr" rid="bib5">Drmanac et al., 2010</xref>). MAGIC’s inference from the full sample is similar to MSMC’s inference from each individual, differing mostly in the distant past where there is limited data. Dotted lines show inference from samples simulated under the inferred <inline-formula><mml:math id="inf56"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>’s, indicating that MAGIC’s inference in the distant past is likely to be more accurate than MSMC’s, but that its inference of the fine-scale structure in <inline-formula><mml:math id="inf57"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is unreliable. Right: Laplace transforms of the distributions of different coalescence times for the same sample. The pairwise coalescence time (corresponding to <inline-formula><mml:math id="inf58"><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> in the left plot) is in gray, while the total branch length is in green and the distribution of tip lengths is in blue. Points show the values inferred directly by MAGIC, while solid and dashed curves show the results of simulations based on the <inline-formula><mml:math id="inf59"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> curves inferred by MAGIC and MSMC, respectively. The pairwise <inline-formula><mml:math id="inf60"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> accurately describes the distribution of total branch lengths, but overestimates the tip length Laplace transform (i.e., underestimates the tip lengths). MAGIC’s overestimate roughly corresponds to a <inline-formula><mml:math id="inf61"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mn>10</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> underestimate of the median tip length, while MSMC’s corresponds to a <inline-formula><mml:math id="inf62"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mn>30</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> underestimate, indicating that both underestimate recent <inline-formula><mml:math id="inf63"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from pairwise data.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.24836.005">http://dx.doi.org/10.7554/eLife.24836.005</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24836-fig4-v2"/></fig></p><p>We also inferred the Laplace transforms of the distributions of two other coalescence times: the total branch length, and the lengths of the tips of the coalescent trees (<xref ref-type="fig" rid="fig4">Figure 4</xref>, right), and compared them to ms simulations of the inferred <inline-formula><mml:math id="inf64"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> demographies. The total branch length is close to that predicted by pairwise <inline-formula><mml:math id="inf65"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, but the tips of the trees are substantially longer. This is consistent with the fact that the pairwise inferences do not detect the recent Yoruban population growth, that is, underestimate the recent effective population size. (It could also be a signature of false-positive singleton SNPs.) Note that even if we did not know that the Yoruban population had been recently increasing, MAGIC’s result for the tips would tell us that the estimates of the left tail of the pairwise coalescence time distribution were inaccurate. To reconcile the results, one could try to find an <inline-formula><mml:math id="inf66"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> trajectory that fits all the points in the right panel of <xref ref-type="fig" rid="fig4">Figure 4</xref>. This could be done via ABC as in ABLE (<xref ref-type="bibr" rid="bib2">Beeravolu Reddy et al., 2016</xref>), simulating the coalescent under different <inline-formula><mml:math id="inf67"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and accepting trajectories that fit better. Unlike in ABLE, all the points are single-locus statistics, so these could be just single-locus simulations with no recombination, greatly reducing the computational requirements. Alternatively, one could simply try another inference method that is better able to resolve recent times (e.g., <xref ref-type="bibr" rid="bib29">Terhorst et al. (2017)</xref>’s SMC++) and then check whether the resulting <inline-formula><mml:math id="inf68"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> matches MAGIC’s inferences. Both of these approaches could also be generalized to include coalescents that cannot be described by an <inline-formula><mml:math id="inf69"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (e.g., for population structure, one could include it in an <italic>ad hoc</italic> ABC model, or one could use an existing method such as ABLE and test its results).</p></sec><sec id="s2-5"><title>Inferring differences among chromosomes: recombination and coalescence</title><p>MAGIC’s coalescence-time inference is designed to be robust to the form of recombination, but it can also be used to learn about recombination. To do this, rather than simply taking the small-window limit of Laplace transforms of the window-averaged coalescence time, one can look at how they change as a function of window size. In general, besides the small-window limit in which almost all windows lie within IBD blocks, there should also be a long-window limit in which almost all windows contain many IBD blocks. In between these two there is a transitional regime where the window length lies within the bulk of the distribution of IBD block lengths; finding this transitional length gives an estimate of the recombination rate.</p><p>Because the transition from the small-window to the large-window limit is not very sharp (<xref ref-type="fig" rid="fig6">Figure 6</xref>, bottom right), this estimate of the recombination rate is very rough. A more precise estimation requires a specific model of recombination and coalescence, like the one used by MSMC. But even if one does not have a good model for the dynamics of a population, one can make the assumption that all autosomes are experiencing roughly the same dynamics, whatever they are. (This assumption is implicit in all demographic inference from full genomes.) In that case, the dependence of the Laplace transforms of the window-averaged coalescence time on window length should be similar across autosomes, and differences in average recombination rates across chromosomes should be detectable as rescalings of the window lengths. MAGIC can therefore use these rescalings to precisely estimate <italic>relative</italic> recombination rates.</p><p>As an example of this approach, we analyze each autosome across the nine unrelated Yoruban individuals in the data set. We find that the Laplace transforms of their window-averaged coalescence time distributions all show a similar dependence on window length (<xref ref-type="fig" rid="fig5">Figure 5</xref>, top left). Up to a rescaling in length, the autosomes appear very similar (<xref ref-type="fig" rid="fig5">Figure 5</xref>, top center), with the exception of 19. The collapse of the remaining 21 autosomes suggests that they differ primarily in the amount of very recent coalescence (rescaling the heterozygosity) and in average recombination rates (rescaling the window lengths). The scaling factors for the window lengths therefore are an estimate of relative recombination rates, and are indeed very close to values measured by <xref ref-type="bibr" rid="bib16">Kong et al. (2002)</xref> (<xref ref-type="fig" rid="fig5">Figure 5</xref>, bottom), with the exception of chromosome 19, as expected.</p><p>It is no surprise that chromosome 19 is an outlier in coalescence: it has a much higher gene density than the other chromosomes (<xref ref-type="bibr" rid="bib10">Grimwood et al., 2004</xref>), and is therefore likely to have a much higher fraction of loci under selection and affected by linked selection (<xref ref-type="bibr" rid="bib13">Hernandez et al., 2011</xref>). However, the other autosomes do not have identical gene densities, and there are several large regions with unusual patterns of diversity, such as the MHC locus and flanking regions on chromosome 6. Indeed, even after rescaling, there is still more residual variation in coalescence across the 21 similar autosomes than would be expected by chance under the genomic coalescence time distributions inferred by MAGIC and MSMC (<xref ref-type="fig" rid="fig5">Figure 5</xref>, top right). This variation must be due to non-demographic factors driving coalescence; the fact that they are readily detectable suggests that one should be cautious in interpreting the details of the results of model-based inference in terms of demography.<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.24836.006</object-id><label>Figure 5.</label><caption><title>Integrating diversity patterns across length scales allows to compare recombination rates among chromosomes and to test whether the observed patterns can be explained by a single shared demographic history.</title><p>Top left: One value of the Laplace transform of the window-averaged coalescence time distribution as a function of window size for each autosome. The curves for most autosomes appear similar, but shifted both vertically and horizontally. Top center: Much inter-autosomal variation can be explained by variation in recombination rates: the curves are similar under a rescaling of window lengths (a horizontal shift such that the midpoints <inline-formula><mml:math id="inf70"><mml:msub><mml:mi>L</mml:mi><mml:mo>×</mml:mo></mml:msub></mml:math></inline-formula> of the curves align), except for chromosome 19 (yellow), which appears to have a different pattern of coalescence. Top right: There is substantial variation in the asymptotes that cannot be explained by variation in recombination rates, and is more than expected from intrinsic coalescent stochasticity. Plot shows the interquartile range (IQR) of the Laplace transform of the coalescence time distribution across chromosomes for the actual data as well as simulations of the pairwise coalescent histories inferred by MAGIC and MSMC (<xref ref-type="fig" rid="fig4">Figure 4</xref>). (Note that IQR, unlike variance, is insensitive to outliers.) Bottom: The rescaling of window sizes needed to align the different autosomes gives an estimate of their relative recombination rates which is very close to the values obtained by <xref ref-type="bibr" rid="bib16">Kong et al. (2002)</xref> (‘True’). For chromosomes other than 22, the inferred error bars are smaller than the size of the markers.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.24836.006">http://dx.doi.org/10.7554/eLife.24836.006</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24836-fig5-v2"/></fig></p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The MAGIC algorithm bridges the gap between fast but limited SFS-based approaches to demographic inference and model-based approaches that are limited to small sample sizes, allowing far more information to be extracted from large, high-coverage samples. To see the difference between MAGIC and an SFS-based approach, consider the information that can be gained from sites with singleton polymorphisms. Under an approach that treats sites independently, these can be summarized by one number – their genomic frequency – which can only be used to estimate one number – the mean total tip length of coalescent trees. MAGIC, in contrast, also considers how clustered the sites are over a wide range of lengthscales, allowing it to estimate not just the mean, but the whole distribution of total tip lengths.</p><p>While this manuscript was in preparation, two other methods extending the SFS by using linkage information were posted. <xref ref-type="bibr" rid="bib29">Terhorst et al. (2017)</xref>’s SMC++ uses the SFS to augment the pairwise coalescent inference approach of PSMC; <xref ref-type="bibr" rid="bib2">Beeravolu Reddy et al., 2016</xref>’s ABLE uses ms to fit demographic models to <xref ref-type="bibr" rid="bib4">Bunnefeld et al., 2015</xref>’s ‘blockwise SFS’ statistics. These methods share MAGIC’s aim of taking advantage of linkage information for large samples, and as mentioned above, ABLE’s initial summary of the genomic diversity is related to MAGIC’s. The fundamental difference is that both SMC++ and ABLE use explicit coalescence and recombination processes (SMC’ for SMC++, ms’s ancestral recombination graph for ABLE) to fit specified demographic models, while MAGIC focuses on just estimating the coalescence time distributions.</p><p>MAGIC is designed to be complementary to the existing inference methods, which largely rely on fitting simplified demographic models that neglect selection (<xref ref-type="bibr" rid="bib26">Schraiber and Akey, 2015</xref>). Because MAGIC makes no assumptions about whether coalescence is driven by demography or selection, and only minimal assumptions about mutation and recombination, it can be used as a first-pass analysis of genomes from species whose natural histories are not already well-known, with its results informing the choice of more detailed, model-based methods that use additional information outside of the sample sequences. Conversely, MAGIC can be used for a necessary final step missing in many demographic inference projects: model checking. To evaluate a model produced by other methods, one can use MAGIC to estimate additional parameters beyond those used to fit the model, and then test whether the model reproduces those values. If it does, this can be a crucial sign that the model is capturing important features of the underlying history, while if it does not, the deviations can point to ways in which the model needs to be adjusted (as with the inferences of the recent past of the Yoruban population above).</p><p>Finally, MAGIC’s estimated Laplace transforms could also be used directly to fit population models (including non-standard ones incorporating, for instance, linked selection, that are not implemented in existing inference methods). Because MAGIC converts the genomic distribution of diversity into the Laplace transforms of single-locus coalescent times, fitting models to its results requires only single-locus coalescent simulations or calculations, which are much less computationally intensive than multi-locus ones. They can thus reasonably be found analytically or via Approximate Bayesian Computation for many models.</p><p>Even for populations for which there are good <italic>a priori</italic> models, the minimal-assumption approach has advantages. Because MAGIC has a modular structure and is not tailored to a specific population model, it can be used to quickly analyze many populations with very different dynamics, with each population’s model incorporated in just the last step of the analysis. Similarly, for any given population, MAGIC can estimate many different parameters describing coalescence and recombination to answer multiple questions about the historical dynamics. Finally, not using any explicit model of coalescence and recombination keeps MAGIC’s algorithm simple enough that it runs quickly even on very large sample sizes, and that users familiar with Python can understand and modify it.</p><p>There are a number of potential modifications to MAGIC that users could make. At a minimum, there are likely to be technical improvements to the estimation methods that would allow it to get more information out of the data. More interestingly, the range of parameters estimated by MAGIC could be extended. In particular, MAGIC currently infers the distributions of features of coalescent trees that can be found from unphased, unpolarized polymorphism data, but it could be extended to take advantage of this extra information when available. It would also be possible to extend MAGIC so that it would infer <italic>joint</italic> distributions of different coalescence times, rather than just all the marginal distributions. This would greatly increase the amount of information that could be extracted from extremely large data sets such as are likely to be available in the near future.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Diversity across genomic windows</title><p>A sample set of genomes will comprise many blocks of sequence with different coalescent histories; by looking at the distribution of genetic diversity across blocks, one can estimate the coalescence time distribution of the population the sample was drawn from. <xref ref-type="bibr" rid="bib17">Li and Durbin (2011)</xref> and <xref ref-type="bibr" rid="bib25">Schiffels and Durbin (2014)</xref> try to do this by considering all possible boundaries between the blocks using a hidden Markov model. However, block boundaries are only easy to identify when mutation rates are much larger than recombination rates, which is generally not the case, and describing every possible block becomes impractical for larger sample sizes as the number of blocks proliferates. Instead, we simply divide the genome into windows of a fixed length <inline-formula><mml:math id="inf71"><mml:mi>L</mml:mi></mml:math></inline-formula>, and consider the distribution of histories of windows. MAGIC estimates the distribution of a single coalescence time (i.e., coalescent tree parameter) <inline-formula><mml:math id="inf72"><mml:mi>T</mml:mi></mml:math></inline-formula> across genomic positions <inline-formula><mml:math id="inf73"><mml:mi>x</mml:mi></mml:math></inline-formula>. For single diploid samples, <inline-formula><mml:math id="inf74"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the total branch length (twice the time to the most recent common ancestor at position <inline-formula><mml:math id="inf75"><mml:mi>x</mml:mi></mml:math></inline-formula>) and completely characterizes the coalescent history. For larger samples, MAGIC can be used to estimate the distributions of multiple statistics one at a time.</p><p>We assume the infinite sites model, in which each mutation occurs at a unique locus. Under this model, the diversity (e.g., heterozygosity in a single diploid sample) in a window of length <inline-formula><mml:math id="inf76"><mml:mi>L</mml:mi></mml:math></inline-formula> starting at position <inline-formula><mml:math id="inf77"><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> has a distribution that depends only on the <italic>window-averaged coalescence time</italic>, <inline-formula><mml:math id="inf78"><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> defined as<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>≡</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>If <inline-formula><mml:math id="inf79"><mml:mi>L</mml:mi></mml:math></inline-formula> is smaller than most block lengths, then windows will typically lie within blocks, and the distribution <inline-formula><mml:math id="inf80"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> of <inline-formula><mml:math id="inf81"><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> will be close to the distribution <inline-formula><mml:math id="inf82"><mml:msub><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula> of <inline-formula><mml:math id="inf83"><mml:mi>T</mml:mi></mml:math></inline-formula>. For very large <inline-formula><mml:math id="inf84"><mml:mi>L</mml:mi></mml:math></inline-formula>, each window will average over many blocks, and <inline-formula><mml:math id="inf85"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> will have a narrow support around the mean of <inline-formula><mml:math id="inf86"><mml:msub><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula>. Usually, there will be a wide range of intermediate values of <inline-formula><mml:math id="inf87"><mml:mi>L</mml:mi></mml:math></inline-formula> for which windows lie inside long blocks but cover multiple short blocks. Ideally, we would like to use information from windows with lengths throughout this range, preferentially selecting the ones that lie inside long blocks.</p><p>Given that <inline-formula><mml:math id="inf88"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> approaches <inline-formula><mml:math id="inf89"><mml:msub><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula>, as <inline-formula><mml:math id="inf90"><mml:mi>L</mml:mi></mml:math></inline-formula> decreases, one might be tempted to take <inline-formula><mml:math id="inf91"><mml:mi>L</mml:mi></mml:math></inline-formula> to be as small as possible, but the problem of course is that we cannot see <inline-formula><mml:math id="inf92"><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> directly; we need to infer it from the number of SNPs in the window. Given <inline-formula><mml:math id="inf93"><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>, and assuming a constant mutation rate <inline-formula><mml:math id="inf94"><mml:mi>μ</mml:mi></mml:math></inline-formula> per base, the number of SNPs will be approximately Poisson-distributed with mean <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. (Here we are assuming that <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> is always small enough that each base has only a small chance of having mutated; this allows us to approximate the underlying sum of binomially-distributed random variables with a Poisson that depends only on <inline-formula><mml:math id="inf97"><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>.) The smaller <inline-formula><mml:math id="inf98"><mml:mi>L</mml:mi></mml:math></inline-formula> is, the lower the signal-to-noise ratio in the number of SNPS will be and the less power we will have to distinguish different values of <inline-formula><mml:math id="inf99"><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>. Thus, we expect that we will get the most information about <inline-formula><mml:math id="inf100"><mml:msub><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula> from an intermediate value of <inline-formula><mml:math id="inf101"><mml:mi>L</mml:mi></mml:math></inline-formula>, and should be able to do better still by integrating information from multiple values of <inline-formula><mml:math id="inf102"><mml:mi>L</mml:mi></mml:math></inline-formula>.</p><p>The total probability that there are <inline-formula><mml:math id="inf103"><mml:mi>n</mml:mi></mml:math></inline-formula> SNPs in a window of length <inline-formula><mml:math id="inf104"><mml:mi>L</mml:mi></mml:math></inline-formula> is the average of the Poisson distribution over all possible values of <inline-formula><mml:math id="inf105"><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf106"><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> is the window-averaged coalescence time scaled such that it is equal to the expected number of SNPs in the window: <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula><inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is a Poisson mixture distribution, with mixing distribution given by <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>, the cumulative distribution function of <inline-formula><mml:math id="inf110"><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>, i.e., the fraction of the genome that is expected to have coalesced by a given scaled time. The observed SNP count distributions <inline-formula><mml:math id="inf111"><mml:mover accent="true"><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> thus give us information about the window-averaged coalescence-time distributions <inline-formula><mml:math id="inf112"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>. We could try to estimate the full distribution <inline-formula><mml:math id="inf113"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>, but we are primarily interested in the true single-locus coalescence-time distribution <inline-formula><mml:math id="inf114"><mml:msub><mml:mi>P</mml:mi><mml:mi>τ</mml:mi></mml:msub></mml:math></inline-formula> (where <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>≡</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≡</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>). We will therefore focus on estimating just features of <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> that can then be combined to estimate <inline-formula><mml:math id="inf117"><mml:msub><mml:mi>P</mml:mi><mml:mi>τ</mml:mi></mml:msub></mml:math></inline-formula>.</p></sec><sec id="s4-2"><title>Laplace transforms</title><p>We need to choose which set of parameters describing <inline-formula><mml:math id="inf118"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> to estimate. The Laplace transform <inline-formula><mml:math id="inf119"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, evaluated at a set of points <inline-formula><mml:math id="inf120"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, is a natural choice, as it is closely related to the diversity distribution (<xref ref-type="bibr" rid="bib19">Lohse et al., 2011</xref>): <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> shows that <inline-formula><mml:math id="inf121"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the <inline-formula><mml:math id="inf122"><mml:msup><mml:mi>n</mml:mi><mml:mtext>th</mml:mtext></mml:msup></mml:math></inline-formula> Taylor coefficient of <inline-formula><mml:math id="inf123"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> about <inline-formula><mml:math id="inf124"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. This has two implications. First, the similarity to the proportion of homozygous windows <inline-formula><mml:math id="inf125"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> means that the Laplace transform has a natural interpretation as an estimate for the proportion of windows of length <inline-formula><mml:math id="inf126"><mml:mi>L</mml:mi></mml:math></inline-formula> that would be homozygous if the mutation rate were multiplied by <inline-formula><mml:math id="inf127"><mml:mi>z</mml:mi></mml:math></inline-formula>. (It is also closely related to the distribution of lengths of IBD blocks – see below.) Second, we can quickly and easily estimate <inline-formula><mml:math id="inf128"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> using the plug-in estimator:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:munderover><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The estimate lt of the <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> transform will be accurate for <inline-formula><mml:math id="inf129"><mml:mi>z</mml:mi></mml:math></inline-formula> close to 1, but will blow up for large <inline-formula><mml:math id="inf130"><mml:mi>z</mml:mi></mml:math></inline-formula> – we cannot accurately estimate the amount of very recent coalescence. To make this precise, we need to estimate the error in <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> due to the stochastic mutation accumulation process. But this depends on the unobserved distribution <inline-formula><mml:math id="inf131"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>, so we will need a rough estimate of this distribution. We use <xref ref-type="bibr" rid="bib9">Ghosh et al., 1983</xref>’s estimator <inline-formula><mml:math id="inf132"><mml:msub><mml:mi>δ</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math></inline-formula> to estimate the value of <inline-formula><mml:math id="inf133"><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> for every window from the observed number of SNPs <inline-formula><mml:math id="inf134"><mml:mi>n</mml:mi></mml:math></inline-formula>; roughly, this gives <inline-formula><mml:math id="inf135"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, with a correction given by their Equation (2.17) that slightly shrinks the estimated values. (This shrinkage improves the estimate for small values of <inline-formula><mml:math id="inf136"><mml:mi>n</mml:mi></mml:math></inline-formula>.) For <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf138"><mml:msub><mml:mi>δ</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math></inline-formula> would give <inline-formula><mml:math id="inf139"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, implying that mutations could never occur, we adjust the formula to <inline-formula><mml:math id="inf140"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf141"><mml:msub><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is the number of windows with 0 SNPs, to account for the fact that coalescence times may not be exactly 0. We then calculate the standard error that would be introduced by the stochastic mutation accumulation process under <inline-formula><mml:math id="inf142"><mml:mover accent="true"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>z</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf143"><mml:mi>K</mml:mi></mml:math></inline-formula> is the total number of windows. The accuracy of <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> and <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> could be improved by using more sophisticated estimators, but the current ones are the easiest to compute.</p></sec><sec id="s4-3"><title>Combining length scales</title><p>To combine information from different window lengths, we need to correct for the increase in window-wide mutation rate <inline-formula><mml:math id="inf144"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. We can therefore consider the quantity <inline-formula><mml:math id="inf145"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf146"><mml:mi>L</mml:mi></mml:math></inline-formula>, holding <inline-formula><mml:math id="inf147"><mml:mi>z</mml:mi></mml:math></inline-formula> fixed, as shown in the bottom panels of <xref ref-type="fig" rid="fig6">Figure 6</xref>. When <inline-formula><mml:math id="inf148"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> is nearly independent of <inline-formula><mml:math id="inf149"><mml:mi>L</mml:mi></mml:math></inline-formula>, this quantity should be nearly constant. (To see this, note that <inline-formula><mml:math id="inf150"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with no explicit <inline-formula><mml:math id="inf151"><mml:mi>L</mml:mi></mml:math></inline-formula> dependence.) This is the case for very large <inline-formula><mml:math id="inf152"><mml:mi>L</mml:mi></mml:math></inline-formula>, when each window averages over many coalescent blocks, and for very small <inline-formula><mml:math id="inf153"><mml:mi>L</mml:mi></mml:math></inline-formula>, where each window falls within a coalescent block and <inline-formula><mml:math id="inf154"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> approaches <inline-formula><mml:math id="inf155"><mml:msub><mml:mi>P</mml:mi><mml:mi>τ</mml:mi></mml:msub></mml:math></inline-formula>, the distribution we are interested in. We therefore fit a sigmoid curve (specifically, Richards’ curve) to <inline-formula><mml:math id="inf156"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf157"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>,<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mfrac><mml:mo>,</mml:mo><mml:mtext>with</mml:mtext><mml:mtext> </mml:mtext><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>;</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn><mml:mo>;</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.24836.007</object-id><label>Figure 6.</label><caption><title>Example of converting the distribution of SNPs to the coalescence time distribution.</title><p>Data are from the simulated ‘bottleneck’ demography (<xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig9">Figure 9</xref>, left columns). Top left: Distribution of SNP densities across windows of different lengths, normalized by the heterozygosity <inline-formula><mml:math id="inf158"><mml:mrow><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>≈</mml:mo><mml:mrow><mml:mn>1.3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. The width of a bar represents the fraction of windows with a given SNP density. The densities are shown on an arcsinh scale (approximately logarithmic for large values but linear for small values). At short lengths, the distribution is concentrated at zero, while at long lengths it is bunched near the mean, with the best spread in between. Top right: The Laplace transform <inline-formula><mml:math id="inf159"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the window-averaged coalescence time distribution <inline-formula><mml:math id="inf160"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> as a function of window length <inline-formula><mml:math id="inf161"><mml:mi>L</mml:mi></mml:math></inline-formula> and Laplace transform variable <inline-formula><mml:math id="inf162"><mml:mi>z</mml:mi></mml:math></inline-formula>. Points show the estimates derived from the SNP density distribution (using <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>, with error bars given by <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>), curves are sigmoid fits (<xref ref-type="disp-formula" rid="equ5">Equation 5</xref>). For small <inline-formula><mml:math id="inf163"><mml:mi>z</mml:mi></mml:math></inline-formula> (long times), small windows can be used to estimate the left asymptote <inline-formula><mml:math id="inf164"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, while for large <inline-formula><mml:math id="inf165"><mml:mi>z</mml:mi></mml:math></inline-formula> (short times), the estimates from small windows diverge (missing points with <inline-formula><mml:math id="inf166"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≪</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula>)) and longer windows need to be used. Typical coalescence times correspond to <inline-formula><mml:math id="inf167"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (blue-green). Bottom left: Laplace transform of the coalescence time distribution. Points are the left asymptotes of the <inline-formula><mml:math id="inf168"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> curves in the top right panel. Black curve shows the true transform, magenta curve shows MAGIC’s fitted distributions (the gamma mixture and piecewise exponential forms give indistinguishable curves), cyan curve shows the Laplace transform of MSMC’s estimated coalescence time distribution. All the curves are close, but differ slightly for very large <inline-formula><mml:math id="inf169"><mml:mi>z</mml:mi></mml:math></inline-formula>, corresponding to very recent times, with MSMC also differing for small <inline-formula><mml:math id="inf170"><mml:mi>z</mml:mi></mml:math></inline-formula> (ancient times). Bottom right: Same as top right, rescaled to show that as <inline-formula><mml:math id="inf171"><mml:mi>z</mml:mi></mml:math></inline-formula> increases, longer windows are sufficient to accurately estimate <inline-formula><mml:math id="inf172"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. But the increase in the minimum sufficient window length is slower than the increase in the minimum length for which <inline-formula><mml:math id="inf173"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be accurately estimated (top right, leftmost points), putting a limit on the maximum <inline-formula><mml:math id="inf174"><mml:mi>z</mml:mi></mml:math></inline-formula> for <inline-formula><mml:math id="inf175"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be estimated (bottom left, rightmost point).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.24836.007">http://dx.doi.org/10.7554/eLife.24836.007</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24836-fig6-v2"/></fig></p><p>and take the left asymptote <inline-formula><mml:math id="inf176"><mml:msub><mml:mi>a</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:math></inline-formula> as an estimate of <inline-formula><mml:math id="inf177"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The right asymptote <inline-formula><mml:math id="inf178"><mml:msub><mml:mi>b</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:math></inline-formula> is the long-window limit, and can therefore be estimated directly from the genomic density of SNPs <inline-formula><mml:math id="inf179"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>:</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. (<inline-formula><mml:math id="inf180"><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the heterozygosity in the basic case when <inline-formula><mml:math id="inf181"><mml:mrow><mml:mi>T</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> is the pairwise TMRCA, but more generally it is the density of SNPs corresponding to the branch statistic being estimated.) To fit the remaining parameters, we use the curve_fit function in SciPy’s optimize package on the lowest-<inline-formula><mml:math id="inf182"><mml:mi>L</mml:mi></mml:math></inline-formula> points that have small estimated errors. curve_fit also returns a standard error <inline-formula><mml:math id="inf183"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, estimated under the assumption that the errors in <inline-formula><mml:math id="inf184"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are independent for different values of <inline-formula><mml:math id="inf185"><mml:mi>L</mml:mi></mml:math></inline-formula>. This is obviously not true (all estimates are from the same set of mutations), but even for lengthscales that are only separated by factors of <inline-formula><mml:math id="inf186"><mml:mn>2</mml:mn></mml:math></inline-formula>, the correlations in the error appear to be small in simulations, giving final error bars of roughly the right magnitude. While <inline-formula><mml:math id="inf187"><mml:msub><mml:mi>a</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:math></inline-formula> contains the information about the single-locus coalescent, the values of other parameters, particularly <inline-formula><mml:math id="inf188"><mml:msub><mml:mi>L</mml:mi><mml:mo>×</mml:mo></mml:msub></mml:math></inline-formula>, are informative about recombination – see ‘Inferring recombination rates’ and <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p><p>The sigmoid form sigmoid is flexible enough to fit all of the simulated and real data that we have examined, but we only trust our estimate of <inline-formula><mml:math id="inf189"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> if the data are close enough to the left asymptote so that the estimate is not very sensitive to the choice of functional form. Effectively, this means that the estimate is close to <inline-formula><mml:math id="inf190"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for the smallest <inline-formula><mml:math id="inf191"><mml:mi>L</mml:mi></mml:math></inline-formula> for which the estimated error bars are small, with corrections based on the next few higher lengthscales. But this smallest <inline-formula><mml:math id="inf192"><mml:mi>L</mml:mi></mml:math></inline-formula> depends on <inline-formula><mml:math id="inf193"><mml:mi>z</mml:mi></mml:math></inline-formula>, so while for any given value of <inline-formula><mml:math id="inf194"><mml:mi>z</mml:mi></mml:math></inline-formula> only a few lengthscales are important, every lengthscale is important for estimating the Laplace transform for some <inline-formula><mml:math id="inf195"><mml:mi>z</mml:mi></mml:math></inline-formula>. Short lengthscales are useful for small <inline-formula><mml:math id="inf196"><mml:mi>z</mml:mi></mml:math></inline-formula> (i.e., long coalescence times), while long lengthscales are useful for large <inline-formula><mml:math id="inf197"><mml:mi>z</mml:mi></mml:math></inline-formula> (short coalescence times) (<xref ref-type="fig" rid="fig6">Figure 6</xref>, bottom panels). To see why this is, recall that our estimate <inline-formula><mml:math id="inf198"><mml:mover accent="true"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is most accurate for arguments near 1, so for each <inline-formula><mml:math id="inf199"><mml:mi>z</mml:mi></mml:math></inline-formula> our most accurate estimate of <inline-formula><mml:math id="inf200"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> comes from windows of length <inline-formula><mml:math id="inf201"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula>. Our smallest window size <inline-formula><mml:math id="inf202"><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> therefore puts a lower limit on the values of <inline-formula><mml:math id="inf203"><mml:mi>z</mml:mi></mml:math></inline-formula> for which we can estimate <inline-formula><mml:math id="inf204"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, that is, an upper limit on the times we can characterize. Similarly, there is an upper limit on the <inline-formula><mml:math id="inf205"><mml:mi>z</mml:mi></mml:math></inline-formula> values (lower limit on timescale) that we can resolve. This can occur at the value of <inline-formula><mml:math id="inf206"><mml:mrow><mml:mi>z</mml:mi><mml:mo>∼</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> at which the windows become so large that we only have a few per chromosome and no longer have good statistics, or, as in <xref ref-type="fig" rid="fig6">Figure 6</xref>, at values such that the windows are so long that even the most recently-coalesced ones cover multiple recombination breakpoints, that is, <inline-formula><mml:math id="inf207"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is far from the asymptote <inline-formula><mml:math id="inf208"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-4"><title>Coalescence-time distributions</title><p>Once we have estimates for the Laplace transform of the coalescence time distribution at a set of <inline-formula><mml:math id="inf209"><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula>, we would like to invert the transform to obtain <inline-formula><mml:math id="inf210"><mml:msub><mml:mi>p</mml:mi><mml:mi>τ</mml:mi></mml:msub></mml:math></inline-formula>. The moments of <inline-formula><mml:math id="inf211"><mml:mi>τ</mml:mi></mml:math></inline-formula> are trivial to find, simply by taking derivatives of <inline-formula><mml:math id="inf212"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at <inline-formula><mml:math id="inf213"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, but beyond the first moment these tend to be dominated by rare, deep coalescence events and so are not informative about the bulk of the distribution. Unfortunately, inverting Laplace transforms is a fundamentally hard problem (<xref ref-type="bibr" rid="bib6">Epstein and Schotland, 2008</xref>), and we need to assume some kind of parametric form for <inline-formula><mml:math id="inf214"><mml:msub><mml:mi>p</mml:mi><mml:mi>τ</mml:mi></mml:msub></mml:math></inline-formula>. We have implemented two possibilities in MAGIC.</p><p>First, one can assume that <inline-formula><mml:math id="inf215"><mml:msub><mml:mi>p</mml:mi><mml:mi>τ</mml:mi></mml:msub></mml:math></inline-formula> can be written as a mixture of gamma distributions:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mtext>M</mml:mtext></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">⌊</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo stretchy="false">⌋</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf216"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and all <inline-formula><mml:math id="inf217"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf218"><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf219"><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are positive. This can also be extended to include a possible point mass at <inline-formula><mml:math id="inf220"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> when estimating the distribution of features for which it is possible that some trees will have a value of exactly 0. For instance, in a sample of 10 haplotypes, there will typically be some loci for which the coalescent tree has no branches that are ancestral to exactly 5 loci. (More generally, this should be considered when estimating the distribution of lengths of branches that are ancestral to exactly <inline-formula><mml:math id="inf221"><mml:mi>k</mml:mi></mml:math></inline-formula> out of sample of <inline-formula><mml:math id="inf222"><mml:mi>n</mml:mi></mml:math></inline-formula> individuals, for any <inline-formula><mml:math id="inf223"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mi>k</mml:mi><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.) Alternatively, one can assume that <inline-formula><mml:math id="inf224"><mml:msub><mml:mi>p</mml:mi><mml:mi>τ</mml:mi></mml:msub></mml:math></inline-formula> can be written as a piecewise-exponential function, as in MSMC and PSMC:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>τ</mml:mi><mml:mtext>PE</mml:mtext></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf225"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf226"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mo>⋯</mml:mo><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf227"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. For pairwise coalescence times, <inline-formula><mml:math id="inf228"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> has a natural interpretation as the instantaneous coalescence rate, that is, the inverse of <inline-formula><mml:math id="inf229"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Both of these forms have the computational advantage of having analytic Laplace transforms:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⌊</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn><mml:mo fence="false" stretchy="false">⌋</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>z</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext>(gamma mixture)</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mi>z</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mtext>(piecewise exponential)</mml:mtext><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>with an additional constant term if a point mass at <inline-formula><mml:math id="inf230"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is included. This means that we can simply fit <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> to the values <inline-formula><mml:math id="inf231"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mover accent="true"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> without having to deal with inverse Laplace transforms directly. We use the basin-hopping optimization algorithm implemented in SciPy to find the parameters that minimize the scaled squared error <inline-formula><mml:math id="inf232"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. For the gamma mixture, we optimize <inline-formula><mml:math id="inf233"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. For the piecewise exponential, we fix the <inline-formula><mml:math id="inf234"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> to be evenly spread in log space between <inline-formula><mml:math id="inf235"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf236"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf237"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>τ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula> and optimize the rates <inline-formula><mml:math id="inf238"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, with a quadratic penalty on <inline-formula><mml:math id="inf239"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for regularization. These forms are flexible enough to fit all the data that we have tried (see, e.g., <xref ref-type="fig" rid="fig6">Figure 6</xref>, bottom left – the two forms give indistinguishable curves). The piecewise-exponential form is better-suited for estimating <inline-formula><mml:math id="inf240"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from pairwise coalescence times, and appears to tend to be more accurate in the tails of the distribution (<xref ref-type="fig" rid="fig7">Figure 7</xref>); we have used it in all curves except the ones in <xref ref-type="fig" rid="fig7">Figure 7</xref> specifically labeled as showing the gamma mixture form.<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.24836.008</object-id><label>Figure 7.</label><caption><title>Comparison of the functional forms for the coalescence time distribution.</title><p>The inferred piecewise exponential (solid magenta) and gamma mixture (dashed purple) distributions are very similar, but where they differ, the piecewise exponential form is closer to the true distribution (black). Simulations are the same as shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. The two forms’ predicted block-length distributions (dotted curves in <xref ref-type="fig" rid="fig2">Figure 2</xref> are indistinguishable.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.24836.008">http://dx.doi.org/10.7554/eLife.24836.008</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24836-fig7-v2"/></fig></p><sec id="s4-4-1"><title>Block-length distributions</title><p>Identical-by-descent (IBD) blocks are stretches of the genome that have not undergone recombination since the common ancestor of the block. The distribution of block lengths can be used to infer patterns of relatedness and ancestry (<xref ref-type="bibr" rid="bib17">Li and Durbin, 2011</xref>; <xref ref-type="bibr" rid="bib24">Ralph and Coop, 2013</xref>), but it is hard to measure except for long blocks with very recent common ancestors, because the recombination events are not directly observable. Under the standard assumptions that coalescence is mostly driven by neutral processes (rather than linked selection) and that recombination primarily occurs via crossovers, the distribution of the genetic map lengths of these blocks across the genome is closely related to the Laplace transform of the coalescence time distribution:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mtext>block</mml:mtext></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>T</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We can estimate the block-length distribution in Morgans simply by approximating the derivative of <inline-formula><mml:math id="inf241"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula>, a much easier problem than inverting the transform. If we want to convert map lengths to numbers of bases, we need to estimate the crossover frequency per base. The dependence of <inline-formula><mml:math id="inf242"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> on <inline-formula><mml:math id="inf243"><mml:mi>L</mml:mi></mml:math></inline-formula> (i.e., <inline-formula><mml:math id="inf244"><mml:msub><mml:mi>L</mml:mi><mml:mo>×</mml:mo></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> above) provides a rough estimate; MSMC gives a more precise one. blocklength gives the distribution of lengths of blocks that are not interrupted by even ‘ghost’ recombination events where the coalescent tree does not change ([<xref ref-type="bibr" rid="bib20">Marjoram and Wall, 2006</xref>]’s ‘<italic>R</italic> class’ of events). In the simplest case of a single diploid sample from a well-mixed population evolving neutrally under the Kingman coalescent, these ghost events can be ignored by simply scaling all recombination rates by <inline-formula><mml:math id="inf245"><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, but in general they must be included, even though they are not directly observable.</p></sec></sec><sec id="s4-5"><title>Required sequence length and polymorphism density</title><p>For MAGIC to accurately estimate the probability of coalescence within a time interval, the underlying genomic data must contain many regions that coalesced within that interval, and these regions must have enough polymorphisms to put reasonable limits on their coalescence times. For these to be true, there must be at least some minimum length of sequence, and recombination must not be too frequent relative to mutation (or else regions short enough to have a single coalescent history will not contain multiple polymorphisms). To explore this first condition, we tried decreasing the amount of simulated data in <xref ref-type="fig" rid="fig2">Figure 2</xref> from the original <inline-formula><mml:math id="inf246"><mml:msup><mml:mn>10</mml:mn><mml:mn>9</mml:mn></mml:msup></mml:math></inline-formula> bases. MAGIC was consistently able to infer the Laplace transform (and therefore the probability distribution) when using only <inline-formula><mml:math id="inf247"><mml:msup><mml:mn>10</mml:mn><mml:mn>8</mml:mn></mml:msup></mml:math></inline-formula> bases (i.e., approximately one human chromosome), but when using just <inline-formula><mml:math id="inf248"><mml:msup><mml:mn>10</mml:mn><mml:mn>7</mml:mn></mml:msup></mml:math></inline-formula> bases succeeded in only some simulations (<xref ref-type="fig" rid="fig8">Figure 8</xref>, top). To explore the second condition, we re-simulated the ‘bottleneck’ history with increasing values of the crossover rate, <inline-formula><mml:math id="inf249"><mml:mi>ρ</mml:mi></mml:math></inline-formula> (and without gene conversion). MAGIC accurately inferred the full Laplace transform until crossovers became more frequent than mutations, <inline-formula><mml:math id="inf250"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>≳</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig8">Figure 8</xref>, bottom), at which point it was only able to infer for small values of <inline-formula><mml:math id="inf251"><mml:mi>z</mml:mi></mml:math></inline-formula>, where the inference primarily depends on short windows (<xref ref-type="fig" rid="fig6">Figure 6</xref>, right panels).<fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.24836.009</object-id><label>Figure 8.</label><caption><title>Limits on inferring the Laplace transform of simulated pairwise coalescence distributions.</title><p>Symbols and colors are as in the bottom left panel of <xref ref-type="fig" rid="fig6">Figure 6</xref>. Top: MAGIC can usually accurately infer the Laplace transform from <inline-formula><mml:math id="inf252"><mml:msup><mml:mn>10</mml:mn><mml:mn>8</mml:mn></mml:msup></mml:math></inline-formula> sequenced bases (top row), but often fails when the data is limited to <inline-formula><mml:math id="inf253"><mml:msup><mml:mn>10</mml:mn><mml:mn>7</mml:mn></mml:msup></mml:math></inline-formula> bases (bottom row, right two panels). Even under limited data, the inferences that it does manage to make remain accurate (bottom row, left panel). Other simulation parameters are as in the top row of <xref ref-type="fig" rid="fig2">Figure 2</xref>. Bottom: MAGIC can infer most of the Laplace transform when the crossover rate, <inline-formula><mml:math id="inf254"><mml:mi>ρ</mml:mi></mml:math></inline-formula>, is less than the mutation rate, <inline-formula><mml:math id="inf255"><mml:mi>μ</mml:mi></mml:math></inline-formula> (left two panels), but for <inline-formula><mml:math id="inf256"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (right panel), it becomes limited to large <inline-formula><mml:math id="inf257"><mml:mi>z</mml:mi></mml:math></inline-formula>. Simulation parameters are as in the top left panel of <xref ref-type="fig" rid="fig2">Figure 2</xref>, with <inline-formula><mml:math id="inf258"><mml:mi>ρ</mml:mi></mml:math></inline-formula> increased.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.24836.009">http://dx.doi.org/10.7554/eLife.24836.009</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24836-fig8-v2"/></fig></p></sec><sec id="s4-6"><title>Implementation</title><p>The code for MAGIC is written in Python and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/weissmanlab/magic">https://github.com/weissmanlab/magic</ext-link> (<xref ref-type="bibr" rid="bib30">Weissman, 2017</xref>). It uses the same input format as MSMC and the msmc-tools suite. A copy is archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/magic">https://github.com/elifesciences-publications/magic</ext-link>.</p></sec><sec id="s4-7"><title>Data processing</title><p>We use the 69 Genomes Diversity Panel from Complete Genomics (<xref ref-type="bibr" rid="bib5">Drmanac et al., 2010</xref>), and use msmc-tools (<xref ref-type="bibr" rid="bib25">Schiffels and Durbin, 2014</xref>) to turn the data into a list of SNPs. We split the genome into windows of 80 bp, count the number of SNPs in each window, and then repeatedly merge all windows in pairs and re-count to get the SNP count distribution at successively larger length scales (<xref ref-type="fig" rid="fig1">Figure 1</xref>, bottom left; <xref ref-type="fig" rid="fig6">Figure 6</xref>, top left). (To correct for uneven sequencing coverage across windows, all windows with <inline-formula><mml:math id="inf259"><mml:mrow><mml:mi/><mml:mo>&lt;</mml:mo><mml:mrow><mml:mn>80</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> coverage were dropped, and all with <inline-formula><mml:math id="inf260"><mml:mrow><mml:mi/><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>80</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> coverage were down-sampled to <inline-formula><mml:math id="inf261"><mml:mrow><mml:mn>80</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula>.) This gives us SNP count distributions at a range of length scales for every chromosome of every individual in the data set.</p></sec><sec id="s4-8"><title>Simulated data</title><p>All coalescent simulations were done in ms (<xref ref-type="bibr" rid="bib15">Hudson, 2002</xref>). To make the simulations computationally tractable, genomes were assembled from independently simulated ‘chromosomes’ of <inline-formula><mml:math id="inf262"><mml:msup><mml:mn>10</mml:mn><mml:mn>7</mml:mn></mml:msup></mml:math></inline-formula> bases each.</p><p>For the test demographic scenarios in <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig3">Figure 3</xref>, the per-base mutation rate was <inline-formula><mml:math id="inf263"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. (ms is parametrized in terms of the present population size, <inline-formula><mml:math id="inf264"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>.) For the ‘bottleneck’ scenario, the demography was given by the command ‘-eG .3 10 -eG .4–10 -eG .6 0’; for ‘repeated bottlenecks’, by ‘-eG .1–10 -eG .3 10 -eG .5–10 -eG .7 10 -eG .9–10 -eG 1.1 10 ”; and for ‘admixture’, by ‘-es .1 1 .5 -ej 2 1 2’. See <xref ref-type="fig" rid="fig9">Figure 9</xref> for schematics. For the pairwise simulations, each sample consisted of <inline-formula><mml:math id="inf265"><mml:mn>100</mml:mn></mml:math></inline-formula> chromosomes with recombination rates as listed in <xref ref-type="fig" rid="fig2">Figure 2</xref>. For the larger-sample simulations in <xref ref-type="fig" rid="fig3">Figure 3</xref>, each sample consisted of <inline-formula><mml:math id="inf266"><mml:mn>10</mml:mn></mml:math></inline-formula> chromosomes with per-base rate of crossovers <inline-formula><mml:math id="inf267"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>/</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and per-base rate of initiation of gene conversion <inline-formula><mml:math id="inf268"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>/</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> with mean tract length <inline-formula><mml:math id="inf269"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mtext>kb</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>.<fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.24836.010</object-id><label>Figure 9.</label><caption><title>Demographic scenarios simulated.</title><p>All time intervals are in units of <inline-formula><mml:math id="inf270"><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. In the ‘bottleneck’ and ‘repeated bottlenecks’ scenarios, the population grows and shrinks exponentially at rate <inline-formula><mml:math id="inf271"><mml:mrow><mml:mn>10</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.24836.010">http://dx.doi.org/10.7554/eLife.24836.010</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24836-fig9-v2"/></fig></p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Paul Marjoram, Magnus Nordborg, Stephan Schiffels, and Diethard Tautz for their very thoughtful and helpful review, with additional thanks to Dr. Schiffels for help with MSMC. We also thank Kelley Harris and Rasmus Nielsen for help with human population genetic data, Peter Ralph and Benjamin H. Good for discussions of the mathematical analysis, Julia Palacios for comments on the preprint, Miaoyan Wang for comments on the beta version of the software, and Razib Khan for suggesting the name of the method.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>DBW, Conceptualization, Software, Investigation, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>OH, Conceptualization, Investigation, Writing—original draft, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following previously published dataset was used:</p><p><related-object content-type="generated-dataset" id="data-ro1" source-id="http://www.completegenomics.com/public-data/69-genomes/" source-id-type="uri"> <collab>Drmanac R</collab><x>,</x> <collab>Sparks AB</collab><x>,</x> <collab>Callow MJ</collab><x>,</x> <collab>Halpern AL</collab><x>,</x> <year>2010</year><x>,</x><source>69 Genomes</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://www.completegenomics.com/public-data/69-genomes/">http://www.completegenomics.com/public-data/69-genomes/</ext-link><x>,</x> <comment>Publicly available at the 69 Genomes Data website (download link: ftp://ftp2.completegenomics.com/)</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alfred</surname><given-names>J</given-names></name><name><surname>Baldwin</surname><given-names>IT</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>New opportunities at the wild frontier</article-title><source>eLife</source><volume>4</volume><elocation-id>e06956</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.06956</pub-id><pub-id pub-id-type="pmid">25806959</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Beeravolu Reddy</surname><given-names>C</given-names></name><name><surname>Hickerson</surname><given-names>MJ</given-names></name><name><surname>Frantz</surname><given-names>LAF</given-names></name><name><surname>Lohse</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Approximate likelihood inference of complex population histories and recombination from multiple genomes</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/077958</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhaskar</surname><given-names>A</given-names></name><name><surname>Song</surname><given-names>YS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Descartes' rule of signs and the identifiability of population demographic models from genomic variation data</article-title><source>The Annals of Statistics</source><volume>42</volume><fpage>2469</fpage><lpage>2493</lpage><pub-id pub-id-type="doi">10.1214/14-AOS1264</pub-id><pub-id pub-id-type="pmid">28018011</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bunnefeld</surname><given-names>L</given-names></name><name><surname>Frantz</surname><given-names>LAF</given-names></name><name><surname>Lohse</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Inferring bottlenecks from genome-wide samples of short sequence blocks</article-title><source>Genetics</source><volume>201</volume><fpage>1157</fpage><lpage>1169</lpage><pub-id pub-id-type="doi">10.1534/genetics.115.179861</pub-id><pub-id pub-id-type="pmid">26341659</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drmanac</surname><given-names>R</given-names></name><name><surname>Sparks</surname><given-names>AB</given-names></name><name><surname>Callow</surname><given-names>MJ</given-names></name><name><surname>Halpern</surname><given-names>AL</given-names></name><name><surname>Burns</surname><given-names>NL</given-names></name><name><surname>Kermani</surname><given-names>BG</given-names></name><name><surname>Carnevali</surname><given-names>P</given-names></name><name><surname>Nazarenko</surname><given-names>I</given-names></name><name><surname>Nilsen</surname><given-names>GB</given-names></name><name><surname>Yeung</surname><given-names>G</given-names></name><name><surname>Dahl</surname><given-names>F</given-names></name><name><surname>Fernandez</surname><given-names>A</given-names></name><name><surname>Staker</surname><given-names>B</given-names></name><name><surname>Pant</surname><given-names>KP</given-names></name><name><surname>Baccash</surname><given-names>J</given-names></name><name><surname>Borcherding</surname><given-names>AP</given-names></name><name><surname>Brownley</surname><given-names>A</given-names></name><name><surname>Cedeno</surname><given-names>R</given-names></name><name><surname>Chen</surname><given-names>L</given-names></name><name><surname>Chernikoff</surname><given-names>D</given-names></name><name><surname>Cheung</surname><given-names>A</given-names></name><name><surname>Chirita</surname><given-names>R</given-names></name><name><surname>Curson</surname><given-names>B</given-names></name><name><surname>Ebert</surname><given-names>JC</given-names></name><name><surname>Hacker</surname><given-names>CR</given-names></name><name><surname>Hartlage</surname><given-names>R</given-names></name><name><surname>Hauser</surname><given-names>B</given-names></name><name><surname>Huang</surname><given-names>S</given-names></name><name><surname>Jiang</surname><given-names>Y</given-names></name><name><surname>Karpinchyk</surname><given-names>V</given-names></name><name><surname>Koenig</surname><given-names>M</given-names></name><name><surname>Kong</surname><given-names>C</given-names></name><name><surname>Landers</surname><given-names>T</given-names></name><name><surname>Le</surname><given-names>C</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>McBride</surname><given-names>CE</given-names></name><name><surname>Morenzoni</surname><given-names>M</given-names></name><name><surname>Morey</surname><given-names>RE</given-names></name><name><surname>Mutch</surname><given-names>K</given-names></name><name><surname>Perazich</surname><given-names>H</given-names></name><name><surname>Perry</surname><given-names>K</given-names></name><name><surname>Peters</surname><given-names>BA</given-names></name><name><surname>Peterson</surname><given-names>J</given-names></name><name><surname>Pethiyagoda</surname><given-names>CL</given-names></name><name><surname>Pothuraju</surname><given-names>K</given-names></name><name><surname>Richter</surname><given-names>C</given-names></name><name><surname>Rosenbaum</surname><given-names>AM</given-names></name><name><surname>Roy</surname><given-names>S</given-names></name><name><surname>Shafto</surname><given-names>J</given-names></name><name><surname>Sharanhovich</surname><given-names>U</given-names></name><name><surname>Shannon</surname><given-names>KW</given-names></name><name><surname>Sheppy</surname><given-names>CG</given-names></name><name><surname>Sun</surname><given-names>M</given-names></name><name><surname>Thakuria</surname><given-names>JV</given-names></name><name><surname>Tran</surname><given-names>A</given-names></name><name><surname>Vu</surname><given-names>D</given-names></name><name><surname>Zaranek</surname><given-names>AW</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Drmanac</surname><given-names>S</given-names></name><name><surname>Oliphant</surname><given-names>AR</given-names></name><name><surname>Banyai</surname><given-names>WC</given-names></name><name><surname>Martin</surname><given-names>B</given-names></name><name><surname>Ballinger</surname><given-names>DG</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name><name><surname>Reid</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Human genome sequencing using unchained base reads on self-assembling DNA nanoarrays</article-title><source>Science</source><volume>327</volume><fpage>78</fpage><lpage>81</lpage><pub-id pub-id-type="doi">10.1126/science.1181498</pub-id><pub-id pub-id-type="pmid">19892942</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Epstein</surname><given-names>CL</given-names></name><name><surname>Schotland</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The bad truth about Laplace's transform</article-title><source>SIAM Review</source><volume>50</volume><fpage>504</fpage><lpage>520</lpage><pub-id pub-id-type="doi">10.1137/060657273</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Excoffier</surname><given-names>L</given-names></name><name><surname>Dupanloup</surname><given-names>I</given-names></name><name><surname>Huerta-Sánchez</surname><given-names>E</given-names></name><name><surname>Sousa</surname><given-names>VC</given-names></name><name><surname>Foll</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Robust demographic inference from genomic and SNP data</article-title><source>PLoS Genetics</source><volume>9</volume><elocation-id>e1003905</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003905</pub-id><pub-id pub-id-type="pmid">24204310</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gattepaille</surname><given-names>L</given-names></name><name><surname>Günther</surname><given-names>T</given-names></name><name><surname>Jakobsson</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Inferring past effective population size from distributions of coalescent times</article-title><source>Genetics</source><volume>204</volume><fpage>1191</fpage><lpage>1206</lpage><pub-id pub-id-type="doi">10.1534/genetics.115.185058</pub-id><pub-id pub-id-type="pmid">27638421</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghosh</surname><given-names>M</given-names></name><name><surname>Hwang</surname><given-names>JT</given-names></name><name><surname>Tsui</surname><given-names>K-W</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Construction of improved estimators in multiparameter estimation for discrete exponential families</article-title><source>The Annals of Statistics</source><volume>11</volume><fpage>351</fpage><lpage>367</lpage><pub-id pub-id-type="doi">10.1214/aos/1176346143</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grimwood</surname><given-names>J</given-names></name><name><surname>Gordon</surname><given-names>LA</given-names></name><name><surname>Olsen</surname><given-names>A</given-names></name><name><surname>Terry</surname><given-names>A</given-names></name><name><surname>Schmutz</surname><given-names>J</given-names></name><name><surname>Lamerdin</surname><given-names>J</given-names></name><name><surname>Hellsten</surname><given-names>U</given-names></name><name><surname>Goodstein</surname><given-names>D</given-names></name><name><surname>Couronne</surname><given-names>O</given-names></name><name><surname>Tran-Gyamfi</surname><given-names>M</given-names></name><name><surname>Aerts</surname><given-names>A</given-names></name><name><surname>Altherr</surname><given-names>M</given-names></name><name><surname>Ashworth</surname><given-names>L</given-names></name><name><surname>Bajorek</surname><given-names>E</given-names></name><name><surname>Black</surname><given-names>S</given-names></name><name><surname>Branscomb</surname><given-names>E</given-names></name><name><surname>Caenepeel</surname><given-names>S</given-names></name><name><surname>Carrano</surname><given-names>A</given-names></name><name><surname>Caoile</surname><given-names>C</given-names></name><name><surname>Chan</surname><given-names>YM</given-names></name><name><surname>Christensen</surname><given-names>M</given-names></name><name><surname>Cleland</surname><given-names>CA</given-names></name><name><surname>Copeland</surname><given-names>A</given-names></name><name><surname>Dalin</surname><given-names>E</given-names></name><name><surname>Dehal</surname><given-names>P</given-names></name><name><surname>Denys</surname><given-names>M</given-names></name><name><surname>Detter</surname><given-names>JC</given-names></name><name><surname>Escobar</surname><given-names>J</given-names></name><name><surname>Flowers</surname><given-names>D</given-names></name><name><surname>Fotopulos</surname><given-names>D</given-names></name><name><surname>Garcia</surname><given-names>C</given-names></name><name><surname>Georgescu</surname><given-names>AM</given-names></name><name><surname>Glavina</surname><given-names>T</given-names></name><name><surname>Gomez</surname><given-names>M</given-names></name><name><surname>Gonzales</surname><given-names>E</given-names></name><name><surname>Groza</surname><given-names>M</given-names></name><name><surname>Hammon</surname><given-names>N</given-names></name><name><surname>Hawkins</surname><given-names>T</given-names></name><name><surname>Haydu</surname><given-names>L</given-names></name><name><surname>Ho</surname><given-names>I</given-names></name><name><surname>Huang</surname><given-names>W</given-names></name><name><surname>Israni</surname><given-names>S</given-names></name><name><surname>Jett</surname><given-names>J</given-names></name><name><surname>Kadner</surname><given-names>K</given-names></name><name><surname>Kimball</surname><given-names>H</given-names></name><name><surname>Kobayashi</surname><given-names>A</given-names></name><name><surname>Larionov</surname><given-names>V</given-names></name><name><surname>Leem</surname><given-names>SH</given-names></name><name><surname>Lopez</surname><given-names>F</given-names></name><name><surname>Lou</surname><given-names>Y</given-names></name><name><surname>Lowry</surname><given-names>S</given-names></name><name><surname>Malfatti</surname><given-names>S</given-names></name><name><surname>Martinez</surname><given-names>D</given-names></name><name><surname>McCready</surname><given-names>P</given-names></name><name><surname>Medina</surname><given-names>C</given-names></name><name><surname>Morgan</surname><given-names>J</given-names></name><name><surname>Nelson</surname><given-names>K</given-names></name><name><surname>Nolan</surname><given-names>M</given-names></name><name><surname>Ovcharenko</surname><given-names>I</given-names></name><name><surname>Pitluck</surname><given-names>S</given-names></name><name><surname>Pollard</surname><given-names>M</given-names></name><name><surname>Popkie</surname><given-names>AP</given-names></name><name><surname>Predki</surname><given-names>P</given-names></name><name><surname>Quan</surname><given-names>G</given-names></name><name><surname>Ramirez</surname><given-names>L</given-names></name><name><surname>Rash</surname><given-names>S</given-names></name><name><surname>Retterer</surname><given-names>J</given-names></name><name><surname>Rodriguez</surname><given-names>A</given-names></name><name><surname>Rogers</surname><given-names>S</given-names></name><name><surname>Salamov</surname><given-names>A</given-names></name><name><surname>Salazar</surname><given-names>A</given-names></name><name><surname>She</surname><given-names>X</given-names></name><name><surname>Smith</surname><given-names>D</given-names></name><name><surname>Slezak</surname><given-names>T</given-names></name><name><surname>Solovyev</surname><given-names>V</given-names></name><name><surname>Thayer</surname><given-names>N</given-names></name><name><surname>Tice</surname><given-names>H</given-names></name><name><surname>Tsai</surname><given-names>M</given-names></name><name><surname>Ustaszewska</surname><given-names>A</given-names></name><name><surname>Vo</surname><given-names>N</given-names></name><name><surname>Wagner</surname><given-names>M</given-names></name><name><surname>Wheeler</surname><given-names>J</given-names></name><name><surname>Wu</surname><given-names>K</given-names></name><name><surname>Xie</surname><given-names>G</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Dubchak</surname><given-names>I</given-names></name><name><surname>Furey</surname><given-names>TS</given-names></name><name><surname>DeJong</surname><given-names>P</given-names></name><name><surname>Dickson</surname><given-names>M</given-names></name><name><surname>Gordon</surname><given-names>D</given-names></name><name><surname>Eichler</surname><given-names>EE</given-names></name><name><surname>Pennacchio</surname><given-names>LA</given-names></name><name><surname>Richardson</surname><given-names>P</given-names></name><name><surname>Stubbs</surname><given-names>L</given-names></name><name><surname>Rokhsar</surname><given-names>DS</given-names></name><name><surname>Myers</surname><given-names>RM</given-names></name><name><surname>Rubin</surname><given-names>EM</given-names></name><name><surname>Lucas</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The DNA sequence and biology of human chromosome 19</article-title><source>Nature</source><volume>428</volume><fpage>529</fpage><lpage>535</lpage><pub-id pub-id-type="doi">10.1038/nature02399</pub-id><pub-id pub-id-type="pmid">15057824</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gutenkunst</surname><given-names>RN</given-names></name><name><surname>Hernandez</surname><given-names>RD</given-names></name><name><surname>Williamson</surname><given-names>SH</given-names></name><name><surname>Bustamante</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Inferring the joint demographic history of multiple populations from multidimensional SNP frequency data</article-title><source>PLoS Genetics</source><volume>5</volume><elocation-id>e1000695</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1000695</pub-id><pub-id pub-id-type="pmid">19851460</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>K</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Inferring demographic history from a spectrum of shared haplotype lengths</article-title><source>PLoS Genetics</source><volume>9</volume><elocation-id>e1003521</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003521</pub-id><pub-id pub-id-type="pmid">23754952</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hernandez</surname><given-names>RD</given-names></name><name><surname>Kelley</surname><given-names>JL</given-names></name><name><surname>Elyashiv</surname><given-names>E</given-names></name><name><surname>Melton</surname><given-names>SC</given-names></name><name><surname>Auton</surname><given-names>A</given-names></name><name><surname>McVean</surname><given-names>G</given-names></name><name><surname>Sella</surname><given-names>G</given-names></name><name><surname>Przeworski</surname><given-names>M</given-names></name><collab>1000 Genomes Project</collab></person-group><year iso-8601-date="2011">2011</year><article-title>Classic selective sweeps were rare in recent human evolution</article-title><source>Science</source><volume>331</volume><fpage>920</fpage><lpage>924</lpage><pub-id pub-id-type="doi">10.1126/science.1198878</pub-id><pub-id pub-id-type="pmid">21330547</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hobolth</surname><given-names>A</given-names></name><name><surname>Christensen</surname><given-names>OF</given-names></name><name><surname>Mailund</surname><given-names>T</given-names></name><name><surname>Schierup</surname><given-names>MH</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Genomic relationships and speciation times of human, chimpanzee, and Gorilla inferred from a coalescent hidden Markov model</article-title><source>PLoS Genetics</source><volume>3</volume><elocation-id>e7</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.0030007</pub-id><pub-id pub-id-type="pmid">17319744</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname><given-names>RR</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Generating samples under a Wright-Fisher neutral model of genetic variation</article-title><source>Bioinformatics</source><volume>18</volume><fpage>337</fpage><lpage>338</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/18.2.337</pub-id><pub-id pub-id-type="pmid">11847089</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kong</surname><given-names>A</given-names></name><name><surname>Gudbjartsson</surname><given-names>DF</given-names></name><name><surname>Sainz</surname><given-names>J</given-names></name><name><surname>Jonsdottir</surname><given-names>GM</given-names></name><name><surname>Gudjonsson</surname><given-names>SA</given-names></name><name><surname>Richardsson</surname><given-names>B</given-names></name><name><surname>Sigurdardottir</surname><given-names>S</given-names></name><name><surname>Barnard</surname><given-names>J</given-names></name><name><surname>Hallbeck</surname><given-names>B</given-names></name><name><surname>Masson</surname><given-names>G</given-names></name><name><surname>Shlien</surname><given-names>A</given-names></name><name><surname>Palsson</surname><given-names>ST</given-names></name><name><surname>Frigge</surname><given-names>ML</given-names></name><name><surname>Thorgeirsson</surname><given-names>TE</given-names></name><name><surname>Gulcher</surname><given-names>JR</given-names></name><name><surname>Stefansson</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>A high-resolution recombination map of the human genome</article-title><source>Nature Genetics</source><volume>31</volume><fpage>241</fpage><lpage>247</lpage><pub-id pub-id-type="doi">10.1038/ng917</pub-id><pub-id pub-id-type="pmid">12053178</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Inference of human population history from individual whole-genome sequences</article-title><source>Nature</source><volume>475</volume><fpage>493</fpage><lpage>496</lpage><pub-id pub-id-type="doi">10.1038/nature10231</pub-id><pub-id pub-id-type="pmid">21753753</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Fu</surname><given-names>YX</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Exploring population size changes using SNP frequency spectra</article-title><source>Nature Genetics</source><volume>47</volume><fpage>555</fpage><lpage>559</lpage><pub-id pub-id-type="doi">10.1038/ng.3254</pub-id><pub-id pub-id-type="pmid">25848749</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lohse</surname><given-names>K</given-names></name><name><surname>Harrison</surname><given-names>RJ</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A general method for calculating likelihoods under the coalescent process</article-title><source>Genetics</source><volume>189</volume><fpage>977</fpage><lpage>987</lpage><pub-id pub-id-type="doi">10.1534/genetics.111.129569</pub-id><pub-id pub-id-type="pmid">21900266</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marjoram</surname><given-names>P</given-names></name><name><surname>Wall</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Fast &quot;coalescent&quot; simulation</article-title><source>BMC Genetics</source><volume>7</volume><elocation-id>16</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2156-7-16</pub-id><pub-id pub-id-type="pmid">16539698</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McVean</surname><given-names>GA</given-names></name><name><surname>Cardin</surname><given-names>NJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Approximating the coalescent with recombination</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>360</volume><fpage>1387</fpage><lpage>1393</lpage><pub-id pub-id-type="doi">10.1098/rstb.2005.1673</pub-id><pub-id pub-id-type="pmid">16048782</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Myers</surname><given-names>S</given-names></name><name><surname>Fefferman</surname><given-names>C</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Can one learn history from the allelic spectrum?</article-title><source>Theoretical Population Biology</source><volume>73</volume><fpage>342</fpage><lpage>348</lpage><pub-id pub-id-type="doi">10.1016/j.tpb.2008.01.001</pub-id><pub-id pub-id-type="pmid">18321552</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paul</surname><given-names>JS</given-names></name><name><surname>Steinrücken</surname><given-names>M</given-names></name><name><surname>Song</surname><given-names>YS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>An accurate sequentially Markov conditional sampling distribution for the coalescent with recombination</article-title><source>Genetics</source><volume>187</volume><fpage>1115</fpage><lpage>1128</lpage><pub-id pub-id-type="doi">10.1534/genetics.110.125534</pub-id><pub-id pub-id-type="pmid">21270390</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ralph</surname><given-names>P</given-names></name><name><surname>Coop</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The geography of recent genetic ancestry across Europe</article-title><source>PLoS Biology</source><volume>11</volume><elocation-id>e1001555</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1001555</pub-id><pub-id pub-id-type="pmid">23667324</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schiffels</surname><given-names>S</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Inferring human population size and separation history from multiple genome sequences</article-title><source>Nature Genetics</source><volume>46</volume><fpage>919</fpage><lpage>925</lpage><pub-id pub-id-type="doi">10.1038/ng.3015</pub-id><pub-id pub-id-type="pmid">24952747</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schraiber</surname><given-names>JG</given-names></name><name><surname>Akey</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Methods and models for unravelling human evolutionary history</article-title><source>Nature Reviews Genetics</source><volume>16</volume><fpage>727</fpage><lpage>740</lpage><pub-id pub-id-type="doi">10.1038/nrg4005</pub-id><pub-id pub-id-type="pmid">26553329</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheehan</surname><given-names>S</given-names></name><name><surname>Harris</surname><given-names>K</given-names></name><name><surname>Song</surname><given-names>YS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Estimating variable effective population sizes from multiple genomes: a sequentially Markov conditional sampling distribution approach</article-title><source>Genetics</source><volume>194</volume><fpage>647</fpage><lpage>662</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.149096</pub-id><pub-id pub-id-type="pmid">23608192</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Steinrücken</surname><given-names>M</given-names></name><name><surname>Kamm</surname><given-names>JA</given-names></name><name><surname>Song</surname><given-names>YS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Inference of complex population histories using whole-genome sequences from multiple populations</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/026591</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Terhorst</surname><given-names>J</given-names></name><name><surname>Kamm</surname><given-names>JA</given-names></name><name><surname>Song</surname><given-names>YS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Robust and scalable inference of population history from hundreds of unphased whole genomes</article-title><source>Nature Genetics</source><volume>49</volume><fpage>303</fpage><lpage>309</lpage><pub-id pub-id-type="doi">10.1038/ng.3748</pub-id><pub-id pub-id-type="pmid">28024154</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Weissman</surname><given-names>DB</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Minimal-assumption genomic inference of coalescence</data-title><source>GitHub</source><version>b6ba0939609266d2ca681d51b712b14a58093eca</version><uri xlink:href="https://github.com/weissmanlab/magic">https://github.com/weissmanlab/magic</uri></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.24836.013</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Nordborg</surname><given-names>Magnus</given-names></name><role>Reviewing editor</role><aff><institution>Vienna Biocenter</institution>, <country>Austria</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Minimal-assumption inference from population-genomic data&quot; for consideration by <italic>eLife</italic>. Your article has been favorably evaluated by Diethard Tautz (Senior Editor) and three reviewers, one of whom, Magnus Nordborg (Reviewer #1), is a member of our Board of Reviewing Editors. The following individuals involved in review of your submission have agreed to reveal their identity: Stephan Schiffels (Reviewer #2); Paul Marjoram (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Polymorphism data contains information about the evolutionary history of the population, and can be used for inference about the process that gave rise to the data. In the era of cheap genome sequencing, this is of great interest. However, generally speaking, the polymorphism data reflects an underlying &quot;ancestral recombination graph&quot;, which, in itself, is a product of the evolutionary process. If we could infer this graph, we would not need the polymorphism data. This theoretical paper describes a method for extracting information about this graph under a fairly general model – information that can then be used for further dissection of the evolutionary process. As is demonstrated in the paper, this can be massively more efficient than trying to infer the details of this process directly from the polymorphism data.</p><p>Essential revisions:</p><p>The analysis of real data and its presentation could be improved, and help readers understand the method better. For example, <xref ref-type="fig" rid="fig4">Figure 4</xref> shows that MAGIC apparently doesn't improve population size estimates in Yoruba over MSMC, even though the MSMC results are based on single individuals while MAGIC analyses all 9 simultaneously. At the same time, when estimating tip branch lengths, <xref ref-type="fig" rid="fig4">Figure 4</xref> (right hand side) shows impressively how MAGIC's estimates are contradicting the Ne model from both MSMC and MAGIC based on pairwise coalescence times, thus perhaps revealing that the model is not good. This advantage should be made clearer, and it may also be useful to point out potential ways forward. For example, joint analysis of pairwise coalescence times and tip branch lengths might suggest better models, or generally improve estimates for certain parameter values?</p><p>This would emphasize MAGIC's utility as a flexible analysis tool that can handle large data sets.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.24836.014</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Essential revisions:</italic> </p><p><italic>The analysis of real data and its presentation could be improved, and help readers understand the method better.</italic> </p><p>For the analysis, the switch to the piecewise-exponential form has slightly improved the performance, and the additional curves in <xref ref-type="fig" rid="fig4">Figure 4</xref> hopefully give a somewhat better sense for the levels and forms of noise and bias in the method.</p><p><italic>For example, <xref ref-type="fig" rid="fig4">Figure 4</xref> shows that MAGIC apparently doesn't improve population size estimates in Yoruba over MSMC, even though the MSMC results are based on single individuals while MAGIC analyses all 9 simultaneously.</italic> </p><p>Yes, this is an important point. We have added it in the first paragraph of the subsection “Human data”.</p><p><italic>At the same time, when estimating tip branch lengths, <xref ref-type="fig" rid="fig4">Figure 4</xref> (right hand side) shows impressively how MAGIC's estimates are contradicting the Ne model from both MSMC and MAGIC based on pairwise coalescence times, thus perhaps revealing that the model is not good. This advantage should be made clearer, and it may also be useful to point out potential ways forward. For example, joint analysis of pairwise coalescence times and tip branch lengths might suggest better models, or generally improve estimates for certain parameter values?</italic> </p><p><italic>This would emphasize MAGIC's utility as a flexible analysis tool that can handle large data sets.</italic> </p><p>We have only added a few lines of text to this section and the Discussion, but we hope that they help make things a little clearer. The key part is –at the end of the subsection “Human data” – we think that MAGIC can be used with ad hoc ABC to match multiple inferred branch length distributions, or to check the results of multiple stand-alone inference methods. We have also added more on this point in the second paragraph of the subsection “Approach” and in the fourth paragraph of the Discussion.</p></body></sub-article></article>