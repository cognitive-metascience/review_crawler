<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">55913</article-id><article-id pub-id-type="doi">10.7554/eLife.55913</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Developmental Biology</subject></subj-group></article-categories><title-group><article-title>An image-based data-driven analysis of cellular architecture in a developing tissue</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-174813"><name><surname>Hartmann</surname><given-names>Jonas</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5600-8285</contrib-id><email>jonas.m.hartmann@protonmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-174814"><name><surname>Wong</surname><given-names>Mie</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-174815"><name><surname>Gallo</surname><given-names>Elisa</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2203-6787</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-174816"><name><surname>Gilmour</surname><given-names>Darren</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7613-090X</contrib-id><email>darren.gilmour@imls.uzh.ch</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund7"/><xref ref-type="other" rid="fund8"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Cell Biology and Biophysics Unit, European Molecular Biology Laboratory (EMBL)</institution><addr-line><named-content content-type="city">Heidelberg</named-content></addr-line><country>Germany</country></aff><aff id="aff2"><label>2</label><institution>Institute of Molecular Life Sciences, University of Zurich (UZH)</institution><addr-line><named-content content-type="city">Zurich</named-content></addr-line><country>Switzerland</country></aff><aff id="aff3"><label>3</label><institution>Collaboration for joint PhD degree between EMBL and Heidelberg University, Faculty of Biosciences</institution><addr-line><named-content content-type="city">Heidelberg</named-content></addr-line><country>Germany</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="senior_editor"><name><surname>Bronner</surname><given-names>Marianne E</given-names></name><role>Senior Editor</role><aff><institution>California Institute of Technology</institution><country>United States</country></aff></contrib><contrib contrib-type="editor"><name><surname>Solnica-Krezel</surname><given-names>Lilianna</given-names></name><role>Reviewing Editor</role><aff><institution>Washington University School of Medicine</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>05</day><month>06</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e55913</elocation-id><history><date date-type="received" iso-8601-date="2020-02-11"><day>11</day><month>02</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-05-24"><day>24</day><month>05</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Hartmann et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Hartmann et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-55913-v1.pdf"/><abstract><p>Quantitative microscopy is becoming increasingly crucial in efforts to disentangle the complexity of organogenesis, yet adoption of the potent new toolbox provided by modern data science has been slow, primarily because it is often not directly applicable to developmental imaging data. We tackle this issue with a newly developed algorithm that uses point cloud-based morphometry to unpack the rich information encoded in 3D image data into a straightforward numerical representation. This enabled us to employ data science tools, including machine learning, to analyze and integrate cell morphology, intracellular organization, gene expression and annotated contextual knowledge. We apply these techniques to construct and explore a quantitative atlas of cellular architecture for the zebrafish posterior lateral line primordium, an experimentally tractable model of complex self-organized organogenesis. In doing so, we are able to retrieve both previously established and novel biologically relevant patterns, demonstrating the potential of our data-driven approach.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>image analysis</kwd><kwd>cellular morphometry</kwd><kwd>morphogenesis</kwd><kwd>lateral line primordium</kwd><kwd>data integration</kwd><kwd>context-guided visualization</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Zebrafish</kwd></kwd-group><funding-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100013060</institution-id><institution>European Molecular Biology Laboratory</institution></institution-wrap></funding-source><award-id>International PhD Programme</award-id><principal-award-recipient><name><surname>Hartmann</surname><given-names>Jonas</given-names></name><name><surname>Gallo</surname><given-names>Elisa</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004410</institution-id><institution>European Molecular Biology Organization</institution></institution-wrap></funding-source><award-id>ALTF 205-2015</award-id><principal-award-recipient><name><surname>Wong</surname><given-names>Mie</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010665</institution-id><institution>H2020 Marie Skłodowska-Curie Actions</institution></institution-wrap></funding-source><award-id>COFUNDII - EMBL Interdisciplinary Post-doc (EIPOD) Program</award-id><principal-award-recipient><name><surname>Wong</surname><given-names>Mie</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100013060</institution-id><institution>European Molecular Biology Laboratory</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Gilmour</surname><given-names>Darren</given-names></name></principal-award-recipient></award-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001711</institution-id><institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung</institution></institution-wrap></funding-source><award-id>31003A_176235</award-id><principal-award-recipient><name><surname>Gilmour</surname><given-names>Darren</given-names></name></principal-award-recipient></award-group><award-group id="fund8"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100006447</institution-id><institution>University of Zurich</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Gilmour</surname><given-names>Darren</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A computational strategy for extracting representative numerical features from 3D microscopy data enables in-depth quantitative analysis of cell and tissue organization through machine learning-driven data integration and context-guided visualization.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Organogenesis proceeds as a complex multi-scale process. Cells utilize a wide range of molecular machinery in a coordinated fashion to give rise to tissue-scale collective behavior, which in turn feeds back on individual cells' architectural and transcriptional dynamics (<xref ref-type="bibr" rid="bib13">Chan et al., 2017</xref>). Uncovering the principles that govern these systems is a long-standing but elusive goal of developmental biology, in part because it is often challenging if not impossible to reduce such complex phenomena to the action of single genes or simple mechanisms (<xref ref-type="bibr" rid="bib7">Bizzarri et al., 2013</xref>). Thus, there is a persistent need for new techniques that enable integrative analysis of developmental systems.</p><p>In recent years, <italic>data science</italic> has arisen as a new interdisciplinary paradigm that combines statistics, computer science and machine learning with the aim of generating knowledge in a data-driven rather than hypothesis-driven fashion (<xref ref-type="bibr" rid="bib19">Dhar, 2013</xref>; <xref ref-type="bibr" rid="bib8">Blei and Smyth, 2017</xref>; <xref ref-type="bibr" rid="bib5">Baker et al., 2018</xref>). Data science thus provides tools to computationally query datasets for patterns that explain the data in an open and unbiased way, not just to test whether the data fit a preformed hypothesis. The application of such data-driven approaches to biology promises a new way of extracting relevant information from large and complicated datasets describing complex biological systems. It thus complements the increasingly rapid pace at which biological data are being generated. However, whilst this promise is already being realized to great effect in some fields, for instance in high-throughput cell biology (<xref ref-type="bibr" rid="bib69">Roukos and Misteli, 2014</xref>; <xref ref-type="bibr" rid="bib29">Gut et al., 2018</xref>; <xref ref-type="bibr" rid="bib15">Chessel and Carazo Salas, 2019</xref>) and in (multi-)omics analysis (<xref ref-type="bibr" rid="bib51">Libbrecht and Noble, 2015</xref>; <xref ref-type="bibr" rid="bib3">Angerer et al., 2017</xref>; <xref ref-type="bibr" rid="bib36">Huang et al., 2017</xref>; <xref ref-type="bibr" rid="bib16">Ching et al., 2018</xref>), developmental biology has seen little adoption of data science techniques to date.</p><p>This is primarily because the field's main source of data, in vivo microscopy, does not readily lend itself to the production of ‘big data’, upon which much of the recent progress in data science is founded. Although imaging datasets of in vivo biological systems are often large in terms of computer memory, they generally do not benefit from the defining property that makes ‘big data’ so useful, namely very large sample numbers on the order of thousands or more, which is not easily achievable in most embryonic model systems. In addition, the high degree of sample to sample variance complicates the use of registration techniques to generate averaged ‘reference’ embryo datasets. Furthermore, only a handful of components can be labeled and observed simultaneously by current fluorescence microscopy methods, which constrains the range of possible biological relationships that could be discovered by applying data science. Despite these limitations, imaging data have the unique advantage that they contain information on the spatial localization of measured components and thus indirectly encode rich higher-order information such as patterns, textures, shapes, locations, and neighborhoods. Moreover, they allow the dynamics of such spatial features to be followed at high temporal resolution. In short, quantitative imaging generates ‘rich data’ rather than ‘big data’.</p><p>Progress towards employing the power of data science for the imaging-based study of development faces three challenges: (1) unpacking the rich spatial information encoded in images into a format that is accessible for data science techniques (<italic>data extraction</italic>), (2) integrating data across multiple experiments to overcome the limited number of simultaneous measurements (<italic>data integration</italic>), and (3) analyzing and visualizing the resulting multi-modal dataset to enable the discovery of biologically meaningful patterns (<italic>data interpretation</italic>).</p><p>Here, we address each of these challenges in the context of a comprehensive data-driven analysis of cellular architecture in an experimental model tissue, the zebrafish posterior Lateral Line Primordium (pLLP), which migrates along the flank of the developing zebrafish embryo, periodically assembling and depositing rosette-shaped clusters of cells that cease migration and differentiate to form sensory organs (<xref ref-type="bibr" rid="bib30">Haas and Gilmour, 2006</xref>; <xref ref-type="bibr" rid="bib26">Ghysen and Dambly-Chaudière, 2007</xref>). The pLLP is patterned into a leader zone of cells that are highly polarized in the direction of migration and a follower zone where rosettes are being assembled through apical constriction (see Figure 2A; <xref ref-type="bibr" rid="bib57">Nechiporuk and Raible, 2008</xref>; <xref ref-type="bibr" rid="bib47">Lecaudey et al., 2008</xref>). This tight integration of collective migration, patterning and morphogenesis gives rise to an intricate tissue architecture that, although easy to image, is challenging to study at the single-cell level as its cells exhibit a wide variety of shapes and behaviors in addition to being comparably small and densely packed (<xref ref-type="bibr" rid="bib25">Galanternik et al., 2016</xref>; <xref ref-type="bibr" rid="bib58">Nogare et al., 2017</xref>).</p><p>To bring data science to this problem, we engineered a multi-step data extraction and analysis pipeline (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Starting from high-resolution in vivo microscopy data, our pipeline first performs 3D single-cell segmentation and then utilizes a newly developed point cloud-based algorithm to extract the information contained in the volumetric data of each cell into a simple set of numbers, so-called <italic>features</italic>. This enabled us to perform a quantitative and unbiased analysis of cell shape across the pLLP. Next, we sought to incorporate internal cellular structures such as organelles into our analysis in order to investigate the relationship between cell morphology and intracellular organization. We achieved this by co-opting machine learning techniques to integrate data across experiments with different markers into a multi-modal atlas. Finally, we built on this approach to map contextual knowledge onto the atlas as a means of facilitating data interpretation through context-guided visualization. We show that this data science-inspired analysis retrieves both known and novel patterns of how cells are organized within the pLLP, demonstrating how a data-driven approach can lay a quantitative foundation for the systems-level study of organogenesis.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of key steps in our data-driven analysis workflow.</title><p>(<bold>A</bold>) Image data of the tissue of interest are acquired using 3D confocal fluorescence microscopy. Each sample is labeled with a membrane marker to delineate cell boundaries (top) and samples can additionally be labeled with various other markers of interest (bottom, colored). (<bold>B</bold>) Using an automated image analysis pipeline, single cells are automatically segmented based on the membrane marker to prepare them for analysis, illustrated here by shifting them apart. (<bold>C</bold>) Next, data extraction takes place to arrive at numerical features representing the cell shapes (yellow) and the various fluorescent protein distributions of additional markers (other colors). (<bold>D</bold>) Such well-structured data simplify the application of machine learning techniques for data integration, which here is performed based on cell shape as a common reference measurement. (<bold>E</bold>) A similar strategy can be used to map manually annotated contextual knowledge (top) into the dataset (bottom), in this case specific cell archetypes chosen based on prior knowledge of the tissue's biology. (<bold>F</bold>) Finally, all of the resulting data are explored and interpreted through various visualizations and statistics.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55913-fig1-v1.tif"/></fig></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>High-Resolution live imaging and 3D Single-Cell segmentation of the zebrafish Posterior Lateral Line Primordium</title><p>The application of data-driven approaches to relevant problems in developmental biology depends on high quality input datasets of the tissue of interest. A data-driven analysis of cellular architecture thus requires high-resolution imaging followed by automated segmentation of individual cells. As developing embryos are large 3D specimens, it is beneficial to use a microscopy method that allows optical sectioning of defined axial z-planes. Here, we employed AiryScan FAST mode confocal microscopy (<xref ref-type="bibr" rid="bib37">Huff, 2016</xref>) to achieve high signal-to-noise ratios and high axial resolution – both of which greatly facilitate 3D segmentation – whilst maintaining a sufficiently high acquisition speed for live imaging of a migrating tissue (~20 s/channel). In this way, we acquired a large set of single and dual channel volumes of wild-type primordia during migration, staged such that the pLLP is located above the posterior half of the embryo's yolk extension (32-36hpf, N = 173 samples in total). All of our samples expressed the bright cell membrane label <italic>cldnb:lyn-EGFP</italic> (<xref ref-type="bibr" rid="bib30">Haas and Gilmour, 2006</xref>; <xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="video" rid="fig2video1">Figure 2—video 1</xref>) and many additionally expressed a red or far-red label for an internal cellular structure (see table in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> for a complete overview).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Imaging and automated 3D single-cell segmentation of the pLLP.</title><p>(<bold>A</bold>) Maximum z-projection of a deconvolved 3D volume of the pLLP acquired using the LSM880 AiryScan FAST mode. (<bold>B</bold>) The same primordium shown with a semi-transparent color overlay of the corresponding single-cell segmentation. (<bold>C</bold>) Expanded view of the same primordium; individual segmented cells have been shifted apart without being rescaled or deformed, revealing their individual shapes within the collective. Note that the segmentation faithfully recapitulates the diversity of cell shapes within the pLLP, with the exception of fine protrusions. Since the protrusions of follower cells are often impossible to detect against the membranes of the cells ahead of them, we decided not to include fine protrusions in our analysis. All scale bars: 10 μm.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55913-fig2-v1.tif"/></fig><media id="fig2video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-55913-fig2-video1.mp4"><label>Figure 2—video 1.</label><caption><title>Dynamic View 3D pLLP Stack.</title><p>Video of the stack shown in <xref ref-type="fig" rid="fig2">Figure 2A</xref>. The slices of the stack are scanned through from bottom to top first, then a maximum z-projection is generated from top to bottom. Scale bar: 10 µm.</p></caption></media><media id="fig2video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-55913-fig2-video2.mp4"><label>Figure 2—video 2.</label><caption><title>Dynamic View of 3D pLLP Segmentation.</title><p>Video of the single-cell segmentation shown in <xref ref-type="fig" rid="fig2">Figure 2B</xref>. The slices of the stack are scanned through from bottom to top first, then a maximum z-projection is generated from top to bottom. Scale bar: 10 µm.</p></caption></media><media id="fig2video3" mime-subtype="mp4" mimetype="video" xlink:href="elife-55913-fig2-video3.mp4"><label>Figure 2—video 3.</label><caption><title>Dynamic View of 3D Expanded Segmentation.</title><p>3D video of expanded segmentation shown in <xref ref-type="fig" rid="fig2">Figure 2C</xref>. First, a rotation of the raw data is shown, followed by its expansion based on the single-cell segmentation. Scale bar: 10 µm.</p></caption></media></fig-group><p>To segment cells, we combined commonplace image processing algorithms into a specialized automated pipeline that uses labeled membranes as its sole input (see materials and methods for details). We found that our pipeline reliably produces high-quality segmentations (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, <xref ref-type="video" rid="fig2video2">Figure 2—video 2</xref>) and that erroneously split or fused cells are rare. To further ensure consistent segmentation quality, each segmented stack was manually double-checked and rare cases of stacks where more than approx. 10% of cells had been either missed, split or fused were excluded (8 of 173; 4.62%). An expanded visualization of a representative segmentation (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, <xref ref-type="video" rid="fig2video3">Figure 2—video 3</xref>) allows the diversity of cell shapes in the lateral line and their relationship with overall tissue architecture to be appreciated in a qualitative fashion.</p><p>Overall, we collected n = 15,347 segmented cells from N = 165 wild-type primordia as the basis for our quantitative analysis. Unless otherwise specified, the results presented in this study are based on this dataset.</p></sec><sec id="s2-2"><title>Point Cloud-Based morphometry for unbiased quantification of cellular architecture</title><p>Most data science techniques require input data in a specific form, namely a <italic>feature space</italic>, which consists of a vector of numerical features for each sample and hence takes the shape of a 2D samples-by-features array (see <xref ref-type="fig" rid="fig1">Figure 1C</xref>). Even when segmented, confocal volumes of cells do not conform to this standard. Thus, numerical features must be extracted from volumetric image data. This can be achieved by simply measuring specific aspects of each cell such as volume or eccentricity (<italic>feature engineering</italic>) but for exploratory analysis it is preferable to derive an unbiased encoding of 3D image information into a 1D feature vector (<italic>feature embedding</italic>). This non-trivial task has previously been tackled in a number of ways (<xref ref-type="bibr" rid="bib63">Pincus and Theriot, 2007</xref>; <xref ref-type="bibr" rid="bib62">Peng and Murphy, 2011</xref>; <xref ref-type="bibr" rid="bib67">Rajaram et al., 2012</xref>; <xref ref-type="bibr" rid="bib79">Tweedy et al., 2013</xref>; <xref ref-type="bibr" rid="bib43">Kalinin et al., 2018</xref>), however no readily applicable solution for feature embedding of both cell morphology and subcellular protein distributions from segmented 3D images has been described to our knowledge.</p><p>We therefore developed a novel method that allows feature embedding of arbitrary fluorescence intensity distributions. As a starting point, we took a standard workflow from the field of geometric morphometrics, which consists of four steps (<xref ref-type="bibr" rid="bib1">Adams et al., 2013</xref>; <xref ref-type="fig" rid="fig3">Figure 3A</xref>):</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>CBE and ISLA for Point Cloud-Based Cell Morphometry.</title><p>(<bold>A</bold>) A classical workflow in landmark-based geometric morphometrics. (<bold>B</bold>) Adapted workflow for morphometrics of arbitrary fluorescence intensity distributions. See <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> for a more detailed version. (<bold>C</bold>) Illustration of ISLA, our algorithm for conversion of voxel-based 3D images to representative point clouds. Shown are a slice of an input image (left), here a membrane-labeled cell in the pLLP (scale bar: 2 μm), the landmarks sampled from this image (middle), here oversampled compared to the standard pipeline for illustration purposes, and the resulting 3D point cloud (right). (<bold>D</bold>) Illustration of CBE, our algorithm for embedding point clouds into a feature space. In this 2D mock example, two cells are being embedded based on point clouds of their outlines (left). CBE proceeds by performing clustering on both clouds combined (middle) and then extracting the distances along each axis from each cluster center to the centroid of its ten nearest neighbors (right). Note that the most distinguishing morphological feature of the two example cells, namely the outcropping of cell <italic>a</italic> at the bottom, is reflected in a large difference in the corresponding cluster's distance values (cluster 4, blue).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55913-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Flowcharts Illustrating the ISLA and CBE Algorithms.</title><p>(<bold>A</bold>) Flowchart of ISLA. To sample from intensity distributions, images are masked by setting voxels outside of the segmentation to zero and a simple background subtraction is performed. To sample from cell shapes, the 1vxl-wide outer shell of the segmentation is set to 1, all other voxels to zero. The resulting image is normalized and used to stochastically sample points for the point cloud. (<bold>B</bold>) Flowchart of CBE. Input point clouds of cells are either rotated according to a registration across tissues (Tissue Frame Of Reference, TFOR) or are volume-normalized and re-represented as a subset of the pairwise distances between points, removing size and rotational information (Cell Frame Of Reference, CFOR). A representative subset of the resulting clouds is overlaid and k-means clustering is performed on the overlay, yielding a set of common reference points. Finally, features are computed to describe each cell's point cloud relative to these common reference points, resulting in an embedded feature space. This feature space can be transformed with PCA to emphasize relevant variation across the sample population.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55913-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Evaluation of the Expressiveness of CBE Embeddings With and Without Cell Frame of Reference (CFOR) Normalization.</title><p>(<bold>A</bold>) Performance in predicting different generative parameters of point clouds in a synthetic dataset from either a raw or a size- and rotation-corrected (cell frame of reference, CFOR) embedding. As expected, CFOR normalization removes all information on cloud size ('scaling') and orientation ('rotation' 1–2). Interestingly, removing this information allows the regressor to perform far better when it comes to the shape parameters of the point cloud ('shape' 1–14). The 'random' parameter is a random Gaussian distribution and serves as a negative control. The regressor used is a Support Vector Regressor (SVR) with an RBF-kernel. (<bold>B</bold>) Evaluation of CBE compared to an alternative embedding strategy based on moments. Shown is how well the parameters used to synthetically generate point clouds can be predicted from embeddings of said clouds using different regression models (kNN: k-Nearest Neighbor regressor, l-SVR: linear Support Vector Regressor, r-SVR: RBF-kernel Support Vector Regressor). Black dots indicate results of 3-fold cross-validation, bars indicate the mean. Moments-based embedding is outperformed by CBE in all cases except with linear SVR, where the results are similar.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55913-fig3-figsupp2-v1.tif"/></fig></fig-group><p>(1)conversion of image data – which is dense and regularly spaced in voxels – into a sparse point cloud of landmarks to facilitate computational transformations, (2) alignment of point clouds by registration to remove translational and rotational variance and hence retrieve pure shape information, (3) re-representation of landmark coordinates based on their deviation from a consensus reference common to all samples in order to arrive at features that are comparable across samples, and (4) dimensionality reduction by Principal Component Analysis (PCA) to find the most relevant features within the data. To adapt this classical workflow to make it applicable to 3D images of cells (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>), it was necessary for us to solve three key problems.</p><p>First, classical workflows extract point clouds based on specific landmarks that are consistent from sample to sample, such as the nose and eyes in facial shape analysis. As a heterogeneous population of cells does not display such common landmarks, we instead implemented a sampling strategy termed <italic>Intensity-Biased Stochastic Landmark Assignment</italic> (ISLA) inspired by <xref ref-type="bibr" rid="bib14">Chan et al., 2018</xref>. ISLA automatically generates a point cloud that is a sparse encoding of the original image, with the local density of points representing local fluorescence intensity (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). ISLA achieves this by treating normalized voxel intensity distributions as multinomial probability distributions and sampling them to obtain a predefined number of landmark coordinates. By adjusting the number of landmarks being sampled, the trade-off between precision and computational performance can be controlled.</p><p>Second, a solution was needed to prevent differences in cell location, size and rotation from obscuring shape information. We first removed translational variance by shifting all cells such that their centroids are placed at the origin coordinates (0,0) and then removed size variation by rescaling point clouds such that cell volumes are normalized. The removal of rotational variance, however, is usually achieved by spatial registration of cells (<xref ref-type="bibr" rid="bib63">Pincus and Theriot, 2007</xref>), which is an ill-defined problem for a highly heterogeneous cell population. Therefore, we instead chose to re-represent the 3D point cloud of each cell in terms of the points' pairwise distances from each other, a representation that is intrinsically invariant to translation, rotation and handedness but retains all other information on the cloud's internal structure. We use the term <italic>Cell Frame Of Reference</italic> (CFOR) to refer to feature spaces where size and rotation have been normalized in this fashion, so only pure shape information is retained.</p><p>While it is beneficial to remove size and rotation when analyzing cell shape, these properties are themselves important for the organization of multicellular systems. For example, dedicated planar cell polarity pathways have evolved to control the rotational symmetry of cells within many tissues, including the mechanosensory hair cell organs deposited by the lateral line primordium (<xref ref-type="bibr" rid="bib56">Mirkovic et al., 2012</xref>; <xref ref-type="bibr" rid="bib39">Jacobo et al., 2019</xref>). Thus, in order to include this level of organization in our analysis, we also pursued a second approach wherein we register entire tissues (rather than individual cells) prior to feature embedding. In this case, rotational variance of individual cells is not removed but instead becomes biologically meaningful as it now reflects the actual orientation of cells within the tissue. Feature spaces resulting from this approach are referred to as <italic>Tissue Frame Of Reference</italic> (TFOR) and retain both cell size and relevant rotational information (<xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p><p>Third and finally, given that point clouds extracted by ISLA are not matched across multiple cells, the classical method for defining a consensus reference across samples, which is to use the average position of matched landmarks (e.g. the average position of all nose landmarks in facial analysis), is not applicable here. To address this, we developed <italic>Cluster-Based Embedding</italic> (CBE) [inspired by <xref ref-type="bibr" rid="bib65">Qiu et al., 2011</xref>, which works by first determining which locations in space contain relevant information across all samples and then measuring each individual sample's structure at these locations. More specifically, CBE proceeds by first performing k-means clustering on an overlay of a representative subset of all cells' point clouds. Using the resulting cluster centers as consensus reference points, CBE then re-represents each individual cell's point cloud in terms of a simple proximity measure relative to said cluster centers (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). We validated CBE using a synthetically generated point cloud dataset, finding that it outperforms an alternative embedding strategy based on point cloud moments and that normalization of size and rotation (i.e. the cell frame of reference, CFOR) is beneficial in the detection of other shape features (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). For further details on feature embedding with ISLA and CBE as well as our evaluation using synthetic point cloud data see the materials and methods section.</p><p>In summary, Cluster-Based Embedding (CBE) of point clouds obtained from 3D images by Intensity-biased Stochastic Landmark Assignment (ISLA) is an expressive and versatile embedding strategy for transforming arbitrary 3D fluorescence distributions into 1D feature vectors. It thus provides a solution to one of the key challenges facing data-driven analysis of tissue development by unpacking the rich information encoded in image stacks into a format that is accessible for further quantitative analysis.</p></sec><sec id="s2-3"><title>The cellular shape space of a model tissue: The lateral line primordium</title><p>Cell shape links cellular mechanics with tissue architecture and is thus key to understanding morphogenesis in model tissues like the developing lateral line primordium. To gain a data-driven view of cell shape in this system, we applied the ISLA-CBE workflow to the cell boundaries of our segmented dataset, deriving an embedded feature space representing cell morphology across the tissue, which we termed the pLLP's <italic>cellular shape space</italic>. We found that the resulting Principal Components (PCs) describe meaningful shape variation (<xref ref-type="fig" rid="fig4">Figure 4A–B</xref>) and that a small number of PCs is sufficient to capture most of the shape heterogeneity across the tissue (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Interestingly, the cells of the pLLP do not cluster into discrete morphological groups (<xref ref-type="fig" rid="fig4">Figure 4A–B,D</xref>), implying a continuous shape spectrum between biologically distinct cells such as those at the tissue's leading edge and those at the center of assembled rosettes.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Analysis of the pLLP's Cellular Shape Space.</title><p>(<bold>A–B</bold>) PCA plots of the tissue frame of reference (TFOR) and an cell frame of reference (CFOR) shape spaces of the pLLP. Each point represents a cell and each color represents a different primordium. Selected example cells are shown as point clouds, illustrating that meaningful properties are encoded in PCs, namely cell orientations (<bold>A</bold>) and cell sphericity and surface smoothness (<bold>B</bold>). (<bold>C</bold>) Explained variance ratios of principal components. (<bold>D</bold>) t-SNE embedding of the shape space showing the absence of obvious clusters as already seen with PCA in (<bold>A–B</bold>). Colors indicate different primordia as in (<bold>A–B</bold>). (<bold>E–F</bold>) Bigraph visualizations of correlations between principal components of the embedded space (bottom nodes) and a set of engineered features (top nodes). Any edge between two nodes indicates a correlation with Pearson's r &gt; abs(0.3) and stronger edges indicate stronger correlations. A blue hue implies a positive and a red hue a negative correlation. These correlations together with manual inspection as shown in (<bold>A–B</bold>) allow the biological meaning of embedded features to be determined. (<bold>G</bold>) Consensus tissue maps of shape space PCs. The contour map represents the local average of PC values across all registered primordia. The small circles show the centroid positions of cells from a single example tissue to aid orientation. The gray bars indicate, from left to right, the deposition zone, follower zone, transition zone, and leader zone. pLLP shape features show varied patterns, including orientation along the D-V axis (TFOR-PC1), characteristic differences between leader and follower cells (TFOR-PC3, CFOR-PC2), and complicated patterns likely arising from the superimposition of different processes (TFOR-PC1).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55913-fig4-v1.tif"/></fig><p>Embedded shape features are an unbiased encoding of shape without a pre-imposed biological meaning. It is thus interesting to ask what biological properties the most important shape features represent. To annotate the dimensions of the shape space with such biological properties, we correlated them against a curated set of simple engineered features (see materials and methods, and <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). Bigraph visualizations of these correlations reveal that the highest contributions to pLLP shape heterogeneity in the tissue frame of reference (TFOR) result from rotational orientation along different axes (PCs 1 and 2) as well as from absolute cell length in all three spatial dimensions (PCs 3, 5 and 6) (<xref ref-type="fig" rid="fig4">Figure 4E</xref>). Some of the PCs do not strongly correlate with any engineered features, implying that this information would have been lost without the use of unbiased feature embedding. Further manual inspection showed PC four to relate to additional rotational information for flat cells, PC seven to the curvature of cells along the tissue's dorso-ventral axis, and PC eight to cell sphericity. Overall, the dominance of orientation and size in the TFOR shape space is consistent with our previous observations on synthetic data (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2A</xref>).</p><p>In the cell frame of reference (CFOR) (<xref ref-type="fig" rid="fig4">Figure 4F</xref>), which is invariant to size and rotation, cell shape heterogeneity is instead dominated by cell sphericity (PC 1), which accounts for nearly 50% of cell shape variation, with lesser contributions from cell surface smoothness (PC 2) and various minor factors that could not be annotated with a clear corresponding engineered feature. Cell sphericity and smoothness are thus important components of the pLLP's cellular architecture, a result that would have gone unnoticed without size- and rotation-invariant shape analysis. Intriguingly, both sphericity and smoothness are closely linked to cell surface mechanics, which have been little studied in the pLLP so far. The minor factors that remain unidentified in the CFOR shape space are likely mostly noise but PCs 3–5, which still explain a few percentage points of variance each (<xref ref-type="fig" rid="fig4">Figure 4C</xref>), may encode some meaningful shape information that is not obvious to the human eye and could only be retrieved using a computational approach.</p><p>The three-dimensional shape of cells in tissues is determined collectively via local cell interactions. Thus, one key advantage of image-based data is that extracted features are localized in the original spatial context of the tissue, allowing access to tissue-scale information that is lost in current single-cell omics approaches that require tissues to be dissociated. To analyze such tissue-scale patterns, we generated consensus maps of feature variation across primordia based on registered cell centroid positions (<xref ref-type="fig" rid="fig4">Figure 4G</xref>). As expected from our correlation analysis, features such as TFOR-PC1 (dorso-ventral orientation) are patterned along the corresponding axis of the tissue (top left panel). For TFOR-PC3 (cell height), the consensus map reveals an increase in cell height immediately behind the tissue's 'leading edge' (top right panel), which is consistent with the established notion that leader cells are flatter and follower cells transition into a more packed and columnar state (<xref ref-type="bibr" rid="bib47">Lecaudey et al., 2008</xref>). This leader-follower progression is also reflected in CFOR-PC2 (cell surface smoothness), which displays a very similar pattern to TFOR-PC3 (<xref ref-type="fig" rid="fig4">Figure 4G</xref>, bottom right panel), possibly due to greater protrusive activity in leaders causing distortions in the cell's shape and thus reducing smoothness. These results provide unbiased quantitative support for previous observations on cell shape changes along the leader-follower axis but also indicate that these changes are continuous rather than discrete. This illustrates how our data-driven approach can provide a complete picture of the patterns of key features across a tissue, which would be challenging to achieve by other means.</p><p>As established above, we found that CFOR-PC1 (sphericity) is a key component of the pLLP's cellular architecture. The corresponding consensus pattern is more intricate than the others (<xref ref-type="fig" rid="fig4">Figure 4G</xref>, bottom left panel), implying that different processes affect cell sphericity in the primordium. Cells at the front of the tissue register as more spherical due to reduced cell height, again as a consequence of the aforementioned leader-follower transition. The more intriguing pattern is that amongst followers there is a tendency for cells at the center of the tissue to be more spherical than those at the periphery, which manifests as a horizontal stripe in the consensus map. This pattern has not been described previously and may point toward an unknown mechanical aspect of pLLP self-organization.</p><p>Taken together, these results illustrate how data-driven exploratory analysis of the cellular shape space can reveal interesting patterns of shape heterogeneity that are indicative of specific mechanisms of organization.</p></sec><sec id="s2-4"><title>Data integration via machine learning on embedded features</title><p>A key strength of the ISLA-CBE pipeline is that it is not limited to embedding objects with continuous surfaces such as then cell plasma membrane. Instead, it is capable of embedding arbitrary intensity distributions, including those of the cytoskeleton, of organelles, or of any other labeled protein. Thus, ISLA-CBE can be used to analyze, and integrate, many aspects of cellular organization beyond morphology. This is of particular benefit when studying behaviors that are driven by the interaction of many cellular mechanisms, as is the case for tissue and organ shaping.</p><p>Our dataset encompasses many dual-color stacks containing both labeled membranes and one of several other cellular structures, including nuclei (<italic>NLS-tdTomato</italic>, <xref ref-type="fig" rid="fig5">Figure 5A</xref>), F-actin (<italic>tagRFPt-UtrophinCH</italic>, <xref ref-type="fig" rid="fig5">Figure 5C</xref>), and the Golgi apparatus (<italic>mKate2-GM130</italic>, <xref ref-type="fig" rid="fig5">Figure 5E</xref>) (see table in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> for a complete overview). For each of these structures we computed specific ISLA-CBE feature spaces (<xref ref-type="fig" rid="fig5">Figure 5B,D,F</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Multi-Channel Imaging, Embedding and Data Integration.</title><p>(<bold>A, C, E</bold>) Maximum z-projections of two-color stacks showing the membrane in magenta and one of three subcellular structures in yellow. (<bold>B, D, F</bold>) Tissue frame of reference (TFOR) CBE embeddings corresponding to the three structures shown in A, C and E. The different colors of points indicate different primordia. The three structures are nuclei (N = 20, n = 2528) (<bold>A–B</bold>), F-actin (N = 19, n = 1876) (<bold>C–D</bold>) and the Golgi apparatus (N = 11, n = 866) (<bold>E–F</bold>). (<bold>G</bold>) Bigraph showing correlations between the Golgi's embedded features and our engineered cells shape features (see <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). The first two Golgi TFOR PCs match those found in the cell shape TFOR space (see <xref ref-type="fig" rid="fig4">Figure 4E</xref>) whereas PCs 3 and 4 are specific to the Golgi. For technical details see the legend of <xref ref-type="fig" rid="fig4">Figure 4E</xref>. (<bold>H–I</bold>) Point cloud renderings showing the distribution of Golgi signal (blue, membranes in red) in two example cells, one with a high value in the Golgi's TFOR PC 3 (<bold>H</bold>) and one with a low value (<bold>I</bold>), illustrating that PC three captures apical enrichment of the Golgi. (<bold>J</bold>) Consensus tissue map for Golgi PC 3 (apical enrichment), showing increased values behind the leader zone. For technical details see the legend of <xref ref-type="fig" rid="fig4">Figure 4G</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55913-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Evaluation of Machine Learning Algorithms for Feature Space Atlas Mapping.</title><p>(<bold>A</bold>) Performance of different algorithms at predicting the embedded feature spaces of different secondary marker channels from embeddings of cell shape. The left column contains predictions from the cell shape CFOR space to subcellular structure CFOR spaces, the right column from cell shape TFOR space to subcellular structure TFOR spaces. Performance is quantified as variance-weighted average of r-squared values across target dimensions. Gray dots are the results from 3-fold cross-validation, blue bars are averages. The algorithms evaluated are a random assignment control (random), k Nearest Neighbors (kNN), the scikit-learn implementation of gradient boosting (boost), xgboost (xgb), random forest regression (forest), support vector regression (SVR), multi-layer perceptrons (MLP), multi-task Lasso regression (Lasso), and multi-task elastic nets (eNet). Note that TFOR predictions work far better than CFOR predictions, which may indicate that pure shape information is insufficient to predict key features of intracellular protein distributions, possibly because information on tissue context is lost. (<bold>B</bold>) Both for training and prediction, PCA-transformed feature spaces were used. Here, prediction quality is shown for each PC of an example channel, illustrating that high-variance PCs lend themselves to more accurate prediction than low-variance components, as expected given that the latter encode less meaningful variation and more noise. (<bold>C</bold>) Examples showing the correlation of resulting predictions with ground truths, again illustrating that high-variance PCs (left) can be fitted better than low-variance PCs (right).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55913-fig5-figsupp1-v1.tif"/></fig></fig-group><p>We sought to combine this intracellular information into an integrated quantitative atlas of cellular architecture. Such atlas integration of image data is usually performed in image space by spatial registration of samples (<xref ref-type="bibr" rid="bib61">Peng et al., 2011</xref>; <xref ref-type="bibr" rid="bib82">Vergara et al., 2017</xref>; <xref ref-type="bibr" rid="bib54">McDole et al., 2018</xref>; <xref ref-type="bibr" rid="bib11">Cai et al., 2018</xref>). However, registration requires stereotypical shapes that can be meaningfully overlaid via spatial transformations, so it is not readily applicable to developing tissues with non-stereotypical cellular positions. Machine learning can be employed as an alternative strategy for atlas mapping that side-steps this problem. Using a training set of dual-color images that contain both reference features (i.e. cell shape derived from the membrane label) and target features (i.e. the intracellular distribution of a specific protein), a machine learning model is trained to predict the target from the reference. The trained model can then be run on samples where only the reference (i.e. membranes) was imaged to generate predictions for the target (i.e. an intracellular protein). This strategy can be applied directly to microscopy images by means of deep convolutional neural networks (<xref ref-type="bibr" rid="bib41">Johnson et al., 2017</xref>; <xref ref-type="bibr" rid="bib17">Christiansen et al., 2018</xref>). However, such deep learning typically requires very large datasets that are usually unobtainable in developmental biology studies. Here, we instead chose to work in the embedded feature space, predicting ISLA-CBE embeddings of protein distributions based on ISLA-CBE embeddings of cell shape. This simplifies the problem such that smaller-scale machine learning algorithms become applicable.</p><p>We trained different classical (non-deep) machine learning models to predict the embedded feature spaces of subcellular structures based on the shape space. We optimized and validated this approach using grid search and cross validation (see materials and methods). Focusing on feature spaces in the tissue frame of reference (TFOR), we found that multi-output Support Vector Regression (SVR) yields good predictions across different conditions (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). We therefore used SVR prediction to generate a complete atlas spanning the embedded TFOR feature spaces of all available markers.</p><p>This atlas can be explored using the same visualizations shown previously for the shape space. As an example, we correlated the embedded features representing the Golgi apparatus (<italic>mKate2-GM130</italic>) with engineered features describing cell shape (<xref ref-type="fig" rid="fig5">Figure 5G</xref>). This shows that Golgi PCs 1 and 2 in the tissue frame of reference again relate to cellular orientation, whereas Golgi PC three correlates with cell height and a more columnar cell shape. Interestingly, the point cloud visualization reveals that Golgi PC three represents apical enrichment (<xref ref-type="fig" rid="fig5">Figure 5H,I</xref>) and the corresponding consensus tissue map shows that PC three is high in follower but not in leader cells (<xref ref-type="fig" rid="fig5">Figure 5J</xref>), indicating increased apical localization of the Golgi apparatus in followers. As apical Golgi localization is a hallmark of many epithelia (<xref ref-type="bibr" rid="bib4">Bacallao et al., 1989</xref>), this finding provides unbiased quantitative support for a model where follower cells display increased epithelial character.</p><p>Besides subcellular protein distributions, changes in gene expression are key drivers of tissue organization. Indeed, one of the major goals of the field is to integrate gene expression data with cell and tissue morphology and behavior (<xref ref-type="bibr" rid="bib6">Battich et al., 2013</xref>; <xref ref-type="bibr" rid="bib49">Lee et al., 2014</xref>; <xref ref-type="bibr" rid="bib70">Satija et al., 2015</xref>; <xref ref-type="bibr" rid="bib44">Karaiskos et al., 2017</xref>; <xref ref-type="bibr" rid="bib74">Stuart et al., 2019</xref>). We therefore investigated whether the machine learning approach to atlas construction we introduced here can be applied to any quantitative measurement that allows cell shape to be acquired simultaneously, including in-situ measurements of gene expression.</p><p>To this end, we performed single-molecule Fluorescence In-Situ Hybridization (smFISH) of <italic>pea3</italic> RNA (<xref ref-type="fig" rid="fig6">Figure 6A</xref>), a marker of FGFR signaling activity associated with the progression of follower cell development (<xref ref-type="bibr" rid="bib2">Aman and Piotrowski, 2008</xref>; <xref ref-type="bibr" rid="bib23">Durdu et al., 2014</xref>). We acquired 2-color stacks of smFISH probes and cell membranes from fixed samples (N = 31, n = 3149), employed automated spot detection to identify and count RNA molecules (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A–E</xref>) and embedded cell shapes with ISLA-CBE. We then used SVR to predict smFISH spot counts based on cell shape and location, finding that by combining all available information (the tissue frame of reference shape space, the cell frame of reference shape space and cell centroid coordinates) the trained model is able to account for 38.2 ± 1.9% of <italic>pea3</italic> expression variance (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). The residual variance that could not be accounted for is due to high cell-to-cell heterogeneity in <italic>pea3</italic> expression among follower cells that does not seem to follow a clear spatial or cell shape-related pattern (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). Nevertheless, we were able to recover the graded overall leader-follower expression pattern of <italic>pea3</italic> when running predictions across the entire atlas (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). Our approach could therefore be used to superimpose at least the key patterns of gene expression in a tissue based on a set of in-situ labeling experiments, which in turn could potentially serve as a reference set to incorporate scRNA-seq data (<xref ref-type="bibr" rid="bib74">Stuart et al., 2019</xref>).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title><italic>pea3</italic> smFISH as an Example of Data Integration Across Imaging Modalities.</title><p>(<bold>A</bold>) Maximum z-projection of a two-color stack of <italic>pea3</italic> smFISH (yellow) and the <italic>lyn-EGFP</italic> membrane marker (magenta). Scale bar: 10 µm. (<bold>B</bold>) Results of SVR regression on <italic>pea3</italic> spot counts using TFOR and CFOR shape features as well as cell centroid coordinates of registered primordia as input. Each blue dot is a cell, the diagonal gray line reflects perfect prediction and blue arrows at the border point to outliers with very high spot counts. On training data, the regressor's explained variance ratio is 0.462 ± 0.011, on previously unseen test data it achieves 0.382 ± 0.019. (<bold>C–D</bold>) Consensus tissue maps of <italic>pea3</italic> expression generated directly from the <italic>pea3</italic> smFISH dataset (<bold>C</bold>) or from the full atlas dataset based on SVR predictions of spot counts (<bold>D</bold>). Note that the prediction for the entire atlas preserves the most prominent pattern – the front-rear gradient across the tissue – but does not capture the noisy heterogeneity among follower cells observed in direct measurements.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55913-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Spot Detection and Cell Shape Embedding for <italic>pea3</italic> smFISH Data.</title><p>(<bold>A–C</bold>) Maximum z-projections of a two-color sample showing the <italic>lyn-EGFP</italic> membrane marker (<bold>A</bold>), the <italic>pea3</italic> smFISH probe (<bold>B</bold>), and the results of automated spot detection with red rings denoting detection events (<bold>C</bold>). Scale bars: 10 µm. (<bold>D</bold>) Zoomed view of the region in the yellow box in (<bold>C</bold>). Scale bar: 2 µm. (<bold>E</bold>) <italic>pea3</italic> smFISH spot counts for each cell, both from measured data (blue) and from predictions across the entire atlas dataset (purple). The left shows averages across primordia, which closely match those reported previously based on a different spot counting method (<xref ref-type="bibr" rid="bib23">Durdu et al., 2014</xref>). The individual cell counts on the right show that there is a long tail of cells with extremely high counts, which as one would expect is not captured in the SVR predictions. (<bold>F–H</bold>) Comparisons of three important cell shape variables between fixed smFISH samples and live samples (here the set of live samples containing only the membrane label; N = 24, n = 2310), showing no significant difference.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55913-fig6-figsupp1-v1.tif"/></fig></fig-group><p>Data integration based on common reference measurements such as cell shape counters one of the major shortcomings of current-day fluorescence microscopy, which is the limited number of channels and thus of molecular components that can be imaged simultaneously. The approach demonstrated here shows how embedded feature spaces and machine learning can be utilized to perform such data integration even in non-stereotypically shaped samples.</p></sec><sec id="s2-5"><title>Mapping of morphological archetypes facilitates biological interpretation</title><p>Feature embedding and atlas mapping enable the conversion of images into rich multi-dimensional numerical datasets. To take full advantage of this, biologically relevant patterns such as the relationships between different cell types, cell shapes and tissue context need to be distilled from these data and presented in a human-interpretable form. Accomplishing this in an automated fashion rather than by laborious manual data exploration remains a challenging problem in data science.</p><p>Classically, data interpretation involves relating data to established knowledge. This prompted us to look for ways to encode contextual knowledge quantitatively and use it to probe our atlas in a context-guided fashion. When asking biological questions about pLLP development, it is useful to distinguish different cell populations: the leader cells that are focused on migration, the cells at the center of nascent rosettes that go on to form sensory hair cells later in development, the cells in the periphery of rosettes that will differentiate into so-called support and mantle cells and the cells in between rosettes (inter-organ cells) that will be deposited as a chain of cells between the maturing lateral line organs (<xref ref-type="bibr" rid="bib28">Grant et al., 2005</xref>; <xref ref-type="bibr" rid="bib34">Hernández et al., 2007</xref>; <xref ref-type="bibr" rid="bib58">Nogare et al., 2017</xref>; <xref ref-type="fig" rid="fig7">Figure 7A</xref>). These four populations constitute simple conceptual archetypes that facilitate reasoning about the primordium's organization.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Context-Guided Visualization using Morphological Archetypes.</title><p>(<bold>A</bold>) A maximum z-projected example stack with colors highlighting different conceptual archetypes in the pLLP that have been manually annotated. (<bold>B</bold>) A low-dimensional <italic>archetype space</italic> resulting from a PCA of the SVC prediction probabilities (with the SVC having been trained on CFOR shape features). Cells are placed according to how similar they are to each archetype, with those at the corners of the tetrahedron belonging strictly to the corresponding archetype and those in between exhibiting an intermediate morphology. (<bold>C</bold>) Since inter-organ cells are not morphologically distinct enough at this stage (see <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>), the archetype space can be reduced to 2D without much loss of information. (<bold>D</bold>) Scatter plots of the 2D archetype space with additional information from the cellular shape space and from the protein distribution atlas superimposed in color. (<bold>E–F</bold>) Boxplots showing data grouped by predicted archetype labels. This form of grouping allows statistical analysis, showing that leader cells are flatter than any other class of follower cells (<bold>E</bold>) and that central rosette cells are more spherical than peripheral rosette cells (<bold>F</bold>). Whiskers are 5th/95th percentiles, p-values are computed with a two-sided Mann-Whitney U-test, and Cohen's d is given as an estimate of effect size.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55913-fig7-v1.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Evaluation of Morphological Archetype Prediction.</title><p>Confusion matrices for SVC archetype classification. The ground truth is based on manual annotation of high-confidence cases. Note that using TFOR features results in slightly better performance than using CFOR features, implying that rotational information and cell size are useful for prediction to some extent. Overall prediction accuracy is high but inter-organ cells are frequently mislabeled, in particular as peripheral cells, indicating that they are morphologically similar at this stage and thus difficult to distinguish based on shape features alone.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55913-fig7-figsupp1-v1.tif"/></fig></fig-group><p>To map archetypes into the tissue's cellular shape space, we manually annotated cells that constitute unambiguous examples for each archetype in a subset of samples (N = 26, n = 624) (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). We then again used machine learning – specifically a Support Vector Classifier (SVC) – with either tissue or cell frame of reference shape features as input to predict the class of all unlabeled cells. For both sets of input features, we found that the classifier was readily able to distinguish leader cells, central cells and peripheral cells, confirming that these manually chosen archetypes are indeed morphologically distinct (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>). The inter-organ cells, however, were frequently misclassified as peripheral or central cells, indicating that at this developmental stage they are not substantially different in terms of shape from other follower cells (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>). This illustrates that mapping of manually annotated information into the atlas intrinsically provides an unbiased quality control of biological pre-conceptions, as classification fails for archetypes that are not distinguishable from others.</p><p>Importantly, the SVC not only predicts categorical labels but also the probabilities with which each cell belongs to each class, a measure of how much a given cell resembles each archetype. This provides an entry point for human-interpretable visualization of atlas data. Here, we performed PCA on the prediction probabilities to arrive at an intuitive visualization wherein cells are distributed according to their similarity to each archetype (<xref ref-type="fig" rid="fig7">Figure 7B,C</xref>). In contrast to unsupervised dimensionality reduction of the shape space (see <xref ref-type="fig" rid="fig4">Figure 4A,B,D</xref>), this new visualization is readily interpretable for anyone with basic prior knowledge of pLLP organization.</p><p>One directly noticeable pattern is in the number of cells found in intermediate states between the leader, central and peripheral archetypes (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). Intermediates between leaders and peripheral cells are common, as would be expected given the leader-follower axis along the length of the primordium. Similarly, intermediates between peripheral and central rosette cells are common, reflecting the continuous nature of rosette structure along the inside-outside axis. However, cells in an intermediate state between the leader and central rosette archetype are rare, possibly indicating that a direct transition between the two states does not frequently occur.</p><p>Any other data available at the single-cell level can be overlaid as a colormap onto the archetype visualization to take full advantage of its intuitive interpretability (<xref ref-type="fig" rid="fig7">Figure 7D</xref>). When doing so, previously observed patterns such as the increased cell height in followers – particularly in central cells – are clearly visible. Notably, the same pattern can be seen for PC 3 of the embedded protein distribution of F-actin, which is part of the atlas. This reflects apical enrichment of F-actin in follower cells, an important feature of rosette morphogenesis (<xref ref-type="bibr" rid="bib47">Lecaudey et al., 2008</xref>). By contrast, plotting CFOR-PC1 (cell sphericity) shows that it is elevated in central rosette cells, especially in a population furthest from the peripheral archetype, a finding that was not predicted by previous studies. This is consistent with the spatial distribution seen in <xref ref-type="fig" rid="fig4">Figure 4G</xref> and reinforces the novel finding that cell sphericity exhibits a non-trivial pattern related to rosette organization. Interestingly, the pattern of CFOR-PC2 (cell surface smoothness) may represent the additive combination of the leader-follower and central-peripheral patterns, supporting a model where distinct mechanisms act to determine cell shape along these two axes of the tissue.</p><p>While these observations were made through an exploratory data-driven approach, the archetype labels also allow them to be checked with classical statistical hypothesis testing. Doing so substantiates both the previously known leader-follower difference in cell height (<xref ref-type="fig" rid="fig7">Figure 7E</xref>) and the novel finding that inner rosette cells are significantly more spherical than outer rosette cells (<xref ref-type="fig" rid="fig7">Figure 7F</xref>).</p><p>Despite its relative simplicity, our archetype-based approach showcases how the mapping of contextual knowledge onto a large and complicated dataset can facilitate its intuitive visualization and biological interpretation, leading to novel hypotheses that can be further tested experimentally.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The overarching goal of developmental biology is to explain how interactions at the molecular and cellular level lead to the formation of complex organisms. Data-driven approaches represent a major opportunity for advancement towards this aim, particularly in the search for holistic system-level understanding. However, seizing this opportunity requires the analysis of image-based multi-layered datasets spanning space, time, several scales and different modalities – a non-trivial task for which data science does not currently provide standardized solutions. Our data-driven analysis of cell and tissue architecture (<xref ref-type="fig" rid="fig1">Figure 1</xref>) addresses the three key challenges entailed in this task in the context of a typical developmental problem: data extraction, data integration, and data interpretation.</p><p>During data extraction, the rich information encoded in images must be pinpointed and transformed into a format more amenable to data science tools. This can be achieved by performing single-cell segmentation (<xref ref-type="fig" rid="fig2">Figure 2</xref>) and subsequently extracting numerical features describing each cell. Features can be generated through feature engineering, which has been employed successfully in a number of cases (<xref ref-type="bibr" rid="bib85">Wang et al., 2017</xref>; <xref ref-type="bibr" rid="bib83">Viader-Llargués et al., 2018</xref>). However, to gain a more complete and unbiased picture, feature embedding is preferable. We developed a novel feature embedding strategy inspired by classical geometric morphometrics, ISLA-CBE (<xref ref-type="fig" rid="fig3">Figure 3</xref>). ISLA allows arbitrary fluorescence intensity distributions to be converted to point clouds which in turn are embedded into a feature space with CBE. Previously described embedding strategies focus separately on shape (<xref ref-type="bibr" rid="bib79">Tweedy et al., 2013</xref>; <xref ref-type="bibr" rid="bib43">Kalinin et al., 2018</xref>) or on protein distributions (<xref ref-type="bibr" rid="bib67">Rajaram et al., 2012</xref>; <xref ref-type="bibr" rid="bib79">Tweedy et al., 2013</xref>; <xref ref-type="bibr" rid="bib29">Gut et al., 2018</xref>), or require subcellular structures to be segmented into objects (<xref ref-type="bibr" rid="bib62">Peng and Murphy, 2011</xref>; <xref ref-type="bibr" rid="bib40">Johnson et al., 2015</xref>). Furthermore, shape-oriented methods usually require somewhat stereotypical objects that can be registered in order to achieve rotational invariance (<xref ref-type="bibr" rid="bib63">Pincus and Theriot, 2007</xref>), a problem ISLA-CBE can solve through a simple pairwise distance transform (i.e. the cell frame of reference, CFOR). Recent work established neural network-based autoencoders as another highly promising approach for feature embedding (<xref ref-type="bibr" rid="bib41">Johnson et al., 2017</xref>) but such deep learning methods tend to require large datasets for training and their internal workings are intractable (<xref ref-type="bibr" rid="bib52">Marcus, 2018</xref>). ISLA-CBE has its own shortcomings, most notably that it is not easily reversible, meaning it is not readily possible to reconstruct a point cloud or a microscopy image from any point in the embedded feature space. Nevertheless, ISLA-CBE serves as a simple and broadly applicable tool for feature embedding of segmented cells.</p><p>Data integration across experiments is crucial to data-driven developmental biology because live microscopy is limited in the number of components that can be measured simultaneously. The value of generating such integrated data atlases has been demonstrated in several examples (<xref ref-type="bibr" rid="bib61">Peng et al., 2011</xref>; <xref ref-type="bibr" rid="bib82">Vergara et al., 2017</xref>), including a dynamic protein atlas of cell division (<xref ref-type="bibr" rid="bib11">Cai et al., 2018</xref>) and an atlas of cell fate and tissue motion in the mouse post-implantation embryo (<xref ref-type="bibr" rid="bib54">McDole et al., 2018</xref>). However, these examples employed registration in image space and thus relied on the stereotypical shape of their samples, a prerequisite that cells in developing tissues do not necessarily conform to. Deep learning once again represents a promising alternative (<xref ref-type="bibr" rid="bib41">Johnson et al., 2017</xref>; <xref ref-type="bibr" rid="bib17">Christiansen et al., 2018</xref>; <xref ref-type="bibr" rid="bib59">Ounkomol et al., 2018</xref>), though it remains to be demonstrated that it is applicable to the relatively small-scale datasets that can feasibly be produced in a developmental biology context. Here, we opted to use classical machine learning tools to perform multivariate-multivariable regression in order to map embedded feature spaces from different channels onto each other with cell shape as a common reference (<xref ref-type="fig" rid="fig5">Figure 5</xref>), an approach that could also easily be extended to gene expression data via smFISH (<xref ref-type="fig" rid="fig6">Figure 6</xref>). This simple and general solution comes with the downside that the resulting atlas cannot easily be viewed as an image overlay. Crucially, however, quantitative data analysis and visualization remain possible.</p><p>Finally, data interpretation is perhaps the most important and most challenging aspect. Even in fields leading in the adoption of data-driven methods, mining big datasets for human-readable mechanistic explanations remains a fundamental challenge (<xref ref-type="bibr" rid="bib35">Holzinger et al., 2014</xref>; <xref ref-type="bibr" rid="bib5">Baker et al., 2018</xref>). When aiming to make progress on this front, it is helpful to remind oneself that data on its own is not inherently meaningful; it can only be meaningfully interpreted in the context of an external conceptual framework (<xref ref-type="bibr" rid="bib12">Callebaut, 2012</xref>; <xref ref-type="bibr" rid="bib50">Leonelli, 2019</xref>). Guided by this notion, we sought a way of mapping contextual information onto the cellular shape space, allowing the entire dataset to be analyzed and visualized through a conceptual lens. Similar to recent work on the classification of cellular protrusions (<xref ref-type="bibr" rid="bib22">Driscoll et al., 2019</xref>), we employed a machine learning classifier to map biologically meaningful cell archetype classes from a manually curated training set onto the entire dataset. We then utilized the prediction probabilities to generate a context-guided visualization that enables the biological interpretation of patterns across the entire atlas (<xref ref-type="fig" rid="fig7">Figure 7</xref>). Despite its relative simplicity, this approach represents a general strategy for bringing together data and context to facilitate interpretation.</p><p>Throughout our analysis, we found evidence that cells in the developing pLLP, from a morphological standpoint, do not fall into distinct groups but rather onto shape spectra between different states (<xref ref-type="fig" rid="fig4">Figure 4A,B,D</xref>). One such shape spectrum exists along the length of the primordium: leader cells are more flat and less defined by apicobasal polarity in their architectural features, whereas follower cells take on a more columnar architecture with the apical side as a focal point for cellular organization (<xref ref-type="fig" rid="fig4">Figures 4G</xref>, <xref ref-type="fig" rid="fig5">5G–J</xref> and <xref ref-type="fig" rid="fig7">7D,E</xref>). This provides data-driven support for previous observations that have led to a model where leaders exhibit mesenchyme-like features focused on driving migration and followers assume epithelial-like features geared toward rosette morphogenesis (<xref ref-type="bibr" rid="bib57">Nechiporuk and Raible, 2008</xref>; <xref ref-type="bibr" rid="bib47">Lecaudey et al., 2008</xref>; <xref ref-type="bibr" rid="bib58">Nogare et al., 2017</xref>). However, it also emphasizes that these archetypical features are gradual in their nature rather than forming discrete clusters with sudden transitions. A second shape spectrum runs from the inside to the outside of assembling rosettes. As development proceeds, the cells along this spectrum will eventually differentiate into distinct cell types: the hair cells, support cells and mantle cells (<xref ref-type="bibr" rid="bib34">Hernández et al., 2007</xref>; <xref ref-type="bibr" rid="bib58">Nogare et al., 2017</xref>). Despite this well-known fate pattern, little attention has been paid thus far to the morphogenetic aspects of the inside-outside axis. Here, we found evidence that cell sphericity and cell surface smoothness, the two key shape factors of the pLLP's CFOR shape space, show inside-outside patterning as part of a more complicated multi-factorial pattern (<xref ref-type="fig" rid="fig4">Figures 4F,G</xref> and <xref ref-type="fig" rid="fig7">7D,F</xref>). Given the well-established link between these properties and effective cell surface tension (<xref ref-type="bibr" rid="bib53">Matzke, 1946</xref>; <xref ref-type="bibr" rid="bib48">Lecuit and Lenne, 2007</xref>), this leads us to the novel hypothesis that variations in adhesion and/or contractility could be the driving mechanism behind this pattern, as they would naturally lead to inside-outside sorting of cells in accordance with the Differential Interfacial Tension Hypothesis (DITH) (<xref ref-type="bibr" rid="bib9">Brodland, 2002</xref>). Following this discovery in our exploratory analysis, further investigation will be required to test this idea and to dissect its biological implementation and function.</p><p>Collectively, the computational strategies presented in this study illustrate the potential of data-driven developmental biology to serve as a means to quantify, integrate and explore image-derived information. For this potential to be fully realized, future work will need to address three key points. First, a versatile open source software framework is needed that simplifies and standardizes handling of multi-layered biological datasets and thereby improves the accessibility of data science tools for developmental biologists. Second, further efforts are needed to facilitate biological interpretation of large multi-dimensional datasets, for instance by extending archetype mapping to other forms of contextual knowledge. Third, atlas datasets such as that of the pLLP need to be extended with additional data and new modalities, including temporal dynamics (based on cell tracking), biophysical properties (such as cell surface tension) and the status of gene regulatory networks (derived e.g. from transcriptomics data). In the long term, we envision a comprehensive tissue atlas, a ‘digital primordium’, which can be mined for patterns and relationships across a wide range of experiments and modalities.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th>Reagent type <break/>(species) or resource</th><th>Designation</th><th>Source or reference</th><th>Identifiers</th><th>Additional <break/>information</th></tr></thead><tbody><tr><td>Strain, strain background (<italic>Danio rerio</italic>)</td><td><italic>cldnb:lyn-EGFP</italic></td><td>doi:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.devcel.2006.02.019">10.1016/j.devcel.2006.02.019</ext-link></td><td>ZFIN ID:ZDB-TGCONSTRCT-070117–15</td><td/></tr><tr><td>Strain, strain background (<italic>Danio rerio</italic>)</td><td><italic>cxcr4b:NLS-tdTomato</italic></td><td>doi:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature12635">10.1038/nature12635</ext-link></td><td>ZFIN ID:ZDB-TGCONSTRCT-141217–3</td><td/></tr><tr><td>Strain, strain background (<italic>Danio rerio</italic>)</td><td><italic>Actb2:mKate2-Rab11a</italic></td><td>This paper</td><td/><td>made with tol2kit, see section ‘Transgenic Fish Lines’</td></tr><tr><td>Strain, strain background (<italic>Danio rerio</italic>)</td><td><italic>LexOP:CDMPR-tagRFPt</italic></td><td>This paper</td><td/><td>made with tol2kit, see section ‘Transgenic Fish Lines’</td></tr><tr><td>Strain, strain background (<italic>Danio rerio</italic>)</td><td><italic>LexOP:B4GalT1(1-55Q)-tagRFPt; cxcr4b:LexPR</italic></td><td>This paper</td><td/><td>made with tol2kit, see <break/>section ‘Transgenic Fish Lines’</td></tr><tr><td>Strain, strain background (<italic>Danio rerio</italic>)</td><td><italic>atoh1a:dtomato</italic></td><td>doi:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ydbio.2010.02.017">10.1016/j.ydbio.2010.02.017</ext-link></td><td>ZFIN ID:ZDB-TGCONSTRCT-100928–4</td><td/></tr><tr><td>Strain, strain background (<italic>Danio rerio</italic>)</td><td><italic>6xUAS:tagRFPt-UtrCH</italic></td><td>This paper</td><td/><td>made with tol2kit, see section ‘Transgenic Fish Lines’</td></tr><tr><td>Strain, strain background (<italic>Danio rerio</italic>)</td><td><italic>cxcr4b:LexPR</italic></td><td>doi:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature13852">10.1038/nature13852</ext-link></td><td>ZFIN ID:ZDB-TGCONSTRCT-170105–4</td><td>LexOP chemically inducible driver line</td></tr><tr><td>Strain, strain background (<italic>Danio rerio</italic>)</td><td>ETL GA346</td><td>doi:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0903060106">10.1073/pnas.0903060106</ext-link></td><td/><td>Gal4-UAS driver line</td></tr><tr><td>Recombinant DNA reagent</td><td><italic>sp6:mKate2-Rab5a</italic> (plasmid)</td><td>This paper</td><td/><td>made with tol2kit, see section ‘Transgenic Fish Lines’</td></tr><tr><td>Recombinant DNA reagent</td><td><italic>sp6:mKate2-GM130(rat)</italic> (plasmid)</td><td>doi:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jcs.026849">10.1242/jcs.026849</ext-link></td><td/><td>made with tol2kit, see section ‘Transgenic Fish Lines’</td></tr><tr><td>Sequence-based reagent</td><td>CDMPR FOR (<italic>D. rerio,</italic> full-length)</td><td>This paper</td><td>PCR primers</td><td><named-content content-type="sequence">GGGGACAAGTTTGTACAAAAAAGCAGGCTGGATGTTGCTGTCTGTGAGAATAATCACT</named-content></td></tr><tr><td>Sequence-based reagent</td><td>CDMPR REV (<italic>D. rerio,</italic> full-length)</td><td>This paper</td><td>PCR primers</td><td><named-content content-type="sequence">GGGGACCACTTTGTACAAGAAAGCTGGGTCCATGGGAAGTAAATGGTCATCTCTTTCCTC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>B4GalT1 FOR <break/>(<italic>D. rerio,</italic> 1-55Q)</td><td>This paper</td><td>PCR primers</td><td><named-content content-type="sequence">GGGGACAAGTTTGTACAAAAAAGCAGGCTGGATGTCGGAGTCGGTGGGATTCTTC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>B4GalT1 REV <break/>(<italic>D. rerio,</italic> 1-55Q)</td><td>This paper</td><td>PCR primers</td><td><named-content content-type="sequence">GGGGACCACTTTGTACAAGAAAGCTGGGTCTTGTGAATTAACCATATCAGAGATAAATGAAATGTGTCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>Rab5a FOR <break/>(<italic>D. rerio,</italic> full-length)</td><td>This paper</td><td>PCR primers</td><td><named-content content-type="sequence">GGGGACAGCTTTCTTGTACAAAGTGGCTATGGCCAATAGGGGAGGAGCAACAC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>Rab5a REV <break/>(<italic>D. rerio,</italic> full-length)</td><td>This paper</td><td>PCR primers</td><td><named-content content-type="sequence">GGGGACAACTTTGTATAATAAAGTTGCTTAGTTGCTGCAGCAGGGGGCT</named-content></td></tr><tr><td>Sequence-based reagent</td><td>Rab11 FOR <break/>(<italic>D. rerio,</italic> full-length)</td><td>This paper</td><td>PCR primers</td><td><named-content content-type="sequence">GGGGACAGCTTTCTTGTACAAAGTGGCTATGGGGACACGAGACGACGAATACG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>Rab11 REV <break/>(<italic>D. rerio,</italic> full-length)</td><td>This paper</td><td>PCR primers</td><td><named-content content-type="sequence">GGGGACAACTTTGTATAATAAAGTTGCCTAGATGCTCTGGCAGCACTGC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>Quasar 670-conjugated Stellaris smFISH probes</td><td>LGC, Biosearch Technologies</td><td>smFISH probes</td><td>Targeted at <italic>D. rerio</italic> pea3 gene, see section ‘smFISH: Fixation, Staining and Imaging’</td></tr><tr><td>Commercial assay or kit</td><td>RNeasy Mini Kit</td><td>Qiagen</td><td>Cat#:74106</td><td/></tr><tr><td>Commercial assay or kit</td><td>QIAshredder</td><td>Qiagen</td><td>Cat#:79654</td><td/></tr><tr><td>Commercial <break/>assay or kit</td><td>SuperScript III Reverse Transcriptase</td><td>Thermo Fisher Scientifc</td><td>Cat#:18080044</td><td/></tr><tr><td>Commercial assay or kit</td><td>mMESSAGEmMACHINESP6 Transcription Kit</td><td>Thermo Fisher Scientific</td><td>Cat#:AM1340</td><td/></tr><tr><td>Commercial assay or kit</td><td>MultiSite Gateway Pro</td><td>Invitrogen</td><td>Cat#:12537</td><td/></tr><tr><td>Chemical compound, drug</td><td>LysoTrackerDeep Red</td><td>Thermo Fisher Scientific</td><td>Cat#:L12492</td><td/></tr><tr><td>Chemical compound, drug</td><td>RU486</td><td>Sigma-Aldrich</td><td>Cat#:M8046</td><td/></tr><tr><td>Chemical compound, drug</td><td>N-phenylthiourea (PTU)</td><td>Sigma-Aldrich</td><td>Cat#:P7629</td><td/></tr><tr><td>Chemical compound, drug</td><td>Tricaine (MESAB)</td><td>Sigma-Aldrich</td><td>Cat#:A5040</td><td/></tr><tr><td>Software, algorithm</td><td>fiji</td><td>doi:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.2019">10.1038/nmeth.2019</ext-link></td><td>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_002285">SCR_002285</ext-link></td><td><ext-link ext-link-type="uri" xlink:href="https://imagej.net/Fiji">imagej.net/Fiji</ext-link></td></tr><tr><td>Software, algorithm</td><td>Anaconda</td><td>Anaconda, Inc</td><td>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_018317">SCR_018317</ext-link></td><td><ext-link ext-link-type="uri" xlink:href="http://www.anaconda.com">www.anaconda.com</ext-link></td></tr><tr><td>Software, algorithm</td><td>python 2.7</td><td>Python Software Foundation</td><td>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_008394">SCR_008394</ext-link></td><td><ext-link ext-link-type="uri" xlink:href="http://www.python.org/psf">www.python.org/psf</ext-link></td></tr><tr><td>Software, algorithm</td><td>ISLA</td><td>This paper</td><td><ext-link ext-link-type="uri" xlink:href="https://github.com/WhoIsJack/data-driven-analysis-lateralline">github.com/WhoIsJack/data-driven-analysis-lateralline</ext-link> (<xref ref-type="bibr" rid="bib32">Hartmann, 2020</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/data-driven-analysis-lateralline">https://github.com/elifesciences-publications/data-driven-analysis-lateralline</ext-link>)</td><td>See section ‘Data and Code Availability’</td></tr><tr><td>Software, algorithm</td><td>CBE</td><td>This paper</td><td><ext-link ext-link-type="uri" xlink:href="https://github.com/WhoIsJack/data-driven-analysis-lateralline">github.com/WhoIsJack/data-driven-analysis-lateralline</ext-link></td><td>See section ‘Data and Code Availability’</td></tr></tbody></table></table-wrap><sec id="s4-1"><title>Animal handling</title><p>Zebrafish (<italic>Danio rerio</italic>, RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/ZFIN_ZDB-GENO-060919-1">ZFIN_ZDB-GENO-060919-1</ext-link>) were grown, maintained and bred according to standard procedures described previously (<xref ref-type="bibr" rid="bib87">Westerfield, 2000</xref>). All experiments were performed on embryos younger than 3dpf, as is stipulated by the EMBL internal policy 65 (IP65) and European Union Directive 2010/63/EU. Live embryos were kept in E3 buffer at 27–30°C. For experiments, pigmentation of embryos was prevented by treating them with 0.002% N-phenylthiourea (PTU) (Sigma-Aldrich, St. Louis, US-MO) starting at 25hpf. For mounting and during live imaging, embryos were anaesthetized using 0.01% Tricaine (Sigma-Aldrich, St. Louis, US-MO).</p></sec><sec id="s4-2"><title>Transgenic fish lines</title><p>All embryos imaged carried the membrane marker <italic>cldnb:lyn-EGFP</italic> (<xref ref-type="bibr" rid="bib30">Haas and Gilmour, 2006</xref>), which was used for single cell segmentation. In addition, different subsets of the main dataset carried one of the following red secondary markers: <italic>cxcr4b:NLS-tdTomato</italic> (nuclei) (<xref ref-type="bibr" rid="bib21">Donà et al., 2013</xref>), <italic>Actb2:mKate2-Rab11a</italic> (recycling endosomes), <italic>LexOP:CDMPR-tagRFPt</italic> (trans-Golgi network and late endosomes), <italic>LexOP:B4GalT1(1-55Q)-tagRFPt</italic> (<italic>trans</italic>-Golgi), 6x<italic>UAS:tagRFPt-UtrCH</italic> (F-actin) or <italic>atoh1a:dtomato</italic> (transcriptional marker for hair cell specification) (<xref ref-type="bibr" rid="bib84">Wada et al., 2010</xref>). Furthermore, in two subsets of the data a red marker was injected as mRNA, namely <italic>mKate2-GM130(rat)</italic> (<italic>cis</italic>-Golgi) (<xref ref-type="bibr" rid="bib64">Pouthas et al., 2008</xref>) and <italic>mKate2-Rab5a</italic> (early endosomes). Finally, one subset of samples was treated with 1 μM LysoTracker Deep Red (Thermo Fisher Scientific, Waltham, US-MA) in E3 medium with 1% DMSO for 90 min prior to imaging. The exact composition of the main dataset is tabulated in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>.</p><p>To drive expression of the UAS construct, those fish additionally carried the Gal4 enhancer trap ETL GA346 (<xref ref-type="bibr" rid="bib20">Distel et al., 2009</xref>). To drive expression of LexOP constructs (<xref ref-type="bibr" rid="bib24">Emelyanov and Parinov, 2008</xref>), those fish carried <italic>cxcr4b:LexPR</italic> (<xref ref-type="bibr" rid="bib23">Durdu et al., 2014</xref>) and were treated with 10 μM of the progesterone analogue RU486 (Sigma-Aldrich, St. Louis, US-MO) from 25hpf.</p><p>Capped mRNA was produced by IVT using the mMESSAGEmMACHINE SP6 Transcription Kit (Thermo Fisher Scientific, Waltham, US-MA) according to the manufacturers’ instructions and was injected at 250 ng/μl into embryos at the 1 cell stage.</p><p>The following plasmids were generated by MultiSite Gateway Pro Cloning (Invitrogen, Waltham, US-MA) based on the Tol2kit (<xref ref-type="bibr" rid="bib46">Kwan et al., 2007</xref>): <italic>LexOP:CDMPR-tagRFPt</italic> (with <italic>cry:mKate2</italic> transgenic marker), <italic>LexOP:B4GalT1(1-55Q)-tagRFPt</italic> (with <italic>cry:mKate2</italic> transgenic marker), <italic>Actb2:mKate2-Rab11a</italic> (with <italic>clmc2:GFP</italic> transgenic marker), 6x<italic>UAS:tagFRPt-UtrCH</italic> (with <italic>cry:mKate2</italic> transgenic marker), <italic>sp6:mKate2-GM130(rat)</italic> and <italic>sp6:mKate2-Rab5a</italic>. tagRFPt (<xref ref-type="bibr" rid="bib73">Shaner et al., 2008</xref>) and UtrCH (<xref ref-type="bibr" rid="bib10">Burkel et al., 2007</xref>) were kindly provided by Jan Ellenberg and Péter Lénárt, respectively. Zebrafish CDMPR, B4GalT1, Rab5a and Rab11a were cloned by extraction of total RNA from dechorionated 48hpf zebrafish embryos using the RNeasy mini kit (Qiagen, Hilden, Germany) and QIAshredder (Quiagen, Hilden, Germany) according to manufacturer's instructions, followed by reverse transcription with SuperScript III Reverse Transcriptase (Thermo Fisher Scientific, Waltham, US-MA) using both random hexamers and oligo-dT simultaneously, according to the manufacturer's instructions, and finally amplification of genes of interest from cDNA with the following oligonucleotides (Sigma-Aldrich, St. Louis, US-MO) (template-specific region underlined):</p><list list-type="simple"><list-item><p>CDMPR FOR: <named-content content-type="sequence">GGGGACAAGTTTGTACAAAAAAGCAGGCTGG<underline>ATGTTGCTGTCTGTGAGAATAATCACT</underline></named-content></p> </list-item> <list-item><p>CDMPR REV: <named-content content-type="sequence">GGGGACCACTTTGTACAAGAAAGCTGGGTC<underline>CATGGGAAGTAAATGGTCATCTCTTTCCTC</underline></named-content></p> </list-item> <list-item><p>B4GalT1 FOR: <named-content content-type="sequence">GGGGACAAGTTTGTACAAAAAAGCAGGCTGG<underline>ATGTCGGAGTCGGTGGGATTCTTC</underline></named-content></p> </list-item> <list-item><p>B4GalT1 REV: <named-content content-type="sequence">GGGGACCACTTTGTACAAGAAAGCTGGGTC<underline>TTGTGAATTAACCATATCAGAGATAAATGAAATGTGTCG</underline></named-content></p> </list-item> <list-item><p>Rab5a FOR: <named-content content-type="sequence">GGGGACAGCTTTCTTGTACAAAGTGGCT<underline>ATGGCCAATAGGGGAGGAGCAACAC</underline></named-content></p> </list-item> <list-item><p>Rab5a REV: <named-content content-type="sequence">GGGGACAACTTTGTATAATAAAGTTGC<underline>TTAGTTGCTGCAGCAGGGGGCT</underline></named-content></p> </list-item> <list-item><p>Rab11a FOR: <named-content content-type="sequence">GGGGACAGCTTTCTTGTACAAAGTGGCT<underline>ATGGGGACACGAGACGACGAATACG</underline></named-content></p> </list-item> <list-item><p>Rab11a REV: <named-content content-type="sequence">GGGGACAACTTTGTATAATAAAGTTGC<underline>CTAGATGCTCTGGCAGCACTGC</underline></named-content></p> </list-item></list></sec><sec id="s4-3"><title>High-Resolution live imaging</title><p>Embryos were manually dechorionated with forceps at 30-34hpf and anaesthetized with 0.01% Tricaine (Sigma-Aldrich, St. Louis, US-MO), then transferred into 1% peqGOLD Low Melt Agarose (Peqlab, Erlangen, Germany) in E3 containing 0.01% Tricaine and immediately deposited onto a MatTek Glass Bottom Microwell Dish (35 mm Petri dish, 10 mm microwell, 0.16–0.19 mm coverglass) (MatTek Corporation, Ashland, US-MA). No more than 10 embryos were mounted in a single dish. A weighted needle tool was used to gently arrange the embryos such that they rest flatly with their lateral side directly on the glass slide. After solidification of the agarose, E3 containing 0.01% Tricaine was added to the dish. Embryos were imaged at 32-36hpf, when the pLLP was located above the posterior half of the embryo's yolk extension.</p><p>The microscope used for imaging was the Zeiss LSM880 with AiryScan technology (Carl Zeiss AG, Oberkochen, Germany), henceforth LSM880. High-resolution 3D stacks (voxel size: 0.099 μm in xy, 0.225 μm in z) were acquired with a 40 × 1.2 NA water objective with Immersol W immersion fluid (Carl Zeiss, Oberkochen, Germany). Imaging in AiryScan FAST mode (<xref ref-type="bibr" rid="bib37">Huff, 2016</xref>) with a piezo stage for z-motion and bi-directional scanning allowed acquisition times for an entire volume to be lowered to approximately 20 s (40 s for dual-color stacks using line switching). Deconvolution was performed using the LSM880's built-in 3D AiryScan deconvolution with 'auto' settings.</p><p>Note that optimal image quality could only be achieved by adjustment of the stage to ensure that the cover glass is exactly normal to the excitation beam. For each dish we imaged, we used 633 nm reflected light and line scanning to get a live view of the cover glass interface, which allowed us to manually adjust the pitch of the stage to be completely horizontal. This process was repeated for both zx and zy line scans.</p></sec><sec id="s4-4"><title>smFISH: Fixation, Staining and Imaging</title><p>Single molecule Fluorescence In-Situ Hybridization (smFISH) was performed according to standard protocols (<xref ref-type="bibr" rid="bib23">Durdu et al., 2014</xref>; <xref ref-type="bibr" rid="bib66">Raj et al., 2008</xref>) using previously published Quasar 670-conjugated Stellaris smFISH probes (LGC, Biosearch Technologies, Hoddesdon, UK) designed to target <italic>pea3</italic> mRNA, listed below.</p><p>Briefly, embryos were fixed overnight in 4% PFA in PBS-T (PBS with 0.1% Neonate-20) at 4°C, then rinsed three times in PBS-T and subsequently permeabilized with 100% methanol overnight at −20°C. Embryos were rehydrated with a methanol series (75%, 50%, 25% Methanol in PBS-T, 5 min per step) and rinsed three times with PBS-T. The yolk was manually removed using forceps. Next, samples were pre-incubated with hybridization buffer (0.1 g/ml deyxtrane sulfate, 0.02 g/ml RNase-free BSA, 1 mg/ml <italic>E. coli</italic> tRNA, 10% formamide, 5x SSC, 0.1% Neonate-20 in ddH2O) at 30°C for 30 min and subsequently hybridized with <italic>pea3</italic> probe solution (0.1 μM in hybridization buffer) at 30°C overnight in the dark. After probe removal, embryos were stained with DAPI (1:1000) in washing buffer (10% formamide, 5x SSC, 0.1% Neonate-20 in ddH2O) for 15 min at 30°C and finally kept in washing buffer for 45 min at 30°C.</p><p>Stained embryos were mounted on glass slides using VECTASHIELD HardSet Antifade Mounting Medium (Vector Laboratories, Burlingame, US-CA) and imaged immediately to prevent loss of signal due to photobleaching. Imaging was performed with a 63 × 1.4 NA oil immersion objective on the LSM880 in FAST mode with 488 nm and 639 nm excitation lasers. Stacks were acquired using 8x averaging with 0.187 μm z-spacing and a pixel size of 0.085 μm, then deconvolved with the built-in 3D AiryScan deconvolution on 'auto' settings.</p><p>The following smFISH probes were used:</p><list list-type="simple"><list-item><p>1: <named-content content-type="sequence">aaggaagacggacagaggca</named-content>, 2: <named-content content-type="sequence">ctgtgttttaatgagctcca</named-content>, 3: <named-content content-type="sequence">cttaaccgtttgtggtcatt</named-content>,</p></list-item> <list-item><p>4: <named-content content-type="sequence">ccatccatcttataatccat</named-content>, 5: <named-content content-type="sequence">agtataaggcacttgctggt</named-content>, 6: <named-content content-type="sequence">atttccttgcgacctattag</named-content>,</p></list-item> <list-item><p>7: <named-content content-type="sequence">tcaacagtctatttaggggc</named-content>, 8: <named-content content-type="sequence">atgtatttcctttttgtcgc</named-content>, 9: <named-content content-type="sequence">aagaggtcttcagattcctg</named-content>,</p></list-item> <list-item><p>10: <named-content content-type="sequence">cctgaagttggcttaaatcc</named-content>, 11: <named-content content-type="sequence">ggaacttgagcttcggtgag</named-content>, 12: <named-content content-type="sequence">aacaaactgctcatcgctgt</named-content>,</p></list-item> <list-item><p>13: <named-content content-type="sequence">cactgagttctctgagtgaa</named-content>, 14: <named-content content-type="sequence">ttcttaatcttcacaggcgg</named-content>, 15: <named-content content-type="sequence">tagctgaagctttgcttgtg</named-content>,</p></list-item> <list-item><p>16: <named-content content-type="sequence">tcataggcactggcgtaaag</named-content>, 17: <named-content content-type="sequence">ctggacatgagctcttagat</named-content>, 18: <named-content content-type="sequence">ttgggggaataatgctgcat</named-content>,</p></list-item> <list-item><p>19: <named-content content-type="sequence">tgagggtggattcatatacc</named-content>, 20: <named-content content-type="sequence">cggaagggaacctggaactg</named-content>, 21: <named-content content-type="sequence">agagtgttgccgatggaaac</named-content>,</p></list-item> <list-item><p>22: <named-content content-type="sequence">tgctgaggaggataaggcaa</named-content>, 23: <named-content content-type="sequence">ccatgtactcctgcttaaag</named-content>, 24: <named-content content-type="sequence">tcctgtttgaccatcatatg</named-content>,</p></list-item> <list-item><p>25: <named-content content-type="sequence">caggttcgtaagtgtagtcg</named-content>, 26: <named-content content-type="sequence">tgtgatggtacatggatggg</named-content>, 27: <named-content content-type="sequence">aaacatgtagccttcactgt</named-content>,</p></list-item> <list-item><p>28: <named-content content-type="sequence">tggcacaacacgggaatcat</named-content>, 29: <named-content content-type="sequence">tcacctcaccttcaaatttc</named-content>, 30:<named-content content-type="sequence">accttcacgaaacacactgc</named-content>,</p></list-item> <list-item><p>31: <named-content content-type="sequence">tagttgaagtgagccacgac</named-content>, 32: <named-content content-type="sequence">gaagggcaaccaagaactgc</named-content>, 33: <named-content content-type="sequence">atgcgatgaagtgggcattg</named-content>,</p></list-item> <list-item><p>34: <named-content content-type="sequence">atgagtttgaattccatgcc</named-content>, 35: <named-content content-type="sequence">ttgtcatagttcatggctgg</named-content>, 36: <named-content content-type="sequence">gtaacgcaaagagcgactca</named-content>,</p></list-item> <list-item><p>37: <named-content content-type="sequence">ttttgcataattcccttctc</named-content>, 38: <named-content content-type="sequence">aggttatcaaagcttctggc</named-content>, 39: <named-content content-type="sequence">cgctgattgtcgggaaaagc</named-content>,</p></list-item> <list-item><p>40: <named-content content-type="sequence">gttgacgtagcgctcaaatt</named-content>, 41: <named-content content-type="sequence">aagaaactccctcatcgagg</named-content>, 42: <named-content content-type="sequence">tacatgtagcctttggagta</named-content>,</p></list-item> <list-item><p>43: <named-content content-type="sequence">aaaggagaatgtcggtggca</named-content>, 44: <named-content content-type="sequence">gtggtaaactgggatgggaa</named-content>, 45: <named-content content-type="sequence">atacaagaggatggggtggg</named-content>,</p></list-item> <list-item><p>46: <named-content content-type="sequence">gaatgcagagtccctaatga</named-content>, 47: <named-content content-type="sequence">agataggcctcagaagtgag</named-content>, 48: <named-content content-type="sequence">gcaatctcttgaaccacagt</named-content>.</p></list-item></list></sec><sec id="s4-5"><title>Software development stack</title><p>The software for this study was developed using the Anaconda distribution (Anaconda, Inc, Austin, US-TX) of python 2.7.13 (64-bit) (Python Software Foundation, Beaverton, US-OR) (<xref ref-type="bibr" rid="bib81">Van Rossum, 1995</xref>).</p><p>The following scientific libraries and modules were used: numpy 1.11.3 (<xref ref-type="bibr" rid="bib78">Travis and Oliphant, 2006</xref>) and pandas 0.19.2 (<xref ref-type="bibr" rid="bib55">McKinney, 2010</xref>) for numerical computation, scikit-image 0.13.0 (<xref ref-type="bibr" rid="bib80">van der Walt et al., 2014</xref>) and scipy.ndimage 2.0 (<xref ref-type="bibr" rid="bib42">Jones and Oliphant, 2001</xref>) for image processing, scikit-learn 0.19.1 (<xref ref-type="bibr" rid="bib60">Pedregosa and Varoquaux, 2011</xref>) for machine learning, matplotlib 1.5.1 (<xref ref-type="bibr" rid="bib38">Hunter, 2007</xref>) and seaborn 0.7.1 (<xref ref-type="bibr" rid="bib86">Waskom et al., 2016</xref>) for plotting, networkx 1.11 (<xref ref-type="bibr" rid="bib31">Hagberg et al., 2008</xref>) for graph-based work, tifffile 0.11.1 (<xref ref-type="bibr" rid="bib27">Gohlke, 2016</xref>) for loading of TIFF images, and various scipy 1.0.0 (<xref ref-type="bibr" rid="bib42">Jones and Oliphant, 2001</xref>) modules for different purposes. Parallelization was implemented using dask 0.15.4 (<xref ref-type="bibr" rid="bib76">Team, 2016</xref>).</p><p>Jupyter Notebooks (jupyter 1.0.0, notebook 5.3.1) (<xref ref-type="bibr" rid="bib45">Kluyver et al., 2016</xref>) were utilized extensively for prototyping, workflow management and exploratory data analysis, whereas refactoring and other software engineering was performed in the Spyder IDE (spyder 3.2.4) (<xref ref-type="bibr" rid="bib68">Raybaut et al., 2018</xref>). Version control was managed with Git 2.12.2.windows.2 (<xref ref-type="bibr" rid="bib77">Torvalds and the Git contributors, 2018</xref>) and an internally hosted GitLab instance (GitLab, San Francisco, US-CA).</p></sec><sec id="s4-6"><title>Image preprocessing</title><p>Following AiryScan 3D deconvolution with 'auto' settings on the LSM880, images were converted to 8bit TIFF files using a custom macro for the Fiji distribution (<xref ref-type="bibr" rid="bib71">Schindelin et al., 2012</xref>) of ImageJ 1.52 g (<xref ref-type="bibr" rid="bib72">Schneider et al., 2012</xref>). The minimum and maximum values determining the intensity range prior to 8bit conversion were selected manually such that intensity clipping is avoided. Care was taken to apply the same values to all samples of a given marker to ensure consistency.</p><p>Samples with the <italic>cxcr4b:NLS-tdTomato</italic> nuclear label exhibited a degree of bleed-through into the <italic>lyn-EGFP</italic> membrane label channel. To prevent this from interfering with single-cell segmentation, we employed a linear unmixing scheme in which the contribution of <italic>NLS-tdTomato</italic> (<inline-formula><mml:math id="inf1"><mml:mi>C</mml:mi></mml:math></inline-formula>, the contaminant image) is removed from the green channel (<inline-formula><mml:math id="inf2"><mml:mi>M</mml:mi></mml:math></inline-formula>, mixed image), resulting in the cleaned membrane channel (<inline-formula><mml:math id="inf3"><mml:mi>U</mml:mi></mml:math></inline-formula>, unmixed image). Our approach assumes that the signal in <inline-formula><mml:math id="inf4"><mml:mi>M</mml:mi></mml:math></inline-formula> is composed according to <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, implying that <inline-formula><mml:math id="inf5"><mml:mi>U</mml:mi></mml:math></inline-formula> can be retrieved by subtraction of an appropriate contamination term (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>).<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mo>∙</mml:mo><mml:mi>C</mml:mi></mml:math></disp-formula><disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo>∙</mml:mo><mml:mi>C</mml:mi></mml:math></disp-formula></p><p>To compute the optimal bleed-through factor <inline-formula><mml:math id="inf6"><mml:mi>a</mml:mi></mml:math></inline-formula> we minimized a custom loss function (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>), which is essentially simply the Pearson Correlation Coefficient (<inline-formula><mml:math id="inf7"><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi></mml:math></inline-formula>) of the contaminant image <inline-formula><mml:math id="inf8"><mml:mi>C</mml:mi></mml:math></inline-formula> and the cleaned image <inline-formula><mml:math id="inf9"><mml:mi>U</mml:mi></mml:math></inline-formula> given a particular candidate factor <inline-formula><mml:math id="inf10"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. To ensure that unreasonably high values of <inline-formula><mml:math id="inf11"><mml:mi>a</mml:mi></mml:math></inline-formula> are punished, we centered the values of the cleaned image onto their mean and converted the result to absolute values, causing overly unmixed regions to start correlating with <inline-formula><mml:math id="inf12"><mml:mi>C</mml:mi></mml:math></inline-formula> again.<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo> <mml:mi/> <mml:mi/><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∙</mml:mo><mml:mi>C</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∙</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>We found that this approach robustly removes <italic>NLS-tdTomato</italic> bleed-through, producing unmixed images that could be segmented successfully.</p></sec><sec id="s4-7"><title>Single-Cell segmentation</title><p>3D single-cell segmentation was performed on membrane-labeled stacks acquired, deconvolved and preprocessed as detailed in the sections above.</p><p>The pipeline for segmentation consists of the following steps, applied sequentially:</p><list list-type="order"><list-item><p>3D median smoothing with a cuboid 3 × 3×3 vxl structural element to reduce shot noise.</p></list-item> <list-item><p>3D Gaussian smoothing with σ<italic> = </italic>3 pxl to further reduce noise and smoothen structures.</p></list-item> <list-item><p>Thresholding to retrieve a binary mask of foreground objects (i.e. the membranes). To automatically determine the appropriate threshold, we use a custom function inspired by a semi-manual approach for spot detection (<xref ref-type="bibr" rid="bib66">Raj et al., 2008</xref>). Starting from the most frequent value in the image histogram as a base threshold, we iteratively scan a limited range of positive offsets (usually 0 to 10 in steps of 1, for slightly lower-quality images 0 to 40 in steps of 2) and count the number of connected components in the inverse of the binary mask resultant from applying each threshold. This roughly represents the number of cell bodies in the stack that are fully enclosed in cell membranes at a given threshold. We consider the threshold producing the largest number the best option and use it to generate the final membrane mask.</p></list-item> <list-item><p>Removal of disconnected components by morphological hole filling.</p></list-item> <list-item><p>Labeling of connected components on the inverted membrane mask. This ideally yields one connected component per cell, i.e. the cytoplasm.</p></list-item> <list-item><p>Removal of connected components smaller than 1'000 voxels (artifacts) and re-labeling of connected components larger than 1'000'000 voxels as background objects.</p></list-item> <list-item><p>Watershed expansion using the labeled connected components as seeds and the smoothed input image as topography (with additional 3D Gaussian smoothing on top of steps 1 and 2, with <italic>σ = 3</italic> pxl). The background objects surrounding the primordium are also expanded.</p></list-item> <list-item><p>Assignment of the zero label to background objects and removal of any objects disconnected from the primordium by retaining only the single largest foreground object.</p></list-item></list><p>We manually optimized the parameters of this pipeline for our data by inspecting the output during an extensive set of test runs.</p><p>Finally, we also manually double-checked all segmentations and discarded rare cases where more than approx. 10% of cells in a stack had been missed or exhibited under- or oversegmentation.</p></sec><sec id="s4-8"><title>Point cloud sampling with ISLA</title><p><italic>Intensity-biased Stochastic Landmark Assignment</italic> (ISLA) (<xref ref-type="fig" rid="fig3">Figure 3A–C</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A</xref>) was applied to cropped-out bounding boxes of single segmented cells. To capture cell shape, the 6-connected inner hull of the binary segmentation mask was used as input image for ISLA. To capture intensity distributions, voxels outside the segmentation mask were set to zero and a simple background subtraction was performed to prevent landmarks from being assigned spuriously due to background signal. The background level was determined as the mean intensity within the masked cell and was subtracted from each voxel's intensity value, with resulting negative values set to zero.</p><p>With the inputs so prepared, voxel intensities were normalized such that their sum equals one by dividing each by the sum of all. Then, landmarks were assigned by considering the normalized voxel intensities as the probabilities of a multinomial distribution from which 2000 points were sampled (with replacement). This number was determined through test runs in which we found that, for volumes of our size, diminishing returns set in around 500 points and using more than 2000 points no longer improved the performance of various downstream analyses.</p><p>Following ISLA sampling, landmark coordinates were scaled from pixels to microns to account for anisotropic image resolution.</p><p>Note we recently published another study that utilizes a simplified version of ISLA for some of the data analysis, albeit in a very different way from how it is used here (<xref ref-type="bibr" rid="bib88">Wong et al., 2020</xref>).</p></sec><sec id="s4-9"><title>Point cloud transformation into TFOR and CFOR</title><p>To place cells in a matched <italic>Tissue Frame of Reference</italic> (TFOR) prior to feature embedding (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B</xref>, left route), primordia were aligned using a simple PCA-based approach that does not require full image registration. To this end, 3000 landmarks were sampled from a given primordium's binary overall segmentation mask using ISLA and a modified PCA was applied to the resulting point cloud. Given that the pLLP's longest axis is always its front-rear axis and the shortest axis is always the apicobasal axis, PCA transformation snaps primordia that had been acquired at a slight angle into a consistent frame of reference. Our modification ensured that 180° flipping could not occur in this procedure. To complete the alignment, the primordial point clouds were translated such that the frontal-most point becomes the coordinate system's origin. Finally, the ISLA point clouds extracted from individual cells as described in the previous paragraph were transformed using the same PCA, thus matching their orientation to the common tissue frame of reference.</p><p>To create a <italic>Cell Frame of Reference</italic> (CFOR) that is invariant to size, rotation and handedness (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B</xref>, right route), point cloud volumes were first normalized such that the sum of the magnitudes of all centroid-to-landmark vectors is 1. Second, cellular point clouds were cast into a pairwise distance (PD) representation. In the PD space, each point of the cloud is no longer characterized by three spatial coordinates but instead by the distances to every other point of the cloud. This representation is rotationally invariant but also extremely high-dimensional (an LxL array, where L is the number of landmarks). To reduce dimensionality, only the 10th, 50th and 90th percentiles of all pairwise distances for each point were chosen to represent that point (resulting in an Lx3 array), which we reasoned would encode both local and global relative spatial location.</p></sec><sec id="s4-10"><title>Feature embedding with CBE</title><p>To determine reference cluster centers for <italic>Cluster-Based Embedding</italic> (CBE) (<xref ref-type="fig" rid="fig3">Figure 3D</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B</xref>), point clouds from multiple samples were centered on their respective centroids and overlaid. K-means clustering was performed on this overlaid cloud (using scikit-learn's <italic>MiniBatchKMeans</italic> implementation) with <italic>k = 20</italic>. The resulting cluster centers were used as common reference points for the next step.</p><p>Several measures were taken to improve the robustness and performance of this cluster detection. First, individual cellular point clouds were downsampled from 2000 points to 500 points prior to being overlaid, using k-means clustering with <italic>k = 500</italic> clusters, the centers of which were used as the new landmarks. Second, not all available cells were used in the overlay. Instead, a representative random subset of primordia (at least 10, at most 25) was selected and only their cells were used in the overlay. The resulting cluster centers were used as reference points across all available samples. Third, the entire overlaid point cloud was downsampled using a density-dependent downsampling approach inspired by <xref ref-type="bibr" rid="bib65">Qiu et al., 2011</xref> (see below), yielding a final overlaid cloud of at most 200'000 points, which allowed reference cluster centers to be computed reasonably efficiently.</p><p>Density-dependent downsampling was performed using a simplified version of the algorithm described by <xref ref-type="bibr" rid="bib65">Qiu et al., 2011</xref>. First, the local density (<inline-formula><mml:math id="inf13"><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:math></inline-formula>) at each point is found, which is defined as the number of points in the local neighborhood, i.e. a sphere whose radius is the median pairwise distance between all points multiplied by an empirically determined factor (here 5). Next, a target density (<inline-formula><mml:math id="inf14"><mml:mi>T</mml:mi><mml:mi>D</mml:mi></mml:math></inline-formula>) is determined, which in accordance with Qiu et al. was set to be the third percentile of all local densities. Now, points are downsampled such that the probability of keeping each point is given by <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. If necessary, the resulting downsampled distribution is further reduced by random sampling in order to reach the maximum of 200'000 points.<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi mathvariant="normal">_</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi mathvariant="normal">_</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:mi>L</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>T</mml:mi><mml:mi>D</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mtext> </mml:mtext></mml:mtd><mml:mtd><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Density-dependent downsampling was chosen to avoid cases where high-density agglomerations of landmarks in a particular region accumulate multiple clusters and thus deplete lower-density regions of local reference points; density-dependent downsampling preserves the overall shape of the overlaid point cloud whilst reducing local density peaks.</p><p>Following the determination of common reference points, CBE proceeds by extracting features describing the local landmark distribution around said reference points for each separate cellular point cloud. Several such features were implemented, including the number of landmarks in the local neighborhood of each reference point, the number of landmarks assigned to each reference point by the k-means clustering itself, the local density of landmarks at each reference point determined by a Gaussian Kernel Density Estimate (KDE), and either the magnitude or the components of the vector connecting each reference point to the centroid of its 25 nearest neighbors. The results were similar across all of these approaches but we ultimately chose to proceed with the last entry in the above list (the vector components; see <xref ref-type="fig" rid="fig3">Figure 3D</xref> for a simple 2D example) based on its inclusion of some additional directional information.</p><p>The feature extraction described above yields an <italic>n-by-3k</italic> latent feature space, where <italic>n</italic> is the number of cells and <italic>k</italic> the number of shared reference clusters (here <italic>k = 20</italic>). As a final step, this space was transformed by Principal Component Analysis (PCA) to bring relevant variation into focus and reduce dimensionality.</p><p>In addition to CBE, an alternative embedding based on the moments of the TFOR or CFOR point clouds was also generated as a comparably simple baseline. We computed the 1 st raw moments (<xref ref-type="disp-formula" rid="equ5">Equation 5</xref>), the 2nd centralized moments (<xref ref-type="disp-formula" rid="equ6">Equation 6</xref>) and the 3rd to 5th normalized moments (<xref ref-type="disp-formula" rid="equ7">Equation 7</xref>) (55 features in total) and once again used PCA to arrive at a compact and expressive feature space.<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mi>r</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>∙</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>∙</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>∙</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:math></disp-formula><disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>∙</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mn>010</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo>∙</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mn>001</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></disp-formula><disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>∙</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mn>010</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo>∙</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mn>001</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup> <mml:mi mathvariant="normal"/></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>In <xref ref-type="disp-formula" rid="equ5 equ6 equ7">Equations 5, 6, 7</xref>, <inline-formula><mml:math id="inf15"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the array of all point cloud coordinates along the spatial dimension <inline-formula><mml:math id="inf16"><mml:mi>d</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf17"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the set of raw (<inline-formula><mml:math id="inf18"><mml:msub><mml:mrow><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), centralized (<inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi>c</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) or normalized (<inline-formula><mml:math id="inf20"><mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) moments of the <inline-formula><mml:math id="inf21"><mml:mi>m</mml:mi></mml:math></inline-formula>-th order, and <inline-formula><mml:math id="inf22"><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula> includes all combinations of length 3 drawn from the integer range <inline-formula><mml:math id="inf23"><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> that satisfy <inline-formula><mml:math id="inf24"><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi></mml:math></inline-formula>. All operations are element-wise except <inline-formula><mml:math id="inf25"><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mo>…</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="inf26"><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mo>…</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula>, which compute the mean and standard deviation across a given array.</p></sec><sec id="s4-11"><title>Synthetic point cloud generator</title><p>In order to benchmark the capability of CBE for latent feature extraction, we required a gold standard dataset to test whether CBE recovers known latent parameters underlying a population of shape objects. We thus wrote a generator to automatically create a large synthetic dataset of cell-like point clouds. This generator functions in four stages:</p><list list-type="order"><list-item><p>Generate a spine (five parameters)The spine is defined by its height along the z dimension (i.e. the apicobasal axis), by an offset, which is the distance and angle by which the end point of the spine is shifted in xy compared to the starting point, and by a connecting line between endpoints, which is a 2<sup>nd</sup> degree polynomial.</p></list-item> <list-item><p>Generate the cell surface (nine parameters)The surface of the cell is determined based on its distance <italic>d</italic> to the spine as a function of <italic>z</italic>. We used the logit-normal as this distance function on the grounds that it has only two parameters, can be asymmetric, monomodal or bimodal, crosses (<italic>0, 0</italic>) and (<italic>1, 0</italic>), and has a range <italic>d &gt; 0</italic> within the domain <italic>0 &gt; z &gt; 1</italic>. For each cell, three different logit-normals were used to describe the surface at three uniformly spaced angles around the spine. Additionally, each of those functions was independently scaled by multiplication with another parameter.</p></list-item> <list-item><p>Sampling of point clouds (0 parameters)The actual surface point cloud to be used in feature embedding was generated by sampling 2000 points with the following scheme: first randomly sample a position along <italic>z</italic> and an angle, then determine the corresponding radius by linear interpolation between the logit-normal values of the two adjacent angles at which they are defined. Finally, angle and radius are converted to the Cartesian coordinate system.</p></list-item> <list-item><p>Centering, scaling and rotation (three parameters)Finally, point clouds are centered on their centroid and cell size is adjusted by multiplication with a scaling parameter, followed by rotation using a homogeneous transformation matrix with two angle parameters.</p></list-item></list><p>All in all, this generator requires 17 parameters of which one modifies only size (not shape) and two modify only rotation. For each synthesized cell, the specific parameter values for the generator were sampled from normal or uniform distributions with hyperparameters set based on empirical experimentation such that a varied population of cell shapes is generated and unreasonably deformed shapes are avoided.</p></sec><sec id="s4-12"><title>Evaluation of CBE on synthetic point clouds</title><p>Using the generator described above, we synthesized a set of <italic>n = 20'000</italic> cellular point clouds and embedded them using both CBE and the moment-based alternative embedding strategy. We then tested how well the values of the 17 known generative parameters could be retrieved from the embedded feature spaces using different scikit-learn implementations of multivariate-multivariable regression, specifically k-Nearest Neighbor (kNN) regression, multi-output linear Support Vector Regression (l-SVR) and multi-output radial basis function kernel Support Vector Regression (r-SVR). Optimal hyperparameters for the two SVRs were determined using cross-validated grid search with <italic>GridSearchCV</italic>, scanning 5 orders of magnitude surrounding the defaults of C (penalty) and epsilon as well as gamma (RBF kernel coefficient) for r-SVR.</p><p>This synthetic experiment showed that cell size and orientation largely obscure other shape features if CFOR-normalization is not performed (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2A</xref>). Furthermore, features generated by CBE enable similar or better predictive performance than moments-based features regardless of the method used for prediction (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2B</xref>). Interestingly, kNN performs markedly better on CBE-embedded spaces, indicating that CBE more meaningfully encodes point cloud similarity as local neighborhood in the embedded space.</p></sec><sec id="s4-13"><title>Feature engineering: Extraction of simple shape measures</title><p>We extracted various explicitly engineered features from entire tissues, segmented cell volumes, and segmented cell point clouds. The features used in this study are listed and briefly described in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>.</p></sec><sec id="s4-14"><title>Multi-Channel atlas prediction</title><p>To construct the multi-channel atlas, we used the secondary markers present in many of our samples (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>), embedded them with ISLA and CBE (see the corresponding sections above) and then trained multivariate-multivariable regressors to predict those embeddings based on the corresponding cell shape embeddings as input features. All embeddings were standardized and PCA-transformed prior to machine learning and only the first 20 PCs were considered. Predictions were performed from shape TFOR to secondary marker TFOR and from shape CFOR to secondary marker CFOR.</p><p>Because expression of the secondary markers was sometimes heterogeneous across the primordium, only cells with a secondary marker intensity above the 33rd percentile were used as training data. Furthermore, to prevent rare extreme outliers (resulting from segmentation artifacts) in either the shape or secondary marker feature space from affecting the prediction, such anomalies were detected and removed from the training data using the isolation forest algorithm (<italic>sklearn.ensemble. isolation_forest</italic>) with <italic>contamination = 0.05</italic>.</p><p>To select the best machine learning model, the following regressors were tested using 3-fold cross-validation based on scikit-learn's <italic>ShuffleSplit</italic> function: k-nearest neighbors regression (<italic>sklearn. neighborsKNeighborsRegressor</italic>), random forest regression (<italic>sklearn.ensemble.RandomForest Regressor</italic>), elastic net regression (<italic>sklearn.linear_model.ElasticNet</italic>), Lasso regression (<italic>sklearn. linear_model.Lasso</italic>), a multi-layer perceptron (<italic>sklearn.neural_network.MLPRegressor</italic>), and a support vector regressor with an RBF-kernel (<italic>sklearn.svm.SVR</italic>). Relevant hyperparameters were optimized on the <italic>NLS-tdTomato</italic> nuclear marker using a 5-fold cross-validated grid search (<italic>sklearn.model_selection. GridSearchCV</italic>) of 5 orders of magnitude surrounding the scikit-learn defaults. Performance was evaluated across different secondary channels and latent feature embeddings (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A</xref>), with the primary aim being high explained variance but also giving some consideration to computational efficiency (training and prediction time). After finding that TFOR predictions perform substantially better than CFOR predictions, possibly because the TFOR shape space incorporates more relevant information for intracellular marker prediction and/or because CFOR spaces contain more noise and more specific information that is challenging to predict, we focused further analysis on TFOR for the time being. We selected the RBF SVR as the regressor of choice because of its consistently high performance.</p><p>For atlas prediction across the entire dataset, the SVR model was trained for each secondary channel (using the corresponding best hyperparameter set) on all available data for that channel and then applied to predict that channel's embedded space for all other cells.</p></sec><sec id="s4-15"><title>smFISH: Spot detection and analysis</title><p>Single-cell segmentation and cell shape feature embedding was performed on the <italic>pea3</italic> smFISH dataset in the same fashion as for the live imaging dataset, resulting in 3'149 cells from 31 samples.</p><p>The <italic>blob_log</italic> spot detector from scikit-image was used (<italic>skimage.blob.blob_log</italic>) to identify smFISH spots (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A–D</xref>). Parameters were optimized by manual testing and by scanning different values for the <italic>threshold</italic> and <italic>min_sigma</italic> parameters, arriving ultimately at <italic>min_sigma = 1</italic>, <italic>max_sigma = 4</italic>, <italic>num_sigma = 10</italic>, <italic>threshold = 0.22</italic>, <italic>overlap = 0.5</italic>, and <italic>log_scale = False</italic>, which produced average counts per cell that are reasonably consistent across different primordia (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1E</xref>) and closely approximate previously reported <italic>pea3</italic> smFISH spot counts in the pLLP (<xref ref-type="bibr" rid="bib23">Durdu et al., 2014</xref>). However, we also found that optimal settings can vary between different smFISH experiments and thus recommend parameter optimization and careful evaluation of the results for every experiment. Furthermore, in this dataset the spot detector failed to detect a reasonable number of spots in some exceptional samples, so we excluded primordia with a mean count per cell of less than two spots from further analysis, leaving 2906 cells from 29 primordia in the dataset.</p><p>Because smFISH must be performed on fixed samples, we checked for fixation effects on cell shape, which would make cross-predictions with the live sample atlas more challenging. In bulk comparisons of key shape features (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1F–H</xref>) we found no significant differences between live and fixed samples. However, such bulk comparisons may miss subtle fixation effects, making the development of methods to quantify, pinpoint and correct such effects an important future goal.</p><p>We trained an RBF-kernel SVR to perform multivariate regression of <italic>pea3</italic> smFISH counts based on as much other information available about each cell as possible (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1E</xref>), namely a combined feature space incorporating the first 10 shape TFOR PCs, the first 10 shape CFOR PCs, and the x, y and z coordinates of cell centroids in TFOR. Hyperparameters C (penalty), epsilon, and gamma (RBF kernel coefficient) were again optimized using <italic>GridSearchCV</italic>, whereas <italic>ShuffleSplit</italic> was used to randomly split data into training and test data for evaluation as shown in <xref ref-type="fig" rid="fig6">Figure 6B</xref>.</p></sec><sec id="s4-16"><title>Prediction and visualization of morphological archetypes</title><p>The four archetypes were manually annotated in 26 primordia (<xref ref-type="fig" rid="fig7">Figure 7A</xref>) using Fiji's multi-point selection tool, yielding 93 leader cells, 241 outer rosette cells, 182 inner rosette cells and 108 between-rosette cells (624 cells in total). Only the clearest examples of the respective archetypes were labeled.</p><p>Cell archetype prediction was performed using scikit-learn's Support Vector Classifier (SVC) with a Radial Basis Function (RBF) kernel, using either TFOR- or CFOR-embedded cell shapes as input features. We optimized the SVC hyperparameters for each embedding using scikit-learn's <italic>GridSearchCV</italic> with 5-fold cross-validation, testing whether or not to use feature standardization, whether or not to use PCA and keep the first 15, 30 or 50 PCs, as well as screening 5 orders of magnitude surrounding the scikit-learn default values for C (penalty) and gamma (RBF kernel coefficient). The resulting best estimator was used for all further training and prediction.</p><p>The confusion matrices in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref> were produced by splitting the annotated cells into a training set (436 cells) and a test set (188 cells) using scikit-learn's <italic>StratifiedShuffleSplit</italic> to balance labels. Predictions for the entire atlas dataset were generated following training with all 624 manually annotated cells.</p><p>The archetype space was constructed by inferring the classification probabilities for each class (using <italic>sklearn.svm.SVC.predict_proba</italic>) and performing a PCA on them. The 3D and 2D visualizations in <xref ref-type="fig" rid="fig7">Figure 7</xref> were then generated by plotting the first three or two principal components, respectively.</p></sec><sec id="s4-17"><title>Image rendering and expanded view of segmentation</title><p>Fiji's <italic>Straighten</italic> tool was used to align angled samples with the main image axes for the purpose of illustration in <xref ref-type="fig" rid="fig1">Figures 1</xref>, <xref ref-type="fig" rid="fig2">2</xref>, <xref ref-type="fig" rid="fig5">5</xref>, <xref ref-type="fig" rid="fig6">6</xref> and <xref ref-type="fig" rid="fig7">7</xref> and in <xref ref-type="video" rid="fig2video1">Figure 2—video 1</xref>, <xref ref-type="video" rid="fig2video2">2</xref>, <xref ref-type="video" rid="fig2video3">3</xref> but never as part of an image analysis pipeline. Maximum projections were created with Fiji whereas 3D videos were rendered with Imaris 7.7.2 (Bitplane, Belfast, UK).</p><p>The expanded view of the segmented pLLP (<xref ref-type="fig" rid="fig1">Figures 1B</xref> and <xref ref-type="fig" rid="fig2">2C</xref>) was generated by first determining the centroids of each segmented cell and then shifting them apart by scaling of their x and y coordinates by a single user-specified factor. The cells were then pasted into an appropriately scaled empty image stack at the new centroid locations, leaving them shifted apart uniformly but not individually rescaled or otherwise transformed. A python implementation of this approach called <italic>tissueRipper</italic> is available under the MIT open source license on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/WhoIsJack/tissueRipper">github.com/WhoIsJack/tissueRipper</ext-link>.</p></sec><sec id="s4-18"><title>Correlation heatmaps and bigraphs</title><p>The corresponding bigraphs (<xref ref-type="fig" rid="fig4">Figures 4E,F</xref> and <xref ref-type="fig" rid="fig5">5G</xref>) were generated using a custom plotting function based on the networkx module. The edges were colored according to the signed value of the Pearson correlation coefficient and sized according to its magnitude. Edges with an absolute correlation coefficient smaller than 0.3 were omitted. The nodes of the engineered features were sorted to reduce edge crossings and group similar nodes, which was achieved by minimizing the following custom loss function:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>∙</mml:mo><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf27"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf28"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the number of engineered and latent features, respectively. <inline-formula><mml:math id="inf29"><mml:mi>C</mml:mi></mml:math></inline-formula> is the current sort order of the engineered features, that is a permutation of the integer interval <inline-formula><mml:math id="inf30"><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math></inline-formula>. Finally, <inline-formula><mml:math id="inf31"><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula> is the absolute Pearson correlation coefficient of the values of the i-th engineered feature and the <inline-formula><mml:math id="inf32"><mml:mi>j</mml:mi></mml:math></inline-formula>-th latent feature. In essence, this loss function is the sum of all Euclidean rank distances between engineered and latent features, weighted by their corresponding absolute Pearson correlation coefficients. Minimization was performed by random shuffling of the sort order and retaining only shuffles that reduced the loss until no change was observed for 2000 consecutive shuffles.</p><p>Note that since the sign of principal components is not inherently meaningful, we flipped it for shape TFOR-PCs 1, 3, 5, six and shape CFOR-PC one across all analyses presented in this study to ensure that PCs positively correlate with their most defining engineered feature(s), facilitating discussion of the results.</p></sec><sec id="s4-19"><title>Tissue consensus maps</title><p>Consensus maps of feature variation (<xref ref-type="fig" rid="fig4">Figures 4G</xref>, <xref ref-type="fig" rid="fig5">5J</xref> and <xref ref-type="fig" rid="fig6">6C,D</xref>) were based on an overlay of TFOR centroid positions of cells across all relevant samples.</p><p>The cut-off for the consensus tissue outline was determined by computing the local density of these overlaid centroids using scipy's Gaussian kernel density estimation with default settings. Regions with densities below 10% of the range between the minimum and maximum density were considered outside of the primordium and are shown as white in the plot.</p><p>The local consensus feature values were computed by applying a point cloud-based Gaussian smooth across the individual cells' feature values, using the 0.5th percentile of all pairwise distances between centroids as <italic>σ</italic>. This smoothed distribution was then plotted as a <italic>tricontourf</italic> plot with matplotlib using up to 21 automatically determined contour levels.</p></sec><sec id="s4-20"><title>Statistical analysis</title><p>Generally, we use <italic>N</italic> to refer to the number of embryos/primordia and <italic>n</italic> to the number of cells.</p><p>Statistical significance for comparisons between two conditions was estimated without parametric assumptions using a two-tailed Mann-Whitney U test (<italic>scipy.stats.mannwhitneyu</italic> with keyword argument <italic>alternative='two-sided'</italic>) with Bonferroni multiple testing correction (<xref ref-type="bibr" rid="bib33">Haynes, 2013</xref>) where appropriate. We considered p&gt;<italic>0.01</italic> as not statistically significant.</p><p>Significance tests with large sample sizes such as those encountered during single-cell analysis tend to indicate high significance regardless of whether the difference between populations is substantive or technical (<xref ref-type="bibr" rid="bib75">Sullivan and Feinn, 2012</xref>), which is why we also report estimates of effect size for any comparison that is statistically significant. Effect sizes were estimated using <xref ref-type="bibr" rid="bib18">Cohen, 1977</xref>. The resulting values can be described as <italic>no effect</italic> (d≈0.0), a <italic>small effect</italic> (d≈0.2), a <italic>medium effect</italic> (d≈0.5) or a <italic>large effect</italic> (d≈0.8) (<xref ref-type="bibr" rid="bib18">Cohen, 1977</xref>).</p></sec><sec id="s4-21"><title>Materials availability</title><p>Requests for experimental resources and reagents should be directed to and will be fulfilled by Darren Gilmour (<ext-link ext-link-type="uri" xlink:href="https://www.imls.uzh.ch/en/research/gilmour.html">darren.gilmour@imls.uzh.ch</ext-link>).</p></sec><sec id="s4-22"><title>Data and code availability</title><p>All raw and processed data are available freely and openly via the Image Data Resource repository (<ext-link ext-link-type="uri" xlink:href="http://idr.openmicroscopy.org/">idr.openmicroscopy.org</ext-link>) under accession number idr0079. Code is available under the MIT open source license on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/WhoIsJack/data-driven-analysis-lateralline">github.com/WhoIsJack/data-driven-analysis-lateralline</ext-link>. Note that we aim to update the core algorithms to python 3 and make them available as a readily reusable module in the near future. Inquiries regarding data and code should be directed to Jonas Hartmann (<ext-link ext-link-type="uri" xlink:href="https://protonmail.com/blog/address-verification-pgp-support/">jonas.m.hartmann@protonmail.com</ext-link>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Sabine Görgens and Andreas Kunze for their support with fish and lab maintenance, respectively. We thank the EMBL Advanced Light Microscopy Facility (ALMF) and the UZH Center for Microscopy and Image Analysis (ZMB) for maintenance of and assistance with microscopes. We thank Alejandra Guzman Herrera for generating the <italic>Act2b:mKate2-Rab11a</italic> line. We thank Francesca Peri and Stefano De Renzis for kindly providing temporary lab space. We thank Christian Tischer and Marvin Albert for helpful discussion on image analysis and numerical computation. We thank Stefano De Renzis, Daniel Krueger, Marvin Albert and Andrew Kennard for critical reading of the manuscript. JH and EG were supported by the EMBL International PhD Programme (EIPP), M.W. was supported by an EMBO Long-Term Fellowship and the EMBL Interdisciplinary Postdoc (EIPOD) Program under Marie Curie COFUNDII Actions. The Gilmour lab was supported by the European Molecular Biology Laboratory (EMBL), the University of Zurich (UZH) and Swiss National Science Funds Grant 31003A_176235.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Investigation, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Investigation, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Resources, Supervision, Funding acquisition, Project administration, Writing - review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Animal experimentation: All experiments on zebrafish embryos were performed between 0-3 days post-fertilization according to the rules of the European Molecular Biology Laboratory, following the guidelines of the European Commission, Directive 2010/63/EU.</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Table of Dataset Composition.</title><p>The number of primordia (N) and of segmented single cells (n) that was used in the analysis for each combination of fluorescent labels. The numbers shown do not include the eight samples that were discarded due to low segmentation quality.</p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-55913-supp1-v1.docx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Table of Engineered Features.</title><p>Brief descriptions of engineered features that were extracted from each segmented cell and used for analysis, in particular to assign biological properties to embedded features extracted with ISLA-CBE.</p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-55913-supp2-v1.docx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-55913-transrepform-v1.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All raw and processed data is openly available via the Image Data Resource repository (<ext-link ext-link-type="uri" xlink:href="https://idr.openmicroscopy.org">https://idr.openmicroscopy.org</ext-link>) under accession number idr0079.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Hartmann</surname><given-names>J</given-names></name><name><surname>Wong</surname><given-names>M</given-names></name><name><surname>Gallo</surname><given-names>E</given-names></name><name><surname>Gilmour</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>idr0079-hartmann-lateralline</data-title><source>Image Data Resource</source><pub-id assigning-authority="other" pub-id-type="accession" xlink:href="https://idr.openmicroscopy.org/search/?query=Name:idr0079">idr0079</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adams</surname> <given-names>DC</given-names></name><name><surname>Rohlf</surname> <given-names>FJ</given-names></name><name><surname>Slice</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A field comes of age: geometric morphometrics in the 21st century</article-title><source>Hysterix</source><volume>24</volume><elocation-id>6283</elocation-id><pub-id pub-id-type="doi">10.4404/hystrix-24.1-6283</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aman</surname> <given-names>A</given-names></name><name><surname>Piotrowski</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Wnt/beta-catenin and fgf signaling control collective cell migration by restricting chemokine receptor expression</article-title><source>Developmental Cell</source><volume>15</volume><fpage>749</fpage><lpage>761</lpage><pub-id pub-id-type="doi">10.1016/j.devcel.2008.10.002</pub-id><pub-id pub-id-type="pmid">19000839</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angerer</surname> <given-names>P</given-names></name><name><surname>Simon</surname> <given-names>L</given-names></name><name><surname>Tritschler</surname> <given-names>S</given-names></name><name><surname>Wolf</surname> <given-names>FA</given-names></name><name><surname>Fischer</surname> <given-names>D</given-names></name><name><surname>Theis</surname> <given-names>FJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Single cells make big data: new challenges and opportunities in transcriptomics</article-title><source>Current Opinion in Systems Biology</source><volume>4</volume><fpage>85</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1016/j.coisb.2017.07.004</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bacallao</surname> <given-names>R</given-names></name><name><surname>Antony</surname> <given-names>C</given-names></name><name><surname>Dotti</surname> <given-names>C</given-names></name><name><surname>Karsenti</surname> <given-names>E</given-names></name><name><surname>Stelzer</surname> <given-names>EH</given-names></name><name><surname>Simons</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>The subcellular organization of Madin-Darby canine kidney cells during the formation of a polarized epithelium</article-title><source>The Journal of Cell Biology</source><volume>109</volume><fpage>2817</fpage><lpage>2832</lpage><pub-id pub-id-type="doi">10.1083/jcb.109.6.2817</pub-id><pub-id pub-id-type="pmid">2592406</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname> <given-names>RE</given-names></name><name><surname>Peña</surname> <given-names>JM</given-names></name><name><surname>Jayamohan</surname> <given-names>J</given-names></name><name><surname>Jérusalem</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Mechanistic models versus machine learning, a fight worth fighting for the biological community?</article-title><source>Biology Letters</source><volume>14</volume><elocation-id>20170660</elocation-id><pub-id pub-id-type="doi">10.1098/rsbl.2017.0660</pub-id><pub-id pub-id-type="pmid">29769297</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Battich</surname> <given-names>N</given-names></name><name><surname>Stoeger</surname> <given-names>T</given-names></name><name><surname>Pelkmans</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Image-based transcriptomics in thousands of single human cells at single-molecule resolution</article-title><source>Nature Methods</source><volume>10</volume><fpage>1127</fpage><lpage>1133</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2657</pub-id><pub-id pub-id-type="pmid">24097269</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bizzarri</surname> <given-names>M</given-names></name><name><surname>Palombo</surname> <given-names>A</given-names></name><name><surname>Cucina</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Theoretical aspects of systems biology</article-title><source>Progress in Biophysics and Molecular Biology</source><volume>112</volume><fpage>33</fpage><lpage>43</lpage><pub-id pub-id-type="doi">10.1016/j.pbiomolbio.2013.03.019</pub-id><pub-id pub-id-type="pmid">23562476</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blei</surname> <given-names>DM</given-names></name><name><surname>Smyth</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Science and data science</article-title><source>PNAS</source><volume>114</volume><fpage>8689</fpage><lpage>8692</lpage><pub-id pub-id-type="doi">10.1073/pnas.1702076114</pub-id><pub-id pub-id-type="pmid">28784795</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brodland</surname> <given-names>GW</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>The differential interfacial tension hypothesis (DITH): a comprehensive theory for the self-rearrangement of embryonic cells and tissues</article-title><source>Journal of Biomechanical Engineering</source><volume>124</volume><fpage>188</fpage><lpage>197</lpage><pub-id pub-id-type="doi">10.1115/1.1449491</pub-id><pub-id pub-id-type="pmid">12002128</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burkel</surname> <given-names>BM</given-names></name><name><surname>von Dassow</surname> <given-names>G</given-names></name><name><surname>Bement</surname> <given-names>WM</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Versatile fluorescent probes for actin filaments based on the actin-binding domain of utrophin</article-title><source>Cell Motility and the Cytoskeleton</source><volume>64</volume><fpage>822</fpage><lpage>832</lpage><pub-id pub-id-type="doi">10.1002/cm.20226</pub-id><pub-id pub-id-type="pmid">17685442</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cai</surname> <given-names>Y</given-names></name><name><surname>Hossain</surname> <given-names>MJ</given-names></name><name><surname>Hériché</surname> <given-names>JK</given-names></name><name><surname>Politi</surname> <given-names>AZ</given-names></name><name><surname>Walther</surname> <given-names>N</given-names></name><name><surname>Koch</surname> <given-names>B</given-names></name><name><surname>Wachsmuth</surname> <given-names>M</given-names></name><name><surname>Nijmeijer</surname> <given-names>B</given-names></name><name><surname>Kueblbeck</surname> <given-names>M</given-names></name><name><surname>Martinic-Kavur</surname> <given-names>M</given-names></name><name><surname>Ladurner</surname> <given-names>R</given-names></name><name><surname>Alexander</surname> <given-names>S</given-names></name><name><surname>Peters</surname> <given-names>JM</given-names></name><name><surname>Ellenberg</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Experimental and computational framework for a dynamic protein atlas of human cell division</article-title><source>Nature</source><volume>561</volume><fpage>411</fpage><lpage>415</lpage><pub-id pub-id-type="doi">10.1038/s41586-018-0518-z</pub-id><pub-id pub-id-type="pmid">30202089</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Callebaut</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Scientific perspectivism: a philosopher of science’s response to the challenge of big data biology</article-title><source>Studies in History and Philosophy of Science Part C: Studies in History and Philosophy of Biological and Biomedical Sciences</source><volume>43</volume><fpage>69</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1016/j.shpsc.2011.10.007</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname> <given-names>CJ</given-names></name><name><surname>Heisenberg</surname> <given-names>CP</given-names></name><name><surname>Hiiragi</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Coordination of morphogenesis and Cell-Fate specification in development</article-title><source>Current Biology</source><volume>27</volume><fpage>R1024</fpage><lpage>R1035</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2017.07.010</pub-id><pub-id pub-id-type="pmid">28950087</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Chan</surname> <given-names>C</given-names></name><name><surname>Theriot</surname> <given-names>J</given-names></name><name><surname>Dunn</surname> <given-names>AR</given-names></name><name><surname>Rohatgi</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><source>Flexible, Comprehensive Frameworks for Quantitative Analysis of Cell Shape and Subcellular Organization in the Context of Cell Motility</source><publisher-loc> California</publisher-loc><publisher-name>Stanford University</publisher-name></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chessel</surname> <given-names>A</given-names></name><name><surname>Carazo Salas</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>From observing to predicting single-cell structure and function with high-throughput/high-content microscopy</article-title><source>Essays in Biochemistry</source><volume>63</volume><fpage>197</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1042/EBC20180044</pub-id><pub-id pub-id-type="pmid">31243141</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ching</surname> <given-names>T</given-names></name><name><surname>Himmelstein</surname> <given-names>DS</given-names></name><name><surname>Beaulieu-Jones</surname> <given-names>BK</given-names></name><name><surname>Kalinin</surname> <given-names>AA</given-names></name><name><surname>Do</surname> <given-names>BT</given-names></name><name><surname>Way</surname> <given-names>GP</given-names></name><name><surname>Ferrero</surname> <given-names>E</given-names></name><name><surname>Agapow</surname> <given-names>P-M</given-names></name><name><surname>Zietz</surname> <given-names>M</given-names></name><name><surname>Hoffman</surname> <given-names>MM</given-names></name><name><surname>Xie</surname> <given-names>W</given-names></name><name><surname>Rosen</surname> <given-names>GL</given-names></name><name><surname>Lengerich</surname> <given-names>BJ</given-names></name><name><surname>Israeli</surname> <given-names>J</given-names></name><name><surname>Lanchantin</surname> <given-names>J</given-names></name><name><surname>Woloszynek</surname> <given-names>S</given-names></name><name><surname>Carpenter</surname> <given-names>AE</given-names></name><name><surname>Shrikumar</surname> <given-names>A</given-names></name><name><surname>Xu</surname> <given-names>J</given-names></name><name><surname>Cofer</surname> <given-names>EM</given-names></name><name><surname>Lavender</surname> <given-names>CA</given-names></name><name><surname>Turaga</surname> <given-names>SC</given-names></name><name><surname>Alexandari</surname> <given-names>AM</given-names></name><name><surname>Lu</surname> <given-names>Z</given-names></name><name><surname>Harris</surname> <given-names>DJ</given-names></name><name><surname>DeCaprio</surname> <given-names>D</given-names></name><name><surname>Qi</surname> <given-names>Y</given-names></name><name><surname>Kundaje</surname> <given-names>A</given-names></name><name><surname>Peng</surname> <given-names>Y</given-names></name><name><surname>Wiley</surname> <given-names>LK</given-names></name><name><surname>Segler</surname> <given-names>MHS</given-names></name><name><surname>Boca</surname> <given-names>SM</given-names></name><name><surname>Swamidass</surname> <given-names>SJ</given-names></name><name><surname>Huang</surname> <given-names>A</given-names></name><name><surname>Gitter</surname> <given-names>A</given-names></name><name><surname>Greene</surname> <given-names>CS</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Opportunities and obstacles for deep learning in biology and medicine</article-title><source>Journal of the Royal Society Interface</source><volume>15</volume><elocation-id>20170387</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2017.0387</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christiansen</surname> <given-names>EM</given-names></name><name><surname>Yang</surname> <given-names>SJ</given-names></name><name><surname>Ando</surname> <given-names>DM</given-names></name><name><surname>Javaherian</surname> <given-names>A</given-names></name><name><surname>Skibinski</surname> <given-names>G</given-names></name><name><surname>Lipnick</surname> <given-names>S</given-names></name><name><surname>Mount</surname> <given-names>E</given-names></name><name><surname>O'Neil</surname> <given-names>A</given-names></name><name><surname>Shah</surname> <given-names>K</given-names></name><name><surname>Lee</surname> <given-names>AK</given-names></name><name><surname>Goyal</surname> <given-names>P</given-names></name><name><surname>Fedus</surname> <given-names>W</given-names></name><name><surname>Poplin</surname> <given-names>R</given-names></name><name><surname>Esteva</surname> <given-names>A</given-names></name><name><surname>Berndl</surname> <given-names>M</given-names></name><name><surname>Rubin</surname> <given-names>LL</given-names></name><name><surname>Nelson</surname> <given-names>P</given-names></name><name><surname>Finkbeiner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>In Silico labeling: predicting fluorescent labels in unlabeled images</article-title><source>Cell</source><volume>173</volume><fpage>792</fpage><lpage>803</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.03.040</pub-id><pub-id pub-id-type="pmid">29656897</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cohen</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1977">1977</year><chapter-title>The T Test for Means</chapter-title><person-group person-group-type="editor"><name><surname>Cohen</surname> <given-names>J</given-names></name></person-group><source>Statistical Power Analysis for the Behavioral Sciences</source><publisher-loc>USA</publisher-loc><publisher-name>Academic Press</publisher-name><fpage>19</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1016/C2013-0-10517-X</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dhar</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Data science and prediction</article-title><source>Communications of the ACM</source><volume>56</volume><fpage>64</fpage><lpage>73</lpage><pub-id pub-id-type="doi">10.1145/2500499</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Distel</surname> <given-names>M</given-names></name><name><surname>Wullimann</surname> <given-names>MF</given-names></name><name><surname>Koster</surname> <given-names>RW</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Optimized Gal4 genetics for permanent gene expression mapping in zebrafish</article-title><source>PNAS</source><volume>106</volume><fpage>13365</fpage><lpage>13370</lpage><pub-id pub-id-type="doi">10.1073/pnas.0903060106</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donà</surname> <given-names>E</given-names></name><name><surname>Barry</surname> <given-names>JD</given-names></name><name><surname>Valentin</surname> <given-names>G</given-names></name><name><surname>Quirin</surname> <given-names>C</given-names></name><name><surname>Khmelinskii</surname> <given-names>A</given-names></name><name><surname>Kunze</surname> <given-names>A</given-names></name><name><surname>Durdu</surname> <given-names>S</given-names></name><name><surname>Newton</surname> <given-names>LR</given-names></name><name><surname>Fernandez-Minan</surname> <given-names>A</given-names></name><name><surname>Huber</surname> <given-names>W</given-names></name><name><surname>Knop</surname> <given-names>M</given-names></name><name><surname>Gilmour</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Directional tissue migration through a self-generated chemokine gradient</article-title><source>Nature</source><volume>503</volume><fpage>285</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1038/nature12635</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Driscoll</surname> <given-names>MK</given-names></name><name><surname>Welf</surname> <given-names>ES</given-names></name><name><surname>Jamieson</surname> <given-names>AR</given-names></name><name><surname>Dean</surname> <given-names>KM</given-names></name><name><surname>Isogai</surname> <given-names>T</given-names></name><name><surname>Fiolka</surname> <given-names>R</given-names></name><name><surname>Danuser</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Robust and automated detection of subcellular morphological motifs in 3D microscopy images</article-title><source>Nature Methods</source><volume>16</volume><fpage>1037</fpage><lpage>1044</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0539-z</pub-id><pub-id pub-id-type="pmid">31501548</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durdu</surname> <given-names>S</given-names></name><name><surname>Iskar</surname> <given-names>M</given-names></name><name><surname>Revenu</surname> <given-names>C</given-names></name><name><surname>Schieber</surname> <given-names>N</given-names></name><name><surname>Kunze</surname> <given-names>A</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name><name><surname>Schwab</surname> <given-names>Y</given-names></name><name><surname>Gilmour</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Luminal signalling links cell communication to tissue architecture during organogenesis</article-title><source>Nature</source><volume>515</volume><fpage>120</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1038/nature13852</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emelyanov</surname> <given-names>A</given-names></name><name><surname>Parinov</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Mifepristone-inducible LexPR system to drive and control gene expression in transgenic zebrafish</article-title><source>Developmental Biology</source><volume>320</volume><fpage>113</fpage><lpage>121</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2008.04.042</pub-id><pub-id pub-id-type="pmid">18544450</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galanternik</surname> <given-names>MV</given-names></name><name><surname>Acedo</surname> <given-names>JN</given-names></name><name><surname>Romero-Carvajal</surname> <given-names>A</given-names></name><name><surname>Piotrowski</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Imaging collective cell migration and hair cell regeneration in the sensory lateral line</article-title><source>The Zebrafish - Cellular and Developmental Biology, Part B Developmental Biology</source><volume>134</volume><fpage>211</fpage><lpage>256</lpage><pub-id pub-id-type="doi">10.1016/bs.mcb.2016.01.004</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghysen</surname> <given-names>A</given-names></name><name><surname>Dambly-Chaudière</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The lateral line microcosmos</article-title><source>Genes &amp; Development</source><volume>21</volume><fpage>2118</fpage><lpage>2130</lpage><pub-id pub-id-type="doi">10.1101/gad.1568407</pub-id><pub-id pub-id-type="pmid">17785522</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Gohlke</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>tifffile</data-title><source>Python</source><version designator="0.11.1">0.11.1</version><ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/tifffile/">https://pypi.org/project/tifffile/</ext-link></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grant</surname> <given-names>KA</given-names></name><name><surname>Raible</surname> <given-names>DW</given-names></name><name><surname>Piotrowski</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Regulation of latent sensory hair cell precursors by Glia in the zebrafish lateral line</article-title><source>Neuron</source><volume>45</volume><fpage>69</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2004.12.020</pub-id><pub-id pub-id-type="pmid">15629703</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gut</surname> <given-names>G</given-names></name><name><surname>Herrmann</surname> <given-names>MD</given-names></name><name><surname>Pelkmans</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Multiplexed protein maps link subcellular organization to cellular states</article-title><source>Science</source><volume>361</volume><elocation-id>eaar7042</elocation-id><pub-id pub-id-type="doi">10.1126/science.aar7042</pub-id><pub-id pub-id-type="pmid">30072512</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haas</surname> <given-names>P</given-names></name><name><surname>Gilmour</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Chemokine signaling mediates self-organizing tissue migration in the zebrafish lateral line</article-title><source>Developmental Cell</source><volume>10</volume><fpage>673</fpage><lpage>680</lpage><pub-id pub-id-type="doi">10.1016/j.devcel.2006.02.019</pub-id><pub-id pub-id-type="pmid">16678780</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="report"><person-group person-group-type="author"><name><surname>Hagberg</surname> <given-names>A</given-names></name><name><surname>Swart</surname> <given-names>P</given-names></name><name><surname>Chult, D</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2008">2008</year><source>Exploring Network Structure, Dynamics, and Function Using NetworkX</source><publisher-loc>Los Alamos, United States</publisher-loc><publisher-name>Los Alamos National Lab</publisher-name><ext-link ext-link-type="uri" xlink:href="https://www.osti.gov/biblio/960616">https://www.osti.gov/biblio/960616</ext-link></element-citation></ref><ref id="bib32"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Hartmann</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Image-Based Data-Driven Analysis of Cellular Architecture</data-title><source>GitHub</source><version designator="8e81702">8e81702</version><ext-link ext-link-type="uri" xlink:href="https://github.com/WhoIsJack/data-driven-analysis-lateralline">https://github.com/WhoIsJack/data-driven-analysis-lateralline</ext-link></element-citation></ref><ref id="bib33"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Haynes</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2013">2013</year><chapter-title>Bonferroni Correction</chapter-title><person-group person-group-type="editor"><name><surname>Dubitzky</surname> <given-names>W</given-names></name><name><surname>Wolkenhauer</surname> <given-names>O</given-names></name><name><surname>Cho</surname> <given-names>K. -H</given-names></name><name><surname>Yokota</surname> <given-names>H</given-names></name></person-group><source>Encyclopedia of Systems Biology</source><volume>154</volume><publisher-name>Springer</publisher-name><fpage>154</fpage><lpage>155</lpage><pub-id pub-id-type="doi">10.1007/978-1-4419-9863-7_100313</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hernández</surname> <given-names>PP</given-names></name><name><surname>Olivari</surname> <given-names>FA</given-names></name><name><surname>Sarrazin</surname> <given-names>AF</given-names></name><name><surname>Sandoval</surname> <given-names>PC</given-names></name><name><surname>Allende</surname> <given-names>ML</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Regeneration in zebrafish lateral line neuromasts: expression of the neural progenitor cell marker sox2 and proliferation-dependent and-independent mechanisms of hair cell renewal</article-title><source>Developmental Neurobiology</source><volume>67</volume><fpage>637</fpage><lpage>654</lpage><pub-id pub-id-type="doi">10.1002/dneu.20386</pub-id><pub-id pub-id-type="pmid">17443814</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holzinger</surname> <given-names>A</given-names></name><name><surname>Dehmer</surname> <given-names>M</given-names></name><name><surname>Jurisica</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Knowledge discovery and interactive data mining in bioinformatics--State-of-the-Art, future challenges and research directions</article-title><source>BMC Bioinformatics</source><volume>15 Suppl 6</volume><elocation-id>I1</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2105-15-S6-I1</pub-id><pub-id pub-id-type="pmid">25078282</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname> <given-names>S</given-names></name><name><surname>Chaudhary</surname> <given-names>K</given-names></name><name><surname>Garmire</surname> <given-names>LX</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>More is better: recent progress in Multi-Omics data integration methods</article-title><source>Frontiers in Genetics</source><volume>8</volume><elocation-id>84</elocation-id><pub-id pub-id-type="doi">10.3389/fgene.2017.00084</pub-id><pub-id pub-id-type="pmid">28670325</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huff</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The fast mode for ZEISS LSM 880 with airyscan: high-speed confocal imaging with super-resolution and improved signal-to-noise ratio</article-title><source>Nature Methods</source><volume>13</volume><elocation-id>398</elocation-id><pub-id pub-id-type="doi">10.1038/nmeth.f.398</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunter</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Matplotlib: a 2D graphics environment</article-title><source>Computing in Science &amp; Engineering</source><volume>9</volume><fpage>90</fpage><lpage>95</lpage><pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacobo</surname> <given-names>A</given-names></name><name><surname>Dasgupta</surname> <given-names>A</given-names></name><name><surname>Erzberger</surname> <given-names>A</given-names></name><name><surname>Siletti</surname> <given-names>K</given-names></name><name><surname>Hudspeth</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Notch-Mediated determination of Hair-Bundle polarity in mechanosensory hair cells of the zebrafish lateral line</article-title><source>Current Biology</source><volume>29</volume><fpage>3579</fpage><lpage>3587</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2019.08.060</pub-id><pub-id pub-id-type="pmid">31668618</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname> <given-names>GR</given-names></name><name><surname>Buck</surname> <given-names>TE</given-names></name><name><surname>Sullivan</surname> <given-names>DP</given-names></name><name><surname>Rohde</surname> <given-names>GK</given-names></name><name><surname>Murphy</surname> <given-names>RF</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Joint modeling of cell and nuclear shape variation</article-title><source>Molecular Biology of the Cell</source><volume>26</volume><fpage>4046</fpage><lpage>4056</lpage><pub-id pub-id-type="doi">10.1091/mbc.E15-06-0370</pub-id><pub-id pub-id-type="pmid">26354424</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Johnson</surname> <given-names>GR</given-names></name><name><surname>Donovan-Maiye</surname> <given-names>RM</given-names></name><name><surname>Maleckar</surname> <given-names>MM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Building a 3D integrated cell</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/238378</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>E</given-names></name><name><surname>Oliphant</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2001">2001</year><data-title>SciPy: open source scientific tools for Python and the SciPy Development Team</data-title><source>SciPy</source><version designator="2.3.0">2.3.0</version><ext-link ext-link-type="uri" xlink:href="http://www.scipy.org">http://www.scipy.org</ext-link></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalinin</surname> <given-names>AA</given-names></name><name><surname>Allyn-Feuer</surname> <given-names>A</given-names></name><name><surname>Ade</surname> <given-names>A</given-names></name><name><surname>Fon</surname> <given-names>G-V</given-names></name><name><surname>Meixner</surname> <given-names>W</given-names></name><name><surname>Dilworth</surname> <given-names>D</given-names></name><name><surname>Husain</surname> <given-names>SS</given-names></name><name><surname>de Wet</surname> <given-names>JR</given-names></name><name><surname>Higgins</surname> <given-names>GA</given-names></name><name><surname>Zheng</surname> <given-names>G</given-names></name><name><surname>Creekmore</surname> <given-names>A</given-names></name><name><surname>Wiley</surname> <given-names>JW</given-names></name><name><surname>Verdone</surname> <given-names>JE</given-names></name><name><surname>Veltri</surname> <given-names>RW</given-names></name><name><surname>Pienta</surname> <given-names>KJ</given-names></name><name><surname>Coffey</surname> <given-names>DS</given-names></name><name><surname>Athey</surname> <given-names>BD</given-names></name><name><surname>Dinov</surname> <given-names>ID</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>3d shape modeling for cell nuclear morphological analysis and classification</article-title><source>Scientific Reports</source><volume>8</volume><elocation-id>2</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-018-31924-2</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karaiskos</surname> <given-names>N</given-names></name><name><surname>Wahle</surname> <given-names>P</given-names></name><name><surname>Alles</surname> <given-names>J</given-names></name><name><surname>Boltengagen</surname> <given-names>A</given-names></name><name><surname>Ayoub</surname> <given-names>S</given-names></name><name><surname>Kipar</surname> <given-names>C</given-names></name><name><surname>Kocks</surname> <given-names>C</given-names></name><name><surname>Rajewsky</surname> <given-names>N</given-names></name><name><surname>Zinzen</surname> <given-names>RP</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The <italic>Drosophila</italic> embryo at single-cell transcriptome resolution</article-title><source>Science</source><volume>358</volume><fpage>194</fpage><lpage>199</lpage><pub-id pub-id-type="doi">10.1126/science.aan3235</pub-id><pub-id pub-id-type="pmid">28860209</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kluyver</surname> <given-names>T</given-names></name><name><surname>Ragan-Kelley</surname> <given-names>B</given-names></name><name><surname>Pérez</surname> <given-names>F</given-names></name><name><surname>Granger</surname> <given-names>B</given-names></name><name><surname>Bussonnier</surname> <given-names>M</given-names></name><name><surname>Frederic</surname> <given-names>J</given-names></name><name><surname>Kelley</surname> <given-names>K</given-names></name><name><surname>Hamrick</surname> <given-names>J</given-names></name><name><surname>Grout</surname> <given-names>J</given-names></name><name><surname>Corlay</surname> <given-names>S</given-names></name><name><surname>Ivanov</surname> <given-names>P</given-names></name><name><surname>Avila</surname> <given-names>D</given-names></name><name><surname>Abdalla</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><chapter-title><italic>Jupyter Notebooks – a publishing format for reproducible computational workflows</italic></chapter-title><person-group person-group-type="editor"><name><surname>Loizides</surname> <given-names>F</given-names></name><name><surname>Schmidt</surname> <given-names>B</given-names></name></person-group><source> Positioning and Power in Academic Publishing: Players, Agents and Agendas</source><volume>90</volume><publisher-name>Jupyter Notebooks </publisher-name><fpage>87</fpage><lpage>90</lpage></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kwan</surname> <given-names>KM</given-names></name><name><surname>Fujimoto</surname> <given-names>E</given-names></name><name><surname>Grabher</surname> <given-names>C</given-names></name><name><surname>Mangum</surname> <given-names>BD</given-names></name><name><surname>Hardy</surname> <given-names>ME</given-names></name><name><surname>Campbell</surname> <given-names>DS</given-names></name><name><surname>Parant</surname> <given-names>JM</given-names></name><name><surname>Yost</surname> <given-names>HJ</given-names></name><name><surname>Kanki</surname> <given-names>JP</given-names></name><name><surname>Chien</surname> <given-names>CB</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The Tol2kit: a multisite gateway-based construction kit for Tol2 transposon transgenesis constructs</article-title><source>Developmental Dynamics</source><volume>236</volume><fpage>3088</fpage><lpage>3099</lpage><pub-id pub-id-type="doi">10.1002/dvdy.21343</pub-id><pub-id pub-id-type="pmid">17937395</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lecaudey</surname> <given-names>V</given-names></name><name><surname>Cakan-Akdogan</surname> <given-names>G</given-names></name><name><surname>Norton</surname> <given-names>WH</given-names></name><name><surname>Gilmour</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Dynamic fgf signaling couples morphogenesis and migration in the zebrafish lateral line primordium</article-title><source>Development</source><volume>135</volume><fpage>2695</fpage><lpage>2705</lpage><pub-id pub-id-type="doi">10.1242/dev.025981</pub-id><pub-id pub-id-type="pmid">18599504</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lecuit</surname> <given-names>T</given-names></name><name><surname>Lenne</surname> <given-names>P-F</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Cell surface mechanics and the control of cell shape, tissue patterns and morphogenesis</article-title><source>Nature Reviews Molecular Cell Biology</source><volume>8</volume><fpage>633</fpage><lpage>644</lpage><pub-id pub-id-type="doi">10.1038/nrm2222</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>JH</given-names></name><name><surname>Daugharthy</surname> <given-names>ER</given-names></name><name><surname>Scheiman</surname> <given-names>J</given-names></name><name><surname>Kalhor</surname> <given-names>R</given-names></name><name><surname>Yang</surname> <given-names>JL</given-names></name><name><surname>Ferrante</surname> <given-names>TC</given-names></name><name><surname>Terry</surname> <given-names>R</given-names></name><name><surname>Jeanty</surname> <given-names>SSF</given-names></name><name><surname>Li</surname> <given-names>C</given-names></name><name><surname>Amamoto</surname> <given-names>R</given-names></name><name><surname>Peters</surname> <given-names>DT</given-names></name><name><surname>Turczyk</surname> <given-names>BM</given-names></name><name><surname>Marblestone</surname> <given-names>AH</given-names></name><name><surname>Inverso</surname> <given-names>SA</given-names></name><name><surname>Bernard</surname> <given-names>A</given-names></name><name><surname>Mali</surname> <given-names>P</given-names></name><name><surname>Rios</surname> <given-names>X</given-names></name><name><surname>Aach</surname> <given-names>J</given-names></name><name><surname>Church</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Highly Multiplexed Subcellular RNA Sequencing in Situ</article-title><source>Science</source><volume>343</volume><fpage>1360</fpage><lpage>1363</lpage><pub-id pub-id-type="doi">10.1126/science.1250212</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leonelli</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The challenges of big data biology</article-title><source>eLife</source><volume>8</volume><elocation-id>e47381</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.47381</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Libbrecht</surname> <given-names>MW</given-names></name><name><surname>Noble</surname> <given-names>WS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Machine learning applications in genetics and genomics</article-title><source>Nature Reviews Genetics</source><volume>16</volume><fpage>321</fpage><lpage>332</lpage><pub-id pub-id-type="doi">10.1038/nrg3920</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Marcus</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Deep learning: a critical appraisal</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1801.00631">https://arxiv.org/abs/1801.00631</ext-link></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matzke</surname> <given-names>EB</given-names></name></person-group><year iso-8601-date="1946">1946</year><article-title>The three-dimensional shape of bubbles in foam; an analysis of the role of surface forces in three-dimensional cell shape determination</article-title><source>American Journal of Botany</source><volume>33</volume><fpage>58</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1002/j.1537-2197.1946.tb10347.x</pub-id><pub-id pub-id-type="pmid">20280138</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McDole</surname> <given-names>K</given-names></name><name><surname>Guignard</surname> <given-names>L</given-names></name><name><surname>Amat</surname> <given-names>F</given-names></name><name><surname>Berger</surname> <given-names>A</given-names></name><name><surname>Malandain</surname> <given-names>G</given-names></name><name><surname>Royer</surname> <given-names>LA</given-names></name><name><surname>Turaga</surname> <given-names>SC</given-names></name><name><surname>Branson</surname> <given-names>K</given-names></name><name><surname>Keller</surname> <given-names>PJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>In Toto Imaging and Reconstruction of Post-Implantation Mouse Development at the Single-Cell Level</article-title><source>Cell</source><volume>175</volume><fpage>859</fpage><lpage>876</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.09.031</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>McKinney</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Data structures for statistical computing in Python</article-title><conf-name>Proceedings of the 9th Python in Science Conference</conf-name></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirkovic</surname> <given-names>I</given-names></name><name><surname>Pylawka</surname> <given-names>S</given-names></name><name><surname>Hudspeth</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Rearrangements between differentiating hair cells coordinate planar polarity and the establishment of mirror symmetry in lateral-line neuromasts</article-title><source>Biology Open</source><volume>1</volume><fpage>498</fpage><lpage>505</lpage><pub-id pub-id-type="doi">10.1242/bio.2012570</pub-id><pub-id pub-id-type="pmid">23213442</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nechiporuk</surname> <given-names>A</given-names></name><name><surname>Raible</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>FGF-dependent mechanosensory organ patterning in zebrafish</article-title><source>Science</source><volume>320</volume><fpage>1774</fpage><lpage>1777</lpage><pub-id pub-id-type="doi">10.1126/science.1156547</pub-id><pub-id pub-id-type="pmid">18583612</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nogare</surname> <given-names>DD</given-names></name><name><surname>Nikaido</surname> <given-names>M</given-names></name><name><surname>Somers</surname> <given-names>K</given-names></name><name><surname>Head</surname> <given-names>J</given-names></name><name><surname>Piotrowski</surname> <given-names>T</given-names></name><name><surname>Chitnis</surname> <given-names>AB</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>In toto imaging of the migrating zebrafish lateral line primordium at single cell resolution</article-title><source>Developmental Biology</source><volume>422</volume><fpage>14</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2016.12.015</pub-id><pub-id pub-id-type="pmid">27965055</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ounkomol</surname> <given-names>C</given-names></name><name><surname>Seshamani</surname> <given-names>S</given-names></name><name><surname>Maleckar</surname> <given-names>MM</given-names></name><name><surname>Collman</surname> <given-names>F</given-names></name><name><surname>Johnson</surname> <given-names>GR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Label-free prediction of three-dimensional fluorescence images from transmitted-light microscopy</article-title><source>Nature Methods</source><volume>15</volume><fpage>917</fpage><lpage>920</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0111-2</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname> <given-names>F</given-names></name><name><surname>Varoquaux</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Scikit-learn: machine learning in Python</article-title><source>Journal of Machine Learning Research</source><volume>12</volume><fpage>2825</fpage><lpage>2830</lpage></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname> <given-names>H</given-names></name><name><surname>Chung</surname> <given-names>P</given-names></name><name><surname>Long</surname> <given-names>F</given-names></name><name><surname>Qu</surname> <given-names>L</given-names></name><name><surname>Jenett</surname> <given-names>A</given-names></name><name><surname>Seeds</surname> <given-names>AM</given-names></name><name><surname>Myers</surname> <given-names>EW</given-names></name><name><surname>Simpson</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>BrainAligner: 3d registration atlases of <italic>Drosophila</italic> brains</article-title><source>Nature Methods</source><volume>8</volume><fpage>493</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1602</pub-id><pub-id pub-id-type="pmid">21532582</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname> <given-names>T</given-names></name><name><surname>Murphy</surname> <given-names>RF</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Image-derived, three-dimensional generative models of cellular organization</article-title><source>Cytometry Part A</source><volume>79A</volume><fpage>383</fpage><lpage>391</lpage><pub-id pub-id-type="doi">10.1002/cyto.a.21066</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pincus</surname> <given-names>Z</given-names></name><name><surname>Theriot</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Comparison of quantitative methods for cell-shape analysis</article-title><source>Journal of Microscopy</source><volume>227</volume><fpage>140</fpage><lpage>156</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2818.2007.01799.x</pub-id><pub-id pub-id-type="pmid">17845709</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pouthas</surname> <given-names>F</given-names></name><name><surname>Girard</surname> <given-names>P</given-names></name><name><surname>Lecaudey</surname> <given-names>V</given-names></name><name><surname>Ly</surname> <given-names>TB</given-names></name><name><surname>Gilmour</surname> <given-names>D</given-names></name><name><surname>Boulin</surname> <given-names>C</given-names></name><name><surname>Pepperkok</surname> <given-names>R</given-names></name><name><surname>Reynaud</surname> <given-names>EG</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>In migrating cells, the golgi complex and the position of the centrosome depend on geometrical constraints of the substratum</article-title><source>Journal of Cell Science</source><volume>121</volume><fpage>2406</fpage><lpage>2414</lpage><pub-id pub-id-type="doi">10.1242/jcs.026849</pub-id><pub-id pub-id-type="pmid">18577576</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname> <given-names>P</given-names></name><name><surname>Simonds</surname> <given-names>EF</given-names></name><name><surname>Bendall</surname> <given-names>SC</given-names></name><name><surname>Gibbs</surname> <given-names>KD</given-names></name><name><surname>Bruggner</surname> <given-names>RV</given-names></name><name><surname>Linderman</surname> <given-names>MD</given-names></name><name><surname>Sachs</surname> <given-names>K</given-names></name><name><surname>Nolan</surname> <given-names>GP</given-names></name><name><surname>Plevritis</surname> <given-names>SK</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Extracting a cellular hierarchy from high-dimensional cytometry data with SPADE</article-title><source>Nature Biotechnology</source><volume>29</volume><fpage>886</fpage><lpage>891</lpage><pub-id pub-id-type="doi">10.1038/nbt.1991</pub-id><pub-id pub-id-type="pmid">21964415</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raj</surname> <given-names>A</given-names></name><name><surname>van den Bogaard</surname> <given-names>P</given-names></name><name><surname>Rifkin</surname> <given-names>SA</given-names></name><name><surname>van Oudenaarden</surname> <given-names>A</given-names></name><name><surname>Tyagi</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Imaging individual mRNA molecules using multiple singly labeled probes</article-title><source>Nature Methods</source><volume>5</volume><fpage>877</fpage><lpage>879</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1253</pub-id><pub-id pub-id-type="pmid">18806792</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rajaram</surname> <given-names>S</given-names></name><name><surname>Pavie</surname> <given-names>B</given-names></name><name><surname>Wu</surname> <given-names>LF</given-names></name><name><surname>Altschuler</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>PhenoRipper: software for rapidly profiling microscopy images</article-title><source>Nature Methods</source><volume>9</volume><fpage>635</fpage><lpage>637</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2097</pub-id><pub-id pub-id-type="pmid">22743764</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Raybaut</surname> <given-names>P</given-names></name><name><surname>Cordoba</surname> <given-names>C</given-names></name><collab>the Spyder project contributors</collab></person-group><year iso-8601-date="2018">2018</year><data-title>Spyder-IDE GitHub Repository</data-title><source>Github</source><version designator="12826">12826</version><ext-link ext-link-type="uri" xlink:href="https://github.com/spyder-ide/spyder">https://github.com/spyder-ide/spyder</ext-link></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roukos</surname> <given-names>V</given-names></name><name><surname>Misteli</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Deep imaging: the next frontier in microscopy</article-title><source>Histochemistry and Cell Biology</source><volume>142</volume><fpage>125</fpage><lpage>131</lpage><pub-id pub-id-type="doi">10.1007/s00418-014-1239-5</pub-id><pub-id pub-id-type="pmid">24989801</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Satija</surname> <given-names>R</given-names></name><name><surname>Farrell</surname> <given-names>JA</given-names></name><name><surname>Gennert</surname> <given-names>D</given-names></name><name><surname>Schier</surname> <given-names>AF</given-names></name><name><surname>Regev</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Spatial reconstruction of single-cell gene expression data</article-title><source>Nature Biotechnology</source><volume>33</volume><fpage>495</fpage><lpage>502</lpage><pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id><pub-id pub-id-type="pmid">25867923</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schindelin</surname> <given-names>J</given-names></name><name><surname>Arganda-Carreras</surname> <given-names>I</given-names></name><name><surname>Frise</surname> <given-names>E</given-names></name><name><surname>Kaynig</surname> <given-names>V</given-names></name><name><surname>Longair</surname> <given-names>M</given-names></name><name><surname>Pietzsch</surname> <given-names>T</given-names></name><name><surname>Preibisch</surname> <given-names>S</given-names></name><name><surname>Rueden</surname> <given-names>C</given-names></name><name><surname>Saalfeld</surname> <given-names>S</given-names></name><name><surname>Schmid</surname> <given-names>B</given-names></name><name><surname>Tinevez</surname> <given-names>JY</given-names></name><name><surname>White</surname> <given-names>DJ</given-names></name><name><surname>Hartenstein</surname> <given-names>V</given-names></name><name><surname>Eliceiri</surname> <given-names>K</given-names></name><name><surname>Tomancak</surname> <given-names>P</given-names></name><name><surname>Cardona</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Fiji: an open-source platform for biological-image analysis</article-title><source>Nature Methods</source><volume>9</volume><fpage>676</fpage><lpage>682</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2019</pub-id><pub-id pub-id-type="pmid">22743772</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schneider</surname> <given-names>CA</given-names></name><name><surname>Rasband</surname> <given-names>WS</given-names></name><name><surname>Eliceiri</surname> <given-names>KW</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>NIH image to ImageJ: 25 years of image analysis</article-title><source>Nature Methods</source><volume>9</volume><fpage>671</fpage><lpage>675</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2089</pub-id><pub-id pub-id-type="pmid">22930834</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shaner</surname> <given-names>NC</given-names></name><name><surname>Lin</surname> <given-names>MZ</given-names></name><name><surname>McKeown</surname> <given-names>MR</given-names></name><name><surname>Steinbach</surname> <given-names>PA</given-names></name><name><surname>Hazelwood</surname> <given-names>KL</given-names></name><name><surname>Davidson</surname> <given-names>MW</given-names></name><name><surname>Tsien</surname> <given-names>RY</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Improving the photostability of bright monomeric orange and red fluorescent proteins</article-title><source>Nature Methods</source><volume>5</volume><fpage>545</fpage><lpage>551</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1209</pub-id><pub-id pub-id-type="pmid">18454154</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname> <given-names>T</given-names></name><name><surname>Butler</surname> <given-names>A</given-names></name><name><surname>Hoffman</surname> <given-names>P</given-names></name><name><surname>Hafemeister</surname> <given-names>C</given-names></name><name><surname>Papalexi</surname> <given-names>E</given-names></name><name><surname>Mauck</surname> <given-names>WM</given-names></name><name><surname>Hao</surname> <given-names>Y</given-names></name><name><surname>Stoeckius</surname> <given-names>M</given-names></name><name><surname>Smibert</surname> <given-names>P</given-names></name><name><surname>Satija</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Comprehensive integration of Single-Cell data</article-title><source>Cell</source><volume>177</volume><fpage>1888</fpage><lpage>1902</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id><pub-id pub-id-type="pmid">31178118</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sullivan</surname> <given-names>GM</given-names></name><name><surname>Feinn</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Using effect Size-or why the <italic>P</italic> value is not enough</article-title><source>Journal of Graduate Medical Education</source><volume>4</volume><fpage>279</fpage><lpage>282</lpage><pub-id pub-id-type="doi">10.4300/JGME-D-12-00156.1</pub-id><pub-id pub-id-type="pmid">23997866</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Team</surname> <given-names>DD</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Library for Dynamic Task Scheduling</data-title><source>Dask</source><version designator="2.17.2">2.17.2</version><ext-link ext-link-type="uri" xlink:href="https://dask.org/">https://dask.org/</ext-link></element-citation></ref><ref id="bib77"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Torvalds</surname> <given-names>L</given-names></name><collab>the Git contributors</collab></person-group><year iso-8601-date="2018">2018</year><data-title>Git GitHub Repository</data-title><source>GitHub</source><version designator="Git 2.27-rc2">Git 2.27-rc2</version><ext-link ext-link-type="uri" xlink:href="https://github.com/git/git">https://github.com/git/git</ext-link></element-citation></ref><ref id="bib78"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Travis</surname> <given-names>E</given-names></name><name><surname>Oliphant</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>A Guide to NumPy</source><publisher-loc> USA</publisher-loc><publisher-name>Trelgol Publishing</publisher-name></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tweedy</surname> <given-names>L</given-names></name><name><surname>Meier</surname> <given-names>B</given-names></name><name><surname>Stephan</surname> <given-names>J</given-names></name><name><surname>Heinrich</surname> <given-names>D</given-names></name><name><surname>Endres</surname> <given-names>RG</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Distinct cell shapes determine accurate chemotaxis</article-title><source>Scientific Reports</source><volume>3</volume><elocation-id>02606</elocation-id><pub-id pub-id-type="doi">10.1038/srep02606</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Walt</surname> <given-names>S</given-names></name><name><surname>Schönberger</surname> <given-names>JL</given-names></name><name><surname>Nunez-Iglesias</surname> <given-names>J</given-names></name><name><surname>Boulogne</surname> <given-names>F</given-names></name><name><surname>Warner</surname> <given-names>JD</given-names></name><name><surname>Yager</surname> <given-names>N</given-names></name><name><surname>Gouillart</surname> <given-names>E</given-names></name><name><surname>Yu</surname> <given-names>T</given-names></name><collab>scikit-image contributors</collab></person-group><year iso-8601-date="2014">2014</year><article-title>scikit-image: image processing in Python</article-title><source>PeerJ</source><volume>2</volume><elocation-id>e453</elocation-id><pub-id pub-id-type="doi">10.7717/peerj.453</pub-id><pub-id pub-id-type="pmid">25024921</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="report"><person-group person-group-type="author"><name><surname>Van Rossum</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1995">1995</year><source>Python Tutorial</source><publisher-loc>Amsterdam, Netherlands</publisher-loc><publisher-name>CWI Report CS-R9526</publisher-name><ext-link ext-link-type="uri" xlink:href="https://docs.python.org/3/tutorial/">https://docs.python.org/3/tutorial/</ext-link></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vergara</surname> <given-names>HM</given-names></name><name><surname>Bertucci</surname> <given-names>PY</given-names></name><name><surname>Hantz</surname> <given-names>P</given-names></name><name><surname>Tosches</surname> <given-names>MA</given-names></name><name><surname>Achim</surname> <given-names>K</given-names></name><name><surname>Vopalensky</surname> <given-names>P</given-names></name><name><surname>Arendt</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Whole-organism cellular gene-expression atlas reveals conserved cell types in the ventral nerve cord of <italic>Platynereis dumerilii</italic></article-title><source>PNAS</source><volume>114</volume><fpage>5878</fpage><lpage>5885</lpage><pub-id pub-id-type="doi">10.1073/pnas.1610602114</pub-id><pub-id pub-id-type="pmid">28584082</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Viader-Llargués</surname> <given-names>O</given-names></name><name><surname>Lupperger</surname> <given-names>V</given-names></name><name><surname>Pola-Morell</surname> <given-names>L</given-names></name><name><surname>Marr</surname> <given-names>C</given-names></name><name><surname>López-Schier</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Live cell-lineage tracing and machine learning reveal patterns of organ regeneration</article-title><source>eLife</source><volume>7</volume><elocation-id>e30823</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.30823</pub-id><pub-id pub-id-type="pmid">29595471</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wada</surname> <given-names>H</given-names></name><name><surname>Ghysen</surname> <given-names>A</given-names></name><name><surname>Satou</surname> <given-names>C</given-names></name><name><surname>Higashijima</surname> <given-names>S</given-names></name><name><surname>Kawakami</surname> <given-names>K</given-names></name><name><surname>Hamaguchi</surname> <given-names>S</given-names></name><name><surname>Sakaizumi</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Dermal morphogenesis controls lateral line patterning during postembryonic development of teleost fish</article-title><source>Developmental Biology</source><volume>340</volume><fpage>583</fpage><lpage>594</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2010.02.017</pub-id><pub-id pub-id-type="pmid">20171200</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>MF</given-names></name><name><surname>Hunter</surname> <given-names>MV</given-names></name><name><surname>Wang</surname> <given-names>G</given-names></name><name><surname>McFaul</surname> <given-names>C</given-names></name><name><surname>Yip</surname> <given-names>CM</given-names></name><name><surname>Fernandez-Gonzalez</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Automated cell tracking identifies mechanically oriented cell divisions during <italic>Drosophila</italic> Axis elongation</article-title><source>Development</source><volume>144</volume><fpage>1350</fpage><lpage>1361</lpage><pub-id pub-id-type="doi">10.1242/dev.141473</pub-id><pub-id pub-id-type="pmid">28213553</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Waskom</surname> <given-names>M</given-names></name><name><surname>Botvinnik</surname> <given-names>O</given-names></name><name><surname>Hobson</surname> <given-names>PD</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>seaborn</data-title><source>Zenodo</source><version designator="0.7.1">v0.7.1</version><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.54844">https://doi.org/10.5281/zenodo.54844</ext-link></element-citation></ref><ref id="bib87"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Westerfield</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2000">2000</year><source>The Zebrafish Book. a Guide for the Laboratory Use of Zebrafish (Danio Rerio)</source><edition>4th ed</edition><publisher-loc>Eugene</publisher-loc><publisher-name>University of Oregon Press</publisher-name></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wong</surname> <given-names>M</given-names></name><name><surname>Newton</surname> <given-names>LR</given-names></name><name><surname>Hartmann</surname> <given-names>J</given-names></name><name><surname>Hennrich</surname> <given-names>ML</given-names></name><name><surname>Wachsmuth</surname> <given-names>M</given-names></name><name><surname>Ronchi</surname> <given-names>P</given-names></name><name><surname>Guzmán-Herrera</surname> <given-names>A</given-names></name><name><surname>Schwab</surname> <given-names>Y</given-names></name><name><surname>Gavin</surname> <given-names>AC</given-names></name><name><surname>Gilmour</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Dynamic buffering of extracellular chemokine by a dedicated scavenger pathway enables robust adaptation during directed tissue migration</article-title><source>Developmental Cell</source><volume>52</volume><fpage>492</fpage><lpage>508</lpage><pub-id pub-id-type="doi">10.1016/j.devcel.2020.01.013</pub-id><pub-id pub-id-type="pmid">32059773</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.55913.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Solnica-Krezel</surname><given-names>Lilianna</given-names></name><role>Reviewing Editor</role><aff><institution>Washington University School of Medicine</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Chitnis</surname><given-names>Ajay B</given-names></name><role>Reviewer</role><aff><institution>Eunice Kennedy Shriver National Institute of Child Health and Human Development</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This work develops an image analysis pipeline for extracting and analyzing cell-based data using unsupervised machine learning to find correlations between cell shape, orientation, position, and gene expression. Timelapse imaging of the developing zebrafish lateral line organ is used as an example of this approach. The authors develop an approach to statistically represent cell shape in both a cell-based and tissue-based reference frame to construct a feature space for machine learning. This representation is used to build an atlas integrating multiple cellular markers and linking them to cell type archetypes. This tour de force pioneering study is expected to open an avenue to a more effective analysis of &quot;data-rich&quot; microscopy data, which provides one of the most important yet challenging windows on unfolding of the embryogenesis and organogenesis.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;An image-based data-driven analysis of cellular architecture in a developing tissue&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by two peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Marianne Bronner as the Senior Editor The following individual involved in review of your submission has agreed to reveal their identity: Ajay B. Chitnis (Reviewer #1).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor, who also read the manuscript and has drafted this decision to help you prepare a revised submission.</p><p>We would like to draw your attention to changes in our revision policy that we have made in response to COVID-19 (https://elifesciences.org/articles/57162). Specifically, we are asking editors to accept without delay manuscripts, like yours, that they judge can stand as <italic>eLife</italic> papers without additional data, even if they feel that they would make the manuscript stronger. Thus the revisions requested below only address clarity and presentation.</p><p>Summary:</p><p>This work develops an image analysis pipeline for extracting and analyzing cell-based data using unsupervised machine learning to find correlations between cell shape, orientation, position, and gene expression. Timelapse imaging of the zebrafish lateral line is used as an example of this approach. The authors develop an approach to statistically represent cell shape in both a cell-based and tissue-based reference frame to construct a feature space for machine learning. This representation is used to build an atlas integrating multiple cellular markers, such as F-actin or Golgi organelle, predict smFISH data and, is linked to cell type archetypes. This tour de force pioneering study is expected to open an avenue to very effective analysis of &quot;data-rich&quot; microscopy data, which provides one of the most important yet challenging windows on unfolding of the embryogenesis and organogenesis.</p><p>Essential revisions:</p><p>Whereas the two reviewers and the managing editor were in agreement about the significance and broader applicability of the methods you developed, they differed in their view on the manuscript presentation.</p><p>One reviewer thought that the paper is well laid out, and despite its complexity, the logic and significance of each step in the analysis made fairly accessible to a diverse reader audience. The authors describe the challenges of data extraction, data integration and data interpretation. They address these challenges by describing how high-resolution 3D images collected with AiryScan fast mode confocal microscopy were first segmented with automation. Then a four-step process was implemented to extract and integrate information from these images.</p><p>However, the second reviewer thought that this paper is a bit of a &quot;diamond in the rough&quot;. It was not easy to understand what the authors were doing after reading the title, Abstract, Introduction, or first section of the Results. And it was not until the reviewer read the remaining results that they got excited that this was a novel, general, and up-and-coming approach. Having read the manuscript, the reviewing editor agrees with this reviewer that revising the manuscript with the goal of increasing its clarity and accessibility would significantly improve its impact.</p><p>Therefore, we recommend that you should re-work the first half of the paper considering the following points with the goal of better communicating your approach to a biology audience. Be 1) more specific, 2) less jargony, and 3) describe goals with multiple words. Moreover, more detail about the patio-temporal details of what was imaged should be added in the Results section. The methodological approach is described as a tool for studying organogenesis, a highly dynamic process. Yet, only from the Materials and methods section one can learn that embryos at 30-34 hpf (and thus practically a single time point) have been imaged. Please, indicate whether a primordium at a specific position in the embryo was imaged. Also, the authors could more clearly describe the feature integration experimental setup, especially whether integration of signals like F-actin, or Golgi apparatus requires simultaneous imaging of the membrane signal. Consulting the manuscript with non-specialists would be also advised during the revision process.</p><p>In addition, as reviewers point out, one is a little disappointed that despite the elegant analysis, what the authors discovered, with some minor exceptions, for the most part confirmed what we knew to a large extent about morphogenesis in the pLLP. Therefore, perhaps more exploration of differences between cells along the inside out axis rather than along the longitudinal or DV axis might have provided some additional important distinctions between cells in terms of how they might correlate with Nuclei, Actin or golgi distribution. Such new insight would underscore the power of the approach and its impact in the field.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.55913.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>Whereas the two reviewers and the managing editor were in agreement about the significance and broader applicability of the methods you developed, they differed in their view on the manuscript presentation.</p><p>One reviewer thought that the paper is well laid out, and despite its complexity, the logic and significance of each step in the analysis made fairly accessible to a diverse reader audience. The authors describe the challenges of data extraction, data integration and data interpretation. They address these challenges by describing how high-resolution 3D images collected with AiryScan fast mode confocal microscopy were first segmented with automation. Then a four-step process was implemented to extract and integrate information from these images.</p><p>However, the second reviewer thought that this paper is a bit of a &quot;diamond in the rough&quot;. It was not easy to understand what the authors were doing after reading the title, Abstract, Introduction, or first section of the Results. And it was not until the reviewer read the remaining results that they got excited that this was a novel, general, and up-and-coming approach. Having read the manuscript, the reviewing editor agrees with this reviewer that revising the manuscript with the goal of increasing its clarity and accessibility would significantly improve its impact.</p><p>Therefore, we recommend that you should re-work the first half of the paper considering the following points with the goal of better communicating your approach to a biology audience. Be 1) more specific, 2) less jargony, and 3) describe goals with multiple words. Moreover, more detail about the patio-temporal details of what was imaged should be added in the Results section. The methodological approach is described as a tool for studying organogenesis, a highly dynamic process. Yet, only from the Materials and methods section one can learn that embryos at 30-34 hpf (and thus practically a single time point) have been imaged. Please, indicate whether a primordium at a specific position in the embryo was imaged. Also, the authors could more clearly describe the feature integration experimental setup, especially whether integration of signals like F-actin, or Golgi apparatus requires simultaneous imaging of the membrane signal. Consulting the manuscript with non-specialists would be also advised during the revision process.</p></disp-quote><p>We have made a range of adjustments aimed at improving clarity and better describing the motivations behind various steps in our analysis throughout the first half of the paper. Regarding jargon, we in some cases opted to keep the technical terminology for the benefit of specialist readers and added further information to clarify its meaning for non-specialists. Keeping the standard terminology while providing accessible explanations has the added benefit of hopefully making general data-science literature less intimidating to those non-specialist readers who'd like know about this important emerging field. After following the recommendation to consult non-specialists, we believe that this revised manuscript is now sufficiently clear and well-contextualized for a general audience. However, if the reviewers or the reviewing editor see further room for improvement, we will be happy to incorporate specific suggestions.</p><p>Regarding timing, embryos were mounted at 30-34hpf and imaged at 32-36hpf with the primordium located above the posterior half of the yolk extension. We have clarified this in the Results and Materials and methods sections. The internal organization of the pLLP is known to be relatively consistent throughout its migration (excepting the start and end), so our analysis focuses on this particular time frame as a means of investigating tissue organization. As indicated in the Discussion section, our approach could readily be extended to dynamic data, which will be the subject of future studies.</p><p>Finally, we have clarified in the data integration section that simultaneous imaging is required in order to produce training data for machine learning.</p><disp-quote content-type="editor-comment"><p>In addition, as reviewers point out, one is a little disappointed that despite the elegant analysis, what the authors discovered, with some minor exceptions, for the most part confirmed what we knew to a large extent about morphogenesis in the pLLP. Therefore, perhaps more exploration of differences between cells along the inside out axis rather than along the longitudinal or DV axis might have provided some additional important distinctions between cells in terms of how they might correlate with Nuclei, Actin or golgi distribution. Such new insight would underscore the power of the approach and its impact in the field.</p></disp-quote><p>We thank the reviewers for this helpful and constructive suggestion. Based on this feedback, we revisited the key patterns found within our atlas with the aim of adding further information on the central-peripheral axis of pLLP organization. In the original manuscript, we tended to highlight the 'known' features we were able to extract, as this helped validate our new unbiased method. However, there were indeed a number of novel insights and these are now emphasized in the revised version.</p><p>Regarding novel insights resulting from additional markers specifically, such as nuclei and actin, we found that the structures currently featured in the atlas are either dominated by leader-follower variation or add little new information beyond what is already captured by cell shape (nuclei and actin in particular tend to simply recapitulate overall cell shape variation). However, we believe this is offset by the exciting general demonstration that additional markers of interest can be integrated so seamlessly into our shape atlas and we're confident that this 'multiplexing' capability will lead to novel insights in other tissue contexts.</p><p>We have followed the helpful suggestion to further explore differences along the inside-outside axis. In Figure 7D, we now include CFOR-PC2 (cell surface smoothness), which shows an interesting pattern that further reinforces our finding that a previously unknown mechanism acting through cell surface mechanics may play a role in rosette morphogenesis. We made modifications to the corresponding paragraphs in the Results and Discussion sections to further highlight this point.</p><p>We note that this finding has in fact prompted us to initiate a targeted mechanistic study on the topic, which has already produced some interesting preliminary results. Besides being beyond the scope of this first manuscript, we're convinced that the addition of more context-specific follow-up experiments would only distract from the broad relevance and novelty of this first study, which presents a data-driven approach that can be applied to many relevant problems in tissue biology.</p></body></sub-article></article>