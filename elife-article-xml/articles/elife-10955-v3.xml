<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">10955</article-id><article-id pub-id-type="doi">10.7554/eLife.10955</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Ecology</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>The evolution of distributed sensing and collective computation in animal populations</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-40435"><name><surname>Hein</surname><given-names>Andrew M</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-41070"><name><surname>Rosenthal</surname><given-names>Sara Brin</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-41071"><name><surname>Hagstrom</surname><given-names>George I</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-41068"><name><surname>Berdahl</surname><given-names>Andrew</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-41069"><name><surname>Torney</surname><given-names>Colin J</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-15192"><name><surname>Couzin</surname><given-names>Iain D</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="corresp" rid="cor2">*</xref><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-3"/><xref ref-type="other" rid="par-4"/><xref ref-type="other" rid="par-5"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Ecology and Evolutionary Biology</institution>, <institution>Princeton University</institution>, <addr-line><named-content content-type="city">Princeton</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Physics</institution>, <institution>Princeton University</institution>, <addr-line><named-content content-type="city">Princeton</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Department of Collective Behaviour</institution>, <institution>Max Planck Institute for Ornithology</institution>, <addr-line><named-content content-type="city">Konstanz</named-content></addr-line>, <country>Germany</country></aff><aff id="aff4"><label>4</label><institution>Santa Fe Institute</institution>, <addr-line><named-content content-type="city">Santa Fe</named-content></addr-line>, <country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Centre for Mathematics and the Environment</institution>, <institution>University of Exeter</institution>, <addr-line><named-content content-type="city">Penryn</named-content></addr-line>, <country>United Kingdom</country></aff><aff id="aff6"><label>6</label><institution content-type="dept">Chair of Biodiversity and Collective Behaviour</institution>, <institution>University of Konstanz</institution>, <addr-line><named-content content-type="city">Konstanz</named-content></addr-line>, <country>Germany</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Doebeli</surname><given-names>Michael</given-names></name><role>Reviewing editor</role><aff id="aff7"><institution>University of British Columbia</institution>, <country>Canada</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>ahein@princeton.edu</email> (AMH);</corresp><corresp id="cor2"><email>icouzin@orn.mpg.de</email> (IDC)</corresp><fn fn-type="con" id="equal-contrib"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>10</day><month>12</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e10955</elocation-id><history><date date-type="received"><day>20</day><month>08</month><year>2015</year></date><date date-type="accepted"><day>01</day><month>11</month><year>2015</year></date></history><permissions><copyright-statement>© 2015, Hein et al</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Hein et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-10955-v3.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.10955.001</object-id><p>Many animal groups exhibit rapid, coordinated collective motion. Yet, the evolutionary forces that cause such collective responses to evolve are poorly understood. Here, we develop analytical methods and evolutionary simulations based on experimental data from schooling fish. We use these methods to investigate how populations evolve within unpredictable, time-varying resource environments. We show that populations evolve toward a distinctive regime in behavioral phenotype space, where small responses of individuals to local environmental cues cause spontaneous changes in the collective state of groups. These changes resemble phase transitions in physical systems. Through these transitions, individuals evolve the emergent capacity to sense and respond to resource gradients (i.e. individuals perceive gradients via social interactions, rather than sensing gradients directly), and to allocate themselves among distinct, distant resource patches. Our results yield new insight into how natural selection, acting on selfish individuals, results in the highly effective collective responses evident in nature.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.001">http://dx.doi.org/10.7554/eLife.10955.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.10955.002</object-id><title>eLife digest</title><p>In nature, we see many examples of highly coordinated movements of groups of individuals; think of a flock of birds turning swiftly in unison or a crowd of people filing through the exit of a building. A common feature of these behaviors is that they occur without any centralized control, and that they involve sudden and often dramatic changes in the 'collective state' of the group (i.e. speed, or the distances between individuals). In the past, researchers have likened these transitions in collective behavior to phase transitions in physical systems, for example, the transition between liquid water and water vapor. However, it is not clear how such collective responses could have evolved.</p><p>Natural selection is an evolutionary process whereby individuals with particularly 'fit' traits produce more offspring than others. Over many generations, these beneficial traits tend to become more common in the population. Hein, Rosenthal, Hagstrom et al. developed a mathematical model to investigate whether the capacity of a population to perform collective motions could evolve through natural selection.</p><p>The model shows that over many generations, populations consistently evolve a unique collective trait whereby small responses of individuals to an environmental cue can cause spontaneous changes in the collective state of the local population. These transitions in collective state greatly enhance the ability of individuals to locate and exploit resources. Hein, Rosenthal, Hagstrom et al.’s findings suggest that natural selection acting on the behavior of individuals can cause a population to evolve a distinctive, collective behavior.</p><p>The next challenge will be to identify a biological system in which the evolution of collective motion can be studied experimentally to test these predictions.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.002">http://dx.doi.org/10.7554/eLife.10955.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>Collective Behavior</kwd><kwd>Physical Computation</kwd><kwd>Swarm</kwd><kwd>Optimization</kwd><kwd>Decision-making</kwd><kwd>Explore-exploit</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000913</institution-id><institution>James S. McDonnell Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Hein</surname><given-names>Andrew M</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>PHY-0848755, IOS-1355061, and EAGER IOS-1251585</award-id><principal-award-recipient><name><surname>Couzin</surname><given-names>Iain D</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000183</institution-id><institution>Army Research Office</institution></institution-wrap></funding-source><award-id>W911NG-11-1-0385 and W911NF-14-1-0431</award-id><principal-award-recipient><name><surname>Couzin</surname><given-names>Iain D</given-names></name></principal-award-recipient></award-group><award-group id="par-4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007297</institution-id><institution>Office of Naval Research Global</institution></institution-wrap></funding-source><award-id>N00014-09-1-1074 and N00014-14-1-0635</award-id><principal-award-recipient><name><surname>Couzin</surname><given-names>Iain D</given-names></name></principal-award-recipient></award-group><award-group id="par-5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004412</institution-id><institution>Human Frontier Science Program</institution></institution-wrap></funding-source><award-id>RGP0065/2012</award-id><principal-award-recipient><name><surname>Couzin</surname><given-names>Iain D</given-names></name></principal-award-recipient></award-group><award-group id="par-6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>Dimensions of Biodiversity OCE-1046001</award-id><principal-award-recipient><name><surname>Hagstrom</surname><given-names>George I</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A computational model shows that natural selection can cause populations to evolve a distinctive population-level phenotype: the ability to transition between collective states in response to the environment.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>In many highly coordinated animal groups, such as fish schools and bird flocks, the ability of individuals to locate resources and avoid predators depends on the collective behavior of the group. For example, when fish schools are attacked by predators, 'flash expansion' (<xref ref-type="bibr" rid="bib30">Pitcher et al., 1993</xref>) and other coordinated collective motions, made possible above a certain group size, reduce individual risk (<xref ref-type="bibr" rid="bib20">Handegard et al., 2012</xref>). Similarly, fish can track dynamic resource patches far more effectively when they are in a group (<xref ref-type="bibr" rid="bib2">Berdahl et al., 2013</xref>). When an individual responds to a change in the environment (e.g., predator, resource cue), this response propagates swiftly through the group (<xref ref-type="bibr" rid="bib32">Rosenthal et al., 2015</xref>), altering the group’s collective motion. How are such rapid, coordinated responses possible? These responses may occur, in part, because the nature of social interactions makes animal groups highly sensitive to small changes in the behavior of individual group members; theoretical (<xref ref-type="bibr" rid="bib12">Couzin et al., 2002</xref>; <xref ref-type="bibr" rid="bib16">D’Orsogna et al., 2006</xref>; <xref ref-type="bibr" rid="bib25">Kolpas et al., 2007</xref>) and empirical (<xref ref-type="bibr" rid="bib41">Tunstrøm et al., 2013</xref>; <xref ref-type="bibr" rid="bib6">Buhl et al., 2006</xref>) studies of collective motion have revealed that minor changes in individual behavior, such as speed (<xref ref-type="bibr" rid="bib41">Tunstrøm et al., 2013</xref>), can cause sudden transitions in group state, reminiscent of similarly sudden phase transitions between collective states in physical systems (such as the solid-liquid-gas transitions as a function of increasing temperature). It has been proposed that individuals may trigger such changes in collective state by responding to the environment, thereby initiating a coordinated response at the group level (e.g., <xref ref-type="bibr" rid="bib12">Couzin et al. (2002)</xref>; <xref ref-type="bibr" rid="bib25">Kolpas et al. (2007)</xref>; <xref ref-type="bibr" rid="bib13">Couzin and Krause, 2003</xref>). This mechanism requires that the behavioral rules of individual animals within a population have evolved in a way that allows groups to transition adaptively among distinct collective states. The evolutionary processes that could lead to this population-level property, however, remain poorly understood.</p><p>The feedback between the behavioral phenotypes of individuals, the collective behaviors that these phenotypes produce, and individual-level fitness consequences has made it challenging to study how complex collective behaviors evolve (<xref ref-type="bibr" rid="bib39">Torney et al., 2011</xref>). Many species, including fish and birds, form groups in which members have low genetic relatedness, which implies that kin selection alone cannot explain the evolution of collective behavior. Moreover, while natural selection acts on the behavioral phenotypes of selfish individuals, collective behaviors are group-level, or perhaps even population-level, properties rather than heritable individual phenotypes. To understand how collective behaviors evolve, then, one must first understand the mapping between individual phenotypes and collective behavior, and between collective behavior and individual fitness.</p><p>Here, we take advantage of detailed studies of the social interaction rules and environmental response behaviors of schooling fish (<xref ref-type="bibr" rid="bib2">Berdahl et al., 2013</xref>; <xref ref-type="bibr" rid="bib24">Katz et al., 2011</xref>) to develop a biologically-motivated evolutionary model of collective responses to the environment. Using analytical methods and evolutionary simulations, we study how individual behavioral rules produce collective behaviors, and how collective behaviors, in turn, govern the fitness and evolution of selfish individuals. To relate individual and collective behaviors to fitness, we consider a fundamental task faced by fish and other motile organisms: finding and exploiting dynamic resources (<xref ref-type="bibr" rid="bib37">Stephens et al., 2007</xref>). In our model, individuals respond to the locations of near neighbors and also to local measurements of resource quality. Each individual achieves a fitness determined by the resource level it experiences over its lifetime. We use this framework to explore the evolution of complex collective responses to the environment, and how such responses are related to transitions in collective state.</p></sec><sec id="s2"><title>Model development</title><sec id="s2-1"><title>Behavioral rules</title><p>We model the movement behaviors of each individual in a population of size <inline-formula><mml:math id="inf1"><mml:mi>N</mml:mi></mml:math></inline-formula> using two experimentally-motivated (<xref ref-type="bibr" rid="bib2">Berdahl et al., 2013</xref>; <xref ref-type="bibr" rid="bib24">Katz et al., 2011</xref>) behavioral rules: a social response rule and an environmental response rule. The social response rule is motivated by experimental studies of pairwise interactions among golden shiners (<italic>Notemigonus crysoleucas</italic>) (<xref ref-type="bibr" rid="bib24">Katz et al., 2011</xref>). Individual fish avoid others with whom they are in very close proximity. As the distance between individuals increases, however, interactions gradually change from repulsive to attractive, with maximum attraction occurring at a distance of two-four body lengths. For longer distances, individuals still attract one another but the strength of attraction decays in magnitude (Appendix section 1; <xref ref-type="bibr" rid="bib24">Katz et al., 2011</xref>). As found in experimental studies of golden shiners (<xref ref-type="bibr" rid="bib24">Katz et al., 2011</xref>) and mosquitofish (<italic>Gambusia holbrooki</italic>) (<xref ref-type="bibr" rid="bib22">Herbert-Read et al., 2011</xref>) there need not be an explicit alignment tendency; rather alignment can be an emergent property of motion combined with the tendencies for repulsion and attraction described above.</p><p>To capture these observed social interactions (or ‘social forces’), we model the acceleration of individuals using a force-based method (<xref ref-type="bibr" rid="bib24">Katz et al., 2011</xref>). The <inline-formula><mml:math id="inf2"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual responds to its neighbors using the following rule:</p><p><disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mn>,</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo>∇</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mn>,</mml:mn><mml:mo> </mml:mo></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf3"><mml:mstyle><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mn>,</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> is the social force on the <inline-formula><mml:math id="inf4"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual, <inline-formula><mml:math id="inf5"><mml:mstyle><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mstyle></mml:math></inline-formula> is the position of the <inline-formula><mml:math id="inf6"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual, <inline-formula><mml:math id="inf7"><mml:mo>∇</mml:mo></mml:math></inline-formula> is the two-dimensional gradient operator, the term in brackets is a social potential, <inline-formula><mml:math id="inf8"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf9"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf10"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf11"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are constants that dictate the relative strengths and length scales of social attraction and repulsion, and the set <inline-formula><mml:math id="inf12"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a set of the <inline-formula><mml:math id="inf13"><mml:mi>k</mml:mi></mml:math></inline-formula> nearest neighbors of the <inline-formula><mml:math id="inf14"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual, where a neighbor is an individual within a distance of <inline-formula><mml:math id="inf15"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of the focal individual. <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> does not include explicit alignment with neighbors. A similar model is discussed in <xref ref-type="bibr" rid="bib16">D’Orsogna et al. (2006)</xref>. In <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> determines the length scale over which individuals are influenced by social interactions. If <inline-formula><mml:math id="inf17"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is greater than <inline-formula><mml:math id="inf18"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> but less than <inline-formula><mml:math id="inf19"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, individuals repel one another at short distances but do not attract one another. We refer to such individuals as asocial (Appendix section 1). If <inline-formula><mml:math id="inf20"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is greater than both <inline-formula><mml:math id="inf21"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf22"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, individuals repel one another at short distances and are attracted to one another at intermediate distances as observed by <xref ref-type="bibr" rid="bib24">Katz et al. (2011)</xref>. Finite <inline-formula><mml:math id="inf23"><mml:mi>k</mml:mi></mml:math></inline-formula> ensures that individuals can only respond to a limited number of their neighbors in crowded regions of space and provides a simplified model of sensory-based social interactions (e.g., <xref ref-type="bibr" rid="bib32">Rosenthal et al. (2015)</xref>; <xref ref-type="bibr" rid="bib38">Strandburg-Peshkin et al. (2013)</xref>). Finite <inline-formula><mml:math id="inf24"><mml:mi>k</mml:mi></mml:math></inline-formula> also ensures that individuals are limited to finite local density (Appendix section 3).</p><p>To model the response of individuals to the environment, we develop an environmental response rule based on experimentally-observed environmental responses of golden shiners (<xref ref-type="bibr" rid="bib2">Berdahl et al., 2013</xref>). In particular, in a dynamic, heterogeneous environment, individual golden shiners respond strongly to local sensory cues by slowing down in favorable regions of the environment, and speeding up in unfavorable regions. In contrast, fish respond only weakly to spatial gradients in environmental quality and instead adjust their headings primarily based on the positions of their near neighbors. Accordingly, we model the <inline-formula><mml:math id="inf25"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual’s environmental response as a function of the level of an environmental cue (in this case, the level of a resource) at its current position:</p><p><disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mn>,</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>Ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mfrac><mml:mstyle><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mstyle><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mn>,</mml:mn></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf26"><mml:mrow><mml:msub><mml:mstyle><mml:mi>F</mml:mi></mml:mstyle><mml:mrow><mml:mi>a</mml:mi><mml:mn>,</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the autonomous force the <inline-formula><mml:math id="inf27"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual generates by accelerating or decelerating in response to the environment, <inline-formula><mml:math id="inf28"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>(</mml:mo><mml:mo>⋅</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is a monotonically decreasing function of the value of an environmental cue, <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is the cue value at the <inline-formula><mml:math id="inf30"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual’s position, <inline-formula><mml:math id="inf31"><mml:mi>η</mml:mi></mml:math></inline-formula> is a damping term that limits individuals to a finite speed, and <inline-formula><mml:math id="inf32"><mml:mrow><mml:msub><mml:mstyle><mml:mi>v</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the <inline-formula><mml:math id="inf33"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual’s velocity. In the absence of social interactions, individuals travel at preferred speed <inline-formula><mml:math id="inf34"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>Ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> (for <inline-formula><mml:math id="inf35"><mml:mrow><mml:msub><mml:mi>Ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). Changes in speed are crucial in the schooling behavior of fish (<xref ref-type="bibr" rid="bib41">Tunstrøm et al., 2013</xref>; <xref ref-type="bibr" rid="bib2">Berdahl et al., 2013</xref>), and as we show below, are also responsible for generating effective collective response in our model. Following the experimental results in <xref ref-type="bibr" rid="bib2">Berdahl et al. (2013)</xref> we assume that individuals do not change their headings in response to the cue. In what follows, we refer to 'cue' and 'resource' interchangeably as we model the case where the cue is the resource itself (see e.g., <xref ref-type="bibr" rid="bib39">Torney et al. (2009)</xref>; <xref ref-type="bibr" rid="bib21">Hein and McKinley (2012)</xref> for cases where the cue is not a resource).</p><p>Combining social and environmental response rules yields two equations that govern each individual’s movement (in two dimensions):</p><p><disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mstyle><mml:mi>v</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mn>,</mml:mn></mml:mrow></mml:math></disp-formula></p><p>and</p><p><disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mi>m</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mstyle><mml:mi>v</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mstyle><mml:mi>F</mml:mi></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mn>,</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle><mml:mi>F</mml:mi></mml:mstyle><mml:mrow><mml:mi>a</mml:mi><mml:mn>,</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mn>,</mml:mn></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf36"><mml:mi>m</mml:mi></mml:math></inline-formula> is mass. <xref ref-type="bibr" rid="bib16">D’Orsogna et al. (2006)</xref> explores the behavior of a similar model with <inline-formula><mml:math id="inf37"><mml:mrow><mml:msub><mml:mi>Ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>Ψ</mml:mi></mml:mrow></mml:math></inline-formula> constant over the full parameter space. Here we focus on a parameter regime that yields behavioral rules that match the experimental observations of <xref ref-type="bibr" rid="bib24">Katz et al. (2011)</xref> and <xref ref-type="bibr" rid="bib2">Berdahl et al. (2013)</xref>.</p><p>We simulate a discretized version of the system described by <xref ref-type="disp-formula" rid="equ3 equ4">Equations 3 and 4</xref>. In particular, we choose a time step, <inline-formula><mml:math id="inf38"><mml:mi>τ</mml:mi></mml:math></inline-formula>, within which the acceleration due to social influences (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) and resource value <inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> are assumed to be constant. Positions, speeds, and accelerations of all individuals at time <inline-formula><mml:math id="inf40"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:math></inline-formula> are then given by the solutions to <xref ref-type="disp-formula" rid="equ3 equ4">Equations 3 and 4</xref> at time <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:math></inline-formula>, with the values of <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf43"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> determined at time <inline-formula><mml:math id="inf44"><mml:mi>t</mml:mi></mml:math></inline-formula>. A navigational noise vector of small magnitude <inline-formula><mml:math id="inf45"><mml:mi>γ</mml:mi></mml:math></inline-formula> and uniform heading 0 to 2<inline-formula><mml:math id="inf46"><mml:mi>π</mml:mi></mml:math></inline-formula> is added to the velocity of each agent at each time step. Taking the limit as <inline-formula><mml:math id="inf47"><mml:mi>τ</mml:mi></mml:math></inline-formula> goes to zero means that individuals are constantly acquiring information and instantaneously altering their actions in response. In Appendix section 3−6, we analyze a continuum approximation of this limiting model and below we discuss results of this analysis alongside simulation results.</p><p>The social interaction rule allows us to build an interaction network for the entire population. Two individuals are socially connected if at least one of them influences the other through <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. We define a 'group' as a set of individuals that belong to the same connected component in this network.</p></sec><sec id="s2-2"><title>Evolutionary dynamics</title><p>The natural environments in which organisms live are often heterogeneous and dynamic (<xref ref-type="bibr" rid="bib37">Stephens et al., 2007</xref>). Consequently, we simulate populations of individuals in dynamic landscapes, where individuals make decisions in response to local sensory cues (local measurements of a resource) and these decisions have fitness consequences for the individuals within the population (<xref ref-type="bibr" rid="bib19">Guttal and Couzin, 2010</xref>; <xref ref-type="bibr" rid="bib40">Torney et al., 2011</xref>). In keeping with experimental observations (<xref ref-type="bibr" rid="bib2">Berdahl et al., 2013</xref>), we assume individuals follow a simple environmental response function: <inline-formula><mml:math id="inf48"><mml:mrow><mml:msub><mml:mi>Ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf49"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> dictates the <inline-formula><mml:math id="inf50"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual’s preferred speed when the level of the environmental cue is zero and <inline-formula><mml:math id="inf51"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> determines how sensitive the <inline-formula><mml:math id="inf52"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual is to the cue value (<xref ref-type="bibr" rid="bib2">Berdahl et al., 2013</xref>). Rather than prescribing values of <inline-formula><mml:math id="inf53"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf54"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, we use an evolutionary framework similar to that developed by <xref ref-type="bibr" rid="bib19">Guttal and Couzin (2010)</xref> to allow these two behavioral traits to evolve along with the maximum interaction length <inline-formula><mml:math id="inf55"><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, which determines whether individuals are social (<inline-formula><mml:math id="inf56"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo></mml:mrow></mml:math></inline-formula> length scale of social attraction) or asocial (<inline-formula><mml:math id="inf57"><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo></mml:math></inline-formula> length scale of social attraction, Appendix section 1).</p><p>In each generation, <inline-formula><mml:math id="inf58"><mml:mi>N</mml:mi></mml:math></inline-formula> individuals are located in a two-dimensional environment in which each point in space is associated with a resource value that changes over time (see Materials and methods). Individuals move through the environment using the interaction rules described above, and each individual has its own value of the <inline-formula><mml:math id="inf59"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf60"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf61"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> parameters. At the end of each generation, we compute each individual’s fitness as the mean value of the resource it experienced during that generation. Each individual then reproduces with a probability proportional to its relative fitness within the population. <inline-formula><mml:math id="inf62"><mml:mi>N</mml:mi></mml:math></inline-formula> offspring comprise the next generation where each offspring inherits the traits of its parent modified by a small mutation (Appendix section 2). For reference, we compare the evolution of populations in which <inline-formula><mml:math id="inf63"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf64"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf65"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are allowed to evolve, to the evolution of populations of asocial individuals, for which <inline-formula><mml:math id="inf66"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is set to a constant (Appendix section 1).</p></sec></sec><sec id="s3" sec-type="results"><title>Results</title><sec id="s3-1"><title>Evolution of behavioral rules</title><p>In populations of asocial individuals, the baseline speed parameter and environmental sensitivity increase consistently through evolutionary time (<xref ref-type="fig" rid="fig1">Figure 1A–B</xref>). Asocial individuals move through the environment, slowing down in regions where the resource value is high and speeding up when the resource value is low (<xref ref-type="other" rid="media1">Video 1</xref>). As one would expect from random walk theory (<xref ref-type="bibr" rid="bib34">Schnitzer, 1993</xref>; <xref ref-type="bibr" rid="bib18">Gurarie and Ovaskainen, 2013</xref>), individuals more rapidly encounter regions of the environment with high resource value when they travel at high preferred speeds (<xref ref-type="disp-formula" rid="equ74">Equation A65</xref>; <xref ref-type="bibr" rid="bib18">Gurarie and Ovaskainen, 2013</xref>), and the more they reduce speed in regions of the environment with high resource quality, the more time they spend in these regions (<xref ref-type="bibr" rid="bib34">Schnitzer, 1993</xref>). Because of these two effects, the fittest asocial individuals have high baseline speeds (i.e., high <inline-formula><mml:math id="inf67"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) and accelerate and decelerate rapidly in response to changes in the resource value (i.e., high <inline-formula><mml:math id="inf68"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>; <xref ref-type="fig" rid="fig1">Figure 1A–B</xref>, Appendix).<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.003</object-id><label>Figure 1.</label><caption><title>Evolution of behavioral rules.</title><p>(<bold>A, B</bold>) show evolutionary dynamics of populations of asocial individuals (i.e., maximum length scale of social interactions <inline-formula><mml:math id="inf69"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> fixed; see text). (<bold>C-E</bold>) show evolutionary dynamics of individuals in which the maximum length scale of social interactions <inline-formula><mml:math id="inf70"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is allowed to evolve. Brightness of color indicates the frequency of a phenotype in the population. In asocial populations, baseline speed parameter <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (<bold><bold>A</bold></bold>) and environmental sensitivity <inline-formula><mml:math id="inf72"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (<bold>B</bold>) increase continually through evolutionary time. When <inline-formula><mml:math id="inf73"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is allowed to evolve (<bold><bold>C</bold>)</bold>, individuals quickly become social (<inline-formula><mml:math id="inf74"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> approaches maximum allowable value of 30), and baseline speed parameter <inline-formula><mml:math id="inf75"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (<bold><bold>D</bold></bold>) and environmental sensitivity <inline-formula><mml:math id="inf76"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (<bold><bold>E</bold></bold>) stabilize at intermediate values. Mean fitness of social populations (<bold>F</bold>, red points) is over five times higher than mean fitness of asocial populations (<bold>F</bold>, blue points), and the coefficient of variation in fitness is over four times lower in social populations (<bold>F</bold> inset). Unless otherwise noted, parameter values in all figures are as follows: <inline-formula><mml:math id="inf77"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1.1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.13</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf80"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf81"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf82"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf83"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf84"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf85"><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.16</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf87"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf88"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf89"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>1,0</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="inf90"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf91"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1500</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.003">http://dx.doi.org/10.7554/eLife.10955.003</ext-link></p></caption><graphic xlink:href="elife-10955-fig1-v3.tif"/></fig><media content-type="glencoe play-in-place height-250 width-310" id="media1" mime-subtype="mp4" mimetype="video" xlink:href="elife-10955-media1.mp4"><object-id pub-id-type="doi">10.7554/eLife.10955.004</object-id><label>Video 1.</label><caption><title>Asocial population.</title><p>Responses of population of asocial individuals (points) and dynamic resource peak (resource value shown in grayscale; dark regions have high resource value, light regions have low resource value). Length of tail proportional to speed. Peak centroid moves according to 2D Brownian motion with drift vector <inline-formula><mml:math id="inf92"><mml:mi>α</mml:mi></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf93"><mml:mi>β</mml:mi></mml:math></inline-formula> (see Materials and methods). In <xref ref-type="other" rid="media1">Videos 1</xref>–<xref ref-type="other" rid="media4">4</xref>, view is zoomed in to area surrounding moving resource peak (field of view is <inline-formula><mml:math id="inf94"><mml:mrow><mml:mn>50</mml:mn><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>50</mml:mn><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf95"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the length scale of repulsion; full environment is projected onto a torus with edge length <inline-formula><mml:math id="inf96"><mml:mrow><mml:mn>346</mml:mn><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>). Behavioral parameters as follows: <inline-formula><mml:math id="inf97"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1.1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf98"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf99"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf100"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>7.5</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf103"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf105"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf106"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2.54</mml:mn></mml:mrow></mml:math></inline-formula>. Environmental parameters in <xref ref-type="other" rid="media1">Videos 1</xref>–<xref ref-type="other" rid="media4">4 </xref>are: <inline-formula><mml:math id="inf107"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.16</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf110"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf111"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf112"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mn>0.06</mml:mn><mml:mo> </mml:mo><mml:mn>0</mml:mn><mml:mo>]</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="inf113"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.004">http://dx.doi.org/10.7554/eLife.10955.004</ext-link></p></caption></media></p><p>When populations are allowed to evolve sociality, the evolutionary process selects for very different behaviors (<xref ref-type="fig" rid="fig1">Figure 1C–E</xref>). Selection quickly favors sociality, and individuals evolve large maximum interaction lengths (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Over evolutionary time, selection removes individuals with high and low values of <inline-formula><mml:math id="inf114"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf115"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> from the population and an evolutionarily stable state (ESSt; <xref ref-type="bibr" rid="bib36">Maynard Smith, 1982</xref>) emerges that is characterized by a single mode at the dominant value of each trait (<xref ref-type="fig" rid="fig1">Figure 1D–E</xref>; Appendix section 2). The ESSt resulting from selection on <inline-formula><mml:math id="inf116"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf117"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf118"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is robust in that it is resistant to invasion by phenotypes near the ESSt, and by invaders with trait values far from the ESSt (Appendix section 2). Throughout evolution, populations of social individuals achieve mean fitness values that are approximately five times higher than those of asocial populations, and a coefficient of variation in fitness approximately four times lower than that of asocial individuals (<xref ref-type="fig" rid="fig1">Figure 1F</xref>).</p><p>Notably, a single individual drawn from a population at the ESSt can invade a resident population of asocial individuals and the social strategy quickly sweeps through the population (Appendix section 2). To understand why this invasion occurs, consider a population of asocial individuals that slow down in favorable regions of the environment. If the environment does not change too rapidly, such individuals will accumulate in regions where the resource level is high. This phenomenon has been studied mathematically in the context of position-dependent diffusion (<xref ref-type="bibr" rid="bib34">Schnitzer, 1993</xref>), and will occur, in general, when individuals lower their speeds in response to the value of an environmental cue. A social mutant that responds to the environment, and to its neighbors, can take advantage of the correlation between density and resource quality by climbing the gradient in the density of its neighbors (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). In this case, the positions of neighbors contain information about the value of resources and social mutants quickly invade asocial populations leading to a rapid increase in mean fitness (Appendix section 2).</p></sec><sec id="s3-2"><title>Evolved populations collectively compute properties of the environment</title><p>The high fitness of the evolved phenotype is due, in part, to a collective resource tracking ability, similar to that found in golden shiners (<xref ref-type="bibr" rid="bib2">Berdahl et al., 2013</xref>). Evolved individuals can find and track resource peaks as they move through the environment (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="other" rid="media2">Video 2</xref>; Materials and methods), whereas asocial individuals and social individuals with trait values far from the ESSt cannot (<xref ref-type="other" rid="media1">Videos 1</xref>, <xref ref-type="other" rid="media3">3</xref>–<xref ref-type="other" rid="media4">4</xref>). Tracking occurs via a dynamic process. Individuals near the edge of the peak move rapidly, whereas individuals nearer to the peak center (where the resource value is high) move slowly (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>). As in fish schools (<xref ref-type="bibr" rid="bib2">Berdahl et al., 2013</xref>), individuals turn toward near neighbors (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) and travel toward the peak center. This collective tracking behavior is particularly important when the resource field changes rapidly over time. As a resource peak moves, individuals at its trailing edge experience a resource value that becomes weaker through time (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). As the resource value becomes weaker, these individuals accelerate (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>), but turn toward neighbors on the peak (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) and thus travel toward the moving peak (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). When the environment contains multiple resource peaks, evolved populations fuse spontaneously to form groups whose sizes correspond to that of the peak they are tracking (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), even though no individual is able to assess peak size, or know whether there are multiple peaks in the environment. This behavior is consistent with recent sonar observations of foraging marine fish showing that fish form shoals that match the sizes of dynamic resource patches (<xref ref-type="bibr" rid="bib3">Bertrand et al., 2008</xref>; <xref ref-type="bibr" rid="bib4">Bertrand et al., 2014</xref>). Our model demonstrates that collective tracking behavior similar to that observed in real fish schools can evolve through selection on the decision rules of individuals.<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.005</object-id><label>Figure 2.</label><caption><title>Collective tracking of dynamic resource and length-scale matching.</title><p>(<bold><bold>A</bold></bold>) Sequence (left to right, top to bottom) of individuals interacting with moving resource peak (resource value in grayscale, darker = higher resource value). Peak is drifting to the right (grey arrow). Colors indicate the regime into which each agent falls (red: <inline-formula><mml:math id="inf119"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2.95</mml:mn></mml:mrow></mml:math></inline-formula>, blue: <inline-formula><mml:math id="inf120"><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>Ψ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2.95</mml:mn></mml:math></inline-formula>, green: <inline-formula><mml:math id="inf121"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). Length of tail is proportional to speed. Peak centroid moves according to 2D Brownian motion with drift (see Materials and methods). (<bold><bold>B</bold></bold>) When environments contain multiple resource peaks, evolved populations divide into groups that match peak sizes, e.g., in a two-peak environment, the size of group on each peak is proportional to peak size. Total size of two peaks is constant so that the larger the first peak (Peak 1, x-axis), the smaller the second peak. Peak size computed as the integral of the resource value over the entire peak (see Materials and methods). Group size is mean size of the group nearest each peak (mean taken over the last 2,500 time steps of each simulation). Points (and error bars) represent mean (<inline-formula><mml:math id="inf122"><mml:mo>±</mml:mo></mml:math></inline-formula> 2 standard errors) of 1,000 simulations for each combination of peak sizes. Parameters as in <xref ref-type="fig" rid="fig1">Figure 1</xref> with <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and values of <inline-formula><mml:math id="inf124"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf125"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf126"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>m</mml:mtext><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> taken from a population in the ESSt.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.005">http://dx.doi.org/10.7554/eLife.10955.005</ext-link></p></caption><graphic xlink:href="elife-10955-fig2-v3.tif"/></fig><media content-type="glencoe play-in-place height-250 width-310" id="media2" mime-subtype="mp4" mimetype="video" xlink:href="elife-10955-media2.mp4"><object-id pub-id-type="doi">10.7554/eLife.10955.006</object-id><label>Video 2.</label><caption><title>Population at the evolutionarily stable state (ESSt).</title><p>Responses of population of individuals evolved for 1500 generations to the ESSt to dynamic resource peaks. Behavioral parameters as in <xref ref-type="other" rid="media1">Video 1</xref> with <inline-formula><mml:math id="inf127"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf128"><mml:mo>⟨</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⟩</mml:mo><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf129"><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⟩</mml:mo><mml:mo>=</mml:mo><mml:mn>2.45</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf130"><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>⟩</mml:mo><mml:mo>=</mml:mo><mml:mn>29</mml:mn></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf131"><mml:mrow><mml:mo>⟨</mml:mo><mml:mo>⋅</mml:mo><mml:mo>⟩</mml:mo></mml:mrow></mml:math></inline-formula> denotes mean over the population. Note rapid accumulation of individuals near peaks and dynamic peak-tracking behavior of groups.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.006">http://dx.doi.org/10.7554/eLife.10955.006</ext-link></p></caption></media></p></sec><sec id="s3-3"><title>Evolved populations are poised near abrupt transitions in collective state</title><p>That individuals in evolutionarily stable populations have intermediate baseline speeds and intermediate environmental sensitivities (<xref ref-type="fig" rid="fig1">Figure 1D–E</xref>) raises a question: what determines the evolutionarily stable values of these traits? It is tempting to conclude that these trait values are determined by the nature of the environment alone. However, the fact that the evolutionary trajectories of social and asocial populations are so different (<xref ref-type="fig" rid="fig1">Figure 1</xref>), suggests that the collective behaviors discussed above strongly influence the outcome of evolution. Analysis of <xref ref-type="disp-formula" rid="equ1 equ2 equ3 equ4">Equations 1–4</xref> reveals that the preferred speed parameter divides the dynamical behavior of populations into distinct collective states (<xref ref-type="fig" rid="fig3">Figure 3</xref>; analysis in Appendix section 5). For <inline-formula><mml:math id="inf132"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, individuals have a preferred speed of zero and the inter-individual distances are governed by initial conditions. In this state, individuals resist acceleration due to social interactions. For small <inline-formula><mml:math id="inf133"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, individuals form relatively dense groups that move through the environment as collectives, either milling, swarming, or translating (<xref ref-type="bibr" rid="bib16">D’Orsogna et al., 2006</xref>), the collective motions exhibited by real schooling fish (<xref ref-type="bibr" rid="bib41">Tunstrøm et al., 2013</xref>). Individual speeds are relatively low and inter-individual distances are short. For large <inline-formula><mml:math id="inf134"><mml:mi>Ψ</mml:mi></mml:math></inline-formula>, inter-individual distances are large, and individuals move through the environment quickly. Dynamic changes among theses states are evident in <xref ref-type="other" rid="media2">Video 2</xref>. These collective states are also clearly distinguishable in <xref ref-type="fig" rid="fig3">Figure 3</xref> (<inline-formula><mml:math id="inf135"><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>Ψ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1.6</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf136"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2.9</mml:mn></mml:mrow></mml:math></inline-formula>) and <xref ref-type="fig" rid="fig15">Appendix Figure 9</xref> (<inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), and are separated by abrupt changes in the distances between near neighbors (the inverse of local density, <xref ref-type="fig" rid="fig3">Figure 3</xref>) or potential energy (<xref ref-type="fig" rid="fig15">Appendix Figure 9</xref>). The location of transitions between states depends on the parameters of the social response rule (e.g., number of neighbors an individual pays attention to <inline-formula><mml:math id="inf138"><mml:mi>k</mml:mi></mml:math></inline-formula>; <xref ref-type="fig" rid="fig4">Figure 4</xref>). The transitional regimes between these states are reminiscent of the first-order phase transitions that occur in some physical systems, for example at the transition between liquid water and water vapor. As in the liquid-vapor phase transition, transitions in collective state are characterized by strong hysteresis (<xref ref-type="fig" rid="fig3">Figure 3</xref>). If the population begins with large <inline-formula><mml:math id="inf139"><mml:mi>Ψ</mml:mi></mml:math></inline-formula>, mean distance to neighbors remains stable for decreasing <inline-formula><mml:math id="inf140"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> and then decreases abruptly (<xref ref-type="fig" rid="fig3">Figure 3</xref>, <xref ref-type="fig" rid="fig15">Appendix Figure 9</xref> upper curve). If <inline-formula><mml:math id="inf141"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> is then increased, mean distance to neighbors increases but follows a different functional relationship with <inline-formula><mml:math id="inf142"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3</xref>, lower curve). We refer to the collective states as <italic>station-keeping</italic> (<inline-formula><mml:math id="inf143"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>; see <xref ref-type="fig" rid="fig15">Appendix Figure 9</xref>), <italic>cohesive</italic> (small <inline-formula><mml:math id="inf144"><mml:mi>Ψ</mml:mi></mml:math></inline-formula>), and <italic>dispersed</italic> (large <inline-formula><mml:math id="inf145"><mml:mi>Ψ</mml:mi></mml:math></inline-formula>). The analogy between transitions in collective state in our system and first order phase transitions in physical systems can be made more precise by analyzing the formation rate of groups when <inline-formula><mml:math id="inf146"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> is in the hysteresis region. In the hysteresis region, the rate at which groups of individuals form spontaneously (and therefore nucleate a transition from the <italic>dispersed</italic> to <italic>cohesive</italic> state) depends strongly on <inline-formula><mml:math id="inf147"><mml:mi>Ψ</mml:mi></mml:math></inline-formula>; when <inline-formula><mml:math id="inf148"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> is near the upper bound of the hysteresis region, the time required for a group to form spontaneously is very long (see Appendix section 5.4). From a thermodynamic perspective, this makes the spontaneous formation of groups extremely unlikely, which explains why populations that begin in the <italic>dispersed</italic> state follow the upper branch of the hysteresis curve shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>.<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.007</object-id><label>Figure 3.</label><caption><title>Hysteresis plot of the distance to 10 nearest neighbors, averaged over the entire population <inline-formula><mml:math id="inf149"><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>10</mml:mn><mml:mtext>N</mml:mtext><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>⟩</mml:mo></mml:mrow></mml:math></inline-formula> (points and error bars) as a function of preferred speed parameter <inline-formula><mml:math id="inf150"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> in a uniform environment.</title><p>Figure produced by starting with a population with <inline-formula><mml:math id="inf151"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> in a uniform environment. Population is allowed to equilibrate for 5000 time steps and <inline-formula><mml:math id="inf152"><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>10</mml:mn><mml:mtext>N</mml:mtext><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>⟩</mml:mo></mml:mrow></mml:math></inline-formula> is then computed. <inline-formula><mml:math id="inf153"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> is then lowered. This process is repeated until <inline-formula><mml:math id="inf154"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, at which point the same procedure is used to increase <inline-formula><mml:math id="inf155"><mml:mi>Ψ</mml:mi></mml:math></inline-formula>. Upper curve corresponds to decreasing <inline-formula><mml:math id="inf156"><mml:mi>Ψ</mml:mi></mml:math></inline-formula>. Lower curve corresponds to increasing <inline-formula><mml:math id="inf157"><mml:mi>Ψ</mml:mi></mml:math></inline-formula>. Regimes where <inline-formula><mml:math id="inf158"><mml:mi>Ψ</mml:mi><mml:mo>~</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf159"><mml:mi>Ψ</mml:mi><mml:mo>∈</mml:mo><mml:mo>(</mml:mo><mml:mn>1.6,2.95</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> correspond to transitions between collective states. Points and (error bars) correspond to mean (<inline-formula><mml:math id="inf160"><mml:mo>±</mml:mo></mml:math></inline-formula> 2 standard errors) of 50 replicate simulations. Parameters as in <xref ref-type="fig" rid="fig1">Figure 1</xref> with <inline-formula><mml:math id="inf161"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.007">http://dx.doi.org/10.7554/eLife.10955.007</ext-link></p></caption><graphic xlink:href="elife-10955-fig3-v3.tif"/></fig><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.008</object-id><label>Figure 4.</label><caption><title>Evolved populations are positioned near transitions in collective state.</title><p>Upper panels show mean distance to 10 nearest neighbors (<inline-formula><mml:math id="inf162"><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>10</mml:mn><mml:mtext>N</mml:mtext><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>⟩</mml:mo></mml:mrow></mml:math></inline-formula>, color scale) from simulated populations. A separate populations is simulated in a uniform environment for each value of the social attraction strength (<inline-formula><mml:math id="inf163"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>), number of neighbors an individual reacts to (<inline-formula><mml:math id="inf164"><mml:mi>k</mml:mi></mml:math></inline-formula>), and the decay length of social attraction (<inline-formula><mml:math id="inf165"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) parameters. Red is low density corresponding to <italic>dispersed</italic> state, and blue is high density corresponding to <italic>cohesive</italic> state. Points show the mean value of <inline-formula><mml:math id="inf166"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> of populations in the EESt (populations evolved for 1,000 generations in an environment with dynamic resource peaks). Evolved populations are positioned near transition between <italic>cohesive</italic> and <italic>dispersed</italic> states. Lower panels are based on analytical calculations and show the predicted regions in which the <italic>dispersed</italic> state is stable (white) and unstable (black, Appendix section 5). Parameters as in <xref ref-type="fig" rid="fig1">Figure 1</xref> with <inline-formula><mml:math id="inf167"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf168"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf169"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.6</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf170"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>1,0</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="inf171"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf172"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1500</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.008">http://dx.doi.org/10.7554/eLife.10955.008</ext-link></p></caption><graphic xlink:href="elife-10955-fig4-v3.tif"/></fig></p><p>For a wide variety environmental conditions (Appendix section 2) and social parameters (<xref ref-type="fig" rid="fig4">Figure 4</xref>), the evolutionarily stable trait values have a notable feature: the evolved values of the baseline speed parameter, <inline-formula><mml:math id="inf173"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, place individuals in the population slightly above the transition between <italic>cohesive</italic> and <italic>dispersed</italic> states when <inline-formula><mml:math id="inf174"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4</xref>, upper panels, <xref ref-type="fig" rid="fig5">Figure 5</xref>; points in both figures show mean <inline-formula><mml:math id="inf175"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> values of population in the ESSt), and the evolved environmental sensitivity, <inline-formula><mml:math id="inf176"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, is large enough that locally, groups of individuals cross from the <italic>dispersed</italic> state through the <italic>cohesive</italic> and <italic>station-keeping</italic> states in regions of the environment where the resource value is high (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, colors indicate instantaneous value of <inline-formula><mml:math id="inf177"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> for each individual). In other words, the evolved values of <inline-formula><mml:math id="inf178"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf179"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> allow local subpopulations to undergo sudden changes from one collective state to another in the proximity of favorable regions of the environment. Importantly, the approximate location of the transition between <italic>cohesive</italic> and <italic>dispersed</italic> states can be predicted by directly analyzing <xref ref-type="disp-formula" rid="equ1 equ2 equ3 equ4">Equations 1–4</xref> without considering details of the environment, or the mapping between behavior and fitness (<xref ref-type="fig" rid="fig4">Figure 4</xref> compare upper panels [simulation] to lower panels [analytical prediction]). While the precise evolutionarily stable values of <inline-formula><mml:math id="inf180"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> depend on the parameters of the environment (Appendix section 2), the evolutionarily stable values of <inline-formula><mml:math id="inf181"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> place the population near the <italic>cohesive-dispersed</italic> transition in many different kinds of environments (<xref ref-type="fig" rid="fig11">Appendix Figure 5</xref>). As we show below, being near this transition allows groups to respond quickly to changes in the environment. Our results demonstrate, that such locations in behavioral state-space are, in fact, evolutionary attractors.<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.009</object-id><label>Figure 5.</label><caption><title>Mean distance to nearest neighbors <inline-formula><mml:math id="inf182"><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>10</mml:mn><mml:mtext>N</mml:mtext><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>⟩</mml:mo></mml:mrow></mml:math></inline-formula> (curves) and ESSt value of <inline-formula><mml:math id="inf183"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (points) as a function of social parameters.</title><p>Points denote mean ESSt value of <inline-formula><mml:math id="inf184"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Note abrupt transitions in density as function of <inline-formula><mml:math id="inf185"><mml:mi>Ψ</mml:mi></mml:math></inline-formula>, as shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>. In all cases, ESSt value of <inline-formula><mml:math id="inf186"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> causes populations to cross transition when resource value is high (i.e., <inline-formula><mml:math id="inf187"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf188"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is maximum resource value of each peak). Densities and ESSt values generated as described in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.009">http://dx.doi.org/10.7554/eLife.10955.009</ext-link></p></caption><graphic xlink:href="elife-10955-fig5-v3.tif"/></fig></p><p>The evolutionary results presented in <xref ref-type="fig" rid="fig1">Figure 1</xref> assume that individuals do not appreciably deplete the resource. We can explore an alternative scenario in which resource peaks are depleted through consumption (Appendix section 2.8). In that case, the <inline-formula><mml:math id="inf189"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual consumes resources at a rate <inline-formula><mml:math id="inf190"><mml:mrow><mml:mi>u</mml:mi><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle><mml:mstyle><mml:mi>i</mml:mi></mml:mstyle></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> per time step. We repeated evolutionary simulations assuming either a high or low rate of resource consumption <inline-formula><mml:math id="inf191"><mml:mi>u</mml:mi></mml:math></inline-formula>. For high consumption rate (100 individuals can deplete a peak in roughly five time steps), <inline-formula><mml:math id="inf192"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> still increases so that individuals are attracted to one another through social interactions, but selection for large <inline-formula><mml:math id="inf193"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is much weaker than the case shown in <xref ref-type="fig" rid="fig1">Figure 1C</xref> (see <xref ref-type="fig" rid="fig13">Appendix Figure 7</xref>). Moreover, <inline-formula><mml:math id="inf194"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf195"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> increase continually through evolutionary time. This result is intuitive because when resources are depleted rapidly, the locations of neighbors convey little information about the future location of resources and transitioning from the <italic>dispersed</italic> to <italic>cohesive</italic> state may actually be maladaptive. By contrast, when individuals consume the resource at a more moderate rate (<xref ref-type="fig" rid="fig13">Appendix Figure 7</xref>), evolutionary trajectories parallel the trajectory shown in <xref ref-type="fig" rid="fig1">Figure 1C–E</xref>; there is strong selection for high <inline-formula><mml:math id="inf196"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf197"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> reaches a stable value that is situated directly above the hysteresis region shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>, and <inline-formula><mml:math id="inf198"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> evolves to a stable value that is large enough to allow individuals to cross from <italic>dispersed</italic> to <italic>cohesive</italic>, and <italic>station-keeping</italic> states in regions of the environment where the resource value is high.</p></sec><sec id="s3-4"><title>Changes in collective state allow for rapid collective computation of the resource distribution</title><p>Why do populations of selfish individuals evolve behavioral rules that place them near the transition between collective states? <italic>Dispersed, cohesive</italic>, and <italic>station-keeping</italic> states are each associated with a characteristic density (low, intermediate, and high, respectively; <xref ref-type="fig" rid="fig3">Figure 3</xref>, <xref ref-type="fig" rid="fig15">Appendix Figure 9</xref>). If individuals enter the <italic>cohesive</italic> and <italic>station-keeping</italic> states where the resource level is high, the density of individuals becomes strongly correlated with the resource distribution (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). The similarity between the distribution of individuals and the distribution of the resource can be quantified by the Kullback-Leibler divergence (KL divergence), an information-theoretic concept that measures the distance between two distributions (<xref ref-type="fig" rid="fig6">Figure 6A</xref> inset). Though individuals cannot sense resource gradients, they can detect gradients in the density of their neighbors (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>), and can therefore move up the resource gradient.<fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.010</object-id><label>Figure 6.</label><caption><title>Collective computation and social gradient climbing.</title><p>(<bold><bold>A</bold></bold>) Collective computation of the resource distribution (grayscale represents resource value, normalized to maximum of 1). Curves show local density of individuals at different distances from the resource peak center (maximum value also normalized to 1). Note the rapid accumulation of individuals near the peak center. The distribution of individuals becomes increasingly concentrated in the region where the resource level is highest; inset shows that the Kullback-Leibler divergence between the resource distribution and the local density of individuals decreases through time as the two distributions become more similar. (<bold><bold>B</bold></bold>) Number of individuals near peak center (within one decay length, <inline-formula><mml:math id="inf199"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, of peak center) as a function of time. Red and blue points and confidence bands represent means <inline-formula><mml:math id="inf200"><mml:mrow><mml:mo>±</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> sd. for 100 replicate simulations. Red points and band is ESSt population and blue points and band is an asocial population with the same parameter values. Curves are analytical predictions based on <xref ref-type="disp-formula" rid="equ3 equ4">Equations 3 and 4</xref> (Appendix section 6).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.010">http://dx.doi.org/10.7554/eLife.10955.010</ext-link></p></caption><graphic xlink:href="elife-10955-fig6-v3.tif"/></fig></p><p>The abrupt transitions in the density of individuals between <italic>dispersed</italic> and <italic>cohesive</italic> states (<xref ref-type="fig" rid="fig3">Figure 3</xref>) mean that there is a strong density gradient in regions of the environment where individuals in the <italic>dispersed</italic> state border individuals in the <italic>cohesive</italic> state (e.g., <xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="fig" rid="fig6">6A</xref>, <xref ref-type="other" rid="media2">Video 2</xref>). This suggests that the behavior of an individual in this region can be approximated by considering only its interactions with individuals that are on the resource peak (i.e., where density is high). Using this assumption, we derive analytically the rate at which new individuals join (or rejoin) a group on the resource peak (Appendix section 6.5). Asocial individuals arrive at a resource peak at a rate <inline-formula><mml:math id="inf201"><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf202"><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a constant (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, blue curves and points; <xref ref-type="disp-formula" rid="equ74">Equation A65</xref>). However, social individuals initially arrive at a rate that increases as more individuals reach the peak, such that the number of individuals on the peak, <inline-formula><mml:math id="inf203"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, increases exponentially with time: <inline-formula><mml:math id="inf204"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mn>,1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mn>,2</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf205"><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mn>,1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf206"><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mn>,2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are positive constants (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, red curves and points; <xref ref-type="disp-formula" rid="equ77 equ78 equ79">Equation A68–A70</xref>). Analytical calculations (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, solid lines) agree well with results of numerical simulations (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, points and confidence bands). The rapid accumulation shown in <xref ref-type="fig" rid="fig6">Figure 6</xref> is especially important when the environment changes quickly with time; it allows groups to respond swiftly to changes in the resource field and enables the emergent resource tracking behavior described above.</p><p>The form of <xref ref-type="disp-formula" rid="equ3 equ4">Equations (3–4)</xref> implies that an individual’s behavioral response combines personal information about the environment (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>) with social cues (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). In fact, under a time rescaling, our model is equivalent to one in which the relative strength of social forces varies across the environment (Appendix section 4). The tradeoff between using social information and personal information is inherent in social decision-making (<xref ref-type="bibr" rid="bib11">Couzin et al., 2005</xref>; <xref ref-type="bibr" rid="bib10">Couzin, et al., 2011</xref>). This tradeoff means that individuals with large <inline-formula><mml:math id="inf207"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf208"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are, by default, less responsive to their neighbors. Perturbing the values of <inline-formula><mml:math id="inf209"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf210"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> of individuals in populations at the ESSt show that, in populations with high mean <inline-formula><mml:math id="inf211"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, individuals fail to form large groups and are poor at tracking resource peaks (Appendix section 2.6, <xref ref-type="fig" rid="fig12">Appendix Figure 6</xref>). In populations with high mean values of <inline-formula><mml:math id="inf212"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, individuals form groups (Appendix section 2.7), but fail to exploit regions with the highest resource quality. Individuals with low values of <inline-formula><mml:math id="inf213"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf214"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> form groups but do not effectively track dynamic resources (Appendix section 2.7).</p></sec></sec><sec id="s4" sec-type="discussion"><title>Discussion</title><p>Our model demonstrates that selection on the behavioral phenotypes of selfish individuals can lead to the rapid evolution of distributed sensing and collective computation. The mechanism that promotes this evolution involves the use of public information: when individuals respond to the environment by slowing down in regions of high resource quality – a behavior that is adaptive even in the absence of social interactions (<xref ref-type="fig" rid="fig8">Appendix Figure 2</xref>) – their positions become correlated with the locations of resources. Social individuals can exploit this public information by climbing gradients in the density of their neighbors. As in simple, game-theoretic models of social foraging (e.g., <xref ref-type="bibr" rid="bib8">Clark and Mangel, 1984</xref>), social individuals gain a fitness advantage by using information about the environment gleaned by observing neighbors. Because of this, asocial populations are readily invaded by social mutants and collective behaviors evolve (Appendix section 2).</p><p>Evolutionarily stable populations occupy a distinctive location in behavioral state space: one in which small changes in individual behavior cause large changes in collective state (<xref ref-type="fig" rid="fig4">Figures 4</xref>, <xref ref-type="fig" rid="fig5">5</xref>). When individuals respond to local environmental cues by accelerating or decelerating, local populations transition between the collective states shown in <xref ref-type="fig" rid="fig3">Figure 3</xref> (e.g. <xref ref-type="fig" rid="fig2">Figure 2A</xref>). This creates the strong spatial gradient in population density (<xref ref-type="fig" rid="fig6">Figure 6A</xref>) and allows groups to track dynamic features in the environment rapidly. Perturbations of this evolutionarily stable state cause individuals either to weigh social information too heavily (i.e., small <inline-formula><mml:math id="inf215"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and/or <inline-formula><mml:math id="inf216"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>), in which case groups fail to explore effectively (<xref ref-type="other" rid="media3">Video 3</xref>, <xref ref-type="fig" rid="fig13">Appendix Figure 7</xref>), or to weigh personal information too heavily (i.e., large <inline-formula><mml:math id="inf217"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and/or <inline-formula><mml:math id="inf218"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>), in which case individuals fail to exploit the social information that enables dynamic resource tracking (<xref ref-type="other" rid="media4">Video 4</xref>, <xref ref-type="fig" rid="fig13">Appendix Figure 7</xref>). Because of this, mutants with phenotypes far from the evolutionarily stable state are removed from the population by natural selection. The transitions we observe in collective state bear a resemblance to phase transitions in physical systems, and our results lend credence to the hypothesis that natural selection can result in the evolution of biological systems that are poised near such bifurcation points in parameter space. Importantly, we show that these high-fitness regions of parameter space can be predicted <italic>a priori</italic> from the structure of individual decision rules, even without knowledge of the environment.<media content-type="glencoe play-in-place height-250 width-310" id="media3" mime-subtype="mp4" mimetype="video" xlink:href="elife-10955-media3.mp4"><object-id pub-id-type="doi">10.7554/eLife.10955.011</object-id><label>Video 3.</label><caption><title>Population with mean <inline-formula><mml:math id="inf219"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> below the ESSt value.</title><p>Responses of perturbed ESSt population to dynamic resource peaks. All parameters as in <xref ref-type="other" rid="media2">Video 2</xref> except that each individual’s value of <inline-formula><mml:math id="inf220"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> parameter is lowered so that the population mean <inline-formula><mml:math id="inf221"><mml:mo>⟨</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⟩</mml:mo><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:math></inline-formula>. Note swarms of individuals form in regions of the environment that are far from resource peaks. Individuals explore poorly and therefore have low fitnesses.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.011">http://dx.doi.org/10.7554/eLife.10955.011</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="media4" mime-subtype="mp4" mimetype="video" xlink:href="elife-10955-media4.mp4"><object-id pub-id-type="doi">10.7554/eLife.10955.012</object-id><label>Video 4.</label><caption><title>Population with mean <inline-formula><mml:math id="inf222"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> above the ESSt value.</title><p>Responses of perturbed ESSt population to dynamic resource peaks. All parameters as in <xref ref-type="other" rid="media2">Video 2</xref> except that each individual’s value of <inline-formula><mml:math id="inf223"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> parameter is increased so that the population mean <inline-formula><mml:math id="inf224"><mml:mo>⟨</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⟩</mml:mo><mml:mo>=</mml:mo><mml:mn>8.8</mml:mn></mml:math></inline-formula>. Note that individuals do not form large groups near resource peaks and fail to track peaks as they move.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.012">http://dx.doi.org/10.7554/eLife.10955.012</ext-link></p></caption></media></p><p>Collective computation is a notion that has strongly motivated research on animal groups (<xref ref-type="bibr" rid="bib2">Berdahl et al., 2013</xref>; <xref ref-type="bibr" rid="bib9">Couzin, 2007</xref>; <xref ref-type="bibr" rid="bib14">Cvikel, et al., 2015</xref>). In our model, populations perform a collective computation through their social and environmental response rules. When individuals are exposed to a heterogeneous resource environment, their responses to the environment cause a modification of the local population density; individuals aggregate in regions where the resource cue is strong. The population performs a physical computation in the formal sense (<xref ref-type="bibr" rid="bib35">Schnitzer, 2002</xref>): physical variables – the positions and relative densities of neighbors – represent mathematical ones – spatially resolved estimates of the quality of resources in the environment. The environments considered in our study bear a strong resemblance to those encountered in dynamic coverage problems in distributed control theory (<xref ref-type="bibr" rid="bib1">Bachmayer and Leonard, 2002</xref>), dynamic optimization problems (<xref ref-type="bibr" rid="bib28">Passino, 2002</xref>), and Monte Carlo parameter estimation (<xref ref-type="bibr" rid="bib27">McKay, 2003</xref>). Combining an evolutionary approach to algorithm design with collective interactions may therefore be a useful starting point for optimization schemes or control algorithms for autonomous vehicles, particularly if the structure of social interactions leads to bifurcation points in behavioral parameter space as in the model studied here.</p><p>Understanding the feedback loop between individual behavior, collective behavior of populations, and selection on individual fitness is a major challenge in evolutionary theory (<xref ref-type="bibr" rid="bib19">Guttal and Couzin, 2010</xref>; <xref ref-type="bibr" rid="bib40">Torney et al., 2011</xref>; <xref ref-type="bibr" rid="bib31">Pruitt and Goodnight, 2014</xref>). Our framework closes this loop and demonstrates how distributed sensing and collective computation can evolve through natural selection on the decision rules of selfish individuals.</p></sec><sec id="s5" sec-type="materials|methods"><title>Materials and methods</title><sec id="s5-1"><title>Resource environment</title><p>Our model of the resource environment incorporates three salient features of the resource environments that schooling fish and other social foragers encounter in nature. These features are: 1) spatial variation in resource quality, 2) temporal variation in resource quality, and 3) characteristic length scales of resource patches (<xref ref-type="bibr" rid="bib37">Stephens et al., 2007</xref>; <xref ref-type="bibr" rid="bib3">Bertrand et al., 2008</xref>; <xref ref-type="bibr" rid="bib4">Bertrand et al., 2014</xref>). Accordingly, we model a two-dimensional environment in which the resource is distributed as a set of <inline-formula><mml:math id="inf225"><mml:mi>M</mml:mi></mml:math></inline-formula> resource peaks. We assume the boundary of the environment is periodic such that individuals, inter-individual potentials, and resource peaks are all projected onto a torus. Each of the <inline-formula><mml:math id="inf226"><mml:mi>M</mml:mi></mml:math></inline-formula> peaks decays like a Gaussian with increasing distance to the peak center. The value of the resource in a single peak at a location, <inline-formula><mml:math id="inf227"><mml:mstyle><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mstyle></mml:math></inline-formula>, is given by</p><p><disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mrow></mml:msup><mml:mn>,</mml:mn></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf228"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is a constant that determines the resource value at the peak center and <inline-formula><mml:math id="inf229"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is a decay length parameter, and <inline-formula><mml:math id="inf230"><mml:mstyle><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mstyle></mml:math></inline-formula> is the location of the centroid of the peak of interest. The total resource value the <inline-formula><mml:math id="inf231"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual experiences <inline-formula><mml:math id="inf232"><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> is the sum over all peaks in the environment. Each peak moves according to Brownian motion with drift vector <inline-formula><mml:math id="inf233"><mml:mi>α</mml:mi></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf234"><mml:mi>β</mml:mi></mml:math></inline-formula>. At each time step, each peak has a probability <inline-formula><mml:math id="inf235"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> of disappearing and reappearing at a new location, chosen at random from all locations in the environment.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>This work was partially supported by National Science Foundation (NSF) Grants PHY-0848755, IOS-1355061, and EAGER IOS-1251585; Office of Naval Research Grants N00014-09-1-1074 and N00014-14-1-0635; Army Research Office Grants W911NG-11-1-0385 and W911NF-14-1-0431; Human Frontier Science Program Grant RGP0065/2012 (to I.D.C.), NSF Dimensions of Biodiversity grant OCE-1046001, and a James S McDonnell Foundation Fellowship (to A.M.H.).</p></ack><sec id="s6" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf2"><p>IDC: Reviewing editor, <italic>eLife.</italic></p></fn><fn fn-type="conflict" id="conf1"><p>The other authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>AMH, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>SBR, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>GIH, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con4"><p>AB, Conception and design, Drafting or revising the article</p></fn><fn fn-type="con" id="con5"><p>CJT, Conception and design, Drafting or revising the article</p></fn><fn fn-type="con" id="con6"><p>IDC, Conception and design, Drafting or revising the article</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bachmayer</surname><given-names>R</given-names></name><name><surname>Leonard</surname><given-names>NE</given-names></name></person-group><year iso-8601-date="2002">2002</year><chapter-title>Vehicle networks for gradient descent in a sampled environment</chapter-title><source>Proceedings of 41st IEEE Conf. on Decision and Control</source><fpage>112</fpage><lpage>117</lpage></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berdahl</surname><given-names>A</given-names></name><name><surname>Torney</surname><given-names>CJ</given-names></name><name><surname>Ioannou</surname><given-names>CC</given-names></name><name><surname>Faria</surname><given-names>JJ</given-names></name><name><surname>Couzin</surname><given-names>ID</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Emergent sensing of complex environments by mobile animal groups</article-title><source>Science</source><volume>339</volume><fpage>513</fpage><lpage>516</lpage><pub-id pub-id-type="doi">10.1126/science.1225883</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bertrand</surname><given-names>A</given-names></name><name><surname>Gerlotto</surname><given-names>F</given-names></name><name><surname>Bertrand</surname><given-names>S</given-names></name><name><surname>Gutiérrez</surname><given-names>M</given-names></name><name><surname>Alza</surname><given-names>L</given-names></name><name><surname>Chipollini</surname><given-names>A</given-names></name><name><surname>Díaz</surname><given-names>E</given-names></name><name><surname>Espinoza</surname><given-names>P</given-names></name><name><surname>Ledesma</surname><given-names>J</given-names></name><name><surname>Quesquén</surname><given-names>R</given-names></name><name><surname>Peraltilla</surname><given-names>S</given-names></name><name><surname>Chavez</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Schooling behaviour and environmental forcing in relation to anchoveta distribution: an analysis across multiple spatial scales</article-title><source>Progress in Oceanography</source><volume>79</volume><fpage>264</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1016/j.pocean.2008.10.018</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bertrand</surname><given-names>A</given-names></name><name><surname>Grados</surname><given-names>D</given-names></name><name><surname>Colas</surname><given-names>F</given-names></name><name><surname>Bertrand</surname><given-names>S</given-names></name><name><surname>Capet</surname><given-names>X</given-names></name><name><surname>Chaigneau</surname><given-names>A</given-names></name><name><surname>Vargas</surname><given-names>G</given-names></name><name><surname>Mousseigne</surname><given-names>A</given-names></name><name><surname>Fablet</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Broad impacts of fine-scale dynamics on seascape structure from zooplankton to seabirds</article-title><source>Nature Communications</source><volume>5</volume><fpage>5239</fpage><pub-id pub-id-type="doi">10.1038/ncomms6239</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Born</surname><given-names>M</given-names></name><name><surname>Green</surname><given-names>HS</given-names></name></person-group><year iso-8601-date="1946">1946</year><article-title>A general kinetic theory of liquids. i. the molecular distribution functions</article-title><source>Proceedings of the Royal Society of London</source><volume>188</volume><fpage>10</fpage><lpage>18</lpage><pub-id pub-id-type="doi">10.1098/rspa.1946.0093</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buhl</surname><given-names>J</given-names></name><name><surname>Sumpter</surname><given-names>DJ</given-names></name><name><surname>Couzin</surname><given-names>ID</given-names></name><name><surname>Hale</surname><given-names>JJ</given-names></name><name><surname>Despland</surname><given-names>E</given-names></name><name><surname>Miller</surname><given-names>ER</given-names></name><name><surname>Simpson</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>From disorder to order in marching locusts</article-title><source>Science</source><volume>312</volume><fpage>1402</fpage><lpage>1406</lpage><pub-id pub-id-type="doi">10.1126/science.1125142</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chou</surname><given-names>Y-L</given-names></name><name><surname>Wolfe</surname><given-names>R</given-names></name><name><surname>Ihle</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Kinetic theory for systems of self-propelled particles with metric-free interactions</article-title><source>Physical Review E</source><volume>86</volume><fpage>021</fpage><lpage>120</lpage><pub-id pub-id-type="doi">10.1103/PhysRevE.86.021120</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>CW</given-names></name><name><surname>Mangel</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Foraging and flocking strategies: information in an uncertain environment</article-title><source>The American Naturalist</source><volume>123</volume><fpage>626</fpage><lpage>641</lpage><pub-id pub-id-type="doi">10.1086/284228</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couzin</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Collective minds</article-title><source>Nature</source><volume>445</volume><fpage>715</fpage><pub-id pub-id-type="doi">10.1038/445715a</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couzin</surname><given-names>ID</given-names></name><name><surname>Ioannou</surname><given-names>CC</given-names></name><name><surname>Demirel</surname><given-names>G</given-names></name><name><surname>Gross</surname><given-names>T</given-names></name><name><surname>Torney</surname><given-names>CJ</given-names></name><name><surname>Hartnett</surname><given-names>A</given-names></name><name><surname>Conradt</surname><given-names>L</given-names></name><name><surname>Levin</surname><given-names>SA</given-names></name><name><surname>Leonard</surname><given-names>NE</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Uninformed individuals promote democratic consensus in animal groups</article-title><source>Science</source><volume>334</volume><fpage>1578</fpage><lpage>1580</lpage><pub-id pub-id-type="doi">10.1126/science.1210280</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couzin</surname><given-names>ID</given-names></name><name><surname>Krause</surname><given-names>J</given-names></name><name><surname>Franks</surname><given-names>NR</given-names></name><name><surname>Levin</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Effective leadership and decision-making in animal groups on the move</article-title><source>Nature</source><volume>433</volume><fpage>513</fpage><lpage>516</lpage><pub-id pub-id-type="doi">10.1038/nature03236</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couzin</surname><given-names>ID</given-names></name><name><surname>Krause</surname><given-names>J</given-names></name><name><surname>James</surname><given-names>R</given-names></name><name><surname>Ruxton</surname><given-names>GD</given-names></name><name><surname>Franks</surname><given-names>NR</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Collective memory and spatial sorting in animal groups</article-title><source>Journal of Theoretical Biology</source><volume>218</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1006/jtbi.2002.3065</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couzin</surname><given-names>ID</given-names></name><name><surname>Krause</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Self-organization and collective behavior in vertebrates</article-title><source>Advances in the Study of Behavior</source><volume>32</volume><fpage>1</fpage><lpage>75</lpage><pub-id pub-id-type="doi">10.1016/S0065-3454(03)01001-5</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cvikel</surname><given-names>N</given-names></name><name><surname>Egert Berg</surname><given-names>K</given-names></name><name><surname>Levin</surname><given-names>E</given-names></name><name><surname>Hurme</surname><given-names>E</given-names></name><name><surname>Borissov</surname><given-names>I</given-names></name><name><surname>Boonman</surname><given-names>A</given-names></name><name><surname>Amichai</surname><given-names>E</given-names></name><name><surname>Yovel</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Bats aggregate to improve prey search but might be impaired when their density becomes too high</article-title><source>Current Biology</source><volume>25</volume><fpage>206</fpage><lpage>2011</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2014.11.010</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Doering</surname><given-names>CR</given-names></name><name><surname>Gibbon</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="1995">1995</year><source>Applied Analysis of the Navier-Stokes Equations</source><publisher-loc>Cambridge</publisher-loc><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9780511608803</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>D’Orsogna</surname><given-names>MR</given-names></name><name><surname>Chuang</surname><given-names>YL</given-names></name><name><surname>Bertozzi</surname><given-names>AL</given-names></name><name><surname>Chayes</surname><given-names>LS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Self-propelled particles with soft-core interactions: patterns, stability, and collapse</article-title><source>Physical Review Letters</source><volume>96</volume><fpage>104302</fpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.96.104302</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flierl</surname><given-names>G</given-names></name><name><surname>Grünbaum</surname><given-names>D</given-names></name><name><surname>Levins</surname><given-names>S</given-names></name><name><surname>Olson</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>From individuals to aggregations: the interplay between behavior and physics</article-title><source>Journal of Theoretical Biology</source><volume>196</volume><fpage>397</fpage><lpage>454</lpage><pub-id pub-id-type="doi">10.1006/jtbi.1998.0842</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gurarie</surname><given-names>E</given-names></name><name><surname>Ovaskainen</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Towards a general formalization of encounter rates in ecology</article-title><source>Theoretical Ecology</source><volume>6</volume><fpage>189</fpage><lpage>202</lpage><pub-id pub-id-type="doi">10.1007/s12080-012-0170-4</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guttal</surname><given-names>V</given-names></name><name><surname>Couzin</surname><given-names>ID</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Social interactions, information use, and the evolution of collective migration</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>107</volume><fpage>16172</fpage><lpage>16177</lpage><pub-id pub-id-type="doi">10.1073/pnas.1006874107</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Handegard</surname><given-names>NO</given-names></name><name><surname>Boswell</surname><given-names>KM</given-names></name><name><surname>Ioannou</surname><given-names>CC</given-names></name><name><surname>Leblanc</surname><given-names>SP</given-names></name><name><surname>Tjøstheim</surname><given-names>DB</given-names></name><name><surname>Couzin</surname><given-names>ID</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The dynamics of coordinated group hunting and collective information transfer among schooling prey</article-title><source>Current Biology</source><volume>22</volume><fpage>1213</fpage><lpage>1217</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2012.04.050</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hein</surname><given-names>AM</given-names></name><name><surname>McKinley</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Sensing and decision-making in random search</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>109</volume><fpage>12070</fpage><lpage>12074</lpage><pub-id pub-id-type="doi">10.1073/pnas.1202686109</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herbert-Read</surname><given-names>JE</given-names></name><name><surname>Perna</surname><given-names>A</given-names></name><name><surname>Mann</surname><given-names>RP</given-names></name><name><surname>Schaerf</surname><given-names>TM</given-names></name><name><surname>Sumpter</surname><given-names>DJ</given-names></name><name><surname>Ward</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Inferring the rules of interaction of shoaling fish</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>108</volume><fpage>18726</fpage><lpage>18731</lpage><pub-id pub-id-type="doi">10.1073/pnas.1109355108</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hindmarsh</surname><given-names>AC</given-names></name><name><surname>Brown</surname><given-names>PN</given-names></name><name><surname>Grant</surname><given-names>KE</given-names></name><name><surname>Lee</surname><given-names>SL</given-names></name><name><surname>Serban</surname><given-names>R</given-names></name><name><surname>Shumaker</surname><given-names>DE</given-names></name><name><surname>Woodward</surname><given-names>CS</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>SUNDIALS</article-title><source>ACM Transactions on Mathematical Software</source><volume>31</volume><fpage>363</fpage><lpage>396</lpage><pub-id pub-id-type="doi">10.1145/1089014.1089020</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katz</surname><given-names>Y</given-names></name><name><surname>Tunstrøm</surname><given-names>K</given-names></name><name><surname>Ioannou</surname><given-names>CC</given-names></name><name><surname>Huepe</surname><given-names>C</given-names></name><name><surname>Couzin</surname><given-names>ID</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Inferring the structure and dynamics of interactions in schooling fish</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>108</volume><fpage>18720</fpage><lpage>18725</lpage><pub-id pub-id-type="doi">10.1073/pnas.1107583108</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolpas</surname><given-names>A</given-names></name><name><surname>Moehlis</surname><given-names>J</given-names></name><name><surname>Kevrekidis</surname><given-names>IG</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Coarse-grained analysis of stochasticity-induced switching between collective motion states</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>104</volume><fpage>5931</fpage><lpage>5935</lpage><pub-id pub-id-type="doi">10.1073/pnas.0608270104</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="book"><person-group person-group-type="author"><collab>MATLAB and Statistics and Machine Learning Toolbox R</collab></person-group><year iso-8601-date="2015">2015</year><source>The MathWorks</source><publisher-loc>Natick</publisher-loc></element-citation></ref><ref id="bib27"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>McKay</surname><given-names>DJC</given-names></name></person-group><year iso-8601-date="2003">2003</year><source>Information Theory, Inference, and Learning Algorithms</source><publisher-loc>Cambridge, UK</publisher-loc><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Passino</surname><given-names>KM</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Biomimicry of bacterial foraging for distributed optimization and control</article-title><source>IEEE Control Systems Magazine</source><volume>22</volume><fpage>52</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1109/MCS.2002.1004010</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peshkov</surname><given-names>A</given-names></name><name><surname>Ngo</surname><given-names>S</given-names></name><name><surname>Bertin</surname><given-names>E</given-names></name><name><surname>Chaté</surname><given-names>H</given-names></name><name><surname>Ginelli</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Continuous theory of active matter systems with metric-free interactions</article-title><source>Physical Review Letters</source><volume>109</volume><fpage>098101</fpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.109.098101</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pitcher</surname><given-names>TJ</given-names></name><name><surname>Parrish</surname><given-names>JK</given-names></name></person-group><year iso-8601-date="1993">1993</year><chapter-title>Functions of shoaling behaviour in teleosts</chapter-title><person-group person-group-type="editor"><name><surname>Pitcher</surname> <given-names>TJ</given-names></name></person-group><source>Behaviour of Teleost Fishes</source><publisher-loc>Dordrecht</publisher-loc><publisher-name>Springer Netherlands</publisher-name><fpage>363</fpage><lpage>439</lpage><pub-id pub-id-type="doi">10.1007/978-94-011-1578-0_12</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pruitt</surname><given-names>JN</given-names></name><name><surname>Goodnight</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Site-specific group selection drives locally adapted group compositions</article-title><source>Nature</source><volume>514</volume><fpage>359</fpage><lpage>362</lpage><pub-id pub-id-type="doi">10.1038/nature13811</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenthal</surname><given-names>SB</given-names></name><name><surname>Twomey</surname><given-names>CR</given-names></name><name><surname>Hartnett</surname><given-names>AT</given-names></name><name><surname>Wu</surname><given-names>HS</given-names></name><name><surname>Couzin</surname><given-names>ID</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Revealing the hidden networks of interaction in mobile animal groups allows prediction of complex behavioral contagion</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>112</volume><fpage>4690</fpage><lpage>4695</lpage><pub-id pub-id-type="doi">10.1073/pnas.1420068112</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Armadillo: an open source c++ linear algebra library for fast prototyping and computationally intensive experiments technical report</article-title><source>NICTA</source></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schnitzer</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Theory of continuum random walks and application to chemotaxis</article-title><source>Physical Review E</source><volume>48</volume><fpage>2553</fpage><lpage>2568</lpage><pub-id pub-id-type="doi">10.1103/PhysRevE.48.2553</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schnitzer</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Biological computation: amazing algorithms</article-title><source>Nature</source><volume>416</volume><fpage>683</fpage><pub-id pub-id-type="doi">10.1038/416683a</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="1982">1982</year><source>Evolution and the Theory of Games</source><publisher-loc>Cambridge</publisher-loc><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9780511806292</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>DW</given-names></name><name><surname>Brown</surname><given-names>JS</given-names></name><name><surname>Ydenberg</surname><given-names>RC</given-names></name></person-group><year iso-8601-date="2007">2007</year><source>Foraging: Behavior and Ecology</source><publisher-loc>USA</publisher-loc><publisher-name>University of Chicago Press</publisher-name><pub-id pub-id-type="doi">10.7208/chicago/9780226772653.001.0001</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strandburg-Peshkin</surname><given-names>A</given-names></name><name><surname>Twomey</surname><given-names>CR</given-names></name><name><surname>Bode</surname><given-names>NW</given-names></name><name><surname>Kao</surname><given-names>AB</given-names></name><name><surname>Katz</surname><given-names>Y</given-names></name><name><surname>Ioannou</surname><given-names>CC</given-names></name><name><surname>Rosenthal</surname><given-names>SB</given-names></name><name><surname>Torney</surname><given-names>CJ</given-names></name><name><surname>Wu</surname><given-names>HS</given-names></name><name><surname>Levin</surname><given-names>SA</given-names></name><name><surname>Couzin</surname><given-names>ID</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Visual sensory networks and effective information transfer in animal groups</article-title><source>Current Biology : CB</source><volume>23</volume><fpage>R709</fpage><lpage>R711</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.07.059</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Torney</surname><given-names>C</given-names></name><name><surname>Neufeld</surname><given-names>Z</given-names></name><name><surname>Couzin</surname><given-names>ID</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Context-dependent interaction leads to emergent search behavior in social aggregates</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>106</volume><fpage>22055</fpage><lpage>22060</lpage><pub-id pub-id-type="doi">10.1073/pnas.0907929106</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Torney</surname><given-names>CJ</given-names></name><name><surname>Berdahl</surname><given-names>A</given-names></name><name><surname>Couzin</surname><given-names>ID</given-names></name><name><surname>Meyers</surname><given-names>LA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Signalling and the evolution of cooperative foraging in dynamic environments</article-title><source>PLoS Computational Biology</source><volume>7</volume><elocation-id>e1002194</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002194</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tunstrøm</surname><given-names>K</given-names></name><name><surname>Katz</surname><given-names>Y</given-names></name><name><surname>Ioannou</surname><given-names>CC</given-names></name><name><surname>Huepe</surname><given-names>C</given-names></name><name><surname>Lutz</surname><given-names>MJ</given-names></name><name><surname>Couzin</surname><given-names>ID</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Collective states, multistability and transitional behavior in schooling fish</article-title><source>PLoS Computational Biology</source><volume>9</volume><elocation-id>e1002915</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002915</pub-id></element-citation></ref></ref-list><app-group><app id="app1"><title>Appendix</title><boxed-text><sec id="s14" sec-type="appendix"><title>1 Social interaction rules</title><sec id="s15"><title>1.1 Model of social interactions</title><p>Past individual-based models that include social interactions have often depicted social interactions by assuming that individuals monitor metric 'zones'. Individuals avoid neighbors in a small zone of avoidance, and align and move toward neighbors within larger zones of social interactions (e.g., <xref ref-type="bibr" rid="bib19">Guttal and Couzin, 2010</xref>; <xref ref-type="bibr" rid="bib12">Couzin et al., 2002</xref>; <xref ref-type="bibr" rid="bib7">Chou et al., 2012</xref>). Here, we use an alternative model that depicts social interactions as forces that act to modify individuals’ accelerations. This approach is closely related to force matching methods that have been applied to data to infer the strength of pairwise social interactions among individuals. We assume that social forces depend on distance in a way that creates short-range repulsion among individuals, strong intermediate range attraction, and weak attraction for longer ranges in agreement with results of <xref ref-type="bibr" rid="bib24">Katz et al. (2011)</xref>. We model the social forces on a focal individual, <inline-formula><mml:math id="inf236"><mml:mi>i</mml:mi></mml:math></inline-formula>, by the following equation:</p><p><disp-formula id="equ6"><label>(A1)</label><mml:math id="m6"><mml:mstyle><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mn>,</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mo>∇</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mn>,</mml:mn></mml:mstyle></mml:math></disp-formula></p><p>where, as described in the Main Text, <inline-formula><mml:math id="inf237"><mml:mstyle><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf238"><mml:mstyle><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mstyle></mml:math></inline-formula> are the position and velocity of the <inline-formula><mml:math id="inf239"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual, respectively, <inline-formula><mml:math id="inf240"><mml:mo>∇</mml:mo></mml:math></inline-formula> is the two-dimensional gradient operator, the term in brackets is a social potential, <inline-formula><mml:math id="inf241"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf242"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf243"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf244"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are constants, and the set <inline-formula><mml:math id="inf245"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a set of the <inline-formula><mml:math id="inf246"><mml:mi>k</mml:mi></mml:math></inline-formula> nearest neighbors of the <inline-formula><mml:math id="inf247"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual, where a neighbor is an individual within a distance of <inline-formula><mml:math id="inf248"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of the focal individual. <xref ref-type="fig" rid="fig7">Appendix Figure 1</xref> shows the effective force exerted on a focal individual by a neighbor located along the focal individual’s trajectory, either behind (<inline-formula><mml:math id="inf249"><mml:mi>x</mml:mi></mml:math></inline-formula>-axis <inline-formula><mml:math id="inf250"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) or in front of (<inline-formula><mml:math id="inf251"><mml:mi>x</mml:mi></mml:math></inline-formula>-axis <inline-formula><mml:math id="inf252"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) the focal individual [compare to <xref ref-type="fig" rid="fig7">Appendix Figure 2</xref> of <xref ref-type="bibr" rid="bib24">Katz et al. (2011</xref>)]. Unlike many past models of interactions among individuals, we do not assume that individuals explicitly align with one another. However, because the r.h.s of <xref ref-type="disp-formula" rid="equ6">Equation A1</xref> is proportional to the gradient of a social potential, social interactions can cause the focal individual to turn. This turning toward neighbors causes the social gradient climbing behavior described in the Main Text and discussed in detail in Appendix section 6 below.<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.013</object-id><label>Appendix Figure 1.</label><caption><title>Speeding force as a function of the location of a single neighbor.</title><p>On the left of the origin, the neighbor is behind the focal individual. For very short distances, the neighbor exerts a positive speeding force on the focal individual, causing it to accelerate. For longer negative distances, the speeding force on the focal individual is negative; the focal individual decelerates to come closer to its neighbor. To the right of the origin the neighbor is in front of the focal individual. For short distances, the speeding force on the focal individual is negative, causing it to slow down. For longer positive distances the speeding force exerted on the focal individual is positive; the focal individual speeds up, closing the distance between it and its neighbor. The distance corresponding to repulsion only is shown with the blue line. Parameters as follows: <italic>C<sub>a</sub></italic> = 1, <italic>C<sub>r </sub></italic>= 1.1, <italic>l<sub>a </sub></italic>= 3, <italic>l<sub>r </sub></italic>= 1.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.013">http://dx.doi.org/10.7554/eLife.10955.013</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig1-v3.tif"/></fig></p></sec><sec id="s16"><title>1.2 Definition of an asocial individual</title><p>To illustrate the collective behavior and evolution of social individuals it is useful to compare social individuals to individuals that are not influenced by social attraction. We refer to such individuals as 'asocial' and define them in terms of <xref ref-type="disp-formula" rid="equ6">Equation A1</xref> by setting <inline-formula><mml:math id="inf253"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to a value that corresponded to the distance at which the gradient of the social potential for a pairwise interaction is equal to zero (blue line in <xref ref-type="fig" rid="fig7">Appendix Figure 1</xref>: point at which potential crosses zero). We define asocial agents in this way because the short-range repulsion included in the inter-agent potential shown in <xref ref-type="fig" rid="fig7">Appendix Figure 1</xref> represents collision-avoidance–a behavior that should be common to all individuals, regardless of whether they are socially attracted to one another. While this definition of an 'asocial' individual is more biologically sensible, we have also tried modeling asocial individuals by assuming that the r.h.s. of <xref ref-type="disp-formula" rid="equ6">Equation A1</xref> is equal to zero for all individuals (this assumes, for instance, that these individuals are not limited to finite local density); this approach does not qualitatively change the results presented below and in the Main Text.</p></sec></sec><sec id="s17" sec-type="appendix"><title>2 Evolutionary dynamics</title><sec id="s18"><title>2.1 Selection algorithm</title><p>To understand the connection between the evolution of collective behaviors and selection on the performance of individuals, we implement a simple evolutionary algorithm similar to that used in <xref ref-type="bibr" rid="bib19">Guttal and Couzin (2010</xref>). In the first generation, <inline-formula><mml:math id="inf254"><mml:mi>N</mml:mi></mml:math></inline-formula> agents with heterogeneous values of <inline-formula><mml:math id="inf255"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf256"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf257"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are initiated in an environment with <inline-formula><mml:math id="inf258"><mml:mi>M</mml:mi></mml:math></inline-formula> resource peaks. The number of agents remains constant across generations, and generations are non-overlapping. Each generation consists of a simulation run for 5,000 or 10,000 time steps over which we calculated the mean resource value experienced by each individual in the population. At the end of each generation, <inline-formula><mml:math id="inf259"><mml:mi>N</mml:mi></mml:math></inline-formula> individuals are selected from the population (with replacement) to reproduce themselves, yielding a total of <inline-formula><mml:math id="inf260"><mml:mi>N</mml:mi></mml:math></inline-formula> new offspring. An individual’s probability of being selected for reproduction is proportional to its mean resource value, normalized by sum of mean resource value over all individuals in the population. Individuals that perform well are more likely to be selected to reproduce and are likely to produce more offspring than individuals that perform poorly. The selection probability of the <inline-formula><mml:math id="inf261"><mml:mi>i</mml:mi></mml:math></inline-formula>th individual <inline-formula><mml:math id="inf262"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is defined as follows:</p><p><disp-formula id="equ7"><label>(A2)</label><mml:math id="m7"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mfenced close="&gt;" open="&lt;"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msub><mml:mfenced close="&gt;" open="&lt;"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mn>,</mml:mn></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf263"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn/><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:math></inline-formula> is the instantaneous resource value of individual <inline-formula><mml:math id="inf264"><mml:mi>i</mml:mi></mml:math></inline-formula>, and angular brackets represent time-averaging over the particular generation under consideration. If an individual is selected for reproduction, a child is produced in the next generation with <inline-formula><mml:math id="inf265"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> equal to that of the parent, with a small mutation. The <inline-formula><mml:math id="inf266"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> value of an offspring is equal to the <inline-formula><mml:math id="inf267"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> value of its parent, plus a normally distributed random number <inline-formula><mml:math id="inf268"><mml:mi>σ</mml:mi></mml:math></inline-formula> with mean zero and variance <inline-formula><mml:math id="inf269"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>:</p><p><disp-formula id="equ8"><label>(A3)</label><mml:math id="m8"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mn>0,</mml:mn><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mn>0,</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:mn>,</mml:mn></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf270"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mn>0,</mml:mn><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the <inline-formula><mml:math id="inf271"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> value of an offspring of individual <inline-formula><mml:math id="inf272"><mml:mi>i</mml:mi></mml:math></inline-formula>. The <inline-formula><mml:math id="inf273"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf274"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> traits of offspring were determined in the same way.</p></sec><sec id="s19"><title>2.2 Evolution of asocial populations</title><p>In general, populations of asocial individuals evolve to have increasing <inline-formula><mml:math id="inf275"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf276"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> values. While fitnesses of individuals in these populations are well below fitnesses of individuals in the evolutionarily stable states discussed below (see Main Text <xref ref-type="fig" rid="fig1">Figure 1F</xref>), selection on asocial populations still leads to an increase in mean fitness (<xref ref-type="fig" rid="fig8">Appendix Figure 2</xref>). This occurs because, as evolution progresses and <inline-formula><mml:math id="inf277"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf278"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> values evolve, asocial individuals spend more time in regions of the environment with high resource value.<fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.014</object-id><label>Appendix Figure 2.</label><caption><title>Fitness of asocial population through evolutionary time.</title><p>Blue points indicate mean fitness of population in each generation. Horizontal red line indicates mean fitness of population over first ten generations. Corresponding <inline-formula><mml:math id="inf279"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf280"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> values for each generation are shown in <xref ref-type="fig" rid="fig1">Figure 1A,B</xref> of the Main Text.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.014">http://dx.doi.org/10.7554/eLife.10955.014</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig2-v3.tif"/></fig></p></sec><sec id="s20"><title>2.3 Establishment of evolutionarily stable state (ESSt)</title><p>We allow populations to evolve according to the algorithm described above. Initial values of <inline-formula><mml:math id="inf281"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf282"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> phenotypes are drawn at random from uniform distributions between 0 and 6. Initial values of <inline-formula><mml:math id="inf283"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are drawn with uniform probability from the interval <inline-formula><mml:math id="inf284"><mml:mo>(</mml:mo><mml:mn>0,30</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>. The distribution of trait values quickly stabilizes for all three phenotypic traits as shown in <xref ref-type="fig" rid="fig1">Figure 1C–E</xref> of Main Text. We refer to this evolved state as an evolutionarily stable state (ESSt, <xref ref-type="bibr" rid="bib19">Guttal and Couzin, 2010</xref>). The persistent variance in the distribution of <inline-formula><mml:math id="inf285"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf286"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf287"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are partially due to mutations in the value of these traits, which are continually introduced into the population. We therefore expect such persistent of inter-individual variation in phenotype as a result of mutation-selection balance.</p></sec><sec id="s21"><title>2.4 Robustness of ESSt</title><p>To evaluate the robustness of the evolutionarily stable state (ESSt) described in the Main Text, we performed evolution under invasion by phenotypes that are both near to, and far from the ESSt. We initiated the population with trait distributions from the ESSt (selected from the final generation of simulations used to establish ESSt). Then in each generation, we selected individuals to reproduce and applied ordinary mutations as described above. However, before initiating the next generation, a single individual was chosen to serve as an invader. That individual’s phenotype was replaced by values (<inline-formula><mml:math id="inf288"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="inf289"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula>, and <inline-formula><mml:math id="inf290"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula>). <inline-formula><mml:math id="inf291"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf292"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> were chosen with uniform probability from the interval <inline-formula><mml:math id="inf293"><mml:mo>(</mml:mo><mml:mn>0,40</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="inf294"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> is chosen with uniform probability from the interval <inline-formula><mml:math id="inf295"><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>(</mml:mo><mml:mn>0,30</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>. Though these intervals are somewhat arbitrary, we note that <inline-formula><mml:math id="inf296"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf297"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> must ultimately be bounded above by limits on the speed that individuals can sustain, and by limits on the distance over which individuals can perceive one another, respectively. <inline-formula><mml:math id="inf298"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> should also be bounded above because it is limited by the rate at which individuals can accelerate (decelerate) in response to changes in the measured value of an environmental cue. Thus, all three traits are bounded above due to physical constraints. Applying higher bounds on these trait values did not qualitatively change our conclusions.</p><p><xref ref-type="fig" rid="fig9">Appendix Figure 3</xref> shows a typical evolutionary progression when a population at ESSt acquires mutations (i.e., small changes in phenotype) and receives an invader in each generation. Although invaders from across the phenotype space are introduced into the population (<xref ref-type="fig" rid="fig9">Appendix Figure 3</xref> blue dots across phenotype space), none of these invaders establishes for more than a few generations (<xref ref-type="fig" rid="fig9">Appendix Figure 3</xref> blue dots become extinct after few generations). The ESSt is resistant to invasion by both nearby phenotypes, introduced through ordinary mutation, and phenotypes far from the ESSt, introduced through invaders. We therefore refer to the ESSt as robust.<fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.015</object-id><label>Appendix Figure 3.</label><caption><title>Evolution of traits under invasion by mutants far from the ESSt.</title><p>Example evolutionary progression for <inline-formula><mml:math id="inf299"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf300"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf301"><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Note that invaders (blue points introduced across phenotype space) do not establish and the dominant trait values in the population do not change over evolutionary time. Color indicates frequency of phenotype in population (white = 0, blue = low frequency, orange = high frequency).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.015">http://dx.doi.org/10.7554/eLife.10955.015</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig3-v3.tif"/></fig></p></sec><sec id="s22"><title>2.5 Invasion of asocial population by social strategy</title><p>To determine whether phenotypes from the ESSt could invade a population of purely asocial individuals, we performed another set of evolutionary simulations in which we initiated populations with <inline-formula><mml:math id="inf302"><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> asocial individuals and a single individual, chosen at random from the ESSt. <xref ref-type="fig" rid="fig10">Appendix Figure 4</xref> shows evolutionary progressions from this initial state. In panel A, the full trait distribution of the population is shown. The social invader increases in frequency and sweeps the population of asocials. Replicate invasions show a very similar progression (<xref ref-type="fig" rid="fig10">Appendix Figure 4B</xref>). The final distribution of trait values matches the ESSt. The change in phenotypes that occur when the ESSt phenotype invades the asocial population lead to a dramatic increase in mean fitness (<xref ref-type="fig" rid="fig10">Appendix Figure 4C</xref>) and a decrease in the range of fitnesses of different individuals in the population.<fig id="fig10" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.016</object-id><label>Appendix Figure 4.</label><caption><title>Typical progression of evolution from initial state with N − 1 asocial individuals and individual selected from the ESSt population.</title><p>(<bold><bold>A</bold></bold>) Invader from ESSt increases in abundance and sweeps population. (<bold><bold>B</bold></bold>) Mean trait values in 50 replicate invasions (each line is a separate invasion from the same initial state with N − 1 asocial individuals). ESSt phenotype quickly invades and sweeps the population in all cases. (<bold>C</bold>) Mean and coeffient of variation in fitness corresponding to the invasion shown in <bold><bold>A</bold></bold>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.016">http://dx.doi.org/10.7554/eLife.10955.016</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig4-v3.tif"/></fig></p></sec><sec id="s23"><title>2.6 Dependence of evolutionary outcomes on the environment</title><p>One of the conclusions drawn in the Main Text is that the trait values of the evolved population at the EESt correspond to a location in behavioral state space where the population is in the dispersed state in regions of the environment with low resource quality, and that the population transitions from the dispersed to cohesive and station-keeping states in regions of the environment with high resource quality. We evaluated whether this conclusion holds, more generally, by evolving populations in more complex environments in which environmental properties were selected at random. We initialized trait values of populations as described in <italic>Establishment of evolutionarily stable state (ESSt)</italic> above. However, to generate the environment, we chose the number of Gaussian resource peaks at random from 1 to 50 with uniform probability. The maximum resource value of each peak and the variance of the two-dimensional Gaussian peak shape were also chosen at random. Maximum resource value was chosen with uniform probability from the interval <inline-formula><mml:math id="inf303"><mml:mo>(</mml:mo><mml:mn>0,10</mml:mn><mml:mo>]</mml:mo></mml:math></inline-formula> and variance was chosen with uniform probability from the interval <inline-formula><mml:math id="inf304"><mml:mo>(</mml:mo><mml:mn>0,30</mml:mn><mml:mo>]</mml:mo></mml:math></inline-formula>. Finally, the variances of all peaks in a given simulation were rescaled so that the sum of the integral of all peaks over the environment was equal to <inline-formula><mml:math id="inf305"><mml:mrow><mml:mn>400</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:math></inline-formula>. We enforce this latter condition to ensure that resource peaks are small relative to the size of the environment. All other parameter values were those listed in <xref ref-type="fig" rid="fig1">Figure 1</xref> of the Main Text, except that <inline-formula><mml:math id="inf306"><mml:mi>N</mml:mi></mml:math></inline-formula> was 300.</p><p>We allowed populations to evolve for 1500 generations and recorded values of <inline-formula><mml:math id="inf307"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf308"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf309"><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> that evolved. <xref ref-type="fig" rid="fig11">Appendix Figure 5</xref> show mean <inline-formula><mml:math id="inf310"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf311"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> trait values after 1500 generations for evolutionary simulations with different environmental conditions. The gray band in <xref ref-type="fig" rid="fig11">Appendix Figure 5</xref> corresponds to the region of hysteresis between cohesive and dispersed states shown in <xref ref-type="fig" rid="fig3">Figure 3</xref> in the Main Text. With the exception of a small number of simulated evolutions (<xref ref-type="fig" rid="fig11">Appendix Figure 5</xref>, points below gray band) populations in all environments had mean trait values of <inline-formula><mml:math id="inf312"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> in or above the hysteresis region. In all cases, the combination of <inline-formula><mml:math id="inf313"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf314"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> caused individuals to exhibit values of <inline-formula><mml:math id="inf315"><mml:mi>Ψ</mml:mi><mml:mo>=</mml:mo><mml:mn/><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula> that were less than zero in the most favorable regions of the environment. Thus, for the large majority of random environmental conditions we generated, individuals transition from <inline-formula><mml:math id="inf316"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> values that correspond to the dispersed state, through <inline-formula><mml:math id="inf317"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> values that correspond to cohesive and station keeping states in favorable regions of the environment.<fig id="fig11" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.017</object-id><label>Appendix Figure 5.</label><caption><title>Trait values after 1500 generations of evolution in randomly generated environments.</title><p>Each point represents the mean trait values of a single population that has been allowed to evolve for 1500 generations. Point sizes denote the number of peaks that were present in the environment. Point colors represent the maximum resource value <italic>λ</italic><sub>0</sub> averaged over all peaks present in the environment. Gray region corresponds to the region of hysteresis shown in <xref ref-type="fig" rid="fig3">Figure 3</xref> of the Main Text. Number of peaks and peak parameters were chosen at random. All other parameters as in <xref ref-type="fig" rid="fig1">Figure 1</xref> of Main Text.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.017">http://dx.doi.org/10.7554/eLife.10955.017</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig5-v3.tif"/></fig></p></sec><sec id="s24"><title>2.7 Perturbation of populations around the ESSt</title><p>To further understand how the evolutionarily stable trait values lead to high individual fitness we perturbed the entire populations at ESSt by shifting either <inline-formula><mml:math id="inf318"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf319"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> of all individuals in the population. This resulted in a change in the mean value of these traits over the entire population. We then simulated the dynamic behaviors of the new perturbed population in a simplified environment containing two resource peaks. Initially, all individuals were located in a single group near one of the peaks (the starting peak). <xref ref-type="fig" rid="fig12">Appendix Figure 6</xref> shows that, for fixed <inline-formula><mml:math id="inf320"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, group sizes and mean fitness vary strongly as a function of the mean value of <inline-formula><mml:math id="inf321"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> of the population (both <inline-formula><mml:math id="inf322"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf323"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are taken from a population at ESSt and values of <inline-formula><mml:math id="inf324"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are shifted to change <inline-formula><mml:math id="inf325"><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⟩</mml:mo></mml:mrow></mml:math></inline-formula> of the population). For small values of <inline-formula><mml:math id="inf326"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, individuals track the starting peak but do not find the second peak (<xref ref-type="fig" rid="fig12">Appendix Figure 6A</xref>, blue and red points, respectively). As <inline-formula><mml:math id="inf327"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> reaches approximately 2.2, individuals begin to form a group on the second resource peak (<xref ref-type="fig" rid="fig12">Appendix Figure 6A</xref>, red points denoting size of group nearest second peak begin to increase). Mean performance of individuals in the group nearest the second peak rapidly increases (<xref ref-type="fig" rid="fig12">Appendix Figure 6A</xref>, red points rapidly increase for <inline-formula><mml:math id="inf328"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>2.2</mml:mn></mml:mrow></mml:math></inline-formula>). When performance is averaged over the entire population, there is a clear maximum at <inline-formula><mml:math id="inf329"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>~</mml:mo><mml:mn>3.6</mml:mn></mml:math></inline-formula> (<xref ref-type="fig" rid="fig12">Appendix Figure 6C</xref>), the value corresponding to mean (and modal) <inline-formula><mml:math id="inf330"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> for the evolved population in the ESSt (orange point in <xref ref-type="fig" rid="fig12">Appendix Figure 6C</xref>). Selection on fitnesses of individuals and optimization for maximum fitness of the entire population lead to the same value of <inline-formula><mml:math id="inf331"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. For larger values of <inline-formula><mml:math id="inf332"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, the average performance over all individuals begins to decline (<xref ref-type="fig" rid="fig12">Appendix Figure 6C</xref>) because fewer individuals aggregate near peaks. Perturbations of <inline-formula><mml:math id="inf333"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> also lead do decreases in mean fitness at the population level (<xref ref-type="fig" rid="fig12">Appendix Figure 6F</xref>). For mean <inline-formula><mml:math id="inf334"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> below that of the ESSt, individuals form small groups near peaks (<xref ref-type="fig" rid="fig12">Appendix Figure 6D</xref>). For mean <inline-formula><mml:math id="inf335"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> above that of ESSt, individuals form large groups, but individuals in the groups near peaks have low fitness because they do not effectively aggregate near peak centers (<xref ref-type="fig" rid="fig12">Appendix Figure 6E</xref>).<fig id="fig12" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.018</object-id><label>Appendix Figure 6.</label><caption><title>Performance of populations near the evolutionarily stable state.</title><p>(<bold><bold>A</bold></bold>) The number of individuals on each peak (the starting peak, blue; the second peak, red) as a function of the mean baseline speed parameter, <inline-formula><mml:math id="inf336"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> of a population perturbed from the ESSt. Below a <inline-formula><mml:math id="inf337"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> of roughly 2.2, individuals do not form a large group on the second peak. (<bold><bold>B</bold></bold>) Mean resource value of individuals on the starting peak (blue) and second peak (red). (<bold><bold>C</bold></bold>) Resource value averaged over all individuals in the population (individuals in groups nearest each peak and all other individuals in the environment). Note maximum value occurs in the regime where individuals aggregate on both the starting and second peaks (<inline-formula><mml:math id="inf338"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>~</mml:mo></mml:math></inline-formula>3.6). Orange point indicates values corresponding to ESSt. (<bold><bold>D</bold></bold>-<bold><bold>F</bold></bold>) Group size (<bold><bold>D</bold></bold>), mean resource value of individuals on peaks (<bold><bold>E</bold></bold>), and mean resource value of all individuals (<bold><bold>F</bold></bold>) as a function of the mean environmental sensitivity parameter <inline-formula><mml:math id="inf339"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> of a population perturbed from ESSt. Orange point in (<bold><bold>F</bold></bold>) indicates values corresponding to ESSt. Note rapid decrease in mean fitness for perturbations in both directions. Semitransparent points are results of 2000 individual simulation runs. To compute means and standard errors, simulation runs were divided into 50 evenly spaced bins. Bolded points and error bars show mean of each bin <inline-formula><mml:math id="inf340"><mml:mo>±</mml:mo></mml:math></inline-formula> 2 standard errors.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.018">http://dx.doi.org/10.7554/eLife.10955.018</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig6-v3.tif"/></fig></p></sec><sec id="s25"><title>2.8 Evolution with resource consumption</title><p>As described in the Main Text, social interactions confer a fitness advantage to social individuals at least in part because the positions and local densities of a given individual’s neighbors contain information about the spatial distribution of resources. However, if individuals quickly consume resources, this may break down. For example, areas in which the density of neighbors is currently high may no longer contain resources in the near future if those neighbors consume the resources. To explore how resource consumption affects evolutionary dynamics, we repeated evolutionary simulations assuming individuals consume the resource. To model resource consumption, we assume each individual consumes resources at a rate given by the product of the resource value at its position <inline-formula><mml:math id="inf341"><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula> and a consumption rate constant <inline-formula><mml:math id="inf342"><mml:mi>u</mml:mi></mml:math></inline-formula>. At each time step, the height of peak <inline-formula><mml:math id="inf343"><mml:mi>j</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf344"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>0,</mml:mn><mml:mtext> </mml:mtext><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, is reduced by the sum <inline-formula><mml:math id="inf345"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mi>u</mml:mi><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mn>,</mml:mn><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula>, where <inline-formula><mml:math id="inf346"><mml:mstyle><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mstyle></mml:math></inline-formula> is the location of the peak and <inline-formula><mml:math id="inf347"><mml:mi>N</mml:mi></mml:math></inline-formula> is the number of individuals in the population. We assume individuals abandon a resource when <inline-formula><mml:math id="inf348"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>0,</mml:mn><mml:mtext> </mml:mtext><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> falls below <inline-formula><mml:math id="inf349"><mml:msup><mml:mi>s</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. To keep the number of resource peaks constant and the total amount of resource on the landscape from being completely depleted, we allow resource peaks that reach a height of <inline-formula><mml:math id="inf350"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>0,</mml:mn><mml:mtext> </mml:mtext><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> to regenerate at a new location chosen at random with equal probability from all points in the environment. The new peak has a peak height equal to the starting peak height, <inline-formula><mml:math id="inf351"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Mean resource value for each agent is calculated in the same manner as in the case where peaks are not depleted.</p><p><xref ref-type="fig" rid="fig13">Appendix Figure 7</xref> shows the results of replicate evolutionary simulations with high (A) and low (B) rates of resource consumption. In the case of high consumption (<xref ref-type="fig" rid="fig13">Appendix Figure 7A</xref>), individuals evolve to have increasing mean values of <inline-formula><mml:math id="inf352"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf353"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf354"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> values are well above the hysteresis regime between collective states. While values of <inline-formula><mml:math id="inf355"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> still enable individuals to be attracted to one another at intermediate to large distances, the variation in <inline-formula><mml:math id="inf356"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> values among replicate simulations suggests that there is not strong selection for large <inline-formula><mml:math id="inf357"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. When individuals consume resources at a lower rate (<xref ref-type="fig" rid="fig13">Appendix Figure 7B</xref>), results parallel those shown in <xref ref-type="fig" rid="fig1">Figure 1</xref> of the Main Text; populations evolve mean values of <inline-formula><mml:math id="inf358"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> that are directly above the hysteresis region, <inline-formula><mml:math id="inf359"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> approaches a stable value, and <inline-formula><mml:math id="inf360"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> approaches the maximum allowable value of 30.<fig id="fig13" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.019</object-id><label>Appendix Figure 7.</label><caption><title>Evolution of behavioral traits when individuals consume resource.</title><p>Lines show means of independent evolutionary simulations. (<bold><bold>A</bold></bold>) High consumption rate corresponding to fast depletion of resource peaks. (<bold><bold>B</bold></bold>) Intermediate consumption rate corresponding to slower depletion of the peaks. Note different axis limits in the top panels of <bold><bold>A</bold></bold> and <bold><bold>B</bold></bold>. Grey region corresponds to hysteresis region between collective states shown in Main Text <xref ref-type="fig" rid="fig3">Figure 3</xref>. Parameters are as follows: <italic>s</italic>*=2, high consumption rate = 3.2*10<sup>–3</sup> (time step<sup>−1</sup>), low consumption rate = 8.0*10<sup>–5</sup> (time step<sup>−1</sup>), N = 300. All other parameters as in <xref ref-type="fig" rid="fig1">Figure 1</xref> of the Main Text. These consumption rates correspond to the case where 100 individuals near the peak center can deplete a peak in roughly five time steps (fast depletion, <bold><bold>A</bold></bold>), and the case where the same task takes 200 time steps (slower depletion, <bold><bold>B</bold></bold>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.019">http://dx.doi.org/10.7554/eLife.10955.019</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig7-v3.tif"/></fig></p></sec></sec><sec id="s26" sec-type="appendix"><title>3 The cohesive state is characterized by a fixed, finite density</title><p>Agents obeying the equations described in the Main text exhibit several distinct collective states. One such state, which we call the cohesive state, is characterized by dense groups of agents occupying a fixed fraction of the environment. One of the salient properties of these groups is that they eventually reach a fixed density that becomes independent of group size. Using a small number of simple assumptions about the behavior of agents within a cohesive group, we are able to predict the density of agents directly from the model parameters. The motivation of our calculation comes from the structure of the equations, which include social potential terms and velocity-dependent self-propulsion terms. The social force on an agent is given by <xref ref-type="disp-formula" rid="equ6">Equation A1</xref>. We will rewrite the social potential in <xref ref-type="disp-formula" rid="equ6">Equation A1</xref> (i.e., the term in brackets) as</p><p><disp-formula id="equ9"><label>(A4)</label><mml:math id="m9"><mml:mi>Φ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mn/><mml:mrow><mml:mo>[</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn/><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:mn/><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn/><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:mn/><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The effect of the potential term in the equations is to exert a force on the entire system towards configurations where the potential energy is lower. The propulsive forces are non-conservative, causing phase-space volumes to contract, allowing the system to approach a potential energy minimum. We model the cohesive state as <inline-formula><mml:math id="inf361"><mml:mi>N</mml:mi></mml:math></inline-formula> agents occupying a circular region of radius <inline-formula><mml:math id="inf362"><mml:mi>l</mml:mi></mml:math></inline-formula>. Further, we assume that the probability distribution of agents within this circular region is uniform, so that agent density is given by:</p><p><disp-formula id="equ10"><label>(A5)</label><mml:math id="m10"><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mi>N</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>The density <inline-formula><mml:math id="inf363"><mml:mi>ρ</mml:mi></mml:math></inline-formula> lets us define an interaction radius <inline-formula><mml:math id="inf364"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> which is expected to contain <inline-formula><mml:math id="inf365"><mml:mi>k</mml:mi></mml:math></inline-formula> individuals:</p><p><disp-formula id="equ11"><label>(A6)</label><mml:math id="m11"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:mi>l</mml:mi><mml:msqrt><mml:mrow><mml:mfrac><mml:mi>k</mml:mi><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:math></disp-formula></p><p>This expression is valid when <inline-formula><mml:math id="inf366"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&gt;</mml:mo><mml:mn/><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>, which is the case we are interested in. When <inline-formula><mml:math id="inf367"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&lt;</mml:mo><mml:mn/><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> the interaction radius is simply the group radius, <inline-formula><mml:math id="inf368"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn/><mml:msub><mml:mi>l</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and each agent interacts with every other agent. We calculate the expected potential by integrating over a circle of radius <inline-formula><mml:math id="inf369"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>:</p><p><disp-formula id="equ12"><label>(A7)</label><mml:math id="m12"><mml:msub><mml:mi>Φ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:mi>ρ</mml:mi><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mn/><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mn/><mml:msub><mml:mi>l</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:mn/><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:mn/><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:mi>A</mml:mi></mml:math></disp-formula></p><p>This integral evaluates to the following expression:</p><p><disp-formula id="equ13"><label>(A8)</label><mml:math id="m13"><mml:msub><mml:mi>Φ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mi>N</mml:mi></mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msqrt><mml:mfrac><mml:mi>k</mml:mi><mml:mi>N</mml:mi></mml:mfrac></mml:msqrt><mml:mi>l</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msqrt><mml:mfrac><mml:mi>k</mml:mi><mml:mi>N</mml:mi></mml:mfrac></mml:msqrt><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mi>l</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mi>N</mml:mi></mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msqrt><mml:mfrac><mml:mi>k</mml:mi><mml:mi>N</mml:mi></mml:mfrac></mml:msqrt><mml:mi>l</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msqrt><mml:mfrac><mml:mi>k</mml:mi><mml:mi>N</mml:mi></mml:mfrac></mml:msqrt><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mi>l</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>It is illustrative to write this expression after the substitution <inline-formula><mml:math id="inf370"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn/><mml:msqrt><mml:mrow><mml:mfrac><mml:mi>N</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>:</p><p><disp-formula id="equ14"><label>(A9)</label><mml:math id="m14"><mml:msub><mml:mi>Φ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi><mml:mo> </mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mfenced><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msqrt><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:msup><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msqrt><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mfenced><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msqrt><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:msup><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msqrt><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace linebreak="newline"/></mml:math></disp-formula></p><p>The density that minimizes <inline-formula><mml:math id="inf371"><mml:msub><mml:mi>Φ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> will be the density of agents in the cohesive state. When written this way, it is clear that <inline-formula><mml:math id="inf372"><mml:mi>N</mml:mi></mml:math></inline-formula> will not influence the location of the minimum of <inline-formula><mml:math id="inf373"><mml:msub><mml:mi>Φ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, as <inline-formula><mml:math id="inf374"><mml:mi>N</mml:mi></mml:math></inline-formula> only appears in the expression as a constant multiplier. Thus, when <inline-formula><mml:math id="inf375"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&gt;</mml:mo><mml:mn/><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> we expect cohesive groups to have a constant density, so that the radius of a group grows like <inline-formula><mml:math id="inf376"><mml:mrow><mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>. These predictions match the results of our simulation quite closely, which one can see from comparisons between <xref ref-type="fig" rid="fig14">Appendix Figure 8</xref> to the lower branch of the hysteresis plot in <xref ref-type="fig" rid="fig15">Appendix Figure 9</xref>.<fig id="fig14" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.020</object-id><label>Appendix Figure 8.</label><caption><title>Plot of potential energy per agent as a function of group size.</title><p>Cutoff at <italic>N </italic>= <italic>K</italic> indicates constant density.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.020">http://dx.doi.org/10.7554/eLife.10955.020</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig8-v3.tif"/></fig><fig id="fig15" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.021</object-id><label>Appendix Figure 9.</label><caption><title>Hysteresis plot of potential energy averaged over the entire population (compare with <xref ref-type="fig" rid="fig3">Figure 3</xref> in Main Text).</title><p>Figure produced by starting with a population with Ψ = 4 in a uniform environment. Population is allowed to equilibrate for 5,000 time steps and then average potential energy is calculated using <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> in the Main Text. Ψ is then lowered. This process is repeated until Ψ = −1, at which point the same procedure is used to increase Ψ. Upper curve corresponds to decreasing Ψ. Lower curve corresponds to increasing Ψ. Note drop in mean potential energy at Ψ = 0. We refer to the states on either side of this transition as <italic>station-keeping</italic> (Ψ &lt; 0) and <italic>cohesive</italic> Ψ &gt; 0 <italic>and below upper transitional regime at</italic> Ψ ∼ 1.7. Points and (error bars) correspond to mean (and 2 standard errors) of 50 replicate simulations. Parameters as in <xref ref-type="fig" rid="fig1">Figure 1</xref> of the Main Text with <italic>l</italic><sub>max</sub> = 30.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.021">http://dx.doi.org/10.7554/eLife.10955.021</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig9-v3.tif"/></fig></p><p>That density is necessarily constant with increasing <inline-formula><mml:math id="inf377"><mml:mi>N</mml:mi></mml:math></inline-formula> is a hallmark of topological interaction laws which are repulsive at short range. When there is no restriction on the number of interaction neighbors, an interaction law of the type that we use can give rise to catastrophic behavior, where the group density increases without bound with increasing <inline-formula><mml:math id="inf378"><mml:mi>N</mml:mi></mml:math></inline-formula> <xref ref-type="bibr" rid="bib16">(D’Orsogna et al., 2006</xref>). One feature of the topological interaction is that it allows for biological realism for agent parameter values that would otherwise lead to catastrophic behavior.</p></sec><sec id="s27" sec-type="appendix"><title>4 Relationship between <inline-formula><mml:math id="inf379"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and the relative strength of social forces</title><p>In order to better understand how changing parameters affect our model, we ignore stochasticity and consider the equations for the acceleration and velocity in a homogeneous environment without resources (so that the background velocity is constant). First we define:</p><p><disp-formula id="equ15"><label>(A10)</label><mml:math id="m15"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>η</mml:mi></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:math></disp-formula></p><p>The equations become:</p><p><disp-formula id="equ16"><label>(A11)</label><mml:math id="m16"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></disp-formula></p><p><disp-formula id="equ17"><label>(A12)</label><mml:math id="m17"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mn/><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mn/><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mn/></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo>∇</mml:mo><mml:msub><mml:mi>Φ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></disp-formula></p><p>Let <inline-formula><mml:math id="inf380"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> be a characteristic length scale in this problem, let <inline-formula><mml:math id="inf381"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> be a characteristic velocity scale, and let <inline-formula><mml:math id="inf382"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> be a characteristic time scale. Then, let <inline-formula><mml:math id="inf383"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the attraction coefficient, be the scale of the potential. We non-dimensionalize our equations by rewriting them in terms of the dimensionless variables:</p><p><disp-formula id="equ18"><label>(A13)</label><mml:math id="m18"><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mi>x</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>t</mml:mi><mml:mo>'</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mi>t</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>v</mml:mi><mml:mo>'</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mi>v</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>Φ</mml:mi><mml:mo>'</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mi>Φ</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mfrac></mml:math></disp-formula></p><p>The resulting dimensionless equations are:</p><p><disp-formula id="equ19"><label>(A14)</label><mml:math id="m19"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:mi>v</mml:mi><mml:mo>'</mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ20"><label>(A15)</label><mml:math id="m20"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mn/><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mn/><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:msup><mml:mi>v</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:msup><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo><mml:mn/><mml:mfrac><mml:msup><mml:mi>v</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mn/><mml:msup><mml:mi>v</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:mn/></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:msup><mml:mo>∇</mml:mo><mml:mo>'</mml:mo></mml:msup><mml:msubsup><mml:mi>Φ</mml:mi><mml:mi>i</mml:mi><mml:mo>'</mml:mo></mml:msubsup></mml:math></disp-formula></p><p>The non-dimensional number <inline-formula><mml:math id="inf384"><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mrow><mml:mi>η</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> measures the relative strength of the social potential. When <inline-formula><mml:math id="inf385"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> becomes large, social forces become negligible. The reason for this effect is that agents begin moving too quickly for the social forces to have any appreciable effect on their trajectories. Therefore, for constant <inline-formula><mml:math id="inf386"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf387"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, an alternative interpretation of <inline-formula><mml:math id="inf388"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is as a term that dictates the relative strengths of autonomous versus social forces.</p></sec><sec id="s28" sec-type="appendix"><title>5 Continuum description predicts cohesive and dispersed state</title><p><xref ref-type="fig" rid="fig3">Figure 3</xref> in the Main Text illustrates that populations exhibit distinct regimes, which we refer to as collective states, as a function of the preferred speed parameter. Two states are evident in <xref ref-type="fig" rid="fig3">Figure 3</xref> in the Main Text: a state with short inter-individual distances for small <inline-formula><mml:math id="inf389"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> and a state with large inter-individual distances for large <inline-formula><mml:math id="inf390"><mml:mi>Ψ</mml:mi></mml:math></inline-formula>. A third state is evident if the mean potential energy of all individuals in the population is plotted as a function of <inline-formula><mml:math id="inf391"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> in a uniform environment, where potential energy is calculated from <xref ref-type="disp-formula" rid="equ3 equ4">Equations 3 and 4</xref> in the Main Text. For <inline-formula><mml:math id="inf392"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> there is a distinct drop in potential energy for decreasing <inline-formula><mml:math id="inf393"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig15">Appendix Figure 9</xref>). We refer to the state that occurs for <inline-formula><mml:math id="inf394"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> as <italic>station-keeping</italic> in the Main Text.</p><p>In order to better understand the behavior of agents in the context of our model, we have developed a continuum equation for the time evolution of agent density. In the context of a homogeneous environment this description can be used to predict the points in parameter space at which the uniform, purely solitary state becomes unstable, and to demonstrate that heterogeneous states cannot be stable at high enough background velocity. Although the continuum description is only an approximation, it is able to qualitatively predict many of the features of our multi-agent simulations, which makes the mechanisms responsible for this behavior mathematically more explicit. In order to derive continuum equations, we begin with a Liouville equation for the probability density of all the <inline-formula><mml:math id="inf395"><mml:mi>N</mml:mi></mml:math></inline-formula> particles within the full phase space, and derive a hierarchy of equations by taking moments (<xref ref-type="bibr" rid="bib17">Flierl et al., 1999</xref>; <xref ref-type="bibr" rid="bib5">Born and Green, 1946</xref>). This hierarchy can be closed by assuming that stochastic forces are sufficiently strong to ensure independence of the individual agents. For the analysis presented here, we assume that the agents travel at a constant velocity <inline-formula><mml:math id="inf396"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:msqrt><mml:mi>Ψ</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula> (using the angular variable <inline-formula><mml:math id="inf397"><mml:mi>θ</mml:mi></mml:math></inline-formula> to describe the direction of the velocity), and that there is noise in the angular velocity driven by a Wiener process with variance <inline-formula><mml:math id="inf398"><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> per unit time. The assumption of a constant velocity implies that we have taken a limit where <inline-formula><mml:math id="inf399"><mml:mi>η</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf400"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf401"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> go to infinity, though their ratios remain constant. We will let <inline-formula><mml:math id="inf402"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf403"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> stand for the limiting ratios of the original model. We will denote the space of positions by <inline-formula><mml:math id="inf404"><mml:mi>V</mml:mi></mml:math></inline-formula>, which will be a 2-torus with length <inline-formula><mml:math id="inf405"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The assumption of a constant velocity and of angular noise lead only to small quantitative changes in agent behavior, and they make it possible to analyze the resulting equations.</p><p>Therefore we begin with the following set of stochastic differential equations:</p><p><disp-formula id="equ21"><label>(A16)</label><mml:math id="m21"><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>cos</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mn/><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:math></disp-formula></p><p><disp-formula id="equ22"><label>(A17)</label><mml:math id="m22"><mml:mi>d</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>sin</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mn/><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:math></disp-formula></p><p><disp-formula id="equ23"><label>(A18)</label><mml:math id="m23"><mml:mi>d</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mn/><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mn/></mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mi>sin</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:msub><mml:mi>Γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mn/><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:msqrt><mml:mi>d</mml:mi><mml:mi>W</mml:mi></mml:math></disp-formula></p><p>Here <inline-formula><mml:math id="inf406"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the social force on agent <inline-formula><mml:math id="inf407"><mml:mi>i</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf408"><mml:msub><mml:mi>Γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the angular direction of the social force on agent <inline-formula><mml:math id="inf409"><mml:mi>i</mml:mi></mml:math></inline-formula>. We assume that this force is produced through a topological interaction of the following form:</p><p><disp-formula id="equ24"><label>(A19)</label><mml:math id="m24"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder></mml:mstyle><mml:mo>−</mml:mo><mml:mo>∇</mml:mo><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:math></disp-formula></p><p>Here <inline-formula><mml:math id="inf410"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the set of <inline-formula><mml:math id="inf411"><mml:mi>k</mml:mi></mml:math></inline-formula> closest neighbors to agent <inline-formula><mml:math id="inf412"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf413"><mml:mi>w</mml:mi></mml:math></inline-formula> is an interaction kernel.</p><p>From these equations, we are able to write a Liouville equation by introducing a probability density on phase space, <inline-formula><mml:math id="inf414"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mo>{</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>{</mml:mo><mml:mi>θ</mml:mi><mml:mo>}</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula>, where <inline-formula><mml:math id="inf415"><mml:mo>{</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>}</mml:mo><mml:mn/></mml:math></inline-formula> is the set of <inline-formula><mml:math id="inf416"><mml:mi>N</mml:mi></mml:math></inline-formula> agent positions and <inline-formula><mml:math id="inf417"><mml:mrow><mml:mo>{</mml:mo><mml:mn/><mml:mi>θ</mml:mi><mml:mo>}</mml:mo><mml:mn/></mml:mrow></mml:math></inline-formula> is the set of <inline-formula><mml:math id="inf418"><mml:mi>N</mml:mi></mml:math></inline-formula> agent directions. The value of <inline-formula><mml:math id="inf419"><mml:mi>P</mml:mi></mml:math></inline-formula> at a given set of positions and directions is the probability that the each of the agents have the specified positions and directions. The Liouville equation is:</p><p><disp-formula id="equ25"><label>(A20)</label><mml:math id="m25"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mover><mml:mi>e</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mspace linebreak="newline"/><mml:mfenced><mml:mrow><mml:mi>P</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mo>{</mml:mo><mml:mi>θ</mml:mi><mml:mo>}</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mi>F</mml:mi><mml:mtext>(</mml:mtext><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mi>sin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Γ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mspace linebreak="newline"/><mml:mo>=</mml:mo><mml:mi>ε</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>In order to simplify this equation, we assume that the probability density function <inline-formula><mml:math id="inf420"><mml:mi>P</mml:mi></mml:math></inline-formula> can be factorized into the product of <inline-formula><mml:math id="inf421"><mml:mi>N</mml:mi></mml:math></inline-formula> identical single particle probability density functions:</p><p><disp-formula id="equ26"><label>(A21)</label><mml:math id="m26"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mo>{</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>}</mml:mo><mml:mn>,</mml:mn><mml:mo>{</mml:mo><mml:mi>θ</mml:mi><mml:mo>}</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mn/><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mn>,</mml:mn><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>This assumption is equivalent to assuming statistical independence of the positions and directions of the agents, a condition which could be reached either through large stochasticity <inline-formula><mml:math id="inf422"><mml:mi>ε</mml:mi></mml:math></inline-formula> or ergodic single particle trajectories. The assumption allows us to derive a closed equation for the single particle probability density function <inline-formula><mml:math id="inf423"><mml:mi>p</mml:mi></mml:math></inline-formula>, in a similar fashion to a closure of the usual BBGKY hierarchy in kinetic theory.</p><p>Then, we are able to write the following equation for the single agent probability density function <inline-formula><mml:math id="inf424"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>θ</mml:mi><mml:mn>,</mml:mn><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:math></inline-formula> (where we have replaced a binomial distribution with a Poisson distribution):</p><p><disp-formula id="equ27"><label>(A22)</label><mml:math id="m27"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mover><mml:mi>e</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>θ</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mfenced><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>×</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:msub><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mo>'</mml:mo><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mn>,</mml:mn><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mn/><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:mfenced><mml:mspace linebreak="newline"/><mml:mo>=</mml:mo><mml:mn/><mml:mi>ε</mml:mi><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>Here, the expression <inline-formula><mml:math id="inf425"><mml:mi>λ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula> is the expected number of agents within a distance <inline-formula><mml:math id="inf426"><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mn/></mml:math></inline-formula> from the point <inline-formula><mml:math id="inf427"><mml:mi>x</mml:mi></mml:math></inline-formula>, the function <inline-formula><mml:math id="inf428"><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula> is the social potential between two particles, and the expression <inline-formula><mml:math id="inf429"><mml:mi>Γ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula> is the angle of force from an agent located at <inline-formula><mml:math id="inf430"><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mn/></mml:math></inline-formula> to an agent located at <inline-formula><mml:math id="inf431"><mml:mi>x</mml:mi></mml:math></inline-formula>:</p><p><disp-formula id="equ28"><label>(A23)</label><mml:math id="m28"><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mn/><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:msup><mml:mi>λ</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>!</mml:mo><mml:mn/></mml:mrow></mml:mfrac><mml:mo/><mml:mrow><mml:mo>|</mml:mo><mml:mo>∇</mml:mo><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mn/></mml:mrow><mml:mo/><mml:mi>sin</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>Γ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ29"><label>(A24)</label><mml:math id="m29"><mml:mi>λ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:mn/><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:mfenced><mml:mn/></mml:mrow></mml:msub><mml:mn/><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msubsup><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>'</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>'</mml:mo><mml:mn>,</mml:mn><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ30"><label>(A25)</label><mml:math id="m30"><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:mn/><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:mn/><mml:msub><mml:mi>l</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msup></mml:math></disp-formula></p><p><disp-formula id="equ31"><label>(A26)</label><mml:math id="m31"><mml:mi>Γ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mo> </mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:mi>arg</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:msub><mml:mo>∇</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:math></disp-formula></p><p>The presence of the terms involving <inline-formula><mml:math id="inf432"><mml:mi>λ</mml:mi></mml:math></inline-formula> are a consequence of the topological interaction law between the agents. This equation is most accurate in the limit where <inline-formula><mml:math id="inf433"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, where <inline-formula><mml:math id="inf434"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a characteristic density and <inline-formula><mml:math id="inf435"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the characteristic length scale of the interaction. In the examples which we considered in our study, this ratio is typically only slightly larger than 1 (see <xref ref-type="bibr" rid="bib29">Peshkov et al., 2012</xref>; <xref ref-type="bibr" rid="bib7">Chou et al., 2012</xref>) for derivations of continuum descriptions of topological interactions in a more collisional regime). Despite that, we find both quantitative and qualitative agreement between the continuum description and the agent based model. This kinetic description can be converted into a hierarchy of fluid equations by taking moments with respect to the angular direction variable <inline-formula><mml:math id="inf436"><mml:mi>θ</mml:mi></mml:math></inline-formula>.</p><p>We introduce the phase space particle density <inline-formula><mml:math id="inf437"><mml:mi>f</mml:mi></mml:math></inline-formula>:</p><p><disp-formula id="equ32"><label>(A27)</label><mml:math id="m32"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn/><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></disp-formula></p><p>The Fourier series for <inline-formula><mml:math id="inf438"><mml:mi>f</mml:mi></mml:math></inline-formula> gives the important macroscopic variables, for instance:</p><p><disp-formula id="equ33"><label>(A28)</label><mml:math id="m33"><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msubsup><mml:mn/><mml:mi>f</mml:mi><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msubsup><mml:mn/><mml:mi>f</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mn/><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msubsup><mml:mn/><mml:mi>f</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mn/><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:math></disp-formula></p><p>Here <inline-formula><mml:math id="inf439"><mml:mi>u</mml:mi></mml:math></inline-formula> is the mean velocity of agents at each point in space. We will take moments of the kinetic equation through Fourier series:</p><p><disp-formula id="equ34"><label>(A29)</label><mml:math id="m34"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:munderover><mml:mn/><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mn/><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:math></disp-formula></p><p>The time evolution equation for the <inline-formula><mml:math id="inf440"><mml:mi>m</mml:mi></mml:math></inline-formula>th Fourier coefficient is:</p><p><disp-formula id="equ35"><label>(A30)</label><mml:math id="m35"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:mrow><mml:mfenced><mml:mrow><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfenced><mml:mrow><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace linebreak="newline"/><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mo>|</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>ρ</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mfenced><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>Θ</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>ρ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mi>Θ</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>ρ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ε</mml:mi><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub></mml:math></disp-formula></p><p>Here, we have simplified this expression by introducing two new functionals of the density, <inline-formula><mml:math id="inf441"><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>ρ</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula> and <inline-formula><mml:math id="inf442"><mml:mi>Θ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>ρ</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula>, which represent the social force exerted at the point <inline-formula><mml:math id="inf443"><mml:mi>x</mml:mi></mml:math></inline-formula> due to the density <inline-formula><mml:math id="inf444"><mml:mi>ρ</mml:mi></mml:math></inline-formula> and the direction of that social force. Explicitly these are given by:</p><p><disp-formula id="equ36"><label>(A31)</label><mml:math id="m36"><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>ρ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mi>V</mml:mi></mml:msub><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:msup><mml:mi>λ</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>!</mml:mo><mml:mn/></mml:mrow></mml:mfrac><mml:mo>∇</mml:mo><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mn/><mml:mfrac><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:math></disp-formula></p><p><disp-formula id="equ37"><label>(A32)</label><mml:math id="m37"><mml:mi>Θ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>ρ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:mi>arg</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>ρ</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:math></disp-formula></p><p>The evolution of the <inline-formula><mml:math id="inf445"><mml:mi>m</mml:mi></mml:math></inline-formula>th moment depends on the value of the <inline-formula><mml:math id="inf446"><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>st moment, so that we have an infinite hierarchy of equations. Moments with high values of <inline-formula><mml:math id="inf447"><mml:mrow><mml:mo>|</mml:mo><mml:mn/><mml:mi>m</mml:mi><mml:mo>|</mml:mo><mml:mn/></mml:mrow></mml:math></inline-formula> experience strong damping, and we can use this to justify discarding all moments with <inline-formula><mml:math id="inf448"><mml:mrow><mml:mo>|</mml:mo><mml:mn/><mml:mi>m</mml:mi><mml:mo>|</mml:mo><mml:mn/></mml:mrow></mml:math></inline-formula> above a given threshold. In the following treatment we will set to zero all Fourier coefficients with <inline-formula><mml:math id="inf449"><mml:mrow><mml:mo>|</mml:mo><mml:mn/><mml:mi>m</mml:mi><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, which is the simplest truncation of the hierarchy that leads to non-trivial equations.</p><p><disp-formula id="equ38"><label>(A33)</label><mml:math id="m38"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo>∇</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>ρ</mml:mi><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></disp-formula></p><p><disp-formula id="equ39"><label>(A34)</label><mml:math id="m39"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>ρ</mml:mi><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mn>2</mml:mn></mml:mfrac><mml:mo>∇</mml:mo><mml:mi>ρ</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>ρ</mml:mi><mml:mo>)</mml:mo><mml:mn/><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:mi>ε</mml:mi><mml:mi>ρ</mml:mi><mml:mi>u</mml:mi></mml:math></disp-formula></p><p>The right hand side of the momentum equation leads to rapid equilibration, and we can eliminate the time derivative in this equation. This allows us to find an expression for <inline-formula><mml:math id="inf450"><mml:mi>ρ</mml:mi><mml:mi>u</mml:mi></mml:math></inline-formula> in terms of <inline-formula><mml:math id="inf451"><mml:mi>ρ</mml:mi></mml:math></inline-formula> only:</p><p><disp-formula id="equ40"><label>(A35)</label><mml:math id="m40"><mml:mi>ρ</mml:mi><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:mfrac><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mo>∇</mml:mo><mml:mi>ρ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mn>,</mml:mn><mml:mi>ρ</mml:mi><mml:mo>)</mml:mo><mml:mn/><mml:mi>ρ</mml:mi></mml:math></disp-formula></p><p>We can use this to write a single closed equation for <inline-formula><mml:math id="inf452"><mml:mi>ρ</mml:mi></mml:math></inline-formula>. In order to facilitate the analysis of this equation, we make one further approximation, replacing the sum over Poisson factors with a Heaviside function that is equal to <inline-formula><mml:math id="inf453"><mml:mn>1</mml:mn></mml:math></inline-formula> if the expected number of agents between inside a ball of size <inline-formula><mml:math id="inf454"><mml:mi>x</mml:mi><mml:mo>'</mml:mo></mml:math></inline-formula> is less than <inline-formula><mml:math id="inf455"><mml:mi>k</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf456"><mml:mn>0</mml:mn></mml:math></inline-formula> otherwise. This captures the dominant qualitative feature of the topological interaction in a simple way: the effective interaction radius is a function of the local density. This approximation is quantitatively consistent with the assumptions of the previous section and the results of our simulations. The resulting equation is:</p><p><disp-formula id="equ41"><label>(A36)</label><mml:math id="m41"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo>∇</mml:mo><mml:mo>⋅</mml:mo><mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mo>∇</mml:mo><mml:mi>ρ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mn/><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>ρ</mml:mi><mml:mn>,</mml:mn><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:msub><mml:mo>∇</mml:mo><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mn/><mml:mi>ρ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mn/><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></disp-formula></p><p><disp-formula id="equ42"><label>(A37)</label><mml:math id="m42"><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>ρ</mml:mi><mml:mn>,</mml:mn><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:msqrt><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:mfrac></mml:msqrt></mml:math></disp-formula></p><p>The advection-diffusion equation will be used to understand the behavior of our multi-agent simulations. From its form one can see the effects of <inline-formula><mml:math id="inf457"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>: large <inline-formula><mml:math id="inf458"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> enhances the diffusivity and reduces the effects of the potential.</p><sec id="s29"><title>5.1 Formation of the cohesive state and stability of the dispersed state</title><p>Any constant density function <inline-formula><mml:math id="inf459"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is an equilibrium solution of <xref ref-type="disp-formula" rid="equ41">Equation A36</xref>. A crucial property of our multi-agent model is that depending on the background velocity, the agents have the ability to spontaneously form a dense state which we call the cohesive state. In order for this to be possible, the uniform state must be unstable. One advantage of the continuum description is that it allows us to investigate such questions within a much simpler framework than in the original agent based model. In order to do so, we select a uniform state with value <inline-formula><mml:math id="inf460"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and linearize around it, neglecting terms second order or higher in the deviation away from <inline-formula><mml:math id="inf461"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>:</p><p><disp-formula id="equ43"><label>(A38)</label><mml:math id="m43"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:mo>∇</mml:mo><mml:mo>⋅</mml:mo><mml:mfenced><mml:mrow><mml:mfrac><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mo>∇</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mn/><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>∇</mml:mo><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mn/><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mn/><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>x</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p><disp-formula id="equ44"><label>(A39)</label><mml:math id="m44"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:msqrt><mml:mrow><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:math></disp-formula></p><p>This is translationally invariant, and we have periodic boundary conditions, so we consider the Fourier coefficients of <inline-formula><mml:math id="inf462"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>:</p><p><disp-formula id="equ45"><label>(A40)</label><mml:math id="m45"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mover><mml:mi>ρ</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mn>1,</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:msub><mml:mover><mml:mi>ρ</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mn>1,</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mn/><mml:msup><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>|</mml:mo><mml:mn/><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mi>ε</mml:mi><mml:msubsup><mml:mi>L</mml:mi><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The term <inline-formula><mml:math id="inf463"><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula> can be calculated by application of the convolution theorem and integration by parts, using the fact that the integrals are radially symmetric (which is true as long as <inline-formula><mml:math id="inf464"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn/><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>):</p><p><disp-formula id="equ46"><label>(A41)</label><mml:math id="m46"><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mi>V</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>⋅</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mfrac></mml:msup><mml:mo>∇</mml:mo><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mn/><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mn/><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mn/><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi></mml:math></disp-formula></p><p><disp-formula id="equ47"><label>(A42)</label><mml:math id="m47"><mml:mo>=</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msubsup><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mn/><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mn/></mml:mrow><mml:mrow><mml:mi>ε</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>|</mml:mo><mml:mn/><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mn/><mml:mi>r</mml:mi></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mfrac></mml:mfenced></mml:math></disp-formula></p><p>Here <inline-formula><mml:math id="inf465"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> stand for the corresponding Bessel functions of the first kind. Linear stability is determined by the sign of the coefficient on <inline-formula><mml:math id="inf466"><mml:msub><mml:mover><mml:mi>ρ</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mn>1,</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> on the right hand side of the following expression:</p><p><disp-formula id="equ48"><label>(A43)</label><mml:math id="m48"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mover><mml:mi>ρ</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mn>1,</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:mn/><mml:mi>j</mml:mi><mml:msup><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi>ε</mml:mi><mml:msubsup><mml:mi>L</mml:mi><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:msub><mml:mover><mml:mi>ρ</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mn>1,</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mn/><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mn/><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msubsup><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>|</mml:mo><mml:mn/><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mn/><mml:mi>r</mml:mi></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>We can use our formula to determine the stability or instability of an arbitrary homogeneous equilibrium solution. We have plotted an example of this in <xref ref-type="fig" rid="fig16">Appendix Figure 10</xref>. A number of general features emerge from these diagrams. Increases in the background velocity <inline-formula><mml:math id="inf467"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> always promotes stability of the dispersed state. The agents make use of this feature to enable themselves to transition from the dispersed state to the cohesive state in regions where <inline-formula><mml:math id="inf468"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> crosses below the stability threshold. Increases in the number of interaction neighbors <inline-formula><mml:math id="inf469"><mml:mi>k</mml:mi></mml:math></inline-formula>, the decay length of the attractive interaction <inline-formula><mml:math id="inf470"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and the strength of the attractive interaction <inline-formula><mml:math id="inf471"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> all promote instability of the dispersed state, though at large <inline-formula><mml:math id="inf472"><mml:mi>k</mml:mi></mml:math></inline-formula> further increases in <inline-formula><mml:math id="inf473"><mml:mi>k</mml:mi></mml:math></inline-formula> have little effect. The background density of agents has a more complicated effect on the stability of the dispersed state, when <inline-formula><mml:math id="inf474"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is low the social forces are very weak because the distance between agents is large, so that a very small <inline-formula><mml:math id="inf475"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is required for formation of the dispersed state. When <inline-formula><mml:math id="inf476"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> gets too large, the repulsive part of the interaction becomes more important and stability of the dispersed state is promoted.<fig id="fig16" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.022</object-id><label>Appendix figure 10.</label><caption><title>Regions of parameter space where <italic>dispersed</italic> state is stable (white) and unstable (black).</title><p>Instability of dispersed state causes transition to <italic>cohesive</italic> state. (<bold><bold>A</bold></bold>) Sensitivity to <italic>l<sub>a</sub></italic>, for <italic>ρ</italic> = .0025, <italic>K</italic> = 25, <italic>l<sub>r</sub></italic> = 1.0, <italic>C<sub>a </sub></italic>= 1.0, <italic>C<sub>r </sub></italic>= 1.1. Increasing <italic>l<sub>a</sub> </italic>promotes instability and formation of the <italic>cohesive</italic> state, as does decreased <italic>v</italic><sub>0</sub>. (<bold><bold>B</bold></bold>) Sensitivity to <italic>K</italic>, for <italic>ρ</italic> = .0025, <italic>l<sub>a</sub></italic> = 7.5, <italic>l<sub>r</sub></italic> = 1.0, <italic>C<sub>a </sub></italic>= 1.0, <italic>C<sub>r </sub></italic>= 1.1. Increasing <italic>K</italic> promotes instability and formation of the <italic>cohesive</italic> state, as does decreased <italic>v</italic><sub>0</sub>. Large values of <italic>K</italic> lead to roughly the same stability properties, due to the exponential decay of the interaction with length. (<bold>C</bold>) Sensitivity to <italic>C<sub>a</sub></italic>, for <italic>ρ</italic> = .0025, <italic>l<sub>a</sub></italic> = 7.5, <italic>l<sub>r</sub></italic> = 1.0, <italic>K</italic> = 25, <italic>C<sub>r </sub></italic>= 1.1. Increasing <italic>C<sub>a</sub></italic> promotes instability and formation of the cohesive state, as does decreased <italic>v</italic><sub>0</sub>. (<bold><bold>D</bold></bold>) Sensitivity to <italic>ρ</italic>. Smaller <italic>v</italic><sub>0</sub> promotes instability. When <italic>ρ</italic> is very small, increasing<italic> ρ</italic> makes instability more likely.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.022">http://dx.doi.org/10.7554/eLife.10955.022</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig10-v3.tif"/></fig></p></sec><sec id="s30"><title>5.2 Nonlinear stability of the dispersed state for high <inline-formula><mml:math id="inf477"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></title><p><xref ref-type="disp-formula" rid="equ41">Equation A36</xref> combines a diffusive term with effective diffusion coefficient <inline-formula><mml:math id="inf478"><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, and a term due to the social forces, which is proportional to the magnitude of the social forces and <inline-formula><mml:math id="inf479"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. On the basis of this, we expect that as <inline-formula><mml:math id="inf480"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> increases the diffusive terms become more important relative to the social forces. In the linear stability analysis, this manifested itself through instability of the homogeneous base state when <inline-formula><mml:math id="inf481"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> was decreased below a threshold. When <inline-formula><mml:math id="inf482"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is large enough, we are able to prove using energy inequalities (<xref ref-type="bibr" rid="bib15">Doering and Gibbon, 1995</xref>) that the homogeneous equilibrium state is a global attractor. The implication of this is that above a certain threshold the cohesive state can no longer exist, and all the agents enter the dispersed state. Combined with the results of the previous subsection, this provides an analytical demonstration of the hysteresis that we observe in our multi-agent model.</p><p>In order to establish these results, we rewrite the dynamical equation for <inline-formula><mml:math id="inf483"><mml:mi>ρ</mml:mi></mml:math></inline-formula> in terms of the deviation from the mean density <inline-formula><mml:math id="inf484"><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn/><mml:mstyle displaystyle="true"><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mfrac><mml:mi>ρ</mml:mi><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>. We define <inline-formula><mml:math id="inf485"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:mi>ρ</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. Then the equation for <inline-formula><mml:math id="inf486"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is:</p><p><disp-formula id="equ49"><label>(A44)</label><mml:math id="m49"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo>∇</mml:mo><mml:mo>⋅</mml:mo><mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mo>∇</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mover><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:msub><mml:mo>∇</mml:mo><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></disp-formula></p><p>We multiply by <inline-formula><mml:math id="inf487"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> on both sides of the equation and integrate:</p><p><disp-formula id="equ50"><label>(A45)</label><mml:math id="m50"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>∥</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mo>∥</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mo>∥</mml:mo><mml:mo>∇</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mo>∥</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mi>V</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mover><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mo>∇</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>∇</mml:mo><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:mspace linebreak="newline"/><mml:mo>-</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mi>V</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mo>∇</mml:mo><mml:mo>⋅</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>∇</mml:mo><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi></mml:math></disp-formula></p><p>Here the expression <inline-formula><mml:math id="inf488"><mml:mo>∥</mml:mo><mml:mi>f</mml:mi><mml:msub><mml:mo>∥</mml:mo><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mi>V</mml:mi></mml:msub><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:msup><mml:mo>|</mml:mo><mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:mfenced><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the standard <inline-formula><mml:math id="inf489"><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> norm on the space <inline-formula><mml:math id="inf490"><mml:mi>V</mml:mi></mml:math></inline-formula>. The first term on the right hand side can be bounded through use of the Poincare inequality for a mean zero function on the torus:</p><p><disp-formula id="equ51"><label>(A46)</label><mml:math id="m51"><mml:mo>∥</mml:mo><mml:mo>∇</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mo>∥</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>≥</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mo>∥</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mo>∥</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></disp-formula></p><p>The second term on the right hand side can be simplified by performing integration by parts in order to transfer the gradient operators onto the <inline-formula><mml:math id="inf491"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> terms:</p><p><disp-formula id="equ52"><label>(A47)</label><mml:math id="m52"><mml:mfenced close="|" open="|"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mover><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:msub><mml:mo>∫</mml:mo><mml:mi>V</mml:mi></mml:msub><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced><mml:mi>x</mml:mi></mml:mfenced><mml:mo>∇</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>∇</mml:mo><mml:mi>ω</mml:mi><mml:mfenced><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:mfenced></mml:mfenced><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced><mml:mrow><mml:mi>x</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mover><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mfenced><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>∇</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mfenced><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mfenced close="|" open="|"><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>∇</mml:mo><mml:mi>ω</mml:mi><mml:mfenced><mml:mfenced close="|" open="|"><mml:mi>x</mml:mi></mml:mfenced></mml:mfenced><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:math></disp-formula></p><p>Here we have made use of Young’s Inequality, which states that <inline-formula><mml:math id="inf492"><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>f</mml:mi><mml:mo>*</mml:mo><mml:mi>g</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mi>r</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>f</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mo>|</mml:mo><mml:mi>p</mml:mi></mml:msub><mml:mo>·</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>g</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula> when <inline-formula><mml:math id="inf493"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>r</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>.</p><p>The third term on the right hand side is the most difficult to deal with because it contains three powers of <inline-formula><mml:math id="inf494"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. To bound this term we make use of the fact that the density <inline-formula><mml:math id="inf495"><mml:mi>ρ</mml:mi></mml:math></inline-formula> is always positive, which implies that <inline-formula><mml:math id="inf496"><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:mover><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>. Then, because <inline-formula><mml:math id="inf497"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> has zero mean, we can bound <inline-formula><mml:math id="inf498"><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>:</p><p><disp-formula id="equ53"><label>(A48)</label><mml:math id="m53"><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mn>2</mml:mn><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mover><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:math></disp-formula></p><p>Using this expression (and Young’s Inequality), we find that:</p><p><disp-formula id="equ54"><label>(A49)</label><mml:math id="m54"><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mi>V</mml:mi></mml:msub><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∇</mml:mo><mml:mo>·</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>∇</mml:mo><mml:mi>ω</mml:mi><mml:mfenced><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:mfenced></mml:mfenced><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced><mml:mrow><mml:mi>x</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mn>2</mml:mn><mml:mfenced><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mi>V</mml:mi></mml:msub><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mover><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>∇</mml:mo><mml:mi>ω</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mo>∞</mml:mo></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>∇</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msub></mml:math></disp-formula></p><p>Using these bounds, we can write a differential inequality for <inline-formula><mml:math id="inf499"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>:</p><p><disp-formula id="equ55"><label>(A50)</label><mml:math id="m55"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mrow/><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mstyle></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:msubsup><mml:mi>ν</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mn>2</mml:mn><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mover><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mfenced><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mfenced close="|" open="|"><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>∇</mml:mo><mml:mi>w</mml:mi><mml:mfenced><mml:mfenced close="|" open="|"><mml:mi>x</mml:mi></mml:mfenced></mml:mfenced><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msubsup><mml:mi>L</mml:mi><mml:mi>D</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mover><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>∇</mml:mo><mml:mi>w</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mo>∞</mml:mo></mml:msub></mml:mrow></mml:mfenced><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>∇</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mover><mml:msub><mml:mrow/><mml:mn>2</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mover></mml:math></disp-formula></p><p>If <italic>v</italic><sub>0</sub> satisfies the following inequality:</p><p><disp-formula id="equ56"><label>(A51)</label><mml:math id="m56"><mml:msub><mml:mi>ν</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≥</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mover><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo> </mml:mo><mml:mfenced><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mfenced><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfenced><mml:mo>∇</mml:mo><mml:mi>w</mml:mi><mml:mfenced><mml:mrow><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfenced><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>L</mml:mi><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>∇</mml:mo><mml:mi>w</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mo>∞</mml:mo></mml:msub></mml:mrow></mml:mfenced></mml:msqrt></mml:math></disp-formula></p><p>then the coefficient of <inline-formula><mml:math id="inf500"><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>∇</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> in the differential inequality is negative, and we can apply the Poincare inequality to find:</p><p><disp-formula id="equ57"><label>(A52)</label><mml:math id="m57"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mi>ε</mml:mi><mml:msubsup><mml:mi>L</mml:mi><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>π</mml:mi><mml:mover><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mo>∇</mml:mo><mml:mi>ω</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>ε</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow><mml:mi>ε</mml:mi></mml:mfrac><mml:menclose notation="top"><mml:mi>ρ</mml:mi></mml:menclose><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>∇</mml:mo><mml:mi>ω</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mo>∞</mml:mo></mml:msub></mml:mrow></mml:mfenced><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></disp-formula></p><p>This inequality allows us to use Gronwall’s lemma (<xref ref-type="bibr" rid="bib15">Doering and Gibbon, 1995</xref>) to prove <inline-formula><mml:math id="inf501"><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> that converges to 0 as a function of time, which implies that the homogeneous state is globally attractive for sufficiently large <italic>v</italic><sub>0</sub>.</p></sec><sec id="s31"><title>5.3 Conclusion from continuum model</title><p>The simulations of the agent based model indicated that our agents possessed two properties: for small <inline-formula><mml:math id="inf502"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> a cohesive state forms spontaneously, for large <inline-formula><mml:math id="inf503"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> only dispersed states are possible, and for moderate values of <inline-formula><mml:math id="inf504"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> both cohesive and dispersed states are possible. We were able to create a continuum model that demonstrates the mechanisms behind these numerical observations. We showed that for small <inline-formula><mml:math id="inf505"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, homogeneous background states are linearly unstable to the formation of clumped states. For larger <inline-formula><mml:math id="inf506"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, the homogeneous background states are linearly stable. Further, we showed that for sufficiently large <inline-formula><mml:math id="inf507"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, the homogeneous state is globally attractive, so that clumped states are not possible.</p></sec><sec id="s32"><title>5.4 Some additional properties of the transition between collective states: nucleation rates and hysteresis</title><p>In the theory of first order phase transitions, hysteresis often arises because there is a free energy penalty for small droplets of the stable phase. This leads to extremely low probabilities of critical droplet formation near the transition temperature. In order to test whether this effect is responsible for the hysteresis in our model equations, we performed long time numerical simulations using values of <inline-formula><mml:math id="inf508"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> within the hysteresis region, allowing us to estimate the nucleation rate of the cohesive phase. We performed replicate simulations with <inline-formula><mml:math id="inf509"><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> agents, restarting the simulations each time the agents were able to form the cohesive state. The results of this simulation are shown in <xref ref-type="fig" rid="fig17">Appendix Figures 11</xref> and <xref ref-type="fig" rid="fig18">12</xref>, illustrating the super-exponential growth in the mean nucleation time as <inline-formula><mml:math id="inf510"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> increases. This growth in nucleation times corresponds to an increase in the minimum radius of a stable group. When <inline-formula><mml:math id="inf511"><mml:mi>Ψ</mml:mi></mml:math></inline-formula> increases above 1.7, the expected time for nucleating the cohesive state becomes extremely large, leading to strong hysteresis. We also computed <inline-formula><mml:math id="inf512"><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mover><mml:mi>T</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msqrt></mml:mfrac></mml:math></inline-formula> to illustrate the approximate scaling of the nucleation time (<xref ref-type="fig" rid="fig18">Appendix Figure 12</xref>). Because we use a topological interaction, we do not necessarily expect this scaling to hold for much larger values of <inline-formula><mml:math id="inf513"><mml:mi>Ψ</mml:mi></mml:math></inline-formula>, as groups with <inline-formula><mml:math id="inf514"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math></inline-formula> will have an increasing, rather than constant, potential energy per particle.<fig id="fig17" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.023</object-id><label>Appendix Figure 11.</label><caption><title>Mean nucleation time as a function of Ψ in the hysteresis region.</title><p>Bars show mean nucleation time calculated from replicate simulations in which individuals begin the simulation with random starting positions. Simulation was ended when an agent reached a social potential value &lt; −14, which is only possible if a dense group has formed. For each simulation, we denoted the time taken to satisfy this condition as the nucleation time. Parameter values taken from population at ESSt described above.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.023">http://dx.doi.org/10.7554/eLife.10955.023</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig11-v3.tif"/></fig><fig id="fig18" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.024</object-id><label>Appendix Figure 12.</label><caption><title>Approximate scaling of mean nucleation time with Ψ in the hysteresis region.</title><p>Data from <xref ref-type="fig" rid="fig17">Appendix Figure 11</xref>. Black points show means. White points are ± 1 standard deviation. Note that the nucleation time is super-exponential in Ψ indicating that the probability of nucleation becomes extremely small as Ψ approaches the upper boundary of the hysteresis region.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.024">http://dx.doi.org/10.7554/eLife.10955.024</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig12-v3.tif"/></fig></p></sec></sec><sec id="s33" sec-type="appendix"><title>6 Social gradient climbing and aggregation on a resource peak</title><p>In this section we derive a model of collective exploration and exploitation that allows us to understand how the ability of agents to find the resource peak changes when model parameters like <inline-formula><mml:math id="inf515"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> or sociality are varied. We model agents as being either in a cohesive state near a resource peak or in a dispersed state. Using the model parameters and some simple assumptions about the dynamics, we calculate the fraction of particles approaching the resource peak that are able to enter the cohesive state. Using this model, we quantitatively estimate the rate at which agents are able to find the peak and the advantage of social agents versus asocial agents. We begin by stating a number of assumptions, each of which arises from some feature of our multi-agent model, that help make our theoretical analysis tractable.</p><sec id="s34"><title>6.1 Assumptions</title><list list-type="order"><list-item><p>The environmental response function is <inline-formula><mml:math id="inf516"><mml:mi>Ψ</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>A</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:math></inline-formula>, indicating a single peak located at the origin and a preferred background velocity of <inline-formula><mml:math id="inf517"><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msqrt></mml:math></inline-formula> in regions far from the resource peak.</p></list-item><list-item><p>Agents travel at the speed dictated by the environmental response function Ψ, so that <inline-formula><mml:math id="inf518"><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mi>Ψ</mml:mi></mml:msqrt></mml:math></inline-formula>. Only the direction of the velocity is allowed to vary.</p></list-item><list-item><p>Particles exist in one of two states, the cohesive state or the dispersed state. Particles in the cohesive state are close to the resource peak. Particles in the dispersed state have a uniform probability distribution in space and in direction. Particles in the cohesive state collectively produce a potential <inline-formula><mml:math id="inf519"><mml:msub><mml:mi>Φ</mml:mi><mml:mi>peak</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:msup><mml:mo> </mml:mo></mml:math></inline-formula>.</p></list-item><list-item><p>Agents in the dispersed state interact only with particles in the cohesive state, and this interaction is cutoff for distances <inline-formula><mml:math id="inf520"><mml:mi>r</mml:mi><mml:mo> </mml:mo><mml:mo>&gt;</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:math></inline-formula>. The potential force is projected normal to the velocity of the agents so that it can only effect the agent directions.</p></list-item><list-item><p>An agent enters the cohesive state if it has a trajectory that reaches the radius of zero velocity, <inline-formula><mml:math id="inf521"><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow/></mml:msub><mml:msqrt><mml:mi>log</mml:mi><mml:mfenced><mml:mfrac><mml:msub><mml:mrow/><mml:mrow><mml:mi>A</mml:mi><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow/><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub></mml:mfrac></mml:mfenced></mml:msqrt></mml:math></inline-formula>, which is assumed to mark the transition between the cohesive and dispersed states.</p></list-item></list></sec><sec id="s35"><title>6.2 Critical angle for capture by the peak</title><p>Consider a particle reaching <inline-formula><mml:math id="inf522"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the radius where it begins to feel the influence of the agents on the environmental resource peak, as is depicted in <xref ref-type="fig" rid="fig19">Appendix Figure 13</xref>. If the angle of the agent’s trajectory is sufficiently directed towards the resource peak, the agent will reach the peak, and if the angle is directed sufficiently away, the agent will not reach the peak. There is a critical angle <inline-formula><mml:math id="inf523"><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> at the boundary between these two scenarios. The size of <inline-formula><mml:math id="inf524"><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> will determine the fraction of agents captured by the resource peak after crossing <inline-formula><mml:math id="inf525"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn/><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and it will also determine the flux of agents onto the resource peak.<fig id="fig19" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.025</object-id><label>Appendix Figure 13.</label><caption><title>There is a group agents on the resource peak at the origin.</title><p>These agents are contained within the a circle of radius <italic>r<sub>t</sub></italic>, corresponding to the zero velocity region. An agent enters the region of radius <italic>r<sub>M</sub></italic> and begins to feel the force from the agents on the peak. The angle of the velocity of the agent relative to the peak is ∆.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.025">http://dx.doi.org/10.7554/eLife.10955.025</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig13-v3.tif"/></fig></p><p>To derive an expression for <inline-formula><mml:math id="inf526"><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, we write equations for an agent traveling with a velocity of magnitude <inline-formula><mml:math id="inf527"><mml:mrow><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:msqrt><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>A</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mn/><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, in direction <inline-formula><mml:math id="inf528"><mml:mi>ω</mml:mi></mml:math></inline-formula>, experiencing the potential force <inline-formula><mml:math id="inf529"><mml:mo>−</mml:mo><mml:mo>∇</mml:mo><mml:msub><mml:mi>Φ</mml:mi><mml:mrow><mml:mtext>p</mml:mtext><mml:mi>eak</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula>:</p><p>Our question is the following: <italic>given initial radius</italic> <inline-formula><mml:math id="inf530"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn/><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula><italic>, initial angle</italic> <inline-formula><mml:math id="inf531"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula><italic>, and initial direction</italic> <inline-formula><mml:math id="inf532"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula><italic>, does the agent reach the zero velocity radius?</italic> The equations of motion are:</p><p><disp-formula id="equ58"><label>(A53)</label><mml:math id="m58"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/><mml:mi>cos</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:mi>ω</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:math></disp-formula></p><p><disp-formula id="equ59"><label>(A54)</label><mml:math id="m59"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mi>r</mml:mi></mml:mfrac><mml:mi>sin</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>ω</mml:mi><mml:mo>−</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:math></disp-formula></p><p><disp-formula id="equ60"><label>(A55)</label><mml:math id="m60"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Φ</mml:mi><mml:mi>peak</mml:mi><mml:mo>'</mml:mo></mml:msubsup><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:mfrac><mml:mi>sin</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>ω</mml:mi><mml:mo>−</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:math></disp-formula></p><p>We define the angle <inline-formula><mml:math id="inf533"><mml:mi>Δ</mml:mi><mml:mo>=</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo>−</mml:mo><mml:mi>ω</mml:mi><mml:mo>+</mml:mo><mml:mi>θ</mml:mi></mml:math></inline-formula>, which is the angle between the velocity vector and the vector directed from the position of the agent to the origin. Then we can rewrite our equations in terms of the variables <inline-formula><mml:math id="inf534"><mml:mi>r</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf535"><mml:mi>Δ</mml:mi></mml:math></inline-formula> alone, leading to the following planar system:</p><p><disp-formula id="equ61"><label>(A56)</label><mml:math id="m61"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/><mml:mi>cos</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>Δ</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:math></disp-formula></p><p><disp-formula id="equ62"><label>(A57)</label><mml:math id="m62"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Φ</mml:mi><mml:mi>peak</mml:mi><mml:mo>'</mml:mo></mml:msubsup><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mi>r</mml:mi></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>sin</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>Δ</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:math></disp-formula></p><p>The system of equations described here has the following properties:</p><list list-type="order"><list-item><p>If <inline-formula><mml:math id="inf536"><mml:mi>Δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, then <inline-formula><mml:math id="inf537"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, so that <inline-formula><mml:math id="inf538"><mml:mi>Δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> for all further times. Similarly, <inline-formula><mml:math id="inf539"><mml:mi>Δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> implies <inline-formula><mml:math id="inf540"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, so that any agent with <inline-formula><mml:math id="inf541"><mml:mi>Δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> will reach the zero velocity radius.</p></list-item><list-item><p>If <inline-formula><mml:math id="inf542"><mml:mo>−</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mi>Δ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn/><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:math></inline-formula>, then <inline-formula><mml:math id="inf543"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and the agent will move closer to the peak.</p></list-item><list-item><p>If both <inline-formula><mml:math id="inf544"><mml:mfenced><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Φ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mo>'</mml:mo></mml:msubsup><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mi>r</mml:mi></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf545"><mml:mo>−</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mi>Δ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn/><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:math></inline-formula>, then <inline-formula><mml:math id="inf546"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>|</mml:mo><mml:mi>Δ</mml:mi><mml:mo>|</mml:mo><mml:mn/></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, and <inline-formula><mml:math id="inf547"><mml:mi>Δ</mml:mi></mml:math></inline-formula> becomes closer to <inline-formula><mml:math id="inf548"><mml:mn>0</mml:mn></mml:math></inline-formula>.</p></list-item></list><p>We make one additional assumption, which has been true in most practical cases, that allows us to make progress with the analysis.</p><p><bold>Assumption</bold>: The function <inline-formula><mml:math id="inf549"><mml:msubsup><mml:mi>Φ</mml:mi><mml:mi>peak</mml:mi><mml:mo>'</mml:mo></mml:msubsup><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:msup><mml:mo>)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>r</mml:mi></mml:mfrac></mml:math></inline-formula> has exactly one sign change on the interval <inline-formula><mml:math id="inf550"><mml:mo>(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>∞</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula>. The location of the sign change occurs when <inline-formula><mml:math id="inf551"><mml:msubsup><mml:mi>Φ</mml:mi><mml:mi>peak</mml:mi><mml:mo>'</mml:mo></mml:msubsup><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:msup><mml:mo>)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>r</mml:mi></mml:mfrac></mml:math></inline-formula>, a point which we denote by <italic>r</italic>*. At <italic>r</italic> = <italic>r</italic>*, there is a balance between centrifugal and potential forces. We have the following inequalities:</p><p><disp-formula id="equ63"><label>(A58)</label><mml:math id="m63"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Φ</mml:mi><mml:mi>peak</mml:mi><mml:mo>'</mml:mo></mml:msubsup><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>ν</mml:mi><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>ν</mml:mi><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>r</mml:mi></mml:mfrac><mml:mo> </mml:mo><mml:mi>for</mml:mi><mml:mo> </mml:mo><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Φ</mml:mi><mml:mi>peak</mml:mi><mml:mo>'</mml:mo></mml:msubsup><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>ν</mml:mi><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>ν</mml:mi><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>r</mml:mi></mml:mfrac><mml:mo> </mml:mo><mml:mi>for</mml:mi><mml:mo> </mml:mo><mml:mi>r</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>r</mml:mi><mml:mo>*</mml:mo></mml:math></disp-formula></p><p>This assumption allows us to divide the <inline-formula><mml:math id="inf552"><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>∆</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> plane into four regions:</p><list list-type="order"><list-item><p><disp-formula id="equ64"><mml:math id="m64"><mml:mo>-</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mo>∆</mml:mo><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mtext> r &lt; r*</mml:mtext></mml:math></disp-formula></p></list-item><list-item><p><disp-formula id="equ65"><mml:math id="m65"><mml:mo>∆</mml:mo><mml:mo>&lt;</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="1em"/><mml:mtext>or</mml:mtext><mml:mspace width="1em"/><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>&lt; ∆</mml:mtext><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mtext>r &gt; r*</mml:mtext></mml:math></disp-formula></p></list-item><list-item><p><disp-formula id="equ66"><mml:math id="m66"><mml:mo>-</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mo>∆</mml:mo><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mtext>r &gt; r*</mml:mtext></mml:math></disp-formula></p></list-item><list-item><p><disp-formula id="equ67"><mml:math id="m67"><mml:mo>∆</mml:mo><mml:mo>&lt;</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="1em"/><mml:mtext>or</mml:mtext><mml:mspace width="1em"/><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>&lt;∆</mml:mtext><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mtext>r &lt; r*</mml:mtext></mml:math></disp-formula></p></list-item></list><p>In region 1, the agents move towards the peak and the potential force is stronger than the centrifugal force. In region 2, the agents move away from the peak, and the potential force is weaker than the centrifugal force. In region 3, agents move towards the peak but the potential force is weaker than the centrifugal force. In region 4, the agents move away from the peak but the potential is stronger than the centrifugal force. We conclude that:</p><list list-type="order"><list-item><p>Any trajectory that enters region 1 will reach the zero velocity radius.</p></list-item><list-item><p>Any trajectory that enters region 2 will escape to <inline-formula><mml:math id="inf553"><mml:mo>∞</mml:mo></mml:math></inline-formula>.</p></list-item></list><p>Consider again the hypothetical agent in region 3 and at radius <italic>r</italic> = <italic>r<sub>M</sub></italic>. The agent will eventually either reach region 1, region 2, or the boundary points between the two regions (which are unstable equilibria).</p><list list-type="order"><list-item><p>The points <inline-formula><mml:math id="inf554"><mml:mfenced><mml:mrow><mml:mi>r</mml:mi><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mo>±</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mfenced></mml:math></inline-formula> are unstable equilibrium points, each corresponding to a periodic orbit around the resource peak.</p></list-item><list-item><p>There are two values of Δ such that the solution of the initial value problem with initial condition (<italic>r<sub>M</sub></italic>, Δ) reach these equilibria. We call these angles <inline-formula><mml:math id="inf555"><mml:mo>±</mml:mo><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, where we define <inline-formula><mml:math id="inf556"><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>. Any trajectory with initial value <inline-formula><mml:math id="inf557"><mml:mo>(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>∆</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula>, with <inline-formula><mml:math id="inf558"><mml:mo>|</mml:mo><mml:mo>∆</mml:mo><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> will enter region I and be captured by the resource peak, and any trajectory with initial value satisfying <inline-formula><mml:math id="inf559"><mml:mo>|</mml:mo><mml:mo>∆</mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> will enter region II and escape the resource peak.</p></list-item></list><p>The angle <inline-formula><mml:math id="inf560"><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the critical angle that we seek.</p></sec><sec id="s36"><title>6.3 Solving the reduced system</title><p>Instead of considering the time dependent differential equation, we search for an equation that describes the shape of a trajectory, that is, we assume <inline-formula><mml:math id="inf561"><mml:mi>Δ</mml:mi></mml:math></inline-formula> is a single valued function of <inline-formula><mml:math id="inf562"><mml:mi>r</mml:mi></mml:math></inline-formula>, and use the original equation in combination with the chain rule to write a differential equation for <inline-formula><mml:math id="inf563"><mml:mi>Δ</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula>. This method is valid in regions where <inline-formula><mml:math id="inf564"><mml:mi>Δ</mml:mi></mml:math></inline-formula> is actually a single-valued function of <inline-formula><mml:math id="inf565"><mml:mi>r</mml:mi></mml:math></inline-formula>, and for this to be the case integration must be restricted to regions where <inline-formula><mml:math id="inf566"><mml:msubsup><mml:mi>Φ</mml:mi><mml:mi>peak</mml:mi><mml:mo>'</mml:mo></mml:msubsup><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mi>r</mml:mi></mml:mfrac></mml:math></inline-formula> has only one sign. The resulting equation will be valid only while a trajectory is in region <inline-formula><mml:math id="inf567"><mml:mn>3</mml:mn></mml:math></inline-formula>, and the coefficients of this equation will blow up at the border of region <inline-formula><mml:math id="inf568"><mml:mn>3</mml:mn></mml:math></inline-formula>.</p><p>The quotient of <xref ref-type="disp-formula" rid="equ61 equ62">Equation A56 and A57</xref> is the desired equation:</p><p><disp-formula id="equ68"><label>(A59)</label><mml:math id="m68"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>Δ</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mrow><mml:mi>cot</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>Δ</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Φ</mml:mi><mml:mi>peak</mml:mi><mml:mo>'</mml:mo></mml:msubsup><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>r</mml:mi></mml:mfrac></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ68">Equation A59</xref> can be solved by integrating along a trajectory beginning at <inline-formula><mml:math id="inf569"><mml:mrow><mml:mo>(</mml:mo><mml:mn/><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mn>,</mml:mn><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:math></inline-formula>, and ending at <inline-formula><mml:math id="inf570"><mml:mo>(</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mn>,</mml:mn><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula>, leading to:</p><p><disp-formula id="equ69"><label>(A60)</label><mml:math id="m69"><mml:msubsup><mml:mo>∫</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:msup><mml:mi>r</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:msubsup><mml:mfenced><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Φ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mo>'</mml:mo></mml:msubsup><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>r</mml:mi></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:msubsup><mml:mn/><mml:mi>cot</mml:mi><mml:mo>(</mml:mo><mml:mi>Δ</mml:mi><mml:mo>)</mml:mo><mml:mn/><mml:mi>d</mml:mi><mml:mi>Δ</mml:mi></mml:math></disp-formula></p><p>To simplify the resulting expressions, let <inline-formula><mml:math id="inf571"><mml:mrow><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:math></inline-formula> be the anti-derivative of <inline-formula><mml:math id="inf572"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Φ</mml:mi><mml:mi>peak</mml:mi><mml:mo>'</mml:mo></mml:msubsup><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula>.</p><p><disp-formula id="equ70"><label>(A61)</label><mml:math id="m70"><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mo>∫</mml:mo><mml:mi>r</mml:mi></mml:msup><mml:mn/><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Φ</mml:mi><mml:mi>peak</mml:mi><mml:mo>'</mml:mo></mml:msubsup><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn/><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>This leads to an integral equation:</p><p><disp-formula id="equ71"><label>(A62)</label><mml:math id="m71"><mml:mi>F</mml:mi><mml:mfenced><mml:mrow><mml:mi>r</mml:mi><mml:mo>*</mml:mo></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mfenced><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mi>log</mml:mi><mml:mo> </mml:mo><mml:mfenced><mml:mfrac><mml:mrow><mml:mi>r</mml:mi><mml:mo>*</mml:mo></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>log</mml:mi><mml:mfenced><mml:mrow><mml:mi>sin</mml:mi><mml:mfenced><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>This equation can be solved for the critical angle <inline-formula><mml:math id="inf573"><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>:</p><p><disp-formula id="equ72"><label>(A63)</label><mml:math id="m72"><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>sin</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:mfenced><mml:mrow><mml:mfrac><mml:mrow><mml:mi>r</mml:mi><mml:mo>*</mml:mo></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mfenced><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mfenced><mml:mrow><mml:mi>r</mml:mi><mml:mo>*</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>The critical angle <inline-formula><mml:math id="inf574"><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is a function of the parameters defining the agent behavior, such as <inline-formula><mml:math id="inf575"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf576"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and the parameters defining the clump, such as the peak occupancy <inline-formula><mml:math id="inf577"><mml:mi>N</mml:mi></mml:math></inline-formula>. When <inline-formula><mml:math id="inf578"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is very small, trajectories spend much more time under the influence of the potential, and consequently it is much more likely that they are captured by the peak. Thus, for small <inline-formula><mml:math id="inf579"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf580"><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>. As <inline-formula><mml:math id="inf581"><mml:mi>N</mml:mi></mml:math></inline-formula> increases, the potential becomes stronger, and the values of <inline-formula><mml:math id="inf582"><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are increased for all <inline-formula><mml:math id="inf583"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. When <inline-formula><mml:math id="inf584"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is too large <inline-formula><mml:math id="inf585"><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> goes to <inline-formula><mml:math id="inf586"><mml:mn>0</mml:mn></mml:math></inline-formula> and agents cannot find the peak. <xref ref-type="fig" rid="fig21">Appendix Figure 15</xref> contains a plot demonstrating the aforementioned properties of <inline-formula><mml:math id="inf587"><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>.<fig id="fig20" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.026</object-id><label>Appendix Figure 14.</label><caption><title>Division of the (<italic>r</italic>, ∆) plane into trapping and escaping regions.</title><p>Any particle that enters region <italic>I</italic> will eventually reach the zero velocity radius. Any particle that enters region <italic>II</italic> will escape capture by the peak. Our initial condition will be in the right half plane, on the circle of width <italic>r<sub>M</sub></italic>. The two red circles are unstable equilibria, each corresponding to a circular orbit of the peak.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.026">http://dx.doi.org/10.7554/eLife.10955.026</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig14-v3.tif"/></fig><fig id="fig21" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.027</object-id><label>Appendix Figure 15.</label><caption><title>Critical angle <inline-formula><mml:math id="inf588"><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> for capture of agents by the resource peak, for different peak occupancy levels <italic>N</italic> and different values of the background velocity <inline-formula><mml:math id="inf589"><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msqrt></mml:math></inline-formula>.</title><p>Small <italic>v</italic><sub>0 </sub>and large <italic>N</italic> lead to increased <inline-formula><mml:math id="inf590"><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and a greater cross-section for capture of agents by the resource peak.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.027">http://dx.doi.org/10.7554/eLife.10955.027</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig15-v3.tif"/></fig></p><p><xref ref-type="fig" rid="fig22">Appendix Figure 16</xref> contains a plot of the direction field <xref ref-type="disp-formula" rid="equ68">Equation A59</xref> and plots of trajectories that reach <inline-formula><mml:math id="inf591"><mml:mfenced><mml:mrow><mml:mn/><mml:msup><mml:mi>r</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mn>,</mml:mn><mml:mo>±</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mfenced><mml:mn/></mml:math></inline-formula>, demonstrating the trapping of trajectories that enter region <inline-formula><mml:math id="inf592"><mml:mi>I</mml:mi></mml:math></inline-formula>, and providing numerical confirmation of our formula for the critical angle <inline-formula><mml:math id="inf593"><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.<fig id="fig22" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.028</object-id><label>Appendix Figure 16.</label><caption><title>Solutions of the differential equation for <inline-formula><mml:math id="inf594"><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>.</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> and <italic>N </italic>= 8.</title><p>The green region corresponds to 0 velocity. In the grey region surrounding the green region, the potential is stronger than centrifugal forces, which for <inline-formula><mml:math id="inf595"><mml:mo>-</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mo>∆</mml:mo><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:math></inline-formula> represents the trapping region. The two red circles correspond to the unstable equilibrium points, and the red trajectories are the trajectories that begin at <inline-formula><mml:math id="inf596"><mml:mfenced><mml:mrow><mml:mo>±</mml:mo><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>, which reach the equilibrium points and thus represent the boundaries of the set of initial conditions that are captured.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.028">http://dx.doi.org/10.7554/eLife.10955.028</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig16-v3.tif"/></fig></p></sec><sec id="s37"><title>6.4 Equation for peak exploration</title><p>Using <xref ref-type="disp-formula" rid="equ72">Equation A63</xref> for <inline-formula><mml:math id="inf597"><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we can write an equation for the rate at which the number of agents occupying a resource peak increases.</p><list list-type="order"><list-item><p>We assume that there is a population of <inline-formula><mml:math id="inf598"><mml:mi>P</mml:mi></mml:math></inline-formula> agents moving in a torus of width <inline-formula><mml:math id="inf599"><mml:mi>L</mml:mi></mml:math></inline-formula>, and that <inline-formula><mml:math id="inf600"><mml:mi>N</mml:mi></mml:math></inline-formula> of these agents occupy a resource peak at the origin.</p></list-item><list-item><p>The spatial density of agents away from the peak is homogeneous and equal to <inline-formula><mml:math id="inf601"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>The velocity of agents located at <inline-formula><mml:math id="inf602"><mml:mrow><mml:mi>r</mml:mi><mml:mo>&gt;</mml:mo><mml:mn/><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> has magnitude <inline-formula><mml:math id="inf603"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:msqrt><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> and is uniformly distributed in direction.</p></list-item><list-item><p>When an agent reaches <inline-formula><mml:math id="inf604"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn/><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, if it has <inline-formula><mml:math id="inf605"><mml:mo>−</mml:mo><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>Δ</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, the agent will be captured by the peak. Otherwise it will escape.</p></list-item></list><p>This allows us to calculate the rate of capture of agents on the peak. The flux of agents to the radius <inline-formula><mml:math id="inf606"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and the angle <inline-formula><mml:math id="inf607"><mml:mi>Δ</mml:mi></mml:math></inline-formula> is equal to <inline-formula><mml:math id="inf608"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>ρ</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. The flux of agents to a point on the circle with <inline-formula><mml:math id="inf609"><mml:mo>−</mml:mo><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>Δ</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is equal to <inline-formula><mml:math id="inf610"><mml:mfrac><mml:mrow><mml:mi>ρ</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>π</mml:mi></mml:mfrac></mml:math></inline-formula>. Then integrating over the circle with radius <inline-formula><mml:math id="inf611"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> gives us the total flux to the peak, or the rate of change of the peak occupancy <inline-formula><mml:math id="inf612"><mml:mi>N</mml:mi></mml:math></inline-formula>:</p><p><disp-formula id="equ73"><label>(A64)</label><mml:math id="m73"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>ρ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn/><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn/><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:math></disp-formula></p></sec><sec id="s38"><title>6.5 Comparison of social versus asocial exploration</title><p>We can perform a simple calculation to demonstrate how sociality enhances the rate at which agents occupy a resource peak. In the context of this model, the difference between social and asocial agents is that the flux of asocial agents to a peak is not enhanced by the presence of agents on a peak. Thus the rate at which the number of asocial agents occupying a peak increases is linear in time. Indeed, if we assume that the total population is large in comparison with the number of agents on the peak, then we can approximate the arrival of asocial agents onto the peak with the following differential equation:</p><p><disp-formula id="equ74"><label>(A65)</label><mml:math id="m74"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>ρ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>If the peak is unoccupied at time <inline-formula><mml:math id="inf613"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, this equation has solution:</p><p><disp-formula id="equ75"><label>(A66)</label><mml:math id="m75"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>ρ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mi>t</mml:mi></mml:math></disp-formula></p><p>In contrast, the flux of social agents to a peak is enhanced by the presence of other agents on the peak. A similar approximation leads to the equations:</p><p><disp-formula id="equ76"><label>(A67)</label><mml:math id="m76"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>ρ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn/><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:math></disp-formula></p><p><xref ref-type="fig" rid="fig23">Appendix Figure 17</xref> contains a plot of the function <inline-formula><mml:math id="inf614"><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn/><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula> versus <inline-formula><mml:math id="inf615"><mml:mi>N</mml:mi></mml:math></inline-formula>. This plot motivates approximating <inline-formula><mml:math id="inf616"><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn/><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:math></inline-formula> as a piecewise linear function, linearly increasing from <inline-formula><mml:math id="inf617"><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> for small <inline-formula><mml:math id="inf618"><mml:mi>N</mml:mi></mml:math></inline-formula> until the value <inline-formula><mml:math id="inf619"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> at which <inline-formula><mml:math id="inf620"><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn/><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:math></inline-formula>, at which point the flux becomes a constant function equal to <inline-formula><mml:math id="inf621"><mml:mrow><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. In the initial phase, we approximate the differential equation with:<fig id="fig23" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.029</object-id><label>Appendix Figure 17.</label><caption><title>Rate of arrival of social agents onto a resource peak as a function of the number of agents already on the peak.</title><p>There are two behavior regimes, the initial regime in which flux grows linearly with <italic>N</italic> (giving rise to exponential growth of the number of individuals on the peak), and a regime where the flux reaches it’s maximum value (after which point peak occupancy grows linearly). This figure was calculated using <xref ref-type="disp-formula" rid="equ76">Equation A67</xref>, with velocity <italic>v</italic><sub>0 </sub>= 1.0, density <italic>ρ </italic>= .01, <italic>K</italic> = 25 interaction neighbors, social potential min(<italic>N</italic>, <italic>K</italic>)<italic>e</italic><sup>−|<italic>r</italic>|/7.5</sup>, and resource peak shape <inline-formula><mml:math id="inf622"><mml:mn>10</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:mn>25</mml:mn><mml:mo>.</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.029">http://dx.doi.org/10.7554/eLife.10955.029</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig17-v3.tif"/></fig></p><p><disp-formula id="equ77"><label>(A68)</label><mml:math id="m77"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>ρ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfenced><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfrac><mml:mfenced><mml:mrow><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>When the peak is unoccupied at <inline-formula><mml:math id="inf623"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, this has solution:</p><p><disp-formula id="equ78"><label>(A69)</label><mml:math id="m78"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mfenced><mml:mn>0</mml:mn></mml:mfenced></mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mfenced><mml:mn>0</mml:mn></mml:mfenced></mml:mstyle></mml:mfrac><mml:mfenced><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>ρ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:msub><mml:mi>ν</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfrac><mml:mi>t</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfrac><mml:mfenced><mml:mrow><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mfenced><mml:mn>0</mml:mn></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>This solution is good up until <inline-formula><mml:math id="inf624"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn/><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, which happens at:</p><p><disp-formula id="equ79"><label>(A70)</label><mml:math id="m79"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo> </mml:mo><mml:mfenced><mml:mrow><mml:mfrac><mml:mstyle displaystyle="true"><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mfenced><mml:mn>0</mml:mn></mml:mfenced></mml:mstyle><mml:mrow><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mfenced><mml:mn>0</mml:mn></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mi>ρ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:msub><mml:mi>ν</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo> </mml:mo><mml:mfenced><mml:mrow><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:msub><mml:mo>∆</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mfenced><mml:mn>0</mml:mn></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>When <inline-formula><mml:math id="inf625"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn/><mml:msub><mml:mi>t</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the solution is:</p><p><disp-formula id="equ80"><label>(A71)</label><mml:math id="m80"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn/><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn/><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mn/><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mn>.</mml:mn></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="fig" rid="fig24">Appendix Figure 18</xref> compares the function <inline-formula><mml:math id="inf626"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn/><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mn/></mml:mrow></mml:math></inline-formula> for social and asocial agents.<fig id="fig24" position="float"><object-id pub-id-type="doi">10.7554/eLife.10955.030</object-id><label>Appendix Figure 18.</label><caption><title>Comparison of peak occupancy as a function of time between social and asocial agents, using the parameters that generated <xref ref-type="fig" rid="fig23">Appendix Figure 17</xref> and <xref ref-type="disp-formula" rid="equ75 equ78 equ80">Equation A66, A69, A71</xref>.</title><p>Social agents occupy the peak much more quickly than asocial agents.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10955.030">http://dx.doi.org/10.7554/eLife.10955.030</ext-link></p></caption><graphic xlink:href="elife-10955-app1-fig18-v3.tif"/></fig></p></sec></sec><sec id="s39" sec-type="appendix"><title>7 Numerical methods</title><p>We used the CVODE subroutine of the SUNDIALS package to numerically solve the agent-based model (<xref ref-type="bibr" rid="bib23">Hindmarsh et al., 2005</xref>). The resulting system of ODEs is stiff, so we utilized the variable order backward-differentiation methods provide by SUNDIALS. We found these implicit methods to be much more efficient than explicit methods for the particular problem that we considered. We also made use of the armadillo linear algebra library (<xref ref-type="bibr" rid="bib33">Sanderson, 2010</xref>), the MATLAB statistics and machine learning toolbox for nearest neighbor searches, and the mex file libraries to interface all of these different tools (<xref ref-type="bibr" rid="bib26">MATLAB, 2015</xref>).</p></sec></boxed-text></app></app-group></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.10955.031</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Doebeli</surname><given-names>Michael</given-names></name><role>Reviewing editor</role><aff id="aff8"><institution>University of British Columbia</institution>, <country>Canada</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see <ext-link ext-link-type="uri" xlink:href="http://elifesciences.org/review-process">review process</ext-link>). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers.</p></boxed-text><p>Thank you for submitting your work entitled &quot;The evolution of distributed sensing and collective computation in animal populations&quot; for peer review at <italic>eLife</italic>. Your submission has been favorably evaluated by Ian Baldwin (Senior editor), a Reviewing editor, and two reviewers.</p><p>The reviewers are enthusiastic about your paper, and we would like to invite you to revise your manuscript according to the suggestions made by the reviewers.</p><p>Summary:</p><p>This paper considers a model for collective motion in the presence of a time-varying resource environment, in which the characteristics of future generations of the agents evolve according to how well the current generation obtained resources. The model is based on two behavioral rules: a social response rule and an environmental response rule. It is a force-based model, in which the interactions with other agents and the environment are captured in terms of potentials that encode these rules. Parameters that are allowed to evolve include an individual's preferred speed when there is no environmental cue, and the sensitivity of an individual to an environmental cue.</p><p>It is found that the parameters evolve to robust evolutionarily stable states, and these are typically places in parameter space near transitions to other collective states. This allows groups to respond quickly to changes in the environment. It is argued that such changes in the collective state resemble a phase transition in physical systems.</p><p>The manuscript presents an important and substantial advance in understanding the evolution of collective motion of animals.</p><p><italic>Reviewer #1:</italic> </p><p>This paper considers a model for collective motion in the presence of a time-varying resource environment, in which the characteristics of future generations of the agents evolve according to how well the current generation obtained resources. The model is based on two behavioral rules: a social response rule and an environmental response rule. It is a force-based model, in which the interactions with other agents and the environment are captured in terms of potentials that encode these rules. Parameters that are allowed to evolve include an individual's preferred speed when there is no environmental cue, and the sensitivity of an individual to an environmental cue.</p><p>It is found that the parameters evolve to robust evolutionarily stable states, and these are typically places in parameter space near transitions to other collective states. This allows groups to respond quickly to changes in the environment. It is argued that such changes in the collective state resemble a phase transition in physical systems.</p><p>The paper has a nice combination of results from computations and theory, much of the details of which are described in the Appendix. Overall it is very well written and describes important properties of collective motion systems. I feel that it is a very strong contribution to the literature.</p><p>My only &quot;major&quot; comment is the following:</p><p>It is common for phase transitions to be characterized in terms of critical exponents that describe how quantities of interest scale near the phase transition. Is it possible to do this for the system in the paper? This would help to strengthen the somewhat vague claim that the changes in the collective state &quot;resemble phase transitions&quot;.</p><p><italic>Reviewer #2:</italic></p><p>In my opinion, the manuscript &quot;The evolution of distributed sensing and collective computation in animal populations&quot; presents an important and substantial advance in understanding the evolution of collective motion of animals and could be published in <italic>eLife</italic>. The authors build up on the relatively well-studied dynamics of non-evolving swarms of interacting particles, introduce important empirically-derived features, and create a comprehensive evolving model which reproduces several common and intuitively-appealing behavioural patterns of such animal groups. In addition to a thorough modeling effort, I especially appreciate the extensive analytic and simplified computational estimates of each important facet of the observed dynamics. Such highly-focused &quot;sub-models&quot; help a reader to verify that the contributions of basic mathematical and biological mechanisms to the rather complex observed phenomenology are understood correctly.</p><p>A major issue that naturally comes to one's mind while reading the manuscript is how the results would be affected by adding a realistic feature of a gradual depletion of well-localized resources by swarming consumers. How a rate of such depletion would affect the evolutionary patterns? In the present form, the manuscript is already loaded with new insights, hence, I think, that a qualitative and perhaps even speculative discussion of this topic would suffice.</p><p><italic>Reviewer #2 (Minor Comments):</italic></p><p>The analogy to the 1-order phase transition based on the density contrast and hysteresis curve could be developed a step further: In traditional first-order phase transitions the hysteresis is caused by the instability of small-size nuclei of an emerging phase. Could something similar be said about the transition between dispersed and cohesive states?</p><p>The word &quot;criticality&quot; seems to become too fashionable and abused in many not directly relevant contexts. In its true meaning, a critical state and critical point terminate the line of first-order phase transition rather than sits &quot;close to it&quot;. In addition, it is characterized by many unique properties (such as non-analytic behaviour of potentials, scale-free correlations, etc.) which are not mentioned and apparently are irrelevant here. So I would recommend to simply refer to such evolutionary stable state as to one being close to the localized-delocalized transition line.</p><p>Same with the word &quot;computation&quot;, which, in my understanding, describes some mathematical actions. I think a more appropriate word to describe the collective behaviour would be &quot;collective sensing&quot;.</p><p>Unless dictated by the journal format requirements, it would be easier on a reader to have the description of the resource dynamics in the Model Development section and to get rid of the Materials and methods one.</p><p>The captions to some figures, especially <xref ref-type="fig" rid="fig4">Figure 4</xref> are very difficult to understand. Unless desperately pressed by the size limit, it would definitely help to expand the caption and even split the figure into several ones.</p><p>Would it be possible to embed the movies into the main text somewhere near the description of three typical dynamical regimes?</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.10955.032</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>Reviewer #1:</p><p><italic>[…] It is common for phase transitions to be characterized in terms of critical exponents that describe how quantities of interest scale near the phase transition. Is it possible to do this for the system in the paper? This would help to strengthen the somewhat vague claim that the changes in the collective state &quot;resemble phase transitions&quot;.</italic> </p><p>We appreciate the reviewer’s point that the analogy between sharp transitions in density/potential energy we observe in collectives, and phase transitions in physical systems could be clarified further. We observe that agents undergo what appears to be a discontinuous change in local density as a function of <inline-formula><mml:math id="inf627"><mml:mtext>Ψ</mml:mtext></mml:math></inline-formula>, so the observed transition more closely resembles a first order phase transition than a second order phase transition. Because of this, we do not expect the kind of power law scaling near the transition point that is a characteristic of second order transitions, and the search for a critical exponent would not be meaningful. On the other hand, hysteresis is a hallmark first order phase transitions so that <xref ref-type="fig" rid="fig3">Figures 3</xref> and Appendix <xref ref-type="fig" rid="fig9">Figure 9</xref> provide evidence that the analogy to phase transitions is sound. Additionally, we have expanded discussion of the hysteresis behavior present in our model and added additional numerical results (Appendix section 5.4) to further clarify the connection between the behavior of our system and first order phase transitions in physical systems (subheading “Evolved populations are poised near abrupt transitions in collective state”, see also the response to reviewer #2’s comment).</p><p>Reviewer #2:</p><p><italic>[…] A major issue that naturally comes to one's mind while reading the manuscript is how the results would be affected by adding a realistic feature of a gradual depletion of well-localized resources by swarming consumers. How a rate of such depletion would affect the evolutionary patterns? In the present form, the manuscript is already loaded with new insights, hence, I think, that a qualitative and perhaps even speculative discussion of this topic would suffice.</italic> </p><p>To address the reviewer’s comment, we performed two additional sets of evolutionary simulations under alternative assumptions about resource depletion. In the first alternative scenario, we assumed that individuals deplete the resource very quickly. As one might expect, social cues provide little useful information about the locations of resources when resources are quickly depleted, and as a consequence, the evolutionary trajectories under fast resource depletion resemble those of asocial individuals. Under more moderate levels of resource depletion, however, the evolutionary trajectories shown in <xref ref-type="fig" rid="fig1">Figure 1</xref> of the main text are largely unchanged; social individuals evolve to an evolutionarily stable state in which <inline-formula><mml:math id="inf628"><mml:mtext>Ψ</mml:mtext></mml:math></inline-formula>0 values are near the transition point in collective state when the resource is at a low value, and individuals cross the transition shown in <xref ref-type="fig" rid="fig3">Figure 3</xref> in regions where the resource value is high. We have added a discussion of these new results to the manuscript (paragraph three, subheading “Evolved populations are poised near abrupt transitions in collective state”).</p><p>Reviewer #2 (Minor Comments):</p><p><italic>The analogy to the 1-order phase transition based on the density contrast and hysteresis curve could be developed a step further: In traditional first-order phase transitions the hysteresis is caused by the instability of small-size nuclei of an emerging phase. Could something similar be said about the transition between dispersed and cohesive states?</italic> </p><p>As the reviewer mentioned, when <inline-formula><mml:math id="inf629"><mml:mtext>Ψ</mml:mtext></mml:math></inline-formula> is increased from a low value to a higher value, in the transitional regime, small nuclei of tightly clustered individuals coexist with individuals in the dispersed state. These nuclei eventually become completely unstable at large enough values of <inline-formula><mml:math id="inf630"><mml:mtext>Ψ</mml:mtext></mml:math></inline-formula>. We have added additional numerical results describing how the rate of nucleus formation depends on <inline-formula><mml:math id="inf631"><mml:mtext>Ψ</mml:mtext></mml:math></inline-formula> in the hysteresis region and described these in subheading “Evolved populations are poised near abrupt transitions in collective state” of the revised manuscript.</p><p><italic>The word &quot;criticality&quot; seems to become too fashionable and abused in many not directly relevant contexts. In its true meaning, a critical state and critical point terminate the line of first-order phase transition rather than sits &quot;close to it&quot;. In addition, it is characterized by many unique properties (such as non-analytic behaviour of potentials, scale-free correlations, etc.) which are not mentioned and apparently are irrelevant here. So I would recommend to simply refer to such evolutionary stable state as to one being close to the localized-delocalized transition line.</italic> </p><p>We have removed the term “criticality” throughout the manuscript to avoid confusion about terminology.</p><p><italic>Same with the word &quot;computation&quot;, which, in my understanding, describes some mathematical actions. I think a more appropriate word to describe the collective behaviour would be &quot;collective sensing&quot;.</italic> </p><p>While we agree with the reviewer that the term “computation” is often misused or used casually, in this manuscript we have strived to define precisely what we mean when we use this term (subheading “Changes in collective state allow for rapid collective computation of the resource distribution” and paragraph three, Discussion). One of our motivations for doing this is to help develop a more rigorous definition of “collective computation” as it is a term that is frequently used in the literature on collective behavior.</p><p><italic>Unless dictated by the journal format requirements, it would be easier on a reader to have the description of the resource dynamics in the Model Development section and to get rid of the Materials and methods one.</italic> </p><p>As far as we can tell, the Material and methods section is required by <italic>eLife</italic>. If it is allowed, we would be willing to move the details of the resource environment to the Model Development section and omit Materials and methods altogether.</p><p><italic>The captions to some figures, especially <xref ref-type="fig" rid="fig4">Figure 4</xref> are very difficult to understand. Unless desperately pressed by the size limit, it would definitely help to expand the caption and even split the figure into several ones.</italic> </p><p>We have divided <xref ref-type="fig" rid="fig4">Figure 4</xref> into two figures and worked to clarify the other figure captions.</p><p><italic>Would it be possible to embed the movies into the main text somewhere near the description of three typical dynamical regimes?</italic> </p><p>We have referenced <xref ref-type="other" rid="media2">Video 2</xref> in the section of the text that describes dynamical regimes (subheading “Evolved populations are poised near abrupt transitions in collective state”).</p></body></sub-article></article>