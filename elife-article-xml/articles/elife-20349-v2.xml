<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">20349</article-id><article-id pub-id-type="doi">10.7554/eLife.20349</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Flexible theta sequence compression mediated via phase precessing interneurons</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-14679"><name><surname>Chadwick</surname><given-names>Angus</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2664-0746</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa1">‡</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-14680"><name><surname>van Rossum</surname><given-names>Mark CW</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6525-6814</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-13369"><name><surname>Nolan</surname><given-names>Matthew F</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1062-6501</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Institute for Adaptive and Neural Computation, School of Informatics</institution>, <institution>University of Edinburgh</institution>, <addr-line><named-content content-type="city">Scotland</named-content></addr-line>, <country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Neuroinformatics Doctoral Training Centre, School of Informatics</institution>, <institution>University of Edinburgh</institution>, <addr-line><named-content content-type="city">Edinburgh</named-content></addr-line>, <country>United Kingdom</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Centre for Integrative Physiology</institution>, <institution>University of Edinburgh</institution>, <addr-line><named-content content-type="city">Edinburgh</named-content></addr-line>, <country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Skinner</surname><given-names>Frances K</given-names></name><role>Reviewing editor</role><aff id="aff4"><institution>University Health Network</institution>, <country>Canada</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>mattnolan@ed.ac.uk</email></corresp><fn fn-type="present-address" id="pa1"><label>‡</label><p>Gatsby Computational Neuroscience Unit, Sainsbury Wellcome Centre, University College London, London, United Kingdom</p></fn><fn fn-type="con" id="equal-contrib"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>08</day><month>12</month><year>2016</year></pub-date><pub-date pub-type="collection"><year>2016</year></pub-date><volume>5</volume><elocation-id>e20349</elocation-id><history><date date-type="received"><day>09</day><month>08</month><year>2016</year></date><date date-type="accepted"><day>07</day><month>12</month><year>2016</year></date></history><permissions><copyright-statement>© 2016, Chadwick et al</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Chadwick et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-20349-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.20349.001</object-id><p>Encoding of behavioral episodes as spike sequences during hippocampal theta oscillations provides a neural substrate for computations on events extended across time and space. However, the mechanisms underlying the numerous and diverse experimentally observed properties of theta sequences remain poorly understood. Here we account for theta sequences using a novel model constrained by the septo-hippocampal circuitry. We show that when spontaneously active interneurons integrate spatial signals and theta frequency pacemaker inputs, they generate phase precessing action potentials that can coordinate theta sequences in place cell populations. We reveal novel constraints on sequence generation, predict cellular properties and neural dynamics that characterize sequence compression, identify circuit organization principles for high capacity sequential representation, and show that theta sequences can be used as substrates for association of conditioned stimuli with recent and upcoming events. Our results suggest mechanisms for flexible sequence compression that are suited to associative learning across an animal’s lifespan.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.001">http://dx.doi.org/10.7554/eLife.20349.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.20349.002</object-id><title>eLife digest</title><p>Nerve cells in the brain exchange information via electrical impulses. In a given brain area, the electrical impulses at any particular moment can be thought of as forming a code that represents an aspect of the outside world. For example, groups of nerve cells in the hippocampus generate a type of code called a theta sequence, which represents a series of recent and upcoming events. The specific timing of electrical impulses within a theta sequence is crucial in creating certain types of memory.</p><p>There are two major classes of nerve cell in the brain: excitatory cells activate impulses in neighbouring cells, while inhibitory cells act to temporarily block impulses from other nerve cells. Many groups, or “circuits”, of nerve cells contain combinations of both cell types to control how and when they communicate. Previous studies show that both types of cell are active within theta sequences, but it is not known precisely how they contribute to creating the sequences.</p><p>Chadwick et al. developed a new mathematical model that simulates how theta sequences can emerge from circuits of both excitatory and inhibitory nerve cells. The connections between these simulated cells are based on experimental data from real nerve cells in the hippocampus. The model predicts that inhibitory cells play an important role in generating theta sequences by interacting with groups of excitatory cells to coordinate the timing of electrical impulses. Furthermore, the model shows how memory capacity depends on these connections.</p><p>The next step following on from this work is to carry out experiments to test the model’s predictions. This will include monitoring the same group of nerve cells in multiple different situations to find out how their theta sequences change, and recording electrical events in individual nerve cells during theta sequences. If the theory’s predictions are confirmed this would lead to a deeper understanding of how our brains remember sequences of events.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.002">http://dx.doi.org/10.7554/eLife.20349.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>episodic-like memory</kwd><kwd>hippocampus</kwd><kwd>phase precession</kwd><kwd>place cell</kwd><kwd>interneuron</kwd><kwd>model</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000266</institution-id><institution>Engineering and Physical Sciences Research Council</institution></institution-wrap></funding-source><award-id>EP/F500385/1</award-id><principal-award-recipient><name><surname>Chadwick</surname><given-names>Angus</given-names></name><name><surname>van Rossum</surname><given-names>Mark CW</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>Biotechnology and Biological Sciences Research Council</institution></institution-wrap></funding-source><award-id>BB/L010496/1</award-id><principal-award-recipient><name><surname>Nolan</surname><given-names>Matthew F</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A new model for phase precession accounts for theta sequence generation, suggests critical roles for interneurons, and predicts circuit properties to optimise memory storage.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Whereas many behaviorally important events take place on timescales of seconds, neuronal membrane dynamics operate at a millisecond timescale. The discovery that during movement hippocampal place cells fire action potentials with timing that precesses relative to the hippocampal theta rhythm (<xref ref-type="bibr" rid="bib61">O'Keefe and Recce, 1993</xref>), and that time-compressed representations of behavioral sequences occur as spike sequences within each theta cycle (<xref ref-type="bibr" rid="bib71">Skaggs et al., 1996</xref>; <xref ref-type="bibr" rid="bib14">Dragoi and Buzsáki, 2006</xref>; <xref ref-type="bibr" rid="bib20">Foster and Wilson, 2007</xref>), suggests that hippocampal activity is organized so that computations on a millisecond neural timescale can address events on behavioral timescales. Thus, spike sequences within theta cycles may form a neuronal substrate for episodic and spatial memory (<xref ref-type="bibr" rid="bib62">Pastalkova et al., 2008</xref>; <xref ref-type="bibr" rid="bib44">Lisman and Redish, 2009</xref>; <xref ref-type="bibr" rid="bib8">Buzsáki and Moser, 2013</xref>; <xref ref-type="bibr" rid="bib76">Wikenheiser and Redish, 2015</xref>). Nevertheless, the circuit mechanisms through which theta sequences are generated are unclear and the mechanisms by which they may contribute to learning have received relatively little attention.</p><p>Several features of theta sequences that may be important for their computational functions pose challenges to models attempting to explain their generation through biophysically constrained mechanisms. First, the rate at which action potentials precess relative to the theta rhythm depends on an animal’s speed of movement (<xref ref-type="bibr" rid="bib25">Geisler et al., 2007</xref>). Second, phase precession occurs along arbitrary two-dimensional trajectories (<xref ref-type="bibr" rid="bib35">Huxter et al., 2008</xref>; <xref ref-type="bibr" rid="bib12">Climer et al., 2013</xref>; <xref ref-type="bibr" rid="bib37">Jeewajee et al., 2014</xref>). Third, theta sequences emerge within theta waves that propagate along the dorsoventral axis of the hippocampus (<xref ref-type="bibr" rid="bib48">Lubenov and Siapas, 2009</xref>; <xref ref-type="bibr" rid="bib63">Patel et al., 2012</xref>). Fourth, while place cells across the dorsoventral axis have field sizes that vary over an order of magnitude, spike phase nevertheless usually advances by a maximum of a single theta cycle across their place field indicating that the rate of phase precession varies dorsoventrally (<xref ref-type="bibr" rid="bib40">Kjelstrup et al., 2008</xref>). Finally, to successfully distinguish behavioral episodes, distinct theta sequences must be generated for experiences over an animal’s lifetime, implying that sequence generation must be both flexible and have a high capacity (<xref ref-type="bibr" rid="bib10">Chadwick et al., 2015</xref>). We previously introduced a phenomenological model which demonstrates that experimentally observed theta sequences can be accounted for by phase precession in independent place cells (<xref ref-type="bibr" rid="bib10">Chadwick et al., 2015</xref>). This is in contrast to suggestions that synaptic coordination within and between cell assemblies is required to explain theta sequences (<xref ref-type="bibr" rid="bib72">Tsodyks et al., 1996</xref>; <xref ref-type="bibr" rid="bib28">Harris et al., 2003</xref>; <xref ref-type="bibr" rid="bib30">Harris, 2005</xref>; <xref ref-type="bibr" rid="bib54">Maurer and McNaughton, 2007</xref>; <xref ref-type="bibr" rid="bib24">Geisler et al., 2010</xref>; <xref ref-type="bibr" rid="bib44">Lisman and Redish, 2009</xref>; <xref ref-type="bibr" rid="bib76">Wikenheiser and Redish, 2015</xref>; <xref ref-type="bibr" rid="bib74">Wang et al., 2015</xref>). Several cellular mechanisms for independent phase precession have been proposed (<xref ref-type="bibr" rid="bib61">O'Keefe and Recce, 1993</xref>; <xref ref-type="bibr" rid="bib57">Mehta et al., 2002</xref>; <xref ref-type="bibr" rid="bib29">Harris et al., 2002</xref>; <xref ref-type="bibr" rid="bib41">Lengyel et al., 2003</xref>; <xref ref-type="bibr" rid="bib7">Burgess et al., 2007</xref>; <xref ref-type="bibr" rid="bib42">Leung, 2011</xref>; <xref ref-type="bibr" rid="bib11">Chance, 2012</xref>), but none appear able to account for the challenges above while maintaining consistency with the hippocampal circuitry (see <xref ref-type="supplementary-material" rid="SD1-data">Figure 1—source data 1</xref> and Discussion). Thus, the biophysical mechanisms through which an independent phase coding scheme could be implemented within the CA1 circuitry while accounting for known computationally important properties of theta sequences are not clear.</p><p>The possible mechanisms underlying phase precession in CA1 are heavily constrained by the architecture of the CA1 circuit. CA1 pyramidal cells make few direct connections with one another (<xref ref-type="bibr" rid="bib4">Anderson et al., 2007</xref>) (but see <xref ref-type="bibr" rid="bib78">Yang et al., 2014</xref>), suggesting that phase precession in CA1 arises through some combination of intrinsic cellular properties, external inputs to the circuit and local interactions between pyramidal cells and interneurons. Major sources of input to CA1 include spatially modulated signals from CA3 and from the entorhinal cortex, and temporally patterned GABAergic inputs from the medial septum, which target hippocampal interneurons and act as a pacemaker to entrain theta oscillations in the circuit (<xref ref-type="bibr" rid="bib22">Freund and Antal, 1988</xref>). Previously proposed mechanisms for independent phase precession focus on integration of signals by place cells (<xref ref-type="bibr" rid="bib61">O'Keefe and Recce, 1993</xref>; <xref ref-type="bibr" rid="bib57">Mehta et al., 2002</xref>; <xref ref-type="bibr" rid="bib29">Harris et al., 2002</xref>; <xref ref-type="bibr" rid="bib41">Lengyel et al., 2003</xref>; <xref ref-type="bibr" rid="bib7">Burgess et al., 2007</xref>; <xref ref-type="bibr" rid="bib42">Leung, 2011</xref>; <xref ref-type="bibr" rid="bib11">Chance, 2012</xref>). However, many interneurons also fire spikes that precess in phase against the theta rhythm, with interneuron phase precession exhibiting strong functional coupling to individual pyramidal cells (<xref ref-type="bibr" rid="bib52">Maurer et al., 2006</xref>; <xref ref-type="bibr" rid="bib25">Geisler et al., 2007</xref>; <xref ref-type="bibr" rid="bib16">Ego-Stengel and Wilson, 2007</xref>). Thus, we asked whether phase precession underlying sequence generation could originate from interneuron dynamics. To address this possibility we introduce a minimal circuit model in which phase precession and theta sequences are generated through interactions between place cells and interneurons driven by pacemaker inputs. In contrast to the view that phase precession in interneurons is inherited synaptically from phase precessing place cell assemblies (<xref ref-type="bibr" rid="bib52">Maurer et al., 2006</xref>; <xref ref-type="bibr" rid="bib25">Geisler et al., 2007</xref>), interneuron phase precession in our model is crucial for the coordination of spike timing in place cells and for the generation of theta sequences. Due to the transient functional coupling between place cells and interneurons, phase precession occurs dynamically whenever a place cell is driven by external inputs. Consequently, phase precession and theta sequences are generated de novo within the network, and slow input sequences are automatically compressed into theta sequences in networks of interacting pyramidal cells and interneurons.</p><p>Our model suggests that CA1 can function as a flexible compressor of its inputs to maintain a representation of temporal order occurring on a behavioral timescale within a faster timescale suitable for synaptic processing in downstream brain areas. The model enables predictions of pacemaker dynamics which account for velocity-dependence of network activity and dorsoventral organization of sequence generation, and predicts network configurations that may underlie the dissociation of phase precession and theta sequences (<xref ref-type="bibr" rid="bib19">Feng et al., 2015</xref>; <xref ref-type="bibr" rid="bib59">Middleton and McHugh, 2016</xref>). The proposed mechanism not only generates sequences encoding spatial trajectories, but can also function as a general purpose circuit with a remarkably high capacity for encoding temporally extended sequences of events. We show how such a compression of ongoing experience into theta cycles enables flexible learning of behavioral associations through spike timing dependent plasticity (STDP). Thus, CA1 may compress ongoing experiences during theta states into fast neural activity patterns suitable for online learning and decision making.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Phase precession emerges in coupled interneuron-pyramidal cell pairs</title><p>Since theta phase precession in independent neurons is sufficient to account for experimentally observed theta sequences (<xref ref-type="bibr" rid="bib10">Chadwick et al., 2015</xref>), we first aimed to identify circuit mechanisms that account for experimentally observed features of phase precession in single neurons. Whereas in many previous models precession is assumed to arise from oscillatory drive targeting place cells, the frequency of theta is established by septal GABAergic projections to hippocampal interneurons (<xref ref-type="bibr" rid="bib22">Freund and Antal, 1988</xref>), which in turn coordinate the spiking activity of local CA1 pyramidal cells (<xref ref-type="bibr" rid="bib67">Royer et al., 2012</xref>). We therefore reasoned that phase precession could emerge from the dynamics of interneurons driven by pacemaker inputs and interacting with pyramidal cells. To explore this possibility we constructed a minimal network model containing a single interneuron and pyramidal cell, with synaptic connectivity based on this architecture (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). The interneuron is driven to fire tonically by a constant depolarizing current, while pacemaker drive from the medial septum to the interneuron is simulated by an 8 Hz oscillatory current, which is sufficient to fully entrain spiking activity of the interneuron when the pyramidal cell is inactive (<xref ref-type="fig" rid="fig1">Figure 1B–C</xref>). In this case, output from the interneuron drives rhythmic subthreshold theta frequency inhibitory synaptic potentials in the pyramidal cell (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). When spatial input to the pyramidal cell is simulated by a suprathreshold external drive, the resulting synaptic drive to the interneuron initiates phase precession in the coupled pair of cells, causing their firing frequency to elevate above that of the pacemaker theta and their firing phase to advance continuously over the place field (<xref ref-type="fig" rid="fig1">Figure 1D–E</xref>). When the pyramidal cell is transiently driven by slow depolarizing current, the phase of spikes fired by the interneuron and by the pyramidal cell advances through a full 360 degrees relative to the 8 Hz pacemaker input. Hence, whenever pyramidal cells are activated by slow depolarizing drives, the basic architecture of the CA1 circuit, along with pacing inputs from the medial septum, is sufficient to generate phase precession in pyramidal cells and interneurons.<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.20349.003</object-id><label>Figure 1.</label><caption><title>A minimal CA1 circuit model for theta phase precession.</title><p>(<bold>A</bold>) An interneuron (red) is driven by a pacemaker theta oscillation from the medial septum. The interneuron synapses reciprocally onto a pyramidal cell (blue). The pyramidal cell is driven by slower external inputs occurring over behavioral timescales. (<bold>B</bold>–<bold>E</bold>) A simulation of this network as the animal crosses the place field of the pyramidal cell. (<bold>B</bold>) Interneuron spiking activity (red lines) and pyramidal cell spikes (blue lines) and membrane potential (blue trace). (<bold>C</bold>) A sample of the interneuron spike train when the pyramidal cell is inactive (i.e., outside of the place field), with the pacemaker rhythm overlaid for reference. In this case, the interneuron locks to the pacemaker input. (<bold>D</bold>) A sample of the interneuron and pyramidal cell spike trains inside the place field. In this case, the interneuron precesses in phase against the pacemaker input and the pyramidal cell fires in bursts which also precess in phase. (<bold>E</bold>) The membrane frequency in the theta band and the spike phases of the interneuron (red) and pyramidal cell (blue) corresponding to the data shown in parts (<bold>A</bold>)-(<bold>D</bold>). Phases are replicated over two cycles for clarity. Note that the pyramidal cell fires up to two spikes per theta cycle in this simulation.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.003">http://dx.doi.org/10.7554/eLife.20349.003</ext-link></p><p><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.20349.004</object-id><label>Figure 1—source data 1.</label><caption><title>Table comparing the proposed model to previous models of phase precession.</title><p>Our model is the first to successfully explain speed-modulation of precession frequency, two-dimensional phase precession and 360 degrees of phase precession without introducing unobserved circuit components, directionally modulated external inputs or inputs with speed-modulated oscillation frequencies.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.004">http://dx.doi.org/10.7554/eLife.20349.004</ext-link></p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-20349-fig1-data1-v2.docx"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig1-v2"/></fig></p><p>To better understand the emergence of these phase precession dynamics, we developed a reduced model in which an interneuron is driven by weak pacemaker input and a slow depolarizing drive, and for which analytical solutions can be obtained (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, see Materials and methods for details of model). During injection of a constant input current the model generates either stable phase locking or phase precession at a constant rate against the pacemaker drive (‘frequency pulling’) depending on the strength of depolarizing drive relative to the strength of pacemaker input (<xref ref-type="fig" rid="fig2">Figure 2B,C</xref>). Phase locking occurs for weak drives, where the interneuron becomes entrained to a fixed phase of the pacemaker input. Frequency pulling occurs for strong drives, in which case, for a given constant input current, the interneuron oscillates with a fixed frequency difference from the pacemaker, causing its phase to advance continuously relative to the pacemaker input. In the phase locking region, because the locking phase varies as a function of the input current, variation in the input current can be used to achieve variation through a maximum of 180 degrees of theta phases (−90 to 90 degrees, see <xref ref-type="fig" rid="fig2">Figure 2B</xref>). In contrast, in the frequency pulling region, phase precession continues indefinitely at a fixed rate for a constant input current.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.20349.005</object-id><label>Figure 2.</label><caption><title>Phase precession and phase locking in a reduced model of an interneuron driven by depolarizing current and weak pacemaker drive.</title><p>(<bold>A</bold>) Schematic of the model. (<bold>B</bold>–<bold>C</bold>) Steady state dynamics for a constant depolarizing drive, assuming a linear f-I curve. (<bold>B</bold>) Phase locking as a function of input current. (<bold>C</bold>) Precession frequency as a function of input current. For sufficiently strong currents, the interneuron oscillates with a frequency above that of the pacemaker (phase precession). For sufficiently weak currents, the interneuron oscillates more slowly than the pacemaker (phase regression). Note that for more biophysical f-I curves the phase regression regime may be absent. (<bold>D</bold>–<bold>E</bold>) Evolution of interneuron phase during a transient, slowly varying current injection. (<bold>D</bold>) Input currents with Gaussian profiles and a range of amplitudes. (<bold>E</bold>) Interneuron phase as a function of time, for each current profile shown in (<bold>D</bold>), showing a total of one cycle of phase precession for stronger drives and only transient phase precession before reversing in phase for weaker drives (purple).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.005">http://dx.doi.org/10.7554/eLife.20349.005</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig2-v2"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20349.006</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Phase precession is robust to the temporal profile of excitatory drive.</title><p>Square pulse excitatory currents (<bold>A</bold>), upward-going asymmetric ramps (<bold>C</bold>) and downward-going asymmetric ramps (<bold>E</bold>) are each able to drive 360 degrees of phase precession (<bold>B</bold>, <bold>D</bold> and <bold>E</bold>). Continuous phase precession through the firing field requires sufficiently strong excitatory drive, but is independent of the shape of the drive. This is in contrast to models that integrate an asymmetric input with a dendritic oscillation.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.006">http://dx.doi.org/10.7554/eLife.20349.006</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig2-figsupp1-v2"/></fig></fig-group></p><p>Previous models that focus on place cells also generate phase precession by integration of theta drives and slow depolarizing drives, achieving variable phase locking through a range of 180 degrees (<xref ref-type="bibr" rid="bib57">Mehta et al., 2002</xref>; <xref ref-type="bibr" rid="bib29">Harris et al., 2002</xref>). However, the underlying dynamics and mechanisms in our model are distinct from these schemes in several ways. First, the excitation-dependent locking of spike phase observed in our model for weak depolarizing drives (the phase locking regime) is the result of the active entrainment of an ongoing intrinsic cellular rhythm to a pacemaker drive, rather than a passive summation and thresholding of inputs to a silent pyramidal cell as in previous models. Moreover, the frequency pulling regime in our model, in which the external drive determines the <italic>rate</italic> of phase precession (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), is not generated by previous models. The dynamics inside the place field in our model take place almost entirely within this novel frequency pulling regime, with the phase locking regime instead governing the dynamics outside of the place field and therefore the alignment of spike phase at place field entry. Because our model relies on the frequency pulling rather than the phase locking regime to produce phase precession, continuous phase precession can be generated for arbitrary input profiles of sufficient strength, and does not require a monotonically increasing ramp input as in previous models (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Second, for symmetrical place fields previous schemes predict a phase advance towards the center of a place field, but a phase reversal as the input current is reduced on leaving the place field (<xref ref-type="bibr" rid="bib58">Melamed et al., 2004</xref>). In contrast, when input currents are sufficient to drive the neuron into the frequency pulling domain in our model, then phase advances continuously throughout the input field (<xref ref-type="fig" rid="fig2">Figure 2D,E</xref>). Provided that inputs are sufficiently strong and sustained, the phase of interneuron firing advances through a full 360 degrees, with the rate of phase precession determined by the strength of the injected current (<xref ref-type="fig" rid="fig2">Figure 2D,E</xref>). Hence, this reduced model explains the dynamics observed in the network simulation of <xref ref-type="fig" rid="fig1">Figure 1</xref>. Specifically, the interneuron remains in a stable phase locking regime while the pyramidal cell is inactive, but enters the frequency pulling regime whenever the pyramidal cell provides sufficient synaptic input, producing phase precession. Phase precessing synaptic inputs from the interneuron coordinate the spike timing of the pyramidal cell and confer phase precession, but phase precession in the interneuron is relatively insensitive to the timing of pyramidal cell inputs, instead requiring only a sufficient increase in excitatory drive.</p></sec><sec id="s2-2"><title>Velocity-modulated precession frequencies are achievable through speed-dependence of synaptic currents</title><p>Experimentally the rate of phase precession in both place cells and interneurons increases with running speed, so that a constant relationship is maintained between spike phase and location (<xref ref-type="bibr" rid="bib25">Geisler et al., 2007</xref>). Because phase precession in our reduced model depends on pacemaker amplitude and excitatory drive, the precession frequency can be flexibly modulated by varying either parameter without needing to adjust the frequency of the pacemaker oscillation (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, Materials and methods). We therefore used the minimal circuit model of <xref ref-type="fig" rid="fig1">Figure 1</xref> to test whether variation of these inputs to the interneuron can account for the experimentally observed speed-dependence of phase precession in pyramidal cells and interneurons. The reduced model predicts that either a decrease in pacemaker amplitude or an increase in depolarizing drive to interneurons with running speed would generate an increase in the rate of phase precession with running speed. However, for stability the pacemaker amplitude must be small for low running speeds (see Materials and Methods). In this case the precession frequency can nevertheless be controlled independently through changes in the depolarizing drive with running speed. Indeed, we found that in the minimal circuit model a linear increase in pacemaker amplitude with running speed, combined with a linear increase in depolarizing current to interneurons with running speed, can generate an approximately linear increase in precession frequency while maintaining stable precession dynamics across running speeds (<xref ref-type="fig" rid="fig3">Figure 3</xref>). Hence, the dynamics required to maintain a fixed relationship between spike phase and place field position can be generated de novo in the local circuitry with inputs at a fixed theta frequency. Importantly, the predicted dependence on running speed of current input to the interneuron is consistent with findings of a velocity-dependent depolarizing current from glutamatergic circuits in the medial septum to interneurons in CA1 (<xref ref-type="bibr" rid="bib23">Fuhrmann et al., 2015</xref>). Similarly, the predicted dependence of the pacemaker amplitude on running speed is consistent with the dependence on running speed of both the LFP theta amplitude in CA1 (<xref ref-type="bibr" rid="bib56">McFarland et al., 1975</xref>; <xref ref-type="bibr" rid="bib55">Maurer et al., 2005</xref>; <xref ref-type="bibr" rid="bib63">Patel et al., 2012</xref>) and the activity of inhibitory circuitry in the medial septum (<xref ref-type="bibr" rid="bib39">King et al., 1998</xref>).<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.20349.007</object-id><label>Figure 3.</label><caption><title>Running speed dependence of phase precession.</title><p>(<bold>A</bold>) Illustration of the model circuit. To account for running speed dependence, pacemaker amplitude and depolarizing current amplitude are increased linearly with running speed. (<bold>B</bold>) Examples of phase precession at a slow and fast running speed, where the pacemaker amplitude and depolarizing current to interneurons are varied. (<bold>C</bold>) Phase precession frequency as a function of running speed. Individual dots illustrate the estimated precession frequency on a single lap.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.007">http://dx.doi.org/10.7554/eLife.20349.007</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig3-v2"/></fig></p></sec><sec id="s2-3"><title>Dorsoventral traveling waves and phase precession gradients can emerge from a common pacemaker drive</title><p>The phase of theta activity varies systematically across the dorsoventral axis of the hippocampus (<xref ref-type="bibr" rid="bib48">Lubenov and Siapas, 2009</xref>), spanning a range of 180 degrees (<xref ref-type="bibr" rid="bib63">Patel et al., 2012</xref>) and creating the appearance of a dorsoventral traveling wave. This variation is difficult to account for by temporal delays in a common pacemaker drive, which has led to the suggestion that entorhinal-hippocampal or intrahippocampal interactions are required to account for dorsoventral phase offsets (<xref ref-type="bibr" rid="bib63">Patel et al., 2012</xref>; <xref ref-type="bibr" rid="bib46">Long et al., 2015</xref>). We asked if the present model can account for these observations without the necessity for additional circuit components. In the reduced interneuron model, the range of phases that stably lock to pacemaker input is precisely 180 degrees, with locking phase depending on the strength of the excitatory current and pacemaker amplitude (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). All other spike phases are unstable. This suggests that a gradient in excitatory inputs to interneurons (or alternatively a gradient in input resistance or some intrinsic membrane current) along the dorsoventral axis might be sufficient to generate the observed dorsoventral phase gradient, despite a coherent pacemaker input.</p><p>To test this hypothesis using more biologically plausible neuronal dynamics we simulated integrate and fire interneurons driven by the same pacemaker inputs, but different levels of depolarizing input currents (<xref ref-type="fig" rid="fig4">Figure 4A–C</xref>). This is equivalent to the full circuit model while the animal is outside of the place field and therefore the pyramidal cell is inactive. <xref ref-type="fig" rid="fig4">Figure 4B</xref> shows three examples of these simulations. In each case, the interneuron is attracted towards a stable locking phase of the pacemaker input, but the precise locking phase depends on the strength of depolarizing current. In <xref ref-type="fig" rid="fig4">Figure 4C</xref> we systematically analyzed how this locking phase depends on the strength of depolarizing current, finding a relationship remarkably similar to that predicted by the reduced model, including a range of 180 degrees of locking phases. Hence, in addition to explaining the change in precession frequency with running speed, the interplay between excitatory currents and pacemaker inputs can explain the phase gradient across the dorsoventral axis of the hippocampus, allowing the emergence of traveling theta waves based on variable locking to a single, common pacemaker input.<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.20349.008</object-id><label>Figure 4.</label><caption><title>Theta dynamics across the dorsoventral axis.</title><p>(<bold>A</bold>) Inputs to interneurons across the dorsoventral axis hypothesized to produce a gradient in theta phase. (<bold>B</bold>) Interneuron spike phases for three simulations with different depolarizing currents. (<bold>C</bold>) Interneuron locking phase vs depolarizing current (cf. <xref ref-type="fig" rid="fig2">Figure 2B</xref>). (<bold>D</bold>) A circuit model, and its dependence on dorsoventral location, which could produce simultaneous traveling theta waves and gradients in precession slope. (<bold>E</bold>) Phase precession in a ventral place cell/interneuron pair (place field size 10 meters). (<bold>F</bold>) Phase precession in a dorsal place cell/interneuron pair (place field size 0.3 meters). Note the change in both locking phase and precession slope from dorsal to ventral.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.008">http://dx.doi.org/10.7554/eLife.20349.008</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig4-v2"/></fig></p><p>Place field size also varies along the dorsoventral axis of the hippocampus, ranging from less than one meter dorsally to approximately 10 meters ventrally (<xref ref-type="bibr" rid="bib40">Kjelstrup et al., 2008</xref>). This gradient is associated with a concomitant gradient in the slope of phase precession, such that phase precesses through approximately one cycle both dorsally and ventrally (<xref ref-type="bibr" rid="bib40">Kjelstrup et al., 2008</xref>). To test whether our minimal circuit model could account for these observations in addition to the traveling wave dynamics, we simulated place cell/interneuron pairs at the ventral and dorsal pole of CA1, with place field sizes of approximately 10 meters and 0.3 meters respectively, and interneuron locking phases separated by approximately 180 degrees (<xref ref-type="fig" rid="fig4">Figure 4D–F</xref>). We found that the gradient in both phase precession and theta phase along the dorsoventral axis could be accounted for simultaneously by a combination of a dorsoventral gradient in the amplitude of pacemaker drive, the depolarizing current to the interneuron and the strength of excitatory synaptic connections (<xref ref-type="fig" rid="fig4">Figure 4E,F</xref>). Thus, our proposed mechanism predicts that depolarizing current input to interneurons (or their excitability), the strength of excitatory synaptic connections from pyramidal cells to interneurons and the amplitude of the septal pacemaker drive all decrease from the dorsal pole to the ventral pole of the hippocampus (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). In line with these predictions, theta power is observed to decrease from dorsal to ventral hippocampus (<xref ref-type="bibr" rid="bib66">Royer et al., 2010</xref>).</p></sec><sec id="s2-4"><title>Robust phase precession is generated along two-dimensional trajectories</title><p>As a further test of the model we asked if in addition to accounting for phase precession on linear tracks, it can account for the properties of phase precession in open environments. In open environments, spikes always precess from late to early phases of theta, regardless of running direction (<xref ref-type="bibr" rid="bib35">Huxter et al., 2008</xref>; <xref ref-type="bibr" rid="bib12">Climer et al., 2013</xref>; <xref ref-type="bibr" rid="bib37">Jeewajee et al., 2014</xref>). These dynamics arise naturally from the depolarizing current envelope in the present model if the animal passes in a straight line through the center of a place field at a constant speed (<xref ref-type="fig" rid="fig1">Figure 1</xref>). No additional inputs such as from head direction cells are required. Experimentally, a more complex feature of phase precession in open environments is observed on passes through the edge of the place field, in which case the firing phase advances through around 180 degrees before reversing through 180 degrees over the second half of the field (Supplementary Figure S2b in <xref ref-type="bibr" rid="bib35">Huxter et al., 2008</xref>). In the present model, similar dynamics occur when the interneuron is not driven sufficiently strongly to pass through to the next cycle and is instead attracted back towards the initial phase (<xref ref-type="fig" rid="fig2">Figure 2D–E</xref> and <xref ref-type="fig" rid="fig5">Figure 5A</xref>). Our model is also consistent with sequences observed during backwards travel, in which theta sequences reflect the ordering at which locations are visited rather than heading direction (<xref ref-type="bibr" rid="bib9">Cei et al., 2014</xref>; <xref ref-type="bibr" rid="bib53">Maurer et al., 2014</xref>).<fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.20349.009</object-id><label>Figure 5.</label><caption><title>Robustness of phase precession to changes in the strength of place field drive.</title><p>(<bold>A</bold>) Failure to precess through one full cycle. In this case, the external inputs were not strong enough to drive the interneuron past the threshold to be pulled into the next theta cycle, and instead it is pulled back towards the phase it started at. This is also seen in an initial increase followed by a decrease in frequency as the cell advances before reversing in phase against the pacemaker. (<bold>B</bold>) Precession through two full cycles. In this simulation, the amplitude of the slow envelope current was increased. This results in an increased firing rate of the pyramidal cell and hence an increased excitatory input to the interneuron. As a result, the interneuron received enough drive to pass through two cycles of pacemaker input. (<bold>C</bold>) The probability of an interneuron precessing through one, two, or three cycles of pacemaker theta phase as a function of the amplitude of the depolarizing envelope current onto the place cell. (<bold>D</bold>) The number of spikes fired by the place cell (with standard deviation shown as error bars) as a function of the amplitude of depolarizing envelope current. (<bold>E</bold>) The probability of the interneuron precessing through one, two, or three cycles of pacemaker theta phase replotted as a function of the number of spikes fired by the place cell.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.009">http://dx.doi.org/10.7554/eLife.20349.009</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig5-v2"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20349.010</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Phase precession is robust to transient intrahippocampal perturbation.</title><p><xref ref-type="bibr" rid="bib79">Zugaro et al. (2005)</xref> demonstrated that spike phase precession persists after transient inactivation of the hippocampus. To address whether our model can account for these observations, we simulated transient silencing of interneurons and pyramidal cells and simultaneous reset of the external pacemaker. Three representative example simulations are shown. In each case, phase precession resumes following the transient perturbation (cf. <xref ref-type="fig" rid="fig3">Figure 3</xref>of <xref ref-type="bibr" rid="bib79">Zugaro et al., 2005</xref>). Left column: The theta phase (black trace), interneuron membrane potential and spikes (red) and pyramidal cell membrane potential and spikes (blue). Right column: The interneuron and pyramidal cell spike phases relative to the pacemaker theta rhythm. Black bars show periods of silencing.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.010">http://dx.doi.org/10.7554/eLife.20349.010</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig5-figsupp1-v2"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20349.011</object-id><label>Figure 5—figure supplement 2.</label><caption><title>Perturbation of spike phase during interneuron silencing.</title><p>(<xref ref-type="bibr" rid="bib67">Royer et al., 2012</xref>) showed that phase precession by pyramidal cells is maintained following transient silencing of PV neurons, while the phase can appear to shift. To examine whether our model can account for these observations we simulated transient inhibition of interneurons. (<bold>A</bold>–<bold>B</bold>) When interneurons were silenced for 1 s, centered on the place cell’s firing field, phase precession was maintained and on average spike phase appears to advance. (<bold>A</bold>) Average spike phase (<inline-formula><mml:math id="inf1"><mml:mo>±</mml:mo></mml:math></inline-formula>circular standard error) across five bins spanning the length of the place field, for the control simulation and for simulations in which interneurons are silenced (cf. <xref ref-type="fig" rid="fig7">Figure 7c</xref> in <xref ref-type="bibr" rid="bib67">Royer et al., 2012</xref>). (<bold>B</bold>) The mean shift in spike phase in each bin (cf. <xref ref-type="fig" rid="fig7">Figure 7b</xref> in <xref ref-type="bibr" rid="bib67">Royer et al., 2012</xref>). The relatively minor effects of interneuron silencing in our simulations is a result of the phase locking of cells outside of the place field (before interneuron silencing begins), which ensures that pyramidal cells begin spiking at the correct phase upon place field entry. Despite the lack of any theta coordination via interneuron input inside the place field, their tonic spiking over the place field combined with the correct phase alignment at place field entry is sufficient to generate results similar to those of Royer et al. in the averaged data. (<bold>C</bold>–<bold>D</bold>) Simulations as for (<bold>A</bold>–<bold>B</bold>), but with silencing of interneurons centered on a random location within 20 cm of the place field center, which may better approximate the conditions in <xref ref-type="bibr" rid="bib67">Royer et al. (2012)</xref>. In these simulations phase precession is again maintained, while the phase change is reduced. Thus, when optogenetic silencing only covers part of the place field, interneuron inputs in the unsilenced portion of the place field further reduce the amount of disruption in the averaged data.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.011">http://dx.doi.org/10.7554/eLife.20349.011</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig5-figsupp2-v2"/></fig></fig-group></p><p>The phase advance and then reversal on passing through the edge of a place field results from failure of the weak synaptic depolarization to drive the model into the frequency pulling domain indicated in <xref ref-type="fig" rid="fig2">Figure 2</xref>. What happens when the synaptic drive is instead very large? We found that with strong and sustained inputs to place cells precession continues over multiple theta cycles (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). However, the pacemaker drive to the interneuron confers robustness against this effect, as the interneuron can only precess through a discrete number of theta cycles and requires considerable additional input to precess through two cycles of theta rather than one. <xref ref-type="fig" rid="fig5">Figure 5C</xref> shows how the number of theta cycles precessed by the interneuron varies with the amplitude of the slow envelope. Over a broad range of input currents (<xref ref-type="fig" rid="fig5">Figure 5C</xref>), or more directly, a broad range of pyramidal cell spike counts (<xref ref-type="fig" rid="fig5">Figure 5D,E</xref>), the interneuron will precess exactly one cycle over the place field. For the choice of parameters used here, robust phase precession through one cycle in the interneuron occurs provided the place cell fires between 10 and 25 spikes in its place field. Thus, phase precession is sufficiently robust to allow considerable rate remapping, but the mechanism nevertheless places constraints on the coexistence of phase precession and rate remapping within place cells (<xref ref-type="bibr" rid="bib3">Allen et al., 2012</xref>).</p><p>Theta phase precession has also been shown to exhibit considerable robustness against experimentally induced circuit perturbations. For example, when CA1 is transiently silenced (for <inline-formula><mml:math id="inf2"><mml:mo>∼</mml:mo></mml:math></inline-formula>200 ms) and the theta rhythm is simultaneously reset, phase precession resumes in CA1 unperturbed upon recovery (<xref ref-type="bibr" rid="bib79">Zugaro et al., 2005</xref>). We tested whether the model would exhibit similar robustness under such a perturbation by injecting a negative current into both place cells and interneurons to induce silencing while simultaneously resetting the phase of the external pacemaker drive. Indeed, we found that phase precession resumes upon recovery from this perturbation, as observed experimentally (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). Further robustness has been observed under optogenetic perturbations of the CA1 circuitry. Specifically, transient (1 s) silencing of somatostatin-positive (SOM) interneurons has almost no effect on spike phase, altering mainly the burst firing of place cells, while silencing of parvalbumin-positive (PV) interneurons appears to introduce a small shift in average spike phase without compromising phase precession overall (<xref ref-type="bibr" rid="bib67">Royer et al., 2012</xref>). We replicated this experimental protocol by injecting a 1 s negative current pulse into the interneuron as the animal crossed the place field. When analyzing the resulting data using the methods of Royer and colleagues, we found a shift in spike phase of a similar magnitude and direction to that reported in experimental data (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2A,B</xref>). These findings can be explained as follows. The interneuron coordinates the pyramidal cell’s theta activity until place field entry so that pyramidal cell spike phase is correctly aligned at the start of the place field. Upon interneuron silencing, the pyramidal cell’s activity becomes independent of the theta rhythm, and depends only on the slow depolarizing drive. Nevertheless, because the pyramidal cell continues to spike tonically at a frequency higher than the theta rhythm during interneuron silencing, its spikes shift in phase continuously (i.e., precess) against the theta rhythm over the place field. This precession within the place field, combined with the phase alignment at place field entry provided by the interneuron before the onset of optogenetic silencing, generates the apparent phase shift of <xref ref-type="bibr" rid="bib67">Royer et al. (2012)</xref> in the trial-averaged data. In contrast to this transient manipulation, we expect that phase precession would be severely disrupted in experiments where phase precessing interneurons are silenced over an entire lap, so that the phase at place field entry is not correctly aligned.</p><p>In summary, the model we outline here provides a robust mechanism for phase precession consistent with the circuitry in CA1. The model accounts for the key features of phase precession observed in CA1, including the dependence on running speed, place field size and dorsoventral location, phase precession along two-dimensional trajectories, the coupling of phase precession between place cells and interneurons, dorsoventral traveling theta waves and robustness to circuit perturbations.</p></sec><sec id="s2-5"><title>Efficient and flexible sequence compression depends on network configuration</title><p>While the model that we propose in <xref ref-type="fig" rid="fig1">Figure 1</xref> generates phase precession using only an isolated place cell and interneuron, CA1 place cells are embedded into much larger networks in which only 7–11% of neurons are interneurons (<xref ref-type="bibr" rid="bib77">Woodson et al., 1989</xref>; <xref ref-type="bibr" rid="bib2">Aika et al., 1994</xref>; <xref ref-type="bibr" rid="bib5">Bezaire and Soltesz, 2013</xref>). The large disparity between the number of place cells and interneurons demands that a single interneuron in the model must couple to multiple pyramidal cells and generate phase precession in each one. To test if this is possible, we first simulated a single interneuron coupled synaptically to two pyramidal cells. We find that, when each pyramidal cell receives a depolarizing drive at a different time, the interneuron can be recruited for phase precession independently by each pyramidal cell (<xref ref-type="fig" rid="fig6">Figure 6</xref>). In this case, the interneuron shows two phase precession fields. As a direct consequence, and in contrast to the case in which there is just one active pyramidal cell per interneuron, the model predicts that outside of their suprathreshold firing fields place cells have subthreshold phase precession fields, characterized by transient increases in the frequency of their theta-modulated inhibitory input when the other place cell is active (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). However, if the pyramidal cells have overlapping place fields, these dynamics may be disrupted. In this case, the stronger synaptic input to the interneuron from two active place cells may increase its precession frequency (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), causing it to precess over multiple cycles (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). Moreover, as synaptic output from the same interneuron coordinates the theta activity of both place cells, their spiking may become synchronized. Thus, a single interneuron can support phase precession by more than one place cell, but overlap between the firing fields of place cells coupled to the same interneuron may disrupt precession-based codes by shifting the phase of coding relative to position and by causing multiple cycles of phase precession within a single firing field.<fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.20349.012</object-id><label>Figure 6.</label><caption><title>Recruitment of an interneuron for phase precession by multiple pyramidal cells.</title><p>(<bold>A</bold>) Circuit diagram showing two pyramidal cells connected to the same interneuron and receiving slow envelope currents at different points in time. (<bold>B</bold>) Simulation of this circuit showing the intrinsic theta frequency, spike phases and membrane potentials. When the blue cell recruits the interneuron for phase precession as the animal crosses its place field, this is also reflected in phase precession of the membrane potential oscillation of the green cell while the animal is outside of its firing field (and vice versa).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.012">http://dx.doi.org/10.7554/eLife.20349.012</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig6-v2"/></fig></p><p>Given this potential sensitivity of the circuit to overlap between place fields of cells connected to the same interneuron, it is unclear whether our proposed mechanism can be extended to large networks with realistic numbers of interneurons and pyramidal cells. To address this we quantify the performance of larger networks while varying the density of active place cells per interneuron, and the spatial arrangement of the firing fields of place cells connected to the same interneuron (<xref ref-type="fig" rid="fig7">Figure 7A–B</xref>). In these networks each pyramidal cell couples to only one interneuron, and these connections are bidirectional, so that each interneuron couples to multiple pyramidal cells (see Materials and methods). This can be viewed as a simplified description of the interactions underlying phase precession, with other circuit interactions removed. These larger networks successfully compress slow input sequences into fast theta sequences when place field maps are sparse with low overlap (<xref ref-type="fig" rid="fig7">Figure 7A</xref> top). In contrast, such sequences do not emerge when place field maps are dense and have high overlap (<xref ref-type="fig" rid="fig7">Figure 7A</xref> bottom).<fig-group><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.20349.013</object-id><label>Figure 7.</label><caption><title>Compression of slow input sequences in CA1 networks.</title><p>(<bold>A</bold>) Network simulations at low and high mapping densities. For sparse, random place field maps, input sequences are compressed into robust theta sequences. For dense, random place field maps, no such sequence compression is observed. (<bold>B</bold>) Top: Examples of optimal maps given two different place field densities. A set of place cells attached to the same interneuron are mapped onto a linear track. In an optimal map, their place field centers are organized such that their overlap is minimized. For a certain number of place cells per interneuron (here, four) overlap occurs even for an optimal map. Bottom: Example of random maps. The location of each place field on the track is drawn from a uniform probability distribution. In this case, a larger number of place cells per interneuron causes an increase in the probability that place fields will overlap. (<bold>C</bold>) Network performance vs number of active place cells per interneuron. As more place cells become active (or the number of interneurons is decreased), the compression of inputs into theta sequences is degraded (red and blue traces). This is caused by a drop in the coherence of phase precession in the population, despite a relatively constant phase-position correlation in individual place cells on single laps (blue trace vs gray trace).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.013">http://dx.doi.org/10.7554/eLife.20349.013</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig7-v2"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20349.014</object-id><label>Figure 7—figure supplement 1.</label><caption><title>Three examples of random place field maps with a density of one active place cell per interneuron per meter, for which disruption of sequence compression occurs (<xref ref-type="fig" rid="fig7">Figure 7C</xref>).</title><p>A single interneuron is shown, as well as the active place cells which couple to that interneuron. <italic>Top panels</italic>: Place field inputs to the five pyramidal cells active on the track and coupled to the single interneuron. <italic>Second panels</italic>: Interneuron theta frequency over time for a single lap as the animal moves along the track. <italic>Third panels</italic>: Interneuron spike phases over time. Note that the interneuron precesses over multiple cycles when it receives sufficient pyramidal cell input, but that place field overlap does not always lead to multiple cycles of phase precession. Fourth panels: Interneuron spiking (red ticks), pyramidal cell spiking (colored ticks) and pyramidal cell membrane potential (colored traces) over time. <italic>Fifth panels</italic>: Pyramidal cell membrane potential theta frequencies over time. <italic>Bottom Panels</italic>: Pyramidal cell spike phases over time. Note that pyramidal cell spiking is highly synchronous within a theta cycle when multiple pyramidal cells are coactive. This synchrony, as well as the multiple cycles of interneuron phase precession, underlies the disruption of sequence compression observed in <xref ref-type="fig" rid="fig7">Figure 7</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.014">http://dx.doi.org/10.7554/eLife.20349.014</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-20349-fig7-figsupp1-v2"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20349.015</object-id><label>Figure 7—figure supplement 2.</label><caption><title>Robustness of phase precession under extraneous noise.</title><p>(<bold>A</bold>−<bold>B</bold>) Examples of phase precession in simulations with low (<bold>A</bold>) and moderate (<bold>B</bold>) levels of noise injected into the pyramidal cell. (<bold>C</bold>−<bold>D</bold>) Dependence of phase precession and population sequence compression on the level of injected pyramidal cell (<bold>C</bold>) and interneuron (<bold>D</bold>) noise (for an explanation of these metrics, see <xref ref-type="fig" rid="fig7">Figure 7</xref> and its description in both the main text and the Materials and methods section). Note that, for a given amplitude in mV, the noise level also depends on the simulation timestep and membrane time constant (see <xref ref-type="disp-formula" rid="equ11">Equation 14</xref>). Note also that, although interneurons and pyramidal cells appear to differ in their sensitivity to noise in these simulations, this is consistent with the amplitudes of other currents injected into the two cell types in the model, which are an order of magnitude smaller for interneurons than pyramidal cells (e.g., the pacemaker and velocity-dependent current to interneurons vs the place field drive and velocity-dependent current to pyramidal cells). As the overall scale of inputs depend strongly on the neuron model and biophysical parameters such as membrane resistance, they cannot be interpreted quantitatively in the present model due to a lack of biophysical detail.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.015">http://dx.doi.org/10.7554/eLife.20349.015</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig7-figsupp2-v2"/></fig><fig id="fig7s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20349.016</object-id><label>Figure 7—figure supplement 3.</label><caption><title>Putative mechanisms for removing disruption from network theta sequences.</title><p>(<bold>A</bold>) In one possible mechanism, synaptic weights between pyramidal cells and interneurons are altered so that pyramidal cell pairs with overlapping place fields no longer functionally couple to the same interneuron. (<bold>B</bold>) In a second mechanism, the place fields themselves undergo changes to remove overlap for pyramidal cells coupled to the same interneuron.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.016">http://dx.doi.org/10.7554/eLife.20349.016</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig7-figsupp3-v2"/></fig><fig id="fig7s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20349.017</object-id><label>Figure 7—figure supplement 4.</label><caption><title>Distributions of single-cell phase precession strengths in random maps with varying degrees of disruptive place field overlap.</title><p>Phase-position correlation is measured for each cell using its pooled spiking activity over 30 laps. Each map consisted of 200 pyramidal cells with place fields randomly organized under a uniform distribution over a five meter track. When there is just one active pyramidal cell per interneuron on the track (top panel), the distribution of phase-position correlations simply reflects limited sample size effects, so that increasing the number of laps would yield a narrower distribution. As the number of active pyramidal cells per interneuron is increased, the mean phase-position correlation decreases due to disruptive place field overlap in the network. Nevertheless, strong phase precession continues to be generated in a fraction of pyramidal cells even for very dense maps (bottom panel).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.017">http://dx.doi.org/10.7554/eLife.20349.017</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig7-figsupp4-v2"/></fig></fig-group></p><p>To more systematically quantify factors affecting sequence compression within the network, we introduced two distinct metrics which measure the extent to which spiking within theta cycles faithfully recapitulates the slow sequence of place field inputs. We call these the single-cycle theta sequence metric and the population phase precession metric (see Materials and methods for details). The single-cycle theta sequence metric measures the similarity between slow input sequences and individual theta sequences (<xref ref-type="fig" rid="fig7">Figure 7C</xref>, solid red line). The population phase precession metric measures the robustness and coherence of phase precession in a population of cells, and therefore serves as an averaged measure of sequence compression over a dataset (<xref ref-type="fig" rid="fig7">Figure 7C</xref>, solid blue line). For these metrics, correlations close to zero imply a lack of sequential organization and therefore poor performance, while strong (positive or negative) correlations signify the presence of sequential representations within theta cycles. Using these metrics, we tested how sequence compression varies depending on the properties of the place field map within the network. We observed decreases in the strength of both individual theta sequences and population phase precession with increasing place field density on the track (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). Strikingly, this quantitative analysis also revealed that with random place field mappings network performance degrades continuously with increasing place field density, whereas with optimal place field mappings designed to minimize overlap in the place fields of cells coupled to the same interneuron (<xref ref-type="fig" rid="fig7">Figure 7B</xref>), high performance is maintained over a wider range of place field densities (<xref ref-type="fig" rid="fig7">Figure 7C</xref>, dashed red and blue lines).</p><p>In summary, both the number of active place cells in an environment and the spatial organization of their place fields influence the quality of sequence compression. In general, network performance is high when the spatial maps are sparse, but high levels of performance can also be maintained in denser spatial maps provided that the place fields of cells coupled to the same interneuron are well separated.</p></sec><sec id="s2-6"><title>Network reconfiguration can dissociate single-trial phase precession and theta sequences</title><p>Recent evidence suggests that theta sequences and phase precession on single laps may be dissociated under some circumstances, such that single-cell precession can occur without spatially ordered theta sequences. For example, on the first lap of a novel linear track place cells exhibit phase precession, in that their spikes advance continuously in phase against the theta rhythm, but the phase lags between cells are initially uncoordinated and do not generate population theta sequences until after further experience (<xref ref-type="bibr" rid="bib19">Feng et al., 2015</xref>). Similarly, when input from CA3 is permanently absent, robust phase precession is observed in each cell while spatially organized theta sequences fail to emerge (<xref ref-type="bibr" rid="bib59">Middleton and McHugh, 2016</xref>). To test whether such a dissociation of phase precession and theta sequences is consistent with our model, we asked whether the changes in sequence compression observed in the simulations of <xref ref-type="fig" rid="fig7">Figure 7</xref> are caused by changes in the robustness of phase precession in individual place cells, or whether they result from changes in the timing relationships between groups of place cells (i.e., a decoherence of phase precession in neuronal populations). When we quantified the fidelity of phase precession for individual cells on single laps (see Materials and methods) we found that robust single-unit phase precession persists as place field overlap is increased (<xref ref-type="fig" rid="fig7">Figure 7C</xref>, gray line), despite the disruption of single-cycle theta sequences and population phase precession. Thus, sequence disruption is caused by a decoherence of phase precession within the population. This decoherence is caused by indirect interactions amongst place cells with overlapping place fields and shared interneurons (e.g. see <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>).</p><p>Given this network configuration-dependent disruption of population activity in our model, we wondered if extraneous noise impacts phase precession and population sequences, and whether interneuron and pyramidal cell noise have similar or dissociable effects on circuit function. We found that with increasing amplitude noise injected into pyramidal cells, single-cell phase precession and population sequences were impaired in parallel (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2A–C</xref>). This is distinct from increasing place field overlap, which disrupts population sequences but not single-cell phase precession. In contrast, increasing noise injected into interneurons disrupts population sequences while leaving phase precession intact at the single trial level, revealing an additional mechanism for dissociating phase precession from population sequences (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2D</xref>). These results underscore the distinct roles of interneurons and pyramidal cells for generating phase precession and population sequences in the model.</p><p>We next sought to establish how the experience dependent reorganization of network activity observed by Feng and colleagues might occur. Our model suggests two potential mechanisms. First, plasticity between place cells and interneurons could adjust synaptic weights such that place cells with overlapping place fields no longer couple strongly to the same interneurons (<xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3A</xref>). Second, the slow envelope inputs to place cells could rapidly reorganize in order to minimize the overlap of place fields of cells coupled to the same interneurons (<xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3B</xref>). If a plasticity mechanism were in place, synaptic changes which allow sequential activity in a new environment would cause disruption in previously stored maps. In contrast, place field reorganization could enable multiple stable maps to be formed without disruption or interference between different representations. Experimental evidence suggests that place field activity is indeed reorganized upon exposure to a novel environment, including a sparsification of the CA1 place code and a decrease in the number of active place cells (<xref ref-type="bibr" rid="bib21">Frank et al., 2004</xref>; <xref ref-type="bibr" rid="bib38">Karlsson and Frank, 2008</xref>). Whether such a reorganization mediates removal of unwanted place field overlap as we predict here is yet to be determined. Further evidence suggests that such a mechanism may depend crucially on plasticity in CA3 to CA1 connections (<xref ref-type="bibr" rid="bib15">Dragoi and Tonegawa, 2013</xref>). Hence, permanent silencing of CA3 would be expected to disrupt CA1 theta sequences without affecting phase precession in our model, as observed by <xref ref-type="bibr" rid="bib59">Middleton and McHugh (2016)</xref>.</p></sec><sec id="s2-7"><title>Theta sequences can be generated in a large number of spatial maps</title><p>What constraints does this sensitivity of sequence generation to connectivity impose on spatial mapping? Intuitively, as more place cells are connected to a given interneuron, the fraction of place cells that can be active in a given environment without interfering with sequence generation becomes smaller. This intuition can be formalized by adopting a simplified model in which place cells can map to different locations on a linear track, under the constraint that place cells which functionally couple to the same interneuron cannot map to locations within a certain distance of each other, which we termed the exclusion zone (see Materials and methods). With this model, we find the maximum fraction of pyramidal cells, <inline-formula><mml:math id="inf3"><mml:mi>F</mml:mi></mml:math></inline-formula>, which can express place fields in a given map is:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf4"><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf5"><mml:msub><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> are the number of interneurons and pyramidal cells respectively, <inline-formula><mml:math id="inf6"><mml:mi>L</mml:mi></mml:math></inline-formula> is the length of the track and <inline-formula><mml:math id="inf7"><mml:mi>D</mml:mi></mml:math></inline-formula> is the size of the exclusion zone (approximately the size of a place field). The above inequality gives a bound on the density of the spatial representation. It implies that spatial maps generated by this network must be sparse and that the required sparsity depends on the ratio of pyramidal cells to interneurons, and on the size of the place fields. If the network is close to this upper bound, there will be a high density of subthreshold phase precession fields in place cells and interneurons will phase precess over most of the environment. If instead the network is operating well below this upper bound, so that the representation is sparser than the minimum requirement, there will be only occasional interneuron and subthreshold phase precession fields. While subthreshold phase precession fields have not yet been investigated, the density of reported interneuron phase precession fields can be high (see Figure 2 of <xref ref-type="bibr" rid="bib52">Maurer et al., 2006</xref>), suggesting that CA1 networks may operate close to this bound.</p><p>Does the non-overlap constraint limit the capacity of the network for the representation of distinct environments and contexts? When we quantify the capacity of the network under the non-overlap constraint (see Experimental Procedures), we find that the number of distinct spatial maps, cell assemblies and sequences that can be generated by the network are each considerably larger than the number of environments, events or behavioral episodes that an animal could encounter within its lifetime. For example, assuming a population of 10,000 pyramidal cells of which 20% are active in each map, 1000 interneurons, an exclusion zone between place fields of 1 meter, a linear track of length five meters and that place field locations can be distinguished with a spatial resolution of 10 cm (a conservative estimate), the number of spatial maps in which coherent theta sequences are generated is greater than <inline-formula><mml:math id="inf8"><mml:msup><mml:mn>10</mml:mn><mml:mn>5000</mml:mn></mml:msup></mml:math></inline-formula>. For the same population of cells, assuming each cell assembly consists of 100 pyramidal cells, there over <inline-formula><mml:math id="inf9"><mml:msup><mml:mn>10</mml:mn><mml:mn>500</mml:mn></mml:msup></mml:math></inline-formula> possible cell assemblies, and assuming a phase sequence consists of 7 cell assemblies (<xref ref-type="bibr" rid="bib45">Lisman and Idiart, 1995</xref>) there are over <inline-formula><mml:math id="inf10"><mml:msup><mml:mn>10</mml:mn><mml:mn>1500</mml:mn></mml:msup></mml:math></inline-formula> possible sequences. Hence, despite the constraints imposed by the coupling between groups of pyramidal cells and interneurons, the capacity of the network to encode distinct environments, contexts and episodes can be considered to be unlimited from an ethological perspective.</p><p>The above analysis quantifies the number of maps under which all pyramidal cells exhibit robust phase precession. However, experimental data show a distribution of phase precession strengths in simultaneously recorded pyramidal cell populations in CA1 (e.g., <xref ref-type="bibr" rid="bib71">Skaggs et al., 1996</xref>; <xref ref-type="bibr" rid="bib69">Schmidt et al., 2009</xref>). We therefore asked whether randomly organized place field maps in our model might be sufficient to account for typical distributions of single-cell phase precession strengths in CA1 populations, despite disruptive place field overlap. In random maps, we found that pyramidal cells exhibit a broad range of phase-position correlations (<xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4</xref>). Even for very dense random maps, in which phase precession is severely disrupted on average, a substantial proportion of the population continued to exhibit robust phase precession. Thus, even randomly organized place field maps may be sufficient to account for experimentally observed phase precession statistics in individual place cells.</p><p>In summary, we find that overlap between the place fields of pyramidal cells which functionally couple to the same interneuron can disrupt sequence compression in the network. The level of disruption increases with the number of active place cells per interneuron. For random place field mappings, maintaining coherent sequence compression requires that place field maps are sparse. By introducing mechanisms to organize place field maps in order to avoid interference, coherent sequence compression can be maintained with much larger numbers of active place cells. While such mechanisms reduce the number of spatial maps available to the network, we find that even under these constraints, there is a practically unlimited capacity for generating distinct spatial maps, cell assemblies and theta sequences in the network.</p></sec><sec id="s2-8"><title>Flexible compression of arbitrary input sequences allows learning through STDP</title><p>How might downstream neurons receiving synaptic input from place cells use compressed sequences for computation? A longstanding hypothesis is that sequence compression enables the association of events through spike timing dependent plasticity (STDP) (<xref ref-type="bibr" rid="bib71">Skaggs et al., 1996</xref>). Because STDP acts on events correlated on a timescale of tens of milliseconds it is not well suited to directly associating behavioral events (<xref ref-type="bibr" rid="bib43">Levy and Steward, 1983</xref>; <xref ref-type="bibr" rid="bib51">Markram et al., 1997</xref>; <xref ref-type="bibr" rid="bib49">Magee and Johnston, 1997</xref>; <xref ref-type="bibr" rid="bib6">Bi and Poo, 1998</xref>), but it may act on compressed theta sequences representing several seconds of recent and upcoming experiences (<xref ref-type="fig" rid="fig8">Figure 8A,B</xref>). Theta sequence compression in conjunction with STDP has been suggested to lead to asymmetry in the firing fields of place cells receiving place cell input (<xref ref-type="bibr" rid="bib57">Mehta et al., 2002</xref>), but the use of compressed event sequences as conditioned stimuli in classical associative learning has not been evaluated.<fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.20349.018</object-id><label>Figure 8.</label><caption><title>A proposed function of sequence compression for associative learning.</title><p>(<bold>A</bold>) The animal explores an environment, activating different cells in CA1 in a particular temporal order on a behavioral timescale. (<bold>B</bold>) A population of CA1 place cells performs sequence compression on the slow Gaussian envelope inputs. These cells project onto a downstream neuron which signals some event of interest (the unconditioned stimulus). When this event occurs, this cell fires tonically at the trough of the theta cycle. Synapses from CA1 place cells to the event cell are modifiable via STDP. (<bold>C</bold>) During each cycle of the theta rhythm, CA1 cell assemblies representing past, present and future events in behavioral time are activated sequentially. At the trough of the theta cycle, place cells representing the animal’s current location are active, whereas during the descending and ascending phases cells representing past and future locations respectively are active. If the downstream cell signaling the unconditioned stimulus fires an action potential at the trough of the theta cycle, STDP between pre- and post-synaptic spikes establishes an association between cells representing recently visited locations and the event. (<bold>D</bold>) If instead the downstream cell encoding spikes at the peak of the theta rhythm, an association between cells representing upcoming locations and this cell is formed, whereas cells representing recently visited locations and these cells have their synapses weakened (i.e., the temporal associations are reversed relative to those in <bold>C</bold>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20349.018">http://dx.doi.org/10.7554/eLife.20349.018</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20349-fig8-v2"/></fig></p><p>We consider a population of CA1 pyramidal cells performing sequence compression on its inputs and projecting to a downstream neuron which receives a second strong input encoding some particular outcome or event of behavioral relevance, termed the <italic>unconditioned stimulus</italic> (US) (<xref ref-type="fig" rid="fig8">Figure 8B</xref>). When the US occurs, the downstream cell signals that event by firing action potentials. Importantly, because behavioral events extending up to several seconds into the past are represented in an orderly fashion along the descending phase of the theta cycle and events occurring up to several seconds into the future are ordered along the ascending phase, sequence compression using theta oscillations generates an absolute temporal reference frame in neural time for past, present and future events in real time on which STDP can act (<xref ref-type="fig" rid="fig8">Figure 8C</xref>).</p><p>The absolute temporal reference frame provided by the theta cycle enables the timing of the downstream US-driven action potential to determine the association made. If these downstream action potentials lock to the trough of the theta rhythm, a standard STDP rule will cause inputs from place cells centered on locations before the place where the US was experienced to undergo an increase in synaptic strength (<xref ref-type="fig" rid="fig8">Figure 8C</xref>). This circuit therefore implements associative learning, forming an association between the conditioned and unconditioned stimuli. In contrast, if the downstream cell were to lock to a theta phase other than the trough, this would introduce a temporal shift to behavioral time lags at which potentiation and depression of synapses occurs. For example, a downstream neuron which fires at the peak of the theta oscillation will cause a <italic>decrease</italic> in synaptic strength from neurons representing past locations and an <italic>increase</italic> in synaptic strength from CA1 pyramidal cells representing the future locations (<xref ref-type="fig" rid="fig8">Figure 8D</xref>). Thus, sequence compression with theta oscillations allows locations, or events, occurring in the past or future to be flexibly and selectively associated with a particular outcome by varying the spike phase of the downstream cell. The high capacity of the sequence compression mechanism that we propose here enables STDP to act on a practically unlimited set of potential behavioral experiences.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We show that compression of behavioral sequences into spike sequences on a timescale suitable for synaptic learning mechanisms can be achieved using a minimal network architecture based on CA1 and its inputs from the medial septum. This network architecture implements a novel mechanism for phase precession based on the dynamic integration of pacemaker and spatial signals by spontaneously active interneurons. Our model accounts for phase precession along arbitrary two-dimensional trajectories and across the dorsoventral axis of the hippocampus, and predicts tuning required to maintain phase precession with variation in running speed and spatial scale. It reveals that the phase precession of interneurons, previously assumed to be an epiphenomenon resulting from synaptic inputs from phase precessing place cell assemblies, may instead coordinate phase precession in pyramidal cells. A striking feature of this network is its large capacity for sequence generation. We also show how STDP mechanisms can implement classical conditioning of sequences encoding future or recent trajectories. Thus, the flexible sequence compression mechanism that we identify here may be a substrate for forms of associative learning that store relationships between conditioning stimuli and previous or future experiences. Our analysis indicates that sequence generation through single-cell phase precession would endow these learning mechanisms with sufficient capacity to operate across an animal’s lifetime.</p><sec id="s3-1"><title>Comparison to previous models for phase precession and theta sequence generation</title><p>In the model we propose here the dynamics of signal integration by interneurons are critical to phase precession and sequence generation. This is in contrast to previous models for phase precession which focus on place cells. A key difference is that interneurons generally exhibit ongoing rhythmic spiking activity throughout an environment, whereas place cells are typically silent across most of an environment, showing sustained firing activity only within spatially localized place fields. In our model phase precession requires entrainment of spontaneous spiking by a pacemaker input and acceleration of spiking due to further excitatory spatial input. The dynamics of our proposed model account for phase precession through a full 360 degrees, and suggest mechanisms for speed tuning and dorsoventral organization of phase that are consistent with experimental observations. We discuss below how the distinct dynamics of pyramidal cells lead to models of phase precession with different properties.</p><p>Previous models for phase precession face challenges in fully accounting for experimentally observed features of theta phase precession and sequence generation (see <xref ref-type="supplementary-material" rid="SD1-data">Figure 1—source data 1</xref>). An initial model for phase precession was based on interference between oscillations with different frequencies (<xref ref-type="bibr" rid="bib61">O'Keefe and Recce, 1993</xref>). This model can account for phase precession observed through the full 360 degrees of a theta cycle. However, because it generates repeated spatial firing fields its predictions map more closely onto the properties of entorhinal grid cells than place cells in the hippocampus (<xref ref-type="bibr" rid="bib60">O'Keefe and Burgess, 2005</xref>). Moreover, to account for phase precession in two dimensions interference models require heading modulated speed-dependent oscillatory signals, but experimental evidence for signals with the required properties is so far quite limited (<xref ref-type="bibr" rid="bib31">Harvey et al., 2009</xref>; but see <xref ref-type="bibr" rid="bib75">Welday et al., 2011</xref>). Other models rely on interactions between slow depolarizing inputs to place cells and oscillatory inputs to their soma and / or dendrites. These models generate a unidirectional phase advance over the place field using either an asymmetric ramp drive (<xref ref-type="bibr" rid="bib57">Mehta et al., 2002</xref>; <xref ref-type="bibr" rid="bib47">Losonczy et al., 2010</xref>; <xref ref-type="bibr" rid="bib50">Magee, 2001</xref>) or using spike train adaptation so that firing ceases at the peak of a symmetric place field drive (<xref ref-type="bibr" rid="bib29">Harris et al., 2002</xref>). However, these models appear able to achieve phase advances over the place field of only 180 degrees. Moreover, to avoid phase reversal in later parts of the firing field these models rely on sustained depolarization and elevated firing of place cells to maintain an advanced phase, whereas for many place cells phase continues to advance after the center of their firing field while firing rate and membrane potential depolarization drop (<xref ref-type="bibr" rid="bib34">Huxter et al., 2003</xref>; <xref ref-type="bibr" rid="bib31">Harvey et al., 2009</xref>). In contrast to these previous models, the network architecture we propose here is able to account for phase precession through 360 degrees, does not require sustained depolarization following the place field center, is compatible with single rather than regularly repeating firing fields and does not rely on tuning of upstream velocity controlled oscillators.</p><p>Observations following experimental manipulations of phase precession also constrain models of the underlying circuit and cellular mechanisms. Intrahippocampal administration of cannabinoids disrupts the temporal organization of CA1 activity during theta cycles without altering firing rates (<xref ref-type="bibr" rid="bib65">Robbe and Buzsáki, 2009</xref>), consistent with the scenario in our model when place field maps are relatively dense and unorganized (<xref ref-type="fig" rid="fig7">Figure 7</xref>) or when high levels of extraneous noise are injected into interneurons (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>). Optogenetic inactivation of parvalbumin-positive interneurons (PV), but not somatostatin-positive interneurons (SOM), disrupts phase precession by shifting the firing phase of pyramidal cells towards the trough of the theta cycle (<xref ref-type="bibr" rid="bib67">Royer et al., 2012</xref>), which is consistent with our model if phase precessing interneurons are generally PV-positive (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). Following a transient silencing of CA1 activity and resetting of the hippocampal theta rhythm, phase precession is relatively unperturbed (<xref ref-type="bibr" rid="bib79">Zugaro et al., 2005</xref>), a finding which is also replicated by our model (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>).</p></sec><sec id="s3-2"><title>Predictions for cellular and synaptic organization of CA1 circuits</title><p>Our proposed model for theta sequence compression makes a number of experimentally testable predictions. These can be grouped into core predictions of the model, and ancillary predictions that follow from constraining the model parameters to account for experimentally observed features of phase precession and to maximize the quality of sequence compression performed by the network. The core predictions are as follows. (1) Silent or inactive pyramidal cells should demonstrate subthreshold phase precession fields resulting from inhibitory input when their primary interneuron is activated by another place cell. This prediction should be testable through patch clamp recordings in awake animals (<xref ref-type="bibr" rid="bib31">Harvey et al., 2009</xref>; <xref ref-type="bibr" rid="bib17">Epsztein et al., 2011</xref>). (2) Groups of pyramidal cells which precess in tandem with a particular interneuron should have non-overlapping place fields, and if not will exhibit disrupted theta compression. This prediction may be testable with high density electrical recordings or advanced imaging methods. (3) Artificially depolarizing a place cell to generate a firing rate field should automatically produce phase precession. This requires that the interneuron driving phase precession is active, but otherwise should also be testable through awake patch-clamp recordings. (4) Phase precession in place cells should be accompanied by the presence of strong, phase precessing inhibitory synaptic inputs. (5) Entrainment of septal GABAergic inputs should set the basal theta frequency, but precession of CA1 interneurons and place cells against this basal theta should remain intact over a range of frequencies. (6) Phase precessing interneurons should show reciprocal synaptic connections onto pyramidal cells, and the interneuron to pyramidal cell synapse should be sufficiently strong to synchronize theta activity. (7) Sustained inactivation (e.g., over an entire lap) of phase precessing interneurons should abolish pyramidal cell phase precession.</p><p>Tuning of our model to account for experimentally observed features of phase precession leads to further predictions about expected properties of the network components. (1) Stable phase precession across different running speeds emerges when phase precessing interneurons receive a velocity-modulated excitatory drive and a pacemaker drive with velocity-dependent amplitude. (2) A dorsoventral gradient in excitation to phase precessing interneurons, alongside a gradient in pacemaker amplitude and excitatory synaptic strength, simultaneously generates dorsoventral traveling theta waves and changes in precession slope across the dorsoventral axis. We note that these ancillary predictions pertain only to the specific implementations that we have considered, and that alternative mechanisms are possible within the model circuitry. For example, dorsoventral traveling waves could equally emerge from a gradient in the phase of pacemaker input within our model, and alternative mechanisms for generating velocity-dependence of phase precession may also be possible within the circuit.</p><p>Because there is a greater number of pyramidal cells than interneurons in CA1, our model requires that each phase precessing interneuron couples to several pyramidal cells. For successful sequence generation pyramidal cells which couple to the same interneuron must have largely non-overlapping place fields. This constraint leads to predictions for network topographies that support and determine the quality of sequence compression. (1) For randomly organized place field maps, reducing the density of firing rate fields in the pyramidal cell population increases the quality of the sequence-compressed representation of behavioral events. (2) Sequence compression can be maintained with maximal performance at far greater place field densities when these place fields are organized so as to minimize coactivity of pyramidal cells which precess with the same interneuron. Interestingly, this implies that CA1 does not exhibit topographically organized place field maps. This is consistent with an apparent lack of anatomical organization of place cells (<xref ref-type="bibr" rid="bib64">Redish et al., 2001</xref>; <xref ref-type="bibr" rid="bib13">Dombeck et al., 2010</xref>). (3) Because the maximum place field density is determined by the ratio of phase precessing interneurons to pyramidal cells, and because experimentally observed coding densities appear to increase along the dorsoventral axis, either: there are more phase precessing interneurons per pyramidal cell in the ventral hippocampus, the fraction of silent pyramidal cells in the ventral hippocampus is higher, or sequences are disrupted in the ventral hippocampus. When the constraint underlying these predictions is violated population theta sequences can be disrupted despite the presence of single-cell phase precession on individual laps. This may explain the dissociation of phase precession and theta sequences during exploration of novel environments (<xref ref-type="bibr" rid="bib19">Feng et al., 2015</xref>) and when CA3 is silenced (<xref ref-type="bibr" rid="bib59">Middleton and McHugh, 2016</xref>). In order to avoid such disruption of sequential activity, our model requires that CA1 networks can learn to decorrelate spatial maps following global remapping, most likely via a reorganization of firing rate fields in order to remove disruptive place field overlap. Understanding the learning rules and circuit mechanisms underlying such a decorrelation poses an interesting challenge, and points towards the importance of investigating the initial reorganization and stabilization of place field maps in novel environments (<xref ref-type="bibr" rid="bib21">Frank et al., 2004</xref>; <xref ref-type="bibr" rid="bib38">Karlsson and Frank, 2008</xref>), with a particular focus on the emergence of spatiotemporally structured representations within theta cycles (<xref ref-type="bibr" rid="bib15">Dragoi and Tonegawa, 2013</xref>; <xref ref-type="bibr" rid="bib19">Feng et al., 2015</xref>).</p><p>The model that we propose automatically compresses slow sequences of inputs occurring on timescales of seconds into fast sequences of spiking activity within each cycle of the network theta rhythm. This mechanism could in principle be implemented in parallel with some previously proposed mechanisms for phase precession. For example, in addition to inputs from local interneurons considered here, dendritic and somatic interference in pyramidal cells might also contribute to the phase advance over the first half of the place field (<xref ref-type="bibr" rid="bib50">Magee, 2001</xref>; <xref ref-type="bibr" rid="bib47">Losonczy et al., 2010</xref>), and oscillatory or phase precessing inputs from CA3 and entorhinal cortex might contribute to membrane phase in CA1 place cells (<xref ref-type="bibr" rid="bib11">Chance, 2012</xref>; <xref ref-type="bibr" rid="bib36">Jaramillo et al., 2014</xref>). Moreover, additional architectures could extend our proposed model. For example, in brain areas such as CA3 and entorhinal cortex, attractor mechanisms may generate the firing rate fields through local circuit interactions (<xref ref-type="bibr" rid="bib68">Samsonovich and McNaughton, 1997</xref>), such that the circuit mechanism proposed here generates theta phase precession when excitatory neurons are driven by slow depolarizing inputs arising from within the local circuitry.</p></sec><sec id="s3-3"><title>Roles for sequence compression in memory functions of the hippocampus</title><p>How might theta sequences generated by pyramidal-interneuron interactions contribute to hippocampal-dependent learning and memory? Our analysis suggests a scenario in which, during theta oscillations, CA1 provides a time-compressed ongoing narrative of behavioral episodes (<xref ref-type="fig" rid="fig1">Figures 1</xref>–<xref ref-type="fig" rid="fig7">7</xref>). This enables downstream STDP mechanisms to form associations between ongoing behavioral events and specific outcomes such as reward or punishment (<xref ref-type="fig" rid="fig8">Figure 8</xref>). During sharp wave ripple events the CA1 network can then explore its state space and thereby test outcomes of different behavioral choices based on associations stored during theta activity (e.g., <xref ref-type="bibr" rid="bib70">Singer et al., 2013</xref>; <xref ref-type="bibr" rid="bib26">Gomperts et al., 2015</xref>). This allows a form of mental exploration in which possible behavioral sequences can be simulated and the likely outcomes determined based on associations learned during theta states (<xref ref-type="bibr" rid="bib33">Hopfield, 2010</xref>). The model that we suggest here provides a mechanism for real-time generation of theta sequences with capacity for storing novel associations experienced across an animal’s lifetime.</p><p>This proposed framework makes several additional experimentally testable predictions for neurons downstream from CA1. First, we predict that, during theta states, the spiking of downstream neurons encoding unconditioned stimuli is locked to the theta rhythm, but is not strongly influenced by the activation of specific cell assemblies in CA1. During sharp wave ripple events that take place following learning, we predict that activation of these same downstream neurons can be driven by cell assemblies in CA1 whose outputs were previously associated with the conditioned stimulus. In line with these predictions, reward responsive neurons in the VTA lock more strongly to the hippocampal theta rhythm than non-reward responsive neurons, and VTA neurons that lock more strongly to the hippocampal theta rhythm exhibit greater coordination with CA1 cell assemblies representing reward locations during awake sharp wave ripple events (<xref ref-type="bibr" rid="bib26">Gomperts et al., 2015</xref>). Second, to form associations between conditioned stimuli and rewards occurring in the future, present or past on behavioral timescales, the proposed learning mechanism predicts that the timing of downstream reward-encoding neurons relative to the theta rhythm should shift, firing near the peak for future rewards and near the trough when rewards have been obtained. This behavior has been observed in reward-encoding neurons in the ventral striatum, which precess in phase relative to the hippocampal theta rhythm as the animal approaches a reward site (<xref ref-type="bibr" rid="bib73">van der Meer and Redish, 2011</xref>). Hence, during theta states a primary function of interneurons in CA1 and other hippocampal structures may be to support compression of ongoing events into neuronal sequences in order to store associations in synaptic projections to downstream brain areas, which may then be utilized during sharp wave ripple events for mental exploration, planning and decision making.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Reduced model of interneuron phase dynamics</title><p>To understand how phase precession emerges in the circuit of <xref ref-type="fig" rid="fig1">Figure 1</xref>, we developed a reduced model of an isolated interneuron driven by a constant excitatory current and a pacemaker current (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). In this simplified description, we treat the interneuron as an oscillator whose baseline frequency <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>ω</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM12">I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is determined by the amplitude of the depolarizing current I through its f-I curve (note that we do not make any explicit assumptions about the form of this f-I curve in the reduced model, although in <xref ref-type="fig" rid="fig2">Figure 2</xref> we assumed a linear f-I curve). We consider the pacemaker input as a weak perturbation to this oscillator, which allows a reduced description of the interneuron in which only its phase is considered (e.g., <xref ref-type="bibr" rid="bib18">Ermentrout, 1986</xref>). We show below that under some general assumptions the following equation is obtained (<xref ref-type="bibr" rid="bib1">Adler, 1946</xref>):<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM13">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM15">sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM16"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM14">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where: <inline-formula><mml:math id="inf12"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>-</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is the instantaneous phase difference between the interneuron and the pacemaker input; the detuning <inline-formula><mml:math id="inf13"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM17">I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>ω</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM18">I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the frequency difference between the pacemaker input and the intrinsic frequency of the interneuron in the absence of pacemaker input; <inline-formula><mml:math id="inf14"><mml:mi>A</mml:mi></mml:math></inline-formula> is the synchronization factor, which depends on the amplitude of pacemaker input and on the intrinsic properties of the interneuron (we describe this dependence in the derivation below). This equation approximates the phase relationship of the interneuron to the pacemaker input for different strengths of pacemaker drive and excitatory drive.</p><p>For a constant input current, <xref ref-type="disp-formula" rid="equ2">Equation (2)</xref> generates two distinct dynamical states depending on the relative values of <inline-formula><mml:math id="inf15"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf16"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow></mml:math></inline-formula> (i.e., depending on the amplitude of pacemaker input and excitatory input to the interneuron). The first is stable phase locking and the second is phase precession. Phase locking occurs when <inline-formula><mml:math id="inf17"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow id="XM19"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, with a stable locking phase of <inline-formula><mml:math id="inf18"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>lock</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi id="XM20">arcsin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac id="XM21"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Phase precession occurs when <inline-formula><mml:math id="inf19"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow id="XM22"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, where there are no stable phases and the interneuron precesses continuously, but nonlinearly, in phase against the pacemaker input (<xref ref-type="fig" rid="fig2">Figure 2C</xref>).</p><p>To derive <xref ref-type="disp-formula" rid="equ2">Equation (2)</xref> and the dynamics described above, we assume that the pacemaker input is weak so that we may introduce an approximation based on its infinitesimal phase response curve <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM23">ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Specifically, the dynamics of an oscillator with frequency <inline-formula><mml:math id="inf21"><mml:mi>ω</mml:mi></mml:math></inline-formula> driven weakly by an external perturbation <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM24">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be approximated by the reduced phase model:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mi>ω</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM25">ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM26">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where amplitude variations have been neglected. To model the case of an oscillator driven by a weak pacemaker (i.e., an interneuron driven by the septal theta rhythm) we consider a perturbation of the form <inline-formula><mml:math id="inf23"><mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM27">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM29">cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM30"><mml:mi>θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM28">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. <xref ref-type="disp-formula" rid="equ3">Equation (3)</xref> can then be expressed as:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM31"><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM33">cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM34"><mml:mi>θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM32">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf24"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>-</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf25"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>ω</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. If <inline-formula><mml:math id="inf26"><mml:mi>z</mml:mi></mml:math></inline-formula> is also sinusoidal, the above equation can be further approximated by averaging out fast fluctuations to obtain <xref ref-type="disp-formula" rid="equ2">Equation (2)</xref>. To see this, we define the theta-average of a variable <inline-formula><mml:math id="inf27"><mml:mi>X</mml:mi></mml:math></inline-formula> as:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>X</mml:mi><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msubsup><mml:mi>X</mml:mi><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Averaging out fluctuations on a sub-theta cycle timescale then gives:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ω</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>which for sinusoidal phase response curves of the form <inline-formula><mml:math id="inf28"><mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM43">ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM44">sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM45">ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is:<disp-formula id="equ7"><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd id="mjx-eqn-7_5"><mml:mtext>(7)</mml:mtext></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ω</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-8_5"><mml:mtext>(8)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ω</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-9_5"><mml:mtext>(9)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ω</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-10_5"><mml:mtext>(10)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>≈</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ω</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where in the last line it was assumed that <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow></mml:math></inline-formula> does not change over a single theta cycle. This recovers <xref ref-type="disp-formula" rid="equ2">Equation (2)</xref> and provides an explicit formula for the synchronization factor in terms of the phase response curve and pacemaker drive <inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. In other words, the synchronization factor depends on the amplitude of pacemaker drive and the sinusoidal component of the phase response curve of the interneuron.</p><p>The general solution to <xref ref-type="disp-formula" rid="equ2">Equation (2)</xref> is given by:<disp-formula id="equ8"><label>(11)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM109">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM110">arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mfrac id="XM111"><mml:mrow><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM104"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM107">tan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM108"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM105"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM106"><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf31"><mml:mi>c</mml:mi></mml:math></inline-formula> is a constant determined by the initial conditions. This equation is valid for both the phase locking and phase precession regimes. In the case of phase precession, where <inline-formula><mml:math id="inf32"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow id="XM112"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, this gives the following precession frequency:<disp-formula id="equ9"><label>(12)</label><mml:math id="m9"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM113"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>which is obtained by noting that <inline-formula><mml:math id="inf33"><mml:mi>tan</mml:mi></mml:math></inline-formula> is a <inline-formula><mml:math id="inf34"><mml:mi>π</mml:mi></mml:math></inline-formula>-periodic function, while <inline-formula><mml:math id="inf35"><mml:mi>arctan</mml:mi></mml:math></inline-formula> is a monotonic function. Assuming that the phase precession frequency scales with running speed <inline-formula><mml:math id="inf36"><mml:mi>v</mml:mi></mml:math></inline-formula> and field size as <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM114"><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf38"><mml:mi>R</mml:mi></mml:math></inline-formula> is the radius of the place field (<xref ref-type="bibr" rid="bib10">Chadwick et al., 2015</xref>), we obtain a constraint on the detuning and synchronization factor:<disp-formula id="equ10"><label>(13)</label><mml:math id="m10"><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM115"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM116"><mml:mrow><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>which shows how the phase precession frequency can be controlled across running speeds and dorsoventral locations by changing the strength of pacemaker input and excitatory drive to interneurons.</p><p>For the stable phase locking case, where <inline-formula><mml:math id="inf39"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow id="XM117"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the expression for the precession frequency yields complex values. To recover the steady state locking dynamics shown in <xref ref-type="fig" rid="fig2">Figure 2B</xref>, note that for complex arguments the <inline-formula><mml:math id="inf40"><mml:mi>tan</mml:mi></mml:math></inline-formula> function in <xref ref-type="disp-formula" rid="equ8">Equation (11)</xref> becomes a <inline-formula><mml:math id="inf41"><mml:mi>tanh</mml:mi></mml:math></inline-formula>, and in the limit <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula> this <inline-formula><mml:math id="inf43"><mml:mi>tanh</mml:mi></mml:math></inline-formula> term tends to <inline-formula><mml:math id="inf44"><mml:mn>1</mml:mn></mml:math></inline-formula> so that <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM118">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> becomes independent of <inline-formula><mml:math id="inf46"><mml:mi>t</mml:mi></mml:math></inline-formula> and the initial condition <inline-formula><mml:math id="inf47"><mml:mi>c</mml:mi></mml:math></inline-formula>. The rate at which the decay to steady state occurs will therefore vary with <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ω</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-2"><title>Numerical simulations</title><p>Simulations were performed using the Brian simulator (<xref ref-type="bibr" rid="bib27">Goodman and Brette, 2009</xref>).</p><sec id="s4-2-1"><title>Neuron model</title><p>We modeled the network using leaky integrate and fire neurons with conductance based synapses. For example, excitatory neurons were modeled by the following equation:<disp-formula id="equ11"><label>(14)</label><mml:math id="m11"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM121">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM125"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM124">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:munderover><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi id="XM122">I</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM123">j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM126">t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM128"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM127">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>Ext</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM129">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:msqrt><mml:msub><mml:mi>τ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:msqrt></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf49"><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> is the membrane potential, <inline-formula><mml:math id="inf50"><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is the resting potential, <inline-formula><mml:math id="inf51"><mml:msub><mml:mi>τ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> is the membrane time constant, <inline-formula><mml:math id="inf52"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi id="XM130">I</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM131">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the conductance of the synapse from presynaptic interneuron <inline-formula><mml:math id="inf53"><mml:mi>j</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf54"><mml:msub><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:math></inline-formula> is the inhibitory reversal potential, <inline-formula><mml:math id="inf55"><mml:msub><mml:mi>I</mml:mi><mml:mi>Ext</mml:mi></mml:msub></mml:math></inline-formula> is an external current input, <inline-formula><mml:math id="inf56"><mml:msub><mml:mi>σ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> is the noise amplitude and <inline-formula><mml:math id="inf57"><mml:mi>η</mml:mi></mml:math></inline-formula> is a random variable drawn from a standard normal distribution at each timestep. When the membrane potential <inline-formula><mml:math id="inf58"><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> reaches the threshold <inline-formula><mml:math id="inf59"><mml:msub><mml:mi>V</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula>, a spike occurs and the membrane potential is reset to <inline-formula><mml:math id="inf60"><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>The synaptic conductances were exponentially decaying and governed by:<disp-formula id="equ12"><label>(15)</label><mml:math id="m12"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi id="XM132">I</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM133">j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM134">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi id="XM135">I</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM136">j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM138"><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM137">j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf61"><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM139">j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is <inline-formula><mml:math id="inf62"><mml:mi>i</mml:mi></mml:math></inline-formula>th spike of cell <inline-formula><mml:math id="inf63"><mml:mi>j</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf64"><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> the synaptic weight. Inhibitory neurons were modeled in the same way, but receiving excitatory rather than inhibitory synaptic conductances.</p></sec><sec id="s4-2-2"><title>External inputs</title><p>For interneurons, the external current was of the form:<disp-formula id="equ13"><label>(16)</label><mml:math id="m13"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>Ext</mml:mi><mml:mi>I</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mn>0</mml:mn><mml:mi>I</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM140">cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM141"><mml:msub><mml:mi>ω</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf65"><mml:msub><mml:mi>I</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> is the amplitude of the pacemaker current. To simulate a trajectory through a place field, the external current injected into the place cell was of the form:<disp-formula id="equ14"><label>(17)</label><mml:math id="m14"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>Ext</mml:mi><mml:mi>E</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM144">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM145">exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM146"><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow id="XM143"><mml:mrow><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM142">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi mathvariant="bold">𝐜</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf66"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM147">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mn>𝟎</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the trajectory of the animal through the place field. For simulations through the edge of the place field (<xref ref-type="fig" rid="fig5">Figure 5A</xref>) the trajectory was a straight line offset from the place field center <inline-formula><mml:math id="inf67"><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi mathvariant="bold">𝐜</mml:mi></mml:msub></mml:math></inline-formula> by 14 cm, otherwise the trajectory passed through the center.</p></sec><sec id="s4-2-3"><title>Synaptic connectivity</title><p>To simulate large scale networks in <xref ref-type="fig" rid="fig7">Figure 7</xref>, synaptic weights from pyramidal cell <inline-formula><mml:math id="inf68"><mml:mi>i</mml:mi></mml:math></inline-formula> to interneuron <inline-formula><mml:math id="inf69"><mml:mi>j</mml:mi></mml:math></inline-formula> were defined as:<disp-formula id="equ15"><label>(18)</label><mml:math id="m15"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mi>E</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf70"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a connectivity matrix with binary entries <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn id="XM148">0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM149">1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf72"><mml:msup><mml:mi>w</mml:mi><mml:mi>E</mml:mi></mml:msup></mml:math></inline-formula> is the strength of excitatory synapses in the network. The connectivity matrix satisfies the following conditions: <inline-formula><mml:math id="inf73"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf74"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf75"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf76"><mml:mi>j</mml:mi></mml:math></inline-formula>. This ensures that each pyramidal cell connects to exactly one interneuron and that each interneuron receives connections from the same number of pyramidal cells. Similarly, synaptic weights from interneuron <inline-formula><mml:math id="inf77"><mml:mi>j</mml:mi></mml:math></inline-formula> to pyramidal cell <inline-formula><mml:math id="inf78"><mml:mi>i</mml:mi></mml:math></inline-formula> were defined as:<disp-formula id="equ16"><label>(19)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where the inhibitory connectivity matrix is simply the transpose of the excitatory connectivity matrix. This ensures that interneurons project to the same pyramidal cells from which they receive connections. There were no synaptic connections between neurons of the same type.</p></sec><sec id="s4-2-4"><title>Model parameters</title><p>The following parameters were fixed, independent of running speed:</p><p><inline-formula><mml:math id="inf79"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>m</mml:mi><mml:mi>I</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula> ms, <inline-formula><mml:math id="inf80"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>m</mml:mi><mml:mi>E</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> ms, <inline-formula><mml:math id="inf81"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV, <inline-formula><mml:math id="inf82"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>70</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV, <inline-formula><mml:math id="inf83"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>65</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV, <inline-formula><mml:math id="inf84"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mi>m</mml:mi><mml:mi>I</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula> pF, <inline-formula><mml:math id="inf85"><mml:msubsup><mml:mi>C</mml:mi><mml:mi>m</mml:mi><mml:mi>E</mml:mi></mml:msubsup></mml:math></inline-formula> = 155 pF, <inline-formula><mml:math id="inf86"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> ms, <inline-formula><mml:math id="inf87"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> ms, <inline-formula><mml:math id="inf88"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>70</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV, <inline-formula><mml:math id="inf89"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> mV, <inline-formula><mml:math id="inf90"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula> Hz, <inline-formula><mml:math id="inf91"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mi>E</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> nS, <inline-formula><mml:math id="inf92"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mi>I</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math></inline-formula> nS, <inline-formula><mml:math id="inf93"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula> cm and a simulation time step of <inline-formula><mml:math id="inf94"><mml:mn>0.1</mml:mn></mml:math></inline-formula> ms.</p></sec><sec id="s4-2-5"><title>Running speed dependence</title><p>We varied several parameters to model the changes with running speed. First, the injected current into the place cell depends on running speed according to <xref ref-type="disp-formula" rid="equ14">Equation (17)</xref>, where the width of the Gaussian in time varies with running speed. In addition to the temporal duration of current injection (as determined by the trajectory <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM151">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), the amplitude of current input <inline-formula><mml:math id="inf96"><mml:msup><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:msup></mml:math></inline-formula> was varied with running speed. In addition, the noise to the place cell was varied with running speed. The amplitude and noise term were varied so that the width of the place field (measured as the distance from first to last spike on a single lap) and the number of spikes fired during a pass through a place field were constant across running speeds. Increasing noise tends to spread out the place field, whereas increasing the input current amplitude tends to increase both the number of spikes fired and the width.</p><p>The inputs to the interneuron were also running speed dependent. Specifically, the pacemaker amplitude <inline-formula><mml:math id="inf97"><mml:msub><mml:mi>I</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> and the baseline current <inline-formula><mml:math id="inf98"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>0</mml:mn><mml:mi>I</mml:mi></mml:msubsup></mml:math></inline-formula> were varied with running speed. By lowering the pacemaker amplitude, the range of input currents over which phase locking occurs is reduced, but the nonlinear transition from phase locking to phase precession is less severe. This effectively allows a wider range of currents over which slow phase precession can be achieved and increases the stability of phase precession within this range. For these reasons, we reduced the pacemaker amplitude at lower running speeds and also reduced the baseline current so as to allow a slow precession frequency.</p><p>The depolarizing current input (in pA) to the interneuron as a function of velocity (in cm/s) was set as:<disp-formula id="equ17"><label>(20)</label><mml:math id="m17"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mn>0</mml:mn><mml:mi>I</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mn>79.5</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mn>0.027</mml:mn><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The septal pacemaker input was:<disp-formula id="equ18"><label>(21)</label><mml:math id="m18"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.065</mml:mn><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The amplitude of current injection into the place cell was:<disp-formula id="equ19"><label>(22)</label><mml:math id="m19"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mn>110</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The noise to the place cell (in mV) was varied with running speed as:<disp-formula id="equ20"><label>(23)</label><mml:math id="m20"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mn>1.75</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>0.025</mml:mn><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p></sec></sec><sec id="s4-3"><title>Simulation of transient intrahippocampal perturbation</title><p>To model to experimental protocol of <xref ref-type="bibr" rid="bib79">Zugaro et al. (2005)</xref>, we repeated the simulation with parameters as described above (with running speed <inline-formula><mml:math id="inf99"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula> cm/s) and in addition injected a negative current of amplitude 50 pA into the pyramidal cell and 20 pA to the interneuron for a duration of 200 ms, centered on the peak of the place field input, while simultaneously resetting the phase of the pacemaker drive. These parameters were sufficient to generate silencing for around 200–250 ms in both cells.</p></sec><sec id="s4-4"><title>Simulation of interneuron silencing experiment</title><p>To model the experimental protocol of <xref ref-type="bibr" rid="bib67">Royer et al. (2012)</xref>, we again repeated the simulation with parameters as described above (<inline-formula><mml:math id="inf100"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula> cm/s), but in this case delivered a negative current of amplitude 10 pA to the interneuron for a duration of 1 s. This was sufficient to silence the interneuron for the duration of the current injection. In the first simulation, silencing was centered on the peak of the place field input. 1050 laps were simulated, and the data were then pooled and averaged to generate <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2A,B</xref> (see <xref ref-type="bibr" rid="bib67">Royer et al. (2012)</xref> for details of data analysis). In the second simulation , silencing was centered on a random location within 20 cm of the peak of the place field input. We performed this additional simulation to account for the fact that the silencing was centered on a fixed portion of the track in the protocol of Royer and colleagues, so that the place cells analyzed typically were only silenced over part of their place field. We again simulated 1050 laps, with silencing centered on a different location in each lap, and then pooled and averaged the resulting data (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2C,D</xref>).</p></sec><sec id="s4-5"><title>Dorsoventral changes</title><p>To model changes in theta dynamics along the dorsoventral axis, we simultaneously varied the place field width <inline-formula><mml:math id="inf101"><mml:mi>σ</mml:mi></mml:math></inline-formula>, noise <inline-formula><mml:math id="inf102"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msubsup></mml:math></inline-formula>, excitatory synaptic weight <inline-formula><mml:math id="inf103"><mml:msup><mml:mi>w</mml:mi><mml:mi>E</mml:mi></mml:msup></mml:math></inline-formula>, depolarizing current to interneurons <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> and the pacemaker drive <inline-formula><mml:math id="inf105"><mml:msub><mml:mi>I</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula>. For <xref ref-type="fig" rid="fig4">Figure 4A,B</xref>, only <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> was varied and all other parameters were as above. For <xref ref-type="fig" rid="fig4">Figure 4C,D</xref>, we chose two parameter sets representing the dorsal and ventral poles. For the dorsal pole, the parameters were: <inline-formula><mml:math id="inf107"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>45</mml:mn></mml:mrow></mml:math></inline-formula> cm; <inline-formula><mml:math id="inf108"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.7</mml:mn></mml:mrow></mml:math></inline-formula> mV; <inline-formula><mml:math id="inf109"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mn>0</mml:mn><mml:mi>I</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>80.455</mml:mn></mml:mrow></mml:math></inline-formula> pA; <inline-formula><mml:math id="inf110"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1.95</mml:mn></mml:mrow></mml:math></inline-formula> pA; <inline-formula><mml:math id="inf111"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mi>E</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0.53</mml:mn></mml:mrow></mml:math></inline-formula> nS. For the ventral pole, the parameters were: <inline-formula><mml:math id="inf112"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>600</mml:mn></mml:mrow></mml:math></inline-formula> cm; <inline-formula><mml:math id="inf113"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> mV; <inline-formula><mml:math id="inf114"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mn>0</mml:mn><mml:mi>I</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>79.525</mml:mn></mml:mrow></mml:math></inline-formula> pA; <inline-formula><mml:math id="inf115"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.12</mml:mn></mml:mrow></mml:math></inline-formula> pA; <inline-formula><mml:math id="inf116"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mi>E</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0.081</mml:mn></mml:mrow></mml:math></inline-formula> nS. In both cases, the running speed was set to <inline-formula><mml:math id="inf117"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula> cm/s.</p></sec><sec id="s4-6"><title>Calculation of precession frequency</title><p>To estimate the theta frequency of the simulated neurons, the membrane potential was bandpass filtered at <inline-formula><mml:math id="inf118"><mml:mrow><mml:mn>6.25</mml:mn><mml:mo>-</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> Hz and the instantaneous phase was calculated via a Hilbert transform. The phase was unwrapped and then smoothed using a moving average of width <inline-formula><mml:math id="inf119"><mml:mn>250</mml:mn></mml:math></inline-formula> ms. The gradient was calculated at each time point to obtain the instantaneous frequency.</p><p>To determine the precession frequency at different running speeds, we calculated the average membrane frequency within a radius of <inline-formula><mml:math id="inf120"><mml:mn>15</mml:mn></mml:math></inline-formula> cm around the place field center on each pass through the place field. To remove artefactual frequency estimates arising due to the bursting dynamics within theta cycles, we excluded individual runs based on the variability of the instantaneous place cell frequency within this <inline-formula><mml:math id="inf121"><mml:mn>15</mml:mn></mml:math></inline-formula> cm radius. Specifically, we excluded runs on which the standard deviation was greater than <inline-formula><mml:math id="inf122"><mml:mn>1.75</mml:mn></mml:math></inline-formula> times the mean standard deviation over all runs at that speed. This excludes cases in which the estimated frequency fluctuated rapidly on a short timescale.</p></sec><sec id="s4-7"><title>Analysis of phase precession statistics</title><p>To estimate the strength of phase precession in each pyramidal cell (the <italic>single-cell phase precession metric</italic>), we calculated the Pearson correlation between the vector of spike phases <inline-formula><mml:math id="inf123"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> and the vector of the animal’s location <inline-formula><mml:math id="inf124"><mml:mi>X</mml:mi></mml:math></inline-formula> at the time of each spike on a single lap. The phase offset was chosen in order to minimize this correlation, i.e. to obtain the most negative possible (strongest) correlation between spike phase and the animal’s location (<xref ref-type="bibr" rid="bib20">Foster and Wilson, 2007</xref>; <xref ref-type="bibr" rid="bib19">Feng et al., 2015</xref>). Specifically, given the vectors <inline-formula><mml:math id="inf125"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf126"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula>, we calculated the correlation <inline-formula><mml:math id="inf127"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. This metric was also used to measure single-cell phase precession pooled over multiple laps (<xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4</xref>).</p><p>To obtain the measure of population phase precession (the <italic>population phase precession metric</italic>), we pooled the spikes of all pyramidal cells on a single lap. We again calculated the correlation between the vector of pooled spike phases <inline-formula><mml:math id="inf129"><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>pop</mml:mi></mml:msub></mml:math></inline-formula> and the vector whose entries are given by the distance of the animal from the place field center of the corresponding cell in the pooled spike phase vector at the time of that spike <inline-formula><mml:math id="inf130"><mml:msub><mml:mi>X</mml:mi><mml:mi>pop</mml:mi></mml:msub></mml:math></inline-formula>. As for the single cell case, the phase offset was chosen in order to minimize this correlation by calculating <inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>arg</mml:mi><mml:mspace width="negativethinmathspace"/><mml:mo form="prefix" movablelimits="true">min</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>To measure the strength of sequential activity in the population (the single-cycle theta sequence metric), we analyzed the data on a cycle-by-cycle basis. For each cycle, we calculated the Pearson correlation between the vector of spike times in the population and the vector whose entries are given by the place field center corresponding to each spike in this first vector. Theta windows for this method had a temporal width equal to the period of the pacemaker input to the network. The offset of theta windows was given by the phase offset <inline-formula><mml:math id="inf133"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> which maximized the population phase precession measure for that lap. This allows for the possibility of an offset between the simulated CA1 network theta activity and the septal input oscillation.</p></sec><sec id="s4-8"><title>Place field mapping</title><p>For network simulations, the number of simulated pyramidal cells was held constant (<inline-formula><mml:math id="inf134"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula>) and the number of interneurons was varied. This choice was made to avoid changes in correlation values introduced by changes in sample size. The number of interneurons was always chosen to be a divisor of the number of pyramidal cells so that there was an equal number of place cells for each interneuron. Each simulated place cell was given exactly one place field. For random place field mapping, place field locations were generated by a uniform distribution over a linear track. For optimal place field mapping, place field locations were defined so that the place cells associated with a single interneuron were equally spaced along the track and so that the entire population of place cells uniformly covered the track.</p></sec><sec id="s4-9"><title>Reduced model of remapping with non-overlap constraint</title><p>Here we quantify the capacity of the network under the assumption that pyramidal cells which couple to the same interneuron cannot have overlapping place fields. We use three distinct measures of the network capacity: the number of spatial maps at a given spatial acuity; the number of cell assemblies; the number of phase sequences. These derivations were used to provide the capacity estimates stated in the main text.</p><sec id="s4-9-1"><title>Number of distinct spatial maps</title><p>To determine the number of spatial maps available to the network, we considered a simplified model in which each place cell can map to a set of discrete locations on a linear track of length <inline-formula><mml:math id="inf135"><mml:mi>L</mml:mi></mml:math></inline-formula>. Specifically, the track is divided into equal bins of size <inline-formula><mml:math id="inf136"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>res</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>bins</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf137"><mml:msub><mml:mi>N</mml:mi><mml:mi>bins</mml:mi></mml:msub></mml:math></inline-formula> is the number of bins and <inline-formula><mml:math id="inf138"><mml:msub><mml:mi>x</mml:mi><mml:mi>res</mml:mi></mml:msub></mml:math></inline-formula> determines the spatial resolution of the place map. To avoid finite size effects, we assume periodic boundary conditions (i.e., a circular track). The number of place fields to be mapped onto the track depends on both the number of place cells <inline-formula><mml:math id="inf139"><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> and the average number of place fields per place cell <inline-formula><mml:math id="inf140"><mml:mi>F</mml:mi></mml:math></inline-formula> (which can be greater or less than one). Given a number of interneurons <inline-formula><mml:math id="inf141"><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:math></inline-formula>, the population of <inline-formula><mml:math id="inf142"><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> place cells is divided into <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:math></inline-formula> equal subsets, so that each interneuron is associated with the same number of place cells. We assume that there is an exclusion zone of size <inline-formula><mml:math id="inf144"><mml:mi>D</mml:mi></mml:math></inline-formula> which sets the minimum distance for which place cells associated with the same interneuron can be mapped, so that <inline-formula><mml:math id="inf145"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>res</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the minimum separation in terms of the number of bins. In general, multiple cells may map to the same bin, or no cells may map onto a given bin, provided that the non-overlap constraint is obeyed.</p><p>We can then consider the number of ways in which <inline-formula><mml:math id="inf146"><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> place fields can be mapped onto the track without violating this constraint. We can calculate this number by counting the number of possible choices for each for each place field <inline-formula><mml:math id="inf147"><mml:mi>i</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf148"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. For the first place field <inline-formula><mml:math id="inf149"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, there are <inline-formula><mml:math id="inf150"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>bins</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> possible choices, since we can choose from <inline-formula><mml:math id="inf151"><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> place cells and <inline-formula><mml:math id="inf152"><mml:msub><mml:mi>N</mml:mi><mml:mi>bins</mml:mi></mml:msub></mml:math></inline-formula> spatial locations. For the next choice <inline-formula><mml:math id="inf153"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, there are <inline-formula><mml:math id="inf154"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>bins</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> choices, due to the exclusion zone about the first cell, which excludes <inline-formula><mml:math id="inf155"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> cells from being mapped onto <inline-formula><mml:math id="inf156"><mml:msub><mml:mi>N</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math></inline-formula> of the possible bins. In general, there are <inline-formula><mml:math id="inf157"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>bins</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM164"><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for the <inline-formula><mml:math id="inf158"><mml:mi>i</mml:mi></mml:math></inline-formula>th choice. Hence, the total number of combinations is:<disp-formula id="equ21"><label>(24)</label><mml:math id="m21"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM166"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>bins</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM165"><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>which can be simplified by noting that <inline-formula><mml:math id="inf159"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>bins</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> so that:<disp-formula id="equ22"><label>(25)</label><mml:math id="m22"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM167"><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>bins</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM169"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM168"><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The above analysis gives the number of ordered choices of place cells and spatial bins, but overcounts the number of distinct maps by allowing the same map to be obtained through multiple choice sequences. This can be corrected by a factor of <inline-formula><mml:math id="inf160"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM170"><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:math></inline-formula> to obtain the number of distinct maps:<disp-formula id="equ23"><label>(26)</label><mml:math id="m23"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>maps</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM171"><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>bins</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM172"><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM174"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM173"><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Taking the logarithm and applying Stirling’s approximation gives:<disp-formula id="equ24"><label>(27)</label><mml:math id="m24"><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>maps</mml:mi></mml:msub></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM175"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>res</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mi id="XM177">log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM178"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM176"><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>This equation was used to determine the number of spatial maps under which coherent theta sequences can be generated, as stated in the main text.</p></sec><sec id="s4-9-2"><title>Number of cell assemblies</title><p>In addition to analyzing the number of spatial maps available to the network, we also considered the number of distinct cell assemblies which can be generated by the network without causing disruption. We define a cell assembly to be a set of coactive cells. We now calculate the number of cell assemblies which contain <inline-formula><mml:math id="inf161"><mml:mi>n</mml:mi></mml:math></inline-formula> place cells under the non-overlap constraint. To construct a cell assembly satisfying the constraint, it is sufficient to simply select <inline-formula><mml:math id="inf162"><mml:mi>n</mml:mi></mml:math></inline-formula> distinct interneurons and then select a place cell associated with each interneuron. The number of possible cell assemblies <inline-formula><mml:math id="inf163"><mml:msub><mml:mi>N</mml:mi><mml:mi>CA</mml:mi></mml:msub></mml:math></inline-formula> is therefore:<disp-formula id="equ25"><label>(28)</label><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>As before, we can simplify this using Stirling’s approximation:<disp-formula id="equ26"><label>(29)</label><mml:math id="m26"><mml:mrow><mml:mrow><mml:mi id="XM183">log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub id="XM184"><mml:mi>N</mml:mi><mml:mi>CA</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM185"><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM186">log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM187"><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM188"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>We used this equation to estimate the number of cell assemblies that can be expressed in the network under the parameter assumptions stated in the main text.</p></sec><sec id="s4-9-3"><title>Number of phase sequences</title><p>Finally, we considered how many phase sequences the network can generate without introducing disruption. A phase sequence is defined as an ordered set of cell assemblies (<xref ref-type="bibr" rid="bib32">Hebb, 1949</xref>). We assume that a phase sequence is a discrete sequence of <inline-formula><mml:math id="inf164"><mml:mi>m</mml:mi></mml:math></inline-formula> cell assemblies, and that no two cells in a phase sequence can couple to the same interneuron. A phase sequence can then be constructed by repeatedly constructing cell assemblies as above, where the available interneurons for each subsequent cell assembly are given by those not already selected in previous assemblies within the sequence. The number of phase sequences <inline-formula><mml:math id="inf165"><mml:msub><mml:mi>N</mml:mi><mml:mi>PS</mml:mi></mml:msub></mml:math></inline-formula> is then:<disp-formula id="equ27"><label>(30)</label><mml:math id="m27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>which can be approximated as:<disp-formula id="equ28"><label>(31)</label><mml:math id="m28"><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>PS</mml:mi></mml:msub></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo>[</mml:mo><mml:mrow id="XM205"><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM197"><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM196"><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM199">log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM200"><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM198"><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM201"><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM202">log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM203"><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM204"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Again, this equation was used to estimate the capacity of the network to generate distinct sequences as stated in the main text.</p></sec></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We would like to thank Mark Brandon for helpful comments on the manuscript. This work was supported by EPSRC, BBSCR and MRC.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf2"><p>MCWvR: Reviewing editor, <italic>eLife</italic></p></fn><fn fn-type="conflict" id="conf1"><p>The other authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>AC, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>MCWvR, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>MFN, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adler</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1946">1946</year><article-title>A study of locking phenomena in oscillators</article-title><source>Proceedings of the IEEE</source><volume>61</volume><fpage>1380</fpage><lpage>1385</lpage><pub-id pub-id-type="doi">10.1109/PROC.1973.9292</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aika</surname><given-names>Y</given-names></name><name><surname>Ren</surname><given-names>JQ</given-names></name><name><surname>Kosaka</surname><given-names>K</given-names></name><name><surname>Kosaka</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Quantitative analysis of GABA-like-immunoreactive and parvalbumin-containing neurons in the CA1 region of the rat hippocampus using a stereological method, the disector</article-title><source>Experimental Brain Research</source><volume>99</volume><fpage>267</fpage><lpage>276</lpage><pub-id pub-id-type="doi">10.1007/BF00239593</pub-id><pub-id pub-id-type="pmid">7925807</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname><given-names>K</given-names></name><name><surname>Rawlins</surname><given-names>JN</given-names></name><name><surname>Bannerman</surname><given-names>DM</given-names></name><name><surname>Csicsvari</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Hippocampal place cells can encode multiple trial-dependent features through rate remapping</article-title><source>Journal of Neuroscience</source><volume>32</volume><fpage>14752</fpage><lpage>14766</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.6175-11.2012</pub-id><pub-id pub-id-type="pmid">23077060</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>P</given-names></name><name><surname>Morris</surname><given-names>R</given-names></name><name><surname>Amaral</surname><given-names>D</given-names></name><name><surname>Bliss</surname><given-names>T</given-names></name><name><surname>O’Keefe</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><source>The Hippocampus Book</source></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bezaire</surname><given-names>MJ</given-names></name><name><surname>Soltesz</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Quantitative assessment of CA1 local circuits: knowledge base for interneuron-pyramidal cell connectivity</article-title><source>Hippocampus</source><volume>23</volume><fpage>751</fpage><lpage>785</lpage><pub-id pub-id-type="doi">10.1002/hipo.22141</pub-id><pub-id pub-id-type="pmid">23674373</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bi</surname><given-names>GQ</given-names></name><name><surname>Poo</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Synaptic modifications in cultured hippocampal neurons: dependence on spike timing, synaptic strength, and postsynaptic cell type</article-title><source>Journal of Neuroscience</source><volume>18</volume><fpage>10464</fpage><lpage>10472</lpage><pub-id pub-id-type="pmid">9852584</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgess</surname><given-names>N</given-names></name><name><surname>Barry</surname><given-names>C</given-names></name><name><surname>O'Keefe</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>An oscillatory interference model of grid cell firing</article-title><source>Hippocampus</source><volume>17</volume><fpage>801</fpage><lpage>812</lpage><pub-id pub-id-type="doi">10.1002/hipo.20327</pub-id><pub-id pub-id-type="pmid">17598147</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname><given-names>G</given-names></name><name><surname>Moser</surname><given-names>EI</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Memory, navigation and theta rhythm in the hippocampal-entorhinal system</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>130</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1038/nn.3304</pub-id><pub-id pub-id-type="pmid">23354386</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cei</surname><given-names>A</given-names></name><name><surname>Girardeau</surname><given-names>G</given-names></name><name><surname>Drieu</surname><given-names>C</given-names></name><name><surname>Kanbi</surname><given-names>KE</given-names></name><name><surname>Zugaro</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Reversed theta sequences of hippocampal cell assemblies during backward travel</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>719</fpage><lpage>724</lpage><pub-id pub-id-type="doi">10.1038/nn.3698</pub-id><pub-id pub-id-type="pmid">24667574</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chadwick</surname><given-names>A</given-names></name><name><surname>van Rossum</surname><given-names>MCW</given-names></name><name><surname>Nolan</surname><given-names>MF</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Independent theta phase coding accounts for CA1 population sequences and enables flexible remapping</article-title><source>eLife</source><volume>4</volume><elocation-id>e03542</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.03542</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chance</surname><given-names>FS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Hippocampal phase precession from dual input components</article-title><source>Journal of Neuroscience</source><volume>32</volume><fpage>16693</fpage><lpage>16703</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2786-12.2012</pub-id><pub-id pub-id-type="pmid">23175823</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Climer</surname><given-names>JR</given-names></name><name><surname>Newman</surname><given-names>EL</given-names></name><name><surname>Hasselmo</surname><given-names>ME</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Phase coding by grid cells in unconstrained environments: two-dimensional phase precession</article-title><source>European Journal of Neuroscience</source><volume>38</volume><fpage>2526</fpage><lpage>2541</lpage><pub-id pub-id-type="doi">10.1111/ejn.12256</pub-id><pub-id pub-id-type="pmid">23718553</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dombeck</surname><given-names>DA</given-names></name><name><surname>Harvey</surname><given-names>CD</given-names></name><name><surname>Tian</surname><given-names>L</given-names></name><name><surname>Looger</surname><given-names>LL</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Functional imaging of hippocampal place cells at cellular resolution during virtual navigation</article-title><source>Nature Neuroscience</source><volume>13</volume><fpage>1433</fpage><lpage>1440</lpage><pub-id pub-id-type="doi">10.1038/nn.2648</pub-id><pub-id pub-id-type="pmid">20890294</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragoi</surname><given-names>G</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Temporal encoding of place sequences by hippocampal cell assemblies</article-title><source>Neuron</source><volume>50</volume><fpage>145</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2006.02.023</pub-id><pub-id pub-id-type="pmid">16600862</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragoi</surname><given-names>G</given-names></name><name><surname>Tonegawa</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Development of schemas revealed by prior experience and NMDA receptor knock-out</article-title><source>eLife</source><volume>2</volume><elocation-id>e01326</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.01326</pub-id><pub-id pub-id-type="pmid">24327561</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ego-Stengel</surname><given-names>V</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Spatial selectivity and theta phase precession in CA1 interneurons</article-title><source>Hippocampus</source><volume>17</volume><fpage>161</fpage><lpage>174</lpage><pub-id pub-id-type="doi">10.1002/hipo.20253</pub-id><pub-id pub-id-type="pmid">17183531</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Epsztein</surname><given-names>J</given-names></name><name><surname>Brecht</surname><given-names>M</given-names></name><name><surname>Lee</surname><given-names>AK</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Intracellular determinants of hippocampal CA1 place and silent cell activity in a novel environment</article-title><source>Neuron</source><volume>70</volume><fpage>109</fpage><lpage>120</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.03.006</pub-id><pub-id pub-id-type="pmid">21482360</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ermentrout</surname><given-names>GB</given-names></name></person-group><year iso-8601-date="1986">1986</year><chapter-title>Losing amplitude and saving phase</chapter-title><source>Lecture Notes in Biomath</source><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name><volume>66</volume><fpage>98</fpage><lpage>114</lpage></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>T</given-names></name><name><surname>Silva</surname><given-names>D</given-names></name><name><surname>Foster</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dissociation between the experience-dependent development of hippocampal theta sequences and single-trial phase precession</article-title><source>Journal of Neuroscience</source><volume>35</volume><fpage>4890</fpage><lpage>4902</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2614-14.2015</pub-id><pub-id pub-id-type="pmid">25810520</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>DJ</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Hippocampal theta sequences</article-title><source>Hippocampus</source><volume>17</volume><fpage>1093</fpage><lpage>1099</lpage><pub-id pub-id-type="doi">10.1002/hipo.20345</pub-id><pub-id pub-id-type="pmid">17663452</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>LM</given-names></name><name><surname>Stanley</surname><given-names>GB</given-names></name><name><surname>Brown</surname><given-names>EN</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Hippocampal plasticity across multiple days of exposure to novel environments</article-title><source>Journal of Neuroscience</source><volume>24</volume><fpage>7681</fpage><lpage>7689</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1958-04.2004</pub-id><pub-id pub-id-type="pmid">15342735</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freund</surname><given-names>TF</given-names></name><name><surname>Antal</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>GABA-containing neurons in the septum control inhibitory interneurons in the hippocampus</article-title><source>Nature</source><volume>336</volume><fpage>170</fpage><lpage>173</lpage><pub-id pub-id-type="doi">10.1038/336170a0</pub-id><pub-id pub-id-type="pmid">3185735</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuhrmann</surname><given-names>F</given-names></name><name><surname>Justus</surname><given-names>D</given-names></name><name><surname>Sosulina</surname><given-names>L</given-names></name><name><surname>Kaneko</surname><given-names>H</given-names></name><name><surname>Beutel</surname><given-names>T</given-names></name><name><surname>Friedrichs</surname><given-names>D</given-names></name><name><surname>Schoch</surname><given-names>S</given-names></name><name><surname>Schwarz</surname><given-names>MK</given-names></name><name><surname>Fuhrmann</surname><given-names>M</given-names></name><name><surname>Remy</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Locomotion, theta oscillations, and the speed-correlated firing of hippocampal neurons are controlled by a medial septal glutamatergic circuit</article-title><source>Neuron</source><volume>86</volume><fpage>1253</fpage><lpage>1264</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.05.001</pub-id><pub-id pub-id-type="pmid">25982367</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geisler</surname><given-names>C</given-names></name><name><surname>Diba</surname><given-names>K</given-names></name><name><surname>Pastalkova</surname><given-names>E</given-names></name><name><surname>Mizuseki</surname><given-names>K</given-names></name><name><surname>Royer</surname><given-names>S</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Temporal delays among place cells determine the frequency of population theta oscillations in the hippocampus</article-title><source>PNAS</source><volume>107</volume><fpage>7957</fpage><lpage>7962</lpage><pub-id pub-id-type="doi">10.1073/pnas.0912478107</pub-id><pub-id pub-id-type="pmid">20375279</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geisler</surname><given-names>C</given-names></name><name><surname>Robbe</surname><given-names>D</given-names></name><name><surname>Zugaro</surname><given-names>M</given-names></name><name><surname>Sirota</surname><given-names>A</given-names></name><name><surname>Buzsaki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Hippocampal place cell assemblies are speed-controlled oscillators</article-title><source>PNAS</source><volume>104</volume><fpage>8149</fpage><lpage>8154</lpage><pub-id pub-id-type="doi">10.1073/pnas.0610121104</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gomperts</surname><given-names>SN</given-names></name><name><surname>Kloosterman</surname><given-names>F</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>VTA neurons coordinate with the hippocampal reactivation of spatial experience</article-title><source>eLife</source><volume>4</volume><elocation-id>e05360</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.05360</pub-id><pub-id pub-id-type="pmid">26465113</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodman</surname><given-names>DF</given-names></name><name><surname>Brette</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The brian simulator</article-title><source>Frontiers in Neuroscience</source><volume>3</volume><fpage>192</fpage><lpage>197</lpage><pub-id pub-id-type="doi">10.3389/neuro.01.026.2009</pub-id><pub-id pub-id-type="pmid">20011141</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>KD</given-names></name><name><surname>Csicsvari</surname><given-names>J</given-names></name><name><surname>Hirase</surname><given-names>H</given-names></name><name><surname>Dragoi</surname><given-names>G</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Organization of cell assemblies in the hippocampus</article-title><source>Nature</source><volume>424</volume><fpage>552</fpage><lpage>556</lpage><pub-id pub-id-type="doi">10.1038/nature01834</pub-id><pub-id pub-id-type="pmid">12891358</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>KD</given-names></name><name><surname>Henze</surname><given-names>DA</given-names></name><name><surname>Hirase</surname><given-names>H</given-names></name><name><surname>Leinekugel</surname><given-names>X</given-names></name><name><surname>Dragoi</surname><given-names>G</given-names></name><name><surname>Czurkó</surname><given-names>A</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Spike train dynamics predicts theta-related phase precession in hippocampal pyramidal cells</article-title><source>Nature</source><volume>417</volume><fpage>738</fpage><lpage>741</lpage><pub-id pub-id-type="doi">10.1038/nature00808</pub-id><pub-id pub-id-type="pmid">12066184</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Neural signatures of cell assembly organization</article-title><source>Nature Reviews Neuroscience</source><volume>6</volume><fpage>399</fpage><lpage>407</lpage><pub-id pub-id-type="doi">10.1038/nrn1669</pub-id><pub-id pub-id-type="pmid">15861182</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harvey</surname><given-names>CD</given-names></name><name><surname>Collman</surname><given-names>F</given-names></name><name><surname>Dombeck</surname><given-names>DA</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Intracellular dynamics of hippocampal place cells during virtual navigation</article-title><source>Nature</source><volume>461</volume><fpage>941</fpage><lpage>946</lpage><pub-id pub-id-type="doi">10.1038/nature08499</pub-id><pub-id pub-id-type="pmid">19829374</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hebb</surname><given-names>DO</given-names></name></person-group><year iso-8601-date="1949">1949</year><chapter-title>The organization of behavior: A neuropsychological theory</chapter-title><source>A Wiley Book in Clinical Psychology</source><publisher-name>Wiley</publisher-name><volume>44</volume></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hopfield</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Neurodynamics of mental exploration</article-title><source>PNAS</source><volume>107</volume><fpage>1648</fpage><lpage>1653</lpage><pub-id pub-id-type="doi">10.1073/pnas.0913991107</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huxter</surname><given-names>J</given-names></name><name><surname>Burgess</surname><given-names>N</given-names></name><name><surname>O'Keefe</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Independent rate and temporal coding in hippocampal pyramidal cells</article-title><source>Nature</source><volume>425</volume><fpage>828</fpage><lpage>832</lpage><pub-id pub-id-type="doi">10.1038/nature02058</pub-id><pub-id pub-id-type="pmid">14574410</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huxter</surname><given-names>JR</given-names></name><name><surname>Senior</surname><given-names>TJ</given-names></name><name><surname>Allen</surname><given-names>K</given-names></name><name><surname>Csicsvari</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Theta phase-specific codes for two-dimensional position, trajectory and heading in the hippocampus</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>587</fpage><lpage>594</lpage><pub-id pub-id-type="doi">10.1038/nn.2106</pub-id><pub-id pub-id-type="pmid">18425124</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaramillo</surname><given-names>J</given-names></name><name><surname>Schmidt</surname><given-names>R</given-names></name><name><surname>Kempter</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Modeling inheritance of phase precession in the hippocampal formation</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>7715</fpage><lpage>7731</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5136-13.2014</pub-id><pub-id pub-id-type="pmid">24872575</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeewajee</surname><given-names>A</given-names></name><name><surname>Barry</surname><given-names>C</given-names></name><name><surname>Douchamps</surname><given-names>V</given-names></name><name><surname>Manson</surname><given-names>D</given-names></name><name><surname>Lever</surname><given-names>C</given-names></name><name><surname>Burgess</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Theta phase precession of grid and place cell firing in open environments</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>369</volume><elocation-id>20120532</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2012.0532</pub-id><pub-id pub-id-type="pmid">24366140</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karlsson</surname><given-names>MP</given-names></name><name><surname>Frank</surname><given-names>LM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Network dynamics underlying the formation of sparse, informative representations in the hippocampus</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>14271</fpage><lpage>14281</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4261-08.2008</pub-id><pub-id pub-id-type="pmid">19109508</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>King</surname><given-names>C</given-names></name><name><surname>Recce</surname><given-names>M</given-names></name><name><surname>O'Keefe</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>The rhythmicity of cells of the medial septum/diagonal band of Broca in the awake freely moving rat: relationships with behaviour and hippocampal theta</article-title><source>European Journal of Neuroscience</source><volume>10</volume><fpage>464</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1046/j.1460-9568.1998.00026.x</pub-id><pub-id pub-id-type="pmid">9749709</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kjelstrup</surname><given-names>KB</given-names></name><name><surname>Solstad</surname><given-names>T</given-names></name><name><surname>Brun</surname><given-names>VH</given-names></name><name><surname>Hafting</surname><given-names>T</given-names></name><name><surname>Leutgeb</surname><given-names>S</given-names></name><name><surname>Witter</surname><given-names>MP</given-names></name><name><surname>Moser</surname><given-names>EI</given-names></name><name><surname>Moser</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Finite scale of spatial representation in the hippocampus</article-title><source>Science</source><volume>321</volume><fpage>140</fpage><lpage>143</lpage><pub-id pub-id-type="doi">10.1126/science.1157086</pub-id><pub-id pub-id-type="pmid">18599792</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lengyel</surname><given-names>M</given-names></name><name><surname>Szatmáry</surname><given-names>Z</given-names></name><name><surname>Erdi</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Dynamically detuned oscillations account for the coupled rate and temporal code of place cell firing</article-title><source>Hippocampus</source><volume>13</volume><fpage>700</fpage><lpage>714</lpage><pub-id pub-id-type="doi">10.1002/hipo.10116</pub-id><pub-id pub-id-type="pmid">12962315</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leung</surname><given-names>LS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A model of intracellular θ phase precession dependent on intrinsic subthreshold membrane currents</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>12282</fpage><lpage>12296</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0586-11.2011</pub-id><pub-id pub-id-type="pmid">21865471</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname><given-names>WB</given-names></name><name><surname>Steward</surname><given-names>O</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Temporal contiguity requirements for long-term associative potentiation/depression in the hippocampus</article-title><source>Neuroscience</source><volume>8</volume><fpage>791</fpage><lpage>797</lpage><pub-id pub-id-type="doi">10.1016/0306-4522(83)90010-6</pub-id><pub-id pub-id-type="pmid">6306504</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lisman</surname><given-names>J</given-names></name><name><surname>Redish</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Prediction, sequences and the hippocampus</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>364</volume><fpage>1193</fpage><lpage>1201</lpage><pub-id pub-id-type="doi">10.1098/rstb.2008.0316</pub-id><pub-id pub-id-type="pmid">19528000</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lisman</surname><given-names>JE</given-names></name><name><surname>Idiart</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Storage of 7 +/- 2 short-term memories in oscillatory subcycles</article-title><source>Science</source><volume>267</volume><fpage>1512</fpage><lpage>1515</lpage><pub-id pub-id-type="doi">10.1126/science.7878473</pub-id><pub-id pub-id-type="pmid">7878473</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Long</surname><given-names>LL</given-names></name><name><surname>Bunce</surname><given-names>JG</given-names></name><name><surname>Chrobak</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Theta variation and spatiotemporal scaling along the septotemporal axis of the hippocampus</article-title><source>Frontiers in Systems Neuroscience</source><volume>9</volume><elocation-id>37</elocation-id><pub-id pub-id-type="doi">10.3389/fnsys.2015.00037</pub-id><pub-id pub-id-type="pmid">25852496</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Losonczy</surname><given-names>A</given-names></name><name><surname>Zemelman</surname><given-names>BV</given-names></name><name><surname>Vaziri</surname><given-names>A</given-names></name><name><surname>Magee</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Network mechanisms of theta related neuronal activity in hippocampal CA1 pyramidal neurons</article-title><source>Nature Neuroscience</source><volume>13</volume><fpage>967</fpage><lpage>972</lpage><pub-id pub-id-type="doi">10.1038/nn.2597</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lubenov</surname><given-names>EV</given-names></name><name><surname>Siapas</surname><given-names>AG</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Hippocampal theta oscillations are travelling waves</article-title><source>Nature</source><volume>459</volume><fpage>534</fpage><lpage>539</lpage><pub-id pub-id-type="doi">10.1038/nature08010</pub-id><pub-id pub-id-type="pmid">19489117</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Magee</surname><given-names>JC</given-names></name><name><surname>Johnston</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>A synaptically controlled, associative signal for Hebbian plasticity in hippocampal neurons</article-title><source>Science</source><volume>275</volume><fpage>209</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.1126/science.275.5297.209</pub-id><pub-id pub-id-type="pmid">8985013</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Magee</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Dendritic mechanisms of phase precession in hippocampal CA1 pyramidal neurons</article-title><source>Journal of Neurophysiology</source><volume>86</volume><fpage>528</fpage><lpage>532</lpage><pub-id pub-id-type="pmid">11431530</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>Lübke</surname><given-names>J</given-names></name><name><surname>Frotscher</surname><given-names>M</given-names></name><name><surname>Sakmann</surname><given-names>B</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Regulation of synaptic efficacy by coincidence of postsynaptic APs and EPSPs</article-title><source>Science</source><volume>275</volume><fpage>213</fpage><lpage>215</lpage><pub-id pub-id-type="doi">10.1126/science.275.5297.213</pub-id><pub-id pub-id-type="pmid">8985014</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maurer</surname><given-names>AP</given-names></name><name><surname>Cowen</surname><given-names>SL</given-names></name><name><surname>Burke</surname><given-names>SN</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Phase precession in hippocampal interneurons showing strong functional coupling to individual pyramidal cells</article-title><source>Journal of Neuroscience</source><volume>26</volume><fpage>13485</fpage><lpage>13492</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2882-06.2006</pub-id><pub-id pub-id-type="pmid">17192431</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maurer</surname><given-names>AP</given-names></name><name><surname>Lester</surname><given-names>AW</given-names></name><name><surname>Ferng</surname><given-names>JJ</given-names></name><name><surname>Ferng</surname><given-names>JJ</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Back to the future: preserved hippocampal network activity during reverse ambulation</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>15022</fpage><lpage>15031</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1129-14.2014</pub-id><pub-id pub-id-type="pmid">25378167</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maurer</surname><given-names>AP</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Network and intrinsic cellular mechanisms underlying theta phase precession of hippocampal neurons</article-title><source>Trends in Neurosciences</source><volume>30</volume><fpage>325</fpage><lpage>333</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2007.05.002</pub-id><pub-id pub-id-type="pmid">17532482</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maurer</surname><given-names>AP</given-names></name><name><surname>Vanrhoads</surname><given-names>SR</given-names></name><name><surname>Sutherland</surname><given-names>GR</given-names></name><name><surname>Lipa</surname><given-names>P</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Self-motion and the origin of differential spatial scaling along the septo-temporal axis of the hippocampus</article-title><source>Hippocampus</source><volume>15</volume><fpage>841</fpage><lpage>852</lpage><pub-id pub-id-type="doi">10.1002/hipo.20114</pub-id><pub-id pub-id-type="pmid">16145692</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McFarland</surname><given-names>WL</given-names></name><name><surname>Teitelbaum</surname><given-names>H</given-names></name><name><surname>Hedges</surname><given-names>EK</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Relationship between hippocampal theta activity and running speed in the rat</article-title><source>Journal of Comparative and Physiological Psychology</source><volume>88</volume><fpage>324</fpage><lpage>328</lpage><pub-id pub-id-type="doi">10.1037/h0076177</pub-id><pub-id pub-id-type="pmid">1120805</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mehta</surname><given-names>MR</given-names></name><name><surname>Lee</surname><given-names>AK</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Role of experience and oscillations in transforming a rate code into a temporal code</article-title><source>Nature</source><volume>417</volume><fpage>741</fpage><lpage>746</lpage><pub-id pub-id-type="doi">10.1038/nature00807</pub-id><pub-id pub-id-type="pmid">12066185</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Melamed</surname><given-names>O</given-names></name><name><surname>Gerstner</surname><given-names>W</given-names></name><name><surname>Maass</surname><given-names>W</given-names></name><name><surname>Tsodyks</surname><given-names>M</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Coding and learning of behavioral sequences</article-title><source>Trends in Neurosciences</source><volume>27</volume><fpage>11</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2003.10.014</pub-id><pub-id pub-id-type="pmid">14698603</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Middleton</surname><given-names>SJ</given-names></name><name><surname>McHugh</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Silencing CA3 disrupts temporal coding in the CA1 ensemble</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>945</fpage><lpage>951</lpage><pub-id pub-id-type="doi">10.1038/nn.4311</pub-id><pub-id pub-id-type="pmid">27239937</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname><given-names>J</given-names></name><name><surname>Burgess</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Dual phase and rate coding in hippocampal place cells: theoretical significance and relationship to entorhinal grid cells</article-title><source>Hippocampus</source><volume>15</volume><fpage>853</fpage><lpage>866</lpage><pub-id pub-id-type="doi">10.1002/hipo.20115</pub-id><pub-id pub-id-type="pmid">16145693</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname><given-names>J</given-names></name><name><surname>Recce</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Phase relationship between hippocampal place units and the EEG theta rhythm</article-title><source>Hippocampus</source><volume>3</volume><fpage>317</fpage><lpage>330</lpage><pub-id pub-id-type="doi">10.1002/hipo.450030307</pub-id><pub-id pub-id-type="pmid">8353611</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pastalkova</surname><given-names>E</given-names></name><name><surname>Itskov</surname><given-names>V</given-names></name><name><surname>Amarasingham</surname><given-names>A</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Internally generated cell assembly sequences in the rat hippocampus</article-title><source>Science</source><volume>321</volume><fpage>1322</fpage><lpage>1327</lpage><pub-id pub-id-type="doi">10.1126/science.1159775</pub-id><pub-id pub-id-type="pmid">18772431</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patel</surname><given-names>J</given-names></name><name><surname>Fujisawa</surname><given-names>S</given-names></name><name><surname>Berényi</surname><given-names>A</given-names></name><name><surname>Royer</surname><given-names>S</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Traveling theta waves along the entire septotemporal axis of the hippocampus</article-title><source>Neuron</source><volume>75</volume><fpage>410</fpage><lpage>417</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.07.015</pub-id><pub-id pub-id-type="pmid">22884325</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Redish</surname><given-names>AD</given-names></name><name><surname>Battaglia</surname><given-names>FP</given-names></name><name><surname>Chawla</surname><given-names>MK</given-names></name><name><surname>Ekstrom</surname><given-names>AD</given-names></name><name><surname>Gerrard</surname><given-names>JL</given-names></name><name><surname>Lipa</surname><given-names>P</given-names></name><name><surname>Rosenzweig</surname><given-names>ES</given-names></name><name><surname>Worley</surname><given-names>PF</given-names></name><name><surname>Guzowski</surname><given-names>JF</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Independence of firing correlates of anatomically proximate hippocampal pyramidal cells</article-title><source>Journal of Neuroscience</source><volume>21</volume><elocation-id>RC134</elocation-id><pub-id pub-id-type="pmid">11222672</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robbe</surname><given-names>D</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Alteration of theta timescale dynamics of hippocampal place cells by a cannabinoid is associated with memory impairment</article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>12597</fpage><lpage>12605</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2407-09.2009</pub-id><pub-id pub-id-type="pmid">19812334</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Royer</surname><given-names>S</given-names></name><name><surname>Sirota</surname><given-names>A</given-names></name><name><surname>Patel</surname><given-names>J</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Distinct representations and theta dynamics in dorsal and ventral hippocampus</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>1777</fpage><lpage>1787</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4681-09.2010</pub-id><pub-id pub-id-type="pmid">20130187</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Royer</surname><given-names>S</given-names></name><name><surname>Zemelman</surname><given-names>BV</given-names></name><name><surname>Losonczy</surname><given-names>A</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Chance</surname><given-names>F</given-names></name><name><surname>Magee</surname><given-names>JC</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Control of timing, rate and bursts of hippocampal place cells by dendritic and somatic inhibition</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>769</fpage><lpage>775</lpage><pub-id pub-id-type="doi">10.1038/nn.3077</pub-id><pub-id pub-id-type="pmid">22446878</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Samsonovich</surname><given-names>A</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Path integration and cognitive mapping in a continuous attractor neural network model</article-title><source>Journal of Neuroscience</source><volume>17</volume><fpage>5900</fpage><lpage>5920</lpage><pub-id pub-id-type="pmid">9221787</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname><given-names>R</given-names></name><name><surname>Diba</surname><given-names>K</given-names></name><name><surname>Leibold</surname><given-names>C</given-names></name><name><surname>Schmitz</surname><given-names>D</given-names></name><name><surname>Buzsaki</surname><given-names>G</given-names></name><name><surname>Kempter</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Single-Trial phase precession in the hippocampus</article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>13232</fpage><lpage>13241</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2270-09.2009</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singer</surname><given-names>AC</given-names></name><name><surname>Carr</surname><given-names>MF</given-names></name><name><surname>Karlsson</surname><given-names>MP</given-names></name><name><surname>Frank</surname><given-names>LM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Hippocampal SWR activity predicts correct decisions during the initial learning of an alternation task</article-title><source>Neuron</source><volume>77</volume><fpage>1163</fpage><lpage>1173</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.01.027</pub-id><pub-id pub-id-type="pmid">23522050</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skaggs</surname><given-names>WE</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences</article-title><source>Hippocampus</source><volume>6</volume><fpage>149</fpage><lpage>172</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1996)6:2&lt;149::AID-HIPO6&gt;3.0.CO;2-K</pub-id><pub-id pub-id-type="pmid">8797016</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsodyks</surname><given-names>MV</given-names></name><name><surname>Skaggs</surname><given-names>WE</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Population dynamics and theta rhythm phase precession of hippocampal place cell firing: a spiking neuron model</article-title><source>Hippocampus</source><volume>6</volume><fpage>271</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1996)6:3&lt;271::AID-HIPO5&gt;3.3.CO;2-Q</pub-id><pub-id pub-id-type="pmid">8841826</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Meer</surname><given-names>MA</given-names></name><name><surname>Redish</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Theta phase precession in rat ventral striatum links place and reward information</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>2843</fpage><lpage>2854</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4869-10.2011</pub-id><pub-id pub-id-type="pmid">21414906</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Romani</surname><given-names>S</given-names></name><name><surname>Lustig</surname><given-names>B</given-names></name><name><surname>Leonardo</surname><given-names>A</given-names></name><name><surname>Pastalkova</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Theta sequences are essential for internally generated hippocampal firing fields</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>282</fpage><lpage>288</lpage><pub-id pub-id-type="doi">10.1038/nn.3904</pub-id><pub-id pub-id-type="pmid">25531571</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Welday</surname><given-names>AC</given-names></name><name><surname>Shlifer</surname><given-names>IG</given-names></name><name><surname>Bloom</surname><given-names>ML</given-names></name><name><surname>Zhang</surname><given-names>K</given-names></name><name><surname>Blair</surname><given-names>HT</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Cosine directional tuning of theta cell burst frequencies: evidence for spatial coding by oscillatory interference</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>16157</fpage><lpage>16176</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0712-11.2011</pub-id><pub-id pub-id-type="pmid">22072668</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wikenheiser</surname><given-names>AM</given-names></name><name><surname>Redish</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Decoding the cognitive map: ensemble hippocampal sequences and decision making</article-title><source>Current Opinion in Neurobiology</source><volume>32</volume><fpage>8</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2014.10.002</pub-id><pub-id pub-id-type="pmid">25463559</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woodson</surname><given-names>W</given-names></name><name><surname>Nitecka</surname><given-names>L</given-names></name><name><surname>Ben-Ari</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Organization of the GABAergic system in the rat hippocampal formation: a quantitative immunocytochemical study</article-title><source>The Journal of Comparative Neurology</source><volume>280</volume><fpage>254</fpage><lpage>271</lpage><pub-id pub-id-type="doi">10.1002/cne.902800207</pub-id><pub-id pub-id-type="pmid">2925894</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>S</given-names></name><name><surname>Yang</surname><given-names>S</given-names></name><name><surname>Moreira</surname><given-names>T</given-names></name><name><surname>Hoffman</surname><given-names>G</given-names></name><name><surname>Carlson</surname><given-names>GC</given-names></name><name><surname>Bender</surname><given-names>KJ</given-names></name><name><surname>Alger</surname><given-names>BE</given-names></name><name><surname>Tang</surname><given-names>C-M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Interlamellar CA1 network in the hippocampus</article-title><source>PNAS</source><volume>111</volume><fpage>12919</fpage><lpage>12924</lpage><pub-id pub-id-type="doi">10.1073/pnas.1405468111</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zugaro</surname><given-names>MB</given-names></name><name><surname>Monconduit</surname><given-names>L</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Spike phase precession persists after transient intrahippocampal perturbation</article-title><source>Nature Neuroscience</source><volume>8</volume><fpage>67</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1038/nn1369</pub-id><pub-id pub-id-type="pmid">15592464</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.20349.019</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Skinner</surname><given-names>Frances K</given-names></name><role>Reviewing editor</role><aff id="aff5"><institution>University Health Network</institution>, <country>Canada</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Flexible theta sequence compression mediated via phase precessing interneurons&quot; for consideration by <italic>eLife</italic>. Your article has been favorably evaluated by Timothy Behrens (Senior Editor) and three reviewers, one of whom is a member of our Board of Reviewing Editors.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>In this thorough and clearly written paper, Chadwick et al. present a novel mechanistic model framework for theta sequences. They advance a model for phase precession in which interneurons receive theta-frequency inputs and pyramidal cells receive a driving Gaussian envelope. Their model distinguishes itself from others by having interneurons (PV) play a critical role. Specifically, the theta rhythm is input via medial septal GABAergic input to interneurons that are coupled with pyramidal (place) cells. This is different from any existing models (as nicely summarized in a table overview (Figure 1—figure supplement 1). The authors describe experimental phenomenon that have been traditionally difficult for other models to capture.</p><p>The authors use a reduced model to motivate, constrain and understand their model framework and so find and explain how it can capture the range of results from experimental work regarding theta sequences (e.g., theta waves propagating along dorsoventral axis, speed dependence etc.).</p><p>In the end, they show (via <xref ref-type="fig" rid="fig8">Figure 8</xref>) and describe their model mechanism in operation with STDP aspects, and have set down core (ancillary and network topographic) predictions.</p><p>The model has the potential to be quite interesting to researchers interested in temporal coding in the hippocampus. Currently there is no universally accepted model of phase precession that seems to explain all the data out there, which suggests either the right one has not yet been proposed or multiple mechanisms are at play. Either way, this model has the potential to be thought-provoking and to drive additional research that will be required to resolve the mechanisms underlying phase precession in hippocampus and associated structures.</p><p>Overall, they seem to have captured an &quot;essential skeleton&quot; for phase precession based on dynamically integrating pacemaker and spatial signals via inhibitory interneurons. It is especially interesting that this model mechanism could potentially be used as a base on which to build other existing mechanisms that include more details and biophysics (e.g., dendritic and somatic interference in pyramidal cells).</p><p>The reviewers would appreciate consideration of the following points in a revised submission.</p><p>Major points:</p><p>1) I would have guessed that this model relies specifically on the tuning of the strengths of the interaction between the pyramidal cell and the interneurons and also (related) the specific timing of the interactions between the two cells. I would guess that the model would be rather sensitive to any noise in the system. Perhaps the authors could demonstrate how phase precession is impacted by extraneous synaptic input noise?</p><p>2) Looking at Royer et al. (2012), the PV-interneurons seem to fire strongly over the entire maze (as do the non-PV interneurons). My understanding is that this is consistent with experimental findings reported from other laboratories. The model presented here requires that interneurons be coupled to pyramidal cells with mostly non-overlapping place fields. While I am satisfied that it is possible for the circuit to be configured in this way (and the authors spend a lot to space going through the combinatorics), I think it is unlikely that every environment would result in the pyramidal and interneuron pairs being organized in this way. Still, not all putative pyramidal cells show strong phase precession. I was curious if the authors might be able to make some prediction about the distribution of phase precession &quot;strengths&quot; that would result from their model with randomly assigned place fields and/or pyramidal cell-interneuron couplings.</p><p>3) In <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>, the authors claim to have replicated the results of Royer et al. 2012. To me it seems that the PV-inactivation accelerates the phase precession, whereas Royer reported a delay in precession. Put another way, the shifts reported by both groups seem to go in opposite directions from each other.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.20349.020</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Major points:</italic> </p><p><italic>1) I would have guessed that this model relies specifically on the tuning of the strengths of the interaction between the pyramidal cell and the interneurons and also (related) the specific timing of the interactions between the two cells. I would guess that the model would be rather sensitive to any noise in the system. Perhaps the authors could demonstrate how phase precession is impacted by extraneous synaptic input noise?</italic> </p><p>To address this question, we have performed additional simulations in which we inject varying levels of extraneous noise into the interneurons or pyramidal cells in the model (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref> in the revised manuscript). We find that the phase precession and sequences continue to be robustly generated when several millivolts of noise is injected into pyramidal cells. Interneuron noise has a similar effect to the disruptive place field overlap we considered previously, causing a disruption of sequences but not single-trial pyramidal cell phase precession. In contrast, the disruption observed when large amplitude noise is injected into pyramidal cells involves a decrease in the strength of single-trial pyramidal cell phase precession as well as population sequences. These findings are now described in the second paragraph of the subsection “Network reconfiguration can dissociate single-trial phase precession and theta sequences”.</p><p><italic>2) Looking at Royer et al. (2012), the PV-interneurons seem to fire strongly over the entire maze (as do the non-PV interneurons). My understanding is that this is consistent with experimental findings reported from other laboratories. The model presented here requires that interneurons be coupled to pyramidal cells with mostly non-overlapping place fields. While I am satisfied that it is possible for the circuit to be configured in this way (and the authors spend a lot to space going through the combinatorics), I think it is unlikely that every environment would result in the pyramidal and interneuron pairs being organized in this way. Still, not all putative pyramidal cells show strong phase precession. I was curious if the authors might be able to make some prediction about the distribution of phase precession &quot;strengths&quot; that would result from their model with randomly assigned place fields and/or pyramidal cell-interneuron couplings.</italic> </p><p>We have now analysed the distribution of phase precession strengths in a population of pyramidal cells with random maps of various densities (<xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4</xref> in the revised manuscript). As suggested by the reviewer, we find that a substantial fraction of the pyramidal cell population continues to exhibit robust phase precession despite disruption in the network.</p><p>With just one pyramidal cell per interneuron, all pyramidal cells exhibit robust phase precession, and cell to cell variability in phase precession strength reflects only sample size effects. With increasing numbers of pyramidal cells per interneuron, the mean phase precession strength in the population steadily decreases, but a substantial proportion nevertheless continue to exhibit strong phase precession even with 10 active pyramidal cells per interneuron on a 5 meter track. These findings are now described in the third paragraph of the subsection “Theta sequences can be generated in a large number of spatial maps”.</p><p><italic>3) In <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>, the authors claim to have replicated the results of Royer et al. 2012. To me it seems that the PV-inactivation accelerates the phase precession, whereas Royer reported a delay in precession. Put another way, the shifts reported by both groups seem to go in opposite directions from each other.</italic></p><p>For the simplest stimulation protocol we implemented (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2A</xref> and B in the original manuscript, Figure 5—figure supplement 3A and B in the revised manuscript), phase precession does shift in the same direction reported by Royer et al. (compare this figure to their <xref ref-type="fig" rid="fig7">Figure 7B and C</xref>). However, the reviewer is correct that when we tested a second, more detailed stimulation protocol, the shift appears to go in the opposite direction, as well as decreasing in magnitude. As we noted in the original manuscript, theta coordination of pyramidal cells is entirely absent during periods of interneuron inactivation in the model. Thus, while we do observe a phase shift in the averaged data, this is actually caused by a shift in the firing frequency of the pyramidal cell during interneuron silencing. The details of how this frequency shift translates into a phase shift in the averaged data are sensitive to specific details of the stimulation protocol, such as the timing and duration of inactivation within the place field. Thus, while our model can reproduce both the magnitude and the direction of the phase shifts reported by Royer et al., our results suggest that the phase shift they reported does not reflect the fundamental role of PV neurons in generating pyramidal cell phase precession. We have now clarified this point in the revised manuscript (subsection “Robust phase precession is generated along two-dimensional trajectories”, third paragraph).</p></body></sub-article></article>