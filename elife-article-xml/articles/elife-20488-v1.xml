<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">20488</article-id><article-id pub-id-type="doi">10.7554/eLife.20488</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Developmental Biology</subject></subj-group></article-categories><title-group><article-title>Discovering sparse transcription factor codes for cell states and state transitions during development</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-64869"><name><surname>Furchtgott</surname><given-names>Leon A</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4258-0950</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-66716"><name><surname>Melton</surname><given-names>Samuel</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-66717"><name><surname>Menon</surname><given-names>Vilas</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-45326"><name><surname>Ramanathan</surname><given-names>Sharad</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="corresp" rid="cor2">*</xref><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">FAS Center for Systems Biology</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Biophysics Program</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Harvard Stem Cell Institute</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff4"><label>4</label><institution>Allen Institute for Brain Science</institution>, <addr-line><named-content content-type="city">Seattle</named-content></addr-line>, <country>United States</country></aff><aff id="aff5"><label>5</label><institution>Janelia Research Campus, Howard Hughes Medical Institute</institution>, <addr-line><named-content content-type="city">Ashburn</named-content></addr-line>, <country>United States</country></aff><aff id="aff6"><label>6</label><institution content-type="dept">Department of Molecular and Cellular Biology</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff7"><label>7</label><institution content-type="dept">School of Engineering and Applied Sciences</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Yosef</surname><given-names>Nir</given-names></name><role>Reviewing editor</role><aff id="aff8"><institution>University of California</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>leon.furchtgott@gmail.com</email> (LAF);</corresp><corresp id="cor2"><email>sharad@cgr.harvard.edu</email> (SR)</corresp><fn fn-type="con" id="equal-contrib"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>15</day><month>03</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e20488</elocation-id><history><date date-type="received"><day>09</day><month>08</month><year>2016</year></date><date date-type="accepted"><day>31</day><month>01</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Furchtgott et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Furchtgott et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-20488-v1.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="article-reference" xlink:href="10.7554/eLife.20487"/><related-article ext-link-type="doi" id="ra2" related-article-type="commentary" xlink:href="10.7554/eLife.25654"/><abstract><object-id pub-id-type="doi">10.7554/eLife.20488.001</object-id><p>Computational analysis of gene expression to determine both the sequence of lineage choices made by multipotent cells and to identify the genes influencing these decisions is challenging. Here we discover a pattern in the expression levels of a sparse subset of genes among cell types in B- and T-cell developmental lineages that correlates with developmental topologies. We develop a statistical framework using this pattern to simultaneously infer lineage transitions and the genes that determine these relationships. We use this technique to reconstruct the early hematopoietic and intestinal developmental trees. We extend this framework to analyze single-cell RNA-seq data from early human cortical development, inferring a neocortical-hindbrain split in early progenitor cells and the key genes that could control this lineage decision. Our work allows us to simultaneously infer both the identity and lineage of cell types as well as a small set of key genes whose expression patterns reflect these relationships.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.001">http://dx.doi.org/10.7554/eLife.20488.001</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>systems biology</kwd><kwd>Transcriptomics</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>Human</kwd><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Furchtgott</surname><given-names>Leon A.</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Ramanathan</surname><given-names>Sharad</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008796</institution-id><institution>Allen Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Menon</surname><given-names>Vilas</given-names></name><name><surname>Ramanathan</surname><given-names>Sharad</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Sparse patterns in gene expression allow simultaneous discovery of cell states, lineage relationships and key genes controlling developmental decisions.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title id="head_1">Introduction</title><p>During development, pluripotent cells make a series of lineage decisions to give rise to the different cell types of the body. These lineage decisions are controlled by intra-cellular molecular networks that include transcription factors and signaling molecules. There are two fundamental challenges associated with understanding the differentiation of individual cells. The first is to identify lineage relationships: how cells and their progeny move from pluripotent through intermediate to terminally differentiated cell states. The second is to identify the key molecular drivers that allow cells to make fate decisions along their developmental trajectory.</p><p>Reconstructing cell lineages has traditionally involved prospectively tracking cells and their progeny using a variety of imaging or genetic tools (<xref ref-type="bibr" rid="bib18">Buckingham and Meilhac, 2011</xref>; <xref ref-type="bibr" rid="bib38">Frumkin et al., 2008</xref>; <xref ref-type="bibr" rid="bib100">Orkin and Zon, 2008</xref>; <xref ref-type="bibr" rid="bib124">Sulston et al., 1983</xref>). Recent progress in single-cell sequencing techniques (<xref ref-type="bibr" rid="bib47">Grün et al., 2015</xref>; <xref ref-type="bibr" rid="bib57">Jaitin et al., 2014</xref>; <xref ref-type="bibr" rid="bib80">Macosko et al., 2015</xref>; <xref ref-type="bibr" rid="bib101">Patel et al., 2014</xref>; <xref ref-type="bibr" rid="bib102">Paul et al., 2015</xref>; <xref ref-type="bibr" rid="bib136">Treutlein et al., 2014</xref>; <xref ref-type="bibr" rid="bib158">Zeisel et al., 2015</xref>) allows for a complementary view of the transcriptional states of individual cells during the course of development, providing static snapshots of the dynamics of the underlying molecular network. But inferring lineage relationships and the dynamics of the underlying molecular networks has proved difficult using transcriptional data alone, in part because of the high dimensional nature of these data. Overcoming this challenge would be particularly useful for understanding the development of human organs such as the brain where traditional lineage tracing experiments are more difficult.</p><p>High dimensional data analysis techniques such as PCA, ICA, or t-SNE, are useful at reducing dimensionality. However, since the resulting axes represent linear combinations of a large number of features (for example, expression levels of each gene), interpreting the analysis or making experimental predictions is sometimes challenging. Meanwhile, traditional statistical methods such as linear multivariate regression have limited applicability for detecting patterns in high dimensional data (<xref ref-type="bibr" rid="bib3">Advani and Ganguli, 2016</xref>; <xref ref-type="bibr" rid="bib29">Donoho and Tanner, 2009</xref>). The challenges inherent in high-dimensional data analysis such as identifying discriminatory features are further exacerbated as the fraction of relevant features decreases (<xref ref-type="bibr" rid="bib29">Donoho and Tanner, 2009</xref>). Computational techniques currently in use to cluster single cell data or to infer relationships among cells are built on these approaches, thereby assuming that all high-variance genes are equally relevant for pattern detection (<xref ref-type="bibr" rid="bib83">Marco et al., 2014</xref>; <xref ref-type="bibr" rid="bib115">Satija et al., 2015</xref>; <xref ref-type="bibr" rid="bib134">Trapnell et al., 2014</xref>). In contrast, decades of work in developmental biology have revealed that combinations of a few transcription factors can be sufficient to experimentally perturb cell fate and developmental decisions (<xref ref-type="bibr" rid="bib42">Gilbert, 2014</xref>; <xref ref-type="bibr" rid="bib44">Graf and Enver, 2009</xref>; <xref ref-type="bibr" rid="bib126">Takahashi and Yamanaka, 2006</xref>) suggesting that the expression patterns of a few genes may be most relevant for making computational inferences. Therefore, there is a need to detect patterns involving a small fraction of all genes. Unfortunately, except in the case of well-studied lineage decisions, we do not know the identity of this fraction.</p><p>In statistics, techniques relying on L1 regularization have been successful in contexts where the number of informative variables is known to be small but whose identities are unknown, both for regression problems (<xref ref-type="bibr" rid="bib12">Baraniuk, 2007</xref>; <xref ref-type="bibr" rid="bib19">Candès et al., 2006</xref>; <xref ref-type="bibr" rid="bib132">Tibshirani, 1996</xref>; <xref ref-type="bibr" rid="bib145">Wainwright, 2009</xref>) and for clustering (<xref ref-type="bibr" rid="bib150">Witten and Tibshirani, 2010</xref>). Inspired by these successes in statistics, our aim here is to discover generalizable sparse patterns in gene expression data during development (if they exist), and to exploit these patterns to computationally infer the dynamics of cell state transitions from high-dimensional transcriptional data obtained during the course of development.</p><p>In this manuscript we analyze expression patterns among cell types with known lineage relationships in late hematopoiesis and discover a pattern in a sparse subset of genes that correlates with these relationships. We develop a Bayesian framework based on this gene expression pattern to simultaneously infer lineage transitions and the key genes that drive them. We apply this method to reconstruct the lineage tree among a different set of cell types in early hematopoietic development, and in this process identify many known drivers of early hematopoiesis, including <italic>Gata1</italic>, <italic>Cebpa</italic> and <italic>Ebf1</italic>. We further extend our method to analyze single-cell gene expression data, using genes exhibiting the discovered pattern to cluster cells from early brain development and to infer lineage relationships between these clusters. Our analysis reveals a split from early progenitors to putative neocortex and mid/hindbrain cell types, as evidenced by the mutually exclusive expression of region-specific genes such as <italic>FOXG1</italic>, <italic>LHX1</italic>, and <italic>POU3F2</italic> (<italic>BRN2</italic>). This prediction was validated experimentally in a separate work (<xref ref-type="bibr" rid="bib154">Yao et al., 2017</xref>). We finally discuss the advantages of using sparse patterns for making inferences and for modeling the underlying gene regulatory networks.</p></sec><sec id="s2" sec-type="results"><title id="head_2">Results</title><sec id="s2-1"><title id="head_3">Discovering sparse patterns correlated with lineage transitions</title><p>In order to identify gene expression patterns that are robustly predictive of lineage relationships, we analyzed gene expression data from 41 cell types during B- and T- cell development that have an experimentally established developmental lineage (<xref ref-type="fig" rid="fig1">Figure 1A</xref>, <xref ref-type="bibr" rid="bib51">Heng et al., 2008</xref>). We searched for sparse patterns of gene expression amongst groups of three cell types from this collection; subsets of three are the minimal set in which measures of relative similarity can be used infer relative lineage relationships.<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.20488.002</object-id><label>Figure 1.</label><caption><title>The clear minimum pattern is robustly detected in leaf cell types throughout triplet lineages in B- and T-cell development.</title><p>(<bold>A</bold>) Developmental lineage tree showing relationships among 41 cell types in B- and T-cell development (<xref ref-type="bibr" rid="bib51">Heng et al., 2008</xref>). Three triplets – the minimal subset of the tree from which relative distances can be studied – are denoted, each including an intermediate root cell type (red) and terminal leaf cell types (blue). 150 triplets among all sets of three cell types within five steps on the lineage tree were extracted for pattern-detection. (<bold>B</bold>) For each triplet of cell types (left), each gene’s expression level can have the clear minimum pattern in either the root or the leaves (right, top box) where the distribution of gene expression levels in one cell type is well separated from the other two (left, p&lt;0.005 in a two sample t-test); clear maximum pattern (left, bottom) in the root or the leaves: the gene has a clear maximum in one of the cell types (right, p&lt;0.005 in a two sample t-test). (<bold>C</bold>) A histogram of the number of genes showing the clear minimum pattern among the 150 triplets with known developmental topology. Triplets in which the root has the most genes showing the pattern shown in red; triplets in which one of the leaves has the most genes showing the pattern shown in blue. None of the triplets with more than 10 genes showing the pattern have the most genes with a clear minimum in the root (no red in any histogram bar except for the left most)(<bold>D</bold>) Principal component analysis of microarray data from the cell types in B- and T- cell development does not reflect known lineage relationships in (<bold>A</bold>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.002">http://dx.doi.org/10.7554/eLife.20488.002</ext-link></p><p><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.20488.003</object-id><label>Figure 1—source data 1.</label><caption><title>Triplets used for pattern detection.</title><p>Sheet 1: The 150 related triplets used for pattern detection are listed, with the root cell type of the triplet in the first column and the two leaves in second and third columns. Cell type names follow (<xref ref-type="bibr" rid="bib51">Heng et al., 2008</xref>). For each triplet are listed the number of genes with a clear minimum in each cell type and a clear maximum in each cell type (<italic>t</italic>-test p-value &lt; 0.005). Also listed for each triplet are the length of the triplet, whether the triplet is a lineage progression or a cell fate decision, whether the triplet contains a terminal node, and the entropy in the clear minimum pattern and clear maximum pattern. Sheet 2: The 100 unrelated triplets are listed; cell type names follow (<xref ref-type="bibr" rid="bib51">Heng et al., 2008</xref>). For each triplet are listed the number of genes with a clear minimum in each cell type and a clear maximum in each cell type (<italic>t</italic>-test p-value &lt; 0.005) and the entropy in the clear minimum pattern and clear maximum pattern.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.003">http://dx.doi.org/10.7554/eLife.20488.003</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-20488-fig1-data1-v1.xlsx"/></supplementary-material></p><p><supplementary-material id="SD2-data"><object-id pub-id-type="doi">10.7554/eLife.20488.004</object-id><label>Figure 1—source data 2.</label><caption><title>List of mouse transcription factors.</title><p>The list of human transcription factors used to cluster and infer lineages for the hematopoietic and intestinal development trees. The list was adapted from (<xref ref-type="bibr" rid="bib130">Thomson et al., 2011</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.004">http://dx.doi.org/10.7554/eLife.20488.004</ext-link></p></caption><media mime-subtype="excel" mimetype="application" xlink:href="elife-20488-fig1-data2-v1.xls"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20488-fig1-v1"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20488.005</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Clear minimum and clear maximum patterns.</title><p>(<bold>A</bold>, <bold>B</bold>) We used a two-distribution t-test to quantify the likelihood of a gene (each denoted by a single dot) showing either the clear minimum (<bold>A</bold>) or clear maximum pattern (<bold>B</bold>).We show the p-value from this t-test and the cell type in which the gene shows differential expression. The p-value cutoff is used to identify genes which show these patterns with high significance (dotted line). In this particular triplet, there are fewer genes with a clear minimum and with a clear maximum in the root of the triplet (B.T1) than in either leaf, as seen by fewer genes in the first row to the right of the cutoff. (<bold>C</bold>) A histogram of the number of genes showing the clear maximum pattern among the 150 triplets with known developmental topology. Triplets in which the root as the most genes showing the pattern are shown in blue. The clear maximum pattern does not show strong predictive power over the lineage relationships between triplets, and even when a large number of genes exhibit the pattern, the majority often reach their maximum in a leaf.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.005">http://dx.doi.org/10.7554/eLife.20488.005</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20488-fig1-figsupp1-v1"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20488.006</object-id><label>Figure 1—figure supplement 2.</label><caption><title>The clear minimum pattern is observed across different types of triplets.</title><p>(<bold>A</bold>) Histogram of the number of genes showing the clear minimum pattern evaluated over all 25,194 genes among the 150 triplets with known developmental topology. Triplets in which the root has the most genes showing the pattern shown in red; triplets in which one of the leaves has the most genes showing the pattern shown in blue. (<bold>B</bold>) Histogram of the number of genes showing the clear minimum pattern evaluated over transcription factors, using FDR-adjusted p-values, among the 150 triplets with known developmental topology. Triplets in which the root has the most genes showing the pattern shown in red; triplets in which one of the leaves has the most genes showing the pattern shown in blue. (<bold>C</bold>) Number of genes showing the clear minimum pattern in the three cell types of each triplet. The number of genes in the root cell type of each triplet is indicated in blue; the number of genes in the two leaves are represented in yellow and red. The triplets are ordered according to the total number of genes showing the pattern in the triplet. (<bold>D</bold>–<bold>F</bold>) A histogram of the number of genes showing the clear minimum pattern. As in <xref ref-type="fig" rid="fig1">Figure 1C</xref>, triplets in which the root has the most genes showing the pattern shown in red; triplets in which one of the leaves has the most genes showing the pattern shown in blue. Triplets are shaded according to different characteristics: length of triplet (<bold>D</bold>), presence of terminal node in triplet (<bold>E</bold>), cell-fate decision or lineage progression (<bold>F</bold>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.006">http://dx.doi.org/10.7554/eLife.20488.006</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20488-fig1-figsupp2-v1"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20488.007</object-id><label>Figure 1—figure supplement 3.</label><caption><title>Distinction between related and unrelated triplets.</title><p>(<bold>A</bold>) Plot, for triplets of related and unrelated cell types, of the entropy S of the fraction of genes downregulated in the 3 cell types (x-axis) and the total number of genes showing a minimum in any triplet for 100 unrelated and 150 related triplets (<xref ref-type="supplementary-material" rid="SD1-data">Figure 1—source data 1</xref>). Related triplets are shown in blue or red, depending on whether the cell type with the most genes showing the downregulated pattern is the root (red) or a leaf (blue), as in <xref ref-type="fig" rid="fig1">Figure 1C</xref>. Unrelated triplets are shown in green. For each triplet, we computed the entropy <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <italic>f<sub>i</sub></italic> is the fraction of the genes which reach a clear minimum in cell type <italic>i = A, B, C.</italic> Jitter added to triplets with S = 0 for clarity. (<bold>B</bold>) Histogram of the maximum inferred probability of a non-null topology in the Bayesian algorithm for the set of related triplets (top) and the set of unrelated triplets (bottom). (<bold>C</bold>) Receiver operating characteristic (ROC) curve for the probability of a non-null topology (<bold>B</bold>) for binary classification of the related and unrelated triplets. The area under the curve (AUC) is 0.96.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.007">http://dx.doi.org/10.7554/eLife.20488.007</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20488-fig1-figsupp3-v1"/></fig></fig-group></p><p>We identified 150 triplets of cell types with experimentally verified lineage relationships from B- and T- cell development (<xref ref-type="bibr" rid="bib51">Heng et al., 2008</xref>) (<xref ref-type="supplementary-material" rid="SD1-data">Figure 1—source data 1</xref>). Three such triplets are shown in <xref ref-type="fig" rid="fig1">Figure 1A</xref>. These triplets constituted both cell fate decisions (for example, cell type A gives rise to cell type B and C) and lineage progressions (cell type B gives rise to cell type A which then gives rise to cell type C). For each triplet, we noted which cell type was the progenitor or intermediate cell type (‘root’ cell type A) and which cell types were not (‘leaf’ cell types B and C). Note that even in the case in which cell type B gives rise to cell type A which gives rise to cell type C, we will refer to A as the ‘root’ and B and C as ‘leaves’ for that particular triplet. We analyzed transcription factor gene expression data for these triplets from the Immunological Genome Consortium (<xref ref-type="bibr" rid="bib51">Heng et al., 2008</xref>) since transcription factors are the ultimate drivers of cell fate decisions.</p><p>Surprisingly, we found that specific expression patterns involving only single genes correlated well with lineage relationships between three cell types. Genes that are not differentially expressed within a triplet of cell types convey no information about relationships between the cell types. Therefore, we select genes with expression variability among the three cell types. The expression pattern of such genes can belong to one of only two possible patterns: (<xref ref-type="fig" rid="fig1">Figure 1B</xref>): the <italic>clear minimum pattern</italic>: the gene has a clear minimum level in one of the three cell types, with its distribution of gene expression levels being well-separated from the other two (p&lt;0.005 in both two sample <italic>t</italic>-tests between the minimum cell type and the other two cell types; <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>); the <italic>clear maximum pattern</italic>: the gene has a clear maximum level in one of the cell types (p&lt;0.005 in both sample <italic>t</italic>-tests; <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>). Note that both patterns can be satisfied simultaneously if the distribution of expression levels in the three cell types are all well-separated with a clear maximum and minimum. We tested if either of the two patterns correlated with the lineage topologies between the three cell types with known lineage relationships (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C</xref>).</p><p>Triplets of cell types can be separated into categories based on how many genes exhibit the aforementioned patterns. 56% of the triplets contained more than 10 genes exhibiting the clear minimum pattern, and in 100% of these triplets the majority of genes with expression fitting this pattern reached their minimum expression in one of the leaves (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) and never in the root of the triplet. The frequency with which the pattern correctly indicated the lineage relationship increased with the number of genes within a triplet exhibiting the pattern, thus suggesting a confidence measure. The genes showing the clear minimum pattern fell into two distinct groups, corresponding to whether the minimum expression level was in one or the other of the two leaves (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>; <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2C</xref>). Thus the expression pattern of the total set of clear minimum genes correlated with the topology. Since genes showing the clear minimum pattern correlated with lineage relationships (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) between cell states both in the case of branches and linear sequences of cell state transitions, we refer to them as <italic>transition genes</italic>.</p><p>We further verified that the clear minimum pattern could be observed (a) in the set of all 25,194 genes (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref>), (b) using FDR-adjusted p-values (<xref ref-type="bibr" rid="bib14">Benjamini and Hochberg, 1995</xref>) (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2B</xref>), (c) in triplets of different lengths along the lineage tree (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2D</xref>), (d) in triplets both containing only internal nodes and including terminal nodes (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2E</xref>), (e) and in both lineage progression and cell fate decision triplets (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2F</xref>).</p><p>The clear maximum pattern was a poorer indicator of lineage relationships (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C</xref>). 83% of the triplets had more than 10 genes exhibiting this pattern, but 10% of those showed the majority of genes with expression fitting this pattern reaching their maximum in the root while the others did so in the leaves. Crucially, the integrity of the relationship between the clear maximum pattern and lineage topology was not correlated with the number of genes exhibiting the pattern (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C</xref>). While the clear maximum pattern did not correlate with lineage relationships, genes exhibiting this pattern identify individual cell types, and therefore we will refer to them as <italic>marker genes</italic>.</p><p>There are many examples of genes known to be functionally important for lineage decisions whose expression patterns fit the clear minimum pattern. In the case of lateral inhibition commonly used during development, progenitor cells express genes together (for example, <italic>Notch</italic> and <italic>Delta</italic>) which are differentially expressed in the differentiated states (only <italic>Notch</italic> or only <italic>Delta</italic>) (<xref ref-type="bibr" rid="bib103">Perrimon et al., 2012</xref>) reaching the minimum expression level in one of the leaves. The same pattern is also seen in multiple examples of lineage decisions often involving mutual inhibition, where key genes expressed in the progenitor are differentially regulated in the progeny (<xref ref-type="bibr" rid="bib44">Graf and Enver, 2009</xref>; <xref ref-type="bibr" rid="bib107">Qi et al., 2013</xref>; <xref ref-type="bibr" rid="bib130">Thomson et al., 2011</xref>; <xref ref-type="bibr" rid="bib160">Zhang et al., 1999</xref>). In each of these cases, key genes reach minimal expression levels in one of the leaves of the triplets.</p><p>The observation that genes exhibiting the clear minimum pattern are correlated with the lineage topology of a triplet of cell types further revealed that (i) only this fraction of transcription factors can be useful for inferring lineage relationships, and (ii) the identity of this fraction depends on which group of three cell types were analyzed. As the subset of genes that are informative varies based on the triplet of cell types being considered, establishing lineage relationship between all cell types at once as opposed to three at a time could be challenging. Indeed, our attempt to reconstruct the lineage relationships between all cell types using methods based on PCA failed (<xref ref-type="fig" rid="fig1">Figure 1D</xref>).</p><p>We further evaluated the clear minimum pattern in 100 triplets in which there was no clear relation between the cell types (<xref ref-type="supplementary-material" rid="SD1-data">Figure 1—source data 1</xref>). We found that while there were a substantial number of genes exhibiting a clear minimum in one of the three cell types in unrelated triplets, their minima were evenly distributed amongst the cell types. To quantify that the minima were evenly distributed, we counted the fraction of genes <italic>f<sub>i</sub></italic> which reached a clear minimum in cell type <italic>i = A, B, C</italic> (for A, B, and C unrelated cell types), and for each triplet, we computed the entropy <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. We compared the distribution of the entropy and the number of genes showing a minimum in any triplet for unrelated and related triplets (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3A</xref>). The unrelated triplets have higher entropy and typically more genes with a minimum level. This suggested that unrelated triplets show a distinct pattern from the related triplets.</p></sec><sec id="s2-2"><title id="head_4">Using patterns to infer lineages</title><p>Together, these observations suggested a strategy for inferring the lineage topology between three cell types: each gene showing the clear minimum pattern with a minimum expression level in a particular cell type increases to the probability that this cell type is not the root of the topology (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). We next developed a statistical machinery to systematically detect this pattern in gene expression data and to use the resulting sparse subset of genes to infer lineage relationships between three cell types at a time. We then used the inferred relationships between all sets of three cell types as constraints to determine the full developmental lineage tree.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.20488.008</object-id><label>Figure 2.</label><caption><title>Identification of topology and transition genes (showing clear minimum pattern) for each triplet of cell types.</title><p>(<bold>A</bold>) Schematic for the statistical inference of lineage topology for 3 cell types. Genes with a clear minimum pattern indicate which cell types that are not the root (see <xref ref-type="fig" rid="fig1">Figure 1C</xref>) and hence allow inference of the topological relationship. (<bold>B</bold>) Dot plot (each dot representing a gene) of the cell type that is most likely to have the minimum mean expression of each gene among CMP, ST and MPP as a function of the odds <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of that gene being a transition gene. Each gene votes against the topology whose root has the minimum mean among the three cell types, and this vote is weighted by the odds that the gene is a transition gene (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). Two groups of genes, labeled by their names, have high odds of being transition genes and thus cast a strong vote against CMP or MPP being the root.(<bold>C</bold>) The computed probability of the topology given gene expression data indicates 0.84 probability that ST is the intermediate type.(<bold>D</bold>) The plot of the probabilities of genes being transition genes for triplet ST/MPP/CMP, given gene expression data and that the topology is MPP – ST – CMP. The names of the 10 genes with the highest probability of being transition genes are shown. Probabilities are calculated assuming the prior odds <inline-formula><mml:math id="inf4"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> = 0.05 (see main text). There are two classes of transition genes: one for which gene expression in CMP is greater than expression in MPP (regular font), and another for which gene expression in MPP is greater than expression in CMP (bold font).(<bold>E</bold>) Plot of the replicates of ST, MPP and CMP in the gene-expression space of the two classes of transition genes (with probability &gt; 0.8). Plotted on each axis is the mean normalized log expression level of the transition genes in the class, each class is denoted in curly brackets by the name of the transition gene with the highest probability.(<bold>F</bold>) Dot plot for triplet MEP/GMP/FrBC of the cell type that is most likely to have the minimum mean expression as a function of the odds <inline-formula><mml:math id="inf5"><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of that gene being a transition gene.(<bold>G</bold>) The computed probability of the topology given gene expression data is the null hypothesis (p=0.99).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.008">http://dx.doi.org/10.7554/eLife.20488.008</ext-link></p><p><supplementary-material id="SD3-data"><object-id pub-id-type="doi">10.7554/eLife.20488.009</object-id><label>Figure 2—source data 1.</label><caption><title>Early hematopoietic cell types considered.</title><p>Listed for each early hematopoietic progenitor whose name is abbreviated in this paper are the Immunological Genome Project descriptor for the cell type, its common name and phenotype, its age and location, and the number of replicates in the data set.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.009">http://dx.doi.org/10.7554/eLife.20488.009</ext-link></p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-20488-fig2-data1-v1.docx"/></supplementary-material></p><p><supplementary-material id="SD4-data"><object-id pub-id-type="doi">10.7554/eLife.20488.010</object-id><label>Figure 2—source data 2.</label><caption><title>Probabilities of topologies for triplets of hematopoietic cell types.</title><p>Listed are, for each triplet of cell types, the probabilities of the four topologies for prior odds <inline-formula><mml:math id="inf6"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>; the number of topologies that reach probability <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for some value of <inline-formula><mml:math id="inf8"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> between 10<sup>−6</sup> and 10<sup>2</sup>; the non-null topology that has the highest probability <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> over the range of prior odds (if the null topology is the most likely topology for the entire range of prior odds, the topology is marked ‘null’); and the value of highest probability <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> over the range of prior odds; the correct topology and triplet length in the traditional model; and the correct topology and triplet length in the Adolfsson model.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.010">http://dx.doi.org/10.7554/eLife.20488.010</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-20488-fig2-data2-v1.xlsx"/></supplementary-material></p><p><supplementary-material id="SD5-data"><object-id pub-id-type="doi">10.7554/eLife.20488.011</object-id><label>Figure 2—source data 3.</label><caption><title>Probabilities of transition and marker genes for the hematopoietic lineage tree.</title><p>Listed are, for crucial triplets along the lineage tree, the 200 genes with the highest probabilities of belonging to the two transition gene classes and the root marker class, and their associated probabilities.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.011">http://dx.doi.org/10.7554/eLife.20488.011</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-20488-fig2-data3-v1.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20488-fig2-v1"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20488.012</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Probability of topology depends on prior odds.</title><p>(<bold>A</bold>) Two models of the hierarchy of early hematopoietic progenitors, both built based on prospective isolation of lineage restricted progenitors, include (left) the traditional model, in which the first split strictly separates myeloid and lymphoid lineages (<xref ref-type="bibr" rid="bib5">Akashi et al., 2000</xref>; <xref ref-type="bibr" rid="bib71">Kondo et al., 1997</xref>; <xref ref-type="bibr" rid="bib111">Reya et al., 2001</xref>) and (right) an alternative hierarchy proposed by Adolfsson and colleagues, in which lymphoid progenitors subsequent to the first split retain some myeloid potential (<xref ref-type="bibr" rid="bib2">Adolfsson et al., 2005</xref>). (<bold>B</bold>) The inferred probability of different topological configurations as a function of the prior odds of genes being transition genes. At low values of the prior odds, very few genes are given substantial votes in the inference procedure. The topology MPP-ST-CMP has high probability for a range of prior odds. (<bold>C</bold>) Genes with high probability of being marker genes for MPP (bold), CMP (plaintext), or ST (italics). (<bold>D</bold>) The triplet MEP, GMP, FrBC shows no significant probability of a non-null topology for a wide range of prior odds. In this case, our inference method makes no claim as to the topological configuration based on the gene expression evidence provided. (<bold>E</bold>) Histogram of the maximum inferred probability of a non-null topology for the 165 triplets of hematopoietic progenitors. (<bold>F</bold>) Projections of the early hematopoietic progenitors along first two principal components. (PC1: 30%; PC2: 17%). Each point represents a different replicate. Note the proximity between ETP and MPP samples (red circle), which does not reflect either of the lineage models shown in (<bold>A</bold>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.012">http://dx.doi.org/10.7554/eLife.20488.012</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20488-fig2-figsupp1-v1"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20488.013</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Plots of the length of the triplets distinguishing the traditional model and in the Adolfsson model.</title><p>Separate plots are shown for triplets whose inferred topology is consistent with only the Adolfsson model (<bold>A</bold>) and the traditional model (<bold>B</bold>) Triplets whose inferred topology is null are shown in turquoise; those whose inferred topology is non-null are shown in black. Jitter was added to the points for clarity.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.013">http://dx.doi.org/10.7554/eLife.20488.013</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20488-fig2-figsupp2-v1"/></fig></fig-group></p><p>The classifications of genes as transition or marker genes in <xref ref-type="fig" rid="fig1">Figure 1</xref> were based on p&lt;0.005 in a two-sample <italic>t</italic>-test. To implement such classifications probabilistically without arbitrary cutoffs we developed a statistical framework to infer the lineage relationships between each set of three cell types A, B, and C and find the key sets of transition genes (those genes that show the clear minimum pattern), given gene expression data <inline-formula><mml:math id="inf11"><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> in those cell types. We determined the probability of any possible topological relationship between the cell types <inline-formula><mml:math id="inf12"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>∅</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> referring to cell type A, B, or C being the root of the triplet, or <inline-formula><mml:math id="inf13"><mml:mrow><mml:mo>∅</mml:mo><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>which corresponds to the case where the data does not suggest any lineage relationship between the three cell types because either no significant pattern could be detected, or multiple genes exhibiting the minimum pattern suggested conflicting topologies. Rather than an absolute classification of genes as showing a pattern or not, we calculated the probability <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> of each gene <inline-formula><mml:math id="inf15"><mml:mi>i</mml:mi></mml:math></inline-formula> being a marker gene (denoted by <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), i.e. gene <inline-formula><mml:math id="inf17"><mml:mi>i</mml:mi></mml:math></inline-formula> showing the clear maximum pattern, and the probability <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> of it being a transition gene denoted by <inline-formula><mml:math id="inf19"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, i.e. gene <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>i</mml:mi><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> showing the clear minimum pattern (Materials and methods).</p><p>We derived the probability of a given topology <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> given the expression data as (Materials and methods):<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where, <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the odds of gene <inline-formula><mml:math id="inf23"><mml:mi>i</mml:mi></mml:math></inline-formula> being a transition gene and thus having a unique minimum. The term <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the probability that the mean <inline-formula><mml:math id="inf25"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> of the distribution of the expression levels of gene i in the root cell type <inline-formula><mml:math id="inf26"><mml:mi>T</mml:mi></mml:math></inline-formula> is less than the mean in the other two cell types. The odds implicitly contains the only free parameter in our analysis, the prior odds <inline-formula><mml:math id="inf27"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, which defines the number of genes we expect to show the clear minimum pattern <italic>a priori</italic>, and functions as a sparsity parameter for the inference. Qualitatively, in the above equation, every gene casts a vote <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> against the cell type <inline-formula><mml:math id="inf29"><mml:mi>T</mml:mi></mml:math></inline-formula> in which its mean expression is minimal being the root. Further, this vote is weighted by the odds <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of gene <inline-formula><mml:math id="inf31"><mml:mi>i</mml:mi></mml:math></inline-formula> being a transition gene. Thus, genes with a clearer minimum pattern get larger votes in determining which cell type is not the root. In practice, these quantities are computed numerically (Materials and methods).</p><p>We note further that if a substantial number of genes cast votes against each of the cell types, then the probability of the null topology <inline-formula><mml:math id="inf32"><mml:mo>∅</mml:mo></mml:math></inline-formula> increases. We computed the probability of obtaining the null topology among the 150 related triplets and 100 unrelated triplets from our training set. The distribution of the probability of obtaining the null topology was considerably different between the related triplets and the unrelated triplets, with an AUC of 0.96 (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3B–C</xref>).</p></sec><sec id="s2-3"><title id="head_5">Application to hematopoietic gene expression data</title><p>We used our statistical framework to recreate the lineage of early hematopoietic differentiation. We considered 11 early hematopoietic progenitors from the ImmGen Consortium microarray data set (<xref ref-type="bibr" rid="bib51">Heng et al., 2008</xref>) (<xref ref-type="supplementary-material" rid="SD3-data">Figure 2—source data 1</xref>). These cell types and their associated relationships were not included in the data set used earlier to study the correlations of the two patterns and lineage topologies. Several features of the early hematopoietic lineage tree are debated (<xref ref-type="bibr" rid="bib2">Adolfsson et al., 2005</xref>; <xref ref-type="bibr" rid="bib54">Iwasaki and Akashi, 2007</xref>) (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A</xref>). Given only the gene expression data for these different subpopulations of cells, we determined the lineage relationships and the key factors associated with each lineage decision. We calculated the probabilities of topology and marker and transition genes for the <inline-formula><mml:math id="inf33"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>3</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>165</mml:mn></mml:mrow></mml:math></inline-formula> possible triplets of cell types using our statistical framework (<xref ref-type="supplementary-material" rid="SD4-data">Figure 2—source data 2</xref>). To illustrate our method, we first described the analysis of the expression data from two such triplets of cell types: CMP/ST/MPP and MEP/GMP/FrBC (<xref ref-type="fig" rid="fig2">Figure 2B–G</xref>). We then assembled the triplets to form an undirected lineage tree (<xref ref-type="fig" rid="fig3">Figure 3</xref>; <xref ref-type="other" rid="media1">Video 1</xref>).<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.20488.014</object-id><label>Figure 3.</label><caption><title>Reconstruction of lineage tree and key transition gene for early hematopoiesis.</title><p>(<bold>A</bold>) Final lineage tree, recapitulating the inferred triplet topologies, with top inferred transition genes indicated along cell fate decisions. (<bold>B</bold>) Plot of the replicates of different cell types in the gene-expression space of the transition gene classes (probability &gt; 0.8) for 4 cell-fate transitions along the inferred lineage tree in (<bold>A</bold>). Plotted on each axis is the mean normalized log expression level of the transition genes in the class. The axis labels and data points are color-coded according to the colors in (<bold>A</bold>). (<bold>C</bold>) Table with selected transition genes for early hematopoietic cell-fate transitions, along with references to published validations of their functional role. Genes known to be effective for reprogramming are shown in bold.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.014">http://dx.doi.org/10.7554/eLife.20488.014</ext-link></p><p><supplementary-material id="SD6-data"><object-id pub-id-type="doi">10.7554/eLife.20488.015</object-id><label>Figure 3—source data 1.</label><caption><title>Marker genes for early hematopoiesis.</title><p>Table with selected marker genes for early hematopoietic cell types, along with references to published validations of their functional role. Genes known to be effective for reprogramming are shown in bold.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.015">http://dx.doi.org/10.7554/eLife.20488.015</ext-link></p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-20488-fig3-data1-v1.docx"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20488-fig3-v1"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20488.016</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Reconstruction of lineage tree from individual triplets.</title><p>(<bold>A–D</bold>) Probability of all topological configurations for a triplet as a function of prior odds for all triplets between 4 cell types: MPP, ST, LT, and CMP. (<bold>A</bold>) The LT-ST-MPP triplet, with p=0.99. (<bold>B</bold>) The CMP-ST-MPP triplet, with p=0.95. (<bold>C</bold>) The LT-ST-CMP triplet, with p=0.99. (<bold>D</bold>) The MPP-LT-CMP triplet, with p=0.65. Note that the next highest topology here is the null topology. (<bold>E</bold>) These four triplets can be combined to infer a simple relationship between all four cell types that is consistent with the topological restrictions inferred from each high probability triplet.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.016">http://dx.doi.org/10.7554/eLife.20488.016</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20488-fig3-figsupp1-v1"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20488.017</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Inferred lineage tree and transition genes for intestinal development.</title><p>(<bold>A</bold>) Inferred lineage tree from intestinal single cell data taken from (<xref ref-type="bibr" rid="bib47">Grün et al., 2015</xref>).Cluster identifications were taken from RaceID2 (<xref ref-type="bibr" rid="bib48">Grün et al., 2016</xref>), and a similar tree was inferred from StemID ([<xref ref-type="bibr" rid="bib48">Grün et al., 2016</xref>], not shown). Using 1369 transcription factors, we inferred these lineage relationships between all cell clusters with more than 10 cells per cluster. The tree differs from that in (<xref ref-type="bibr" rid="bib48">Grün et al., 2016</xref>) only in the progression from C<sub>2</sub> – C<sub>8</sub> – C<sub>4</sub>, while we infer the triplet C<sub>8</sub> – C<sub>2</sub> – C<sub>4</sub> with p&gt;0.99, both of which are consistent with literature (<xref ref-type="bibr" rid="bib139">van der Flier and Clevers, 2009</xref>), and await experimental validation. (<bold>B</bold>) High-probability transition genes with known relevance in intestinal homeostasis or differentiation taken from the top 20 transition genes for each lineage progression.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.017">http://dx.doi.org/10.7554/eLife.20488.017</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20488-fig3-figsupp2-v1"/></fig></fig-group><media content-type="glencoe play-in-place height-250 width-310" id="media1" mime-subtype="mp4" mimetype="video" xlink:href="elife-20488-media1.mp4"><object-id pub-id-type="doi">10.7554/eLife.20488.018</object-id><label>Video 1.</label><caption><title>Tree-building process for early hematopoietic lineage</title><p>Animation of the triplet assembly and pruning process for reconstructing the early hematopoietic lineage. For illustrative purposes, triplets (with p&gt;0.6) are successively selected at random (in practice, the assembly and pruning process was performed on all triplets simultaneously; the resulting tree does not depend on the order in which the triplets are selected). The nodes of the current triplet are highlighted in yellow; if a topology is recognized for the triplet, the root is shown in green and the leaves in yellow, and the triplet edges are shown in magenta. If adding the triplet causes another triplet to be pruned, the soon-to-be-pruned (i.e. offending) edge is highlighted in red. The resulting pruned graph is then shown before adding the next triplet. As more triplets are considered, more edges between nodes are added and then pruned, leading to the final tree.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.018">http://dx.doi.org/10.7554/eLife.20488.018</ext-link></p></caption></media></p><p>Following <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, each gene votes against the topology whose central node has the minimum expression of that gene among the three cell types, and this vote is weighted by the odds that the gene is a transition gene. To illustrate this for the triplet of cell types CMP, ST and MPP, we plotted the topology each gene voted most against, <italic>i.e.</italic> the topology <inline-formula><mml:math id="inf34"><mml:mi>T</mml:mi></mml:math></inline-formula> for which <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the maximum, versus the odds <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of that gene being a transition gene (<xref ref-type="fig" rid="fig2">Figure 2B</xref>).</p><p>We find two groups of genes that are much more likely to be transition genes than any of the other genes, with values of <inline-formula><mml:math id="inf37"><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> compared to <inline-formula><mml:math id="inf38"><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>0</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> at most for other genes (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, regular and bold fonts). These two groups of genes have a large value for either <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and thus vote against <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (cell type CMP is the intermediate) or against <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (cell type MPP is the intermediate). Together these genes that have a high odds of being transition genes appear to most support topology <inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow><mml:mo>≡</mml:mo><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>In fact, the intuition in <xref ref-type="fig" rid="fig2">Figure 2B</xref> is borne out in the calculation of <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Using <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> above and assuming a sparsity parameter of 0.05, we calculate that there is an 84% chance that the topology is <inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2C</xref>; <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B</xref>). Although gene <italic>Irf8</italic> (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, italic font) is strongly downregulated in ST and is expressed at higher levels in CMP and MPP (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), we note that its signal is overwhelmed by the large number of genes downregulated in either CMP or MPP, illustrating the statistical nature of the framework.</p><p>For each triplet, we evaluated each gene’s probability of being a transition or marker gene (<xref ref-type="supplementary-material" rid="SD5-data">Figure 2—source data 3</xref>). <xref ref-type="fig" rid="fig2">Figure 2D</xref> shows the names and associated probabilities of the 12 genes most likely to be transition genes for the triplet <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The transition genes fall into two groups, corresponding to the two groups in <xref ref-type="fig" rid="fig2">Figure 2B</xref>. One group, which includes genes <italic>Gata1</italic>, <italic>Dach1</italic>, and <italic>Gata2</italic>, has higher expression in CMP than in MPP; the other group, which includes <italic>Hlf</italic>, <italic>Tsc22d1</italic>, and <italic>Hoxa9</italic>, has higher expression in MPP. Although the values of the probabilities of the genes being transition genes vary with the value of the sparsity parameter, the relative order of different genes does not change. The genes identified include many genes previously identified as being important for lineage specification (<xref ref-type="bibr" rid="bib23">Crispino, 2005</xref>; <xref ref-type="bibr" rid="bib41">Gazit et al., 2013</xref>; <xref ref-type="bibr" rid="bib92">Miyawaki et al., 2015</xref>). The transition genes we discovered thus not only have gene expression patterns that reflect the lineage decision but also include functionally important genes.</p><p>In addition to the transition genes, we identified marker genes (<inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) present only in ST (including <italic>Mpl</italic> and <italic>Rai14</italic>, consistent with [<xref ref-type="bibr" rid="bib121">Solar et al., 1998</xref>]) and then symmetrically downregulated in both CMP and MPP (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>). Marker genes for CMP include <italic>Srf</italic>, <italic>Zeb2</italic>, <italic>Rbpj</italic> and <italic>Irf8</italic> (consistent with [<xref ref-type="bibr" rid="bib43">Goossens et al., 2011</xref>; <xref ref-type="bibr" rid="bib74">Kurotaki et al., 2013</xref>; <xref ref-type="bibr" rid="bib109">Ragu et al., 2010</xref>; <xref ref-type="bibr" rid="bib113">Robert-Moreno et al., 2005</xref>; <xref ref-type="bibr" rid="bib127">Tamura et al., 2000</xref>]); marker genes for MPP include <italic>Satb1</italic>, consistent with (<xref ref-type="bibr" rid="bib116">Satoh et al., 2013</xref>). Although these genes were not used to determine the topology, they are good markers for cell types ST, CMP and MPP.</p><p>Plotting the cell types using the mean expression levels of the two transition gene class captures the fork in the gene expression space associated with the cell-fate decision (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). In contrast with the PCA analysis of the cell types (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1E</xref>), in which MPP appears to be an intermediate between the hematopoietic stem cell types (LT and ST) and CMP, the projection of the cell types onto the transition-gene subspace shows that ST splits into CMP and MPP.</p><p>In contrast to the case of the triplet of cell types CMP/ST/MPP, for triplet MEP/GMP/FrBC, the distributions of genes supporting different topologies are similar (<xref ref-type="fig" rid="fig2">Figure 2F</xref>). Thus the most likely topology calculated using <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> is the null hypothesis (99%), which is that transition genes, if they exist, do not have patterns that depend on the cellular topology (<xref ref-type="fig" rid="fig2">Figure 2G</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1D</xref>), in which case there is insufficient evidence to classify the triplet according to a particular non-null topology. The distribution of the maximal probability of non-null topologies in the different triplets is heavily concentrated near 1, allowing for clear separation between null and non-null triplets (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1E</xref>). Null topologies were identified by the algorithm for triplets with cells that are from three terminal nodes (for example, the triplet MEP/GMP/FrBC) or from triplets that contain very distantly related triplets (for example, LT/CLP/ETP) (<xref ref-type="supplementary-material" rid="SD4-data">Figure 2—source data 2</xref>).</p></sec><sec id="s2-4"><title id="head_6">A lineage tree for early hematopoiesis</title><p>We next reconstructed the early hematopoietic lineage tree and identified transition genes involved in the different cell state transitions using all the non-null triplet relationships as constraints on the lineage relationships between all cell types. Out of the 165 possible triplets of hematopoietic progenitors, 144 showed one single non-null topology with probability greater than 0.6 over a range of the prior odds from 10<sup>−6</sup> to 10<sup>2</sup>. We next determined an undirected graph that recapitulates all of the individual triplet topologies (note that we are only inferring triplet topologies and are not inferring directionality). For example, although triplet CMP/LT/MPP has topology CMP – <bold>LT</bold> – MPP (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A</xref>), we could determine that LT cannot be the <italic>direct</italic> progenitor of CMP or MPP, because ST is an intermediate between LT and both cell types (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B–C</xref>). We could thus 'prune' this triplet when inferring the full graph (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1D–E</xref>). A visualization of the pruning process is shown in <xref ref-type="other" rid="media1">Video 1</xref>, where successive triplets are added to the graph, creating new edges and pruning others, leading to the final undirected tree. In practice, though, the pruning process was performed on all triplets simultaneously, not in succession.</p><p>The ST/CMP/MPP triplet (<xref ref-type="fig" rid="fig2">Figure 2B–E</xref>) immediately distinguishes between two competing models regarding the hierarchy of early hematopoietic progenitors. According to the traditional picture (<xref ref-type="bibr" rid="bib54">Iwasaki and Akashi, 2007</xref>), MPP is the progenitor of CMP, and ST is the progenitor of MPP – therefore MPP should be an intermediate between ST and CMP and the topology of triplet ST/MPP/CMP should be ST – <bold>MPP</bold> – CMP (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>, left). According to a model suggested by Adolfsson and colleagues (<xref ref-type="bibr" rid="bib2">Adolfsson et al., 2005</xref>), ST splits into CMP and MPP (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>, right), and the topology should be CMP – <bold>ST</bold> – MPP. We identify both CMP – <bold>ST</bold> – MPP and CMP – <bold>LT</bold> – MPP as the correct topologies, lending support to the Adolfsson model. The Adolfsson and traditional models differ in the topology of 9 triplets. The inferred expected topologies of 8 out of these nine triplets support the Adolfsson model, which led to the identification of the final tree (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p><p>The lineage tree that we determined is consistent with the Adolfsson model and contains three additional lineage decisions (<xref ref-type="fig" rid="fig3">Figure 3A–B</xref>). First, CMP gives rise to MEP (megakaryocyte/erythroid progenitor) and GMP (granulocyte/macrophage progenitor). Second, MPP gives rise to MLP (multilineage progenitor), which then splits into the GMP and CLP (common lymphoid progenitor) cell types. In the final lineage decision, CLP gives rise to the ETP (pre-T) and FrA (pre-pro-B) cell types.</p><p>For each triplet of cell types along the tree, we identified transition and marker classes of genes. Among the 14 triplets that contained only adjacent cell types, we identified on average 24 marker genes per cell type and 25 transition genes (probability threshold of 0.8, prior odds <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). Many genes we discovered as belonging with high probability to the transition and marker classes of genes at each lineage decision are known in the literature to be functionally important genes, including classic hematopoietic regulators such as <italic>Cebpa</italic>, <italic>Sfpi1</italic>, <italic>Gata1</italic>, <italic>Satb1</italic>, <italic>Irf8</italic> and <italic>Ebf1</italic> (see full tables with references in <xref ref-type="fig" rid="fig3">Figure 3C</xref> and <xref ref-type="supplementary-material" rid="SD6-data">Figure 3—source data 1</xref>). Additionally, the genes identified include many genes successfully used in hematopoietic reprogramming experiments, including <italic>Gata2</italic> and <italic>Pbx1</italic> (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Together these observations suggest that the sparse subspace of transition and marker genes identified by our framework not only allows for accurate reconstruction of the lineage hierarchy but also constitutes a set of candidates for relevant biological functions.</p><p>As further validation of the inference method, we compared it to the method proposed by Grun et al. on a single-cell intestinal development data set (<xref ref-type="bibr" rid="bib47">Grün et al., 2015</xref>, <xref ref-type="bibr" rid="bib48">2016</xref>). We inferred lineages between each cell type based on their cluster identifications, excluding clusters with fewer than 10 cells, and constructed an undirected lineage tree by taking triplets with probability &gt; 0.6 and applying the pruning rule (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2A</xref>). The only disagreement between the two methods is the progression from crypt base columnar cells (C<sub>2</sub>) to different populations of Goblet cells (C<sub>4</sub> and C<sub>8</sub>). Grun et al. hypothesize a C<sub>2</sub> – C<sub>8</sub> – C<sub>4</sub> progression, while we infer the triplet C<sub>8</sub> – C<sub>2</sub> – C<sub>4</sub> with p&gt;0.99, suggesting that the progenitor C<sub>2</sub> gives rise to both differentiated Goblet subpopulations. Both lineage trees are supported by the literature (<xref ref-type="bibr" rid="bib139">van der Flier and Clevers, 2009</xref>). The high probability transition genes included many factors well known for their roles in tissue homeostasis and development (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2B</xref>), notably <italic>Klf4</italic> (<xref ref-type="bibr" rid="bib157">Yu et al., 2012</xref>), <italic>Atoh1</italic> (<xref ref-type="bibr" rid="bib142">VanDussen and Samuelson, 2010</xref>), <italic>Spdef</italic> (<xref ref-type="bibr" rid="bib96">Noah et al., 2010</xref>), <italic>Foxa1/Foxa2</italic> (<xref ref-type="bibr" rid="bib155">Ye and Kaestner, 2009</xref>), and <italic>Tcf3</italic> (<xref ref-type="bibr" rid="bib88">Merrill et al., 2001</xref>).</p></sec><sec id="s2-5"><title id="head_7">Inferred lineage tree for human excitatory neuronal progenitors from in vitro single-cell data over 80 days of differentiation</title><p>The ease with which single-cell transcriptomic data can be generated (<xref ref-type="bibr" rid="bib47">Grün et al., 2015</xref>; <xref ref-type="bibr" rid="bib57">Jaitin et al., 2014</xref>; <xref ref-type="bibr" rid="bib80">Macosko et al., 2015</xref>; <xref ref-type="bibr" rid="bib101">Patel et al., 2014</xref>; <xref ref-type="bibr" rid="bib102">Paul et al., 2015</xref>; <xref ref-type="bibr" rid="bib136">Treutlein et al., 2014</xref>; <xref ref-type="bibr" rid="bib158">Zeisel et al., 2015</xref>) presents an opportunity to understand the dynamics of the underlying networks that lead individual cells to their final fate. We studied the differentiation of stem cells both into germ layer progenitors (<xref ref-type="bibr" rid="bib58">Jang et al., 2017</xref>) and into cortical neurons. To study the latter, we analyzed single-cell gene expression data from 2217 cells from an in vitro differentiation protocol for early human neuronal development (<xref ref-type="bibr" rid="bib154">Yao et al., 2017</xref>). Briefly, human embryonic stem cells (hESCs) were subjected to a SMAD inhibition-based cortical induction phase, a progenitor expansion phase, and a neural differentiation phase. Single cells were sorted at 12, 26, 54, and 80 days into differentiation, and their gene expression was profiled using the SMART-Seq2 technique (<xref ref-type="bibr" rid="bib104">Picelli et al., 2013</xref>). In the initial clustering of the single-cell data, dimensionality reduction by PCA (into 15 above-noise components) followed by t-SNE (<xref ref-type="bibr" rid="bib140">Van Der Maaten and Hinton, 2008</xref>; <xref ref-type="bibr" rid="bib115">Satija et al., 2015</xref>) showed separation by day and <italic>SOX2</italic> expression (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). However, the number of predicted clusters varied depending on the perplexity parameter (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A–B</xref>). In addition, no clear lineage or distance relationship among the putative types is immediately apparent from this clustering. Analysis of this data with other recent methods such as Monocle and Monocle2 (<xref ref-type="bibr" rid="bib134">Trapnell et al., 2014</xref>), TSCAN (<xref ref-type="bibr" rid="bib61">Ji and Ji, 2016</xref>), and StemID (<xref ref-type="bibr" rid="bib48">Grün et al., 2016</xref>) did not clearly reconstruct lineage or infer key genes regulating transitions (<xref ref-type="fig" rid="fig4">Figure 4A</xref> – Bottom, <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). Monocle2 (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2A</xref>) produces a tree with complex branching, but <italic>SOX2</italic>+ progenitors and <italic>DCX</italic>+ differentiated neurons do not clearly separate.<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.20488.019</object-id><label>Figure 4.</label><caption><title>Inference of lineage tree and key transitions genes using single cell expression data from in vitro differentiated developing human brain. </title><p>(<bold>A</bold>) RNA-seq data from single cells collected at days 12, 26, 54, and 80 from a human brain in vitro differentiation protocol (<xref ref-type="bibr" rid="bib154">Yao et al., 2017</xref>) were analyzed using a variety of existing methods. Partitioning single-cells into cell types through non-linear dimensionality reduction using t-SNE (top) depends on the perplexity parameter (set here to 5, see <xref ref-type="fig" rid="fig1s1">Figure 4 – Figure Supplement 1A-B</xref>) and does not allow for mechanistic understanding. Independent component analysis of all transcription factors with Monocle (bottom) does not show clear structure and could not inform reconstruction of lineage relationships. (<bold>B</bold>) Maximization algorithm to determine most likely cluster identities <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mtext>c</mml:mtext><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext>c</mml:mtext><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mtext>c</mml:mtext><mml:mrow><mml:mtext>n</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, sets of transitions <inline-formula><mml:math id="inf50"><mml:mrow><mml:mo>{</mml:mo><mml:mtext>T</mml:mtext><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, marker genes (<inline-formula><mml:math id="inf51"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) and transition genes (<inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), given single-cell gene expression data <inline-formula><mml:math id="inf53"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Starting from a seed clustering scheme <inline-formula><mml:math id="inf54"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>iterative maximization of the conditional probabilities <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtext>T</mml:mtext><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtext>T</mml:mtext><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> converges to most likely set <inline-formula><mml:math id="inf57"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mi>C</mml:mi> <mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mtext>T</mml:mtext> <mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<bold>C</bold>) Cell-cell covariance matrix between cells using only the associated high probability marker and transition genes show the final cluster assignments <inline-formula><mml:math id="inf58"><mml:mrow><mml:msub><mml:mtext>c</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf59"><mml:mrow><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (right) in contrast to using all transcription factors (left). (<bold>D</bold>) Selected high probability triplets of clusters plotted in the axes defined by two sets of transition gene classes for each triplet. <inline-formula><mml:math id="inf60"><mml:mrow><mml:msub><mml:mtext>c</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>(top right, <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.99</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), plotted in transition gene class {<italic>CEBPG</italic>} also including <italic>POU3F1, POU3F2, NR2F1, NR2F2, ARX, LIN28A, TOX3, ZBTB20, PROX1</italic> and <italic>SOX15</italic>, and class {<italic>DMRTA1</italic>} also including <italic>HES1, HES5, FOXG1, PAX6, HMGA2, SOX2, SOX3, SOX9, SOX6, SP8, OTX2, TGIF, ID4, TCF7L2</italic>, and <italic>TCFL1</italic>. <inline-formula><mml:math id="inf62"><mml:mrow><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (top left, <inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.96</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), plotted in transition gene class {<italic>LHX2</italic>} also including <italic>FEZF2, FOXG1, HMGA1, SP8, OTX1, SOX11, GLI3, SIX3, ETV5</italic>, and class {<italic>POU3F2</italic>} also including <italic>GTF2I, HIF1A, ID1, ID3, PROX1, SALL1, SOX21, TCF12, TRPS1, ZHX2</italic>.<inline-formula><mml:math id="inf64"><mml:mrow><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (bottom left, <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), plotted in transition gene class {<italic>FOXO1</italic>} also including <italic>HMGA2, PAX6</italic>, and <italic>SOX2</italic>, and class {<italic>LHX2</italic>} also including <italic>DMRTA2, HMGA1, ARX, LIN28A, OTX2, LITAF, NANOG, POU3F1, SOX15</italic>. <inline-formula><mml:math id="inf66"><mml:mrow><mml:msub><mml:mtext>c</mml:mtext><mml:mn>6</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>5</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (bottom right, <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), plotted in transition gene class {<italic>PAX3</italic>} also including <italic>CRX, SOX11, EBF2, FOXP4, ASCL1, FOXO3</italic>, and <italic>SIX3</italic>, and class {<italic>ARGFX</italic>} also including <italic>DUXA, HES1, NFIB, PPARA, SOX2, SOX7</italic>, and <italic>SOX9</italic>. (<bold>E</bold>) Correlations between differentiated cell clusters (Figure 4 – Figure Supplement 4D) and bulk population samples from brain regions (<italic>in vivo</italic> developmental human data) (<xref ref-type="bibr" rid="bib89">Miller et al., 2014</xref>). Neuronal cell types can be identified with specific spatial regions of the brain to interpret the topology of the lineage tree. Expression signatures of <italic>SOX2</italic>+ cell types <inline-formula><mml:math id="inf68"><mml:mrow><mml:msub><mml:mtext>c</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf69"><mml:mrow><mml:msub><mml:mrow><mml:mtext> c</mml:mtext></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> were dominated by pluripotency factors, and are not shown. (<bold>F</bold>) Inferred lineage tree for brain development. Genes associated with neocortical development, and mid-/hind-brain progenitors, and specific neuronal cell types are identified as high probability transition genes and are corroborated by mapping information from in vivo data. Clusters color-coded similarly to (<bold>D</bold>). D12/26/54/80 labels indicate time of collection of cells within each cell type. Prog refers to <italic>SOX2</italic>+ cells, Diff refers to <italic>SOX2</italic>-/<italic>DCX</italic>+ cells (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1C–D</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.019">http://dx.doi.org/10.7554/eLife.20488.019</ext-link></p><p><supplementary-material id="SD7-data"><object-id pub-id-type="doi">10.7554/eLife.20488.020</object-id><label>Figure 4—source data 1.</label><caption><title>Final cluster identities of single cells from in vitro cortical differentiation.</title><p>Cells were assigned to a cluster based on an iterative clustering procedure. Their final cluster assignments are shown here. Cell types 8–11 contained bulk brain control cells, and non-neuronal cells which were excluded from the analysis.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.020">http://dx.doi.org/10.7554/eLife.20488.020</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-20488-fig4-data1-v1.xlsx"/></supplementary-material></p><p><supplementary-material id="SD8-data"><object-id pub-id-type="doi">10.7554/eLife.20488.021</object-id><label>Figure 4—source data 2.</label><caption><title>Probabilities of topologies for triplets of single-cell clusters.</title><p>Listed are, for each triplet of clusters, the probability of a given topology and the root of the inferred topology. ‘0’ refers to the null topology. Triplets with p&gt;0.6 were used to construct the lineage tree.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.021">http://dx.doi.org/10.7554/eLife.20488.021</ext-link></p></caption><media mime-subtype="excel" mimetype="application" xlink:href="elife-20488-fig4-data2-v1.xls"/></supplementary-material></p><p><supplementary-material id="SD9-data"><object-id pub-id-type="doi">10.7554/eLife.20488.022</object-id><label>Figure 4—source data 3.</label><caption><title>Probabilities of Transition and Marker Genes for the Human Brain Developmental Lineage Tree.</title><p>Listed are, for crucial triplets along the lineage tree, the genes with the p&gt;0.8 of belonging to the two transition gene classes and the root marker class, and their associated probabilities.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.022">http://dx.doi.org/10.7554/eLife.20488.022</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-20488-fig4-data3-v1.xlsx"/></supplementary-material></p><p><supplementary-material id="SD10-data"><object-id pub-id-type="doi">10.7554/eLife.20488.023</object-id><label>Figure 4—source data 4.</label><caption><title>Human Brain Development SmartSeq2 Census.</title><p>Further detail can be found Materials and methods and in <xref ref-type="bibr" rid="bib154">Yao et al. (2017)</xref> (Supplemental Information).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.023">http://dx.doi.org/10.7554/eLife.20488.023</ext-link></p></caption><media mime-subtype="excel" mimetype="application" xlink:href="elife-20488-fig4-data4-v1.xls"/></supplementary-material></p><p><supplementary-material id="SD11-data"><object-id pub-id-type="doi">10.7554/eLife.20488.024</object-id><label>Figure 4—source data 5.</label><caption><title>List of Human Transcription Factors.</title><p>List of human transcription factors used to cluster and infer lineages for the cortical differentiation tree. List was adapted from (<xref ref-type="bibr" rid="bib13">Ben-Porath et al., 2008</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.024">http://dx.doi.org/10.7554/eLife.20488.024</ext-link></p></caption><media mime-subtype="excel" mimetype="application" xlink:href="elife-20488-fig4-data5-v1.xls"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20488-fig4-v1"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20488.025</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Cluster identity and sparse coding in neuronal differentiation.</title><p>(<bold>A</bold>–<bold>B</bold>) t-SNE of developing neuronal cells displays seemingly different number of cell types depending on the perplexity parameter.(<bold>C</bold>) <italic>SOX2</italic> expression clearly falls into bimodal distribution. Cell types with high levels of <italic>SOX2</italic> (blue, <inline-formula><mml:math id="inf70"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) are labeled progenitor cell populations. (<bold>D</bold>) <italic>DCX</italic> expression in final clusters is also bimodal, and cell types with high expression (green, <inline-formula><mml:math id="inf72"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf73"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) are labeled differentiated (post-mitotic) neurons. (<bold>E</bold>) We assembled 20 triplets that were inferred to be non-null, and had a maximal distance between leaf nodes of less than 5. Amongst these triplets, we attempted to infer the correct topology using a minimal subset of genes. Restricting the inference to the N genes per triplet with the greatest odds ratio of being transition genes, the tree can be reconstructed accurately for any N ≥ 4.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.025">http://dx.doi.org/10.7554/eLife.20488.025</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20488-fig4-figsupp1-v1"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.20488.026</object-id><label>Figure 4—figure supplement 2.</label><caption><title>A selection of recent lineage-determination methods for single cell transcriptomic analysis applied to an in vitro neuronal differentiation data set (<xref ref-type="bibr" rid="bib154">Yao et al., 2017</xref>).</title><p>Each of these methods was run with multiple sets of parameters in an attempt to optimize the lineage inference; however, it is possible that an unexplored parameter regime might yield more interpretable results, although it is unclear which parameters these might be. (<bold>A</bold>) Monocle2 (<xref ref-type="bibr" rid="bib134">Trapnell et al., 2014</xref>) shows a complex tree with clear progression and multiple branches, but does not separate progenitor cells (<italic>DCX</italic>- cells) from neurons (<italic>DCX</italic>+ cells): progenitor cells are known to give rise to neurons, whereas neurons are post-mitotic and do not give rise to progenitors, in contradiction with certain portions of the tree. In addition, portions of the tree are in conflict with the general time point information specifying when cells were collected (<xref ref-type="bibr" rid="bib154">Yao et al., 2017</xref>). (<bold>B</bold>) TSCAN (<xref ref-type="bibr" rid="bib61">Ji and Ji, 2016</xref>) shows separation of <italic>DCX</italic>- and <italic>DCX</italic>+ cells along PC dimension 2 (note that cells are not labeled by <italic>DCX</italic> expression in this plot), but fails to capture structure among the differentiated neurons, particularly a fore-/hind-brain split. (<bold>C</bold>). StemID (<xref ref-type="bibr" rid="bib48">Grün et al., 2016</xref>) produces a complex lineage that is not directly interpretable, and no clear separation of progenitors from neurons or forebrain-like from mid/hindbrain-like neurons is apparent.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.20488.026">http://dx.doi.org/10.7554/eLife.20488.026</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-20488-fig4-figsupp2-v1"/></fig></fig-group></p><p>Analyzing data from single-cell profiling presents an additional challenge relative to data from population-level profiling because cell types are not previously known and must be inferred from the data. Computationally, it is necessary define a measure of similarity in the gene expression profiles of individual cells so as to be able to cluster them and define cell states. Here again, it is necessary to identify the correct gene subspace to use for clustering. Clustering and determining lineage have typically been performed sequentially and treated as independent problems (<xref ref-type="bibr" rid="bib115">Satija et al., 2015</xref>; <xref ref-type="bibr" rid="bib135">Trapnell, 2015</xref>; <xref ref-type="bibr" rid="bib134">Trapnell et al., 2014</xref>). However, we found that it is informative to solve both these problems simultaneously.</p><p>In our framework, the relevant feature set for clustering is the set of marker and transition transcription factors from the triplets with non-null topologies. But determination of these sets of genes and of the transition topologies depends itself on knowledge of the cluster identities. Following previous work on sparse clustering (<xref ref-type="bibr" rid="bib150">Witten and Tibshirani, 2010</xref>), we simultaneously determined optimal clusters, lineage topology and sets of transition and marker genes by iteratively selecting transition and marker genes and clustering the data using this set of features (<xref ref-type="fig" rid="fig4">Figure 4B</xref>).</p><p>In order to utilize information about developmental distances in clustering, we iteratively maximized a joint distribution, <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, over the developmental tree, <inline-formula><mml:math id="inf75"><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> and the set of clusters of cells, <inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). Starting with a clustering <inline-formula><mml:math id="inf77"><mml:mrow><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> we first inferred the set of genes <inline-formula><mml:math id="inf78"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> which were identified in high probability triplets, <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, and we then re-clustered in this new subspace to obtain the clusters for the next iteration <inline-formula><mml:math id="inf81"><mml:mrow><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p><p>Initial analysis based on the gap statistic (<xref ref-type="bibr" rid="bib131">Tibshirani et al., 2001</xref>) suggested that the single-cell gene expression profiles clustered into 20 clusters of cell types. We chose a seed <inline-formula><mml:math id="inf82"><mml:mrow><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> for the iterated clustering procedure by intentionally over-clustering the data into 40 clusters using spectral K-medoids. By being overly discriminative in our initial clustering, we ensured that all genes with differential regulation would be classified as either marker genes or transition genes, and would be preserved in later clustering iterations. We iterated the clustering-inference procedure until the dimension of the re-clustering subspace changed by less than 10% of the total transcription factor space. In this resulting subspace of 469 genes, we finally clustered the cells into the final configuration <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> using K-medoids (<xref ref-type="fig" rid="fig4">Figure 4C</xref>, <xref ref-type="supplementary-material" rid="SD7-data">Figure 4—source data 1</xref>) where the number of clusters K = 8 was chosen based on the gap statistic (<xref ref-type="bibr" rid="bib131">Tibshirani et al., 2001</xref>).</p><p>We inferred 45 high probability triplets (<inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) between the final cell clusters (<xref ref-type="supplementary-material" rid="SD8-data">Figure 4—source data 2</xref>). Four such triplets are shown in <xref ref-type="fig" rid="fig4">Figure 4D</xref>, plotted in axes defined by transition genes for each triplet (<xref ref-type="supplementary-material" rid="SD9-data">Figure 4—source data 3</xref>). Starting with progenitor cell states (<italic>SOX2</italic>+, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1C</xref>), we manually appended cell clusters to the tree according to their time information and in agreement with inferred topological restrictions. The first transition involves the production of day 12 neuronal cell type <inline-formula><mml:math id="inf85"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> from day 12 progenitor <inline-formula><mml:math id="inf86"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, which is observed in the triplets <inline-formula><mml:math id="inf87"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf88"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. The <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> triplet (<inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.99</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="fig" rid="fig4">Figure 4D</xref> – top left) is mediated by 47 transition genes between <inline-formula><mml:math id="inf91"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf92"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and 87 between <inline-formula><mml:math id="inf93"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf94"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). Transition genes expressed highly in the <inline-formula><mml:math id="inf96"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> branch include <italic>CEBPG, POU3F1, POU3F2, NR2F1, NR2F2, ARX, LIN28A, TOX3, ZBTB20, PROX1</italic>, and <italic>SOX15</italic> which have been previously implicated in proliferation of forebrain progenitors (<xref ref-type="bibr" rid="bib9">Au et al., 2013</xref>; <xref ref-type="bibr" rid="bib15">Borello et al., 2014</xref>; <xref ref-type="bibr" rid="bib21">Cimadamore et al., 2013</xref>; <xref ref-type="bibr" rid="bib28">Dominguez et al., 2013</xref>; <xref ref-type="bibr" rid="bib153">Yang et al., 2015</xref>) and the migratory behaviors of ganglionic eminences (<xref ref-type="bibr" rid="bib64">Kanatani et al., 2008</xref>; <xref ref-type="bibr" rid="bib66">Kessaris et al., 2014</xref>; <xref ref-type="bibr" rid="bib78">Lodato et al., 2014</xref>; <xref ref-type="bibr" rid="bib99">Olivetti and Noebels, 2012</xref>; <xref ref-type="bibr" rid="bib110">Reinchisi et al., 2012</xref>). The <inline-formula><mml:math id="inf97"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> transition genes include <italic>DMRTA1, HES1, HES5, FOXG1, PAX6, HMGA2, SOX2, SOX3, SOX9, SOX6, SP8, OTX2, TGIF, ID4, SOX3, TCF7L2</italic>, and <italic>TCFL1</italic> which are known to be expressed in forebrain progenitors of the developing neocortex, thalamus, and hypothalamus (<xref ref-type="bibr" rid="bib1">Abraham et al., 2013</xref>; <xref ref-type="bibr" rid="bib106">Pozniak et al., 2010</xref>; <xref ref-type="bibr" rid="bib119">Shimojo et al., 2011</xref>; <xref ref-type="bibr" rid="bib137">Tzeng and de Vellis, 1998</xref>; <xref ref-type="bibr" rid="bib147">Wang et al., 2006</xref>), and are known to establish dorsal forebrain regional identity; (<xref ref-type="bibr" rid="bib10">Azim et al., 2009</xref>; <xref ref-type="bibr" rid="bib11">Bani-Yaghoub et al., 2006</xref>; <xref ref-type="bibr" rid="bib15">Borello et al., 2014</xref>; <xref ref-type="bibr" rid="bib40">Gaston-Massuet et al., 2016</xref>; <xref ref-type="bibr" rid="bib49">Hagey et al., 2014</xref>; <xref ref-type="bibr" rid="bib52">Hutton and Pevny, 2011</xref>; <xref ref-type="bibr" rid="bib62">Johansson et al., 2013</xref>; <xref ref-type="bibr" rid="bib68">Kikkawa et al., 2013</xref>; <xref ref-type="bibr" rid="bib69">Kishi et al., 2012</xref>; <xref ref-type="bibr" rid="bib82">Manuel et al., 2011</xref>; <xref ref-type="bibr" rid="bib93">Miyoshi and Fishell, 2012</xref>; <xref ref-type="bibr" rid="bib98">Ohtsuka et al., 2001</xref>; <xref ref-type="bibr" rid="bib114">Ross et al., 2003</xref>; <xref ref-type="bibr" rid="bib118">Shen and Walsh, 2005</xref>; <xref ref-type="bibr" rid="bib125">Sur and Rubenstein, 2005</xref>; <xref ref-type="bibr" rid="bib153">Yang et al., 2015</xref>; <xref ref-type="bibr" rid="bib159">Zembrzycki et al., 2007</xref>).</p><p>The progenitor cell types form the triplet <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.96</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="fig" rid="fig4">Figure 4D</xref> – top right). The <inline-formula><mml:math id="inf99"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> branch is mediated by 39 transition genes including <italic>LHX2, FEZF2, FOXG1, HMGA1, SP8, OTX1, SOX11, GLI3, SIX3</italic>, and <italic>ETV5</italic> which suggest that <inline-formula><mml:math id="inf100"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is comprised of cortical progenitors (<xref ref-type="bibr" rid="bib8">Appolloni et al., 2008</xref>; <xref ref-type="bibr" rid="bib45">Greig et al., 2013</xref>; <xref ref-type="bibr" rid="bib69">Kishi et al., 2012</xref>; <xref ref-type="bibr" rid="bib82">Manuel et al., 2011</xref>; <xref ref-type="bibr" rid="bib108">Raciti et al., 2013</xref>). The <inline-formula><mml:math id="inf101"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> branch is mediated by 55 transition genes including <italic>GTF2I, HIF1A, ID1, ID3, PROX1, POU3F2, SALL1, SOX21 TCF12, TRPS1</italic> and <italic>ZHX2</italic>, which are associated with mesencephalon and metencephalon regional development, as well as having known involvement with midbrain/hindbrain organizer identity (<xref ref-type="bibr" rid="bib17">Buck et al., 2001</xref>; <xref ref-type="bibr" rid="bib33">Enkhmandakh et al., 2009</xref>; <xref ref-type="bibr" rid="bib53">Inoue et al., 2012</xref>; <xref ref-type="bibr" rid="bib56">Jaegle et al., 2003</xref>; <xref ref-type="bibr" rid="bib73">Kunath et al., 2002</xref>; <xref ref-type="bibr" rid="bib76">Lavado and Oliver, 2007</xref>; <xref ref-type="bibr" rid="bib91">Milosevic et al., 2007</xref>; <xref ref-type="bibr" rid="bib97">Ohba et al., 2004</xref>; <xref ref-type="bibr" rid="bib138">Uittenbogaard and Chiaramello, 2002</xref>; <xref ref-type="bibr" rid="bib154">Yao et al., 2017</xref>). We additionally inferred the triplet <inline-formula><mml:math id="inf102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.99</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="fig" rid="fig4">Figure 4D</xref> – bottom left), which suggests a three way split from early progenitor <inline-formula><mml:math id="inf103"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> into early differentiated neuron <inline-formula><mml:math id="inf104"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and progenitors <inline-formula><mml:math id="inf105"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf106"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>The continuation of the <inline-formula><mml:math id="inf107"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> branch is inferred through triplet <inline-formula><mml:math id="inf108"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf109"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.97</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). The <inline-formula><mml:math id="inf110"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> branch includes transition genes <italic>BCL11A, EMX2, FOXP2</italic> and <italic>RORB</italic>, which are known to be associated with the neocortex and neuronal identity (<xref ref-type="bibr" rid="bib24">Cánovas et al., 2015</xref>; <xref ref-type="bibr" rid="bib31">Ebisu et al., 2016</xref>; <xref ref-type="bibr" rid="bib46">Greig et al., 2016</xref>; <xref ref-type="bibr" rid="bib55">Jabaudon et al., 2012</xref>; <xref ref-type="bibr" rid="bib148">Wiegreffe et al., 2015</xref>; <xref ref-type="bibr" rid="bib151">Woodworth et al., 2016</xref>; <xref ref-type="bibr" rid="bib159">Zembrzycki et al., 2007</xref>).The triplet <inline-formula><mml:math id="inf111"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf112"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.99</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) meanwhile is characterized by transition genes in the <inline-formula><mml:math id="inf113"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> branch including <italic>ASCL1, FOXP2, PAX3, POU3F4, ZIC1, ZIC4, HOXB2</italic>, and <italic>EN2</italic>, which have been shown to regulate fate acquisition in the midbrain/hindbrain (<xref ref-type="bibr" rid="bib4">Agoston et al., 2012</xref>; <xref ref-type="bibr" rid="bib7">Ang, 2006</xref>; <xref ref-type="bibr" rid="bib27">Di Bonito et al., 2013</xref>; <xref ref-type="bibr" rid="bib32">Elsen et al., 2008</xref>; <xref ref-type="bibr" rid="bib50">Hegarty et al., 2013</xref>; <xref ref-type="bibr" rid="bib90">Miller et al., 2011</xref>; <xref ref-type="bibr" rid="bib128">Tan et al., 2014</xref>).</p><p>The <inline-formula><mml:math id="inf114"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> cell cluster differentiates into two distinct clusters of post-mitotic neurons -- <inline-formula><mml:math id="inf115"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf116"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>7</mml:mn><mml:mo> </mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf117"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.99</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="fig" rid="fig4">Figure 4D</xref> – bottom right). The <inline-formula><mml:math id="inf118"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> branch is inferred from transition genes including <italic>PAX3, CRX, SOX11, EBF2, FOXP4, ASCL1, FOXO3</italic>, and <italic>SIX3</italic> which have strong expression in developing dopaminergic and gabaergic neurons of the midbrain (<xref ref-type="bibr" rid="bib4">Agoston et al., 2012</xref>; <xref ref-type="bibr" rid="bib34">Erickson et al., 2010</xref>; <xref ref-type="bibr" rid="bib105">Pino et al., 2014</xref>; <xref ref-type="bibr" rid="bib153">Yang et al., 2015</xref>; <xref ref-type="bibr" rid="bib156">Yin et al., 2009</xref>; <xref ref-type="bibr" rid="bib161">Zhang et al., 2002</xref>). Transition genes in the <inline-formula><mml:math id="inf119"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> branch include <italic>ARGFX, DUXA, HES1, NFIB, PPARA, SOX2, SOX7</italic>, and <italic>SOX9</italic>, which are known to be associated with the medulla oblongata region of the hindbrain (<xref ref-type="bibr" rid="bib35">Fawcett and Klymkowsky, 2004</xref>; <xref ref-type="bibr" rid="bib63">Kameda et al., 2011</xref>; <xref ref-type="bibr" rid="bib72">Kumbasar et al., 2009</xref>; <xref ref-type="bibr" rid="bib81">Madissoon et al., 2016</xref>; <xref ref-type="bibr" rid="bib85">Matsui et al., 2000</xref>; <xref ref-type="bibr" rid="bib123">Stolt et al., 2003</xref>).</p><p>In addition to interpreting these individual transition genes defining the major branch splits, we correlated the expression over all predicted transition and marker genes in neuronal clusters to in vivo developmental human data (<xref ref-type="bibr" rid="bib89">Miller et al., 2014</xref>). The in vivo data comprise a representative range of microarray data sampled from different parts of the developing brain at post-conception week 15, including forebrain proliferative regions, midbrain, and hindbrain. The differences in data acquisition methods (RNAseq vs. microarray, single-cell vs heterogeneous populations) resulted in relatively low correlations overall, but there are clear associations between individual clusters and specific brain regions (<xref ref-type="fig" rid="fig4">Figure 4E</xref>). Specifically, <inline-formula><mml:math id="inf120"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, maps to the ganglionic eminences, suggesting an interneuron identity, whereas <inline-formula><mml:math id="inf121"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf122"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> show better mapping to mid- and hindbrain structures, and <inline-formula><mml:math id="inf123"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> appears to be more closely related to neocortex. Overall, this global comparison, combined with the identification of genes with known regional expression, suggests that the inferred clusters from the in vitro data capture the diversity of differentiation into the early stages of the major neuronal lineages (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). These lineage predictions based on our analysis techniques were verified experimentally using viral barcoding in a separate work (<xref ref-type="bibr" rid="bib154">Yao et al., 2017</xref>).</p><p>To estimate the sparsity of the underlying network and to find a minimal subset of genes through which lineage could be inferred, we replicated the analysis while only considering a limited set of genes per triplet. We assembled a collection of 20 triplets with maximal leaf-to-leaf distance of 4 nodes, and non-null inferred topology. For each triplet, we ranked genes based on their odds of being a transition gene, <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> agnostic of the true topology of the triplet. We then replicated the inference process using only the N genes with the greatest odds (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1E</xref>). We found that with as few as 4 genes per triplet, the correct lineage topology could be inferred for all of the triplets. Genes with greatest odds comprise a restricted subset of genes for further experimental investigation. Further, these findings suggest that the dynamics of expression of just four specific genes are sufficient to monitor a particular lineage decision in single cells.</p></sec></sec><sec id="s3" sec-type="discussion"><title id="head_8">Discussion</title><p>Finding an informative subspace of variables for data analysis is a general problem in machine learning, both for regression and clustering (<xref ref-type="bibr" rid="bib132">Tibshirani, 1996</xref>; <xref ref-type="bibr" rid="bib150">Witten and Tibshirani, 2010</xref>); the innovation in this paper is to use a statistical pattern learned from known biology to inform this subspace search. The approach we take here is complementary to methods that project expression variability onto coordinates of PCA, ICA or t-SNE maps (<xref ref-type="bibr" rid="bib83">Marco et al., 2014</xref>; <xref ref-type="bibr" rid="bib115">Satija et al., 2015</xref>; <xref ref-type="bibr" rid="bib134">Trapnell et al., 2014</xref>), which are combinations of all variables. Searching for sparse representation of the dynamics has the advantage of providing interpretability and experimental direction (<xref ref-type="bibr" rid="bib86">McGibbon and Pande, 2017</xref>). Following the dynamics of this small set of high-probability transition genes via fluorescent tagging could allow for the tracking of lineage decisions of individual cells in real time. Further, these genes provide a list of candidates for drivers of fate decisions, and hence a set of experimental hypotheses.</p><p>Not all genes give us equal information about the dynamics of differentiation. We discovered that genes showing the clear minimum pattern are most predictive of the sequence of lineage transitions during development. Although our pattern discovery and subsequent lineage reconstruction does not assume any functional role for the clear minimum pattern, we note that this pattern is shown by genes known to be regulators of development during hematopoiesis. The same pattern observed in many differentiating systems (<xref ref-type="bibr" rid="bib44">Graf and Enver, 2009</xref>; <xref ref-type="bibr" rid="bib107">Qi et al., 2013</xref>; <xref ref-type="bibr" rid="bib130">Thomson et al., 2011</xref>; <xref ref-type="bibr" rid="bib160">Zhang et al., 1999</xref>), and is consistent with mutual inhibition. Mutual inhibition, in turn, is hypothesized to play an important role in maintaining multi-stable systems and in mediating transitions between different stable states of multi-stable systems (<xref ref-type="bibr" rid="bib36">Ferrell, 2012</xref>).</p><p>Discovery of sparse representations of the cell states and variability between them demonstrates the efficacy of low dimensional descriptions of the system. Understanding the dynamics and transitions of complex physical systems composed of a large number of variables has been driven by the discovery of low dimensional order parameters (<xref ref-type="bibr" rid="bib6">Anderson, 1978</xref>; <xref ref-type="bibr" rid="bib75">Landau and Lifshitz, 1951</xref>). As opposed to measuring and modeling states as high dimensional objects in their native representation, order parameters provide low dimensional descriptions of the states and dynamics, which has proven crucial in developing both qualitative and quantitative models. Finding small subsets of genes which captures the lineage transitions in cells analogously provides a low dimensional subspace that captures the dynamics in genetic networks and can be useful for modeling (<xref ref-type="bibr" rid="bib58">Jang et al., 2017</xref>). An accompanying paper allows us to exploit this idea to extract mathematical models for the underlying molecular circuits from single cell gene expression data obtained during germ layer differentiation (<xref ref-type="bibr" rid="bib58">Jang et al., 2017</xref>).</p></sec><sec id="s4" sec-type="materials|methods"><title id="head_9">Materials and methods</title><sec id="s4-1"><title id="head_10">In vitro neuronal differentiation</title><p>Single-cell transcriptomic data from the in vitro neural differentiation procedure was obtained as described in <xref ref-type="bibr" rid="bib154">Yao et al. (2017)</xref> (Supplemental information):</p><p>hESCs were dissociated with Accutase and plated on Matrigel-coated 24-well plates at 2.5 × 105 cells/cm2 in DMEM/F12 (#11330–032), 1 × N2, 1 × B27 without vitamin A, 2 mM Glutamax, 100 μM non-essential amino acids, 0.5 mg/mL BSA, 1X Pen-Strep, and 100 μM 2-mercaptoethanol (referred to as basal medium; all from Thermo Fisher, Waltham, MA) with 20 ng/mL FGF2 (Thermo Fisher) and 2 μM thiazovivin. Cortical induction was initiated by changing to the basal medium with 5 μM SB431542 (StemRD, Burlingame, CA), 50 nM LDN193189 (Reagents Direct, Encinitas, CA) and 1 μM cyclopamine (Stemgent, Lexington, MA) (referred to as NIM). NIM was changed daily for 11 days. On day 12, cells were dissociated and seeded on Matrigelcoated 24-well plates at 5 × 105/cm2 in basal medium with 20 ng/mL FGF2 and 2 μM thiazovivin. Progenitor expansion was initiated on D13 by changing to serum-free human neural stem cell culture medium (NSCM, #A10509–01 from Thermo Fisher) containing 20 ng/mL FGF2 and 20 ng/mL EGF. NSCM was changed daily for 6 days. Cultures were passaged once more on D19 with Accutase and replated at 5 × 105 cells/cm2. On D26, cells were dissociated with Accutase and seeded on 24-well plates sequentially coated with poly-D-lysine (Millipore, Billerica, MA) and laminin (Thermo Fisher) at 1 × 105 cells/cm2 in basal medium supplemented with 20 ng/mL FGF2 and 2 μM thiazovivin. On D27, medium was changed to a 1:1 mixture of DMEM/F12 and Neurobasal medium (#21103–049) supplemented with 100 μM cAMP (Sigma-Aldrich, St Louis, MO), 10 ng/mL BDNF (R and D Systems, Minneapolis, MN), 10 ng/mL GDNF (R and D Systems) and 10 ng/mL NT-3 (R and D Systems) (referred to as ND). Cells were maintained in ND medium for four weeks until day 54 with half medium change every other day. Quality of differentiations was routinely assessed by immunostaining at D12 (<italic>PAX6</italic> and <italic>DCX</italic>), at D26 (<italic>LHX2, SOX2, EOMES, POU3F2</italic>, and <italic>TBR1</italic>), and at D54 (<italic>MAP2</italic> costained with <italic>TBR1, CTIP2, SATB2</italic>). In addition flow cytometry at D26 (<italic>EOMES</italic>, <italic>SOX2</italic> and <italic>PAX6</italic>) was performed. Typically, <italic>EOMES</italic> at day 26 proved the most valuable quality control metric (~10% of cells by both flow cytometry and immunostaining) and predicted failure at D54. Specifically, when <italic>EOMES</italic> was low (&lt;1% of cells) differentiations failed and were typically dominated by <italic>POU3F2</italic>+ cell types and/or non-neural ‘other’ cell types. These failed differentiations were eliminated from further analysis, typically ~20% of experiments (5 of 19 experiments in 2016). 50 bp paired-end Smart-Seq2 libraries were prepared from these cells as previously described (<xref ref-type="bibr" rid="bib104">Picelli et al., 2013</xref>) and mapped as described in <xref ref-type="bibr" rid="bib129">Thomsen et al., 2016</xref> and <xref ref-type="bibr" rid="bib154">Yao et al. (2017)</xref>. As each cell was profiled independently (without pooling before amplification, as in methods such as Cel-Seq, STRT, or Drop-Seq), we did not observe the batch effects present in pooling-based methods. Although cells were profiled in plates (batches), there was no significant plate-related variation - this Fixed single-cell transcriptomic characteriza is most likely due to amplification being carried out separately in each well of the plate, thereby precluding cross-talk among barcodes, or plate-related differences in amplification. This is clear from the mixing of cells from different plates in the clustering. A complete census is provided (<xref ref-type="supplementary-material" rid="SD10-data">Figure 4—source data 4</xref>).</p></sec><sec id="s4-2"><title id="head_11">Gene expression data</title><p>Hematopoietic gene expression data were downloaded from the Immunological Genome Project (<xref ref-type="bibr" rid="bib51">Heng et al., 2008</xref>); GEO GSE15907) and log-2 transformed. We restricted the genes considered to 1459 transcription factors. Brain development expression data were log-2 transformed, and 1460 transcription factors were individually normalized by dividing by the 90th-percentile expression value. Lists of mouse and human transcription factors are provided (<xref ref-type="supplementary-material" rid="SD2-data">Figure 1—source data 2</xref>, <xref ref-type="supplementary-material" rid="SD11-data">Figure 4—source data 5</xref>).</p></sec><sec id="s4-3"><title id="head_12">Software</title><p>Calculations were performed using custom written MATLAB code (The Mathworks) on the Harvard Research Computing Odyssey cluster. Code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/furchtgott/sibilant">https://github.com/furchtgott/sibilant</ext-link>. t-SNE was done using the package provided in (<xref ref-type="bibr" rid="bib141">Van Der Maaten, 2009</xref>). Monocole was run in R (<xref ref-type="bibr" rid="bib22">Core Team, 2015</xref>; <xref ref-type="bibr" rid="bib134">Trapnell et al., 2014</xref>).</p></sec><sec id="s4-4"><title id="head_13">Description of algorithm</title><p>The algorithm proceeds according to the following steps:</p><list list-type="order"><list-item><p>Find initial seed clustering configuration <inline-formula><mml:math id="inf125"><mml:mrow><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> using K-medoids where K is chosen to be larger than the cluster number inferred from the Gap statistic (<xref ref-type="bibr" rid="bib131">Tibshirani et al., 2001</xref>)</p></list-item><list-item><p>For all triplets of clusters, find most likely <inline-formula><mml:math id="inf126"><mml:mi>T</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf127"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf128"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> given <inline-formula><mml:math id="inf129"><mml:mrow><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>:<list list-type="alpha-lower"><list-item><p>Compute <inline-formula><mml:math id="inf130"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> by integrating numerically over <inline-formula><mml:math id="inf131"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ6 equ9 equ10">Equations 6, 9, and 10</xref>).</p></list-item><list-item><p>Compute <inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> using <xref ref-type="disp-formula" rid="equ20 equ29">Equations 20 and 29</xref>.</p></list-item><list-item><p>Identify mostly likely topology <inline-formula><mml:math id="inf133"><mml:mi>T</mml:mi></mml:math></inline-formula> and set of <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf135"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item></list></p></list-item><list-item><p>Recluster <inline-formula><mml:math id="inf136"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mi>g</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> using K-medoids in the space of all <inline-formula><mml:math id="inf137"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf138"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for the triplets with probability <inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>&gt; 0.6 of being non-null. Determine new clustering configuration <inline-formula><mml:math id="inf140"><mml:mrow><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>Repeat steps 1 and 2 until convergence of <inline-formula><mml:math id="inf141"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mi>C</mml:mi> <mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p></list-item><list-item><p>Determine the most likely tree connecting cell clusters, recapitulating high-probability triplet topologies.</p></list-item></list><p>Each of these steps is described in the following section.</p></sec><sec id="s4-5"><title id="head_14">Bayesian framework for inferring cluster identities, state transitions, and marker and transition genes simultaneously</title><sec id="s4-5-1"><title id="head_15">Notation; Bayes’ rule</title><p>Given gene expression data from single cells <inline-formula><mml:math id="inf142"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, we built a probabilistic framework to simultaneously infer cell cluster identities, <inline-formula><mml:math id="inf143"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, the sequence of transitions <inline-formula><mml:math id="inf144"><mml:mi>T</mml:mi></mml:math></inline-formula> between these clusters, the key sets of marker genes <inline-formula><mml:math id="inf145"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that define each cell cluster, and genes <inline-formula><mml:math id="inf146"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that determine the sequence of transitions between clusters. We maximized the joint probability distribution of these variables given the gene expression data, <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to determine the maximum likelihood estimates of these parameters.</p><p>We first consider how to solve this problem in the case in which there are three cell clusters, and we will later build a tree using all possible combinations of three cell clusters. Let the set of three cell clusters be c<sub>A</sub>, c<sub>B</sub> and c<sub>C</sub> with gene expression data <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for all genes <inline-formula><mml:math id="inf149"><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mo> </mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and all cells. The term <inline-formula><mml:math id="inf150"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> denotes the expression data for just gene <inline-formula><mml:math id="inf151"><mml:mi>i</mml:mi></mml:math></inline-formula> in cells in clusters c<sub>A</sub>, c<sub>B</sub>, and c<sub>C</sub>. The topology <inline-formula><mml:math id="inf152"><mml:mi>T</mml:mi></mml:math></inline-formula> of the relationships between cell clusters c<sub>A</sub>, c<sub>B</sub> and c<sub>C</sub> can take on four possible values: <inline-formula><mml:math id="inf153"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒜</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>: cell cluster c<sub>A</sub> is in the middle (either c<sub>A</sub> is the progenitor of c<sub>B</sub> and c<sub>C</sub>, or c<sub>A</sub> is an intermediate cell type between c<sub>B</sub> and c<sub>C</sub>); <inline-formula><mml:math id="inf154"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">ℬ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>: cell cluster c<sub>B</sub> is in the middle; <inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>: cell cluster c<sub>C</sub> is in the middle; or <inline-formula><mml:math id="inf156"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mo>∅</mml:mo></mml:mrow></mml:math></inline-formula>: we cannot determine the topology. Complementarily, for each gene <inline-formula><mml:math id="inf157"><mml:mi>i</mml:mi></mml:math></inline-formula> we define variables <inline-formula><mml:math id="inf158"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf159"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf160"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf161"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> if the gene is a marker gene, <inline-formula><mml:math id="inf162"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf163"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if the gene is a transition gene, and <inline-formula><mml:math id="inf164"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> otherwise. Our task is to determine the probability <inline-formula><mml:math id="inf165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> given gene expression data for all genes <inline-formula><mml:math id="inf166"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>According to Bayes’ rule, <inline-formula><mml:math id="inf167"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is proportional to the probability of the gene expression data given <inline-formula><mml:math id="inf168"><mml:mi>T</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf169"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mi>C</mml:mi> <mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf170"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mspace width="2em"/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The denominator of the right hand side of <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> is a normalization constant. Expressions <inline-formula><mml:math id="inf171"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf172"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, and<inline-formula><mml:math id="inf173"><mml:mrow><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mi>C</mml:mi> <mml:mo>}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> are respectively the prior probabilities of <inline-formula><mml:math id="inf174"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf175"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> given <inline-formula><mml:math id="inf176"><mml:mi>T</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf177"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mi>C</mml:mi> <mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>the prior probability of <inline-formula><mml:math id="inf178"><mml:mi>T</mml:mi></mml:math></inline-formula> given <inline-formula><mml:math id="inf179"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mi>C</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and the prior probability of <inline-formula><mml:math id="inf180"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mi>C</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We assume that in the absence of any expression data, the probability that a gene is a transition or marker gene is independent of the topology and clustering configuration: <inline-formula><mml:math id="inf181"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf182"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-5-2"><title id="head_16">Conditional independence</title><p>In our model, we assume that knowing the clustering configuration <inline-formula><mml:math id="inf183"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mi>C</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the topology <inline-formula><mml:math id="inf184"><mml:mi>T</mml:mi></mml:math></inline-formula> and whether or not a gene is a marker or transition gene is sufficient to determine the probability distribution for its expression levels in each of the cell clusters. Therefore, the gene expression patterns of different genes are conditionally independent given the topology, clustering and gene type:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Thus, <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> becomes<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We maximize the evaluated <inline-formula><mml:math id="inf185"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> with respect to <inline-formula><mml:math id="inf186"><mml:mi>T</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf187"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mi>C</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and each of the <inline-formula><mml:math id="inf188"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf189"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to obtain the most likely relationships between cell types c<sub>A</sub>, c<sub>B</sub> and c<sub>C</sub>, as well as the genes most likely to be marker and transition genes.</p></sec><sec id="s4-5-3"><title id="head_17">Expression for <inline-formula><mml:math id="inf190"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (transition genes)</title><p>To infer <inline-formula><mml:math id="inf191"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, we need a model to compute the probability of the gene expression data for each gene, <inline-formula><mml:math id="inf192"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, given <inline-formula><mml:math id="inf193"><mml:mi>T</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf194"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mi>C</mml:mi> <mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="inf195"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>and <inline-formula><mml:math id="inf196"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, following <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>. Our model for the probability distribution of the expression of a single transition gene <inline-formula><mml:math id="inf197"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in the three cell types <inline-formula><mml:math id="inf198"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is defined solely by the geometry of the arrangement of the cell types in gene expression space, as described in the main text. For example, for <inline-formula><mml:math id="inf199"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒜</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf200"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, our model is that the distribution of the expression levels of <inline-formula><mml:math id="inf201"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> in the three cell types A, B and C has the smallest mean value in either B or C but not in A (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). If the distribution of the expression of gene <inline-formula><mml:math id="inf202"><mml:mi>i</mml:mi></mml:math></inline-formula> in cell type A is <inline-formula><mml:math id="inf203"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (we assume a log-normal distribution) with a mean <inline-formula><mml:math id="inf204"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf205"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, with analogous expressions for cell types B and C, then our model defining <inline-formula><mml:math id="inf206"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒜</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is that either <inline-formula><mml:math id="inf207"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf208"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf209"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>and <inline-formula><mml:math id="inf210"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf211"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf212"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf213"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> are the mean values of the expression levels of <inline-formula><mml:math id="inf214"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in cell types A, B and C. Thus,<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒜</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The terms in <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> can be calculated by integrating over the prior probability distribution of the means <inline-formula><mml:math id="inf215"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf216"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf217"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and standard deviations <inline-formula><mml:math id="inf218"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf219"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf220"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, with the conditions on the means constraining the domains of integration:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒜</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:munder><mml:mo>∭</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:munder><mml:mo>∭</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Probabilities <inline-formula><mml:math id="inf221"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">ℬ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf222"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> are defined similarly.</p><p>In addition to topologies <inline-formula><mml:math id="inf223"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒜</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf224"><mml:mi>ℬ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf225"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, we consider a null hypothesis <inline-formula><mml:math id="inf226"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>∅</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in which transition genes have differential expression levels between states, but these levels are not correlated with any particular topology of states. This corresponds to having gene expression levels from cell-types A, B and C coming from three distributions with no restrictions on the relative order of the three means:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mi>∅</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∭</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Note that the probability of the data given the null hypothesis is the average of the probabilities of the data given the non-null hypotheses:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mi>∅</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Note that <inline-formula><mml:math id="inf227"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> depends on both <inline-formula><mml:math id="inf228"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf229"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-5-4"><title id="head_18">Expression for <inline-formula><mml:math id="inf230"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (marker genes)</title><p>Our model for marker genes assumes that the probability distribution for the expression level of such genes, <inline-formula><mml:math id="inf231"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to be independent of <inline-formula><mml:math id="inf232"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and to be generated from distributions with two cell-types having a low value and the third a high value (for example, <inline-formula><mml:math id="inf233"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for cell-types A and B and <inline-formula><mml:math id="inf234"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for cell-type C, with the constraint <inline-formula><mml:math id="inf235"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:munder><mml:mo>∭</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:munder><mml:mo>∭</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:munder><mml:mo>∭</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Note that <inline-formula><mml:math id="inf236"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> does not depend on <inline-formula><mml:math id="inf237"><mml:mi>T</mml:mi></mml:math></inline-formula> but does depend on <inline-formula><mml:math id="inf238"><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-5-5"><title id="head_19">Expression for <italic><inline-formula><mml:math id="inf239"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></italic> (irrelevant genes)</title><p>Our model for genes that are neither marker nor transition genes is that the expression levels of such genes, <inline-formula><mml:math id="inf240"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, is generated from one single distribution <inline-formula><mml:math id="inf241"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∬</mml:mo><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Note that <inline-formula><mml:math id="inf242"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> does not depend on <inline-formula><mml:math id="inf243"><mml:mi>T</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf244"><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-5-6"><title id="head_20">Numerical integration</title><p>Each of the probabilities on the right hand side of <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> is evaluated numerically as above. We assume the distribution of the expression of gene <inline-formula><mml:math id="inf245"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in cluster c<sub>A </sub><inline-formula><mml:math id="inf246"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to be log-normal. Given <inline-formula><mml:math id="inf247"><mml:mi>m</mml:mi></mml:math></inline-formula> log2-transformed replicate measurements <inline-formula><mml:math id="inf248"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> of gene expression of gene <inline-formula><mml:math id="inf249"><mml:mi>i</mml:mi></mml:math></inline-formula> in cells belonging to cluster c<sub>A</sub>, the probability of the data assuming mean <inline-formula><mml:math id="inf250"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf251"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="thinmathspace"/><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:msup><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="thinmathspace"/><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Distributions <inline-formula><mml:math id="inf252"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf253"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are defined analogously.</p><p>We take the <italic>a priori</italic> probability distribution of <inline-formula><mml:math id="inf254"><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf255"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf256"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as uniform over a certain range of means and standard deviations estimated from the data. For the log2-transformed hematopoietic gene expression data, we take <inline-formula><mml:math id="inf257"><mml:mrow><mml:mn>2</mml:mn><mml:mo>&lt;</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf258"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>0.75</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>We take the prior probabilities for the distributions in different cell types to be independent: <inline-formula><mml:math id="inf259"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The constraints on the order of the means are enforced by the domain of integration, and the prior must be properly normalized over this domain. For example, in <xref ref-type="disp-formula" rid="equ6">Equation 6</xref>,<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:munder><mml:mo>∭</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:munder><mml:mo>∭</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:munder></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1.</mml:mn></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Integrals were evaluated numerically in MATLAB using trapezoidal integration with step-sizes <inline-formula><mml:math id="inf260"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> = 0.05 and <inline-formula><mml:math id="inf261"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>σ</mml:mi></mml:mrow></mml:math></inline-formula> = 0.01.</p><p>The choice of a log-normal distribution could potentially confound the results, particularly for single-cell RNA-Seq data with significant zero-inflation. This is a potential area for improvement in our algorithm, but the method can easily be adapted to model different distributions of RNA expression, such as gamma distributions (<xref ref-type="bibr" rid="bib117">Shahrezaei and Swain, 2008</xref>; <xref ref-type="bibr" rid="bib149">Wills et al., 2013</xref>) or beta-Poisson distributions (<xref ref-type="bibr" rid="bib26">Delmans and Hemberg, 2016</xref>; <xref ref-type="bibr" rid="bib144">Vu et al., 2016</xref>). In either case, the probability of the data given different topologies would be computed by numeric integration over the parameters of the distribution, for example, <inline-formula><mml:math id="inf262"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf263"><mml:mi>β</mml:mi></mml:math></inline-formula> for the Gamma distribution, by replacing the log-normal distributions in <xref ref-type="disp-formula" rid="equ7 equ9 equ10">Equations 7, 9 and 10</xref> with ones from the appropriate model.</p><p>The choice of the right parametric form for single-cell RNA expression is still an area of active research. Our choice of log-normal distributions assumes that higher order moments of the distributions (beyond standard deviation) ought to have a minimal contribution to the predictions, but we have not tested this extensively.</p><p>Although the default prior was the uniform prior, we also implemented an empirical prior <inline-formula><mml:math id="inf264"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by estimating the empirical distribution over all the Immgen cell types, using the kernel density estimation code provided in (<xref ref-type="bibr" rid="bib16">Botev et al., 2010</xref>). The resulting hematopoietic lineage tree was identical. Using the kernel-density-estimated empirical prior may provide more stability in future analyses.</p></sec><sec id="s4-5-7"><title id="head_21">Probability of topology given gene expression and cluster identities <inline-formula><mml:math id="inf265"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></title><p>We can derive the probability of the topology given the gene expression data and cluster identities <inline-formula><mml:math id="inf266"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> by summing over all the <inline-formula><mml:math id="inf267"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf268"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to find the probability of the data given topology <inline-formula><mml:math id="inf269"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mo>…</mml:mo><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where the probability of gene expression data for gene <inline-formula><mml:math id="inf270"><mml:mi>i</mml:mi></mml:math></inline-formula> given topology <inline-formula><mml:math id="inf271"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is obtained by summing <inline-formula><mml:math id="inf272"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> over <inline-formula><mml:math id="inf273"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf274"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We consider the odds of a gene being a transition gene <inline-formula><mml:math id="inf275"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as a sparsity parameter, which we vary. We take <inline-formula><mml:math id="inf276"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2.</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>The probability of topology <inline-formula><mml:math id="inf277"><mml:mi>T</mml:mi></mml:math></inline-formula> given data is proportional to the probability of the data given topology <inline-formula><mml:math id="inf278"><mml:mi>T</mml:mi></mml:math></inline-formula> (using Bayes’ rule):<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>T</mml:mi></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Therefore, using <xref ref-type="disp-formula" rid="equ14">Equation 14</xref>, we obtain the following expression for <inline-formula><mml:math id="inf279"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ18">Equation 18</xref> can be written more explicitly by rewriting <xref ref-type="disp-formula" rid="equ15">Equation 15</xref> as follows:<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here we have used the fact noted earlier that in our generating model, <inline-formula><mml:math id="inf280"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf281"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> do not depend on <inline-formula><mml:math id="inf282"><mml:mi>T</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ10">Equation 10</xref>). The terms <inline-formula><mml:math id="inf283"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> cancel out in the numerator and denominator of <xref ref-type="disp-formula" rid="equ18">Equation 18</xref>, and we can write <xref ref-type="disp-formula" rid="equ18">Equation 18</xref> in terms of ratios of the probabilities of the data given transition-gene and non-transition-gene status:<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We can rewrite <xref ref-type="disp-formula" rid="equ20">Equation 20</xref> as:<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="thinmathspace"/><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>∣</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="thinmathspace"/><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>∣</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf284"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the odds that gene <inline-formula><mml:math id="inf285"><mml:mi>i</mml:mi></mml:math></inline-formula> is a transition gene, given clustering:<disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>and <inline-formula><mml:math id="inf286"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the probability of <inline-formula><mml:math id="inf287"><mml:mi>T</mml:mi></mml:math></inline-formula> given only gene expression data for gene <inline-formula><mml:math id="inf288"><mml:mi>i</mml:mi></mml:math></inline-formula>, clustering and that gene <inline-formula><mml:math id="inf289"><mml:mi>i</mml:mi></mml:math></inline-formula> is a transition gene:<disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Thus each gene’s contribution <inline-formula><mml:math id="inf290"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to the probability of the topology given total gene expression <inline-formula><mml:math id="inf291"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is weighted by the odds <inline-formula><mml:math id="inf292"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> that it is transition gene.</p></sec><sec id="s4-5-8"><title id="head_22">Rewriting <xref ref-type="disp-formula" rid="equ21">Equation 21</xref> in terms of negative votes</title><p>Let us denote the probability of gene expression data for gene <inline-formula><mml:math id="inf293"><mml:mi>i</mml:mi></mml:math></inline-formula> given that cell cluster <inline-formula><mml:math id="inf294"><mml:mi>ξ</mml:mi></mml:math></inline-formula> has the distribution with minimum mean expression as <inline-formula><mml:math id="inf295"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> For example, <inline-formula><mml:math id="inf296"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Then, using <inline-formula><mml:math id="inf297"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <xref ref-type="disp-formula" rid="equ5 equ8">Equations 5 and 8</xref>, we can write:<disp-formula id="equ24"><label>(24)</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒜</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">ℬ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>∅</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="italic">C</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="italic">C</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒜</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">ℬ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="italic">C</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mi>∅</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow/></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="italic">C</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Therefore, for <inline-formula><mml:math id="inf298"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒜</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">ℬ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, we can rewrite <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> as:<disp-formula id="equ25"><label>(25)</label><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="italic">C</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="italic">C</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="italic">C</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Combining <xref ref-type="disp-formula" rid="equ21 equ25">Equations 21 and 25</xref>, we derive, for <inline-formula><mml:math id="inf299"><mml:mrow><mml:mi>T</mml:mi><mml:mo>≠</mml:mo><mml:mo>∅</mml:mo></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ26"><label>(26)</label><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mo>∝</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>∝</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>∣</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi mathvariant="italic">C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>∣</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="italic">C</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2em"/><mml:mstyle displaystyle="true" scriptlevel="0"/></mml:mtd><mml:mtd><mml:mo>∝</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi mathvariant="normal">g</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">B</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi mathvariant="italic">C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf300"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>C</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the probability that cell cluster <inline-formula><mml:math id="inf301"><mml:mi>T</mml:mi></mml:math></inline-formula> (the intermediate cluster in topology <inline-formula><mml:math id="inf302"><mml:mi>T</mml:mi></mml:math></inline-formula>) has the distribution with the minimum mean for gene <inline-formula><mml:math id="inf303"><mml:mi>i</mml:mi></mml:math></inline-formula>:<disp-formula id="equ27"><label>(27)</label><mml:math id="m27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Every gene can be thought of as casting a vote <inline-formula><mml:math id="inf304"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>C</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> against cell type <inline-formula><mml:math id="inf305"><mml:mi>T</mml:mi></mml:math></inline-formula> being the intermediate, and this vote is weighted by the odds <inline-formula><mml:math id="inf306"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of the gene <inline-formula><mml:math id="inf307"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> being a transition gene and having a unique minimum, given the clustering. This corresponds to <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> in the main text.</p></sec><sec id="s4-5-9"><title id="head_23">Expression for <inline-formula><mml:math id="inf308"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></title><p>Once <inline-formula><mml:math id="inf309"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is calculated, it is straightforward to find <inline-formula><mml:math id="inf310"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ28"><label>(28)</label><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf311"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the probability of <inline-formula><mml:math id="inf312"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf313"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>given the particular topology <inline-formula><mml:math id="inf314"><mml:mi>T</mml:mi></mml:math></inline-formula>, clustering <inline-formula><mml:math id="inf315"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mi>C</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and gene expression. Because we have assumed that gene expression patterns <inline-formula><mml:math id="inf316"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> are conditionally independent given <inline-formula><mml:math id="inf317"><mml:mi>T</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf318"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mi>C</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf319"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf320"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>), the probabilities of being marker or transition genes <inline-formula><mml:math id="inf321"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf322"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are also conditionally independent given gene expression, clustering and the topology:<disp-formula id="equ29"><label>(29)</label><mml:math id="m29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf323"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the probability that gene <inline-formula><mml:math id="inf324"><mml:mi>i</mml:mi></mml:math></inline-formula> is a marker or transition gene given its gene expression, the clustering, and that the topology is <inline-formula><mml:math id="inf325"><mml:mi>T</mml:mi></mml:math></inline-formula>.</p></sec><sec id="s4-5-10"><title>Choice of prior odds does not affect the most likely topology</title><p>The only free parameter in our calculation above is the prior odds of gene <italic>i</italic> being a transition gene, <inline-formula><mml:math id="inf326"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. At one extreme, if <inline-formula><mml:math id="inf327"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, then <inline-formula><mml:math id="inf328"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>: if we assume that none of the genes are transition genes, then knowing gene expression does not give us any new knowledge of the topology <inline-formula><mml:math id="inf329"><mml:mi>T</mml:mi></mml:math></inline-formula>, since only transition genes are informative about <inline-formula><mml:math id="inf330"><mml:mi>T</mml:mi></mml:math></inline-formula>. At the other extreme, if <inline-formula><mml:math id="inf331"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> then the null hypothesis dominates: if all genes are transition genes, then there will be negative votes against all topologies. We computed the behavior of <inline-formula><mml:math id="inf332"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> between these two limits to determine the sensitivity of our answer to <inline-formula><mml:math id="inf333"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p><xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> shows the dependence of the probabilities <inline-formula><mml:math id="inf334"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> on the prior odds for triplets CMP/ST/MPP and GMP/MEP/FrBC for values of <inline-formula><mml:math id="inf335"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> between 10<sup>−8</sup> and 10<sup>2</sup>. For triplet CMP/ST/MPP the topology <inline-formula><mml:math id="inf336"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow><mml:mo>≡</mml:mo><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> dominates for <inline-formula><mml:math id="inf337"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> between 10<sup>−2</sup> and 10, whereas for triplet MEP/GMP/FrBC there is no value of the prior odds that strongly favors a non-null topology. For most triplets, the most likely topology does not depend on the choice of prior odds; when building lineage trees, we ignore those triplets where different choices of prior odds lead to different most-likely topologies, i.e. there is more than one non-null topology that reaches probability 0.6 over the range of prior odds.</p></sec></sec><sec id="s4-6"><title id="head_24">Determination of lineage tree from triplet topologies</title><sec id="s4-6-1"><title id="head_25">Selection of triplets</title><p>In order to build lineage trees from the topologies we determine for each cell type, we select the triplets for which our determination of the topology is most robust. There is one free parameter in our model: the prior odds for a gene to be a transition gene in the absence of gene expression data, <inline-formula><mml:math id="inf338"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. For each triplet, we vary this parameter between 10<sup>−6</sup> and 10<sup>2</sup> and calculate the probability of the topology given gene expression data <inline-formula><mml:math id="inf339"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as a function of the prior odds.</p><p>We want to consider only triplets which showed a single dominant topology. We exclude triplets which show a weak probability for a particular topology or ones which depend on a particular choice of prior odds. We also do not consider triplets which show a strong probability for two different topologies, depending on the choice of prior odds.</p><p>There were 14 such triplets among the 165 hematopoietic triplets. Mathematically, these cases come up when the genes that are most likely to show the clear minimum pattern (furthest on the right in a ‘dot plot’) suggest one topology, but if one used a more permissive value of the sparsity parameter, a different topology wins out. One of the cell types might have a small number of genes with very high odds, but then fewer genes with moderately high odds compared to the other cell types. We did not notice a clear pattern in the identity of the triplets exhibiting this behavior, but 9 of the 14 were triplets of length five or greater in the Adolfsson model. One of the triplets with this behavior was the MLP/CMP/GMP triplet, and the dominant topology was either MLP (at low prior odds) or CMP (at higher prior odds). Interestingly, both cell types are progenitors to GMP in the Adolfsson model.</p><p>We consider triplets for which only one non-null topology has probability <inline-formula><mml:math id="inf340"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>greater than 0.6. The probabilities of the different topologies for each triplet in the hematopoietic tree are shown in <xref ref-type="supplementary-material" rid="SD3-data">Figure 2—source data 1</xref> and for the triplets in the cortical development tree in <xref ref-type="supplementary-material" rid="SD8-data">Figure 4—source data 2</xref>.</p></sec><sec id="s4-6-2"><title id="head_26">Pruning rule</title><p>We assemble the triplets with known topology into an undirected graph. Since we determined topologies by considering cell types three at a time, we obtain topological relationships involving both cell types that are nearest neighbors and cell types that are more distantly related. In order to reconstruct the tree, we must determine which cell types are nearest neighbors and which ones are separated by one or more intermediate cell types.</p><p>The set of inferred topologies allows us to determine which cell types are separated by intermediates. For every pair of cell types, we ask whether any of the inferred topologies features an intermediate between the two cell types. If such a topology has been inferred, we consider that the two cell types are not nearest neighbors, and that at least one other cell type is an intermediate. For example, we can ignore triplet CMP – <bold>LT</bold> – MPP because triplet LT – <bold>ST</bold> – CMP testifies that there exists an intermediate between LT and CMP, and triplet LT – <bold>ST</bold> – MPP testifies that there exists an intermediate between LT and MPP (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p><p>Note that this pruning rule does not assume the absence of loops. The lineage tree we infer for the hematopoietic progenitors contains a loop that includes ST to CMP to GMP on one side and ST to MPP to MLP to GMP on the other side. The loop involves triplets CMP – <bold>ST</bold> – MPP, ST – <bold>CMP</bold> – GMP, ST – <bold>MPP</bold> – MLP and MPP – <bold>MLP</bold> – GMP (we cannot determine the topology of triplet CMP/MLP/GMP). None of the triplets shows a topology that would allow us to break up the loop.</p></sec><sec id="s4-6-3"><title id="head_27">Distinguishing between two models of hematopoiesis</title><p>The topologies we infer support the model from <xref ref-type="bibr" rid="bib2">Adolfsson et al. (2005)</xref>, in which CMP splits from ST-HSC. In particular, there are several triplets that can distinguish the Adolfsson model from the traditional picture, and they support the Adolfsson model. These triplets include CMP – <bold>ST</bold> – MPP, CMP – <bold>ST</bold> – MLP, MEP – <bold>ST</bold> – MLP and CMP – <bold>LT</bold> – MPP. These triplets show that, unlike in the traditional picture, cell types CMP and MEP split from ST are not descended from MPP or MLP.</p><p>On the other hand, triplets LT – <bold>MLP</bold> – GMP, ST – <bold>MLP</bold> – GMP and MPP – <bold>MLP</bold> – GMP show that MLP is an intermediate between the earliest progenitors and GMP. See also <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref> and <xref ref-type="supplementary-material" rid="SD4-data">Figure 2—source data 2</xref>.</p></sec></sec><sec id="s4-7"><title id="head_28">Stability analysis</title><p>The inference algorithm depends on several parameters and priors. We performed a stability analysis for both the microarray hematopoietic data and the human brain single cell data to determine the parameter ranges for which the inferred lineage tree was unchanged.</p><list list-type="order"><list-item><p>Hematopoiesis<list list-type="bullet"><list-item><p>For the prior probability, given that a gene is not a transition gene, that it is an irrelevant gene, our default value was <inline-formula><mml:math id="inf341"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> =0.5, but the tree was unchanged for values of <inline-formula><mml:math id="inf342"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> between 0.25 and 0.65.</p></list-item><list-item><p>For the prior probabilities of different topologies, our default value was <inline-formula><mml:math id="inf343"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>∅</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒜</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="script">ℬ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.25</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. We varied <inline-formula><mml:math id="inf344"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>∅</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> while keeping the prior probabilities of the non-null topologies equal: <inline-formula><mml:math id="inf345"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>≠</mml:mo><mml:mi>∅</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>∅</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The tree was unchanged for values of <inline-formula><mml:math id="inf346"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>∅</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> between 0.1 and 0.35.</p></list-item><list-item><p>We used a threshold of 0.6 to consider a triplet significant for the tree-building step. The tree was unchanged for thresholds between 0.5 and 0.65.</p></list-item><list-item><p>A key input parameter into the algorithm is the expected prior distribution of means and standard deviations <inline-formula><mml:math id="inf347"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> used in the numeric integration. Our default prior was a uniform prior for both means and standard deviations over reasonable ranges of these parameters. We also implemented an empirical prior <inline-formula><mml:math id="inf348"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by estimating the empirical distribution over all the Immgen cell types, using kernel density estimation (<xref ref-type="bibr" rid="bib16">Botev et al., 2010</xref>). The resulting hematopoietic lineage tree was identical. Using the kernel-density-estimated empirical prior may provide more stability in future analyses.</p></list-item></list></p></list-item><list-item><p> Brain Development<list list-type="bullet"><list-item><p>For the prior probability, given that a gene is not a transition gene, that it is an irrelevant gene, our default value was <inline-formula><mml:math id="inf349"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.5, but the tree was unchanged for values of <inline-formula><mml:math id="inf350"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mo>|</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> between 0.02 and 0.97.</p></list-item><list-item><p>For the prior probabilities of different topologies, our default value was <inline-formula><mml:math id="inf351"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>∅</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒜</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="script">ℬ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.25</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. We varied <inline-formula><mml:math id="inf352"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>∅</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> while keeping the prior probabilities of the non-null topologies equal: <inline-formula><mml:math id="inf353"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>≠</mml:mo><mml:mo>∅</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>∅</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The tree was unchanged for values of <inline-formula><mml:math id="inf354"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>∅</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> between 0.06 and 0.96.</p></list-item><list-item><p>We used a threshold of 0.6 to consider a triplet significant for the tree-building step. The tree was unchanged for thresholds between 0.5 and 0.8.</p></list-item><list-item><p>For the single cell data, we also changed the number of initial seed clusters for the iterative algorithm within a range from 30 to 45. In each case, the tree remained the same, and never more than 23% of the cells were clustered into a different cell type.</p></list-item></list></p></list-item></list></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Sandeep Choubey, Alex Schier, Andrew Murray, David Scadden and Toshihiko Oki for scientific discussions. We also thank Christof Koch, Andrew Murray, KC Huang, Jim Valcourt and Dann Huh for detailed comments and feedback on this work. We are grateful to Simona Lodato for helping us interpret our results and in particular help us write the section on the genes we discover to be important during cortical development. We are particularly grateful to the Senior and Reviewing Editors and to the four peer reviewers, including Nir Yosef, for their very thoughtful comments and suggestions. The study was supported by NSF-GRFP and NDSEG Fellowships (LF), an NIH Pioneer Award (SR), and the Allen Institute for Brain Science (SR).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>LAF, Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>SM, Conceptualization, Data curation, Software, Formal analysis, Validation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>VM, Validation, Visualization, Writing—review and editing</p></fn><fn fn-type="con" id="con4"><p>SR, Conceptualization, Resources, Formal analysis, Supervision, Funding acquisition, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following previously published datasets were used:</p><p><related-object content-type="generated-dataset" id="data-ro1" source-id="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE15907" source-id-type="uri"><collab>Gopalan G</collab><x>,</x> <year>2009</year><x>,</x><source>Immunological Genome Project</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE15907">http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE15907</ext-link><x>,</x> <comment>Publicly available at the NCBI Gene Expression Omnibus (accession no: GSE15907)</comment></related-object></p><p><related-object content-type="generated-dataset" id="data-ro2" source-id="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE62270" source-id-type="uri"> <collab>Grün D</collab><x>,</x> <collab>Lyubimova A</collab><x>,</x> <collab>Kester L</collab><x>,</x> <collab>Wiebrands K</collab><x>,</x> <collab>Basak O</collab><x>,</x> <collab>Sasaki N</collab><x>,</x> <collab>Clevers H</collab><x>,</x> <collab>van Oudenaarden A</collab><x>,</x> <year>2015</year><x>,</x><source>Single-Cell mRNA Sequencing Reveals Rare Intestinal Cell Types</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE62270">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE62270</ext-link><x>,</x> <comment>Publicly available at the NCBI Gene Expression Omnibus (accession no: GSE62270)</comment></related-object></p><p><related-object content-type="generated-dataset" id="data-ro3" source-id="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE86982" source-id-type="uri"> <collab>Yao Z</collab><x>,</x> <collab>Mich JK</collab><x>,</x> <collab>Ku S</collab><x>,</x> <collab>Menon V</collab><x>,</x> <collab>Krostag A</collab><x>,</x> <collab>Martinez RA</collab><x>,</x> <collab>Grimley JS</collab><x>,</x> <collab>Wang Y</collab><x>,</x> <collab>Ramanathan S</collab><x>,</x> <collab>Levi BP</collab><x>,</x> <year>2016</year><x>,</x><source>Region-specific neural stem cell lineages revealed by single-cell rna-seq from human embryonic stem cells [Smart-seq]</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE86982">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE86982</ext-link><x>,</x> <comment>Publicly available at the NCBI Gene Expression Omnibus (accession no: GSE86982)</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abraham</surname><given-names>AB</given-names></name><name><surname>Bronstein</surname><given-names>R</given-names></name><name><surname>Chen</surname><given-names>EI</given-names></name><name><surname>Koller</surname><given-names>A</given-names></name><name><surname>Ronfani</surname><given-names>L</given-names></name><name><surname>Maletic-Savatic</surname><given-names>M</given-names></name><name><surname>Tsirka</surname><given-names>SE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Members of the high mobility group B protein family are dynamically expressed in embryonic neural stem cells</article-title><source>Proteome Science</source><volume>11</volume><elocation-id>18</elocation-id><pub-id pub-id-type="doi">10.1186/1477-5956-11-18</pub-id><pub-id pub-id-type="pmid">23621913</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adolfsson</surname><given-names>J</given-names></name><name><surname>Månsson</surname><given-names>R</given-names></name><name><surname>Buza-Vidas</surname><given-names>N</given-names></name><name><surname>Hultquist</surname><given-names>A</given-names></name><name><surname>Liuba</surname><given-names>K</given-names></name><name><surname>Jensen</surname><given-names>CT</given-names></name><name><surname>Bryder</surname><given-names>D</given-names></name><name><surname>Yang</surname><given-names>L</given-names></name><name><surname>Borge</surname><given-names>OJ</given-names></name><name><surname>Thoren</surname><given-names>LA</given-names></name><name><surname>Anderson</surname><given-names>K</given-names></name><name><surname>Sitnicka</surname><given-names>E</given-names></name><name><surname>Sasaki</surname><given-names>Y</given-names></name><name><surname>Sigvardsson</surname><given-names>M</given-names></name><name><surname>Jacobsen</surname><given-names>SE</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Identification of Flt3+ lympho-myeloid stem cells lacking erythro-megakaryocytic potential a revised road map for adult blood lineage commitment</article-title><source>Cell</source><volume>121</volume><fpage>295</fpage><lpage>306</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2005.02.013</pub-id><pub-id pub-id-type="pmid">15851035</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Advani</surname><given-names>M</given-names></name><name><surname>Ganguli</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Statistical mechanics of optimal convex inference in high dimensions</article-title><source>Physical Review X</source><volume>6</volume><elocation-id>031034</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevX.6.031034</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Agoston</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>N</given-names></name><name><surname>Haslinger</surname><given-names>A</given-names></name><name><surname>Wizenmann</surname><given-names>A</given-names></name><name><surname>Schulte</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Genetic and physical interaction of Meis2, Pax3 and Pax7 during dorsal midbrain development</article-title><source>BMC Developmental Biology</source><volume>12</volume><elocation-id>10</elocation-id><pub-id pub-id-type="doi">10.1186/1471-213X-12-10</pub-id><pub-id pub-id-type="pmid">22390724</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akashi</surname><given-names>K</given-names></name><name><surname>Traver</surname><given-names>D</given-names></name><name><surname>Miyamoto</surname><given-names>T</given-names></name><name><surname>Weissman</surname><given-names>IL</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>A clonogenic common myeloid progenitor that gives rise to all myeloid lineages</article-title><source>Nature</source><volume>404</volume><fpage>193</fpage><lpage>197</lpage><pub-id pub-id-type="doi">10.1038/35004599</pub-id><pub-id pub-id-type="pmid">10724173</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>Local moments and localized states</article-title><source>Reviews of Modern Physics</source><volume>50</volume><fpage>191</fpage><lpage>201</lpage><pub-id pub-id-type="doi">10.1103/RevModPhys.50.191</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ang</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Transcriptional control of midbrain dopaminergic neuron development</article-title><source>Development</source><volume>133</volume><fpage>3499</fpage><lpage>3506</lpage><pub-id pub-id-type="doi">10.1242/dev.02501</pub-id><pub-id pub-id-type="pmid">16899537</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Appolloni</surname><given-names>I</given-names></name><name><surname>Calzolari</surname><given-names>F</given-names></name><name><surname>Corte</surname><given-names>G</given-names></name><name><surname>Perris</surname><given-names>R</given-names></name><name><surname>Malatesta</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Six3 controls the neural progenitor status in the murine CNS</article-title><source>Cerebral Cortex</source><volume>18</volume><fpage>553</fpage><lpage>562</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhm092</pub-id><pub-id pub-id-type="pmid">17576749</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Au</surname><given-names>E</given-names></name><name><surname>Ahmed</surname><given-names>T</given-names></name><name><surname>Karayannis</surname><given-names>T</given-names></name><name><surname>Biswas</surname><given-names>S</given-names></name><name><surname>Gan</surname><given-names>L</given-names></name><name><surname>Fishell</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A modular gain-of-function approach to generate cortical interneuron subtypes from ES cells</article-title><source>Neuron</source><volume>80</volume><fpage>1145</fpage><lpage>1158</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.09.022</pub-id><pub-id pub-id-type="pmid">24314726</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Azim</surname><given-names>E</given-names></name><name><surname>Jabaudon</surname><given-names>D</given-names></name><name><surname>Fame</surname><given-names>RM</given-names></name><name><surname>Macklis</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>SOX6 controls dorsal progenitor identity and interneuron diversity during neocortical development</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>1238</fpage><lpage>1247</lpage><pub-id pub-id-type="doi">10.1038/nn.2387</pub-id><pub-id pub-id-type="pmid">19657336</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bani-Yaghoub</surname><given-names>M</given-names></name><name><surname>Tremblay</surname><given-names>RG</given-names></name><name><surname>Lei</surname><given-names>JX</given-names></name><name><surname>Zhang</surname><given-names>D</given-names></name><name><surname>Zurakowski</surname><given-names>B</given-names></name><name><surname>Sandhu</surname><given-names>JK</given-names></name><name><surname>Smith</surname><given-names>B</given-names></name><name><surname>Ribecco-Lutkiewicz</surname><given-names>M</given-names></name><name><surname>Kennedy</surname><given-names>J</given-names></name><name><surname>Walker</surname><given-names>PR</given-names></name><name><surname>Sikorska</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Role of Sox2 in the development of the mouse neocortex</article-title><source>Developmental Biology</source><volume>295</volume><fpage>52</fpage><lpage>66</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2006.03.007</pub-id><pub-id pub-id-type="pmid">16631155</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baraniuk</surname><given-names>RG</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Compressive sensing</article-title><source>IEEE signal processing magazine</source><volume>118</volume><fpage>12</fpage><lpage>13</lpage></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ben-Porath</surname><given-names>I</given-names></name><name><surname>Thomson</surname><given-names>MW</given-names></name><name><surname>Carey</surname><given-names>VJ</given-names></name><name><surname>Ge</surname><given-names>R</given-names></name><name><surname>Bell</surname><given-names>GW</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Weinberg</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>An embryonic stem cell-like gene expression signature in poorly differentiated aggressive human tumors</article-title><source>Nature Genetics</source><volume>40</volume><fpage>499</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1038/ng.127</pub-id><pub-id pub-id-type="pmid">18443585</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname> <given-names>Y</given-names></name><name><surname>Hochberg</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title><source>Journal of the Royal Statistical Society. Series B</source><volume>57</volume><fpage>289</fpage><lpage>3000</lpage></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borello</surname><given-names>U</given-names></name><name><surname>Madhavan</surname><given-names>M</given-names></name><name><surname>Vilinsky</surname><given-names>I</given-names></name><name><surname>Faedo</surname><given-names>A</given-names></name><name><surname>Pierani</surname><given-names>A</given-names></name><name><surname>Rubenstein</surname><given-names>J</given-names></name><name><surname>Campbell</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Sp8 and COUP-TF1 reciprocally regulate patterning and Fgf signaling in cortical progenitors</article-title><source>Cerebral Cortex</source><volume>24</volume><fpage>1409</fpage><lpage>1421</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhs412</pub-id><pub-id pub-id-type="pmid">23307639</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Botev</surname><given-names>ZI</given-names></name><name><surname>Grotowski</surname><given-names>JF</given-names></name><name><surname>Kroese</surname><given-names>DP</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Kernel density estimation via diffusion</article-title><source>The Annals of Statistics</source><volume>38</volume><fpage>2916</fpage><lpage>2957</lpage><pub-id pub-id-type="doi">10.1214/10-AOS799</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buck</surname><given-names>A</given-names></name><name><surname>Kispert</surname><given-names>A</given-names></name><name><surname>Kohlhase</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Embryonic expression of the murine homologue of SALL1, the gene mutated in Townes--Brocks syndrome</article-title><source>Mechanisms of Development</source><volume>104</volume><fpage>143</fpage><lpage>146</lpage><pub-id pub-id-type="doi">10.1016/S0925-4773(01)00364-1</pub-id><pub-id pub-id-type="pmid">11404093</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buckingham</surname><given-names>ME</given-names></name><name><surname>Meilhac</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Tracing cells for tracking cell lineage and clonal behavior</article-title><source>Developmental Cell</source><volume>21</volume><fpage>394</fpage><lpage>409</lpage><pub-id pub-id-type="doi">10.1016/j.devcel.2011.07.019</pub-id><pub-id pub-id-type="pmid">21920310</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Candès</surname><given-names>EJ</given-names></name><name><surname>Romberg</surname><given-names>JK</given-names></name><name><surname>Tao</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Stable signal recovery from incomplete and inaccurate measurements</article-title><source>Communications on Pure and Applied Mathematics</source><volume>59</volume><fpage>1207</fpage><lpage>1223</lpage><pub-id pub-id-type="doi">10.1002/cpa.20124</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>CY</given-names></name><name><surname>Pasolli</surname><given-names>HA</given-names></name><name><surname>Giannopoulou</surname><given-names>EG</given-names></name><name><surname>Guasch</surname><given-names>G</given-names></name><name><surname>Gronostajski</surname><given-names>RM</given-names></name><name><surname>Elemento</surname><given-names>O</given-names></name><name><surname>Fuchs</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>NFIB is a governor of epithelial-melanocyte stem cell behaviour in a shared niche</article-title><source>Nature</source><volume>495</volume><fpage>98</fpage><lpage>102</lpage><pub-id pub-id-type="doi">10.1038/nature11847</pub-id><pub-id pub-id-type="pmid">23389444</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cimadamore</surname><given-names>F</given-names></name><name><surname>Amador-Arjona</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>C</given-names></name><name><surname>Huang</surname><given-names>CT</given-names></name><name><surname>Terskikh</surname><given-names>AV</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>SOX2-LIN28/let-7 pathway regulates proliferation and neurogenesis in neural precursors</article-title><source>PNAS</source><volume>110</volume><fpage>E3017</fpage><lpage>3026</lpage><pub-id pub-id-type="doi">10.1073/pnas.1220176110</pub-id><pub-id pub-id-type="pmid">23884650</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Core Team</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><source>R: A Language and Environment for Statistical Computing</source></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crispino</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>GATA1 in normal and malignant hematopoiesis</article-title><source>Seminars in Cell &amp; Developmental Biology</source><volume>16</volume><fpage>137</fpage><lpage>147</lpage><pub-id pub-id-type="doi">10.1016/j.semcdb.2004.11.002</pub-id><pub-id pub-id-type="pmid">15659348</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cánovas</surname><given-names>J</given-names></name><name><surname>Berndt</surname><given-names>FA</given-names></name><name><surname>Sepúlveda</surname><given-names>H</given-names></name><name><surname>Aguilar</surname><given-names>R</given-names></name><name><surname>Veloso</surname><given-names>FA</given-names></name><name><surname>Montecino</surname><given-names>M</given-names></name><name><surname>Oliva</surname><given-names>C</given-names></name><name><surname>Maass</surname><given-names>JC</given-names></name><name><surname>Sierralta</surname><given-names>J</given-names></name><name><surname>Kukuljan</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The specification of cortical subcerebral projection neurons depends on the direct repression of TBR1 by CTIP1/BCL11a</article-title><source>Journal of Neuroscience</source><volume>35</volume><fpage>7552</fpage><lpage>7564</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0169-15.2015</pub-id><pub-id pub-id-type="pmid">25972180</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Santa Barbara</surname> <given-names>P</given-names></name><name><surname>van den Brink</surname><given-names>GR</given-names></name><name><surname>Roberts</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Development and differentiation of the intestinal epithelium</article-title><source>Cellular and Molecular Life Sciences</source><volume>60</volume><fpage>1322</fpage><lpage>1332</lpage><pub-id pub-id-type="doi">10.1007/s00018-003-2289-3</pub-id><pub-id pub-id-type="pmid">12943221</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delmans</surname><given-names>M</given-names></name><name><surname>Hemberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Discrete distributional differential expression (D3E)--a tool for gene expression analysis of single-cell RNA-seq data</article-title><source>BMC Bioinformatics</source><volume>17</volume><elocation-id>110</elocation-id><pub-id pub-id-type="doi">10.1186/s12859-016-0944-6</pub-id><pub-id pub-id-type="pmid">26927822</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Di Bonito</surname><given-names>M</given-names></name><name><surname>Narita</surname><given-names>Y</given-names></name><name><surname>Avallone</surname><given-names>B</given-names></name><name><surname>Sequino</surname><given-names>L</given-names></name><name><surname>Mancuso</surname><given-names>M</given-names></name><name><surname>Andolfi</surname><given-names>G</given-names></name><name><surname>Franzè</surname><given-names>AM</given-names></name><name><surname>Puelles</surname><given-names>L</given-names></name><name><surname>Rijli</surname><given-names>FM</given-names></name><name><surname>Studer</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Assembly of the auditory circuitry by a Hox genetic network in the mouse brainstem</article-title><source>PLoS Genetics</source><volume>9</volume><elocation-id>e1003249</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003249</pub-id><pub-id pub-id-type="pmid">23408898</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dominguez</surname><given-names>MH</given-names></name><name><surname>Ayoub</surname><given-names>AE</given-names></name><name><surname>Rakic</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>POU-III transcription factors (Brn1, Brn2, and Oct6) influence neurogenesis, molecular identity, and migratory destination of upper-layer cells of the cerebral cortex</article-title><source>Cerebral Cortex</source><volume>23</volume><fpage>2632</fpage><lpage>2643</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhs252</pub-id><pub-id pub-id-type="pmid">22892427</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donoho</surname><given-names>D</given-names></name><name><surname>Tanner</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Observed universality of phase transitions in high-dimensional geometry, with implications for modern data analysis and signal processing</article-title><source>Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences</source><volume>367</volume><fpage>4273</fpage><lpage>4293</lpage><pub-id pub-id-type="doi">10.1098/rsta.2009.0152</pub-id><pub-id pub-id-type="pmid">19805445</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duggan</surname> <given-names>SP</given-names></name><name><surname>Behan</surname><given-names>FM</given-names></name><name><surname>Kirca</surname><given-names>M</given-names></name><name><surname>Zaheer</surname><given-names>A</given-names></name><name><surname>McGarrigle</surname><given-names>SA</given-names></name><name><surname>Reynolds</surname><given-names>JV</given-names></name><name><surname>Vaz</surname><given-names>GM</given-names></name><name><surname>Senge</surname><given-names>MO</given-names></name><name><surname>Kelleher</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The characterization of an intestine-like genomic signature maintained during Barrett's-associated adenocarcinogenesis reveals an NR5A2-mediated promotion of cancer cell survival</article-title><source>Scientific Reports</source><volume>6</volume><elocation-id>32638</elocation-id><pub-id pub-id-type="doi">10.1038/srep32638</pub-id><pub-id pub-id-type="pmid">27586588</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ebisu</surname><given-names>H</given-names></name><name><surname>Iwai-Takekoshi</surname><given-names>L</given-names></name><name><surname>Fujita-Jimbo</surname><given-names>E</given-names></name><name><surname>Momoi</surname><given-names>T</given-names></name><name><surname>Kawasaki</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Foxp2 regulates identities and projection patterns of thalamic nuclei during development</article-title><source>Cerebral Cortex</source><elocation-id>bhw187</elocation-id><pub-id pub-id-type="doi">10.1093/cercor/bhw187</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elsen</surname><given-names>GE</given-names></name><name><surname>Choi</surname><given-names>LY</given-names></name><name><surname>Millen</surname><given-names>KJ</given-names></name><name><surname>Grinblat</surname><given-names>Y</given-names></name><name><surname>Prince</surname><given-names>VE</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Zic1 and Zic4 regulate zebrafish roof plate specification and hindbrain ventricle morphogenesis</article-title><source>Developmental Biology</source><volume>314</volume><fpage>376</fpage><lpage>392</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2007.12.006</pub-id><pub-id pub-id-type="pmid">18191121</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enkhmandakh</surname><given-names>B</given-names></name><name><surname>Makeyev</surname><given-names>AV</given-names></name><name><surname>Erdenechimeg</surname><given-names>L</given-names></name><name><surname>Ruddle</surname><given-names>FH</given-names></name><name><surname>Chimge</surname><given-names>NO</given-names></name><name><surname>Tussie-Luna</surname><given-names>MI</given-names></name><name><surname>Roy</surname><given-names>AL</given-names></name><name><surname>Bayarsaihan</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Essential functions of the Williams-Beuren syndrome-associated TFII-I genes in embryonic development</article-title><source>PNAS</source><volume>106</volume><fpage>181</fpage><lpage>186</lpage><pub-id pub-id-type="doi">10.1073/pnas.0811531106</pub-id><pub-id pub-id-type="pmid">19109438</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Erickson</surname><given-names>T</given-names></name><name><surname>French</surname><given-names>CR</given-names></name><name><surname>Waskiewicz</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Meis1 specifies positional information in the retina and tectum to organize the zebrafish visual system</article-title><source>Neural Development</source><volume>5</volume><elocation-id>22</elocation-id><pub-id pub-id-type="doi">10.1186/1749-8104-5-22</pub-id><pub-id pub-id-type="pmid">20809932</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fawcett</surname><given-names>SR</given-names></name><name><surname>Klymkowsky</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Embryonic expression of xenopus laevis SOX7</article-title><source>Gene Expression Patterns</source><volume>4</volume><fpage>29</fpage><lpage>33</lpage><pub-id pub-id-type="doi">10.1016/j.modgep.2003.08.003</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferrell</surname><given-names>JE</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Bistability, bifurcations, and Waddington's epigenetic landscape</article-title><source>Current Biology</source><volume>22</volume><fpage>R458</fpage><lpage>R466</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2012.03.045</pub-id><pub-id pub-id-type="pmid">22677291</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fre</surname> <given-names>S</given-names></name><name><surname>Huyghe</surname><given-names>M</given-names></name><name><surname>Mourikis</surname><given-names>P</given-names></name><name><surname>Robine</surname><given-names>S</given-names></name><name><surname>Louvard</surname><given-names>D</given-names></name><name><surname>Artavanis-Tsakonas</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Notch signals control the fate of immature progenitor cells in the intestine</article-title><source>Nature</source><volume>435</volume><fpage>964</fpage><lpage>968</lpage><pub-id pub-id-type="doi">10.1038/nature03589</pub-id><pub-id pub-id-type="pmid">15959516</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frumkin</surname><given-names>D</given-names></name><name><surname>Wasserstrom</surname><given-names>A</given-names></name><name><surname>Itzkovitz</surname><given-names>S</given-names></name><name><surname>Stern</surname><given-names>T</given-names></name><name><surname>Harmelin</surname><given-names>A</given-names></name><name><surname>Eilam</surname><given-names>R</given-names></name><name><surname>Rechavi</surname><given-names>G</given-names></name><name><surname>Shapiro</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Cell lineage analysis of a mouse tumor</article-title><source>Cancer Research</source><volume>68</volume><fpage>5924</fpage><lpage>5931</lpage><pub-id pub-id-type="doi">10.1158/0008-5472.CAN-07-6216</pub-id><pub-id pub-id-type="pmid">18632647</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcia</surname> <given-names>H</given-names></name><name><surname>Fleyshman</surname><given-names>D</given-names></name><name><surname>Kolesnikova</surname><given-names>K</given-names></name><name><surname>Safina</surname><given-names>A</given-names></name><name><surname>Commane</surname><given-names>M</given-names></name><name><surname>Paszkiewicz</surname><given-names>G</given-names></name><name><surname>Omelian</surname><given-names>A</given-names></name><name><surname>Morrison</surname><given-names>C</given-names></name><name><surname>Gurova</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Expression of FACT in mammalian tissues suggests its role in maintaining of undifferentiated state of cells</article-title><source>Oncotarget</source><volume>2</volume><fpage>783</fpage><lpage>796</lpage><pub-id pub-id-type="doi">10.18632/oncotarget.340</pub-id><pub-id pub-id-type="pmid">21998152</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaston-Massuet</surname><given-names>C</given-names></name><name><surname>McCabe</surname><given-names>MJ</given-names></name><name><surname>Scagliotti</surname><given-names>V</given-names></name><name><surname>Young</surname><given-names>RM</given-names></name><name><surname>Carreno</surname><given-names>G</given-names></name><name><surname>Gregory</surname><given-names>LC</given-names></name><name><surname>Jayakody</surname><given-names>SA</given-names></name><name><surname>Pozzi</surname><given-names>S</given-names></name><name><surname>Gualtieri</surname><given-names>A</given-names></name><name><surname>Basu</surname><given-names>B</given-names></name><name><surname>Koniordou</surname><given-names>M</given-names></name><name><surname>Wu</surname><given-names>CI</given-names></name><name><surname>Bancalari</surname><given-names>RE</given-names></name><name><surname>Rahikkala</surname><given-names>E</given-names></name><name><surname>Veijola</surname><given-names>R</given-names></name><name><surname>Lopponen</surname><given-names>T</given-names></name><name><surname>Graziola</surname><given-names>F</given-names></name><name><surname>Turton</surname><given-names>J</given-names></name><name><surname>Signore</surname><given-names>M</given-names></name><name><surname>Mousavy Gharavy</surname><given-names>SN</given-names></name><name><surname>Charolidi</surname><given-names>N</given-names></name><name><surname>Sokol</surname><given-names>SY</given-names></name><name><surname>Andoniadou</surname><given-names>CL</given-names></name><name><surname>Wilson</surname><given-names>SW</given-names></name><name><surname>Merrill</surname><given-names>BJ</given-names></name><name><surname>Dattani</surname><given-names>MT</given-names></name><name><surname>Martinez-Barbera</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Transcription factor 7-like 1 is involved in hypothalamo-pituitary axis development in mice and humans</article-title><source>PNAS</source><volume>113</volume><fpage>E548</fpage><lpage>557</lpage><pub-id pub-id-type="doi">10.1073/pnas.1503346113</pub-id><pub-id pub-id-type="pmid">26764381</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gazit</surname><given-names>R</given-names></name><name><surname>Garrison</surname><given-names>BS</given-names></name><name><surname>Rao</surname><given-names>TN</given-names></name><name><surname>Shay</surname><given-names>T</given-names></name><name><surname>Costello</surname><given-names>J</given-names></name><name><surname>Ericson</surname><given-names>J</given-names></name><name><surname>Kim</surname><given-names>F</given-names></name><name><surname>Collins</surname><given-names>JJ</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Wagers</surname><given-names>AJ</given-names></name><name><surname>Rossi</surname><given-names>DJ</given-names></name><collab>Immunological Genome Project Consortium</collab></person-group><year iso-8601-date="2013">2013</year><article-title>Transcriptome analysis identifies regulators of hematopoietic stem and progenitor cells</article-title><source>Stem Cell Reports</source><volume>1</volume><fpage>266</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1016/j.stemcr.2013.07.004</pub-id><pub-id pub-id-type="pmid">24319662</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gilbert</surname><given-names>SF</given-names></name></person-group><year iso-8601-date="2014">2014</year><source>Developmental biology</source><publisher-name>Sinauer</publisher-name></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goossens</surname><given-names>S</given-names></name><name><surname>Janzen</surname><given-names>V</given-names></name><name><surname>Bartunkova</surname><given-names>S</given-names></name><name><surname>Yokomizo</surname><given-names>T</given-names></name><name><surname>Drogat</surname><given-names>B</given-names></name><name><surname>Crisan</surname><given-names>M</given-names></name><name><surname>Haigh</surname><given-names>K</given-names></name><name><surname>Seuntjens</surname><given-names>E</given-names></name><name><surname>Umans</surname><given-names>L</given-names></name><name><surname>Riedt</surname><given-names>T</given-names></name><name><surname>Bogaert</surname><given-names>P</given-names></name><name><surname>Haenebalcke</surname><given-names>L</given-names></name><name><surname>Berx</surname><given-names>G</given-names></name><name><surname>Dzierzak</surname><given-names>E</given-names></name><name><surname>Huylebroeck</surname><given-names>D</given-names></name><name><surname>Haigh</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The EMT regulator Zeb2/Sip1 is essential for murine embryonic hematopoietic stem/progenitor cell differentiation and mobilization</article-title><source>Blood</source><volume>117</volume><fpage>5620</fpage><lpage>5630</lpage><pub-id pub-id-type="doi">10.1182/blood-2010-08-300236</pub-id><pub-id pub-id-type="pmid">21355089</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graf</surname><given-names>T</given-names></name><name><surname>Enver</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Forcing cells to change lineages</article-title><source>Nature</source><volume>462</volume><fpage>587</fpage><lpage>594</lpage><pub-id pub-id-type="doi">10.1038/nature08533</pub-id><pub-id pub-id-type="pmid">19956253</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greig</surname><given-names>LC</given-names></name><name><surname>Woodworth</surname><given-names>MB</given-names></name><name><surname>Galazo</surname><given-names>MJ</given-names></name><name><surname>Padmanabhan</surname><given-names>H</given-names></name><name><surname>Macklis</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Molecular logic of neocortical projection neuron specification, development and diversity</article-title><source>Nature Reviews Neuroscience</source><volume>14</volume><fpage>755</fpage><lpage>769</lpage><pub-id pub-id-type="doi">10.1038/nrn3586</pub-id><pub-id pub-id-type="pmid">24105342</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greig</surname><given-names>LC</given-names></name><name><surname>Woodworth</surname><given-names>MB</given-names></name><name><surname>Greppi</surname><given-names>C</given-names></name><name><surname>Macklis</surname><given-names>JD</given-names></name><name><surname>Abdel-Majid</surname><given-names>RM</given-names></name><name><surname>Leong</surname><given-names>WL</given-names></name><name><surname>Schalkwyk</surname><given-names>LC</given-names></name><name><surname>Smallman</surname><given-names>DS</given-names></name><name><surname>Wong</surname><given-names>ST</given-names></name><name><surname>Storm</surname><given-names>DR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Ctip1 controls acquisition of sensory area identity and establishment of sensory input fields in the developing neocortex</article-title><source>Neuron</source><volume>90</volume><fpage>261</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.03.008</pub-id><pub-id pub-id-type="pmid">27100196</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grün</surname><given-names>D</given-names></name><name><surname>Lyubimova</surname><given-names>A</given-names></name><name><surname>Kester</surname><given-names>L</given-names></name><name><surname>Wiebrands</surname><given-names>K</given-names></name><name><surname>Basak</surname><given-names>O</given-names></name><name><surname>Sasaki</surname><given-names>N</given-names></name><name><surname>Clevers</surname><given-names>H</given-names></name><name><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title><source>Nature</source><volume>525</volume><fpage>251</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1038/nature14966</pub-id><pub-id pub-id-type="pmid">26287467</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grün</surname><given-names>D</given-names></name><name><surname>Muraro</surname><given-names>MJ</given-names></name><name><surname>Boisset</surname><given-names>JC</given-names></name><name><surname>Wiebrands</surname><given-names>K</given-names></name><name><surname>Lyubimova</surname><given-names>A</given-names></name><name><surname>Dharmadhikari</surname><given-names>G</given-names></name><name><surname>van den Born</surname><given-names>M</given-names></name><name><surname>van Es</surname><given-names>J</given-names></name><name><surname>Jansen</surname><given-names>E</given-names></name><name><surname>Clevers</surname><given-names>H</given-names></name><name><surname>de Koning</surname><given-names>EJ</given-names></name><name><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>De novo prediction of stem cell identity using Single-Cell transcriptome data</article-title><source>Cell Stem Cell</source><volume>19</volume><fpage>266</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1016/j.stem.2016.05.010</pub-id><pub-id pub-id-type="pmid">27345837</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hagey</surname><given-names>DW</given-names></name><name><surname>Muhr</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Sox2 acts in a dose-dependent fashion to regulate proliferation of cortical progenitors</article-title><source>Cell Reports</source><volume>9</volume><fpage>1908</fpage><lpage>1920</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2014.11.013</pub-id><pub-id pub-id-type="pmid">25482558</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hegarty</surname><given-names>SV</given-names></name><name><surname>Sullivan</surname><given-names>AM</given-names></name><name><surname>O'Keeffe</surname><given-names>GW</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Midbrain dopaminergic neurons: a review of the molecular circuitry that regulates their development</article-title><source>Developmental Biology</source><volume>379</volume><fpage>123</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2013.04.014</pub-id><pub-id pub-id-type="pmid">23603197</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heng</surname><given-names>TS</given-names></name><name><surname>Painter</surname><given-names>MW</given-names></name><collab>Immunological Genome Project Consortium</collab></person-group><year iso-8601-date="2008">2008</year><article-title>The immunological genome project: networks of gene expression in immune cells</article-title><source>Nature Immunology</source><volume>9</volume><fpage>1091</fpage><lpage>1094</lpage><pub-id pub-id-type="doi">10.1038/ni1008-1091</pub-id><pub-id pub-id-type="pmid">18800157</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hutton</surname><given-names>SR</given-names></name><name><surname>Pevny</surname><given-names>LH</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>SOX2 expression levels distinguish between neural progenitor populations of the developing dorsal telencephalon</article-title><source>Developmental Biology</source><volume>352</volume><fpage>40</fpage><lpage>47</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2011.01.015</pub-id><pub-id pub-id-type="pmid">21256837</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Inoue</surname><given-names>F</given-names></name><name><surname>Kurokawa</surname><given-names>D</given-names></name><name><surname>Takahashi</surname><given-names>M</given-names></name><name><surname>Aizawa</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Gbx2 directly restricts Otx2 expression to forebrain and midbrain, competing with class III POU factors</article-title><source>Molecular and Cellular Biology</source><volume>32</volume><fpage>2618</fpage><lpage>2627</lpage><pub-id pub-id-type="doi">10.1128/MCB.00083-12</pub-id><pub-id pub-id-type="pmid">22566684</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iwasaki</surname><given-names>H</given-names></name><name><surname>Akashi</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Myeloid lineage commitment from the hematopoietic stem cell</article-title><source>Immunity</source><volume>26</volume><fpage>726</fpage><lpage>740</lpage><pub-id pub-id-type="doi">10.1016/j.immuni.2007.06.004</pub-id><pub-id pub-id-type="pmid">17582345</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jabaudon</surname><given-names>D</given-names></name><name><surname>Shnider</surname><given-names>SJ</given-names></name><name><surname>Tischfield</surname><given-names>DJ</given-names></name><name><surname>Galazo</surname><given-names>MJ</given-names></name><name><surname>Macklis</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Rorβ induces barrel-like neuronal clusters in the developing neocortex</article-title><source>Cerebral Cortex</source><volume>22</volume><fpage>996</fpage><lpage>1006</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhr182</pub-id><pub-id pub-id-type="pmid">21799210</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaegle</surname><given-names>M</given-names></name><name><surname>Ghazvini</surname><given-names>M</given-names></name><name><surname>Mandemakers</surname><given-names>W</given-names></name><name><surname>Piirsoo</surname><given-names>M</given-names></name><name><surname>Driegen</surname><given-names>S</given-names></name><name><surname>Levavasseur</surname><given-names>F</given-names></name><name><surname>Raghoenath</surname><given-names>S</given-names></name><name><surname>Grosveld</surname><given-names>F</given-names></name><name><surname>Meijer</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The POU proteins Brn-2 and Oct-6 share important functions in schwann cell development</article-title><source>Genes &amp; development</source><volume>17</volume><fpage>1380</fpage><lpage>1391</lpage><pub-id pub-id-type="doi">10.1101/gad.258203</pub-id><pub-id pub-id-type="pmid">12782656</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaitin</surname><given-names>DA</given-names></name><name><surname>Kenigsberg</surname><given-names>E</given-names></name><name><surname>Keren-Shaul</surname><given-names>H</given-names></name><name><surname>Elefant</surname><given-names>N</given-names></name><name><surname>Paul</surname><given-names>F</given-names></name><name><surname>Zaretsky</surname><given-names>I</given-names></name><name><surname>Mildner</surname><given-names>A</given-names></name><name><surname>Cohen</surname><given-names>N</given-names></name><name><surname>Jung</surname><given-names>S</given-names></name><name><surname>Tanay</surname><given-names>A</given-names></name><name><surname>Amit</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Massively parallel single-cell RNA-seq for marker-free decomposition of tissues into cell types</article-title><source>Science</source><volume>343</volume><fpage>776</fpage><lpage>779</lpage><pub-id pub-id-type="doi">10.1126/science.1247651</pub-id><pub-id pub-id-type="pmid">24531970</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jang</surname><given-names>S</given-names></name><name><surname>Furchtgott</surname><given-names>L</given-names></name><name><surname>Choubey</surname><given-names>S</given-names></name><name><surname>Zou</surname><given-names>L-N</given-names></name><name><surname>Doyle</surname><given-names>A</given-names></name><name><surname>Menon</surname><given-names>V</given-names></name><name><surname>Loew</surname><given-names>E</given-names></name><name><surname>Krostag</surname><given-names>A-R</given-names></name><name><surname>Martinez</surname><given-names>RA</given-names></name><name><surname>Madisen</surname><given-names>L</given-names></name><name><surname>Levi</surname><given-names>BP</given-names></name><name><surname>Ramanathan</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Probabilistic model of gene networks controlling embryonic stem cell differentiation inferred from single-cell transcriptomics</article-title><source>eLife</source><volume>6</volume><elocation-id>e20487</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.20487</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jenny</surname><given-names>M</given-names></name><name><surname>Uhl</surname><given-names>C</given-names></name><name><surname>Roche</surname><given-names>C</given-names></name><name><surname>Duluc</surname><given-names>I</given-names></name><name><surname>Guillermin</surname><given-names>V</given-names></name><name><surname>Guillemot</surname><given-names>F</given-names></name><name><surname>Jensen</surname><given-names>J</given-names></name><name><surname>Kedinger</surname><given-names>M</given-names></name><name><surname>Gradwohl</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Neurogenin3 is differentially required for endocrine cell fate specification in the intestinal and gastric epithelium</article-title><source>The EMBO Journal</source><volume>21</volume><fpage>6338</fpage><lpage>6347</lpage><pub-id pub-id-type="doi">10.1093/emboj/cdf649</pub-id><pub-id pub-id-type="pmid">12456641</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname><given-names>J</given-names></name><name><surname>Pedersen</surname><given-names>EE</given-names></name><name><surname>Galante</surname><given-names>P</given-names></name><name><surname>Hald</surname><given-names>J</given-names></name><name><surname>Heller</surname><given-names>RS</given-names></name><name><surname>Ishibashi</surname><given-names>M</given-names></name><name><surname>Kageyama</surname><given-names>R</given-names></name><name><surname>Guillemot</surname><given-names>F</given-names></name><name><surname>Serup</surname><given-names>P</given-names></name><name><surname>Madsen</surname><given-names>OD</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Control of endodermal endocrine development by Hes-1</article-title><source>Nature Genetics</source><volume>24</volume><fpage>36</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1038/71657</pub-id><pub-id pub-id-type="pmid">10615124</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ji</surname><given-names>Z</given-names></name><name><surname>Ji</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>TSCAN: Pseudo-time reconstruction and evaluation in single-cell RNA-seq analysis</article-title><source>Nucleic Acids Research</source><volume>44</volume><elocation-id>e117</elocation-id><pub-id pub-id-type="doi">10.1093/nar/gkw430</pub-id><pub-id pub-id-type="pmid">27179027</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johansson</surname><given-names>PA</given-names></name><name><surname>Irmler</surname><given-names>M</given-names></name><name><surname>Acampora</surname><given-names>D</given-names></name><name><surname>Beckers</surname><given-names>J</given-names></name><name><surname>Simeone</surname><given-names>A</given-names></name><name><surname>Götz</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The transcription factor Otx2 regulates choroid plexus development and function</article-title><source>Development</source><volume>140</volume><fpage>1055</fpage><lpage>1066</lpage><pub-id pub-id-type="doi">10.1242/dev.090860</pub-id><pub-id pub-id-type="pmid">23364326</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kameda</surname><given-names>Y</given-names></name><name><surname>Saitoh</surname><given-names>T</given-names></name><name><surname>Fujimura</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Hes1 regulates the number and anterior-posterior patterning of mesencephalic dopaminergic neurons at the mid/hindbrain boundary (isthmus)</article-title><source>Developmental Biology</source><volume>358</volume><fpage>91</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2011.07.016</pub-id><pub-id pub-id-type="pmid">21798254</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanatani</surname><given-names>S</given-names></name><name><surname>Yozu</surname><given-names>M</given-names></name><name><surname>Tabata</surname><given-names>H</given-names></name><name><surname>Nakajima</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>COUP-TFII is preferentially expressed in the caudal ganglionic eminence and is involved in the caudal migratory stream</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>13582</fpage><lpage>13591</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2132-08.2008</pub-id><pub-id pub-id-type="pmid">19074032</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katz</surname><given-names>JP</given-names></name><name><surname>Perreault</surname><given-names>N</given-names></name><name><surname>Goldstein</surname><given-names>BG</given-names></name><name><surname>Lee</surname><given-names>CS</given-names></name><name><surname>Labosky</surname><given-names>PA</given-names></name><name><surname>Yang</surname><given-names>VW</given-names></name><name><surname>Kaestner</surname><given-names>KH</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>The zinc-finger transcription factor Klf4 is required for terminal differentiation of goblet cells in the colon</article-title><source>Development</source><volume>129</volume><fpage>2619</fpage><lpage>2628</lpage><pub-id pub-id-type="pmid">12015290</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kessaris</surname><given-names>N</given-names></name><name><surname>Magno</surname><given-names>L</given-names></name><name><surname>Rubin</surname><given-names>AN</given-names></name><name><surname>Oliveira</surname><given-names>MG</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Genetic programs controlling cortical Interneuron fate</article-title><source>Current Opinion in Neurobiology</source><volume>26</volume><fpage>79</fpage><lpage>87</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2013.12.012</pub-id><pub-id pub-id-type="pmid">24440413</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname><given-names>WI</given-names></name><name><surname>Blennerhasset</surname><given-names>P</given-names></name><name><surname>Ma</surname><given-names>C</given-names></name><name><surname>Matthaei</surname><given-names>KI</given-names></name><name><surname>Collins</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Stat6 dependent goblet cell hyperplasia during intestinal nematode infection</article-title><source>Parasite Immunology</source><volume>23</volume><fpage>39</fpage><lpage>42</lpage><pub-id pub-id-type="doi">10.1046/j.1365-3024.2001.00353.x</pub-id><pub-id pub-id-type="pmid">11136476</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kikkawa</surname><given-names>T</given-names></name><name><surname>Obayashi</surname><given-names>T</given-names></name><name><surname>Takahashi</surname><given-names>M</given-names></name><name><surname>Fukuzaki-Dohi</surname><given-names>U</given-names></name><name><surname>Numayama-Tsuruta</surname><given-names>K</given-names></name><name><surname>Osumi</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Dmrta1 regulates proneural gene expression downstream of Pax6 in the mammalian telencephalon</article-title><source>Genes to Cells</source><volume>18</volume><fpage>636</fpage><lpage>649</lpage><pub-id pub-id-type="doi">10.1111/gtc.12061</pub-id><pub-id pub-id-type="pmid">23679989</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kishi</surname><given-names>Y</given-names></name><name><surname>Fujii</surname><given-names>Y</given-names></name><name><surname>Hirabayashi</surname><given-names>Y</given-names></name><name><surname>Gotoh</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>HMGA regulates the global chromatin state and neurogenic potential in neocortical precursor cells</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1127</fpage><lpage>1133</lpage><pub-id pub-id-type="doi">10.1038/nn.3165</pub-id><pub-id pub-id-type="pmid">22797695</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knight</surname><given-names>JM</given-names></name><name><surname>Davidson</surname><given-names>LA</given-names></name><name><surname>Herman</surname><given-names>D</given-names></name><name><surname>Martin</surname><given-names>CR</given-names></name><name><surname>Goldsby</surname><given-names>JS</given-names></name><name><surname>Ivanov</surname><given-names>IV</given-names></name><name><surname>Donovan</surname><given-names>SM</given-names></name><name><surname>Chapkin</surname><given-names>RS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Non-invasive analysis of intestinal development in preterm and term infants using RNA-Sequencing</article-title><source>Scientific Reports</source><volume>4</volume><fpage>159</fpage><lpage>173</lpage><pub-id pub-id-type="doi">10.1038/srep05453</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kondo</surname><given-names>M</given-names></name><name><surname>Weissman</surname><given-names>IL</given-names></name><name><surname>Akashi</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Identification of clonogenic common lymphoid progenitors in mouse bone marrow</article-title><source>Cell</source><volume>91</volume><fpage>661</fpage><lpage>672</lpage><pub-id pub-id-type="doi">10.1016/S0092-8674(00)80453-5</pub-id><pub-id pub-id-type="pmid">9393859</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumbasar</surname><given-names>A</given-names></name><name><surname>Plachez</surname><given-names>C</given-names></name><name><surname>Gronostajski</surname><given-names>RM</given-names></name><name><surname>Richards</surname><given-names>LJ</given-names></name><name><surname>Litwack</surname><given-names>ED</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Absence of the transcription factor <italic>Nfib</italic> delays the formation of the basilar pontine and other mossy fiber nuclei</article-title><source>The Journal of Comparative Neurology</source><volume>513</volume><fpage>98</fpage><lpage>112</lpage><pub-id pub-id-type="doi">10.1002/cne.21943</pub-id><pub-id pub-id-type="pmid">19107796</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kunath</surname><given-names>M</given-names></name><name><surname>Lüdecke</surname><given-names>HJ</given-names></name><name><surname>Vortkamp</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Expression of Trps1 during mouse embryonic development</article-title><source>Mechanisms of Development</source><volume>119 Suppl 1</volume><fpage>S117</fpage><lpage>120</lpage><pub-id pub-id-type="doi">10.1016/S0925-4773(03)00103-5</pub-id><pub-id pub-id-type="pmid">14516672</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kurotaki</surname><given-names>D</given-names></name><name><surname>Osato</surname><given-names>N</given-names></name><name><surname>Nishiyama</surname><given-names>A</given-names></name><name><surname>Yamamoto</surname><given-names>M</given-names></name><name><surname>Ban</surname><given-names>T</given-names></name><name><surname>Sato</surname><given-names>H</given-names></name><name><surname>Nakabayashi</surname><given-names>J</given-names></name><name><surname>Umehara</surname><given-names>M</given-names></name><name><surname>Miyake</surname><given-names>N</given-names></name><name><surname>Matsumoto</surname><given-names>N</given-names></name><name><surname>Nakazawa</surname><given-names>M</given-names></name><name><surname>Ozato</surname><given-names>K</given-names></name><name><surname>Tamura</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Essential role of the IRF8-KLF4 transcription factor cascade in murine monocyte differentiation</article-title><source>Blood</source><volume>121</volume><fpage>1839</fpage><lpage>1849</lpage><pub-id pub-id-type="doi">10.1182/blood-2012-06-437863</pub-id><pub-id pub-id-type="pmid">23319570</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Landau</surname><given-names>LD</given-names></name><name><surname>Lifshitz</surname><given-names>EM</given-names></name></person-group><year iso-8601-date="1951">1951</year><source>Statistical Physics</source><publisher-name>Elsevier</publisher-name><volume>5</volume><ext-link ext-link-type="uri" xlink:href="https://books.google.com/books?id=VzgJN-XPTRsC&amp;pgis=1">https://books.google.com/books?id=VzgJN-XPTRsC&amp;pgis=1</ext-link></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lavado</surname><given-names>A</given-names></name><name><surname>Oliver</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Prox1 expression patterns in the developing and adult murine brain</article-title><source>Developmental Dynamics</source><volume>236</volume><fpage>518</fpage><lpage>524</lpage><pub-id pub-id-type="doi">10.1002/dvdy.21024</pub-id><pub-id pub-id-type="pmid">17117441</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>X</given-names></name><name><surname>Udager</surname><given-names>AM</given-names></name><name><surname>Hu</surname><given-names>C</given-names></name><name><surname>Qiao</surname><given-names>XT</given-names></name><name><surname>Richards</surname><given-names>N</given-names></name><name><surname>Gumucio</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Dynamic patterning at the pylorus: formation of an epithelial intestine-stomach boundary in late fetal life</article-title><source>Developmental Dynamics</source><volume>238</volume><fpage>3205</fpage><lpage>3217</lpage><pub-id pub-id-type="doi">10.1002/dvdy.22134</pub-id><pub-id pub-id-type="pmid">19877272</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lodato</surname><given-names>S</given-names></name><name><surname>Molyneaux</surname><given-names>BJ</given-names></name><name><surname>Zuccaro</surname><given-names>E</given-names></name><name><surname>Goff</surname><given-names>LA</given-names></name><name><surname>Chen</surname><given-names>HH</given-names></name><name><surname>Yuan</surname><given-names>W</given-names></name><name><surname>Meleski</surname><given-names>A</given-names></name><name><surname>Takahashi</surname><given-names>E</given-names></name><name><surname>Mahony</surname><given-names>S</given-names></name><name><surname>Rinn</surname><given-names>JL</given-names></name><name><surname>Gifford</surname><given-names>DK</given-names></name><name><surname>Arlotta</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Gene co-regulation by Fezf2 selects neurotransmitter identity and connectivity of corticospinal neurons</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>1046</fpage><lpage>1054</lpage><pub-id pub-id-type="doi">10.1038/nn.3757</pub-id><pub-id pub-id-type="pmid">24997765</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lorente-Trigos</surname><given-names>A</given-names></name><name><surname>Varnat</surname><given-names>F</given-names></name><name><surname>Melotti</surname><given-names>A</given-names></name><name><surname>Ruiz i Altaba</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>BMP signaling promotes the growth of primary human colon carcinomas in vivo</article-title><source>Journal of Molecular Cell Biology</source><volume>2</volume><fpage>318</fpage><lpage>332</lpage><pub-id pub-id-type="doi">10.1093/jmcb/mjq035</pub-id><pub-id pub-id-type="pmid">21098050</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Basu</surname><given-names>A</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name><name><surname>Nemesh</surname><given-names>J</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Goldman</surname><given-names>M</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Bialas</surname><given-names>AR</given-names></name><name><surname>Kamitaki</surname><given-names>N</given-names></name><name><surname>Martersteck</surname><given-names>EM</given-names></name><name><surname>Trombetta</surname><given-names>JJ</given-names></name><name><surname>Weitz</surname><given-names>DA</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Shalek</surname><given-names>AK</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>McCarroll</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Highly parallel Genome-wide expression profiling of individual cells using nanoliter droplets</article-title><source>Cell</source><volume>161</volume><fpage>1202</fpage><lpage>1214</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id><pub-id pub-id-type="pmid">26000488</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Madissoon</surname><given-names>E</given-names></name><name><surname>Jouhilahti</surname><given-names>EM</given-names></name><name><surname>Vesterlund</surname><given-names>L</given-names></name><name><surname>Töhönen</surname><given-names>V</given-names></name><name><surname>Krjutškov</surname><given-names>K</given-names></name><name><surname>Petropoulous</surname><given-names>S</given-names></name><name><surname>Einarsdottir</surname><given-names>E</given-names></name><name><surname>Linnarsson</surname><given-names>S</given-names></name><name><surname>Lanner</surname><given-names>F</given-names></name><name><surname>Månsson</surname><given-names>R</given-names></name><name><surname>Hovatta</surname><given-names>O</given-names></name><name><surname>Bürglin</surname><given-names>TR</given-names></name><name><surname>Katayama</surname><given-names>S</given-names></name><name><surname>Kere</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Characterization and target genes of nine human PRD-like homeobox domain genes expressed exclusively in early embryos</article-title><source>Scientific Reports</source><volume>6</volume><elocation-id>28995</elocation-id><pub-id pub-id-type="doi">10.1038/srep28995</pub-id><pub-id pub-id-type="pmid">27412763</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manuel</surname><given-names>MN</given-names></name><name><surname>Martynoga</surname><given-names>B</given-names></name><name><surname>Molinek</surname><given-names>MD</given-names></name><name><surname>Quinn</surname><given-names>JC</given-names></name><name><surname>Kroemmer</surname><given-names>C</given-names></name><name><surname>Mason</surname><given-names>JO</given-names></name><name><surname>Price</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The transcription factor Foxg1 regulates telencephalic progenitor proliferation cell autonomously, in part by controlling Pax6 expression levels</article-title><source>Neural Development</source><volume>6</volume><elocation-id>9</elocation-id><pub-id pub-id-type="doi">10.1186/1749-8104-6-9</pub-id><pub-id pub-id-type="pmid">21418559</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marco</surname><given-names>E</given-names></name><name><surname>Karp</surname><given-names>RL</given-names></name><name><surname>Guo</surname><given-names>G</given-names></name><name><surname>Robson</surname><given-names>P</given-names></name><name><surname>Hart</surname><given-names>AH</given-names></name><name><surname>Trippa</surname><given-names>L</given-names></name><name><surname>Yuan</surname><given-names>GC</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Bifurcation analysis of single-cell gene expression data reveals epigenetic landscape</article-title><source>PNAS</source><volume>111</volume><fpage>E5643</fpage><lpage>E5650</lpage><pub-id pub-id-type="doi">10.1073/pnas.1408993111</pub-id><pub-id pub-id-type="pmid">25512504</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marjoram</surname><given-names>L</given-names></name><name><surname>Alvers</surname><given-names>A</given-names></name><name><surname>Deerhake</surname><given-names>ME</given-names></name><name><surname>Bagwell</surname><given-names>J</given-names></name><name><surname>Mankiewicz</surname><given-names>J</given-names></name><name><surname>Cocchiaro</surname><given-names>JL</given-names></name><name><surname>Beerman</surname><given-names>RW</given-names></name><name><surname>Willer</surname><given-names>J</given-names></name><name><surname>Sumigray</surname><given-names>KD</given-names></name><name><surname>Katsanis</surname><given-names>N</given-names></name><name><surname>Tobin</surname><given-names>DM</given-names></name><name><surname>Rawls</surname><given-names>JF</given-names></name><name><surname>Goll</surname><given-names>MG</given-names></name><name><surname>Bagnat</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Epigenetic control of intestinal barrier function and inflammation in zebrafish</article-title><source>PNAS</source><volume>112</volume><fpage>2770</fpage><lpage>2775</lpage><pub-id pub-id-type="doi">10.1073/pnas.1424089112</pub-id><pub-id pub-id-type="pmid">25730872</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsui</surname><given-names>H</given-names></name><name><surname>Kimura</surname><given-names>A</given-names></name><name><surname>Yamashiki</surname><given-names>N</given-names></name><name><surname>Moriyama</surname><given-names>A</given-names></name><name><surname>Kaya</surname><given-names>M</given-names></name><name><surname>Yoshida</surname><given-names>I</given-names></name><name><surname>Takagi</surname><given-names>N</given-names></name><name><surname>Takahashi</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Molecular and biochemical characterization of a serine proteinase predominantly expressed in the medulla oblongata and cerebellar white matter of mouse brain</article-title><source>Journal of Biological Chemistry</source><volume>275</volume><fpage>11050</fpage><lpage>11057</lpage><pub-id pub-id-type="doi">10.1074/jbc.275.15.11050</pub-id><pub-id pub-id-type="pmid">10753908</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGibbon</surname><given-names>RT</given-names></name><name><surname>Husic</surname><given-names>BE</given-names></name><name><surname>Pande</surname><given-names>VS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Identification of simple reaction coordinates from complex dynamics</article-title><source>The Journal of Chemical Physics</source><volume>146</volume><elocation-id>044109</elocation-id><pub-id pub-id-type="doi">10.1063/1.4974306</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mellor</surname><given-names>P</given-names></name><name><surname>Deibert</surname><given-names>L</given-names></name><name><surname>Calvert</surname><given-names>B</given-names></name><name><surname>Bonham</surname><given-names>K</given-names></name><name><surname>Carlsen</surname><given-names>SA</given-names></name><name><surname>Anderson</surname><given-names>DH</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>CREB3L1 is a metastasis suppressor that represses expression of genes regulating metastasis, invasion, and angiogenesis</article-title><source>Molecular and Cellular Biology</source><volume>33</volume><fpage>4985</fpage><lpage>4995</lpage><pub-id pub-id-type="doi">10.1128/MCB.00959-13</pub-id><pub-id pub-id-type="pmid">24126059</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merrill</surname><given-names>BJ</given-names></name><name><surname>Gat</surname><given-names>U</given-names></name><name><surname>DasGupta</surname><given-names>R</given-names></name><name><surname>Fuchs</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Tcf3 and Lef1 regulate lineage differentiation of multipotent stem cells in skin</article-title><source>Genes &amp; Development</source><volume>15</volume><fpage>1688</fpage><lpage>1705</lpage><pub-id pub-id-type="doi">10.1101/gad.891401</pub-id><pub-id pub-id-type="pmid">11445543</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>JA</given-names></name><name><surname>Ding</surname><given-names>SL</given-names></name><name><surname>Sunkin</surname><given-names>SM</given-names></name><name><surname>Smith</surname><given-names>KA</given-names></name><name><surname>Ng</surname><given-names>L</given-names></name><name><surname>Szafer</surname><given-names>A</given-names></name><name><surname>Ebbert</surname><given-names>A</given-names></name><name><surname>Riley</surname><given-names>ZL</given-names></name><name><surname>Royall</surname><given-names>JJ</given-names></name><name><surname>Aiona</surname><given-names>K</given-names></name><name><surname>Arnold</surname><given-names>JM</given-names></name><name><surname>Bennet</surname><given-names>C</given-names></name><name><surname>Bertagnolli</surname><given-names>D</given-names></name><name><surname>Brouner</surname><given-names>K</given-names></name><name><surname>Butler</surname><given-names>S</given-names></name><name><surname>Caldejon</surname><given-names>S</given-names></name><name><surname>Carey</surname><given-names>A</given-names></name><name><surname>Cuhaciyan</surname><given-names>C</given-names></name><name><surname>Dalley</surname><given-names>RA</given-names></name><name><surname>Dee</surname><given-names>N</given-names></name><name><surname>Dolbeare</surname><given-names>TA</given-names></name><name><surname>Facer</surname><given-names>BA</given-names></name><name><surname>Feng</surname><given-names>D</given-names></name><name><surname>Fliss</surname><given-names>TP</given-names></name><name><surname>Gee</surname><given-names>G</given-names></name><name><surname>Goldy</surname><given-names>J</given-names></name><name><surname>Gourley</surname><given-names>L</given-names></name><name><surname>Gregor</surname><given-names>BW</given-names></name><name><surname>Gu</surname><given-names>G</given-names></name><name><surname>Howard</surname><given-names>RE</given-names></name><name><surname>Jochim</surname><given-names>JM</given-names></name><name><surname>Kuan</surname><given-names>CL</given-names></name><name><surname>Lau</surname><given-names>C</given-names></name><name><surname>Lee</surname><given-names>CK</given-names></name><name><surname>Lee</surname><given-names>F</given-names></name><name><surname>Lemon</surname><given-names>TA</given-names></name><name><surname>Lesnar</surname><given-names>P</given-names></name><name><surname>McMurray</surname><given-names>B</given-names></name><name><surname>Mastan</surname><given-names>N</given-names></name><name><surname>Mosqueda</surname><given-names>N</given-names></name><name><surname>Naluai-Cecchini</surname><given-names>T</given-names></name><name><surname>Ngo</surname><given-names>NK</given-names></name><name><surname>Nyhus</surname><given-names>J</given-names></name><name><surname>Oldre</surname><given-names>A</given-names></name><name><surname>Olson</surname><given-names>E</given-names></name><name><surname>Parente</surname><given-names>J</given-names></name><name><surname>Parker</surname><given-names>PD</given-names></name><name><surname>Parry</surname><given-names>SE</given-names></name><name><surname>Stevens</surname><given-names>A</given-names></name><name><surname>Pletikos</surname><given-names>M</given-names></name><name><surname>Reding</surname><given-names>M</given-names></name><name><surname>Roll</surname><given-names>K</given-names></name><name><surname>Sandman</surname><given-names>D</given-names></name><name><surname>Sarreal</surname><given-names>M</given-names></name><name><surname>Shapouri</surname><given-names>S</given-names></name><name><surname>Shapovalova</surname><given-names>NV</given-names></name><name><surname>Shen</surname><given-names>EH</given-names></name><name><surname>Sjoquist</surname><given-names>N</given-names></name><name><surname>Slaughterbeck</surname><given-names>CR</given-names></name><name><surname>Smith</surname><given-names>M</given-names></name><name><surname>Sodt</surname><given-names>AJ</given-names></name><name><surname>Williams</surname><given-names>D</given-names></name><name><surname>Zöllei</surname><given-names>L</given-names></name><name><surname>Fischl</surname><given-names>B</given-names></name><name><surname>Gerstein</surname><given-names>MB</given-names></name><name><surname>Geschwind</surname><given-names>DH</given-names></name><name><surname>Glass</surname><given-names>IA</given-names></name><name><surname>Hawrylycz</surname><given-names>MJ</given-names></name><name><surname>Hevner</surname><given-names>RF</given-names></name><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Jones</surname><given-names>AR</given-names></name><name><surname>Knowles</surname><given-names>JA</given-names></name><name><surname>Levitt</surname><given-names>P</given-names></name><name><surname>Phillips</surname><given-names>JW</given-names></name><name><surname>Sestan</surname><given-names>N</given-names></name><name><surname>Wohnoutka</surname><given-names>P</given-names></name><name><surname>Dang</surname><given-names>C</given-names></name><name><surname>Bernard</surname><given-names>A</given-names></name><name><surname>Hohmann</surname><given-names>JG</given-names></name><name><surname>Lein</surname><given-names>ES</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Transcriptional landscape of the prenatal human brain</article-title><source>Nature</source><volume>508</volume><fpage>199</fpage><lpage>206</lpage><pub-id pub-id-type="doi">10.1038/nature13185</pub-id><pub-id pub-id-type="pmid">24695229</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>RL</given-names></name><name><surname>Stein</surname><given-names>MK</given-names></name><name><surname>Loewy</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Serotonergic inputs to FoxP2 neurons of the pre-locus coeruleus and parabrachial nuclei that project to the ventral tegmental area</article-title><source>Neuroscience</source><volume>193</volume><fpage>229</fpage><lpage>240</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2011.07.008</pub-id><pub-id pub-id-type="pmid">21784133</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milosevic</surname><given-names>J</given-names></name><name><surname>Maisel</surname><given-names>M</given-names></name><name><surname>Wegner</surname><given-names>F</given-names></name><name><surname>Leuchtenberger</surname><given-names>J</given-names></name><name><surname>Wenger</surname><given-names>RH</given-names></name><name><surname>Gerlach</surname><given-names>M</given-names></name><name><surname>Storch</surname><given-names>A</given-names></name><name><surname>Schwarz</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Lack of hypoxia-inducible factor-1 alpha impairs midbrain neural precursor cells involving vascular endothelial growth factor signaling</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>412</fpage><lpage>421</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2482-06.2007</pub-id><pub-id pub-id-type="pmid">17215402</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miyawaki</surname><given-names>K</given-names></name><name><surname>Arinobu</surname><given-names>Y</given-names></name><name><surname>Iwasaki</surname><given-names>H</given-names></name><name><surname>Kohno</surname><given-names>K</given-names></name><name><surname>Tsuzuki</surname><given-names>H</given-names></name><name><surname>Iino</surname><given-names>T</given-names></name><name><surname>Shima</surname><given-names>T</given-names></name><name><surname>Kikushige</surname><given-names>Y</given-names></name><name><surname>Takenaka</surname><given-names>K</given-names></name><name><surname>Miyamoto</surname><given-names>T</given-names></name><name><surname>Akashi</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>CD41 marks the initial myelo-erythroid lineage specification in adult mouse hematopoiesis: redefinition of murine common myeloid progenitor</article-title><source>Stem Cells</source><volume>33</volume><fpage>976</fpage><lpage>987</lpage><pub-id pub-id-type="doi">10.1002/stem.1906</pub-id><pub-id pub-id-type="pmid">25446279</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miyoshi</surname><given-names>G</given-names></name><name><surname>Fishell</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Dynamic FoxG1 expression coordinates the integration of Multipolar pyramidal neuron precursors into the cortical plate</article-title><source>Neuron</source><volume>74</volume><fpage>1045</fpage><lpage>1058</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.04.025</pub-id><pub-id pub-id-type="pmid">22726835</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muncan</surname><given-names>V</given-names></name><name><surname>Sansom</surname><given-names>OJ</given-names></name><name><surname>Tertoolen</surname><given-names>L</given-names></name><name><surname>Phesse</surname><given-names>TJ</given-names></name><name><surname>Begthel</surname><given-names>H</given-names></name><name><surname>Sancho</surname><given-names>E</given-names></name><name><surname>Cole</surname><given-names>AM</given-names></name><name><surname>Gregorieff</surname><given-names>A</given-names></name><name><surname>de Alboran</surname><given-names>IM</given-names></name><name><surname>Clevers</surname><given-names>H</given-names></name><name><surname>Clarke</surname><given-names>AR</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Rapid loss of intestinal crypts upon conditional deletion of the Wnt/Tcf-4 target gene c-Myc</article-title><source>Molecular and Cellular Biology</source><volume>26</volume><fpage>8418</fpage><lpage>8426</lpage><pub-id pub-id-type="doi">10.1128/MCB.00821-06</pub-id><pub-id pub-id-type="pmid">16954380</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Negishi</surname><given-names>H</given-names></name><name><surname>Miki</surname><given-names>S</given-names></name><name><surname>Sarashina</surname><given-names>H</given-names></name><name><surname>Taguchi-Atarashi</surname><given-names>N</given-names></name><name><surname>Nakajima</surname><given-names>A</given-names></name><name><surname>Matsuki</surname><given-names>K</given-names></name><name><surname>Endo</surname><given-names>N</given-names></name><name><surname>Yanai</surname><given-names>H</given-names></name><name><surname>Nishio</surname><given-names>J</given-names></name><name><surname>Honda</surname><given-names>K</given-names></name><name><surname>Taniguchi</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Essential contribution of IRF3 to intestinal homeostasis and microbiota-mediated Tslp gene induction</article-title><source>PNAS</source><volume>109</volume><fpage>21016</fpage><lpage>21021</lpage><pub-id pub-id-type="doi">10.1073/pnas.1219482110</pub-id><pub-id pub-id-type="pmid">23213237</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Noah</surname><given-names>TK</given-names></name><name><surname>Kazanjian</surname><given-names>A</given-names></name><name><surname>Whitsett</surname><given-names>J</given-names></name><name><surname>Shroyer</surname><given-names>NF</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>SAM pointed domain ETS factor (SPDEF) regulates terminal differentiation and maturation of intestinal goblet cells</article-title><source>Experimental Cell Research</source><volume>316</volume><fpage>452</fpage><lpage>465</lpage><pub-id pub-id-type="doi">10.1016/j.yexcr.2009.09.020</pub-id><pub-id pub-id-type="pmid">19786015</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohba</surname><given-names>H</given-names></name><name><surname>Chiyoda</surname><given-names>T</given-names></name><name><surname>Endo</surname><given-names>E</given-names></name><name><surname>Yano</surname><given-names>M</given-names></name><name><surname>Hayakawa</surname><given-names>Y</given-names></name><name><surname>Sakaguchi</surname><given-names>M</given-names></name><name><surname>Darnell</surname><given-names>RB</given-names></name><name><surname>Okano</surname><given-names>HJ</given-names></name><name><surname>Okano</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Sox21 is a repressor of neuronal differentiation and is antagonized by YB-1</article-title><source>Neuroscience Letters</source><volume>358</volume><fpage>157</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1016/j.neulet.2004.01.026</pub-id><pub-id pub-id-type="pmid">15039105</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohtsuka</surname><given-names>T</given-names></name><name><surname>Sakamoto</surname><given-names>M</given-names></name><name><surname>Guillemot</surname><given-names>F</given-names></name><name><surname>Kageyama</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Roles of the basic helix-loop-helix genes Hes1 and Hes5 in expansion of neural stem cells of the developing brain</article-title><source>Journal of Biological Chemistry</source><volume>276</volume><fpage>30467</fpage><lpage>30474</lpage><pub-id pub-id-type="doi">10.1074/jbc.M102420200</pub-id><pub-id pub-id-type="pmid">11399758</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olivetti</surname><given-names>PR</given-names></name><name><surname>Noebels</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Interneuron, interrupted: molecular pathogenesis of ARX mutations and X-linked infantile spasms</article-title><source>Current Opinion in Neurobiology</source><volume>22</volume><fpage>859</fpage><lpage>865</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2012.04.006</pub-id><pub-id pub-id-type="pmid">22565167</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orkin</surname><given-names>SH</given-names></name><name><surname>Zon</surname><given-names>LI</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Hematopoiesis: an evolving paradigm for stem cell biology</article-title><source>Cell</source><volume>132</volume><fpage>631</fpage><lpage>644</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2008.01.025</pub-id><pub-id pub-id-type="pmid">18295580</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patel</surname><given-names>AP</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Trombetta</surname><given-names>JJ</given-names></name><name><surname>Shalek</surname><given-names>AK</given-names></name><name><surname>Gillespie</surname><given-names>SM</given-names></name><name><surname>Wakimoto</surname><given-names>H</given-names></name><name><surname>Cahill</surname><given-names>DP</given-names></name><name><surname>Nahed</surname><given-names>BV</given-names></name><name><surname>Curry</surname><given-names>WT</given-names></name><name><surname>Martuza</surname><given-names>RL</given-names></name><name><surname>Louis</surname><given-names>DN</given-names></name><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name><name><surname>Suvà</surname><given-names>ML</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Bernstein</surname><given-names>BE</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title><source>Science</source><volume>344</volume><fpage>1396</fpage><lpage>1401</lpage><pub-id pub-id-type="doi">10.1126/science.1254257</pub-id><pub-id pub-id-type="pmid">24925914</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paul</surname><given-names>F</given-names></name><name><surname>Arkin</surname><given-names>Y</given-names></name><name><surname>Giladi</surname><given-names>A</given-names></name><name><surname>Jaitin</surname><given-names>DA</given-names></name><name><surname>Kenigsberg</surname><given-names>E</given-names></name><name><surname>Keren-Shaul</surname><given-names>H</given-names></name><name><surname>Winter</surname><given-names>D</given-names></name><name><surname>Lara-Astiaso</surname><given-names>D</given-names></name><name><surname>Gury</surname><given-names>M</given-names></name><name><surname>Weiner</surname><given-names>A</given-names></name><name><surname>David</surname><given-names>E</given-names></name><name><surname>Cohen</surname><given-names>N</given-names></name><name><surname>Lauridsen</surname><given-names>FK</given-names></name><name><surname>Haas</surname><given-names>S</given-names></name><name><surname>Schlitzer</surname><given-names>A</given-names></name><name><surname>Mildner</surname><given-names>A</given-names></name><name><surname>Ginhoux</surname><given-names>F</given-names></name><name><surname>Jung</surname><given-names>S</given-names></name><name><surname>Trumpp</surname><given-names>A</given-names></name><name><surname>Porse</surname><given-names>BT</given-names></name><name><surname>Tanay</surname><given-names>A</given-names></name><name><surname>Amit</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Transcriptional heterogeneity and lineage commitment in myeloid progenitors</article-title><source>Cell</source><volume>163</volume><fpage>1663</fpage><lpage>1677</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.11.013</pub-id><pub-id pub-id-type="pmid">26627738</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perrimon</surname><given-names>N</given-names></name><name><surname>Pitsouli</surname><given-names>C</given-names></name><name><surname>Shilo</surname><given-names>BZ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Signaling mechanisms controlling cell fate and embryonic patterning</article-title><source>Cold Spring Harbor Perspectives in Biology</source><volume>4</volume><elocation-id>a005975</elocation-id><pub-id pub-id-type="doi">10.1101/cshperspect.a005975</pub-id><pub-id pub-id-type="pmid">22855721</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Picelli</surname><given-names>S</given-names></name><name><surname>Björklund</surname><given-names>ÅK</given-names></name><name><surname>Faridani</surname><given-names>OR</given-names></name><name><surname>Sagasser</surname><given-names>S</given-names></name><name><surname>Winberg</surname><given-names>G</given-names></name><name><surname>Sandberg</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title><source>Nature Methods</source><volume>10</volume><fpage>1096</fpage><lpage>1098</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2639</pub-id><pub-id pub-id-type="pmid">24056875</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pino</surname><given-names>E</given-names></name><name><surname>Amamoto</surname><given-names>R</given-names></name><name><surname>Zheng</surname><given-names>L</given-names></name><name><surname>Cacquevel</surname><given-names>M</given-names></name><name><surname>Sarria</surname><given-names>JC</given-names></name><name><surname>Knott</surname><given-names>GW</given-names></name><name><surname>Schneider</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>FOXO3 determines the accumulation of α-synuclein and controls the fate of dopaminergic neurons in the substantia nigra</article-title><source>Human Molecular Genetics</source><volume>23</volume><fpage>1435</fpage><lpage>1452</lpage><pub-id pub-id-type="doi">10.1093/hmg/ddt530</pub-id><pub-id pub-id-type="pmid">24158851</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pozniak</surname><given-names>CD</given-names></name><name><surname>Langseth</surname><given-names>AJ</given-names></name><name><surname>Dijkgraaf</surname><given-names>GJ</given-names></name><name><surname>Choe</surname><given-names>Y</given-names></name><name><surname>Werb</surname><given-names>Z</given-names></name><name><surname>Pleasure</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Sox10 directs neural stem cells toward the oligodendrocyte lineage by decreasing suppressor of fused expression</article-title><source>PNAS</source><volume>107</volume><fpage>21795</fpage><lpage>21800</lpage><pub-id pub-id-type="doi">10.1073/pnas.1016485107</pub-id><pub-id pub-id-type="pmid">21098272</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qi</surname><given-names>X</given-names></name><name><surname>Hong</surname><given-names>J</given-names></name><name><surname>Chaves</surname><given-names>L</given-names></name><name><surname>Zhuang</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>D</given-names></name><name><surname>Chabon</surname><given-names>J</given-names></name><name><surname>Graham</surname><given-names>B</given-names></name><name><surname>Ohmori</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Huang</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Antagonistic regulation by the transcription factors C/EBPα and MITF specifies basophil and mast cell fates</article-title><source>Immunity</source><volume>39</volume><fpage>97</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1016/j.immuni.2013.06.012</pub-id><pub-id pub-id-type="pmid">23871207</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raciti</surname><given-names>M</given-names></name><name><surname>Granzotto</surname><given-names>M</given-names></name><name><surname>Duc</surname><given-names>MD</given-names></name><name><surname>Fimiani</surname><given-names>C</given-names></name><name><surname>Cellot</surname><given-names>G</given-names></name><name><surname>Cherubini</surname><given-names>E</given-names></name><name><surname>Mallamaci</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Reprogramming fibroblasts to neural-precursor-like cells by structured overexpression of pallial patterning genes</article-title><source>Molecular and Cellular Neuroscience</source><volume>57</volume><fpage>42</fpage><lpage>53</lpage><pub-id pub-id-type="doi">10.1016/j.mcn.2013.10.004</pub-id><pub-id pub-id-type="pmid">24128663</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ragu</surname><given-names>C</given-names></name><name><surname>Boukour</surname><given-names>S</given-names></name><name><surname>Elain</surname><given-names>G</given-names></name><name><surname>Wagner-Ballon</surname><given-names>O</given-names></name><name><surname>Raslova</surname><given-names>H</given-names></name><name><surname>Debili</surname><given-names>N</given-names></name><name><surname>Olson</surname><given-names>EN</given-names></name><name><surname>Daegelen</surname><given-names>D</given-names></name><name><surname>Vainchenker</surname><given-names>W</given-names></name><name><surname>Bernard</surname><given-names>OA</given-names></name><name><surname>Penard-Lacronique</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The serum response factor (SRF)/megakaryocytic acute leukemia (MAL) network participates in megakaryocyte development</article-title><source>Leukemia</source><volume>24</volume><fpage>1227</fpage><lpage>1230</lpage><pub-id pub-id-type="doi">10.1038/leu.2010.80</pub-id><pub-id pub-id-type="pmid">20428204</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reinchisi</surname><given-names>G</given-names></name><name><surname>Ijichi</surname><given-names>K</given-names></name><name><surname>Glidden</surname><given-names>N</given-names></name><name><surname>Jakovcevski</surname><given-names>I</given-names></name><name><surname>Zecevic</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>COUP-TFII expressing interneurons in human fetal forebrain</article-title><source>Cerebral Cortex</source><volume>22</volume><fpage>2820</fpage><lpage>2830</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhr359</pub-id><pub-id pub-id-type="pmid">22178710</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reya</surname><given-names>T</given-names></name><name><surname>Morrison</surname><given-names>SJ</given-names></name><name><surname>Clarke</surname><given-names>MF</given-names></name><name><surname>Weissman</surname><given-names>IL</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Stem cells, cancer, and cancer stem cells</article-title><source>Nature</source><volume>414</volume><fpage>105</fpage><lpage>111</lpage><pub-id pub-id-type="doi">10.1038/35102167</pub-id><pub-id pub-id-type="pmid">11689955</pub-id></element-citation></ref><ref id="bib112"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riccio</surname> <given-names>O</given-names></name><name><surname>van Gijn</surname><given-names>ME</given-names></name><name><surname>Bezdek</surname><given-names>AC</given-names></name><name><surname>Pellegrinet</surname><given-names>L</given-names></name><name><surname>van Es</surname><given-names>JH</given-names></name><name><surname>Zimber-Strobl</surname><given-names>U</given-names></name><name><surname>Strobl</surname><given-names>LJ</given-names></name><name><surname>Honjo</surname><given-names>T</given-names></name><name><surname>Clevers</surname><given-names>H</given-names></name><name><surname>Radtke</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Loss of intestinal crypt progenitor cells owing to inactivation of both Notch1 and Notch2 is accompanied by derepression of CDK inhibitors p27Kip1 and p57Kip2</article-title><source>EMBO reports</source><volume>9</volume><fpage>377</fpage><lpage>383</lpage><pub-id pub-id-type="doi">10.1038/embor.2008.7</pub-id><pub-id pub-id-type="pmid">18274550</pub-id></element-citation></ref><ref id="bib113"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robert-Moreno</surname><given-names>A</given-names></name><name><surname>Espinosa</surname><given-names>L</given-names></name><name><surname>de la Pompa</surname><given-names>JL</given-names></name><name><surname>Bigas</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>RBPjkappa-dependent notch function regulates Gata2 and is essential for the formation of intra-embryonic hematopoietic cells</article-title><source>Development</source><volume>132</volume><fpage>1117</fpage><lpage>1126</lpage><pub-id pub-id-type="doi">10.1242/dev.01660</pub-id><pub-id pub-id-type="pmid">15689374</pub-id></element-citation></ref><ref id="bib114"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ross</surname><given-names>SE</given-names></name><name><surname>Greenberg</surname><given-names>ME</given-names></name><name><surname>Stiles</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Basic helix-loop-helix factors in cortical development</article-title><source>Neuron</source><volume>39</volume><fpage>13</fpage><lpage>25</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(03)00365-9</pub-id><pub-id pub-id-type="pmid">12848929</pub-id></element-citation></ref><ref id="bib115"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Satija</surname><given-names>R</given-names></name><name><surname>Farrell</surname><given-names>JA</given-names></name><name><surname>Gennert</surname><given-names>D</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Spatial reconstruction of single-cell gene expression data</article-title><source>Nature Biotechnology</source><volume>33</volume><fpage>495</fpage><lpage>502</lpage><pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id><pub-id pub-id-type="pmid">25867923</pub-id></element-citation></ref><ref id="bib116"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Satoh</surname><given-names>Y</given-names></name><name><surname>Yokota</surname><given-names>T</given-names></name><name><surname>Sudo</surname><given-names>T</given-names></name><name><surname>Kondo</surname><given-names>M</given-names></name><name><surname>Lai</surname><given-names>A</given-names></name><name><surname>Kincade</surname><given-names>PW</given-names></name><name><surname>Kouro</surname><given-names>T</given-names></name><name><surname>Iida</surname><given-names>R</given-names></name><name><surname>Kokame</surname><given-names>K</given-names></name><name><surname>Miyata</surname><given-names>T</given-names></name><name><surname>Habuchi</surname><given-names>Y</given-names></name><name><surname>Matsui</surname><given-names>K</given-names></name><name><surname>Tanaka</surname><given-names>H</given-names></name><name><surname>Matsumura</surname><given-names>I</given-names></name><name><surname>Oritani</surname><given-names>K</given-names></name><name><surname>Kohwi-Shigematsu</surname><given-names>T</given-names></name><name><surname>Kanakura</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The Satb1 protein directs hematopoietic stem cell differentiation toward lymphoid lineages</article-title><source>Immunity</source><volume>38</volume><fpage>1105</fpage><lpage>1115</lpage><pub-id pub-id-type="doi">10.1016/j.immuni.2013.05.014</pub-id><pub-id pub-id-type="pmid">23791645</pub-id></element-citation></ref><ref id="bib117"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shahrezaei</surname><given-names>V</given-names></name><name><surname>Swain</surname><given-names>PS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Analytical distributions for stochastic gene expression</article-title><source>PNAS</source><volume>105</volume><fpage>17256</fpage><lpage>17261</lpage><pub-id pub-id-type="doi">10.1073/pnas.0803850105</pub-id><pub-id pub-id-type="pmid">18988743</pub-id></element-citation></ref><ref id="bib118"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>J</given-names></name><name><surname>Walsh</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Targeted disruption of Tgif, the mouse ortholog of a human holoprosencephaly gene, does not result in holoprosencephaly in mice</article-title><source>Molecular and Cellular Biology</source><volume>25</volume><fpage>3639</fpage><lpage>3647</lpage><pub-id pub-id-type="doi">10.1128/MCB.25.9.3639-3647.2005</pub-id><pub-id pub-id-type="pmid">15831469</pub-id></element-citation></ref><ref id="bib119"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shimojo</surname> <given-names>H</given-names></name><name><surname>Ohtsuka</surname><given-names>T</given-names></name><name><surname>Kageyama</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Dynamic expression of notch signaling genes in neural stem/progenitor cells</article-title><source>Frontiers in Neuroscience</source><volume>5</volume><elocation-id>78</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2011.00078</pub-id><pub-id pub-id-type="pmid">21716644</pub-id></element-citation></ref><ref id="bib120"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sillars-Hardebol</surname><given-names>AH</given-names></name><name><surname>Carvalho</surname><given-names>B</given-names></name><name><surname>Beliën</surname><given-names>JAM</given-names></name><name><surname>de Wit</surname><given-names>M</given-names></name><name><surname>Delis-van Diemen</surname><given-names>PM</given-names></name><name><surname>Tijssen</surname><given-names>M</given-names></name><name><surname>van de Wiel</surname><given-names>MA</given-names></name><name><surname>Pontén</surname><given-names>F</given-names></name><name><surname>Meijer</surname><given-names>GA</given-names></name><name><surname>Fijneman</surname><given-names>RJA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>CSE1L, DIDO1 and RBM39 in colorectal adenoma to carcinoma progression</article-title><source>Cellular Oncology</source><volume>35</volume><fpage>293</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1007/s13402-012-0088-2</pub-id></element-citation></ref><ref id="bib121"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solar</surname> <given-names>GP</given-names></name><name><surname>Kerr</surname><given-names>WG</given-names></name><name><surname>Zeigler</surname><given-names>FC</given-names></name><name><surname>Hess</surname><given-names>D</given-names></name><name><surname>Donahue</surname><given-names>C</given-names></name><name><surname>de Sauvage</surname><given-names>FJ</given-names></name><name><surname>Eaton</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Role of c-mpl in early hematopoiesis</article-title><source>Blood</source><volume>92</volume><fpage>4</fpage><lpage>10</lpage><pub-id pub-id-type="pmid">9639492</pub-id></element-citation></ref><ref id="bib122"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spehlmann</surname> <given-names>ME</given-names></name><name><surname>Manthey</surname><given-names>CF</given-names></name><name><surname>Dann</surname><given-names>SM</given-names></name><name><surname>Hanson</surname><given-names>E</given-names></name><name><surname>Sandhu</surname><given-names>SS</given-names></name><name><surname>Liu</surname><given-names>LY</given-names></name><name><surname>Abdelmalak</surname><given-names>FK</given-names></name><name><surname>Diamanti</surname><given-names>MA</given-names></name><name><surname>Retzlaff</surname><given-names>K</given-names></name><name><surname>Scheller</surname><given-names>J</given-names></name><name><surname>Rose-John</surname><given-names>S</given-names></name><name><surname>Greten</surname><given-names>FR</given-names></name><name><surname>Wang</surname><given-names>JYJ</given-names></name><name><surname>Eckmann</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Trp53 deficiency protects against acute intestinal inflammation</article-title><source>The Journal of Immunology</source><volume>191</volume><fpage>837</fpage><lpage>847</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.1201716</pub-id></element-citation></ref><ref id="bib123"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stolt</surname><given-names>CC</given-names></name><name><surname>Lommes</surname><given-names>P</given-names></name><name><surname>Sock</surname><given-names>E</given-names></name><name><surname>Chaboissier</surname><given-names>MC</given-names></name><name><surname>Schedl</surname><given-names>A</given-names></name><name><surname>Wegner</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The Sox9 transcription factor determines glial fate choice in the developing spinal cord</article-title><source>Genes &amp; Development</source><volume>17</volume><fpage>1677</fpage><lpage>1689</lpage><pub-id pub-id-type="doi">10.1101/gad.259003</pub-id><pub-id pub-id-type="pmid">12842915</pub-id></element-citation></ref><ref id="bib124"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sulston</surname><given-names>JE</given-names></name><name><surname>Schierenberg</surname><given-names>E</given-names></name><name><surname>White</surname><given-names>JG</given-names></name><name><surname>Thomson</surname><given-names>JN</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>The embryonic cell lineage of the nematode caenorhabditis elegans</article-title><source>Developmental Biology</source><volume>100</volume><fpage>64</fpage><lpage>119</lpage><pub-id pub-id-type="doi">10.1016/0012-1606(83)90201-4</pub-id><pub-id pub-id-type="pmid">6684600</pub-id></element-citation></ref><ref id="bib125"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sur</surname><given-names>M</given-names></name><name><surname>Rubenstein</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Patterning and plasticity of the cerebral cortex</article-title><source>Science</source><volume>310</volume><fpage>805</fpage><lpage>810</lpage><pub-id pub-id-type="doi">10.1126/science.1112070</pub-id><pub-id pub-id-type="pmid">16272112</pub-id></element-citation></ref><ref id="bib126"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takahashi</surname><given-names>K</given-names></name><name><surname>Yamanaka</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Induction of pluripotent stem cells from mouse embryonic and adult fibroblast cultures by defined factors</article-title><source>Cell</source><volume>126</volume><fpage>663</fpage><lpage>676</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2006.07.024</pub-id><pub-id pub-id-type="pmid">16904174</pub-id></element-citation></ref><ref id="bib127"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tamura</surname><given-names>T</given-names></name><name><surname>Nagamura-Inoue</surname><given-names>T</given-names></name><name><surname>Shmeltzer</surname><given-names>Z</given-names></name><name><surname>Kuwata</surname><given-names>T</given-names></name><name><surname>Ozato</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>ICSBP directs bipotential myeloid progenitor cells to differentiate into mature macrophages</article-title><source>Immunity</source><volume>13</volume><fpage>155</fpage><lpage>165</lpage><pub-id pub-id-type="doi">10.1016/S1074-7613(00)00016-9</pub-id><pub-id pub-id-type="pmid">10981959</pub-id></element-citation></ref><ref id="bib128"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tan</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Zhu</surname><given-names>H</given-names></name><name><surname>Qin</surname><given-names>J</given-names></name><name><surname>Tian</surname><given-names>M</given-names></name><name><surname>Dong</surname><given-names>C</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Jin</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Brn4 and TH synergistically promote the differentiation of neural stem cells into dopaminergic neurons</article-title><source>Neuroscience Letters</source><volume>571</volume><fpage>23</fpage><lpage>28</lpage><pub-id pub-id-type="doi">10.1016/j.neulet.2014.04.019</pub-id><pub-id pub-id-type="pmid">24769320</pub-id></element-citation></ref><ref id="bib129"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomsen</surname><given-names>ER</given-names></name><name><surname>Mich</surname><given-names>JK</given-names></name><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>Hodge</surname><given-names>RD</given-names></name><name><surname>Doyle</surname><given-names>AM</given-names></name><name><surname>Jang</surname><given-names>S</given-names></name><name><surname>Shehata</surname><given-names>SI</given-names></name><name><surname>Nelson</surname><given-names>AM</given-names></name><name><surname>Shapovalova</surname><given-names>NV</given-names></name><name><surname>Levi</surname><given-names>BP</given-names></name><name><surname>Ramanathan</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Fixed single-cell transcriptomic characterization of human radial glial diversity</article-title><source>Nature Methods</source><volume>13</volume><fpage>87</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3629</pub-id><pub-id pub-id-type="pmid">26524239</pub-id></element-citation></ref><ref id="bib130"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomson</surname><given-names>M</given-names></name><name><surname>Liu</surname><given-names>SJ</given-names></name><name><surname>Zou</surname><given-names>LN</given-names></name><name><surname>Smith</surname><given-names>Z</given-names></name><name><surname>Meissner</surname><given-names>A</given-names></name><name><surname>Ramanathan</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Pluripotency factors in embryonic stem cells regulate differentiation into germ layers</article-title><source>Cell</source><volume>145</volume><fpage>875</fpage><lpage>889</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2011.05.017</pub-id><pub-id pub-id-type="pmid">21663792</pub-id></element-citation></ref><ref id="bib131"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Walther</surname><given-names>G</given-names></name><name><surname>Hastie</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Estimating the number of clusters in a data set via the gap statistic</article-title><source>Journal of the Royal Statistical Society: Series B</source><volume>63</volume><fpage>411</fpage><lpage>423</lpage><pub-id pub-id-type="doi">10.1111/1467-9868.00293</pub-id></element-citation></ref><ref id="bib132"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Regression shrinkage and selection via the lasso</article-title><source>Journal of the Royal Statistical Society. Series B</source><volume>58</volume><fpage>267</fpage><lpage>288</lpage><pub-id pub-id-type="doi">10.1111/j.1467-9868.2011.00771.x</pub-id></element-citation></ref><ref id="bib133"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tou</surname><given-names>L</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Shivdasani</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Regulation of mammalian epithelial differentiation and intestine development by class I histone deacetylases</article-title><source>Molecular and Cellular Biology</source><volume>24</volume><fpage>3132</fpage><lpage>3139</lpage><pub-id pub-id-type="doi">10.1128/MCB.24.8.3132-3139.2004</pub-id><pub-id pub-id-type="pmid">15060137</pub-id></element-citation></ref><ref id="bib134"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Cacchiarelli</surname><given-names>D</given-names></name><name><surname>Grimsby</surname><given-names>J</given-names></name><name><surname>Pokharel</surname><given-names>P</given-names></name><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Morse</surname><given-names>M</given-names></name><name><surname>Lennon</surname><given-names>NJ</given-names></name><name><surname>Livak</surname><given-names>KJ</given-names></name><name><surname>Mikkelsen</surname><given-names>TS</given-names></name><name><surname>Rinn</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title><source>Nature Biotechnology</source><volume>32</volume><fpage>381</fpage><lpage>386</lpage><pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id><pub-id pub-id-type="pmid">24658644</pub-id></element-citation></ref><ref id="bib135"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Defining cell types and states with single-cell genomics</article-title><source>Genome research</source><volume>25</volume><fpage>1491</fpage><lpage>1498</lpage><pub-id pub-id-type="doi">10.1101/gr.190595.115</pub-id><pub-id pub-id-type="pmid">26430159</pub-id></element-citation></ref><ref id="bib136"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Treutlein</surname><given-names>B</given-names></name><name><surname>Brownfield</surname><given-names>DG</given-names></name><name><surname>Wu</surname><given-names>AR</given-names></name><name><surname>Neff</surname><given-names>NF</given-names></name><name><surname>Mantalas</surname><given-names>GL</given-names></name><name><surname>Espinoza</surname><given-names>FH</given-names></name><name><surname>Desai</surname><given-names>TJ</given-names></name><name><surname>Krasnow</surname><given-names>MA</given-names></name><name><surname>Quake</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title><source>Nature</source><volume>509</volume><fpage>371</fpage><lpage>375</lpage><pub-id pub-id-type="doi">10.1038/nature13173</pub-id><pub-id pub-id-type="pmid">24739965</pub-id></element-citation></ref><ref id="bib137"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tzeng</surname><given-names>SF</given-names></name><name><surname>de Vellis</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Id1, Id2, and Id3 gene expression in neural cells during development</article-title><source>Glia</source><volume>24</volume><fpage>372</fpage><lpage>381</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1136(199812)24:4&lt;372::AID-GLIA2&gt;3.0.CO;2-B</pub-id><pub-id pub-id-type="pmid">9814817</pub-id></element-citation></ref><ref id="bib138"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uittenbogaard</surname><given-names>M</given-names></name><name><surname>Chiaramello</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Expression of the bHLH transcription factor Tcf12 (ME1) gene is linked to the expansion of precursor cell populations during neurogenesis</article-title><source>Gene Expression Patterns</source><volume>1</volume><fpage>115</fpage><lpage>121</lpage><pub-id pub-id-type="doi">10.1016/S1567-133X(01)00022-9</pub-id><pub-id pub-id-type="pmid">15018808</pub-id></element-citation></ref><ref id="bib139"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Flier</surname><given-names>LG</given-names></name><name><surname>Clevers</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Stem cells, self-renewal, and differentiation in the intestinal epithelium</article-title><source>Annual Review of Physiology</source><volume>71</volume><fpage>241</fpage><lpage>260</lpage><pub-id pub-id-type="doi">10.1146/annurev.physiol.010908.163145</pub-id><pub-id pub-id-type="pmid">18808327</pub-id></element-citation></ref><ref id="bib140"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Der Maaten</surname><given-names>L</given-names></name><name><surname>Hinton</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Visualizing data using t-SNE</article-title><source>Journal of Machine Learning Research</source><volume>9</volume><fpage>2579</fpage><lpage>2605</lpage></element-citation></ref><ref id="bib141"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Van Der Maaten</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Learning a parametric embedding by preserving local structure</article-title><conf-name>Twelfth International Conference on Artificial Intelligence and Statistics (AI-STATS)</conf-name><fpage>384</fpage><lpage>391</lpage></element-citation></ref><ref id="bib142"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>VanDussen</surname><given-names>KL</given-names></name><name><surname>Samuelson</surname><given-names>LC</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Mouse atonal homolog 1 directs intestinal progenitors to secretory cell rather than absorptive cell fate</article-title><source>Developmental Biology</source><volume>346</volume><fpage>215</fpage><lpage>223</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2010.07.026</pub-id><pub-id pub-id-type="pmid">20691176</pub-id></element-citation></ref><ref id="bib143"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varelas</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The hippo pathway effectors TAZ and YAP in development, homeostasis and disease</article-title><source>Development</source><volume>141</volume><pub-id pub-id-type="doi">10.1242/dev.102376</pub-id><pub-id pub-id-type="pmid">24715453</pub-id></element-citation></ref><ref id="bib144"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vu</surname><given-names>TN</given-names></name><name><surname>Wills</surname><given-names>QF</given-names></name><name><surname>Kalari</surname><given-names>KR</given-names></name><name><surname>Niu</surname><given-names>N</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Rantalainen</surname><given-names>M</given-names></name><name><surname>Pawitan</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Beta-Poisson model for single-cell RNA-seq data analyses</article-title><source>Bioinformatics</source><volume>32</volume><fpage>2128</fpage><lpage>2135</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw202</pub-id><pub-id pub-id-type="pmid">27153638</pub-id></element-citation></ref><ref id="bib145"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wainwright</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Sharp thresholds for High-Dimensional and noisy sparsity recovery using $\ell _{1}$ -Constrained Quadratic Programming (Lasso)</article-title><source>IEEE Transactions on Information Theory</source><volume>55</volume><fpage>2183</fpage><lpage>2202</lpage></element-citation></ref><ref id="bib146"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>M</given-names></name><name><surname>Gu</surname><given-names>D</given-names></name><name><surname>Du</surname><given-names>M</given-names></name><name><surname>Xu</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>S</given-names></name><name><surname>Zhu</surname><given-names>L</given-names></name><name><surname>Lu</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>R</given-names></name><name><surname>Xing</surname><given-names>J</given-names></name><name><surname>Miao</surname><given-names>X</given-names></name><name><surname>Chu</surname><given-names>H</given-names></name><name><surname>Hu</surname><given-names>Z</given-names></name><name><surname>Yang</surname><given-names>L</given-names></name><name><surname>Tang</surname><given-names>C</given-names></name><name><surname>Pan</surname><given-names>L</given-names></name><name><surname>Du</surname><given-names>H</given-names></name><name><surname>Zhao</surname><given-names>J</given-names></name><name><surname>Du</surname><given-names>J</given-names></name><name><surname>Tong</surname><given-names>N</given-names></name><name><surname>Sun</surname><given-names>J</given-names></name><name><surname>Shen</surname><given-names>H</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Common genetic variation in ETV6 is associated with colorectal cancer susceptibility</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>11478</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms11478</pub-id><pub-id pub-id-type="pmid">27145994</pub-id></element-citation></ref><ref id="bib147"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>TW</given-names></name><name><surname>Stromberg</surname><given-names>GP</given-names></name><name><surname>Whitney</surname><given-names>JT</given-names></name><name><surname>Brower</surname><given-names>NW</given-names></name><name><surname>Klymkowsky</surname><given-names>MW</given-names></name><name><surname>Parent</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Sox3 expression identifies neural progenitors in persistent neonatal and adult mouse forebrain germinative zones</article-title><source>The Journal of Comparative Neurology</source><volume>497</volume><fpage>88</fpage><lpage>100</lpage><pub-id pub-id-type="doi">10.1002/cne.20984</pub-id><pub-id pub-id-type="pmid">16680766</pub-id></element-citation></ref><ref id="bib148"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiegreffe</surname><given-names>C</given-names></name><name><surname>Simon</surname><given-names>R</given-names></name><name><surname>Peschkes</surname><given-names>K</given-names></name><name><surname>Kling</surname><given-names>C</given-names></name><name><surname>Strehle</surname><given-names>M</given-names></name><name><surname>Cheng</surname><given-names>J</given-names></name><name><surname>Srivatsa</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>P</given-names></name><name><surname>Jenkins</surname><given-names>NA</given-names></name><name><surname>Copeland</surname><given-names>NG</given-names></name><name><surname>Tarabykin</surname><given-names>V</given-names></name><name><surname>Britsch</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Bcl11a (Ctip1) controls migration of cortical projection neurons through regulation of sema3c</article-title><source>Neuron</source><volume>87</volume><fpage>311</fpage><lpage>325</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.06.023</pub-id><pub-id pub-id-type="pmid">26182416</pub-id></element-citation></ref><ref id="bib149"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wills</surname><given-names>QF</given-names></name><name><surname>Livak</surname><given-names>KJ</given-names></name><name><surname>Tipping</surname><given-names>AJ</given-names></name><name><surname>Enver</surname><given-names>T</given-names></name><name><surname>Goldson</surname><given-names>AJ</given-names></name><name><surname>Sexton</surname><given-names>DW</given-names></name><name><surname>Holmes</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Single-cell gene expression analysis reveals genetic associations masked in whole-tissue experiments</article-title><source>Nature Biotechnology</source><volume>31</volume><fpage>748</fpage><lpage>752</lpage><pub-id pub-id-type="doi">10.1038/nbt.2642</pub-id><pub-id pub-id-type="pmid">23873083</pub-id></element-citation></ref><ref id="bib150"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Witten</surname><given-names>DM</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A framework for feature selection in clustering</article-title><source>Journal of the American Statistical Association</source><volume>105</volume><fpage>713</fpage><lpage>726</lpage><pub-id pub-id-type="doi">10.1198/jasa.2010.tm09415</pub-id><pub-id pub-id-type="pmid">20811510</pub-id></element-citation></ref><ref id="bib151"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woodworth</surname><given-names>MB</given-names></name><name><surname>Greig</surname><given-names>LC</given-names></name><name><surname>Liu</surname><given-names>KX</given-names></name><name><surname>Ippolito</surname><given-names>GC</given-names></name><name><surname>Tucker</surname><given-names>HO</given-names></name><name><surname>Macklis</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Ctip1 regulates the balance between specification of distinct projection neuron subtypes in deep cortical layers</article-title><source>Cell Reports</source><volume>15</volume><fpage>999</fpage><lpage>1012</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2016.03.064</pub-id><pub-id pub-id-type="pmid">27117402</pub-id></element-citation></ref><ref id="bib152"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wullaert</surname> <given-names>A</given-names></name><name><surname>Bonnet</surname><given-names>MC</given-names></name><name><surname>Pasparakis</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>NF-κB in the regulation of epithelial homeostasis and inflammation</article-title><source>Cell Research</source><volume>21</volume><fpage>146</fpage><lpage>158</lpage><pub-id pub-id-type="doi">10.1038/cr.2010.175</pub-id><pub-id pub-id-type="pmid">21151201</pub-id></element-citation></ref><ref id="bib153"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Q</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Yin</surname><given-names>M</given-names></name><name><surname>Yin</surname><given-names>Y</given-names></name><name><surname>Zhou</surname><given-names>G</given-names></name><name><surname>Zhou</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Ebf2 is required for development of dopamine neurons in the midbrain periaqueductal gray matter of mouse</article-title><source>Developmental Neurobiology</source><volume>75</volume><fpage>1282</fpage><lpage>1294</lpage><pub-id pub-id-type="doi">10.1002/dneu.22284</pub-id><pub-id pub-id-type="pmid">25762221</pub-id></element-citation></ref><ref id="bib154"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>Mich</surname><given-names>JK</given-names></name><name><surname>Ku</surname><given-names>S</given-names></name><name><surname>Menon</surname><given-names>V</given-names></name><name><surname>Krostag</surname><given-names>AR</given-names></name><name><surname>Martinez</surname><given-names>RA</given-names></name><name><surname>Furchtgott</surname><given-names>L</given-names></name><name><surname>Mulholland</surname><given-names>H</given-names></name><name><surname>Bort</surname><given-names>S</given-names></name><name><surname>Fuqua</surname><given-names>MA</given-names></name><name><surname>Gregor</surname><given-names>BW</given-names></name><name><surname>Hodge</surname><given-names>RD</given-names></name><name><surname>Jayabalu</surname><given-names>A</given-names></name><name><surname>May</surname><given-names>RC</given-names></name><name><surname>Melton</surname><given-names>S</given-names></name><name><surname>Nelson</surname><given-names>AM</given-names></name><name><surname>Ngo</surname><given-names>NK</given-names></name><name><surname>Shapovalova</surname><given-names>NV</given-names></name><name><surname>Shehata</surname><given-names>SI</given-names></name><name><surname>Smith</surname><given-names>MW</given-names></name><name><surname>Tait</surname><given-names>LJ</given-names></name><name><surname>Thompson</surname><given-names>CL</given-names></name><name><surname>Thomsen</surname><given-names>ER</given-names></name><name><surname>Ye</surname><given-names>C</given-names></name><name><surname>Glass</surname><given-names>IA</given-names></name><name><surname>Kaykas</surname><given-names>A</given-names></name><name><surname>Yao</surname><given-names>S</given-names></name><name><surname>Phillips</surname><given-names>JW</given-names></name><name><surname>Grimley</surname><given-names>JS</given-names></name><name><surname>Levi</surname><given-names>BP</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Ramanathan</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A Single-Cell roadmap of lineage bifurcation in human ESC models of embryonic brain development</article-title><source>Cell Stem Cell</source><volume>20</volume><fpage>120</fpage><lpage>134</lpage><pub-id pub-id-type="doi">10.1016/j.stem.2016.09.011</pub-id><pub-id pub-id-type="pmid">28094016</pub-id></element-citation></ref><ref id="bib155"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ye</surname><given-names>DZ</given-names></name><name><surname>Kaestner</surname><given-names>KH</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Foxa1 and Foxa2 control the differentiation of goblet and enteroendocrine L- and D-cells in mice</article-title><source>Gastroenterology</source><volume>137</volume><fpage>2052</fpage><lpage>2062</lpage><pub-id pub-id-type="doi">10.1053/j.gastro.2009.08.059</pub-id><pub-id pub-id-type="pmid">19737569</pub-id></element-citation></ref><ref id="bib156"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yin</surname><given-names>M</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Yin</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Ang</surname><given-names>SL</given-names></name><name><surname>Ding</surname><given-names>Y</given-names></name><name><surname>Zhou</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Ventral mesencephalon-enriched genes that regulate the development of dopaminergic neurons in vivo</article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>5170</fpage><lpage>5182</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5569-08.2009</pub-id><pub-id pub-id-type="pmid">19386913</pub-id></element-citation></ref><ref id="bib157"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>T</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Xu</surname><given-names>R</given-names></name><name><surname>Wang</surname><given-names>TC</given-names></name><name><surname>Ai</surname><given-names>W</given-names></name><name><surname>Liu</surname><given-names>C</given-names></name><name><surname>Ghaleb</surname><given-names>A</given-names></name><name><surname>McConnell</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Krüppel-like factor 4 regulates intestinal epithelial cell morphology and polarity</article-title><source>PLoS One</source><volume>7</volume><elocation-id>e32492</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0032492</pub-id><pub-id pub-id-type="pmid">22384261</pub-id></element-citation></ref><ref id="bib158"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeisel</surname><given-names>A</given-names></name><name><surname>Muñoz-Manchado</surname><given-names>AB</given-names></name><name><surname>Codeluppi</surname><given-names>S</given-names></name><name><surname>Lönnerberg</surname><given-names>P</given-names></name><name><surname>La Manno</surname><given-names>G</given-names></name><name><surname>Juréus</surname><given-names>A</given-names></name><name><surname>Marques</surname><given-names>S</given-names></name><name><surname>Munguba</surname><given-names>H</given-names></name><name><surname>He</surname><given-names>L</given-names></name><name><surname>Betsholtz</surname><given-names>C</given-names></name><name><surname>Rolny</surname><given-names>C</given-names></name><name><surname>Castelo-Branco</surname><given-names>G</given-names></name><name><surname>Hjerling-Leffler</surname><given-names>J</given-names></name><name><surname>Linnarsson</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Brain structure. cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title><source>Science</source><volume>347</volume><fpage>1138</fpage><lpage>1142</lpage><pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id><pub-id pub-id-type="pmid">25700174</pub-id></element-citation></ref><ref id="bib159"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zembrzycki</surname><given-names>A</given-names></name><name><surname>Griesel</surname><given-names>G</given-names></name><name><surname>Stoykova</surname><given-names>A</given-names></name><name><surname>Mansouri</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Genetic interplay between the transcription factors Sp8 and Emx2 in the patterning of the forebrain</article-title><source>Neural Development</source><volume>2</volume><elocation-id>8</elocation-id><pub-id pub-id-type="doi">10.1186/1749-8104-2-8</pub-id><pub-id pub-id-type="pmid">17470284</pub-id></element-citation></ref><ref id="bib160"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>P</given-names></name><name><surname>Behre</surname><given-names>G</given-names></name><name><surname>Pan</surname><given-names>J</given-names></name><name><surname>Iwama</surname><given-names>A</given-names></name><name><surname>Wara-Aswapati</surname><given-names>N</given-names></name><name><surname>Radomska</surname><given-names>HS</given-names></name><name><surname>Auron</surname><given-names>PE</given-names></name><name><surname>Tenen</surname><given-names>DG</given-names></name><name><surname>Sun</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Negative cross-talk between hematopoietic regulators: GATA proteins repress PU.1</article-title><source>PNAS</source><volume>96</volume><fpage>8705</fpage><lpage>8710</lpage><pub-id pub-id-type="doi">10.1073/pnas.96.15.8705</pub-id><pub-id pub-id-type="pmid">10411939</pub-id></element-citation></ref><ref id="bib161"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Miki</surname><given-names>T</given-names></name><name><surname>Iwanaga</surname><given-names>T</given-names></name><name><surname>Koseki</surname><given-names>Y</given-names></name><name><surname>Okuno</surname><given-names>M</given-names></name><name><surname>Sunaga</surname><given-names>Y</given-names></name><name><surname>Ozaki</surname><given-names>N</given-names></name><name><surname>Yano</surname><given-names>H</given-names></name><name><surname>Koseki</surname><given-names>H</given-names></name><name><surname>Seino</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Identification, tissue expression, and functional characterization of Otx3, a novel member of the Otx family</article-title><source>Journal of Biological Chemistry</source><volume>277</volume><fpage>28065</fpage><lpage>28069</lpage><pub-id pub-id-type="doi">10.1074/jbc.C100767200</pub-id><pub-id pub-id-type="pmid">12055180</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.20488.033</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Yosef</surname><given-names>Nir</given-names></name><role>Reviewing editor</role><aff id="aff9"><institution>University of California</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Discovering sparse transcription factor codes for cell states and state transitions during development&quot; for consideration by <italic>eLife</italic>. Your article has been favorably evaluated by Arup Chakraborty (Senior Editor) and three reviewers, one of whom, Nir Yosef (Reviewer #1), is a member of our Board of Reviewing Editors.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This paper presents an interesting framework for identification of lineage/ developmental relationships based on whole transcriptome profiles. The basic notion is that differentially expressed genes among triplets of samples (representing either a developmental fork or a linear developmental progression) should largely exhibit a prototypical pattern that reflects the lineage relationship. The authors successfully apply this to infer lineage relationship in hematopoiesis, using bulk- level RNA-seq. They then turn to apply their method to single cell data of early neuronal development, and concomitantly infer clusters of cells (each representing a developmental state), and their organization into a lineage structure. A subset of these results is followed up in another, yet unpublished manuscript. The algorithm was also used and followed up on in a companion manuscript of ESC differentiation.</p><p>Essential revisions:</p><p>Overall, this study is innovative and provides new insights into cell-type detection and lineage relationship. The method developed here is complementary to existing pseudotime inference methods in single-cell analysis and the paper is clearly written. Nonetheless, the paper may benefit from additional valuation of the method's performance, specifically – by applications to additional data sets and by systematic comparison with existing methods. More detailed descriptions of their methods is also merited, as described below.</p><p>1) &quot;Lineage progression&quot; triplets: In the case of cell type B that gives rise to cell type A that gives rise to cell type C the middle node (A) is chosen as the &quot;root&quot;</p><p>1.1) The terminology &quot;root cell type&quot; and &quot;terminal leaf cell types&quot; seems inappropriate and confusing in this case and should be revised.</p><p>1.2) The minimum-in-leaf model makes sense in the &quot;Lineage progression&quot; case as it captures the common scenario of genes that get turned on or off in a lineage path, with some persistence of this state. However, in such triplets that are distant enough along the path this may contradict the single &quot;pulse&quot; model (i.e., transient change) proposed in other studies. To explore this, <xref ref-type="fig" rid="fig1">Figure 1</xref> should be revised. Currently it only shows the majority statistics. It would be important to see the fraction of genes that conform to the minimum-in-leaf model (which can be anywhere between 51% and 100%) while contrasting:</p><p>1.2.1) &quot;Lineage progression&quot; vs. &quot;cell fate decision&quot; triplets.</p><p>1.2.2) Triplets with leaves vs. triplets that only include internal nodes.</p><p>1.2.3) Triplets with different distance in the tree.</p><p>2) The Clear-minimum-in-leaf model.</p><p>2.1) To further support the validity of the minimum-in-leaf model, the latter extension to <xref ref-type="fig" rid="fig1">Figure 1</xref> (comment 1.2) should also include comparison between all related triplets vs. all unrelated triplets (i.e., representatives from three different branches).</p><p>2.2) Subsection “Discovering sparse patterns correlated with lineage transitions”, third paragraph: There are more than 2 possible patterns for differentially expressed genes between 3 cell types. In addition to the clear minimum A&lt;B=C and clear maximum A=B&lt;C there is also A&lt;B&lt;C, which is actually what is expected for lateral inhibition, discussed in the text several times. This pattern of three clearly distinct expression levels is not discussed at all in the text (in fact, it is excluded from the model, as described in subsection “1. Notation; Bayes’ Rule”, first paragraph). A clear example is HLF, mentioned in the text as higher in MPP compared to CMP, but it is much higher in the third member of the discussed triplet, ST (according to ImmGen skyline browser).</p><p>2.3) The B&amp;T subtree used for the observation has a very simple topology of only two branches. That might limit the generality of the conclusion. Indeed, the reconstructed lineage tree of the progenitors include a loop, which is not supported by the literature. Authors should discuss this difference from known tree topology. Also, why did they use their approach to reconstruct only hematopoietic progenitors and not all ~250 ImmGen populations?</p><p>3) First algorithm.</p><p>3.1) For the formula in the third paragraph of the subsection “Using patterns to infer lineages”, but I wonder how to draw a cutoff for a tree to be 'correct'. If the method is applied to unrelated cell-types, what is distribution of the p-values?</p><p>3.2) How robust is the lineage prediction model to the initialization procedure and parameter choices? For example, how sensitive is the resulting tree on the number of initial clusters? how sensitive are the results for the algorithm's parameters (e.g., probability cutoffs) or for sub-sampling of samples or genes? A similar stability analysis should also be included for the second algorithm (extension to single cells), which can be even more sensitive due to its iterative nature.</p><p>4) Application to hematopoiesis:</p><p>4.1) It is not clear how well the algorithm can separate related from unrelated triplets? (i.e., representatives from three different branches). While this is mentioned anecdotally in <xref ref-type="fig" rid="fig2">Figure 2</xref>, it should be evaluated systematically, e.g., with AUROC.</p><p>4.2) Given the constraints of the algorithm, the aggregated lineage tree is undirected. While this is mentioned briefly, this key point should be better clarified in the main text.</p><p>5) Algorithm's extension to single cells.</p><p>5.1) Comparison to other methods.</p><p>Recently a number of papers have been published to infer cell lineages from single-cell gene expression data, such as Monocole (Trapnell et al. NBT, 2014), Treutlein et al. (Nature 2014), Wishbone (Setty, Nature Biotech, 2016), tSCAN (Ji, NAR, 2016), StemID (Grun, Cell Stem Cell 2016), and diffusion map (Haghverdi, Nature Methods, 2016). It will be useful to compare with these methods at least to get a sense to what degree this method provides new information (note: it looks like <xref ref-type="fig" rid="fig4">Figure 4B</xref> comes from Monocole, but we could not find a mention for it in the Results section).</p><p>5.2) Differential expression in single cells.</p><p>The t-test used to identify clear minimum and clear maximum patterns is appropriate for microarray analysis, but one limitation of t-test is it assumes the underlying distribution is normal, which is not true for RNAseq, and especially single-cell RNA-seq data. Specifically, single-cell RNA-seq can be severely under-powered because many genes (especially transcription factors) have low or even zero expression values due to dropout. Please discuss ways to incorporate more sophisticated tests that addresses this challenge (e.g., as in scDE), or demonstrate why this is not needed.</p><p>5.3) Related to that – the threshold used for definition of a pattern is p&lt;0.005 in a two sample t-test. Though not specified by the authors, it seems that as there are 1500 transcription factors tested, and 3 tests performed per gene (to test the separation of each of the 3 triplet members from the other two), 4500 tests were performed per triplet. Thus, one would expect to find 22 transcription factors (4500*0.005) with a pattern that pass this threshold for each triplet in the absence of a signal. The authors have to address the multiple comparisons issue.</p><p>6) Application on Single cell data</p><p>6.1) While the single-cell data comes from another manuscript that is under review elsewhere; the information provided on this data is insufficient.</p><p>6.1.1) Please provide a compete &quot;census&quot; of the data – how many cells from each condition; how many reads per library, which read lengths were used?</p><p>6.1.2) How was the data processed? Should we worry about potential confounders of library quality (which have been presented and discussed time and again in the recent scRNA-seq literature)?</p><p>6.2) The algorithm should have been demonstrated first on a single cell RNA-seq datasets where the true cell type transitions tree is known, such as one of the publicly available hematopoietic progenitors single cell RNA-seq datasets.</p><p>6.3) There is no estimate of how sparse is the resulting code – how many genes can be used to decipher the topology? Can they be identified ahead? Is it possible that any group of genes of similar size (~1500) can code for cell states and cell transitions with the same success as the transcription factors?</p><p>6.4) It is not clear how the tree was generated. Was it using the generic algorithm from the previous section, or by enforcing the temporal order of the samples? If it is the latter – please describe the procedure and explain why the generic algorithm does not work.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.20488.034</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Essential revisions:</italic> </p><p><italic>Overall, this study is innovative and provides new insights into cell-type detection and lineage relationship. The method developed here is complementary to existing pseudotime inference methods in single-cell analysis and the paper is clearly written. Nonetheless, the paper may benefit from additional valuation of the method's performance, specifically – by applications to additional data sets and by systematic comparison with existing methods. More detailed descriptions of their methods is also merited, as described below.</italic> </p><p>We would like to thank the Senior and Reviewing Editors and four peer reviewers for their thoughtful comments and suggestions. The feedback and suggestions have greatly improved our manuscript as well as strengthened our conclusions and for this again we are grateful. We have considered each comment and have amended the manuscript to add 5 new figure supplements, 3 new source data items, and 1 movie, as well as edited the text as noted in the detailed responses below.</p><p><italic>1) &quot;Lineage progression&quot; triplets: In the case of cell type B that gives rise to cell type A that gives rise to cell type C the middle node (A) is chosen as the &quot;root&quot;</italic> </p><p><italic>1.1) The terminology &quot;root cell type&quot; and &quot;terminal leaf cell types&quot; seems inappropriate and confusing in this case and should be revised.</italic> </p><p>We would be happy to change the terminology to something clearer, but we have struggled to find an unequivocally clearer alternative. We would like to propose a few alternatives, which we feel all have advantages and disadvantages, and we hope the reviewers could advise on which conveys the meaning most accurately (or propose a better alternative): A) central node and peripheral nodes. B) intermediate node and endpoints. C) internal node and leaf nodes.</p><p>D) central node and terminal nodes.</p><p>We have also clarified our use of the terms “root” and “leaf, adding: “Note that even in the case in which cell type B gives rise to cell type A which gives rise to cell type C, we will refer to A as the “root” and B and C as “leaves” for that particular triplet.”</p><p><italic>1.2) The minimum-in-leaf model makes sense in the &quot;Lineage progression&quot; case as it captures the common scenario of genes that get turned on or off in a lineage path, with some persistence of this state. However, in such triplets that are distant enough along the path this may contradict the single &quot;pulse&quot; model (i.e., transient change) proposed in other studies. To explore this, <xref ref-type="fig" rid="fig1">Figure 1</xref> should be revised. Currently it only shows the majority statistics. It would be important to see the fraction of genes that conform to the minimum-in-leaf model (which can be anywhere between 51% and 100%) while contrasting:</italic></p><p><italic>1.2.1) &quot;Lineage progression&quot; vs. &quot;cell fate decision&quot; triplets.</italic> </p><p><italic>1.2.2) Triplets with leaves vs. triplets that only include internal nodes.</italic> </p><p><italic>1.2.3) Triplets with different distance in the tree.</italic> </p><p>We added an additional figure supplement to <xref ref-type="fig" rid="fig1">Figure 1</xref> (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>) to test these questions. <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2C</xref> shows the number of genes conforming to the pattern for each triplet, and <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2D-F</xref> show the triplets shaded according to decision type, presence of internal nodes, and distance. Although biologically, each of these subsets could reasonably be expected to exhibit different statistics, we found that each scenario produced aggregate statistics that were indistinguishable from <xref ref-type="fig" rid="fig1">Figure 1</xref>. Since <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> includes plots for each of the scenarios suggested in this comment, we have left the representation in <xref ref-type="fig" rid="fig1">Figure 1</xref> unchanged for the purposes of clarity. <xref ref-type="supplementary-material" rid="SD1-data">Figure 1—source data 1</xref> has been appropriately updated.</p><p><italic>2) The Clear-minimum-in-leaf model.</italic> </p><p><italic>2.1) To further support the validity of the minimum-in-leaf model, the latter extension to <xref ref-type="fig" rid="fig1">Figure 1</xref> (comment 1.2) should also include comparison between all related triplets vs. all unrelated triplets (i.e., representatives from three different branches).</italic> </p><p>The comment suggests we compare the model’s success on triplets with known relationships vs. those with unknown relationships to establish an expectation of the false positives from our algorithm. This is an important point that we have addressed in two ways.</p><p>First, we have repeated the analysis in <xref ref-type="fig" rid="fig1">Figure 1</xref> on a set of 100 unrelated triplets from the same hematopoietic lineage tree, where there is no clear relationship between the cell types. <xref ref-type="supplementary-material" rid="SD1-data">Figure 1—source data 1</xref> has been updated with these triplets. We found that while there were a substantial number of genes exhibiting a clear minimum in one of the three cell types in unrelated triplets, their minima were evenly distributed amongst the cell types (in contrast to what is seen in related triplets: the clear minimum pattern is not seen in the ‘root’). To quantify this, we counted the fraction of genes <italic>f<sub>i</sub></italic>which reached a clear minimum in cell type <italic>i = A, B, C</italic> (For A, B, and C unrelated cell types), and for each triplet, we computed the entropy 𝑆 = −∑<sub>i=</sub><italic><sub>A,B,C</sub> f<sub>i</sub></italic> log (<italic>f<sub>i</sub></italic>) and plotted this quantity vs. the number of genes showing a minimum in any triplet for unrelated and related triplets (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3A</xref>). The unrelated triplets have higher entropy and typically more genes showing the downregulation pattern.</p><p>Second, we applied our Bayesian methodology to the set of 150 related and 100 unrelated triplets and compared the distribution of the probability of obtaining a non-null topology. (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3B</xref>). The two distributions diverge considerably, with an AUROC (Area Under Receiver Operating Characteristic) of 0.96, which is shown in a new supplemental figure (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3C</xref>).</p><p><italic>2.2) Subsection “Discovering sparse patterns correlated with lineage transitions”, third paragraph: There are more than 2 possible patterns for differentially expressed genes between 3 cell types. In addition to the clear minimum A&lt;B=C and clear maximum A=B&lt;C there is also A&lt;B&lt;C, which is actually what is expected for lateral inhibition, discussed in the text several times. This pattern of three clearly distinct expression levels is not discussed at all in the text (in fact, it is excluded from the model, as described in subsection “1. Notation; Bayes’ Rule”, first paragraph). A clear example is HLF, mentioned in the text as higher in MPP compared to CMP, but it is much higher in the third member of the discussed triplet, ST (according to ImmGen skyline browser).</italic> </p><p>This is an important comment and we have tried to clarify the text accordingly. First, we are defining the clear minimum pattern as A &lt; B &amp; A &lt; C and the clear maximum pattern as A &lt; C &amp; B &lt; C. (The p-value we calculate for the clear minimum model is the less significant of the two p-values for ttest(A,B) and ttest(A,C)). Given this definition, a gene displaying the A &lt; B &lt; C pattern would fulfill both the clear minimum and clear maximum patterns.</p><p>In our inference method, transition genes are similarly defined as having a minimum expression level, i.e. A &lt; B and A &lt; C. These constraints are enforced in the bounds of the numeric integration (point 3 of the subsection “Bayesian Framework for inferring cluster identities, state transitions, and marker and transition genes simultaneously”), and we are not constraining B=C. Indeed, Hlf is identified with high probability as a transition gene for triplet ST/MPP/CMP despite the two levels in ST and MPP. We have revised the text to discuss and clarify genes with three distinct levels (subsection “Discovering sparse patterns correlated with lineage transitions”, third paragraph).</p><p>In response to the comments we defined the A &lt; B &lt; C pattern as the “clear median” pattern, and we have evaluated how well the pattern correlates with the known topologies. Specifically, does the cell type with median expression level tend to be the root cell type of the triplet? We found that, similar to the clear maximum pattern, the clear median pattern was not a good predictor of the topology.</p><p>Therefore, for clarity, we did not define an additional clear median pattern in the main text, and clarified that genes with the clear median pattern belonged to both the clear minimum and clear maximum classes (in the aforementioned paragraph).</p><p><italic>2.3) The B&amp;T subtree used for the observation has a very simple topology of only two branches. That might limit the generality of the conclusion.</italic> </p><p>The B and T lineage tree is certainly simpler than some systems, but it contains a combination of lineage decisions as well as lineage progressions. While we were restricted by the relative paucity of well-verified lineage trees, our algorithm has been successfully tested on a) microarray data from early hematopoietic progenitors, b) single-cell gene expression data from intestinal cell differentiation (added in the revised manuscript, now in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>), c) single-cell gene expression data from early germ layer differentiation (accompanying Jang et al. manuscript). The predictions in this paper regarding a forebrain/hindbrain split in neural development have been experimentally verified with viral barcoding in human brain development (Yao et al., 2017). Together, this body of evidence suggests to us that the motif we identified and the approach we developed may have more general applicability.</p><p><italic>Indeed, the reconstructed lineage tree of the progenitors include a loop, which is not supported by the literature. Authors should discuss this difference from known tree topology.</italic> </p><p>The loop we predict in the progenitor tree is in fact supported by the Adolfsson model in the literature (Adolfsson et al., 2005). We have written a discussion of the differences between the reconstructed lineage tree and the traditional model (subsection “A lineage tree for early hematopoiesis”, second paragraph). To address the conflicting models of early hematopoietic progenitor lineages, we have compared the triplet topologies expected in the canonical model and in the Adolfsson model, and demonstrated that our predictions support the key features of the Adolfsson model (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p><p><italic>Also, why did they use their approach to reconstruct only hematopoietic progenitors and not all ~250 ImmGen populations?</italic> </p><p>We did not test our model on the entirety of the ImmGen data set because not all of the lineage relationships were verified experimentally as the B- and T- cell branches and early progenitors, meaning the results would not necessarily have been informative of the performance of the algorithm.</p><p><italic>3) First algorithm.</italic> </p><p><italic>3.1) For the formula in the third paragraph of the subsection “Using patterns to infer lineages”, but I wonder how to draw a cutoff for a tree to be 'correct'. If the method is applied to unrelated cell-types, what is distribution of the p-values?</italic> </p><p>We thank the reviewers for this helpful suggestion. We compiled the inferred probability of triplet topologies for both related and unrelated triplets explored earlier from the B- and T- cell branches of the hematopoietic tree (see comment 2.2). We applied our Bayesian methodology to the set of 150 related and 100 unrelated triplets and compared the distributions of the probability of obtaining a non-null topology in a new supplemental subfigure (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3B</xref>). As mentioned in a previous comment and addressed in the new supplemental figure, the two distributions diverge considerably, with an AUC of 0.96 (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3C</xref>).</p><p><italic>3.2) How robust is the lineage prediction model to the initialization procedure and parameter choices? For example, how sensitive is the resulting tree on the number of initial clusters? how sensitive are the results for the algorithm's parameters (e.g., probability cutoffs) or for sub-sampling of samples or genes? A similar stability analysis should also be included for the second algorithm (extension to single cells), which can be even more sensitive due to its iterative nature.</italic> </p><p>We have added a subsection “Stability analysis” to the Materials and methods section, covering both algorithms. We found that the resulting trees are robust to probability cutoff, the prior probability of having a null topology p(T), the relative probabilities of irrelevant and marker genes, and the number of initial clusters.</p><p>In a new subfigure (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1E</xref>), we have shown the distribution of maximal probabilities for non-null topologies in hematopoiesis. Here we show that triplets tend to have very high probabilities (close to 1), and varying the probability cutoff for triplet consideration does not affect the overall tree construction.</p><p>Additionally, a key input parameter into the algorithm is the expected prior distribution of means and standard deviations 𝑝(𝜇, 𝜎) used in the numeric integration (LXYZ). We have been using a uniform prior for both mean and standard deviation, but this requires specification of the ranges of the mean and standard deviation. We implemented an empirical prior 𝑝(𝜇, 𝜎) by estimating the empirical distribution over all the Immgen cell types, using kernel density estimation. The resulting hematopoietic lineage tree was identical. Using the kernel density estimated empirical prior may provide more stability in future analyses.</p><p><italic>4) Application to hematopoiesis:</italic> </p><p><italic>4.1) It is not clear how well the algorithm can separate related from unrelated triplets? (i.e., representatives from three different branches). While this is mentioned anecdotally in <xref ref-type="fig" rid="fig2">Figure 2</xref>, it should be evaluated systematically, e.g., with AUROC.</italic> </p><p>We have systematically annotated each of the 165 triplets, noting the topologies expected in the traditional model and in the Adolfsson model, and the expected triplet length in each model. This information has also been added to <xref ref-type="supplementary-material" rid="SD4-data">Figure 2—source data 2</xref>. and demonstrated that our predictions support the key features of the Adolfsson model (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p><p>Null topologies were identified by the algorithm for triplets with cells that are from 3 terminal nodes (e.g. the triplet MEP/GMP/FrBC) or from triplets that contain very distantly related triplets (e.g. LT/CLP/ETP).</p><p>For 7 triplets with terminal nodes in there is no expected topology (e.g. MEP/GMP/FrA), the method identified a non-null topology (e.g. GMP). However, these misidentified triplets did not affect the final tree, since they were eliminated using the pruning rule (subsection “Pruning rule”), which prunes triplets that contain links between cell types that are not nearest neighbors. In the case of MEP/GMP/FrA, MEP and GMP are separated by CMP, and GMP and FrA are separated by MLP.</p><p>By our count, the Adolfsson and traditional models differ in the topology of 9 triplets. The inferred expected topologies of 8 out of these 9 triplets support the Adolfsson model, which led to the identification of the final tree.</p><p><italic>4.2) Given the constraints of the algorithm, the aggregated lineage tree is undirected. While this is mentioned briefly, this key point should be better clarified in the main text.</italic> </p><p>This is indeed a key point that is easily missed. We have amended the text to clarify this point, stating that “we next determined an undirected graph that recapitulates all of the individual triplet topologies (note that we are only inferring triplet topologies and are not inferring directionality).”</p><p><italic>5) Algorithm's extension to single cells.</italic> </p><p><italic>5.1) Comparison to other methods.</italic></p><p><italic>Recently a number of papers have been published to infer cell lineages from single-cell gene expression data, such as Monocole (Trapnell et al. NBT, 2014), Treutlein et al. (Nature 2014), Wishbone (Setty, Nature Biotech, 2016), tSCAN (Ji, NAR, 2016), StemID (Grun, Cell Stem Cell 2016), and diffusion map (Haghverdi, Nature Methods, 2016). It will be useful to compare with these methods at least to get a sense to what degree this method provides new information (note: it looks like <xref ref-type="fig" rid="fig4">Figure 4B</xref> comes from Monocole, but we could not find a mention for it in the Results section).</italic> </p><p>While our method is complementary to many of these alternative approaches, we have addressed some specific areas in which our method can add insight to analysis of single cell data. We applied Monocle 2, tSCAN, and StemID to the neuronal differentiation data set in this paper and were unable to extract meaningful results as shown in a new supplemental figure (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). In each of these cases, it was difficult to extract experimentally verified hypotheses from the analysis. In particular, the forebrain/hindbrain split in early development was not correctly identified (this split has been verified experimentally in Yao et al., 2017). We have also addressed this in the main text, adding that: “Analysis of this data with other recent methods such as Monocle and Monocle2 (Trapnell et al., 2014), TSCAN (Ji and Ji, 2016), and StemID (Grün et al., 2016) did not clearly reconstruct lineage or infer key genes regulating transitions (<xref ref-type="fig" rid="fig4">Figure 4A</xref> – Bottom, <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). Monocle2 (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2A</xref>) produces a tree with complex branching, but <italic>Sox2Sox2</italic><sup>+</sup> progenitors and DCX+ differentiated neurons do no clearly separate”.</p><p>In addition, we performed a more in-depth comparison with StemID to explore the different conclusions one could gain from these orthogonal methods. We analyzed the intestinal cell differentiation system investigated by Grun et al., 2015 and compared our conclusions with those that they found. Using the Grun et al. cell clusters and a minimum cluster size of 10 cells, we accurately predicted the topology of each triplet in the lineage tree which they reconstruct, as shown in a new supplemental figure (Figure 3—figure supplement 3).</p><p>Our method is complementary to StemID in that for each of the triplets, we were able to identify a sparse set of transition genes which could be experimentally perturbed to explore the dynamics of the system (<xref ref-type="supplementary-material" rid="SD8-data">Figure 4—source data 2</xref>), many of which have known developmental relevance.</p><p><italic>5.2) Differential expression in single cells.</italic></p><p><italic>The t-test used to identify clear minimum and clear maximum patterns is appropriate for microarray analysis, but one limitation of t-test is it assumes the underlying distribution is normal, which is not true for RNAseq, and especially single-cell RNA-seq data. Specifically, single-cell RNA-seq can be severely under-powered because many genes (especially transcription factors) have low or even zero expression values due to dropout. Please discuss ways to incorporate more sophisticated tests that addresses this challenge (e.g., as in scDE), or demonstrate why this is not needed.</italic> </p><p>We have now clarified that the single cell data is analyzed using the Bayesian formalism introduced earlier, and does not use a <italic>t</italic>-test to quantify separation between distributions. The inference methodology does, however, implicitly fit the expression data to a log-normal distribution. The choice of a log-normal distribution could potentially confound the results, particularly in cases with significant zero-inflation. This is a potential area for improvement in our algorithm, but the method can easily be adapted to model different distributions of RNA expression, such as γ distributions (Shahrezaei and Swain, 2008; Wills et al., 2013) and β-Poisson distributions (Vu et al., 2016; Delman and Hemberg, 2016). In either case, the probability of the data given different topologies would be computed by numeric integration over the parameters of the distribution, e.g. 𝛼 and 𝛽 for the Γ distribution, by replacing the log-normal distributions in <xref ref-type="disp-formula" rid="equ6 equ8 equ9">Equations 6, 8 and 9</xref> with ones from the appropriate model.</p><p>The choice of the right parametric form for single-cell RNA expression is still an area of active research. Our choice of log-normal distributions assumes that higher order moments of the distributions (beyond standard deviation) ought to have a minimal contribution to the predictions, but we have not tested this extensively.</p><p><italic>5.3) Related to that – the threshold used for definition of a pattern is p&lt;0.005 in a two sample t-test. Though not specified by the authors, it seems that as there are 1500 transcription factors tested, and 3 tests performed per gene (to test the separation of each of the 3 triplet members from the other two), 4500 tests were performed per triplet. Thus, one would expect to find 22 transcription factors (4500*0.005) with a pattern that pass this threshold for each triplet in the absence of a signal. The authors have to address the multiple comparisons issue.</italic> </p><p>We computed the FDR-adjusted p-values for the pattern recognition and found that the clear minimum pattern is still robust to this multiple hypothesis correction (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2B</xref>). In the Bayesian inference method, the prior odds of being a transition gene serves as a sparsity parameter which directly addresses the multiple comparisons issue.</p><p><italic>6) Application on Single cell data</italic> </p><p><italic>6.1) While the single-cell data comes from another manuscript that is under review elsewhere; the information provided on this data is insufficient.</italic> </p><p><italic>6.1.1) Please provide a compete &quot;census&quot; of the data – how many cells from each condition; how many reads per library, which read lengths were used?</italic> </p><p><italic>6.1.2) How was the data processed? Should we worry about potential confounders of library quality (which have been presented and discussed time and again in the recent scRNA-seq literature)?</italic> </p><p>We have added a new subsection to the Materials and methods to include this information (“In Vitro Neuronal Differentiation”). In particular, as the single cells were profiled independently using the Smart- Seq2 protocol (without pooling before amplification, as in methods such as Cel-Seq, STRT, or Drop-Seq), we did not observe the batch effects present in pooling-based methods. We would also like to note that the paper detailing the collection of this data set has now been published in Cell Stem Cell(Yao et al., 2017).</p><p><italic>6.2) The algorithm should have been demonstrated first on a single cell RNA-seq datasets where the true cell type transitions tree is known, such as one of the publicly available hematopoietic progenitors single cell RNA-seq datasets.</italic> </p><p>We applied our method to the intestinal cell differentiation from Grun et al., (Figure 4—figure supplement 3) and found that our method correctly predicts the topology of each triplet based on the Grun et al. reconstructed lineage tree. Further, we identified key genes in many of the triplets with known developmental relevance. By reducing the system to a sparse measure of distances between cell types in the lineage tree, we can provide complimentary biological insight to existing methods which would allow for further experimental investigation. We have modified the main text in the last paragraph of the subsection “A lineage tree for early hematopoiesis”, to discuss this additional analysis.</p><p><italic>6.3) There is no estimate of how sparse is the resulting code – how many genes can be used to decipher the topology? Can they be identified ahead? Is it possible that any group of genes of similar size (~1500) can code for cell states and cell transitions with the same success as the transcription factors?</italic> </p><p>To address this suggestion, we explored the sparsity of the code based on our reconstruction. We assembled 20 triplets from brain development that were originally inferred to be non-null and had a maximal leaf-to-leaf distance no greater than 5. For each triplet, we ranked genes based on their odds of being transition genes 𝒪<italic><sub>i</sub></italic>. We then attempted to infer the correct topology using only the N genes per triplet with the largest odds, and varied N between 1 and 50 (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1E</xref>). We find that with just 4 genes per triplet (80 total), we can correctly infer the topology of each of these triplets. Note that these genes are ranked by their odds of being transition genes, which is agnostic to the true topology of the triplet. Given assignments of cells to cell types (or clustering), these genes can be found without knowing the topology of the tree by computing the odds. We thank the reviewers for pointing out this relevant feature of the tree reconstruction. We have added discussion of the sparsity to the last paragraph of the subsection “Inferred lineage tree for human excitatory neuronal progenitors from in vitro single-cell data over 80 days of differentiation”.</p><p><italic>6.4) It is not clear how the tree was generated. Was it using the generic algorithm from the previous section, or by enforcing the temporal order of the samples? If it is the latter – please describe the procedure and explain why the generic algorithm does not work.</italic> </p><p>We have now clarified in the main text (subsection “Inferred lineage tree for human excitatory neuronal progenitors from in vitro single-cell data over 80 days of differentiation”, sixth paragraph) that the tree was compiled using a) triplets with P&gt;0.6, b) knowledge that <italic>Sox2Sox2</italic><sup>+</sup> cell types were progenitors, and DCX+ cell types were differentiated (so a DCX+ cell type could not transition to a <italic>Sox2Sox2</italic><sup>+</sup> cell type), c) using the pruning rule as described in the Materials and methods section. Using these rules, the tree was assembled by hand. A method for computationally generating a tree from a set of triplets would be a valuable extension of this work.</p></body></sub-article></article>