<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">50524</article-id><article-id pub-id-type="doi">10.7554/eLife.50524</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Epistasis and entrenchment of drug resistance in HIV-1 subtype B</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-133867"><name><surname>Biswas</surname><given-names>Avik</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3519-3944</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-134076"><name><surname>Haldane</surname><given-names>Allan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8343-1994</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-11094"><name><surname>Arnold</surname><given-names>Eddy</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-61426"><name><surname>Levy</surname><given-names>Ronald M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8696-5177</contrib-id><email>ronlevy@temple.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Center for Biophysics and Computational Biology</institution><institution>Temple University</institution><addr-line><named-content content-type="city">Philadelphia</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Physics</institution><institution>Temple University</institution><addr-line><named-content content-type="city">Philadelphia</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Center for Advanced Biotechnology and Medicine</institution><institution>Rutgers University</institution><addr-line><named-content content-type="city">Piscataway</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Department of Chemistry and Chemical Biology</institution><institution>Rutgers University</institution><addr-line><named-content content-type="city">Piscataway</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Department of Chemistry</institution><institution>Temple University</institution><addr-line><named-content content-type="city">Philadelphia</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Wittkopp</surname><given-names>Patricia J</given-names></name><role>Reviewing Editor</role><aff><institution>University of Michigan</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Wittkopp</surname><given-names>Patricia J</given-names></name><role>Senior Editor</role><aff><institution>University of Michigan</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>08</day><month>10</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e50524</elocation-id><history><date date-type="received" iso-8601-date="2019-07-25"><day>25</day><month>07</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2019-09-09"><day>09</day><month>09</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Biswas et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Biswas et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-50524-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.50524.001</object-id><p>The development of drug resistance in HIV is the result of primary mutations whose effects on viral fitness depend on the entire genetic background, a phenomenon called ‘epistasis’. Based on protein sequences derived from drug-experienced patients in the Stanford HIV database, we use a co-evolutionary (Potts) Hamiltonian model to provide direct confirmation of epistasis involving many simultaneous mutations. Building on earlier work, we show that primary mutations leading to drug resistance can become highly favored (or entrenched) by the complex mutation patterns arising in response to drug therapy despite being disfavored in the wild-type background, and provide the first confirmation of entrenchment for all three drug-target proteins: protease, reverse transcriptase, and integrase; a comparative analysis reveals that NNRTI-induced mutations behave differently from the others. We further show that the likelihood of resistance mutations can vary widely in patient populations, and from the population average compared to specific molecular clones.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>epistasis</kwd><kwd>drug resistance</kwd><kwd>entrenchment</kwd><kwd>HIV</kwd><kwd>co-evolutionary model</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Virus</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>U54-GM103368</award-id><principal-award-recipient><name><surname>Levy</surname><given-names>Ronald M</given-names></name><name><surname>Arnold</surname><given-names>Eddy</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01-GM030580</award-id><principal-award-recipient><name><surname>Levy</surname><given-names>Ronald M</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>S10OD020095</award-id><principal-award-recipient><name><surname>Levy</surname><given-names>Ronald M</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>1R35GM132090</award-id><principal-award-recipient><name><surname>Levy</surname><given-names>Ronald M</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Drug resistance in HIV is the result of mutations, which affect fitness depending on epistatic interactions with the entire sequence background that varies within and between patient populations.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>HIV mutates rapidly as it jumps from host to host, acquiring resistance to each host’s distinct immune response and applied drug regimen. Drug-resistance mutations (DRMs) arise when the virus evolves under selective pressure due to antiretroviral therapy (ART). Primary DRMs often incur a fitness penalty which is then compensated for by accompanying associated mutations (<xref ref-type="bibr" rid="bib35">Heeney et al., 2006</xref>; <xref ref-type="bibr" rid="bib64">Shafer and Schapiro, 2008</xref>). With the use of current robust inhibitors in drug therapy, the drug-resistance mutation patterns in HIV have become increasingly more complex (<xref ref-type="bibr" rid="bib60">Richman et al., 2004a</xref>; <xref ref-type="bibr" rid="bib40">Iyidogan and Anderson, 2014</xref>) often leading to ART failure in patients. Resistance is estimated to develop in up to 50% of patients undergoing monotherapy (<xref ref-type="bibr" rid="bib61">Richman et al., 2004b</xref>) and up to 30% of patients receiving current combination antiretroviral therapy (c-ART) (<xref ref-type="bibr" rid="bib28">Gupta et al., 2008</xref>). The primary drug targets in treatment of HIV are the enzymes coded by the <italic>pol</italic> gene, reverse transcriptase (RT), protease (PR), and integrase (IN). A large number of sequences of HIV are available for RT, PR, and IN for patients who have been treated during the past nearly 30 years, and this information permits critical sequence-based informatic analysis of drug resistance.</p><p>The selective pressure of drug therapy modulates patterns of correlated mutations at residue positions which are both near and distal from the active site (<xref ref-type="bibr" rid="bib9">Chang and Torbett, 2011</xref>; <xref ref-type="bibr" rid="bib34">Haq et al., 2012</xref>; <xref ref-type="bibr" rid="bib20">Flynn et al., 2015</xref>; <xref ref-type="bibr" rid="bib78">Yilmaz and Schiffer, 2017</xref>). A mutation’s impact on the stability or fitness of a protein however is dependent on the entire genetic background in which it occurs: a phenomenon known as ’epistasis’. Drug resistance develops as these mutations accumulate, providing the virus a fitness benefit in the presence of drug pressure, with a complex interplay in the roles of primary and secondary mutations (<xref ref-type="bibr" rid="bib78">Yilmaz and Schiffer, 2017</xref>; <xref ref-type="bibr" rid="bib58">Ragland et al., 2017</xref>). When a primary resistance mutation is incurred in the context of a wild-type background, there is usually a fitness penalty associated with it. In backgrounds with more (accessory) mutations however, the fitness penalty decreases and on average, the primary mutation can become more likely than the wild-type residue. Because the beneficial effects of the associated mutations depend on the primary mutation, with the accumulation of (accessory) mutations, the reversion of the primary mutation can become increasingly deleterious, leading to a type of evolutionary ‘entrenchment’ of the primary mutation (<xref ref-type="bibr" rid="bib57">Pollock et al., 2012</xref>; <xref ref-type="bibr" rid="bib65">Shah et al., 2015</xref>; <xref ref-type="bibr" rid="bib52">McCandlish et al., 2016</xref>). The entrenchment effect on a primary mutation can be very strong on average, and is in fact, modulated by the collective effect of the entire sequence background.</p><p>The effective modeling of epistasis is then critical to the identification and understanding of the drug and immune pressure mediated mutational combinations that give rise to drug-resistant, stable viruses. Experimental techniques to assess the effect of multiple mutations on phenotype have proven effective (<xref ref-type="bibr" rid="bib72">Troyer et al., 2009</xref>; <xref ref-type="bibr" rid="bib15">da Silva et al., 2010</xref>; <xref ref-type="bibr" rid="bib46">Liu et al., 2013</xref>), but functional assays to test all possible combinations are impossible because of the vast size of the mutational space. Co-evolutionary information derived from multiple sequence alignments (MSAs) of related protein sequences have also served as a basis for building models for protein structure and fitness (<xref ref-type="bibr" rid="bib25">Göbel et al., 1994</xref>; <xref ref-type="bibr" rid="bib47">Lockless and Ranganathan, 1999</xref>; <xref ref-type="bibr" rid="bib55">Morcos et al., 2011</xref>; <xref ref-type="bibr" rid="bib37">Hinkley et al., 2011</xref>; <xref ref-type="bibr" rid="bib34">Haq et al., 2012</xref>; <xref ref-type="bibr" rid="bib18">Ferguson et al., 2013</xref>; <xref ref-type="bibr" rid="bib49">Mann et al., 2014</xref>; <xref ref-type="bibr" rid="bib42">Jacquin et al., 2016</xref>; <xref ref-type="bibr" rid="bib38">Hopf et al., 2017</xref>; <xref ref-type="bibr" rid="bib73">Tubiana et al., 2019</xref>). A subset of such models, called Potts statistical models (<xref ref-type="bibr" rid="bib45">Levy et al., 2017</xref>) (a generalization of <italic>Ising spin glass</italic> models), have been used successfully to predict the tertiary and quaternary structure of proteins (<xref ref-type="bibr" rid="bib55">Morcos et al., 2011</xref>; <xref ref-type="bibr" rid="bib50">Marks et al., 2012</xref>; <xref ref-type="bibr" rid="bib68">Sułkowska et al., 2012</xref>; <xref ref-type="bibr" rid="bib69">Sutto et al., 2015</xref>; <xref ref-type="bibr" rid="bib31">Haldane et al., 2016</xref>; <xref ref-type="bibr" rid="bib45">Levy et al., 2017</xref>; <xref ref-type="bibr" rid="bib67">Sjodt et al., 2018</xref>) as well as viral protein stability and fitness (<xref ref-type="bibr" rid="bib66">Shekhar et al., 2013</xref>; <xref ref-type="bibr" rid="bib4">Barton et al., 2016a</xref>; <xref ref-type="bibr" rid="bib38">Hopf et al., 2017</xref>; <xref ref-type="bibr" rid="bib21">Flynn et al., 2017</xref>; <xref ref-type="bibr" rid="bib45">Levy et al., 2017</xref>; <xref ref-type="bibr" rid="bib48">Louie et al., 2018</xref>).</p><p>Recent studies using Potts models inferred the epistatic interactions involved in the evolution of drug resistance in HIV-1 protease (<xref ref-type="bibr" rid="bib21">Flynn et al., 2017</xref>). The authors identified sequence backgrounds with differing patterns of associated mutations which were predicted to either strongly entrench or strongly disfavor particular primary mutations in HIV-1 protease. Of crucial importance is the observation that whether a mutation favors or disfavors a primary resistance mutation with which it is associated, depends on the entire sequence background. Here we confirm the predictions in <xref ref-type="bibr" rid="bib21">Flynn et al. (2017)</xref> providing the first direct confirmations of ‘entrenchment’ by the entire sequence background and show how such models capture the epistatic interactions that lead to drug resistance in each of the three predominant target enzymes in HIV subjected to selective pressure of ART: protease, reverse transcriptase, and integrase. We show that it is possible to predict which mutations a particular background will support in the drug-experienced population and how conducive that background is towards that mutation. Understanding the relationship between the likelihood of a drug-resistance mutation and the specific sequence background is important for the interpretation of mutagenesis experiments, which are carried out in the background of specific reference sequences such as subtype B molecular clones NL4-3, HXB2, and others (<xref ref-type="bibr" rid="bib51">Martinez-Picado et al., 1999</xref>; <xref ref-type="bibr" rid="bib2">An et al., 1999</xref>). Our results demonstrate that the background-dependent likelihood of a primary mutation and the strength of compensatory behavior can vary widely in patient populations, and from population averages to predominant subtype B molecular clones such as NL4-3 or HXB2.</p><p>It is useful to review some basic properties of Potts models in this context. A Potts model is a maximum-entropy model of the likelihood of a dataset multiple sequence alignment (MSA), constrained to predict the bivariate (pairwise) residue frequencies between all pairs of positions in the alignment, in other words it is designed to capture the observed pairwise mutational correlations caused by epistasis. A central quantity known as the ‘statistical’ energy of a sequence <inline-formula><mml:math id="inf1"><mml:mi>S</mml:mi></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, Materials and methods) is commonly interpreted to be proportional to fitness; the model predicts that sequences will appear in the dataset with probability <inline-formula><mml:math id="inf2"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, such that sequences with favorable statistical energies are more prevalent in the MSA. A key feature of the Potts model is that the effect of a mutation on fitness and <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is ‘background-dependent’, as a single change at one position causes a difference in <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> of the coupling values in the sum for <inline-formula><mml:math id="inf5"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and a mutation at one position will affect mutations at all other positions both directly and indirectly through chains of interactions involving one or many intermediate residues. Because of this, the Potts model predicts complex patterns of mutational correlations, even though the effective energy model includes only pairwise terms.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Epistasis: the effect of the background on primary resistance mutations in HIV</title><p>We begin by demonstrating the importance of the genetic background in determining the frequencies of primary mutations in HIV and verifying this by comparison to the empirical background dependence of primary mutations observed in the Stanford HIV database. We do this using a background-dependent computation of residue biases. If we mutate a sequence <inline-formula><mml:math id="inf6"><mml:mi>S</mml:mi></mml:math></inline-formula> at position <inline-formula><mml:math id="inf7"><mml:mi>i</mml:mi></mml:math></inline-formula> to a residue <inline-formula><mml:math id="inf8"><mml:mi>α</mml:mi></mml:math></inline-formula>, calling the mutated sequence <inline-formula><mml:math id="inf9"><mml:msubsup><mml:mi>S</mml:mi><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula>, we can also calculate the mutant sequence’s probability <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> according to the Potts model. Further, we can calculate the relative probability of any mutation at position <inline-formula><mml:math id="inf11"><mml:mi>i</mml:mi></mml:math></inline-formula> of sequence <inline-formula><mml:math id="inf12"><mml:mi>S</mml:mi></mml:math></inline-formula>, as <inline-formula><mml:math id="inf13"><mml:mrow><mml:mrow><mml:mi>ℙ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Notably, <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>ℙ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> depends on the background comprised of all positions except <inline-formula><mml:math id="inf15"><mml:mi>i</mml:mi></mml:math></inline-formula>. We will call this background <inline-formula><mml:math id="inf16"><mml:mrow><mml:mi>S</mml:mi><mml:mo>∖</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> representing the sequence <inline-formula><mml:math id="inf17"><mml:mi>S</mml:mi></mml:math></inline-formula> with an unspecified residue at position <inline-formula><mml:math id="inf18"><mml:mi>i</mml:mi></mml:math></inline-formula>. Given a very large sample of sequences such that the background <inline-formula><mml:math id="inf19"><mml:mrow><mml:mi>S</mml:mi><mml:mo>∖</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> is sampled multiple times, a residue <inline-formula><mml:math id="inf20"><mml:mi>α</mml:mi></mml:math></inline-formula> will appear at position <inline-formula><mml:math id="inf21"><mml:mi>i</mml:mi></mml:math></inline-formula> in that background with frequency <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>ℙ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In practice, obtaining such large samples is difficult. But equivalently, if a background <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>S</mml:mi><mml:mo>∖</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> is sampled from nature without knowledge of the residue at position <inline-formula><mml:math id="inf24"><mml:mi>i</mml:mi></mml:math></inline-formula>, the Potts model can be used to predict that the residue <inline-formula><mml:math id="inf25"><mml:mi>α</mml:mi></mml:math></inline-formula> will be at the missing position with a likelihood <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>ℙ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We emphasize that the model was not fit using this information. While the Potts Hamiltonian model only contains fields and pairwise coupling terms; <inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>ℙ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> involves combinations of couplings of residues at <inline-formula><mml:math id="inf28"><mml:mi>i</mml:mi></mml:math></inline-formula> with all other positions and cannot be expressed as a simple function of the correlations between mutations at pairs of positions.</p><p>Using <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>ℙ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> we can classify sequences by how likely a residue <inline-formula><mml:math id="inf30"><mml:mi>α</mml:mi></mml:math></inline-formula> is to appear at a position <inline-formula><mml:math id="inf31"><mml:mi>i</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). We divide the dataset MSA into 10 groups of sequences ordered by <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>ℙ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and compare the Potts predicted frequency of the residue in each group to its observed frequency. <xref ref-type="fig" rid="fig1">Figure 1B</xref> shows good agreement for the likelihood of M at position 90 in HIV-1 protease, an important drug-resistance mutation. <xref ref-type="fig" rid="fig1">Figure 1D</xref> shows that the average absolute error between Potts predicted and observed frequencies is very small for all major drug-resistance mutations in HIV PR, RT and IN, establishing that the Potts model is a good predictor of epistasis in viral sequence backgrounds. These results provide one of the most direct verifications of the complex patterns (involving the effect of many mutations) of epistatic interactions involving drug-resistance mutations in HIV. This result also shows that the background dependence can be very strong, as many sequences can have likelihoods of <inline-formula><mml:math id="inf33"><mml:mrow><mml:mrow><mml:mi>ℙ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula> while others have <inline-formula><mml:math id="inf34"><mml:mrow><mml:mrow><mml:mi>ℙ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> as is seen for the DRM L90M in HIV PR (<xref ref-type="fig" rid="fig1">Figure 1B</xref>).</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.002</object-id><label>Figure 1.</label><caption><title>The Potts model predicts residue frequencies.</title><p>(<bold>A</bold>) Schematic showing that the Potts model can be used to classify sequences by how likely a residue <inline-formula><mml:math id="inf35"><mml:mi>α</mml:mi></mml:math></inline-formula> is to appear at a position <inline-formula><mml:math id="inf36"><mml:mi>i</mml:mi></mml:math></inline-formula> in a sequence <inline-formula><mml:math id="inf37"><mml:mi>S</mml:mi></mml:math></inline-formula> using the background-dependent probability, <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>ℙ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) The observed frequency of the resistance mutation L90M in HIV-1 drug-experienced proteases matches the Potts model predicted frequencies in sequence clusters binned according to the Potts-predicted frequencies in steps of 0.1 (blue circles) with statistical error (green). Diameters of the circles represent the number of sequences. Inset shows the significant overlap in Hamming distance for sequences with low predicted mutant frequencies between 0.2 and 0.3 (blue) and high, 0.7 and 0.8 (pink) depicting the difficulty of such a classification based on Hamming distance. (<bold>C</bold>) The receiver operator characteristic (ROC) curve comparing the Potts model and Hamming distances as classifiers of mutational probabilities for L90M in HIV protease. (<bold>D</bold>) The average absolute error between the observed mutational frequencies and the Potts-predicted frequencies for the major drug-resistance mutations in HIV-1 in three drug targets. The average absolute error is calculated by binning the sequences in ascending order of their predicted frequencies such that there are roughly equal number of sequences in each bin as shown in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>, and averaging over the absolute error in each bin.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-50524-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.50524.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Observed vs predicted frequencies for calculating the average absolute error in <xref ref-type="fig" rid="fig1">Figure 1D</xref>.</title><p>The average absolute error in <xref ref-type="fig" rid="fig1">Figure 1D</xref> is calculated by binning the sequences in ascending order of their predicted frequencies such that there are roughly equal number of sequences in each bin, and averaging the absolute error of the bins. This binning procedure avoids finite sampling errors encountered when following a more restrictive method of binning by Potts frequencies from 0 to 1 in steps of 0.1 as shown in <xref ref-type="fig" rid="fig1">Figure 1B</xref> especially when the mutation frequency is small. The observed vs predicted frequencies are shown for primary drug-resistance mutations V82A occurring in response to PIs in HIV-1 protease (<bold>A</bold>); N155H occurring in response to INSTIs in HIV-1 IN (<bold>B</bold>); M184V occurring in response to NRTIs in HIV-1 reverse transcriptase (<bold>C</bold>); and Y181C/G occurring in response to NNRTIs in HIV-1 reverse transcriptase (<bold>D</bold>). Diameters of the blue circles represent data sizes in each bin, and error bars are shown as green cross-hairs.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-50524-fig1-figsupp1-v1.tif"/></fig></fig-group><p>The epistatic predictions of the Potts model cannot be simply explained by the number of background mutations (or Hamming distance) relative to the wild-type (consensus wild-type subtype B amino acid sequence). It is not simply the number of mutations that bias residues, but particular patterns of mutations. The inset figure of <xref ref-type="fig" rid="fig1">Figure 1B</xref> shows that there is significant overlap in the distributions of the number of mutations between two groups of sequences in which the probability of observing the mutation L90M is ~3x smaller in one than the other (‘blue’ compared to ‘red’) illustrating that a prediction of residue frequencies based on Hamming distance alone is insufficient. We compare the residue-prediction ability of the Potts model using <inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>ℙ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to that of a ‘Hamming’ model which predicts residue frequencies purely based on the number of mutations. This is plotted in <xref ref-type="fig" rid="fig1">Figure 1C</xref> for the L90M mutation in HIV protease. There is a significant performance gain for the Potts model with a true positive rate (TPR) of 0.81 at a false positive rate (FPR) of 0.1, compared to a TPR of 0.46 at an FPR of 0.1 for the Hamming distance model, again showing that the latter model is much less predictive.</p></sec><sec id="s2-2"><title>‘Entrenchment’ of a primary resistance mutation and its verification</title><p>The log likelihood of a mutation occurring at a position <inline-formula><mml:math id="inf40"><mml:mi>i</mml:mi></mml:math></inline-formula> in a given sequence background relative to the wild-type residue (consensus) at that position can be calculated from the change in the Potts statistical energy on acquiring that mutation from the wild-type residue at that site as <inline-formula><mml:math id="inf41"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. If <inline-formula><mml:math id="inf42"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, this implies that the mutation is more favorable in the given sequence background and that there is a fitness penalty associated for reversion back to the wild-type residue; while <inline-formula><mml:math id="inf43"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> implies that the wild-type residue is more favorable and the mutation is likely to revert to the wild-type residue. A single resistance mutation in the wild-type background is almost always disfavored relative to the wild-type residue, and is generally disfavored (<inline-formula><mml:math id="inf44"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) in backgrounds which are close to the wild-type (i.e carry a few accessory mutations). However, as the number of mutations in the background increases, the preference for the wild-type residue at position <inline-formula><mml:math id="inf45"><mml:mi>i</mml:mi></mml:math></inline-formula> decreases on average, until eventually the mutant is preferred at that position. We describe a drug-resistance mutation at position <inline-formula><mml:math id="inf46"><mml:mi>i</mml:mi></mml:math></inline-formula> as being ‘entrenched’ in a particular sequence S if <inline-formula><mml:math id="inf47"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> at that position. When a drug-resistance mutation is entrenched at <inline-formula><mml:math id="inf48"><mml:mi>i</mml:mi></mml:math></inline-formula> in sequence S, this means that the drug-resistance mutation is more probable than the wild-type residue at <inline-formula><mml:math id="inf49"><mml:mi>i</mml:mi></mml:math></inline-formula> in sequence S.</p><p><xref ref-type="fig" rid="fig2">Figure 2A</xref> illustrates entrenchment for the drug-resistance mutation L90M in HIV-1 proteases. The preference to revert as a function of the number of mutations at PI-associated sites is shown as box plots. Each box plot shows the median and mean values of the preference to revert for sequences, conditional on the indicated number of mutations at PI-associated sites in the corresponding column, as well as the region containing half of the sequences (shown in gray bounded by blue/red boxes); the whiskers of the box plot indicate the range of <inline-formula><mml:math id="inf50"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> values for sequences in the tails of the distributions conditional on the number of mutations at PI-associated sites. For drug-experienced viral PR sequence backgrounds that contain eight or fewer PI-associated mutations, (<xref ref-type="fig" rid="fig2">Figure 2A</xref> left area in blue), the L90M mutation is disfavored on average and likely to revert, with more than a 10 fold preference to revert in backgrounds with no inhibitor-associated mutations. However, the box plots show that the sequences, conditional on a fixed number of PI-associated mutations, typically span a large range of <inline-formula><mml:math id="inf51"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>s. For example, the mean and median values of <inline-formula><mml:math id="inf52"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> for L90M in those sequences which contain exactly eight PI-associated mutations is slightly smaller than zero (meaning a probability of reverting slightly greater than one), the range of <inline-formula><mml:math id="inf53"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> values spans from about −6 to +5.4 (the preference to revert spans the range ∼217x to 0.003x). <xref ref-type="fig" rid="fig2">Figure 2A</xref> shows that for each box plot corresponding to nine or more PI-associated mutations, the mean and median value of <inline-formula><mml:math id="inf54"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, again for each box plot <inline-formula><mml:math id="inf55"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> or equivalently, the preference to revert, assumes a large range. It is noteworthy that in the consensus background (one of the sequences containing no PI-associated mutations), the predicted probability of observing the consensus residue L90 is ~40x greater than observing the drug-resistance mutation 90M in the Stanford database of drug-experienced sequences. This prediction for the relative likelihood of L90M in the consensus background is qualitatively consistent with what is actually observed in the drug-experienced Stanford dataset (40 sequences are observed to contain L90 and 2 sequences are observed to contain 90M). <xref ref-type="fig" rid="fig2">Figure 2</xref> does not however, represent a time ordering for the acquisition of the primary DRM, instead it follows the general favorability and likelihood of the mutation in sequence backgrounds conditional on the number of inhibitor-associated mutations; and the mutation L90M <italic>on average</italic>, is favored over the wild-type residue and is entrenched (unlikely to revert) only in sequence backgrounds with 9 or more PI-associated mutations (seen in <xref ref-type="fig" rid="fig2">Figure 2A</xref> for sequences in red).</p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.004</object-id><label>Figure 2.</label><caption><title>Entrenchment and the effect of epistasis on the favorability of a primary resistance mutation.</title><p>(<bold>A</bold>) <inline-formula><mml:math id="inf56"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mn>90</mml:mn></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mrow><mml:mn>90</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mn>90</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> change for sequences, conditional on the number of PI-associated mutations is shown as boxplots annotating the first, second and third interquartile range. Whiskers extend to 1.5 times the interquartile range with outliers marked as ’x’s and the mean values are marked as squares. The left ordinate scale shows the relative probability of reversion <inline-formula><mml:math id="inf57"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and the right shows <inline-formula><mml:math id="inf58"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>. Sequences whose energy difference fall above <inline-formula><mml:math id="inf59"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (dashed line) are entrenching backgrounds favoring the mutation. Sequence backgrounds where the mutation is favored on average are shown in red, the others in blue. The mutation L90M becomes favorable on average when there are about 9 PI-associated mutations, but there is a wide range of favorability and ‘which’ PI-associated mutations are present play an important role in determining if the primary mutation is favored/disfavored. The highlighted regions (white with dark border) show there are many sequence backgrounds with between 7 and 14 mutations in which L90M is either ‘highly entrenched or favored’ (top) or ‘highly disfavored’ (bottom). (<bold>B</bold>) Distributions of number of PI-associated mutations in sequences in the ‘highly entrenching’ and ‘highly disfavoring’ regions from panel A have a large overlap, again showing that entrenchment is not primarily determined by number of associated mutations. Prediction of the likelihood of M based on the number of PI-associated mutations alone for these sequence backgrounds where M is highly entrenched (red) or highly disfavored (blue) would be especially difficult due to the large overlap between them.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-50524-fig2-v1.tif"/></fig><p>For a quantitative comparison of the Potts model predictions of ‘entrenchment’ with the observed statistics concerning the relative likelihood of L90M in the Stanford drug-experienced dataset, it is necessary to aggregate the sequence statistics since the dataset size is too small to compare predictions with observations on a sequence by sequence basis. We compare the observed and predicted residue frequencies for different subsets of sequences as shown in <xref ref-type="table" rid="table1">Table 1</xref> for L90M in HIV protease. The agreement between the predictions of the Potts model and the observed sequence statistics is very good. For the set of highly entrenching sequences (<inline-formula><mml:math id="inf60"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf61"><mml:mi>σ</mml:mi></mml:math></inline-formula> being the standard deviation in <inline-formula><mml:math id="inf62"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>) the L90M mutation is predicted to be present in this set with frequency 97.6% whereas it is observed to be present with frequency 97.3% (see <xref ref-type="table" rid="table1">Table 1</xref> second row). In the backgrounds classified by the Potts model as ‘highly disfavoring’, the mutation is predicted to occur with frequency 3.5% whereas the observed frequency is 1.9%. The L90M mutation is observed to be enriched in the sequences classified by the Potts model as ‘highly entrenching’ over those classified as ‘highly disfavoring’ the mutation by a factor of ~1907.</p><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.005</object-id><label>Table 1.</label><caption><title>Confirmation of the Potts model entrenchment predictions for the mutation L90M in HIV-1 protease.</title><p>Analytical predictions of likelihoods of the mutation (using the Potts model) are shown along with the corresponding observed frequencies in different subsets of our dataset classified as entrenching (<inline-formula><mml:math id="inf63"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) or disfavoring (<inline-formula><mml:math id="inf64"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) for the mutation. The agreement between the predicted and observed frequencies is remarkable and serves as a confirmation for the Potts model entrenchment predictions.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Sequences</th><th>Classification</th><th>Number of sequences</th><th>Predicted frequency</th><th>Observed frequency</th></tr></thead><tbody><tr><td rowspan="2">All</td><td>Entrenched</td><td>1475</td><td>82.7%</td><td>83.9%</td></tr><tr><td>Disfavored</td><td>3283</td><td>12.7%</td><td>11.9%</td></tr><tr><td rowspan="2">All with <inline-formula><mml:math id="inf65"><mml:mrow><mml:mrow><mml:mo fence="true" stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo fence="true" stretchy="false">|</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> of <inline-formula><mml:math id="inf66"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></td><td>Entrenched</td><td>560</td><td>97.6%</td><td>97.3%</td></tr><tr><td>Disfavored</td><td>1444</td><td>3.5%</td><td>1.9%</td></tr><tr><td rowspan="2">With between 7 and 14 mutations and <inline-formula><mml:math id="inf67"><mml:mrow><mml:mrow><mml:mo fence="true" stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo fence="true" stretchy="false">|</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> of <inline-formula><mml:math id="inf68"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></td><td>Entrenched</td><td>470</td><td>97.5%</td><td>97.0%</td></tr><tr><td>Disfavored</td><td>239</td><td>2.8%</td><td>2.1%</td></tr></tbody></table></table-wrap><p>Entrenchment cannot be predicted based simply on the number of mutations, particularly for sequences with an intermediate number of associated mutations in the background. To illustrate this we consider sequences for L90M in HIV-1 PR, with between 7 and 14 inhibitor-associated mutations which correspond to the two highlighted regions (white with dark border) in the center of <xref ref-type="fig" rid="fig2">Figure 2A</xref> which contain roughly equal numbers of sequences (see <xref ref-type="table" rid="table1">Table 1</xref> third row agreement between predictions and observations is excellent). There is significant overlap of the number of PI-associated mutations in the two distributions as seen in <xref ref-type="fig" rid="fig2">Figure 2B</xref>, which makes clear why it is difficult to classify them based on the number of associated mutations alone. This also serves to emphasize that the probability of observing a drug-resistance mutation depends on the specific pattern of mutations that appears in the background and not just the total number of associated mutations in the background; this is also implied from the variance of the Potts <inline-formula><mml:math id="inf69"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> (lengths of the box and whiskers in <xref ref-type="fig" rid="fig2">Figure 2A</xref>) for sequences, for instance, with 13 to 17 PI-associated mutations, where some sequence backgrounds with even such high numbers of associated mutations disfavor the primary DRM while others entrench it.</p></sec><sec id="s2-3"><title>Comparative entrenchment of resistance mutations in protease, reverse transcriptase, and integrase</title><p>Entrenchment of a resistance mutation depends crucially on the specific background in which it is acquired. In this section, we compare the effect of ‘background dependence’ of primary DRMs in each of the three major HIV drug target proteins, reverse transcriptase, protease and integrase for the four drug classes: nucleoside analog reverse transcriptase inhibitors (NRTIs), non-nucleoside analog reverse transcriptase inhibitors (NNRTIs), protease inhibitors (PIs) and integrase strand transfer inhibitors (INSTIs) (<xref ref-type="table" rid="table2">Table 2</xref>). Due to the large number of primary resistance mutations, we restrict our analysis to only those occurring at ~1% mutation frequencies or more. A mutation is defined to be ‘entrenched in the population’ if at least 50% of the sequences which <italic>contain that mutation</italic> have a change in Potts statistical energy score <inline-formula><mml:math id="inf70"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p><table-wrap id="table2" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.006</object-id><label>Table 2.</label><caption><title>Entrenchment in the population (of sequences carrying the mutation) for four major classes of resistance mutations in HIV-1 subtype B: A DRM is entrenched in the population if at least ~50% or more of the sequences containing the mutation entrench it (i.e <inline-formula><mml:math id="inf71"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>).</title><p>We catalog entrenchment in the population (of sequences carrying the mutation) for all primary DRMs appearing at ~1% frequency or more, and our study reveals mutations in response to NNRTIs are much less entrenched in the population (of sequences carrying the mutation) than others.</p><p><supplementary-material id="table2sdata1"><object-id pub-id-type="doi">10.7554/eLife.50524.007</object-id><label>Table 2—source data 1.</label><caption><title>Table showing entrenchment in the population (of sequences carrying the mutation) for primary resistance mutations against NRTIs.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-50524-table2-data1-v1.docx"/></supplementary-material></p><p><supplementary-material id="table2sdata2"><object-id pub-id-type="doi">10.7554/eLife.50524.008</object-id><label>Table 2—source data 2.</label><caption><title>Table showing entrenchment in the population (of sequences carrying the mutation) for primary resistance mutations against NNRTIs.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-50524-table2-data2-v1.docx"/></supplementary-material></p><p><supplementary-material id="table2sdata3"><object-id pub-id-type="doi">10.7554/eLife.50524.009</object-id><label>Table 2—source data 3.</label><caption><title>Table showing entrenchment in the population (of sequences carrying the mutation) for primary resistance mutations against PIs.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-50524-table2-data3-v1.docx"/></supplementary-material></p><p><supplementary-material id="table2sdata4"><object-id pub-id-type="doi">10.7554/eLife.50524.010</object-id><label>Table 2—source data 4.</label><caption><title>Table showing entrenchment in the population (of sequences carrying the mutation) for primary resistance mutations against INSTIs.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-50524-table2-data4-v1.docx"/></supplementary-material></p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>NRTIs</th><th>NNRTIs</th><th>PIs</th><th>INSTIs</th></tr></thead><tbody><tr><td>Years in therapy</td><td>32</td><td>23</td><td>24</td><td>12</td></tr><tr><td>Number of primary DRMs</td><td>18</td><td>15</td><td>13</td><td>15</td></tr><tr><td>DRMs entrenched in the population (of sequences carrying the mutation)</td><td>11 (61.1%)</td><td>1 ( 6.7%)</td><td>10 (76.9%)</td><td>13 (86.7 %)</td></tr><tr><td>Number of DRMs conferring high-level resistance</td><td>7</td><td>11</td><td>7</td><td>6</td></tr><tr><td>High-level resistance DRMs entrenched in the population (of sequences carrying the mutation)</td><td>3 (42.8%)</td><td>1 (9.1 %)</td><td>5 (71.4%)</td><td>5 (83.3 %)</td></tr></tbody></table><table-wrap-foot><fn><p>Source: Results shown in this table are based on calculations for ‘entrenchment in the population’ (of sequences carrying the mutation) for each primary DRM occurring at ~1% frequency or more in HIV-1 RT, PR, and IN, respectively as shown in <xref ref-type="supplementary-material" rid="table2sdata1">Table 2—source data 1</xref>, <xref ref-type="supplementary-material" rid="table2sdata2">Table 2—source data 2</xref>, <xref ref-type="supplementary-material" rid="table2sdata3">Table 2—source data 3</xref> and <xref ref-type="supplementary-material" rid="table2sdata4">Table 2—source data 4</xref>. Resistance levels are determined according to Stanford HIVDB (<xref ref-type="bibr" rid="bib59">Rhee et al., 2003</xref>; <xref ref-type="bibr" rid="bib63">Shafer, 2006</xref>) mutation scores for PIs, NRTIs, NNRTIs, and INSTIs. </p></fn></table-wrap-foot></table-wrap><p>If a resistance mutation is ‘entrenched in the population’, it means that the majority of sequences containing that mutation are unlikely to revert. These sequences would then support the development of drug resistance in the population as it evolves under drug selection pressure. Most drug-resistance mutations against all four classes of drugs are usually present only at low frequencies (much lower than 50% with the one exception of M184V in RT) in the drug-experienced dataset (<xref ref-type="supplementary-material" rid="table2sdata1">Table 2—source datas 1</xref>, <xref ref-type="supplementary-material" rid="table2sdata2">2</xref>, <xref ref-type="supplementary-material" rid="table2sdata3">3</xref>, <xref ref-type="supplementary-material" rid="table2sdata4">4</xref>); but many of these mutations (with the exception of those conferring resistance to the NNRTIs) are highly ‘entrenched in the population’ of sequences where they do occur (<xref ref-type="table" rid="table2">Table 2</xref>), meaning that the mutation is more likely than the wild-type residue in these particular backgrounds, with low probability of reversion. The INSTI-selected resistance mutation Q148R in integrase, for example, is present in only about 5% of the patient population (in our dataset), but the mutation is entrenched in more than 85% of these sequences which have the mutation. These entrenching sequences, even though they are only a small fraction (~4.3%) of the total population, can then support the persistence of drug resistance associated with that mutation as the population evolves under drug selection pressure.</p><p>Over the last decade, viral IN has emerged as the major new focus of antiretroviral therapy. IN has been subjected to drug pressure for a considerably shorter period of time than other HIV target proteins, yet IN drug-resistance mutations are strongly ‘entrenched in the population’ of sequences containing the mutation (<xref ref-type="table" rid="table2">Table 2</xref>) similar to DRMs against PIs, and NRTIs which have been used in therapy for much longer. <xref ref-type="fig" rid="fig3">Figure 3</xref> illustrates the degree (strength or value of <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>, and frequency or number of times <inline-formula><mml:math id="inf73"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) of entrenchment for some key resistance mutations occurring in the catalytic core domain (CCD) of IN. The mutations Q148R and Q148H for example, reduce susceptibilities to the IN strand transfer inhibitors (INSTIs) raltegravir (RAL) and elvitegravir (EVG) by 40–100 fold and 5–10 fold, respectively (<xref ref-type="bibr" rid="bib27">Goethals et al., 2010</xref>; <xref ref-type="bibr" rid="bib23">Fransen et al., 2009</xref>; <xref ref-type="bibr" rid="bib1">Abram et al., 2013</xref>; <xref ref-type="bibr" rid="bib26">Goethals et al., 2008</xref>). Together, they are present in ~20% of the treated population, but they are strongly entrenched in the sequences in which they occur, with the probability of reversion being much smaller than 1%. <xref ref-type="fig" rid="fig3">Figure 3</xref> shows that the strength of entrenchment can be high for many of these mutations. For example, mutations at site 148 are entrenched in almost all sequences with this mutation, ensuring the persistence of drug resistance associated with these mutations. Comparatively, resistance mutations in RT associated with the non-nucleoside analog reverse transcriptase inhibitors (NNRTIs) are much less ‘entrenched in the population’ of sequences containing the mutation (<xref ref-type="table" rid="table2">Table 2</xref>). Only 1 (K103N/T) of the 15 mutations rendering resistance to NNRTIs shows any significant ‘entrenchment’ by the background.</p><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.011</object-id><label>Figure 3.</label><caption><title>Degree of entrenchment of key resistance mutations occurring in the catalytic core domain (CCD) of HIV-1 IN.</title><p>The change in Potts statistical energy <inline-formula><mml:math id="inf74"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> for some of the key resistance mutations occurring in the catalytic core domain (CCD) of IN, is plotted as a function of the rank of mutation-carrying sequences, ranked in descending order of their favorability towards the mutant. Plot shows the degree of entrenchment for these mutations. For example, Q148R is highly entrenched in almost all sequences carrying it, whereas, G163K is entrenched (<inline-formula><mml:math id="inf75"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) in only about half of the sequences carrying G163K.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-50524-fig3-v1.tif"/></fig><p>The striking observation that NNRTI-resistance mutations are less entrenched than those for NRTIs, PIs, and INSTIs is noteworthy (<xref ref-type="table" rid="table2">Table 2</xref>). One clear difference is that NNRTIs are the only allosteric inhibitors among the four target classes being examined here. NRTIs, PIs, and INSTIs exert their action by binding to the catalytic active sites of the target enzymes. One characteristic of active sites is that they contain invariant (or at least highly conserved) residues, and it is possible that nearby mutations interact strongly with those and their potential entrenchment may be influenced by the presence of the conserved residues. Another shared characteristic of the PI, RT, and IN active site is their catalytic residues are all acidic (PR: 2 Asp; RT 3 Asp; IN 1 Glu, 2 Asp). The NNRTI-binding site has considerably more sequence variation, with only Trp229 being invariant. Perhaps the overall variability of sequence in this region makes it more difficult for residues to become entrenched. Another key difference is that the variety of conformational states of the NNRTI-binding region is broader than for the active sites. The pocket can be closed, open, hyperextended open, and open with a shift of the primer grip, with varying degrees of solvent exposure of numerous internal hydrophobic residues (<xref ref-type="bibr" rid="bib62">Sarafianos et al., 2009</xref>).</p><p>Entrenchment of a DRM makes it hard to escape drug resistance once the mutation is highly favored in its background. <xref ref-type="table" rid="table2">Table 2</xref> shows the ‘entrenchment in the population’ of individual DRMs in sequences that carry the DRM. On aggregating over all possible DRMS, the fraction of sequences containing at least one primary DRM is greater than 60% for all four classes of DRMS (see <xref ref-type="table" rid="table3">Table 3</xref> second row). When considering the fraction of sequences carrying at least one entrenched DRM, again the fraction is close to 50% or greater for three of the four DRM classes; the prominent exception is NNRTIs for which only 28.1% carry at least one entrenched primary DRM. This implies that the persistence of drug resistance against NNRTIs as a class (compared to the others) is less likely in the population than the other three classes of HIV drugs.</p><table-wrap id="table3" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.012</object-id><label>Table 3.</label><caption><title>Entrenchment of at least one primary DRM for each of the four drug classes in HIV-1: Table shows the percentage of drug-experienced sequences which contain at least one primary DRM, and the percentage of drug-experienced sequences which contain at least one primary DRM such that the DRM is entrenched by its respective background.</title><p>This is shown separately for resistance mutations occurring in response to each of the four HIV drug classes. A significantly lower percentage (~28%) of the patient sequences carry at least one entrenched resistance mutation conferring resistance to the NNRTIs when compared to other drugs (~50%–65%).</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>NRTIs</th><th>NNRTIs</th><th>PI</th><th>Insti</th></tr></thead><tbody><tr><td>Number of sequences in MSA</td><td>19194</td><td>19194</td><td>4758</td><td>1220</td></tr><tr><td>% of total sequences containing at least one primary DRM</td><td>78.5%</td><td>62.4%</td><td>64.8%</td><td>61.7%</td></tr><tr><td>% of total sequences with at least one entrenched primary DRM</td><td>64.7%</td><td>28.1%</td><td>50.8%</td><td>47.2 %</td></tr></tbody></table></table-wrap></sec><sec id="s2-4"><title>Fitness and degree of entrenchment of observed resistance mutations: why some mutations are seen and others are not</title><p>The evolutionary trajectory of a resistance mutation depends on the balance between the fitness cost of evolving that mutation in its particular background, and the advantage it provides in evading drug pressure. It has been shown for HIV protease that a majority of the possible amino acid substitutions are observed rarely or not at all in isolates, indicating that the protein function is under strong purifying selection (<xref ref-type="bibr" rid="bib7">Boucher et al., 2019</xref>). Observed resistance mutations arising with lower fitness costs which allow the virus to escape drug pressure with the least effect on its ability to propagate infection are therefore expected to become evolutionarily ‘entrenched’ by their respective sequence-backgrounds. <xref ref-type="fig" rid="fig4">Figure 4</xref> shows the distribution of likelihoods as measured by the Potts <inline-formula><mml:math id="inf76"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> scores at drug-resistance sites in sequences where the corresponding drug-resistance mutations are present in HIV integrase. The distribution of likelihoods for observed DRMs in sequences where they are present is seen in ‘green’, while the ‘blue’ distribution shows the distribution of likelihoods of mutations to other possible residue types in these sequences (containing the DRMs) at the sites where the DRM is observed. The distribution of the likelihoods of observed IN DRMs (green in <xref ref-type="fig" rid="fig4">Figure 4</xref>) shows that these drug-resistance mutations are generally more favorable than the wild-type residue as they have a <inline-formula><mml:math id="inf77"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in their respective backgrounds where the mutations are present. The relative displacement of the green from the blue distribution shows that in sequences which contain the drug-resistance mutation, the observed mutations are predicted on average to be more likely than the consensus residue type and that mutations to other residue types at those sites in the same sequence backgrounds are even less likely than the consensus residue type, on average. Hence, the observed resistance mutations arise in these drug-experienced backgrounds and help enable the virus to evade drug pressure. The more prohibitive fitness costs associated with the appearance of rare/unobserved mutations (blue distribution in <xref ref-type="fig" rid="fig4">Figure 4</xref>) at the same sites support the suggestion that drug-resistance mutations generally confer resistance at the least fitness cost. Each distribution also has a wide range of <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> scores illustrating the wide variation in the favorabilities of different mutations in different sequence backgrounds.</p><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.013</object-id><label>Figure 4.</label><caption><title>Distribution of Potts <inline-formula><mml:math id="inf79"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo mathvariant="bold">⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> scores for key residues associated with drug resistance in HIV-1 IN.</title><p>The distribution of the Potts <inline-formula><mml:math id="inf80"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> scores for sequences carrying the particular resistance mutation are shown in ’green’ for the most frequently observed INSTI selected resistance mutations in HIV IN, and in ’blue’ for all other possible mutations at the same sites. Other possible mutations include rarely observed or unobserved mutations. The histograms show the differential distribution of <inline-formula><mml:math id="inf81"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> scores for observed vs. unobserved/rare mutations at 15 primary mutation sites associated with evolving drug resistance in HIV-1 IN. The green (observed) and blue (unobserved/rare) distributions are normalized to the total number of primary DRMs in IN in the Stanford HIVDB and the total number of other possible mutations at the same sites, respectively. The mean <inline-formula><mml:math id="inf82"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> scores for observed vs. unobserved mutations are +2.11 and −5.58, respectively (<inline-formula><mml:math id="inf83"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>). The wide distribution of <inline-formula><mml:math id="inf84"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> scores also illustrates the role of the background in which the resistance mutation occurs.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-50524-fig4-v1.tif"/></fig></sec><sec id="s2-5"><title>Molecular clones and the effects of specific backgrounds</title><p>In vitro fitness and drug susceptibility assays for viral proteins of HIV are often based on <italic>mutagenesis</italic> experiments, which are performed with specific molecular clones of the virus such as <italic>NL4-3, HXB2, LAI IIIB</italic>, etc (<xref ref-type="bibr" rid="bib39">Hu and Kuritzkes, 2010</xref>; <xref ref-type="bibr" rid="bib1">Abram et al., 2013</xref>). Mutagenesis experiments performed with specific clones, however, can only explore a limited region of the fitness and mutational landscapes available to the viral proteins accessible through the particular clones. These measurements are not necessarily representative of the fitness effects and the favorabilities of primary resistance mutations in the presence of in vivo selective pressures and entrenchment in viral background(s) of diverse patient populations as contained in the Stanford HIV drug resistance database (HIVDB, <ext-link ext-link-type="uri" xlink:href="https://hivdb.stanford.edu/">https://hivdb.stanford.edu/</ext-link>).</p><p><xref ref-type="fig" rid="fig5">Figure 5</xref> compares the predicted log likelihoods (Potts <inline-formula><mml:math id="inf85"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>s also associated with the degree of entrenchment) of primary drug-resistance mutations in integrase and reverse transcriptase averaged over the drug-experienced patient sequences in the Stanford HIVDB (denoted as <inline-formula><mml:math id="inf86"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:math></inline-formula>) with the corresponding values in the specific backgrounds of molecular clones NL4-3 (panels A and D), HXB2 (panels B and E) and the subtype B consensus sequence (panels C and F), respectively. The likelihood and degree of entrenchment of a primary resistance mutation depends strongly on the specific background in which it is accrued and as observed in <xref ref-type="fig" rid="fig5">Figure 5</xref>, these effects studied in the genetic background of a specific molecular clone does not accurately (correlates only moderately) represent the effects averaged over drug-experienced patient populations. Among the three specific sequences analyzed, NL4-3 seems to be somewhat more representative of drug-experienced patient populations than the other two. That the consensus B sequence is not the most representative serves to highlight that epistatic effects can vary significantly from the average to patient populations. In fact, the molecular clones likely represent patient backgrounds where the mutation is disfavored and likely absent, rather than where the mutation is entrenched.</p><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.014</object-id><label>Figure 5.</label><caption><title>Entrenchment and favorability of key resistance mutations in specific backgrounds.</title><p>The <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> change in Potts energy of a sequence is used as the measure of ‘entrenchment’ and favorability of key resistance mutations in HIV-1 NL4-3, HXB2, and the subtype-B consensus sequences, respectively, shown as a function of the average <inline-formula><mml:math id="inf88"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> in drug-experienced HIV-1 subtype B patient populations (<inline-formula><mml:math id="inf89"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:math></inline-formula>) in the Stanford HIVDB for viral integrase (<bold>A,B,C</bold>) and reverse transcriptase (<bold>D,E,F</bold>). In each case, the Pearson correlation coefficients are indicated. The protein sequences for the molecular clones NL4-3 and HXB2 are obtained from GenBank with accession number AF324493.2 and K03455.1, respectively with protein ids for the pol polyprotein as AAK08484.2 and AAB50259.1, respectively. The subtype B consensus sequence is obtained from the Stanford HIVDB. The degree of ‘entrenchment’ in these subtype B strains is often not representative of the average entrenchment effects in a patient population or even the most representative background from a patient population.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-50524-fig5-v1.tif"/></fig><p><xref ref-type="fig" rid="fig6">Figure 6</xref> shows the distribution of the change in Potts energy, <inline-formula><mml:math id="inf90"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> (log likelihood) values for the DRMS N155H (panel A) and G140S (panel B) in HIV IN in different drug-experienced sequence backgrounds in the Stanford HIVDB along with the <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> change in the specific backgrounds of NL4-3, HXB-2 and the subtype B consensus sequences. In terms of the change in Potts energy, which represents the degree of entrenchment of a mutation and its overall favorability in a given background, there is a clear distinction between sequence backgrounds where the mutation is present and mostly favored (or ‘entrenched’) from those where the mutation is absent. Key resistance mutations are typically disfavored in molecular clones in line with the fitness effects reported in <xref ref-type="bibr" rid="bib39">Hu and Kuritzkes (2010)</xref> and in line with sequence backgrounds that do not carry the mutation (<xref ref-type="fig" rid="fig6">Figure 6</xref>). An exception to the general rule is observed for the IN mutation N155H in NL4-3 (<xref ref-type="fig" rid="fig6">Figure 6A</xref>), where the virus, despite not carrying the mutation, is favorable towards it.</p><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.015</object-id><label>Figure 6.</label><caption><title>The particular sequence background in which a resistance mutation occurs affects the degree of entrenchment, with often a clear distinction between sequences where the mutation is present (green) versus absent (blue) shown here for the mutations N155H (<bold>A</bold>) and G140S (<bold>B</bold>) in integrase.</title><p>The degree of entrenchment for subtype B consensus, NL4-3 and HXB2 are shown as ’black dashed’, ’red’ and ’magenta’ lines, respectively. The Potts entrenchment score manifests as a clear distinction between backgrounds where a particular mutation is observed from ones where the mutation is absent, with the former more likely to present a distinct fitness advantage towards the mutation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-50524-fig6-v1.tif"/></fig></sec><sec id="s2-6"><title>Effective epistasis in the presence of drug selection pressure</title><p>HIV evolves rapidly with studies indicating that in the absence of drug pressure, the virus in a single patient explores the majority of all point mutations many times daily (<xref ref-type="bibr" rid="bib13">Coffin, 1995</xref>; <xref ref-type="bibr" rid="bib56">Perelson et al., 1996</xref>). The presence of drug selection pressure can however bias the virus to explore regions of the mutational landscape that allow the virus to evade the drug, which are not accessible otherwise. In this section, we discuss how drug treatment leads to a mutational landscape that reflects both intrinsic epistatic effects and the effects of drug selection pressure; we use the term ‘effective epistasis’ to refer to the combined effects of both.</p><p>As HIV jumps from host to host, it adapts to the applied selection pressure from each host’s immune response and drug regimen if the host is currently undergoing retroviral treatment. In the case of immune response selection pressure, (<xref ref-type="bibr" rid="bib66">Shekhar et al., 2013</xref>; <xref ref-type="bibr" rid="bib18">Ferguson et al., 2013</xref>) suggest that due to the diversity of host immune responses among the HIV population, selective effects of immune pressure are averaged so that a Potts model fit to sequences from many different hosts can effectively capture the ‘intrinsic’ fitness landscape of the virus. In the case of drug selection pressure, the correlated mutation patterns which are contained in MSAs built on drug-experienced datasets reflect a combination of intrinsic epistatic effects and possibly correlations induced by drug selection pressure. To distinguish between intrinsic epistasis and correlated drug selection pressure, we have built a second Potts statistical energy model on an MSA constructed from the Stanford HIV drug-naive dataset and compared the two models.</p><p><xref ref-type="fig" rid="fig7">Figure 7</xref> shows that the effects of point mutations captured by the changes in Potts statistical energies, <inline-formula><mml:math id="inf92"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> when scored using the two models (the drug-naive model fit to an MSA constructed using HIV sequences in the Stanford database without prior drug exposure and the drug-experienced model fit to an MSA constructed with drug-experienced sequences) are highly correlated. The changes in the ‘field’ terms are responsible for the shift in <inline-formula><mml:math id="inf93"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>s, whereas the changes in the ‘couplings’ determine the correlation coefficient. Overall, the high correlation (Pearson correlation coefficient &gt; 0.8) between the probabilities of observing the drug-resistance mutation relative to the wild-type in a given background (measured as a function of <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>), when the Potts model is parameterized on the drug-naive dataset as compared with the drug-experienced dataset shows that ‘intrinsic’ epistatic effects have a large influence on the virus evolving under drug selection pressure. A detailed comparison of the two models will be presented elsewhere.</p><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.016</object-id><label>Figure 7.</label><caption><title>Comparison of Potts models parameterized on drug-naive and drug-experienced HIV protein sequences.</title><p>The comparison of the effects of point mutations is shown in terms of Potts <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> scores (which forms the basis of our study) using two different Potts models, parameterized on drug-naive vs drug-experienced sequences for PR drug-resistance mutations M46I (<bold>A</bold>), I54V (<bold>B</bold>), V82A (<bold>C</bold>), and L90M (<bold>D</bold>), all of which appear with at least a frequency of 0.25% in both datasets. Bin shading for the 2D histogram scatter plots shown here scales logarithmically with the number of sequences whose scores fall into each bin. To obtain <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> scores, the sequences are scored using a drug-naive model vs. a drug-experienced model. The <inline-formula><mml:math id="inf97"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> scores are highly correlated with a Pearson correlation coefficient of 0.82 (<inline-formula><mml:math id="inf98"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>), 0.93 (<inline-formula><mml:math id="inf99"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>), 0.85 (<inline-formula><mml:math id="inf100"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>), and 0.82 (<inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>), respectively.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-50524-fig7-v1.tif"/></fig><p>As a consequence of fitting a Potts model on drug-experienced sequences, there may be apparent mutational correlations induced due to the varying selective pressures of different drug regimens. However, the large overlap in resistance mutation sites among different drugs of the same class (<xref ref-type="bibr" rid="bib75">Wensing et al., 2017</xref>) as seen in <xref ref-type="fig" rid="fig8">Figure 8</xref> as well as the large number of possible resistance mutations that can arise in response to any one drug, and the multi-drug resistance mutation patterns induced by many drugs (<xref ref-type="bibr" rid="bib14">Condra et al., 1995</xref>; <xref ref-type="bibr" rid="bib36">Hertogs et al., 2000</xref>; <xref ref-type="bibr" rid="bib16">Delaugerre et al., 2001</xref>), all tend to minimize the effects of such ‘spurious’ correlations in the drug-experienced dataset. Furthermore, if such ‘spurious’ correlations picked up from a drug-experienced dataset strongly affected the drug-experienced Potts model, we would not expect to see the ‘effective’ epistatic effects on <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> inferred by the drug-experienced model to be highly correlated with the ‘intrinsic’ epistatic effects of the drug-naive model as observed in <xref ref-type="fig" rid="fig7">Figure 7</xref>.</p><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.017</object-id><label>Figure 8.</label><caption><title>Drug-pressure associated mutations are largely common between drugs of the same class.</title><p>The mutations (both primary and associated) arising in drug-treated HIV proteases in response to inhibitor treatment are shown corresponding to each protease drug. The diameters of the circles represent the number of mutations at that site that occurred in sequences treated with the particular drug. Most mutations that occur in response to one drug are seen to have occurred when treated with another drug of the same class, showing that the ‘spurious correlations’ (that could be picked up by a Potts model built on a mixture of patient sequences treated with different drugs of the same class, if the mutations occurring in response to one drug are not at all observed in response to another), are minimal.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-50524-fig8-v1.tif"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The evolution of viruses like HIV under drug and immune selective pressures induces correlated mutations due to constraints on the structural stability and fitness (ability to assemble, replicate, and propagate infection) of the virus (<xref ref-type="bibr" rid="bib71">Theys et al., 2018</xref>). This is a manifestation of the epistatic interactions in the viral genome. In fact, it has been shown that long-range epistasis can shift a protein’s mutational tolerance during HIV evolution (<xref ref-type="bibr" rid="bib30">Haddox et al., 2018</xref>). Epistasis has recently become a major focus in structural biology and genomics, and co-evolutionary information encoded in collections of protein sequences have been used to infer epistatic couplings between them (<xref ref-type="bibr" rid="bib37">Hinkley et al., 2011</xref>; <xref ref-type="bibr" rid="bib18">Ferguson et al., 2013</xref>; <xref ref-type="bibr" rid="bib49">Mann et al., 2014</xref>; <xref ref-type="bibr" rid="bib38">Hopf et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Figliuzzi et al., 2016</xref>; <xref ref-type="bibr" rid="bib8">Butler et al., 2016</xref>; <xref ref-type="bibr" rid="bib32">Haldane et al., 2018</xref>). In the current study, we have used the correlated mutations encoded in an MSA of drug-experienced HIV-1 sequences to parameterize a Potts Hamiltonian model of sequence statistical energies, and used it to infer the epistatic interactions leading to drug resistance in HIV-1 Subtype B. We first confirmed the Potts model’s ability to accurately predict the likelihood of a mutation based on a Potts statistical energy analysis. The predictive power of the model is established by verifying predictions of mutation prevalence based on its background using aggregate sequence statistics from the MSA, illustrating the crucial role of the background in giving rise to a mutation. This also provides the most direct verification of the complex patterns of epistasis which lead to drug resistance in HIV.</p><p>Entrenchment of functionally important mutations has been shown to be a general feature in systems exhibiting epistasis (<xref ref-type="bibr" rid="bib57">Pollock et al., 2012</xref>). The entrenchment of primary resistance mutations described in this work suggests that epistasis plays a major role in the evolution of HIV under drug selection pressure. Both primary and accessory drug-resistance mutations exhibit strong epistatic interactions and therefore, entrenchment is a likely mechanism by which drug-resistance mutations accumulate within the population and in the persistence of drug resistance. Building on previous work by <xref ref-type="bibr" rid="bib21">Flynn et al. (2017)</xref> identifying sequence backgrounds which were predicted to strongly entrench or strongly disfavor particular primary resistance mutations in HIV-1 PR, we first confirmed the Potts model entrenchment predictions using aggregate statistics from the MSA, and then extended it to the two other major HIV drug target enzymes, RT and IN.</p><p>It has been shown by <xref ref-type="bibr" rid="bib5">Barton et al. (2016b)</xref> and <xref ref-type="bibr" rid="bib10">Chen and Kardar (2019)</xref> that large differences in escape times for HIV patients targeting the same epitope can be explained by differences in the background mutations contained in the sequence of the virus strains that infected these patients. A similar result can also be expected for the virus subjected to antiretroviral therapy. If the background mutations have strong disfavorable couplings with the primary escape mutation, the escape mutation will likely take much longer to establish itself in the population. Due to the nature of entrenchment, we expect this to be reflected in the entrenchment score of a primary mutation in a given background. Resistance mutations, particularly ones associated with high levels of drug resistance, can be expected to occur with a significant degree of entrenchment in most drug-experienced backgrounds containing the mutation. Therefore, in the context of patient populations, a study of the entrenchment of primary resistance mutations is very relevant. The most entrenched mutations are the ones which are at some local maxima in the fitness landscape. Accumulating correlated mutations as observed in <xref ref-type="fig" rid="fig2">Figure 2A</xref>, can unlock pathways to these local fitness maxima (<xref ref-type="bibr" rid="bib29">Gupta and Adami, 2016</xref>). But of crucial importance is the background in which these mutations occur. The local maxima can be 100 times more favorable in particular backgrounds, and these highly resistant sequences pose a significant risk for transmission of drug resistance to new hosts. Entrenchment of resistance mutations can thus play a central role in the persistence of drug-resistant viruses, and many of the most strongly entrenched mutations have been shown to revert slowly in drug-naive patients with transmitted resistance or in drug-experienced patients after withdrawal of ART (<xref ref-type="bibr" rid="bib41">Izopet et al., 2000</xref>; <xref ref-type="bibr" rid="bib77">Yang et al., 2015</xref>; <xref ref-type="bibr" rid="bib24">Gandhi et al., 2003</xref>; <xref ref-type="bibr" rid="bib6">Borman et al., 1996</xref>).</p><p>In vitro studies of the acquisition of drug resistance are based on mutagenesis experiments usually performed on molecular clones such as NL4-3, HXB2, IIIB, etc. We show that the epistatic effects on major drug-resistance mutations in molecular clones can be very different from what is observed in patient populations. Thus, fitness studies in particular clones may not be representative of fitness in drug-experienced patient populations or even the consensus background of a patient population.</p><p>Our comparison of the statistical energy differences <inline-formula><mml:math id="inf103"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> obtained from two Potts models of HIV protease sequence co-variation, one constructed from an MSA of drug-naive sequences in the Stanford HIV database, and the other constructed from an MSA of drug-experienced sequences, shows that the effect of the sequence background on the likelihood of observing a drug-resistance mutation compared with a consensus residue is highly correlated between the drug-experienced and drug-naive datasets (<xref ref-type="fig" rid="fig7">Figure 7</xref>). This supports our conclusion that ‘intrinsic’ epistatic effects have a strong influence on the virus evolving under drug selection pressure. While beyond the scope of the present work, this observation invites further analysis and opens up new avenues of research designed to interrogate in a quantitative way how the application of drug selection pressure changes the intrinsic mutational landscape. In order to identify HIV sequences which are most responsible for conferring drug resistance, we need to know the probabilities of observing highly entrenching sequences in the drug-naive population as well as in the drug-experienced population. Multi-canonical reweighting techniques have been developed for this purpose (<xref ref-type="bibr" rid="bib70">Tan et al., 2016</xref>). While the present work does not deal with the time development of drug resistance or identify evolutionary paths, our construction of Potts models from both the drug-naive and drug-experienced populations, sets the stage for kinetic Monte-Carlo studies of pathways by which drug resistance is acquired.</p><p>Overall, the analysis presented here provides a framework for further studies of the fitness of HIV proteins evolving under drug selection pressure. The Potts model parameterized on the drug-experienced dataset is a powerful classifier that can identify complex sequence patterns that highly favor (entrench) or disfavor each drug-resistance mutation. Elucidating the epistatic effects of key resistance mutations has the potential to impact future HIV therapies and their entrenchment may be an important factor reinforcing the emergence of drug-resistant strains. The degree of entrenchment of key resistance mutations can provide insights about the fitness of these mutations in the context of a patient HIV reservoir; and their differential degree of entrenchment in different viral sequence backgrounds has the potential to impact future drug design strategies for the next generation of c-ART based on the patient viral reservoir, and suggests that the future of these strategies may very well involve personalized medicine based on an analysis of each patient’s individual viral genomic background.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>In this section, we give a brief introduction to the Potts Hamiltonian model and the motivation behind the model. The Potts model is a probabilistic model of sequence co-variation built on the single and pairwise site amino-acid frequencies of a protein MSA, and aimed to describe the observation probabilities of the various states of the system (sequences in the MSA).</p><p>To build the inference model, the goal is to approximate the unknown empirical probability distribution <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> which best describes HIV-1 sequences <inline-formula><mml:math id="inf105"><mml:mi>S</mml:mi></mml:math></inline-formula> of length <inline-formula><mml:math id="inf106"><mml:mi>L</mml:mi></mml:math></inline-formula>, where each residue is encoded in an alphabet <inline-formula><mml:math id="inf107"><mml:mi>Q</mml:mi></mml:math></inline-formula>, by a model probability distribution <inline-formula><mml:math id="inf108"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as in <xref ref-type="bibr" rid="bib54">Mora and Bialek (2011)</xref>. We choose the ‘least biased’ or maximum entropy distribution as the model distribution. Such distributions maximizing the entropy have been previously derived in <xref ref-type="bibr" rid="bib53">Mézard and Mora (2009)</xref>; <xref ref-type="bibr" rid="bib74">Weigt et al. (2009)</xref>; <xref ref-type="bibr" rid="bib55">Morcos et al. (2011)</xref>; <xref ref-type="bibr" rid="bib18">Ferguson et al. (2013)</xref>; <xref ref-type="bibr" rid="bib4">Barton et al. (2016a)</xref> with the constraint that the empirical univariate and bivariate marginal distributions are effectively preserved. We follow a derivation of the maximum entropy model using Lagrange multipliers as in <xref ref-type="bibr" rid="bib54">Mora and Bialek (2011)</xref> and <xref ref-type="bibr" rid="bib18">Ferguson et al. (2013)</xref>. Our maximum entropy model takes the form of an exponential distribution given by:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi><mml:mi>L</mml:mi></mml:munderover><mml:msubsup><mml:mi>h</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where the quantity <inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the Potts Hamiltonian determining the statistical energy of a sequence <inline-formula><mml:math id="inf110"><mml:mi>S</mml:mi></mml:math></inline-formula> of length <inline-formula><mml:math id="inf111"><mml:mi>L</mml:mi></mml:math></inline-formula>, the model parameters <inline-formula><mml:math id="inf112"><mml:msubsup><mml:mi>h</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> called ‘fields’ represent the statistical energy of residue <inline-formula><mml:math id="inf113"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> at position i in sequence <inline-formula><mml:math id="inf114"><mml:mi>S</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf115"><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> are ‘couplings’ representing the energy contribution of a position pair <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>. In this form, the Potts Hamiltonian consists of <inline-formula><mml:math id="inf117"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula> field parameters <inline-formula><mml:math id="inf118"><mml:msubsup><mml:mi>h</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>L</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> coupling parameters <inline-formula><mml:math id="inf120"><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, and for the exponential distribution <inline-formula><mml:math id="inf121"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>∝</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, negative fields and couplings signify favored amino acids. The change in Potts energy due to mutating a residue <inline-formula><mml:math id="inf122"><mml:mi>α</mml:mi></mml:math></inline-formula> at position <inline-formula><mml:math id="inf123"><mml:mi>i</mml:mi></mml:math></inline-formula> in <inline-formula><mml:math id="inf124"><mml:mi>S</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf125"><mml:mi>β</mml:mi></mml:math></inline-formula> is then given by:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>→</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>In this form, a <inline-formula><mml:math id="inf126"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>→</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> implies that the residue <inline-formula><mml:math id="inf127"><mml:mi>β</mml:mi></mml:math></inline-formula> is more favorable than residue <inline-formula><mml:math id="inf128"><mml:mi>α</mml:mi></mml:math></inline-formula> at position <inline-formula><mml:math id="inf129"><mml:mi>i</mml:mi></mml:math></inline-formula> for the given sequence <inline-formula><mml:math id="inf130"><mml:mi>S</mml:mi></mml:math></inline-formula>. If <inline-formula><mml:math id="inf131"><mml:mi>α</mml:mi></mml:math></inline-formula> represents the wild-type residue at <inline-formula><mml:math id="inf132"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf133"><mml:mi>β</mml:mi></mml:math></inline-formula> the mutant, then the mutant is favorable over the wild-type if <inline-formula><mml:math id="inf134"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for the change, and <italic>vice versa</italic>.</p><p>The methodology followed in this analysis is similar to the one followed in <xref ref-type="bibr" rid="bib21">Flynn et al. (2017)</xref> for HIV-1 PR (for further details on derivation and description of the model parameters see their Materials and methods section as well as the SI). The sample size of the MSA plays a critical role in determining the quality and effectiveness of the model (<xref ref-type="bibr" rid="bib33">Haldane and Levy, 2019</xref>) and we confirm that the models are fit using sufficient data with minimal overfitting.</p><sec id="s4-1"><title>Data processing and mutation classification</title><p>The method begins with the collection of sequence and patient as well as reference information from the Stanford University HIV Drug resistance database (HIVDB, <ext-link ext-link-type="uri" xlink:href="https://hivdb.stanford.edu">https://hivdb.stanford.edu</ext-link>) (<xref ref-type="bibr" rid="bib59">Rhee et al., 2003</xref>; <xref ref-type="bibr" rid="bib63">Shafer, 2006</xref>). In this work, we have used the Stanford HIVDB genotype-rx (<ext-link ext-link-type="uri" xlink:href="https://hivdb.stanford.edu/pages/genotype-rx.html">https: //hivdb.stanford.edu/pages/genotype-rx.html</ext-link>) to obtain protein sequences for HIV target proteins. Alternatively, downloadable sequence datasets are also available on the Stanford HIVDB ( <ext-link ext-link-type="uri" xlink:href="https://hivdb.stanford.edu/pages/geno-rx-datasets.html">https://hivdb.stanford.edu/pages/geno-rx-datasets.html</ext-link>). The filtering criteria we used are: HIV-1, subtype B and nonCRF, and drug-experienced (# of PI = 1–9 for PR, # of NRTI = 1–9 and # of NNRTI = 1–4 for RT, and # of INST = 1–3 for IN), removal of mixtures, and unambiguous amino acid sequences (amino acids are ‘-ACDEFGHIKLMNPQRSTVWY’). For RT, sequences with exposure to both NRTIs and NNRTIs were selected. An alternate search for RT sequences exposed to only NRTIs or NNRTIs would return a vastly smaller number of isolates (5398 and 80 isolates, respectively for sequences exposed to only NRTIs or only NNRTIs as compared to 22446 isolates for sequences exposed to both). Sequences with insertions (‘#’) and deletions (‘~’) are removed. MSA columns and rows with more than 1% gaps (‘.’) are removed. This resulted in a final MSA size of <inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>4758</mml:mn></mml:mrow></mml:math></inline-formula> sequences of length <inline-formula><mml:math id="inf136"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>93</mml:mn></mml:mrow></mml:math></inline-formula> for PR, <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>19194</mml:mn></mml:mrow></mml:math></inline-formula> sequences of length <inline-formula><mml:math id="inf138"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>188</mml:mn></mml:mrow></mml:math></inline-formula> for RT, and <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>1220</mml:mn></mml:mrow></mml:math></inline-formula> sequences of length <inline-formula><mml:math id="inf140"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>263</mml:mn></mml:mrow></mml:math></inline-formula> for IN. (Sequence datasets now available in the Stanford HIVDB are further updated, last on February, 2019). To retain enough sequence coverage in the MSA, we removed residues: residues 1–38 and residue 227 onwards for RT (see <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref> of Appendix), and 264 onwards for IN. For this reason, some interesting DRMs like F227I/L/V/C, L234I, P236L or N348I (NNRTI affected) for RT are not amenable for our analysis. For drug-naive PR model, sequences are obtained from the Stanford HIVDB using the criterion # of PI = 0, and after filtering of inserts, deletes, rows or columns with too many ‘gap’ characters, etc results in an MSA of <inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>14969</mml:mn></mml:mrow></mml:math></inline-formula> sequences of length <inline-formula><mml:math id="inf142"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>93</mml:mn></mml:mrow></mml:math></inline-formula>. The protein sequences for the molecular clones NL4-3 and HXB2 are obtained from GenBank (<xref ref-type="bibr" rid="bib11">Clark et al., 2016</xref>) with accession number AF324493.2 and K03455.1, respectively. The protein ids for the pol polyprotein are AAK08484.2 and AAB50259.1, respectively. The subtype B consensus sequence is obtained from the Los Alamos HIV sequence database (<xref ref-type="bibr" rid="bib22">Foley et al., 2018</xref>) consensus and ancestral sequence alignments (<ext-link ext-link-type="uri" xlink:href="https://www.hiv.lanl.gov/content/sequence/HIV/CONSENSUS/Consensus.html">https://www.hiv.lanl.gov/content/sequence/HIV/CONSENSUS/Consensus.html</ext-link>, last updated August 2004), and is also available in Appendix 1 of the Stanford HIVDB release notes page (<ext-link ext-link-type="uri" xlink:href="https://hivdb.stanford.edu/page/release-notes/">https://hivdb.stanford.edu/page/release-notes/</ext-link>). Sequences are given weights reciprocal to the number of sequences contributed by each patient such that if multiple sequences are obtained from a single patient, the effective number of sequences obtained from any single patient is still 1. Sequences from different patients are assumed to be independent. It has been shown that phylogenetic trees of drug-naive and drug-experienced HIV-1 patients exhibit star-like phylogenies (<xref ref-type="bibr" rid="bib44">Keele et al., 2008</xref>; <xref ref-type="bibr" rid="bib29">Gupta and Adami, 2016</xref>), and thus, phylogenetic corrections are not required. Potts models of different HIV-1 protein sequences under immune pressure have also previously been parameterized without phylogenetic corrections (<xref ref-type="bibr" rid="bib18">Ferguson et al., 2013</xref>; <xref ref-type="bibr" rid="bib49">Mann et al., 2014</xref>; <xref ref-type="bibr" rid="bib8">Butler et al., 2016</xref>).</p><p>In this work, mutations in the HIV genome have been classified into three main classes: primary or signature drug-resistance mutations, accessory or secondary mutations, and polymorphic mutations. The subtype B consensus sequence, which is derived from an alignment of subtype B sequences maintained at the Los Alamos HIV Sequence Database (<ext-link ext-link-type="uri" xlink:href="https://www.hiv.lanl.gov/content/sequence/HIV/CONSENSUS/Consensus.html">https://www.hiv.lanl.gov</ext-link>), and is a commonly used reference sequence to which new sequences are compared, is used as our reference sequence and is referred to as the ‘consensus wild-type’ throughout the text. In accordance with current literature <xref ref-type="bibr" rid="bib75">Wensing et al. (2017)</xref> and the Stanford HIV Drug Resistance Database (<xref ref-type="bibr" rid="bib59">Rhee et al., 2003</xref>; <xref ref-type="bibr" rid="bib63">Shafer, 2006</xref>), any mutation that (i) affects in vitro drug-susceptibility, (ii) occurs commonly in persons experiencing virological failure, and (iii) occurs with fairly low extent of polymorphism (mutations occurring commonly as natural variants) among untreated individuals, is classified as a major or primary drug-resistance mutation. In contrast, mutations with little or no effect on drug susceptibility are classified as accessory or secondary. Such mutations may reduce drug susceptibility or increase replication fitness only in combination with a primary mutation. Polymorphic mutations are mutations occurring as natural variants typically in antiretroviral drug (ARV) naive patients. Polymorphic mutations may occur in the absence of drug pressure and usually have little effect on ARV susceptibility when they occur without other DRMs. In this regard, polymorphic mutations affecting ARV susceptibility in combination with other DRMs can be classified as accessory.</p></sec><sec id="s4-2"><title>Alphabet reduction</title><p>It has been shown that a reduced grouping of alphabets based on statistical properties can still capture most of the information in the full 20 letter alphabet while decreasing the number of degrees of freedom and thereby, leading to a more efficient model inference (<xref ref-type="bibr" rid="bib4">Barton et al., 2016a</xref>; <xref ref-type="bibr" rid="bib31">Haldane et al., 2016</xref>). All the possible alphabet reductions from 21 amino acid characters (20+1 gap) to 20 amino acid characters at any site <inline-formula><mml:math id="inf143"><mml:mi>i</mml:mi></mml:math></inline-formula> are enumerated for all pair of positions <inline-formula><mml:math id="inf144"><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, by summing the bivariate marginals for each of the <inline-formula><mml:math id="inf145"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>21</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> possible combinations of amino acid characters, and choosing the alphabet grouping which minimizes the root mean square difference (RMSD) in mutual information (MI):<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo maxsize="160%" minsize="160%">(</mml:mo><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo maxsize="160%" minsize="160%">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></disp-formula>between all pairs of positions <inline-formula><mml:math id="inf146"><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The process is then iteratively carried out from 20 amino acid characters to 19, and so on until the desired reduction in amino acid characters is reached. Due to residue conservation at many sites in HIV-1, several previous studies have used a binary alphabet to extract meaningful information from HIV sequences (<xref ref-type="bibr" rid="bib76">Wu et al., 2003</xref>; <xref ref-type="bibr" rid="bib18">Ferguson et al., 2013</xref>; <xref ref-type="bibr" rid="bib20">Flynn et al., 2015</xref>). A binary alphabet however, marginalizes the information at a site to only the wild-type and mutant residues, with the loss of some informative distinctions between residues particularly at sites acquiring multiple mutations. To strike a balance between loss of information due alphabet reduction and reduction of the number of degrees of freedom for effective model inference, we use a reduced alphabet of 4 letters in line with <xref ref-type="bibr" rid="bib21">Flynn et al. (2017)</xref>. Our four letter alphabet reduction gives a <italic>Pearson’s</italic> <inline-formula><mml:math id="inf147"><mml:msup><mml:mi>R</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:msup></mml:math></inline-formula> coefficient of 0.995, 0.984, and 0.980 for protease, reverse transcriptase, and integrase, respectively between the <inline-formula><mml:math id="inf148"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> of bivariate marginal distributions with the full 21 letter alphabet and the reduced four letter alphabet, representing a minimal loss of information due to the reduction.</p><p>Using the reduced alphabet, the original MSA is then re-encoded and the bivariate marginals are recalculated. Small pseudocounts are then added to the bivariate marginals, as described by <xref ref-type="bibr" rid="bib31">Haldane et al. (2016)</xref> to make up for sampling bias or limit divergence in the following inference procedure.</p></sec><sec id="s4-3"><title>Model inference</title><p>The goal of the model inference is to find a suitable set of Potts parameters <inline-formula><mml:math id="inf149"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> that fully determines the Potts Hamiltonian <inline-formula><mml:math id="inf150"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the total probability distribution <inline-formula><mml:math id="inf151"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> given in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> and <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>, respectively. This is done by obtaining the set of fields and couplings <inline-formula><mml:math id="inf152"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, which yield bivariate marginal estimates that best reproduce the empirical bivariate marginals.</p><p>A number of techniques to this effect have been developed previously (<xref ref-type="bibr" rid="bib53">Mézard and Mora, 2009</xref>; <xref ref-type="bibr" rid="bib74">Weigt et al., 2009</xref>; <xref ref-type="bibr" rid="bib3">Balakrishnan et al., 2011</xref>; <xref ref-type="bibr" rid="bib12">Cocco and Monasson, 2011</xref>; <xref ref-type="bibr" rid="bib55">Morcos et al., 2011</xref>; <xref ref-type="bibr" rid="bib34">Haq et al., 2012</xref>; <xref ref-type="bibr" rid="bib43">Jones et al., 2012</xref>; <xref ref-type="bibr" rid="bib17">Ekeberg et al., 2013</xref>; <xref ref-type="bibr" rid="bib18">Ferguson et al., 2013</xref>; <xref ref-type="bibr" rid="bib4">Barton et al., 2016a</xref>). We follow the methodology given in <xref ref-type="bibr" rid="bib18">Ferguson et al. (2013)</xref>. Given a set of fields and couplings, the bivariate marginals are estimated by generating sequences through a Markov Chain Monte Carlo (MCMC) sampling with the Metropolis criterion for a generated sequence proportional to the exponentiated Potts Hamiltonian. A multidimensional Newton search algorithm is then used to find the optimal set of Potts parameters <inline-formula><mml:math id="inf153"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. The descent step in the Newton search is determined after comparing the bivariate marginal estimates generated from the MCMC sample with the empirical bivariate marginal distribution. Although approximations are made in the computation of the Newton steps, the advantage of this method is that it avoids making explicit approximations to the model probability distribution. The method is limited by the sampling error of the input empirical marginal distributions and can also be computationally quite intensive. Our GPU implementation of the MCMC method makes it computationally tractable without resorting to more approximate inverse inference methods. The MCMC algorithm implemented on GPUs has been used to infer Potts models of sequence covariation which are sufficiently accurate to infer higher order marginals as shown by <xref ref-type="bibr" rid="bib21">Flynn et al. (2017)</xref>; <xref ref-type="bibr" rid="bib32">Haldane et al. (2018)</xref>. For a full description of the inference technique, we refer the reader to the supplemental information of <xref ref-type="bibr" rid="bib31">Haldane et al. (2016)</xref>.</p><p>The scheme for choosing the Newton update step is important. <xref ref-type="bibr" rid="bib18">Ferguson et al. (2013)</xref> developed a quasi-Newton parameter update approach which determines the updates to <inline-formula><mml:math id="inf154"><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf155"><mml:msup><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:math></inline-formula> by inverting the system’s Jacobian. In order to simplify and speed up the computation, we take advantage of the gauge invariance of the Potts Hamiltonian. We use a fieldless gauge in which <inline-formula><mml:math id="inf156"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf157"><mml:mi>i</mml:mi></mml:math></inline-formula>, and we compute the expected change in the model bivariate marginals <inline-formula><mml:math id="inf158"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> (hereafter dropping the m subscript) due to a change in <inline-formula><mml:math id="inf159"><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> to the first order by:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Computing the Jacobian <inline-formula><mml:math id="inf160"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math></inline-formula> and inverting the linear system in <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> to solve for the changes in <inline-formula><mml:math id="inf161"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf162"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> given the <inline-formula><mml:math id="inf163"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, is the challenging part of the computation. We choose the <inline-formula><mml:math id="inf164"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> as:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>with a small enough damping parameter <inline-formula><mml:math id="inf165"><mml:mi>γ</mml:mi></mml:math></inline-formula> such that the linear (and other) approximations are valid.</p><p>The computational cost of fitting <inline-formula><mml:math id="inf166"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>L</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>93</mml:mn><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>372</mml:mn><mml:mo>,</mml:mo><mml:mn>816</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> model parameters for the smallest protein in our analysis, PR, on 2 NVIDIA K80 or 4 NVIDIA TitanX GPUs is <inline-formula><mml:math id="inf167"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo>⁢</mml:mo><mml:mi>â</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">€</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">‰</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. The methodology followed in this analysis is almost the same as done in <xref ref-type="bibr" rid="bib21">Flynn et al. (2017)</xref> (see Materials and methods) for HIV-1 PR. For a more detailed description of data preprocessing, model inference, and comparison with other methods, we refer the reader to the SI and text of <xref ref-type="bibr" rid="bib21">Flynn et al. (2017)</xref>; <xref ref-type="bibr" rid="bib31">Haldane et al. (2016)</xref>; <xref ref-type="bibr" rid="bib32">Haldane et al. (2018)</xref>; <xref ref-type="bibr" rid="bib33">Haldane and Levy (2019)</xref>.</p><p>A repository containing the inference methodology code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ComputationalBiophysicsCollaborative/IvoGPU">https://github.com/ComputationalBiophysicsCollaborative/IvoGPU</ext-link> and the final MSAs are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ComputationalBiophysicsCollaborative/elife_data">https://github.com/ComputationalBiophysicsCollaborative/elife_data</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/elife_data">https://github.com/elifesciences-publications/elife_data</ext-link>). Appendix 1 contains a figure showing the sequence coverage for RT and tables of most entrenched and least entrenched sequences with same Hamming distances, for some important DRMs in PR, RT and IN.</p></sec><sec id="s4-4"><title>Statistical robustness of HIV potts models</title><p>Finite sampling error and overfitting can play an important role in all inference problems, and inverse Ising inference is no exception. Overfitting of the Potts model cannot be simply estimated by comparing the number of model parameters to the number of sequences being fit. Our Potts model is not directly fit to the sequences but to the bivariate marginals (pairwise residue frequencies) of the MSA, and there are equal numbers of model parameters as there are bivariate marginals. The inference problem is neither over nor under constrained. The major source of error that affects our model inference is the fact that the inference relies on pair statistics (bivariate marginals) found in a finite collection of sequences. Overfitting comes from this finite-sampling error in the bivariate marginals estimated from a finite-sized multiple sequence alignment (MSA) which then serves as the input for model inference. It has been shown by <xref ref-type="bibr" rid="bib33">Haldane and Levy (2019)</xref> that it is possible to fit accurate Potts models to MSAs when the number of sequences in the MSA is much smaller than the number of parameters of the Potts model.</p><p>The degree of Potts model overfitting can be quantified using the ‘signal to noise ratio’, or SNR, which is a function of the sequence length <inline-formula><mml:math id="inf168"><mml:mi>L</mml:mi></mml:math></inline-formula>, alphabet size <inline-formula><mml:math id="inf169"><mml:mi>q</mml:mi></mml:math></inline-formula>, number of sequences in the MSA <inline-formula><mml:math id="inf170"><mml:mi>N</mml:mi></mml:math></inline-formula>, and a measure of the degree of conservation of the MSA, <inline-formula><mml:math id="inf171"><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>. Using an SNR analysis of the kind described in <xref ref-type="bibr" rid="bib33">Haldane and Levy (2019)</xref>, we conclude that the Potts models for HIV-1 PR and RT are clearly not overfit (SNR values are 21.6 for PR, and 43.7 for RT). Since the number of sequences in the IN MSA is considerably smaller than the others, the IN model can be more affected by overfitting and may be less reliable than others (SNR is 0.14). However, the different types of predictions based on Potts models are differently affected by finite sampling error; predictions of the effect of point mutations to a sequence, <inline-formula><mml:math id="inf172"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>, which forms the basis of this study are the most robust and least affected by finite sampling. Using the in silico tests suggested in <xref ref-type="bibr" rid="bib33">Haldane and Levy (2019)</xref>, we find that the effects of point mutations are accurately captured even in the IN model, which is the most susceptible to finite sampling errors among our three models (for a more detailed analysis of the effects of finite sampling on the predictions of the Potts model, we refer the reader to <xref ref-type="bibr" rid="bib33">Haldane and Levy, 2019</xref>). Thus, we conclude that the MSA sample sizes for PR, RT, and IN used in this study are sufficiently large to construct Potts models for these HIV proteins that adequately reflect the effects of the sequence background on point mutations which are the central focus of this work.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank the very supportive collaborative environment provided by the HIV Interaction and Viral Evolution (HIVE) Center at the Scripps Research Institute (<ext-link ext-link-type="uri" xlink:href="http://hivescripps.edu">http://hivescripps.edu</ext-link>, last accessed January, 2019). We thank Alan Engelman for his comments and suggestions for revisions of a draft of this manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Formal analysis, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Formal analysis, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Formal analysis, Writing—original draft</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Formal analysis, Writing—original draft, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.50524.018</object-id><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-50524-transrepform-v1.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Sequence data analyzed in this study is obtained from the Stanford University HIV drug resistance database (<ext-link ext-link-type="uri" xlink:href="https://hivdb.stanford.edu/">https://hivdb.stanford.edu/</ext-link>), Los Alamos HIV sequence database (<ext-link ext-link-type="uri" xlink:href="https://www.hiv.lanl.gov/content/sequence/HIV/mainpage.html">https://www.hiv.lanl.gov/content/sequence/HIV/mainpage.html</ext-link>). Source data tables are provided for Table 2.</p><p>The following previously published datasets were used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Rhee</surname><given-names>S-Y</given-names></name><name><surname>Gonzales</surname><given-names>MJ</given-names></name><name><surname>Kantor</surname><given-names>R</given-names></name><name><surname>Betts</surname><given-names>BJ</given-names></name><name><surname>Ravela</surname><given-names>J</given-names></name><name><surname>Shafer</surname><given-names>RW</given-names></name></person-group><year iso-8601-date="2003">2003</year><data-title>Stanford University HIV drug resistance database: Genotype-Treatment Correlations</data-title><source>Stanford HIV drug resistance database</source><pub-id assigning-authority="other" pub-id-type="archive" xlink:href="https://hivdb.stanford.edu/pages/geno-rx-datasets.html">GENOTYPE-RX</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Foley</surname><given-names>B</given-names></name><name><surname>Leitner</surname><given-names>T</given-names></name><name><surname>Apetrei</surname><given-names>C</given-names></name><name><surname>Hahn</surname><given-names>B</given-names></name><name><surname>Mizrachi</surname><given-names>I</given-names></name><name><surname>Mullins</surname><given-names>J</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Wolinsky</surname><given-names>S</given-names></name><name><surname>Korber</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2004">2004</year><data-title>Consensus and Ancestral Sequence Alignments, Select 'Alignment type:Consensus/Ancestral', 'organism: HIV-1/SIVcpz', 'Pre-defined region of the genome: POL', Subtype:All', 'DNA/PRotein: Protein'</data-title><source>Los Alamos HIV sequence database</source><pub-id assigning-authority="other" pub-id-type="archive" xlink:href="https://hiv.lanl.gov/content/sequence/NEWALIGN/align.html">Consensus and Ancestral Sequence Alignments</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abram</surname> <given-names>ME</given-names></name><name><surname>Hluhanich</surname> <given-names>RM</given-names></name><name><surname>Goodman</surname> <given-names>DD</given-names></name><name><surname>Andreatta</surname> <given-names>KN</given-names></name><name><surname>Margot</surname> <given-names>NA</given-names></name><name><surname>Ye</surname> <given-names>L</given-names></name><name><surname>Niedziela-Majka</surname> <given-names>A</given-names></name><name><surname>Barnes</surname> <given-names>TL</given-names></name><name><surname>Novikov</surname> <given-names>N</given-names></name><name><surname>Chen</surname> <given-names>X</given-names></name><name><surname>Svarovskaia</surname> <given-names>ES</given-names></name><name><surname>McColl</surname> <given-names>DJ</given-names></name><name><surname>White</surname> <given-names>KL</given-names></name><name><surname>Miller</surname> <given-names>MD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Impact of primary elvitegravir Resistance-Associated mutations in HIV-1 integrase on drug susceptibility and viral replication fitness</article-title><source>Antimicrobial Agents and Chemotherapy</source><volume>57</volume><fpage>2654</fpage><lpage>2663</lpage><pub-id pub-id-type="doi">10.1128/AAC.02568-12</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>An</surname> <given-names>DS</given-names></name><name><surname>Morizono</surname> <given-names>K</given-names></name><name><surname>Li</surname> <given-names>QX</given-names></name><name><surname>Mao</surname> <given-names>SH</given-names></name><name><surname>Lu</surname> <given-names>S</given-names></name><name><surname>Chen</surname> <given-names>IS</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>An inducible human immunodeficiency virus type 1 (hiv-1) vector which effectively suppresses hiv-1 replication</article-title><source>Journal of Virology</source><volume>73</volume><fpage>7671</fpage><lpage>7677</lpage><pub-id pub-id-type="pmid">10438857</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balakrishnan</surname> <given-names>S</given-names></name><name><surname>Kamisetty</surname> <given-names>H</given-names></name><name><surname>Carbonell</surname> <given-names>JG</given-names></name><name><surname>Lee</surname> <given-names>SI</given-names></name><name><surname>Langmead</surname> <given-names>CJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Learning generative models for protein fold families</article-title><source>Proteins: Structure, Function, and Bioinformatics</source><volume>79</volume><fpage>1061</fpage><lpage>1078</lpage><pub-id pub-id-type="doi">10.1002/prot.22934</pub-id><pub-id pub-id-type="pmid">21268112</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname> <given-names>JP</given-names></name><name><surname>De Leonardis</surname> <given-names>E</given-names></name><name><surname>Coucke</surname> <given-names>A</given-names></name><name><surname>Cocco</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016a</year><article-title>ACE: adaptive cluster expansion for maximum entropy graphical model inference</article-title><source>Bioinformatics</source><volume>32</volume><fpage>3089</fpage><lpage>3097</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw328</pub-id><pub-id pub-id-type="pmid">27329863</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname> <given-names>JP</given-names></name><name><surname>Goonetilleke</surname> <given-names>N</given-names></name><name><surname>Butler</surname> <given-names>TC</given-names></name><name><surname>Walker</surname> <given-names>BD</given-names></name><name><surname>McMichael</surname> <given-names>AJ</given-names></name><name><surname>Chakraborty</surname> <given-names>AK</given-names></name></person-group><year iso-8601-date="2016">2016b</year><article-title>Relative rate and location of intra-host HIV evolution to evade cellular immunity are predictable</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>11660</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms11660</pub-id><pub-id pub-id-type="pmid">27212475</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borman</surname> <given-names>AM</given-names></name><name><surname>Paulous</surname> <given-names>S</given-names></name><name><surname>Clavel</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Resistance of human immunodeficiency virus type 1 to protease inhibitors: selection of resistance mutations in the presence and absence of the drug</article-title><source>Journal of General Virology</source><volume>77</volume><fpage>419</fpage><lpage>426</lpage><pub-id pub-id-type="doi">10.1099/0022-1317-77-3-419</pub-id><pub-id pub-id-type="pmid">8601776</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boucher</surname> <given-names>JI</given-names></name><name><surname>Whitfield</surname> <given-names>TW</given-names></name><name><surname>Dauphin</surname> <given-names>A</given-names></name><name><surname>Nachum</surname> <given-names>G</given-names></name><name><surname>Hollins</surname> <given-names>C</given-names></name><name><surname>Zeldovich</surname> <given-names>KB</given-names></name><name><surname>Swanstrom</surname> <given-names>R</given-names></name><name><surname>Schiffer</surname> <given-names>CA</given-names></name><name><surname>Luban</surname> <given-names>J</given-names></name><name><surname>Bolon</surname> <given-names>DNA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Constrained mutational sampling of amino acids in HIV-1 protease evolution</article-title><source>Molecular Biology and Evolution</source><volume>36</volume><fpage>798</fpage><lpage>810</lpage><pub-id pub-id-type="doi">10.1093/molbev/msz022</pub-id><pub-id pub-id-type="pmid">30721995</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname> <given-names>TC</given-names></name><name><surname>Barton</surname> <given-names>JP</given-names></name><name><surname>Kardar</surname> <given-names>M</given-names></name><name><surname>Chakraborty</surname> <given-names>AK</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Identification of drug resistance mutations in HIV from constraints on natural evolution</article-title><source>Physical Review E</source><volume>93</volume><elocation-id>022412</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.93.022412</pub-id><pub-id pub-id-type="pmid">26986367</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname> <given-names>MW</given-names></name><name><surname>Torbett</surname> <given-names>BE</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Accessory mutations maintain stability in drug-resistant HIV-1 protease</article-title><source>Journal of Molecular Biology</source><volume>410</volume><fpage>756</fpage><lpage>760</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2011.03.038</pub-id><pub-id pub-id-type="pmid">21762813</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>H</given-names></name><name><surname>Kardar</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Mean-field computational approach to hiv dynamics on a fitness landscape</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/518704</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname> <given-names>K</given-names></name><name><surname>Karsch-Mizrachi</surname> <given-names>I</given-names></name><name><surname>Lipman</surname> <given-names>DJ</given-names></name><name><surname>Ostell</surname> <given-names>J</given-names></name><name><surname>Sayers</surname> <given-names>EW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>GenBank</article-title><source>Nucleic Acids Research</source><volume>44</volume><fpage>D67</fpage><lpage>D72</lpage><pub-id pub-id-type="doi">10.1093/nar/gkv1276</pub-id><pub-id pub-id-type="pmid">26590407</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cocco</surname> <given-names>S</given-names></name><name><surname>Monasson</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Adaptive cluster expansion for inferring boltzmann machines with noisy data</article-title><source>Physical Review Letters</source><volume>106</volume><elocation-id>090601</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.106.090601</pub-id><pub-id pub-id-type="pmid">21405611</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coffin</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>HIV population dynamics in vivo: implications for genetic variation, pathogenesis, and therapy</article-title><source>Science</source><volume>267</volume><fpage>483</fpage><lpage>489</lpage><pub-id pub-id-type="doi">10.1126/science.7824947</pub-id><pub-id pub-id-type="pmid">7824947</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Condra</surname> <given-names>JH</given-names></name><name><surname>Schleif</surname> <given-names>WA</given-names></name><name><surname>Blahy</surname> <given-names>OM</given-names></name><name><surname>Gabryelski</surname> <given-names>LJ</given-names></name><name><surname>Graham</surname> <given-names>DJ</given-names></name><name><surname>Quintero</surname> <given-names>JC</given-names></name><name><surname>Rhodes</surname> <given-names>A</given-names></name><name><surname>Robbins</surname> <given-names>HL</given-names></name><name><surname>Roth</surname> <given-names>E</given-names></name><name><surname>Shivaprakash</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>In vivo emergence of HIV-1 variants resistant to multiple protease inhibitors</article-title><source>Nature</source><volume>374</volume><fpage>569</fpage><lpage>571</lpage><pub-id pub-id-type="doi">10.1038/374569a0</pub-id><pub-id pub-id-type="pmid">7700387</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>da Silva</surname> <given-names>J</given-names></name><name><surname>Coetzer</surname> <given-names>M</given-names></name><name><surname>Nedellec</surname> <given-names>R</given-names></name><name><surname>Pastore</surname> <given-names>C</given-names></name><name><surname>Mosier</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Fitness epistasis and constraints on adaptation in a human immunodeficiency virus type 1 protein region</article-title><source>Genetics</source><volume>185</volume><fpage>293</fpage><lpage>303</lpage><pub-id pub-id-type="doi">10.1534/genetics.109.112458</pub-id><pub-id pub-id-type="pmid">20157005</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delaugerre</surname> <given-names>C</given-names></name><name><surname>Rohban</surname> <given-names>R</given-names></name><name><surname>Simon</surname> <given-names>A</given-names></name><name><surname>Mouroux</surname> <given-names>M</given-names></name><name><surname>Tricot</surname> <given-names>C</given-names></name><name><surname>Agher</surname> <given-names>R</given-names></name><name><surname>Huraux</surname> <given-names>JM</given-names></name><name><surname>Katlama</surname> <given-names>C</given-names></name><name><surname>Calvez</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Resistance profile and cross-resistance of HIV-1 among patients failing a non-nucleoside reverse transcriptase inhibitor-containing regimen</article-title><source>Journal of Medical Virology</source><volume>65</volume><fpage>445</fpage><lpage>448</lpage><pub-id pub-id-type="doi">10.1002/jmv.2055</pub-id><pub-id pub-id-type="pmid">11596076</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ekeberg</surname> <given-names>M</given-names></name><name><surname>Lövkvist</surname> <given-names>C</given-names></name><name><surname>Lan</surname> <given-names>Y</given-names></name><name><surname>Weigt</surname> <given-names>M</given-names></name><name><surname>Aurell</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Improved contact prediction in proteins: using pseudolikelihoods to infer potts models</article-title><source>Physical Review E</source><volume>87</volume><elocation-id>012707</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.87.012707</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferguson</surname> <given-names>AL</given-names></name><name><surname>Mann</surname> <given-names>JK</given-names></name><name><surname>Omarjee</surname> <given-names>S</given-names></name><name><surname>Ndung’u T</surname></name><name><surname>Walker BD</surname></name><name><surname>Chakraborty AK</surname></name></person-group><year iso-8601-date="2013">2013</year><article-title>Translating HIV sequences into quantitative fitness landscapes predicts viral vulnerabilities for rational immunogen design</article-title><source>Immunity</source><volume>38</volume><fpage>606</fpage><lpage>617</lpage><pub-id pub-id-type="doi">10.1016/j.immuni.2012.11.022</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Figliuzzi</surname> <given-names>M</given-names></name><name><surname>Jacquier</surname> <given-names>H</given-names></name><name><surname>Schug</surname> <given-names>A</given-names></name><name><surname>Tenaillon</surname> <given-names>O</given-names></name><name><surname>Weigt</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Coevolutionary landscape inference and the Context-Dependence of mutations in Beta-Lactamase TEM-1</article-title><source>Molecular Biology and Evolution</source><volume>33</volume><fpage>268</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1093/molbev/msv211</pub-id><pub-id pub-id-type="pmid">26446903</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flynn</surname> <given-names>WF</given-names></name><name><surname>Chang</surname> <given-names>MW</given-names></name><name><surname>Tan</surname> <given-names>Z</given-names></name><name><surname>Oliveira</surname> <given-names>G</given-names></name><name><surname>Yuan</surname> <given-names>J</given-names></name><name><surname>Okulicz</surname> <given-names>JF</given-names></name><name><surname>Torbett</surname> <given-names>BE</given-names></name><name><surname>Levy</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Deep sequencing of protease inhibitor resistant HIV patient isolates reveals patterns of correlated mutations in gag and protease</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004249</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004249</pub-id><pub-id pub-id-type="pmid">25894830</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flynn</surname> <given-names>WF</given-names></name><name><surname>Haldane</surname> <given-names>A</given-names></name><name><surname>Torbett</surname> <given-names>BE</given-names></name><name><surname>Levy</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Inference of epistatic effects leading to entrenchment and drug resistance in HIV-1 protease</article-title><source>Molecular Biology and Evolution</source><volume>34</volume><fpage>1291</fpage><lpage>1306</lpage><pub-id pub-id-type="doi">10.1093/molbev/msx095</pub-id><pub-id pub-id-type="pmid">28369521</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="report"><person-group person-group-type="author"><name><surname>Foley</surname> <given-names>B</given-names></name><name><surname>Leitner</surname> <given-names>T</given-names></name><name><surname>Apetrei</surname> <given-names>C</given-names></name><name><surname>Hahn</surname> <given-names>B</given-names></name><name><surname>Mizrachi</surname> <given-names>I</given-names></name><name><surname>Mullins</surname> <given-names>J</given-names></name><name><surname>Rambaut</surname> <given-names>A</given-names></name><name><surname>Wolinsky</surname> <given-names>S</given-names></name><name><surname>Korber</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2018">2018</year><source>Hiv Sequence Compendium 2018</source><publisher-name>US Department of Energy</publisher-name><pub-id pub-id-type="doi">10.2172/1458915</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fransen</surname> <given-names>S</given-names></name><name><surname>Gupta</surname> <given-names>S</given-names></name><name><surname>Danovich</surname> <given-names>R</given-names></name><name><surname>Hazuda</surname> <given-names>D</given-names></name><name><surname>Miller</surname> <given-names>M</given-names></name><name><surname>Witmer</surname> <given-names>M</given-names></name><name><surname>Petropoulos</surname> <given-names>CJ</given-names></name><name><surname>Huang</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Loss of raltegravir susceptibility by human immunodeficiency virus type 1 is conferred via multiple nonoverlapping genetic pathways</article-title><source>Journal of Virology</source><volume>83</volume><fpage>11440</fpage><lpage>11446</lpage><pub-id pub-id-type="doi">10.1128/JVI.01168-09</pub-id><pub-id pub-id-type="pmid">19759152</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gandhi</surname> <given-names>RT</given-names></name><name><surname>Wurcel</surname> <given-names>A</given-names></name><name><surname>Rosenberg</surname> <given-names>ES</given-names></name><name><surname>Johnston</surname> <given-names>MN</given-names></name><name><surname>Hellmann</surname> <given-names>N</given-names></name><name><surname>Bates</surname> <given-names>M</given-names></name><name><surname>Hirsch</surname> <given-names>MS</given-names></name><name><surname>Walker</surname> <given-names>BD</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Progressive reversion of human immunodeficiency virus type 1 resistance mutations in vivo after transmission of a multiply drug-resistant virus</article-title><source>Clinical Infectious Diseases</source><volume>37</volume><fpage>1693</fpage><lpage>1698</lpage><pub-id pub-id-type="doi">10.1086/379773</pub-id><pub-id pub-id-type="pmid">14689353</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Göbel</surname> <given-names>U</given-names></name><name><surname>Sander</surname> <given-names>C</given-names></name><name><surname>Schneider</surname> <given-names>R</given-names></name><name><surname>Valencia</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Correlated mutations and residue contacts in proteins</article-title><source>Proteins: Structure, Function, and Genetics</source><volume>18</volume><fpage>309</fpage><lpage>317</lpage><pub-id pub-id-type="doi">10.1002/prot.340180402</pub-id><pub-id pub-id-type="pmid">8208723</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goethals</surname> <given-names>O</given-names></name><name><surname>Clayton</surname> <given-names>R</given-names></name><name><surname>Van Ginderen</surname> <given-names>M</given-names></name><name><surname>Vereycken</surname> <given-names>I</given-names></name><name><surname>Wagemans</surname> <given-names>E</given-names></name><name><surname>Geluykens</surname> <given-names>P</given-names></name><name><surname>Dockx</surname> <given-names>K</given-names></name><name><surname>Strijbos</surname> <given-names>R</given-names></name><name><surname>Smits</surname> <given-names>V</given-names></name><name><surname>Vos</surname> <given-names>A</given-names></name><name><surname>Meersseman</surname> <given-names>G</given-names></name><name><surname>Jochmans</surname> <given-names>D</given-names></name><name><surname>Vermeire</surname> <given-names>K</given-names></name><name><surname>Schols</surname> <given-names>D</given-names></name><name><surname>Hallenberger</surname> <given-names>S</given-names></name><name><surname>Hertogs</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Resistance mutations in human immunodeficiency virus type 1 integrase selected with elvitegravir confer reduced susceptibility to a wide range of integrase inhibitors</article-title><source>Journal of Virology</source><volume>82</volume><fpage>10366</fpage><lpage>10374</lpage><pub-id pub-id-type="doi">10.1128/JVI.00470-08</pub-id><pub-id pub-id-type="pmid">18715920</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goethals</surname> <given-names>O</given-names></name><name><surname>Vos</surname> <given-names>A</given-names></name><name><surname>Van Ginderen</surname> <given-names>M</given-names></name><name><surname>Geluykens</surname> <given-names>P</given-names></name><name><surname>Smits</surname> <given-names>V</given-names></name><name><surname>Schols</surname> <given-names>D</given-names></name><name><surname>Hertogs</surname> <given-names>K</given-names></name><name><surname>Clayton</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Primary mutations selected in vitro with raltegravir confer large fold changes in susceptibility to first-generation integrase inhibitors, but minor fold changes to inhibitors with second-generation resistance profiles</article-title><source>Virology</source><volume>402</volume><fpage>338</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1016/j.virol.2010.03.034</pub-id><pub-id pub-id-type="pmid">20421122</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname> <given-names>R</given-names></name><name><surname>Hill</surname> <given-names>A</given-names></name><name><surname>Sawyer</surname> <given-names>AW</given-names></name><name><surname>Pillay</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Emergence of drug resistance in HIV type 1-infected patients after receipt of first-line highly active antiretroviral therapy: a systematic review of clinical trials</article-title><source>Clinical Infectious Diseases</source><volume>47</volume><fpage>712</fpage><lpage>722</lpage><pub-id pub-id-type="doi">10.1086/590943</pub-id><pub-id pub-id-type="pmid">18662137</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname> <given-names>A</given-names></name><name><surname>Adami</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Strong selection significantly increases epistatic interactions in the Long-Term evolution of a protein</article-title><source>PLOS Genetics</source><volume>12</volume><elocation-id>e1005960</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1005960</pub-id><pub-id pub-id-type="pmid">27028897</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haddox</surname> <given-names>HK</given-names></name><name><surname>Dingens</surname> <given-names>AS</given-names></name><name><surname>Hilton</surname> <given-names>SK</given-names></name><name><surname>Overbaugh</surname> <given-names>J</given-names></name><name><surname>Bloom</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Mapping mutational effects along the evolutionary landscape of HIV envelope</article-title><source>eLife</source><volume>7</volume><elocation-id>e34420</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.34420</pub-id><pub-id pub-id-type="pmid">29590010</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haldane</surname> <given-names>A</given-names></name><name><surname>Flynn</surname> <given-names>WF</given-names></name><name><surname>He</surname> <given-names>P</given-names></name><name><surname>Vijayan</surname> <given-names>RS</given-names></name><name><surname>Levy</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Structural propensities of kinase family proteins from a potts model of residue co-variation</article-title><source>Protein Science</source><volume>25</volume><fpage>1378</fpage><lpage>1384</lpage><pub-id pub-id-type="doi">10.1002/pro.2954</pub-id><pub-id pub-id-type="pmid">27241634</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haldane</surname> <given-names>A</given-names></name><name><surname>Flynn</surname> <given-names>WF</given-names></name><name><surname>He</surname> <given-names>P</given-names></name><name><surname>Levy</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Coevolutionary landscape of kinase family proteins: sequence probabilities and functional motifs</article-title><source>Biophysical Journal</source><volume>114</volume><fpage>21</fpage><lpage>31</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2017.10.028</pub-id><pub-id pub-id-type="pmid">29320688</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haldane</surname> <given-names>A</given-names></name><name><surname>Levy</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Influence of multiple-sequence-alignment depth on potts statistical models of protein covariation</article-title><source>Physical Review E</source><volume>99</volume><elocation-id>032405</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.99.032405</pub-id><pub-id pub-id-type="pmid">30999494</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haq</surname> <given-names>O</given-names></name><name><surname>Andrec</surname> <given-names>M</given-names></name><name><surname>Morozov</surname> <given-names>AV</given-names></name><name><surname>Levy</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Correlated electrostatic mutations provide a reservoir of stability in HIV protease</article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002675</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002675</pub-id><pub-id pub-id-type="pmid">22969420</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heeney</surname> <given-names>JL</given-names></name><name><surname>Dalgleish</surname> <given-names>AG</given-names></name><name><surname>Weiss</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Origins of HIV and the evolution of resistance to AIDS</article-title><source>Science</source><volume>313</volume><fpage>462</fpage><lpage>466</lpage><pub-id pub-id-type="doi">10.1126/science.1123016</pub-id><pub-id pub-id-type="pmid">16873637</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hertogs</surname> <given-names>K</given-names></name><name><surname>Bloor</surname> <given-names>S</given-names></name><name><surname>Kemp</surname> <given-names>SD</given-names></name><name><surname>Van den Eynde</surname> <given-names>C</given-names></name><name><surname>Alcorn</surname> <given-names>TM</given-names></name><name><surname>Pauwels</surname> <given-names>R</given-names></name><name><surname>Van Houtte</surname> <given-names>M</given-names></name><name><surname>Staszewski</surname> <given-names>S</given-names></name><name><surname>Miller</surname> <given-names>V</given-names></name><name><surname>Larder</surname> <given-names>BA</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Phenotypic and genotypic analysis of clinical HIV-1 isolates reveals extensive protease inhibitor cross-resistance: a survey of over 6000 samples</article-title><source>Aids</source><volume>14</volume><fpage>1203</fpage><lpage>1210</lpage><pub-id pub-id-type="doi">10.1097/00002030-200006160-00018</pub-id><pub-id pub-id-type="pmid">10894285</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hinkley</surname> <given-names>T</given-names></name><name><surname>Martins</surname> <given-names>J</given-names></name><name><surname>Chappey</surname> <given-names>C</given-names></name><name><surname>Haddad</surname> <given-names>M</given-names></name><name><surname>Stawiski</surname> <given-names>E</given-names></name><name><surname>Whitcomb</surname> <given-names>JM</given-names></name><name><surname>Petropoulos</surname> <given-names>CJ</given-names></name><name><surname>Bonhoeffer</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A systems analysis of mutational effects in HIV-1 protease and reverse transcriptase</article-title><source>Nature Genetics</source><volume>43</volume><fpage>487</fpage><lpage>489</lpage><pub-id pub-id-type="doi">10.1038/ng.795</pub-id><pub-id pub-id-type="pmid">21441930</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hopf</surname> <given-names>TA</given-names></name><name><surname>Ingraham</surname> <given-names>JB</given-names></name><name><surname>Poelwijk</surname> <given-names>FJ</given-names></name><name><surname>Schärfe</surname> <given-names>CP</given-names></name><name><surname>Springer</surname> <given-names>M</given-names></name><name><surname>Sander</surname> <given-names>C</given-names></name><name><surname>Marks</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Mutation effects predicted from sequence co-variation</article-title><source>Nature Biotechnology</source><volume>35</volume><fpage>128</fpage><lpage>135</lpage><pub-id pub-id-type="doi">10.1038/nbt.3769</pub-id><pub-id pub-id-type="pmid">28092658</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname> <given-names>Z</given-names></name><name><surname>Kuritzkes</surname> <given-names>DR</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Effect of raltegravir resistance mutations in HIV-1 integrase on viral fitness</article-title><source>JAIDS Journal of Acquired Immune Deficiency Syndromes</source><volume>55</volume><fpage>148</fpage><lpage>155</lpage><pub-id pub-id-type="doi">10.1097/QAI.0b013e3181e9a87a</pub-id><pub-id pub-id-type="pmid">20634701</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iyidogan</surname> <given-names>P</given-names></name><name><surname>Anderson</surname> <given-names>KS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Current perspectives on HIV-1 antiretroviral drug resistance</article-title><source>Viruses</source><volume>6</volume><fpage>4095</fpage><lpage>4139</lpage><pub-id pub-id-type="doi">10.3390/v6104095</pub-id><pub-id pub-id-type="pmid">25341668</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izopet</surname> <given-names>J</given-names></name><name><surname>Massip</surname> <given-names>P</given-names></name><name><surname>Souyris</surname> <given-names>C</given-names></name><name><surname>Sandres</surname> <given-names>K</given-names></name><name><surname>Puissant</surname> <given-names>B</given-names></name><name><surname>Obadia</surname> <given-names>M</given-names></name><name><surname>Pasquier</surname> <given-names>C</given-names></name><name><surname>Bonnet</surname> <given-names>E</given-names></name><name><surname>Marchou</surname> <given-names>B</given-names></name><name><surname>Puel</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Shift in HIV resistance genotype after treatment interruption and short-term antiviral effect following a new salvage regimen</article-title><source>Aids</source><volume>14</volume><fpage>2247</fpage><lpage>2255</lpage><pub-id pub-id-type="doi">10.1097/00002030-200010200-00005</pub-id><pub-id pub-id-type="pmid">11089612</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacquin</surname> <given-names>H</given-names></name><name><surname>Gilson</surname> <given-names>A</given-names></name><name><surname>Shakhnovich</surname> <given-names>E</given-names></name><name><surname>Cocco</surname> <given-names>S</given-names></name><name><surname>Monasson</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Benchmarking inverse statistical approaches for protein structure and design with exactly solvable models</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1004889</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004889</pub-id><pub-id pub-id-type="pmid">27177270</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>DT</given-names></name><name><surname>Buchan</surname> <given-names>DW</given-names></name><name><surname>Cozzetto</surname> <given-names>D</given-names></name><name><surname>Pontil</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>PSICOV: precise structural contact prediction using sparse inverse covariance estimation on large multiple sequence alignments</article-title><source>Bioinformatics</source><volume>28</volume><fpage>184</fpage><lpage>190</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr638</pub-id><pub-id pub-id-type="pmid">22101153</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keele</surname> <given-names>BF</given-names></name><name><surname>Giorgi</surname> <given-names>EE</given-names></name><name><surname>Salazar-Gonzalez</surname> <given-names>JF</given-names></name><name><surname>Decker</surname> <given-names>JM</given-names></name><name><surname>Pham</surname> <given-names>KT</given-names></name><name><surname>Salazar</surname> <given-names>MG</given-names></name><name><surname>Sun</surname> <given-names>C</given-names></name><name><surname>Grayson</surname> <given-names>T</given-names></name><name><surname>Wang</surname> <given-names>S</given-names></name><name><surname>Li</surname> <given-names>H</given-names></name><name><surname>Wei</surname> <given-names>X</given-names></name><name><surname>Jiang</surname> <given-names>C</given-names></name><name><surname>Kirchherr</surname> <given-names>JL</given-names></name><name><surname>Gao</surname> <given-names>F</given-names></name><name><surname>Anderson</surname> <given-names>JA</given-names></name><name><surname>Ping</surname> <given-names>LH</given-names></name><name><surname>Swanstrom</surname> <given-names>R</given-names></name><name><surname>Tomaras</surname> <given-names>GD</given-names></name><name><surname>Blattner</surname> <given-names>WA</given-names></name><name><surname>Goepfert</surname> <given-names>PA</given-names></name><name><surname>Kilby</surname> <given-names>JM</given-names></name><name><surname>Saag</surname> <given-names>MS</given-names></name><name><surname>Delwart</surname> <given-names>EL</given-names></name><name><surname>Busch</surname> <given-names>MP</given-names></name><name><surname>Cohen</surname> <given-names>MS</given-names></name><name><surname>Montefiori</surname> <given-names>DC</given-names></name><name><surname>Haynes</surname> <given-names>BF</given-names></name><name><surname>Gaschen</surname> <given-names>B</given-names></name><name><surname>Athreya</surname> <given-names>GS</given-names></name><name><surname>Lee</surname> <given-names>HY</given-names></name><name><surname>Wood</surname> <given-names>N</given-names></name><name><surname>Seoighe</surname> <given-names>C</given-names></name><name><surname>Perelson</surname> <given-names>AS</given-names></name><name><surname>Bhattacharya</surname> <given-names>T</given-names></name><name><surname>Korber</surname> <given-names>BT</given-names></name><name><surname>Hahn</surname> <given-names>BH</given-names></name><name><surname>Shaw</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Identification and characterization of transmitted and early founder virus envelopes in primary HIV-1 infection</article-title><source>PNAS</source><volume>105</volume><fpage>7552</fpage><lpage>7557</lpage><pub-id pub-id-type="doi">10.1073/pnas.0802203105</pub-id><pub-id pub-id-type="pmid">18490657</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname> <given-names>RM</given-names></name><name><surname>Haldane</surname> <given-names>A</given-names></name><name><surname>Flynn</surname> <given-names>WF</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Potts hamiltonian models of protein co-variation, free energy landscapes, and evolutionary fitness</article-title><source>Current Opinion in Structural Biology</source><volume>43</volume><fpage>55</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1016/j.sbi.2016.11.004</pub-id><pub-id pub-id-type="pmid">27870991</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>Y</given-names></name><name><surname>Holte</surname> <given-names>S</given-names></name><name><surname>Rao</surname> <given-names>U</given-names></name><name><surname>McClure</surname> <given-names>J</given-names></name><name><surname>Konopa</surname> <given-names>P</given-names></name><name><surname>Swain</surname> <given-names>JV</given-names></name><name><surname>Lanxon-Cookson</surname> <given-names>E</given-names></name><name><surname>Kim</surname> <given-names>M</given-names></name><name><surname>Chen</surname> <given-names>L</given-names></name><name><surname>Mullins</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A sensitive real-time PCR based assay to estimate the impact of amino acid substitutions on the competitive replication fitness of human immunodeficiency virus type 1 in cell culture</article-title><source>Journal of Virological Methods</source><volume>189</volume><fpage>157</fpage><lpage>166</lpage><pub-id pub-id-type="doi">10.1016/j.jviromet.2012.10.016</pub-id><pub-id pub-id-type="pmid">23201292</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lockless</surname> <given-names>SW</given-names></name><name><surname>Ranganathan</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Evolutionarily conserved pathways of energetic connectivity in protein families</article-title><source>Science</source><volume>286</volume><fpage>295</fpage><lpage>299</lpage><pub-id pub-id-type="doi">10.1126/science.286.5438.295</pub-id><pub-id pub-id-type="pmid">10514373</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louie</surname> <given-names>RHY</given-names></name><name><surname>Kaczorowski</surname> <given-names>KJ</given-names></name><name><surname>Barton</surname> <given-names>JP</given-names></name><name><surname>Chakraborty</surname> <given-names>AK</given-names></name><name><surname>McKay</surname> <given-names>MR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Fitness landscape of the human immunodeficiency virus envelope protein that is targeted by antibodies</article-title><source>PNAS</source><volume>115</volume><fpage>E564</fpage><lpage>E573</lpage><pub-id pub-id-type="doi">10.1073/pnas.1717765115</pub-id><pub-id pub-id-type="pmid">29311326</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mann</surname> <given-names>JK</given-names></name><name><surname>Barton</surname> <given-names>JP</given-names></name><name><surname>Ferguson</surname> <given-names>AL</given-names></name><name><surname>Omarjee</surname> <given-names>S</given-names></name><name><surname>Walker</surname> <given-names>BD</given-names></name><name><surname>Chakraborty</surname> <given-names>A</given-names></name><name><surname>Ndung'u</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The fitness landscape of HIV-1 gag: advanced modeling approaches and validation of model predictions by in vitro testing</article-title><source>PLOS Computational Biology</source><volume>10</volume><elocation-id>e1003776</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003776</pub-id><pub-id pub-id-type="pmid">25102049</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marks</surname> <given-names>DS</given-names></name><name><surname>Hopf</surname> <given-names>TA</given-names></name><name><surname>Sander</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Protein structure prediction from sequence variation</article-title><source>Nature Biotechnology</source><volume>30</volume><fpage>1072</fpage><lpage>1080</lpage><pub-id pub-id-type="doi">10.1038/nbt.2419</pub-id><pub-id pub-id-type="pmid">23138306</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martinez-Picado</surname> <given-names>J</given-names></name><name><surname>Sutton</surname> <given-names>L</given-names></name><name><surname>De Pasquale</surname> <given-names>MP</given-names></name><name><surname>Savara</surname> <given-names>AV</given-names></name><name><surname>D'Aquila</surname> <given-names>RT</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Human immunodeficiency virus type 1 cloning vectors for antiretroviral resistance testing</article-title><source>Journal of Clinical Microbiology</source><volume>37</volume><fpage>2943</fpage><lpage>2951</lpage><pub-id pub-id-type="pmid">10449480</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCandlish</surname> <given-names>DM</given-names></name><name><surname>Shah</surname> <given-names>P</given-names></name><name><surname>Plotkin</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Epistasis and the dynamics of reversion in molecular evolution</article-title><source>Genetics</source><volume>203</volume><fpage>1335</fpage><lpage>1351</lpage><pub-id pub-id-type="doi">10.1534/genetics.116.188961</pub-id><pub-id pub-id-type="pmid">27194749</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mézard</surname> <given-names>M</given-names></name><name><surname>Mora</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Constraint satisfaction problems and neural networks: a statistical physics perspective</article-title><source>Journal of Physiology-Paris</source><volume>103</volume><fpage>107</fpage><lpage>113</lpage><pub-id pub-id-type="doi">10.1016/j.jphysparis.2009.05.013</pub-id><pub-id pub-id-type="pmid">19616623</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mora</surname> <given-names>T</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Are biological systems poised at Criticality?</article-title><source>Journal of Statistical Physics</source><volume>144</volume><fpage>268</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1007/s10955-011-0229-4</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morcos</surname> <given-names>F</given-names></name><name><surname>Pagnani</surname> <given-names>A</given-names></name><name><surname>Lunt</surname> <given-names>B</given-names></name><name><surname>Bertolino</surname> <given-names>A</given-names></name><name><surname>Marks</surname> <given-names>DS</given-names></name><name><surname>Sander</surname> <given-names>C</given-names></name><name><surname>Zecchina</surname> <given-names>R</given-names></name><name><surname>Onuchic</surname> <given-names>JN</given-names></name><name><surname>Hwa</surname> <given-names>T</given-names></name><name><surname>Weigt</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title><source>PNAS</source><volume>108</volume><fpage>E1293</fpage><lpage>E1301</lpage><pub-id pub-id-type="doi">10.1073/pnas.1111471108</pub-id><pub-id pub-id-type="pmid">22106262</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perelson</surname> <given-names>AS</given-names></name><name><surname>Neumann</surname> <given-names>AU</given-names></name><name><surname>Markowitz</surname> <given-names>M</given-names></name><name><surname>Leonard</surname> <given-names>JM</given-names></name><name><surname>Ho</surname> <given-names>DD</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>HIV-1 dynamics in vivo: virion clearance rate, infected cell life-span, and viral generation time</article-title><source>Science</source><volume>271</volume><fpage>1582</fpage><lpage>1586</lpage><pub-id pub-id-type="doi">10.1126/science.271.5255.1582</pub-id><pub-id pub-id-type="pmid">8599114</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pollock</surname> <given-names>DD</given-names></name><name><surname>Thiltgen</surname> <given-names>G</given-names></name><name><surname>Goldstein</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Amino acid coevolution induces an evolutionary stokes shift</article-title><source>PNAS</source><volume>109</volume><fpage>E1352</fpage><lpage>E1359</lpage><pub-id pub-id-type="doi">10.1073/pnas.1120084109</pub-id><pub-id pub-id-type="pmid">22547823</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ragland</surname> <given-names>DA</given-names></name><name><surname>Whitfield</surname> <given-names>TW</given-names></name><name><surname>Lee</surname> <given-names>SK</given-names></name><name><surname>Swanstrom</surname> <given-names>R</given-names></name><name><surname>Zeldovich</surname> <given-names>KB</given-names></name><name><surname>Kurt-Yilmaz</surname> <given-names>N</given-names></name><name><surname>Schiffer</surname> <given-names>CA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Elucidating the interdependence of drug resistance from combinations of mutations</article-title><source>Journal of Chemical Theory and Computation</source><volume>13</volume><fpage>5671</fpage><lpage>5682</lpage><pub-id pub-id-type="doi">10.1021/acs.jctc.7b00601</pub-id><pub-id pub-id-type="pmid">28915040</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rhee</surname> <given-names>SY</given-names></name><name><surname>Gonzales</surname> <given-names>MJ</given-names></name><name><surname>Kantor</surname> <given-names>R</given-names></name><name><surname>Betts</surname> <given-names>BJ</given-names></name><name><surname>Ravela</surname> <given-names>J</given-names></name><name><surname>Shafer</surname> <given-names>RW</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Human immunodeficiency virus reverse transcriptase and protease sequence database</article-title><source>Nucleic Acids Research</source><volume>31</volume><fpage>298</fpage><lpage>303</lpage><pub-id pub-id-type="doi">10.1093/nar/gkg100</pub-id><pub-id pub-id-type="pmid">12520007</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richman</surname> <given-names>DD</given-names></name><name><surname>Little</surname> <given-names>SJ</given-names></name><name><surname>Smith</surname> <given-names>DM</given-names></name><name><surname>Wrin</surname> <given-names>T</given-names></name><name><surname>Petropoulos</surname> <given-names>C</given-names></name><name><surname>Wong</surname> <given-names>JK</given-names></name></person-group><year iso-8601-date="2004">2004a</year><article-title>Hiv evolution and escape</article-title><source>Transactions of the American Clinical and Climatological Association</source><volume>115</volume><elocation-id>289</elocation-id><pub-id pub-id-type="pmid">17060974</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richman</surname> <given-names>DD</given-names></name><name><surname>Morton</surname> <given-names>SC</given-names></name><name><surname>Wrin</surname> <given-names>T</given-names></name><name><surname>Hellmann</surname> <given-names>N</given-names></name><name><surname>Berry</surname> <given-names>S</given-names></name><name><surname>Shapiro</surname> <given-names>MF</given-names></name><name><surname>Bozzette</surname> <given-names>SA</given-names></name></person-group><year iso-8601-date="2004">2004b</year><article-title>The prevalence of antiretroviral drug resistance in the united states</article-title><source>Aids</source><volume>18</volume><fpage>1393</fpage><lpage>1401</lpage><pub-id pub-id-type="doi">10.1097/01.aids.0000131310.52526.c7</pub-id><pub-id pub-id-type="pmid">15199315</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sarafianos</surname> <given-names>SG</given-names></name><name><surname>Marchand</surname> <given-names>B</given-names></name><name><surname>Das</surname> <given-names>K</given-names></name><name><surname>Himmel</surname> <given-names>DM</given-names></name><name><surname>Parniak</surname> <given-names>MA</given-names></name><name><surname>Hughes</surname> <given-names>SH</given-names></name><name><surname>Arnold</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Structure and function of HIV-1 reverse transcriptase: molecular mechanisms of polymerization and inhibition</article-title><source>Journal of Molecular Biology</source><volume>385</volume><fpage>693</fpage><lpage>713</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2008.10.071</pub-id><pub-id pub-id-type="pmid">19022262</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shafer</surname> <given-names>RW</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Rationale and uses of a public HIV drug-resistance database</article-title><source>The Journal of Infectious Diseases</source><volume>194</volume><fpage>S51</fpage><lpage>S58</lpage><pub-id pub-id-type="doi">10.1086/505356</pub-id><pub-id pub-id-type="pmid">16921473</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shafer</surname> <given-names>RW</given-names></name><name><surname>Schapiro</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Hiv-1 drug resistance mutations: an updated framework for the second decade of haart</article-title><source>AIDS Reviews</source><volume>10</volume><elocation-id>67</elocation-id><pub-id pub-id-type="pmid">18615118</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shah</surname> <given-names>P</given-names></name><name><surname>McCandlish</surname> <given-names>DM</given-names></name><name><surname>Plotkin</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Contingency and entrenchment in protein evolution under purifying selection</article-title><source>PNAS</source><volume>112</volume><fpage>E3226</fpage><lpage>E3235</lpage><pub-id pub-id-type="doi">10.1073/pnas.1412933112</pub-id><pub-id pub-id-type="pmid">26056312</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shekhar</surname> <given-names>K</given-names></name><name><surname>Ruberman</surname> <given-names>CF</given-names></name><name><surname>Ferguson</surname> <given-names>AL</given-names></name><name><surname>Barton</surname> <given-names>JP</given-names></name><name><surname>Kardar</surname> <given-names>M</given-names></name><name><surname>Chakraborty</surname> <given-names>AK</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Spin models inferred from patient-derived viral sequence data faithfully describe HIV fitness landscapes</article-title><source>Physical Review E</source><volume>88</volume><elocation-id>062705</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.88.062705</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sjodt</surname> <given-names>M</given-names></name><name><surname>Brock</surname> <given-names>K</given-names></name><name><surname>Dobihal</surname> <given-names>G</given-names></name><name><surname>Rohs</surname> <given-names>PDA</given-names></name><name><surname>Green</surname> <given-names>AG</given-names></name><name><surname>Hopf</surname> <given-names>TA</given-names></name><name><surname>Meeske</surname> <given-names>AJ</given-names></name><name><surname>Srisuknimit</surname> <given-names>V</given-names></name><name><surname>Kahne</surname> <given-names>D</given-names></name><name><surname>Walker</surname> <given-names>S</given-names></name><name><surname>Marks</surname> <given-names>DS</given-names></name><name><surname>Bernhardt</surname> <given-names>TG</given-names></name><name><surname>Rudner</surname> <given-names>DZ</given-names></name><name><surname>Kruse</surname> <given-names>AC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Structure of the peptidoglycan polymerase RodA resolved by evolutionary coupling analysis</article-title><source>Nature</source><volume>556</volume><fpage>118</fpage><lpage>121</lpage><pub-id pub-id-type="doi">10.1038/nature25985</pub-id><pub-id pub-id-type="pmid">29590088</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sułkowska</surname> <given-names>JI</given-names></name><name><surname>Morcos</surname> <given-names>F</given-names></name><name><surname>Weigt</surname> <given-names>M</given-names></name><name><surname>Hwa</surname> <given-names>T</given-names></name><name><surname>Onuchic</surname> <given-names>JN</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Genomics-aided structure prediction</article-title><source>PNAS</source><volume>109</volume><fpage>10340</fpage><lpage>10345</lpage><pub-id pub-id-type="doi">10.1073/pnas.1207864109</pub-id><pub-id pub-id-type="pmid">22691493</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sutto</surname> <given-names>L</given-names></name><name><surname>Marsili</surname> <given-names>S</given-names></name><name><surname>Valencia</surname> <given-names>A</given-names></name><name><surname>Gervasio</surname> <given-names>FL</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>From residue coevolution to protein conformational ensembles and functional dynamics</article-title><source>PNAS</source><volume>112</volume><fpage>13567</fpage><lpage>13572</lpage><pub-id pub-id-type="doi">10.1073/pnas.1508584112</pub-id><pub-id pub-id-type="pmid">26487681</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tan</surname> <given-names>Z</given-names></name><name><surname>Xia</surname> <given-names>J</given-names></name><name><surname>Zhang</surname> <given-names>BW</given-names></name><name><surname>Levy</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Locally weighted histogram analysis and stochastic solution for large-scale multi-state free energy estimation</article-title><source>The Journal of Chemical Physics</source><volume>144</volume><elocation-id>034107</elocation-id><pub-id pub-id-type="doi">10.1063/1.4939768</pub-id><pub-id pub-id-type="pmid">26801020</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Theys</surname> <given-names>K</given-names></name><name><surname>Libin</surname> <given-names>P</given-names></name><name><surname>Pineda-Peña</surname> <given-names>AC</given-names></name><name><surname>Nowé</surname> <given-names>A</given-names></name><name><surname>Vandamme</surname> <given-names>AM</given-names></name><name><surname>Abecasis</surname> <given-names>AB</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The impact of HIV-1 within-host evolution on transmission dynamics</article-title><source>Current Opinion in Virology</source><volume>28</volume><fpage>92</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1016/j.coviro.2017.12.001</pub-id><pub-id pub-id-type="pmid">29275182</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Troyer</surname> <given-names>RM</given-names></name><name><surname>McNevin</surname> <given-names>J</given-names></name><name><surname>Liu</surname> <given-names>Y</given-names></name><name><surname>Zhang</surname> <given-names>SC</given-names></name><name><surname>Krizan</surname> <given-names>RW</given-names></name><name><surname>Abraha</surname> <given-names>A</given-names></name><name><surname>Tebit</surname> <given-names>DM</given-names></name><name><surname>Zhao</surname> <given-names>H</given-names></name><name><surname>Avila</surname> <given-names>S</given-names></name><name><surname>Lobritz</surname> <given-names>MA</given-names></name><name><surname>McElrath</surname> <given-names>MJ</given-names></name><name><surname>Le Gall</surname> <given-names>S</given-names></name><name><surname>Mullins</surname> <given-names>JI</given-names></name><name><surname>Arts</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Variable fitness impact of HIV-1 escape mutations to cytotoxic T lymphocyte (CTL) response</article-title><source>PLOS Pathogens</source><volume>5</volume><elocation-id>e1000365</elocation-id><pub-id pub-id-type="doi">10.1371/journal.ppat.1000365</pub-id><pub-id pub-id-type="pmid">19343217</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tubiana</surname> <given-names>J</given-names></name><name><surname>Cocco</surname> <given-names>S</given-names></name><name><surname>Monasson</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Learning protein constitutive motifs from sequence data</article-title><source>eLife</source><volume>8</volume><elocation-id>e39397</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.39397</pub-id><pub-id pub-id-type="pmid">30857591</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weigt</surname> <given-names>M</given-names></name><name><surname>White</surname> <given-names>RA</given-names></name><name><surname>Szurmant</surname> <given-names>H</given-names></name><name><surname>Hoch</surname> <given-names>JA</given-names></name><name><surname>Hwa</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Identification of direct residue contacts in protein-protein interaction by message passing</article-title><source>PNAS</source><volume>106</volume><fpage>67</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1073/pnas.0805923106</pub-id><pub-id pub-id-type="pmid">19116270</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wensing</surname> <given-names>AM</given-names></name><name><surname>Calvez</surname> <given-names>V</given-names></name><name><surname>Günthard</surname> <given-names>HF</given-names></name><name><surname>Johnson</surname> <given-names>VA</given-names></name><name><surname>Paredes</surname> <given-names>R</given-names></name><name><surname>Pillay</surname> <given-names>D</given-names></name><name><surname>Shafer</surname> <given-names>RW</given-names></name><name><surname>Richman</surname> <given-names>DD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>2017 update of the drug resistance mutations in hiv-1</article-title><source>Topics in Antiviral Medicine</source><volume>24</volume><fpage>132</fpage><lpage>133</lpage><pub-id pub-id-type="pmid">28208121</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname> <given-names>TD</given-names></name><name><surname>Schiffer</surname> <given-names>CA</given-names></name><name><surname>Gonzales</surname> <given-names>MJ</given-names></name><name><surname>Taylor</surname> <given-names>J</given-names></name><name><surname>Kantor</surname> <given-names>R</given-names></name><name><surname>Chou</surname> <given-names>S</given-names></name><name><surname>Israelski</surname> <given-names>D</given-names></name><name><surname>Zolopa</surname> <given-names>AR</given-names></name><name><surname>Fessel</surname> <given-names>WJ</given-names></name><name><surname>Shafer</surname> <given-names>RW</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Mutation patterns and structural correlates in human immunodeficiency virus type 1 protease following different protease inhibitor treatments</article-title><source>Journal of Virology</source><volume>77</volume><fpage>4836</fpage><lpage>4847</lpage><pub-id pub-id-type="doi">10.1128/jvi.77.8.4836-4847.2003</pub-id><pub-id pub-id-type="pmid">12663790</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>WL</given-names></name><name><surname>Kouyos</surname> <given-names>RD</given-names></name><name><surname>Böni</surname> <given-names>J</given-names></name><name><surname>Yerly</surname> <given-names>S</given-names></name><name><surname>Klimkait</surname> <given-names>T</given-names></name><name><surname>Aubert</surname> <given-names>V</given-names></name><name><surname>Scherrer</surname> <given-names>AU</given-names></name><name><surname>Shilaih</surname> <given-names>M</given-names></name><name><surname>Hinkley</surname> <given-names>T</given-names></name><name><surname>Petropoulos</surname> <given-names>C</given-names></name><name><surname>Bonhoeffer</surname> <given-names>S</given-names></name><name><surname>Günthard</surname> <given-names>HF</given-names></name><collab>Swiss HIV Cohort Study (SHCS)</collab></person-group><year iso-8601-date="2015">2015</year><article-title>Persistence of transmitted HIV-1 drug resistance mutations associated with fitness costs and viral genetic backgrounds</article-title><source>PLOS Pathogens</source><volume>11</volume><elocation-id>e1004722</elocation-id><pub-id pub-id-type="doi">10.1371/journal.ppat.1004722</pub-id><pub-id pub-id-type="pmid">25798934</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Yilmaz</surname> <given-names>NK</given-names></name><name><surname>Schiffer</surname> <given-names>CA</given-names></name></person-group><year iso-8601-date="2017">2017</year><chapter-title>Drug resistance to hiv-1 protease inhibitors: molecular mechanisms and substrate coevolution</chapter-title><source>Antimicrobial Drug Resistance</source><publisher-name>Springer</publisher-name><fpage>535</fpage><lpage>544</lpage><pub-id pub-id-type="doi">10.1007/978-3-319-46718-4_35</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.50524.019</object-id><fig id="app1fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.020</object-id><label>Appendix 1—figure 1.</label><caption><title>Sequence coverage for RT.</title><p>Figure shows the sequence coverage (# of sequences vs the # of residues) for RT drug-experienced (both NRTI and NNRTI) sequences derived from the Stanford HIVDB (22,444 isolates from 20422 patients). For RT, sequences with exposure to both NRTIs and NNRTIs were selected as an alternate search for RT sequences exposed to only NRTIs or NNRTIs would return a vastly smaller number of isolates (5398 and 80, respectively). Sequences with insertions (‘#‘) and deletions (‘ ~‘) are removed. MSA columns and rows with more than 1% gaps (‘.’) are removed. This resulted in a final MSA size of <italic>N</italic> = 19194 sequences from 17130 persons each with length <italic>L</italic> = 188 for RT. To retain enough sequence coverage in the MSA, we removed residues: residues 1–38, and residue 227 onwards for RT. For this reason, some interesting DRMs like F227I/L/V/C, L234I, P236L or N348I (NNRTI affected) for RT are not amenable for our analysis.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-50524-app1-fig1-v1.tif"/></fig><table-wrap id="app1table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.021</object-id><label>Appendix 1—table 1.</label><caption><title>Most entrenched (ME) and least entrenched (LE) or most disfavoring sequence pairs with the same Hamming distances (HD) for primary resistance mutations against the INSTIs</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top"/><th valign="top"/><th colspan="2" valign="top">E92Q</th><th colspan="2" valign="top">L74M</th><th colspan="2" valign="top">N155H</th><th colspan="2" valign="top">Q148H</th><th colspan="2" valign="top">G140S</th></tr><tr><th valign="top">Position</th><th valign="top">Consensus</th><th valign="top">ME</th><th valign="top">LE</th><th valign="top">ME</th><th valign="top">LE</th><th valign="top">ME</th><th valign="top">LE</th><th valign="top">ME</th><th valign="top">LE</th><th valign="top">ME</th><th valign="top">LE</th></tr></thead><tbody><tr><td valign="top">6</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">11</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">D</td><td valign="top">--</td><td valign="top">D</td></tr><tr><td valign="top">17</td><td valign="top">S</td><td valign="top">--</td><td valign="top">--</td><td valign="top">N</td><td valign="top">N</td><td valign="top">N</td><td valign="top">N</td><td valign="top">--</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">20</td><td valign="top">R</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">K</td><td valign="top">--</td></tr><tr><td valign="top">22</td><td valign="top">M</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">23</td><td valign="top">A</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">28</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">31</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td></tr><tr><td valign="top">32</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td></tr><tr><td valign="top">37</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td></tr><tr><td valign="top">39</td><td valign="top">S</td><td valign="top">C</td><td valign="top">C</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">45</td><td valign="top">L</td><td valign="top">Q</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">50</td><td valign="top">M</td><td valign="top">--</td><td valign="top">--</td><td valign="top">M</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">L</td><td valign="top">--</td></tr><tr><td valign="top">63</td><td valign="top">L</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">72</td><td valign="top">I</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">74</td><td valign="top">L</td><td valign="top"><bold>M</bold></td><td valign="top">--</td><td valign="top"><bold>M</bold></td><td valign="top"><bold>M</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">92</td><td valign="top">E</td><td valign="top"><bold>Q</bold></td><td valign="top"><bold>Q</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">97</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>A</bold></td><td valign="top"><bold>A</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">101</td><td valign="top">L</td><td valign="top">--</td><td valign="top">I</td><td valign="top">I</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">I</td><td valign="top">I</td></tr><tr><td valign="top">119</td><td valign="top">S</td><td valign="top">--</td><td valign="top">--</td><td valign="top">T</td><td valign="top">R</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">P</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">124</td><td valign="top">T</td><td valign="top">--</td><td valign="top">N</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">A</td><td valign="top">--</td><td valign="top">N</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">135</td><td valign="top">I</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">136</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">Q</td><td valign="top">--</td></tr><tr><td valign="top">138</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>D</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>K</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">140</td><td valign="top">G</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>--</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>S</bold></td><td valign="top"><bold>S</bold></td><td valign="top">--</td><td valign="top"><bold>S</bold></td><td valign="top"><bold>S</bold></td></tr><tr><td valign="top">143</td><td valign="top">Y</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>R</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">148</td><td valign="top">Q</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>H</bold></td><td valign="top"><bold>H</bold></td><td valign="top"><bold>H</bold></td><td valign="top"><bold>H</bold></td><td valign="top"><bold>R</bold></td></tr><tr><td valign="top">151</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>I</bold></td><td valign="top"><bold>I</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">154</td><td valign="top">M</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">155</td><td valign="top">N</td><td valign="top">--</td><td valign="top"><bold>H</bold></td><td valign="top">--</td><td valign="top"><bold>H</bold></td><td valign="top"><bold>H</bold></td><td valign="top"><bold>H</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">156</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">N</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">170</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">A</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">181</td><td valign="top">F</td><td valign="top">--</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">188</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">R</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">196</td><td valign="top">A</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">P</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">201</td><td valign="top">V</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">I</td><td valign="top">I</td><td valign="top">I</td><td valign="top">--</td><td valign="top">I</td></tr><tr><td valign="top">206</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">S</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">208</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">M</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">L</td><td valign="top">--</td></tr><tr><td valign="top">212</td><td valign="top">E</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">A</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">215</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">S</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">216</td><td valign="top">Q</td><td valign="top">N</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">220</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">230</td><td valign="top">S</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">G</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">232</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">N</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">E</td></tr><tr><td valign="top">234</td><td valign="top">L</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">256</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td><td valign="top">E</td><td valign="top">--</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">E</td><td valign="top">E</td></tr><tr><td valign="top">HD</td><td valign="top"/><td valign="top">8</td><td valign="top">8</td><td valign="top">12</td><td valign="top">12</td><td valign="top">9</td><td valign="top">9</td><td valign="top">10</td><td valign="top">10</td><td valign="top">9</td><td valign="top">9</td></tr></tbody></table><table-wrap-foot><fn><p>Residues same as consensus are shown as ‘--', mutations are shown as the one letter abbreviated alphabet encoding the mutant residue (in bold are primary drug-resistance mutations appearing at more than 1% frequency).</p></fn></table-wrap-foot></table-wrap><table-wrap id="app1table2" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.022</object-id><label>Appendix 1—table 2.</label><caption><title>Most entrenched (ME) and least entrenched (LE) or most disfavoring sequence pairs with the same Hamming distances (HD) for primary resistance mutations against NNRTIs</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top"/><th valign="top"/><th colspan="2" valign="top">P225H</th><th colspan="2" valign="top">Y188L</th><th colspan="2" valign="top">L100I</th><th colspan="2" valign="top">K103N/E</th><th colspan="2" valign="top">Y181C/G</th><th valign="top">■</th><th colspan="2" valign="top">E138K/R</th></tr><tr><th valign="top"/><th valign="top">Consensus</th><th valign="top">ME</th><th valign="top">LE</th><th valign="top">ME</th><th valign="top">LE</th><th valign="top">ME</th><th valign="top">LE</th><th valign="top">ME</th><th valign="top">LE</th><th valign="top">ME</th><th valign="top">LE</th><th valign="top"/><th valign="top">ME</th><th valign="top">LE</th></tr></thead><tbody><tr><td valign="top">39</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td><td valign="top">---</td><td valign="top">--</td><td valign="top">--</td><td valign="top">S</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">41</td><td valign="top">M</td><td valign="top">--</td><td valign="top">--</td><td valign="top">L</td><td valign="top">L</td><td valign="top">L</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">L</td></tr><tr><td valign="top">43</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">R</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">44</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">48</td><td valign="top">S</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">49</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">R</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">50</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">58</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td><td valign="top">N</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">60</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">62</td><td valign="top">A</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">65</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">R</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">67</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">G</td><td valign="top">N</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">68</td><td valign="top">S</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">G</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">G</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">69</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td><td valign="top">N</td><td valign="top">--</td><td valign="top">N</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">N</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">70</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">R</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">74</td><td valign="top">L</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">V</td><td valign="top">V</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">V</td></tr><tr><td valign="top">75</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">A</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">77</td><td valign="top">F</td><td valign="top">--</td><td valign="top">--</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">82</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">R</td><td valign="top">--</td></tr><tr><td valign="top">90</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>I</bold></td><td valign="top">--</td><td valign="top"><bold>I</bold></td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">98</td><td valign="top">A</td><td valign="top"><bold>S</bold></td><td valign="top"><bold>G</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>S</bold></td><td valign="top">--</td><td valign="top"><bold>S</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">100</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>I</bold></td><td valign="top"><bold>I</bold></td><td valign="top"><bold>I</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">101</td><td valign="top">K</td><td valign="top"><bold>Q</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>E</bold></td><td valign="top"><bold>E</bold></td><td valign="top">--</td><td valign="top"/><td valign="top"><bold>E</bold></td><td valign="top">--</td></tr><tr><td valign="top">103</td><td valign="top">K</td><td valign="top"><bold>N</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>N</bold></td><td valign="top"><bold>N</bold></td><td valign="top">--</td><td valign="top"><bold>N</bold></td><td valign="top"><bold>N</bold></td><td valign="top">--</td><td valign="top"><bold>N</bold></td><td valign="top"/><td valign="top"><bold>R</bold></td><td valign="top">--</td></tr><tr><td valign="top">104</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">N</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">106</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>I</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>A</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">108</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">116</td><td valign="top">F</td><td valign="top">--</td><td valign="top">--</td><td valign="top">W</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">118</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">122</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">E</td><td valign="top">E</td><td valign="top">--</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">E</td><td valign="top">E</td></tr><tr><td valign="top">123</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">126</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">R</td><td valign="top">--</td></tr><tr><td valign="top">135</td><td valign="top">I</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td><td valign="top">K</td><td valign="top">M</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">T</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">138</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>K</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top"><bold>K</bold></td><td valign="top"><bold>K</bold></td></tr><tr><td valign="top">139</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>--</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">E</td><td valign="top">--</td></tr><tr><td valign="top">142</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">Q</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top"/><td valign="top">T</td><td valign="top">--</td></tr><tr><td valign="top">151</td><td valign="top">Q</td><td valign="top">--</td><td valign="top">--</td><td valign="top">M</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">158</td><td valign="top">A</td><td valign="top">--</td><td valign="top">S</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">S</td></tr><tr><td valign="top">162</td><td valign="top">S</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">C</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">A</td></tr><tr><td valign="top">165</td><td valign="top">T</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">166</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">Q</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">169</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">A</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">172</td><td valign="top">R</td><td valign="top">--</td><td valign="top">--</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">173</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">N</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">176</td><td valign="top">P</td><td valign="top">Q</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">177</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">N</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">178</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">M</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">M</td><td valign="top">--</td></tr><tr><td valign="top">179</td><td valign="top">V</td><td valign="top">--</td><td valign="top"><bold>D</bold></td><td valign="top">--</td><td valign="top"><bold>I</bold></td><td valign="top">--</td><td valign="top"><bold>D</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">180</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">M</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">181</td><td valign="top">Y</td><td valign="top">--</td><td valign="top"><bold>C</bold></td><td valign="top">--</td><td valign="top"><bold>C</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>C</bold></td><td valign="top"><bold>C</bold></td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">184</td><td valign="top">M</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top">I</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">188</td><td valign="top">Y</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>L</bold></td><td valign="top"><bold>L</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>L</bold></td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">189</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">190</td><td valign="top">G</td><td valign="top">--</td><td valign="top"><bold>A</bold></td><td valign="top">--</td><td valign="top"><bold>S</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>A</bold></td><td valign="top"><bold>A</bold></td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">196</td><td valign="top">G</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">197</td><td valign="top">Q</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">200</td><td valign="top">T</td><td valign="top">A</td><td valign="top">V</td><td valign="top">A</td><td valign="top">--</td><td valign="top">A</td><td valign="top">A</td><td valign="top">A</td><td valign="top">A</td><td valign="top">--</td><td valign="top">A</td><td valign="top"/><td valign="top">--</td><td valign="top">A</td></tr><tr><td valign="top">202</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">203</td><td valign="top">E</td><td valign="top">---</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">207</td><td valign="top">Q</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">A</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">210</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">W</td><td valign="top">W</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">211</td><td valign="top">R</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">K</td><td valign="top">--</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">K</td><td valign="top">K</td><td valign="top"/><td valign="top">--</td><td valign="top">K</td></tr><tr><td valign="top">214</td><td valign="top">F</td><td valign="top">--</td><td valign="top">--</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">L</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">215</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td><td valign="top">Y</td><td valign="top">Y</td><td valign="top">Y</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">Y</td></tr><tr><td valign="top">219</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">Q</td><td valign="top">Q</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">221</td><td valign="top">H</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">Y</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">223</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">225</td><td valign="top">P</td><td valign="top"><bold>H</bold></td><td valign="top"><bold>H</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>H</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"/><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">HD</td><td valign="top"/><td valign="top">9</td><td valign="top">9</td><td valign="top">18</td><td valign="top">18</td><td valign="top">16</td><td valign="top">16</td><td valign="top">11</td><td valign="top">11</td><td valign="top">14</td><td valign="top">14</td><td valign="top"/><td valign="top">9</td><td valign="top">9</td></tr></tbody></table><table-wrap-foot><fn><p>Residues same as consensus are shown as ‘--', mutations are shown as the one letter abbreviated alphabet encoding the mutant residue (in bold are primary drug-resistance mutations appearing at more than 1% frequency).</p></fn></table-wrap-foot></table-wrap><table-wrap id="app1table3" position="float"><object-id pub-id-type="doi">10.7554/eLife.50524.023</object-id><label>Appendix 1—table 3.</label><caption><title>Most entrenched (ME) and least entrenched (LE) or most disfavoring sequence pairs with the same Hamming distances (HD) for primary resistance mutations against PIs</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top"/><th valign="top"/><th colspan="2" valign="top">I50V</th><th colspan="2" valign="top">I84V</th><th colspan="2" valign="top">L90M</th><th colspan="2" valign="top">V82A</th></tr><tr><th valign="top">Position</th><th valign="top">Consensus</th><th valign="top">ME</th><th valign="top">LE</th><th valign="top">ME</th><th valign="top">LE</th><th valign="top">ME</th><th valign="top">LE</th><th valign="top">ME</th><th valign="top">LE</th></tr></thead><tbody><tr><td valign="top">10</td><td valign="top">L</td><td valign="top">I</td><td valign="top">--</td><td valign="top">F</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">I</td><td valign="top">I</td></tr><tr><td valign="top">13</td><td valign="top">I</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td></tr><tr><td valign="top">15</td><td valign="top">I</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">18</td><td valign="top">Q</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">H</td><td valign="top">--</td><td valign="top">--</td><td valign="top">H</td></tr><tr><td valign="top">19</td><td valign="top">L</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">20</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">R</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">24</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td></tr><tr><td valign="top">30</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>N</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">32</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>I</bold></td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">33</td><td valign="top">L</td><td valign="top">--</td><td valign="top">F</td><td valign="top">--</td><td valign="top">F</td><td valign="top">--</td><td valign="top">--</td><td valign="top">F</td><td valign="top">--</td></tr><tr><td valign="top">34</td><td valign="top">E</td><td valign="top">Q</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">35</td><td valign="top">E</td><td valign="top">--</td><td valign="top">D</td><td valign="top">--</td><td valign="top">D</td><td valign="top">--</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">36</td><td valign="top">M</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">L</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">37</td><td valign="top">N</td><td valign="top">--</td><td valign="top">S</td><td valign="top">--</td><td valign="top">E</td><td valign="top">--</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">41</td><td valign="top">R</td><td valign="top">--</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">43</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">46</td><td valign="top">M</td><td valign="top"><bold>I</bold></td><td valign="top">--</td><td valign="top"><bold>I</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>L</bold></td><td valign="top"><bold>L</bold></td><td valign="top"><bold>I</bold></td></tr><tr><td valign="top">47</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">A</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">48</td><td valign="top">G</td><td valign="top"><bold>V</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">50</td><td valign="top">I</td><td valign="top"><bold>V</bold></td><td valign="top"><bold>V</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">53</td><td valign="top">F</td><td valign="top">Y</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">L</td><td valign="top">--</td></tr><tr><td valign="top">54</td><td valign="top">I</td><td valign="top"><bold>S</bold></td><td valign="top">--</td><td valign="top"><bold>V</bold></td><td valign="top">--</td><td valign="top"><bold>V</bold></td><td valign="top">--</td><td valign="top"><bold>V</bold></td><td valign="top">--</td></tr><tr><td valign="top">55</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">R</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">57</td><td valign="top">R</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">58</td><td valign="top">Q</td><td valign="top">--</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">60</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">E</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">61</td><td valign="top">Q</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">Y</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">62</td><td valign="top">I</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">63</td><td valign="top">L</td><td valign="top">Q</td><td valign="top">P</td><td valign="top">P</td><td valign="top">P</td><td valign="top">P</td><td valign="top">--</td><td valign="top">P</td><td valign="top">P</td></tr><tr><td valign="top">64</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">66</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">67</td><td valign="top">C</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">F</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">71</td><td valign="top">A</td><td valign="top">V</td><td valign="top">T</td><td valign="top">--</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td></tr><tr><td valign="top">72</td><td valign="top">I</td><td valign="top">V</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">K</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">73</td><td valign="top">G</td><td valign="top">--</td><td valign="top">--</td><td valign="top">T</td><td valign="top">--</td><td valign="top">S</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">74</td><td valign="top">T</td><td valign="top">S</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">76</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>V</bold></td></tr><tr><td valign="top">77</td><td valign="top">V</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">79</td><td valign="top">P</td><td valign="top">--</td><td valign="top">--</td><td valign="top">A</td><td valign="top">--</td><td valign="top">A</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">82</td><td valign="top">V</td><td valign="top"><bold>A</bold></td><td valign="top"><bold>I</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>I</bold></td><td valign="top"><bold>A</bold></td><td valign="top"><bold>A</bold></td></tr><tr><td valign="top">84</td><td valign="top">I</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>V</bold></td><td valign="top"><bold>V</bold></td><td valign="top"><bold>V</bold></td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>V</bold></td></tr><tr><td valign="top">88</td><td valign="top">N</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">D</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">89</td><td valign="top">L</td><td valign="top">--</td><td valign="top">V</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">I</td></tr><tr><td valign="top">90</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td><td valign="top"><bold>M</bold></td><td valign="top"><bold>M</bold></td><td valign="top"><bold>M</bold></td><td valign="top"><bold>M</bold></td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">93</td><td valign="top">I</td><td valign="top">L</td><td valign="top">L</td><td valign="top">L</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">95</td><td valign="top">C</td><td valign="top">--</td><td valign="top">--</td><td valign="top">F</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td><td valign="top">--</td></tr><tr><td valign="top">HD</td><td valign="top"/><td valign="top">15</td><td valign="top">15</td><td valign="top">13</td><td valign="top">13</td><td valign="top">14</td><td valign="top">14</td><td valign="top">9</td><td valign="top">9</td></tr></tbody></table><table-wrap-foot><fn><p>Residues same as consensus are shown as ‘--', mutations are shown as the one letter abbreviated alphabet encoding the mutant residue (in bold are primary drug-resistance mutations appearing at more than 1% frequency).</p></fn></table-wrap-foot></table-wrap></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.50524.029</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Wittkopp</surname><given-names>Patricia J</given-names></name><role>Reviewing Editor</role><aff><institution>University of Michigan</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>[Editors’ note: a previous version of this study was rejected after peer review, but the authors submitted for reconsideration. The first decision letter after peer review is shown below.]</p><p>Thank you for submitting your work entitled &quot;Epistasis and entrenchment of drug resistance in HIV-1 subtype B&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by a Senior Editor, a Reviewing Editor, and two reviewers. The reviewers have opted to remain anonymous.</p><p>Our decision has been reached after consultation between the reviewers. Based on these discussions and the individual reviews below, we regret to inform you that your work will not be considered further for publication in <italic>eLife</italic>.</p><p>The topic of your paper is very important, and indeed epistasis and the effects of coupled mutations in HIV proteins on the fitness of HIV is documented. However, as the reviews below note, because your study is based on individuals undergoing treatment, it is impossible to separate correlated selection pressures from epistatic effects.</p><p><italic>Reviewer #1:</italic></p><p>Here Biswas and collaborators apply coevolutionary analysis methods to study the entrenchment of HIV drug resistance mutations in the protease, integrase, and reverse transcriptase proteins. Entrenchment refers to an increasing preference for the mutant (i.e., resistant) residue as epistatic accessory mutations are accumulated. The authors demonstrate an impressive ability to predict the frequency of resistance mutations in different genetic backgrounds. They then characterize how entrenchment depends on the number of accumulated resistance-associated mutations, and which specific mutations are most strongly associated with entrenchment.</p><p>Specific comments:</p><p>1) One might reasonably hypothesize that the reason that drug resistance mutations are more likely to appear together in the Potts model is because the model is capturing correlated selection pressures rather than true epistasis. In other words, in patients who are treated by one drug, there is selection for the accumulation of resistance mutations for that drug. No such selection is present in patients not treated by that drug. Thus, whether the resistance/accessory mutations are truly epistatic or not, they will tend to appear either clustered together in sequences or not at all. This could then be reflected as a network of positive epistatic couplings in the Potts model. Butler et al., cited by the authors, used sequence data obtained before the widespread use of protease inhibitors to infer an Ising model that contained positive epistatic couplings between resistance sites. In principle, this approach should limit the effect of correlated selection pressures due to differences in drug treatment among different individuals. Butler and collaborators further found some external evidence for true epistasis between a resistance mutation at site 84 in protease and other accessory mutations. In the present work, given that the MSA contains sequences from individuals who are drug-experienced, are there independent lines of evidence that support the hypothesis of true epistatic interactions between associated resistance mutations? And more broadly, how would one deal with the confounding influence of correlated selection pressures?</p><p>2) As a possible suggestion, one might expect that inferring Potts parameters using the pseudolikelihood method would provide an even better fit of the probability of different mutations at a given site as a function of the sequence background, since this is precisely what the pseudolikelihood algorithm is optimizing. In contrast, the canonical maximum entropy approach must simultaneously fit all low-order correlations.</p><p>3) Some of the figures and tables are challenging to interpret. For example, in Supplementary file 1 both the most (ME) and least (LE) residues at position 17 for the L74M mutation are N. This result also appears for other mutations and positions in other tables. This needs further explanation. The plot in the inset of Figure 1B is also a bit challenging to interpret at first, and the small size of the numbers/labels in the inset plot makes it difficult to read at standard resolution. The ordering of resistance mutations in Figure 1D is confusing. The linear order would suggest order along the sequence, but mutations within each sequence are presented in reverse order along the protein sequence. Integrase is also placed before reverse transcriptase. This figure would likely be more clear if the same color scheme was maintained, but the mutations were reordered according to their positions in Pol.</p><p><italic>Reviewer #2:</italic></p><p>The study analyzes molecular co-evolution in sequences of HIV from drug-exposed patients, applying a Potts model to infer fitness effects of mutations and their dependence on the genetic background. The authors use the inferred model to analyze the notion of entrenchment - that a mutation tends to become more difficult to revert, over time, due the epistatic interactions with subsequent substitutions in the genetic background on which it first arose. The authors report this trend in three different HIV proteins that are targets of various drug treatments.</p><p>The intellectual basis of this study is sound and interesting - that epistasis can shape and channel molecular evolution - and it builds on a broader theoretical literature that has demonstrated such phenomenon for protein evolution in general (e.g. Pollack et al., 2012; Shah et al., 2015). Demonstrating this effect for real-world sampled protein sequences, in the setting of HIV protein evolution in response to drugs, is an especially nice project - as it would provide real-world relevance, in a clinical setting, for a broad body of theoretical work.</p><p>Despite the enthusiasm for the topics, I am disappointed by a large number of inconsistencies in the reported results - which do not, in the end, seem to demonstrate the type of entrenchment the authors start out to explore. And I'm also disappointed by the presentation of the model and analysis, which is ambiguous or unclear in both main text and Materials and methods section. I am left without a clear understanding of what the authors claim to have demonstrated, or what specific model inferences they are reporting in most of their figures.</p><p>These two problems - whether their analysis actually addresses the established concept of entrenchment, and whether the writing/notation is clear enough to explain what analyses they actually performed – occur throughout the manuscript, and so I will address instances of these two problems in a linear fashion throughout the work:</p><p>1) The Potts model appears to be massively overfit. Even after artificially reducing the alphabet size from 20 acids to 4, the authors seem to be fitting roughly 380,000 parameters to account for all pairwise interactions between sites. And yet, as far as a I can tell, the authors have only ~20,000 sequences. So, they are fitting an order of magnitude more parameters than they have data. Even so, they make a big deal of the fact the model makes good &quot;predictions&quot; for the frequency of sequences observed (Figure 1B)- but it is not clear if these prediction were made with cross-validation (e.g. fitting on one part of the data, and prediction for another part), and little discussion of overfitting is provided, if any. In any case, the notion that pairwise maxent Potts-like models can do a decent job of explaining sequence variability is not a new result and has been shown in dozens of papers.</p><p>1b) The authors discuss their Potts model as providing a general probability for the observing a mutation alpha at site i in a genetic background of sequence S. But, in fact, the model depends only on pairwise interactions, the full sequence S. The authors should clarify this in the main text.</p><p>1c) It is not clear what reference sequence is used as the &quot;wildtype&quot; S throughout the analysis. Is this a consensus sequence from the database? This should be explained in the main text.</p><p>2) The main results on entrenchment (Figure 2) are not described precisely and seem to contradict the notion of entrenchment to which the authors refer in their introduction. Entrenchment according to Pollack et al., occurs when a substitution is initially neutral or slightly beneficial (so that its reversion is neutral or only slightly deleterious), but when subsequent substitutions in the protein render the focal mutation highly deleterious to revert. And yet the mutations discussed here are drug resistance mutations arising in the presence of drugs - and so the primary mutation must be net highly beneficial, even if it partly disrupts HIV protein function. (Indeed Figure 4 shows that the primary DRMS are favored.) And so, prima facie, this situation is quite different to Pollack at all - because the reversion is immediately disfavored, even without changes to the genetic background. Presumably the authors intend to show that the DRMs become *even more deleterious* to revert as subsequent substitutions accrue, although they do not say this in the main text and repeatedly refer to the DRMs as carrying fitness costs as the time of their emergence.</p><p>2b) Figure 2A, showing the main entrenchment results according to the Potts model, seems to contradict the notion the primary mutation is a resistance site that is beneficial at the time of its substitution (as in Figure 4). The figure reports a nearly 100-fold preference to revert the primary DRM L90M substitution in the background in which it arose - i.e. the mutation is inferred to carry a huge fitness cost (and its reversion a benefit) at the time of its origin. This does not make sense to me, as a reader, as the DRM (even if it contains some costs for protein function) must be net adaptive at the time of its substitution in a patient. Why does Figure 2A show that the drug resistance site is strongly disfavored in the genetic background in which it initially arose?</p><p>2c) The authors should define in terms of the ΔE notation when, precisely, is being plotted on the y-axis of Figure 4A.</p><p>2d) The authors state &quot;entrenchment of key resistance mutations is likely to play an important role in emergence of drug-resistance viral strains&quot;. I cannot understand what the authors mean by this. Certainly, the initial *emergence* of a drug resistance strain depends on the adaptive benefit of DRM on the background in which it arises - and has nothing to do with future changes to the genetic background. Perhaps the authors mean that the &quot;persistence&quot; of the DRM over subsequent evolution depends on entrenchment?</p><p>3) [Presentation issue] The authors discuss the stabilization or destabilization of mutations in their Introduction and throughout (Table 1). I believe by &quot;stabilization&quot; they mean epistasis with subsequent substitutions that render the primary mutation costly to revert. But this is a terrible choice of words, because the large literature on entrenchment (Pollack, Shah etc.) has been developed for models of thermostability - and, indeed, entrenchment has been observed to arise from interactions between sites for protein stability. The authors do not seem to be using the word &quot;stability&quot; here to mean thermostability, which is tremendously confusing when referring to a literature that is all about the effects of mutations, and their interactions, on thermostability.</p><p>4) The authors make a big deal of their analysis of &quot;entrenchment of DRMs&quot; in the population - meaning that drug resistance mutations are beneficial in over 50% of the sequences sampled/fit. I do not find this surprising or even attributable to entrenchment at all - because, after all, the sequences being used to fit the model are sequences from drug-experienced HIV populations, where the drug resistance mutation will be net beneficial *at the time of its original occurrence* and even without any further substitutions. This is shown directly in Figure 4, for example.</p><p>5) When the authors report that they have &quot;verification&quot; of entrenchment I assumed they meant they had direct data on fitness measurements for a mutation in one genetic background, and in a subsequent background. But in fact, the &quot;verification&quot; is simply relative to the fitted Potts model. By contrast, when the authors do compare the model to actual measurements of fitness effects (subsection “Molecular clones and the effects of specific backgrounds”), the authors seem to be saying that the predictions of the Potts model do not match the empirical measurements, and they attribute this to limitation of the mutagenesis experiments, as opposed to a deficiency of the Potts model. Comparison to data would have been the only thing that really convinces me that any statistical effects of their model are &quot;verified&quot;.</p><p>5b) Also, I had a hard time understanding what conclusions the authors draw from Figure 5, or even what the axes really denote in Figure 5. The notation Δ E_patient does not seem to be defined in the main text. The authors seem to be showing effects of mutations predicted by the Potts model fitted to patient data versus their predicted effects in the specific genetic backgrounds used for mutagenesis experiments - but it's not clear if that's what they're plotting, in fact, or what we are supposed to conclude from Figure 5.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.50524.030</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors' note: the author responses to the re-review follow.]</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>Here Biswas and collaborators apply coevolutionary analysis methods to study the entrenchment of HIV drug resistance mutations in the protease, integrase, and reverse transcriptase proteins. Entrenchment refers to an increasing preference for the mutant (i.e., resistant) residue as epistatic accessory mutations are accumulated. The authors demonstrate an impressive ability to predict the frequency of resistance mutations in different genetic backgrounds. They then characterize how entrenchment depends on the number of accumulated resistance-associated mutations, and which specific mutations are most strongly associated with entrenchment.</p><p>Specific comments:</p><p>1) One might reasonably hypothesize that the reason that drug resistance mutations are more likely to appear together in the Potts model is because the model is capturing correlated selection pressures rather than true epistasis. In other words, in patients who are treated by one drug, there is selection for the accumulation of resistance mutations for that drug. No such selection is present in patients not treated by that drug. Thus, whether the resistance/accessory mutations are truly epistatic or not, they will tend to appear either clustered together in sequences or not at all. This could then be reflected as a network of positive epistatic couplings in the Potts model. Butler et al., cited by the authors, used sequence data obtained before the widespread use of protease inhibitors to infer an Ising model that contained positive epistatic couplings between resistance sites. In principle, this approach should limit the effect of correlated selection pressures due to differences in drug treatment among different individuals. Butler and collaborators further found some external evidence for true epistasis between a resistance mutation at site 84 in protease and other accessory mutations. In the present work, given that the MSA contains sequences from individuals who are drug-experienced, are there independent lines of evidence that support the hypothesis of true epistatic interactions between associated resistance mutations? And more broadly, how would one deal with the confounding influence of correlated selection pressures?</p></disp-quote><p>The reviewer’s comments suggest that we need to address three important questions: (1) Can we distinguish between correlations induced by “true epistastic interactions” and those due to correlated selection pressure induced by drugs; (2) Do our conclusions about the entrenchment of drug resistance mutations depend on whether the origins of the mutational correlation patterns can be separated into “intrinsic epistasis” and effects due to correlated selection pressure induced by drugs; (3) Is the Potts model we build from the drug experienced dataset contaminated by artifacts associated with different patients being given different drug regimens.</p><p>1) Can we distinguish between correlations induced by “true” or “intrinsic” epistasis and those induced by correlated selection pressure induced by drugs?</p><p>To begin with, we note that while reviewer #1 refers to epistatic effects which are independent of drug selection pressure as “true epistasis”, we prefer to describe them as “intrinsic epistasis”, since correlated mutations induced by drug selection pressure may also be considered to be a form of epistasis. We use the term “effective epistasis” to refer to mutational correlations induced by the combined effects of “intrinsic epistasis” and correlated selection pressure due to drugs. We have added a new subsection “Effective epistasis in the presence of drug selection pressure” where we discuss the distinction between “intrinsic epistasis” and correlated selection pressure.</p><p>In the case of immune response selection pressure Shekhar et al., 2013 suggest that due to the diversity of host immune responses among the HIV population, a Potts model fit to sequences from many different hosts can effectively capture the “intrinsic” fitness landscape of the virus because the selective effects of immune pressure are averaged in a way that can be modeled by adjusting the fields of the Potts model, leaving the couplings unchanged.</p><p>We have available to us from the Stanford HIV database, a drug experienced sequence data set and a drug naïve dataset. We have fit a Potts model for HIV-1 Subtype B Protease to each dataset individually. Comparisons of the Potts statistical energy values ΔE predicted by the drug naïve and drug experienced models for mutating from the wild type to the drug resistance mutations for four HIV PR DRMS as a function of the background sequence are presented in subsection “Effective epistasis in the presence of drug selection pressure” of the revised manuscript. There is a high correlation (r &gt; 0.8) between the probabilities of observing the drug resistance mutation relative to the wild type in a given background, when the Potts model is parameterized on the drug naïve dataset as compared with the drug experienced dataset. This means that “intrinsic” epistatic effects have a large influence on the virus evolving under drug selection pressure.</p><p>It is possible to carry out a more quantitative analysis of how the application of drug selection pressure changes the intrinsic mutational correlation patterns and probabilities of observing DRMs in specific sequence backgrounds using multi-canonical reweighting techniques familiar to researchers who work with Ising or Potts models. While such an analysis is beyond the scope of the present work, in a future communication we will provide a detailed comparison of the drug naïve and drug experienced Potts models and the relationship between them, as such an analysis can provide insights into sequence patterns which are most strongly associated with the transmission of drug resistance.</p><p>2) Do our conclusions about the entrenchment of drug resistance mutations depend on whether the origins of the mutational correlation patterns can be separated into “intrinsic epistasis” and effects due to correlated selection pressure induced by drugs?</p><p>As far as the goal of the current work is concerned, to demonstrate that the Potts model can accurately predict the effect of the sequence background on the probability of observing a resistance mutation in the drug experienced population, and therefore identify those sequences which are highly favoring (entrenching) or highly disfavoring the mutation, it is not necessary to separate the effects of intrinsic epistasis from those due to correlated selection pressure induced by drugs. The data we are comparing the predictions of our Potts models to are the observed frequencies (prevalences) in the Stanford HIV drug experienced sequence database of drug resistance mutations, in sets of sequence backgrounds classified by our model as either favoring or disfavoring the DRM. These are non-trivial predictions; the observations confirm the predictions. Put another way, the Potts model parameterized on the drug experienced dataset is a powerful classifier that can identify complex sequence patterns that highly favor (entrench) or disfavor each drug resistant mutant. It should be noted that the frequency of any individual drug resistance mutation (DRM) appearing in the drug experienced Stanford HIV database is typically small. See our response to reviewer #2 comment 4) for additional discussion of the distinction between the frequency of a DRM appearing in the drug experienced population and the “entrenchment” of that DRM.</p><p>3) Is the Potts model we build from the drug experienced dataset contaminated by an artifact associated with different patients being given different drug regimens? This could result in spurious apparent correlations predicted by the Potts model.</p><p>Reviewer #1 also expresses a concern that if the selection pressures induced by different drugs are significantly different, then this could lead to artifacts when parameterizing a Potts model on a drug experienced dataset, as the model would potentially be sensitive to the details of how many patients in the dataset are exposed to each drug. While we cannot definitively rule out such an artifact, two lines of evidence suggest that if such effects are present, they are small.</p><p>First, we note that HIV drugs are frequently given in combination, and that many of the drugs have similar resistance patterns. We include a comparison of these patterns for different Protease inhibitors in Figure 8 of the revised manuscript. Secondly, as noted above there is a strong correlation between the ΔE values predicted using the Potts model parameterized on the drug naïve dataset and the one parameterized on the drug experienced set. If the details concerning the number of individuals which were given specific drugs and combination therapies strongly influenced the Potts model parameterized on the drug experienced dataset, we would not expect the “effective epistatic” effects on ΔE inferred by the drug experienced model to be highly correlated with the “intrinsic epistatic” effects of the drug naïve model. These observations mitigate possible artifacts associated with the fact that individual HIV patients represented in the drug experienced dataset may be undergoing different drug therapies. We added a statement about in subsection “Effective epistasis in the presence of drug selection pressure” of the revised manuscript.</p><disp-quote content-type="editor-comment"><p>2) As a possible suggestion, one might expect that inferring Potts parameters using the pseudolikelihood method would provide an even better fit of the probability of different mutations at a given site as a function of the sequence background, since this is precisely what the pseudolikelihood algorithm is optimizing. In contrast, the canonical maximum entropy approach must simultaneously fit all low-order correlations.</p></disp-quote><p>We are using an approach which optimizes the maximum entropy Boltzmann likelihood function by fitting the bivariate marginals of the Potts model to the observed bivariate marginals using MCMC sampling. This is a more compute intensive approach to inferring the parameters of the Potts Hamiltonian, but it is also more accurate as the errors in the bivariate and univariate marginals are much smaller than those obtained by the pseudolikelihood method. This has been demonstrated in the literature; for instance, the supplementary information in Barton et al., 2016 shows large relative errors in the generated univariate marginals and the pairwise correlations using the pseudolikelihood method, and in Jacquin et al., 2016, Barton et al., 2016, it is shown that the pseudolikelihood method is not &quot;generative&quot;, meaning sequences generated using it have modified bivariate marginals. The agreement we obtain using our MCMC GPU implementation of inverse inference, between predicted and observed frequencies of drug resistance mutations in different sets of backgrounds is excellent, and probably cannot be matched using more approximate inverse inference methods like the pseudo-likelihood.</p><disp-quote content-type="editor-comment"><p>3) Some of the figures and tables are challenging to interpret. For example, in Supplementary file 1 both the most (ME) and least (LE) residues at position 17 for the L74M mutation are N. This result also appears for other mutations and positions in other tables. This needs further explanation. The plot in the inset of Figure 1B is also a bit challenging to interpret at first, and the small size of the numbers/labels in the inset plot makes it difficult to read at standard resolution. The ordering of resistance mutations in Figure 1D is confusing. The linear order would suggest order along the sequence, but mutations within each sequence are presented in reverse order along the protein sequence. Integrase is also placed before reverse transcriptase. This figure would likely be more clear if the same color scheme was maintained, but the mutations were reordered according to their positions in Pol.</p></disp-quote><p>Supplementary file 1 in the updated supplement presents a pair of sequences for each mutation; one being the most entrenching for that mutation and the other the least entrenching (the probability of observing the mutation relative to the wildtype at this position is the smallest in the least entrenching background). There will be positions at which the same accessory mutation appears in both the most and least entrenching backgrounds; for example, the mutation 17N, which is accessory to L74M. The background sequences which are the most and least entrenching for any resistance mutation is a collective property of the set of all mutations in the corresponding background; any particular accessory mutation may appear in both backgrounds.</p><p>As per the reviewer’s suggestion, we have changed the ordering of mutations in Figure 1D according to their positions in <italic>Pol</italic> and resized Figure 1 for clarity.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>The study analyzes molecular co-evolution in sequences of HIV from drug-exposed patients, applying a Potts model to infer fitness effects of mutations and their dependence on the genetic background. The authors use the inferred model to analyze the notion of entrenchment – that a mutation tends to become more difficult to revert, over time, due the epistatic interactions with subsequent substitutions in the genetic background on which it first arose. The authors report this trend in three different HIV proteins that are targets of various drug treatments.</p><p>The intellectual basis of this study is sound and interesting – that epistasis can shape and channel molecular evolution – and it builds on a broader theoretical literature that has demonstrated such phenomenon for protein evolution in general (e.g. Pollack et al., 2012; Shah et al., 2015). Demonstrating this effect for real-world sampled protein sequences, in the setting of HIV protein evolution in response to drugs, is an especially nice project – as it would provide real-world relevance, in a clinical setting, for a broad body of theoretical work.</p></disp-quote><p>We appreciate the reviewer’s enthusiasm for the topic of the paper.</p><disp-quote content-type="editor-comment"><p>Despite the enthusiasm for the topics, I am disappointed by a large number of inconsistencies in the reported results – which do not, in the end, seem to demonstrate the type of entrenchment the authors start out to explore. And I'm also disappointed by the presentation of the model and analysis, which is ambiguous or unclear in both main text and Materials and methods section. I am left without a clear understanding of what the authors claim to have demonstrated, or what specific model inferences they are reporting in most of their figures.</p><p>These two problems – whether their analysis actually addresses the established concept of entrenchment, and whether the writing/notation is clear enough to explain what analyses they actually performed – occur throughout the manuscript, and so I will address instances of these two problems in a linear fashion throughout the work:</p></disp-quote><p>We have made revisions to the manuscript to make it clearer following the suggestions of the reviewers, and in light of what appears to be a serious misunderstanding of our work at several places by reviewer #2. We do not believe that there are inconsistencies in the reported results; it is apparent from the reviewer’s comments that we have done an inadequate job of describing our work. Several statements made by referee #2 are incorrect. We have revised the manuscript to address the issues and concerns raised by referee #2 as described below.</p><disp-quote content-type="editor-comment"><p>1) The Potts model appears to be massively overfit. Even after artificially reducing the alphabet size from 20 acids to 4, the authors seem to be fitting roughly 380,000 parameters to account for all pairwise interactions between sites. And yet, as far as a I can tell, the authors have only ~20,000 sequences. So, they are fitting an order of magnitude more parameters than they have data. Even so, they make a big deal of the fact the model makes good &quot;predictions&quot; for the frequency of sequences observed (Figure 1B) - but it is not clear if these prediction were made with cross-validation (e.g. fitting on one part of the data, and prediction for another part), and little discussion of overfitting is provided, if any. In any case, the notion that pairwise maxent Potts-like models can do a decent job of explaining sequence variability is not a new result and has been shown in dozens of papers.</p></disp-quote><p>Overfitting is an important issue and we appreciate the suggestion that we should discuss it more thoroughly. We have recently published a detailed analysis of overfitting effects in the context of inverse inference of Potts model parameters from protein multiple-sequence alignments (Haldane and Levy, 2019). We have added a discussion of overfitting effects to the main text in subsection “Statistical Robustness of HIV Potts models” which we summarize here.</p><p>The reviewer suggests that we are overfitting our model because the number of model parameters (θ) is much larger than the number of sequences in our dataset (N). However, we explain in Haldane and Levy, 2019 why this is not the correct comparison to make. First, our model is not fit directly to the sequences but rather to the bivariate marginals of the MSA, and there are an equal number of model parameters θ as there are bivariate marginals. The inference problem is therefore neither overconstrained nor underconstrained. In addition, while for (linear) regression overfitting occurs when the number of datapoints is less than the number of model parameters, this is not the case for inference methods in general.</p><p>In Haldane and Levy, 2019 we explain how overfitting ultimately arises due to finite-sampling error in the bivariate marginal frequencies used as input to the inference procedure, which are computed from the MSA of N sequences. Each bivariate marginal f is estimated from a sample of size N, and its statistical error is the multinomial mean-square error f(1-f)/N. This statistical error in the bivariate marginals leads to error in the inferred model parameters.</p><p>Based on this fact, in Haldane and Levy, 2019 we go on to derive the dependence of model quality on the number of parameters and the number of sequences in the MSA, and we show how one can fit accurate Potts models to MSAs containing only thousands of effective sequences with negligible overfitting, even though there are many more Potts model parameters than sequences. We illustrate this using a simple-to-understand toy model and demonstrate it numerically for realistic Potts models. We find that the degree of overfitting can be quantified using the &quot;signal-to-noise ratio&quot; (SNR), which is a function of the number of model parameters θ, the degree of conservation of the MSA as measured by a value called Χ<sup>2</sup>, and the number of sequences N. While the SNR is related to the ratio of number of parameters θ to number of sequences N, it contains other terms including Χ<sup>2.</sup>. In order to demonstrate that our Potts models for HIV proteins are not overfit, we have added a discussion of the SNR of our models to the revised manuscript showing that they have suitable SNR and satisfy the criteria described in Haldane and Levy, 2019 for estimating statistical energy differences without overfitting. Our paper (Haldane and Levy, 2019) also discusses cross-validation of Potts statistical energies and quantities which can be derived from the statistical energies such as ΔE.</p><p>We think reviewer #2’s comment “In any case, the notion that pairwise maxent Potts-like models can do a decent job of explaining sequence variability is not a new result and has been shown in dozens of papers.” is inappropriate. We have been active and publishing in this field since 2012 and are well versed in the literature which is extensively cited. Our analysis of the effects of the sequence background on the likelihood of drug resistance mutations in HIV-1, which first appeared in 2017 (Flynn et al., 2017) and which is presented in a more complete form in the current manuscript where the predictions are verified, is highly novel, there is nothing comparable in the literature. Our analysis of the entrenchment of DRMS for HIV-1 is not simply a calculation of the fitness of single point mutations, which has been reported by several groups working with Potts models of sequence variability. In order to demonstrate the entrenchment of a DRM by the background it is necessary to be able to capture the effects of many simultaneous mutations on DRM sites and how those effects change as the sequence background changes. This is related to our ability to model higher order marginals of the distribution, which is possible using our MCMC method to infer the Potts model. It would be quite difficult to obtain results concerning the entrenchment of DRMS of comparable quality using more approximate inference methods.</p><disp-quote content-type="editor-comment"><p>1b) The authors discuss their Potts model as providing a general probability for the observing a mutation alpha at site i in a genetic background of sequence S. But, in fact, the model depends only on pairwise interactions, the full sequence S. The authors should clarify this in the main text.</p></disp-quote><p>While the Potts Hamiltonian model contains only pairwise interaction terms, the Potts effective potential function induces higher order correlations and the probability of a given sequence cannot be decomposed into a sum of products of lower order terms. In other words, pairs of residues interact with each other both directly (through a direct coupling in the Hamiltonian) and indirectly through chains of interactions involving one or more intermediate residues. As a consequence, the higher order marginals of the distribution cannot be expressed as an explicit function of the pair correlations. Our ability to predict the effect of the background on the likelihood of a drug resistance mutation is related to the ability of our MCMC algorithm to infer a Potts model of sequence co-variation which is sufficiently accurate to infer higher order marginals of the distribution as described in Flynn et al., 2017; Haldane et al., 2018. The Potts model Hamiltonian with pairwise terms is both necessary and sufficient to capture many observable effects that involve higher order correlations, like the effect of the sequence background on the likelihood of a DRM. Whether or not Hamiltonian functions which include triplet or even higher order terms are needed to capture other properties of the HIV sequence ensembles is a question that is not strictly germane to our paper, and in any case is best studied first in toy models because of the data limitations inherent in HIV sequence databases. We have added a discussion of this point to the main text in subsection “Epistasis: the effect of the background on primary resistance mutations in HIV” and subsection “Model inference”.</p><disp-quote content-type="editor-comment"><p>1c) It is not clear what reference sequence is used as the &quot;wildtype&quot; S throughout the analysis. Is this a consensus sequence from the database? This should be explained in the main text.</p></disp-quote><p>For all three proteins (PR, RT, IN) the reference sequence referred to as “wildtype” is the consensus subtype B sequence, as obtained from an alignment of subtype B sequences maintained in the Los Alamos HIV sequence database, which is frequently used as the reference for mutation studies. Where the consensus sequence can be obtained is stated the revised Materials and methods section. Since this reference sequence is often referred to as the “consensus wild-type subtype B” sequence, we have adopted this terminology in the main text and in the Materials and methods section.</p><disp-quote content-type="editor-comment"><p>2) The main results on entrenchment (Figure 2) are not described precisely and seem to contradict the notion of entrenchment to which the authors refer in their introduction. Entrenchment according to Pollack et al. occurs when a substitution is initially neutral or slightly beneficial (so that its reversion is neutral or only slightly deleterious), but when subsequent substitutions in the protein render the focal mutation highly deleterious to revert. And yet the mutations discussed here are drug resistance mutations arising in the presence of drugs – and so the primary mutation must be net highly beneficial, even if it partly disrupts HIV protein function. (Indeed Figure 4 shows that the primary DRMS are favored.) And so, prima facie, this situation is quite different to Pollack at all – because the reversion is immediately disfavored, even without changes to the genetic background. Presumably the authors intend to show that the DRMs become *even more deleterious* to revert as subsequent substitutions accrue, although they do not say this in the main text and repeatedly refer to the DRMs as carrying fitness costs as the time of their emergence.</p><p>2b) Figure 2A, showing the main entrenchment results according to the Potts model, seems to contradict the notion the primary mutation is a resistance site that is beneficial at the time of its substitution (as in Figure 4). The figure reports a nearly 100-fold preference to revert the primary DRM L90M substitution in the background in which it arose – i.e. the mutation is inferred to carry a huge fitness cost (and its reversion a benefit) at the time of its origin. This does not make sense to me, as a reader, as the DRM (even if it contains some costs for protein function) must be net adaptive at the time of its substitution in a patient. Why does Figure 2A show that the drug resistance site is strongly disfavored in the genetic background in which it initially arose?</p></disp-quote><p>We use the term entrenchment to refer to the fact that the sequence background has a large effect on the relative likelihood of observing a drug resistance mutation vs. a consensus wildtype residue at a DRM site. For some sequence backgrounds with several accessory mutations the background is highly favorable for the DRM; we refer to these mutation patterns as “entrenching”, while for other backgrounds with the same total number of associated mutations, those backgrounds highly disfavor the DRM. Our Potts Hamiltonian model is able to predict these sequence specific effects (entrenching vs. disfavoring DRMS) with high fidelity, even for sets of sequences conditional on having the same total Hamming distance from the wild type consensus sequence. This is an achievement that would not be possible using more approximate inverse inference techniques to construct the Potts Hamiltonian.</p><p>Perhaps the reviewer’s questions 2 and 2b are due to a misunderstanding concerning the information contained in Figure 2? It appears that the reviewer is interpreting Figure 2 as a time ordering of the appearance of the L90M mutation in backgrounds with increasing numbers of mutations. There is no information about time ordering of the appearance of L90M in Figure 2. We are not currently using the Potts model to infer information about the kinetics by which drug resistance is acquired. In fact, the drug resistance mutation 90M appears in the Stanford drug experienced dataset only 2 times in the wild type consensus background, while the wild-type consensus residue L90 appears 40 times in the wild type consensus background in the same dataset. Even though L90M is a drug resistance mutation, it is deleterious in the consensus wildtype background because of intrinsic epistatic effects, and according to the Stanford drug experienced database, the L90M mutation in the consensus background is ~ 20x less likely to be observed than the wild-type residue (L90) in the same consensus background sequence.</p><p>While Figure 2 should not be thought of as a time ordering of the appearance of L90M in a population, we can speculate about kinetics given the information in Figure 2. A possible scenario would be that L90M first appears in backgrounds where the L90M mutation is almost neutral, there are many such sequences with a Hamming distance of ~7 to 10 mutations from the consensus wildtype. Many of these backgrounds are almost neutral for L90M. Additional mutations, sometimes accompanied by reversions, will in general increase the likelihood of L90M leading to stronger entrenchment. Such a scenario is consistent in a general way with the time dependent model of entrenchment described by Shah et al., (2015) and Pollock et al., (2012), even though our current model does not include kinetics. But there are differences with the scenario envisioned by these authors in that the initial HIV-1 DRM mutation in the wildtype consensus sequence need not be almost neutral, since the path to entrenchment of drug resistance mutations need not pass through that sequence containing 1 DRM in the consensus background (the paper by Shah et al., does describe a similar scenario). We have revised the main text (subsection ““Entrenchment” of a primary resistance mutation and its verification”, Discussion section) to make it clear that our model is not a kinetic model, and that the L90M mutation is only rarely observed in the wild type consensus background in the drug experienced Stanford database. We plan to investigate the time evolution of the appearance of drug resistance in specific backgrounds using explicitly kinetic models in upcoming work.</p><disp-quote content-type="editor-comment"><p>2c) The authors should define in terms of the ΔE notation when, precisely, is being plotted on the y-axis of Figure 4A.</p></disp-quote><p>It is not clear whether the reviewer is referring to Figure 2A or Figure 4? Concerning the Y-axis on the rhs of Figure 2A, D,E is the difference in the Potts statistical energy of the sequence with the consensus wild type residue L at position 90 minus the Potts statistical energy of the drug resistance mutation M at position 90. A positive value ΔE means the mutant is favored. ΔE is the log of the probability of observing the mutant M in the background relative to the wild type residue in the background. The box plots show the statistics (median, and quartiles) for ΔE.</p><p>Figure 4 shows the distributions of ΔE values for key residues associated with drug resistance in HIV-1 IN. The green histogram shows the calculated ΔE for every drug resistance position in sequences where the drug resistance mutation is present, while the blue histogram shows the calculated ΔE to all other residue types in the same sequence background. The relative displacement of the green from the blue distributions shows that in sequences which contain the drug resistance mutation, the mutation is predicted on average to be more likely than the consensus residue type in that background (green distribution), and mutations to other residue types in that same sequence background are less likely (blue distribution). The green histogram is normalized to the total drug resistance mutation count in the Stanford HIV database (the total number of drug resistance mutations in each sequence times the total number of sequences), while the blue histogram is normalized to the total number of other possible mutations excluding the drug resistance mutation. This is made clear in the main text in subsection “Fitness and degree of entrenchment of observed resistance mutations: why some mutations are seen and others are not” and the legend for Figure 4.</p><disp-quote content-type="editor-comment"><p>2d) The authors state &quot;entrenchment of key resistance mutations is likely to play an important role in emergence of drug-resistance viral strains&quot;. I cannot understand what the authors mean by this. Certainly, the initial *emergence* of a drug resistance strain depends on the adaptive benefit of DRM on the background in which it arises – and has nothing to do with future changes to the genetic background. Perhaps the authors mean that the &quot;persistence&quot; of the DRM over subsequent evolution depends on entrenchment?</p></disp-quote><p>We can understand why a reader might be confused by the statement &quot;entrenchment of key resistance mutations is likely to play an important role in emergence of drug-resistance viral strains&quot;. We have revised the text in the Discussion section to provide a better explanation of what we intended to say concerning the relationship between entrenchment and the emergence of drug resistance. In the new text we state clearly that in this manuscript we are not modeling the time development of drug resistance or identifying evolutionary paths by which drug resistance is acquired. However, our construction of Potts models for both the drug naïve and drug experienced populations, sets the stage for kinetic studies of the pathways by which drug resistance is acquired. In order to identify HIV sequences which are most responsible for conferring drug resistance, we need to know the probabilities of observing highly entrenching sequences in both the drug naïve and drug experienced populations. As we discuss in the Discussion section of the revised manuscript, multicanonical reweighting techniques that can be applied to Ising and Potts models have been developed for this purpose.</p><p>Concerning the reviewer’s statement “Certainly the initial *emergence* of a drug resistance strain depends on the adaptive benefit of DRM on the background in which it arises”, we emphasize again that the initial “emergence” of a drug resistance mutation does not need to appear in the consensus wild type background (see our response to reviewer #2 comment 2 and 2b above), and for example the Protease resistance mutation L90M is rarely observed in the wildtype consensus background in the Stanford drug experienced dataset.</p><disp-quote content-type="editor-comment"><p>3) [Presentation issue] The authors discuss the stabilization or destabilization of mutations in their Introduction and throughout (Table 1). I believe by &quot;stabilization&quot; they mean epistasis with subsequent substitutions that render the primary mutation costly to revert. But this is a terrible choice of words, because the large literature on entrenchment (Pollack, Shah etc.) has been developed for models of thermostability – and, indeed, entrenchment has been observed to arise from interactions between sites for protein stability. The authors do not seem to be using the word &quot;stability&quot; here to mean thermostability, which is tremendously confusing when referring to a literature that is all about the effects of mutations, and their interactions, on thermostability.</p></disp-quote><p>We have removed the words “stabilizing” and “destabilizing” when referring to mutations as we agree that these words are often used in the context of the effects of a mutation on “protein stability” or “thermostability”. Instead we use the terms “favoring” or “disfavoring” to describe the correlated effects of sequence backgrounds on the probability of a drug resistance mutation appearing in that background.</p><p>The Potts model infers the probabilities of sequences in a population; several papers have characterized how well Potts statistical energies track fitness. There are many different ways that mutations can affect fitness; they include mutational effects on thermostability, replicative capacity, viral infectivity, etc. All of these factors will contribute to the prevalence of the sequence in the Stanford HIV database. (Also, see our answer to reviewer #2 comment 4 next).</p><disp-quote content-type="editor-comment"><p>4) The authors make a big deal of their analysis of &quot;entrenchment of DRMs&quot; in the population – meaning that drug resistance mutations are beneficial in over 50% of the sequences sampled/fit. I do not find this surprising or even attributable to entrenchment at all – because, after all, the sequences being used to fit the model are sequences from drug-experienced HIV populations, where the drug resistance mutation will be net beneficial *at the time of its original occurrence* and even without any further substitutions. This is shown directly in Figure 4, for example.</p></disp-quote><p>Regrettably, the reviewer appears to misunderstand the points we make about “entrenchment of DRMS” and therefore misunderstand the main theme of our paper. The reviewer’s statement that “drug resistance mutations are beneficial in over 50% of the sequences sampled/fit” is incorrect. This is clear simply from an analysis of the frequencies (univariate marginals) of the four classes of drug resistance mutations in the three target proteins (RT mutations against NRTIs and NNRTIs, PR mutations against PIs, and IN mutations against INSTIs). In fact, for all four classes of DRMs, the frequency with which each DRM appears in the Stanford HIV drug experienced database is almost always under 50% (there is one exception, the NRTI resistance mutation M184V); and the frequencies of individual DRMS in the drug experienced dataset are usually much smaller than 50%.</p><p>We use the term “Entrenchment of a DRM in the population” to refer to the fact that for most DRM mutations (the exception being NNRTIs), we observe that the DRM is favored over the consensus residue type at the corresponding DRM position (i.e. the Potts energy change is ΔE &gt;0 at that position, and this depends on the residues at every other position) for more than 50% of the sequences which contain the DRM. If a mutation is entrenched in the population it is then unlikely or difficult to revert in more than 50% of the sequences in which the DRM is present.</p><p>This information was contained in Table 2—source data 1, Table 2—source data 2, Table 2—source data 3, and Table 2—source data 4, of the original manuscript. We have revised the tables to make the point clearer and revised the main text in subsection “Comparative entrenchment of resistance mutations in protease, reverse transcriptase, and integrase” to point this out. Most sequence backgrounds are unfavorable for any specific DRM. Consider an example. For the π mutation D30N in Protease, only 8% of the sequences in the Stanford HIVDB contain this π mutation, but 66% of the sequences with the D30N mutation have sequence backgrounds which are entrenching, meaning that there is a greater than even chance of observing D30N in 66% of the sequences containing D30N (see Table 2—source data 3). Consider another example, the INSTI-selected mutation Q148H which occurs with frequency 19% in the Stanford Drug Experienced dataset, but in 98% of these sequences (containing Q148H), the Potts model predicts that the Q148H mutation is more likely than not (i.e. that it is entrenched in these sequences). We have revised the text in subsection “Comparative entrenchment of resistance mutations in protease, reverse transcriptase, and integrase” to make it very clear that there is a distinction between the frequency of observing a DRM (which is usually low), and the likelihood that the DRM is “entrenched” in the sequences which contain that mutation (which is usually high).</p><p>Entrenchment in the population is better defined with an example the second paragraph of subsection “Comparative entrenchment of resistance mutations in protease, reverse transcriptase, and integrase”. It is also discussed in the fifth paragraph of subsection “Comparative entrenchment of resistance mutations in protease, reverse transcriptase, and integrase” leading to a discussion of sequences containing at least one entrenched DRM.</p><disp-quote content-type="editor-comment"><p>5) When the authors report that they have &quot;verification&quot; of entrenchment I assumed they meant they had direct data on fitness measurements for a mutation in one genetic background, and in a subsequent background. But in fact, the &quot;verification&quot; is simply relative to the fitted Potts model. By contrast, when the authors do compare the model to actual measurements of fitness effects (subsection “Molecular clones and the effects of speci1c backgrounds”), the authors seem to be saying that the predictions of the Potts model do not match the empirical measurements, and they attribute this to limitation of the mutagenesis experiments, as opposed to a deficiency of the Potts model. Comparison to data would have been the only thing that really convinces me that any statistical effects of their model are &quot;verified&quot;.</p><p>5b) Also, I had a hard time understanding what conclusions the authors draw from Figure 5, or even what the axes really denote in Figure 5. The notation Δ E_patient does not seem to be defined in the main text. The authors seem to be showing effects of mutations predicted by the Potts model fitted to patient data versus their predicted effects in the specific genetic backgrounds used for mutagenesis experiments – but it's not clear if that's what they're plotting, in fact, or what we are supposed to conclude from Figure 5.</p></disp-quote><p>“Entrenchment” is a statement about the relative probability of seeing a drug resistance mutation as compared with the consensus residue type at a specific position, given the sequence background, which is determined by the coupling of that position to all other positions in the sequence. Our predictions of entrenchment using the Potts model are amply verified using the Potts model calculations of the change in the statistical energy ΔE as a classifier to predict the sequence backgrounds in which the drug resistance mutation is likely to be present (or absent), and then comparing the predictions with the observations from the Stanford HIV drug experienced dataset which are aggregated into groups according to the predicted values of ΔE. The comparison between our predictions and observations are presented in Table 1. We cannot emphasize too strongly that we do not fit a Potts model to observations about which sequence backgrounds are likely to favor or disfavor a DRM; the Potts model is only fit to the bivariate marginals of a very high dimensional distribution (the MSA).</p><p>A classifier of sequence backgrounds as “entrenching” or “disfavoring” towards DRMs where the predicted frequencies match the observed frequencies so well as shown in Table 1 is highly non-trivial and extremely unlikely to have happened by chance (p-value close to zero).</p><p>The subsection “Molecular clones and the effects of specific backgrounds” in the revised text presents a discussion of the results shown in Figure 5 and Figure 6. In Figure 5 we compare the predicted log likelihood (ΔE) of observing a drug resistance mutation in three specific sequence backgrounds – the molecular clones NL4-3, and HXB2, and the consensus sequence background – with the corresponding values calculated as an average over the drug experienced sequences in the Stanford HIV-1 dataset &lt;ΔE<sub>patients</sub>&gt;. We make the following points: (a) the log likelihood values of a drug resistance mutation appearing in the three specific sequence backgrounds NL4-3, HXB2, and consensus, correlates moderately with the average value in the drug experienced population and NL4-3 is most representative of the drug experienced population. Figure 5 shows that the log likelihood values are negative for most drug resistance mutations in the NL4-3 and HXB2 molecular clones, and indeed most drug resistance mutations are not present in these clones.</p><p>The reviewer’s claim that “By contrast, when the authors do compare the model to actual measurements of fitness effects (subsection “Molecular clones and the effects of speci1c backgrounds”), the authors seem to be saying that the predictions of the Potts model do not match the empirical measurement” is not correct, that is not what we are saying. As stated again for emphasis, our paper is focused on an analysis of how the sequence background affects the likelihood of observing a drug resistance mutation. We verify the predictions by comparison with the prevalence of drug resistance mutations observed in the Stanford database in particular backgrounds when the statistics are aggregated according to the predicted likelihood of observing the mutation in sequence backgrounds with Potts ΔE scores in different ranges. Potts statistical energy scores ΔE are sometimes used as a proxy for organism “fitness”; this can take on different meanings depending on which experiments (e.g. thermal stability, replicative capacity, etc.) are used to interrogate for “fitness” (Wargo and Kurath, 2012). We note that many key resistance mutations are predicted by the Potts model to be disfavored in the NL4-3 and HXB2 molecular clones, this is consistent with literature reports of the effects of these drug resistance mutations on experimental probes of fitness using the NL4-3 and HXB2 clones for these experiments (Hu and Kuritzkes, 2010; Abram et al., 2013).</p><p>Figure 6 shows the distributions of Potts statistical energy differences ΔE for two IN drug resistance mutations N155H and G140S calculated over the set of drug experienced sequences in the Stanford database. It can be seen that on average the statistical energies are much more favorable in sequence backgrounds where the drug mutation appears as compared with those where it does not. For comparison the statistical energy differences for the NL4-3 and HXB2 clones are also shown. The Potts statistical energy of a sequence is commonly interpreted to be proportional to fitness. Using changes in statistical energy as a proxy for changes in fitness when a DRM is substituted for a wild-type consensus residue, the results shown in Figure 6 imply that the fitness effects of the N155H and G140S IN mutations measured through mutagenesis experiments on specific molecular clones are likely to be quite different from the effects averaged over a distribution of sequence backgrounds represented in the Stanford HIVDB.</p></body></sub-article></article>