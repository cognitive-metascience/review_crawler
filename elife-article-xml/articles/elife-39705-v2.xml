<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">39705</article-id><article-id pub-id-type="doi">10.7554/eLife.39705</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Communication</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Molecular function limits divergent protein evolution on planetary timescales</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-116794"><name><surname>Konaté</surname><given-names>Mariam M</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-116801"><name><surname>Plata</surname><given-names>Germán</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6470-7748</contrib-id><email>gap2118@cumc.columbia.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-116795"><name><surname>Park</surname><given-names>Jimin</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/><xref ref-type="other" rid="dataset1"/></contrib><contrib contrib-type="author" id="author-145575"><name><surname>Usmanova</surname><given-names>Dinara R</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5031-0013</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-59622"><name><surname>Wang</surname><given-names>Harris</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2164-4318</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-116210"><name><surname>Vitkup</surname><given-names>Dennis</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4259-8162</contrib-id><email>dv2121@cumc.columbia.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Systems Biology</institution><institution>Columbia University</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Division of Cancer Treatment and Diagnosis, National Cancer Institute</institution><addr-line><named-content content-type="city">Bethesda</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Department of Pathology and Cell Biology</institution><institution>Columbia University</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Department of Biomedical Informatics</institution><institution>Columbia University</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ben-Tal</surname><given-names>Nir</given-names></name><role>Reviewing Editor</role><aff><institution>Tel Aviv University</institution><country>Israel</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Tautz</surname><given-names>Diethard</given-names></name><role>Senior Editor</role><aff><institution>Max-Planck Institute for Evolutionary Biology</institution><country>Germany</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>18</day><month>09</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e39705</elocation-id><history><date date-type="received" iso-8601-date="2018-06-29"><day>29</day><month>06</month><year>2018</year></date><date date-type="accepted" iso-8601-date="2019-08-07"><day>07</day><month>08</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Konaté et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Konaté et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-39705-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.39705.001</object-id><p>Functional conservation is known to constrain protein evolution. Nevertheless, the long-term divergence patterns of proteins maintaining the same molecular function and the possible limits of this divergence have not been explored in detail. We investigate these fundamental questions by characterizing the divergence between ancient protein orthologs with conserved molecular function. Our results demonstrate that the decline of sequence and structural similarities between such orthologs significantly slows down after ~1–2 billion years of independent evolution. As a result, the sequence and structural similarities between ancient orthologs have not substantially decreased for the past billion years. The effective divergence limit (&gt;25% sequence identity) is not primarily due to protein sites universally conserved in all linages. Instead, less than four amino acid types are accepted, on average, per site across orthologous protein sequences. Our analysis also reveals different divergence patterns for protein sites with experimentally determined small and large fitness effects of mutations.</p><p><bold>Editorial note:</bold> This article has been through an editorial process in which the authors decide how to respond to the issues raised during peer review. The Reviewing Editor's assessment is that all the issues have been addressed (<xref ref-type="decision-letter" rid="SA1">see decision letter</xref>).</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>orthologous protein</kwd><kwd>evolution</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>E. coli</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R01</award-id><principal-award-recipient><name><surname>Vitkup</surname><given-names>Dennis</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Orthologous proteins that continuously maintain the same molecular function do not usually diverge beyond a certain level of sequence and structural similarity.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>As proteins evolve from a common ancestor, their sequences and structures diverge from each other (<xref ref-type="bibr" rid="bib16">Chothia and Lesk, 1986</xref>; <xref ref-type="bibr" rid="bib51">Povolotskaya and Kondrashov, 2010</xref>). Multiple previous studies have investigated the relationship between the conservation of protein molecular function, sequence identity (<xref ref-type="bibr" rid="bib39">Lee et al., 2007</xref>; <xref ref-type="bibr" rid="bib61">Tian and Skolnick, 2003</xref>; <xref ref-type="bibr" rid="bib66">Worth et al., 2009</xref>) and structural similarity (<xref ref-type="bibr" rid="bib16">Chothia and Lesk, 1986</xref>; <xref ref-type="bibr" rid="bib65">Wilson et al., 2000</xref>). For example, the likelihood that two proteins share the same molecular function, given their sequence (<xref ref-type="bibr" rid="bib61">Tian and Skolnick, 2003</xref>) or structural (<xref ref-type="bibr" rid="bib65">Wilson et al., 2000</xref>) similarity, has been used to investigate the emergence of new protein functions (<xref ref-type="bibr" rid="bib53">Rost, 2002</xref>; <xref ref-type="bibr" rid="bib17">Conant and Wolfe, 2008</xref>), and to perform functional annotations of protein sequences (<xref ref-type="bibr" rid="bib39">Lee et al., 2007</xref>; <xref ref-type="bibr" rid="bib65">Wilson et al., 2000</xref>). In this work, we focused on a different and currently unaddressed set of questions. Namely, how far can two sequences diverge while continuously maintaining the same molecular function? What are the temporal patterns of this divergence across billions of years of evolution? And how different protein sites contribute to the long-term divergence between orthologs with the same molecular function? We note that the requirement for the continuous conservation of molecular function is crucial in this context, as multiple examples of convergent evolution and protein engineering demonstrate that the same molecular function, such as catalysis of a specific chemical reaction, can in principle be accomplished by proteins with unrelated sequences and even different folds (<xref ref-type="bibr" rid="bib12">Bork et al., 1993</xref>; <xref ref-type="bibr" rid="bib24">Galperin et al., 1998</xref>; <xref ref-type="bibr" rid="bib45">Omelchenko et al., 2010</xref>).</p><p>It was previously demonstrated that proteins with the same structural fold frequently diverge to very low (~10%) levels of sequence identity (<xref ref-type="bibr" rid="bib52">Rost, 1997</xref>). These results suggest that conservation of protein fold, that is, the overall arrangement and topological connections of protein secondary structures (<xref ref-type="bibr" rid="bib43">Murzin et al., 1995</xref>), exerts relatively minor constraints on how far protein sequences can diverge. In contrast to protein folds, it is possible that conservation of specific molecular functions will significantly limit the long-term divergence of protein orthologs. While only a relatively small fraction of protein residues (~3–5%) are usually directly involved in catalysis (<xref ref-type="bibr" rid="bib40">Lehninger et al., 2013</xref>), recent analyses have demonstrated that even sites located far from catalytic residues may be significantly constrained in evolution. Because substitutions at these sites can have substantial effects on molecular function (<xref ref-type="bibr" rid="bib23">Firnberg et al., 2016</xref>), it is likely that functionally-related sequence constraints extend far beyond catalytic residues.</p><p>In this study, we explored the long-term divergence patterns of protein orthologs by characterizing their pairwise sequence and structural similarity as a function of their divergence time. We used several models of molecular evolution to calculate the divergence rates, defined as the decrease in pairwise sequence identity or structural similarity per unit time, between orthologous proteins with the same molecular function. We also characterized the long-term divergence patterns at protein sites with different levels of evolutionary conservation, different locations in protein structures, and different experimentally measured fitness effects of amino acid substitutions. Finally, we explored how the limits of sequence and structural divergence after billions of years of evolution depend on the degree of functional conservation between orthologs.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>To study the evolution of proteins with the same molecular function, we initially focused our analysis on enzymes because their molecular function is usually well defined. The Enzyme Commission (EC) classifies enzymatic functions using a hierarchical 4-digit code (<xref ref-type="bibr" rid="bib4">Bairoch, 1999</xref>), such that two enzymes that share all four EC digits catalyze the same biochemical reaction. We used protein sequences representing 64 EC numbers from 22 diverse model organisms across the three domains of life (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). The considered activities include members of all six major enzyme classes: oxidoreductases, transferases, hydrolases, lyases, isomerases and ligases.</p><p>To investigate whether the conservation of enzymatic function limits the divergence between orthologous sequences, we first calculated global pairwise sequence identities between orthologs as a function of their divergence times (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). The pairwise divergence times reported in the literature (<xref ref-type="bibr" rid="bib29">Hedges et al., 2006</xref>) between the considered 22 species (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>) were used as a proxy for the divergence times between corresponding orthologous proteins. For each enzymatic activity, we constructed phylogenetic trees based on the orthologous protein sequences and compared them to the corresponding species’ trees. Protein sequences with clear differences to the species'phylogenetic tree topologies, suggesting cases of horizontal gene transfer, were excluded from the analysis (see Materials and methods).</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.39705.002</object-id><label>Figure 1.</label><caption><title>Sequence divergence of enzyme orthologs as a function of time.</title><p>The global pairwise sequence identities between pairs of orthologous enzymes are shown as a function of divergence times between the corresponding species. Three models of amino acid substitution were used to fit the divergence data. Model 1 (black lines) assumes independent and equal substitution rates across all protein sites. Model 2 (red lines) assumes, in addition to independent and equal substitution rates, that a given fraction of protein sites remains identical at large divergence distances. Model 3 (blue lines) assumes a gamma distribution of amino acid substitution rates across sites. Best fits of the models are shown for four representative EC numbers: (<bold>a</bold>) 1.5.1.3, (<bold>b</bold>) 2.7.4.3, (<bold>c</bold>) 4.2.1.2, (<bold>d</bold>) 6.3.4.2. The horizontal dashed black lines represent the average sequence identity for the global alignment of unrelated protein sequences. The data and corresponding model fits for the other EC numbers considered in the analysis are given in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> and <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2a</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39705.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Sequence divergence of enzyme orthologs as a function of time.</title><p>The global pairwise sequence identities between pairs of orthologous enzymes as a function of divergence times between the corresponding species. The colored lines indicate fits to the data using the three models of amino acid substitutions (<xref ref-type="disp-formula" rid="equ1 equ2 equ3">Equations 1-3</xref>). The horizontal dashed black lines show the average sequence identity for the global alignment of unrelated protein sequences. Dot colors indicate the corresponding psi-blast E-value of the pairwise alignments for a database size of 3.8 × 10<sup>5</sup> sequences. Parameter fits of the divergence models are presented in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2a</xref>.</p><p><supplementary-material id="fig1s1sdata1"><object-id pub-id-type="doi">10.7554/eLife.39705.004</object-id><label>Figure 1—figure supplement 1—source data 1.</label><caption><title>Sequence identity versus divergence times for 64 enzyme families.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-39705-fig1-figsupp1-data1-v2.txt"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39705.005</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Projected long-term sequence identity of metabolic orthologs.</title><p>The distribution, across 64 EC numbers, of the projected global sequence identity after 7 billion years of sequence divergence according to the Model 3 (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). The vertical dashed red line represents the median value of the distribution (33%).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39705.006</object-id><label>Figure 1—figure supplement 3.</label><caption><title>Divergence of orthologs with experimentally validated functional annotations.</title><p>Sequence identity as a function of divergence time for orthologous enzymes annotated with the same EC number and experimentally validated molecular functions. The color lines indicate fits to the data for the three models of amino acid substitution (<xref ref-type="disp-formula" rid="equ1 equ2 equ3">Equations 1-3</xref>). Results are shown for 12 different EC numbers. For all EC numbers, the Model 2 (red) gives a better fit to the data compared to the Model 1 (black, F-test p-value&lt;0.05). Also, for all EC numbers the minimum sequence identity at long divergence times (<italic>Y<sub>0</sub></italic>, from <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>) is higher than the average sequence identity between unrelated protein pairs (~13.5%, dashed black lines) (Wald-test p-value&lt;0.05).</p><p><supplementary-material id="fig1s3sdata1"><object-id pub-id-type="doi">10.7554/eLife.39705.007</object-id><label>Figure 1—figure supplement 3—source data 1.</label><caption><title>Sequence identity versus divergence times for experimentally validated enzymes.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-39705-fig1-figsupp3-data1-v2.txt"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig1-figsupp3-v2.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39705.008</object-id><label>Figure 1—figure supplement 4.</label><caption><title>Enzyme divergence rates at 30% sequence identity.</title><p>The distribution of sequence divergence rates between orthologous enzymes when their sequence identity reaches 30%. Divergence rates were defined as the decrease in percent sequence identity per billion years. Divergence rates were calculated based on the Model 3 fits and <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>. The dashed red line represents the mean value of the distribution across enzymes (1.6% per billion years).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig1-figsupp4-v2.tif"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39705.009</object-id><label>Figure 1—figure supplement 5.</label><caption><title>Sequence divergence of non-enzyme orthologs as a function of divergence time.</title><p>The global pairwise sequence identities between pairs of orthologous proteins that are not part of the EC nomenclature are shown as a function of divergence times between the corresponding species. The colored lines indicate fits to the data using the three models of amino acid substitution (<xref ref-type="disp-formula" rid="equ1 equ2 equ3">Equations 1-3</xref>). The dashed black lines represent the average sequence identity for the global sequence alignment of unrelated protein sequences. Model parameter fits are presented in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2c</xref>.</p><p><supplementary-material id="fig1s5sdata1"><object-id pub-id-type="doi">10.7554/eLife.39705.010</object-id><label>Figure 1—figure supplement 5— source data 1.</label><caption><title>Sequence identity versus divergence times for 29 non-enzyme families.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-39705-fig3-v2.txt"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig1-figsupp5-v2.tif"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39705.011</object-id><label>Figure 1—figure supplement 6.</label><caption><title>Sequence divergence of mitochondrial ribosomal orthologs as a function of divergence time.</title><p>Global sequence identity as a function of divergence time for orthologous proteins with substantially different divergence rates between eukaryotic orthologs (red) and pairs of orthologs involving at least one prokaryotic sequence (black). Eukaryotic proteins are mostly annotated as mitochondrial ribosomal proteins and translation initiation factors. The dashed black lines represent the average sequence identity for the global sequence alignment of unrelated protein sequences.</p><p><supplementary-material id="fig1s6sdata1"><object-id pub-id-type="doi">10.7554/eLife.39705.012</object-id><label>Figure 1—figure supplement 6—source data 1.</label><caption><title>Sequence identity versus divergence times for mitochondrial ribosomal orthologs.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-39705-fig1-figsupp6-data1-v2.txt"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig1-figsupp6-v2.tif"/></fig><fig id="fig1s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39705.013</object-id><label>Figure 1—figure supplement 7.</label><caption><title>Effect of uncertainty in the estimation of species divergence times on the model fits.</title><p>Effect of different estimates of species’ divergence times on the predicted long-term sequence identity between orthologous enzymes with the same molecular function. The data on the left shows the fraction of enzymes for which the Model 2 Y<sub>0</sub> parameter is higher than 25% sequence identity; each dot corresponds to a different assignment of lineage divergence times (based on either minimum or maximum literature estimates; see Materials and methods). The data on the right shows the fraction of orthologous enzymes for which the predicted sequence identity after 7.8 billion years of divergence is higher than 25% identity. The box plots show the minimum and maximum values and 25% and 75% percentiles based on 1000 divergence time assignments.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig1-figsupp7-v2.tif"/></fig></fig-group><p>We next considered two simple models of long-term protein evolution, one without a long-term limit of sequence divergence and the other with an explicit divergence limit. The first model corresponds to sequence divergence with equal and independent amino acid substitution rates across all proteins sites (<xref ref-type="bibr" rid="bib20">Dickerson, 1971</xref>; <xref ref-type="bibr" rid="bib72">Zuckerkandl and Pauling, 1965</xref>); see <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, where <italic>y</italic> represents global sequence identity, <italic>t</italic> represents divergence time, and <italic>R<sub>0</sub></italic> represents the average substitution rate (<xref ref-type="bibr" rid="bib20">Dickerson, 1971</xref>). In this model, back substitutions are not allowed, and sequence divergence slows down with time simply due to multiple substitutions at the same protein sites and progressively fewer non-mutated sites. The second model corresponds to sequence divergence where, in addition to sites with equal and independent substitution rates, there is a minimal fraction of identical sites at long divergence times; the fraction of identical sites is represented by <italic>Y<sub>0</sub></italic> in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>.<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mi>*</mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>*</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:math></disp-formula><disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>100</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>*</mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>*</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:math></disp-formula></p><p>We applied the two models to fit the sequence divergence for each of the considered enzymatic functions. The best model fits for four representative metabolic activities are shown in <xref ref-type="fig" rid="fig1">Figure 1</xref> (black for the first model and red for the second); the fits for the remaining metabolic activities are shown in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>. In 62 of the 64 cases, the second model fits the divergence data significantly better than the first model (F-test p-value&lt;0.05, <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2a</xref>). Moreover, in 95% of the cases (61/64) the maximum likelihood value of the parameter <italic>Y<sub>0</sub></italic> is significantly higher (Wald test p-value&lt;0.05) than the average sequence identity between random protein sequences based on their optimal global alignment (~13.5%, shown in <xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> by dashed black lines). The distribution of the fitted parameter <italic>Y<sub>0</sub></italic> suggests a long-term sequence identity &gt;25% (with average ~40%) between considered orthologs (<xref ref-type="fig" rid="fig2">Figure 2a</xref>); this demonstrates that conservation of a specific enzymatic function significantly limits long-term protein sequence divergence. Notably, model two is mathematically equivalent (see Materials and methods) to a divergence model with equal substitution rates across sites, a limited number of amino acid types accepted per site, and allowed back substitutions (<xref ref-type="bibr" rid="bib58">Tajima and Nei, 1984</xref>; <xref ref-type="bibr" rid="bib26">Gilson et al., 2017</xref>; <xref ref-type="bibr" rid="bib69">Yang, 2006</xref>). In this model, the parameter <italic>Y<sub>0</sub></italic> represents the inverse of the effective number of acceptable amino acid types per site during protein evolution. Our results thus suggest that, on average, only 2 to 4 amino acids are acceptable per site for proteins that strictly conserve their molecular function (<xref ref-type="fig" rid="fig2">Figure 2a</xref>, top blue X axis); we note that this low average number does not contradict the fact that more than four amino acid types could be observed at a given protein site at low frequencies (<xref ref-type="bibr" rid="bib13">Breen et al., 2012</xref>).</p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.39705.014</object-id><label>Figure 2.</label><caption><title>The limit of long-term protein sequence divergence between orthologous proteins.</title><p>(<bold>a</bold>) The distribution of <italic>Y<sub>0</sub></italic> parameter values across 64 EC numbers for fits based on Model 2 (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>). The <italic>Y<sub>0</sub></italic> parameter represents the minimum percentage of protein sites that remain identical at long divergence times. The parameter <italic>Y<sub>0</sub></italic> (considered as a fraction) can also be interpreted as the inverse of the average number of amino acid types accepted per protein site during long-term protein evolution (top blue X axis). (<bold>b</bold>) Similar to panel a, but for 29 ancient protein families annotated with non-enzymatic functions. In panels a and b, the vertical red dashed lines represent the median values of the distributions (39% and 30%, respectively).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig2-v2.tif"/></fig><p>The two aforementioned models simplify the process of sequence divergence by considering the same substitution rates across protein sites. A more realistic and commonly used model of protein evolution assumes a gamma distribution (<xref ref-type="bibr" rid="bib68">Yang et al., 2000</xref>) of substitution rates across protein sites; see <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>; (<xref ref-type="bibr" rid="bib46">Ota and Nei, 1994</xref>), where α represents the shape parameter of the gamma distribution. The best fits of such a variable-rate model (blue in <xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>) showed that the rates of protein sequence divergence between orthologous enzymes have decreased by more than 10 times during ~4 billion years of evolution (see Materials and methods and <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2b</xref>). Although the third model does not explicitly consider a long-term divergence limit, the obtained model fits also show that the vast majority of orthologous enzymes with the same function will remain above 25% sequence identity on the timescales when Earth environments will be hospitable to life (1–3 billion years from the present <xref ref-type="bibr" rid="bib44">O'Malley-James et al., 2014</xref>) (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>).<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mi>*</mml:mi><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>*</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:math></disp-formula></p><p>The observed divergence limit is not an artifact due to difficulty detecting remote protein homologs, as it occurs at relatively high sequence identities (<xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), for which corresponding orthologs can be easily identified by computational sequence comparison methods. Furthermore, the results remained similar when we restricted the analysis to orthologous enzyme pairs with experimentally validated molecular functions (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>), based on publications referenced in the BRENDA database (<xref ref-type="bibr" rid="bib15">Chang et al., 2015</xref>). The results also remain robust towards the variance in the estimates of divergence times between considered species (see Materials and methods). We note that the divergence limit between orthologs with the same molecular function does not imply that the rates of molecular substitutions decrease in evolution. It is also not simply due to the curvilinear relationship between time and sequence identity caused by multiple mutations at the same sites; specifically, the observed decrease in divergence rates is substantially higher (by &gt;10 fold) than the one expected in model one simply due to multiple substitutions at the same protein sites. Instead, the effective limit is reached when, due to a small number of amino acids types accepted per protein site and back substitutions, additional amino acid replacements do not lead to a substantial further increase in protein sequence and structural divergence (<xref ref-type="bibr" rid="bib42">Meyer et al., 1986</xref>).</p><p>Interestingly, following the previously introduced metaphor of the expanding protein universe (<xref ref-type="bibr" rid="bib51">Povolotskaya and Kondrashov, 2010</xref>; <xref ref-type="bibr" rid="bib21">Dokholyan et al., 2002</xref>), we can use the third model (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>) to express the divergence rate between orthologs as a function of protein distance (<italic>D = 1 – y</italic>, where <italic>y</italic> is the fractional sequence identity ranging from 0 to 1), see <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>. This equation, similarly to Hubble’s law of universe expansion (<xref ref-type="bibr" rid="bib30">Hubble, 1929</xref>), describes how the divergence rate depends on the distance between protein orthologs. In contrast to the real universe, the expansion rate of the protein universe significantly decreases with divergence time and with distance between protein orthologs. For example, the divergence rate between protein orthologs drops, on average, to only ~2% sequene identity decrease per billion years when their mutual sequence identity reaches 30% (corresponding to protein distance of 70%; <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>).<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>*</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:math></disp-formula></p><p>The analyses described above focused on the divergence of enzymes with the same molecular function. In order to investigate whether the observed divergence patterns are not specific to enzymes, we repeated the analysis using non-enzymatic ancient orthologs (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>, <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2c</xref>). The set of analyzed 29 protein families included ribosomal proteins, heat shock proteins, membrane transporters, and electron transfer flavoproteins (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2d</xref>). Based on the same set of 22 species used in the analysis of enzyme families, we found that model two fitted the data significantly better than model one, and that the parameter <italic>Y<sub>0</sub></italic> was &gt;25% for the majority (23/29) of the non-enzymatic protein families (<xref ref-type="fig" rid="fig2">Figure 2b</xref>, <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2c</xref>). Interestingly, we also identified 19 additional orthologous groups showing two clearly different divergence patterns (<xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>), with pairs of eukaryotic orthologs diverging substantially faster and farther than prokaryotic orthologs in the same protein family. The orthologous groups with this behavior included mitochondrial ribosomal proteins and initiation factors of mitochondrial translation (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2e</xref>). It has been previously postulated that mitochondrial ribosomal proteins diverged significantly faster in eukaryotes, compared to the divergence between their bacterial orthologs, due to compensatory protein substitutions following the accumulation of slightly deleterious substitutions in the mitochondrial ribosomal RNA (<xref ref-type="bibr" rid="bib5">Barreto and Burton, 2013</xref>).</p><p>Having established, in the first half of the manuscript that conservation of molecular function significantly limits long-term sequence evolution, we investigated, in the second half, how different protein sites contribute to the observed divergence constraints. Specifically, whether the same protein sites are conserved between ancient orthologs in different phylogenetic lineages, how sites with different fitness effects of amino acid substitutions contribute to the divergence limit, and how structural locations of protein sites affect their long-term divergence patterns. We also explored how different levels of functional specificity constrain sequence and structural divergence.</p><p>To investigate whether the same protein sites are usually conserved between orthologs in different phylogenetic lineages, we aligned the sequences of ancient enzyme orthologs with the same molecular function (see Materials and methods). We then calculated how often each protein site is occupied by identical amino acids across pairs of orthologs from phylogenetically independent linages (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Orthologous protein pairs from independent lineages were obtained using species' pairs that do not share any edges in the corresponding phylogenetic tree (<xref ref-type="bibr" rid="bib3">Arnold and Stadler, 2010</xref>) (<xref ref-type="fig" rid="fig3">Figure 3a</xref>); for example, in <xref ref-type="fig" rid="fig3">Figure 3a</xref> the pair D-H is independent of the pair A-B but not of the pair E-F. We performed the above analysis using 30 enzymatic activities for which at least 20 independent pairs of orthologs could be identified based on annotations in the KEGG database (<xref ref-type="bibr" rid="bib33">Kanehisa et al., 2016</xref>) (see Materials and methods). The results demonstrated that only a relatively small fraction of protein sites (10–20%) are universally conserved, that is, they are identical in a majority (&gt;90%) of independent lineages (<xref ref-type="fig" rid="fig3">Figure 3b</xref>). Therefore, the observed long-term divergence limit is not primarily due to sets of universally conserved protein sites; instead, different sites contribute to the limit in independent phylogenetic lineages. By comparing the fractions of universally conserved sites to the average sequence identity between distant orthologs (~40%, <xref ref-type="fig" rid="fig2">Figure 2a</xref>) we found that these sites account, on average, for only ~35% of the observed sequence identity at long divergence distances. The analysis also revealed that different protein families show different probability distributions of identical sites (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). This is likely a consequence of diverse structural and functional requirements across protein families, leading to protein-family specific constraints on protein sites.</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.39705.015</object-id><label>Figure 3.</label><caption><title>Conservation of protein sites in phylogenetically independent lineages.</title><p>To identify the fractions of protein sites that are universally conserved ― defined as sites that are identical in at least 90% of orthologs ― we considered phylogenetically independent lineages. (<bold>a</bold>) Illustration of pairs of species (e.g. <bold>A–B and D–H</bold>) representing phylogenetically independent lineages. In the figure, A-B and D-H are pairs of species that diverged within a certain time window (illustrated by the blue shaded region); these species pairs do not share more recent edges in the phylogenetic tree. (<bold>b</bold>) The distribution of the fraction of universally conserved sites across 30 enzymatic families. The analysis was performed using 30 enzymatic families for which at least 20 independent pairs of orthologs with the same molecular function could be identified based on annotations in the KEGG database (<xref ref-type="bibr" rid="bib33">Kanehisa et al., 2016</xref>) (see Materials and methods); pairs of orthologs that diverged &gt;2 billion years ago were selected for this analysis. Error bars represent the S.E.M. based on three replicates using different sets of orthologous pairs. The dashed red line represents the median of the distribution (~13%).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39705.016</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Distribution of enzyme sites according to their conservation frequency.</title><p>The panels show the distribution of protein sites according to their probability of being identical in phylogenetically independent lineages; the distributions are shown for 30 different enzyme activities (EC numbers). The probabilities were calculated as the proportion of phylogenetyically independent pairs of orthologs, with divergence times &gt; 2 billion years (<xref ref-type="fig" rid="fig2">Figure 2a</xref>), in which a protein site is occupied by identical amino acids. Error bars represent the S.E.M across three replicates with different assignments of independent orthologous pairs.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig3-figsupp1-v2.tif"/></fig></fig-group><p>We next investigated the long-term divergence patterns at protein sites with different fitness effects of amino acid substitutions. To that end, we experimentally measured the fitness effects of all possible single amino acid substitutions in a representative enzyme, the <italic>Escherichia coli</italic> dihydrofolate reductase (FolA, EC 1.5.1.3). We selected FolA for the experiments due to its small size (159 amino acids) and essential role in the <italic>E. coli</italic> metabolism (<xref ref-type="bibr" rid="bib8">Benkovic et al., 1988</xref>); also, the long-term protein sequence identity between FolA orthologs (~32%, see <xref ref-type="fig" rid="fig1">Figure 1a</xref>) is similar to other analyzed enzymes (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). Following a recently described strategy (<xref ref-type="bibr" rid="bib34">Kelsic et al., 2016</xref>), we used the Multiplex Automated Genome Engineering (MAGE) approach (<xref ref-type="bibr" rid="bib63">Wang et al., 2009</xref>) to introduce every possible amino acid substitution at each FolA site in <italic>E. coli</italic>. To evaluate the relative fitness effects of protein substitutions we measured the growth rate of strains containing each protein variant compared to the ‘wild type’ (WT) strain into which substitutions were introduced. Relative growth rates were measured in parallel by performing growth competition experiments between the pooled mutants. Amplicon sequencing of the <italic>folA</italic> gene was then used to measure the relative changes of mutant and WT abundances as a function of time (see Materials and methods, <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>).</p><p>Using the MAGE growth measurements in <italic>E. coli</italic>, we investigated the patterns of long-term sequence divergence at protein sites with different fitness effects of amino acid substitutions. Specifically, we sorted FolA protein sites into several groups according to their experimentally measured average fitness effects (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>), and explored sequence divergence for sites within each fitness group (<xref ref-type="fig" rid="fig4">Figure 4a</xref>, different colors). We evaluated sequence identity between FolA orthologs across divergence times using all pairwise comparisons between ~300 orthologous sequences from the COG database (<xref ref-type="bibr" rid="bib25">Galperin et al., 2015</xref>). Although, as expected, sites with stronger fitness effects diverged more slowly, our analysis revealed interesting differences in temporal divergence patterns for sites with small and large fitness effects. For sites in the least deleterious fitness group (<xref ref-type="fig" rid="fig4">Figure 4a</xref>, blue) we observed, similar to the global sequence identity, a substantial decrease (~10 fold, see <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> in Materials and methods) in mutual divergence rates after ~1.5 billion years of evolution. Notably, even for FolA sites with mild fitness effects, sequence identity remains above 25% at long divergence distances. In contrast to sites with mild fitness effects, sites with the most deleterious mutations (<xref ref-type="fig" rid="fig4">Figure 4a</xref>, black) displayed a much slower, but approximately constant average divergence rate throughout evolutionary history. This pattern suggests that, in contrast to divergence at sites with small fitness effects, the divergence at sites with large effects is not yet close to saturation.</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.39705.017</object-id><label>Figure 4.</label><caption><title>Sequence divergence of protein sites with different fitness effects of mutations measured in <italic>E. coli</italic>.</title><p>(<bold>a</bold>) The divergence of sequence identity for FolA protein sites with different average fitness effects of mutations (measured in <italic>E. coli</italic>) is shown using different colors. The average sequence identities were calculated using bacterial FolA orthologs available in the COG database (<xref ref-type="bibr" rid="bib25">Galperin et al., 2015</xref>); divergence times were estimated using bacterial 16S rRNA sequences (see Materials and methods). Error bars represent the S.D. of sequence identity in each bin. (<bold>b</bold>) Similar to panel (<bold>a</bold>), but for the sequence divergence at protein sites of the <italic>E. coli</italic> translation initiation factor InfA. (<bold>c</bold>) The probability that protein sites in FolA orthologs (upper panel) and InfA orthologs (lower panel) are occupied by identical amino acids as a function of the average mutant fitness (measured in <italic>E. coli</italic>) at the corresponding protein sites. The probability represents the fraction of phylogenetically independent pairs of orthologs in which sites are identical at long divergence times (2 ± 0.25 billion years for FolA, and 2.5 ± 0.25 billion years for InfA). Error bars represent the S.E.M. across sites.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39705.018</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Distribution of average fitness effects of amino acid substitutions.</title><p>The panels show the distribution of average growth defects due to amino acid substitutions across FolA (<bold>a</bold>) and InfA (<bold>b</bold>) protein sites. The average growth (fitness) effects at each site was calculated as the mean values of experimentally measured growth phenotypes due to all possible amino acid substitutions at the site.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39705.019</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Reproducibility of experimentally measured average fitness effects of amino acid substitutions across FolA sites.</title><p>The similarity between the average fitness effects of substitutions across FolA sites was calculated using two non-overlapping sets of substitutions (see Materials and methods). Each dot in the figure represents one FolA site. The relative growth decrease in the X axis was calculated based on the relative growth rates of mutants carrying 32 randomly selected codons; the relative growth decrease in the Y axis was calculated based on the relative growth rates of mutants carrying the remaining 32 codons. The line X = Y is shown in red. Pearson’s r = 0.95, p-value&lt;1e-20.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig4-figsupp2-v2.tif"/></fig></fig-group><p>To assess the generality of the FolA results we used another dataset (<xref ref-type="bibr" rid="bib34">Kelsic et al., 2016</xref>), obtained using MAGE, of fitness values for all possible amino acids substitutions in the <italic>E. coli</italic> translation initiation factor InfA (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). Consistent with the relatively higher level of sequence conservation of InfA, we observed lower average mutant growth rates and lower rates of sequence divergence in each fitness group. Nevertheless, the long-term divergence patterns were qualitatively similar between the two proteins. For sites in the least deleterious InfA fitness group (<xref ref-type="fig" rid="fig4">Figure 4b</xref>, blue), we observed a substantial decrease in the divergence rate after ~2 billon years of evolution. In contrast, sites with strongest fitness effects (<xref ref-type="fig" rid="fig4">Figure 4b</xref>, pink) displayed a slower but approximately constant divergence rate.</p><p>Because the fitness effects of mutations at a protein site may change in evolution (<xref ref-type="bibr" rid="bib41">Lunzer et al., 2010</xref>; <xref ref-type="bibr" rid="bib14">Chan et al., 2017</xref>), it is interesting to investigate how fitness effects measured in one species, such as <italic>E. coli</italic>, correlate with the site conservation in other species at the divergence limit. To explore this question, we calculated the probability that a protein site is occupied at long evolutionary times (~2 billion years for FolA and ~2.5 billion years for InfA) by the same amino acid in phylogenetically independent lineages (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). We then investigated how this probability changes as a function of the average fitness effects of substitutions at the site measured in <italic>E. coli</italic> (<xref ref-type="fig" rid="fig4">Figure 4c</xref>). For both FolA and InfA, the probability that a protein site is identical at large divergence distances first increases, approximately linearly with increasing average fitness effects, and then begins to saturate for sites with large (&gt;30% growth rate decrease) fitness effects. Thus, the fitness effects at a protein site correlate with the site’s conservation even after billions of years of evolution.</p><p>The sequence constraints revealed by our analysis likely arise due to the conservation of corresponding protein structures required for efficient catalysis and molecular function (<xref ref-type="bibr" rid="bib65">Wilson et al., 2000</xref>; <xref ref-type="bibr" rid="bib64">Watson et al., 2005</xref>). Therefore, in addition to sequence divergence we also investigated the long-term structural divergence of orthologous proteins with the same function. For this analysis we used &gt;1000 orthologous pairs of enzymes sharing all 4 EC digits with known 3D structures (<xref ref-type="bibr" rid="bib9">Berman et al., 2000</xref>) (see Materials and methods); structures of orthologous enzymes were aligned using the TM-align algorithm (<xref ref-type="bibr" rid="bib71">Zhang and Skolnick, 2005</xref>). This analysis demonstrated that the average root mean square deviation (RMSD) between C-alpha atoms of the orthologous enzymes increases (Spearman’s r = 0.44, p-value&lt;1e-20) with divergence time (<xref ref-type="fig" rid="fig5">Figure 5a</xref>). Nevertheless, the C-alpha RMSD between orthologs rarely increases beyond 3 Å, even at long evolutionary distances. Consistent with sequence evolution (<xref ref-type="fig" rid="fig1">Figure 1</xref>), we also observed a substantial decrease in the rate of structural divergence after ~1.5 billion years of divergent evolution.</p><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.39705.020</object-id><label>Figure 5.</label><caption><title>Long-term structural evolution of enzymes with the same molecular function.</title><p>(<bold>a</bold>) The pairwise C-alpha root mean square deviation (RMSD) as a function of the divergence time between pairs of orthologs annotated with the same EC number. RMSD values were calculated based on structural protein alignments using the TM-align algorithm (<xref ref-type="bibr" rid="bib71">Zhang and Skolnick, 2005</xref>). Gray dots represent pairs of considered orthologs, boxes indicate the median and 25–75 RMSD percentiles for the corresponding divergence times, the vertical lines indicate the 5–95 percentiles, and the red line shows the moving average of the data. (<bold>b</bold>) Long-term divergence of sequence identity of protein sites located at different distances to enzymes’ active site residues. In this analysis we considered the same species and enzymatic activities used to explore the global sequence divergence (<xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>); the average sequence identities within each distance shell (shown using different colors) were calculated across all pairs of orthologs annotated with the same EC number (see Materials and methods). Error bars represent the S.E.M. across ortholog pairs.</p><p><supplementary-material id="fig5sdata1"><object-id pub-id-type="doi">10.7554/eLife.39705.021</object-id><label>Figure 5—source data 1.</label><caption><title>RMSD versus divergence times for proteins with the same enzymatic function.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-39705-fig5-data1-v2.txt"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig5-v2.tif"/></fig><p>Only a small fraction of all enzyme residues forms an active site and directly participates in catalysis. Therefore, we investigated next how the sequence divergence depends on the spatial proximity of protein positions to active site residues. It was previously demonstrated that evolutionary rates of amino acid substitutions correlate with protein sites’ spatial distance to catalytic residues (<xref ref-type="bibr" rid="bib31">Jack et al., 2016</xref>). Notably, differences in short-term evolutionary rates do not imply the existence of a divergence limit, nor do they inform how site-specific divergence patterns correlate with sites' structural locations. Thus, the main goal of our analysis was to investigate the temporal patterns of the long-term divergence, and the effective divergence limit for sites at various distances to the active site. We considered catalytic site annotations available from the Protein Data Bank (<xref ref-type="bibr" rid="bib9">Berman et al., 2000</xref>), UniProt-KB (<xref ref-type="bibr" rid="bib62">UniProt Consortium, 2015</xref>) and the Catalytic Site Atlas (<xref ref-type="bibr" rid="bib50">Porter, 2004</xref>) and quantified the average sequence divergence for sites at various distances from catalytic residues (see Materials and methods, <xref ref-type="fig" rid="fig5">Figure 5b</xref>). We based this analysis on the same set of enzymatic activities used to study global sequence divergence (<xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Although, as expected, residues close to the active site were the most highly conserved (<xref ref-type="bibr" rid="bib31">Jack et al., 2016</xref>; <xref ref-type="bibr" rid="bib28">Halabi et al., 2009</xref>), even distant sites displayed a substantial divergence limit (~40%) at long evolutionary distances. This result suggests that the spatial constraints required for specific molecular function usually propagate throughout the entire protein structure and significantly limit the long-term divergence even at sites distant from catalytic residues.</p><p>Finally, we investigated how various degrees of functional conservation affect the long-term divergence between orthologs. To that end, we compared the long-term sequence and structural similarities of enzymes sharing their full EC classification to those sharing only the first three digits of their EC classification (<xref ref-type="fig" rid="fig6">Figure 6a and b</xref>); for this comparison we only used orthologs from species with divergence times &gt; 2 billion years (see Materials and methods). In contrast to enzymes sharing all four EC digits, conservation of the first three digits indicates only a general class of substrates or cofactors (<xref ref-type="bibr" rid="bib4">Bairoch, 1999</xref>). This analysis revealed significantly lower long-term sequence identities (27% vs. 37% identity, Mann-Whitney p-value&lt;10<sup>−20</sup>) and structural similarities (2.4 vs. 1.8 Å RMSD, P-value 2 × 10<sup>−18</sup>) between orthologs sharing only partial EC numbers. Notably, orthologs sharing only the first three EC digits are still substantially more conserved, both in sequence and structure (p-values&lt;10<sup>−20</sup>), than pairs of enzymes with the same structural fold, but unrelated enzyme activities (i.e. enzymes sharing no digits in the EC classification) (<xref ref-type="fig" rid="fig6">Figure 6a and b</xref>, <xref ref-type="bibr" rid="bib18">Dawson et al., 2017</xref>).</p><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.39705.022</object-id><label>Figure 6.</label><caption><title>Effect of functional specificity on long-term sequence and structural divergence between orthologs.</title><p>(<bold>a</bold>) Sequence identities between orthologous pairs of enzymes that diverged over two billion years ago. The long-term sequence divergence between pairs of orthologs sharing the same EC number (gray, n = 272) is compared to the divergence between pairs only sharing the first three digits of their EC numbers (red, n = 265), that is, enzymes conserving only a general class of substrates or cofactors. The results are based on enzyme COGs for the 22 species used to analyze global sequence divergence (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). Blue points show sequence identities between pairs of proteins with the same structural fold (<xref ref-type="bibr" rid="bib18">Dawson et al., 2017</xref>) but unrelated enzyme activities, that is, activities sharing no digits in the EC classification (n = 298, see Materials and methods). The right blue Y axis represents the average number of amino acid types accepted per protein site during long-term protein evolution. (<bold>b</bold>) Similar to panel a, but showing the corresponding C-alpha structural divergence (RMSD) between protein pairs. (<bold>c</bold>) Long-term sequence identities between orthologous enzyme pairs at the same levels of structural similarity. Results are shown for pairs of enzymes sharing their full EC classification (gray dots), or only sharing the first three digits of their EC classification (red dots). In all panels: *(p&lt;0.05), **(p&lt;1e-4), ***(p&lt;1e-10) for the Mann-Whitney test.</p><p><supplementary-material id="fig6sdata1"><object-id pub-id-type="doi">10.7554/eLife.39705.023</object-id><label>Figure 6—source data 1.</label><caption><title>Sequence identities between ancient orthologs sharing the same EC number and only the first three digits of their EC numbers.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-39705-fig6-data1-v2.txt"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39705-fig6-v2.tif"/></fig><p>We also investigated the sequence constraints at the same level of protein structural divergence for proteins with different degrees of functional conservation. To that end, we calculated the sequence identity between orthologs, sharing either their full or partial EC numbers, at different bins of long-term structural similarity (<xref ref-type="fig" rid="fig6">Figure 6c</xref>). Interestingly, we observed that even at the same level of C-alpha RMSD divergence, orthologs sharing full EC numbers usually have higher levels of sequence identity compared to orthologous pairs with the same level of structural divergence but sharing only three EC digits. This result indicates that conservation of molecular function constrains sequence divergence even beyond the requirement to maintain a specific spatial structure.</p></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Our analysis demonstrates that, in contrast to proteins with the same fold (<xref ref-type="bibr" rid="bib52">Rost, 1997</xref>), the requirement to strictly conserve the same molecular function significantly limits the long-term sequence and structural divergence of protein orthologs. Although we confirmed the result by <xref ref-type="bibr" rid="bib51">Povolotskaya and Kondrashov (2010)</xref> that ancient protein orthologs are still diverging from each other, our study reveals that the rate of this divergence becomes increasingly slow for orthologs that strictly conserve their function. Even a slight relaxation of functional specificity, for example from full to partial EC conservation (<xref ref-type="fig" rid="fig6">Figure 6a and b</xref>), leads to substantially more pronounced long-term sequence and structural divergence. Similarly, a substantial sequence identity between homologous restriction endonucleases is usually limited to isoschizomers, that is, proteins specific to the same target DNA sequence (<xref ref-type="bibr" rid="bib48">Pingoud et al., 2014</xref>).</p><p>We believe that the observed divergence patterns can be explained by the following mechanistic model. Proteins with the same molecular function usually conserve the identity of their chemical and biological substrates and interaction partners. This conservation leads to functional pressure to closely preserve the spatial positions and dynamics of key protein residues necessary for efficient catalysis and function (<xref ref-type="bibr" rid="bib40">Lehninger et al., 2013</xref>). In turn, the requirement to continuously preserve structural properties and functional dynamics of key protein residues likely imposes a strict requirement to preserve the overall protein structure, in other words, structural optimality necessary for efficient and specific protein function. The evolutionary pressure to preserve structural optimality (to within &lt;3 Å C-alpha RMSD) required for a given molecular function leads, in agreement with the results by <xref ref-type="bibr" rid="bib16">Chothia and Lesk (1986)</xref> and others (<xref ref-type="bibr" rid="bib26">Gilson et al., 2017</xref>), to substantial levels of overall sequence conservation and the observed divergence limit. Our analysis further demonstrates that less than four amino acid types are accepted, on average, per site for proteins strictly conserving their molecular function.</p><p>We note that the observed conservation may reflect both the impact of amino acid substitutions on protein activity, due to changes in equilibrium positions and dynamics of protein residues, and on protein abundance, due to changes in overall protein stability (<xref ref-type="bibr" rid="bib10">Bershtein et al., 2015</xref>; <xref ref-type="bibr" rid="bib1">Adkar et al., 2017</xref>). Nevertheless, direct and comprehensive biochemical experiments demonstrated that the deleterious effects of mutations primarily arise from changes in specific protein activity rather than decreases in protein stability and cellular abundance (<xref ref-type="bibr" rid="bib23">Firnberg et al., 2016</xref>). Our results support this model, demonstrating that conservation of functional specificity imposes substantially more stringent long-term sequence constraints than simply conservation of protein folds and protein stability. Indeed, while every folded protein should maintain its stability, our results demonstrate that maintaining stable folds does not constrain long-term divergence to more than 10-15% sequence identity, which is substantially less than the requirement for maintaining specific molecular functions (~40% sequence identity). </p><p>The presented results demonstrate that only about a third of the sequence conservation between distant orthologs with the same molecular function can be attributed to universally conserved protein sites, that is, sites occupied by identical amino acids in almost all lineages. In contrast, we found that different protein sites are usually identical between orthologs from different lineages. This result is likely due, at least in part, to the epistatic nature of protein sequence landscapes, where mutations that are neutral in one lineage are often prohibitively deleterious in another (<xref ref-type="bibr" rid="bib13">Breen et al., 2012</xref>; <xref ref-type="bibr" rid="bib41">Lunzer et al., 2010</xref>). In the context of the aforementioned divergence model, the evolution of mitochondrial ribosomal proteins in eukaryotes (<xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>) provides an interesting example, suggesting that orthologs’ divergence can be substantially accelerated by co-evolution with their interaction partners or relaxation of selection pressures.</p><p>Our experimental and computational analyses also delineate two distinct stages of the long-term divergence of orthologs with the same molecular function. During the first 1–2 billion years of divergence, substitutions at protein sites with mild fitness effects lead to a substantial (40–60%) decrease in sequence identity. After the first stage, divergence at these sites effectively saturates. The saturation at sites with small fitness effects, combined with very slow divergence rate at sites with large fitness effects (<xref ref-type="fig" rid="fig4">Figure 4</xref>), leads to a substantially slower sequence and structural divergence during the second stage. Interestingly, as a consequence of this slowdown, for the past billion years there has not been a substantial decrease in sequence and structural similarity between ancient orthologs with the same molecular function. Further analyses of biochemical, biophysical and cellular constraints will reveal how various structural and functional properties influence proteins’ long-term evolution, and how protein functional efficiency may be compromised by deleterious mutations (<xref ref-type="bibr" rid="bib54">Shendure and Akey, 2015</xref>).</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th valign="top">Reagent type <break/>(species) or resource</th><th>Designation</th><th>Source or reference</th><th>Identifiers</th><th>Additional <break/>information</th></tr></thead><tbody><tr><td>Strain, strain <break/>background <break/>(<italic>Escherichia coli</italic> EcNR2)</td><td>MG1655, bla, bio-, <break/>λ-Red+, mutS-::cmR</td><td>PMID: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/?term=19633652">19633652</ext-link></td><td>Addgene #26931</td><td/></tr><tr><td>Sequence-based <break/>reagent</td><td>90 bp DNA <break/>oligos with <break/>phosphorothioated bases</td><td>This paper</td><td>See <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref></td><td>100 nmole DNA <break/>Plate oligo, <break/>Integrated DNA <break/>Technologies</td></tr><tr><td>Commercial assay or kit</td><td>Miseq Reagent Kit V2</td><td>Illumina</td><td>MS-102–2002</td><td/></tr><tr><td>Commercial assay or kit</td><td>sybr green</td><td>ThermoFisher</td><td>S7567</td><td/></tr><tr><td>Commercial assay or kit</td><td>Qubit HS DNA kit</td><td>ThermoFisher</td><td>Q32854</td><td/></tr><tr><td>Commercial assay or kit</td><td>Q5 Hot Start High- <break/>Fidelity Mastermix</td><td>NEB</td><td>M0494S</td><td/></tr><tr><td>Commercial assay or kit</td><td>DNA clean and <break/>concentration kit 5</td><td>Zymo Research</td><td>D4013</td><td/></tr><tr><td>Commercial assay or kit</td><td>illustra bacteria <break/>genomicPrep Mini <break/>Spin kit</td><td>GE life sciences</td><td>28904259</td><td/></tr><tr><td>Commercial assay or kit</td><td>Agilent DNA 1000 kit</td><td>Agilent Genomics</td><td>5067–1504</td><td/></tr><tr><td>Software, algorithm</td><td>SeqPrep v1.1</td><td>John St. John</td><td><ext-link ext-link-type="uri" xlink:href="https://github.com/jstjohn/SeqPrep">https://github.com/jstjohn/SeqPrep</ext-link></td><td/></tr><tr><td>Software, algorithm</td><td>Bowtie2</td><td>PMID: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/?term=19633652">22388286</ext-link></td><td/><td/></tr><tr><td>Software, algorithm</td><td>Perl scripts to count <break/>mutant reads</td><td>This paper</td><td><ext-link ext-link-type="uri" xlink:href="https://github.com/platyias/count-MAGE-seq">https://github.com/platyias/count-MAGE-seq</ext-link> <break/>(copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/count-MAGE-seq">https://github.com/elifesciences-publications/count-MAGE-seq</ext-link>).</td><td/></tr><tr><td>Other</td><td>Turbidostat for growth <break/>competition assay</td><td>PMID: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/?term=23429717">23429717</ext-link></td><td/><td/></tr></tbody></table></table-wrap><sec id="s4-1"><title>Considered enzyme activities and corresponding protein orthologs</title><p>We selected for analysis the sequences annotated in UniProt (<xref ref-type="bibr" rid="bib62">UniProt Consortium, 2015</xref>) with EC numbers associated with the following metabolic pathways (defined in the KEGG database) (<xref ref-type="bibr" rid="bib33">Kanehisa et al., 2016</xref>): Glycolysis and gluconeogenesis, pentose phosphate pathway, TCA cycle, purine metabolism, pyrimidine metabolism. Using the protein sequences from 22 diverse organisms (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>) we constructed clusters of orthologous groups (COGs) using the EdgeSearch algorithm (<xref ref-type="bibr" rid="bib35">Kristensen et al., 2010</xref>). Following previous studies, we considered any two proteins from different species in the same COG as orthologs (<xref ref-type="bibr" rid="bib59">Tatusov et al., 1997</xref>). COGs were obtained using the COGsoft software (<xref ref-type="bibr" rid="bib35">Kristensen et al., 2010</xref>), starting from an all-against-all psi-blast (<xref ref-type="bibr" rid="bib2">Altschul et al., 1997</xref>) search, setting the database size at 10<sup>8</sup>, and using a maximum considered E-value of 0.1. To obtain the largest number of likely orthologs we did not apply a filter on low complexity or composition-based statistics. Only proteins sharing the same EC number and assigned to the same COG were compared, and only COGs with sequences in 10 or more of the 22 species were used.</p><p>In order to exclude proteins clearly showing evidence of Horizontal Gene Transfer (HGT), we constructed a maximum likelihood phylogenetic tree of the 12 prokaryotes considered in our analysis using a concatenated alignment of marker genes (<xref ref-type="bibr" rid="bib67">Wu and Scott, 2012</xref>). The species tree was then manually compared to the individual trees of the prokaryotic sequences sharing the same molecular function within each COG; COG-specific trees were built using the GAMMA model of amino-acid substitution implemented in the RAxML software (<xref ref-type="bibr" rid="bib57">Stamatakis, 2014</xref>). Proteins that showed clear differences in tree topologies, suggesting HGT, were excluded from further analysis. Ancient gene duplications, that is, duplications occurring prior to the divergence between considered species, often lead to cases in which enzymes in the same COG but from different species have diverged for longer than the corresponding species’ divergence times; thus, we did not consider COGs with tree topologies showing evidence of ancient gene duplications. Ancient gene duplications were defined as those occurring prior to the last common ancestor of 3 or more of the 22 species considered in the analysis.</p><p>The same procedure was used to select non-enzymatic COGs for analyses (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>). However, in this case we only considered COGs for which none of the proteins were annotated in UniProt with metabolic EC numbers. Naturally, UniProt functional annotations for non-enzymes vary in terms of their source and format. Therefore, it is difficult to ascertain the degree of functional specificity and conservation between non-enzymatic orthologs. To address this, we manually checked that the molecular functions associated with proteins in the same COG were related, although we could not ascertain perfect conservation of molecular function.</p></sec><sec id="s4-2"><title>Models of long-term protein sequence evolution</title><p>Global sequence identities for pairs of proteins annotated with the same molecular function in the same COG were calculated using pairwise alignments with ClustalW2 (<xref ref-type="bibr" rid="bib38">Larkin et al., 2007</xref>). Sequence identity was computed as the number of identical sites at aligned positions, divided by the total number of aligned sites, excluding gaps. Divergence times between organisms were obtained from the TimeTree database (<xref ref-type="bibr" rid="bib29">Hedges et al., 2006</xref>) (November, 2015) and used as a proxy for protein divergence times; in the analysis we used the mean divergence times across studies listed in the database. Divergence times between bacteria and archaea were set to 4 billion years based on current estimates for the occurrence time of their Last Common Ancestor (<xref ref-type="bibr" rid="bib55">Sheridan et al., 2003</xref>; <xref ref-type="bibr" rid="bib6">Battistuzzi et al., 2004</xref>) and existing evidence of an early origin of life on Earth (<xref ref-type="bibr" rid="bib7">Bell et al., 2015</xref>). It is likely that ancient eukaryotic genes originated through episodic endosymbiotic gene transfer events and vertical inheritance from bacterial and archaeal genomes (<xref ref-type="bibr" rid="bib36">Ku et al., 2015</xref>; <xref ref-type="bibr" rid="bib60">Thiergart et al., 2012</xref>). Because of the discrete nature of such transfer events, the vast majority of individual prokaryotic-eukaryotic orthologous pairs are likely to have diverged from each other long before the origin of eukaryotes (1.8 billion years ago [<xref ref-type="bibr" rid="bib47">Parfrey et al., 2011</xref>]); specifically, because most ancient prokaryotic species would not have transferred genes to eukaryotes. Thus, based on the median divergence time between the considered prokaryotes (~4 billion years, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>), divergence times between eukaryotes and prokaryotes were set in our analyses at 4 billion years. The results presented in the paper remain insensitive to the exact value of this divergence estimate (within the 3–4 billion year interval). Based on the recently proposed affiliation of eukaryotes and members from the Lokiarchaeota (<xref ref-type="bibr" rid="bib56">Spang et al., 2015</xref>), divergence times between <italic>S. solfataricus</italic> and eukaryotes were set at 2.7 billion years, that is, the estimated age of the TACK superphylum (<xref ref-type="bibr" rid="bib27">Guy and Ettema, 2011</xref>; <xref ref-type="bibr" rid="bib11">Betts et al., 2018</xref>).</p><p>In order to study the long-term divergence patterns of orthologs, we only used COGs containing pairs of orthologs with at least five different divergence times distributed across 4 billion years. Sequence divergence data were fitted with models 1 to 3 using the least-squares minimization algorithm implemented in the MATLAB R2017a fitnlm function (The MathWorks, Inc, Natick, MA). The best fits of model 1 and model two were compared using the F-test. To test whether the conservation of molecular function limits protein sequence divergence, the minimum sequence identity parameter in model 2 (<italic>Y<sub>0</sub></italic>, from <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>) was compared, for each enzymatic activity, to the average global sequence identity between unrelated protein pairs using the Wald test.</p><p>To investigate the effect of the uncertainty of divergence times’ estimates, we repeated the analysis of the 64 enzymatic activities while randomly assigning either the maximum or minimum value of the divergence times between lineages reported in the TimeTree database. This analysis was performed for a total of 1000 independent assignment runs. Across the independent assignment runs, the expected long-term sequence identity between orthologs was higher than 25% for at least 90% of enzymes (based on model 2), and the projected sequence identity after 7.8 billion years was above 25% (based on model 3) for at least 75% of enzymes (<xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7</xref>).</p><p>To assess the effect of computational functional annotations on the observed divergence results, we repeated the analysis using only sequences with experimentally validated molecular functions (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>). To keep only sequences with validated molecular functions, we manually reviewed published references for enzyme annotations in the BRENDA database (<xref ref-type="bibr" rid="bib15">Chang et al., 2015</xref>), and discarded any functional assignments that were based exclusively on computational or high-throughput studies. After filtering for the experimentally validated annotations, we only considered EC numbers corresponding to pairs of orthologs with at least four different divergence times distributed across 4 billion years.</p></sec><sec id="s4-3"><title>Calculation of the divergence rate</title><p>Based on Model 3, we determined the divergence rate, that is, the rate of the decrease in sequence identity per time, at a given divergence time <italic>t</italic> by solving for the derivative of <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> with respect to time:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mn>100</mml:mn><mml:mi>*</mml:mi><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>*</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo> <mml:mi/><mml:mo>-</mml:mo><mml:mn>100</mml:mn><mml:mi>*</mml:mi><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>*</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula>where <italic>y</italic> represents global sequence identity, <italic>t</italic> represents divergence time, <italic>R<sub>0</sub></italic> represents the average substitution rate, and α represents the shape parameter of the gamma distribution.</p></sec><sec id="s4-4"><title>Equivalency between model two and a poisson divergence model with allowed back substitutions</title><p>In the Jukes-Cantor model of nucleotide divergence (<xref ref-type="bibr" rid="bib58">Tajima and Nei, 1984</xref>; <xref ref-type="bibr" rid="bib32">Jukes and Cantor, 1969</xref>), the expected number of substitutions per site (δ) between two sequences after a divergence time <italic>t</italic> from a common ancestor is given by:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mfrac><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></disp-formula>where <italic>y</italic> is the proportion of identical sites and <italic>a</italic> is the number of allowed nucleotide types (usually 4). The same model can be applied to the divergence of protein sequences (<xref ref-type="bibr" rid="bib68">Yang et al., 2000</xref>; <xref ref-type="bibr" rid="bib46">Ota and Nei, 1994</xref>), by setting <italic>a</italic> to the number of allowed amino acid types per protein site. Furthermore, δ = 2λ<italic>t</italic>, where λ represents the substitution rate per site per unit time, which is assumed to be equal across all sites. Substituting δ, and solving the above equation for <italic>y</italic> yields:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mi>y</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>λ</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></disp-formula>which is mathematically equivalent to model 2 <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>, with <italic>R<sub>0</sub></italic>=<inline-formula><mml:math id="inf1"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>λ</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula>, and <italic>Y<sub>0</sub></italic> =<inline-formula><mml:math id="inf2"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>. Thus, Y<sub>0</sub> can also be interpreted as the inverse of the average number of amino acids accepted per protein site during protein evolution.</p></sec><sec id="s4-5"><title>FolA competition experiment in <italic>E. coli</italic></title><p>To perform competition experiments we used the EcNR2 strain derived from <italic>E. coli</italic> K12 MG1655. Mutagenesis was performed using Multiplex Automated Genomic Engineering (MAGE), as previously described (<xref ref-type="bibr" rid="bib63">Wang et al., 2009</xref>). 90 bp DNA oligomers were designed around each folA codon using the MG1655 wild type sequence as reference (<xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>). For each codon, all possible nucleotide variants were synthesized. To avoid simultaneous mutations of multiple codons, cells were transformed targeting ten consecutive codons at a time. After four rounds of electroporation, cells were recovered and pooled together at approximately the same concentration based on cell counts. Two competition growth experiments were carried out, one for each half of the protein. For the competition experiments, cells were grown in LB media in a turbidostat while maintaining constant volume and cell density. Samples were taken every 2 hr for a period of 16 hr, spun down, washed in PBS, spun down again and stored at −20°C until all samples were collected. For each competition, the corresponding FolA region was amplified through PCR while assigning a specific DNA barcode for each time point. PCR products were then pooled and paired-end sequenced using the MiSeq Reagent Kit two from Illumina. Sequence reads were deposited to the SRA database with accession number: SRP152339.</p><p>To determine, at each time point, the abundance of each mutant relative to wild type, we joined paired-end reads using SeqPrep (v 1.1) and aligned the joined reads to the folA gene sequence using Bowtie2 (<xref ref-type="bibr" rid="bib37">Langmead and Salzberg, 2012</xref>). We then counted the number of reads per mutant using a custom script (<xref ref-type="bibr" rid="bib49">Plata, 2018</xref>). Reads with more than a single mutated codon were discarded. Counts were median-normalized to control for noise due to mutagenesis performed in batches of 10 codons. At each time point we calculated the ratio <italic>R<sub>t</sub></italic> of mutant to wild type (WT) reads. In exponential growth, the growth rate difference between a given mutant and WT was calculated based on the slope of <inline-formula><mml:math id="inf3"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> as a function of time:<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>*</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></disp-formula>where <italic>m<sub>i</sub></italic> and <italic>m<sub>wt</sub></italic> represent the mutant and WT growth rates, respectively. Growth rate differences were calculated only for mutants with at least five time points with 20 or more reads. Relative growth rates were calculated by dividing the slopes in the equation above by the number of e-fold increases given the average dilution rate of the turbidostat (1.37/h).</p><p>To calculate a single value characterizing the effect of all possible mutations at a protein site, we first averaged the relative growth rates of mutants resulting in the same amino acid change. We then calculated the average fitness effect of mutations at each protein site by averaging across 20 possible amino acids substitutions (<xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>).</p><p>To estimate the sensitivity of our results to sequencing errors, we calculated the average fitness effect of substitutions at each FolA site using the relative growth rates of mutant strains carrying only 32 mutated codons selected at random out of 64 possible codons. We observed a high correlation (Pearson’s r: 0.95, p-value&lt;1e-20, <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>) between the average growth rate effects at each site calculated using two non-overlapping subsets of 32 codons. As expected, nonsense mutations and substitutions in the <italic>folA</italic> start codon had substantially stronger average effects on growth rates compared to other substitutions (26% versus 4% slower growth than WT, respectively. Mann Whitney U, p-value&lt;10<sup>−20</sup>). Also, the relative growth rates due to synonymous codon substitutions were usually very mild (0.2% higher growth compared to WT); 97% of synonymous substitutions had growth effects of less than 3%.</p></sec><sec id="s4-6"><title>Contribution of different sites to the divergence limit</title><p>In order to identify phylogenetically independent pairs of species, we aligned the 16S rRNA gene sequences of bacterial species having orthologs annotated with the target 30 EC numbers (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). 16S rRNA sequences were obtained from the GreenGenes database (<xref ref-type="bibr" rid="bib19">DeSantis et al., 2006</xref>) (October, 2016). We then built maximum likelihood phylogenetic trees based on the 16S alignments using RAxML (<xref ref-type="bibr" rid="bib57">Stamatakis, 2014</xref>). Next, we used the Maximum Pairing Problem approach by<xref ref-type="bibr" rid="bib3">Arnold and Stadler (2010)</xref> to find the largest number of edge-disjoint pairs of species with 16S rRNA genetic distances corresponding to &gt;2 billion years of divergence. Divergence times were estimated from the 16S genetic distances based on the linear regression of literature reported divergence times (<xref ref-type="bibr" rid="bib29">Hedges et al., 2006</xref>) (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). The F84 model of nucleotide substitution implemented in the phylip package (<xref ref-type="bibr" rid="bib22">Felsenstein, 2005</xref>) was used to compute the genetic distances. Using the 16S alignment data, we calculated the probability that a protein site was identical across independent lineages. The probability was calculated as the fraction of orthologous pairs from phylogenetically independent species pairs with identical amino acids at the site. The amino acid identities at a given site were obtained based on the multiple sequence alignment of all orthologs associated with each EC number, obtained using ClustalW2 (<xref ref-type="bibr" rid="bib38">Larkin et al., 2007</xref>). A similar procedure was applied to analyze FolA and InfA orthologs from the COG database (<xref ref-type="fig" rid="fig3">Figure 3c</xref>).</p><p>To investigate the divergence of sites with different fitness effects, we used sequences of FolA and InfA bacterial orthologs from the COG database (<xref ref-type="bibr" rid="bib25">Galperin et al., 2015</xref>). The FolA orthologs annotated with the same EC number in UniProt (n = 311) and the InfA orthologs annotated with the same KEGG Orthology (KO) number in KEGG (n = 514) were used to build multiple sequence alignments with ClustalW2 (<xref ref-type="bibr" rid="bib38">Larkin et al., 2007</xref>). Divergence times were estimated from the 16S genetic distances as described above. Within each divergence bin (<xref ref-type="fig" rid="fig4">Figure 4a,b</xref>), sequence identities of sites with different average fitness effects (represented by different colors in <xref ref-type="fig" rid="fig4">Figure 4a,b</xref>) were averaged across all pairs of orthologs at a given divergence time.</p></sec><sec id="s4-7"><title>Analysis of global protein structural evolution</title><p>To study the divergence of protein structures as a function of time, we obtained PDB codes for all proteins associated with EC numbers in the BRENDA database (<xref ref-type="bibr" rid="bib15">Chang et al., 2015</xref>). We then selected for the analysis species with experimentally solved enzyme structures for at least 10 different EC numbers. Psi-blast searches with a conservative E-value cutoff of 10<sup>−6</sup> were used to identify orthologs (defined as bi-directional best hits) in the selected species. The 3D structures of orthologous pairs, annotated with the same EC number, were aligned using the TM-align program (<xref ref-type="bibr" rid="bib71">Zhang and Skolnick, 2005</xref>) to obtain the C-alpha RMSD values. Pairs of proteins were not considered if more than 70% of the residues of the shortest protein could not be structurally aligned. We also removed from the analysis pairs of structures with flexibility between domains, as they could result in large RMSD values despite significant structural similarity. To identify such proteins we used the FATCAT (<xref ref-type="bibr" rid="bib70">Ye and Godzik, 2003</xref>) software to perform flexible structural alignments of all structure pairs. We then filtered the structural pairs that were split into two or more domains by the FATCAT alignments.</p></sec><sec id="s4-8"><title>Analysis of the enzyme active sites</title><p>To analyze divergence as a function of active site distance we used protein sequences associated with the 64 EC numbers and 22 species considered in <xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>. To that end, PDB (<xref ref-type="bibr" rid="bib9">Berman et al., 2000</xref>) was searched for homologous sequences annotated with the same enzymatic activities and with known 3D structures. Annotations of active site residues for the corresponding structures were obtained from the Catalytic Site Atlas (<xref ref-type="bibr" rid="bib50">Porter, 2004</xref>), PDB and UniProt-KB (<xref ref-type="bibr" rid="bib62">UniProt Consortium, 2015</xref>). For each PDB structure with available active site information, protein sites were then stratified into different layers according to the distance between their alpha carbons and the centroid of the active site residues. Each pair of orthologs was then aligned using ClustalW2 (<xref ref-type="bibr" rid="bib38">Larkin et al., 2007</xref>) with a homolog in PDB annotated with the same activity and with defined distance layers around the active site; the PDB sequence with the highest sequence identity to either member of the pair was used for the alignment. Sequence identities for different layers were calculated based on the structural positions in the corresponding PDB reference sequences.</p></sec><sec id="s4-9"><title>Comparison of pairs of enzymes with the same structural folds</title><p>We used structural classifications of protein domains from the CATH database (v4.2.0) (<xref ref-type="bibr" rid="bib18">Dawson et al., 2017</xref>). For structural comparisons, we only considered PDB structures with a single classified domain per chain. Protein pairs classified in CATH in the same homologous structural superfamily were considered as having the same fold. To obtain pairs of proteins in the same fold but with different functions, we only considered PDB structures annotated with different EC numbers in BRENDA. For this analysis we randomly selected 300 pairs of structures with the same fold that do not share any digits of their EC classification.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We sincerely thank Dan Tawfik, Eugene Koonin, and Fyodor Kondrashov for very helpful discussions. This work was supported in part by the National Institute of General Medical Sciences grants GM079759 and R35GM13188 to DV.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Data curation, Software, Formal analysis, Investigation, Methodology, Writing—original draft</p></fn><fn fn-type="con" id="con2"><p>Data curation, Software, Formal analysis, Investigation, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Investigation, Methodology, Writing—review and editing</p></fn><fn fn-type="con" id="con4"><p>Formal analysis, Investigation, Methodology, Writing—review and editing</p></fn><fn fn-type="con" id="con5"><p>Supervision, Methodology, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Supervision, Funding acquisition, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><object-id pub-id-type="doi">10.7554/eLife.39705.024</object-id><label>Supplementary file 1.</label><caption><title>Considered model species and pairwise average divergence times.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-39705-supp1-v2.docx"/></supplementary-material><supplementary-material id="supp2"><object-id pub-id-type="doi">10.7554/eLife.39705.025</object-id><label>Supplementary file 2.</label><caption><title>Fitted model parameters, statistical test results and non-enzymatic protein annotations.</title><p><xref ref-type="supplementary-material" rid="supp2">Supplementary file 2A</xref> Fitted model parameters and test results for the 64 considered activities (EC numbers). <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2B</xref> Estimated rates of sequence divergence for pairs of orthologs according to Model three fits <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2C</xref> Fitted model parameters and test results for 29 sets of orthologs not annotated with EC numbers <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2D</xref> UniProt annotations of representative sequences from E. coli and H. sapiens for sets of orthologs not annotated with EC numbers <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2E</xref> UniProt annotations of representative sequences from E. coli and H. sapiens for sets of orthologs not annotated with EC numbers and fast divergence rates in eukaryotes.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-39705-supp2-v2.xlsx"/></supplementary-material><supplementary-material id="supp3"><object-id pub-id-type="doi">10.7554/eLife.39705.026</object-id><label>Supplementary file 3.</label><caption><title>Average relative growth rate effect of amino acid substitutions in the FolA protein of <italic>E. coli</italic>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-39705-supp3-v2.xlsx"/></supplementary-material><supplementary-material id="supp4"><object-id pub-id-type="doi">10.7554/eLife.39705.027</object-id><label>Supplementary file 4.</label><caption><title>DNA oligomers used to introduce amino acid substitutions along the FolA protein.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-39705-supp4-v2.xlsx"/></supplementary-material><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.39705.028</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-39705-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Sequence reads were deposited to the SRA database with accession number: SRP152339. Source data files have been provided for figure 1, figure 5, figure 6 and figure 1 supplements 1, 3, 5 and 6.</p><p>The following dataset was generated:</p><p><element-citation id="dataset2" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Konaté</surname><given-names>MM</given-names></name><name><surname>Plata</surname><given-names>G</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Usmanova</surname><given-names>DR</given-names></name><name><surname>Wang</surname><given-names>HH</given-names></name><name><surname>Vitkup</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Molecular function limits divergent protein evolution on planetary timescales</data-title><source>SRA</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/sra/SRP152339">SRP152339</pub-id></element-citation></p><p>The following previously published dataset was used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Eric</surname><given-names>D Kelsic</given-names></name><name><surname>Hattie</surname><given-names>Chung</given-names></name><name><surname>Niv</surname><given-names>Cohen</given-names></name><name><surname>Jimin</surname><given-names>Park</given-names></name><name><surname>Harris</surname><given-names>H Wang</given-names></name><name><surname>Roy</surname><given-names>Kishony</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Data S1</data-title><source>Supplementary material of: https://doi.org/10.1016/j.cels.2016.11.004</source><pub-id assigning-authority="other" pub-id-type="doi">10.1016/j.cels.2016.11.004</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adkar</surname> <given-names>BV</given-names></name><name><surname>Manhart</surname> <given-names>M</given-names></name><name><surname>Bhattacharyya</surname> <given-names>S</given-names></name><name><surname>Tian</surname> <given-names>J</given-names></name><name><surname>Musharbash</surname> <given-names>M</given-names></name><name><surname>Shakhnovich</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Optimization of lag phase shapes the evolution of a bacterial enzyme</article-title><source>Nature Ecology &amp; Evolution</source><volume>1</volume><fpage>149</fpage><pub-id pub-id-type="doi">10.1038/s41559-017-0149</pub-id><pub-id pub-id-type="pmid">28812634</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname> <given-names>SF</given-names></name><name><surname>Madden</surname> <given-names>TL</given-names></name><name><surname>Schäffer</surname> <given-names>AA</given-names></name><name><surname>Zhang</surname> <given-names>J</given-names></name><name><surname>Zhang</surname> <given-names>Z</given-names></name><name><surname>Miller</surname> <given-names>W</given-names></name><name><surname>Lipman</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title><source>Nucleic Acids Research</source><volume>25</volume><fpage>3389</fpage><lpage>3402</lpage><pub-id pub-id-type="doi">10.1093/nar/25.17.3389</pub-id><pub-id pub-id-type="pmid">9254694</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arnold</surname> <given-names>C</given-names></name><name><surname>Stadler</surname> <given-names>PF</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Polynomial algorithms for the maximal pairing problem: efficient phylogenetic targeting on arbitrary trees</article-title><source>Algorithms for Molecular Biology</source><volume>5</volume><fpage>25</fpage><pub-id pub-id-type="doi">10.1186/1748-7188-5-25</pub-id><pub-id pub-id-type="pmid">20525185</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bairoch</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>The ENZYME data bank in 1999</article-title><source>Nucleic Acids Research</source><volume>27</volume><fpage>310</fpage><lpage>311</lpage><pub-id pub-id-type="doi">10.1093/nar/27.1.310</pub-id><pub-id pub-id-type="pmid">9847212</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barreto</surname> <given-names>FS</given-names></name><name><surname>Burton</surname> <given-names>RS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Evidence for compensatory evolution of ribosomal proteins in response to rapid divergence of mitochondrial rRNA</article-title><source>Molecular Biology and Evolution</source><volume>30</volume><fpage>310</fpage><lpage>314</lpage><pub-id pub-id-type="doi">10.1093/molbev/mss228</pub-id><pub-id pub-id-type="pmid">22993236</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Battistuzzi</surname> <given-names>FU</given-names></name><name><surname>Feijao</surname> <given-names>A</given-names></name><name><surname>Hedges</surname> <given-names>SB</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>A genomic timescale of prokaryote evolution: insights into the origin of methanogenesis, Phototrophy, and the colonization of land</article-title><source>BMC Evolutionary Biology</source><volume>4</volume><elocation-id>44</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2148-4-44</pub-id><pub-id pub-id-type="pmid">15535883</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>EA</given-names></name><name><surname>Boehnke</surname> <given-names>P</given-names></name><name><surname>Harrison</surname> <given-names>TM</given-names></name><name><surname>Mao</surname> <given-names>WL</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Potentially biogenic carbon preserved in a 4.1 billion-year-old zircon</article-title><source>PNAS</source><volume>112</volume><fpage>14518</fpage><lpage>14521</lpage><pub-id pub-id-type="doi">10.1073/pnas.1517557112</pub-id><pub-id pub-id-type="pmid">26483481</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benkovic</surname> <given-names>SJ</given-names></name><name><surname>Fierke</surname> <given-names>CA</given-names></name><name><surname>Naylor</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Insights into enzyme function from studies on mutants of dihydrofolate reductase</article-title><source>Science</source><volume>239</volume><fpage>1105</fpage><lpage>1110</lpage><pub-id pub-id-type="doi">10.1126/science.3125607</pub-id><pub-id pub-id-type="pmid">3125607</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname> <given-names>HM</given-names></name><name><surname>Westbrook</surname> <given-names>J</given-names></name><name><surname>Feng</surname> <given-names>Z</given-names></name><name><surname>Gilliland</surname> <given-names>G</given-names></name><name><surname>Bhat</surname> <given-names>TN</given-names></name><name><surname>Weissig</surname> <given-names>H</given-names></name><name><surname>Shindyalov</surname> <given-names>IN</given-names></name><name><surname>Bourne</surname> <given-names>PE</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The protein data bank</article-title><source>Nucleic Acids Research</source><volume>28</volume><fpage>235</fpage><lpage>242</lpage><pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id><pub-id pub-id-type="pmid">10592235</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bershtein</surname> <given-names>S</given-names></name><name><surname>Serohijos</surname> <given-names>AW</given-names></name><name><surname>Bhattacharyya</surname> <given-names>S</given-names></name><name><surname>Manhart</surname> <given-names>M</given-names></name><name><surname>Choi</surname> <given-names>JM</given-names></name><name><surname>Mu</surname> <given-names>W</given-names></name><name><surname>Zhou</surname> <given-names>J</given-names></name><name><surname>Shakhnovich</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Protein homeostasis imposes a barrier on functional integration of horizontally transferred genes in Bacteria</article-title><source>PLOS Genetics</source><volume>11</volume><elocation-id>e1005612</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1005612</pub-id><pub-id pub-id-type="pmid">26484862</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Betts</surname> <given-names>HC</given-names></name><name><surname>Puttick</surname> <given-names>MN</given-names></name><name><surname>Clark</surname> <given-names>JW</given-names></name><name><surname>Williams</surname> <given-names>TA</given-names></name><name><surname>Donoghue</surname> <given-names>PCJ</given-names></name><name><surname>Pisani</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Integrated genomic and fossil evidence illuminates life's early evolution and eukaryote origin</article-title><source>Nature Ecology &amp; Evolution</source><volume>2</volume><fpage>1556</fpage><lpage>1562</lpage><pub-id pub-id-type="doi">10.1038/s41559-018-0644-x</pub-id><pub-id pub-id-type="pmid">30127539</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bork</surname> <given-names>P</given-names></name><name><surname>Sander</surname> <given-names>C</given-names></name><name><surname>Valencia</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Convergent evolution of similar enzymatic function on different protein folds: the hexokinase, ribokinase, and galactokinase families of sugar kinases</article-title><source>Protein Science</source><volume>2</volume><fpage>31</fpage><lpage>40</lpage><pub-id pub-id-type="doi">10.1002/pro.5560020104</pub-id><pub-id pub-id-type="pmid">8382990</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breen</surname> <given-names>MS</given-names></name><name><surname>Kemena</surname> <given-names>C</given-names></name><name><surname>Vlasov</surname> <given-names>PK</given-names></name><name><surname>Notredame</surname> <given-names>C</given-names></name><name><surname>Kondrashov</surname> <given-names>FA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Epistasis as the primary factor in molecular evolution</article-title><source>Nature</source><volume>490</volume><fpage>535</fpage><lpage>538</lpage><pub-id pub-id-type="doi">10.1038/nature11510</pub-id><pub-id pub-id-type="pmid">23064225</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname> <given-names>YH</given-names></name><name><surname>Venev</surname> <given-names>SV</given-names></name><name><surname>Zeldovich</surname> <given-names>KB</given-names></name><name><surname>Matthews</surname> <given-names>CR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Correlation of fitness landscapes from three orthologous TIM barrels originates from sequence and structure constraints</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>14614</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms14614</pub-id><pub-id pub-id-type="pmid">28262665</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname> <given-names>A</given-names></name><name><surname>Schomburg</surname> <given-names>I</given-names></name><name><surname>Placzek</surname> <given-names>S</given-names></name><name><surname>Jeske</surname> <given-names>L</given-names></name><name><surname>Ulbrich</surname> <given-names>M</given-names></name><name><surname>Xiao</surname> <given-names>M</given-names></name><name><surname>Sensen</surname> <given-names>CW</given-names></name><name><surname>Schomburg</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>BRENDA in 2015: exciting developments in its 25th year of existence</article-title><source>Nucleic Acids Research</source><volume>43</volume><fpage>D439</fpage><lpage>D446</lpage><pub-id pub-id-type="doi">10.1093/nar/gku1068</pub-id><pub-id pub-id-type="pmid">25378310</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chothia</surname> <given-names>C</given-names></name><name><surname>Lesk</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>The relation between the divergence of sequence and structure in proteins</article-title><source>The EMBO Journal</source><volume>5</volume><fpage>823</fpage><lpage>826</lpage><pub-id pub-id-type="doi">10.1002/j.1460-2075.1986.tb04288.x</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conant</surname> <given-names>GC</given-names></name><name><surname>Wolfe</surname> <given-names>KH</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Turning a hobby into a job: how duplicated genes find new functions</article-title><source>Nature Reviews Genetics</source><volume>9</volume><fpage>938</fpage><lpage>950</lpage><pub-id pub-id-type="doi">10.1038/nrg2482</pub-id><pub-id pub-id-type="pmid">19015656</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dawson</surname> <given-names>NL</given-names></name><name><surname>Lewis</surname> <given-names>TE</given-names></name><name><surname>Das</surname> <given-names>S</given-names></name><name><surname>Lees</surname> <given-names>JG</given-names></name><name><surname>Lee</surname> <given-names>D</given-names></name><name><surname>Ashford</surname> <given-names>P</given-names></name><name><surname>Orengo</surname> <given-names>CA</given-names></name><name><surname>Sillitoe</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>CATH: an expanded resource to predict protein function through structure and sequence</article-title><source>Nucleic Acids Research</source><volume>45</volume><fpage>D289</fpage><lpage>D295</lpage><pub-id pub-id-type="doi">10.1093/nar/gkw1098</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DeSantis</surname> <given-names>TZ</given-names></name><name><surname>Hugenholtz</surname> <given-names>P</given-names></name><name><surname>Larsen</surname> <given-names>N</given-names></name><name><surname>Rojas</surname> <given-names>M</given-names></name><name><surname>Brodie</surname> <given-names>EL</given-names></name><name><surname>Keller</surname> <given-names>K</given-names></name><name><surname>Huber</surname> <given-names>T</given-names></name><name><surname>Dalevi</surname> <given-names>D</given-names></name><name><surname>Hu</surname> <given-names>P</given-names></name><name><surname>Andersen</surname> <given-names>GL</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Greengenes, a chimera-checked 16S rRNA gene database and workbench compatible with ARB</article-title><source>Applied and Environmental Microbiology</source><volume>72</volume><fpage>5069</fpage><lpage>5072</lpage><pub-id pub-id-type="doi">10.1128/AEM.03006-05</pub-id><pub-id pub-id-type="pmid">16820507</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dickerson</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>The structures of cytochrome c and the rates of molecular evolution</article-title><source>Journal of Molecular Evolution</source><volume>1</volume><fpage>26</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1007/BF01659392</pub-id><pub-id pub-id-type="pmid">4377446</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dokholyan</surname> <given-names>NV</given-names></name><name><surname>Shakhnovich</surname> <given-names>B</given-names></name><name><surname>Shakhnovich</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Expanding protein universe and its origin from the biological big bang</article-title><source>PNAS</source><volume>99</volume><fpage>14132</fpage><lpage>14136</lpage><pub-id pub-id-type="doi">10.1073/pnas.202497999</pub-id><pub-id pub-id-type="pmid">12384571</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Felsenstein</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2005">2005</year><data-title>PHYLIP (Phylogeny inference package) </data-title><version designator="3.6">3.6</version><publisher-loc>Seattle</publisher-loc><publisher-name>University of Washington</publisher-name><ext-link ext-link-type="uri" xlink:href="http://evolution.genetics.washington.edu/phylip.html"><ext-link ext-link-type="uri" xlink:href="http://evolution.genetics.washington.edu/phylip.html">http://evolution.genetics.washington.edu/phylip.html</ext-link></ext-link></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Firnberg</surname> <given-names>E</given-names></name><name><surname>Labonte</surname> <given-names>JW</given-names></name><name><surname>Gray</surname> <given-names>JJ</given-names></name><name><surname>Ostermeier</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A comprehensive, High-Resolution map of a gene's Fitness Landscape</article-title><source>Molecular Biology and Evolution</source><volume>33</volume><elocation-id>1378</elocation-id><pub-id pub-id-type="doi">10.1093/molbev/msw021</pub-id><pub-id pub-id-type="pmid">26912810</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galperin</surname> <given-names>MY</given-names></name><name><surname>Walker</surname> <given-names>DR</given-names></name><name><surname>Koonin</surname> <given-names>EV</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Analogous enzymes: independent inventions in enzyme evolution</article-title><source>Genome Research</source><volume>8</volume><fpage>779</fpage><lpage>790</lpage><pub-id pub-id-type="doi">10.1101/gr.8.8.779</pub-id><pub-id pub-id-type="pmid">9724324</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galperin</surname> <given-names>MY</given-names></name><name><surname>Makarova</surname> <given-names>KS</given-names></name><name><surname>Wolf</surname> <given-names>YI</given-names></name><name><surname>Koonin</surname> <given-names>EV</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Expanded microbial genome coverage and improved protein family annotation in the COG database</article-title><source>Nucleic Acids Research</source><volume>43</volume><fpage>D261</fpage><lpage>D269</lpage><pub-id pub-id-type="doi">10.1093/nar/gku1223</pub-id><pub-id pub-id-type="pmid">25428365</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilson</surname> <given-names>AI</given-names></name><name><surname>Marshall-Christensen</surname> <given-names>A</given-names></name><name><surname>Choi</surname> <given-names>JM</given-names></name><name><surname>Shakhnovich</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The role of evolutionary selection in the dynamics of protein structure evolution</article-title><source>Biophysical Journal</source><volume>112</volume><fpage>1350</fpage><lpage>1365</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2017.02.029</pub-id><pub-id pub-id-type="pmid">28402878</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guy</surname> <given-names>L</given-names></name><name><surname>Ettema</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The archaeal 'TACK' superphylum and the origin of eukaryotes</article-title><source>Trends in Microbiology</source><volume>19</volume><fpage>580</fpage><lpage>587</lpage><pub-id pub-id-type="doi">10.1016/j.tim.2011.09.002</pub-id><pub-id pub-id-type="pmid">22018741</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Halabi</surname> <given-names>N</given-names></name><name><surname>Rivoire</surname> <given-names>O</given-names></name><name><surname>Leibler</surname> <given-names>S</given-names></name><name><surname>Ranganathan</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Protein sectors: evolutionary units of three-dimensional structure</article-title><source>Cell</source><volume>138</volume><fpage>774</fpage><lpage>786</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2009.07.038</pub-id><pub-id pub-id-type="pmid">19703402</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedges</surname> <given-names>SB</given-names></name><name><surname>Dudley</surname> <given-names>J</given-names></name><name><surname>Kumar</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>TimeTree: a public knowledge-base of divergence times among organisms</article-title><source>Bioinformatics</source><volume>22</volume><fpage>2971</fpage><lpage>2972</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btl505</pub-id><pub-id pub-id-type="pmid">17021158</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hubble</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="1929">1929</year><article-title>A relation between distance and radial velocity among extra-galactic nebulae</article-title><source>PNAS</source><volume>15</volume><fpage>168</fpage><lpage>173</lpage><pub-id pub-id-type="doi">10.1073/pnas.15.3.168</pub-id><pub-id pub-id-type="pmid">16577160</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jack</surname> <given-names>BR</given-names></name><name><surname>Meyer</surname> <given-names>AG</given-names></name><name><surname>Echave</surname> <given-names>J</given-names></name><name><surname>Wilke</surname> <given-names>CO</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Functional sites induce Long-Range evolutionary constraints in enzymes</article-title><source>PLOS Biology</source><volume>14</volume><elocation-id>e1002452</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002452</pub-id><pub-id pub-id-type="pmid">27138088</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Jukes</surname> <given-names>TH</given-names></name><name><surname>Cantor</surname> <given-names>CR</given-names></name></person-group><year iso-8601-date="1969">1969</year><chapter-title>Evolution of Protein Molecules</chapter-title><person-group person-group-type="editor"><name><surname>Munro</surname> <given-names>H. N</given-names></name></person-group><source>Mammalian Protein Metabolism</source><publisher-name>Academic Press</publisher-name><fpage>21</fpage><lpage>132</lpage></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanehisa</surname> <given-names>M</given-names></name><name><surname>Sato</surname> <given-names>Y</given-names></name><name><surname>Kawashima</surname> <given-names>M</given-names></name><name><surname>Furumichi</surname> <given-names>M</given-names></name><name><surname>Tanabe</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>KEGG as a reference resource for gene and protein annotation</article-title><source>Nucleic Acids Research</source><volume>44</volume><fpage>D457</fpage><lpage>D462</lpage><pub-id pub-id-type="doi">10.1093/nar/gkv1070</pub-id><pub-id pub-id-type="pmid">26476454</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelsic</surname> <given-names>ED</given-names></name><name><surname>Chung</surname> <given-names>H</given-names></name><name><surname>Cohen</surname> <given-names>N</given-names></name><name><surname>Park</surname> <given-names>J</given-names></name><name><surname>Wang</surname> <given-names>HH</given-names></name><name><surname>Kishony</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>RNA structural determinants of optimal codons revealed by MAGE-Seq</article-title><source>Cell Systems</source><volume>3</volume><fpage>563</fpage><lpage>571</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2016.11.004</pub-id><pub-id pub-id-type="pmid">28009265</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kristensen</surname> <given-names>DM</given-names></name><name><surname>Kannan</surname> <given-names>L</given-names></name><name><surname>Coleman</surname> <given-names>MK</given-names></name><name><surname>Wolf</surname> <given-names>YI</given-names></name><name><surname>Sorokin</surname> <given-names>A</given-names></name><name><surname>Koonin</surname> <given-names>EV</given-names></name><name><surname>Mushegian</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A low-polynomial algorithm for assembling clusters of orthologous groups from intergenomic symmetric best matches</article-title><source>Bioinformatics</source><volume>26</volume><fpage>1481</fpage><lpage>1487</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq229</pub-id><pub-id pub-id-type="pmid">20439257</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ku</surname> <given-names>C</given-names></name><name><surname>Nelson-Sathi</surname> <given-names>S</given-names></name><name><surname>Roettger</surname> <given-names>M</given-names></name><name><surname>Sousa</surname> <given-names>FL</given-names></name><name><surname>Lockhart</surname> <given-names>PJ</given-names></name><name><surname>Bryant</surname> <given-names>D</given-names></name><name><surname>Hazkani-Covo</surname> <given-names>E</given-names></name><name><surname>McInerney</surname> <given-names>JO</given-names></name><name><surname>Landan</surname> <given-names>G</given-names></name><name><surname>Martin</surname> <given-names>WF</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Endosymbiotic origin and differential loss of eukaryotic genes</article-title><source>Nature</source><volume>524</volume><fpage>427</fpage><lpage>432</lpage><pub-id pub-id-type="doi">10.1038/nature14963</pub-id><pub-id pub-id-type="pmid">26287458</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname> <given-names>B</given-names></name><name><surname>Salzberg</surname> <given-names>SL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Fast gapped-read alignment with bowtie 2</article-title><source>Nature Methods</source><volume>9</volume><fpage>357</fpage><lpage>359</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id><pub-id pub-id-type="pmid">22388286</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larkin</surname> <given-names>MA</given-names></name><name><surname>Blackshields</surname> <given-names>G</given-names></name><name><surname>Brown</surname> <given-names>NP</given-names></name><name><surname>Chenna</surname> <given-names>R</given-names></name><name><surname>McGettigan</surname> <given-names>PA</given-names></name><name><surname>McWilliam</surname> <given-names>H</given-names></name><name><surname>Valentin</surname> <given-names>F</given-names></name><name><surname>Wallace</surname> <given-names>IM</given-names></name><name><surname>Wilm</surname> <given-names>A</given-names></name><name><surname>Lopez</surname> <given-names>R</given-names></name><name><surname>Thompson</surname> <given-names>JD</given-names></name><name><surname>Gibson</surname> <given-names>TJ</given-names></name><name><surname>Higgins</surname> <given-names>DG</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Clustal W and clustal X version 2.0</article-title><source>Bioinformatics</source><volume>23</volume><fpage>2947</fpage><lpage>2948</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btm404</pub-id><pub-id pub-id-type="pmid">17846036</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>D</given-names></name><name><surname>Redfern</surname> <given-names>O</given-names></name><name><surname>Orengo</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Predicting protein function from sequence and structure</article-title><source>Nature Reviews Molecular Cell Biology</source><volume>8</volume><fpage>995</fpage><lpage>1005</lpage><pub-id pub-id-type="doi">10.1038/nrm2281</pub-id><pub-id pub-id-type="pmid">18037900</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lehninger</surname> <given-names>AL</given-names></name><name><surname>Nelson</surname> <given-names>DL</given-names></name><name><surname>Cox</surname> <given-names>MM</given-names></name></person-group><year iso-8601-date="2013">2013</year><source>Lehninger Principles of Biochemistry</source><edition>6th Edition</edition><publisher-loc>New York</publisher-loc><publisher-name>W.H. Freeman</publisher-name></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lunzer</surname> <given-names>M</given-names></name><name><surname>Golding</surname> <given-names>GB</given-names></name><name><surname>Dean</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Pervasive cryptic epistasis in molecular evolution</article-title><source>PLOS Genetics</source><volume>6</volume><elocation-id>e1001162</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1001162</pub-id><pub-id pub-id-type="pmid">20975933</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer</surname> <given-names>TE</given-names></name><name><surname>Cusanovich</surname> <given-names>MA</given-names></name><name><surname>Kamen</surname> <given-names>MD</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Evidence against use of bacterial amino acid sequence data for construction of all-inclusive phylogenetic trees</article-title><source>PNAS</source><volume>83</volume><fpage>217</fpage><lpage>220</lpage><pub-id pub-id-type="doi">10.1073/pnas.83.2.217</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murzin</surname> <given-names>AG</given-names></name><name><surname>Brenner</surname> <given-names>SE</given-names></name><name><surname>Hubbard</surname> <given-names>T</given-names></name><name><surname>Chothia</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures</article-title><source>Journal of Molecular Biology</source><volume>247</volume><fpage>536</fpage><lpage>540</lpage><pub-id pub-id-type="doi">10.1016/S0022-2836(05)80134-2</pub-id><pub-id pub-id-type="pmid">7723011</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Malley-James</surname> <given-names>JT</given-names></name><name><surname>Cockell</surname> <given-names>CS</given-names></name><name><surname>Greaves</surname> <given-names>JS</given-names></name><name><surname>Raven</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Swansong biospheres II: the final signs of life on terrestrial planets near the end of their habitable lifetimes</article-title><source>International Journal of Astrobiology</source><volume>13</volume><fpage>229</fpage><lpage>243</lpage><pub-id pub-id-type="doi">10.1017/S1473550413000426</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Omelchenko</surname> <given-names>MV</given-names></name><name><surname>Galperin</surname> <given-names>MY</given-names></name><name><surname>Wolf</surname> <given-names>YI</given-names></name><name><surname>Koonin</surname> <given-names>EV</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Non-homologous isofunctional enzymes: A systematic analysis of alternative solutions in enzyme evolution</article-title><source>Biology Direct</source><volume>5</volume><elocation-id>31</elocation-id><pub-id pub-id-type="doi">10.1186/1745-6150-5-31</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ota</surname> <given-names>T</given-names></name><name><surname>Nei</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Estimation of the number of amino acid substitutions per site when the substitution rate varies among sites</article-title><source>Journal of Molecular Evolution</source><volume>38</volume><fpage>642</fpage><lpage>643</lpage><pub-id pub-id-type="doi">10.1007/BF00175885</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parfrey</surname> <given-names>LW</given-names></name><name><surname>Lahr</surname> <given-names>DJ</given-names></name><name><surname>Knoll</surname> <given-names>AH</given-names></name><name><surname>Katz</surname> <given-names>LA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Estimating the timing of early eukaryotic diversification with multigene molecular clocks</article-title><source>PNAS</source><volume>108</volume><fpage>13624</fpage><lpage>13629</lpage><pub-id pub-id-type="doi">10.1073/pnas.1110633108</pub-id><pub-id pub-id-type="pmid">21810989</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pingoud</surname> <given-names>A</given-names></name><name><surname>Wilson</surname> <given-names>GG</given-names></name><name><surname>Wende</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Type II restriction endonucleases--a historical perspective and more</article-title><source>Nucleic Acids Research</source><volume>42</volume><fpage>7489</fpage><lpage>7527</lpage><pub-id pub-id-type="doi">10.1093/nar/gku447</pub-id><pub-id pub-id-type="pmid">24878924</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Plata</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Count-MAGE-Seq</data-title><source>GitHub</source><version designator="4f827f6">4f827f6</version><ext-link ext-link-type="uri" xlink:href="https://github.com/platyias/count-MAGE-seq"><italic>https://github.com/platyias/count-MAGE-seq</italic></ext-link></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Porter</surname> <given-names>CT</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The catalytic site atlas: a resource of catalytic sites and residues identified in enzymes using structural data</article-title><source>Nucleic Acids Research</source><volume>32</volume><fpage>129D</fpage><lpage>133</lpage><pub-id pub-id-type="doi">10.1093/nar/gkh028</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Povolotskaya</surname> <given-names>IS</given-names></name><name><surname>Kondrashov</surname> <given-names>FA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Sequence space and the ongoing expansion of the protein universe</article-title><source>Nature</source><volume>465</volume><fpage>922</fpage><lpage>926</lpage><pub-id pub-id-type="doi">10.1038/nature09105</pub-id><pub-id pub-id-type="pmid">20485343</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rost</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Protein structures sustain evolutionary drift</article-title><source>Folding and Design</source><volume>2</volume><fpage>S19</fpage><lpage>S24</lpage><pub-id pub-id-type="doi">10.1016/S1359-0278(97)00059-X</pub-id><pub-id pub-id-type="pmid">9218962</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rost</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Enzyme function less conserved than anticipated</article-title><source>Journal of Molecular Biology</source><volume>318</volume><fpage>595</fpage><lpage>608</lpage><pub-id pub-id-type="doi">10.1016/S0022-2836(02)00016-5</pub-id><pub-id pub-id-type="pmid">12051862</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shendure</surname> <given-names>J</given-names></name><name><surname>Akey</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The origins, determinants, and consequences of human mutations</article-title><source>Science</source><volume>349</volume><fpage>1478</fpage><lpage>1483</lpage><pub-id pub-id-type="doi">10.1126/science.aaa9119</pub-id><pub-id pub-id-type="pmid">26404824</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheridan</surname> <given-names>PP</given-names></name><name><surname>Freeman</surname> <given-names>KH</given-names></name><name><surname>Brenchley</surname> <given-names>JE</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Estimated minimal divergence times of the major bacterial and archaeal phyla</article-title><source>Geomicrobiology Journal</source><volume>20</volume><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1080/01490450303891</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spang</surname> <given-names>A</given-names></name><name><surname>Saw</surname> <given-names>JH</given-names></name><name><surname>Jørgensen</surname> <given-names>SL</given-names></name><name><surname>Zaremba-Niedzwiedzka</surname> <given-names>K</given-names></name><name><surname>Martijn</surname> <given-names>J</given-names></name><name><surname>Lind</surname> <given-names>AE</given-names></name><name><surname>van Eijk</surname> <given-names>R</given-names></name><name><surname>Schleper</surname> <given-names>C</given-names></name><name><surname>Guy</surname> <given-names>L</given-names></name><name><surname>Ettema</surname> <given-names>TJG</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Complex archaea that bridge the gap between prokaryotes and eukaryotes</article-title><source>Nature</source><volume>521</volume><fpage>173</fpage><lpage>179</lpage><pub-id pub-id-type="doi">10.1038/nature14447</pub-id><pub-id pub-id-type="pmid">25945739</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stamatakis</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title><source>Bioinformatics</source><volume>30</volume><fpage>1312</fpage><lpage>1313</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu033</pub-id><pub-id pub-id-type="pmid">24451623</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tajima</surname> <given-names>F</given-names></name><name><surname>Nei</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Estimation of evolutionary distance between nucleotide sequences</article-title><source>Molecular Biology and Evolution</source><volume>1</volume><fpage>269</fpage><lpage>285</lpage><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a040317</pub-id><pub-id pub-id-type="pmid">6599968</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tatusov</surname> <given-names>RL</given-names></name><name><surname>Koonin</surname> <given-names>EV</given-names></name><name><surname>Lipman</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>A genomic perspective on protein families</article-title><source>Science</source><volume>278</volume><fpage>631</fpage><lpage>637</lpage><pub-id pub-id-type="doi">10.1126/science.278.5338.631</pub-id><pub-id pub-id-type="pmid">9381173</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thiergart</surname> <given-names>T</given-names></name><name><surname>Landan</surname> <given-names>G</given-names></name><name><surname>Schenk</surname> <given-names>M</given-names></name><name><surname>Dagan</surname> <given-names>T</given-names></name><name><surname>Martin</surname> <given-names>WF</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>An evolutionary network of genes present in the eukaryote common ancestor polls genomes on eukaryotic and mitochondrial origin</article-title><source>Genome Biology and Evolution</source><volume>4</volume><fpage>466</fpage><lpage>485</lpage><pub-id pub-id-type="doi">10.1093/gbe/evs018</pub-id><pub-id pub-id-type="pmid">22355196</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname> <given-names>W</given-names></name><name><surname>Skolnick</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>How well is enzyme function conserved as a function of pairwise sequence identity?</article-title><source>Journal of Molecular Biology</source><volume>333</volume><fpage>863</fpage><lpage>882</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2003.08.057</pub-id><pub-id pub-id-type="pmid">14568541</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>UniProt Consortium</collab></person-group><year iso-8601-date="2015">2015</year><article-title>UniProt: a hub for protein information</article-title><source>Nucleic Acids Research</source><volume>43</volume><fpage>D204</fpage><lpage>D212</lpage><pub-id pub-id-type="doi">10.1093/nar/gku989</pub-id><pub-id pub-id-type="pmid">25348405</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>HH</given-names></name><name><surname>Isaacs</surname> <given-names>FJ</given-names></name><name><surname>Carr</surname> <given-names>PA</given-names></name><name><surname>Sun</surname> <given-names>ZZ</given-names></name><name><surname>Xu</surname> <given-names>G</given-names></name><name><surname>Forest</surname> <given-names>CR</given-names></name><name><surname>Church</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Programming cells by multiplex genome engineering and accelerated evolution</article-title><source>Nature</source><volume>460</volume><fpage>894</fpage><lpage>898</lpage><pub-id pub-id-type="doi">10.1038/nature08187</pub-id><pub-id pub-id-type="pmid">19633652</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watson</surname> <given-names>JD</given-names></name><name><surname>Laskowski</surname> <given-names>RA</given-names></name><name><surname>Thornton</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Predicting protein function from sequence and structural data</article-title><source>Current Opinion in Structural Biology</source><volume>15</volume><fpage>275</fpage><lpage>284</lpage><pub-id pub-id-type="doi">10.1016/j.sbi.2005.04.003</pub-id><pub-id pub-id-type="pmid">15963890</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>CA</given-names></name><name><surname>Kreychman</surname> <given-names>J</given-names></name><name><surname>Gerstein</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Assessing annotation transfer for genomics: quantifying the relations between protein sequence, structure and function through traditional and probabilistic scores</article-title><source>Journal of Molecular Biology</source><volume>297</volume><fpage>233</fpage><lpage>249</lpage><pub-id pub-id-type="doi">10.1006/jmbi.2000.3550</pub-id><pub-id pub-id-type="pmid">10704319</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Worth</surname> <given-names>CL</given-names></name><name><surname>Gong</surname> <given-names>S</given-names></name><name><surname>Blundell</surname> <given-names>TL</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Structural and functional constraints in the evolution of protein families</article-title><source>Nature Reviews Molecular Cell Biology</source><volume>10</volume><fpage>709</fpage><lpage>720</lpage><pub-id pub-id-type="doi">10.1038/nrm2762</pub-id><pub-id pub-id-type="pmid">19756040</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname> <given-names>M</given-names></name><name><surname>Scott</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Phylogenomic analysis of bacterial and archaeal sequences with AMPHORA2</article-title><source>Bioinformatics</source><volume>28</volume><fpage>1033</fpage><lpage>1034</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts079</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>Z</given-names></name><name><surname>Nielsen</surname> <given-names>R</given-names></name><name><surname>Goldman</surname> <given-names>N</given-names></name><name><surname>Pedersen</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Codon-substitution models for heterogeneous selection pressure at amino acid sites</article-title><source>Genetics</source><volume>155</volume><fpage>431</fpage><lpage>449</lpage><pub-id pub-id-type="pmid">10790415</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>Z</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Computational Molecular Evolution</source><publisher-loc>Oxford</publisher-loc><publisher-name>Oxford University Press</publisher-name></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ye</surname> <given-names>Y</given-names></name><name><surname>Godzik</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Flexible structure alignment by chaining aligned fragment pairs allowing twists</article-title><source>Bioinformatics</source><volume>19 Suppl 2</volume><fpage>ii246</fpage><lpage>ii255</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btg1086</pub-id><pub-id pub-id-type="pmid">14534198</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Skolnick</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>TM-align: a protein structure alignment algorithm based on the TM-score</article-title><source>Nucleic Acids Research</source><volume>33</volume><fpage>2302</fpage><lpage>2309</lpage><pub-id pub-id-type="doi">10.1093/nar/gki524</pub-id><pub-id pub-id-type="pmid">15849316</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zuckerkandl</surname> <given-names>E</given-names></name><name><surname>Pauling</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="1965">1965</year><chapter-title>Evolutionary Divergence and Convergence in Proteins</chapter-title><person-group person-group-type="editor"><name><surname>Bryson</surname> <given-names>V</given-names></name><name><surname>Vogel</surname> <given-names>H. J</given-names></name></person-group><source>Evolving Genes and Proteins</source><publisher-name>Academic Press</publisher-name><fpage>97</fpage><lpage>166</lpage></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.39705.034</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Ben-Tal</surname><given-names>Nir</given-names></name><role>Reviewing Editor</role><aff><institution>Tel Aviv University</institution><country>Israel</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Ben-Tal</surname><given-names>Nir</given-names> </name><role>Reviewer</role><aff><institution>Tel Aviv University</institution><country>Israel</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter, peer reviews, and accompanying author responses.</p></boxed-text><p>[<bold>Editorial note:</bold> This article has been through an editorial process in which the authors decide how to respond to the issues raised during peer review. The Reviewing Editor's assessment is that all the issues have been addressed.]</p><p>Thank you for submitting your article &quot;Molecular function limits divergent protein evolution on planetary timescales&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Nir Ben-Tal as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Diethard Tautz as the Senior Editor. The other reviewers remain anonymous.</p><p>The Reviewing Editor has highlighted the concerns that require revision and/or responses, and we have included the separate reviews below for your consideration. If you have any questions, please do not hesitate to contact us.</p><p>Summary:</p><p>The manuscript analyzes clusters of orthologue enzymes of the same function, defined as sharing the same 4-digits EC number, to examine the limitation of function preservation on evolutionary divergence. The results seem to indicate that function confines divergence, which is not surprising. The potential novelty here is the time dependence of the process, where phylogenetic time of species divergence is used as natural time scale &quot;clock&quot;. The data shows that proteins diverse from each other rapidly during the first ~1.5 billion years, but saturate after that.</p><p>Opinion: The manuscript addresses an important and interesting topic, but it should be revised significantly to clarify what exactly was computed and why, what was measured and why, and how the results are related to previous studies. In view of the amount and nature of the issues raised, the authors should consider withdrawing the manuscript.</p><p>Major concerns:</p><p>(pretty much copy-pasted from the individual reports)</p><p>1) This study poses the question about the extent to which function constrains sequence divergence. The answer given is that for orthologous enzymes 25% sequence identity is the approximate limit. The major critique, is that the authors did not make an attempt to provide a clear mechanistic explanation for such phenomenon. Is it simply because a significant fraction of positions is invariant? Is it because there are various constraints on various sites? Is it because only a small subsets of amino acids are tolerated at some sites? Why not take several enzyme families with very thick alignments and analyze them position-by-position to shed light on this question? Without such deep analysis, the paper, while interesting in its general idea, reads superficial and underdeveloped, despite some experimental results.</p><p>2) The authors premise their study on the assertion made by Rost in a 1997 review that proteins of the same fold can diverge up to random sequence ID of 3-5%, i.e., that structural similarity does not impose constraint on sequence ID. As a consequence the authors attribute in their analysis all sequence identity constraints to functional similarity. However, this premise is highly problematic. While anecdotally one can find two proteins of similar fold with very low sequence ID, typically proteins with similar structure (not necessarily orthologues) have sequence ID at or above 25% – this is the essence of the famous cusp in sequence-structure relationship first reported by Lesk and Chothia in the eighties. In fact a careful analysis of structural/stability constraints on sequence divergence has been published in recent paper (Biophys J v.112, p.1350-65, 2017) where it was shown that in divergent evolution scenario protein structure is maintained up to 25-30% sequence ID and quickly deteriorates beyond that. Incidentally it is very close to 25% ID which the authors claim to stem from functional constraints. Furthermore, the above mentioned BJ paper presents a detailed analytical estimate of sequence divergence dynamics akin to exponential fits used in this PAPER. The authors should make themselves familiar with this theory and consider using it to fit their divergence curves rather than ad hoc exponential fits.</p><p>3) The high throughput experimental data is potentially interesting but its description is so cryptic and incomplete that it is very hard to assess what actually has been done there. In particular there is no assessment of noise in deep sequencing to assess fitness, of the effects of synonymous substitutions, etc. How is the data binned and why binning? The use of LB as a medium for the folA experiment is unfortunate because in LB DHFR is much less essential than in minimal media and therefore the results could be skewed by very permissive conditions. In addition the standing genetic variation is not taken into account – fitness effects could be a result of hitchhiking (i.e. originate from the variation of the background into which the mutations are introduced). These concerns aside, it is not entirely clear what does comparison with experiment tell us beyond the obvious that sites where deleterious fitness effects are greatest evolve more slowly. Was the sole purpose of the experiment to bin positions by their fitness effects? If so, what new insight is gained from slower divergence of sites with more profound fitness effects compared to faster divergence of sites that are more tolerant to substitutions in experiments. Isn't this effect expected? Maybe quantification of the effect may have some novelty, but such quantification has not been done. The obvious thing to do is to compare their alleged fitness effects with dN/dS assessment for the rates but that has not been done.</p><p>4) The word &quot;protein&quot; should be replaced with &quot;enzyme&quot; in the title. &quot;We focused on enzymes because their molecular function is usually well defined,&quot; doesn't sound quite true. Reading the manuscript, it seems that the goal of this work is to investigate divergence of enzymes. The divergence of non-enzymes will most likely follow a different pattern and will generally be much lower than 25% identity. If the authors want to generalize to non-enzymes, they need to perform appropriate analyses. Currently, only one experiment is dedicated to a non-enzyme. It is not fair to the readers to generalize beyond the scope of analysis that was carried out.</p><p>5) The sentence in the Abstract &quot;divergence rates of orthologous enzymes decrease substantially after ~1-2 billion years of independent evolution&quot; is confusing. &quot;Rate&quot; means number of amino acid substitutions per site per unit of time. Moreover, the authors write in the Introduction &quot;a divergence limit does not imply that the rate of amino acid substitutions slows down in evolution,&quot; thus contradicting the Abstract. The Abstract should be edited and the misleading sentence corrected. From the context of the paper is seems like by &quot;divergence rate&quot; the author mean the rate of decrease in pairwise sequence identity with time. This definition poses additional question. This &quot;divergence rate&quot; will always decrease due to multiple and back substitutions and it is trivial. The authors need to make it clear that what they mean goes beyond a trivial curvilinear relationship between time and sequence identity.</p><p>6) Further on this, evolutionary rate is much more than simply a count of changes in the identity of the amino acids. To measure it properly one needs to rely on the phylogeny. Indeed, since the study is based on several clusters of orthologous proteins, why not do just that? For example, why not use the dN/dS formalism?</p><p>7) &quot;billion years of evolution, we observed a significant decrease in mutual divergence rates,&quot; see item 5 above. Also, shouldn't &quot;significant&quot; be quantified is some way?</p><p>8) &quot;Species' divergence times were used to estimate the times of divergence between corresponding orthologous proteins&quot;: How reliable is this time estimate?</p><p>9) Discussion &quot;The presented results demonstrate that, in contrast to proteins with the same fold [Rost, 1997], the requirement to maintain the same molecular function significantly constrains the long-term divergence of protein orthologs&quot;: This difference is surprising. Maybe it has to do with how changes were estimated in the two studies? To state it with confidence direct comparison is needed, where the exact same methodology is used.</p><p>10) Finally, the manuscript should be edited for clarity by a professional scientific editor.</p><p>Separate reviews (please respond to each point):</p><p><italic>Reviewer #1:</italic> </p><p>Summary of paper:</p><p>The manuscript analyzes clusters of orthologue enzymes of the same function, defined as sharing the same 4-digits EC number, to examine the limitation of function preservation on evolutionary divergence. The results seem to indicate that function confines divergence, which is anticipated- perhaps also shown before. The potential novelty here is the time dependence of the process. The data shows (to the best of my understanding) that proteins diverse from each other rapidly during the first ~1.5 billion years, but saturate after that. The data further suggests (again, assuming that I understood correctly) that the rapid evolutionary phase mostly reflects random drift, i.e., amino acid sites that can freely mutate, and that the saturation value reflects their relative fraction of the entire enzyme sequence.</p><p>Opinion: The manuscript could be important but it should be revised significantly to clarify what exactly was computed and why, what was measured and why, and how the results are related to previous studies. I also believe the manuscript should be edited for clarity by a professional scientific editor.</p><p>Major issues:</p><p>1) Results &quot;In the first model, all protein sites have equal and independent substitution rates; see Equation 1&quot;: Equation 1 obviously represents an unrealistic evolutionary model because it is well known that the evolutionary rates are not equal at all amino acid sites. For example, catalytic residues hardly change.</p><p>2) Where does Equation 2 come from? It also doesn't look particularly realistic.</p><p>3) Equation 3 is the commonly used evolutionary model I think. So why not start with it?</p><p>4) &quot;Species' divergence times were used to estimate the times of divergence</p><p>between corresponding orthologous proteins&quot;: How reliable is this time estimate?</p><p>5) Figure 2: How is &quot;fitness cost&quot; defined?</p><p>6) &quot;phylogenetically independent pairs of species&quot;: What does it mean and how is &quot;independent&quot; defined? Is the pair A-B in Figure 3A phylogenetically independent? And the pair D-H?</p><p>7) &quot;Notably, the probability that a protein site is identical, and thus contributes to the divergence limit, first increases linearly with increasing fitness effects at the site, and then begins to saturate for sites with high (&gt;30%) fitness effects (Figure 3B).&quot; This is perhaps true for FolA but I do not see saturation for InfA.</p><p>8) The distributions of the probability of identical sites in FolA and InfA (Figures 4A and B) are very different, but they are discussed together without reference to the difference.</p><p>9) Discussion &quot;The presented results demonstrate that, in contrast to proteins with the same fold [Rost, 1997], the requirement to maintain the same molecular function significantly constrains the long-term divergence of protein orthologs&quot;: I am surprised about this difference. Maybe it has to do with how changes were estimated in the two studies? To state it with confidence I would have liked to see direct comparison where the exact same methodology is used.</p><p>10) Evolutionary rate is much more than simply a count of changes in the identity of the amino acids. To measure it properly one needs to rely on the phylogeny. Indeed, since the study is based on several clusters of orthologous proteins, why not do just that?</p><p><italic>Reviewer #2:</italic> </p><p>This study poses the question about the extent to which function constrains sequence divergence. The answer given is that for orthologous enzymes 25% sequence identity is the approximate limit. The major critique, is that the authors did not make an attempt to provide a clear mechanistic explanation for such phenomenon. Is it simply because a significant fraction of positions is invariant? Is it because there are various constraints on various sites? Is it because only a small subsets of amino acids are tolerated at some sites? Why not take several enzyme families with very thick alignments and analyze them position-by-position to shed light on this question? Without such deep analysis, the paper, while interesting in its general idea, reads superficial and underdeveloped, despite some experimental results.</p><p>1) I suggest replacing the word &quot;protein&quot; with &quot;enzyme&quot; in the title. &quot;We focused on enzymes because their molecular function is usually well defined,&quot; doesn't sound quite true. Reading the manuscript, it seems that the goal of this work is to investigate divergence of enzymes. I am positive that the divergence of non-enzymes will follow a different pattern and will generally be much lower than 25% identity. If the authors want to generalize to non-enzymes, they need to perform appropriate analyses. Currently, only one experiment is dedicated to a non-enzyme. It is not fair to the readers to generalize beyond the scope of analysis that was carried out.</p><p>2) I think that the sentence in the Abstract &quot;divergence rates of orthologous enzymes decrease substantially after ~1-2 billion years of independent evolution&quot; is confusing. &quot;Rate&quot; usually means number of amino acid substitutions per site per unit of time. Moreover, the authors write in the Introduction &quot;a divergence limit does not imply that the rate of amino acid substitutions slows down in evolution,&quot; thus contradicting the Abstract. I suggest to edit the Abstract and correct the misleading sentence. From the context of the paper is seems like by &quot;divergence rate&quot; the author mean the rate of decrease in pairwise sequence identity with time. This definition poses additional question. This &quot;divergence rate&quot; will always decrease due to multiple and back substitutions and it is trivial. The authors need to make it clear that what they mean goes beyond a +trivial curvilinear relationship between time and sequence identity.</p><p>3) &quot;billion years of evolution, we observed a significant decrease in mutual divergence rates,&quot; see item 2 above. Also, shouldn't &quot;significant&quot; be quantified is some way?</p><p>4) It was not made clear why these experiments were performed and how they integrate with the rest of the study. Addition of these experiments seems preliminary and no confident conclusions follow. Was the sole purpose of the experiment to bin positions by their fitness effects? If so, what new insight is gained from slower divergence of sites with more profound fitness effects compared to faster divergence of sites that are more tolerant to substitutions in experiments. Isn't this effect expected? Maybe quantification of the effect may have some novelty, but such quantification has not been done.</p><p><italic>Reviewer #3:</italic> </p><p>In this paper the authors aim to assess how does the requirement of conserved function (i.e. orthology) constraints sequence evolution. The author premise their study on the assertion made by Rost in 1997 review that proteins of the same fold can diverge up to random sequence ID of 3-5% i.e. that structural similarity does not impose constraint on sequence ID. As a consequence the authors attribute in their analysis all sequence identity constraints to functional similarity. To that end they analyze sequence divergence of orthologs using phylogenetic time of species divergence as natural time scale &quot;clock&quot;. They observed saturating time dependencies of sequence divergence with time and conclude that the rate of sequence divergence decreases with decreasing divergence time. Further, they carried out a high throughput mutational experiment on fitness effects of substitutions in 2 genes – folA and InfA – in <italic>E. coli</italic> and find, perhaps unsurprisingly, that sites where mutational effects on fitness are stronger are less constrained in evolution.</p><p>While the paper contains some interesting bioinformatics observations and analysis I have serious concerns about its premise and interpretation of the results. Apparently some issues stem from author's apparent gaps in knowledge of modern literature on biophysical determinants of protein evolution.</p><p>1) The premise that structural similarity does not constraint sequence identity is highly problematic. While anecdotally one can find two proteins of similar fold with very small sequence ID typically proteins with similar structure (not necessarily orthologues) have sequence ID at or above 25% – this is the essence of the famous cusp in sequence-structure relationship first reported by Lesk and Chothia in the eighties. In fact a careful analysis of structural/stability constraints on sequence divergence has been published in recent paper (Biophys J v.112, p.1350-65 (2017) where it was shown that in <italic>divergent</italic> evolution scenario protein structure is maintained up to 25-30% sequence ID and quickly deteriorates beyond that. Incidentally it is very close to 25% ID which the authors claim to stem from functional constraints Furthermore, the above mentioned BJ paper presents a detailed analytical estimate of sequence divergence dynamics akin to exponential fits used in this PAPER. The authors should make themselves familiar with this theory and use it to for their divergence curves rather ad hoc exponential fits.</p><p>2) The high throughput experimental data is potentially interesting but its description is so cryptic and incomplete that it is very hard to assess what actually has been done there. In particular there is no assessment of noise in deep sequencing to assess fitness., of the effects of synonymous substitutions etc. How is the data binned and why binning? The use of LB as a medium for the folA experiment is unfortunate because in LB DHFR is much less essential than in minimal media and therefore the results could be skewed by very permissive conditions. In addition the standing genetic variation is not taken into account – fitness effects could be a result of hitchhiking (i.e. originate from the variation of the background into which the mutations are introduced).These concerns aside, it is not entirely clear what does comparison with experiment tell us beyond the obvious that sites where deleterious fitness effects are greatest evolve more slowly. The obvious thing to do is to compare their alleged fitness effects with dN/dS assessment of the rates but that has not been done.</p><p>3) The interpretation of the experimental fitness effects in terms of function is also questionable. The authors are apparently unaware of series of experimental works from Shakhnovich lab where determinants of fitness effects of mutations are addressed. In particular it has been shown using both point mutations and orthologous chromosomal replacements for folA gene (PLOS Genetics 2015 DOI:10.1371/journal.pgen.1005612) and adk gene (Nature Ecology Evolution, 2017 http://dx.doi.org/10.1038/s41559-017-0149) that fitness is determined by product of folded protein abundance A and activity kcat/KM. Mutations may affect stability and through that parameter A (by changing the balance between protein production and degradation, see Mol Cell v.49, pp133-44 (2013). Therefore interpretation of the experimental trends entirely in functional terms is not warranted.</p><p>A minor comment: The concept and metaphor of expanding protein universe has been introduced 10 years before Kondrashov's work in the paper &quot;Expanding protein universe and its origin from biological big bang&quot; PNAS 2002, v.99 pp. 14132-6.</p><p>[Editors' note: further revisions were suggested before publication, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Molecular function limits divergent protein evolution on planetary timescales&quot; for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by Diethard Tautz as the Senior Editor, a Reviewing Editor, and two reviewers.</p><p>As you can see from the reports below, the reviewers appreciated the revisions. However, there are still major outstanding issues. While some of these can be resolved by changes in the presentation, others are fundamental. We would strongly encourage you to address all of these prior to publication.</p><p><italic>Reviewer #2:</italic> </p><p>I find that the authors did a thorough revision of the manuscript. At least now I think I understood the main conclusion of the paper. In enzymes and other proteins with very strong functional conservation, the number of different amino acids acceptable at a position is about 4. It is not because many sites are invariant and some are variable (not a dirty trick of average temperature in a hospital), but because most sites (except the invariant ones) are constrained to use a library of 3 to 5 different amino acids, not more than that. If this is not the bottom line, then the authors need to do better job at crystallizing their main claim and result.</p><p>If it is, I think it is a meaningful finding that could be explained better to the readers. I guess the second claim is that 3-5 amino acid limit is universal to all enzymes and (conserved!) non-enzymes. I do doubt (as in the original review) the validity of such a strong claim, which could be a result of the authors' bias in selecting families for their analysis. At least for non-enzymes, they selected most conserved proteins (like ribosomal proteins), so of course such selection is biased to get proteins that saturate easily in evolution. The authors try to justify this biased selection suggesting that it is difficult to find orthologs. But that statement by itself totally discredits this study. Why? Because if you cannot find your orthologs, wouldn't it mean that they already diverged beyond (lower than) your claimed 25% identity as the universal limit, and the author's conclusions do not apply to such families? Maybe for the enzymes too, the 25% limit is simply a reflection of the search methods the authors used to find orthologs, that fail to find more distant ones.</p><p>To improve the presentation and make this paper quite interesting (well, reviewers are not supposed to direct the study, but the authors seem passionate about their work and also seem rather inexperienced in both logical thinking and putting a paper together, so maybe this recommendation could be helpful), I would suggest to base it on two plots.</p><p>1) Between-protein variability.</p><p>The first plot is the histogram of the average estimated number of amino acids allowable per site (without invariant sites, or with) for enzyme families and other protein families. Well, the authors would have to try harder to find orthologs for proteins that manage to diverge below 25%, even my rotation students can do that. This histogram would be expected to have a maximum around 3 to 5, and for some variable proteins it could be around 10 or 15? Right? Then protein families with very low and very high numbers could be discussed with an attempt to give explanations about their uniqueness.</p><p>2) Within-protein variability.</p><p>The second plot is the histogram of estimated number of amino acids allowable per site within a protein family. The authors could either normalize to the average per protein, or select a bin with the maximum count from previous plot (let's say 4). These histograms can be averaged for all families with mean and SD showing for each bin. I would assume there will be a large count for invariant sites for enzymes (at 1), counts for 2 amino acids used, 3, 4, etc. Will this histogram have a single mode? Maybe around 4? Several modes? Will there be sites using more than 10 amino acids? How are these distributed in spatial structure and relative to the active site? Discussion of these details could be quite insightful and interesting.</p><p>If these authors do not wish to make these plots, since this review will be published, maybe someone else will, and we will learn something interesting as a result.</p><p>Currently, there are so many plots in this paper and many of them are not particularly helpful to get the point across quickly. Also I still find the usage of non-standard terms (like divergence rate) confusing, not necessary, and not insightful about the mechanism. Yes, the terms are defined, but they are just masking the reality, which is simpler: constrained usage of amino acids in positions of enzyme molecules. Not all 20, not even 10, but 4! Why not state and illustrate this clearly? Don't you agree that the impact of the paper will increase because it will be easier to understand?</p><p>The Abstract is still very poor and misleading. For instance, the statement &quot;The effective divergence limit (&gt;25% sequence identity) is not primarily due to multiple substitutions at the same sites&quot; is completely wrong. According to the authors' explanations, this &quot;effective divergence limit&quot; is exactly due to multiple substitutions at the same site! If you have only 4 amino acids acceptable at a site, due to multiple substitutions sequence identity will saturate are 25%. Like in DNA. Why not write a precise and clear Abstract about what this work presents? Due to so many logical flaws in the authors' thinking and presentation (as illustrated above), I would be scared to publish this paper without a careful read. One statement at a time. And trying to figure out why the statement is wrong. If clearly not wrong, then move on to the next one.</p><p>And, finally, why not compare your results with this paper more thoroughly PMID: 27138088? Isn't it a bit similar? I guess I don't understand the meaning behind &quot;to investigate the temporal patterns of the long-term divergence.&quot;</p><p>Do the authors still claim that the sites are saturated at the usage of 3 to 5 amino acids because the time passed was not sufficient to gain more changes? Or the time was enough and protein of the same function simply cannot tolerate additional amino acids well and still keep the function? Which one is right? I got an impression it was the latter. And then what I said at the beginning of this review holds. If it is the former, it needs to be convincingly justified.</p><p>If the authors disagree with my review, then I did not understand the paper, which is possible, and still suggests that the authors need to improve the presentation.</p><p><italic>Reviewer #3:</italic> </p><p>This version of the manuscript is a significant improvement over the previous version in terms of added details (e.g. experimental procedure of folA mutagenesis re now described in sufficient detail to be understandable and/or potentially reproducible).</p><p>The authors attempted to address my (and other reviewers) main concern by presenting the analysis in new Figure 5 that shows that full orthologues (all EC numbers coincide) are more sequence-constrained than partial orthologues (3 EC numbers coincide). However this analysis fails to control for different structural divergence between full and partial orthologues.</p><p>Therefore, the most problematic aspect of the analysis – that authors attribute observed sequence conservation in diverging clades to conservation of function between orthologues has not been fully addressed. A clear alternative explanation that such conservation is explained by maintenance of structure and stability regardless of function still stands.</p><p>The authors used a truism by pointing out that proteins of the same FOLD (i.e. topologically similar arrangement of elements of secondary structure) can diverge to 10% or less sequence ID again citing an old work with data collected on very limited number of structures available at that time.</p><p>However, their full functional orthologues are much more similar structurally than proteins sharing the same fold. The correct control which was suggested in my initial review has not been done satisfactorily. Specifically, the authors should compare their sets of proteins with sets that have similar degree of structural similarity (measured as distribution of TM-scores) but different function. There are such examples where structures are quite similar (TM-score-wise) but functions differ significantly. Good examples of that kind ate TIM-barrels which are almost exclusively enzymes with wide variety of specificity and Igfold proteins again with very conserved structures but broadly diverged functional annotations.</p><p>If the authors find that conservation of structure in functionally divergent proteins imposes less sequence divergence constraints than same degree of structural conservation in orthologues – that will be a clear demonstration of additional constraints imposed by functional conservation which is the main message of this work. In the absence of such analysis the current data does not justify the conclusion.</p><p>Minor point: The authors severely misquote Firnberg et al., 2016. They say: &quot;Nevertheless, direct and comprehensive biochemical experiments demonstrated that the deleterious effects of protein mutations primarily result from changes in specific protein activity rather than decreases in protein stability and cellular abundance [Firnberg et al., 2016]&quot;. In fact, the authors of Firnberg et al., 2016, say directly the opposite: '… These DFEs provide insight into the inherent benefits of the genetic code's architecture, support for the hypothesis that mRNA stability dictates codon usage at the beginning of genes, an extensive framework for understanding protein mutational tolerance, and evidence that mutational effects on protein thermodynamic stability shape the DFE..…&quot; (cited from the Abstract of Firnberg et al., 2016). The authors misrepresent the main result of Firnberg et al., 2016: According to Figure 5B of Firnberg et al., 2016, the <italic>product</italic> of abundance and catalytic activity shapes fitness effects in TEM1, not abundance alone. This is exactly what is established in Bershtein et al., 2015 and Adkar et al., 2017, and shows that abundance (which is a function of stability) enters fitness landscape on equal footing with catalytic activity, i.e. there is as much selection for abundance (i.e. stability) as it is for kcat/KM and related measures of activity. This misinterpretation somewhat undermines the major premise of the present paper that there is separate selection for activity/function and stability/structure. In reality one cannot disentangle the two because fitness landscape depends on the function (i.e. the product) of the two factors.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.39705.035</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>The manuscript analyzes clusters of orthologue enzymes of the same function, defined as sharing the same 4-digits EC number, to examine the limitation of function preservation on evolutionary divergence. The results seem to indicate that function confines divergence, which is not surprising. The potential novelty here is the time dependence of the process, where phylogenetic time of species divergence is used as natural time scale &quot;clock&quot;. The data shows that proteins diverse from each other rapidly during the first ~1.5 billion years, but saturate after that.</p><p>Opinion: The manuscript addresses an important and interesting topic, but it should be revised significantly to clarify what exactly was computed and why, what was measured and why, and how the results are related to previous studies. In view of the amount and nature of the issues raised, the authors should consider withdrawing the manuscript.</p></disp-quote><p>We sincerely thank the reviewing editor and reviewers for their thoughtful suggestions and comments. Following the reviewers’ suggestions, we have substantially revised the manuscript to clarify the main results, their novelty and importance. Although the fact that functional conservation constrains protein divergence is indeed not surprising, our manuscript describes interesting long-term temporal patterns and the limits of this divergence for proteins with the same molecular function. We welcome the opportunity provided by this innovative peer review model to share with the readers our replies to the reviewers’ comments. We believe that this scientific dialogue will be an important contribution to understanding of long-term evolution of protein sequences and structures.</p><disp-quote content-type="editor-comment"><p>Major concerns:</p><p>(pretty much copy-pasted from the individual reports)</p><p>1) This study poses the question about the extent to which function constrains sequence divergence. The answer given is that for orthologous enzymes 25% sequence identity is the approximate limit. The major critique, is that the authors did not make an attempt to provide a clear mechanistic explanation for such phenomenon. Is it simply because a significant fraction of positions is invariant? Is it because there are various constraints on various sites? Is it because only a small subsets of amino acids are tolerated at some sites? Why not take several enzyme families with very thick alignments and analyze them position-by-position to shed light on this question? Without such deep analysis, the paper, while interesting in its general idea, reads superficial and underdeveloped, despite some experimental results.</p></disp-quote><p>We apologize for the possible confusion. The mechanistic explanation of our results is the following. We demonstrate in the manuscript that the long-term evolution of proteins that continuously maintain the same molecular functions generally requires a strict conservation of protein structures (&lt;3Å C-α root mean square deviation). The structural conservation is likely necessary for proper structural positioning of active site residues required for efficient function and catalysis. This level of structural conservation, in agreement with the Chothia and Lesk analysis (Chothia and Lesk, 1986), requires a substantial conservation of protein sequences, which leads to the observed sequence divergence limit. Furthermore, our analysis shows that only about 35% of the sequence conservation between distant orthologs can be attributed to universally conserved protein sites, i.e. sites occupied by identical amino acids in almost all lineages. In contrast, the observed divergence limit primarily originates from a small number of acceptable amino acids at each protein site under the continuous constraint to strictly conserve protein structure and function. Following the reviewers’ suggestion, we now present an analysis of sequence conservation across protein sites using multiple sequence alignments for 30 diverse enzyme families (Figure 2B, Figure 2—figure supplement 1).</p><disp-quote content-type="editor-comment"><p>2) The authors premise their study on the assertion made by Rost in a 1997 review that proteins of the same fold can diverge up to random sequence ID of 3-5%, i.e., that structural similarity does not impose constraint on sequence ID. As a consequence the authors attribute in their analysis all sequence identity constraints to functional similarity. However, this premise is highly problematic. While anecdotally one can find two proteins of similar fold with very low sequence ID, typically proteins with similar structure (not necessarily orthologues) have sequence ID at or above 25% – this is the essence of the famous cusp in sequence-structure relationship first reported by Lesk and Chothia in the eighties. In fact a careful analysis of structural/stability constraints on sequence divergence has been published in recent paper (Biophys J v.112, p.1350-65, 2017) where it was shown that in divergent evolution scenario protein structure is maintained up to 25-30% sequence ID and quickly deteriorates beyond that. Incidentally it is very close to 25% ID which the authors claim to stem from functional constraints. Furthermore, the above mentioned BJ paper presents a detailed analytical estimate of sequence divergence dynamics akin to exponential fits used in this PAPER. The authors should make themselves familiar with this theory and consider using it to fit their divergence curves rather than ad hoc exponential fits.</p></disp-quote><p>We believe that there may be a potential misunderstanding here in terms of the definition of protein folds and structures, and in terms of the nature of evolutionary constraints. A protein fold is defined as a particular set of protein secondary structures, their arrangement and topological connections (Murzin et al., 1995). Both the Rost 1997 paper and the Biophysical J. paper (cited by the reviewer) actually show that a low sequence identity (&lt;25%) between proteins with the same fold is very common. Thus, the sequence constraints necessary to simply maintain a protein fold cannot be responsible for the divergence limit we observe. We also would like to emphasize that selection does not specifically act to maintain structural similarity; instead, structural and sequence conservation is a consequence of the selection for a molecular function necessary to maintain species fitness. In contrast to protein folds, our analysis demonstrates that the continuous conservation of specific molecular functions usually requires high structural similarity (&lt;3Å C-α root mean square deviation), and that the requirement for the structural conservation likely constrains the divergence of sequence identity (&gt;25%).</p><p>In terms of the analytical model presented in the Biophysical J. 2017 paper, we note that the exponential formulas used in our fits are not <italic>ad hoc</italic>. They directly correspond to a divergence model with equal probability of mutations across protein sites, as in the Biophysical J. model. The BJ model is numerically identical to our second model. Specifically, the fraction of identical sites (<italic>y)</italic> after a certain divergence time (<italic>t)</italic> in the BJ model is given by:</p><p>y=1-((a-1)/a)(1-(1-a/l(a-1)<sup>μt</sup>)</p><p>according to Equation 7 in the BJ paper, where the parameter <italic>l</italic> is the length of the protein, <italic>a</italic> is the number of acceptable amino acid types per protein site, and <italic>μ</italic> is the per-protein substitution rate. After re-arranging, and given that the substitution rate per site <italic>μ<sub>0</sub></italic> =<italic>μ × l<sup>-1</sup></italic>:</p><p>y=1a+(1-1/a)(1+((-a/(a-1))/l))<sup>lμ<sub>0</sub>t</sup></p><p>Given the well-known limit: exp(x)=lim<sub>n→∞</sub>⁡(1+x/n)<sup>n</sup>, and because protein length <italic>l</italic> is substantially larger than a/(a-1):</p><p>y=1/a+(1-1/a)exp(-R<sub>0</sub>t); with R0=(a/(a-1))μ0</p><p>This equation is numerically identical to our model 2. Furthermore, this demonstrates that the parameter <italic>Y<sub>0</sub></italic> in model 2 can be also interpreted as the inverse of the effective number of amino acid types acceptable per protein site when molecular function is strictly conserved. Our results thus suggest that, on average, only 2 to 4 amino acids types are usually accepted per protein site as long as protein molecular function is conserved.</p><disp-quote content-type="editor-comment"><p>3) The high throughput experimental data is potentially interesting but its description is so cryptic and incomplete that it is very hard to assess what actually has been done there. In particular there is no assessment of noise in deep sequencing to assess fitness, of the effects of synonymous substitutions, etc. How is the data binned and why binning? The use of LB as a medium for the folA experiment is unfortunate because in LB DHFR is much less essential than in minimal media and therefore the results could be skewed by very permissive conditions. In addition the standing genetic variation is not taken into account – fitness effects could be a result of hitchhiking (i.e. originate from the variation of the background into which the mutations are introduced). These concerns aside, it is not entirely clear what does comparison with experiment tell us beyond the obvious that sites where deleterious fitness effects are greatest evolve more slowly. Was the sole purpose of the experiment to bin positions by their fitness effects? If so, what new insight is gained from slower divergence of sites with more profound fitness effects compared to faster divergence of sites that are more tolerant to substitutions in experiments. Isn't this effect expected? Maybe quantification of the effect may have some novelty, but such quantification has not been done. The obvious thing to do is to compare their alleged fitness effects with dN/dS assessment for the rates but that has not been done.</p></disp-quote><p>We agree with the reviewers that the correlation between the fitness effects of mutations and evolutionary conservation is indeed expected. But this particular result was neither a goal nor a major conclusion of our analysis. Our primary goals were to characterize the long-term temporal divergence patterns at sites with different fitness effects, to explore the limits of the sequence divergence at different sites, and to investigate the contribution of sites with various fitness effects to the divergence limit. For example, our analysis demonstrated (Figure 3), for the first time to our knowledge, that the divergence at sites with relatively small fitness effects usually saturates after 1-2 billion years of evolution, while the divergence at sites with higher fitness effects still continues, although at a substantially smaller rate.</p><p>In our analysis, we binned the sites (based on their average fitness effects) in order to explore the sequence divergence for sites within each fitness category. We used logarithmic bins in our analysis due to the skewed distribution of fitness effects in the experimental data (Figure 3—figure supplement 2).</p><p>Following the reviewers’ suggestion, we now use several approaches to demonstrate the reliability of our experimental measurements: 1.) we show that mutants targeting start and stop codons have, on average, significantly larger growth effects compared to amino acid replacements; 2.) we show that synonymous substitutions yield very small fitness effects; and 3.) by calculating average growth defects per site (based on strains with non-overlapping sets of introduced codons), we demonstrate a high reproducibility (r = 0.95) of our experimental findings. Overall, these results demonstrate that neither sequencing noise nor background mutations have a significant effect on the experimental measurements.</p><disp-quote content-type="editor-comment"><p>4) The word &quot;protein&quot; should be replaced with &quot;enzyme&quot; in the title. &quot;We focused on enzymes because their molecular function is usually well defined,&quot; doesn't sound quite true. Reading the manuscript, it seems that the goal of this work is to investigate divergence of enzymes. The divergence of non-enzymes will most likely follow a different pattern and will generally be much lower than 25% identity. If the authors want to generalize to non-enzymes, they need to perform appropriate analyses. Currently, only one experiment is dedicated to a non-enzyme. It is not fair to the readers to generalize beyond the scope of analysis that was carried out.</p></disp-quote><p>We indeed believe that for enzymes, specific molecular functions are usually well-defined. Following the reviewers’ suggestion, we now also present the results of similar sequence analyses for orthologous proteins that are not enzymes. In order to explore the long-term divergence limit, protein orthologs need to be present across very long evolutionary distances. Therefore, the analyzed proteins mostly represent ribosomal proteins, chaperones and electron transport flavoproteins. Notably, the results obtained for these protein families are consistent with the divergence limit observed for enzymes (Figure 1—figure supplement 5). We also now describe an interesting and specific case of several mitochondrial ribosomal proteins which display much faster divergence rates compared to their prokaryote orthologs; a likely consequence of their co-evolution with the fast-evolving mitochondrial-encoded rRNA.</p><disp-quote content-type="editor-comment"><p>5) The sentence in the Abstract &quot;divergence rates of orthologous enzymes decrease substantially after ~1-2 billion years of independent evolution&quot; is confusing. &quot;Rate&quot; means number of amino acid substitutions per site per unit of time. Moreover, the authors write in the Introduction &quot;a divergence limit does not imply that the rate of amino acid substitutions slows down in evolution,&quot; thus contradicting the Abstract. The Abstract should be edited and the misleading sentence corrected. From the context of the paper is seems like by &quot;divergence rate&quot; the author mean the rate of decrease in pairwise sequence identity with time. This definition poses additional question. This &quot;divergence rate&quot; will always decrease due to multiple and back substitutions and it is trivial. The authors need to make it clear that what they mean goes beyond a trivial curvilinear relationship between time and sequence identity.</p></disp-quote><p>The reviewer is correct, and we apologize for being unclear. We specifically define the sequence divergence rate (now in the third paragraph of the Introduction) as the decrease in the pairwise sequence identity per unit time. Notably, this divergence rate is different from the substitution rate, which corresponds to the number of amino acid substitutions per site per unit time. We have also edited the Abstract and the main text to further clarify this distinction. As we discuss in the paper (fifth paragraph of the Results) the observed divergence limit is not a trivial consequence of the curvilinear relationship between divergence time and sequence identity. For example, according to the data fits using model 1 and model 3, the decrease in the sequence divergence rate after ~1-2 billion years of evolution is more than an order of magnitude higher than expected simply due to multiple substitutions at the same sites. We show in the paper that the observed sequence divergence limit is primarily due to a small number of acceptable amino acids at each protein site under the continuous and strict conservation of protein function.</p><disp-quote content-type="editor-comment"><p>6) Further on this, evolutionary rate is much more than simply a count of changes in the identity of the amino acids. To measure it properly one needs to rely on the phylogeny. Indeed, since the study is based on several clusters of orthologous proteins, why not do just that? For example, why not use the dN/dS formalism?</p></disp-quote><p>We would like to clarify that the primary goal of our manuscript was not to determine the short-term evolutionary rates across different sites, which can be indeed quantified using the dN/dS formalism. Our main goals were to characterize the patterns of long-term sequence divergence across protein sites and the contribution of sites to the divergence limit for proteins with the same molecular function. Unfortunately, short-term substitution rates (based on the dN/dS formalism) are not informative across long evolutionary distances (billions of years) due to saturation of substitutions at synonymous sites. We rely in our analyses on phylogenetic information by using the consensus species' divergence times (Supplementary file 1).</p><disp-quote content-type="editor-comment"><p>7) &quot;billion years of evolution, we observed a significant decrease in mutual divergence rates,&quot; see item 5 above. Also, shouldn't &quot;significant&quot; be quantified is some way?</p></disp-quote><p>Following the reviewer’s comment, we have re-worded this sentence to clarify that we are specifically referring to the decline of sequence identity per unit time; we also now report that, based on model 3 and Equation 5, the sequence divergence rate for proteins with the same molecular function decreases more than ten times after ~1.5 billion years of evolution.</p><disp-quote content-type="editor-comment"><p>8) &quot;Species' divergence times were used to estimate the times of divergence between corresponding orthologous proteins&quot;: How reliable is this time estimate?</p></disp-quote><p>We thank the reviewer for this question. We now present in Supplementary file 1 data describing the variance in the estimated divergence times based on multiple independent publications. Overall, most estimates of species divergence differ by tens to several hundred million years. To assess the sensitivity of our results to this variation, we repeated the analysis using ~1000 independent runs by randomly sampling either the maximum or minimum reported divergence times between each pair of lineages. The fits of the divergence model 2 based these simulations demonstrate that for ~90% of proteins the independent assignments of the divergence times support a long-term sequence identity limit higher than 25% (Figure 1—figure supplement 7).</p><disp-quote content-type="editor-comment"><p>9) Discussion &quot;The presented results demonstrate that, in contrast to proteins with the same fold [Rost, 1997], the requirement to maintain the same molecular function significantly constrains the long-term divergence of protein orthologs&quot;: This difference is surprising. Maybe it has to do with how changes were estimated in the two studies? To state it with confidence direct comparison is needed, where the exact same methodology is used.</p></disp-quote><p>We agree with the reviewer that this result is both interesting and surprising. This is one of the key results of our manuscript. This result is especially interesting given that proteins with the same fold often have very low levels of sequence similarity. Our analysis demonstrates that, in contrast to protein that simply share the same fold, orthologs that continuously conserve specific molecular functions usually display high degree of structural and sequence similarity even after billions of years of divergent evolution. We also show (Figure 5) that even a small relaxation of functional conservation (for example, from sharing all 4 digits of the EC number to only sharing the first 3 digits of the EC number) results in a significant increase of long-term sequence divergence.</p><disp-quote content-type="editor-comment"><p>10) Finally, the manuscript should be edited for clarity by a professional scientific editor.</p></disp-quote><p>Following the reviewer’s suggestion, we have extensively revised the text to improve clarity, and to highlight the novelty and importance of our findings.</p><disp-quote content-type="editor-comment"><p>Separate reviews (please respond to each point):</p></disp-quote><p>Reviewer #1:</p><disp-quote content-type="editor-comment"><p>Summary of paper:</p><p>The manuscript analyzes clusters of orthologue enzymes of the same function, defined as sharing the same 4-digits EC number, to examine the limitation of function preservation on evolutionary divergence. The results seem to indicate that function confines divergence, which is anticipated- perhaps also shown before. The potential novelty here is the time dependence of the process. The data shows (to the best of my understanding) that proteins diverse from each other rapidly during the first ~1.5 billion years, but saturate after that. The data further suggests (again, assuming that I understood correctly) that the rapid evolutionary phase mostly reflects random drift, i.e., amino acid sites that can freely mutate, and that the saturation value reflects their relative fraction of the entire enzyme sequence.</p><p>Opinion: The manuscript could be important but it should be revised significantly to clarify what exactly was computed and why, what was measured and why, and how the results are related to previous studies. I also believe the manuscript should be edited for clarity by a professional scientific editor.</p><p>Major issues:</p><p>1) Results &quot;In the first model, all protein sites have equal and independent substitution rates; see Equation 1&quot;: Equation 1 obviously represents an unrealistic evolutionary model because it is well known that the evolutionary rates are not equal at all amino acid sites. For example, catalytic residues hardly change.</p><p>2) Where does Equation 2 come from? It also doesn't look particularly realistic.</p><p>3) Equation 3 is the commonly used evolutionary model I think. So why not start with it?</p></disp-quote><p>All scientific models are ultimately approximations to reality. They are essentially useful tools for answering specific questions and testing hypotheses. For example, despite being clearly an approximation to reality, model 2 fits the long-term sequence divergence data pretty well (Figure 1). Notably, increasing the complexity of the models (e.g. model 2 compared to model 3) does not significantly improve the fits to the data (see R<sup>2</sup> values in Supplementary file 2A). Model 2 describes sequence divergence with independent and equal probability of amino acid substitutions across protein sites and a divergence limit at long evolutionary distances.</p><p>Our main reason for first considering models 1 and 2 is to test whether the observed decline in protein sequence identity (i.e. the sequence divergence rate) is simply due to multiple substitutions at the same sites (a trivial explanation for the curvilinear relationship between time and sequence identity), or whether it is necessary to assume additional constraints, such as the long-term divergence limit. Testing the goodness of fits between these two simple models allows us to answer this specific question. We now describe in the text that model 2 represents a simple modification to model 1 in which the exponential decay of sequence identity is bounded by a minimum identity at long evolutionary distances.</p><disp-quote content-type="editor-comment"><p>4) &quot;Species' divergence times were used to estimate the times of divergence</p><p>between corresponding orthologous proteins&quot;: How reliable is this time estimate?</p></disp-quote><p>We thank the reviewer for this question. We now present in Supplementary file 1 data describing the variance in the estimated divergence times based on multiple independent publications. Overall, most estimates of species divergence differ by tens to several hundred million years. To assess the sensitivity of our results to this variation, we repeated the analysis using ~1000 independent runs by randomly sampling either the maximum or minimum reported divergence times between each pair of lineages. The fits of the divergence model 2 based these simulations demonstrate that for ~90% of proteins the independent assignments of the divergence times support a long-term sequence identity limit higher than 25% (Figure 1—figure supplement 7).</p><disp-quote content-type="editor-comment"><p>5) Figure 2: How is &quot;fitness cost&quot; defined?</p></disp-quote><p>Fitness cost was defined as the percent decrease in bacterial growth rate relative to the original strain, i.e. the “wild type”, in which mutations were introduced. We have now clarified this definition in the manuscript.</p><disp-quote content-type="editor-comment"><p>6) &quot;phylogenetically independent pairs of species&quot;: What does it mean and how is &quot;independent&quot; defined? Is the pair A-B in Figure 3A phylogenetically independent? And the pair D-H?</p></disp-quote><p>Phylogenetically independent pairs of species are defined as pairs of species that do not share any edges in the phylogenetic tree with each other since each pair diverged from a common ancestor. In Figure 2A of the updated manuscript, the pair A-B is independent from the pair D-H because they do not share edges in the phylogenetic tree since divergence from a common ancestor. By contrast, the pair D-H is not independent from the pair E-F. We now provide these examples in the main text to clarify these points.</p><disp-quote content-type="editor-comment"><p>7) &quot;Notably, the probability that a protein site is identical, and thus contributes to the divergence limit, first increases linearly with increasing fitness effects at the site, and then begins to saturate for sites with high (&gt;30%) fitness effects (Figure 3B).&quot; This is perhaps true for FolA but I do not see saturation for InfA.</p></disp-quote><p>We agree with the reviewer that the saturation is more prominent for FolA. However, we also observe it in InfA; for example, for InfA there is a larger (&gt;2-fold) change in the probability of site identity in the 10-40% interval of the relative growth rate decrease (x-axis), compared to the 40-70% interval.</p><disp-quote content-type="editor-comment"><p>8) The distributions of the probability of identical sites in FolA and InfA (Figures 4A and B) are very different, but they are discussed together without reference to the difference.</p></disp-quote><p>We apologize for being unclear. Likely due to family-specific constraints, the distributions of the probability of identical sites are indeed quite different between FolA and InfA. But our main point in this analysis is that in both cases the fraction of universally conserved sites, i.e. sites conserved in almost all lineages, is relatively small. We now present in Figure 2B and Figure 2—figure supplement 1 a more comprehensive analysis based on 30 different enzyme families. These results demonstrate that sites conserved in the majority of the linages are responsible for only about a third of the overall sequence identity between distant orthologs.</p><disp-quote content-type="editor-comment"><p>9) Discussion &quot;The presented results demonstrate that, in contrast to proteins with the same fold [1997], the requirement to maintain the same molecular function significantly constrains the long-term divergence of protein orthologs&quot;: I am surprised about this difference. Maybe it has to do with how changes were estimated in the two studies? To state it with confidence I would have liked to see direct comparison where the exact same methodology is used.</p></disp-quote><p>We agree with the reviewer that this result is interesting and surprising. This is one of the key results of our manuscript. Previous studies demonstrated (for example, Rost, 1997), that proteins sharing the same fold often have very small degrees of sequence and structural similarity. Our analysis shows that, in contrast to proteins that simply share the same fold, orthologs that continuously conserve specific molecular functions usually display high degree of structural and sequence similarity even after billions of years of divergent evolution. We also show (Figure 5) that even a small relaxation of functional conservation (for example, from sharing all 4 digits of the EC number to only sharing the first 3 digits of the EC number) results in a significant increase of long-term sequence divergence.</p><disp-quote content-type="editor-comment"><p>10) Evolutionary rate is much more than simply a count of changes in the identity of the amino acids. To measure it properly one needs to rely on the phylogeny. Indeed, since the study is based on several clusters of orthologous proteins, why not do just that?</p></disp-quote><p>We agree with the reviewer that evolutionary rate is more than a count of amino acid changes, which is why we use multiple divergence models to fit the data. We note that we indeed use phylogenetic information by considering published divergence times between different lineages. However, we do not fit an evolutionary model to the clusters of orthologous proteins because the short-term evolutionary rates derived in this way would not be informative about divergence patterns over long geological timescales. Our study is focused on understanding the patterns of long-term divergence of sequence and structural identity for proteins conserving molecular function, rather than estimating short-term evolutionary rates across protein sites.</p><p>Reviewer #2:</p><disp-quote content-type="editor-comment"><p>This study poses the question about the extent to which function constrains sequence divergence. The answer given is that for orthologous enzymes 25% sequence identity is the approximate limit. The major critique, is that the authors did not make an attempt to provide a clear mechanistic explanation for such phenomenon. Is it simply because a significant fraction of positions is invariant? Is it because there are various constraints on various sites? Is it because only a small subsets of amino acids are tolerated at some sites? Why not take several enzyme families with very thick alignments and analyze them position-by-position to shed light on this question? Without such deep analysis, the paper, while interesting in its general idea, reads superficial and underdeveloped, despite some experimental results.</p></disp-quote><p>We thank the reviewer for suggestions and apologize for the potential confusion. The mechanistic explanation of our results is the following. We demonstrate in the manuscript that the long-term evolution of proteins that continuously maintain the same molecular functions generally requires a strict conservation of protein structures (&lt;3Å C-α root mean square deviation). The structural conservation is likely necessary for proper structural positioning of active site residues required for efficient function and catalysis. This level of structural conservation, in agreement with the Chothia and Lesk analysis (Chothia and Lesk, 1986), requires a substantial conservation of protein sequences, which leads to the observed sequence divergence limit. Furthermore, our analysis shows that only about 35% of the sequence conservation between distant orthologs can be attributed to universally conserved protein sites, i.e. sites occupied by identical amino acids in almost all lineages. In contrast, the observed divergence limit primarily originates from a small number of acceptable amino acids at each protein site under the continuous constraint to strictly conserve protein structure and function. Following the reviewers’ suggestion, we now present an analysis of sequence conservation across protein sites using multiple sequence alignments for 30 diverse enzyme families (Figure 2B, Figure 2—figure supplement 1).</p><disp-quote content-type="editor-comment"><p>1) I suggest replacing the word &quot;protein&quot; with &quot;enzyme&quot; in the title. &quot;We focused on enzymes because their molecular function is usually well defined,&quot; doesn't sound quite true. Reading the manuscript, it seems that the goal of this work is to investigate divergence of enzymes. I am positive that the divergence of non-enzymes will follow a different pattern and will generally be much lower than 25% identity. If the authors want to generalize to non-enzymes, they need to perform appropriate analyses. Currently, only one experiment is dedicated to a non-enzyme. It is not fair to the readers to generalize beyond the scope of analysis that was carried out.</p></disp-quote><p>We indeed believe that for enzymes, specific molecular functions are usually well-defined. Following the reviewers’ suggestion, we now also present the results of similar sequence analyses for orthologous proteins that are not enzymes. In order to explore the long-term divergence limit, protein orthologs need to be present across very long evolutionary distances. Therefore, the analyzed proteins mostly represent ribosomal proteins, chaperones and electron transport flavoproteins. Notably, the results obtained for these protein families are consistent with the divergence limit observed for enzymes (Figure 1—figure supplement 5). We also now describe an interesting and specific case of several mitochondrial ribosomal proteins which display much faster divergence rates compared to their prokaryote orthologs; a likely consequence of their co-evolution with the fast-evolving mitochondrial-encoded rRNA.</p><disp-quote content-type="editor-comment"><p>2) I think that the sentence in the Abstract &quot;divergence rates of orthologous enzymes decrease substantially after ~1-2 billion years of independent evolution&quot; is confusing. &quot;Rate&quot; usually means number of amino acid substitutions per site per unit of time. Moreover, the authors write in the Introduction &quot;a divergence limit does not imply that the rate of amino acid substitutions slows down in evolution,&quot; thus contradicting the Abstract. I suggest to edit the Abstract and correct the misleading sentence. From the context of the paper is seems like by &quot;divergence rate&quot; the author mean the rate of decrease in pairwise sequence identity with time. This definition poses additional question. This &quot;divergence rate&quot; will always decrease due to multiple and back substitutions and it is trivial. The authors need to make it clear that what they mean goes beyond a +trivial curvilinear relationship between time and sequence identity.</p></disp-quote><p>The reviewer is correct, and we apologize for being unclear. We specifically define the sequence divergence rate (now in the third paragraph of the Introduction) as the decrease in the pairwise sequence identity per unit time. Notably, this divergence rate is different from the substitution rate, which corresponds to the number of amino acid substitutions per site per unit time. We have also edited the Abstract and the main text to further clarify this distinction. As we discuss in the paper (fifth paragraph of the Results) the observed divergence limit is not a trivial consequence of the curvilinear relationship between divergence time and sequence identity. For example, according to the data fits using model 1 and model 3, the decrease in the sequence divergence rate after ~1-2 billion years of evolution is more than an order of magnitude higher than expected simply due to multiple substitutions at the same sites. We show in the paper that the observed sequence divergence limit is primarily due to a small number of acceptable amino acids at each protein site under the continuous and strict conservation of protein function.</p><disp-quote content-type="editor-comment"><p>3) &quot;billion years of evolution, we observed a significant decrease in mutual divergence rates,&quot; see item 2 above. Also, shouldn't &quot;significant&quot; be quantified is some way?</p></disp-quote><p>Following the reviewer’s comment, we have re-worded this sentence to clarify that we are specifically referring to the decline of sequence identity per unit time; we also now report that, based on model 3 and Equation 5, the sequence divergence rate for proteins with the same molecular function decreases about ten times after ~1.5 billion years of evolution.</p><disp-quote content-type="editor-comment"><p>4) It was not made clear why these experiments were performed and how they integrate with the rest of the study. Addition of these experiments seems preliminary and no confident conclusions follow. Was the sole purpose of the experiment to bin positions by their fitness effects? If so, what new insight is gained from slower divergence of sites with more profound fitness effects compared to faster divergence of sites that are more tolerant to substitutions in experiments. Isn't this effect expected? Maybe quantification of the effect may have some novelty, but such quantification has not been done.</p></disp-quote><p>We agree with the reviewer that the correlation between the fitness effects of mutations and evolutionary conservation is expected. But this particular result was neither a goal nor a major conclusion of our analysis. Our primary goals were to characterize the long-term temporal divergence patterns at sites with different fitness effects, to explore the limits of the sequence divergence across sites, and to investigate the contribution of sites with various fitness effects to the divergence limit. For example, our analysis demonstrated (Figure 3), for the first time to our knowledge, that the divergence at sites with relatively small fitness effects usually saturates after 1-2 billion years of evolution, while the divergence at sites with higher fitness effects still continues, although at a substantially smaller rate.</p><p>Reviewer #3:</p><disp-quote content-type="editor-comment"><p>[…] While the paper contains some interesting bioinformatics observations and analysis I have serious concerns about its premise and interpretation of the results. Apparently some issues stem from author's apparent gaps in knowledge of modern literature on biophysical determinants of protein evolution.</p><p>1) The premise that structural similarity does not constraint sequence identity is highly problematic. While anecdotally one can find two proteins of similar fold with very small sequence ID typically proteins with similar structure (not necessarily orthologues) have sequence ID at or above 25% – this is the essence of the famous cusp in sequence-structure relationship first reported by Lesk and Chothia in the eighties. In fact a careful analysis of structural/stability constraints on sequence divergence has been published in recent paper (Biophys J v.112, p.1350-65 (2017) where it was shown that in divergent evolution scenario protein structure is maintained up to 25-30% sequence ID and quickly deteriorates beyond that. Incidentally it is very close to 25% ID which the authors claim to stem from functional constraints Furthermore, the above mentioned BJ paper presents a detailed analytical estimate of sequence divergence dynamics akin to exponential fits used in this PAPER. The authors should make themselves familiar with this theory and use it to for their divergence curves rather ad hoc exponential fits.</p></disp-quote><p>We believe that there may be a potential misunderstanding here in terms of the definition of protein folds and structures, and in terms of the nature of evolutionary constraints. A protein fold is defined as a particular set of protein secondary structures, their arrangement and topological connections (Murzin et al., 1995). Both the Rost 1997 paper and the Biophysical J. paper (cited by the reviewer) actually show that a low sequence identity (&lt;25%) between proteins with the same fold is very common. Thus, the sequences constraints necessary to simply maintain a protein fold cannot be responsible for the divergence limit we observe. We also would like to emphasize that selection does not specifically act to maintain structural similarity; instead, structural and sequence conservation is a consequence of the selection for a molecular function necessary to maintain species fitness. In contrast to protein folds, our analysis demonstrates that the continuous conservation of specific molecular functions usually requires high structural similarity (&lt;3Å C-α root mean square deviation), and that the requirement for the structural conservation likely constrains the divergence of sequence identity (&gt;25%).</p><p>In terms of the analytical model presented in the Biophysical J. 2017 paper, we note that the exponential formulas used in our fits are not <italic>ad hoc</italic>. They directly correspond to a divergence model with equal probability of mutations across protein sites, as in the Biophysical J. model. The BJ model is numerically identical to our second model. Specifically, the fraction of identical sites (<italic>y)</italic> after a certain divergence time (<italic>t)</italic> in the BJ model is given by:</p><p>y=1-((a-1)/a)(1-(1-a/l(a-1))<sup>μt</sup>)</p><p>according to Equation 7 in the BJ paper, where the parameter <italic>l</italic> is the length of the protein, <italic>a</italic> is the number of acceptable amino acid types per protein site, and <italic>μ</italic> is the per-protein substitution rate. After re-arranging, and given that the substitution rate per site <italic>μ<sub>0</sub></italic> = <italic>μ × l<sup>-1</sup></italic>:</p><p>y=1/a+(1-1/a)(1+(-a/(a-1))/l)<sup>lμ<sub>0</sub>t</sup></p><p>Given the well-known limit: exp(x)=lim<sub>n→∞⁡</sub>(1+x/n)<sup>n</sup>, and because protein length <italic>l</italic> is substantially larger than a/(a-1):</p><p>y=1/a+(1-1/a)exp(-R<sub>0</sub>t); with R0=(a/(a-1))μ<sub>0</sub></p><p>This equation is numerically identical to our model 2. Furthermore, this demonstrates that the parameter <italic>Y<sub>0</sub></italic> in model 2 can be also interpreted as the inverse of the effective number of amino acid types acceptable per protein site when molecular function is strictly conserved. Our results thus suggest that, on average, only 2 to 4 amino acids types are usually accepted per protein site as long as protein molecular function is conserved.</p><disp-quote content-type="editor-comment"><p>2) The high throughput experimental data is potentially interesting but its description is so cryptic and incomplete that it is very hard to assess what actually has been done there. In particular there is no assessment of noise in deep sequencing to assess fitness., of the effects of synonymous substitutions etc. How is the data binned and why binning? The use of LB as a medium for the folA experiment is unfortunate because in LB DHFR is much less essential than in minimal media and therefore the results could be skewed by very permissive conditions. In addition the standing genetic variation is not taken into account – fitness effects could be a result of hitchhiking (i.e. originate from the variation of the background into which the mutations are introduced).These concerns aside, it is not entirely clear what does comparison with experiment tell us beyond the obvious that sites where deleterious fitness effects are greatest evolve more slowly. The obvious thing to do is to compare their alleged fitness effects with dN/dS assessment of the rates but that has not been done.</p></disp-quote><p>We agree with the reviewers that the correlation between the fitness effects of mutations and evolutionary conservation is indeed expected. But this particular result was neither a goal nor a major conclusion of our analysis. Our primary goals were to characterize the long-term temporal divergence patterns at sites with different fitness effects, to explore the limits of the sequence divergence at different sites, and to investigate the contribution of sites with various fitness effects to the divergence limit. For example, our analysis demonstrated (Figure 3), for the first time to our knowledge, that the divergence at sites with relatively small fitness effects usually saturates after 1-2 billion years of evolution, while the divergence at sites with higher fitness effects still continues, although at a substantially smaller rate.</p><p>We would also like to clarify that the primary goal of our manuscript was not to determine the short-term evolutionary rates across different sites, which can be indeed quantified using the dN/dS formalism. Our main goals were to characterize the patterns of long-term sequence divergence for proteins with the same molecular function. Short-term substitutions rates (calculated using the dN/dS formalism) cannot reveal the patterns of sequence divergence across billions of years of evolution due to saturation of substitutions at synonymous sites.</p><p>In our analysis, we binned the sites (based on their average fitness effects) in order to explore the sequence divergence for sites within each fitness category. We used logarithmic bins in our analysis due to the skewed distribution of fitness effects in the experimental data (Figure 3—figure supplement 2).</p><p>Following the reviewers’ suggestion, we now use several approaches to demonstrate the reliability of our experimental measurements: 1.) we show that mutants targeting start and stop codons have, on average, significantly larger growth effects compared to amino acid replacements; 2.) we show that synonymous substitutions yield very small fitness effects; and 3.) by calculating average growth defects per site (based on strains with non-overlapping sets of introduced codons), we demonstrate a high reproducibility (r = 0.95) of our experimental findings. Overall, these results demonstrate that neither sequencing noise nor background mutations have a significant effect on the experimental measurements.</p><disp-quote content-type="editor-comment"><p>3) The interpretation of the experimental fitness effects in terms of function is also questionable. The authors are apparently unaware of series of experimental works from Shakhnovich lab where determinants of fitness effects of mutations are addressed. In particular it has been shown using both point mutations and orthologous chromosomal replacements for folA gene (PLOS Genetics 2015 DOI:10.1371/journal.pgen.1005612) and adk gene (Nature Ecology Evolution, 2017 http://dx.doi.org/10.1038/s41559-017-0149) that fitness is determined by product of folded protein abundance A and activity kcat/KM. Mutations may affect stability and through that parameter A (by changing the balance between protein production and degradation, see Mol Cell v.49, pp133-44 (2013). Therefore interpretation of the experimental trends entirely in functional terms is not warranted.</p></disp-quote><p>We are aware of the experimental work from the Shakhnovich lab, and agree with the reviewer that the effects of mutations on fitness could arise either due to effects on protein activity or protein stability, which affects the product of protein abundance and activity. We note however that direct and comprehensive biochemical experiments demonstrate that the deleterious effects of protein mutations primarily arise from changes in specific protein activity rather than decreases in stability or protein cellular abundance; see, for example, Firnberg et al., 2014. We now clarify this point in the Discussion.</p><disp-quote content-type="editor-comment"><p>A minor comment: The concept and metaphor of expanding protein universe has been introduced 10 years before Kondrashov's work in the paper &quot;Expanding protein universe and its origin from biological big bang&quot; PNAS 2002, v.99 pp. 14132-6.</p></disp-quote><p>We thank the reviewer for bringing this manuscript to our attention, and we now cite this paper in the main text.</p><disp-quote content-type="editor-comment"><p>[Editors' note: further revisions were suggested before publication, as described below.]</p><p>As you can see from the reports below, the reviewers appreciated the revisions. However, there are still major outstanding issues. While some of these can be resolved by changes in the presentation, others are fundamental. We would strongly encourage you to address all of these prior to publication.</p></disp-quote><p>We again thank the editors and reviewers for their remarks and suggestions. We have updated the manuscript to fully address the comments and remaining concerns. Following the recommendation of the second reviewer, we highlighted the low average number of acceptable amino acids per site associated with the conservation of protein molecular function. Following the suggestions of the third reviewer, we further clarified the effects of functional constraints on the divergence limit both for protein sequences and structures. We also demonstrated, as the third reviewer requested, that even at the same level of structural divergence, orthologs sharing more specific molecular functions display substantially higher levels of long-term sequence identity.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>I find that the authors did a thorough revision of the manuscript. At least now I think I understood the main conclusion of the paper. In enzymes and other proteins with very strong functional conservation, the number of different amino acids acceptable at a position is about 4. It is not because many sites are invariant and some are variable (not a dirty trick of average temperature in a hospital), but because most sites (except the invariant ones) are constrained to use a library of 3 to 5 different amino acids, not more than that. If this is not the bottom line, then the authors need to do better job at crystallizing their main claim and result.</p></disp-quote><p>We thank the reviewer for the comments. Indeed, the observation that only a few (less than 4) amino acids are accepted, on average, per site for proteins with conserved molecular function is one of our main results, which we now highlight in the Abstract. However, as we explained in our previous reply, this is not the only main result or conclusion of our work.</p><p>We apologize for repeating our statements from a previous reply. In the paper we asked several important and interrelated questions: 1) How far can two sequences diverge while continuously maintaining the same specific molecular function? 2) What are the temporal patterns of this divergence across billions of years of evolution? and 3) How do different protein sites contribute to the long-term divergence between orthologs with the same molecular function? Our paper provides corresponding main conclusions: 1) Orthologs that share the same molecular function usually do not diverge beyond ~3.5 Å RMSD and ~25% sequence identity (this translates to 3-4 amino acids, on average, per site). 2) The decrease of sequence identity between diverging orthologs becomes increasingly slow past 1-2 billion years of divergent evolution, such that ancient orthologs have retained approximately the same level of similarity for the past billion years. And 3) the observed long-term sequence similarity is not primarily due to universally conserved sites across all orthologs. Instead, as the reviewer correctly comments, most sites are on average constrained to a library of less than 4 amino acids. We also show that long-term sequence constraints can be partially explained by a site’s fitness effects of mutations and its distance to catalytic residues.</p><disp-quote content-type="editor-comment"><p>If it is, I think it is a meaningful finding that could be explained better to the readers. I guess the second claim is that 3-5 amino acid limit is universal to all enzymes and (conserved!) non-enzymes. I do doubt (as in the original review) the validity of such a strong claim, which could be a result of the authors' bias in selecting families for their analysis. At least for non-enzymes, they selected most conserved proteins (like ribosomal proteins), so of course such selection is biased to get proteins that saturate easily in evolution. The authors try to justify this biased selection suggesting that it is difficult to find orthologs. But that statement by itself totally discredits this study. Why? Because if you cannot find your orthologs, wouldn't it mean that they already diverged beyond (lower than) your claimed 25% identity as the universal limit, and the author's conclusions do not apply to such families? Maybe for the enzymes too, the 25% limit is simply a reflection of the search methods the authors used to find orthologs, that fail to find more distant ones.</p></disp-quote><p>We apologize for the possible confusion. But we discussed this particular concern in the manuscript, and are afraid that the related discussion escaped the attention of the reviewer. First, for almost all analyzed enzymatic protein families, sequence divergence saturates at a relatively high sequence identity (25%-40%); at these sequence identities, protein orthologs can be easily identified by computational sequence comparison methods. Second, when we relax the stringency of the molecular function conservation (e.g. from sharing all digits of an EC number (EC4) to sharing only the first three digits (EC3)), we immediately observe orthologous protein pairs with significantly lower levels of sequence identity (Figure 6). For non-enzymatic protein families, we need to investigate families that conserved specific molecular functions across billions of years of evolution. That is why we are limited in the number of protein families we can consider, not because we cannot find orthologs, but because there are not many such non-enzymatic protein families (beyond known examples such as ribosomes, flavoproteins or chaperones) that continuously conserved specific molecular functions across billions of years of evolution.</p><disp-quote content-type="editor-comment"><p>To improve the presentation and make this paper quite interesting (well, reviewers are not supposed to direct the study, but the authors seem passionate about their work and also seem rather inexperienced in both logical thinking and putting a paper together, so maybe this recommendation could be helpful), I would suggest to base it on two plots.</p><p>1) Between-protein variability.</p><p>The first plot is the histogram of the average estimated number of amino acids allowable per site (without invariant sites, or with) for enzyme families and other protein families. Well, the authors would have to try harder to find orthologs for proteins that manage to diverge below 25%, even my rotation students can do that. This histogram would be expected to have a maximum around 3 to 5, and for some variable proteins it could be around 10 or 15? Right? Then protein families with very low and very high numbers could be discussed with an attempt to give explanations about their uniqueness.</p><p>2) Within-protein variability.</p><p>The second plot is the histogram of estimated number of amino acids allowable per site within a protein family. The authors could either normalize to the average per protein, or select a bin with the maximum count from previous plot (let's say 4). These histograms can be averaged for all families with mean and SD showing for each bin. I would assume there will be a large count for invariant sites for enzymes (at 1), counts for 2 amino acids used, 3, 4, etc. Will this histogram have a single mode? Maybe around 4? Several modes? Will there be sites using more than 10 amino acids? How are these distributed in spatial structure and relative to the active site? Discussion of these details could be quite insightful and interesting.</p><p>If these authors do not wish to make these plots, since this review will be published, maybe someone else will, and we will learn something interesting as a result.</p></disp-quote><p>We thank the reviewer for the suggestions, but would like to first make an editorial comment. We do not think that condescending personal comments, i.e. calling into question the authors’ abilities for logical thinking (see more about it below), are either appropriate or helpful. We do not take these comments personally, but anonymously throwing personal comments is not what science or publishing should be about. We hope that the reviewer agrees. We also believe that publication of peer-reviews by <italic>eLife</italic> and other prominent journals will raise the overall level of scientific discussion, and make reviewers feel responsible for their comments.</p><p>Back to science. The comments above are especially surprising because the suggested analyses were mostly already present in the manuscript. We again think they may have simply escaped the reviewer’s attention. We have now made several further changes to highlight these results:</p><p>1) The between-protein variability in long-term sequence identity (previously Figure 1—figure supplement 2A) is now presented as a main figure in the manuscript (Figure 2A). We have added an additional x-axis (at the top of the figure) to show the corresponding average number of accepted amino acids per site; we also now present the results of an equivalent analysis for non-enzymatic protein families (Figure 2B).</p><p>2) In regards to the comparison between enzymes that conserve their function and proteins that “manage to diverge below 25% identity”, we have now modified Figure 6A to highlight the higher average number of acceptable amino acids for ancient orthologs sharing only three digits of the EC annotation. We also show the sequence identity of proteins with different molecular functions but the same structural fold. Additionally, we compared those differences to the corresponding long-term structural similarities between orthologs (Figure 6B).</p><p>3) In terms of within protein variability, we now comment on the different shapes of the distributions shown in Figure 3—figure supplement 1. We decided not to average these distributions across enzymes, as this would hide an interesting underlying variability in the number of acceptable amino acids across protein families.</p><p>As we describe in the manuscript (see discussion of Figure 6), the aforementioned results demonstrate that the average number of acceptable amino acids per site increases from the case when a specific molecular function is conserved (~3 amino acids for EC4), to conservation of less specific functions (~4 amino acids for EC3), to simply preserving the same protein fold (~10 amino acids). Naturally, a higher long-term sequence identity limit usually corresponds to a smaller average number of acceptable amino acids per site.</p><disp-quote content-type="editor-comment"><p>Currently, there are so many plots in this paper and many of them are not particularly helpful to get the point across quickly. Also I still find the usage of non-standard terms (like divergence rate) confusing, not necessary, and not insightful about the mechanism. Yes, the terms are defined, but they are just masking the reality, which is simpler: constrained usage of amino acids in positions of enzyme molecules. Not all 20, not even 10, but 4! Why not state and illustrate this clearly? Don't you agree that the impact of the paper will increase because it will be easier to understand?</p></disp-quote><p>We appreciate the reviewer’s opinion. As we described above, we now further highlight the aforementioned result about the number of acceptable amino acids. Nevertheless, as we stated previously, this is not the only main result in the paper. There are many other interesting results, analyses, and experiments described in the manuscript. We understand that the reviewer particularly appreciates this result. We do too! But, based on the comments of other reviewers and editors, and discussions with our colleagues, many researchers are likely to be interested in other results as well. Such as the existence of the sequence and structural divergence limits, temporal profiles of long-terms divergence, various structural and functional analyses, correlations with experimentally measured fitness effects, etc. Therefore, we cannot reduce the paper to one particular result or figure. We currently have 6 main figures in the manuscript, which is arguably not many, and, we believe, they can be easily understood by most readers interested in the topic. We hope that all of our analyses are useful and provide different and complementary insights to different researchers.</p><p>In terms of the “divergence rate”, we do not understand this comment. The terms “divergence rate” or “protein divergence rate” are in fact quite standard and popular in molecular evolution. Searches for these terms in Google or PubMed return many hundreds of usages in the same or similar context and in multiple related papers. We now also define it in the text, to prevent any possibility for misinterpretation or confusion.</p><disp-quote content-type="editor-comment"><p>The Abstract is still very poor and misleading. For instance, the statement &quot;The effective divergence limit (&gt;25% sequence identity) is not primarily due to multiple substitutions at the same sites&quot; is completely wrong. According to the authors' explanations, this &quot;effective divergence limit&quot; is exactly due to multiple substitutions at the same site! If you have only 4 amino acids acceptable at a site, due to multiple substitutions sequence identity will saturate are 25%. Like in DNA. Why not write a precise and clear Abstract about what this work presents? Due to so many logical flaws in the authors' thinking and presentation (as illustrated above), I would be scared to publish this paper without a careful read. One statement at a time. And trying to figure out why the statement is wrong. If clearly not wrong, then move on to the next one.</p></disp-quote><p>We apologize for the possible confusion, but we do not believe that our statements are either wrong or illogical. Let’s consider the example given by the reviewer. It is true that DNA sequence identity saturates at 25% under the assumption that all nucleotide substitutions are equally accepted at DNA sites. In this case the limit is indeed directly driven by random and neutral substitutions. But in the case of proteins, this scenario, i.e. acceptance of all amino acids with the same probability, would lead to saturation at 5% sequence identity, and not at 25-40%, which is what we observe for proteins with conserved molecular functions. That is why we said that “the limit is not <italic>primarily</italic> driven by multiple substitutions at the same sites”. Obviously, substitutions at the same sites occur all the time, but the small number of acceptable substitutions is ultimately <italic>not the cause but the consequence</italic> of the functional constraints and the divergence limit. In any case, to eliminate any possibility of confusion here, following the reviewer’s suggestion, we rewrote the Abstract accordingly.</p><disp-quote content-type="editor-comment"><p>And, finally, why not compare your results with this paper more thoroughly PMID: 27138088? Isn't it a bit similar? I guess I don't understand the meaning behind &quot;to investigate the temporal patterns of the long-term divergence.&quot;</p><p>Do the authors still claim that the sites are saturated at the usage of 3 to 5 amino acids because the time passed was not sufficient to gain more changes? Or the time was enough and protein of the same function simply cannot tolerate additional amino acids well and still keep the function? Which one is right? I got an impression it was the latter. And then what I said at the beginning of this review holds. If it is the former, it needs to be convincingly justified.</p></disp-quote><p>We apologize for possible confusion. By “the temporal patterns of the long-term divergence” we mean the changes in sequence and structural similarities between orthologs as a function of time. As we discuss in the paper (see trajectories in Figure 1 and Figure 5A), our results clearly demonstrate that most ancient orthologs are close to saturation, and are unlikely to diverge, at least on planetary timescales, beyond ~25% sequence identity.</p><p>In terms of the paper by Jack et al., as we state in the paper, Jack et al. explored the difference in short-term substitution rates as a function of sites’ distance to catalytic residues. In contrast, our study is focused on the global long-term sequence and structural divergence across billions of years of evolution, the observed divergence limit, its origins, and the related analyses, such as contribution of various sites. Importantly, as we already discussed in our previous reply, the differences in short-term evolutionary rates do not imply the existence of a divergence limit, do not inform about the timing at which the divergence of orthologs saturates, or explain the functional origins of this saturation.</p><disp-quote content-type="editor-comment"><p>If the authors disagree with my review, then I did not understand the paper, which is possible, and still suggests that the authors need to improve the presentation.</p></disp-quote><p>We believe that the reviewer understood the paper, and thank the reviewer again for the comments and suggestions.</p><p>Reviewer #3:</p><disp-quote content-type="editor-comment"><p>This version of the manuscript is a significant improvement over the previous version in terms of added details (e.g. experimental procedure of folA mutagenesis re now described in sufficient detail to be understandable and/or potentially reproducible).</p><p>The authors attempted to address my (and other reviewers) main concern by presenting the analysis in new Figure 5 that shows that full orthologues (all EC numbers coincide) are more sequence-constrained than partial orthologues (3 EC numbers coincide). However this analysis fails to control for different structural divergence between full and partial orthologues.</p><p>Therefore, the most problematic aspect of the analysis – that authors attribute observed sequence conservation in diverging clades to conservation of function between orthologues has not been fully addressed. A clear alternative explanation that such conservation is explained by maintenance of structure and stability regardless of function still stands.</p><p>The authors used a truism by pointing out that proteins of the same FOLD (i.e. topologically similar arrangement of elements of secondary structure) can diverge to 10% or less sequence ID again citing an old work with data collected on very limited number of structures available at that time.</p><p>However, their full functional orthologues are much more similar structurally than proteins sharing the same fold. The correct control which was suggested in my initial review has not been done satisfactorily. Specifically, the authors should compare their sets of proteins with sets that have similar degree of structural similarity (measured as distribution of TM-scores) but different function. There are such examples where structures are quite similar (TM-score-wise) but functions differ significantly. Good examples of that kind ate TIM-barrels which are almost exclusively enzymes with wide variety of specificity and Igfold proteins again with very conserved structures but broadly diverged functional annotations.</p><p>If the authors find that conservation of structure in functionally divergent proteins imposes less sequence divergence constraints than same degree of structural conservation in orthologues – that will be a clear demonstration of additional constraints imposed by functional conservation which is the main message of this work. In the absence of such analysis the current data does not justify the conclusion.</p></disp-quote><p>Following the reviewer’s comments, we now present the suggested analysis (Figure 6C) testing the contribution of function to sequence constrains independent of structural similarity. The results clearly demonstrate that, even at the same level of structural divergence (RMSD), there is significantly higher sequence similarity for pairs of orthologs sharing the full EC annotation, i.e. a higher degree of functional similarity. We have updated the Discussion to reflect this new result.</p><p>Importantly, we would like to emphasize that the main message of our work is not Figure 6C, but the fact that the conservation of specific molecular function limits how far orthologs can diverge both in sequence and structure (i.e. in terms of the RMSD). As we comment in the Discussion, this limit is likely due to the conservation of structural optimality (but not necessarily protein stability, see below), i.e. of the specific structural arrangements and dynamics of protein residues required for efficient catalysis and function. To further emphasize this point, we now show side by side (Figure 6A, 6B) the long-term sequence and structural divergence of orthologs sharing 1.) their full EC numbers, 2.) orthologs sharing only the first three digits of their EC numbers, and 3.) enzymes classified in the same structural fold, but with different molecular functions. These results clearly demonstrate that orthologs maintaining a less stringent level of functional conservation diverge significantly further in both sequence and structure.</p><disp-quote content-type="editor-comment"><p>Minor point: The authors severely misquote Firnberg et al., 2016. They say: &quot;Nevertheless, direct and comprehensive biochemical experiments demonstrated that the deleterious effects of protein mutations primarily result from changes in specific protein activity rather than decreases in protein stability and cellular abundance [Firnberg et al., 2016]&quot;. In fact, the authors of Firnberg et al., 2016, say directly the opposite: '… These DFEs provide insight into the inherent benefits of the genetic code's architecture, support for the hypothesis that mRNA stability dictates codon usage at the beginning of genes, an extensive framework for understanding protein mutational tolerance, and evidence that mutational effects on protein thermodynamic stability shape the DFE..…&quot; (cited from the Abstract of Firnberg et al., 2016). The authors misrepresent the main result of Firnberg et al., 2016: According to Figure 5B of [Firnberg et al., 2016] the product of abundance and catalytic activity shapes fitness effects in TEM1, not abundance alone. This is exactly what is established in Bershtein et al., 2015 and Adkar et al., 2017, and shows that abundance (which is a function of stability) enters fitness landscape on equal footing with catalytic activity, i.e. there is as much selection for abundance (i.e. stability) as it is for kcat/KM and related measures of activity. This misinterpretation somewhat undermines the major premise of the present paper that there is separate selection for activity/function and stability/structure. In reality one cannot disentangle the two because fitness landscape depends on the function (i.e. the product) of the two factors.</p></disp-quote><p>Frankly, we are quite surprised by the Reviewer’s comment. The reviewer suggests that we misquote the Firnberg <italic>et al.</italic> study and cites several sentences from their abstract. We are puzzled by this comment because immediately after the cited text, in fact in the next sentence (!) of the abstract, Fimberg <italic>et al.</italic> directly and clearly state: “<italic>Contrary to prevailing expectations, we find that deleterious effects of mutations primarily arise from a decrease in specific protein activity and not cellular protein levels</italic>”, which is exactly what we are saying in our paper.</p><p>Of course we do not dispute the fact that Fitness ~ Enzyme_Rate= kcat*[E] (under ligand saturation), which is textbook biochemical knowledge. Also we do not dispute that stability effects <italic>do contribute</italic> to protein evolution, we specifically said that in the text and previous reply. However, it is simply not true that because Fitness(x)=kcat(x)*[E(x)] (where “x” a specific mutation), it is not possible to understand the average relative contribution of random mutations to changes in fitness due to functional (kcat) or stability/abundance ([E]) effects. In direct mathematical terms: if P(x)=A(x)*B(x) it is clearly possible to disentangle the relative contribution of A and B to the variance in P due to changes in x. In fact, the experiments in Figure 5 of Firnberg <italic>et al.</italic> were specifically designed to do that, and they directly support the primary contributions of effects related to protein activity. The different, and in fact sometimes opposite, contributions of stability and activity to protein evolution are also illustrated by several examples of enzymatic optimization where protein stability is traded for an increase in catalytic efficiency (see for example PMID: 26940154, PMID: 20036254).</p><p>In our view, the discussion above is not a minor point. These results support our conceptual model of the observed limit. We also think the Reviewer maybe is confused that mutations can affect protein function (i.e. kcat) only through purely sequence effect. In fact, sequence substitutions affect the average protein structure and dynamics (but again not necessarily protein stability!) and make the structure not optimal for catalysis and function. Furthermore, we would like to emphasize again that there is no specific selection in evolution for protein stability, i.e. evolution does not just select proteins to be stable <italic>per se</italic>. Obviously, proteins need to have a certain level of stability for functioning, but, based on the Fimberg <italic>et al.</italic> results, the selection for protein stability is not the only and likely not the main target of functional selection.</p></body></sub-article></article>