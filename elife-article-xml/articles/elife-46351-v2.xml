<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">46351</article-id><article-id pub-id-type="doi">10.7554/eLife.46351</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Replay as wavefronts and theta sequences as bump oscillations in a grid cell attractor network</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-132728"><name><surname>Kang</surname><given-names>Louis</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5702-2740</contrib-id><email>louis.kang@berkeley.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-16404"><name><surname>DeWeese</surname><given-names>Michael R</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Redwood Center for Theoretical Neuroscience, Helen Wills Neuroscience Institute</institution><institution>University of California, Berkeley</institution><addr-line><named-content content-type="city">Berkeley</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Physics</institution><institution>University of California, Berkeley</institution><addr-line><named-content content-type="city">Berkeley</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Deshmukh</surname><given-names>Sachin</given-names></name><role>Reviewing Editor</role><aff><institution>Indian Institute of Science Bangalore</institution><country>India</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Colgin</surname><given-names>Laura L</given-names></name><role>Senior Editor</role><aff><institution>University of Texas at Austin</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>18</day><month>11</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e46351</elocation-id><history><date date-type="received" iso-8601-date="2019-03-01"><day>01</day><month>03</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2019-11-15"><day>15</day><month>11</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Kang and DeWeese</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Kang and DeWeese</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-46351-v2.pdf"/><abstract><p>Grid cells fire in sequences that represent rapid trajectories in space. During locomotion, theta sequences encode sweeps in position starting slightly behind the animal and ending ahead of it. During quiescence and slow wave sleep, bouts of synchronized activity represent long trajectories called replays, which are well-established in place cells and have been recently reported in grid cells. Theta sequences and replay are hypothesized to facilitate many cognitive functions, but their underlying mechanisms are unknown. One mechanism proposed for grid cell formation is the continuous attractor network. We demonstrate that this established architecture naturally produces theta sequences and replay as distinct consequences of modulating external input. Driving inhibitory interneurons at the theta frequency causes attractor bumps to oscillate in speed and size, which gives rise to theta sequences and phase precession, respectively. Decreasing input drive to all neurons produces traveling wavefronts of activity that are decoded as replays.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>grid cell</kwd><kwd>replay</kwd><kwd>phase precession</kwd><kwd>theta sequence</kwd><kwd>continuous attractor</kwd><kwd>wavefront</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007247</institution-id><institution>Adolph C. and Mary Sprague Miller Institute for Basic Research in Science, University of California Berkeley</institution></institution-wrap></funding-source><award-id>Postdoctoral fellowship</award-id><principal-award-recipient><name><surname>Kang</surname><given-names>Louis</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000183</institution-id><institution>Army Research Office</institution></institution-wrap></funding-source><award-id>W911NF-13-1-0390</award-id><principal-award-recipient><name><surname>DeWeese</surname><given-names>Michael R</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>An experimentally supported model of grid cells naturally enables them to participate in firing sequences that encode rapid trajectories in space.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The hippocampal region contains spatially tuned cells that generally encode an animal’s position in its spatial environment. Place cells in the hippocampal formation fire at one or a few locations (<xref ref-type="bibr" rid="bib67">O'Keefe and Dostrovsky, 1971</xref>), and grid cells in the medial entorhinal cortex (MEC) fire at many locations that form a triangular lattice in space (<xref ref-type="bibr" rid="bib42">Hafting et al., 2005</xref>). However, at short timescales, these neurons fire in coordinated sequences that represent trajectories away from the current animal position.</p><p>The first type of sequence occurs when the animal is moving and the local field potential (LFP) of the hippocampal region is dominated by an oscillation of 5–11 Hz, the theta range (<xref ref-type="bibr" rid="bib103">Vanderwolf, 1969</xref>; <xref ref-type="bibr" rid="bib66">O'Keefe, 1976</xref>; <xref ref-type="bibr" rid="bib104">Vinogradova, 1995</xref>). During every cycle of this oscillation, neurons corresponding to locations slightly behind the animal fire first, followed by those corresponding to the current location and finally locations ahead of the animal (<xref ref-type="bibr" rid="bib93">Skaggs et al., 1996</xref>; <xref ref-type="bibr" rid="bib69">O'Neill et al., 2017</xref>). These so-called theta sequences involving many neurons are related to a single-neuron phenomenon called phase precession (<xref ref-type="bibr" rid="bib68">O'Keefe and Recce, 1993</xref>; <xref ref-type="bibr" rid="bib43">Hafting et al., 2008</xref>). When an animal first enters the firing field of a place or grid cell, the neuron spikes late in the theta cycle. As the animal moves through the field, subsequent spikes tend to arrive at smaller theta phase, or earlier within a cycle. Thus, activity within each theta cycle starts with neurons whose peak firing occurs behind the animal and ends with neurons whose peak firing occurs ahead of the animal, which is a theta sequence (<xref ref-type="bibr" rid="bib93">Skaggs et al., 1996</xref>).</p><p>The second type of sequence occurs when the animal is idle and not moving, a state called quiet wakefulness or quiescence; it also occurs during slow wave sleep, which will not concern us here. During idle periods, the LFP of the hippocampal region loses theta oscillations but is instead intermittently punctuated by sharp-wave ripples with power across 140–200 Hz (<xref ref-type="bibr" rid="bib12">Buzsáki, 1986</xref>; <xref ref-type="bibr" rid="bib19">Chrobak and Buzsáki, 1996</xref>). During these events, spatially tuned neurons fire in coordinated bursts that represent rapid, long-distance trajectories. These replays are well-established in place cells (<xref ref-type="bibr" rid="bib58">Lee and Wilson, 2002</xref>; <xref ref-type="bibr" rid="bib36">Foster and Wilson, 2006</xref>) and have recently been observed in grid cells within superficial layers of the MEC (<xref ref-type="bibr" rid="bib69">O'Neill et al., 2017</xref>). Note that replays can also involve grid cells within <italic>deep</italic> layers of the MEC (<xref ref-type="bibr" rid="bib71">Ólafsdóttir et al., 2016</xref>); these findings, which have been disputed (<xref ref-type="bibr" rid="bib99">Trimper et al., 2017</xref>), will not be addressed by this work.</p><p>Hippocampal experiments on theta sequences and replay have established a rich phenomenology, which includes their properties near branch points of a maze (<xref ref-type="bibr" rid="bib111">Wu and Foster, 2014</xref>; <xref ref-type="bibr" rid="bib6">Belchior et al., 2014</xref>), their modulation by reward history (<xref ref-type="bibr" rid="bib52">Johnson and Redish, 2007</xref>; <xref ref-type="bibr" rid="bib106">Wikenheiser and Redish, 2015a</xref>; <xref ref-type="bibr" rid="bib1">Ambrose et al., 2016</xref>; <xref ref-type="bibr" rid="bib110">Wu et al., 2017</xref>), their ability to predict future actions (<xref ref-type="bibr" rid="bib77">Pfeiffer and Foster, 2013</xref>; <xref ref-type="bibr" rid="bib92">Singer et al., 2013</xref>; <xref ref-type="bibr" rid="bib107">Wikenheiser and Redish, 2015b</xref>; <xref ref-type="bibr" rid="bib112">Xu et al., 2019</xref>), and their potential role in disease pathogenesis (<xref ref-type="bibr" rid="bib63">Middleton et al., 2018</xref>). These findings suggest that hippocampal sequences facilitate many cognitive functions, such as memory consolidation, credit assignment, and action planning (<xref ref-type="bibr" rid="bib34">Foster, 2017</xref>; <xref ref-type="bibr" rid="bib73">Ólafsdóttir et al., 2018</xref>; <xref ref-type="bibr" rid="bib119">Zielinski et al., 2018</xref>). However, the mechanisms that produce theta sequences and replay among place and grid cells are still unclear.</p><p>Meanwhile, a mechanism for producing grid cells themselves, the continuous attractor model, has been accumulating experimental support (<xref ref-type="bibr" rid="bib23">Couey et al., 2013</xref>; <xref ref-type="bibr" rid="bib115">Yoon et al., 2013</xref>; <xref ref-type="bibr" rid="bib49">Heys et al., 2014</xref>; <xref ref-type="bibr" rid="bib29">Dunn et al., 2015</xref>; <xref ref-type="bibr" rid="bib37">Fuchs et al., 2016</xref>; <xref ref-type="bibr" rid="bib120">Zutshi et al., 2018</xref>; <xref ref-type="bibr" rid="bib41">Gu et al., 2018</xref>). This class of networks posits particular configurations of synapses within the MEC that are local and symmetric (<xref ref-type="bibr" rid="bib9">Burak and Fiete, 2009</xref>; <xref ref-type="bibr" rid="bib105">Widloski and Fiete, 2014</xref>). By incorporating key biological features such as fully spiking neural dynamics, we find that new phenomena emerge in this recurrent architecture: grid cells will exhibit either theta sequences or replays depending on the external input provided by other brain regions. These inputs correspond to experimentally measured changes between active and inactive behavior (<xref ref-type="bibr" rid="bib96">Steriade et al., 2001</xref>; <xref ref-type="bibr" rid="bib91">Simon et al., 2006</xref>) and do not involve changes in connectivity. From this perspective, the same architecture that produces grid cells causes them to participate in sequences that may be leveraged by other brain regions, such as the hippocampus, to pursue desired cognitive goals.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Our fully spiking continuous attractor model produces grid cells</title><p>We first describe our implementation of a continuous attractor network and demonstrate that it reproduces classic grid responses when a simulated animal explores a 2D open field. Model details are provided in Materials and methods and <xref ref-type="table" rid="table1">Table 1</xref>. We simulate a single grid module—that is, grid cells of one scale and orientation (<xref ref-type="bibr" rid="bib95">Stensola et al., 2012</xref>)—with a continuous attractor network based on <xref ref-type="bibr" rid="bib9">Burak and Fiete (2009)</xref> and <xref ref-type="bibr" rid="bib105">Widloski and Fiete (2014)</xref>. Neurons are assembled in a 2D sheet with five overlapping populations, of which four represent excitatory principal cells and one represents inhibitory interneurons (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Each excitatory neuron excites its neighbors across all populations, and each inhibitory neuron inhibits only excitatory neurons located a certain distance away. We will address the purpose of having four slightly different excitatory populations shortly.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Main model parameters and their values unless otherwise noted.</title><p>Values that change between runs, idle periods, and allocentric corrections are indicated accordingly.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>Variable</th><th>Value</th></tr></thead><tbody><tr><td>Neurons per population</td><td><inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf2"><mml:mrow><mml:mn>232</mml:mn><mml:mo>×</mml:mo><mml:mn>232</mml:mn></mml:mrow></mml:math></inline-formula></td></tr><tr><td>Simulation timestep</td><td><inline-formula><mml:math id="inf3"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula></td><td>1 ms</td></tr><tr><td>Exc. membrane time constant</td><td><inline-formula><mml:math id="inf4"><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>m</mml:mtext><mml:mo>+</mml:mo></mml:msubsup></mml:math></inline-formula></td><td>40 ms</td></tr><tr><td>Inh. membrane time constant</td><td><inline-formula><mml:math id="inf5"><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>m</mml:mtext><mml:mo>-</mml:mo></mml:msubsup></mml:math></inline-formula></td><td>20 ms</td></tr><tr><td>Exc.-to-exc. synaptic delay</td><td><inline-formula><mml:math id="inf6"><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>s</mml:mtext><mml:mrow><mml:mi/><mml:mo>+</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td>5 ms</td></tr><tr><td>Exc.-to-inh. synaptic delay</td><td><inline-formula><mml:math id="inf7"><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>s</mml:mtext><mml:mrow><mml:mi/><mml:mo>-</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td>2 ms</td></tr><tr><td>Inh. synaptic delay</td><td><inline-formula><mml:math id="inf8"><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>s</mml:mtext><mml:mo>-</mml:mo></mml:msubsup></mml:math></inline-formula></td><td>2 ms</td></tr><tr><td>Exc. drive maximum</td><td><inline-formula><mml:math id="inf9"><mml:msubsup><mml:mi>a</mml:mi><mml:mtext>max</mml:mtext><mml:mo>+</mml:mo></mml:msubsup></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf10"><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mn>2.0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>runs</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>1.6</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>idle</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>2.0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>allo.</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></inline-formula></td></tr><tr><td>Exc. drive minimum</td><td><inline-formula><mml:math id="inf11"><mml:msubsup><mml:mi>a</mml:mi><mml:mtext>min</mml:mtext><mml:mo>+</mml:mo></mml:msubsup></mml:math></inline-formula></td><td>0.8</td></tr><tr><td>Exc. drive scaled spread</td><td><inline-formula><mml:math id="inf12"><mml:msub><mml:mi>ρ</mml:mi><mml:msup><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:msub></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf13"><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mn>1.2</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>runs</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0.9</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>idle</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></inline-formula></td></tr><tr><td>Inh. drive magnitude</td><td><inline-formula><mml:math id="inf14"><mml:msubsup><mml:mi>a</mml:mi><mml:mtext>mag</mml:mtext><mml:mo>-</mml:mo></mml:msubsup></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf15"><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mn>0.72</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>runs</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0.0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>idle</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0.72</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>allo.</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></inline-formula></td></tr><tr><td>Inh. drive theta amplitude</td><td><inline-formula><mml:math id="inf16"><mml:msubsup><mml:mi>a</mml:mi><mml:mtext>th</mml:mtext><mml:mo>-</mml:mo></mml:msubsup></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf17"><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mn>0.2</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>runs</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>idle</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>allo.</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></inline-formula></td></tr><tr><td>Inh. drive theta frequency</td><td><inline-formula><mml:math id="inf18"><mml:mi>f</mml:mi></mml:math></inline-formula></td><td>8 Hz</td></tr><tr><td>Exc. synaptic strength</td><td><inline-formula><mml:math id="inf19"><mml:msubsup><mml:mi>w</mml:mi><mml:mtext>mag</mml:mtext><mml:mo>+</mml:mo></mml:msubsup></mml:math></inline-formula></td><td>0.2</td></tr><tr><td>Exc. synaptic spread</td><td><inline-formula><mml:math id="inf20"><mml:msub><mml:mi>r</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:msub></mml:math></inline-formula></td><td>6</td></tr><tr><td>Inh. synaptic strength</td><td><inline-formula><mml:math id="inf21"><mml:msubsup><mml:mi>w</mml:mi><mml:mtext>mag</mml:mtext><mml:mo>-</mml:mo></mml:msubsup></mml:math></inline-formula></td><td>2.8</td></tr><tr><td>Inh. synaptic distance</td><td><inline-formula><mml:math id="inf22"><mml:msub><mml:mi>r</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:msub></mml:math></inline-formula></td><td>12</td></tr><tr><td>Exc. synaptic shift</td><td><inline-formula><mml:math id="inf23"><mml:mi>ξ</mml:mi></mml:math></inline-formula></td><td>3</td></tr><tr><td>Exc. velocity gain</td><td><inline-formula><mml:math id="inf24"><mml:mi>α</mml:mi></mml:math></inline-formula></td><td>0.25 s/m</td></tr><tr><td>Exc. noise magnitude</td><td><inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.002<sup>2</sup></td></tr><tr><td>Inh. noise magnitude</td><td><inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>ζ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.002<sup>2</sup></td></tr></tbody></table></table-wrap><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Model architecture and generation of 2D grid cells.</title><p>(<bold>A</bold>) Our model consists of a neural sheet with five overlapping populations, four of them excitatory—N, W, S, and E—and one inhibitory. Each density plot depicts the synaptic outputs in the sheet of a neuron at the origin. (<bold>B</bold>) Each neuron is driven to a particular membrane potential, which exceeds the spiking threshold for excitatory neurons at the center of the sheet and oscillates at 8 Hz for inhibitory neurons while the animal is running. (<bold>C</bold>) Snapshot of neural activity showing S and inhibitory populations separately; other excitatory populations have activity patterns similar to that of the S population. Each pixel is a neuron and dark colors indicate recent spiking. (<bold>D</bold>) Left, segment of a 2D open field trajectory. Right, neural activity over the course of the segment with each neuron colored according to the position at which it attained its maximum firing rate. Each attractor bump moves in synchrony with animal motion. (<bold>E</bold>) Left, two sample grid cells with spikes shown as colored dots superimposed on the animal’s trajectory. Each neuron’s location in the sheet is indicated by a circle of corresponding color in D. Right, autocorrelation of rate maps calculated from spikes at left. Black scale bars, 50 neurons. White scale bars, 50 cm.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>2D firing maps for many grid cells.</title><p>Spatial firing maps for a 2D open field trajectory. Twenty grid cells are selected from the simulation depicted in <xref ref-type="fig" rid="fig1">Figure 1D,E</xref> across all four excitatory populations. For each grid cell, spikes superimposed on the animal’s trajectory (left) and autocorrelation of rate maps calculated from spikes (right).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig1-figsupp1-v2.tif"/></fig><media id="fig1video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-46351-fig1-video1.mp4"><label>Figure 1—video 1.</label><caption><title>Emergence of a grid-like pattern on the neural sheet from randomly initialized membrane potentials.</title><p>Neural activities of the W and inhibitory populations over the first 240 ms of simulation setup. Each pixel is a neuron, with black corresponding to current spikes and lightest gray corresponding to spikes 40 ms ago. Defects in the grid are then removed as described in the Model details subsection of Appendix 1 before the main simulation begins.</p></caption></media><media id="fig1video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-46351-fig1-video2.mp4"><label>Figure 1—video 2.</label><caption><title>Path integration over an open field trajectory produces 2D grid cells.</title><p>Left, neural activity of the W population. Each pixel is a neuron, with black corresponding to current spikes and lightest gray corresponding to spikes 40 ms ago. Red circle indicates the location of a single recorded neuron. Right, open field trajectory in an enclosure of diameter 1.8 m with a black square indicating the current animal position. Red dots indicate animal positions during spikes recorded from the neuron.</p></caption></media></fig-group><p>To accurately simulate rapid sequences of spikes, we implement fully spiking grid cells that obey leaky integrate-and-fire dynamics. Each neuron has a membrane potential that tends toward a steady-state value called the drive, which represents a combination of resting potential and broad input from other brain regions (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). If the potential exceeds a threshold of 1 in arbitrary units, a spike is emitted, the potential is reset to 0, and the neuron’s targets experience a postsynaptic jump in potential after a brief synaptic delay. During locomotion, excitatory principal cells are driven to fire by various cortical and subcortical inputs (<xref ref-type="bibr" rid="bib56">Kerr et al., 2007</xref>; <xref ref-type="bibr" rid="bib7">Bonnevie et al., 2013</xref>). Thus, their drive exceeds threshold at the center of the neural sheet; it decays towards the edges to avoid edge effects that disrupt continuous attractor dynamics (<xref ref-type="bibr" rid="bib9">Burak and Fiete, 2009</xref>). Meanwhile, inhibitory interneurons have subthreshold drive that oscillates at a theta frequency of 8 Hz due to input from the medial septum (<xref ref-type="bibr" rid="bib8">Brandon et al., 2011</xref>; <xref ref-type="bibr" rid="bib57">Koenig et al., 2011</xref>; <xref ref-type="bibr" rid="bib39">Gonzalez-Sulser et al., 2014</xref>; <xref ref-type="bibr" rid="bib101">Unal et al., 2015</xref>). With this architecture and random initial membrane potentials, the neural sheet naturally develops local regions of activity, called bumps, that are arranged in a triangular lattice and are coherent across populations (<xref ref-type="fig" rid="fig1">Figure 1C</xref> and <xref ref-type="video" rid="fig1video1">Figure 1—video 1</xref>). This self-organized grid is an attractor state of the network.</p><p>How do we produce neurons with grid-like spatial tuning from the grid-like activity pattern on the neural sheet? This transformation is performed by the four excitatory populations, each of which corresponds to a perpendicular direction along the neural sheet and a perpendicular direction in the spatial environment. Excitatory neurons have output synapses biased in their preferred sheet direction (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), and they receive more input when the animal moves along their preferred spatial direction. When the animal moves along, say, the 'North' direction, neurons in the N population have increased drive; since their outputs are biased in the 'up' direction on the neural sheet, the activity pattern moves up. In this way, the activity pattern on the sheet moves synchronously with the animal’s 2D trajectory (<xref ref-type="fig" rid="fig1">Figure 1D</xref>), and the grid pattern is projected onto single neuron spatial responses (<xref ref-type="fig" rid="fig1">Figure 1E</xref> and <xref ref-type="video" rid="fig1video2">Figure 1—video 2</xref>). Each active neuron in the sheet is a grid cell with the same scale and orientation (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p></sec><sec id="s2-2"><title>Grid cells are spatially tuned and theta-modulated along a linear track</title><p>For the rest of the paper, we simulate 1D trajectories consisting of runs along a linear track separated by idle periods at either end (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). As in the 2D case, attractor bumps on the neural sheet move synchronously with animal motion. But over the course of a simulation, the grid-like pattern on the neural sheet drifts (<xref ref-type="bibr" rid="bib9">Burak and Fiete, 2009</xref>) such that for a given track position, the corresponding bump locations on the neural sheet slowly change. This drift introduces errors in path-integration (<xref ref-type="bibr" rid="bib47">Hardcastle et al., 2015</xref>), which are believed to be corrected by allocentric input from border cells (<xref ref-type="bibr" rid="bib70">Ocko et al., 2018</xref>; <xref ref-type="bibr" rid="bib54">Keinath et al., 2018</xref>), boundary vector cells (<xref ref-type="bibr" rid="bib32">Evans et al., 2016</xref>), or landmark cells (<xref ref-type="bibr" rid="bib81">Raudies and Hasselmo, 2015</xref>; <xref ref-type="bibr" rid="bib86">Savelli et al., 2017</xref>). Thus, we implement brief allocentric corrections in our model. Attractor bump locations on the neural sheet that correspond to either end of the track are learned during simulation setup. They are periodically reintroduced during the main simulation as excitatory input between idle periods and runs (<xref ref-type="fig" rid="fig2">Figure 2A,B</xref>; see Materials and methods). In Appendix 2, we present a version of our model without allocentric corrections that still demonstrates many of our results, though to a weaker degree.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Grid cells along a 1D track.</title><p>(<bold>A</bold>) Trajectory consisting of runs along a track separated by idle periods at either end. Between the end of an idle period and the start of a run, the network receives brief allocentric input. (<bold>B</bold>) Allocentric input corrects the location of attractor bumps on the neural sheet (Materials and methods). (<bold>C</bold>) Left, track diagram. Right, neural activity over runs with each neuron colored according to the track position at which it attained maximum firing rate. Red circles indicate regions of recording. Scale bar, 50 neurons. (<bold>D</bold>) Firing fields of recorded grid cells sorted by position of maximum rate. (<bold>E</bold>) Multiunit activity of neurons in D averaged over theta cycles, which span from one trough of the oscillating inhibitory drive to the next. Data is repeated over two cycles for clarity.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Firing fields for multiple simulations.</title><p>Firing fields of recorded grid cells along a 1D track. Fields are sorted by position of maximum rate. (<bold>A</bold>) Representative simulations exhibiting one field. (<bold>B</bold>) Representative simulations exhibiting two fields.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig2-figsupp1-v2.tif"/></fig></fig-group><p>Grid cells at different locations in the sheet generally correspond to different positions along the track (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). From four regions in the sheet chosen for recording, we select up to 150 excitatory neurons whose spatial firing fields are stable from lap to lap and collectively tile the track (<xref ref-type="fig" rid="fig2">Figure 2D</xref>; Materials and methods). Over replicate simulations with different random initial membrane potentials, many simulations contain only grid cells with single fields as in <xref ref-type="fig" rid="fig2">Figure 2D</xref>. In other replicates, the attractor grid self-organizes on the neural sheet with an orientation such that two attractor bumps pass over recorded neurons and produce two fields (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>; Appendix 1). All of our single-simulation examples presented below in the main text correspond to the simulation depicted in <xref ref-type="fig" rid="fig2">Figure 2D</xref> that exhibits single fields. Similarly, the grid cells in <xref ref-type="bibr" rid="bib69">O'Neill et al. (2017)</xref>, with which we will primarily compare our results, often possess a single dominant field along an arm of a T-maze. However, both types of simulations contribute to our results, and we will provide examples for simulations exhibiting two fields in our figure supplements.</p><p>At the theta timescale, grid cell activity is highest when the oscillating inhibitory drive is lowest and excitatory cells are most disinhibited (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). This observation allows us identify theta phases in our simulations with those defined through LFP measurements. Experimentally, grid cells (<xref ref-type="bibr" rid="bib43">Hafting et al., 2008</xref>) and place cells (<xref ref-type="bibr" rid="bib14">Buzsáki, 2002</xref>; <xref ref-type="bibr" rid="bib33">Feng et al., 2015</xref>) are most active at troughs of the theta-filtered LFP, which can be explained in terms of extracellular currents generated by neural activity (<xref ref-type="bibr" rid="bib15">Buzsáki et al., 2012</xref>). <xref ref-type="bibr" rid="bib69">O'Neill et al. (2017)</xref> define theta cycles to span from trough to trough of the LFP. Accordingly, we align our theta cycles to start with phase 0° at troughs of the inhibitory drive (<xref ref-type="fig" rid="fig2">Figure 2E</xref>).</p></sec><sec id="s2-3"><title>Theta phase precession arises from oscillations in attractor bump size</title><sec id="s2-3-1"><title>Phase precession results</title><p>During runs, activity passes through recorded neurons as attractor bumps move along the neural sheet (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, and <xref ref-type="video" rid="video1">Video 1</xref>). However, spike trains from single neurons exhibit finer temporal organization with respect to the theta oscillation in a variety of ways (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, and <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). Many neurons are phase-independent and fire throughout the theta cycle. Some are phase-locking and strongly prefer to fire at 360° (equivalently, 0° or 720°). Finally, some exhibit phase precession with a preferred phase that starts around 360° when the animal enters a grid field but decreases as the animal progresses through it.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>During runs, certain neurons exhibit theta phase locking and precession.</title><p>(<bold>A</bold>) Grid cell spike rasters for four laps along the track. Vertical blue lines indicate theta cycle boundaries. (<bold>B</bold>) Relationship between animal position along the track and theta phase for representative neurons. Dots represent spikes during runs in the directions indicated by arrows, with each spike repeated at two equivalent phases for clarity. Lines indicate fit by circular-linear regression. Numbers in each panel from top left to top right indicate magnitudes of correlation coefficients, regression fit scores, and regression slopes. (<bold>C–E</bold>) Data across all replicate simulations. (<bold>C</bold>) Magnitudes of circular-linear correlation coefficients. Mean ± s.d.: 0.17 ± 0.11. (<bold>D</bold>) Fit scores for circular-linear regression. (<bold>E</bold>) Regression slopes in units of field size for neurons with fit score &gt;0.4. The predominance of negative values for rightward runs and positive for leftward runs indicates decreasing phase as the animal traverses grid fields in either direction. (<bold>F</bold>) Spike densities for different subgroups. An animal enters a grid field at progress 0% and exits it at 100%.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Spike rasters over multiple runs.</title><p>Vertical blue lines indicate theta cycle boundaries. (<bold>A</bold>) Representative simulation exhibiting one field. (<bold>B</bold>) Representative simulation exhibiting two fields.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Position-phase relationships during rightward runs for many neurons.</title><p>Relationship between animal position along the track and theta phase during rightward runs. Dots represent spikes during runs in the directions indicated by arrows, with each spike repeated at two equivalent phases for clarity. Lines indicate fit by circular-linear regression. Numbers in each panel from top left to top right indicate magnitudes of correlation coefficients, regression fit scores, and precession ranges. (<bold>A</bold>) Representative neurons from simulations exhibiting one field. (<bold>B</bold>) Representative neurons from simulations exhibiting two fields.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Position-phase relationships during leftward runs for many neurons.</title><p>Relationship between animal position along the track and theta phase during leftward runs. Panels same as in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig3-figsupp3-v2.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 4.</label><caption><title>Further analysis of subgroups with different phase relationships.</title><p>Further analysis of subgroups of phase-independent, phase-locking, and phase-precessing neurons. (<bold>A,B</bold>) Distributions of regression slopes using a fit score cutoff different from 0.4, which was used in <xref ref-type="fig" rid="fig3">Figure 3</xref>. (<bold>C</bold>) Neural sheet locations of neurons belonging to each subgroup for the simulation described in <xref ref-type="fig" rid="fig3">Figure 3A,B</xref>. Data encompassing recording areas shown in <xref ref-type="fig" rid="fig2">Figure 2C</xref> and recording areas offset by 45° on the neural sheet. Left, track diagram. Right, neural activity over runs with each neuron colored according to the track position at which it attained maximum firing rate. Scale bar, 50 neurons. (<bold>D–G</bold>) Distribution of neurons in each subgroup with respect to various properties. Medians for each subgroup indicated by dashed lines. Medians for phase-locking and phase-precessing subgroups compared by the Mann-Whitney <italic>U</italic> test with reported <italic>p</italic>-value. (<bold>D</bold>) Mean firing rate. (<bold>E</bold>) Distance from the center of the neural sheet divided by the half the neural sheet size <italic>n</italic>. (<bold>F</bold>) Angle on the neural sheet relative to the right direction, or <inline-formula><mml:math id="inf27"><mml:mrow><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. (<bold>G</bold>) Location relative to attractor bumps in units of relative firing rate. A value of 1 means that the center of a bump passes over the neuron, and a value of 0 means that no part of a bump passes over the neuron (Appendix 1).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig3-figsupp4-v2.tif"/></fig><fig id="fig3s5" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 5.</label><caption><title>Dependence of phase relationships on excitatory population and number of fields.</title><p>Box-whisker plots with lines at medians, boxes between first to third quartiles, and whiskers between the entire data range excluding outliers lying more than 1.5 times the interquartile distance beyond the first or third quartile. Medians compared by the Mann-Whitney <italic>U</italic> test with reported <italic>p</italic>-values. (<bold>A–F</bold>) Analysis of phase relationships with respect to excitatory population. For these simulations, the direction of animal velocity is 0°, which means that runs are aligned to the E and W directions. The ‘along’ category corresponds to both the E population when the animal is running towards E and the W population when the animal is running towards W. The ‘against’ category corresponds to the E and W populations during the opposite running directions. The ‘perp.’ category corresponds to the N and S directions. (<bold>A</bold>) Number of valid recorded neurons. Note that there are very few ‘against’ neurons due to low firing rate, and this category is excluded from further analysis. (<bold>B</bold>) Number of spikes per neuron. (<bold>C</bold>) Magnitude of correlation coefficient. (<bold>D</bold>) Fraction of phase locking neurons. (<bold>E</bold>) Fraction of phase precessing neurons. (<bold>F</bold>) Phase precession range. (<bold>G–J</bold>) Analysis of phase relationships with respect to number of fields exhibited by a simulation. (<bold>G</bold>) Magnitude of correlation coefficient. (<bold>H</bold>) Fraction of phase locking neurons. (<bold>I</bold>) Fraction of phase precessing neurons. (<bold>J</bold>) Phase precession range.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig3-figsupp5-v2.tif"/></fig><fig id="fig3s6" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 6.</label><caption><title>Phase relationship properties over different simulation parameters.</title><p>Correlation coefficient magnitude, precession range, fraction of phase-locking neurons, and fraction of precessing neurons as functions of various simulation parameters. Points at mean values with bars indicating s.d. over replicate simulations. Small horizontal offsets added for clarity. (<bold>A</bold>) Animal speed and track orientation relative to the E direction, or <inline-formula><mml:math id="inf28"><mml:mrow><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) Excitatory drive and recording distance from the center of the neural sheet divided by the half the neural sheet size.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig3-figsupp6-v2.tif"/></fig><fig id="fig3s7" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 7.</label><caption><title>Phase relationship properties over different simulation parameters, continued.</title><p>Same as <xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>, except as functions of different parameters. (<bold>A</bold>) Inhibitory theta amplitude and inhibitory drive. (<bold>B</bold>) Inhibitory and excitatory membrane time constants.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig3-figsupp7-v2.tif"/></fig></fig-group><media id="video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-46351-video1.mp4"><label>Video 1.</label><caption><title>Neural activity during runs, idle periods, and allocentric corrections.</title><p>Left, position of the animal (black square) along a 1D track. Right, neural activity of the E population. Each pixel is a neuron, with black corresponding to current spikes and lightest gray corresponding to spikes 40 ms ago. Red circles indicate regions of recording.</p></caption></media><p>We first quantify these relationships using circular-linear correlation (<xref ref-type="disp-formula" rid="equ13">Equation 13</xref>), which indicates whether theta phase changes with position (<xref ref-type="bibr" rid="bib55">Kempter et al., 2012</xref>). Our correlation magnitudes 0.17 ± 0.11 (mean ± s.d.; <xref ref-type="fig" rid="fig3">Figure 3C</xref>) are low compared to experiments, which report grid cells with mean ≈0.3 and place cells with mean ≈0.4 (<xref ref-type="bibr" rid="bib69">O'Neill et al., 2017</xref>). This difference arises from two sources. Figure S10 of <xref ref-type="bibr" rid="bib69">O'Neill et al. (2017)</xref> shows some highly correlated neurons with magnitudes up to 0.8; these are absent from our simulations. It also shows fewer neurons with correlation value close to 0, which corresponds to either phase-independent or phase-locking neurons. Since both subgroups lack a preferred theta phase that consistently changes with position, circular-linear correlation cannot distinguish between them (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, top two rows).</p><p>To further characterize phase behavior, we use circular-linear regression (<xref ref-type="bibr" rid="bib55">Kempter et al., 2012</xref>), which can differentiate between all three subgroups of phase relationships presented in <xref ref-type="fig" rid="fig3">Figure 3B</xref>. Phase-independent neurons are defined to have a regression fit score less than a cutoff of 0.4 (<xref ref-type="fig" rid="fig3">Figure 3D</xref>; <xref ref-type="disp-formula" rid="equ11">Equation 11</xref>). Neurons with high fit score are then distinguished as either phase-locking or precessing by the absolute value of their regression slope in units of field size, which is called the phase precession range (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). We use a range of 60° as the cutoff. Experimentally, phase-locking and precessing neurons are found in Layers III and II (LIII and LII), respectively (<xref ref-type="bibr" rid="bib43">Hafting et al., 2008</xref>). A wide variety of phase precession ranges are reported across subtypes of LII neurons with medians spanning from 50° for pyramidal cells (<xref ref-type="bibr" rid="bib30">Ebbesen et al., 2016</xref>) to 170° for stellate cells (<xref ref-type="bibr" rid="bib83">Reifenstein et al., 2016</xref>). Our cutoff is close to the lower limit of this span. Yet, regardless of the cutoff value, regression slopes are biased towards negative values for rightward laps and positive values for leftward laps, which means that the preferred firing phase tends to decrease as an animal moves through a grid field. This directional tendency is a key biological feature of phase precession seen experimentally (<xref ref-type="bibr" rid="bib43">Hafting et al., 2008</xref>), and it is also maintained for other cutoff values applied to the fit score (<xref ref-type="fig" rid="fig3s4">Figure 3–Figure Supplement 4A,B</xref>).</p><p>We also construct spike density plots using all neurons in each subgroup (<xref ref-type="fig" rid="fig3">Figure 3F</xref>). These plots show that phase-locking neurons have a preferred phase around 360° throughout the field and that phase-precessing neurons have a preferred phase also around 360° at field entry. This value corresponds to theta troughs when excitatory neurons are most disinhibited (<xref ref-type="fig" rid="fig2">Figure 2E</xref>) and matches measurements for LIII and LII neurons (<xref ref-type="bibr" rid="bib43">Hafting et al., 2008</xref>; note that their phase convention differs from ours by 180°). More detailed features also seem to agree between phase-precessing neurons in our simulations and LII neurons in experiments. First, the peak density decreases by ≈75° over the first 50% of field progress, and second, there is a smaller density at around 60% field progress and 140° theta phase (<xref ref-type="fig" rid="fig3">Figure 3F</xref>; <xref ref-type="bibr" rid="bib43">Hafting et al., 2008</xref>). This second density has been separately related to bursting (<xref ref-type="bibr" rid="bib21">Climer et al., 2013</xref>) and a second source of neural input (<xref ref-type="bibr" rid="bib113">Yamaguchi et al., 2002</xref>; <xref ref-type="bibr" rid="bib16">Chance, 2012</xref>); further investigation is required to reconcile these assertions with its origin in our model.</p><p>The dependence of phase behavior on simulation features and parameters is explored in detail in the figure supplements of <xref ref-type="fig" rid="fig3">Figure 3</xref>. We will briefly list a few key results interspersed with experimental findings that support them. Phase precession statistics do not depend on the direction of animal motion (<xref ref-type="fig" rid="fig3s5">Figure 3–Figure Supplement 5E,F</xref>); in experiments, <xref ref-type="bibr" rid="bib21">Climer et al. (2013)</xref> report omnidirectional precession in a 2D environment. Precession range and correlation magnitude increase with animal speed (<xref ref-type="fig" rid="fig3s6">Figure 3–Figure Supplement 6A</xref>, <italic>p</italic> = 0.002 and 0.0006 for precession range and correlation magnitude, respectively, by pooling data across track orientations and applying the Krushal-Wallis <italic>H</italic> test); in experiments, <xref ref-type="bibr" rid="bib51">Jeewajee et al. (2014)</xref> report that faster motion is associated with steeper precession slopes and higher correlation magnitudes (<xref ref-type="fig" rid="fig3">Figure 3a</xref>, results for <italic>pdcd</italic>, which corresponds to field progress defined in this paper).</p><p>To summarize our phase precession results, our simulation produces a subgroup of phase-locking neurons akin to MEC LIII neurons and a subgroup of phase-precessing neurons akin to MEC LII neurons. Further consideration of correlation coefficients and precession ranges, with connections to measurements, will be provided in the Discussion.</p></sec><sec id="s2-3-2"><title>Attractor bump oscillations explain phase precession</title><p>We can understand the emergence of phase precession through the effect of oscillating inhibitory drive on attractor bumps. Higher inhibitory drive suppresses the activity of the excitatory grid cells and decreases the size of bumps (<xref ref-type="fig" rid="fig4">Figure 4A,B</xref>). Imagine we record from a single neuron as a bump of activity moves through it on the neural sheet. As an attractor bump moves, its size oscillates with inhibitory drive (<xref ref-type="fig" rid="fig4">Figure 4C</xref>, top, and <xref ref-type="video" rid="fig4video1">Figure 4—video 1</xref>). The activity bump will most likely first reach the grid cell when it is large and growing in size, which corresponds to the end of the theta cycle when the inhibitory drive is decreasing towards its lowest point. Thus, as an animal enters a grid field, the first spike will likely have large theta phase slightly less than 360°. During the next theta cycle, the center of the bump has moved closer to the neuron, so the edge of the bump will reach the neuron when it is growing in size but not as large. Thus, the next spike will have slightly smaller theta phase. This is the origin of phase precession in our model. We continue generating spikes with simplified dynamics in which the neuron fires when it is contained within the bump, but there is a 40 ms refractory period corresponding to membrane potential building up towards threshold after it is reset. This procedure represents one lap along the track at constant velocity.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Bump size oscillations explain phase precession in models with simplified dynamics.</title><p>(<bold>A,B</bold>) Data from simulations with fixed inhibitory drive and constant animal velocity. (<bold>A</bold>) Snapshots of neural activity. Scale bar, 50 neurons. (<bold>B</bold>) The diameter of bumps on the neural sheet decreases linearly with inhibitory drive (linear regression <inline-formula><mml:math id="inf29"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0.90</mml:mn></mml:mrow></mml:math></inline-formula>, ANOVA <inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). (<bold>C</bold>) Phase precession in a conceptual model with bump size oscillations. We imagine an attractor bump, with size oscillations described by B, passing through a recorded grid cell. Top, a single lap. The recorded neuron is at location 0 and fires a spike (black dot) whenever contained within the bump (gray area), subject to a 40 ms refractory period. Bottom, relationship between theta phase and time across multiple laps with different initial phases. Spikes occur around 360° (equivalently, 0°) at the start of the field, and their phase generally decreases with time within in the grid field. (<bold>D</bold>) Attractor bump shape at different theta phases averaged over theta cycles and individual bumps (Appendix 1). Grays scaled separately for each theta phase. Scale bar, three neurons. (<bold>E,F</bold>) Phase behavior in a simplified model using average bump dynamics. (<bold>E</bold>) We imagine the average attractor bump passing through a recorded grid cell. Top, a single lap. The recorded neuron is at location 0 and stochastically fires a spike (black dot) with rate proportional to bump activity, subject to a 40 ms refractory period. Bottom, relationship between time and theta phase across multiple laps with different initial phases. (<bold>F</bold>) Relationship between time and theta phase using average bumps whose activity has been rescaled to different maximum values: 40, 50, and 100 spikes/s. Dots represent spikes generated according to E. Lines indicate fit by circular-linear regression. Numbers in each panel from top left to top right indicate magnitude of correlation coefficient, regression fit score, and regression slope.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Simplified model using average bump dynamics produces different phase behaviors for different levels of rescaled activity.</title><p>Simplified model of phase precession using average bump dynamics. Bump activity is rescaled to different maximum values. (<bold>A–D</bold>) Neurons exhibit phase locking under low bump activity with maximum value 40 spikes/s. Statistics from 1000 neurons simulated according to <xref ref-type="fig" rid="fig4">Figure 4E</xref>. (<bold>A</bold>) Relationship between animal position along the track and theta phase for representative neurons. Dots represent spikes. Lines indicate fit by circular-linear regression. Numbers in each panel from top left to top right indicate magnitude of correlation coefficient, regression fit score, and regression slope. (<bold>B</bold>) Magnitudes of circular-linear correlation coefficients. (<bold>C</bold>) Fit scores for circular-linear regression. (<bold>D</bold>) Regression slopes for neurons with fit score &gt;0.4. (<bold>E–H</bold>) Neurons exhibit phase precession under medium bump activity with maximum value 50 spikes/s. Panels same as A–D. (<bold>I–K</bold>) Neurons exhibit phase independence under high bump activity with maximum value 100 spikes/s. Panels same as A–C.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig4-figsupp1-v2.tif"/></fig><media id="fig4video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-46351-fig4-video1.mp4"><label>Figure 4—video 1.</label><caption><title>Phase precession in a simplified conceptual model.</title><p>An idealized attractor bump, with constant speed and oscillating size, passes through a recorded grid cell multiple times with different initial theta phases. This represents an animal running multiple laps in the same direction at constant speed. Top, the recorded neuron is at location 0 and fires a spike (black dot) whenever it is contained within the bump (gray area), subject to a 40 ms refractory period. Bottom, relationship between theta phase and time for spikes accumulated across multiple laps. Theta phase generally decreases with time within in the grid field. Since the simulated animal moves at constant speed, time is proportional to position, so theta phase decreases with position within in the grid field.</p></caption></media><media id="fig4video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-46351-fig4-video2.mp4"><label>Figure 4—video 2.</label><caption><title>Average attractor bump shape as a function of theta phase.</title><p>Bump activity is averaged over multiple bumps and theta cycles. Darker areas indicate higher activity, scaled separately for each theta phase. The constant velocity component of bump motion is removed.</p></caption></media></fig-group><p>We represent additional laps by performing the same simplified procedure as above, but with different shifts in theta phase, since the animal does not always enter the grid field at the same initial phase. Spikes accumulated across laps show phase precession (<xref ref-type="fig" rid="fig4">Figure 4C</xref>, bottom), though the effect is strongest at the beginning of the field. In the middle of the field, spikes still precess, but they cluster around values of both 360° and 180°. At the end of the field, a few spikes even precess in the opposite direction, increasing in phase with time. Thus, bump oscillations alone can explain the direction of phase precession and the preferred phase at field entry, but spike phases do not decrease perfectly linearly with progress through the field.</p><p>To analyze attractor bump oscillations more precisely, we calculate the average bump shape as a function of theta phase (<xref ref-type="fig" rid="fig4">Figure 4D</xref> and <xref ref-type="video" rid="fig4video2">Figure 4—video 2</xref>; Appendix 1). We now imagine that this average bump passes multiple times through a recorded neuron whose spiking probability is proportional to bump activity (<xref ref-type="fig" rid="fig4">Figure 4E</xref>). Each instance of this stochastic process produces a phase-locking, phase-precessing, or phase-independent neuron. By explicitly rescaling the activity of the average bump without otherwise changing its time-varying shape, we can generate neurons enriched in one of these phase relationships (<xref ref-type="fig" rid="fig4">Figure 4F</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Under high activity, neurons are driven to fire across all theta phases and exhibit phase independence. Under low activity, neurons only fire during the most permissive theta phase and exhibit phase locking at 360°. Under intermediate levels of activity, neurons can respond to oscillations in bump size as demonstrated in <xref ref-type="fig" rid="fig4">Figure 4C</xref> and exhibit phase precession.</p><p>This finding on how activity level influences phase behavior is supported by the experimental report that higher spike counts are associated with steeper precession slopes (<xref ref-type="bibr" rid="bib51">Jeewajee et al., 2014</xref>, <xref ref-type="fig" rid="fig3">Figure 3b</xref>, results for <italic>pdcd</italic>, which corresponds to field progress defined in this paper). Our main model also reflects this finding: neurons with low, medium, and high firing rates have increased likelihoods for phase locking, precession, and independence (<xref ref-type="fig" rid="fig3s4">Figure 3–Figure Supplement 4D</xref>). Thus, the heterogeneous phase behaviors observed in our main simulations arise, at least in part, from heterogeneous levels of bump activity. Three factors that determine the level of activity experienced by a neuron are its distance to the center of the neural sheet, its sheet location relative to attractor bumps, and its preferred firing direction relative to animal motion. Accordingly, the prevalence of different phase behaviors varies with these factors (<xref ref-type="fig" rid="fig3s4">Figure 3–Figure Supplement 4E,G</xref> and <xref ref-type="fig" rid="fig3s5">Figure 3–Figure Supplement 5B,D</xref>).</p></sec></sec><sec id="s2-4"><title>Theta sequences arise from oscillations in attractor bump speed</title><p>Next, we use the firing fields illustrated in <xref ref-type="fig" rid="fig2">Figure 2D</xref> to decode the animal’s position from the population activity presented in <xref ref-type="fig" rid="fig3">Figure 3A</xref> (Materials and methods). The decoded position generally matches the animal’s actual position (<xref ref-type="fig" rid="fig5">Figure 5A</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>), but at the theta timescale, there are deviations whose regularities are revealed by averaging over theta cycles.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>During runs, the decoded position exhibits theta sequences.</title><p>(<bold>A</bold>) Decoded position for four laps along the track corresponding to <xref ref-type="fig" rid="fig3">Figure 3A</xref>. Vertical blue lines indicate theta cycle boundaries. (<bold>B</bold>) Decoded position shifted by actual position and averaged over theta cycles. The thick black fit line indicates the time window with the steepest increase in decoded position. Vertical thin black lines indicate theta cycle boundaries. (<bold>C</bold>) Mean actual run speed (error bars indicate s.d. over time) and mean theta sequence speed, as indicated by the slope of the thick black line in B (error bars indicate s.d. over replicate simulations). (<bold>D</bold>) Difference between the maximum likelihood decoded position from B and the actual animal position as a function of time. Within each theta cycle, the segment from the smallest to the largest value is emphasized as a theta sequence.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Decoded position over many runs.</title><p>Decoded position over multiple runs corresponding to <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>. Vertical blue lines indicate theta cycle boundaries. Orange line indicates the actual animal trajectory. (<bold>A</bold>) Representative simulation exhibiting one field. (<bold>B</bold>) Representative simulation exhibiting two fields.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Decoded position shifted by actual position and averaged over theta cycles for many simulations.</title><p>Vertical black lines indicate theta cycle boundaries. (<bold>A</bold>) Representative simulations exhibiting one field. (<bold>B</bold>) Representative simulations exhibiting two fields.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig5-figsupp2-v2.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 3.</label><caption><title>Dependence of theta sequence speed on number of fields and simulation parameters.</title><p>Theta sequence speed divided by mean actual speed for different numbers of fields and parameter values. (<bold>A</bold>) Dependence of theta speed on number of fields. Box-whisker plot with line at medians, box between first to third quartiles, and whiskers between the entire data range excluding outliers lying more than 1.5 times the interquartile distance beyond the first or third quartile. <italic>p</italic>-value calculated by the Mann-Whitney <italic>U</italic> test. (<bold>B–E</bold>) Theta sequence speed divided by mean actual speed as a function of various simulation parameters. Points at mean values with bars indicating s.d. over replicate simulations. (<bold>B</bold>) Animal speed and track orientation relative to the E direction, or <inline-formula><mml:math id="inf31"><mml:mrow><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. (<bold>C</bold>) Excitatory drive and recording distance from the center of the neural sheet divided by the half the neural sheet size. (<bold>D</bold>) Inhibitory theta amplitude and inhibitory drive. (<bold>E</bold>) Inhibitory and excitatory membrane time constants.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig5-figsupp3-v2.tif"/></fig></fig-group><p>To do so, we take quadruplets of consecutive theta cycles, ignoring those whose decoded positions are close to the ends of the track and reversing those corresponding to right-to-left motion (Materials and methods). We align the decoded positions with respect to the actual position of the animal midway through each theta quadruplet, and we average these shifted decoded positions over theta quadruplets. This average decoded trajectory generally increases across the quadruplet, corresponding to the animal’s actual forward motion (<xref ref-type="fig" rid="fig5">Figure 5B</xref> and <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). However, within each theta cycle, the decoded position increases rapidly, before retreating at cycle boundaries. We identify these forward sweeps as theta sequences, which represent motion at 0.88 ± 0.15 m/s, approximately twice the actual speed of 0.50 ± 0.05 m/s (mean ± s.d.; <xref ref-type="fig" rid="fig5">Figure 5C</xref>). This matches experimental observations of average theta sequence speed ≈1 m/s compared to the animal’s speed of ≈0.4–0.5 m/s (<xref ref-type="bibr" rid="bib69">O'Neill et al., 2017</xref>). We also illustrate these sequences by comparing the maximum likelihood decoded position and the actual position as a function of time (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). Averaged over theta cycles, the decoded position lags behind the actual position at cycle boundaries and then advances ahead of it midcycle.</p><p>Theta sequences, like phase precession, arise naturally in our model from an effect of oscillating inhibitory drive on attractor bumps. In addition to determining bump size, inhibitory drive also affects the speed at which bumps move along the neural sheet—higher inhibitory drive produces faster bump motion for a given animal speed (<xref ref-type="fig" rid="fig6">Figure 6A,B</xref>). At the middle of theta cycles, inhibitory drive is highest, so attractor bumps move quickly and represent fast animal trajectories. These theta sequences are faster than the animal’s actual speed, which is approximately constant within a theta cycle and thus encoded as the average bump speed over the entire cycle. We can also see the origin of theta sequences directly from the average dynamics of attractor bumps (<xref ref-type="fig" rid="fig4">Figure 4D</xref>, <xref ref-type="fig" rid="fig6">Figure 6C</xref>, and <xref ref-type="video" rid="fig4video2">Figure 4—video 2</xref>). The location of peak activity moves with a sawtooth-like pattern that, over a theta cycle, lags behind the overall motion of the bump and advances ahead of it (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). These forward surges produce the sequences in decoded position (<xref ref-type="fig" rid="fig5">Figure 5D</xref>).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Bump speed oscillations explain theta sequences.</title><p>(<bold>A,B</bold>) Data from simulations with fixed inhibitory drive and constant animal velocity. (<bold>A</bold>) Snapshots of neural activity. Scale bar, 50 neurons. (<bold>B</bold>) The speed of bumps on the neural sheet increases linearly with inhibitory drive (linear regression <inline-formula><mml:math id="inf32"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0.91</mml:mn></mml:mrow></mml:math></inline-formula>, ANOVA <inline-formula><mml:math id="inf33"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). Thus, the average decoded position in <xref ref-type="fig" rid="fig5">Figure 5B</xref> advances most rapidly around the middle of the theta cycle. (<bold>C</bold>) Activity of the average attractor bump depicted in <xref ref-type="fig" rid="fig4">Figure 4D</xref> along its central axis. (<bold>D</bold>) Top, peak activity location from C as a function of time. Bottom, peak activity position relative to constant bump motion as a function of time. Within each theta cycle, the segment from the smallest to the largest value is emphasized and corresponds to a theta sequence in <xref ref-type="fig" rid="fig5">Figure 5D</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Relationship between attractor bump size and speed.</title><p>Attractor bump size and speed are not generally correlated over changes in multiple simulation parameters, but both are negatively correlated with the amount of inhibition produced by inhibitory neurons. (<bold>A</bold>) Legend for simulations with fixed inhibitory drive. Each simulation is performed at different values of inhibitory drive <inline-formula><mml:math id="inf34"><mml:msubsup><mml:mi>a</mml:mi><mml:mtext>mag</mml:mtext><mml:mo>-</mml:mo></mml:msubsup></mml:math></inline-formula>, inhibitory synaptic strength <inline-formula><mml:math id="inf35"><mml:msubsup><mml:mi>w</mml:mi><mml:mtext>mag</mml:mtext><mml:mo>-</mml:mo></mml:msubsup></mml:math></inline-formula>, and inhibitory membrane time constant <inline-formula><mml:math id="inf36"><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>m</mml:mtext><mml:mo>-</mml:mo></mml:msubsup></mml:math></inline-formula>. Other parameters are set at the values used for main simulation runs (<xref ref-type="table" rid="table1">Table 1</xref>). (<bold>B–F</bold>) Relationships between pairs of attractor bump properties across parameters displayed in A. Rank correlation computed by Spearman’s <inline-formula><mml:math id="inf37"><mml:mi>ρ</mml:mi></mml:math></inline-formula> with <italic>p</italic>-values indicated. Attractor bump properties are diameter, speed, the multiunit activity of inhibitory neurons (inhibitory MUA), and a metric for the amount of inhibition produced by inhibitory neurons (<inline-formula><mml:math id="inf38"><mml:mrow><mml:mtext>inhibitory MUA</mml:mtext><mml:mo>×</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mtext>mag</mml:mtext><mml:mo>-</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>). Note that B indicates no overall correlation between bump size and speed, but increasing <inline-formula><mml:math id="inf39"><mml:msubsup><mml:mi>a</mml:mi><mml:mtext>mag</mml:mtext><mml:mo>-</mml:mo></mml:msubsup></mml:math></inline-formula> (following blue–cyan–green) increases bump speed and decreases bump diameter, as seen in <xref ref-type="fig" rid="fig4">Figure 4B</xref> and <xref ref-type="fig" rid="fig6">Figure 6B</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig6-figsupp1-v2.tif"/></fig></fig-group><p>Our model’s mechanism for theta sequences can explain why their speed is roughly twice the actual speed, as observed experimentally (<xref ref-type="bibr" rid="bib69">O'Neill et al., 2017</xref>). Suppose the theta oscillation spends roughly the same amount of time at its peaks, when attractor bumps move at maximal speed, and at its troughs, when bumps do not move at all. Then, the average bump speed, which encodes the actual animal speed, is half the maximal bump speed, which encodes the theta sequence speed. Indeed, simulations whose grid cells contain two fields, whose track is oriented differently, whose trajectory is faster or slower, or whose parameters are chosen differently all have theta sequence speeds between 1.2 and 2.5 times the actual speed (<xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>).</p></sec><sec id="s2-5"><title>Replay arises from traveling wavefronts of activity</title><p>We now simulate idle periods at either end of the track. We would like to know how external inputs to the MEC change at transitions between active and quiescent states, but these measurements have not been performed to our knowledge. Thus, we instead adapt experimental findings taken during slow wave sleep, which resembles the quiescent state in many behavioral and electrophysiological ways (<xref ref-type="bibr" rid="bib13">Buzsáki, 1996</xref>). The neocortex, which activates MEC principal cells, is broadly less active during slow wave sleep (<xref ref-type="bibr" rid="bib96">Steriade et al., 2001</xref>), and the medial septum, which inhibits MEC interneurons, increases its firing rate while losing most of its oscillatory nature (<xref ref-type="bibr" rid="bib91">Simon et al., 2006</xref>). We model these effects respectively as decreased excitatory drive and decreased inhibitory drive without oscillations (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). The network rapidly switches between these inputs and those of <xref ref-type="fig" rid="fig1">Figure 1B</xref>, which represent the active state, as the animal transitions between quiescence and runs.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Lower drive during quiescence produces traveling wavefronts of activity that are decoded as replays.</title><p>(<bold>A</bold>) During idle periods at either end of the track, excitatory and inhibitory drives decrease, and the latter no longer oscillates. (<bold>B</bold>) Snapshot of neural activity showing S and inhibitory populations separately. Red circles indicate regions of recording. Scale bar, 50 neurons. (<bold>C</bold>) Grid cell spike rasters for four idle periods. (<bold>D</bold>) Decoded position corresponding to C. Rapid trajectory sweeps arise from traveling wavefronts as depicted by the S population in B. (<bold>E</bold>) Replays from one simulation with cyan fit lines. (<bold>F</bold>) Number of replays across simulations. (<bold>G</bold>) Mean actual run speed (error bars indicate s.d. over time) and mean replay speed, as indicated by the slopes of cyan lines in E (error bars indicate s.d. over replays).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Spike rasters over multiple idle periods.</title><p>(<bold>A</bold>) Representative simulation exhibiting one field. (<bold>B</bold>) Representative simulation exhibiting two fields.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig7-figsupp1-v2.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>Decoded position over many idle periods.</title><p>Decoded position over multiple idle periods corresponding to <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>. (<bold>A</bold>) Representative simulation exhibiting one field. (<bold>B</bold>) Representative simulation exhibiting two fields.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig7-figsupp2-v2.tif"/></fig><fig id="fig7s3" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 3.</label><caption><title>Many replays.</title><p>Replays with cyan fit lines. (<bold>A</bold>) Representative replays from simulations exhibiting one field. (<bold>B</bold>) Representative replays from simulations exhibiting two fields. Note that two or three parallel lines participate in the fit (Appendix 1).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig7-figsupp3-v2.tif"/></fig><fig id="fig7s4" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 4.</label><caption><title>Dependence of replay count and speed on number of fields and simulation parameters.</title><p>(<bold>A–D</bold>) Dependence of replay count and speed on number of fields. Box-whisker plot with line at medians, box between first to third quartiles, and whiskers between the entire data range excluding outliers lying more than 1.5 times the interquartile distance beyond the first or third quartile. <italic>p</italic>-value calculated by the Mann-Whitney <italic>U</italic> test. (<bold>A</bold>) Replay count. (<bold>B</bold>) Replay speed divided by mean actual speed. (<bold>C,D</bold>) Same as A,B, but we detect replays in simulations exhibiting two fields with the same method used for single fields. (<bold>E–H</bold>) Replay count and replay speed divided by mean actual speed as functions of various simulation parameters. Points at mean values with bars indicating s.d. over replicate simulations. (<bold>E</bold>) Velocity gain and animal speed. (<bold>F</bold>) Excitatory and inhibitory drive. (<bold>G</bold>) Excitatory-to-excitatory synaptic delay and noise magnitude for both excitatory and inhibitory neurons. (<bold>H</bold>) Inhibitory and excitatory membrane time constants.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig7-figsupp4-v2.tif"/></fig></fig-group><p>During quiescence, attractor bumps still form a lattice at the center of the neural sheet, where excitatory drive still exceeds threshold (<xref ref-type="fig" rid="fig7">Figure 7B</xref> and <xref ref-type="video" rid="video1">Video 1</xref>). However, these bumps vanish toward the edge of the sheet, where they are replaced by traveling wavefronts of activity. These wavefronts cannot be solely sustained by excitatory drive, which is subthreshold in this outer region; instead, they must be nucleated and then self-sustained through excitatory-to-excitatory connections. In our model, nucleation occurs at activity bumps toward the edge of the sheet (<xref ref-type="video" rid="video1">Video 1</xref>). Once nucleated, the wavefront propagates freely through the outer region because inhibitory neurons, with low drive, are not activated by the wavefront. In contrast, wavefronts cannot propagate in the center region, because excitatory neurons there receive enough drive to spike vigorously and activate nearby inhibitory neurons (<xref ref-type="fig" rid="fig7">Figure 7B</xref>, inhibitory population). These interneurons, with their surround distribution of synaptic outputs (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), constrain neural activity to localized bumps and prevent wavefront propagation.</p><p>When a wavefront passes through a region of recorded neurons, it can appear as a sequence of spikes (<xref ref-type="fig" rid="fig7">Figure 7C</xref> and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>) that is decoded as a rapid trajectory (<xref ref-type="fig" rid="fig7">Figure 7D</xref> and <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>). We identify these events as replays, which traverse much of the track over ~100 ms (<xref ref-type="fig" rid="fig7">Figure 7E</xref> and <xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3</xref>). Due to the stochastic nature of wavefront generation, the number of detected replays can vary considerably across laps (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>) and across replicate simulations (<xref ref-type="fig" rid="fig7">Figure 7F</xref>). However, replays have a characteristic speed determined by that of wavefront propagation; it is 7.0 ± 2.6 m/s, which is about 14 times faster than the actual speed of 0.50 ± 0.05 m/s (mean ± s.d.; <xref ref-type="fig" rid="fig7">Figure 7G</xref>). This agrees with experiments, which measure replays at ≈4–6 m/s and actual motion at ≈0.4–0.5 m/s (<xref ref-type="bibr" rid="bib69">O'Neill et al., 2017</xref>). Replay speed depends on the number of grid fields and the values of simulation parameters (<xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4</xref>). In fact, grid cells with two fields encode two different track positions, so replays among them can have their distribution of decoded position split between parallel lines (<xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3</xref>). We have implemented two different detection methods that yield slightly different replay speeds: one that is identical to the single-field case, and another in which multiple lines participate in the fit (<xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4A-D </xref>; Appendix 1). Nevertheless, across all simulation parameters and detection methods, replays are always much faster than both the actual animal speed and the theta sequence speed, as observed experimentally (<xref ref-type="bibr" rid="bib69">O'Neill et al., 2017</xref>). This happens because traveling wavefronts lack inhibition and should be the network phenomenon that propagates fastest.</p></sec><sec id="s2-6"><title>Replay properties under different network configurations</title><sec id="s2-6-1"><title>Lower velocity gain produces replays with directional bias</title><p>Under the main parameter values in <xref ref-type="table" rid="table1">Table 1</xref>, attractor bumps travel long distances on the neural sheet when the animal moves from one end of the track to another (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). These distances are longer than the grid scale, so different positions on the track can correspond to the similar locations on the neural sheet, preventing a consistent correspondence between neural sheet location and track position (yellow and purple areas in <xref ref-type="fig" rid="fig2">Figure 2C</xref>). With lower velocity gain, attractor bumps travel shorter distances, and such a correspondence is apparent (yellow and purple areas in <xref ref-type="fig" rid="fig8">Figure 8A</xref>).</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Replays acquire additional properties in networks with different configurations of attractor bumps.</title><p>(<bold>A–C</bold>) With lower velocity gain, neural sheet locations have a clear one-to-one correspondence with track positions, which allows replays to exhibit a directional bias. (<bold>A</bold>) Left, track diagram with animal idle at 0 cm. Right, corresponding snapshot of neural activity superimposed on a background colored according to the position at which each neuron attains its maximum firing rate (cf. <xref ref-type="fig" rid="fig2">Figure 2C</xref>, right panel). Red circles indicate regions of recording. Attractor bumps still represent the animal position, and a wavefront can be seen emanating from one bump at the top right. (<bold>B</bold>) Direction of replay propagation across simulations. For each actual position and replay direction, width of gray bars indicates the number of simulations with a particular replay count. Means indicated with lines. <italic>p</italic>-values from the Mann-Whitney <italic>U</italic> test show that a significantly greater number of replays propagate away from either actual position. (<bold>C</bold>) Distances between actual position and decoded position at the start or end of replays. Paired medians compared by the Wilcoxon rank-sum test with indicated <italic>p</italic>-value. (<bold>D–G</bold>) With periodic boundary conditions and uniform excitatory drive, attractor bumps and activity wavefronts appear throughout the neural sheet. (<bold>D,E</bold>) Excitatory drive during runs and idle periods. (<bold>F,G</bold>) Snapshots of neural activity during runs and idle periods showing S and inhibitory populations. Each pixel is a neuron and dark colors indicate recent spiking. Red circles indicate regions of recording. Scale bars, 50 neurons.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig8-v2.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>Replay properties in simulations with lower velocity gain.</title><p>(<bold>A</bold>) Grid cell spike rasters for four idle periods. (<bold>B</bold>) Decoded position corresponding to A. (<bold>C</bold>) Replays across multiple simulations with cyan fit lines. (<bold>D</bold>) Number of replays across simulations. (<bold>E</bold>) Actual run speed 0.50 ± 0.05 m/s (mean ± s.d. over time) and replay speed 7.4 ± 2.3 m/s (mean ± s.d. over replays).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig8-figsupp1-v2.tif"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 2.</label><caption><title>Replay properties in simulations with periodic boundary conditions and uniform excitatory drive.</title><p>Same as <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>, but for simulations with periodic boundary conditions and uniform excitatory drive. Replay speed is 8.0 ± 2.2 m/s (mean ± s.d. over replays).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig8-figsupp2-v2.tif"/></fig><fig id="fig8s3" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 3.</label><caption><title>Phase precession and theta sequence properties in simulations with periodic boundary conditions and uniform excitatory drive.</title><p>(<bold>A</bold>) Grid cell spike rasters for four runs. Vertical blue lines indicate theta cycle boundaries. (<bold>B</bold>) Decoded position corresponding to A. (<bold>C</bold>) Relationship between animal position and theta phase for representative neurons. Dots represent spikes during runs in the directions indicated by arrows. Lines indicate fit by circular-linear regression. Numbers in each panel from top left to top right indicate magnitudes of correlation coefficients, regression fit scores, and regression slopes. (<bold>D–F</bold>) Data across all replicate simulations. (<bold>D</bold>) Magnitudes of circular-linear correlation coefficients. Mean ± s.d.: 0.14 ± 0.09. (<bold>E</bold>) Fit scores for circular-linear regression. (<bold>F</bold>) Regression slopes for neurons with fit score &gt;0.4. (<bold>G</bold>) Decoded position averaged over theta cycles. Thick black line fit to theta sequence. (<bold>H</bold>) Actual run speed 0.50 ± 0.05 m/s (mean ± s.d. over time) and theta sequence speed 0.90 ± 0.11 m/s (mean ± s.d. over replicate simulations).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-fig8-figsupp3-v2.tif"/></fig><media id="fig8video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-46351-fig8-video1.mp4"><label>Figure 8—video 1.</label><caption><title>Replays preferentially radiate from attractor bumps encoding the current animal position.</title><p>The activity snapshot in <xref ref-type="fig" rid="fig8">Figure 8A</xref> corresponds to t = 41.14 s. Left, position of the animal (black square) at 0 cm along a 1D track, whose positions are colored with a gradient. Right, neural activity of the E population superimposed upon a spatial firing map. Each neuron is colored according the position at which it attains maximum firing rate. Each black pixel represents a spike within the last 5 ms. A wavefront travels through the red recording region located at the top right of the neural sheet. It emanates from an attractor bump sustained by yellow neurons that represent the current position of 0 cm, and it rapidly sweeps through neurons representing progressively farther track positions.</p></caption></media><media id="fig8video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-46351-fig8-video2.mp4"><label>Figure 8—video 2.</label><caption><title>Neural activity during runs, idle periods, and allocentric corrections for a simulation with periodic boundary conditions and uniform excitatory drive.</title><p>Left, position of the animal (black square) along a 1D track. Right, neural activity of the E population. Each pixel is a neuron, with black corresponding to current spikes and lightest gray corresponding to spikes 40 ms ago. Red circles indicate regions of recording.</p></caption></media></fig-group><p>When an animal is idle at either end of the track, attractor bumps are still located at neurons that represent the current position (<xref ref-type="fig" rid="fig8">Figure 8A</xref> and <xref ref-type="video" rid="fig8video1">Figure 8—video 1</xref>). Recall that replays are nucleated at attractor bumps (<xref ref-type="video" rid="video1">Video 1</xref> and <xref ref-type="fig" rid="fig8">Figure 8A</xref>). As a wavefront radiates from a bump, it will likely first activate neurons whose firing fields represent nearby positions, followed by those with increasingly distant fields, due to the correspondence between neural sheet locations and track positions (<xref ref-type="video" rid="fig8video1">Figure 8—video 1</xref>). Thus, the decoded position tends to start near the actual position of the animal and travel away from it (<xref ref-type="fig" rid="fig8">Figure 8B</xref>). Accordingly, the decoded starting position of replays are closer to the actual position than the decoded ending position (<xref ref-type="fig" rid="fig8">Figure 8C</xref>).</p><p>However, replays are not all detected immediately after wavefront nucleation; wavefronts traveling for some time may pass through a region of recorded neurons from any direction. Thus, despite the predominance of replays directed away from the actual animal position, some start at the opposite side of the track and travel toward the actual position (<xref ref-type="fig" rid="fig8">Figure 8B</xref>). This directional bias has not been directly assessed for grid cells, but it appears in experiments on hippocampal replay (<xref ref-type="bibr" rid="bib25">Diba and Buzsáki, 2007</xref>; <xref ref-type="bibr" rid="bib24">Davidson et al., 2009</xref>).</p></sec><sec id="s2-6-2"><title>Periodic boundary conditions and uniform drive produces replays throughout the neural sheet</title><p>Our main model has nonperiodic boundary conditions, which requires excitatory drive to decrease towards the edge of the neural sheet to prevent boundary effects that disrupt path integration (<xref ref-type="bibr" rid="bib9">Burak and Fiete, 2009</xref>). During idle periods, the persistence of attractor bumps at the center of the sheet maintain a representation of the animal’s position (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). With periodic boundaries that eliminate edges, we can implement uniform excitatory drive during both runs and idle periods (<xref ref-type="fig" rid="fig8">Figure 8D,E</xref>). This allows the entire neural sheet to exhibit attractor bumps during runs and activity wavefronts during idle periods (<xref ref-type="fig" rid="fig8">Figure 8F,G</xref> and <xref ref-type="video" rid="fig8video2">Figure 8—video 2</xref>). Thus, replays can be recorded from anywhere on the neural sheet. Note that allocentric input at the end of each idle period is essential in this case because positional information in the form of attractor bumps completely disappears. Simulations with periodic boundary conditions and uniform drive produce all the essential replay and theta-related phenomena observed in our main model (<xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2</xref> and <xref ref-type="fig" rid="fig8s3">Figure 8—figure supplement 3</xref>).</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><sec id="s3-1"><title>Summary of our results</title><p>Decades of hippocampal experiments have established theta phase precession, theta sequences, and replay as central features of place cell dynamics (<xref ref-type="bibr" rid="bib66">O'Keefe, 1976</xref>; <xref ref-type="bibr" rid="bib12">Buzsáki, 1986</xref>; <xref ref-type="bibr" rid="bib93">Skaggs et al., 1996</xref>; <xref ref-type="bibr" rid="bib58">Lee and Wilson, 2002</xref>; <xref ref-type="bibr" rid="bib36">Foster and Wilson, 2006</xref>). Evidence has been accumulating that grid cells, discovered more recently, also exhibit these phenomena (<xref ref-type="bibr" rid="bib43">Hafting et al., 2008</xref>; <xref ref-type="bibr" rid="bib71">Ólafsdóttir et al., 2016</xref>; <xref ref-type="bibr" rid="bib69">O'Neill et al., 2017</xref>). These three phenomena appear to be similar to one another in many ways, but experiments have also demonstrated important discordances. Theta sequences have been understood as the direct consequence of individually phase-precessing neurons (<xref ref-type="bibr" rid="bib68">O'Keefe and Recce, 1993</xref>; <xref ref-type="bibr" rid="bib93">Skaggs et al., 1996</xref>). However, place cell experiments show that phase precession can appear without theta sequences (<xref ref-type="bibr" rid="bib33">Feng et al., 2015</xref>). Theta sequences and replays both represent temporally compressed trajectories, and both seem important for memory consolidation and planning (<xref ref-type="bibr" rid="bib35">Foster and Knierim, 2012</xref>; <xref ref-type="bibr" rid="bib119">Zielinski et al., 2018</xref>). Yet, replay trajectories are significantly faster than theta sequences, and theta sequences only propagate in the direction of motion whereas replays can propagate in any direction relative to the resting animal (<xref ref-type="bibr" rid="bib24">Davidson et al., 2009</xref>; <xref ref-type="bibr" rid="bib33">Feng et al., 2015</xref>; <xref ref-type="bibr" rid="bib118">Zheng et al., 2016</xref>; <xref ref-type="bibr" rid="bib69">O'Neill et al., 2017</xref>).</p><p>We unify phase precession, theta sequences, and replay under a single model while maintaining distinctions among them. Phase precession and theta sequences arise naturally from oscillations in attractor bump size and speed, respectively, which are both consequences of medial septum input. However, bump size and speed are not generally correlated across changes in other model parameters (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). Thus, it is conceivable that one theta-related phenomenon can exist without the other under certain conditions. Replays in our model arise from the disappearance of attractor bumps and their replacement by traveling wavefronts of activity. Wavefront propagation involves dynamical processes that are fundamentally different from attractor bump motion, and thus has led to different decoded speeds and directions for replays and theta sequences.</p><p>Crucially, we produce these phenomena in a continuous attractor network that can still generate 2D grid cells through path integration. Our implementation shares similarities with an early version of the model (<xref ref-type="bibr" rid="bib9">Burak and Fiete, 2009</xref>) and a version whose connectivity can be learned (<xref ref-type="bibr" rid="bib105">Widloski and Fiete, 2014</xref>). However, there are three key differences. First, we use fully spiking neurons, which are rarely used in grid cell attractor models—we have only found them utilized in <xref ref-type="bibr" rid="bib31">English (2017)</xref> and <xref ref-type="bibr" rid="bib11">Bush and Burgess (2014)</xref>, the latter of which combines an attractor network with the oscillatory interference model for grid cells (<xref ref-type="bibr" rid="bib10">Burgess et al., 2007</xref>; <xref ref-type="bibr" rid="bib48">Hasselmo et al., 2007</xref>). Typically, neural dynamics are founded on firing rates, which can be used to generate spike trains through a memoryless Poisson process (<xref ref-type="bibr" rid="bib9">Burak and Fiete, 2009</xref>; <xref ref-type="bibr" rid="bib105">Widloski and Fiete, 2014</xref>); these models do not capture the strong short-time anticorrelation in spiking due to the reset of membrane potential. Second, we include excitatory-to-excitatory connections in accordance with their recent experimental discovery (<xref ref-type="bibr" rid="bib37">Fuchs et al., 2016</xref>; <xref ref-type="bibr" rid="bib109">Winterer et al., 2017</xref>; <xref ref-type="bibr" rid="bib89">Schmidt et al., 2017</xref>; <xref ref-type="bibr" rid="bib120">Zutshi et al., 2018</xref>). These connections allow wavefronts to propagate among excitatory neurons while nearby inhibitory neurons remain silent. Third, we vary the external input to the network between active and quiescent behavioral states in accordance with observations (<xref ref-type="bibr" rid="bib96">Steriade et al., 2001</xref>; <xref ref-type="bibr" rid="bib91">Simon et al., 2006</xref>). Consequently, the network can instantly switch between operating regimes that exhibit either theta-related phenomena or replays.</p><p>Our model presents a distinct conception of entorhinal replay that can be tested experimentally. Direct observation of propagating wavefronts can be pursued by calcium imaging of the MEC (<xref ref-type="bibr" rid="bib49">Heys et al., 2014</xref>; <xref ref-type="bibr" rid="bib26">Diehl et al., 2019</xref>). Otherwise, tetrode recordings of grid cell replay in open field environments may be analyzed for wavefront dynamics. In two dimensions, wavefronts would not represent a single trajectory, but instead a manifold of positions that sweep out a plane through space. New decoding techniques that permit the grid cell population to simultaneously represent inconsistent locations would be required to distinguish between these two possible representations of motion.</p></sec><sec id="s3-2"><title>Relationships to experiments and other models</title><p>We chose to build a continuous attractor model that can produce theta-related behavior and replay with as simple an architecture as possible, but we imagine that more complex network geometries are possible. For example, during quiescence, our model maintains activity bumps at the center of network and only exhibits replays at the edges; with alternative implementations of excitatory drive, multiple areas may contain persistent attractor bumps that nucleate wavefronts. We have also ignored other known components of the grid system. We do not model multiple grid modules (<xref ref-type="bibr" rid="bib95">Stensola et al., 2012</xref>; <xref ref-type="bibr" rid="bib102">Urdapilleta et al., 2017</xref>; <xref ref-type="bibr" rid="bib53">Kang and Balasubramanian, 2019</xref>). During runs, spike frequency adaptation (<xref ref-type="bibr" rid="bib116">Yoshida et al., 2013</xref>) would reduce the number of spikes late in the grid field, which could enhance phase precession according to the conceptual model presented in <xref ref-type="fig" rid="fig4">Figure 4</xref> and increase correlation magnitude. During quiescence, the MEC exhibits Up and Down states marked by high and low levels of activity; perhaps transitions between these states, which is associated with CA1 ripples (<xref ref-type="bibr" rid="bib45">Hahn et al., 2012</xref>), can nucleate multiple wavefronts that propagate in synchrony. Moreover, simulation features used to study gamma oscillations in grid cells (<xref ref-type="bibr" rid="bib65">Nolan, 2018</xref>; <xref ref-type="bibr" rid="bib20">Chrobak and Buzsáki, 1998</xref>; <xref ref-type="bibr" rid="bib22">Colgin et al., 2009</xref>) can be introduced to elucidate the role of gamma during theta-related phenomena and replays (<xref ref-type="bibr" rid="bib78">Pfeiffer and Foster, 2015</xref>; <xref ref-type="bibr" rid="bib80">Ramirez-Villegas et al., 2018</xref>).</p><p>Our model does not explicitly implement biophysical distinctions between LII and LIII neurons or between stellate and pyramidal cells within LII. These neural subpopulations have different characteristic ranges of phase precession that even vary between experimental reports. <xref ref-type="bibr" rid="bib30">Ebbesen et al. (2016)</xref> found the median precession range of LII stellate and pyramidal cells to be ≈130° and ≈50°, respectively, which is smaller than the values of ≈110° and ≈170° found by <xref ref-type="bibr" rid="bib83">Reifenstein et al. (2016)</xref>. Meanwhile, LIII grid cells, which often possess conjunctive head direction tuning (<xref ref-type="bibr" rid="bib84">Sargolini et al., 2006</xref>) like the neurons in our model, predominantly exhibit phase-locking with phase precession range close to 0° according to <xref ref-type="bibr" rid="bib43">Hafting et al. (2008)</xref>. However, <xref ref-type="bibr" rid="bib82">Reifenstein et al. (2014)</xref> reports small, but significant precession in LIII, and single-lap analyses by <xref ref-type="bibr" rid="bib30">Ebbesen et al. (2016)</xref> finds that LIII neurons precess even more than LII pyramidal cells. <xref ref-type="bibr" rid="bib69">O'Neill et al. (2017)</xref> does not distinguish between these cell types and observes all of these phase behaviors; this heterogeneity is dynamically captured by the excitatory principal cells in our model. Simulations implementing multiple types of principal cells would be required to precisely assign the distinctions in theta phase properties to the appropriate cell type.</p><p>Other models have been proposed for theta phase precession (<xref ref-type="bibr" rid="bib100">Tsodyks et al., 1996</xref>; <xref ref-type="bibr" rid="bib97">Thurley et al., 2008</xref>; <xref ref-type="bibr" rid="bib64">Navratilova et al., 2012</xref>; <xref ref-type="bibr" rid="bib98">Thurley et al., 2013</xref>) and replay (<xref ref-type="bibr" rid="bib79">Ponulak and Hopfield, 2013</xref>; <xref ref-type="bibr" rid="bib4">Azizi et al., 2013</xref>; <xref ref-type="bibr" rid="bib5">Bayati et al., 2015</xref>; <xref ref-type="bibr" rid="bib18">Chenkov et al., 2017</xref>; <xref ref-type="bibr" rid="bib38">Gönner et al., 2017</xref>; <xref ref-type="bibr" rid="bib44">Haga and Fukai, 2018</xref>). For example, one grid cell model uses after-spike depolarization within a 1D continuous attractor network to generate phase precession and theta sequences (<xref ref-type="bibr" rid="bib64">Navratilova et al., 2012</xref>). This experimentally observed feature pulls attractor bumps back to recently active locations every theta cycle. A place cell model combines an oscillating membrane potential, as found in our model, with synaptic facilitation (<xref ref-type="bibr" rid="bib97">Thurley et al., 2008</xref>). These features could be added to our model to strengthen theta-related phenomena and potentially increase correlation magnitude, but they not required. Previously proposed replay models were all intended to address place cells, not grid cells. Several of them encode replay trajectories into synaptic weights, either through hard-wiring or a learning mechanism (<xref ref-type="bibr" rid="bib18">Chenkov et al., 2017</xref>; <xref ref-type="bibr" rid="bib38">Gönner et al., 2017</xref>; <xref ref-type="bibr" rid="bib44">Haga and Fukai, 2018</xref>). Two models have suggested that replays originate from wavefronts of activity propagating through networks of place cells (<xref ref-type="bibr" rid="bib79">Ponulak and Hopfield, 2013</xref>; <xref ref-type="bibr" rid="bib5">Bayati et al., 2015</xref>; <xref ref-type="bibr" rid="bib75">Palmer et al., 2017</xref>). These wavefronts then enhance connections through the network though spike-timing-dependent plasticity rules, which could account for the ability of reward to modulate hippocampal replay (<xref ref-type="bibr" rid="bib77">Pfeiffer and Foster, 2013</xref>; <xref ref-type="bibr" rid="bib1">Ambrose et al., 2016</xref>; <xref ref-type="bibr" rid="bib76">Palmer and Gong, 2013</xref>).</p></sec><sec id="s3-3"><title>Possible implications</title><p>Although phase precession, theta sequences, and replay arise without learning in our model, they are not necessarily epiphenomenal in the sense that they serve no cognitive purpose. Grid cells are thought to provide a spatial representation that is immediately available upon entering an environment and that remains stable over days of experience (<xref ref-type="bibr" rid="bib42">Hafting et al., 2005</xref>; <xref ref-type="bibr" rid="bib59">Leutgeb et al., 2007</xref>; <xref ref-type="bibr" rid="bib26">Diehl et al., 2019</xref>). They provide spatial information to the hippocampus (<xref ref-type="bibr" rid="bib17">Cheng and Frank, 2011</xref>; <xref ref-type="bibr" rid="bib46">Hales et al., 2014</xref>), whose place cells associate location with environmental context (<xref ref-type="bibr" rid="bib108">Wilson and McNaughton, 1993</xref>; <xref ref-type="bibr" rid="bib2">Anderson and Jeffery, 2003</xref>) and reward (<xref ref-type="bibr" rid="bib50">Hollup et al., 2001</xref>; <xref ref-type="bibr" rid="bib62">Mamad et al., 2017</xref>) to aid the animal in pursuing its goals. In this vein, we envision that superficial MEC layers act as a pattern generator for phase precession, theta sequences, and replay, especially in new environments. These phenomena are then presented to the hippocampus to be refined by experience and modulated by reward.</p><p>The concept that sequences in hippocampus arise from superficial MEC layers has been experimentally substantiated for theta phenomena: lesioning the MEC disrupts phase precession and theta sequences in place cells (<xref ref-type="bibr" rid="bib87">Schlesiger et al., 2015</xref>), but grid cell phase precession is not affected by hippocampal inactivation (<xref ref-type="bibr" rid="bib43">Hafting et al., 2008</xref>). Driving place cell replays with grid cell replays would require temporal coordination between the two, for which experimental support is mixed. <xref ref-type="bibr" rid="bib69">O'Neill et al. (2017)</xref> does not find coordination between grid cell replays in superficial MEC layers and sharp-wave-ripples (SWRs) in CA1, during which place cell replays appear. However, <xref ref-type="bibr" rid="bib71">Ólafsdóttir et al. (2016)</xref> and <xref ref-type="bibr" rid="bib72">Ólafsdóttir et al. (2017)</xref> report that hippocampal replays represent trajectories coherently with grid cell activity in deep MEC layers, and <xref ref-type="bibr" rid="bib114">Yamamoto and Tonegawa (2017)</xref> reports that SWRs in CA1 are preceded by SWRs in superficial MEC layers. Further investigation would help to elucidate the temporal relationships between hippocampus and MEC. Also, note that we do not exclude the possibility that place cell replays can also be initiated within the hippocampus or by subcortical nuclei (<xref ref-type="bibr" rid="bib94">Stark et al., 2014</xref>; <xref ref-type="bibr" rid="bib88">Schlingloff et al., 2014</xref>; <xref ref-type="bibr" rid="bib74">Oliva et al., 2016</xref>; <xref ref-type="bibr" rid="bib3">Angulo-Garcia et al., 2018</xref>; <xref ref-type="bibr" rid="bib85">Sasaki et al., 2018</xref>).</p><p>Place cell activity appears to contain an abundance of certain short sequences that represent contiguous locations in novel environments and participate frequently in replays (<xref ref-type="bibr" rid="bib60">Liu et al., 2018</xref>). This finding is related to the disputed (<xref ref-type="bibr" rid="bib90">Silva et al., 2015</xref>) observation of hippocampal preplay (<xref ref-type="bibr" rid="bib27">Dragoi and Tonegawa, 2011</xref>; <xref ref-type="bibr" rid="bib40">Grosmark and Buzsáki, 2016</xref>; <xref ref-type="bibr" rid="bib61">Liu et al., 2019</xref>). From the perspective of our model, such preexisting sequences may arise from wavefronts generated intrinsically by grid cells, which then drive corresponding place cells. After experience, hippocampal plasticity supplements the sequences with additional place cells to enhance their representation of meaningful trajectories (<xref ref-type="bibr" rid="bib40">Grosmark and Buzsáki, 2016</xref>; <xref ref-type="bibr" rid="bib28">Drieu et al., 2018</xref>). In this way, wavefronts in the MEC can accelerate learning by providing a scaffold for the hippocampus to modify and improve. Meanwhile, the MEC maintains a symmetric representation of space, so the next experience, possibly with different spatial properties, can be learned equally well.</p><p>Yet, we emphasize that our model focuses on the mechanistic origins of grid cell sequences and its results hold regardless of whether the suggested relationships between MEC and hippocampus are borne out by future experiments.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>This section provides an overview of our simulation methods. Full details are provided in Appendix 1.</p><sec id="s4-1"><title>Model architecture and dynamics</title><p>Our architecture is inspired by <xref ref-type="bibr" rid="bib9">Burak and Fiete (2009)</xref> and <xref ref-type="bibr" rid="bib105">Widloski and Fiete (2014)</xref>. A 2D neural sheet contains five overlapping populations, each with neurons at <inline-formula><mml:math id="inf40"><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. There are four excitatory populations: N, S, W, and E; we index them by <inline-formula><mml:math id="inf43"><mml:mi>P</mml:mi></mml:math></inline-formula> and use the symbol <inline-formula><mml:math id="inf44"><mml:mo>+</mml:mo></mml:math></inline-formula> for parameters common to all of them. There is one inhibitory population <inline-formula><mml:math id="inf45"><mml:mo>-</mml:mo></mml:math></inline-formula>.</p><p>Each excitatory neuron is described by a membrane potential <inline-formula><mml:math id="inf46"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>P</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and a spike indicator <inline-formula><mml:math id="inf47"><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mi>P</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which equals either 1 if neuron <inline-formula><mml:math id="inf48"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula> in population <inline-formula><mml:math id="inf49"><mml:mi>P</mml:mi></mml:math></inline-formula> spiked at time <inline-formula><mml:math id="inf50"><mml:mi>t</mml:mi></mml:math></inline-formula> or 0 otherwise. When the potential exceeds a threshold of 1 in arbitrary units, the neuron fires a spike and its potential is reset to 0:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>P</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>←</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo mathvariant="italic" separator="true"> </mml:mo><mml:mtext>and</mml:mtext></mml:mrow></mml:mrow><mml:mo mathvariant="italic" separator="true"> </mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mi>P</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>←</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We prevent <inline-formula><mml:math id="inf51"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>P</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from decreasing past –1 as a limit on hyperpolarization. The same definitions and dynamics apply to the inhibitory population <inline-formula><mml:math id="inf52"><mml:mo>-</mml:mo></mml:math></inline-formula>.</p><p>Membrane potentials follow leaky integrator dynamics. The excitatory neurons obey<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mtext>m</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow/><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">e</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mtext>s</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mtext>s</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow/><mml:mo>+</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">E</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>And the inhibitory neurons obey<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mtext>m</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow/><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">e</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mtext>s</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>ζ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Neural drive is given by <inline-formula><mml:math id="inf53"><mml:mi>a</mml:mi></mml:math></inline-formula>, which is modulated by the animal’s velocity <inline-formula><mml:math id="inf54"><mml:mrow><mml:mi mathvariant="bold">𝐕</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for excitatory neurons. Each excitatory population <inline-formula><mml:math id="inf55"><mml:mi>P</mml:mi></mml:math></inline-formula> prefers a perpendicular direction in space <inline-formula><mml:math id="inf56"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">𝐄</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover><mml:msup><mml:mi/><mml:mi>P</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, which we call North, South, West, and East for the populations N, S, W, and E. Neural connectivity is given by <inline-formula><mml:math id="inf57"><mml:mi>w</mml:mi></mml:math></inline-formula>. Each excitatory population <inline-formula><mml:math id="inf58"><mml:mi>P</mml:mi></mml:math></inline-formula> has its synaptic outputs shifted by a small amount <inline-formula><mml:math id="inf59"><mml:mi>ξ</mml:mi></mml:math></inline-formula> in a preferred direction <inline-formula><mml:math id="inf60"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">𝐞</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover><mml:msup><mml:mi/><mml:mi>P</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> on the neural sheet, which we call up, down, left, and right for the populations N, S, W, and E. Spikes produce an instantaneous change in postsynaptic membrane potential after a synaptic delay <inline-formula><mml:math id="inf61"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:math></inline-formula>, which is longer for excitatory-to-excitatory connections (<inline-formula><mml:math id="inf62"><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>s</mml:mtext><mml:mrow><mml:mi/><mml:mo>+</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>) than for excitatory-to-inhibitory connections (<inline-formula><mml:math id="inf63"><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>s</mml:mtext><mml:mrow><mml:mi/><mml:mo>-</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>) based on axon morphology (<xref ref-type="bibr" rid="bib89">Schmidt et al., 2017</xref>). Independent, zero-mean, normally distributed noise <inline-formula><mml:math id="inf64"><mml:mi>ζ</mml:mi></mml:math></inline-formula> is added to each neuron at each timestep. See <xref ref-type="table" rid="table1">Table 1</xref> for complete variable definitions and values.</p></sec><sec id="s4-2"><title>Drive and connectivity</title><p>The drive to excitatory populations is<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mtd><mml:mtd><mml:mi>ρ</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mi>ρ</mml:mi><mml:mo>≥</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow><mml:msqrt><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mrow/><mml:mo stretchy="true">/</mml:mo><mml:mrow/><mml:mfrac><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> is a scaled radial distance for the neuron at <inline-formula><mml:math id="inf66"><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. It equals 0 at the center of the neural sheet and approximately one at the midpoint of an edge. The drive to inhibitory subpopulations is<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mtext>mag</mml:mtext><mml:mo>-</mml:mo></mml:msubsup><mml:mo>-</mml:mo><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mtext>th</mml:mtext><mml:mo>-</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf67"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is a phase offset chosen randomly at the start of each lap.</p><p>The synaptic connectivity from excitatory neurons to all neurons is based on the symmetric function<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mtext>mag</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mtd><mml:mtd><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mi>r</mml:mi><mml:mo>≥</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The synaptic connectivity from inhibitory neurons to excitatory neurons is<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mtext>mag</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mtd><mml:mtd><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mi>r</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>There is no connectivity from inhibitory neurons to other inhibitory neurons.</p><p>See <xref ref-type="table" rid="table1">Table 1</xref> for complete variable definitions and values.</p></sec><sec id="s4-3"><title>Brief allocentric correction</title><p>The grid-like pattern of excitatory drive during brief allocentric corrections (<xref ref-type="fig" rid="fig2">Figure 2B</xref>) represents inputs from neurons with allocentric responses, such as border, boundary vector, or landmark cells (<xref ref-type="bibr" rid="bib32">Evans et al., 2016</xref>; <xref ref-type="bibr" rid="bib81">Raudies and Hasselmo, 2015</xref>; <xref ref-type="bibr" rid="bib86">Savelli et al., 2017</xref>). Interactions between allocentric neurons and grid cells have also been implemented in other continuous attractor models (<xref ref-type="bibr" rid="bib70">Ocko et al., 2018</xref>; <xref ref-type="bibr" rid="bib54">Keinath et al., 2018</xref>). In our model, allocentric input is learned in an accelerated manner during simulation setup. Immediately before the main simulation phase, we simulate one run in each track direction followed by a learning period at either end of the track. The locations of attractor bumps during learning periods are stored by tallying the number of spikes produced at each neural sheet location. These tallies are linearly rescaled to serve as the allocentric drive to excitatory populations.</p></sec><sec id="s4-4"><title>Single neuron recording and decoding</title><p>We simulate our model 10 times with slightly different run trajectories randomly generated by fractional Brownian motion processes, followed by 10 more times with the same trajectories but reversed velocities. These simulations produce spike trains for all neurons in the network. To match multiunit tetrode recordings, we select two sets of up to 150 excitatory neurons in each simulation. Each of these sets is an independent recording to be analyzed separately, which we call a ‘simulation’ in our results.</p><p>We select neurons for recording as follows. For the first set, we choose four points on the neural sheet whose distance from the center is 95 neurons and whose angular positions, or clock positions, are random but equally spaced. From circular areas of radius 12 centered at these points, we randomly select up to 150 excitatory neurons whose firing fields are stable across laps. For the second set, we choose the four circular areas with the same distance from the center of the sheet and with angular positions offset 45° from the first four areas. We again select up to 150 neurons with stable firing fields. All single-simulation results reported in the main text come from the same simulation.</p><p>We use grid cell firing fields accrued from all laps in both directions to decode the animal’s position from the population activity of its recorded neurons. We use the standard Bayesian decoding procedure that assumes independent, Poisson-distributed spike counts and a uniform prior (<xref ref-type="bibr" rid="bib117">Zhang et al., 1998</xref>; <xref ref-type="bibr" rid="bib69">O'Neill et al., 2017</xref>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>The authors thank John Widloski, David Foster, Fritz Sommer, Zengyi Li, Guy Isely, Kate Jeffery, Hugo Spiers, and Srdjan Ostojic for stimulating discussions and helpful ideas. Part of this work was performed at the Simons Institute for the Theory of Computing.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Resources, Supervision, Funding acquisition, Visualization, Writing—original draft, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="scode1"><label>Source code 1.</label><caption><title>Source code for the main simulation written in C.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-46351-code1-v2.zip"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-46351-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Source code for the simulations have been included as supporting files.</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ambrose</surname> <given-names>RE</given-names></name><name><surname>Pfeiffer</surname> <given-names>BE</given-names></name><name><surname>Foster</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Reverse replay of hippocampal place cells is uniquely modulated by changing reward</article-title><source>Neuron</source><volume>91</volume><fpage>1124</fpage><lpage>1136</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.07.047</pub-id><pub-id pub-id-type="pmid">27568518</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname> <given-names>MI</given-names></name><name><surname>Jeffery</surname> <given-names>KJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Heterogeneous modulation of place cell firing by changes in context</article-title><source>The Journal of Neuroscience</source><volume>23</volume><fpage>8827</fpage><lpage>8835</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.23-26-08827.2003</pub-id><pub-id pub-id-type="pmid">14523083</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Angulo-Garcia</surname> <given-names>D</given-names></name><name><surname>Ferraris</surname> <given-names>M</given-names></name><name><surname>Ghestem</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Spatio-temporal organization of cell assemblies in nucleus reuniens during slow oscillations</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/474973</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Azizi</surname> <given-names>AH</given-names></name><name><surname>Wiskott</surname> <given-names>L</given-names></name><name><surname>Cheng</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A computational model for preplay in the Hippocampus</article-title><source>Frontiers in Computational Neuroscience</source><volume>7</volume><elocation-id>161</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2013.00161</pub-id><pub-id pub-id-type="pmid">24282402</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bayati</surname> <given-names>M</given-names></name><name><surname>Valizadeh</surname> <given-names>A</given-names></name><name><surname>Abbassian</surname> <given-names>A</given-names></name><name><surname>Cheng</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Self-organization of synchronous activity propagation in neuronal networks driven by local excitation</article-title><source>Frontiers in Computational Neuroscience</source><volume>9</volume><elocation-id>e00069</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2015.00069</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Belchior</surname> <given-names>H</given-names></name><name><surname>Lopes-Dos-Santos</surname> <given-names>V</given-names></name><name><surname>Tort</surname> <given-names>AB</given-names></name><name><surname>Ribeiro</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Increase in hippocampal theta oscillations during spatial decision making</article-title><source>Hippocampus</source><volume>24</volume><fpage>693</fpage><lpage>702</lpage><pub-id pub-id-type="doi">10.1002/hipo.22260</pub-id><pub-id pub-id-type="pmid">24520011</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonnevie</surname> <given-names>T</given-names></name><name><surname>Dunn</surname> <given-names>B</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Derdikman</surname> <given-names>D</given-names></name><name><surname>Kubie</surname> <given-names>JL</given-names></name><name><surname>Roudi</surname> <given-names>Y</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Grid cells require excitatory drive from the Hippocampus</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>309</fpage><lpage>317</lpage><pub-id pub-id-type="doi">10.1038/nn.3311</pub-id><pub-id pub-id-type="pmid">23334581</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brandon</surname> <given-names>MP</given-names></name><name><surname>Bogaard</surname> <given-names>AR</given-names></name><name><surname>Libby</surname> <given-names>CP</given-names></name><name><surname>Connerney</surname> <given-names>MA</given-names></name><name><surname>Gupta</surname> <given-names>K</given-names></name><name><surname>Hasselmo</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Reduction of theta rhythm dissociates grid cell spatial periodicity from directional tuning</article-title><source>Science</source><volume>332</volume><fpage>595</fpage><lpage>599</lpage><pub-id pub-id-type="doi">10.1126/science.1201652</pub-id><pub-id pub-id-type="pmid">21527714</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burak</surname> <given-names>Y</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Accurate path integration in continuous attractor network models of grid cells</article-title><source>PLOS Computational Biology</source><volume>5</volume><elocation-id>e1000291</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000291</pub-id><pub-id pub-id-type="pmid">19229307</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>An oscillatory interference model of grid cell firing</article-title><source>Hippocampus</source><volume>17</volume><fpage>801</fpage><lpage>812</lpage><pub-id pub-id-type="doi">10.1002/hipo.20327</pub-id><pub-id pub-id-type="pmid">17598147</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname> <given-names>D</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A hybrid oscillatory interference/continuous attractor network model of grid cell firing</article-title><source>The Journal of Neuroscience</source><volume>34</volume><fpage>5065</fpage><lpage>5079</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4017-13.2014</pub-id><pub-id pub-id-type="pmid">24695724</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Hippocampal sharp waves: their origin and significance</article-title><source>Brain Research</source><volume>398</volume><fpage>242</fpage><lpage>252</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(86)91483-6</pub-id><pub-id pub-id-type="pmid">3026567</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>The hippocampo-neocortical dialogue</article-title><source>Cerebral Cortex</source><volume>6</volume><fpage>81</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1093/cercor/6.2.81</pub-id><pub-id pub-id-type="pmid">8670641</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Theta oscillations in the Hippocampus</article-title><source>Neuron</source><volume>33</volume><fpage>325</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(02)00586-X</pub-id><pub-id pub-id-type="pmid">11832222</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname> <given-names>G</given-names></name><name><surname>Anastassiou</surname> <given-names>CA</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The origin of extracellular fields and currents--EEG, ECoG, LFP and spikes</article-title><source>Nature Reviews Neuroscience</source><volume>13</volume><fpage>407</fpage><lpage>420</lpage><pub-id pub-id-type="doi">10.1038/nrn3241</pub-id><pub-id pub-id-type="pmid">22595786</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chance</surname> <given-names>FS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Hippocampal phase precession from dual input components</article-title><source>Journal of Neuroscience</source><volume>32</volume><fpage>16693</fpage><lpage>16703</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2786-12.2012</pub-id><pub-id pub-id-type="pmid">23175823</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname> <given-names>S</given-names></name><name><surname>Frank</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The structure of networks that produce the transformation from grid cells to place cells</article-title><source>Neuroscience</source><volume>197</volume><fpage>293</fpage><lpage>306</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2011.09.002</pub-id><pub-id pub-id-type="pmid">21963867</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chenkov</surname> <given-names>N</given-names></name><name><surname>Sprekeler</surname> <given-names>H</given-names></name><name><surname>Kempter</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Memory replay in balanced recurrent networks</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005359</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005359</pub-id><pub-id pub-id-type="pmid">28135266</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chrobak</surname> <given-names>JJ</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>High-frequency oscillations in the output networks of the hippocampal-entorhinal Axis of the freely behaving rat</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>3056</fpage><lpage>3066</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-09-03056.1996</pub-id><pub-id pub-id-type="pmid">8622135</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chrobak</surname> <given-names>JJ</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Gamma oscillations in the entorhinal cortex of the freely behaving rat</article-title><source>The Journal of Neuroscience</source><volume>18</volume><fpage>388</fpage><lpage>398</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.18-01-00388.1998</pub-id><pub-id pub-id-type="pmid">9412515</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Climer</surname> <given-names>JR</given-names></name><name><surname>Newman</surname> <given-names>EL</given-names></name><name><surname>Hasselmo</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Phase coding by grid cells in unconstrained environments: two-dimensional phase precession</article-title><source>European Journal of Neuroscience</source><volume>38</volume><fpage>2526</fpage><lpage>2541</lpage><pub-id pub-id-type="doi">10.1111/ejn.12256</pub-id><pub-id pub-id-type="pmid">23718553</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colgin</surname> <given-names>LL</given-names></name><name><surname>Denninger</surname> <given-names>T</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Bonnevie</surname> <given-names>T</given-names></name><name><surname>Jensen</surname> <given-names>O</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Frequency of gamma oscillations routes flow of information in the Hippocampus</article-title><source>Nature</source><volume>462</volume><fpage>353</fpage><lpage>357</lpage><pub-id pub-id-type="doi">10.1038/nature08573</pub-id><pub-id pub-id-type="pmid">19924214</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couey</surname> <given-names>JJ</given-names></name><name><surname>Witoelar</surname> <given-names>A</given-names></name><name><surname>Zhang</surname> <given-names>SJ</given-names></name><name><surname>Zheng</surname> <given-names>K</given-names></name><name><surname>Ye</surname> <given-names>J</given-names></name><name><surname>Dunn</surname> <given-names>B</given-names></name><name><surname>Czajkowski</surname> <given-names>R</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Roudi</surname> <given-names>Y</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Recurrent inhibitory circuitry as a mechanism for grid formation</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>318</fpage><lpage>324</lpage><pub-id pub-id-type="doi">10.1038/nn.3310</pub-id><pub-id pub-id-type="pmid">23334580</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davidson</surname> <given-names>TJ</given-names></name><name><surname>Kloosterman</surname> <given-names>F</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Hippocampal replay of extended experience</article-title><source>Neuron</source><volume>63</volume><fpage>497</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.07.027</pub-id><pub-id pub-id-type="pmid">19709631</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diba</surname> <given-names>K</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Forward and reverse hippocampal place-cell sequences during ripples</article-title><source>Nature Neuroscience</source><volume>10</volume><fpage>1241</fpage><lpage>1242</lpage><pub-id pub-id-type="doi">10.1038/nn1961</pub-id><pub-id pub-id-type="pmid">17828259</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diehl</surname> <given-names>GW</given-names></name><name><surname>Hon</surname> <given-names>OJ</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Stability of medial entorhinal cortex representations over time</article-title><source>Hippocampus</source><volume>29</volume><fpage>284</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1002/hipo.23017</pub-id><pub-id pub-id-type="pmid">30175425</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragoi</surname> <given-names>G</given-names></name><name><surname>Tonegawa</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Preplay of future place cell sequences by hippocampal cellular assemblies</article-title><source>Nature</source><volume>469</volume><fpage>397</fpage><lpage>401</lpage><pub-id pub-id-type="doi">10.1038/nature09633</pub-id><pub-id pub-id-type="pmid">21179088</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drieu</surname> <given-names>C</given-names></name><name><surname>Todorova</surname> <given-names>R</given-names></name><name><surname>Zugaro</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Nested sequences of hippocampal assemblies during behavior support subsequent sleep replay</article-title><source>Science</source><volume>362</volume><fpage>675</fpage><lpage>679</lpage><pub-id pub-id-type="doi">10.1126/science.aat2952</pub-id><pub-id pub-id-type="pmid">30409880</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunn</surname> <given-names>B</given-names></name><name><surname>Mørreaunet</surname> <given-names>M</given-names></name><name><surname>Roudi</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Correlations and functional connections in a population of grid cells</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004052</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004052</pub-id><pub-id pub-id-type="pmid">25714908</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ebbesen</surname> <given-names>CL</given-names></name><name><surname>Reifenstein</surname> <given-names>ET</given-names></name><name><surname>Tang</surname> <given-names>Q</given-names></name><name><surname>Burgalossi</surname> <given-names>A</given-names></name><name><surname>Ray</surname> <given-names>S</given-names></name><name><surname>Schreiber</surname> <given-names>S</given-names></name><name><surname>Kempter</surname> <given-names>R</given-names></name><name><surname>Brecht</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Cell Type-Specific differences in spike timing and spike shape in the rat parasubiculum and superficial medial entorhinal cortex</article-title><source>Cell Reports</source><volume>16</volume><fpage>1005</fpage><lpage>1015</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2016.06.057</pub-id><pub-id pub-id-type="pmid">27425616</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="thesis"><person-group person-group-type="author"><name><surname>English</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Spiking Neural Network Models for the Emergence of Patterned Activity in Grid Cell Populations</article-title><publisher-loc>Switzerland</publisher-loc><publisher-name>ETH Zurich and University of Zurich</publisher-name></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evans</surname> <given-names>T</given-names></name><name><surname>Bicanski</surname> <given-names>A</given-names></name><name><surname>Bush</surname> <given-names>D</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>How environment and self-motion combine in neural representations of space</article-title><source>The Journal of Physiology</source><volume>594</volume><fpage>6535</fpage><lpage>6546</lpage><pub-id pub-id-type="doi">10.1113/JP270666</pub-id><pub-id pub-id-type="pmid">26607203</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname> <given-names>T</given-names></name><name><surname>Silva</surname> <given-names>D</given-names></name><name><surname>Foster</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dissociation between the experience-dependent development of hippocampal theta sequences and single-trial phase precession</article-title><source>Journal of Neuroscience</source><volume>35</volume><fpage>4890</fpage><lpage>4902</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2614-14.2015</pub-id><pub-id pub-id-type="pmid">25810520</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Replay comes of age</article-title><source>Annual Review of Neuroscience</source><volume>40</volume><fpage>581</fpage><lpage>602</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-072116-031538</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname> <given-names>DJ</given-names></name><name><surname>Knierim</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Sequence learning and the role of the Hippocampus in rodent navigation</article-title><source>Current Opinion in Neurobiology</source><volume>22</volume><fpage>294</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.12.005</pub-id><pub-id pub-id-type="pmid">22226994</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname> <given-names>DJ</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Reverse replay of behavioural sequences in hippocampal place cells during the awake state</article-title><source>Nature</source><volume>440</volume><fpage>680</fpage><lpage>683</lpage><pub-id pub-id-type="doi">10.1038/nature04587</pub-id><pub-id pub-id-type="pmid">16474382</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuchs</surname> <given-names>EC</given-names></name><name><surname>Neitz</surname> <given-names>A</given-names></name><name><surname>Pinna</surname> <given-names>R</given-names></name><name><surname>Melzer</surname> <given-names>S</given-names></name><name><surname>Caputi</surname> <given-names>A</given-names></name><name><surname>Monyer</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Local and distant input controlling excitation in layer II of the medial entorhinal cortex</article-title><source>Neuron</source><volume>89</volume><fpage>194</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.11.029</pub-id><pub-id pub-id-type="pmid">26711115</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gönner</surname> <given-names>L</given-names></name><name><surname>Vitay</surname> <given-names>J</given-names></name><name><surname>Hamker</surname> <given-names>FH</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Predictive Place-Cell sequences for Goal-Finding emerge from goal memory and the cognitive map: a computational model</article-title><source>Frontiers in Computational Neuroscience</source><volume>11</volume><elocation-id>84</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2017.00084</pub-id><pub-id pub-id-type="pmid">29075187</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonzalez-Sulser</surname> <given-names>A</given-names></name><name><surname>Parthier</surname> <given-names>D</given-names></name><name><surname>Candela</surname> <given-names>A</given-names></name><name><surname>McClure</surname> <given-names>C</given-names></name><name><surname>Pastoll</surname> <given-names>H</given-names></name><name><surname>Garden</surname> <given-names>D</given-names></name><name><surname>Sürmeli</surname> <given-names>G</given-names></name><name><surname>Nolan</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>GABAergic projections from the medial septum selectively inhibit interneurons in the medial entorhinal cortex</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>16739</fpage><lpage>16743</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1612-14.2014</pub-id><pub-id pub-id-type="pmid">25505326</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grosmark</surname> <given-names>AD</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Diversity in neural firing dynamics supports both rigid and learned hippocampal sequences</article-title><source>Science</source><volume>351</volume><fpage>1440</fpage><lpage>1443</lpage><pub-id pub-id-type="doi">10.1126/science.aad1935</pub-id><pub-id pub-id-type="pmid">27013730</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname> <given-names>Y</given-names></name><name><surname>Lewallen</surname> <given-names>S</given-names></name><name><surname>Kinkhabwala</surname> <given-names>AA</given-names></name><name><surname>Domnisoru</surname> <given-names>C</given-names></name><name><surname>Yoon</surname> <given-names>K</given-names></name><name><surname>Gauthier</surname> <given-names>JL</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name><name><surname>Tank</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A Map-like Micro-Organization of grid cells in the medial entorhinal cortex</article-title><source>Cell</source><volume>175</volume><fpage>736</fpage><lpage>750</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.08.066</pub-id><pub-id pub-id-type="pmid">30270041</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Molden</surname> <given-names>S</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Microstructure of a spatial map in the entorhinal cortex</article-title><source>Nature</source><volume>436</volume><fpage>801</fpage><lpage>806</lpage><pub-id pub-id-type="doi">10.1038/nature03721</pub-id><pub-id pub-id-type="pmid">15965463</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Bonnevie</surname> <given-names>T</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Hippocampus-independent phase precession in entorhinal grid cells</article-title><source>Nature</source><volume>453</volume><fpage>1248</fpage><lpage>1252</lpage><pub-id pub-id-type="doi">10.1038/nature06957</pub-id><pub-id pub-id-type="pmid">18480753</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haga</surname> <given-names>T</given-names></name><name><surname>Fukai</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Recurrent network model for learning goal-directed sequences through reverse replay</article-title><source>eLife</source><volume>7</volume><elocation-id>e34171</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.34171</pub-id><pub-id pub-id-type="pmid">29969098</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hahn</surname> <given-names>TT</given-names></name><name><surname>McFarland</surname> <given-names>JM</given-names></name><name><surname>Berberich</surname> <given-names>S</given-names></name><name><surname>Sakmann</surname> <given-names>B</given-names></name><name><surname>Mehta</surname> <given-names>MR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Spontaneous persistent activity in entorhinal cortex modulates cortico-hippocampal interaction in vivo</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1531</fpage><lpage>1538</lpage><pub-id pub-id-type="doi">10.1038/nn.3236</pub-id><pub-id pub-id-type="pmid">23042081</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hales</surname> <given-names>JB</given-names></name><name><surname>Schlesiger</surname> <given-names>MI</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name><name><surname>Squire</surname> <given-names>LR</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name><name><surname>Clark</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Medial entorhinal cortex lesions only partially disrupt hippocampal place cells and hippocampus-dependent place memory</article-title><source>Cell Reports</source><volume>9</volume><fpage>893</fpage><lpage>901</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2014.10.009</pub-id><pub-id pub-id-type="pmid">25437546</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardcastle</surname> <given-names>K</given-names></name><name><surname>Ganguli</surname> <given-names>S</given-names></name><name><surname>Giocomo</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Environmental boundaries as an error correction mechanism for grid cells</article-title><source>Neuron</source><volume>86</volume><fpage>827</fpage><lpage>839</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.03.039</pub-id><pub-id pub-id-type="pmid">25892299</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hasselmo</surname> <given-names>ME</given-names></name><name><surname>Giocomo</surname> <given-names>LM</given-names></name><name><surname>Zilli</surname> <given-names>EA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Grid cell firing may arise from interference of theta frequency membrane potential oscillations in single neurons</article-title><source>Hippocampus</source><volume>17</volume><fpage>1252</fpage><lpage>1271</lpage><pub-id pub-id-type="doi">10.1002/hipo.20374</pub-id><pub-id pub-id-type="pmid">17924530</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heys</surname> <given-names>JG</given-names></name><name><surname>Rangarajan</surname> <given-names>KV</given-names></name><name><surname>Dombeck</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The functional micro-organization of grid cells revealed by cellular-resolution imaging</article-title><source>Neuron</source><volume>84</volume><fpage>1079</fpage><lpage>1090</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.10.048</pub-id><pub-id pub-id-type="pmid">25467986</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hollup</surname> <given-names>SA</given-names></name><name><surname>Molden</surname> <given-names>S</given-names></name><name><surname>Donnett</surname> <given-names>JG</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Accumulation of hippocampal place fields at the goal location in an annular watermaze task</article-title><source>The Journal of Neuroscience</source><volume>21</volume><fpage>1635</fpage><lpage>1644</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.21-05-01635.2001</pub-id><pub-id pub-id-type="pmid">11222654</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeewajee</surname> <given-names>A</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Douchamps</surname> <given-names>V</given-names></name><name><surname>Manson</surname> <given-names>D</given-names></name><name><surname>Lever</surname> <given-names>C</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Theta phase precession of grid and place cell firing in open environments</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>369</volume><elocation-id>20120532</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2012.0532</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname> <given-names>A</given-names></name><name><surname>Redish</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>12176</fpage><lpage>12189</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3761-07.2007</pub-id><pub-id pub-id-type="pmid">17989284</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname> <given-names>L</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A geometric attractor mechanism for self-organization of entorhinal grid modules</article-title><source>eLife</source><volume>8</volume><elocation-id>e46687</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.46687</pub-id><pub-id pub-id-type="pmid">31373556</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keinath</surname> <given-names>AT</given-names></name><name><surname>Epstein</surname> <given-names>RA</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Environmental deformations dynamically shift the grid cell spatial metric</article-title><source>eLife</source><volume>7</volume><elocation-id>e38169</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.38169</pub-id><pub-id pub-id-type="pmid">30346272</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kempter</surname> <given-names>R</given-names></name><name><surname>Leibold</surname> <given-names>C</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name><name><surname>Diba</surname> <given-names>K</given-names></name><name><surname>Schmidt</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Quantifying circular-linear associations: hippocampal phase precession</article-title><source>Journal of Neuroscience Methods</source><volume>207</volume><fpage>113</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2012.03.007</pub-id><pub-id pub-id-type="pmid">22487609</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kerr</surname> <given-names>KM</given-names></name><name><surname>Agster</surname> <given-names>KL</given-names></name><name><surname>Furtak</surname> <given-names>SC</given-names></name><name><surname>Burwell</surname> <given-names>RD</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Functional neuroanatomy of the parahippocampal region: the lateral and medial entorhinal Areas</article-title><source>Hippocampus</source><volume>17</volume><fpage>697</fpage><lpage>708</lpage><pub-id pub-id-type="doi">10.1002/hipo.20315</pub-id><pub-id pub-id-type="pmid">17607757</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koenig</surname> <given-names>J</given-names></name><name><surname>Linder</surname> <given-names>AN</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The spatial periodicity of grid cells is not sustained during reduced theta oscillations</article-title><source>Science</source><volume>332</volume><fpage>592</fpage><lpage>595</lpage><pub-id pub-id-type="doi">10.1126/science.1201685</pub-id><pub-id pub-id-type="pmid">21527713</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>AK</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Memory of sequential experience in the Hippocampus during slow wave sleep</article-title><source>Neuron</source><volume>36</volume><fpage>1183</fpage><lpage>1194</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(02)01096-6</pub-id><pub-id pub-id-type="pmid">12495631</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leutgeb</surname> <given-names>JK</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Pattern separation in the dentate gyrus and CA3 of the Hippocampus</article-title><source>Science</source><volume>315</volume><fpage>961</fpage><lpage>966</lpage><pub-id pub-id-type="doi">10.1126/science.1135801</pub-id><pub-id pub-id-type="pmid">17303747</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>K</given-names></name><name><surname>Sibille</surname> <given-names>J</given-names></name><name><surname>Dragoi</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Generative predictive codes by multiplexed hippocampal neuronal tuplets</article-title><source>Neuron</source><volume>99</volume><fpage>1329</fpage><lpage>1341</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.07.047</pub-id><pub-id pub-id-type="pmid">30146305</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>K</given-names></name><name><surname>Sibille</surname> <given-names>J</given-names></name><name><surname>Dragoi</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Preconfigured patterns are the primary driver of offline multi-neuronal sequence replay</article-title><source>Hippocampus</source><volume>29</volume><fpage>275</fpage><lpage>283</lpage><pub-id pub-id-type="doi">10.1002/hipo.23034</pub-id><pub-id pub-id-type="pmid">30260526</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mamad</surname> <given-names>O</given-names></name><name><surname>Stumpp</surname> <given-names>L</given-names></name><name><surname>McNamara</surname> <given-names>HM</given-names></name><name><surname>Ramakrishnan</surname> <given-names>C</given-names></name><name><surname>Deisseroth</surname> <given-names>K</given-names></name><name><surname>Reilly</surname> <given-names>RB</given-names></name><name><surname>Tsanov</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Place field assembly distribution encodes preferred locations</article-title><source>PLOS Biology</source><volume>15</volume><elocation-id>e2002365</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.2002365</pub-id><pub-id pub-id-type="pmid">28898248</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Middleton</surname> <given-names>SJ</given-names></name><name><surname>Kneller</surname> <given-names>EM</given-names></name><name><surname>Chen</surname> <given-names>S</given-names></name><name><surname>Ogiwara</surname> <given-names>I</given-names></name><name><surname>Montal</surname> <given-names>M</given-names></name><name><surname>Yamakawa</surname> <given-names>K</given-names></name><name><surname>McHugh</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Altered hippocampal replay is associated with memory impairment in mice heterozygous for the Scn2a gene</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>996</fpage><lpage>1003</lpage><pub-id pub-id-type="doi">10.1038/s41593-018-0163-8</pub-id><pub-id pub-id-type="pmid">29867081</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Navratilova</surname> <given-names>Z</given-names></name><name><surname>Giocomo</surname> <given-names>LM</given-names></name><name><surname>Fellous</surname> <given-names>JM</given-names></name><name><surname>Hasselmo</surname> <given-names>ME</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Phase precession and variable spatial scaling in a periodic attractor map model of medial entorhinal grid cells with realistic after-spike dynamics</article-title><source>Hippocampus</source><volume>22</volume><fpage>772</fpage><lpage>789</lpage><pub-id pub-id-type="doi">10.1002/hipo.20939</pub-id><pub-id pub-id-type="pmid">21484936</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Nolan</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><chapter-title>A Model for Grid Firing and Theta-Nested Gamma Oscillations in Layer 2 of the Medial EntorhinalCortex</chapter-title><source>Hippocampal Microcircuits</source><publisher-name>Springer</publisher-name><fpage>567</fpage><lpage>584</lpage><pub-id pub-id-type="doi">10.1007/978-3-319-99103-0_15</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>Place units in the Hippocampus of the freely moving rat</article-title><source>Experimental Neurology</source><volume>51</volume><fpage>78</fpage><lpage>109</lpage><pub-id pub-id-type="doi">10.1016/0014-4886(76)90055-8</pub-id><pub-id pub-id-type="pmid">1261644</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Dostrovsky</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>The Hippocampus as a spatial map. Preliminary evidence from unit activity in the freely-moving rat</article-title><source>Brain Research</source><volume>34</volume><fpage>171</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(71)90358-1</pub-id><pub-id pub-id-type="pmid">5124915</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Recce</surname> <given-names>ML</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Phase relationship between hippocampal place units and the EEG theta rhythm</article-title><source>Hippocampus</source><volume>3</volume><fpage>317</fpage><lpage>330</lpage><pub-id pub-id-type="doi">10.1002/hipo.450030307</pub-id><pub-id pub-id-type="pmid">8353611</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Neill</surname> <given-names>J</given-names></name><name><surname>Boccara</surname> <given-names>CN</given-names></name><name><surname>Stella</surname> <given-names>F</given-names></name><name><surname>Schoenenberger</surname> <given-names>P</given-names></name><name><surname>Csicsvari</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Superficial layers of the medial entorhinal cortex replay independently of the Hippocampus</article-title><source>Science</source><volume>355</volume><fpage>184</fpage><lpage>188</lpage><pub-id pub-id-type="doi">10.1126/science.aag2787</pub-id><pub-id pub-id-type="pmid">28082591</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ocko</surname> <given-names>SA</given-names></name><name><surname>Hardcastle</surname> <given-names>K</given-names></name><name><surname>Giocomo</surname> <given-names>LM</given-names></name><name><surname>Ganguli</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Emergent elasticity in the neural code for space</article-title><source>PNAS</source><volume>1154</volume><elocation-id>e11798</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.1805959115</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ólafsdóttir</surname> <given-names>HF</given-names></name><name><surname>Carpenter</surname> <given-names>F</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Coordinated grid and place cell replay during rest</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>792</fpage><lpage>794</lpage><pub-id pub-id-type="doi">10.1038/nn.4291</pub-id><pub-id pub-id-type="pmid">27089021</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ólafsdóttir</surname> <given-names>HF</given-names></name><name><surname>Carpenter</surname> <given-names>F</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Task demands predict a dynamic switch in the content of awake hippocampal replay</article-title><source>Neuron</source><volume>96</volume><fpage>925</fpage><lpage>935</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.09.035</pub-id><pub-id pub-id-type="pmid">29056296</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ólafsdóttir</surname> <given-names>HF</given-names></name><name><surname>Bush</surname> <given-names>D</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The role of hippocampal replay in memory and Planning</article-title><source>Current Biology</source><volume>28</volume><fpage>R37</fpage><lpage>R50</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2017.10.073</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliva</surname> <given-names>A</given-names></name><name><surname>Fernández-Ruiz</surname> <given-names>A</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name><name><surname>Berényi</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Role of hippocampal CA2 region in triggering Sharp-Wave ripples</article-title><source>Neuron</source><volume>91</volume><fpage>1342</fpage><lpage>1355</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.08.008</pub-id><pub-id pub-id-type="pmid">27593179</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palmer</surname> <given-names>J</given-names></name><name><surname>Keane</surname> <given-names>A</given-names></name><name><surname>Gong</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Learning and executing goal-directed choices by internally generated sequences in spiking neural circuits</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005669</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005669</pub-id><pub-id pub-id-type="pmid">28759562</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palmer</surname> <given-names>JHC</given-names></name><name><surname>Gong</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Formation and regulation of dynamic patterns in Two-Dimensional spiking neural circuits with Spike-Timing-Dependent plasticity</article-title><source>Neural Computation</source><volume>25</volume><fpage>2833</fpage><lpage>2857</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00511</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname> <given-names>BE</given-names></name><name><surname>Foster</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Hippocampal place-cell sequences depict future paths to remembered goals</article-title><source>Nature</source><volume>497</volume><fpage>74</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1038/nature12112</pub-id><pub-id pub-id-type="pmid">23594744</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname> <given-names>BE</given-names></name><name><surname>Foster</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>PLACE CELLS. Autoassociative dynamics in the generation of sequences of hippocampal place cells</article-title><source>Science</source><volume>349</volume><fpage>180</fpage><lpage>183</lpage><pub-id pub-id-type="doi">10.1126/science.aaa9633</pub-id><pub-id pub-id-type="pmid">26160946</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ponulak</surname> <given-names>F</given-names></name><name><surname>Hopfield</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Rapid, parallel path planning by propagating wavefronts of spiking neural activity</article-title><source>Frontiers in Computational Neuroscience</source><volume>7</volume><elocation-id>98</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2013.00098</pub-id><pub-id pub-id-type="pmid">23882213</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramirez-Villegas</surname> <given-names>JF</given-names></name><name><surname>Willeke</surname> <given-names>KF</given-names></name><name><surname>Logothetis</surname> <given-names>NK</given-names></name><name><surname>Besserve</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dissecting the synapse- and Frequency-Dependent network mechanisms of in Vivo Hippocampal Sharp Wave-Ripples</article-title><source>Neuron</source><volume>100</volume><fpage>1224</fpage><lpage>1240</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.09.041</pub-id><pub-id pub-id-type="pmid">30482688</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raudies</surname> <given-names>F</given-names></name><name><surname>Hasselmo</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Differences in Visual-Spatial input may underlie different compression properties of firing fields for grid cell modules in medial entorhinal cortex</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004596</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004596</pub-id><pub-id pub-id-type="pmid">26584432</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reifenstein</surname> <given-names>E</given-names></name><name><surname>Stemmler</surname> <given-names>M</given-names></name><name><surname>Herz</surname> <given-names>AV</given-names></name><name><surname>Kempter</surname> <given-names>R</given-names></name><name><surname>Schreiber</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Movement dependence and layer specificity of entorhinal phase precession in two-dimensional environments</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e100638</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0100638</pub-id><pub-id pub-id-type="pmid">24959748</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reifenstein</surname> <given-names>ET</given-names></name><name><surname>Ebbesen</surname> <given-names>CL</given-names></name><name><surname>Tang</surname> <given-names>Q</given-names></name><name><surname>Brecht</surname> <given-names>M</given-names></name><name><surname>Schreiber</surname> <given-names>S</given-names></name><name><surname>Kempter</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Cell-Type specific phase precession in layer II of the medial entorhinal cortex</article-title><source>The Journal of Neuroscience</source><volume>36</volume><fpage>2283</fpage><lpage>2288</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2986-15.2016</pub-id><pub-id pub-id-type="pmid">26888937</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sargolini</surname> <given-names>F</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Conjunctive representation of position, direction, and velocity in entorhinal cortex</article-title><source>Science</source><volume>312</volume><fpage>758</fpage><lpage>762</lpage><pub-id pub-id-type="doi">10.1126/science.1125572</pub-id><pub-id pub-id-type="pmid">16675704</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sasaki</surname> <given-names>T</given-names></name><name><surname>Piatti</surname> <given-names>VC</given-names></name><name><surname>Hwaun</surname> <given-names>E</given-names></name><name><surname>Ahmadi</surname> <given-names>S</given-names></name><name><surname>Lisman</surname> <given-names>JE</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dentate network activity is necessary for spatial working memory by supporting CA3 sharp-wave ripple generation and prospective firing of CA3 neurons</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>258</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1038/s41593-017-0061-5</pub-id><pub-id pub-id-type="pmid">29335604</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savelli</surname> <given-names>F</given-names></name><name><surname>Luck</surname> <given-names>JD</given-names></name><name><surname>Knierim</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Framing of grid cells within and beyond navigation boundaries</article-title><source>eLife</source><volume>6</volume><elocation-id>e21354</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.21354</pub-id><pub-id pub-id-type="pmid">28084992</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schlesiger</surname> <given-names>MI</given-names></name><name><surname>Cannova</surname> <given-names>CC</given-names></name><name><surname>Boublil</surname> <given-names>BL</given-names></name><name><surname>Hales</surname> <given-names>JB</given-names></name><name><surname>Mankin</surname> <given-names>EA</given-names></name><name><surname>Brandon</surname> <given-names>MP</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name><name><surname>Leibold</surname> <given-names>C</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The medial entorhinal cortex is necessary for temporal organization of hippocampal neuronal activity</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>1123</fpage><lpage>1132</lpage><pub-id pub-id-type="doi">10.1038/nn.4056</pub-id><pub-id pub-id-type="pmid">26120964</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schlingloff</surname> <given-names>D</given-names></name><name><surname>Káli</surname> <given-names>S</given-names></name><name><surname>Freund</surname> <given-names>TF</given-names></name><name><surname>Hájos</surname> <given-names>N</given-names></name><name><surname>Gulyás</surname> <given-names>AI</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mechanisms of sharp wave initiation and ripple generation</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>11385</fpage><lpage>11398</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0867-14.2014</pub-id><pub-id pub-id-type="pmid">25143618</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname> <given-names>H</given-names></name><name><surname>Gour</surname> <given-names>A</given-names></name><name><surname>Straehle</surname> <given-names>J</given-names></name><name><surname>Boergens</surname> <given-names>KM</given-names></name><name><surname>Brecht</surname> <given-names>M</given-names></name><name><surname>Helmstaedter</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Axonal synapse sorting in medial entorhinal cortex</article-title><source>Nature</source><volume>549</volume><fpage>469</fpage><lpage>475</lpage><pub-id pub-id-type="doi">10.1038/nature24005</pub-id><pub-id pub-id-type="pmid">28959971</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silva</surname> <given-names>D</given-names></name><name><surname>Feng</surname> <given-names>T</given-names></name><name><surname>Foster</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Trajectory events across hippocampal place cells require previous experience</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>1772</fpage><lpage>1779</lpage><pub-id pub-id-type="doi">10.1038/nn.4151</pub-id><pub-id pub-id-type="pmid">26502260</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simon</surname> <given-names>AP</given-names></name><name><surname>Poindessous-Jazat</surname> <given-names>F</given-names></name><name><surname>Dutar</surname> <given-names>P</given-names></name><name><surname>Epelbaum</surname> <given-names>J</given-names></name><name><surname>Bassant</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Firing properties of anatomically identified neurons in the medial septum of anesthetized and unanesthetized restrained rats</article-title><source>Journal of Neuroscience</source><volume>26</volume><fpage>9038</fpage><lpage>9046</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1401-06.2006</pub-id><pub-id pub-id-type="pmid">16943562</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singer</surname> <given-names>AC</given-names></name><name><surname>Carr</surname> <given-names>MF</given-names></name><name><surname>Karlsson</surname> <given-names>MP</given-names></name><name><surname>Frank</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Hippocampal SWR activity predicts correct decisions during the initial learning of an alternation task</article-title><source>Neuron</source><volume>77</volume><fpage>1163</fpage><lpage>1173</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.01.027</pub-id><pub-id pub-id-type="pmid">23522050</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name><name><surname>Barnes</surname> <given-names>CA</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences</article-title><source>Hippocampus</source><volume>6</volume><fpage>149</fpage><lpage>172</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1996)6:2&lt;149::AID-HIPO6&gt;3.0.CO;2-K</pub-id><pub-id pub-id-type="pmid">8797016</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stark</surname> <given-names>E</given-names></name><name><surname>Roux</surname> <given-names>L</given-names></name><name><surname>Eichler</surname> <given-names>R</given-names></name><name><surname>Senzai</surname> <given-names>Y</given-names></name><name><surname>Royer</surname> <given-names>S</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Pyramidal cell-interneuron interactions underlie hippocampal ripple oscillations</article-title><source>Neuron</source><volume>83</volume><fpage>467</fpage><lpage>480</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.06.023</pub-id><pub-id pub-id-type="pmid">25033186</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stensola</surname> <given-names>H</given-names></name><name><surname>Stensola</surname> <given-names>T</given-names></name><name><surname>Solstad</surname> <given-names>T</given-names></name><name><surname>Frøland</surname> <given-names>K</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The entorhinal grid map is discretized</article-title><source>Nature</source><volume>492</volume><fpage>72</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1038/nature11649</pub-id><pub-id pub-id-type="pmid">23222610</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steriade</surname> <given-names>M</given-names></name><name><surname>Timofeev</surname> <given-names>I</given-names></name><name><surname>Grenier</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Natural waking and sleep states: a view from inside neocortical neurons</article-title><source>Journal of Neurophysiology</source><volume>85</volume><fpage>1969</fpage><lpage>1985</lpage><pub-id pub-id-type="doi">10.1152/jn.2001.85.5.1969</pub-id><pub-id pub-id-type="pmid">11353014</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thurley</surname> <given-names>K</given-names></name><name><surname>Leibold</surname> <given-names>C</given-names></name><name><surname>Gundlfinger</surname> <given-names>A</given-names></name><name><surname>Schmitz</surname> <given-names>D</given-names></name><name><surname>Kempter</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Phase precession through synaptic facilitation</article-title><source>Neural Computation</source><volume>20</volume><fpage>1285</fpage><lpage>1324</lpage><pub-id pub-id-type="doi">10.1162/neco.2008.07-06-292</pub-id><pub-id pub-id-type="pmid">18085985</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thurley</surname> <given-names>K</given-names></name><name><surname>Hellmundt</surname> <given-names>F</given-names></name><name><surname>Leibold</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Phase precession of grid cells in a network model without external pacemaker</article-title><source>Hippocampus</source><volume>23</volume><fpage>786</fpage><lpage>796</lpage><pub-id pub-id-type="doi">10.1002/hipo.22133</pub-id><pub-id pub-id-type="pmid">23576429</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trimper</surname> <given-names>JB</given-names></name><name><surname>Trettel</surname> <given-names>SG</given-names></name><name><surname>Hwaun</surname> <given-names>E</given-names></name><name><surname>Colgin</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Methodological caveats in the detection of coordinated replay between place cells and grid cells</article-title><source>Frontiers in Systems Neuroscience</source><volume>11</volume><elocation-id>57</elocation-id><pub-id pub-id-type="doi">10.3389/fnsys.2017.00057</pub-id><pub-id pub-id-type="pmid">28824388</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsodyks</surname> <given-names>MV</given-names></name><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Population dynamics and theta rhythm phase precession of hippocampal place cell firing: a spiking neuron model</article-title><source>Hippocampus</source><volume>6</volume><fpage>271</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1996)6:3&lt;271::AID-HIPO5&gt;3.0.CO;2-Q</pub-id><pub-id pub-id-type="pmid">8841826</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Unal</surname> <given-names>G</given-names></name><name><surname>Joshi</surname> <given-names>A</given-names></name><name><surname>Viney</surname> <given-names>TJ</given-names></name><name><surname>Kis</surname> <given-names>V</given-names></name><name><surname>Somogyi</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Synaptic targets of medial septal projections in the Hippocampus and extrahippocampal cortices of the mouse</article-title><source>Journal of Neuroscience</source><volume>35</volume><fpage>15812</fpage><lpage>15826</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2639-15.2015</pub-id><pub-id pub-id-type="pmid">26631464</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Urdapilleta</surname> <given-names>E</given-names></name><name><surname>Si</surname> <given-names>B</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Selforganization of modular activity of grid cells</article-title><source>Hippocampus</source><volume>27</volume><fpage>1204</fpage><lpage>1213</lpage><pub-id pub-id-type="doi">10.1002/hipo.22765</pub-id><pub-id pub-id-type="pmid">28768062</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vanderwolf</surname> <given-names>CH</given-names></name></person-group><year iso-8601-date="1969">1969</year><article-title>Hippocampal electrical activity and voluntary movement in the rat</article-title><source>Electroencephalography and Clinical Neurophysiology</source><volume>26</volume><fpage>407</fpage><lpage>418</lpage><pub-id pub-id-type="doi">10.1016/0013-4694(69)90092-3</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vinogradova</surname> <given-names>OS</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Expression, control, and probable functional significance of the neuronal theta-rhythm</article-title><source>Progress in Neurobiology</source><volume>45</volume><fpage>523</fpage><lpage>583</lpage><pub-id pub-id-type="doi">10.1016/0301-0082(94)00051-I</pub-id><pub-id pub-id-type="pmid">7624485</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Widloski</surname> <given-names>J</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A model of grid cell development through spatial exploration and spike time-dependent plasticity</article-title><source>Neuron</source><volume>83</volume><fpage>481</fpage><lpage>495</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.06.018</pub-id><pub-id pub-id-type="pmid">25033187</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wikenheiser</surname> <given-names>AM</given-names></name><name><surname>Redish</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2015">2015a</year><article-title>Hippocampal theta sequences reflect current goals</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>289</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1038/nn.3909</pub-id><pub-id pub-id-type="pmid">25559082</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wikenheiser</surname> <given-names>AM</given-names></name><name><surname>Redish</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2015">2015b</year><article-title>Decoding the cognitive map: ensemble hippocampal sequences and decision making</article-title><source>Current Opinion in Neurobiology</source><volume>32</volume><fpage>8</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2014.10.002</pub-id><pub-id pub-id-type="pmid">25463559</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>MA</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Dynamics of the hippocampal ensemble code for space</article-title><source>Science</source><volume>261</volume><fpage>1055</fpage><lpage>1058</lpage><pub-id pub-id-type="doi">10.1126/science.8351520</pub-id><pub-id pub-id-type="pmid">8351520</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winterer</surname> <given-names>J</given-names></name><name><surname>Maier</surname> <given-names>N</given-names></name><name><surname>Wozny</surname> <given-names>C</given-names></name><name><surname>Beed</surname> <given-names>P</given-names></name><name><surname>Breustedt</surname> <given-names>J</given-names></name><name><surname>Evangelista</surname> <given-names>R</given-names></name><name><surname>Peng</surname> <given-names>Y</given-names></name><name><surname>D'Albis</surname> <given-names>T</given-names></name><name><surname>Kempter</surname> <given-names>R</given-names></name><name><surname>Schmitz</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Excitatory microcircuits within superficial layers of the medial entorhinal cortex</article-title><source>Cell Reports</source><volume>19</volume><fpage>1110</fpage><lpage>1116</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2017.04.041</pub-id><pub-id pub-id-type="pmid">28494861</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname> <given-names>C-T</given-names></name><name><surname>Haggerty</surname> <given-names>D</given-names></name><name><surname>Kemere</surname> <given-names>C</given-names></name><name><surname>Ji</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Hippocampal awake replay in fear memory retrieval</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>571</fpage><lpage>580</lpage><pub-id pub-id-type="doi">10.1038/nn.4507</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname> <given-names>X</given-names></name><name><surname>Foster</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Hippocampal replay captures the unique topological structure of a novel environment</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>6459</fpage><lpage>6469</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3414-13.2014</pub-id></element-citation></ref><ref id="bib112"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname> <given-names>H</given-names></name><name><surname>Baracskay</surname> <given-names>P</given-names></name><name><surname>O'Neill</surname> <given-names>J</given-names></name><name><surname>Csicsvari</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Assembly responses of hippocampal CA1 place cells predict learned behavior in Goal-Directed spatial tasks on the radial Eight-Arm maze</article-title><source>Neuron</source><volume>101</volume><fpage>119</fpage><lpage>132</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.11.015</pub-id><pub-id pub-id-type="pmid">30503645</pub-id></element-citation></ref><ref id="bib113"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamaguchi</surname> <given-names>Y</given-names></name><name><surname>Aota</surname> <given-names>Y</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Lipa</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Bimodality of theta phase precession in hippocampal place cells in freely running rats</article-title><source>Journal of Neurophysiology</source><volume>87</volume><fpage>2629</fpage><lpage>2642</lpage><pub-id pub-id-type="doi">10.1152/jn.2002.87.6.2629</pub-id><pub-id pub-id-type="pmid">12037166</pub-id></element-citation></ref><ref id="bib114"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamamoto</surname> <given-names>J</given-names></name><name><surname>Tonegawa</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Direct medial entorhinal cortex input to hippocampal CA1 is crucial for extended quiet awake replay</article-title><source>Neuron</source><volume>96</volume><fpage>217</fpage><lpage>227</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.09.017</pub-id><pub-id pub-id-type="pmid">28957670</pub-id></element-citation></ref><ref id="bib115"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoon</surname> <given-names>K</given-names></name><name><surname>Buice</surname> <given-names>MA</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Hayman</surname> <given-names>R</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Specific evidence of low-dimensional continuous attractor dynamics in grid cells</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1077</fpage><lpage>1084</lpage><pub-id pub-id-type="doi">10.1038/nn.3450</pub-id><pub-id pub-id-type="pmid">23852111</pub-id></element-citation></ref><ref id="bib116"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoshida</surname> <given-names>M</given-names></name><name><surname>Jochems</surname> <given-names>A</given-names></name><name><surname>Hasselmo</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Comparison of properties of medial entorhinal cortex layer II neurons in two anatomical dimensions with and without cholinergic activation</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e73904</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0073904</pub-id><pub-id pub-id-type="pmid">24069244</pub-id></element-citation></ref><ref id="bib117"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>K</given-names></name><name><surname>Ginzburg</surname> <given-names>I</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Interpreting neuronal population activity by reconstruction: unified framework with application to hippocampal place cells</article-title><source>Journal of Neurophysiology</source><volume>79</volume><fpage>1017</fpage><lpage>1044</lpage><pub-id pub-id-type="doi">10.1152/jn.1998.79.2.1017</pub-id><pub-id pub-id-type="pmid">9463459</pub-id></element-citation></ref><ref id="bib118"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname> <given-names>C</given-names></name><name><surname>Bieri</surname> <given-names>KW</given-names></name><name><surname>Hsiao</surname> <given-names>YT</given-names></name><name><surname>Colgin</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Spatial sequence coding differs during slow and fast gamma rhythms in the Hippocampus</article-title><source>Neuron</source><volume>89</volume><fpage>398</fpage><lpage>408</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.12.005</pub-id><pub-id pub-id-type="pmid">26774162</pub-id></element-citation></ref><ref id="bib119"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zielinski</surname> <given-names>MC</given-names></name><name><surname>Tang</surname> <given-names>W</given-names></name><name><surname>Jadhav</surname> <given-names>SP</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The role of replay and theta sequences in mediating hippocampal-prefrontal interactions for memory and cognition</article-title><source>Hippocampus</source><volume>91</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1002/hipo.22821</pub-id></element-citation></ref><ref id="bib120"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zutshi</surname> <given-names>I</given-names></name><name><surname>Fu</surname> <given-names>ML</given-names></name><name><surname>Lilascharoen</surname> <given-names>V</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name><name><surname>Lim</surname> <given-names>BK</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Recurrent circuits within medial entorhinal cortex superficial layers support grid cell firing</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>3701</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-06104-5</pub-id><pub-id pub-id-type="pmid">30209250</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s8" sec-type="appendix"><title>Additional methods</title><sec id="s8-1"><title>Model details</title><sec id="s8-1-1"><title>Setup</title><p>We initialize each neuron on the neural sheet to a random membrane potential between 0 and 1. We evolve the network according to <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> and <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> for 500 timesteps without velocity input to generate a rough grid-like pattern of activity. To make the grid more regular and to anneal grid defects, we perform three evolutions of timesteps with constant velocity input <bold>V</bold> of magnitude 0.5 m/s and angles, <italic>π</italic>/2 –﻿ π/5, 2π/5, and <italic>π</italic>/4 successively. We then evolve the network for 4 laps without idle periods.</p><p>Finally, we learn allocentric inputs as follows. We simulate 2 additional laps with 1000 timesteps of idle periods at each end of this track. During this time, both the excitatory and inhibitory drives are maintained at their run values without theta oscillations. Over the final 500 timesteps at each end, the number of spikes produced at each neural sheet location across the 4 excitatory populations are tallied. These values are linearly rescaled to serve as allocentric inputs to excitatory neurons, with the highest spike count corresponding to <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi mathvariant="normal">a</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> and anything below the 5th percentile of nonzero activity corresponding to <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi mathvariant="normal">a</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>. Then the main simulation phase begins.</p></sec><sec id="s8-1-2"><title>Simulations with periodic boundary conditions</title><p>Since annealing grid defects is difficult with periodic boundary conditions, we initialize membrane potentials with a grid-like configuration on the neural sheet as in <xref ref-type="bibr" rid="bib9">Burak and Fiete (2009)</xref>. The grid scale is chosen to be similar to that self-organized without periodic boundary conditions. The rest of simulation setup proceeds similarly as above, except the three evolutions with constant velocity input last only 500 timesteps each.</p><p>Parameter values that differ from those in <xref ref-type="table" rid="table1">Table 1</xref> are <italic>n</italic> = 192, <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi mathvariant="normal">a</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> during runs and 0.92 when idle for the uniform excitatory drive, <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi mathvariant="normal">a</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1.4</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> during allocentric corrections, <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi mathvariant="normal">a</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.75</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> during runs and –0.1 when idle, and <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi mathvariant="normal">a</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> during runs. Results are shown in <xref ref-type="fig" rid="fig8">Figure 8F, G</xref>.</p></sec><sec id="s8-1-3"><title>Trajectory</title><p>For 2D open field simulations, we use velocity inputs extracted by <xref ref-type="bibr" rid="bib9">Burak and Fiete (2009)</xref> from a real animal trajectory reported in <xref ref-type="bibr" rid="bib42">Hafting et al. (2005)</xref>.</p><p>For 1D track simulations, we generate trajectories as follows. Each trajectory consists of 36 runs alternating in direction, each lasting 1.5 s. Each run is followed by an idle period of 1.5 s and an allocentric correction period of 0.5 s. The velocity angle is <italic>π</italic>/5, chosen to avoid directions of symmetry in the neural sheet.</p><p>In each run, the speed linearly increases from 0 m/s to 0.5 m/s over the first 0.3 s, remains at 0.5 m/s over the next 0.9 s, and linearly decreases from 0.5 m/s to 0 m/s over the last 0.3 s. To the middle 0.9 s of constant speed, we add noise. The noise is generated by a fractional Brownian motion process with drift 0, volatility 1, and Hurst index 0.8. We then add an overall constant at each timestep to make the noise sum to 0 (and thus, to leading order, contribute 0 additional displacement) and introduce an overall scale factor to make its maximum magnitude 0.1 m/s. We add this processed noise to the constant velocity of 0.5 m/s. The initial theta phase of each run is chosen randomly, and the phase increases during runs at a constant rate to span 360° over 125 ms.</p><p>Excitatory and inhibitory drives change between runs and idle periods according to <xref ref-type="table" rid="table1">Table 1</xref>. They do so by linearly interpolating between corresponding values over the first 0.3 s of each idle period.</p></sec></sec><sec id="s8-2"><title>Single neuron recording and position decoding</title><sec id="s8-2-1"><title>Selection of neurons for recording</title><p>As described in Materials and methods, we select up to 150 neurons total for recording from four equally spaced circular areas on the neural sheet (up to 200 neurons total for simulations with periodic boundary conditions). For the main simulation, these areas are centered 95 neurons from the center of the sheet; for the simulations with lower velocity gain in <xref ref-type="fig" rid="fig8">Figure 8A-C</xref>, the distance is 75 neurons; for the simulations with periodic boundary conditions in <xref ref-type="fig" rid="fig8">Figure 8D-G</xref>, the distance is 60 neurons. In each area, we randomly choose 30–50 neurons from each excitatory population and compute their firing fields for each run as follows. We partition space into 5 cm bins and compute the firing rate of each bin as the number of spikes divided by the occupancy time; these raw fields are smoothed by a Gaussian filter of width 4 bins. Firing fields for leftward and rightward runs are considered separately. In at least one direction, recorded neurons must have maximum firing rate above 0.5 Hz for all runs, and the normalized correlation, defined as <inline-formula><mml:math id="inf75"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐮</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐮</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for two vectors <inline-formula><mml:math id="inf76"><mml:mi mathvariant="bold">𝐮</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf77"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula>, must be above 0.6 for all pairs of runs.</p></sec><sec id="s8-2-2"><title>Firing fields</title><p>For 2D open field simulations, we partition space into bins indexed by <bold>R</bold> = (<italic>X</italic>,<italic> Y</italic>) and compute the firing rate of each bin as the number of spikes divided by the occupancy time. These raw fields are smoothed by a Gaussian filter of width 5 bins to produce the field map <italic>F</italic>(<bold>R</bold>). We define the normalized autocorrelation map as<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐑</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐑</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐑</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:munder></mml:mstyle><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐑</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold">𝐑</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi mathvariant="bold">𝐑</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐑</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:munder></mml:mstyle><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐑</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐑</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>N</italic>(<bold>R</bold>) is the number of pairs of positions separated by <bold>R</bold>. Autocorrelation maps are shown in <xref ref-type="fig" rid="fig1">Figure 1E</xref>.</p><p>For 1D track simulations, we partition space into 2 cm bins indexed by <italic>X</italic> and compute the firing rate of each bin as the number of spikes divided by the occupancy time over all laps. These raw fields are smoothed by a Gaussian filter of width 1 bin to produce the field map <italic>F</italic>(<italic>X</italic>). Field maps are shown in <xref ref-type="fig" rid="fig2">Figure 2D</xref>.</p><p>To categorize a simulation as exhibiting 'one field' or 'two fields,' we first order all neurons by the track position at which they are most active. We exclude the middle 40% of all neurons, since we do not expect neurons with central field positions to exhibit two fields. We then shift each field such that its position of peak activity is at 0 cm and calculate the fraction of field activity located more than 18 cm away. If this fraction is greater than 0.1, we consider the simulation as exhibiting two fields. The center of mass of this distant activity, using the absolute value of position, is the distance between fields for the simulation.</p></sec><sec id="s8-2-3"><title>Position decoding</title><p>We use the standard Bayesian techniques to decode position from the population activity of grid cells (<xref ref-type="bibr" rid="bib117">Zhang et al., 1998</xref>; <xref ref-type="bibr" rid="bib69">O'Neill et al., 2017</xref>). Let <italic>s</italic><sub><italic>k</italic></sub>(<italic>t</italic>) count the number of spikes fired by the recorded neuron <italic>k</italic> within a time window of Δ<italic>T </italic>around <italic>t</italic>. Each neuron has a field map <italic>F<sub>k</sub></italic>(<italic>X</italic>) as described above. For every time <italic>t</italic>, we wish to calculate the probability that the animal is at position <italic>X</italic> given the population activity <bold>s</bold>(<italic>t</italic>). We do so through Bayes’s rule, assuming a flat prior and a spiking likelihood that obeys independent Poisson statistics:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We increment time in steps of 5 ms. For theta-related analysis, we use a sliding decoding window of width Δ<italic>T</italic> = 20 ms. For analysis of replays, whose timescales are shorter and spikes are more concentrated, we use Δ<italic>T</italic> = 10 ms and require each window to contain at least two spikes.</p></sec></sec><sec id="s8-3"><title>Theta-related analysis</title><sec id="s8-3-1"><title>Multiunit activity</title><p>To calculate the multiunit activity averaged over theta cycles, we sum spike trains over recorded neurons during each run, extract the multiunit activity of each complete theta cycle, and average these extracts. This theta-modulated multiunit activity is shown in <xref ref-type="fig" rid="fig2">Figure 2E</xref>.</p></sec><sec id="s8-3-2"><title>Phase precession</title><p>We use circular-linear regression and correlation as described in <xref ref-type="bibr" rid="bib55">Kempter et al. (2012)</xref> to quantify the relationship between theta phase and position within a grid field. For each neuron, we combine spikes across all rightward runs and across all leftward runs, considering each direction separately. For each direction, we identify a separation between grid fields as a 10 cm span without spikes. For each neuron and each direction, we only consider the most central field. We exclude fields that spike within 3 cm from the track ends to avoid edge effects, and also exclude fields containing fewer than 30 spikes or spanning less than 12 cm wide.</p><p>For each field, we record the position <italic>X</italic><sub><italic>j</italic> </sub>and theta phase <italic>ψ</italic><sub><italic>j</italic> </sub>at which each of its spikes <italic>j </italic>occurred. We hypothesize that the phase of each spike is linearly influenced by its position:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>q</italic> is the phase precession slope and <italic>ψ</italic><sub>0</sub> is the phase offset. We wish to fit these parameters by minimizing the total circular distance between true phases and corresponding predicted phases. The circular distance between two phases <italic>ψ</italic> and <italic>θ</italic> is defined to be 2[1 – cos(<italic>ψ</italic> – <italic>θ</italic>)]. As explained in <xref ref-type="bibr" rid="bib55">Kempter et al. (2012)</xref>, we can transform the minimization over into the following maximization:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>arg</mml:mi></mml:mpadded><mml:mo movablelimits="false">⁢</mml:mo><mml:mi>max</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:munder><mml:mo>⁡</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>S</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>S</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where is the number of spikes. We perform the maximization numerically over <italic>q</italic>. The maximum value is called the mean resultant length (or vector strength), and it is used as our fit score. The minimizing value of <italic>ψ</italic><sub>0 </sub>can be then calculated directly:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Regression results are shown in <xref ref-type="fig" rid="fig3">Figure 3D, E</xref>.</p><p>We can also estimate the circular-linear correlation coefficient, which is analogous to the Pearson correlation coefficient for two linear variables. Note that since the marginal distribution of Θ may be uniform, we use the following expression (<xref ref-type="bibr" rid="bib55">Kempter et al., 2012</xref>):<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msup><mml:mi>sin</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>ψ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msqrt><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msup><mml:mi>sin</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mover><mml:mi>q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is a circular variable related to <italic>X<sub>j</sub></italic>, and <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>ψ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mrow><mml:mover><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> are respective circular means. This correlation coefficient is shown in <xref ref-type="fig" rid="fig3">Figure 3C</xref>.</p></sec><sec id="s8-3-3"><title>Normalized bump coordinate</title><p>Over the course of a simulation, attractor bumps trace out trails of activity on the neural sheet (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). For a neuron at a given sheet location, we quantify how centrally an attractor bump passes through it with a metric called the normalized bump coordinate. We first tally the total number of spikes occurring at each location on the neural sheet across all excitatory populations. This yields an overall firing rate for each sheet location. For a neuron at a given location, we look for the central axis of the nearest attractor bump trail as follows. We find the highest overall firing rate in a window of length 10 neurons and width 4 neurons centered at the given location and oriented with long side perpendicular to the track orientation. The normalized bump coordinate is the ratio between the given location’s overall firing rate and this highest overall firing rate, which should correspond to an attractor bump’s central axis. Bump coordinate results are shown in <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4G</xref>.</p></sec><sec id="s8-3-4"><title>Simplified phase precession models</title><p>For our conceptual model with bump size oscillations, we imagine an attractor bump moving through a recorded neuron. Although the bump naturally oscillates in speed, we advance the bump with constant speed in the neural sheet; similar results (not shown) are obtained if the speed oscillations depicted in <xref ref-type="fig" rid="fig6">Figure 6B</xref> are included. We stipulate that the middle of the bump passes through the recorded neuron at position 0 and time 0. Thus, the 1D profile of the bump is given by the region between<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mo>±</mml:mo></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi><mml:mo>±</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>b</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are the smallest and largest radii of the bump, <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the constant bump velocity, <italic>f</italic> = 8 Hz, and the phase offset <italic>ψ</italic><sub>0 </sub>is incremented by <italic>π</italic>/5 for every new lap. We choose <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow/><mml:mn>17</mml:mn><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow/><mml:mn>3.3</mml:mn><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and Δ<italic>b</italic> = 1.4 neurons, which are close to the values presented in <xref ref-type="fig" rid="fig4">Figure 4B</xref> and <xref ref-type="fig" rid="fig6">Figure 6B</xref>. Whenever <italic>b</italic><sub>–﻿</sub>(<italic>t</italic>) ≤ 0 ≤ <italic>b</italic><sub>+</sub>(<italic>t</italic>), the neuron fires a spike, subject to a refractory period of 40 ms. Results are shown in <xref ref-type="fig" rid="fig4">Figure 4C</xref>.</p><p>For our simplified model with average bump dynamics, we first determine the average bump shape as a function of theta phase as described later. As in the conceptual model described immediately above, we imagine the central axis of this average bump moving through a recorded neuron. We simulate 18 laps with evenly spaced initial theta phases. The recorded neuron’s spiking rate is proportional to bump activity. We can linearly rescale bump activity to a desired maximum level across all theta phases; that is, the bump would still exhibit different levels of maximum activity at each theta phase. Spikes are generated with sub-Poisson statistics using the decimation procedure described in <xref ref-type="bibr" rid="bib9">Burak and Fiete (2009)</xref>; we choose the coefficient of variation to be <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msqrt><mml:mn>8</mml:mn></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula>. We also use a refractory period of 40 ms. Results are shown in <xref ref-type="fig" rid="fig4">Figure 4E, F</xref>.</p></sec><sec id="s8-3-5"><title>Theta sequences</title><p>We visualize theta sequences by averaging the decoded position over theta cycles. From all runs along the track, we take overlapping quadruplets of consecutive theta cycles, discarding those during which the animal comes within of the track ends to avoid edge effects. We assign time 0 to the middle of each theta quadruplet. We then shift the decoded positions of each quadruplet by the actual position of the animal at time 0, such that the origin corresponds to the actual animal position at the middle of the theta quadruplet. Before averaging, we proceed as in <xref ref-type="bibr" rid="bib69">O'Neill et al. (2017)</xref> and divide the probability at each timestep by its maximum value. We then separately average each timestep of the quadruplet, ignoring cycles without spikes within that timestep.</p><p>To find the slope of the fastest decoded motion within the theta cycle, we use a similar approach to <xref ref-type="bibr" rid="bib69">O'Neill et al. (2017)</xref>. For each time window whose midpoint lies within the third cycle of the averaged theta quadruplet, we find the fit line that captures the most decoded probability. In <xref ref-type="bibr" rid="bib69">O'Neill et al. (2017)</xref>, this involves summing all the probability that lies within a certain number of position bins away from each possible line. Instead of setting such a hard cutoff, we pass the averaged probability distribution at each timestep through a Gaussian filter of width. For each candidate line, we sum over the filtered probability of the closest position bin at each timestep; this process is analogous to weighting each bin according to a Gaussian function of its distance to the line and summing the unfiltered probability over all bins. The fit line is the one with the largest total probability. Finally, across all time windows, we choose the fit line with highest slope to represent the averaged theta sequence. These sequences and the Gaussian-filtered, averaged probability distribution is shown in <xref ref-type="fig" rid="fig5">Figure 5B</xref>.</p></sec></sec><sec id="s8-4"><title>Replay analysis</title><sec id="s8-4-1"><title>Replay detection</title><p>As in <xref ref-type="bibr" rid="bib69">O'Neill et al. (2017)</xref>, we look for replays within highly synchronous events (HSEs). To detect HSEs, we first filter the multiunit activity during idle periods by a Gaussian of width and filter size, and we remove all zero-valued timesteps. HSEs are time intervals lasting at least during which the processed multiunit activity exceeds its 20th percentile and contains at least one timestep that exceeds its 80th percentile (or 60th percentile for simulations with periodic boundary conditions).</p><p>For each HSE, we look for linear replays by finding the fit line that captures the most decoded probability as we did for theta sequences. We first pass the probability distribution at each timestep during the HSE through a Gaussian filter whose width is and whose maximum value is 1. For each candidate line, we sum over the filtered probability of the closest position bin at each timestep and divide by the number of timesteps that the line spends within track limits. The result is an average probability captured by the line, which we call a replay score. For each HSE, the fit line is the one with the highest replay score. Finally, we exclude HSEs whose fit lines have a replay score less than 0.6 or spend less than 30 ms or 30 cm within track limits. The remaining fit lines are replays. Extracted replays are shown in <xref ref-type="fig" rid="fig7">Figure 7E</xref>.</p><p>For simulations whose neurons exhibit two fields, the probability distribution of the decoded position may be spread over both fields. Thus, we supplement each candidate line with two more lines of the same slope. These three lines are separated by the distance between grid fields. We sum over the filtered probability of the closest position bins to each of these lines.</p></sec><sec id="s8-4-2"><title>Replay properties</title><p>The speed of a replay is the magnitude of the slope of its fit line, as reported in <xref ref-type="fig" rid="fig7">Figure 7G</xref>.</p><p>The start position of a replay is the fit line position at the beginning of its HSE, which is clipped to 0 cm or 60 cm if it lies outside track limits. Similarly, the end position of a replay is the fit line position at the end of its HSE, which is similarly clipped. These positions are reported in <xref ref-type="fig" rid="fig8">Figure 8C</xref>.</p></sec></sec><sec id="s8-5"><title>Simulations with fixed inhibitory drive and constant velocity</title><sec id="s8-5-1"><title>Setup and trajectory</title><p>These simulations are structured similarly to the main simulations on a 1D track. However, we choose a constant inhibitory drive <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> and eliminate theta oscillations with <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. During setup, instead of evolving the network with an animal trajectory, we evolve 1000 timesteps with constant velocity of magnitude 0.5 m/s and angle <italic>π</italic>/5. For the main simulation, we evolve another 1000 timesteps with the same velocity.</p></sec><sec id="s8-5-2"><title>Attractor bump speed</title><p>To extract the speed of attractor bumps, we first divide time into 40 ms bins. Within each bin, we sum the spikes at each position on the neural sheet across all excitatory populations, and we pass the result through a Gaussian filter of width. We thus obtain smoothed activity maps at 40 ms intervals.</p><p>We find the seven activity peaks that remain closest to the center of the neural sheet throughout the simulation. For each time bin, we take the average position of all seven peaks, and fit this average motion with a linear model. The norm of the resulting velocity is the bump speed, as reported in <xref ref-type="fig" rid="fig6">Figure 6B</xref>.</p></sec><sec id="s8-5-3"><title>Attractor bump size</title><p>To extract the size of attractor bumps, we return to the raw spike trains, which we register across the course of the simulation by compensating for the overall bump motion. That is, to each spike emitted by an excitatory neuron, we assign a shifted neural sheet position equal to the true position of the neuron minus the bump velocity obtained above multiplied by its spiking time.</p><p>Around each of the seven activity peaks identified above, which are stationary after registration, we draw a circle of radius 12 neurons and calculate the center of mass of all enclosed spikes over the entire simulation. This point is the center of the registered activity bump. We then calculate the registered distance of each spike to the center; the 90th percentile is taken to be the radius of the activity bump. Bump diameters averaged over the seven activity peaks are reported in <xref ref-type="fig" rid="fig4">Figure 4B</xref>.</p></sec><sec id="s8-5-4"><title>Attractor bump shape</title><p>To determine the average attractor bump shape during runs, we use periodic simulations with uniform excitatory drive to generate a set of attractor bumps that experience the same drive. We reintroduce oscillations into the inhibitory drive. These simulations use <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.7</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>We first perform registration, as described above, for 12 attractor bumps. We count the number of spikes across all bumps at each registered location on the neural sheet (using 0.2 neuron bins) as a function of time within the theta cycle (using 1 ms bins). We then apply Gaussian filters of width 3 time bins and 5 position bins to obtain average bump shape as a function of theta phase, as shown in <xref ref-type="fig" rid="fig4">Figure 4D</xref> and <xref ref-type="video" rid="fig4video2">Figure 4—video 2</xref>.</p></sec></sec></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><sec id="s9" sec-type="appendix"><title>Simulations without brief allocentric correction</title><sec id="s9-1"><title>Model details</title><p>Simulation setup proceeds similarly to simulations with allocentric correction, except we evolve the network for 6 laps including idle periods after the three evolutions with constant velocity input. We also do not learn allocentric connections.</p><p>Without allocentric correction, the main simulation can only be run for 12 laps instead of 36. Each lap consists of a 1.5 s run and a 2.5 s idle period. Excitatory and inhibitory drives linearly interpolate between run and idle values over the first and last 0.3 s of each idle period.</p><p>We perform 20 replicate simulations in each direction instead of 10. Parameter values that differ from those in <xref ref-type="table" rid="table1">Table 1</xref> are <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.65</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> during runs and 0.1 when idle, <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.12</mml:mn><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>ζ</mml:mi><mml:mi>P</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>ζ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mn>0.012</mml:mn><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s9-2"><title>Analysis details</title><p>With fewer laps compared to simulations with allocentric correction, we use more lenient cutoffs for both theta-related and replay analysis. During phase relationship analysis, we require a minimum of 15 spikes, instead of 30. We also use a regression fit score cutoff of 0.3, instead of 0.4, below which neurons are considered phase-independent. During replay detection, replays must span a minimum of 20 cm, instead of 30 cm.</p></sec><sec id="s9-3"><title>Results</title><p>In simulations without brief allocentric corrections, many theta-related and replay properties are present a weaker level. We can only run the simulations for 12 laps, and we must use lower velocity gain so that the attractor bumps do not travel far on the neural sheet (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1A</xref> and <xref ref-type="video" rid="app2video1">Appendix 2—video 1</xref>). Otherwise, attractor drift will cause the firing fields to change significantly between the start and the end of the simulation.</p><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Theta-related and replay properties in simulations without brief allocentric corrections.</title><p>(<bold>A</bold>) Left, track diagram. Right, neural activity over runs with each neuron colored according to the track position at which it attained maximum firing rate. Red circles indicate regions of recording. (<bold>B</bold>) Relationship between animal position and theta phase for representative neurons. Clockwise from top left, relationships depicted are phase independence, phase locking, phase precession, and phase precession. Dots represent spikes during runs in the directions indicated by arrows. Lines indicate fit by circular-linear regression. Numbers in each panel from top left to top right indicate magnitudes of correlation coefficients, regression fit scores, and precession ranges. (<bold>C–E</bold>) Data across all replicate simulations. (<bold>C</bold>) Magnitudes of circular-linear correlation coefficients. Mean ± s.d.: 0.15 ± 0.11. (<bold>D</bold>) Fit scores for circular-linear regression. (<bold>E</bold>) Regression slopes for neurons with fit score &gt;0.3. (<bold>F</bold>) Decoded position averaged over theta cycles. Thick black line fit to theta sequence. (<bold>G</bold>) Replays with cyan fit lines. (<bold>H</bold>) Mean actual run speed (error bars indicate s.d. over time), mean theta sequence speed (error bars indicate s.d. over replicate simulations), and mean replay speed (error bars indicate s.d. over replays). (<bold>I</bold>) Direction of replay propagation across simulations. Means indicated with lines. <italic>p</italic>-values from the Mann-Whitney <italic>U</italic> test show that a significantly greater number of replays propagate away from either actual position. (<bold>J</bold>) Distances between actual position and decoded position at the start or end of replays. Paired medians compared by the Wilcoxon rank-sum test with indicated <italic>p</italic>-value. Scale bars, 50 neurons.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46351-app2-fig1-v2.tif"/></fig><media id="app2video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-46351-app2-video1.mp4"><label>Appendix 2—video 1.</label><caption><title>Neural activity during runs and idle periods during a simulation without allocentric corrections.</title><p>Left, position of the animal (black square) along a 1D track. Right, neural activity of the E population. Each pixel is a neuron, with black corresponding to current spikes and lightest gray corresponding to spikes 40 ms ago. Red circles indicate regions of recording.</p></caption></media><p>During runs, our neurons can still be divided into subgroups whose activity exhibits different phase relationships (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1B</xref>). The magnitude of circular-linear correlation (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1C</xref>; 0.15 ± 0.11, mean ± s.d.) is slightly lower than it is with allocentric correction (<xref ref-type="fig" rid="fig3">Figure 3C</xref>; 0.17 ± 0.11, mean ± s.d.). Excluding phase-independent neurons with fit score &lt;0.3 (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1D</xref>), we see a large population of phase-locking neurons and a small population of phase-precessing neurons (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1E</xref>). If we use a high phase range cutoff of 120° for phase precession, we find that preferred phase predominantly decreases with progress through the grid field, which is the biologically observed direction. By decoding position from spike trains and averaging over theta cycles, we see a sawtooth pattern containing theta sequences (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1F</xref>), though the pattern is less organized than it is with allocentric correction (<xref ref-type="fig" rid="fig5">Figure 5B</xref>).</p><p>During idle periods, traveling wavefronts produce replays (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1G</xref> and <xref ref-type="video" rid="app2video1">Appendix 2—video 1</xref>). The speeds of theta sequences and replays are 1.1 ± 0.3 m/s and 7.0 ± 2.6 m/s respectively (mean ± s.d.; <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1H</xref>), which agree well with corresponding speeds in simulations with allocentric correction (0.9 ± 0.2 m/s and 7.0 ± 2.6 m/s), and which also agree well with experiments (<xref ref-type="bibr" rid="bib69">O'Neill et al., 2017</xref>). As in <xref ref-type="fig" rid="fig8">Figure 8A–C</xref>, the lower velocity gain produces a bias in replay direction away from the current animal position (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1I,J</xref>).</p><p>In summary, after removing allocentric corrections, our model maintains its features involving theta sequences and replays. It still produces some degree of phase precession, but for fewer neurons and larger precession ranges. </p></sec></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.46351.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Deshmukh</surname><given-names>Sachin</given-names></name><role>Reviewing Editor</role><aff><institution>Indian Institute of Science Bangalore</institution><country>India</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Deshmukh</surname><given-names>Sachin</given-names> </name><role>Reviewer</role><aff><institution>Indian Institute of Science Bangalore</institution><country>India</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Blair</surname><given-names>Tad</given-names> </name><role>Reviewer</role><aff><institution>University of California, Los Angeles</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>Continuous attractor networks have been used to simulate grid cells. This paper shows that the continuous attractors can be easily adapted to show other properties of the entorhinal-hippocampal network, namely phase precession, theta sequences during behavior and replay sequences during rest. This detailed and comprehensive modelling study shows that when the continuous attractor network is coupled with theta modulated inhibition, the attractor bumps expand and contract, leading to theta phase precession and theta sequences. Reduction of external drive leads to spontaneous replay like sequences. These results are of significant interest to both theoreticians as well as experimentalists interested in temporal phenomena in the grid cell network.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for sending your article entitled &quot;Replay as wavefronts and theta sequences as bump oscillations in a grid cell attractor network&quot; for peer review at <italic>eLife</italic>. Your article is being evaluated by three peer reviewers, and the evaluation is being overseen by a Reviewing Editor and Laura Colgin as the Senior Editor.</p><p>Given the list of essential revisions, including major changes to the model and extensive new analyses, the editors and reviewers invite you to respond within the next two weeks with an action plan and timetable for the completion of the additional work. The action plan should contain a similar amount of detail as a traditional rebuttal letter. We plan to share your responses with the reviewers and then issue a binding recommendation.</p><p>Essential revisions:</p><p>1) The non-periodic boundary conditions and non-uniform driving inputs seem like rather odd design choices. This raises some concern that there may be unexplained reasons for these choices (that is, the model's behavior may depend upon these choices in ways that are not spelled out). The model should be re-implemented using periodic topology, either across the entire manuscript or in additional comparison figures.</p><p>2) Phase precession in this model may differ from experimentally observed phase precession in some fundamental ways. The Hafting et al., 2008, study shows that layer II MEC phase precession is highly stereotyped, with typical entry/exit phases of 222º/60º, corresponding to the total ~160º precession. Further, Hafting reported typical slopes of about -3º/cm for 30-70 cm grid spacings; &quot;correcting&quot; this value by mean([30,70])/120 for the larger ~120 cm spacing of the modeled grids (Figure 1E) suggests modeled phase slopes should be on the order of -1.25º/cm. But the authors show the slope ranging up to -30º/cm; this range seems clearly too high. It could be that the trajectory-dependent starting phase produces phase trajectories that yield essentially meaningless circular-linear regression slopes as possibly indicated by Figure 3B. Or, the largest bar in Figure 3D could be correctly showing this smaller slope (instead of phase locking as interpreted by the authors), and the interpretation of the larger slopes as precession was simply incorrect. Regardless, the authors must revise the phase precession mechanism and/or its interpretation to at least qualitatively recapitulate the limited range, grid-scale appropriate slopes, and stereotyped phase trajectories in published data.</p><p>3) It is unclear whether the 1D phase precession shown in the paper results are specific to a chosen trajectory through the 2D sheet, or whether these results generalize across all directions. The justification for the track choice to improve &quot;interpretability&quot; is weak given that the choice reduces the robustness of the results. The results should be directionally generalized, and the effects of multiple fields on the track (possibly using larger tracks commensurate with grid scale) should be demonstrated and interpreted. Furthermore, the authors need to demonstrate generalization across a range of speeds.</p><p>4) A parametric analysis of the conditions which give rise to phase precession and wavefront propagation is rather lacking here, and should be included.</p><p>5) Theta sequences: The O'Neill paper (Supplementary Figure 10E) shows the clear sawtooth pattern in which MEC sequences start from behind and end up ahead of the current position. The stalling/speeding dynamics are qualitatively different from both hippocampal observations, and the O'Neill MEC data. The authors should ensure the validity of theta sequence output with regards to (at the minimum) their stated benchmark.</p><p><italic>Reviewer #1:</italic></p><p>Continuous attractor networks have been used to simulate grid cells. This paper shows that the continuous attractors can be easily adapted to show other properties of the entorhinal-hippocampal network, namely phase precession, theta sequences during behavior and replay sequences during rest.</p><p>While the idea of getting these cellular properties out of a network that hasn't been specifically designed to generate these is very attractive, I suspect that some of these observations may arise specifically out of biologically unrealistic idiosyncrasies of the model.</p><p>1) &quot;During locomotion, excitatory principal cells are driven to fire by various neocortical and thalamic inputs [Kerr et al., 2007]. Thus, their drive exceeds threshold at the center of the neural sheet; it decays towards the edges to avoid edge effects that disrupt continuous attractor dynamics [Burak and Fiete, 2009].&quot; And &quot;Once nucleated, the wavefront propagates freely through the outer region because inhibitory neurons, with low drive, are not activated by the wavefront. In contrast, wavefronts cannot propagate in the center region, because excitatory neurons there receive enough drive to spike vigorously and activate nearby inhibitory neurons.&quot;</p><p>During quiescent periods, the excitatory drive reduces, but still maintains its shape (Figure 5). The replay events are seen only at the periphery and not at the center of the sheet. I'm concerned that 1) This excludes center of the sheet from replays (which is not supported by any observed data to the best of my knowledge) and 2) The replays could simply be a side effect of the simulation architecture (which may not be replicated in reality – no one has demonstrated grid cells which maintain location specific firing during quiescent periods), and may not be seen if the boundary effects are countered by using a toroid instead of a sheet with gaussian excitatory drive peaking at the center of the sheet. The authors do discuss a possible enhanced model with landmark and border inputs sustaining their activity through the quiescent period (Discussion, fifth paragraph) that they claim can deal with this issue, but that is insufficient. The authors should implement the attractor as a toroid instead of as a sheet along with external drive not limited to a part of the network (&quot;center&quot; in case of the sheet) which can persist (at a lower level) during the quiescent period, rather than base a main result on the specific architecture that is unrealistic.</p><p>This change will also deal with the need for the external drive to be limited to the center during locomotion.</p><p>Theta phase precession and sequences as well as replay sequences arising out of such a model would be much more convincing.</p><p>2) &quot;Unlike the 2D case in which grid cells have multiple firing fields, we choose parameters such that they have single fields to improve the interpretability of our results.&quot;</p><p>The authors need to show that their results are not unique to the selected direction, even if it’s just by showing that the results are at least qualitatively similar in other directions (even if the multiple vertices create redundancy). One possible concern is that the replays can &quot;jump&quot; between redundant vertices when a neuron with multiple fields on the track is active (i.e. instead of going in the order 1 2 3 N 4 5 6, redundant fields of neuron N can give rise to a sequence 1 2 3 N 25 26 27). This can degrade the replay.</p><p>3) Figure 3B, G. Theta phase precession shown here is unlike the observed precession, in the sense that there appear to be double/multiple precessing lines running within a field (this can be alternatively interpreted as precessing through &gt;&gt; 360°). This could be an artefact of the chosen refractory period, and the precession might disappear when using a shorter refractory period. A 40ms refractory period is rather long for grid cells. Does having a shorter refractory period drastically alter the results? Cells showing 10-15°/cm seem to have more realistic precession, but even that might get affected by having a shorter refractory period.</p><p>4).&quot; Wavefront propagation involves dynamical processes that are fundamentally different from attractor bump motion, and thus leads to different decoded speeds and directions for replays and theta sequences.&quot;</p><p>How dependent is the wavefront propagation speed on the specific time constants used in the model? Were the time constants tweaked to achieve the desired speed?</p><p><italic>Reviewer #2:</italic></p><p>In this paper, Kang and DeWeese present a spiking model of the entorhinal grid cell network. The paper's main contributions are rooted in two novel ideas: 1) explaining phase precession as a consequence of theta-synchronized expansion and contraction of attractor bumps, and 2) showing that replay sequences can occur during propagating waves that emerge in regions of the network where excitatory drive is low. There are several issues that I think should be addressed in revision:</p><p>1) The idea that phase precession arises from expansion/contraction of attractor bumps is quite innovative, but I am concerned that under this mechanism, the phase at which grid cells fire during entry / exit from their fields may not fully accord with experimental findings. Two issues should be addressed here:</p><p>1a) What model parameters determine whether a particular grid cell has a fixed versus variable phase? Does this depend upon movement velocity (speed or direction), the neuron's position in the sheet, the level of excitatory drive, etc.? It would be helpful if the authors could perform a more systematic analysis of the drive / speed / direction regimes within which different phase precession behaviors occur. One of the paper's main strengths is its novel theory for phase precession, but without a clearer understanding of how this phase precession behavior arises from the network dynamics, it is difficult to understand what this theory entails, and what it might predict for biology.</p><p>1b) While explaining phase precession by expansion and contraction of the attractor bumps is quite innovative, I am concerned that phase precession arising from this mechanism may differ in a fundamental way from experimentally observed phase precession. Before explaining this concern, it is necessary to point out that the authors have adopted a convention for measuring theta phase that is opposite from what many experimental authors have previously used. Here, the authors define 180° as the phase at which grid cell firing rates are at their <italic>minimum</italic>. By contrast, classical phase precession papers by O'Keefe, the Mosers, and others defined 180° as the phase at which firing rates of place/grid cells are at their <italic>maximum</italic>. This reversal of convention must be carefully tracked when assessing whether the model agrees with evidence from prior papers. To avoid any confusion arising from this discrepancy, let me state my concern in a way that is independent of which phase convention is used. In experimental studies, place and grid cells usually show a specific preferred firing phase as the animal <italic>enters</italic> the spatial field, which is ~150-170° <italic>later</italic> than the phase at which the cell fires when the animal is in the center of its field. However, in the present model, it appears that this is not the case. For example, in Figure 3G, it appears that as the animal enters a grid cell's field, the cell prefers to fire at a phase which is a few degrees <italic>earlier</italic> than the phase at which the cell fires when the animal is in the center of its field. I don't think this is in good accordance with experimental findings for grid cells or place cells. This issue should be explicitly addressed in the paper.</p><p>2) The authors have chosen to build their network with non-periodic boundary conditions (rectangular sheets of neurons) and a radial gradient of excitatory drive which peaks in the center of the sheet. It is unclear how essential behaviors of the model (grid cells with diverse phase precession profiles, propagating waves) depend upon the non-uniform excitatory drive, or whether these behavior could also be obtained under uniform drive.</p><p>3) The influence (if any) of movement velocity upon phase precession is not clear. In a 2D attractor network, velocity has two components: speed and direction. Does the phase precession behavior of the model depend upon one or both of these velocity components? Concerning speed, it is not entirely clear whether simulation results were obtained using fixed or variable running speeds (for example, in Figure 4C, why is there a nonzero error bar for &quot;actual&quot; running speed? It does not appear from the trajectory plot in Figure 2A that there is much noise in the running speed during simulated track traversals). Concerning direction, was the 1D track simulated as some specific linear trajectory through the 2D grid sheet, and if so, what was the orientation alignment of the 1D trajectory on the 2D grid sheet? Would different alignments yield fundamentally different phase precession results?</p><p>4) If excitatory drive is the main determinant of wave propagation, then it would be nice if the authors could perform a more systematic analysis of the drive regimes in which wave propagation occurs. Can the entire sheet be switched into wave propagation behavior by applying an appropriately low level of uniform excitatory drive? Or is there something about the non-uniformity of the drive level that is essential for the wave propagation to occur?</p><p><italic>Reviewer #3:</italic></p><p>Kang and DeWeese present a detailed and comprehensive modeling study of theta-rhythmic modulation of the activity bump on a continuous attractor map to explain phase precession, theta sequences, and, by reducing subcortical input levels, the switch to the &quot;irregular&quot; state in which sharp-wave/ripple 'replay' reactivations are observed. These are well-studied hippocampal phenomena that may be crucial to the spatial, mnemonic, and decision-making roles of the hippocampus; the manuscript addresses how they may arise in medial entorhinal (MEC) grid cell networks, which is a critical question for the field. The attractor-based mechanism is interesting and potentially contributes a compelling unification of these temporal phenomena; however, there are several gaps in logic and disconnections from the literature in the way the results are currently presented.</p><p>• The claims regarding phase precession are largely undercut by the low correlations in Figure 3C and zero-dominated histogram in Figure 3D showing that most of the simulated grid cells do not precess. The authors note that additional features may increase the correlations, but the bias of the distribution toward 0 is the problem, not the average value. Hafting et al., 2008, showed that layer II principal cells all generally precess; while the authors mention that phase locking is observed in layer III (cf. the Hafting paper) as justification, their model is not a layer III model. If the bump modulation is the shared cause of precession and sequences, then the two effects should be equivalently strong in the model.</p><p>• Additionally, arguments regarding hippocampal phase precession have related to whether it is a cause or effect of temporal compression during theta sequences, or even whether it is epiphenomenal. In MEC, if both effects are generated by the same underlying mechanism as in this model, then the critical question concerns whether phase precession has any function in this setting. Some theories posit that precession helps construct sequences, but others claim that it is simply a by-product of temporal compression (e.g., G. Dragoi and G. Buzsáki. Neuron, 50(1):145-157, 2006.; G. Dragoi. Front Syst Neurosci, 7:46, 2013). It's not clear what the authors are claiming in this manuscript, but the results argue for precession as epiphenomenon because it is unnecessary to either sequences or replay, and the starting phase at the edge of a grid field is apparently random, indicating that it plays no role in the spatiotemporal ordering of activity. The description of the origin of precession in the model (subsection “Theta phase precession arises from oscillations in attractor bump size”, third paragraph) emphasizes that it results from transient changes in spread of activity, instead of external input, network, or cell-assembly modulation as in hippocampal models. The authors should broadly reconsider and clarify the theoretical context and implications of their model design and results regarding precession and theta sequences.</p><p>• The wavefront replay mechanism suffers from a similar causative discrepancy in which the replay sequences do not have any particular relationship with recently expressed sequences. Experiments (e.g., Drieu, Todorova, and Zugaro, 2018) are beginning to corroborate <italic>earlier</italic> theories (such as Dragoi, 2013, mentioned above) that online sequences drive plasticity necessary for subsequent replay. However, grid-cell weights in the model are hard-wired, thus precluding any direct contribution to the learning or memory consolidation roles that may be central to the replay phenomenon in general. The Discussion argues that hard-wired replay might play an initiation role for hippocampal replays, but that incorrectly assumes grid cells directly activate place cells (as in the old grid-to-place models) and ignores sharp-wave initiation studies implicating dentate gyrus, CA2, and/or ascending inputs (Sasaki, et al., 2018; Oliva, et al., 2016; Angulo-Garcia, et al., 2018). The potential roles of grid cell wavefronts may be more limited than discussed, which should be addressed.</p><p>• The model is based on the aperiodic network with feedforward Gaussian envelope function described by Burak and Fiete, 2009, but they also described a periodic solution. The periodic solution has problems with rotation, but some of the results (especially the generation of replays) are affected by or depend on the topology. The authors should clarify the reliance of their results on network topology and whether other formulations may also support their conclusions.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.46351.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) The non-periodic boundary conditions and non-uniform driving inputs seem like rather odd design choices. This raises some concern that there may be unexplained reasons for these choices (that is, the model's behavior may depend upon these choices in ways that are not spelled out). The model should be re-implemented using periodic topology, either across the entire manuscript or in additional comparison figures.</p></disp-quote><p>This is a good point. Following the Editor and reviewers’ suggestion, we have added comparison figures featuring a model with periodic topology and uniform drive (Figure 8D–G). It reproduces all essential replay and theta-related behaviors of the non-periodic implementation (Figure 8—figure supplement 2 and Figure 8—figure supplement 3). As in the non-periodic case, it transitions between attractor bumps arranged in a triangular grid and traveling wavefronts in response to changes in input drive. The attractor bumps are capable of path-integration during runs.</p><p>During quiescent periods, traveling wavefronts propagate across the entire network. This erases information about the animal’s position, so grid fields would not be consistent from lap to lap. To maintain positional information, we have added a simple implementation of brief allocentric input from border, boundary vector, or landmark cells (Ocko et al., 2018; Keinath et al., 2018; and others). This input is active only for 0.5 s between idle periods and runs to nucleate the activity bumps in their appropriate conditions. Inputs to the model are strictly uniform during the 1.5 s-long runs and the 2.0 s-long periods of quiescence that contain traveling wavefronts.</p><p>For most of the paper, we still use non-periodic boundary conditions, which requires non-uniform driving inputs (Burak and Fiete, 2009). Although periodic boundary conditions are useful to represent a large area of cortex in which edges are deemed irrelevant, we find that non-periodic boundary conditions are more biologically feasible. Periodic boundary conditions obeying a toroidal topology require a precise configuration of long-range connections that we believe is unlikely to exist in the brain. On the other hand, continuous attractor networks with non-periodic boundary conditions can arise from anatomically local connections, whose precise symmetry can be learned through synaptic plasticity rules (Widlowski and Fiete, 2014).</p><disp-quote content-type="editor-comment"><p>2) Phase precession in this model may differ from experimentally observed phase precession in some fundamental ways. The Hafting et al., 2008, study shows that layer II MEC phase precession is highly stereotyped, with typical entry/exit phases of 222º/60º, corresponding to the total ~160º precession. Further, Hafting reported typical slopes of about -3º/cm for 30-70 cm grid spacings; &quot;correcting&quot; this value by mean([30,70])/120 for the larger ~120 cm spacing of the modeled grids (Figure 1E) suggests modeled phase slopes should be on the order of -1.25º/cm. But the authors show the slope ranging up to -30º/cm; this range seems clearly too high. It could be that the trajectory-dependent starting phase produces phase trajectories that yield essentially meaningless circular-linear regression slopes as possibly indicated by Figure 3B. Or, the largest bar in Figure 3D could be correctly showing this smaller slope (instead of phase locking as interpreted by the authors), and the interpretation of the larger slopes as precession was simply incorrect. Regardless, the authors must revise the phase precession mechanism and/or its interpretation to at least qualitatively recapitulate the limited range, grid-scale appropriate slopes, and stereotyped phase trajectories in published data.</p></disp-quote><p>We agree with the Editor’s and reviewers’ suggestions and have revised our manuscript accordingly, as we will now describe. We will structure our response by successively addressing stereotyped phase trajectories, grid-scale appropriate slopes, and limited range, as listed in the last sentence of the Concern.</p><p>First, we discuss stereotyped phase trajectories. Our new implementation of brief allocentric corrections has increased the number of phase-precessing neurons in our model. However, we do not believe that the experimental evidence requires our model to exhibit the same degree of precession across all neurons. These two points are elaborated in turn below.</p><p>a) Brief allocentric corrections have made phase behavior more stereotyped in our model. Our original results were based on simulated data from only 12 laps along the track, 6 in each direction, which provided many fewer spikes per neuron than were acquired in phase precession experiments. Our lap count was limited by attractor drift, which arises from noise accumulation and destabilizes grid fields. Allocentric input is believed to correct errors in path-integration (Hardcastle et al., 2015; Ocko et al., 2018; Keinath et al., 2018; and others; see also Essential revision1) and allows us to run simulations for many more laps, providing more spikes per neuron with more stable firing fields. It also allows us to use stronger velocity input, which in our experience produces more attractor drift because the attractor bumps move farther along the neural sheet during each lap.</p><p>Compared to our original simulations, more neurons exhibit phase precession between 60º and 360º and a smaller proportion of neurons exhibit phase-position correlation close to 0 (Figure 3). Although correlation values are still less than they are in Supplementary Figure 10C of O’Neill et al., 2017, the peak in the distribution is no longer at 0, as observed in experiment. In the Discussion, we mention how these correlation values can be further increased with additional simulation features that may reduce the number of phase-independent neurons that fire throughout the theta cycle.</p><p>b) Although our neurons do not all precess in a stereotyped fashion, this heterogeneity matches the variety of phase behaviors observed in superficial MEC layers. We believe that at most, the experimental literature indicates that only a subpopulation of neurons in superficial MEC layers exhibits highly stereotyped phase precession. Hafting et al., 2008 report that LII neurons consistently precess, whereas LIII neurons exhibit phase locking instead. However, LII pyramidal cells precess less than LII stellate cells do (Ebbesen et al., 2016; Reifenstein et al., 2016) and even less than LIII neurons do at the single-lap level (Ebbesen et al., 2016).</p><p>It is not certain that our grid cells should correspond to one subpopulation of MEC neurons in particular. Grid cells in continuous attractor models, like our model, increase their activity when the animal moves along a preferred direction and can thus be considered grid × head direction conjunctive cells (Zilli, 2012). These conjunctive cells are more common in LIII and deeper layers (Sargolini et al., 2006). It is true that other features of continuous attractor models, such as recurrent inhibition (Couey et al., 2013), may be better established in LII. Additionally, some researchers do propose that continuous attractor models describe LII neurons with directional inputs from deeper MEC layers (Bush and Burgess, 2014; and others). Nevertheless, we find it too restrictive to claim that our model must describe only MEC LII neurons (and potentially only its strongly precessing stellate cells). The O’Neill et al., 2017 results that our model addresses were obtained from superficial MEC layers without distinguishing between LII and LIII; they contain a mixture of phase behaviors.</p><p>Next, we discuss grid-scale appropriate slopes. In short, to properly make the important experimental comparisons mentioned by the Editor and reviewers, we have decided to convert our slopes to units of degrees per field instead of degrees per cm. In our manuscript, we focused on matching theta behavior and replay as measured by O’Neill et al., 2017. Their grid cells have scale ~150 cm, and their example of phase precession exhibits slope ~10º/cm (Supplementary Figure 10A in O’Neill et al., 2017). It is true that Hafting et al., 2008 provides a more comprehensive investigation of phase precession, and both their grid scales (30–70 cm) and phase precession slopes (~3º/cm) are much smaller. Other papers report precession slopes in units of degrees per second (Ebbesen et al., 2016; Reifenstein et al., 2016). In light of these differences in slope values even among experimental reports and their dependence on grid scale, we find that a more consistent metric for precession is its phase range, which equals the absolute value of precession slope in units of degrees per field. We will discuss experimental comparisons of precession range in the next paragraph.</p><p>Finally, we discuss the range of phase precession. The Editor and reviewers point out that our previous results exhibit large phase precession slopes of magnitude ~30º/cm, which corresponds to a precession range of greater than 360º. Our new simulations incorporate brief allocentric input and better align with precession ranges reported experimentally, which are less than 360º. We present two analyses of precession range in our revised manuscript:</p><p>a) Figure 3E shows our analysis of phase precession slope in units of field size, and its absolute value is the precession range. We agree with the Editor’s suggestion that some slope values may be meaningless due to poor fit. To address this issue, we modified our slope analysis by only including neurons whose fit score, which is the mean resultant length (Kempter et al., 2012), exceeds a certain value. In Figure 3E, neurons still preferentially show negative slopes for rightward runs and positive slopes for leftward runs, which corresponds to decreasing phase as the animal moves through the field. Moreover, many neurons responsible for this bias, corresponding to regions in which the “left” and “right” histograms do not overlap, precess with range 60º–360º. This compares favorably with these median precession ranges experimentally measured in MEC LII: ~160º in cells of unspecified type (Hafting et al., 2008), ~170º and ~110º in stellate and pyramidal cells respectively (Reifenstein et al., 2016), and ~130º and ~50º in stellate and pyramidal cells respectively (Ebbesen et al., 2016). Our simulations still produce many cells with precession range close to 0º, which may correspond to MEC LIII cells observed to lack strong precession (Hafting et al., 2008).</p><p>b) Following Hafting et al., 2008, we present in Figure 3F spike density plots averaged over different subgroups of neurons. The rightmost density plot corroborates our results in Figure 3E: for neurons with high fit scores and large phase ranges &gt;60º, the preferred phase decreases as the animal moves through grid fields. This preferred phase is ~360º (or equivalently 0º) at the beginning of the field, and magnitude of its decrease is ~75º. For neurons with small phase ranges &lt;60º, neurons maintain a constant phase preference of ~360º. The former population appears to be consistent with LII cells and the latter with LIII cells.</p><p>In summary, our implementation of brief allocentric corrections leads to more phase-precessing neurons whose precession range lies within the experimentally reported span for LII neurons. In the Discussion, we cite experimental measurements to explain why we do not believe our model should necessarily produce only grid cells with stereotyped precession.</p><disp-quote content-type="editor-comment"><p>3) It is unclear whether the 1D phase precession shown in the paper results are specific to a chosen trajectory through the 2D sheet, or whether these results generalize across all directions. The justification for the track choice to improve &quot;interpretability&quot; is weak given that the choice reduces the robustness of the results. The results should be directionally generalized, and the effects of multiple fields on the track (possibly using larger tracks commensurate with grid scale) should be demonstrated and interpreted. Furthermore, the authors need to demonstrate generalization across a range of speeds.</p></disp-quote><p>This is a good point. We have now generalized our results to a variety of track directions relative to the neural sheet and across a range of speeds (Figure 3—figure supplement 6). We have also compared phase behavior for simulations exhibiting single fields and multiple fields (Figure 3—figure supplement 5). We have found that precession range and correlation magnitude increase with animal speed, as observed experimentally (Jeewajee et al., 2014). However, track orientation and the number of grid fields do not affect phase behavior.</p><disp-quote content-type="editor-comment"><p>4) A parametric analysis of the conditions which give rise to phase precession and wavefront propagation is rather lacking here, and should be included.</p></disp-quote><p>We agree that a parametric analysis is a good idea. We have now measured various phase precession, theta sequence, and replay properties across a wide range of parameters. The results are shown in Figure 3—figure supplement 6, Figure 3—figure supplement 7, Figure 5—figure supplement 3, and Figure 7—figure supplement 4. Across all parameter values, theta sequence speed remains roughly 2 times the actual speed, and replay speed remains roughly 14 times the actual speed. These values are consistent with our original findings and with experimental measurements (O’Neill et al., 2017).</p><disp-quote content-type="editor-comment"><p>5) Theta sequences: The O'Neill paper (Supplementary Figure 10E) shows the clear sawtooth pattern in which MEC sequences start from behind and end up ahead of the current position. The stalling/speeding dynamics are qualitatively different from both hippocampal observations, and the O'Neill MEC data. The authors should ensure the validity of theta sequence output with regards to (at the minimum) their stated benchmark.</p></disp-quote><p>The Editor and the reviewers make a good point; in our new simulations with brief allocentric corrections (see also Essential revision1), theta sequence plots now exhibit a prominent sawtooth pattern (Figure 5B). These sequences start behind the animal’s actual position and end ahead of it (Figure 5D), a feature that arises from activity bump dynamics (Figure 6D). Allocentric corrections allow for combination of more simulation laps, more stable firing fields, and stronger velocity input that cause this sawtooth pattern to emerge.</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>Continuous attractor networks have been used to simulate grid cells. This paper shows that the continuous attractors can be easily adapted to show other properties of the entorhinal-hippocampal network, namely phase precession, theta sequences during behavior and replay sequences during rest.</p><p>While the idea of getting these cellular properties out of a network that hasn't been specifically designed to generate these is very attractive, I suspect that some of these observations may arise specifically out of biologically unrealistic idiosyncrasies of the model.</p><p>1) &quot;During locomotion, excitatory principal cells are driven to fire by various neocortical and thalamic inputs [Kerr et al., 2007]. Thus, their drive exceeds threshold at the center of the neural sheet; it decays towards the edges to avoid edge effects that disrupt continuous attractor dynamics [Burak and Fiete, 2009].&quot; And &quot;Once nucleated, the wavefront propagates freely through the outer region because inhibitory neurons, with low drive, are not activated by the wavefront. In contrast, wavefronts cannot propagate in the center region, because excitatory neurons there receive enough drive to spike vigorously and activate nearby inhibitory neurons.&quot;</p><p>During quiescent periods, the excitatory drive reduces, but still maintains its shape (Figure 5). The replay events are seen only at the periphery and not at the center of the sheet. I'm concerned that 1) This excludes center of the sheet from replays (which is not supported by any observed data to the best of my knowledge) and 2) The replays could simply be a side effect of the simulation architecture (which may not be replicated in reality – no one has demonstrated grid cells which maintain location specific firing during quiescent periods), and may not be seen if the boundary effects are countered by using a toroid instead of a sheet with gaussian excitatory drive peaking at the center of the sheet. The authors do discuss a possible enhanced model with landmark and border inputs sustaining their activity through the quiescent period (Discussion, fifth paragraph) that they claim can deal with this issue, but that is insufficient. The authors should implement the attractor as a toroid instead of as a sheet along with external drive not limited to a part of the network (&quot;center&quot; in case of the sheet) which can persist (at a lower level) during the quiescent period, rather than base a main result on the specific architecture that is unrealistic.</p><p>This change will also deal with the need for the external drive to be limited to the center during locomotion.</p><p>Theta phase precession and sequences as well as replay sequences arising out of such a model would be much more convincing.</p></disp-quote><p>The reviewer raises an interesting point here. As we have described in our response to Essential revision1, we have now implemented periodic boundary conditions with uniform drive, and our simulations show attractor bumps and traveling wavefronts during runs and idle periods, respectively (Figure 8). These grid cells no longer maintain location-specific firing during quiescent periods. However, we do not believe there is convincing experimental evidence for or against location-specific firing during quiescent periods. Few papers report the properties of grid cells during quiescence; grid cells during this state do have much lower firing rates, but there appears to be some residual activity outside of highly synchronized events (Figure 2A in O’Neill et al., 2017). To our knowledge, it is unknown whether this activity maintains a representation of an animal’s location. Nevertheless, we expect our results to hold in either case; the animal’s spatial representation can be either maintained by an active region of the grid network (whether in the center or close to an edge) or reset by brief allocentric inputs.</p><disp-quote content-type="editor-comment"><p>2) &quot;Unlike the 2D case in which grid cells have multiple firing fields, we choose parameters such that they have single fields to improve the interpretability of our results.&quot;</p><p>The authors need to show that their results are not unique to the selected direction, even if it’s just by showing that the results are at least qualitatively similar in other directions (even if the multiple vertices create redundancy). One possible concern is that the replays can &quot;jump&quot; between redundant vertices when a neuron with multiple fields on the track is active (i.e. instead of going in the order 1 2 3 N 4 5 6, redundant fields of neuron N can give rise to a sequence 1 2 3 N 25 26 27). This can degrade the replay.</p></disp-quote><p>This is a good idea. As described in our response to Essential revision3, we agree that running simulations with varied track orientations and multiple grid fields would test the robustness of our model. We have included these results throughout our paper. Changing track orientation does not affect phase behavior (Figure 3—figure supplement 6). Simulations exhibiting one or two grid fields exhibit the same phase behavior and theta sequence speed (Figure 3—figure supplement 5, Figure 5—figure supplement 3). During replays, simulations with two grid fields can have their decoded probability split between multiple track positions that form parallel lines (Figure 7—figure supplement 3). Their detected speed is slightly lower than the speed of replays among grid cells with one field, but the difference in detection methods that accounts for split probability distributions may contribute to this difference (Figure 7—figure supplement 4).</p><disp-quote content-type="editor-comment"><p>3) Figure 3B, G. Theta phase precession shown here is unlike the observed precession, in the sense that there appear to be double/multiple precessing lines running within a field (this can be alternatively interpreted as precessing through &gt;&gt; 360°). This could be an artefact of the chosen refractory period, and the precession might disappear when using a shorter refractory period. A 40ms refractory period is rather long for grid cells. Does having a shorter refractory period drastically alter the results? Cells showing 10-15°/cm seem to have more realistic precession, but even that might get affected by having a shorter refractory period.</p></disp-quote><p>As described in our response to Essential revision2, our simulations with brief allocentric inputs, which allow us to obtain more spikes per neuron with more stable firing fields, demonstrate more neurons whose range of precession is less than 360º. We do not implement a refractory period in our main simulations; we have only considered conceptual models in Figure 4 that use a refractory period. In our main model, we do use a 40 ms membrane time constant for excitatory neurons. As described in our response to Essential revision4, we have characterized how the behavior of the model depends on the membrane time constants and other parameter values (Figure 3—figure supplement 6 and Figure 3—figure supplement 7). Phase precession properties do not significantly vary with membrane time constants over the range we tested.</p><disp-quote content-type="editor-comment"><p>4) &quot; Wavefront propagation involves dynamical processes that are fundamentally different from attractor bump motion, and thus leads to different decoded speeds and directions for replays and theta sequences.&quot;</p><p>How dependent is the wavefront propagation speed on the specific time constants used in the model? Were the time constants tweaked to achieve the desired speed?</p></disp-quote><p>Wavefronts, which arise directly from activity propagation from one excitatory neuron to the next, generally travel much faster than activity bumps, whose motion arises from smaller imbalances among excitatory populations with different preferred directions. Thus, replays are generally much faster than the animal trajectory. Without fine tuning, our choice of parameters makes replays ~14 times faster. As described in our response to Essential revision4, we have characterized how replay speed depends on the values of time constants and other parameters (Figure 7—figure supplement 4). In general, replays are 8–20 times faster than the speed of the animal trajectory, which agrees well with experimental measurements of a ~9–15-fold speed-up (O’Neill et al., 2017).</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>In this paper, Kang and DeWeese present a spiking model of the entorhinal grid cell network. The paper's main contributions are rooted in two novel ideas: 1) explaining phase precession as a consequence of theta-synchronized expansion and contraction of attractor bumps, and 2) showing that replay sequences can occur during propagating waves that emerge in regions of the network where excitatory drive is low. There are several issues that I think should be addressed in revision:</p><p>1) The idea that phase precession arises from expansion/contraction of attractor bumps is quite innovative, but I am concerned that under this mechanism, the phase at which grid cells fire during entry / exit from their fields may not fully accord with experimental findings. Two issues should be addressed here:</p><p>1a) What model parameters determine whether a particular grid cell has a fixed versus variable phase? Does this depend upon movement velocity (speed or direction), the neuron's position in the sheet, the level of excitatory drive, etc.? It would be helpful if the authors could perform a more systematic analysis of the drive / speed / direction regimes within which different phase precession behaviors occur. One of the paper's main strengths is its novel theory for phase precession, but without a clearer understanding of how this phase precession behavior arises from the network dynamics, it is difficult to understand what this theory entails, and what it might predict for biology.</p></disp-quote><p>We appreciate the reviewer’s comment that our model is based on an innovative mechanism. The reviewer makes a good suggestion that we determine differences between grid cells that exhibit phase locking and phase precession, and now we have performed a comprehensive analysis. To constrain spiking to preferred theta phases, both phase-locking and precessing neurons require low excitatory drive and tend to be located towards the edge of the neural sheet where drive is lower (Figure 3—figure supplement 6). In particular, phase-locking neurons must have spikes constrained to only the most permissive part of the theta cycle; thus, they have lower firing rates than phase-precessing neurons (Figure 3—figure supplement 4). Two factors contribute to lower firing rates: phase-locking neurons are slightly less prevalent towards the center of attractor bumps (Figure 3—figure supplement 4) and more prevalent in excitatory populations whose preferred direction is perpendicular to the track orientation (Figure 3—figure supplement 5). This relationship between precession range and firing rate was observed experimentally by Jeewajee et al., 2014, who reported that grid cells with more spikes have steeper precession slopes.</p><p>Furthermore, with a new simplified model of phase precession, we demonstrate that the level of neural activity can directly influence phase behavior (Figure 4E, F and Figure 4—figure supplement 1). In this model, we determine the time-varying shape of the average attractor bump and rescale its activity to different levels. We find that low, medium, and high activity levels increase the prevalence of phase-locking, precessing, and independent neurons respectively.</p><p>Phase precession properties are similar between populations whose preferred direction is either aligned with or perpendicular to the track orientation (Figure 3—figure supplement 5), which is related to omnidirectional precession observed experimentally (Climer et al., 2013). Precession is also independent of track orientation (see also Essential revision3), but its range increases with animal speed (Figure 3—figure supplement 6), as observed experimentally (Jeewajee et al., 2014). In our parametric analysis (see also Essential revision4), we report how phase precession properties vary in a complex fashion with simulation parameters (Figure 3—figure supplement 6 and Figure 3—figure supplement 7).</p><disp-quote content-type="editor-comment"><p>1b) While explaining phase precession by expansion and contraction of the attractor bumps is quite innovative, I am concerned that phase precession arising from this mechanism may differ in a fundamental way from experimentally observed phase precession. Before explaining this concern, it is necessary to point out that the authors have adopted a convention for measuring theta phase that is opposite from what many experimental authors have previously used. Here, the authors define 180° as the phase at which grid cell firing rates are at their minimum. By contrast, classical phase precession papers by O'Keefe, the Mosers, and others defined 180° as the phase at which firing rates of place/grid cells are at their maximum. This reversal of convention must be carefully tracked when assessing whether the model agrees with evidence from prior papers. To avoid any confusion arising from this discrepancy, let me state my concern in a way that is independent of which phase convention is used. In experimental studies, place and grid cells usually show a specific preferred firing phase as the animal enters the spatial field, which is ~150-170° later than the phase at which the cell fires when the animal is in the center of its field. However, in the present model, it appears that this is not the case. For example, in Figure 3G, it appears that as the animal enters a grid cell's field, the cell prefers to fire at a phase which is a few degrees earlier than the phase at which the cell fires when the animal is in the center of its field. I don't think this is in good accordance with experimental findings for grid cells or place cells. This issue should be explicitly addressed in the paper.</p></disp-quote><p>As described in our response to Essential revision 2, our new simulations with brief allocentric corrections demonstrate more neurons whose range of precession is less than 360º. These neurons have a preferred firing phase that is higher (later) at the beginning of a grid field than at its center.</p><p>Figure 4A–C of our revision (corresponding to Figure 3G in our first submission) presents a simplified conceptual model that readily explains two features of phase precession in our model: preferred phases at the beginning of a grid field are close to 0º/360º (under our convention) and preferred phases tend to decrease, not increase, through the field. The simplified conceptual model cannot explain why the range of precession is less than 360º. We have made this point clearer in our revision.</p><p>As for the convention for theta phase, we agree that the presence of opposite definitions is confusing. Although classic phase precession papers identify 180º with maximum grid cell activity, other papers, including O’Neill et al., 2017 and Feng et al., 2015, identify 180º with minimum activity. Since our focus is to capture the results of O’Neill et al., 2017, we use the latter convention.</p><disp-quote content-type="editor-comment"><p>2) The authors have chosen to build their network with non-periodic boundary conditions (rectangular sheets of neurons) and a radial gradient of excitatory drive which peaks in the center of the sheet. It is unclear how essential behaviors of the model (grid cells with diverse phase precession profiles, propagating waves) depend upon the non-uniform excitatory drive, or whether these behavior could also be obtained under uniform drive.</p></disp-quote><p>As described in our response to Essential revisions1, our simulations with periodic boundary conditions and uniform drive show attractor bumps and traveling wavefronts across the entire neural sheet during runs and idle periods, respectively (Figure 8). This implementation can produce all the essential behaviors found in our original model (Figure 8—figure supplement 2 and Figure 8—figure supplement 3).</p><disp-quote content-type="editor-comment"><p>3) The influence (if any) of movement velocity upon phase precession is not clear. In a 2D attractor network, velocity has two components: speed and direction. Does the phase precession behavior of the model depend upon one or both of these velocity components? Concerning speed, it is not entirely clear whether simulation results were obtained using fixed or variable running speeds (for example, in Figure 4C, why is there a nonzero error bar for &quot;actual&quot; running speed? It does not appear from the trajectory plot in Figure 2A that there is much noise in the running speed during simulated track traversals). Concerning direction, was the 1D track simulated as some specific linear trajectory through the 2D grid sheet, and if so, what was the orientation alignment of the 1D trajectory on the 2D grid sheet? Would different alignments yield fundamentally different phase precession results?</p></disp-quote><p>As described in our response to Essential revision3, we agree that running simulations with varied track orientations would test the robustness of our model. Yes, the 1D track corresponds to a fixed orientation of 36º on the neural sheet (Appendix 1), chosen to avoid cardinal directions, which are preferred by our neurons. We have now tested different orientations 0º, 22.5º, and 45º, and found no dependence between orientation and phase precession properties (Figure 3—figure supplement 6). We note that we do not fix the orientation of the grid-like activity pattern on the neural sheet; it varies from simulation to simulation.</p><p>We do include variations in velocity in our simulated trajectory such that the speed varies between 0.4 and 0.6 m/s (Appendix 1). As part of our parametric analysis (Essential revision4), we have also tested different mean running speeds of 0.3 and 0.75 m/s. The range of phase precession increases with animal speed (Figure 3—figure supplement 6), as observed experimentally (Jeewajee et al., 2014).</p><disp-quote content-type="editor-comment"><p>4) If excitatory drive is the main determinant of wave propagation, then it would be nice if the authors could perform a more systematic analysis of the drive regimes in which wave propagation occurs. Can the entire sheet be switched into wave propagation behavior by applying an appropriately low level of uniform excitatory drive? Or is there something about the non-uniformity of the drive level that is essential for the wave propagation to occur?</p></disp-quote><p>Yes, simulations with periodic boundary conditions and uniform drive demonstrate wavefronts that propagate throughout the entire neural sheet (Essential revision 1; Figure 8). As part of our parametric analysis (Essential revision 4), we found that replays are roughly independent of excitatory drive; their number is reduced with higher inhibitory drive, since inhibition disrupts wavefront propagation (Figure 7—figure supplement 4).</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>Kang and DeWeese present a detailed and comprehensive modeling study of theta-rhythmic modulation of the activity bump on a continuous attractor map to explain phase precession, theta sequences, and, by reducing subcortical input levels, the switch to the &quot;irregular&quot; state in which sharp-wave/ripple 'replay' reactivations are observed. These are well-studied hippocampal phenomena that may be crucial to the spatial, mnemonic, and decision-making roles of the hippocampus; the manuscript addresses how they may arise in medial entorhinal (MEC) grid cell networks, which is a critical question for the field. The attractor-based mechanism is interesting and potentially contributes a compelling unification of these temporal phenomena; however, there are several gaps in logic and disconnections from the literature in the way the results are currently presented.</p></disp-quote><p>We thank the reviewer for stating that we are addressing a critical question for the field and that our proposed mechanism is interesting and potentially contributes a compelling unification of temporal phenomena. We have made many changes to our manuscript that we feel provide more connections to the literature and better logical flow.</p><disp-quote content-type="editor-comment"><p>• The claims regarding phase precession are largely undercut by the low correlations in Figure 3C and zero-dominated histogram in Figure 3D showing that most of the simulated grid cells do not precess. The authors note that additional features may increase the correlations, but the bias of the distribution toward 0 is the problem, not the average value. Hafting et al., 2008, showed that layer II principal cells all generally precess; while the authors mention that phase locking is observed in layer III (cf. the Hafting paper) as justification, their model is not a layer III model. If the bump modulation is the shared cause of precession and sequences, then the two effects should be equivalently strong in the model.</p></disp-quote><p>The Reviewer raises a subtle and important point. As described in our response to Essential revision2, we believe our model does not necessarily describe only neurons with stereotyped phase precession. Our neurons with grid-like firing maps and directional preferences can be considered conjunctive cells, which are more common in MEC LIII than in LII (Sargolini et al., 2006). These LIII cells exhibit phase locking more than phase precession (Hafting et al., 2008). Moreover, Ebbesen et al., 2016 found that the range and slope of phase precession in LII pyramidal cells is even less than those of LIII cells. We do not exclude the possibility that our model may capture LII neurons whose directional selectivity is influenced by conjunctive cells from deeper MEC layers (as suggested by Bush &amp; Burgess, 2014; and others), but we do not agree that biological plausibility requires most of our cells to precess. We thank Reviewer 3 for pointing out that we did not fully discuss this in our manuscript, and now our justification is provided in the Discussion.</p><p>Moreover, incorporating brief allocentric corrections leads to a shift in the peak of our phase-position correlation distribution away from 0 (Figure 3C). In the Discussion, we suggest other biophysical features that may be added to our model to increase its correlation further.</p><disp-quote content-type="editor-comment"><p>• Additionally, arguments regarding hippocampal phase precession have related to whether it is a cause or effect of temporal compression during theta sequences, or even whether it is epiphenomenal. In MEC, if both effects are generated by the same underlying mechanism as in this model, then the critical question concerns whether phase precession has any function in this setting. Some theories posit that precession helps construct sequences, but others claim that it is simply a by-product of temporal compression (e.g., G. Dragoi and G. Buzsáki. Neuron, 50(1):145-157, 2006.; G. Dragoi. Front Syst Neurosci, 7:46, 2013). It's not clear what the authors are claiming in this manuscript, but the results argue for precession as epiphenomenon because it is unnecessary to either sequences or replay, and the starting phase at the edge of a grid field is apparently random, indicating that it plays no role in the spatiotemporal ordering of activity. The description of the origin of precession in the model (subsection “Theta phase precession arises from oscillations in attractor bump size”, third paragraph) emphasizes that it results from transient changes in spread of activity, instead of external input, network, or cell-assembly modulation as in hippocampal models. The authors should broadly reconsider and clarify the theoretical context and implications of their model design and results regarding precession and theta sequences.</p></disp-quote><p>The reviewer raises important questions regarding the interpretation of both published data and our modeling results. While our work focuses on the mechanistic origins of phase precession and theta sequences, we appreciate the suggestion to further consider their relationship to each other and to broader cognitive theories. Accordingly, we have expanded upon our comments on this topic in our Discussion.</p><p>As reviewer 3 mentions, in hippocampus, some work indicates that phase precession may appear before theta sequences (Feng et al., 2015), which is consistent with the possibility that phase precession gives rise to theta sequences. Our work suggests that such a dependence is not necessary in grid cells and that both can arise from the same underlying cause—namely, oscillations in inhibitory drive. (Similarly, Navratilova et al., 2012, also suggest that both phenomena are consequences of a single factor, after-spike depolarization, in a grid cell model.) Note that this is not inconsistent with a difference in the onset times of these two phenomena in MEC, which has not been observed to our knowledge but would be analogous to what Feng et al., 2015 report in hippocampus. In our model, phase precession arises from oscillations in attractor bump size and theta sequences arise from oscillations in bump velocity. Oscillating inhibitory drive causes both types of bump oscillations, but their relative prominence may differ from one parameter regime to another (Figure 6—figure supplement 1), which may cause phase precession to be detected without theta sequences, or vice versa, at certain times.</p><p>One possible implication of our model is that these theta-related phenomena in MEC, which depend only on intrinsic circuitry and medial septum inputs in our model, may drive the corresponding phenomena in hippocampus, where such particular intrinsic circuitry may not exist. In support of this idea are reports that grid cell phase precession occurs independently of hippocampus (Hafting et al., 2008), but place cell phase precession and theta sequences require the MEC (Schlesiger et al., 2015). Plasticity in the hippocampus can then help the animal leverage these phenomena during movement, like replays during quiescence, to pursue cognitive goals. In this sense, phase precession would not be an epiphenomenon that serves no purpose. For example, phase precession may enable phase coding of position, which allows more accurate assignment of rewards, and theta sequences may help the animal decide between possible trajectories (Kay et al., 2019) based on previous experience. However, our results hold independent of whether these ideas about the relationship between MEC and hippocampus are borne out by future experiments.</p><p>Finally, we note that spike phases at the beginning of grid fields are consistently close to 0º/360º in our model, and not random (Figure 3F), which aligns well with experimental data (Hafting et al., 2008; O’Neill et al., 2017). The simplified conceptual model presented in Figure 4 of our manuscript provides an intuitive explanation for this feature. We acknowledge the reviewer for the opportunity to emphasize this feature in our revision.</p><disp-quote content-type="editor-comment"><p>• The wavefront replay mechanism suffers from a similar causative discrepancy in which the replay sequences do not have any particular relationship with recently expressed sequences. Experiments (e.g., Drieu, Todorova and Zugaro, 2018) are beginning to corroborate earlier theories (such as Dragoi, 2013, mentioned above) that online sequences drive plasticity necessary for subsequent replay. However, grid-cell weights in the model are hard-wired, thus precluding any direct contribution to the learning or memory consolidation roles that may be central to the replay phenomenon in general. The Discussion argues that hard-wired replay might play an initiation role for hippocampal replays, but that incorrectly assumes grid cells directly activate place cells (as in the old grid-to-place models) and ignores sharp-wave initiation studies implicating dentate gyrus, CA2, and/or ascending inputs (Sasaki, et al., 2018; Oliva, et al., 2016; Angulo-Garcia et al., 2018). The potential roles of grid cell wavefronts may be more limited than discussed, which should be addressed.</p></disp-quote><p>We acknowledge that our discussion of a potential role for grid cell replay, the driving of hippocampal replay, was limited, and we thank the reviewer for bringing this point and the broader literature on sharp-wave initiation to our attention. There can be advantages to having replays driven by intrinsically generated sequences, like a central pattern generator, without synaptic plasticity. These replays would be available immediately and maintain an unbiased spatial distribution. However, it is completely possible that there are multiple sites contributing to sequence initiation, including the ones mentioned by reviewer 3. Although the main results of our paper do not depend on the cognitive roles assigned to grid cell replays, we have revised our Discussion to emphasize the broader context of other potential drivers of hippocampal replay.</p><p>The potential role for grid cell replay to drive hippocampal replay does assume that grid cells activate place cells. This activation does not have to be direct; the flow of activity from grid cells in MEC LII to classical place cells in CA1, for example, can travel through dentate gyrus and CA3, although grid cells or conjunctive cells in MEC LIII may also directly activate CA1 through the temporoammonic pathway (Brun et al., 2008). The idea that grid cells influence place cells is supported by classical studies (see Bush et al., 2014 for a review) and more recent work (Hales et al., 2014; Kanter et al., 2017; Mallory et al., 2018). However, we are not asserting that grid cells are the sole drivers of place cell activity (Bush et al., 2014), and recent work also suggests that grid cells can be influenced by (Ólafsdóttir et al., 2016; Boccara et al., 2019; Butler et al., 2019) or depend upon (Chen et al., 2016) external spatial inputs, such as those from place cells in hippocampus. The origin and flow of spatial information within the hippocampal region appears to be quite complicated, and we believe the possibility that grid cells activate place cells cannot be eliminated.</p><disp-quote content-type="editor-comment"><p>• The model is based on the aperiodic network with feedforward Gaussian envelope function described by Burak and Fiete, 2009, but they also described a periodic solution. The periodic solution has problems with rotation, but some of the results (especially the generation of replays) are affected by or depend on the topology. The authors should clarify the reliance of their results on network topology and whether other formulations may also support their conclusions.</p></disp-quote><p>As described in our response to Essential revision1, our new simulations with periodic boundary conditions and uniform drive demonstrate wavefronts that propagate throughout the entire neural sheet.</p></body></sub-article></article>