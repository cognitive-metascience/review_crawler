<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">06444</article-id><article-id pub-id-type="doi">10.7554/eLife.06444</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Noise promotes independent control of gamma oscillations and grid firing within recurrent attractor networks</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-24161"><name><surname>Solanka</surname><given-names>Lukas</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-14680"><name><surname>van Rossum</surname><given-names>Mark CW</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-13369"><name><surname>Nolan</surname><given-names>Matthew F</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1062-6501</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Centre for Integrative Physiology</institution>, <institution>University of Edinburgh</institution>, <addr-line><named-content content-type="city">Edinburgh</named-content></addr-line>, <country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution>Institute for Adaptive and Neural Computation</institution>, <addr-line><named-content content-type="city">Edinburgh</named-content></addr-line>, <country>United Kingdom</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Neuroinformatics Doctoral Training Centre, School of Informatics</institution>, <institution>University of Edinburgh</institution>, <addr-line><named-content content-type="city">Edinburgh</named-content></addr-line>, <country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-14764"><name><surname>Skinner</surname><given-names>Frances K</given-names></name><role>Reviewing editor</role><aff><institution>University Health Network</institution>, <country>Canada</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><label>*</label>For correspondence: <email>mattnolan@ed.ac.uk</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>06</day><month>07</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e06444</elocation-id><history><date date-type="received"><day>11</day><month>01</month><year>2015</year></date><date date-type="accepted"><day>04</day><month>07</month><year>2015</year></date></history><permissions><copyright-statement>© 2015, Solanka et al</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Solanka et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-06444-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.06444.001</object-id><p>Neural computations underlying cognitive functions require calibration of the strength of excitatory and inhibitory synaptic connections and are associated with modulation of gamma frequency oscillations in network activity. However, principles relating gamma oscillations, synaptic strength and circuit computations are unclear. We address this in attractor network models that account for grid firing and theta-nested gamma oscillations in the medial entorhinal cortex. We show that moderate intrinsic noise massively increases the range of synaptic strengths supporting gamma oscillations and grid computation. With moderate noise, variation in excitatory or inhibitory synaptic strength tunes the amplitude and frequency of gamma activity without disrupting grid firing. This beneficial role for noise results from disruption of epileptic-like network states. Thus, moderate noise promotes independent control of multiplexed firing rate- and gamma-based computational mechanisms. Our results have implications for tuning of normal circuit function and for disorders associated with changes in gamma oscillations and synaptic strength.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.001">http://dx.doi.org/10.7554/eLife.06444.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.06444.002</object-id><title>eLife digest</title><p>When electrodes are placed on the scalp, or lowered into the brain itself, rhythmic waves of electrical activity are seen that reflect the coordinated firing of large numbers of neurons. The pattern of the waves varies between different brain regions, and according to what the animal or person is doing. During sleep and quiet wakefulness, slower brain waves predominate, whereas faster waves called gamma oscillations emerge during cognition—the act of processing knowledge.</p><p>Gamma waves can be readily detected in a region of the brain called the medial entorhinal cortex (MEC). This brain region is also known for its role in forming the spatial memories that allow an individual to remember how to navigate around an area they have previously visited. Individual MEC cells increase their firing rates whenever an individual is at specific locations. When these locations are plotted in two dimensions, they form a hexagonal grid: this ‘grid cell map’ enables the animal to keep track of its position as it navigates through its environment.</p><p>To determine how MEC neurons can simultaneously encode spatial locations and generate the gamma waves implicated in cognition, Solanka et al. have used supercomputing to simulate the activity of more than 1.5 million connections between MEC cells. Changing the strength of these connections had different effects on the ability of the MEC to produce gamma waves or spatial maps. However, adjusting the model to include random fluctuations in neuronal firing, or ‘noise’, was beneficial for both types of output. This is partly because noise prevented neuronal firing from becoming excessively synchronized, which would otherwise have caused seizures.</p><p>Although noise is generally regarded as disruptive, the results of Solanka et al. suggest that it helps the MEC to perform its two distinct roles. Specifically, the presence of noise enables relatively small changes in the strength of the connections between neurons to alter gamma waves—and thus affect cognition—without disrupting the neurons' ability to encode spatial locations. Given that noise reduces the likelihood of seizures, the results also raise the possibility that introducing noise into the brain in a controlled way could have therapeutic benefits for individuals with epilepsy.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.002">http://dx.doi.org/10.7554/eLife.06444.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author keywords</title><kwd>oscillation</kwd><kwd>entorhinal cortex</kwd><kwd>cognition</kwd><kwd>attractor network</kwd><kwd>synapse</kwd><kwd>inhibition</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>Biotechnology and Biological Sciences Research Council (BBSRC)</institution></institution-wrap></funding-source><award-id>BB/L010496/1</award-id><principal-award-recipient><name><surname>Solanka</surname><given-names>Lukas</given-names></name><name><surname>Nolan</surname><given-names>Matthew F</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>Biotechnology and Biological Sciences Research Council (BBSRC)</institution></institution-wrap></funding-source><award-id>BB/F529254/1</award-id><principal-award-recipient><name><surname>Solanka</surname><given-names>Lukas</given-names></name><name><surname>van Rossum</surname><given-names>Mark CW</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000266</institution-id><institution>Engineering and Physical Sciences Research Council (EPSRC)</institution></institution-wrap></funding-source><award-id>EP/F500385/1</award-id><principal-award-recipient><name><surname>Solanka</surname><given-names>Lukas</given-names></name><name><surname>van Rossum</surname><given-names>Mark CW</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.3</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Random fluctuations in neuronal firing may enable a single brain region, the medial entorhinal cortex, to perform distinct roles in cognition (by generating gamma waves) and spatial navigation (by producing a grid cell map).</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Cognitive processes are mediated by computations in neural circuits and are often associated with gamma frequency oscillations in circuit activity. Gamma activity and cognitive performance often co-vary within tasks and between individuals, while cognitive deficits in psychiatric disorders such as autism and schizophrenia are linked to altered gamma frequency network dynamics (<xref ref-type="bibr" rid="bib45">Uhlhaas and Singer, 2012</xref>; <xref ref-type="bibr" rid="bib40">Spellman and Gordon, 2014</xref>). Such disorders are also linked to changes in the efficacy of excitatory glutamatergic and inhibitory GABAergic synapses (<xref ref-type="bibr" rid="bib31">Rubenstein and Merzenich, 2003</xref>; <xref ref-type="bibr" rid="bib23">Lewis et al., 2012</xref>). A critical and unresolved issue is the mechanistic relationship between gamma oscillations, the strength of excitation and inhibition, and circuit computations. On the one hand, neural codes based on firing rates may be sufficient for circuit computations (<xref ref-type="bibr" rid="bib36">Shadlen and Newsome, 1994</xref>; <xref ref-type="bibr" rid="bib20">Histed and Maunsell, 2014</xref>). In this scenario gamma oscillations might index circuit activation, but would not be required for computation. Evidence that rate coded computations and gamma oscillations arise from shared circuit mechanisms could be interpreted to support this view (<xref ref-type="bibr" rid="bib25">Lundqvist et al., 2010</xref>; <xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>), which predicts that when synaptic properties of a circuit are altered then gamma activity and the output of the rate-coded computation will co-vary. Alternatively, gamma oscillations, while sharing cellular substrates with rate-coded computations, may nevertheless support independent or multiplexed computational modes. For example, according to the communication through coherence hypothesis, tuning of gamma frequency activity may facilitate selective interactions between distant brain regions (<xref ref-type="bibr" rid="bib15">Fries, 2009</xref>). In this scenario independent control of rate coded computation and gamma activity would be beneficial, for example by allowing tuning of coherence without disrupting multiplexed rate-coded computations. However, it is unclear how this could be achieved in circuits where gamma and rate-coded computations share common synaptic mechanisms, as this would require variation in synaptic properties to differentially affect gamma activity and the rate coded computation.</p><p>We address these issues using a model that accounts, through a common synaptic mechanism, for gamma oscillations and spatial computation by neurons in layer 2 of the medial entorhinal cortex (MEC) (<xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). The rate-coded firing of grid cells in the MEC is a well-studied feature of neural circuits for spatial cognition (<xref ref-type="bibr" rid="bib28">Moser and Moser, 2013</xref>). During exploration of an environment individual grid cells are active at multiple locations that together follow a hexagonal grid-like organization. At the same time MEC circuits generate periods of activity in the high gamma frequency range (60–120 Hz) nested within a slower theta (8–12 Hz) frequency network oscillation (<xref ref-type="bibr" rid="bib6">Chrobak and Buzsáki, 1998</xref>). Analysis of spatial correlations in grid firing, of manipulations to grid circuits, and recording of grid cell membrane potential in behaving animals, collectively point towards continuous two-dimensional network attractor states as explanations for grid firing (<xref ref-type="bibr" rid="bib3">Bonnevie et al., 2013</xref>; <xref ref-type="bibr" rid="bib11">Domnisoru et al., 2013</xref>; <xref ref-type="bibr" rid="bib34">Schmidt-Hieber and Häusser, 2013</xref>; <xref ref-type="bibr" rid="bib48">Yoon et al., 2013</xref>). In layer II of the MEC, which has the highest known density of grid cells (<xref ref-type="bibr" rid="bib33">Sargolini et al., 2006</xref>), stellate cells that project to the dentate gyrus of the hippocampus are the major population of excitatory neurons (<xref ref-type="bibr" rid="bib17">Gatome et al., 2010</xref>). These excitatory (E) neurons do not appear to influence one another directly but instead interact via intermediate inhibitory (I) neurons (<xref ref-type="bibr" rid="bib10">Dhillon and Jones, 2000</xref>; <xref ref-type="bibr" rid="bib8">Couey et al., 2013</xref>; <xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). Models that explicitly incorporate this recurrent E-I-E connectivity can account for grid firing through velocity-dependent update of network attractor states (<xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). When these models are implemented with excitable spiking neurons they also account for theta-nested gamma frequency network oscillations (<xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). The influence in these, or other classes of attractor network models, of the strength of E to I or I to E connections on gamma oscillations and grid firing, or other attractor computations, has not been systematically investigated.</p><p>We find that while gamma oscillations and grid firing are both sensitive to the strength of excitatory and inhibitory connections, their relationship differs. Although their underlying synaptic substrates are identical, gamma activity nevertheless provides little information about grid firing or the presence of underlying network attractor states. Thus, gamma activity is not a good predictor of rate-coded computation. Unexpectedly, we find the range of E- and I- synaptic strengths that support gamma and grid firing is massively increased by moderate intrinsic noise through a mechanism involving suppression of seizure-like events. In the presence of moderate noise differences in synaptic strength can tune the amplitude and frequency of gamma across a wide range with little effect on grid firing. We obtain similar results in implementations of E-I models in which connectivity is probabilistic and in models extended to include additional I to I and E to E connections. Our results suggest constraints for extrapolation of differences in gamma activity to mechanisms for cognition, identify noise as a critical factor for successful circuit computation, and suggest that tuning of excitatory or inhibitory synaptic strength could be used to control gamma-dependent processes multiplexed within circuits carrying out rate coded computations.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>To systematically explore relationships between strengths of excitatory and inhibitory synapses, computations and gamma activity, we initially take advantage of models that account for both grid firing and theta-nested gamma oscillations through E-I-E interactions (<xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). In these models a layer of E cells sends synaptic connections to a layer of I cells, which in turn feedback onto the E cell layer (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). For attractor dynamics to emerge the strength of E and I connections are set to depend on the relative locations of neurons in network space (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). While suitable connectivity could arise during development through spike timing-dependent synaptic plasticity (<xref ref-type="bibr" rid="bib47">Widloski and Fiete, 2014</xref>), here the connection profiles are fixed (<xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). To vary the strength of excitatory or inhibitory connections in the network as a whole we scale the strength of all connections relative to a maximum conductance value (g<sub>E</sub> or g<sub>I</sub> for excitation and inhibition respectively) (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). We also consider networks in which the connection probability, rather than its strength, varies according to the relative position of neurons in the network (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Each E and I cell is implemented as an exponential integrate and fire neuron and so its membrane potential approximates the dynamics of a real neuron, as opposed to models in which synaptic input directly updates a spike rate parameter. Addition of noise to a single E or I cell increases variability in its membrane potential trajectory approximating that seen in vivo (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) (<xref ref-type="bibr" rid="bib11">Domnisoru et al., 2013</xref>; <xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>; <xref ref-type="bibr" rid="bib34">Schmidt-Hieber and Häusser, 2013</xref>). Given that all neurons in the model are implemented as exponential integrate-and-fire neurons and that in total the model contains &gt;1.5 million synaptic connections, we optimized a version of the model to enable relatively fast simulation and automated extraction and analysis of generated data (see ‘Materials and methods’). In this way the effect on grid firing of 31 × 31 combinations of g<sub>E</sub> and g<sub>I</sub> could be evaluated typically using &gt;50 nodes on a computer cluster in approximately 1 week.<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.06444.003</object-id><label>Figure 1.</label><caption><title>Attractor network model with feedback inhibition and theta frequency inputs.</title><p>(<bold>A</bold>) A schematic of populations of excitatory cells (E cells, red) and inhibitory cells (I cells, blue) on a twisted torus of size 34 × 30 neurons. The synaptic coupling between the two populations was parameterized by the inter-population peak synaptic conductances g<sub>E</sub> (E → I synapses) and g<sub>I</sub> (I → E synapses). (<bold>B</bold>) Top: Plots illustrate peak synaptic conductances of E (red) and I (blue) synapses as a function of the distance between pre- and post-synaptic neurons. Bottom: Distributions of synaptic weights from all I cells onto an E cell in the model (left) and from all E cells onto an I-cell (right). Parameters g<sub>I</sub> and g<sub>E</sub> determine maximal values of these distributions. (<bold>C</bold>) Examples of the membrane potential of an isolated E cell during two consecutive theta cycles in networks without noise (white noise input current standard deviation σ = 0 pA), with an intermediate amount of noise (σ = 150 pA) and with noise levels doubled (σ = 300 pA). Theta signal is illustrated in grey.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.003">http://dx.doi.org/10.7554/eLife.06444.003</ext-link></p></caption><graphic xlink:href="elife-06444-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Synaptic weights in scaled and probabilistic variants of the network.</title><p>(<bold>A</bold>) Output (top) and input (bottom) synaptic weights of an E (left) and I (right) neuron in the middle of the twisted torus in a network in which synaptic weights are scaled according to the synaptic profile functions from <xref ref-type="fig" rid="fig1">Figure 1B</xref>. (<bold>B</bold>) Same as (<bold>A</bold>), but synaptic weights are constant and the probability of connection between a pair of neurons is scaled according to the synaptic profile functions in <xref ref-type="fig" rid="fig1">Figure 1B</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.004">http://dx.doi.org/10.7554/eLife.06444.004</ext-link></p></caption><graphic xlink:href="elife-06444-fig1-figsupp1-v2.tif"/></fig></fig-group></p><sec id="s2-1"><title>Intrinsic noise increases the range of synaptic strengths that support grid firing</title><p>What happens to grid firing patterns when the strengths of excitatory and/or inhibitory synaptic connections in the model are modified? To address this we first evaluated grid firing while simulating exploration within a circular environment with a network from which noise sources were absent (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). When we reduce the strength of connections from I cells by threefold and increase the strength of connections from E cells by threefold we find that grid firing is abolished (<xref ref-type="fig" rid="fig2">Figure 2Ab</xref> vs <xref ref-type="fig" rid="fig2">Figure 2Aa</xref>). Exploring the parameter space of g<sub>E</sub> and g<sub>I</sub> more systematically reveals a relatively restricted region that supports grid firing (<xref ref-type="fig" rid="fig2">Figure 2D</xref> and <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1A–D</xref>). Rather than the required g<sub>I</sub> and g<sub>E</sub> being proportional to one another, this region is shifted towards low values of g<sub>I</sub> and high g<sub>E</sub>. Thus, the ability of recurrently connected networks to generate grid fields requires specific tuning of synaptic connection strengths.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.06444.005</object-id><label>Figure 2.</label><caption><title>Noise increases the range of synaptic strengths that support grid firing.</title><p>(<bold>A</bold>–<bold>C</bold>) Example spatial firing fields (left) and spatial autocorrelation plots (right) of E and I cells for networks without noise (<bold>A</bold>; σ = 0 pA), with noise level set to σ = 150 pA (<bold>B</bold>), and noise level set to σ = 300 pA (<bold>C</bold>) and with the strengths of recurrent synaptic connections indicated by arrows in (<bold>D</bold>–<bold>F</bold>). Maximal firing rate is indicated to the top right of each spatial firing plot. The range of spatial autocorrelations is normalized between 0 and 1. (<bold>D</bold>–<bold>F</bold>) Gridness score as a function of g<sub>E</sub> and g<sub>I</sub> for networks with each noise level. Each item in the color plot is an average gridness score of four simulation runs. Arrows indicate the positions of grid field and autocorrelation examples from simulations illustrated in (<bold>A</bold>–<bold>C</bold>). Simulations that did not finish in a specified time interval (5 hr) are indicated by white color. (<bold>G</bold>) Difference between gridness scores of networks with σ = 150 pA and networks with σ = 0 pA plotted as a function of g<sub>E</sub> and g<sub>I</sub>. (<bold>H</bold>) Gridness score plotted as a function of the standard deviation of intrinsic noise. Each noise level comprises simulations from a neighborhood of g<sub>E</sub> and g<sub>I</sub> surrounding a center point in the parameter space (center included) indicated by arrows in (<bold>D</bold>–<bold>F</bold>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.005">http://dx.doi.org/10.7554/eLife.06444.005</ext-link></p></caption><graphic xlink:href="elife-06444-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.006</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Sensitivity of grid firing to changes in feedback inhibition, excitation and noise levels in networks with connection probability between pairs of neurons drawn according to the synaptic profile functions in <xref ref-type="fig" rid="fig1">Figure 1B</xref>.</title><p>(<bold>A</bold>–<bold>C</bold>) Example spatial firing fields (left) and spatial autocorrelation plots (right) of E and I cells for networks without noise (<bold>A</bold>; σ = 0 pA), with noise set to σ = 150 pA (<bold>B</bold>), and noise set to σ = 300 pA (<bold>C</bold>) and with the strengths of recurrent synaptic connections indicated by arrows in (<bold>D</bold>–<bold>F</bold>). Maximal firing rate is indicated in the top right of each spatial firing plot. The range of spatial autocorrelations is normalized between 0 and 1. (<bold>D</bold>–<bold>F</bold>) Gridness score as a function of g<sub>E</sub> and g<sub>I</sub> for networks with each noise level. Each item in the color plot is an average gridness score of two simulation runs. Arrows indicate the positions of grid field and autocorrelation examples from simulations illustrated in (<bold>A</bold>–<bold>C</bold>). Simulations that did not finish in a specified time interval (5 hr) are indicated by white color.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.006">http://dx.doi.org/10.7554/eLife.06444.006</ext-link></p></caption><graphic xlink:href="elife-06444-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.007</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Spatial information and sparsity of firing fields of E and I cells.</title><p>(<bold>A</bold>) Spatial information of E (top) and I (bottom) cells as a function of g<sub>E</sub> and g<sub>I</sub> in networks from <xref ref-type="fig" rid="fig2">Figure 2</xref>. (<bold>B</bold>) Same as (<bold>A</bold>), but the color plots show spatial sparsity of E and I cells. Black lines indicate the region from <xref ref-type="fig" rid="fig2">Figure 2D–F</xref> where the gridness score = 0.5.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.007">http://dx.doi.org/10.7554/eLife.06444.007</ext-link></p></caption><graphic xlink:href="elife-06444-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.008</object-id><label>Figure 2—figure supplement 3.</label><caption><title>Gridness scores of I cells.</title><p>Colour plots show gridness score as a function of g<sub>E</sub> and g<sub>I</sub> for networks without noise (<bold>A</bold>), with noise standard deviation σ = 150 pA (<bold>B</bold>), and σ = 300 pA (<bold>C</bold>). Data are from simulations of networks with feedback inhibition only (E-I networks; <xref ref-type="fig" rid="fig2">Figure 2</xref>). Black lines indicate the region from <xref ref-type="fig" rid="fig2">Figure 2D–F</xref> where the gridness score of E cells = 0.5.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.008">http://dx.doi.org/10.7554/eLife.06444.008</ext-link></p></caption><graphic xlink:href="elife-06444-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.009</object-id><label>Figure 2—figure supplement 4.</label><caption><title>Spatial firing fields in networks with uncorrelated spatial input applied to each I cell.</title><p>(<bold>A</bold>) Examples of firing fields of E and I cells. Gridness score and maximal firing rate of the firing field is indicated in the top left and right parts of each firing field, respectively. (<bold>B</bold>) Distributions of spatial sparsity (left), spatial information (centre) and gridness score (right) of 100 randomly selected cells from each population of neurons. Each simulation run was repeated 10 times with different random seeds. Network parameters were g<sub>E</sub> = 3 nS and g<sub>I</sub> = 1 nS. Each I cell received connections from three randomly selected neurons with a place like spatial firing field. Properties of place cells: r<sub>max</sub> = 100 Hz, σ<sub>field</sub> = 80 cm (cf. <xref ref-type="app" rid="app1">Appendix 1</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.009">http://dx.doi.org/10.7554/eLife.06444.009</ext-link></p></caption><graphic xlink:href="elife-06444-fig2-figsupp4-v2.tif"/></fig></fig-group></p><p>Because neural activity in the brain is noisy (<xref ref-type="bibr" rid="bib36">Shadlen and Newsome, 1994</xref>; <xref ref-type="bibr" rid="bib13">Faisal et al., 2008</xref>), we wanted to know if the ability of the circuit to compute location is affected by noise intrinsic to each neuron (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Given that continuous attractor networks are often highly sensitive to noise (<xref ref-type="bibr" rid="bib49">Zhang, 1996</xref>; <xref ref-type="bibr" rid="bib12">Eliasmith, 2005</xref>), we expected that intrinsic noise would reduce the parameter space in which computation is successful. In contrast, when we added noise with standard deviation of 150 pA to the intrinsic dynamics of each neuron, we found that both configurations from <xref ref-type="fig" rid="fig2">Figure 2Aa,b</xref> now supported grid firing patterns (<xref ref-type="fig" rid="fig2">Figure 2Ba,b</xref>). When we considered the full space of E and I synaptic strengths in the presence of this moderate noise we now found a much larger region that supports grid firing (<xref ref-type="fig" rid="fig2">Figure 2E</xref> and <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1E–H</xref>). This region has a crescent-like shape, with arms of relatively high g<sub>I</sub> and low g<sub>E</sub>, and low g<sub>I</sub> and high g<sub>E</sub>. Thus, while tuning of g<sub>I</sub> and g<sub>E</sub> continues to be required for grid firing, moderate noise massively increases the range of g<sub>E</sub> and g<sub>I</sub> over which grid fields are generated.</p><p>When intrinsic noise was increased further, to 300 pA, the parameter space that supports grid firing was reduced in line with our initial expectations (<xref ref-type="fig" rid="fig2">Figure 2Ca,b,F</xref> and <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1I–L</xref>). To systematically explore the range of g<sub>E</sub> and g<sub>I</sub> over which the network is most sensitive to the beneficial effects of noise we subtracted grid scores for simulations with 150 pA noise from scores with deterministic simulations (<xref ref-type="fig" rid="fig2">Figure 2G</xref>). This revealed that the unexpected beneficial effect of noise was primarily in the region of the parameter space where recurrent inhibition was strong. In this region, increasing noise above a threshold led to high grid scores, while further increases in noise progressively impaired grid firing (<xref ref-type="fig" rid="fig2">Figure 2H</xref>). In probabilistically connected networks, the range of g<sub>E</sub> and g<sub>I</sub> supporting grid firing was reduced, but the shape of the parameter space and dependence on noise was similar to the standard networks (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>), indicating that the dependence of grid firing on g<sub>E</sub> and g<sub>I</sub>, and the effects of noise, are independent of the detailed implementation of the E-I attractor networks.</p><p>How closely does the firing of I cells in the simulated networks correspond to inhibitory activity in behaving animals, and to what extent is the pattern of I cell firing affected by g<sub>E</sub>, g<sub>I</sub> and noise? While there is little data on the spatial firing of interneurons in the MEC, recent evidence indicates that the majority of parvalbumin positive interneurons have firing fields with significant spatial stability, but low spatial sparsity and grid scores compared to excitatory grid cells (<xref ref-type="bibr" rid="bib4">Buetfering et al., 2014</xref>). A possible interpretation of these data is that parvalbumin positive cells are unlikely to fulfill the roles of I cells predicted in E-I models. However, in networks that we evaluate here in which E cells have grid firing fields in the presence of moderate noise, I cell firing fields also have a much lower spatial information content and spatial sparsity than the corresponding E cell firing fields (E cells: spatial sparsity 0.788 ± 0.061, spatial information: 1.749 ± 0.32 bits/spike; I cells: spatial sparsity 0.239 ± 0.018, spatial information 0.243 ± 0.024 bits/spike; p &lt; 10<sup>−16</sup> for comparisons of both spatial sparsity and information; paired t-test; data range is indicated as mean ± standard deviation) (<xref ref-type="fig" rid="fig2">Figure 2A–C</xref> and <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). Spatial autocorrelograms of simulated I cell firing fields also do not contain the six hexagonally organized peaks that are characteristic of grid fields (<xref ref-type="fig" rid="fig2">Figure 2A–C</xref>). Nevertheless, I cell spatial autocorrelograms produce positive grid scores (0.39 ± 0.16; <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>), although these are reduced compared to scores for the E cells in the same networks (E cells: 0.796 ± 0.157; p &lt; 10<sup>−16</sup>; paired t-test; mean ± SD) and in many networks are below the threshold considered previously to qualify as grid like (cf. Figure 4B of <xref ref-type="bibr" rid="bib4">Buetfering et al., 2014).</xref> When we evaluated the dependence of I cell spatial firing on g<sub>E</sub>, g<sub>I</sub> and noise, it appeared to be similar to that of E cells <xref ref-type="fig" rid="fig2s3">(Figure 2—figure supplement 3</xref>). To assess whether grid scores of I cells can be reduced further in E-I networks while maintaining grid firing by E cells, we investigated networks in which uncorrelated spatial input is applied to each I cell (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). In these simulations E cells had grid scores of 0.57 ± 0.25, spatial sparsity of 0.78 ± 0.03 and spatial information of 1.69 ± 0.18 bits/spike, whereas I cells had grid scores of 0.16 ± 0.2 (p &lt; 10<sup>−16</sup>, paired t-test), spatial sparsity of 0.21 ± 0.01 (p &lt; 10<sup>−16</sup>, paired t-test) and spatial information of 0.2 ± 0.01 bits/spike (p &lt; 10<sup>−16</sup>, paired t-test; range of all data sets is mean ± SD). Thus, spatial firing of I cells has a similar dependence on noise, g<sub>E</sub> and g<sub>I</sub> to grid cells, conventional indices of spatial firing are nevertheless much lower for I cells in E-I networks compared to E cells, and grid firing by E cells in E-I networks is relatively robust to disruption of the rotational symmetry of I cell firing fields.</p><p>Together these simulations demonstrate that attractor circuit computations that generate grid firing fields require specific tuning of g<sub>E</sub> and g<sub>I</sub>. In the absence of noise grid firing is supported in relatively restricted regions of parameter space. Optimal levels of noise, which produce single cell membrane potential fluctuations of a similar amplitude to experimental observations (<xref ref-type="bibr" rid="bib11">Domnisoru et al., 2013</xref>; <xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>; <xref ref-type="bibr" rid="bib34">Schmidt-Hieber and Häusser, 2013</xref>), promote grid firing by reducing the sensitivity of grid computations to the strength of recurrent synaptic connections, particularly when inhibition is relatively strong and excitation is weak.</p></sec><sec id="s2-2"><title>Differential sensitivity of gamma oscillations and grid firing to the strength of E and I synapses</title><p>Is the sensitivity of gamma frequency oscillations to synaptic strength and to noise similar to that of grid firing? To evaluate gamma activity we recorded synaptic currents from single E and I cells across multiple theta cycles (<xref ref-type="fig" rid="fig3">Figure 3A–C</xref>). For the network configurations illustrated in <xref ref-type="fig" rid="fig2">Figure 2Aa,b</xref> and in which intrinsic noise is absent, we observed synaptic events entrained to theta cycles (<xref ref-type="fig" rid="fig3">Figure 3Aa,b</xref>). However, the timing and amplitude of synaptic events typically differed between theta cycles and no consistent gamma rhythm was apparent. In contrast, in the presence of noise with standard deviation 150 pA we observed nested gamma frequency synaptic activity with timing that was consistent between theta cycles (<xref ref-type="fig" rid="fig3">Figure 3Ba</xref>). In this condition the frequency of the gamma oscillations was reduced and their amplitude increased by raising g<sub>I</sub> and lowering g<sub>E</sub> (<xref ref-type="fig" rid="fig3">Figure 3Bb</xref>). With a further increase in noise to 300 pA, gamma activity remained entrained to theta cycles, but became less ordered (<xref ref-type="fig" rid="fig3">Figure 3Ca,b</xref>).<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.06444.012</object-id><label>Figure 3.</label><caption><title>Differential sensitivity of gamma oscillations and grid fields to changes in the strength of E and I synapses.</title><p>(<bold>A</bold>–<bold>C</bold>) Examples of inhibitory (red) and excitatory (blue) synaptic currents recorded respectively from excitatory and inhibitory neurons from simulations highlighted by arrows in panels (<bold>D</bold>–<bold>F</bold>). (<bold>D</bold>–<bold>F</bold>) Top: Correlation value at the first local maximum of the autocorrelation of inhibitory synaptic currents (I → E cells, 25 randomly selected E cells), plotted as a function of g<sub>E</sub> and g<sub>I</sub>, for networks without noise (<bold>D</bold>), with noise level set to σ = 150 pA (<bold>E</bold>), and noise level set to σ = 300 pA (<bold>F</bold>). Each point is an average over five simulation trials. In these simulations velocity and place cell inputs were disabled. The duration of simulations was 10 s. Bottom: Frequency corresponding to the peaks of the autocorrelation functions for simulations in the top panels. Black lines in (<bold>E</bold>) indicate the region from <xref ref-type="fig" rid="fig2">Figure 2E</xref> where the gridness score = 0.5. (<bold>G</bold>) Scatter plots show gridness score as a function of gamma oscillation strength (top) and frequency (bottom) for simulations with noise absent (green), with an intermediate level of noise (red) and highest simulated noise level (blue). Each dot represents data from a single network configuration. (<bold>H</bold>) Top: Gamma oscillation strength plotted as a function of standard deviation of the noise current. Grey color indicates simulations with g<sub>E</sub> = 3 nS, g<sub>I</sub> = 1 nS (<bold>A</bold>). Red color indicates simulations with g<sub>E</sub> = 1 nS, g<sub>I</sub> = 3 nS (<bold>B</bold>). Bottom: Frequency corresponding to the detected autocorrelation peak.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.012">http://dx.doi.org/10.7554/eLife.06444.012</ext-link></p></caption><graphic xlink:href="elife-06444-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.013</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Sensitivity of gamma oscillations to changes in the strength of E and I synapses in networks with connection probability between pairs of neurons drawn according to the synaptic profile functions in <xref ref-type="fig" rid="fig1">Figure 1B</xref>.</title><p>(<bold>A</bold>–<bold>C</bold>) Examples of inhibitory (red) and excitatory (blue) synaptic currents recorded respectively from excitatory and inhibitory neurons from simulations highlighted by arrows in panels (<bold>D</bold>–<bold>F</bold>). (<bold>D</bold>–<bold>F</bold>) Top: Correlation value at the first local maximum of an autocorrelation of inhibitory synaptic currents (I → E cells, 25 randomly selected E cells), plotted as a function of g<sub>E</sub> and g<sub>I</sub>, for networks without noise (<bold>D</bold>), with noise set to σ = 150 pA (<bold>E</bold>), and noise set to σ = 300 pA (<bold>F</bold>). Each point is an average over five simulation trials. In these simulations velocity and place cell inputs were disabled. The duration of simulations was 10 s. Bottom: Frequency corresponding to the peaks of the autocorrelation functions for simulations in the top panels. Black lines in (<bold>E</bold>) indicate the region from <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> where the gridness score = 0.5.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.013">http://dx.doi.org/10.7554/eLife.06444.013</ext-link></p></caption><graphic xlink:href="elife-06444-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.014</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Scatter plots of gridness score as a function of the amplitude of gamma oscillations.</title><p>(<bold>A</bold>–<bold>C</bold>) The plots show relationships between grid field computations (gridness score) and the power of nested gamma oscillations for deterministic networks (<bold>A</bold>), networks with moderate noise (<bold>B</bold>) and networks with the highest simulated noise level (<bold>C</bold>). Noise level is indicated by σ. The strength of the oscillation was obtained by computing autocorrelation functions of inhibitory currents impinging onto 25 randomly selected E cells in the network and detecting their first local maxima. The correlation value at the first local maximum is plotted on the abscissa. Color coding determines the values of g<sub>E</sub> and g<sub>I</sub>, as shown in the 2D colorbar.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.014">http://dx.doi.org/10.7554/eLife.06444.014</ext-link></p></caption><graphic xlink:href="elife-06444-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.015</object-id><label>Figure 3—figure supplement 3.</label><caption><title>Scatter plots of gridness score as a function of the detected oscillation frequency.</title><p>(<bold>A</bold>–<bold>C</bold>) The plots show relationships between grid field computations (gridness score) and the frequency of gamma oscillations for deterministic networks (<bold>A</bold>), networks with moderate noise (<bold>B</bold>) and networks with the highest simulated noise level (<bold>C</bold>). Noise level is indicated by σ. The frequency of the oscillation was obtained by computing autocorrelation functions of inhibitory currents impinging onto 25 randomly selected E cells in the network and detecting their first local maxima. The time lag at the first local maximum yielded the frequency of the oscillation, which is plotted on the abscissa. Color coding determines the values of g<sub>E</sub> and g<sub>I</sub>, as shown in the 2D colorbar.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.015">http://dx.doi.org/10.7554/eLife.06444.015</ext-link></p></caption><graphic xlink:href="elife-06444-fig3-figsupp3-v2.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.016</object-id><label>Figure 3—figure supplement 4.</label><caption><title>Amplitude and frequency of gamma oscillations in the g<sub>E</sub> and g<sub>I</sub> parameter regions where grid fields are robust.</title><p>Amplitude (top) and frequency (bottom) of detected gamma oscillations for simulations in which gridness score is greater than 0.5, in deterministic networks (<bold>A</bold>), networks with an intermediate level of noise (<bold>B</bold>) and in networks with the highest simulated level of noise (<bold>C</bold>). The data in this figure are from simulations in <xref ref-type="fig" rid="fig3">Figure 3</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.016">http://dx.doi.org/10.7554/eLife.06444.016</ext-link></p></caption><graphic xlink:href="elife-06444-fig3-figsupp4-v2.tif"/></fig></fig-group></p><p>To explore gamma activity across a wider range of g<sub>I</sub> and g<sub>E</sub> we automated quantification of the strength and frequency of oscillatory input to E cells (see ‘Materials and methods’). In the absence of noise gamma frequency activity only occurred for a narrow range of g<sub>I</sub> and g<sub>E</sub> (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). Strikingly, following addition of moderate noise the region of parameter space that supports gamma activity was massively expanded (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). Within this space, the amplitude of gamma increased with increasing inhibition, whereas the frequency was reduced. As noise is increased further the amplitude and frequency of gamma oscillations are reduced (<xref ref-type="fig" rid="fig3">Figure 3F</xref>). We found a similar dependence of gamma oscillations on noise, g<sub>E</sub> and g<sub>I</sub> in networks with probabilistic connectivity (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Thus, intrinsic noise modifies the amplitude and frequency of nested gamma oscillations.</p><p>To determine whether there is a systematic relationship between values of g<sub>E</sub> and g<sub>I</sub> that generate gamma and grid firing we compared the gridness score and gamma scores for each circuit configuration (<xref ref-type="fig" rid="fig3">Figure 3G</xref>, <xref ref-type="fig" rid="fig3s2 fig3s3">Figure 3—figure supplements 2, 3</xref>). We found this relationship to be complex and highly sensitive to noise. However, we did not find any evidence for strong linear relationships between gamma amplitude or gamma frequency and grid score (R<sup>2</sup> &lt; 0.12 for all comparisons), while gamma amplitude and frequency provided only modest amounts of information about grid scores (0.27 &lt; MIC &lt; 0.33 and 0.27 &lt; MIC &lt; 0.37 respectively). The relationship between noise intensity and gamma differed from that for grid computations. Whereas, grids emerged above a sharp noise threshold (<xref ref-type="fig" rid="fig2">Figure 2H</xref>), for the same regions in parameter space the frequency and amplitude of gamma oscillations varied smoothly as a function of noise (<xref ref-type="fig" rid="fig3">Figure 3H</xref>). Thus, neither the frequency nor the power of gamma appears to be a good predictor of grid firing.</p><p>When we considered only regions of parameter space that generate robust grid fields (grid score &gt;0.5), we found circuits generating almost the complete observed range of gamma amplitudes (0.02 &lt; autocorrelation peak &lt; 0.59) and frequencies (31 Hz &lt; frequency &lt; 102 Hz) (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>). For example, considering the crescent shaped region of E-I space that supports grid firing in the presence of intermediate noise (the region within the isocline in <xref ref-type="fig" rid="fig3">Figure 3E</xref>), when g<sub>I</sub> is high and g<sub>E</sub> low then the amplitude of gamma is relatively low and the frequency high. Moving towards the region where g<sub>I</sub> is high and g<sub>E</sub> is low, the amplitude of gamma is increased and the frequency is reduced. Thus, variation of synaptic strength across this region of E-I space can be used to tune the properties of gamma activity while maintaining the ability of the network to generate grid fields.</p><p>Together these data indicate that an optimal level of noise promotes emergence of gamma oscillations, while the properties of oscillations may depend on the relative strength of synaptic connections. The relationship between gamma and synaptic strength differs to that for grid computations. Strikingly, while gamma activity provides relatively little information about grid firing, differential sensitivity of gamma and grid firing to g<sub>E</sub> and g<sub>I</sub> provides a mechanism for circuits to tune gamma frequency activity while maintaining the ability to compute rate coded grid firing fields.</p></sec><sec id="s2-3"><title>Noise promotes attractor computation by opposing seizures</title><p>Given the emergence of a large parameter space that supports grid firing following introduction of moderate noise, we were interested to understand how noise influences the dynamics of the E-I circuits. One possibility is that in networks that fail to generate grid firing fields network attractor states form, but their activity bumps are unable to track movement. In this scenario disrupted grid firing would reflect incorrect control of network activity by velocity signals. Alternatively, deficits in grid firing may reflect failure of network attractor states to emerge. To distinguish these possibilities we investigated formation of activity bumps in network space over the first 10 s following initialization of each network (<xref ref-type="fig" rid="fig4">Figure 4</xref>).<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.06444.010</object-id><label>Figure 4.</label><caption><title>Noise promotes formation of continuous attractors.</title><p>(<bold>A</bold>) Examples of snapshots of network activity of E cells from simulations in which velocity and place cell inputs are inactivated. Each row shows a simulation trial with a value of g<sub>E</sub> and g<sub>I</sub> highlighted by an arrow in panel (<bold>B</bold>). The corresponding probability of bump formation (P(bumps)) and the maximal firing rate is indicated to the left and right, respectively. (<bold>B</bold>) Color plots show probability of bump formation (P(bumps)), for the simulated range of g<sub>E</sub> and g<sub>I</sub> and the three simulated noise levels. Each color point is an average of five 10 s simulation runs. Arrows show positions in the parameter space of examples in (<bold>A</bold>). Black lines indicate the regions where the gridness score = 0.5 (cf. <xref ref-type="fig" rid="fig2">Figure 2D–F</xref>). (<bold>C</bold>) Relationship between gridness score computed from the grid field simulation runs (<xref ref-type="fig" rid="fig2">Figure 2D–F</xref>) and the probability of bump formation (<bold>B</bold>). (<bold>D</bold>) Relationship between gamma oscillation strength (<xref ref-type="fig" rid="fig3">Figure 3D–F</xref>) and the probability of bump formation (<bold>B</bold>). Each color in (<bold>C</bold> and <bold>D</bold>) represents one noise level and each dot in the scatter plots corresponds to simulations of a single pair of values of g<sub>E</sub> and g<sub>I</sub>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.010">http://dx.doi.org/10.7554/eLife.06444.010</ext-link></p></caption><graphic xlink:href="elife-06444-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.011</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Sensitivity of bump attractor spontaneous drift to variations in g<sub>E</sub> and g<sub>I</sub> and noise levels.</title><p>(<bold>A</bold>) Schematic of the bump attractor drift estimation procedure. The first 500 ms of a simulation trial are used to initialize the bump attractor. Onset of theta modulated input current was at 500 ms. The estimated centers of bump attractors measured by the least squares fit of symmetric Gaussians were at 1 s (initial position) and 9 s (final position). The drift was then estimated as the distance on twisted torus between the initial and final position. Simulation time was 10 s. (<bold>B</bold>) Color plots show bump attractor drifts averaged over five simulation trials, for the simulated ranges of excitatory and inhibitory synaptic strengths and levels of noise. Networks without noise can form stable bump attractors in a subset of their parameter region. Networks with noise suffer from attractor drift in majority of the parameter region. Black lines in (<bold>B</bold>) indicate the region from <xref ref-type="fig" rid="fig2">Figure 2D–F</xref> where gridness score = 0.5.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.011">http://dx.doi.org/10.7554/eLife.06444.011</ext-link></p></caption><graphic xlink:href="elife-06444-fig4-figsupp1-v2.tif"/></fig></fig-group></p><p>Our analysis suggests that the deficit in grid firing in deterministic compared to noisy networks reflects a failure of attractor states to emerge. For deterministic simulation of the points in parameter space considered in <xref ref-type="fig" rid="fig2">Figure 2Aa</xref>, which are able to generate grid patterns, we found that a single stable bump of activity emerged over the first 2.5 s of simulated time (<xref ref-type="fig" rid="fig4">Figure 4Aa</xref>). In contrast, for deterministic simulation of the point considered in 2Ab, which in deterministic simulations did not generate grid patterns, a single stable bump fails to emerge (<xref ref-type="fig" rid="fig4">Figure 4Ab</xref>). Quantification across the wider space of g<sub>E</sub> and g<sub>I</sub> values (see ‘Materials and methods’) indicated that when g<sub>I</sub> is low there is a high probability of bump formation as well as grid firing, whereas when g<sub>I</sub> is high the probability of both is reduced (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). In contrast to the deterministic condition, for circuits with intrinsically noisy neurons activity bumps emerged in the first 1.25 s following initialization of the network (<xref ref-type="fig" rid="fig4">Figure 4Ac–e</xref>) and the area of parameter space that supported bump formation was much larger than that supporting grid firing (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). Plotting gridness scores as a function of bump probability indicated that bump formation was necessary, although not sufficient for grid formation (<xref ref-type="fig" rid="fig4">Figure 4C</xref>), while plotting the first autocorrelation peak as a function of bump probability supported our conclusion that grid computation and gamma activity are not closely related (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). Together, these data indicate that noise promotes formation of attractor bumps in network activity and in deterministic simulations the failure of the circuit to generate attractor states largely accounts for disrupted grid firing.</p><p>In noisy networks the presence of low grid scores for networks with high bump scores (<xref ref-type="fig" rid="fig4">Figure 4C</xref>) is explained by sensitivity of these network configurations to noise-induced drift. This is illustrated by the region of parameter space from <xref ref-type="fig" rid="fig2">Figure 2Ab</xref>, where g<sub>I</sub> is relatively high and g<sub>E</sub> relatively low, and which in deterministic simulations fails to generate bumps or grids. With moderate noise, this point generates bumps that show little drift (<xref ref-type="fig" rid="fig4">Figure 4Ac</xref>), whereas as noise is increased further the bump begins to drift (<xref ref-type="fig" rid="fig4">Figure 4Ae</xref>). In contrast, at the point illustrated in <xref ref-type="fig" rid="fig2">Figure 2Aa</xref>, which forms grids and bumps in the presence or absence of noise, activity bumps are relatively stable in each condition (<xref ref-type="fig" rid="fig4">Figure 4Aa,d</xref>), although drift increases with greater noise (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Thus, intrinsic noise has two opposing effects on bump formation. For much of the parameter space we consider moderate noise promotes emergence of bumps and grids, while across all of parameter space noise reduces bump stability leading to deterioration of grids.</p><p>To investigate how addition of noise promotes emergence of network attractor states we investigated the dynamics of neurons in the simulated circuits. We focus initially on the point in parameter space identified in <xref ref-type="fig" rid="fig2">Figure 2Ab</xref>, where grids are found in the presence of moderate noise, and bumps are found when noise is moderate or high. When we examined times of action potentials generated by all neurons in this circuit, we find that in the absence of noise the network generates hyper-synchronous seizure-like states at the start of each theta cycle (<xref ref-type="fig" rid="fig5">Figure 5A</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A</xref>). The number of E cells active on each theta cycle differs, but their activity is typically restricted to the rising phase of theta, and there is no consistent structure in the pattern of activated neurons. The number of simultaneously active I cells is also greatest at the start of each theta cycle. The I-cells continue to fire over the theta cycle, but their synchronization declines. When moderate noise is added to the circuit only a subset of E-cells are active on each theta cycle, forming an activity bump (<xref ref-type="fig" rid="fig5">Figure 5B</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B</xref>). The I-cells are active at gamma frequency and the formation of an activity bump in the E-cell population is reflected by an inverted bump in the I-cell population activity (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). With increased noise there is a similar overall pattern of activity, but spike timing becomes more variable, causing the bumps to drift and reducing the degree of synchronization at gamma frequencies (<xref ref-type="fig" rid="fig5">Figure 5C</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1C</xref>).<fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.06444.017</object-id><label>Figure 5.</label><caption><title>Noise opposes generation of seizure-like states.</title><p>(<bold>A</bold>–<bold>C</bold>) Raster plots show activity of all neurons in the excitatory (red) and inhibitory (blue) populations for the duration of two theta cycles (top), along with the average population firing rates for both populations (center and bottom; calculated with a sliding rectangular window with 2 ms duration and 0.5 ms time step), for networks where noise is absent (<bold>A</bold>; σ = 0), with noise set to σ = 150 pA (<bold>B</bold>), and with noise set to σ = 300 pA (<bold>C</bold>). Simulations were performed in the absence of animal movement and place cell input; g<sub>E</sub> = 1 nS and g<sub>I</sub> = 3 nS. (<bold>D</bold>) Maximal average population firing rate of E cells estimated from the whole simulation run (10 s; 500 ms at the beginning of the simulation excluded) for each simulated level of noise. Each point is an average of maxima from five simulation runs. (<bold>E</bold>) Probability of the maximal population-average firing rate during each theta cycle exceeding 300 Hz, that is, at least 60% of E cells firing synchronously within a time period of 2 ms in the parameter space of g<sub>E</sub> and g<sub>I</sub> when σ = 0 pA. Black lines indicate regions where gridness score equals 0.5. (<bold>F</bold>) Scatter plots show the relationship between gridness score and the maximal firing rate during the simulation (left) and the probability of the maximal population-average firing rate during each theta cycle exceeding 300 Hz (right).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.017">http://dx.doi.org/10.7554/eLife.06444.017</ext-link></p></caption><graphic xlink:href="elife-06444-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.018</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Examples of activity in the network.</title><p>(<bold>A</bold>–<bold>C</bold>) Top: Mean maximal firing rate per theta cycle (average over five trials), outlining the average activity during theta cycles, in the parameter space of g<sub>E</sub> and g<sub>I</sub>. Center and bottom: Raster plots (center) and population-average firing rates (bottom) of all cells in selected locations of the E-I parameter space during 16 consecutive θ cycles. Action potentials and firing rates of E and I cells are colored red and blue, respectively. An arrow highlights the position in the parameter space.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.018">http://dx.doi.org/10.7554/eLife.06444.018</ext-link></p></caption><graphic xlink:href="elife-06444-fig5-figsupp1-v2.tif"/></fig></fig-group></p><p>To determine whether these changes in network dynamics are seen across wider regions of parameter space we first quantified the presence of seizure like events from the maximum population firing rate in any 2 ms window over 10 s of simulation time (E-rate<sub>max</sub>). Strikingly, we found that in the absence of noise epochs with highly synchronized activity were found for almost all combinations of g<sub>E</sub> and g<sub>I</sub>, whereas these seizure-like events were absent in simulations where noise was present (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). Interestingly, while grids emerge in deterministic networks in regions of E-I space where E-rate<sub>max</sub> is relatively low, there is a substantial region of parameter space in which E-rate<sub>max</sub> is &gt;400 Hz, but grids are nevertheless formed. It is possible that seizure-like states may be rare in this region of parameter space and so do not interfere sufficiently with attractor dynamics to prevent grid firing. To test this we calculated for each combination of g<sub>E</sub> and g<sub>I</sub> the proportion of theta cycles having events with population-average rate &gt;300 Hz (P<sub>E-rate</sub> &gt; 300). For values of g<sub>E</sub> and g<sub>I</sub> where grid fields are present P<sub>E-rate</sub> &gt; 300 was relatively low, indicating that seizure-like events are indeed rare (<xref ref-type="fig" rid="fig5">Figure 5E</xref>). Consistent with this, when we plotted grid score as a function of P<sub>E-rate</sub> &gt; 300, we found that P<sub>E-rate</sub> &gt; 300 was relatively informative about the gridness score in networks without noise (MIC = 0.624) and a low value of P<sub>E-rate</sub> &gt; 300 was necessary for grid firing (<xref ref-type="fig" rid="fig5">Figure 5F</xref>). In contrast, E-rate<sub>max</sub> was less informative of grid firing (0.392 ≤ MIC ≤0.532) and a wide range of values were consistent with grid firing (<xref ref-type="fig" rid="fig5">Figure 5F</xref>). Thus, while grid firing is compatible with occasional seizure-like events, when seizure-like events occur on the majority of theta cycles then grid firing is prevented.</p><p>Because seizure-like events tend to initiate early on the depolarizing phase of each theta cycle, we asked if synchronization by theta frequency drive plays a role in their initiation. When theta frequency input was replaced with a constant input with the same mean amplitude, the power of gamma oscillations was still dependent on the levels of noise and changes in g<sub>E</sub> and g<sub>I</sub> (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). However, in contrast to simulations with theta frequency input (<xref ref-type="fig" rid="fig5">Figure 5D,E</xref>), noise-free networks without theta exhibited hyper-synchronous firing only when g<sub>E</sub> was &lt;0.5 nS (<xref ref-type="fig" rid="fig6">Figure 6A</xref>) and generated grid firing fields almost in the complete range of g<sub>E</sub> and g<sub>I</sub> (<xref ref-type="fig" rid="fig6">Figure 6D,G</xref>). Addition of noise in the absence of theta had mostly detrimental effects on grid firing (<xref ref-type="fig" rid="fig6">Figure 6E,F,H,I</xref> and <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). Interestingly, with intermediate levels of noise, the subregion with high gridness scores (&gt;0.5) retained its crescent-like shape (<xref ref-type="fig" rid="fig6">Figure 6E,H</xref>), but was smaller when compared to the networks with theta frequency inputs (size of regions with and without theta: 488/961 vs 438/961), while the range of gamma frequencies present was much lower than in networks containing theta drive. Together, these data indicate that moderate noise prevents emergence of seizure like states by disrupting synchronization of the attractor network by the shared theta frequency drive. In networks with moderate noise theta drive promotes grid firing and enables a wide range of gamma frequencies to be generated without disrupting grid firing.<fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.06444.019</object-id><label>Figure 6.</label><caption><title>Seizure-like states and grid firing fields in networks without theta frequency inputs.</title><p>(<bold>A</bold>–<bold>C</bold>) Maximal average population firing rate of E cells estimated from the whole simulation run (10 s; 500 ms at the beginning of the simulation excluded) for each simulated level of noise indicated by σ, in networks with theta frequency inputs replaced with a constant input with the same mean amplitude. Each point is an average of maxima from five simulation trials. Black lines indicate the regions from (<bold>G</bold>–<bold>H</bold>) where gridness score = 0.5. (<bold>D</bold>–<bold>F</bold>) Example spatial firing fields (left) and autocorrelation plots (right) for the specific values of g<sub>E</sub> and g<sub>I</sub> indicated by arrows in (<bold>G</bold>–<bold>I</bold>), corresponding to the three simulated noise levels. Maximal firing rate is indicated at the top right of each spatial firing plot. The range of spatial autocorrelations is normalized between 0 and 1. (<bold>G</bold>–<bold>I</bold>) Gridness score as a function of g<sub>E</sub> and g<sub>I</sub>, for each simulated level of noise. Each item in the color plot is an average gridness score of three simulation runs of 600 s duration. Arrows indicate the positions of grid field and autocorrelation examples from simulations illustrated in (<bold>D</bold>–<bold>F</bold>). Simulations that did not finish in a specified time interval (5 hr) are indicated by white color.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.019">http://dx.doi.org/10.7554/eLife.06444.019</ext-link></p></caption><graphic xlink:href="elife-06444-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.020</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Effect of replacing theta frequency inputs by a constant input with an equal mean amplitude.</title><p>(<bold>A</bold>–<bold>C</bold>) Amplitude (top) and frequency (bottom) of detected gamma oscillations (‘Materials and methods’) in deterministic networks (<bold>A</bold>), networks with an intermediate level of noise (<bold>B</bold>) and in networks with the highest simulated level of noise (<bold>C</bold>). Each point is an average of five simulation runs. Data are from the same simulation set. White color indicates simulation runs in which no autocorrelation peaks were detected (cf. ‘Materials and methods’).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.020">http://dx.doi.org/10.7554/eLife.06444.020</ext-link></p></caption><graphic xlink:href="elife-06444-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.021</object-id><label>Figure 6—figure supplement 2.</label><caption><title>Effect of noise on gridness scores in networks without theta frequency inputs.</title><p>The plot shows a difference between gridness scores of networks with σ = 150 pA and networks with σ = 0 pA plotted as a function of g<sub>E</sub> and g<sub>I</sub> when theta inputs were replaced with a constant input with an equal mean amplitude.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.021">http://dx.doi.org/10.7554/eLife.06444.021</ext-link></p></caption><graphic xlink:href="elife-06444-fig6-figsupp2-v2.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.022</object-id><label>Figure 6—figure supplement 3.</label><caption><title>Firing rates of E cells.</title><p>(<bold>A</bold>) Average firing rate of all E cells during simulations of animal movement as a function of g<sub>E</sub> and g<sub>I</sub>. Black lines outline the region from <xref ref-type="fig" rid="fig2">Figure 2D–F</xref> where gridness score = 0.5. (<bold>B</bold>) Relationship between gridness score and firing frequency of E cells.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.022">http://dx.doi.org/10.7554/eLife.06444.022</ext-link></p></caption><graphic xlink:href="elife-06444-fig6-figsupp3-v2.tif"/></fig><fig id="fig6s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.023</object-id><label>Figure 6—figure supplement 4.</label><caption><title>Calibration of the gain of the velocity inputs.</title><p>(<bold>A</bold>–<bold>C</bold>) Bump attractor speed as a function of the strength of the velocity current for the three simulated levels of noise. 10 simulation runs were performed for each level of noise (blue markers). In each run the speed of the bump was calculated in response to the injected velocity input and the data were used to fit a linear relationship using an estimation procedure outlined in <xref ref-type="app" rid="app1">Appendix 1</xref> (black line). (<bold>D</bold>–<bold>F</bold>) Slope of the estimated velocity gain of the attractor networks as a function of g<sub>E</sub> and g<sub>I</sub> for all simulated levels of noise. (<bold>G</bold>–<bold>I</bold>) Same as in (<bold>D</bold>–<bold>F</bold>) but the plots show error of fit for the estimated linear relationships. Arrows show locations of the data plotted in (<bold>A</bold>–<bold>C</bold>). Black lines in (<bold>D</bold>–<bold>I</bold>) indicate the region from <xref ref-type="fig" rid="fig2">Figure 2D–F</xref> where gridness score = 0.5.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.023">http://dx.doi.org/10.7554/eLife.06444.023</ext-link></p></caption><graphic xlink:href="elife-06444-fig6-figsupp4-v2.tif"/></fig><fig id="fig6s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.024</object-id><label>Figure 6—figure supplement 5.</label><caption><title>Effectivity of the place cell resetting mechanism as a function of g<sub>E</sub> and g<sub>I</sub> and noise levels.</title><p>(<bold>A</bold>) Illustration of the procedure to estimate the difference between the bump position induced by place cells and actual estimated position of the bump state, by using a sliding window with 250 ms duration and 125 ms time step. The resulting distance from the reset position, in one simulation run, was then an average over all sliding windows. (<bold>B</bold>) Color plots show the effectivity of place cell mechanism for an average of five simulation runs with 10 s duration. Place cells are most effective in networks with an intermediate amount of noise. Black lines in (<bold>B</bold>) indicate the region from <xref ref-type="fig" rid="fig2">Figure 2D–F</xref> where gridness score = 0.5.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.024">http://dx.doi.org/10.7554/eLife.06444.024</ext-link></p></caption><graphic xlink:href="elife-06444-fig6-figsupp5-v2.tif"/></fig></fig-group></p><p>Our analysis points towards suppression of seizure-like events as the mechanism by which moderate noise promotes grid firing, while interactions between noise and theta appear important for the capacity to multiplex grid firing with a wide range of gamma frequencies. However, we wanted to know if other factors might contribute to these beneficial roles of noise. Grid fields may also fail to form if overall activity levels are too low, in which case neurons with grid fields instead encode head direction (<xref ref-type="bibr" rid="bib3">Bonnevie et al., 2013</xref>). This observation is unlikely to explain our results as the mean firing rate of E cells in networks that generated grid firing fields (grid score &gt;0.5, networks with g<sub>E</sub> or g<sub>I</sub> set to 0 excluded) was in fact lower than the firing rate of networks without grid fields (1.2; 1.0; 1.0 Hz grid fields vs 3.0; 2.7; 1.2 Hz no grid fields, in networks with σ = 0; 150; 300 pA respectively). There was also no systematic relationship between grid score and firing frequency (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>). We also wanted to know if other properties of grid fields vary as a function of g<sub>E</sub> and g<sub>I</sub>. Parameters used to calibrate velocity integration by the grid network varied very little with changes in g<sub>E</sub> and g<sub>I</sub> (<xref ref-type="fig" rid="fig6s4">Figure 6—figure supplement 4</xref>), whereas drift increased with g<sub>I</sub> (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) and place cell input was most effective in opposing attractor drift in noisy networks with high gridness scores (<xref ref-type="fig" rid="fig6s5">Figure 6—figure supplement 5</xref>). These data are consistent with suppression of seizure like events as the mechanism by which noise promotes grid firing, while interactions between noise and theta frequency inputs profoundly influence the dynamics of attractor networks that generate grid fields.</p></sec><sec id="s2-4"><title>Recurrent inhibition increases the frequency of gamma activity and promotes grid firing</title><p>Our analysis so far focuses on E-I attractor networks as simple models of grid firing that are compatible with the finding that synaptic interactions between stellate cells in layer 2 of the MEC are mediated via inhibitory interneurons (<xref ref-type="bibr" rid="bib10">Dhillon and Jones, 2000</xref>; <xref ref-type="bibr" rid="bib8">Couey et al., 2013</xref>; <xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). However, there is evidence that interneurons active during theta-nested gamma activity make connections to one another as well as to stellate cells (<xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). To establish whether this recurrent inhibition substantially modifies our conclusions from simpler E-I networks, we extended the E-I model to also include synapses between interneurons (see ‘Materials and methods’). In the resulting E-I-I networks, in the absence of noise, grid firing emerges across a much larger region of parameter space compared to E-I networks (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, <xref ref-type="fig" rid="fig7s1 fig7s2 fig7s3 fig7s4">Figure 7—figure supplements 1–4</xref>). However, as in E-I networks occasional seizure like activity was present across a wide range of g<sub>E</sub> and g<sub>I</sub> (<xref ref-type="fig" rid="fig7s5">Figure 7—figure supplement 5</xref>), and gamma frequency activity was largely absent (<xref ref-type="fig" rid="fig7">Figure 7D,G</xref>). Following addition of noise with standard deviation of 150 pA to E-I-I networks, grid firing was maintained, seizure like activity was abolished, and gamma like activity emerged (<xref ref-type="fig" rid="fig7">Figure 7B,E,H</xref> and <xref ref-type="fig" rid="fig7s5">Figure 7—figure supplement 5</xref>). Increasing the noise amplitude to 300 pA reduced grid firing and interfered with the emergence of gamma oscillations (<xref ref-type="fig" rid="fig7">Figure 7C,F,I</xref> and <xref ref-type="fig" rid="fig7s1 fig7s2 fig7s3 fig7s4 fig7s5">Figure 7—figure supplements 1–5</xref>). Importantly, just as in E-I networks, the presence of moderate noise in E-I-I networks enables tuning of gamma activity by varying g<sub>E</sub> and g<sub>I</sub> while maintaining the ability of the networks to generate grid firing fields. Gamma activity had a higher frequency in E-I-I compared to E-I networks, with a greater proportion of the parameter space supporting gamma frequencies &gt;80 Hz. This higher frequency gamma is similar to fast gamma observed experimentally in the MEC (cf. <xref ref-type="bibr" rid="bib6">Chrobak and Buzsáki, 1998</xref>; <xref ref-type="bibr" rid="bib7">Colgin et al., 2009</xref>; <xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). Thus, by including additional features of local circuits in layer 2 of the MEC, E-I-I models may more closely recapitulate experimental observations. Nevertheless, E-I-I networks maintain the ability, in the presence of moderate noise, for variation in g<sub>E</sub> and g<sub>I</sub> to tune gamma oscillations without interfering with grid firing.<fig-group><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.06444.025</object-id><label>Figure 7.</label><caption><title>Gridness scores and gamma activity in networks with recurrent inhibition.</title><p>(<bold>A</bold>–<bold>C</bold>) Gridness score as a function of g<sub>E</sub> and g<sub>I</sub> for networks without noise (<bold>A</bold>; σ = 0 pA), with noise level set to σ = 150 pA (<bold>B</bold>), and noise level set to σ = 300 pA (<bold>C</bold>). Simulations that did not finish in a specified time interval (5 hr) are indicated by white color. (<bold>D</bold>–<bold>F</bold>) Examples of inhibitory (red) and excitatory (blue) synaptic currents recorded respectively from excitatory and inhibitory neurons from simulations highlighted by arrows in panels (<bold>G</bold>–<bold>I</bold>). (<bold>G</bold>–<bold>I</bold>) Top: Correlation value at the first local maximum of an autocorrelation of inhibitory synaptic currents (I → E cells, 25 randomly selected E cells), plotted as a function of g<sub>E</sub> and g<sub>I</sub>, for networks without noise (<bold>G</bold>), with noise level set to σ = 150 pA (<bold>H</bold>), and noise level set to σ = 300 pA (<bold>I</bold>). Each point is an average over five simulation trials. In these simulations velocity and place cell inputs were disabled. The duration of simulations was 10 s. Bottom: Frequency corresponding to the peaks of the autocorrelation functions for simulations in the top panels. Black lines in (<bold>H</bold>) indicate the regions from (<bold>B</bold>) where gridness score = 0.5.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.025">http://dx.doi.org/10.7554/eLife.06444.025</ext-link></p></caption><graphic xlink:href="elife-06444-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.026</object-id><label>Figure 7—figure supplement 1.</label><caption><title>Spatial firing fields in networks that contain recurrent I → I synapses.</title><p>(<bold>A</bold>–<bold>C</bold>) Example spatial firing fields (left) and spatial autocorrelation plots (right) for networks with g<sub>E</sub> = 3 nS and g<sub>I</sub> = 1 nS (<bold>A</bold>) and networks with g<sub>E</sub> = 1 nS and g<sub>I</sub> = 3 nS (<bold>B</bold>), corresponding to the three simulated noise levels indicated by σ. Maximal firing rate is indicated to the top right of each spatial firing plot. Range of spatial autocorrelations is normalized between 0 and 1.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.026">http://dx.doi.org/10.7554/eLife.06444.026</ext-link></p></caption><graphic xlink:href="elife-06444-fig7-figsupp1-v2.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.027</object-id><label>Figure 7—figure supplement 2.</label><caption><title>Continuous attractors in networks that contain direct I → I synapses.</title><p>(<bold>A</bold>) Examples of E cell population firing rate snapshots from simulations in which velocity and place cell inputs are inactivated. Each row shows a simulation trial with a value of g<sub>E</sub> and g<sub>I</sub> highlighted by an arrow in panel (<bold>B</bold>). The corresponding probability of bump formation (P(bumps)) is indicated to the left. Maximal firing rate for each set of snapshots is indicated to the right. (<bold>B</bold>) Color plots show probability of bump formation (P(bumps)), for the simulated range of g<sub>E</sub> and g<sub>I</sub> and the three simulated noise levels. Each color point is an average of five 10 s simulation runs. Black lines in (<bold>B</bold>) indicate the region from <xref ref-type="fig" rid="fig7">Figure 7A–C</xref> where gridness score = 0.5.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.027">http://dx.doi.org/10.7554/eLife.06444.027</ext-link></p></caption><graphic xlink:href="elife-06444-fig7-figsupp2-v2.tif"/></fig><fig id="fig7s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.028</object-id><label>Figure 7—figure supplement 3.</label><caption><title>Sensitivity of bump attractor spontaneous drift to variations in g<sub>E</sub>, g<sub>I</sub> and noise levels in networks that contain direct I → I synapses.</title><p>(<bold>A</bold>) Schematic of the bump attractor drift estimation procedure. The first 500 ms of a simulation trial are used to initialize the bump attractor. Onset of theta modulated input current was at 500 ms. The estimated centers of bump attractors measured by the least squares fit of symmetric Gaussians were at 1 s (initial position) and 9 s (final position). The drift was then estimated as the distance on twisted torus between the initial and final position. Simulation time was 10 s. (<bold>B</bold>) Color plots show bump attractor drifts averaged over five simulation trials, for the simulated ranges of excitatory and inhibitory synaptic strengths and levels of noise. Networks without noise can form stable bump attractors in a subset of their parameter region. Networks with noise suffer from attractor drift in the majority of the parameter region. Black lines in (<bold>B</bold>) indicate the region from <xref ref-type="fig" rid="fig7">Figure 7A–C</xref> where gridness score = 0.5.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.028">http://dx.doi.org/10.7554/eLife.06444.028</ext-link></p></caption><graphic xlink:href="elife-06444-fig7-figsupp3-v2.tif"/></fig><fig id="fig7s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.029</object-id><label>Figure 7—figure supplement 4.</label><caption><title>Calibration of the gain of the velocity inputs in networks that contain direct I → I synapses.</title><p>(<bold>A</bold>–<bold>C</bold>) Bump attractor speed as a function of the strength of the velocity current for the three simulated levels of noise indicated by σ. Values of g<sub>E</sub> and g<sub>I</sub> are indicated by arrows in (<bold>D</bold>–<bold>I</bold>). 10 simulation runs were performed for each level of noise (blue markers). In each run the speed of the bump was calculated in response to the injected velocity input and the data were used to fit a linear relationship using an estimation procedure outlined in <xref ref-type="app" rid="app1">Appendix 1</xref> (black line). (<bold>D</bold>–<bold>F</bold>) Slope of the estimated velocity gain of the attractor networks as a function of g<sub>E</sub> and g<sub>I</sub> for all simulated levels of noise. (<bold>G</bold>–<bold>I</bold>) Same as in (<bold>D</bold>–<bold>F</bold>) but the plots show error of fit for the estimated linear relationships. Arrows in (<bold>D</bold>–<bold>I</bold>) show locations of the data plotted in (<bold>A</bold>–<bold>C</bold>). Black lines in (<bold>D</bold>–<bold>I</bold>) indicate the region from <xref ref-type="fig" rid="fig7">Figure 7A–C</xref> where gridness score = 0.5.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.029">http://dx.doi.org/10.7554/eLife.06444.029</ext-link></p></caption><graphic xlink:href="elife-06444-fig7-figsupp4-v2.tif"/></fig><fig id="fig7s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.030</object-id><label>Figure 7—figure supplement 5.</label><caption><title>Seizure-like states in networks that contain direct I → I synapses.</title><p>(<bold>A</bold>–<bold>C</bold>) Raster plots show activity of all neurons in the excitatory (red) and inhibitory (blue) populations for the duration of two theta cycles (top), along with the average population firing rates for both populations (center and bottom; calculated with a sliding rectangular window with 2 ms duration and 0.5 ms time step), for networks where noise is absent (<bold>A</bold>; σ = 0), with noise set to σ = 150 pA (<bold>B</bold>), and with noise set to σ = 300 pA (<bold>C</bold>). Simulations were performed in the absence of animal movement and place cell input; g<sub>E</sub> = 1 nS and g<sub>I</sub> = 3 nS. (<bold>D</bold>) Maximal average population firing rate of E cells estimated from the whole simulation run (10 s; 500 ms at the beginning of the simulation excluded) for each simulated level of noise. Each point is an average of maxima from five simulation runs. (<bold>E</bold>) Probability of the maximal population-average firing rate during each theta cycle exceeding 300 Hz, that is, at least 60% of E cells firing synchronously within a time period of 2 ms, in the parameter space of g<sub>E</sub> and g<sub>I</sub> when σ = 0 pA. Black lines indicate the regions from <xref ref-type="fig" rid="fig7">Figure 7A–C</xref> where gridness score equals 0.5. (<bold>F</bold>) Scatter plots show the relationship between gridness score and the maximal firing rate during the simulation (left) and the probability of the maximal population-average firing rate during each theta cycle exceeding 300 Hz (right).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.030">http://dx.doi.org/10.7554/eLife.06444.030</ext-link></p></caption><graphic xlink:href="elife-06444-fig7-figsupp5-v2.tif"/></fig><fig id="fig7s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.031</object-id><label>Figure 7—figure supplement 6.</label><caption><title>Sensitivity of grid firing to changes in inhibition and excitation in networks that contain direct E → E synapses.</title><p>(<bold>A</bold>–<bold>C</bold>) Example firing fields (left) and spatial autocorrelation plots (right) for the strengths of recurrent synaptic connections indicated by arrows in (<bold>D</bold>–<bold>F</bold>) for networks without noise (<bold>A</bold>; σ = 0 pA), with noise set to σ = 150 pA (<bold>B</bold>), and noise set to σ = 300 pA (<bold>C</bold>). (<bold>D</bold>–<bold>F</bold>) Gridness score as a function of g<sub>E</sub> and g<sub>I</sub> for networks with each noise level. Each item in the color plot is an average gridness score of two simulation runs. Arrows indicate the positions of grid field and autocorrelation examples from simulations illustrated in (<bold>A</bold>–<bold>C</bold>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.031">http://dx.doi.org/10.7554/eLife.06444.031</ext-link></p></caption><graphic xlink:href="elife-06444-fig7-figsupp6-v2.tif"/></fig><fig id="fig7s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.032</object-id><label>Figure 7—figure supplement 7.</label><caption><title>Sensitivity of gamma oscillations to changes in inhibition and excitation in networks that contain direct E → E synapses.</title><p>(<bold>A</bold>–<bold>C</bold>) Examples of inhibitory (red) and excitatory (blue) synaptic currents recorded respectively from excitatory and inhibitory neurons from simulations highlighted by arrows in panels (<bold>D</bold>–<bold>F</bold>). (<bold>D</bold>–<bold>F</bold>) Top: Correlation value at the first local maximum of an autocorrelation of inhibitory synaptic currents (I → E cells, 25 randomly selected E cells), plotted as a function of g<sub>E</sub> and g<sub>I</sub>, for networks without noise (<bold>D</bold>), with noise set to σ = 150 pA (<bold>E</bold>), and noise set to σ = 300 pA (<bold>F</bold>). Each point is an average over five simulation trials. In these simulations velocity and place cell inputs were disabled. The duration of simulations was 10 s. Bottom: Frequency corresponding to the peaks of the autocorrelation functions for simulations in the top panels. Black lines in (<bold>E</bold>) indicate the region from <xref ref-type="fig" rid="fig7s6">Figure 7—figure supplement 6</xref> where the gridness score = 0.5.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.032">http://dx.doi.org/10.7554/eLife.06444.032</ext-link></p></caption><graphic xlink:href="elife-06444-fig7-figsupp7-v2.tif"/></fig><fig id="fig7s8" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.033</object-id><label>Figure 7—figure supplement 8.</label><caption><title>Continuous attractors in networks that contain direct E → E synapses.</title><p>(<bold>A</bold>) Examples of E cell population firing rate snapshots from simulations in which velocity and place cell inputs are inactivated. Each row shows a simulation trial with a value of g<sub>E</sub> and g<sub>I</sub> highlighted by an arrow in panel (<bold>B</bold>). The corresponding probability of bump formation (P(bumps)) is indicated to the left. Maximal firing rate for each row is indicated to the right. (<bold>B</bold>) Color plots show probability of bump formation (P(bumps)), for the simulated range of g<sub>E</sub> and g<sub>I</sub> and the three simulated noise levels indicated by σ. Each color point is an average of five 10 s simulation runs. Arrows show positions in the parameter space of examples in (<bold>A</bold>). Black lines indicate the region from <xref ref-type="fig" rid="fig7s6">Figure 7—figure supplement 6</xref> where the gridness score = 0.5.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.033">http://dx.doi.org/10.7554/eLife.06444.033</ext-link></p></caption><graphic xlink:href="elife-06444-fig7-figsupp8-v2.tif"/></fig><fig id="fig7s9" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.034</object-id><label>Figure 7—figure supplement 9.</label><caption><title>Seizure-like states in networks that contain direct E → E synapses.</title><p>(<bold>A</bold>–<bold>C</bold>) Raster plots show activity of all neurons in the excitatory (red) and inhibitory (blue) populations for the duration of two theta cycles (top), along with the average population firing rates for both populations (center and bottom; calculated with a sliding rectangular window with 2 ms duration and 0.5 ms time step), for networks where noise is absent (<bold>A</bold>; σ = 0), with noise set to σ = 150 pA (<bold>B</bold>), and with noise set to σ = 300 pA (<bold>C</bold>). Simulations were performed in the absence of animal movement and place cell input; g<sub>E</sub> = 1 nS and g<sub>I</sub> = 3 nS. (<bold>D</bold>) Maximal average population firing rate of E cells estimated from the whole simulation run (10 s; 500 ms at the beginning of the simulation excluded) for each simulated level of noise. Each point is an average of maxima from five simulation runs. (<bold>E</bold>) Probability of the maximal population-average firing rate during each theta cycle exceeding 300 Hz, that is, at least 60% of E cells firing synchronously within a time period of 2 ms in the parameter space of g<sub>E</sub> and g<sub>I</sub> when σ = 0 pA. (<bold>F</bold>) Scatter plots show the relationship between gridness score and the maximal firing rate during the simulation (left) and the probability of the maximal population-average firing rate during each theta cycle exceeding 300 Hz (right). Black lines in (<bold>D</bold> and <bold>E</bold>) indicate the region from <xref ref-type="fig" rid="fig7s6">Figure 7—figure supplement 6</xref> where the gridness score = 0.5.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.034">http://dx.doi.org/10.7554/eLife.06444.034</ext-link></p></caption><graphic xlink:href="elife-06444-fig7-figsupp9-v2.tif"/></fig><fig id="fig7s10" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06444.035</object-id><label>Figure 7—figure supplement 10.</label><caption><title>Probability of bump formation and network activity plots in networks with structured E → E and unstructured E → I and I → E connections.</title><p>Since the presence of bump attractors is necessary for grid computation, we tested whether networks with only structured E-E connections can generate activity bumps. We used the Gaussian fitting procedure (cf. ‘Materials and methods’) to estimate the presence of bump attractors in these networks. (<bold>A</bold>) Probability of bump formation as a function of the E-E synaptic scaling factor (g<sub>E → E</sub>) and the width of the synaptic profile (σ<sub>E → E</sub>). Arrow highlights the position in the parameter space corresponding to the raster plots (center) and network activity snapshots (bottom) for E and I cells. Firing rate in the network activity color plots are in the range of 0 (dark blue) to the maximum firing rate indicated to the right of the plot (dark red). In these networks g<sub>E</sub> = 1 nS and g<sub>I</sub> = 0.1 nS. (<bold>B</bold>) Same as (<bold>A</bold>) but g<sub>E</sub> = 3 nS and g<sub>I</sub> = 1 nS. (<bold>C</bold>) Same as (<bold>A</bold>) and (<bold>B</bold>) but in these simulations the synaptic scaling factor of E-E connections and the width of the synaptic profile were fixed (g<sub>E → E</sub> = 3 nS and σ<sub>E → E</sub> = 0.0833) and g<sub>E</sub> and g<sub>I</sub> varied in the range of 0–6 nS. Simulations that produced excessive spiking activity and did not finish in a specified time limit (3 hr) are indicated by white color. Many networks suffer from runaway excitation and inhibition (<bold>A</bold>) or generate only background synaptic activity characterized by low firing rates of E and I cells (<bold>B</bold> and <bold>C</bold>). The Gaussian fitting procedure used to estimate the probability of bump formation can nevertheless yield a high bump score due to the fact that this procedure can also give a high score to intermittent pockets of activity (<bold>A</bold>) or pockets of background activity of E cells (<bold>B</bold> and <bold>C</bold>). This activity, however, is not stable enough to generate grid firing fields.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.035">http://dx.doi.org/10.7554/eLife.06444.035</ext-link></p></caption><graphic xlink:href="elife-06444-fig7-figsupp10-v2.tif"/></fig></fig-group></p><p>Finally, we asked if addition of synaptic connections between excitatory cells modifies the relationship between gamma, noise, g<sub>E</sub> and g<sub>I</sub>. While the E-I model is consistent with the connectivity between stellate cells in layer 2 of the MEC, adjacent pyramidal cells may also have grid firing properties. Unlike stellate cells, pyramidal cells interact with one another directly via excitatory connections and indirectly via inhibitory interneurons (<xref ref-type="bibr" rid="bib8">Couey et al., 2013</xref>). To assess the impact of E-E connections, we first extended the E-I model to allow each E cell to excite other E cells that are nearby in neuron space. The dependence of grid firing, gamma oscillations, and bump formation on noise, g<sub>E</sub> and g<sub>I</sub> was similar to E-I networks (<xref ref-type="fig" rid="fig7s6 fig7s7 fig7s8 fig7s9">Figure 7—figure supplements 6–9</xref>). We also attempted to evaluate networks in which E-E connections were structured, but E-I and I-E connections were uniformly distributed. However, in these networks we were unable to identify parameters that support formation of stable activity bumps (<xref ref-type="fig" rid="fig7s10">Figure 7—figure supplement 10</xref>). This is consistent with instability of simpler network attractors based on E-E connections (<xref ref-type="bibr" rid="bib35">Seung et al., 2000</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We investigated the relationship between rate coded spatial computations and nested gamma oscillations in attractor network models of grid firing. While in the models we consider rate coding and gamma oscillations share the same neural substrate, that is projections from a population of E cells to an I cell population, which in turn projects back to the E cell population, we find that their sensitivity to variations in excitatory and inhibitory synaptic strengths nevertheless differs. A moderate level of noise promotes generation of both grid fields and nested gamma oscillations, primarily by the disruption of epileptic-like firing of E and I cells in the network. When the strength of E or I connections is varied in the presence of moderate noise a wide range of gamma frequency and power can be obtained without affected grid firing. Thus, noise can be beneficial for computations performed by the nervous system, while the frequency and power of multiplexed gamma oscillations can be tuned independently of rate-coded grid computations, suggesting a mechanism for differential control of multiplexed neural codes.</p><p>Our results suggest a novel beneficial role for noise. In general noise in the nervous system is believed to distort the fidelity of transmitted signals (<xref ref-type="bibr" rid="bib13">Faisal et al., 2008</xref>). Exceptions are stochastic resonance phenomena in which noise promotes detection of small amplitude signals by individual neurons (<xref ref-type="bibr" rid="bib24">Longtin et al., 1991</xref>; <xref ref-type="bibr" rid="bib2">Benzi et al., 1999</xref>; <xref ref-type="bibr" rid="bib37">Shu et al., 2003</xref>), improvements in signal coding through desynchronization of neuronal populations (<xref ref-type="bibr" rid="bib21">Hunsberger et al., 2014</xref>) and emergence of stochastic weak synchronization in interneuron networks (<xref ref-type="bibr" rid="bib43">Tiesinga and Jose, 2000</xref>). The beneficial role for noise that we identify here differs from these phenomena in that it emerges through interactions between populations of neurons and because the grid cell attractor network performs a computation—generation of a spatial code from velocity inputs—rather than propagating input signals. We find that by opposing emergence of hyper-sychronous seizure-like states noise allows the network to generate stable bump attractor states. Noise prevents the seizure-like states by desynchronizing neuronal responses to common theta input. We were able to identify this role for noise because spiking and synaptic dynamics are explicitly represented in the simulated network. These dynamics are absent from other attractor network models of grid firing (<xref ref-type="bibr" rid="bib16">Fuhs and Touretzky, 2006</xref>; <xref ref-type="bibr" rid="bib19">Guanella et al., 2007</xref>; <xref ref-type="bibr" rid="bib5">Burak and Fiete, 2009</xref>). They are also absent from other models of theta-nested gamma oscillations that simulate two-dimensional dynamical systems of E and I populations with theta modulated inputs to the network (<xref ref-type="bibr" rid="bib29">Onslow et al., 2014</xref>). Thus, intrinsic cellular and synaptic dynamics in conjunction with noise sources may be important in accounting for computations and oscillatory activity in neural networks.</p><p>The distinct control of rate coded grid computations and gamma oscillations by noise, g<sub>E</sub> and g<sub>I</sub> was independent of the detailed implementation of the E-I models we considered and was maintained in more complex models incorporating I-I and E-E coupling. Current available experimental data appears to be insufficient to distinguish between these different models. For example, our analysis of interneuron firing indicates that while E-I models predict that interneurons will have spatial firing fields, they have lower spatial information content, spatial sparsity and grid scores than E cells and therefore may be difficult to detect in existing experimental datasets and with current analysis tools. Thus, evidence previously interpreted to argue against E-I based mechanisms for grid firing may in fact not distinguish these from other possible mechanisms. Indeed, we found that grid firing by E cells can be maintained during spatial input that distorts the spatial firing pattern of I cells (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). While these simulations establish in principle that E-I based attractor networks can generate grid outputs even when spatial firing of many E and I cells in the network is not clearly grid-like, the extent to which these networks can account for additional details of experimental observations, for example weak periodic patterns in the spatial autocorrelation of the firing fields of some PV interneurons (cf. <xref ref-type="bibr" rid="bib4">Buetfering et al., 2014</xref>, <xref ref-type="fig" rid="fig4">Figure 4a</xref>), is not yet clear. Our results are consistent with local synaptic connections, in addition to those between E cells and I cells, having important functional roles. For example addition of synapses between interneurons to E-I networks causes an overall increase in the frequency of gamma activity and in the stability of grid firing. Nevertheless, we find that in these modified networks moderate noise still enables variation in g<sub>E</sub> and g<sub>I</sub> to tune gamma oscillations independently from grid firing.</p><p>An intriguing aspect of our results is that they suggest novel approaches to suppressing seizures and to promoting normal cognitive function. Seizures have previously been suggested to result from deficits in inhibition or from alterations in intrinsic excitability of neurons (<xref ref-type="bibr" rid="bib22">Lerche et al., 2001</xref>; <xref ref-type="bibr" rid="bib44">Treiman, 2001</xref>). We show that seizures can be induced when these properties are held constant simply by reducing levels of noise within a circuit. A future experimental challenge for dissecting the contribution of intrinsic noise to seizures will be to target biological noise sources. In the brain noise arises from ion channel gating and from background synaptic activity. It is therefore difficult to manipulate noise sources without also affecting intrinsic excitability or excitation-inhibition balance. However, it may be feasible to add noise to circuits through transcranial magnetic stimulation (<xref ref-type="bibr" rid="bib32">Ruzzoli et al., 2010</xref>). In this case our simulations predict that addition of noise may restore epileptic circuits to normal activity. This mechanism may explain why focal electrical stimulation of the entorhinal cortex in patients with seizures leads to an enhancement of memory performance (<xref ref-type="bibr" rid="bib42">Suthana et al., 2012</xref>).</p><p>While correlations between gamma oscillations and various cognitive and pathological brain states are well established, the proposed computational roles of gamma oscillations have been difficult to reconcile with rate-coded representations with which they co-exist. We were able to address this issue directly by analyzing a circuit in which gamma oscillations and rate-coded computations arise from a shared mechanism. Rather than gamma serving as an index of rate-coded computation, we find instead that there is a substantial parameter space across which rate-coded computation is stable, while the amplitude and frequency of theta-nested gamma oscillations varies. Our analysis leads to several new and testable predictions. First, tuning of recurrent synaptic connections could be used to modify gamma oscillations without affecting rate-coded computation. If multiple networks of the kind we simulate here correspond to grid modules providing input to downstream neurons in the hippocampus (<xref ref-type="bibr" rid="bib41">Stensola et al., 2012</xref>), then adjusting g<sub>E</sub> or g<sub>I</sub> would alter gamma frequency with minimal effect on the grid firing pattern of each module. If the downstream neurons integrate input at the gamma time scale, then this should lead to re-mapping of their place representation in the absence of any change in either the strength of their synaptic inputs or the information they receive from upstream grid cells. Adjustment of g<sub>E</sub> and g<sub>I</sub> could be achieved dynamically through actions of neuromodulators (<xref ref-type="bibr" rid="bib26">Marder, 2012</xref>), or on slower developmental time scales (<xref ref-type="bibr" rid="bib47">Widloski and Fiete, 2014</xref>). Second, subtle differences in gamma could be a sensitive index of network pathology at stages before deficits in rate coded computation are apparent. If cognitive deficits in psychiatric disorders reflect a failure of rate coded computation, then our analysis predicts that a change in noise within a circuit, in addition to synaptic modification, may be necessary for deficits to emerge. From this perspective it is intriguing that seizure phenotypes are often associated with disorders such as autism (<xref ref-type="bibr" rid="bib9">Deykin and MacMahon, 1979</xref>). Alternatively, cognitive deficits may result from a failure to coordinate gamma frequency synchronization of circuits that converge on downstream targets. In this case we expect cognitive deficits to be phenocopied by manipulations that affect gamma frequency or power without influencing rate-coded computations (<xref ref-type="bibr" rid="bib38">Sigurdsson et al., 2010</xref>; <xref ref-type="bibr" rid="bib40">Spellman and Gordon, 2014</xref>).</p><p>In conclusion, our systematic exploration of three dimensions of parameter space (g<sub>E</sub>, g<sub>I</sub> and intrinsic noise) illustrates the complexity of relationships between rate-coded computation, gamma frequency oscillations and underlying cellular and molecular mechanisms. Our results highlight the challenges in straightforward interpretation of experiments in which these parameters are correlated to one another, (cf. <xref ref-type="bibr" rid="bib46">Wang and Krystal, 2014</xref>). While there are parallels to investigations of pace-making activity in invertebrate circuits (<xref ref-type="bibr" rid="bib27">Marder and Taylor, 2011</xref>), which demonstrate that many parameter combinations can account for higher order behavior, there are also critical differences in that the models we describe account for multiplexing of rate-coded computation and oscillatory activity, while the number of neurons and connections in the simulated circuit is much larger. Future experimentation will be required to test our model predictions for unexpected beneficial roles of noise and for control of gamma oscillations independently from grid firing by modulating the strength of excitatory and inhibitory synaptic connections.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>The model comprised a network of exponential integrate and fire neurons (<xref ref-type="bibr" rid="bib14">Fourcaud-Trocmé et al., 2003</xref>) implemented as a custom-made module of the NEST simulator (<xref ref-type="bibr" rid="bib18">Gewaltig and Diesmann, 2007</xref>). The network investigated in the majority of simulations (<xref ref-type="fig" rid="fig1 fig2 fig3 fig4 fig5 fig6">Figures 1–6</xref>) is modified from that in <xref ref-type="bibr" rid="bib30">Pastoll et al. (2013)</xref> and consists of excitatory (E) and inhibitory (I) populations of neurons that were arranged on a twisted torus with dimensions of 34 × 30 neurons. In networks where connection strengths were generated probabilistically instead of in an all-to-all way, the synaptic weights from E to I cells and vice versa were constant, while the probability of connection between the pre- and post-synaptic neuron was drawn according to <xref ref-type="fig" rid="fig1">Figure 1B</xref>. In addition, some networks also included direct uniform recurrent inhibition between I cells (<xref ref-type="fig" rid="fig7">Figure 7</xref>; referred to as E-I-I networks) or direct structured recurrent excitation between E cells (<xref ref-type="fig" rid="fig7s10 fig7s7 fig7s8 fig7s9 fig7s6">Figure 7—figure supplements 6–10</xref>). When recurrent excitation was present, synaptic weights between E cells followed the connectivity profile in which the strongest connection was between cells that were close to each other in network space (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) and the weights between E and I cells were generated either according to synaptic profiles from <xref ref-type="fig" rid="fig1">Figure 1B</xref> (<xref ref-type="fig" rid="fig7s6 fig7s7 fig7s8 fig7s9">Figure 7—figure supplements 6–9</xref>) or the E-I connectivity was uniform with a probability of connection of 0.1 (<xref ref-type="fig" rid="fig7s10">Figure 7—figure supplement 10</xref>). E and I cells also received the theta current drive which was the sum of a constant amplitude positive current and a current with sinusoidal waveform (8 Hz). The constant component of the drive was required to activate the circuit, while the theta drive frequency was chosen to reflect the frequency of theta oscillations in behaving animals. The amplitude (cf. <xref ref-type="app" rid="app1">Appendix 1</xref>) was chosen to produce theta modulation of I cell firing similar to that observed in behaving animals (cf. <xref ref-type="bibr" rid="bib6">Chrobak and Buzsáki, 1998</xref>) and ex-vivo models of theta-nested gamma activity (cf. <xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). In order to oppose drift of the activity bump in networks that simulated exploration of the arena E cells received input from cells with place-like firing fields simulated as Poisson spiking generators with their instantaneous firing rate modeled as a Gaussian function of the animal position. Full details of the connectivity and network parameters are in <xref ref-type="app" rid="app1">Appendix 1</xref>.</p><p>In all simulations the networks were parameterized by the standard deviation of noise (σ) injected independently into each E and I cell and by synaptic scaling parameters (g<sub>E</sub> and g<sub>I</sub>). Noise was sampled from a Gaussian distribution with standard deviation either set to σ = 0, 150 or 300 pA, or alternatively in the range of 0–300 pA in steps of 10 pA (<xref ref-type="fig" rid="fig2 fig3">Figures 2H, 3H</xref>). The peaks of the synaptic profile functions (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) were determined by the g<sub>E</sub> and g<sub>I</sub> parameters that appropriately scaled the maximal conductance values of the excitatory and inhibitory connections respectively.</p><p>Gridness scores were estimated by simulating exploration in a circular arena with a diameter of 180 cm. For each value of g<sub>E</sub> and g<sub>I</sub> the simulations consisted of two phases. In the first phase, animal movement with constant speed and direction (vertically from bottom to top) was simulated in order to calibrate the gain of the velocity input to achieve 60 cm spacing between grid fields in the network. In the second phase, the calibrated velocity input gains were used during a simulation of realistic animal movements with duration of 600 s (<xref ref-type="bibr" rid="bib19a">Hafting et al., 2005</xref>). Each simulation was repeated 1–4 times. For each trial, gridness score was then estimated from an E or I cell located at position (0, 0) on the twisted torus. In simulations where interneurons received uncorrelated spatial inputs (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>), gridness scores were estimated from 100 randomly selected E and I cells on the twisted torus.</p><p>For the analysis of bump attractor properties and gamma oscillations a separate set of simulations were run. For each value of g<sub>E</sub>, g<sub>I</sub> and noise level, there were five trials of 10 s duration during which the velocity and place cell inputs were deactivated. For each trial spiking activity of all cells was recorded. In addition, inhibitory synaptic currents of 25 randomly selected E cells were saved and used for further analysis.</p><p>The strength and frequency of gamma oscillations were estimated from the inhibitory synaptic currents recorded from E cells. The currents were first band-pass filtered between 20 and 200 Hz. For each trace, its autocorrelation function was computed and the first local maximum was detected using a peak detection algorithm which was based on calculating the points in the autocorrelation function where the first difference of the signal changed sign from positive to negative and thus approximated the points where the first derivative was zero and the second derivative was negative. The strength and frequency of gamma oscillations was estimated from the correlation value and lag at the position of the first local maximum respectively.</p><p>Properties of bump attractors were estimated by fitting symmetric Gaussian functions onto successive snapshots of firing rates of each cell in the E population. For each snapshot this procedure yielded the position of the bump center and its width. The probability of bump formation was then estimated as a proportion of population-activity snapshots that were classified as bump attractors, that is, those fitted Gaussian functions whose width did not exceed the shorter side of the twisted torus. Other properties of bump attractors were estimated by analyzing successive positions of the bump attractor centers. Action potential raster plots of E and I populations (<xref ref-type="fig" rid="fig5">Figure 5A–C</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref> and <xref ref-type="fig" rid="fig7s10">Figure 7—figure supplement 10</xref>) show neuron indices that are flattened in a row-wise manner with respect to the two-dimensional twisted torus. Data points with white color in <xref ref-type="fig" rid="fig5">Figure 5D,E</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A</xref> have been excluded from analysis since the maximal firing rate of E cells exceeded 500 Hz/2 ms window.</p><p>The calculation of the maximal information coefficient (MIC) for the relationship between gridness score, gamma and bump scores was estimated by applying the MIC measure using the minepy package (<xref ref-type="bibr" rid="bib1">Albanese et al., 2013</xref>). Calculations of spatial information were carried out according to (<xref ref-type="bibr" rid="bib39">Skaggs et al., 1996</xref>). Spatial sparsity was calculated by following the procedure outlined in (<xref ref-type="bibr" rid="bib4">Buetfering et al., 2014</xref>). All other data analysis and simulations were performed in Python.</p></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Hugh Pastoll, Lukas Fisher and Paolo Puggioni for useful discussions. This work has made use of resources provided by the Edinburgh Compute and Data Facility (ECDF; <ext-link ext-link-type="uri" xlink:href="http://www.ecdf.ed.ac.uk">www.ecdf.ed.ac.uk</ext-link>), which has support from the eDIKT initiative (<ext-link ext-link-type="uri" xlink:href="http://www.edikt.org.uk">www.edikt.org.uk</ext-link>).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>LS, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>MCWR, Conception and design, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con3"><p>MFN, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.06444.036</object-id><label>Supplementary file 1.</label><caption><p>Examples of spatial firing fields. (A-L) Top: Gridness score in the parameter space of the E and I synaptic strength scaling parameters (g<sub>E</sub> and g<sub>I</sub> respectively). Bottom: Firing fields of a single cell obtained by simulating animal movement, in the parameter region highlighted by black rectangle in the parameter space plot. Above each firing field is the estimated gridness score (left) and maximal firing rate in the firing field (right). Blank (white) locations in the parameter space are simulations that did not finish in the pre-specified time limit (5 hr). Noise level used in each set of simulations is shown by σ<sub>noise</sub>. Color scale in the firing field plots ranges from 0 Hz (dark blue) to the maximal firing rate for each of the firing fields (dark red).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.036">http://dx.doi.org/10.7554/eLife.06444.036</ext-link></p></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-06444-supp1-v2.pdf"/></supplementary-material></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albanese</surname><given-names>D</given-names></name><name><surname>Filosi</surname><given-names>M</given-names></name><name><surname>Visintainer</surname><given-names>R</given-names></name><name><surname>Riccadonna</surname><given-names>S</given-names></name><name><surname>Jurman</surname><given-names>G</given-names></name><name><surname>Furlanello</surname><given-names>C</given-names></name></person-group><year>2013</year><article-title>Minerva and minepy: a C engine for the MINE suite and its R, Python and MATLAB wrappers</article-title><source>Bioinformatics</source><volume>29</volume><fpage>407</fpage><lpage>408</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts707</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benzi</surname><given-names>R</given-names></name><name><surname>Sutera</surname><given-names>A</given-names></name><name><surname>Vulpiani</surname><given-names>A</given-names></name></person-group><year>1999</year><article-title>The mechanism of stochastic resonance</article-title><source>Journal of Physics A</source><volume>14</volume><fpage>L453</fpage><lpage>L457</lpage><pub-id pub-id-type="doi">10.1088/0305-4470/14/11/006</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonnevie</surname><given-names>T</given-names></name><name><surname>Dunn</surname><given-names>B</given-names></name><name><surname>Fyhn</surname><given-names>M</given-names></name><name><surname>Hafting</surname><given-names>T</given-names></name><name><surname>Derdikman</surname><given-names>D</given-names></name><name><surname>Kubie</surname><given-names>JL</given-names></name><name><surname>Roudi</surname><given-names>Y</given-names></name><name><surname>Moser</surname><given-names>EI</given-names></name><name><surname>Moser</surname><given-names>MB</given-names></name></person-group><year>2013</year><article-title>Grid cells require excitatory drive from the hippocampus</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>309</fpage><lpage>317</lpage><pub-id pub-id-type="doi">10.1038/nn.3311</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buetfering</surname><given-names>C</given-names></name><name><surname>Allen</surname><given-names>K</given-names></name><name><surname>Monyer</surname><given-names>H</given-names></name></person-group><year>2014</year><article-title>Parvalbumin interneurons provide grid cell-driven recurrent inhibition in the medial entorhinal cortex</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>710</fpage><lpage>718</lpage><pub-id pub-id-type="doi">10.1038/nn.3696</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burak</surname><given-names>Y</given-names></name><name><surname>Fiete</surname><given-names>IR</given-names></name></person-group><year>2009</year><article-title>Accurate path integration in continuous attractor network models of grid cells</article-title><source>PLOS Computational Biology</source><volume>5</volume><fpage>e1000291</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000291</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chrobak</surname><given-names>JJ</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year>1998</year><article-title>Gamma oscillations in the entorhinal cortex of the freely behaving rat</article-title><source>The Journal of Neuroscience</source><volume>18</volume><fpage>388</fpage><lpage>398</lpage></element-citation></ref><ref id="bib4a"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Compte</surname><given-names>A</given-names></name><name><surname>Brunel</surname><given-names>N</given-names></name><name><surname>Goldman-Rakic</surname><given-names>PS</given-names></name><name><surname>Wang</surname><given-names>XJ</given-names></name></person-group><year>2000</year><article-title>Synaptic mechanisms and network dynamics underlying spatial working memory in a cortical network model</article-title><source>Cerebral Cortex</source><volume>10</volume><fpage>910</fpage><lpage>923</lpage><pub-id pub-id-type="doi">10.1093/cercor/10.9.910</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colgin</surname><given-names>LL</given-names></name><name><surname>Denninger</surname><given-names>T</given-names></name><name><surname>Fyhn</surname><given-names>M</given-names></name><name><surname>Hafting</surname><given-names>T</given-names></name><name><surname>Bonnevie</surname><given-names>T</given-names></name><name><surname>Jensen</surname><given-names>O</given-names></name><name><surname>Moser</surname><given-names>MB</given-names></name><name><surname>Moser</surname><given-names>EI</given-names></name></person-group><year>2009</year><article-title>Frequency of gamma oscillations routes flow of information in the hippocampus</article-title><source>Nature</source><volume>462</volume><fpage>353</fpage><lpage>357</lpage><pub-id pub-id-type="doi">10.1038/nature08573</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couey</surname><given-names>JJ</given-names></name><name><surname>Witoelar</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>SJ</given-names></name><name><surname>Zheng</surname><given-names>K</given-names></name><name><surname>Ye</surname><given-names>J</given-names></name><name><surname>Dunn</surname><given-names>B</given-names></name><name><surname>Czajkowski</surname><given-names>R</given-names></name><name><surname>Moser</surname><given-names>MB</given-names></name><name><surname>Moser</surname><given-names>EI</given-names></name><name><surname>Roudi</surname><given-names>Y</given-names></name><name><surname>Witter</surname><given-names>MP</given-names></name></person-group><year>2013</year><article-title>Recurrent inhibitory circuitry as a mechanism for grid formation</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>318</fpage><lpage>324</lpage><pub-id pub-id-type="doi">10.1038/nn.3310</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deykin</surname><given-names>EY</given-names></name><name><surname>MacMahon</surname><given-names>B</given-names></name></person-group><year>1979</year><article-title>The incidence of seizures among children with autistic symptoms</article-title><source>The American Journal of Psychiatry</source><volume>136</volume><fpage>1310</fpage><lpage>1312</lpage><pub-id pub-id-type="doi">10.1176/ajp.136.10.1310</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dhillon</surname><given-names>A</given-names></name><name><surname>Jones</surname><given-names>RS</given-names></name></person-group><year>2000</year><article-title>Laminar differences in recurrent excitatory transmission in the rat entorhinal cortex in vitro</article-title><source>Neuroscience</source><volume>99</volume><fpage>413</fpage><lpage>422</lpage><pub-id pub-id-type="doi">10.1016/S0306-4522(00)00225-6</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Domnisoru</surname><given-names>C</given-names></name><name><surname>Kinkhabwala</surname><given-names>AA</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name></person-group><year>2013</year><article-title>Membrane potential dynamics of grid cells</article-title><source>Nature</source><volume>495</volume><fpage>199</fpage><lpage>204</lpage><pub-id pub-id-type="doi">10.1038/nature11973</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eliasmith</surname><given-names>C</given-names></name></person-group><year>2005</year><article-title>A unified approach to building and controlling spiking attractor networks</article-title><source>Neural Computation</source><volume>17</volume><fpage>1276</fpage><lpage>1314</lpage><pub-id pub-id-type="doi">10.1162/0899766053630332</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faisal</surname><given-names>AA</given-names></name><name><surname>Selen</surname><given-names>LP</given-names></name><name><surname>Wolpert</surname><given-names>DM</given-names></name></person-group><year>2008</year><article-title>Noise in the nervous system</article-title><source>Nature Reviews. Neuroscience</source><volume>9</volume><fpage>292</fpage><lpage>303</lpage><pub-id pub-id-type="doi">10.1038/nrn2258</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fourcaud-Trocmé</surname><given-names>N</given-names></name><name><surname>Hansel</surname><given-names>D</given-names></name><name><surname>van Vreeswijk</surname><given-names>C</given-names></name><name><surname>Brunel</surname><given-names>N</given-names></name></person-group><year>2003</year><article-title>How spike generation mechanisms determine the neuronal response to fluctuating inputs</article-title><source>The Journal of Neuroscience</source><volume>23</volume><fpage>11628</fpage><lpage>11640</lpage></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fries</surname><given-names>P</given-names></name></person-group><year>2009</year><article-title>Neuronal gamma-band synchronization as a fundamental process in cortical computation</article-title><source>Annual Review of Neuroscience</source><volume>32</volume><fpage>209</fpage><lpage>224</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.051508.135603</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuhs</surname><given-names>MC</given-names></name><name><surname>Touretzky</surname><given-names>DS</given-names></name></person-group><year>2006</year><article-title>A spin glass model of path integration in rat medial entorhinal cortex</article-title><source>The Journal of Neuroscience</source><volume>26</volume><fpage>4266</fpage><lpage>4276</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4353-05.2006</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gatome</surname><given-names>CW</given-names></name><name><surname>Slomianka</surname><given-names>L</given-names></name><name><surname>Lipp</surname><given-names>HP</given-names></name><name><surname>Amrein</surname><given-names>I</given-names></name></person-group><year>2010</year><article-title>Number estimates of neuronal phenotypes in layer II of the medial entorhinal cortex of rat and mouse</article-title><source>Neuroscience</source><volume>170</volume><fpage>156</fpage><lpage>165</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2010.06.048</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gewaltig</surname><given-names>MO</given-names></name><name><surname>Diesmann</surname><given-names>M</given-names></name></person-group><year>2007</year><article-title>NEST (NEural Simulation Tool)</article-title><source>Scholarpedia</source><volume>2</volume><fpage>1430</fpage><pub-id pub-id-type="doi">10.4249/scholarpedia.1430</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guanella</surname><given-names>A</given-names></name><name><surname>Kiper</surname><given-names>D</given-names></name><name><surname>Verschure</surname><given-names>P</given-names></name></person-group><year>2007</year><article-title>A model of grid cells based on a twisted torus topology</article-title><source>International Journal of Neural Systems</source><volume>17</volume><fpage>231</fpage><lpage>240</lpage><pub-id pub-id-type="doi">10.1142/S0129065707001093</pub-id></element-citation></ref><ref id="bib19a"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hafting</surname><given-names>T</given-names></name><name><surname>Fyhn</surname><given-names>M</given-names></name><name><surname>Molden</surname><given-names>S</given-names></name><name><surname>Moser</surname><given-names>MB</given-names></name><name><surname>Moser</surname><given-names>EI</given-names></name></person-group><year>2005</year><article-title>Microstructure of a spatial map in the entorhinal cortex</article-title><source>Nature</source><volume>436</volume><fpage>801</fpage><lpage>806</lpage><pub-id pub-id-type="doi">10.1038/nature03721</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Histed</surname><given-names>MH</given-names></name><name><surname>Maunsell</surname><given-names>JH</given-names></name></person-group><year>2014</year><article-title>Cortical neural populations can guide behavior by integrating inputs linearly, independent of synchrony</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>111</volume><fpage>E178</fpage><lpage>E187</lpage><pub-id pub-id-type="doi">10.1073/pnas.1318750111</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunsberger</surname><given-names>E</given-names></name><name><surname>Scott</surname><given-names>M</given-names></name><name><surname>Eliasmith</surname><given-names>C</given-names></name></person-group><year>2014</year><article-title>The competing benefits of noise and heterogeneity in neural coding</article-title><source>Neural Computation</source><volume>26</volume><fpage>1600</fpage><lpage>1623</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00621</pub-id></element-citation></ref><ref id="bib6a"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>R</given-names></name><name><surname>Buhl</surname><given-names>EH</given-names></name></person-group><year>1993</year><article-title>Basket-like interneurones in layer II of the entorhinal cortex exhibit a powerful NMDA-mediated synaptic excitation</article-title><source>Neuroscience Letters</source><volume>149</volume><fpage>35</fpage><lpage>39</lpage><pub-id pub-id-type="doi">10.1016/0304-3940(93)90341-H</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lerche</surname><given-names>H</given-names></name><name><surname>Jurkat Rott</surname><given-names>K</given-names></name><name><surname>Lehmann Horn</surname><given-names>F</given-names></name></person-group><year>2001</year><article-title>Ion channels and epilepsy</article-title><source>American Journal of Medical Genetics</source><volume>106</volume><fpage>146</fpage><lpage>159</lpage><pub-id pub-id-type="doi">10.1002/ajmg.1582</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewis</surname><given-names>DA</given-names></name><name><surname>Curley</surname><given-names>AA</given-names></name><name><surname>Glausier</surname><given-names>JR</given-names></name><name><surname>Volk</surname><given-names>DW</given-names></name></person-group><year>2012</year><article-title>Cortical parvalbumin interneurons and cognitive dysfunction in schizophrenia</article-title><source>Trends in Neurosciences</source><volume>35</volume><fpage>57</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2011.10.004</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Longtin</surname><given-names>A</given-names></name><name><surname>Bulsara</surname><given-names>A</given-names></name><name><surname>Moss</surname><given-names>F</given-names></name></person-group><year>1991</year><article-title>Time-interval sequences in bistable systems and the noise-induced transmission of information by sensory neurons</article-title><source>Physical Review Letters</source><volume>67</volume><fpage>656</fpage><lpage>659</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.67.656</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lundqvist</surname><given-names>M</given-names></name><name><surname>Compte</surname><given-names>A</given-names></name><name><surname>Lansner</surname><given-names>A</given-names></name></person-group><year>2010</year><article-title>Bistable, irregular firing and population oscillations in a modular attractor memory network</article-title><source>PLOS Computational Biology</source><volume>6</volume><fpage>e1000803</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000803</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year>2012</year><article-title>Neuromodulation of neuronal circuits: back to the future</article-title><source>Neuron</source><volume>76</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.09.010</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Taylor</surname><given-names>AL</given-names></name></person-group><year>2011</year><article-title>Multiple models to capture the variability in biological neurons and networks</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>133</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1038/nn.2735</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moser</surname><given-names>EI</given-names></name><name><surname>Moser</surname><given-names>MB</given-names></name></person-group><year>2013</year><article-title>Grid cells and neural coding in high-end cortices</article-title><source>Neuron</source><volume>80</volume><fpage>765</fpage><lpage>774</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.09.043</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Onslow</surname><given-names>AC</given-names></name><name><surname>Jones</surname><given-names>MW</given-names></name><name><surname>Bogacz</surname><given-names>R</given-names></name></person-group><year>2014</year><article-title>A canonical circuit for generating phase-amplitude coupling</article-title><source>PLOS ONE</source><volume>9</volume><fpage>e102591</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0102591</pub-id></element-citation></ref><ref id="bib7a"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paoletti</surname><given-names>P</given-names></name><name><surname>Bellone</surname><given-names>C</given-names></name><name><surname>Zhou</surname><given-names>Q</given-names></name></person-group><year>2013</year><article-title>NMDA receptor subunit diversity: impact on receptor properties, synaptic plasticity and disease</article-title><source>Nature Reviews. Neuroscience</source><volume>14</volume><fpage>383</fpage><lpage>400</lpage><pub-id pub-id-type="doi">10.1038/nrn3504</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pastoll</surname><given-names>H</given-names></name><name><surname>Solanka</surname><given-names>L</given-names></name><name><surname>van Rossum</surname><given-names>MCW</given-names></name><name><surname>Nolan</surname><given-names>MF</given-names></name></person-group><year>2013</year><article-title>Feedback inhibition enables theta-nested gamma oscillations and grid firing fields</article-title><source>Neuron</source><volume>77</volume><fpage>141</fpage><lpage>154</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.11.032</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubenstein</surname><given-names>JL</given-names></name><name><surname>Merzenich</surname><given-names>MM</given-names></name></person-group><year>2003</year><article-title>Model of autism: increased ratio of excitation/inhibition in key neural systems</article-title><source>Genes, Brain and Behavior</source><volume>2</volume><fpage>255</fpage><lpage>267</lpage><pub-id pub-id-type="doi">10.1034/j.1601-183X.2003.00037.x</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruzzoli</surname><given-names>M</given-names></name><name><surname>Marzi</surname><given-names>CA</given-names></name><name><surname>Miniussi</surname><given-names>C</given-names></name></person-group><year>2010</year><article-title>The neural mechanisms of the effects of transcranial magnetic stimulation on perception</article-title><source>Journal of Neurophysiology</source><volume>103</volume><fpage>2982</fpage><lpage>2989</lpage><pub-id pub-id-type="doi">10.1152/jn.01096.2009</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sargolini</surname><given-names>F</given-names></name><name><surname>Fyhn</surname><given-names>M</given-names></name><name><surname>Hafting</surname><given-names>T</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name><name><surname>Witter</surname><given-names>MP</given-names></name><name><surname>Moser</surname><given-names>MB</given-names></name><name><surname>Moser</surname><given-names>EI</given-names></name></person-group><year>2006</year><article-title>Conjunctive representation of position, direction, and velocity in entorhinal cortex</article-title><source>Science</source><volume>312</volume><fpage>758</fpage><lpage>762</lpage><pub-id pub-id-type="doi">10.1126/science.1125572</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt-Hieber</surname><given-names>C</given-names></name><name><surname>Häusser</surname><given-names>M</given-names></name></person-group><year>2013</year><article-title>Cellular mechanisms of spatial navigation in the medial entorhinal cortex</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>325</fpage><lpage>331</lpage><pub-id pub-id-type="doi">10.1038/nn.3340</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seung</surname><given-names>HS</given-names></name><name><surname>Lee</surname><given-names>DD</given-names></name><name><surname>Reis</surname><given-names>BY</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name></person-group><year>2000</year><article-title>Stability of the memory of eye position in a recurrent network of conductance-based model neurons</article-title><source>Neuron</source><volume>26</volume><fpage>259</fpage><lpage>271</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(00)81155-1</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shadlen</surname><given-names>MN</given-names></name><name><surname>Newsome</surname><given-names>WT</given-names></name></person-group><year>1994</year><article-title>Noise, neural codes and cortical organization</article-title><source>Current Opinion in Neurobiology</source><volume>4</volume><fpage>569</fpage><lpage>579</lpage><pub-id pub-id-type="doi">10.1016/0959-4388(94)90059-0</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shu</surname><given-names>Y</given-names></name><name><surname>Hasenstaub</surname><given-names>A</given-names></name><name><surname>Badoual</surname><given-names>M</given-names></name><name><surname>Bal</surname><given-names>T</given-names></name><name><surname>McCormick</surname><given-names>DA</given-names></name></person-group><year>2003</year><article-title>Barrages of synaptic activity control the gain and sensitivity of cortical neurons</article-title><source>The Journal of Neuroscience</source><volume>23</volume><fpage>10388</fpage><lpage>10401</lpage></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sigurdsson</surname><given-names>T</given-names></name><name><surname>Stark</surname><given-names>KL</given-names></name><name><surname>Karayiorgou</surname><given-names>M</given-names></name><name><surname>Gogos</surname><given-names>JA</given-names></name><name><surname>Gordon</surname><given-names>JA</given-names></name></person-group><year>2010</year><article-title>Impaired hippocampal-prefrontal synchrony in a genetic mouse model of schizophrenia</article-title><source>Nature</source><volume>464</volume><fpage>763</fpage><lpage>767</lpage><pub-id pub-id-type="doi">10.1038/nature08855</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skaggs</surname><given-names>WE</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name></person-group><year>1996</year><article-title>Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences</article-title><source>Hippocampus</source><volume>6</volume><fpage>149</fpage><lpage>172</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1996)6:2&amp;amp;lt;149::AID-HIPO6&amp;amp;gt;3.0.CO;2-K</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spellman</surname><given-names>TJ</given-names></name><name><surname>Gordon</surname><given-names>JA</given-names></name></person-group><year>2014</year><article-title>Synchrony in schizophrenia: a window into circuit-level pathophysiology</article-title><source>Current Opinion in Neurobiology</source><volume>30</volume><fpage>17</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2014.08.009</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stensola</surname><given-names>H</given-names></name><name><surname>Stensola</surname><given-names>T</given-names></name><name><surname>Solstad</surname><given-names>T</given-names></name><name><surname>Frøland</surname><given-names>K</given-names></name><name><surname>Moser</surname><given-names>MB</given-names></name><name><surname>Moser</surname><given-names>EI</given-names></name></person-group><year>2012</year><article-title>The entorhinal grid map is discretized</article-title><source>Nature</source><volume>492</volume><fpage>72</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1038/nature11649</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suthana</surname><given-names>N</given-names></name><name><surname>Haneef</surname><given-names>Z</given-names></name><name><surname>Stern</surname><given-names>J</given-names></name><name><surname>Mukamel</surname><given-names>R</given-names></name><name><surname>Behnke</surname><given-names>E</given-names></name><name><surname>Knowlton</surname><given-names>B</given-names></name><name><surname>Fried</surname><given-names>I</given-names></name></person-group><year>2012</year><article-title>Memory enhancement and deep-brain stimulation of the entorhinal area</article-title><source>The New England Journal of Medicine</source><volume>366</volume><fpage>502</fpage><lpage>510</lpage><pub-id pub-id-type="doi">10.1056/NEJMoa1107212</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tiesinga</surname><given-names>P</given-names></name><name><surname>Jose</surname><given-names>JV</given-names></name></person-group><year>2000</year><article-title>Robust gamma oscillations in networks of inhibitory hippocampal interneurons</article-title><source>Network</source><volume>11</volume><fpage>1</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1088/0954-898X/11/1/301</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Treiman</surname><given-names>DM</given-names></name></person-group><year>2001</year><article-title>GABAergic mechanisms in epilepsy</article-title><source>Epilepsia</source><volume>42</volume><fpage>8</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1046/j.1528-1157.2001.042suppl.3008.x</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uhlhaas</surname><given-names>PJ</given-names></name><name><surname>Singer</surname><given-names>W</given-names></name></person-group><year>2012</year><article-title>Neuronal dynamics and neuropsychiatric disorders: toward a translational paradigm for dysfunctional large-scale networks</article-title><source>Neuron</source><volume>75</volume><fpage>963</fpage><lpage>980</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.09.004</pub-id></element-citation></ref><ref id="bib11a"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>XJ</given-names></name></person-group><year>1999</year><article-title>Synaptic basis of cortical persistent activity: the importance of NMDA receptors to working memory</article-title><source>Journal of Neuroscience</source><volume>19</volume><fpage>9587</fpage><lpage>9603</lpage></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>XJ</given-names></name><name><surname>Krystal</surname><given-names>JH</given-names></name></person-group><year>2014</year><article-title>Computational psychiatry</article-title><source>Neuron</source><volume>84</volume><fpage>638</fpage><lpage>654</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.10.018</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Widloski</surname><given-names>J</given-names></name><name><surname>Fiete</surname><given-names>IR</given-names></name></person-group><year>2014</year><article-title>A model of grid cell development through spatial exploration and spike time-dependent plasticity</article-title><source>Neuron</source><volume>83</volume><fpage>481</fpage><lpage>495</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.06.018</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoon</surname><given-names>K</given-names></name><name><surname>Buice</surname><given-names>MA</given-names></name><name><surname>Barry</surname><given-names>C</given-names></name><name><surname>Hayman</surname><given-names>R</given-names></name><name><surname>Burgess</surname><given-names>N</given-names></name><name><surname>Fiete</surname><given-names>IR</given-names></name></person-group><year>2013</year><article-title>Specific evidence of low-dimensional continuous attractor dynamics in grid cells</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1077</fpage><lpage>1084</lpage><pub-id pub-id-type="doi">10.1038/nn.3450</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>K</given-names></name></person-group><year>1996</year><article-title>Representation of spatial orientation by the intrinsic dynamics of the head-direction cell ensemble: a theory</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>2112</fpage><lpage>2126</lpage></element-citation></ref></ref-list><app-group><app id="app1"><title>Appendix 1</title><boxed-text><sec id="s7" sec-type="appendix"><title>Supplementary methods</title><sec id="s7-1"><title>Neuron membrane and synaptic dynamics</title><p>Each neuron's membrane potential (<italic>V</italic><sub>m</sub>) is governed by the passive membrane equation:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mtext>m</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mtext>syn</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mtext>ext</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>in which the total membrane current is a sum of four separate components: the trans-membrane current (<italic>I</italic><sub>m</sub>), the total synaptic current (<italic>I</italic><sub>syn</sub>), the current injected externally from other brain regions (<italic>I</italic><sub>ext</sub>) and <inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>η</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which is the noise current with zero mean and appropriate standard deviation in the range of 0–300 pA.</p><p>For E cells, the trans-membrane current<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>L</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>L</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>AHP</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>AHP</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>L</mml:mtext></mml:msub><mml:msub><mml:mtext>Δ</mml:mtext><mml:mtext>T</mml:mtext></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext>T</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mtext>Δ</mml:mtext><mml:mtext>T</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>contains the leak conductances (‘L’ subscript), after-spike hyperpolarisation conductance (‘AHP’ subscript) and an exponential part that initiates a spike when the membrane potential gets close to the threshold (<italic>V</italic><sub>T</sub>). After each spike, there is a reset of membrane potential and the AHP conductance:<disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext>r</mml:mtext></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ4"><label>(3)</label><mml:math id="m4"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>AHP</mml:mtext></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>AHP</mml:mtext></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The I cells do not possess an AHP, but instead contain a simple adaptation term. The trans-membrane current has the following form:<disp-formula id="equ5"><label>(4)</label><mml:math id="m5"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>L</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>ad</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>L</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>L</mml:mtext></mml:msub><mml:msub><mml:mtext>Δ</mml:mtext><mml:mtext>T</mml:mtext></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext>T</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mtext>Δ</mml:mtext><mml:mtext>T</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The <italic>g</italic><sub>ad</sub> term adds an extra conductance after each spike, that is, after the spike:<disp-formula id="equ6"><mml:math id="m6"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext>r</mml:mtext></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ7"><label>(5)</label><mml:math id="m7"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>ad</mml:mtext></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>ad</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>ad</mml:mtext></mml:mrow><mml:mrow><mml:mtext>inc</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We used adaptation for the I cells in order to include refractory properties after each spike. The frequency vs current (F-I) relationship of the standard leaky integrate-and-fire neuron model has a steep slope right after the firing threshold has been crossed. This is an undesirable property because a neuron's firing rate is overly sensitive to small current changes. To linearize the F-I curve we used adaptation. The adaptation was not specifically tuned to produce the current model behavior and other mechanisms could be used as well (e.g., after-spike hyperpolarization as was done in the case of E cells).</p><p>Both AHP and adaptation conductances (<italic>g</italic><sub>AHP</sub> and <italic>g</italic><sub>ad</sub> respectively) decay exponentially:<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>AHP</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>AHP</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>AHP</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ9"><label>(6)</label><mml:math id="m9"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>ad</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>ad</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>ad</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In <xref ref-type="disp-formula" rid="equ2 equ5">Equations 2, 4</xref>, the term Δ<sub>T</sub> is defined as the spike slope factor (<xref ref-type="bibr" rid="bib14">Fourcaud-Trocmé et al., 2003</xref>) and it measures the sharpness of the spike initiation. The closer this parameter is to zero, the faster spike initiation will happen when <italic>V</italic><sub>m</sub> gets close to <italic>V</italic><sub>T</sub>. For the exponential integrate and fire neuron, in the limit Δ<sub>T</sub> → 0, the model becomes equivalent to a leaky integrate and fire neuron (<xref ref-type="bibr" rid="bib14">Fourcaud-Trocmé et al., 2003</xref>).</p><p>The synaptic current for each neuron is a sum of the AMPA, NMDA and GABA<sub>A</sub> synaptic currents collected from spikes of all other neurons:<disp-formula id="equ10"><label>(7)</label><mml:math id="m10"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mtext>syn</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext>A</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext>A</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>NMDA</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>NMDA</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In networks that do not contain recurrent E → E connections we set <italic>g</italic><sub>AMPA</sub> = <italic>g</italic><sub>NMDA</sub> = 0 for the E cells, and <inline-formula><mml:math id="inf2"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext>A</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for I cells. In other network variants (with E → E or I → I connectivity) these synaptic strengths are non-zero. E → E, as well as E → I synapses thus both contain the NMDA component. Connections from place cells were modeled as AMPA conductances only (cf. description of place cell inputs). The synaptic conductances <italic>g</italic><sub>AMPA</sub>, <italic>g</italic><sub>NMDA</sub> and <inline-formula><mml:math id="inf3"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext> A</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of a postsynaptic neuron <italic>i</italic> were modeled as exponentials with pre-defined time constants (see <xref ref-type="table" rid="tbl1">Appendix table 1</xref> for the parameter values):<disp-formula id="equ11"><mml:math id="m11"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>AMPA</mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mtext>AMPA</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>AMPA</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mtext>AMPA</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ12"><mml:math id="m12"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext> NMDA</mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mtext>NMDA</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>NMDA</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mtext> NMDA</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ13"><label>(8)</label><mml:math id="m13"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext> GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext> A</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext> A</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext> A</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext> GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext> A</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.06444.037</object-id><label>Appendix table 1.</label><caption><p>Parameter values for synapses</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.037">http://dx.doi.org/10.7554/eLife.06444.037</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Name</th><th>Units</th><th>Value</th></tr></thead><tbody><tr><td><italic>E</italic><sub>AMPA</sub></td><td>mV</td><td>0</td></tr><tr><td><italic>τ</italic><sub>AMPA</sub></td><td>ms</td><td>1</td></tr><tr><td><italic>E</italic><sub>NMDA</sub></td><td>mV</td><td>0</td></tr><tr><td><italic>τ</italic><sub>NMDA</sub></td><td>ms</td><td>100</td></tr><tr><td><inline-formula><mml:math id="inf23"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext> A</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>mV</td><td>−75</td></tr><tr><td><inline-formula><mml:math id="inf24"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext> A</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>ms</td><td>5</td></tr></tbody></table></table-wrap></p><p>After each spike of a presynaptic neuron <italic>j</italic>, each corresponding conductance was incremented by <italic>w</italic><sup><italic>ij</italic></sup>.</p><p>In MEC layer II, basket cells receive a potent, NMDA-mediated synaptic excitation (<xref ref-type="bibr" rid="bib6a">Jones and Buhl, 1993</xref>). These NMDA responses are slow, lasting several tens of ms (<xref ref-type="bibr" rid="bib6a">Jones and Buhl, 1993</xref>). NMDA synapses in the attractor network are thus represented by an exponentially decaying conductance (<inline-formula><mml:math id="inf4"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>NMDA</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>), with a 100 ms time constant (<xref ref-type="table" rid="tbl1">Appendix table 1</xref>). Both the voltage dependence and slow kinetics of NMDA receptors have been suggested to help maintain persistent activity in working memory networks (<xref ref-type="bibr" rid="bib11a">Wang, 1999</xref>). Here, it is the slow kinetics of <italic>g</italic><sub>NMDA</sub> that is necessary to maintain the state of the network during consecutive theta cycles. NMDA receptors are known to be of several variants, depending on the types of the subunits the receptors are composed of (<xref ref-type="bibr" rid="bib7a">Paoletti et al., 2013</xref>). These several receptor variants have different kinetic time scales, and different sensitivity to the concentration of Mg<sup>2+</sup>. In <xref ref-type="bibr" rid="bib6a">Jones and Buhl (1993)</xref>, the authors do not report, quantitatively, to what extent the amplitude of the NMDA-mediated synaptic responses are dependent on the Mg<sup>2+</sup> concentration. Therefore, we assume here that the slow kinetics of <italic>g</italic><sub>NMDA</sub> is sufficient to stabilise the activity of the network and do not include voltage-dependence of NMDA conductances.</p><p>Finally, the current external to the neuron<disp-formula id="equ14"><label>(9)</label><mml:math id="m14"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>ext</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>const</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>vel</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>place</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>consists of a constant value (<italic>I</italic><sub>const</sub>), a theta modulated part, modeled as<disp-formula id="equ15"><label>(10)</label><mml:math id="m15"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>sin</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>the velocity modulated current (<italic>I</italic><sub>vel</sub>) that simulates a combination of head-direction input and animal speed input, and an input coming from place cells (<italic>I</italic><sub>place</sub>). The description of the parameters in the equations can be found in <xref ref-type="table" rid="tbl2">Appendix table 2</xref>. The theta current drive is the sum of a constant amplitude positive current (<italic>I</italic><sub>const</sub>) and a current with sinusoidal waveform (<italic>I</italic><sub><italic>θ</italic></sub>). The constant component of the drive is required to activate the circuit. If it is removed then the circuit becomes silent. The sinusoidal waveform has a frequency of 8 Hz. This is chosen to reflect the frequency of theta oscillations in behaving animals. The amplitude is chosen to produce theta modulation of interneuron firing similar to that observed in behaving animals (cf. <xref ref-type="bibr" rid="bib6">Chrobak and Buzsáki, 1998</xref>) and in ex-vivo models of theta-nested gamma activity (cf. <xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). While <italic>I</italic><sub>const</sub> and <italic>I</italic><sub><italic>θ</italic></sub> are simple functions of time, the velocity modulated current and place cell current are described separately. The velocity modulated current is described in ‘Velocity modulated input current’ and the place cell input current in ‘Place cell input’.<table-wrap id="tbl2" position="float"><object-id pub-id-type="doi">10.7554/eLife.06444.038</object-id><label>Appendix table 2.</label><caption><p>Neuron parameters and their description</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.038">http://dx.doi.org/10.7554/eLife.06444.038</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Name</th><th>Description</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><italic>V</italic><sub>m</sub></td><td>Membrane potential</td><td><italic>E</italic><sub>AMPA</sub></td><td>AMPA reversal potential</td></tr><tr><td><italic>C</italic><sub>m</sub></td><td>Membrane capacitance</td><td><italic>g</italic><sub>NMDA</sub></td><td>NMDA conductance</td></tr><tr><td><italic>g</italic><sub>L</sub></td><td>Leak conductance</td><td><italic>E</italic><sub>NMDA</sub></td><td>NMDA reversal potential</td></tr><tr><td><italic>E</italic><sub>L</sub></td><td>Leak reversal potential</td><td><italic>I</italic><sub>m</sub></td><td>Trans-membrane current</td></tr><tr><td><italic>g</italic><sub>AHP</sub></td><td>AHP conductance</td><td><italic>I</italic><sub>syn</sub></td><td>Synaptic current</td></tr><tr><td><italic>τ</italic><sub>AHP</sub></td><td>AHP time constant</td><td><italic>I</italic><sub>syn</sub></td><td>Synaptic current</td></tr><tr><td><italic>E</italic><sub>AHP</sub></td><td>AHP reversal potential</td><td><italic>I</italic><sub>ext</sub></td><td>External current</td></tr><tr><td>Δ<sub>T</sub></td><td>Spike initiation width</td><td><italic>I</italic><sub>const</sub></td><td>Constant current</td></tr><tr><td><italic>V</italic><sub>T</sub></td><td>Spike initiation threshold</td><td><italic>I</italic><sub><italic>θ</italic></sub></td><td>Theta-modulated current</td></tr><tr><td><inline-formula><mml:math id="inf15"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext> A</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>GABA conductance</td><td><italic>I</italic><sub>vel</sub></td><td>Velocity current</td></tr><tr><td><inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext> A</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>GABA reversal potential</td><td><italic>I</italic><sub>place</sub></td><td>Place cell current</td></tr><tr><td><italic>g</italic><sub>AMPA</sub></td><td>AMPA conductance</td><td><italic>τ</italic><sub>AMPA</sub></td><td>AMPA time constant</td></tr><tr><td><inline-formula><mml:math id="inf17"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext> A</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>GABA time constant</td><td><italic>τ</italic><sub>NMDA</sub></td><td>NMDA time constant</td></tr><tr><td><italic>g</italic><sub>ad</sub></td><td>Adaptation conductance</td><td><italic>τ</italic><sub>ad</sub></td><td>Adaptation time constant</td></tr><tr><td><inline-formula><mml:math id="inf18"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>AHP</mml:mtext></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>AHP maximal value</td><td><inline-formula><mml:math id="inf19"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>ad</mml:mtext></mml:mrow><mml:mrow><mml:mtext>inc</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>Adaptation conductance increase</td></tr><tr><td><italic>A</italic><sub><italic>θ</italic></sub></td><td><italic>θ</italic>-current amplitude</td><td><italic>f</italic><sub><italic>θ</italic></sub></td><td><italic>θ</italic>-current frequency</td></tr><tr><td><italic>ϕ</italic><sub><italic>θ</italic></sub></td><td><italic>θ</italic>-current phase</td><td>–</td><td>–</td></tr><tr><td><italic>w</italic><sub>AMPA</sub></td><td>AMPA synaptic weight</td><td><italic>w</italic><sub>NMDA</sub></td><td>NMDA synaptic weight</td></tr><tr><td><inline-formula><mml:math id="inf20"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext> A</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>GABA synaptic weight</td><td>–</td><td>–</td></tr></tbody></table><table-wrap-foot><fn><p>For the exact values used in the simulations, refer to <xref ref-type="table" rid="tbl1">Appendix tables 1</xref>, <xref ref-type="table" rid="tbl3 tbl4 tbl5">3–5</xref>.</p></fn></table-wrap-foot></table-wrap><table-wrap id="tbl3" position="float"><object-id pub-id-type="doi">10.7554/eLife.06444.039</object-id><label>Appendix table 3.</label><caption><p>Single neuron parameter values for all cells</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.039">http://dx.doi.org/10.7554/eLife.06444.039</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Name</th><th>Units</th><th>Value (E cells)</th><th>Value (I cells)</th></tr></thead><tbody><tr><td><italic>C</italic><sub>m</sub></td><td>pF</td><td>211.389</td><td>227.3</td></tr><tr><td><italic>E</italic><sub>L</sub></td><td>mV</td><td>−68.5</td><td>−60</td></tr><tr><td><italic>V</italic><sub>T</sub></td><td>mV</td><td>−50</td><td>−45</td></tr><tr><td><italic>V</italic><sub>r</sub></td><td>mV</td><td>−68.5</td><td>−60</td></tr><tr><td><italic>g</italic><sub>L</sub></td><td>nS</td><td>22.73</td><td>22.73</td></tr><tr><td>Δ<sub>T</sub></td><td>mV</td><td>0.4</td><td>0.4</td></tr><tr><td><italic>E</italic><sub>AHP</sub></td><td>mV</td><td>−80</td><td>×</td></tr><tr><td><italic>τ</italic><sub>AHP</sub></td><td>ms</td><td>20</td><td>×</td></tr><tr><td><inline-formula><mml:math id="inf21"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>AHP</mml:mtext></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>nS</td><td>5</td><td>×</td></tr><tr><td><italic>τ</italic><sub>ad</sub></td><td>ms</td><td>×</td><td>7.5</td></tr><tr><td><inline-formula><mml:math id="inf22"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>ad</mml:mtext></mml:mrow><mml:mrow><mml:mtext>inc</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>nS</td><td>×</td><td>22.73</td></tr></tbody></table></table-wrap><table-wrap id="tbl4" position="float"><object-id pub-id-type="doi">10.7554/eLife.06444.040</object-id><label>Appendix table 4.</label><caption><p>Parameter values for external inputs</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.040">http://dx.doi.org/10.7554/eLife.06444.040</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Name</th><th>Units</th><th>Value (E cells)</th><th>Value (I cells)</th></tr></thead><tbody><tr><td><italic>I</italic><sub>const</sub></td><td>pA</td><td>300</td><td>200</td></tr><tr><td><italic>A</italic><sub><italic>θ</italic></sub></td><td>pA</td><td>375</td><td>25</td></tr><tr><td><italic>ϕ</italic><sub><italic>θ</italic></sub></td><td>rad</td><td>−<italic>π</italic>/2</td><td>−<italic>π</italic>/2</td></tr><tr><td><italic>f</italic><sub><italic>θ</italic></sub></td><td>Hz</td><td>8</td><td>8</td></tr></tbody></table></table-wrap><table-wrap id="tbl5" position="float"><object-id pub-id-type="doi">10.7554/eLife.06444.041</object-id><label>Appendix table 5.</label><caption><p>Parameter values for synaptic profiles</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.041">http://dx.doi.org/10.7554/eLife.06444.041</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Name</th><th>Units</th><th>Value</th></tr></thead><tbody><tr><td><italic>μ</italic></td><td>normalised</td><td>0.433</td></tr><tr><td><italic>σ</italic><sub>exc</sub></td><td>normalised</td><td>0.0834</td></tr><tr><td><italic>σ</italic><sub>inh</sub></td><td>normalised</td><td>0.0834</td></tr><tr><td>C</td><td>normalised</td><td>0.03</td></tr><tr><td><italic>λ</italic><sub>grid</sub></td><td>cm</td><td>60</td></tr></tbody></table></table-wrap></p></sec><sec id="s7-2"><title>Synaptic connection profiles</title><p>In the majority of the simulations the attractor model simulates only connections from E to I cells and vice versa. Synapse strengths of connections originating from E cells are generated by a Gaussian-like function with values dependent on the distance between a presynaptic (<italic>j</italic>) and postsynaptic (<italic>i</italic>) cell on the twisted torus:<disp-formula id="equ16"><label>(11)</label><mml:math id="m16"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mtext>AMPA</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">e</mml:mi><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext> exc</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ17"><label>(12)</label><mml:math id="m17"><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">e</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>−</mml:mi><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>−</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="italic">p</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>torus</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ18"><label>(13)</label><mml:math id="m18"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mtext> NMDA</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>NMDA</mml:mtext></mml:msub><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mtext> AMPA</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In these equations, <italic>μ</italic> is the distance of the excitatory surround from the position of presynaptic neuron, <italic>σ</italic><sub>exc</sub> is the width of the excitatory surround, <inline-formula><mml:math id="inf5"><mml:mrow><mml:mo>|</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mtext>torus</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a distance on the twisted torus that takes the boundaries of the torus into account and <italic>C</italic> is the synaptic profile shift. The excitatory connections are composed of the equivalent amount of NMDA synaptic conductances. The synaptic strengths of NMDA is specified by a fractional constant <italic>C</italic><sub>NMDA</sub>. In all simulations, the NMDA conductance constituted 2% of the AMPA conductance, which was an amount necessary to retain the information about the position of the bump attractor during consecutive theta cycles, while not too high to prevent generation of nested gamma oscillations. In <xref ref-type="disp-formula" rid="equ17">Equation 12</xref>, <bold>e</bold><sub><italic>p</italic></sub> determines the shift of the center of the outgoing synaptic strength profile on the torus, and was used to couple the velocity of the bump with the animal velocity (<xref ref-type="bibr" rid="bib5">Burak and Fiete, 2009</xref>; <xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). The velocity modulated input is described in more detail in ‘Velocity modulated input current’.</p><p>Synapse strengths from I cells to E cells in networks with structured connections were generated by a Gaussian function<disp-formula id="equ19"><label>(14)</label><mml:math id="m19"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext> GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext> A</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext> I</mml:mtext></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext> inh</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>that takes a distance between the pre- and post-synaptic neurons (<italic>d</italic>(<italic>i</italic>, <italic>j</italic>, 0, 0)) and a width of the Gaussian (<italic>σ</italic><sub>inh</sub>) as parameters. As can be seen from <xref ref-type="disp-formula" rid="equ19">Equation 14</xref>, inhibitory neurons do not have shifts in their outgoing synaptic profiles. In addition, a distance-independent I → E inhibitory connectivity was generated for which the probability of connection between the pre- and post-synaptic cell was 0.4 and the weight of a connection was set to <inline-formula><mml:math id="inf6"><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>013</mml:mn><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mtext> I</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The total inhibitory synaptic weight was thus a sum of <inline-formula><mml:math id="inf7"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext> GABA</mml:mtext></mml:mrow><mml:mrow><mml:mtext> A</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ19">Equation 14</xref> and the distance-independent component. In simulations with recurrent I → I connectivity (E-I-I networks), I neurons were mutually connected with a connection probability of 0.1 and a constant synaptic weight of 69 pS.</p><p>In networks that contain recurrent E → E connectivity, the connections between E cells were modelled as a Gaussian function, that is, similarly to <xref ref-type="disp-formula" rid="equ19">Equation 14</xref>:<disp-formula id="equ20"><label>(15)</label><mml:math id="m20"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mtext> E</mml:mtext><mml:mo>→</mml:mo><mml:mtext> E</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mtext>E</mml:mtext><mml:mo>→</mml:mo><mml:mtext> E</mml:mtext></mml:mrow></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">e</mml:mi><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext> E</mml:mtext><mml:mo>→</mml:mo><mml:mtext> E</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>C</italic>, <bold>e</bold><sub><italic>p</italic></sub> and <italic>σ</italic><sub>E → E</sub> have the same meaning as in <xref ref-type="disp-formula" rid="equ16">Equation 11</xref>. In these simulations, if not stated otherwise, <italic>g</italic><sub>E → E</sub> = 0.5 nS.</p><p>We also evaluated networks in which E → I and I → E synapses were unstructured and have a constant value. Here, the E → E synaptic weights were set according to <xref ref-type="disp-formula" rid="equ20">Equation 15</xref> and the excitatory and inhibitory synaptic weights for E → I and I → E synapses were set to <italic>g</italic><sub>E</sub>/<italic>d</italic> and <italic>g</italic><sub>I</sub>/<italic>d</italic> respectively, where <italic>d</italic> is a probability of connection between the presynaptic and postsynaptic neuron, set to 0.1. The density factor <italic>d</italic> was used in order to ensure equivalence of total synaptic input of a postsynaptic cell when compared to networks that have all-to-all connectivity (<xref ref-type="disp-formula" rid="equ16 equ19 equ20">Equations 11, 14, 15</xref>).</p><p>Finally, in networks where connection strengths were generated probabilistically instead of in an all-to-all way, the synaptic weights from E to I cells and vice versa were all constant and set to <italic>g</italic><sub>E</sub> and <italic>g</italic><sub>I</sub> respectively, while the probability of connection between the pre- and post-synaptic neuron was drawn according to <xref ref-type="disp-formula" rid="equ16">Equation 11</xref> for E → I synapses, and <xref ref-type="disp-formula" rid="equ19">Equation 14</xref> for I → E synapses.</p></sec><sec id="s7-3"><title>Velocity modulated input current</title><p>All simulations of grid fields and estimations of the velocity input gain contain current input modulated by the speed and direction of the simulated animal. Although translational activity can be achieved by inputs to either of the populations (<xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>), here we have simulated velocity modulated inputs only onto the E cell population. All E cells are assigned a preferred direction vector (<xref ref-type="disp-formula" rid="equ17">Equation 12</xref>) that shifts the outgoing synaptic profile in the direction specified by the unit vector <bold>e</bold><sub><italic>p</italic></sub> in <xref ref-type="disp-formula" rid="equ17">Equation 12</xref>. The preferred directions are drawn from a set of four unit vectors pointing up, down, left and right so that all directions are distributed along the twisted torus.</p><p>During simulated movement of the animal, the velocity modulated current injected into the neuron <italic>i</italic> is computed as follows (here ⋅ is a dot product):<disp-formula id="equ21"><mml:math id="m21"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi mathvariant="bold">e</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ22"><label>(16)</label><mml:math id="m22"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:msub><mml:mi>λ</mml:mi><mml:mtext>grid</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The gain of the velocity input (<italic>C</italic><sub><italic>v</italic></sub>) is determined from the number of neurons the bump needs to translate in order to return to the original position (<italic>N</italic><sub><italic>x</italic></sub> [neurons]; on a twisted torus this quantity is effectively the horizontal size of the neural sheet) divided by the product of the expected grid field spacing (<italic>λ</italic><sub>grid</sub> [cm]) and a slope of the relationship between bump speed and injected velocity current magnitude (<italic>a</italic> [neurons/s/pA]). Therefore, given a desired spacing between grid fields, the gain of the velocity inputs can be calibrated.</p></sec><sec id="s7-4"><title>Place cell input</title><p>Because of the finite network size, spiking variability, or imperfections in the synaptic profile functions, the position of bump attractor in the network might drift over time. The simulations of grid firing fields (<xref ref-type="fig" rid="fig2 fig6 fig7">Figures 2, 6D–I, 7A–C</xref> and associated figure supplements) and simulations that explored the controllability of the network by place cell input (<xref ref-type="fig" rid="fig6s5">Figure 6—figure supplement 5</xref>) included a separate population of cells with place-like firing fields connected to E cells (in all other simulations the input was de-activated). Inputs from these cells opposed drift of the bump attractor.</p><p>Place cells were simulated as independent inhomogeneous Poisson processes, whose rate was modulated by a Gaussian function of the simulated animal location. Thus, the firing rate of an <italic>i</italic>th place cell, <italic>r</italic><sub><italic>i</italic></sub> was:<disp-formula id="equ23"><label>(17)</label><mml:math id="m23"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">l</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>field</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>r</italic><sub>max</sub> is firing rate in the center of the place field, <bold>l</bold> is an instantaneous position of the simulated animal, <bold><italic>μ</italic></bold><sub><italic>i</italic></sub> is the center of the place field and <italic>σ</italic><sub>field</sub> is the width of the place field. In all simulations, there were 900 place cells, with <italic>r</italic><sub>max</sub> = 50 Hz, and <italic>σ</italic><sub>field</sub> = 20 cm. Spikes emitted by place cells were thus generated by independent Poisson processes with rate <italic>r</italic><sub><italic>i</italic></sub>(<italic>t</italic>) in <xref ref-type="disp-formula" rid="equ23">Equation 17</xref>, and the centres of individual place fields were uniformly distributed in the arena the simulated animal was moving in. The connection weights from place cells were arranged in a divergent manner, so that a place cell had strongest connections with grid cells whose firing fields were aligned (in real space) with the firing field of the place cell. The connection weight from place cell <italic>i</italic> to a grid cell <italic>j</italic> decayed according to a Gaussian function<disp-formula id="equ24"><label>(18)</label><mml:math id="m24"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mtext>PC</mml:mtext></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mrow><mml:mtext>PC</mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mtext>G</mml:mtext><mml:mi>j</mml:mi></mml:msubsup><mml:msup><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>PC</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf8"><mml:mrow><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mtext>PC</mml:mtext></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the maximal connection strength between two fully aligned grid and place fields, <inline-formula><mml:math id="inf9"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mrow><mml:mtext>PC</mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is the centre of the place field of the <italic>i</italic>th place cell, <inline-formula><mml:math id="inf10"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mtext>G</mml:mtext><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is the centre of the grid field of the <italic>j</italic>th grid cell that is nearest to the place cell, <italic>σ</italic><sub>PC</sub> is the width of the synaptic profile. The parameters were set to <inline-formula><mml:math id="inf11"><mml:mrow><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mtext>PC</mml:mtext></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> = 0.5 nS and <italic>σ</italic><sub>PC</sub> = 7 cm. Connections from place cells were modelled as AMPA conductances only (<xref ref-type="disp-formula" rid="equ13">Equation 8</xref>). This was sufficient for the purpose of opposing drift of the bump attractor and we therefore do not include any more biological detail into these connections.</p><p>In simulations where I cells received uncorrelated spatial inputs (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>), an additional population of place cells was instantiated, with parameters set to <italic>r</italic><sub>max</sub> = 100 Hz and <italic>σ</italic><sub>field</sub> = 80 cm. Each I cell received connections from three randomly chosen place cells, with a synaptic weight of 4 nS.</p></sec><sec id="s7-5"><title>Bump attractor initialisation</title><p>Each simulation contains an initialisation stage that attempts to set the model into the desired state, that is, a bump attractor. During this stage, the theta-modulated input is switched off and the network receives only the constant input source (see <xref ref-type="disp-formula" rid="equ14">Equation 9</xref>). The bump attractor might not form spontaneously, and instead the network could persist in a uniform firing rate regime (<xref ref-type="bibr" rid="bib4a">Compte et al., 2000</xref>). However, it might be possible that when forced into the attractor state, the network will persist (data not shown). Therefore, we used the place cell input as a spatially-tuned input that served (i) as an initialisation input in order to drive the network into an attractor state if this does not happen spontaneously and (ii) to initialise the bump attractor position so that the phase of grid firing fields matched the positions of place fields. The initialisation phase lasted for the first 500 ms of simulation time, during which the firing rate of place cells were doubled, and the strength of connections from place cells to grid cells was increased 10-fold.</p></sec><sec id="s7-6"><title>Parameter space exploration</title><p>The excitatory and inhibitory parameter space exploration was performed by varying the amount of inhibitory and excitatory synaptic strengths. Since the actual synaptic weights are a function of distance on the twisted torus, we used the maximal conductance of AMPA (<italic>g</italic><sub>E</sub>, <xref ref-type="disp-formula" rid="equ16">Equation 11</xref>) and GABA synapses (<italic>g</italic><sub>I</sub>, <xref ref-type="disp-formula" rid="equ19">Equation 14</xref>) in all the parameter exploration plots. Note that since the amplitude of NMDA conductances was a fixed fraction of that of AMPA, the strength of NMDA was also scaled as a function of <italic>g</italic><sub>E</sub> in line with the scaling of the AMPA conductance and was thus implicitly counted toward <italic>g</italic><sub>E</sub>. Additionally, in <xref ref-type="fig" rid="fig7s10">Figure 7—figure supplement 10</xref>, parameter exploration simulations were performed in which the <italic>g</italic><sub>E → E</sub> synaptic scaling variable, as well as the width of the synaptic profile of E → E connections (<italic>σ</italic><sub>E → E</sub> in <xref ref-type="disp-formula" rid="equ20">Equation 15</xref>) was used.</p></sec><sec id="s7-7"><title>Analysis of spatial firing fields</title><p>Gridness scores were calculated following previous studies (<xref ref-type="bibr" rid="bib33">Sargolini et al., 2006</xref>), by taking the spatial autocorrelation of each firing field (a region corresponding to a circle with radius <italic>λ</italic><sub>grid</sub>/2 and a centre in the middle of the autocorrelation function has been removed) and rotating in steps of three degrees. For each rotation a Pearson correlation coefficient was calculated with the original autocorrelation. To calculate the gridness score the maximum of values at 30, 90 and 150° rotation was subtracted from the minimum of the values at 60 and 120° rotation.</p><p>Spatial information (bits/spike) was calculated according to (<xref ref-type="bibr" rid="bib39">Skaggs et al., 1996</xref>):<disp-formula id="equ25"><label>(19)</label><mml:math id="m25"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mtext> </mml:mtext><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>λ</mml:mi></mml:mfrac><mml:msub><mml:mrow><mml:mtext>log</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>λ</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the environment was divided into <italic>N</italic> bins and <italic>p</italic><sub><italic>i</italic></sub> was the occupancy probability of bin <italic>i</italic>, <italic>λ</italic><sub><italic>i</italic></sub> was the mean firing rate for bin <italic>i</italic> and <italic>λ</italic> was the overall mean firing rate of the cell.</p><p>Spatial sparsity was calculated following (<xref ref-type="bibr" rid="bib4">Buetfering et al., 2014</xref>):<disp-formula id="equ26"><label>(20)</label><mml:math id="m26"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>N</italic>, <italic>p</italic><sub><italic>i</italic></sub> and <italic>λ</italic><sub><italic>i</italic></sub> have the same meaning as in <xref ref-type="disp-formula" rid="equ25">Equation 19</xref>.</p></sec><sec id="s7-8"><title>Estimating gain of the velocity-dependent inputs</title><p>In order to estimate the precision of velocity integration in a continuous attractor, we have performed shorter simulations in which a constant velocity input (in a vertical direction) was injected into E cells for a period of 10 s. Based on this set of simulations, the slope of the relationship between bump speed and the injected velocity current was estimated (in units of neurons/s/pA). The estimation was based on the following algorithm:<list list-type="order"><list-item><p>Estimate the range of bump speeds that need to be covered (<xref ref-type="fig" rid="fig8">Appendix figure 1</xref>).<disp-formula id="equ27"><label>(21)</label><mml:math id="m27"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mtext>bump</mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mtext> grid</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mtext>animal</mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>s</italic><sub><italic>i</italic></sub> are the speeds of the animal/bump, estimated from forward differences of the trajectory of the simulated animal, <italic>N</italic><sub><italic>x</italic></sub> is the horizontal size of the neural sheet (neurons), and <italic>λ</italic><sub>grid</sub> is the grid field spacing (cm). These speeds will form a distribution of bump speeds that the attractor must achieve in order to path integrate without error (<xref ref-type="fig" rid="fig8">Appendix figure 1B</xref>).<fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.06444.042</object-id><label>Appendix figure 1.</label><caption><title>(<bold>A</bold>) Histogram of velocities of a simulated animal.</title><p>(<bold>B</bold>) Histogram of bump speeds derived from the animal velocities estimated in <xref ref-type="disp-formula" rid="equ27">Equation 21</xref>, for different grid field spacings.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06444.042">http://dx.doi.org/10.7554/eLife.06444.042</ext-link></p></caption><graphic xlink:href="elife-06444-app1-fig1-v2.tif"/></fig></p></list-item><list-item><p>Pick a specified percentile from this distribution (here the 99th percentile was used), that is, the maximal speed of the bump, in order to account for the specified fraction of animal velocities, set this as <italic>s</italic><sub>max</sub>. The range of target bump speeds will be &lt;0, <italic>s</italic><sub>max</sub>&gt;.</p></list-item><list-item><p>For each <italic>I</italic><sub>vel</sub> ∈ {0, 10,…, 100} pA, estimate the bump speed by tracking its position on the neural sheet, using the ‘Gaussian fitting procedure’. Repeat this step 10 times. This step acquires data for estimating the relationship between the slope of bump speed and injected velocity current.</p></list-item><list-item><p>For each <inline-formula><mml:math id="inf12"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mtext>vel</mml:mtext></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>100</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> pA, estimate a line fit on data samples with the velocity current in the range of <inline-formula><mml:math id="inf13"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>vel</mml:mtext></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mtext>vel</mml:mtext></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo></mml:mrow></mml:math></inline-formula>, that is, fit the line to only a subset of velocity current data points.</p></list-item><list-item><p>Remove all fits that do not fit at least &lt;0, <italic>s</italic><sub>max</sub>&gt; on the bump velocity axis.</p></list-item><list-item><p>If there are any lines left, select line with the minimal error of fit (normalized by the number of data points used); otherwise select line (from the original list) that covers the maximal range of bump speeds.</p></list-item><list-item><p>Calculate the slope of the selected line and finish.</p></list-item></list></p></sec><sec id="s7-9"><title>Simulation protocols</title><sec id="s7-9-1"><title>Simulations of animal movement</title><p>Simulations of animal movement were carried out for 600 s of simulated time. Here, for each value of <italic>g</italic><sub>E</sub> and <italic>g</italic><sub>I</sub>, the main simulation run was preceded by a number of shorter simulations which determined how much current needs to be injected in order for the bump of activity to track the simulated movement of an animal (‘Estimating gain of the velocity-dependent inputs’). This procedure calibrates the gain of the velocity input current in order to produce grid fields with a specified spacing between the peaks in the individual firing fields. The result is a single number in units of neurons/s/pA, which determines the speed of the bump as a function of injected velocity input. The spacing between the individual fields of the grid firing fields was set to 60 cm in all of the simulations.</p><p>During the main simulation run, the animal movement was simulated for 600 s. Each of the runs was repeated four times for simulations in <xref ref-type="fig" rid="fig2">Figure 2</xref> and three times for simulations in <xref ref-type="fig" rid="fig6">Figure 6D–I</xref> and once for networks that contain additional recurrent synapses between E cells or I cells, as well as in networks with synapses generated probabilistically. These simulations use the estimated velocity response gain in order to calibrate the spacing between the grid firing fields. After the simulation was finished, a neuron in the bottom-left corner of the torus was selected for analysis. For this cell the gridness score of its firing field was computed. The reasoning behind choosing only a single cell to estimate the gridness score is as follows. The grid firing fields in the network are a result of coordination of activity of the network as a whole. If the network forms a bump attractor that is able to accurately track animal movement, all cells in the network will have grid-like firing fields that differ only in their phases. On the other hand, if the bump attractor does not form, is unstable, or does not accurately track the position of the animal, the gridness score of all cells will be low. Thus, the firing field of a single cell in the network represents grid field computation in the network as a whole. Moreover, this cell can be selected arbitrarily. This condition might not hold in simulations where I cells receive uncorrelated spatial inputs and therefore in these simulations firing fields of 100 randomly selected cells from both E and I populations were used to calculate the gridness scores (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>).</p></sec><sec id="s7-9-2"><title>Short simulation runs without animal movement</title><p>Some of the simulation runs were used to estimate properties of bump attractors and nested gamma oscillations. In these experiments, instead of simulating animal movement, a shorter, 10 s simulation, was run. The velocity and place cell input were deactivated. Thus, the network is expected to only produce a static bump attractor and does not perform path integration. For each parameter setting (determined by <italic>g</italic><sub>E</sub>, <italic>g</italic><sub>I</sub>, and the noise level), five simulations were performed. For each simulation run, post-synaptic currents were recorded from 25 randomly selected excitatory cells in the model by clamping their membrane potential at −50 mV (this was done by simulating a separate process for each of the selected neurons, while simulating the original membrane potential according to <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). Thus, on each run, different cells could be picked up for analysis. It is in principle possible to record membrane currents from all the neurons. However, the amount of data generated by such simulations quickly becomes overwhelming (on the order of several terabytes per parameter exploration experiment). Thus the approach chosen here was to sample from the population of neurons and store the recorded state variables of only a subset of these. This allowed for unrestricted analysis and visualisation of the recorded state variables.</p></sec></sec><sec id="s7-10"><title>Analysis of nested gamma oscillations</title><p>We estimated the properties of nested gamma oscillations by using autocorrelation functions of the inhibitory currents impinging from inhibitory synapses onto excitatory cells. These currents were estimated from 25 randomly selected excitatory cells recorded during the simulation run. For each neuron, the current was then band-pass filtered between 20 and 200 Hz, the autocorrelation function was computed and then used to detect local maxima after excluding the first peak. The positions of local maxima were calculated as those points in the autocorrelation function where the first difference of the signal changed sign from positive to negative and thus approximated points where the first derivative is zero and the second derivative is negative. The power and frequency of the underlying oscillation was then estimated from the correlation value and from the time lag of the first detected autocorrelation peak respectively. Both values were averaged over all 25 recorded neurons and then subsequently averaged over all simulation trials.</p></sec><sec id="s7-11"><title>Gaussian fitting procedure</title><p>In networks where properties of bump attractors, such as the position and presence of an activity bump, were estimated, we developed a procedure to fit Gaussian functions onto successive snapshots of network activity of E cells. The network activity snapshots were estimated by taking action potential times of all E cells and estimating their immediate firing rate using a 250 ms wide sliding window with a 125 ms time step. For each snapshot, the properties of a bump-like network activity (if it was a bump) were then estimated by fitting a symmetric Gaussian function to the network activity snapshots, using the maximum likelihood estimator under Gaussian noise (the least squares fitting method):<disp-formula id="equ28"><label>(22)</label><mml:math id="m28"><mml:mrow><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext> bump</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>A</italic> was the height of the Gaussian function, <bold>X</bold> was neuron position on the twisted torus, <bold><italic>μ</italic></bold> was the centre of the Gaussian, <italic>σ</italic><sub>bump</sub> was the width of the Gaussian, and <inline-formula><mml:math id="inf14"><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>⋅</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> represents a distance metric on the twisted torus. The parameters fitted were <italic>A</italic>, <bold><italic>μ</italic></bold> and <italic>σ</italic><sub>bump</sub>. These parameters were then used as the basis for further analysis.</p></sec></sec></boxed-text></app></app-group></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.06444.043</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Skinner</surname><given-names>Frances K</given-names></name><role>Reviewing editor</role><aff><institution>University Health Network</institution>, <country>Canada</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see <ext-link ext-link-type="uri" xlink:href="http://elifesciences.org/review-process">review process</ext-link>). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers.</p></boxed-text><p>[Editors’ note: this article was originally rejected after discussions between the reviewers, but the authors were invited to resubmit after an appeal against the decision.]</p><p>Thank you for choosing to send your work entitled “Noise promotes independent control of gamma oscillations and grid firing within a recurrent attractor network” for consideration at <italic>eLife</italic>. Your full submission has been evaluated by Eve Marder (Senior editor) and three peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the decision was reached after discussions between the reviewers. Based on our discussions and the individual reviews below, we regret to inform you that your work will not be considered further for publication in <italic>eLife</italic> at this time.</p><p>While all the reviewers felt that the work was intriguing and could be of interest to the gamma oscillation, noise and grid cell community, there was concern that the present model was not consistent with existing experimental data. Specifically, discrepancies regarding inhibitory cell connectivity and recent experimental work (<xref ref-type="bibr" rid="bib4">Buetfering et al., 2014</xref>) need to be addressed. It was felt that this would require re-doing and/or performing additional simulations to determine whether results remained the same. Further detailed comments for consideration are provided below. While you may choose to resubmit a revised manuscript, please note that substantial progress to address the reviewers' concerns is required for a subsequent review to be considered.</p><p><italic>Reviewer #1</italic>:</p><p>The authors study the noise-sensitivity of a model previously introduced in a Neuron paper. The connectivity is different from other models for grid cells because there is no recurrent excitation; rather the stellate cells interact via inhibitory cells. To obtain nice oscillations it is helpful that cells have similar firing rates, however to encode information in the level of activity it is necessary that cells have different firing rates. The authors determine under what conditions both can be achieved simultaneously and find that there is an optimal noise level. The mechanism described bears some resemblance to study of an interneuron network by <xref ref-type="bibr" rid="bib43">Tiesinga and Jose (2000)</xref> wherein noise reduces the effects of heterogeneity in firing rate on the level of gamma synchronization and increases the range of conductances for which oscillations are obtained, but at the price of neurons not firing on each cycle, similar to the results shown in the manuscript. The results are nice and I found the paper interesting.</p><p>In <xref ref-type="fig" rid="fig2 fig4">Figures 2 and 4</xref> place fields are shown. I presume they are from E cells. What do the place fields for I cells look like? Does this conform to experimental data?</p><p>From the Neuron paper I gather that there is no recurrent excitation, but what is the evidence for the absence of mutual inhibition?</p><p>The neurons are connected all to all. Would an actual stochastic connectivity according to a probability that is scaled to the conductance pattern shown in <xref ref-type="fig" rid="fig1">Figure 1B</xref>, also work and provide the appropriate noise level?</p><p>The authors focus on varying synaptic strength g<sub>I</sub> and g<sub>E</sub>, which shows the robustness of oscillations/attractor states, but I would expect that synaptic strength of the network in vivo would not vary that much over time, or could that happen through synaptic plasticity effects? It would be nice to discuss the relevance of the conductance range investigated.</p><p><italic>Reviewer #2</italic>:</p><p>I have only one major comment. This work is largely based on this lab's prior finding that layer II stellate cells do not show recurrent connectivity. This was a problem for standard attractor model connectivity, so the authors conceived the E-I-E attractor model. I think this is great. But, it remains possible that layer II pyramidal cells do show recurrent connectivity, which would support the standard attractor models. There is now controversy which cell types correspond to grid cells, and thus far the published (recent Neuron paper from Brecht's lab) and unpublished (David Roland's poster at SfN from the Moser lab) data suggest that both cell types in layer II are grid cells. Since pyramidal cells might/probably show recurrent connectivity, I would like to know if the same principles about noise emphasized by this paper would also apply to more standard E–E attractor models. I wouldn't ask the authors to explicitly model this, but do the authors have any insight about this that they could add to the Discussion? This is especially relevant to their very broad discussion about the beneficial role of noise in neural computation in general and the protective role of noise against seizures. Most cortical circuits have recurrent excitatory connectivity. Perhaps the authors could address more standard E–E attracter that contains global inhibition in their discussion.</p><p><italic>Reviewer #3</italic>:</p><p>The authors created a recurrent attractor network, and investigated how noise affected synaptic activity at gamma frequencies and grid firing. Their recurrent attractor network incorporates E-I-E connectivity to produce grid firing through a velocity-dependent update of network attractor states, and also produce theta-nested gamma frequencies. They found that noise can increase the range of synaptic strengths with which gamma activity and grid computations are produced, and that synaptic gamma frequency and amplitude can be modulated independently from the grid firing.</p><p>In general, the manuscript was well-written, and the results logically follow from their model. However, fundamental questions about the model itself are important to consider. Recently, Buetfering and colleagues found that parvalbumin-positive (PV+) interneurons in the medial entorhinal cortex (MEC) integrate input form grid cells with various phases, and exhibited low spatial sparsity and no spatial periodicity (<xref ref-type="bibr" rid="bib4">Buetfering et al., 2014</xref>. Nat Neurosci 17(5):710–718.). This argues against a scenario in which fast-spiking interneurons mediate grid cell phase-dependent recurrent inhibition in the MEC – a necessary component of the authors' recurrent attractor network model, where the activity bump in the E-cell population is reflected by an inverted bump in I-cell population activity. This discrepancy needs to be addressed.</p><p>[Editors’ note: what now follows is the decision letter after the authors submitted for further consideration.]</p><p>Thank you for resubmitting your work entitled “Noise promotes independent control of gamma oscillations and grid firing within recurrent attractor networks” for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by Eve Marder (Senior editor), a Reviewing editor, and two additional reviewers.</p><p>The manuscript has been significantly improved and only minor revisions are required. Once you have addressed these trailing issues, the manuscript should be acceptable without further review.</p><p><italic>Reviewer #1 Minor Comments</italic>:</p><p>I have one minor question, in their new <xref ref-type="fig" rid="fig2">Figure 2</xref>, they show unimodal spatial autocorrelation images of the I cells. This does occur in the Buetfering paper <xref ref-type="fig" rid="fig4">Figure 4A</xref>, but there are also a few with a weak periodic pattern (lower right panel of <xref ref-type="fig" rid="fig4">Figure 4A</xref>, grid score 0.18). Can this be found in the simulations as well?</p><p><italic>Reviewer #2 (General assessment and major comments (Required))</italic>:</p><p>The authors responded to my comments adequately. In addition to the initial goal of exploring conductance parameters from E-I and I-E, the manuscript now provides substantially additional simulations to support E-I-E attractor models in general.</p><p>In their rebuttal the authors defend against the criticism that experimental data has not shown grid firing fields in inhibitory neurons. This criticism manifests from Buettfering et al., 2014 who report that PV interneurons do not show grid firing patterns. The authors have completed additional analyses and expanded their discussion to argue that these experimental data are no inconsistent with E-I models. (1) I cells in their model are weakly tuned grid cells (often below the gridness threshold used by Buettfering). (2) New simulations show that I cells show less grid-like activity when they are connected to uncorrelated grid cells. (3) The authors point out that <xref ref-type="bibr" rid="bib4">Buetfering et al., 2014</xref> only examine PV interneurons, and thus, other interneurons could exhibit grid firing fields. Overall I find these arguments convincing (especially #2), which fuel the debate about the structure of plausible E-I models and lead to new predictions (non-spatially correlated input to I cells, and/or other interneuron classes show grid properties). Close examination of experimental data show clear grids and not-so-clear grids (Krupic, Burgess, and O'Keefe, 2012) which may to correspond to firing on different theta phases (Newman and Hasselmo, 2014), similar to many interneuron classes in CA1 of the hippocampus.</p><p>The authors add I–I connectivity, consistent with their experimental data, and the model is robust. This suggestion and implementation has strengthened the manuscript.</p><p>My concern about E–E models has been addressed. While I do believe E–E models are still possible the authors correctly argue that this issue is far from settled. We do not yet have a clear understanding of MEC microcircuits, especially intralaminar connections that may or may not be needed for grid cell generation. However, the authors add additional simulations of E-E-I models, which provide similar results to the E-I models.</p><p><italic>Reviewer #3</italic>:</p><p>Overall, we think that the authors have addressed our concerns. In particular, the additional simulations and discussions about how their findings relate to <xref ref-type="bibr" rid="bib4">Buetfering et al. (2014)</xref>, examining the effect of recurrent inhibition (I–I) has made the paper much stronger, and tying their results into some experimentally testable predictions.</p><p>The general results showing how different mechanisms could control grid activity and gamma oscillations are interesting, although a bit more of an explanation of the precise mechanisms of their gamma oscillation is needed (i.e., first paragraph of Discussion).</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.06444.044</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the author responses to the first round of peer review follow.]</p><p>We appreciate the initial enthusiasm of the reviewers for the manuscript and recognise their concerns regarding possible discrepancies between inhibitory cell connectivity and recent experimental work. In recognition of the editorial view that addressing these concerns would require “re-doing and/or performing additional simulations to determine whether results remained the same”, we have carried out substantial additional simulations and analysis that we believe addresses in full the issues raised by the reviewers and further strengthens the conclusions of our study. Our additional work includes the following new advances:</p><p>1) To address the concern that there may be discrepancies between our proposed models for grid firing and recent data from Buetfering et al. we have adopted two approaches. First, we analysed in detail the spatial firing properties of interneurons in networks that we simulate. We find that these properties are in fact consistent with the Buetfering et al. data set. Importantly, our new results provide substantial benchmarks against which future experimental data can be evaluated. Second, whereas previously we did not directly address the results of Buetfering et al., in a revised manuscript we will present our new analysis and will also highlight that the Buetfering study focuses only on a subset of inhibitory neurons that are labelled by parvalbumin. It remains to be determined whether these, or another population of interneurons, is more relevant to the predictions made by the models that we propose.</p><p>2) To address the concern about the extent to which our results hold if known connections between interneurons are incorporated into our model, we have carried out additional simulations with models that incorporate this connectivity. While our initial model was deliberately simplified to facilitate its analysis, we now show that our main conclusions nevertheless hold when inhibitory connections between interneurons are accounted for. These new simulations also demonstrate for the first time that this additional inhibitory connectivity increases the robustness of grid firing and the frequency of gamma oscillations.</p><p>3) To address concerns about scenarios in which connections between excitatory neurons may play important roles in grid firing, for example if pyramidal rather than stellate cells are the primary generators of grid activity, we have adopted two approaches. First, we have implemented new models in which structured coupling between excitatory cells is incorporated along with the existing structured interactions between excitatory and inhibitory cells. Our new data demonstrate that this scenario has little impact on our main conclusions. Second, we evaluate scenarios in which only connections between excitatory neurons are structured. We find that in this scenario excitatory feedback causes circuits to become unstable and as a result we are unable to identify network configurations that support grid firing. This is consistent with previous theoretical work demonstrating instability of much simpler attractor networks based exclusively on structured excitation. As these new data suggest that structured connections between excitatory neurons are on their own unlikely to support grid firing in networks of spiking neurons, they further support our proposal that grid attractors are primarily generated through interactions between excitatory and inhibitory cells.</p><p>4) We have carried out new simulations that address concerns about the detailed implementation of our models. For example, we have evaluated models in which connections are probabilistic. Results of simulations with these models are in line with our original conclusions.</p><p>Given that our new data and analysis address the reviewers' previous concerns in full, and provide further strong support for our initial conclusions, we would like to submit to <italic>eLife</italic> a revised version of our manuscript incorporating these findings.</p><p>We continue to believe that our results will be of interest to a broad and diverse audience. Our study offers novel and general insights into the relationship between gamma oscillations and neural computation, and their dependence on underlying synaptic mechanisms. By establishing direct causal relationships between synaptic mechanisms, computation and gamma oscillations our results will guide future investigation of normal cognitive states, and of disorders including autism and schizophrenia. We hope that given the substantial new work that we have carried out it will be suitable for publication in <italic>eLife.</italic></p><p>Reviewer #1:</p><p><italic>The authors study the noise-sensitivity of a model previously introduced in a Neuron paper. The connectivity is different from other models for grid cells because there is no recurrent excitation; rather the stellate cells interact</italic> via <italic>inhibitory cells. To obtain nice oscillations it is helpful that cells have similar firing rates, however to encode information in the level of activity it is necessary that cells have different firing rates. The authors determine under what conditions both</italic> can <italic>be achieved simultaneously and find that there is an optimal noise level. The mechanism described bears some resemblance to study of an interneuron network by</italic> <xref ref-type="bibr" rid="bib43"><italic>Tiesinga and Jose (2000)</italic></xref> <italic>wherein noise reduces the effects of heterogeneity in firing rate on the level of gamma synchronization and increases the range of conductances for which oscillations are obtained, but at the price of neurons not firing on each cycle, similar to the results shown in the manuscript. The results are nice and I found the paper interesting</italic>.</p><p>We apologize for the oversight and now cite the study by <xref ref-type="bibr" rid="bib43">Tiesinga and Jose (2000)</xref> in the Discussion. In their study of stochastic weak synchronization in interneuron networks, noise is required for emergence of oscillations, but increasing noise suppresses oscillations. Nevertheless, the model considered by <xref ref-type="bibr" rid="bib43">Tiesinga and Jose (2000)</xref> differs in important ways from the models we investigate here. In particular, it does not generate network attractor states or appear to carry out a rate-coded computation, and it does not include excitatory neurons.</p><p><italic>In</italic> <xref ref-type="fig" rid="fig2 fig4"><italic>Figures 2 and 4</italic></xref> <italic>place fields are shown. I presume they are from E cells. What do the place fields for I cells look like? Does this conform to experimental data</italic>?</p><p><xref ref-type="fig" rid="fig2">Figure 2</xref> shows spatial firing fields from E cells and <xref ref-type="fig" rid="fig4">Figure 4</xref> shows network activity of E cells. We have modified the figure legends to make this clear<bold>.</bold></p><p>We did not previously show the I cell fields because our focus was on grid firing and we previously reported predicted spatial firing properties of I cells in E-I networks (e.g. <xref ref-type="fig" rid="fig7">Figure 7</xref> in <xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). Given the interest of the reviewer we have now amended <xref ref-type="fig" rid="fig2">Figure 2A–C</xref> to show examples of I cell fields alongside the firing fields of the E cells.</p><p>The previous version of our manuscript also did not address the relationship of the firing fields of I cells to experimental data. While not an initial focus of this study, we now include substantial new data, analysis and discussion to address this. Our major changes relevant to this issue are as follows.</p><p>1) Only the spatial firing fields of parvalbumin (PV) positive interneurons have been examined experimentally (see Buetfering et al., Nature Neuroscience, 2014). These PV cells have firing fields with significant spatial stability, but compared with grid cells they on average have much lower spatial sparsity and grid scores. These observations were interpreted by Buetfering et al. as evidence against E-I models, which we showed previously to predict spatial firing by I cells (cf. <xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>). However, before reaching this conclusion it is important to first consider carefully the predictions of E-I models. We now report additional analysis which demonstrates that in E-I models that generate grid firing, the firing fields of I cells have substantially lower spatial sparsity, spatial information and grid scores than E cells (<xref ref-type="fig" rid="fig2">Figure 2A–C</xref> and <xref ref-type="fig" rid="fig2s2 fig2s3">Figure 2–figure supplement 2–3)</xref>. Importantly, the grid scores of I cells in all network configurations are less than the corresponding E cells and in many network configurations are &lt;0.4, which is below the cut off applied by Buetfering et al. to identify grid firing.</p><p>2) To obtain a better understanding of the robustness of spatial firing by I cells to interference from out of field spatial input, and of the distribution of spatial firing within an E-I network, we have also simulated E-I networks in which I cells receive uncorrelated spatial input. We find that grid firing in E-I networks is robust to substantial uncorrelated spatial inputs. Importantly, in these simulations we find further reductions in the rotational symmetry of interneuron firing fields, and as a result a further reduction of their grid scores. We report this new data in Figure 2–figure supplement 6. Together, these results establish that E-I networks can generate grid firing by E cells in conditions in which I cells have spatial firing that does not satisfy current metrics for gridness. Thus, the Buetfering data set is in fact consistent with the properties of I cells in E-I attractor networks.</p><p>3) While the Buetfering et al. data clearly show spatial firing of PV-interneurons and as we show above are broadly consistent with our model predictions, the firing properties of other classes of interneuron in the MEC are unknown. Thus, it remains to be determined if other types of interneurons present in layer II can exhibit spatial firing fields predicted by E-I networks as these have not been recorded from in the study by <xref ref-type="bibr" rid="bib4">Buetfering et al., 2014</xref>. We now make this issue clear in the Discussion.</p><p>In summary, the experimental data published to date is consistent with E-I classes of model that we consider here. Importantly, our new analysis provides substantial benchmarks against which future experimental data can be evaluated.</p><p><italic>From the Neuron paper I gather that there is no recurrent excitation, but what is the evidence for the absence of mutual inhibition</italic>?</p><p>Our experimental observations indicate that mutual inhibition is likely to be present between interneurons that also connect with stellate cells (cf. Pastoll et al. <xref ref-type="fig" rid="fig3">Figure 3D</xref>). As the reviewer notes, this was not included in our original model. This was primarily to reduce the complexity of the model and therefore make analysis more tractable.</p><p>To address this we have carried out new simulations in which I–I connectivity is included in the network. In these simulations our primary qualitative conclusions hold (see <xref ref-type="fig" rid="fig7">Figure 7</xref> and <xref ref-type="fig" rid="fig7s1 fig7s10 fig7s2 fig7s3 fig7s4 fig7s5 fig7s6 fig7s7 fig7s8 fig7s9">Figure 7–figure supplements 1–10</xref>). Interestingly, in addition we find that addition of I–I connections causes an overall increase in the frequency of gamma oscillations (see <xref ref-type="fig" rid="fig7">Figure 7D–I</xref>). This is important because previously the gamma oscillations in our simulated E-I networks had frequency at the lower end of that observed experimentally (cf. Chrobak and Buzsaki, 1998; <xref ref-type="bibr" rid="bib30">Pastoll et al., 2013</xref>), whereas with more realistic networks incorporating I–I coupling the gamma frequency matches the typical experimental observations more closely.</p><p><italic>The neurons are connected all to all. Would an actual stochastic connectivity according to a probability that is scaled to the conductance pattern shown in</italic> <xref ref-type="fig" rid="fig1"><italic>Figure 1</italic>B</xref><italic>, also work and provide the appropriate noise level</italic>?</p><p>This is an interesting idea. To address it we have simulated networks with the suggested stochastic connectivity scaled and a fixed synaptic weight for each synapse whose value depends on g<sub>E</sub> and g<sub>I</sub> for E and I connections respectively (<xref ref-type="fig" rid="fig1s1">Figure 1–figure supplement 1</xref>). This model reproduces our results obtained previously by simulating models with the all-to-all connectivity. We have now included in the manuscript an illustration of synaptic weights for both simulated cases (<xref ref-type="fig" rid="fig1s1">Figure 1–figure supplement 1</xref>), and the results of the new simulations which demonstrate the role of noise, g<sub>E</sub> and g<sub>I</sub> in models with probabilistic connectivity (<xref ref-type="fig" rid="fig2s3 fig2s4">Figure 2–figure supplements 4 and 5</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3–figure supplement 1</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4–figure supplement 1</xref>, Figure 5–figure supplement 2, Figure 6–figure supplements 7 and 8).</p><p><italic>The authors focus on varying synaptic strength g</italic><sub><italic>I</italic></sub> <italic>and g</italic><sub><italic>E</italic></sub><italic>, which shows the robustness of oscillations/attractor states, but I would expect that synaptic strength of the network</italic> in vivo <italic>would not vary that much over time, or could that happen through synaptic plasticity effects? It would be nice to discuss the relevance of the conductance range investigated</italic>.</p><p>We now add to the Discussion that “Adjustment of g<sub>E</sub> and g<sub>I</sub> could be achieved dynamically through actions of neuromodulators (<xref ref-type="bibr" rid="bib26">Marder, 2012</xref>), or on slower developmental time scales (<xref ref-type="bibr" rid="bib47">Widloski and Fiete, 2014</xref>)”.</p><p>Reviewer #2:</p><p><italic>I have only one major comment. This work is largely based on this lab's prior finding that layer II stellate cells do not show recurrent connectivity. This was a problem for standard attractor model connectivity, so the authors conceived the E-I-E attractor model. I think this is great. But, it remains possible that layer II pyramidal cells do show recurrent connectivity, which would support the standard attractor models. There is now controversy which cell types correspond to grid cells, and thus far the published (recent Neuron paper from Brecht's lab) and unpublished (David Roland's poster at SfN from the Moser lab) data suggest that both cell types in layer II are grid cells. Since pyramidal cells might/probably show recurrent connectivity, I would like to know if the same principles about noise emphasized by this paper would also apply to more standard E–E attractor models. I wouldn't ask the authors to explicitly model this, but do the authors have any insight about this that they could add to the Discussion? This is especially relevant to their very broad discussion about the beneficial role of noise in neural computation in general and the protective role of noise against seizures. Most cortical circuits have recurrent excitatory connectivity. Perhaps the authors could address more standard E–E attracter that contains global inhibition in their discussion</italic>.</p><p>We agree that based on current data stellate and pyramidal cells could both be grid cells, but this issue is far from settled and their relationships to one another are not clear. It is likely that pyramidal cells make excitatory connections to one another (Dhillon and Jones, 1999; <xref ref-type="bibr" rid="bib8">Couey et al., 2013</xref>). There is evidence that pyramidal cells also interact via inhibitory interneurons (Varga et al., 2010) and therefore pure E–E models are unlikely to be applicable. However, it is possible models in which E–E coupling co-exists with E- &gt; I and I- &gt; E coupling might also be consistent with experimental data. We have therefore explored this issue with additional simulations. The results of these simulations of E-E-I networks are similar to our findings with E-I networks. We include the results of these simulations and additional discussion in the revised manuscript (Figure 7–figure supplements 6–11).</p><p>For completeness we have also carried out simulations to evaluate networks in which only connections between excitatory neurons are structured, while interactions between excitatory and inhibitory neurons are uniformly distributed across the network. We find that the resulting unconstrained excitatory feedback causes these networks to be unstable, preventing generation of bump attractors and gamma activity (Figure 7–figure supplement 12).</p><p>Reviewer #3:</p><p><italic>The authors created a recurrent attractor network, and investigated how noise affected synaptic activity at gamma frequencies and grid firing. Their recurrent attractor network incorporates E-I-E connectivity to produce grid firing through a velocity-dependent update of network attractor states, and also produce theta-nested gamma frequencies. They found that noise</italic> can <italic>increase the range of synaptic strengths with which gamma activity and grid computations are produced, and that synaptic gamma frequency and amplitude</italic> can <italic>be modulated independently from the grid firing</italic>.</p><p><italic>In general, the manuscript was well-written, and the results logically follow from their model. However, fundamental questions about the model itself are important to consider. Recently, Buetfering and colleagues found that parvalbumin-positive (PV+) interneurons in the medial entorhinal cortex (MEC) integrate input form grid cells with various phases, and exhibited low spatial sparsity and no spatial periodicity (</italic><xref ref-type="bibr" rid="bib4"><italic>Buetfering et al. 2014</italic></xref><italic>. Nat Neurosci 17(5):710–718.). This argues against a scenario in which fast-spiking interneurons mediate grid cell phase-dependent recurrent inhibition in the MEC – a necessary component of the authors' recurrent attractor network model, where the activity bump in the E-cell population is reflected by an inverted bump in I-cell population activity. This discrepancy needs to be addressed</italic>.</p><p>We appreciate the reviewers point concerning comparisons with the Buetfering et al. dataset, but several issues are important to note.</p><p>1) Our new analysis of I cell firing fields indicates that the Buetfering et al. data are in fact consistent with the predictions of the E-I. Importantly, we show that to be consistent with the models we consider here the experimentally observed interneuron firing fields need not have high spatial periodicity. This is in contrast to the assumption made by Buetfering et al. when interpreting their data. These issues are outlined in more detail in our response to Reviewer 1 above.</p><p>2) Our new simulations, described above in response to Reviewer 2, extend our observations to networks in which E–E coupling is present. They show that our general conclusions hold in these networks too. They also argue that if grid fields are generated through attractor network mechanisms, for which there is now considerable experimental support (e.g. see <xref ref-type="bibr" rid="bib48">Yoon et al., 2013</xref>; Domnisorou et al., 2013; Schmidt-Hieber et al., 2014), then interneurons with spatial firing fields, although not necessarily rotational symmetry of their spatial autocorrelations, are likely to be present regardless of the exact underlying mechanism.</p><p>3) The E-I model does not argue that specifically parvalbumin positive interneurons mediate E-I connectivity underlying grid firing. Thus, other interneuron subtypes not investigated by Buetfering et al. are equally plausible candidates.</p><p>While our previous manuscript overlooked these issues, in the revised manuscript we now make sure they are clearly discussed. Importantly, all of the models we now consider (E-I, E-E-I and E-I-I) support our general conclusions regarding the relationships between noise, g<sub>E</sub> and g<sub>I</sub>.</p><p>[Editors’ note: the author responses to the re-review follow.]</p><p>Reviewer #1 Minor Comments:</p><p><italic>I have one minor question, in their new</italic> <xref ref-type="fig" rid="fig2"><italic>Figure 2</italic></xref><italic>, they show unimodal spatial autocorrelation images of the I cells. This does occur in the Buetfering paper</italic> <xref ref-type="fig" rid="fig4"><italic>Figure 4</italic>A</xref><italic>, but there are also a few with a weak periodic pattern (lower right panel of</italic> <xref ref-type="fig" rid="fig4"><italic>Figure 4</italic>A</xref><italic>, grid score 0.18). Can this be found in the simulations as well</italic>?</p><p>While our new simulations (Figure 3–figure supplement 5) establish in principle that E-I based attractor networks can generate grid outputs even when spatial firing of many E and I cells in the network is not clearly grid-like, the extent to which these networks can account for all details of experimental observations, including the weak periodic pattern referred to by the reviewer, is not yet clear. We have modified the Discussion to highlight this point.</p><p>Reviewer #3:</p><p><italic>Overall, we think that the authors have addressed our concerns. In particular, the additional simulations and discussions about how their findings relate to</italic> <xref ref-type="bibr" rid="bib4"><italic>Buetfering et al. (2014)</italic></xref><italic>, examining the effect of recurrent inhibition (I–I) has made the paper much stronger, and tying their results into some experimentally testable predictions</italic>.</p><p><italic>The general results showing how different mechanisms could control grid activity and gamma oscillations are interesting although a bit more of an explanation of the precise mechanisms of their gamma oscillation is needed (i.e., first paragraph of Discussion)</italic>.</p><p>We have modified the second sentence of the first paragraph of the Discussion to try to address this point.</p></body></sub-article></article>