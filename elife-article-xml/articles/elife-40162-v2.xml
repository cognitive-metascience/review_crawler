<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">40162</article-id><article-id pub-id-type="doi">10.7554/eLife.40162</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Developmental Biology</subject></subj-group></article-categories><title-group><article-title>Motion sensing superpixels (MOSES) is a systematic computational framework to quantify and discover cellular motion phenotypes</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-96054"><name><surname>Zhou</surname><given-names>Felix Y</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4463-1165</contrib-id><email>felix.zhou@ludwig.ox.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-97170"><name><surname>Ruiz-Puig</surname><given-names>Carlos</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9214-3804</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-97171"><name><surname>Owen</surname><given-names>Richard P</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-97172"><name><surname>White</surname><given-names>Michael J</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-97173"><name><surname>Rittscher</surname><given-names>Jens</given-names></name><email>jens.rittscher@eng.ox.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-55275"><name><surname>Lu</surname><given-names>Xin</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6587-1152</contrib-id><email>xin.lu@ludwig.ox.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund7"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf3"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Ludwig Institute for Cancer Research, Nuffield Department of Clinical Medicine</institution><institution>University of Oxford</institution><addr-line><named-content content-type="city">Oxford</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Institute of Biomedical Engineering, Department of Engineering</institution><institution>University of Oxford</institution><addr-line><named-content content-type="city">Oxford</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Big Data Institute, Li Ka Shing Centre for Health Information and Discovery</institution><institution>University of Oxford</institution><addr-line><named-content content-type="city">Oxford</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Mohammadi</surname><given-names>Hamid</given-names></name><role>Reviewing Editor</role><aff><institution>Francis Crick Institute</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Stainier</surname><given-names>Didier Y</given-names></name><role>Senior Editor</role><aff><institution>Max Planck Institute for Heart and Lung Research</institution><country>Germany</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>26</day><month>02</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e40162</elocation-id><history><date date-type="received" iso-8601-date="2018-07-16"><day>16</day><month>07</month><year>2018</year></date><date date-type="accepted" iso-8601-date="2019-01-11"><day>11</day><month>01</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Zhou et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Zhou et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-40162-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.40162.001</object-id><p>Correct cell/cell interactions and motion dynamics are fundamental in tissue homeostasis, and defects in these cellular processes cause diseases. Therefore, there is strong interest in identifying factors, including drug candidates that affect cell/cell interactions and motion dynamics. However, existing quantitative tools for systematically interrogating complex motion phenotypes in timelapse datasets are limited. We present Motion Sensing Superpixels (MOSES), a computational framework that measures and characterises biological motion with a unique superpixel ‘mesh’ formulation. Using published datasets, MOSES demonstrates single-cell tracking capability and more advanced population quantification than Particle Image Velocimetry approaches. From &gt; 190 co-culture videos, MOSES motion-mapped the interactions between human esophageal squamous epithelial and columnar cells mimicking the esophageal squamous-columnar junction, a site where Barrett’s esophagus and esophageal adenocarcinoma often arise clinically. MOSES is a powerful tool that will facilitate unbiased, systematic analysis of cellular dynamics from high-content time-lapse imaging screens with little prior knowledge and few assumptions.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>collective motion</kwd><kwd>dynamic graphs</kwd><kwd>motion analysis</kwd><kwd>superpixels</kwd><kwd>motion maps</kwd><kwd>boundary formation</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100009729</institution-id><institution>Ludwig Institute for Cancer Research</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Zhou</surname><given-names>Felix Y</given-names></name><name><surname>Ruiz-Puig</surname><given-names>Carlos</given-names></name><name><surname>Owen</surname><given-names>Richard P</given-names></name><name><surname>Rittscher</surname><given-names>Jens</given-names></name><name><surname>Lu</surname><given-names>Xin</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000266</institution-id><institution>Engineering and Physical Sciences Research Council</institution></institution-wrap></funding-source><award-id>EP/F500394/1</award-id><principal-award-recipient><name><surname>Zhou</surname><given-names>Felix Y</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution>Oxford Health Services Research Committee</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Owen</surname><given-names>Richard P</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution>Oxford University Clinical Academic Graduate School</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Owen</surname><given-names>Richard P</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000289</institution-id><institution>Cancer Research UK</institution></institution-wrap></funding-source><award-id>C5255/A19498</award-id><principal-award-recipient><name><surname>White</surname><given-names>Michael J</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000266</institution-id><institution>Engineering and Physical Sciences Research Council</institution></institution-wrap></funding-source><award-id>EP/M013774/1</award-id><principal-award-recipient><name><surname>Rittscher</surname><given-names>Jens</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000289</institution-id><institution>Cancer Research UK</institution></institution-wrap></funding-source><award-id>C9720/A18513</award-id><principal-award-recipient><name><surname>Lu</surname><given-names>Xin</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A new computational framework provides a flexible and general approach for single and collective biological motion characterisation and phenotyping ideally suited for high-throughput timelapse screens.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>During tissue development and homeostasis in multicellular organisms, different cell types expand and migrate to form defined organ structures. For example, during wound-healing, both immune and epithelial cells are required to proliferate and coordinately migrate (<xref ref-type="bibr" rid="bib41">Schaffer and Nanney, 1996</xref>; <xref ref-type="bibr" rid="bib10">Clark, 2013</xref>; <xref ref-type="bibr" rid="bib22">Leoni et al., 2015</xref>). Aberrant cellular motion can be caused by deregulation of key signalling pathways in pathological conditions, including cancer, and may be critical for disease development and progression, for example leading to invasion and metastasis. Therefore, there is strong biological and clinical need for precise, quantitative characterisation of cellular motion behaviour in a tissue-relevant context to objectively compare the effects of drugs and genetic mutations.</p><p>When two cell populations adjoin <italic>in vivo</italic>, they often form a sharp, stable interface termed a ‘boundary’, with limited intermingling (<xref ref-type="bibr" rid="bib11">Dahmann et al., 2011</xref>). In adult humans, sharp boundaries separate different types of epithelia, such as between the squamous and columnar epithelia in the esophagus, cervix and anus. Disruption of these boundaries can lead to disease. For example, disruption of the esophageal squamous columnar epithelial boundary is a feature of Barrett’s Esophagus (BE), a condition that confers a 30–50 fold increased risk of esophageal adenocarcinoma (EAC) (<xref ref-type="bibr" rid="bib16">Gaddam et al., 2013</xref>). Understanding how complex tissue motion dynamics relate to pathological phenotypes, and how they can be affected by intrinsic and extrinsic factors, is therefore a key challenge in biomedical research. Live cell imaging over a long time (e.g. hours/days) is required to study the underlying complex cellular motion.</p><p>Recently, there has been a rising interest in scaling up live cell imaging for unbiased high-throughput screening and analysis to identify drug targets and develop therapies that can cause or prevent abnormal cellular motion (<xref ref-type="bibr" rid="bib43">Schmitz et al., 2010</xref>; <xref ref-type="bibr" rid="bib19">Held et al., 2010</xref>; <xref ref-type="bibr" rid="bib35">Pau et al., 2013</xref>). Accordingly, a diverse range of co-culture experimental assays have been developed (<xref ref-type="bibr" rid="bib17">Goers et al., 2014</xref>), amongst which wound-healing type assays are one of the simplest and most widely used. Attempts have been made to use these assays to study the regulation of complex biological/pathological processes such as the stable boundary formation between homo- and heterotypic cell populations using live cell imaging over a period of up to 6 days. However, a major barrier is how to analyse the resulting complex biological motion phenotypes and its variation between different tested conditions, particularly for multi-cell type populations (<xref ref-type="bibr" rid="bib17">Goers et al., 2014</xref>) in high-content screens.</p><p>In general, there are two types of cell movements; ‘single-cell’ migration in which each cell migrates independently or ‘collective’ migration where a group of cells migrates together in a coordinated fashion. Single-cell migration has been well studied due to the availability of many single-cell tracking methods that can extract rich motion features even for unbiased high-throughput screens (<xref ref-type="bibr" rid="bib33">Padfield et al., 2011</xref>; <xref ref-type="bibr" rid="bib27">Meijering et al., 2012</xref>; <xref ref-type="bibr" rid="bib26">Maška et al., 2014</xref>; <xref ref-type="bibr" rid="bib42">Schiegg et al., 2015</xref>; <xref ref-type="bibr" rid="bib32">Nketia et al., 2017</xref>). In contrast, collective migration is much less understood due to a lack of tools to extract equally rich quantitative motion features of cell populations in a high-throughput fashion with minimal prior knowledge.</p><p>Extension of existing single-cell tracking methods to analyse collective cell motion in general is non-trivial. Single-cell tracking methods all require accurate single-cell image segmentation, which is highly challenging when cells adjoin or overlap as they do frequently in tissue and confluent cell cultures. Moreover, there is a lack of systematic techniques to associate the motion of individual cells to the global moving collective. Alternatively, existing popular methods to analyse collective motion in cell populations such as Particle Image Velocimetry (PIV) (<xref ref-type="bibr" rid="bib47">Szabó et al., 2006</xref>; <xref ref-type="bibr" rid="bib38">Petitjean et al., 2010</xref>) and its variants (e.g. cell image velocimetry (CIV) (<xref ref-type="bibr" rid="bib29">Milde et al., 2012</xref>)), do not require image segmentation. However, they only extract the global motion for a single video frame in the form of a velocity field, a velocity vector for each image pixel without assignment of pixels to individual cells. This lack of continuous tracking of cellular motion limits the application of PIV methods when characterising collective migration in complex biological phenomena such as boundary formation and chemoattraction. These biological processes often occur over a highly variable time period ranging from minutes to days, and identification of involved cell groups is often desired. Furthermore, PIV-extracted motion fields fail to exploit temporal continuity to reduce noise and avoid perturbations by imaging artefacts including visual clutter, image occlusion, and autofluorescence. Most prohibitively, PIV methods output only the velocities of image pixels. There is a lack of a systematic method to build motion ‘signatures’ to automatically and unbiasedly discriminate and predict biological motion phenotypes in large datasets. To this end, previous studies have attempted to extract additional motion parameters from PIV and appearance parameters from individual video frames (<xref ref-type="bibr" rid="bib31">Neumann et al., 2006</xref>; <xref ref-type="bibr" rid="bib53">Zaritsky et al., 2012</xref>; <xref ref-type="bibr" rid="bib54">Zaritsky et al., 2014</xref>; <xref ref-type="bibr" rid="bib55">Zaritsky et al., 2015</xref>; <xref ref-type="bibr" rid="bib56">Zaritsky et al., 2017</xref>). These include applying velocity-based clustering in migrating monolayers, and handcrafted image features to describe local image appearance using, for example, local binary patterns (<xref ref-type="bibr" rid="bib53">Zaritsky et al., 2012</xref>). However, these approaches are sensitive to the number of identified phenotypes and data outliers, requiring relatively high-quality imaging, restricting the experimental systems they can be applied to. Importantly, all the approaches (<xref ref-type="bibr" rid="bib31">Neumann et al., 2006</xref>; <xref ref-type="bibr" rid="bib53">Zaritsky et al., 2012</xref>; <xref ref-type="bibr" rid="bib54">Zaritsky et al., 2014</xref>; <xref ref-type="bibr" rid="bib55">Zaritsky et al., 2015</xref>; <xref ref-type="bibr" rid="bib56">Zaritsky et al., 2017</xref>) assume prior knowledge of the motion behaviour. Notably, kymographs specifically exploit motion patterns known to be symmetrical around a given spatial axis such as wound healing and cannot be used to identify novel spatial motion features that could be relevant to normal tissue development or to a defined disease setting.</p><p>A suitable computational method for studying cellular motion therefore should be able to address the joint challenge of analysing single-cell and collective motion behaviour. Additionally, it must be: (i) scalable in a medium- or high-throughput manner; (ii) sufficiently robust to handle inevitable variations in image acquisition and experimental protocol; (iii) sensitive to detect motion differences resulting from small changes in environment or stimuli with minimal replicates; (iv) automatic, requiring no manual intervention except for initial setting of parameters; and (v) unbiased to enable motion characterisation (e.g. as a motion ‘signature’) with minimal prior assumptions of motion behaviour.</p><p>To address these analytical challenges, here we developed Motion Sensing Superpixels (MOSES), a computational framework that aims to provide a flexible and general approach for biological motion extraction, characterisation and phenotyping. We empowered PIV-type methods with a mesh formulation that enables systematic measurement and unbiased extraction of rich motion features for single and collective cell motion suitable for high-throughput phenotypic screens. We use the analysis of a multi-well plate-based <italic>in vitro</italic> assay to study the complex cell population dynamics between different epithelial cell types from the esophageal squamous-columnar junction (SCJ) to demonstrate the potential of MOSES. Our analysis illustrates how MOSES can be used to effectively ‘encode’ complex dynamic patterns in the form of a motion ‘signature’, which would not be possible using standard globally extracted velocity-based measures from PIV. Finally, a side-by-side comparison with PIV analysis on published datasets illustrates the biological relevance and the advanced features of MOSES. In particular, MOSES can highlight novel motion phenotypes in high-content comparative biological video analysis.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title><italic>In vitro</italic> model to study the spatio-temporal dynamics of boundary formation between different cell populations</title><p>To develop MOSES, we chose to investigate <italic>in vitro</italic> the boundary formation dynamics between squamous and columnar epithelia at the esophageal squamous-columnar junction (SCJ) (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). To recapitulate features of the <italic>in vivo</italic> boundary formation, we used three epithelial cell lines in pairwise combinations and an experimental model system with similar characteristics to wound-healing and migration assays but with additional complexity. Together the resulting videos pose a number of analytical challenges that require the development of a more advanced method beyond the current capabilities of PIV and CIV.</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.40162.002</object-id><label>Figure 1.</label><caption><title>Temporary divider system to study interactions between cell populations.</title><p>(<bold>A</bold>) The squamous-columnar junction (SCJ) divides the stratified squamous epithelia of the esophagus and the columnar epithelia of the stomach. Barrett’s esophagus (BE) is characterised by squamous epithelia being replaced by columnar epithelial cells. The three cell lines derived from the indicated locations were used in the assays (EPC2, squamous esophagus epithelium, CP-A, Barrett’s esophagus and OE33, esophageal adenocarcinoma (EAC) cell line). (<bold>B</bold>) The three main epithelial interfaces that occur in BE to EAC progression. (<bold>C</bold>) Overview of the experimental procedure, described in steps 1–3. In our assay, cells were allowed to migrate and were filmed for 4–6 days after removal of the divider (step 4). (<bold>D</bold>) Cell density of red- vs green-dyed cells in the same culture, automatically counted from confocal images taken of fixed samples at 0, 1, 2, 3, and 4 days and co-plotted on the same axes. Each point is derived from a separate image. If a point lies on the identity line (black dashed), within the image, red- and green-dyed cells have the same cell density. (<bold>E,F</bold>) Top images: Snapshot at 96 h of three combinations of epithelial cell types, cultured in 0% or 5% serum as indicated. Bottom images: kymographs cut through the mid-height of the videos as marked by the dashed white line. All scale bars: 500 μm. (<bold>G</bold>) Displaced distance of the boundary following gap closure in (<bold>E,F</bold>) normalised by the image width. From left to right, n = 16, 16, 16, 17, 30, 17 videos.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Automated cell counting with convolutional neural networks (CNN).</title><p>(<bold>A</bold>) CNN training procedure. Image patches (64 × 64 pixels) are randomly subsampled from the large DAPI-stained images. The convolutional network is trained to transform a given DAPI image patch to a dot-like image such that the sum of all pixel intensities in the output dot-like image equals the number of cells in the DAPI image. During training, the ideal dot-like image is provided by manual annotation. (<bold>B</bold>) An example of a 64 × 64 pixels image patch of cells stained with DAPI (blue), with individual cells counted manually (left) or by automatic CNN counting (right). Red spots mark individual counted cells. (<bold>C</bold>) Plot of manually annotated cell counts vs automated cell counts tested on 64 × 64 image patches (n = 200). Each point is a patch. The mean absolute deviation (MAD) was 4.86 cells, a percentage error of 3.91% for an average of 124.3 cells per image. Pearson correlation coefficient, r = 0.992. Red dashed line is the ideal identity line. (<bold>D</bold>) Image segmentation of epithelial sheets coloured with red and green dyes, used for sheet-specific cell counting. Grey shaded area is the excluded image area. (<bold>E</bold>) Paired boxplots of cell density (number of cells/sheet area, plotted as x10<sup>3</sup> on y-axis) for each monolayer from fixed samples collected at different times (up to 4 days (96 h) after divider removal). In each pair, the left boxplot is for the red labelled cells and right for the green labelled cells, indicated by red or green dots, respectively. Each dot represents the value from a confocal image. Outline box colour indicates the cell line (see legend). All scale bars: 200 μm.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.004</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Cell migration is largely unaffected by dye colour.</title><p>Mean squared displacement (MSD) curves computed from optical flow plotted on a log<sub>10</sub>-log<sub>10</sub> axis as a function of the time interval for named same cell line combinations in 0% and 5% serum. (<bold>A–C</bold>) MSD curves coloured grey for phase-constrast non-dyed (<bold>A</bold>), red for red-dyed (<bold>B</bold>) and green for green-dyed cells (<bold>C</bold>). (<bold>D</bold>) Errorbar plots showing mean extracted exponent <inline-formula><mml:math id="inf1"><mml:mi>α</mml:mi></mml:math></inline-formula> from MSD = <inline-formula><mml:math id="inf2"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (Materials and methods) ± one standard deviation for time intervals <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> h, for the phase-contrast, red and green sheets of individual phase-contrast plus RGB channel videos. Each point is a video. Two sided <italic>t</italic>-test was applied assuming identical variances. * denotes p = &lt; 0.05. Red and green lipophilic dye reduced the mobility of non-dyed EPC2 and OE33 cells with statistical significance. The size effect was particularly large in OE33, (bottom row marked with orange triangles) with a large drop in the MSD exponent. We do not know the cause but it may be a result of the dyes affecting each cell line differently.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.005</object-id><label>Figure 1—figure supplement 3.</label><caption><title>Motion fields at gap closure between EPC2:EPC2, EPC2:CP-A and EPC2:OE33 cell line combinations.</title><p>(<bold>A</bold>) Snapshot of the combined motion field of red (R) and green (G) dyed cells at the frame of gap closure (16 h, 14 h and 12 h for EPC2:EPC2, EPC2:CP-A, EPC2:OE33 respectively) coloured by direction of movement according to the colour wheel for representative videos. (<bold>B</bold>) Snapshots of the EPC2:OE33 motion field taken at different times following gap closure. Yellow triangles indicate identified motion in ‘green’ cells where the dye fluorescence is nearly lost. (<bold>C</bold>) Confocal staining of a fixed EPC2:OE33 sample at 72 h. DAPI stains the DNA; E-cadherin marks the adherens junctions; actin (<inline-formula><mml:math id="inf4"><mml:mi>β</mml:mi></mml:math></inline-formula>-actin) marks the actin-cytoskeleton; and K7 (Keratin 7) marks the OE33 cells of columnar epithelium origin. All scale bars: 200 μm.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig1-figsupp3-v2.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.006</object-id><label>Figure 1—figure supplement 4.</label><caption><title>Gap closure times and cell proliferation of cell line combinations in 0% and 5% serum.</title><p>(<bold>A</bold>). Boxplots showing median and interquartile range (IQR) of gap closure in EPC2:EPC2, EPC2:CP-A and EPC2:OE33 combinations. Whiskers indicate data within 1.5 x IQR of lower and upper quartiles. Black dashed line = global mean gap closure time. (<bold>B</bold>) Root mean squared displacement (RMSD) curves of<italic> x</italic>-direction velocity components in 0% and 5% serum conditions with mean gap closure point marked (black dashed line) with ± 5 h either side (red dashed lines), the accuracy to which we could detect the gap closure frame (<xref ref-type="fig" rid="fig3s9">Figure 3—figure supplement 9</xref>). (<bold>C,D</bold>) Grouped boxplots of mean cell density (<bold>C</bold>) and cell density change (<bold>D</bold>) from automatic cell counting using convolutional neural networks. Cell line combinations are written cell line 1:cell line 2 thus EPC2:CP-A indicates cell line 1 = EPC2, cell line 2 = CP-A. Cell line 1 and cell line 2 are coloured green and yellow in the boxplots, respectively.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig1-figsupp4-v2.tif"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.007</object-id><label>Figure 1—figure supplement 5.</label><caption><title>Collective sheet migration dynamics are lost in 0% serum.</title><p>(<bold>A</bold>) Samples grown in 0% or 5% serum were fixed for staining at 24 h when the gap between the two sheets have just closed, and at 144 h at the end of filming. DAPI (blue) marks the cell nucleus. E-cadherin (green) marks the adherens junctions. Actin (<inline-formula><mml:math id="inf5"><mml:mi>β</mml:mi></mml:math></inline-formula>-actin, yellow) marks the actin-cytoskeleton. K7 (Keratin 7, red) is a specific marker of columnar cells. All scale bars: 20 μm. (<bold>B</bold>) Spatial correlation curves computed from superpixel tracks as a function of superpixel distance (Materials and methods). Black dots = computed values. Dashed black line = fitted line to black dots of the form, <inline-formula><mml:math id="inf6"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>/</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. Green solid line = median line computed from the black dots. Shaded region = ± 2 standard deviations of the green median line. (<bold>C</bold>) Plot of the extracted values <inline-formula><mml:math id="inf7"><mml:mi>a</mml:mi></mml:math></inline-formula> vs <inline-formula><mml:math id="inf8"><mml:mi>b</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf9"><mml:mi>a</mml:mi></mml:math></inline-formula> is the correlation with superpixels 1 superpixel away and <inline-formula><mml:math id="inf10"><mml:mi>b</mml:mi></mml:math></inline-formula> the characteristic number of superpixels away for which motion is correlated. Each video is a point, see legend for colour code. The higher points are on the plot, the greater the collective motion. Black solid line is the support vector of a linear support vector machine (SVM) trained to separate 0% and 5% serum according to the values of <inline-formula><mml:math id="inf11"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf12"><mml:mi>b</mml:mi></mml:math></inline-formula>. Dashed black lines mark the SVM margin. Serum separability, the ability to predict if a video contains 0% or 5% serum, is defined as the training SVM accuracy using the whole dataset, n = 112 videos (n = 16 each for EPC2:EPC2, EPC2:CP-A, EPC2:OE33 in 0% serum and n = 17 EPC2:EPC2, 30 EPC2:CP-A and 17 EPC2:EPC2 in 5% serum).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig1-figsupp5-v2.tif"/></fig></fig-group><p>To model the relevant esophageal interfaces, we used three epithelial cell lines: EPC2, an immortalised squamous epithelial cell line from the normal esophagus (<xref ref-type="bibr" rid="bib18">Harada et al., 2003</xref>); CP-A, an immortalised BE cell line with gastric columnar epithelial properties (<xref ref-type="bibr" rid="bib28">Merlo et al., 2011</xref>); and OE33, derived from EAC (<xref ref-type="bibr" rid="bib4">Boonstra et al., 2010</xref>). We co-cultured these lines in the following combinations: 1) EPC2:EPC2 (squamous:squamous, as a normal control); 2) EPC2:CP-A (squamous:columnar, as in Barrett’s esophagus); and 3) EPC2:OE33 (squamous:cancer, as in EAC) (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Two epithelial cell populations, each labelled with a different lipophilic membrane dye (<xref ref-type="bibr" rid="bib39">Progatzky et al., 2013</xref>), were co-cultured in the same well of a 24-well plate, separated by a divider with width 500 µm. The divider was removed after 12 h and cells were allowed to migrate towards each other (<xref ref-type="fig" rid="fig1">Figure 1C</xref>).</p><p>We first compared the effects of the two dyes on proliferation and migration using monolayer combinations of the three cell types (<xref ref-type="video" rid="video1">Video 1</xref>). Proliferation was assessed by cell density, automatically counted from DAPI staining using convolutional neural networks (CNN; see <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>, Materials and methods). Migration (diffusive behaviour) was assessed by mean squared displacement (<xref ref-type="bibr" rid="bib34">Park et al., 2015</xref>). Green and red fluorescent-labelled EPC2, CP-A, and OE33 cells proliferated at the same rate (<xref ref-type="fig" rid="fig1">Figure 1D</xref>, for EPC2 cells: slope = 0.976, Pearson correlation coefficient 0.978, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1E</xref>), and migrated in a similar way (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). Compared to non-dyed cells, the mobility of CP-A cells were unaffected however both dyes equally reduced the mobility of EPC2 and OE33 cells. The diffusion modes of all cells were unaffected (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>) and the boundary formation behaviour between dyed and non-dyed cells was identical.</p><media id="video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-40162-video1.mp4"><object-id pub-id-type="doi">10.7554/eLife.40162.008</object-id><label>Video 1.</label><caption><title>Dynamics of monolayer combinations of three oesophageal epithelial cell lines, EPC2:EPC2, CP-A:CP-A, OE33:OE33.</title><p>Bar: 500 μm.</p></caption></media><p>We next analysed boundary formation in the three different combinations of co-cultured epithelial cell lines (EPC2:EPC2, EPC2:CP-A, and EPC2:OE33), initially in serum-containing media (5% fetal bovine serum, FBS). In all three combinations, as expected, both populations moved as epithelial sheets (<xref ref-type="video" rid="video2">Video 2</xref>). Firstly, in the squamous combination using the same EPC2 cell line labelled with two different colours, the green- or red-labelled EPC2:EPC2 cells met and coalesced into a monolayer as expected. Secondly, in the squamous-columnar EPC2:CP-A combination, we observed boundary formation between the two populations after 72 h, following a short period of CP-A ‘pushing’ EPC2. Thirdly, in the squamous-cancer EPC2:OE33 combination, the cancer cell line OE33 expanded continuously, resulting in the disappearance of EPC2 from the field of view (<xref ref-type="video" rid="video2">Video 2</xref>, <xref ref-type="fig" rid="fig1">Figure 1E</xref>) as assessed by the motion field and confocal images (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>). The forces that govern the behaviour of the two cell lines on contact are unknown and traction force microscopy is required to investigate the ‘retracting’ or ‘pushing’ behaviour of EPC2 or OE33 cells respectively in future studies. Nonetheless, the observed boundary formation in the EPC2:CP-A combination and disordered interactions between EPC2:OE33 cells suggest that the three chosen epithelial cell lines in the tested combinations may model certain motion dynamics of the <italic>in vivo</italic> cell-cell interactions. Interestingly, cell counting suggests the observed phenotypes were not due to differential proliferation rate between the individual cell lines in combination (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4C,D</xref>).</p><media id="video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-40162-video2.mp4"><object-id pub-id-type="doi">10.7554/eLife.40162.009</object-id><label>Video 2.</label><caption><title>Sheet migration in EPC2:EPC2, EPC2:CP-A and EPC2:OE33 in 0% and 5% FBS.</title><p>No boundary forms in 0% fetal bovine serum (FBS) where all combinations move similarly. A stable boundary forms between EPC2 and CP-A in 5% FBS. Film duration: 96 h. Bar: 500 μm. Videos were contrast enhanced for better visualisation.</p></caption></media><p>Evidence from model systems, including <italic>Drosophila melanogaster</italic> embryonic parasegment (<xref ref-type="bibr" rid="bib30">Monier et al., 2010</xref>) and anteroposterior and dorsoventral wing disc boundaries (<xref ref-type="bibr" rid="bib23">Major and Irvine, 2005</xref>; <xref ref-type="bibr" rid="bib24">Major and Irvine, 2006</xref>; <xref ref-type="bibr" rid="bib21">Landsberg et al., 2009</xref>), suggests the importance of cell-cell interactions and collective migration for stable boundary formation between epithelial populations <italic>in vivo</italic>. Thus to create a dataset in which we predict that cell motion would be dramatically disrupted we repeated the assays in serum-free conditions. We used convolutional neural networks (Materials and methods) to determine the mean cell density and mean change in cell density from video frames over the first 48 h of cells grown in serum (5% FBS) and no serum (0% FBS) conditions. We observed that culturing of the same cell combinations in serum-free versus 5% serum medium had undetectable impact on cell density at the very confluent cell conditions investigated (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). However, as expected, serum-free condition induced large global changes in cell migration (<xref ref-type="fig" rid="fig1">Figure 1F</xref>, <xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5A</xref>) with observed loss of cell contacts, collective sheet migration (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5B,C</xref>) and the absence of boundary formation. We also observed reduced overall boundary displacement (<xref ref-type="fig" rid="fig1">Figure 1F,G</xref>) and all cell line combinations exhibited similar motion dynamics (<xref ref-type="fig" rid="fig1">Figure 1F,G</xref>, <xref ref-type="video" rid="video2">Video 2</xref>). These results illustrate that serum-free medium has a profound impact on cell motion dynamics and the generated video datasets in serum-free medium are ideal as an experimental condition for testing the ability of MOSES to detect motion dynamics under different experimental conditions. It is important to note that the serum-free condition is not used as a biological negative control of boundary formation but only as a computational negative control for the development of our method.</p></sec><sec id="s2-2"><title>Development of MOSES to quantify cell motion dynamics</title><p>We next developed a computational workflow, MOtion SEnsing Superpixels (MOSES), to quantify cellular motion from video datasets. MOSES was formulated modularly with three components (<xref ref-type="fig" rid="fig2">Figure 2</xref>): 1) motion extraction; 2) construction of long-time motion tracks; and 3) capture of local dynamic context.</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.40162.010</object-id><label>Figure 2.</label><caption><title>Schematic diagram of MOtion SEnsing Superpixels (MOSES).</title><p>(<bold>A</bold>) High level overview of the three configurable components that define MOSES: motion extraction, construction of long-time motion tracks, and capture of local dynamic context. Long-time here indicates tracking of superpixels for longer than one frame or timepoint. (<bold>B</bold>) Example ways to practically implement each of the three high-level MOSES component concepts described in (<bold>A</bold>) in software. (<bold>C</bold>) Using long-time tracking of superpixels MOSES bridges single-cell tracking for sparse cell culture and PIV for confluent monolayers to extract global motion patterns for both scenarios, single-cell and collective motion within one computational framework.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.011</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Intensity-independent filtering of superpixel tracks for migrating epithelial sheets.</title><p>(<bold>A</bold>) Graphic overview of the key steps in the algorithm, see Materials and methods for accompanying details. (<bold>B</bold>) Filtered tracks are robust to intensity artefacts. Top panels show snapshots from an example video at 96 h (left), 0 h (middle) and at the time of gap closure (right). Bottom left shows the ‘raw’ superpixel tracks from 0 to 96 h, which are spurious due to autofluorescence in the green channel after green cells leave the field-of-view. Bottom middle shows the assigned red and green superpixels depicted as coloured dots marking their centroid positions at 0 h for the image shown above. Bottom right shows all filtered superpixel tracks from 0 to 96 h using the algorithm in (<bold>A</bold>). The extent of the green tracks now correctly resembles the interface shape for the image above.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.012</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Experimental validation of MOSES optical flow superpixel tracking.</title><p>(<bold>A</bold>) Schematic illustration of the spike-in experimental setup. A separate sample of cell population 1 or 2 is dyed a third colour (blue; dots on figure) and added to the respective red or green sheet (solid colours on figure). (<bold>B</bold>) Comparison of MOSES tracks of spiked-in cells and the benchmark single-cell TrackMate tracks when the blue spiked-in cells were explicitly tracked (blue boxplots, 10,000 superpixels) or indirectly inferred from the respective coloured sheet (black boxplots, 1000 superpixels). Red boxplot centre line = median. Boxes of boxplots show interquartile range (IQR). Whiskers are located 1.5 x IQR above and below quartiles. Track similarity is reported using normalised velocity cross-correlation after matching the TrackMate and MOSES tracks (M) and if the correct matchings were randomly permuted (P). Permuted track similarity values for each video are the average of 10 random permutations. (<bold>C</bold>) Track results of the best and worst inferred tracks from sheet motion according to track similarity and the respective single-cell spiked-in MOSES tracks overlaid on a video snapshot at 0 h. Magenta: TrackMate tracks. Green: MOSES tracks of green cell population. (<bold>D</bold>) Breakdown of the mean MOSES track similarity with TrackMate tracks in (<bold>B</bold>) with respect to the three tested cell lines in combination; EPC2, CP-A, OE33. Blue bars = matched tracks, black bars = permuted tracks as in (<bold>B</bold>). Error bars show ± one standard deviation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig2-figsupp2-v2.tif"/></fig></fig-group><sec id="s2-2-1"><title>Component 1: Motion extraction</title><p>We use dense optical flow to avoid the shortcomings of using cell segmentation to track individual cells in confluent tissue. Optical flow is similar to particle image velocimetry (PIV) but yields higher resolution motion fields with a displacement vector for each pixel at every time point. PIV typically estimates a single velocity for an image patch or ‘window’ using spatial correlation. This corresponds to extracting only the superpixel movement in <xref ref-type="fig" rid="fig2">Figure 2A</xref> over one frame. Optical flow is also easier to modify to account for additional physical phenomena such as out-of-plane motion and large, discontinuous movements not captured within a PIV ‘window’ (<xref ref-type="bibr" rid="bib7">Brox et al., 2004</xref>; <xref ref-type="bibr" rid="bib8">Brox et al., 2009</xref>).</p></sec><sec id="s2-2-2"><title>Component 2: Construct long-time motion tracks</title><p>To capture all spatial motion dynamics in the video, we construct long-time motion tracks that continuously track the cellular motion for any amount of time using superpixels. Local neighbouring image pixels are grouped into a pre-specified (see below) number of image regions or ‘superpixels’ to enable spatial averaging of the pixel-based motion fields (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, Step 1). At each time point, the (<italic>x</italic>,<italic>y</italic>) position of a given superpixel is updated by averaging the optical flow (<xref ref-type="bibr" rid="bib14">Farnebäck, 2003</xref>) over the image area covered by the superpixel to obtain the displaced direction and distance (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, Steps 2-4). Subsequently, long-time superpixel motion tracks are generated by concatenating the positions of each superpixel at all time-points (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, Step 5). All long-time superpixel motion tracks together encode the entire spatio-temporal motion history within the video. By default, the number of superpixels used are user-specified and fixed to sufficiently subsample only the field-of-view of the initial video frame. Where a video exhibits highly dynamic movement and coverage of the full spatio-temporal motion, including the movement of new cells not initially present but which later move into the field of view, is necessary for analysis, additional superpixels can be dynamically added during tracking. Tracks produced by the latter approach are known as dense trajectories (<xref ref-type="bibr" rid="bib50">Wang et al., 2011</xref>). In our experiments, we used a fixed number of 1000 superpixels to cover an image size of 1344 x 1024 (with this setting an average superpixel is 37 pixels x 37 pixels covering <inline-formula><mml:math id="inf13"><mml:mo>≈</mml:mo></mml:math></inline-formula> 14,000 μm<sup>2</sup> (2x lens) or <inline-formula><mml:math id="inf14"><mml:mo>≈</mml:mo></mml:math></inline-formula> 3600 μm<sup>2</sup> (4x lens)) to monitor epithelial sheet dynamics. For multichannel images, each channel representing different coloured cell populations (i.e. red and green in our assay) was independently tracked in this manner (<xref ref-type="fig" rid="fig2">Figure 2B</xref>).</p><p>Depending on the specific application, background artefacts such as stage drift or floating debris, can contribute tracks that are biologically irrelevant and need to be filtered in post-processing (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, middle panel). In this filtering step, superpixels are assigned to cover only the dynamic motion of all ‘objects’ of interest. The ‘object’ for single-cell tracking is each individual cell, and for epithelial sheets is the entire sheet within the video frame. To assign superpixels to each sheet, we use motion information (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, Materials and methods). This approach avoids relying on image intensity features whose variation commonly leads to segmentation errors. We validated our motion extraction and long-time track construction using published single-cell tracking datasets from the cell tracking challenge (<xref ref-type="bibr" rid="bib26">Maška et al., 2014</xref>) (<xref ref-type="video" rid="video3">Video 3</xref>), and also experimentally, by spiking one of the dyed cell populations in the <italic>in vitro</italic> setup described above with a third, sparse population of blue-dyed cells. Our method produced very similar tracks (similarity score of 0.8) to an open software tool for single-particle tracking, TrackMate (<xref ref-type="bibr" rid="bib49">Tinevez et al., 2017</xref>) (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, <xref ref-type="video" rid="video4">Video 4</xref>).</p><media id="video3" mime-subtype="mp4" mimetype="video" xlink:href="elife-40162-video3.mp4"><object-id pub-id-type="doi">10.7554/eLife.40162.013</object-id><label>Video 3.</label><caption><title>Single-cell motion extraction using MOSES workflow compared to manual annotations used in the cell tracking challenge dataset (<xref ref-type="bibr" rid="bib26">Maška et al., 2014</xref>).</title><p>Bar: 100 μm.</p></caption></media><media id="video4" mime-subtype="mp4" mimetype="video" xlink:href="elife-40162-video4.mp4"><object-id pub-id-type="doi">10.7554/eLife.40162.014</object-id><label>Video 4.</label><caption><title>Assessment of individual cell motion in confluent cell sheets using spiked-in fluorescent cell populations and MOSES.</title><p>Blue (B) represents the spiked-in population of EPC2 cells. (R) and (G) refer to the red and green EPC2 epithelial sheets, respectively. Bar: 500 μm.</p></caption></media></sec><sec id="s2-2-3"><title>Component 3: Capture local dynamic context</title><p>A ‘mesh’ is constructed by ‘linking’ superpixels to capture how individual superpixels move with respect to their neighbours over time (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, Step 6). The constructed dynamic mesh, inspired by work in human surveillance (<xref ref-type="bibr" rid="bib9">Chang et al., 2011</xref>), naturally captures the local collective dynamics without explicit thresholding or clustering. Separate meshes are produced for each colour channel. Multiple different meshes can be defined and constructed for specific purposes (see Materials and methods). Because the mesh is a representation of interactions inferred from the local spatial relationships of superpixels, it can be used to derive robust local and global measures of motion relating to biological phenomena such as collective motion and tissue interactions (see below).</p><p>In summary, MOSES has been designed to describe the video motion in terms of the individual trajectories of moving ‘entities’ (defined by the image superpixels) and their spatiotemporal interactions (as captured by a dynamic mesh). Depending on the application, superpixels can be assigned to and biologically interpreted as part of an object, a single cell or multiple cells.</p></sec></sec><sec id="s2-3"><title>Quantitative measurement of squamous and columnar epithelial boundary formation using MOSES</title><p>To verify the enhanced ability of MOSES over standard PIV analysis to quantitatively assess relevant biological features of interest in tissue, we applied it to analyse the formation of boundary dynamics between squamous and columnar cells. In total, 125 videos (48 with 0% serum and 77 with 5% serum) were collected from four independent experiments and jointly analysed. These videos are highly heterogeneous, creating a challenging dataset for analysis (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p><p>Standard velocity kymographs were able to firstly confirm our observations in <xref ref-type="fig" rid="fig1">Figure 1E–G</xref> of the differences in cell motion between 0% and 5% serum conditions. As shown in <xref ref-type="fig" rid="fig3">Figure 3A</xref>, all cell combinations grown in 0% serum exhibited a similar global motion pattern, minimal sheet-like motion and interface movement following gap closure. By contrast, in 5% serum the same three cell line combinations exhibited very different dynamics, amongst which we observed the formation of a stable equilibrium following contact only between EPC2 and CP-A cell sheets. However, subsequent computation of the mean sheet speed, as performed during routine PIV analysis, highlighted the analytical need for a computational framework to extract more descriptive motion measures. As shown in <xref ref-type="fig" rid="fig3">Figure 3B</xref>, aside from an indication of a global speed increase in 5% serum, speed was an insufficient metric to characterise the observed phenotypes, exhibiting high variance between replicates and failure to highlight the uniqueness of the EPC2:CP-A interaction. We thus used MOSES to construct more discriminative phenotypic measures to characterise the boundary formation of EPC2:CP-A.</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.40162.015</object-id><label>Figure 3.</label><caption><title>MOSES quantifies boundary formation and epithelial sheet interaction dynamics.</title><p>(<bold>A</bold>) Projected ‘<italic>x</italic>’-direction velocity kymograph of the dense optical flow for each cell line combination at the two serum concentrations used in the assay. The speed and direction of movement are indicated by the intensity and colour respectively (blue, moving left; red, moving right). (<bold>B</bold>) Average speed of each video for each cell combination, coloured green and yellow for the first and second cell line in the named combinations respectively. (<bold>C,D</bold>) Violin plots of boundary formation index (<bold>C</bold>) and mesh stability (<bold>D</bold>) for each video (black dot) for different cell combinations in 0% and 5% serum. Dashed line is the threshold, one standard deviation above the pooled mean value of all cell line combinations in 0% serum. Red solid line in violins = mean, black solid line in violins = median. (<bold>E</bold>) Maximum (Max.) velocity cross-correlation between the two sheets, before and after gap closure, left and right violins respectively for each cell line combination. Shaded region of all violins is the probability density of the data whose width is proportional to the number of videos at this value. (<bold>F</bold>) Boxplots showing median and interquartile range (IQR) of velocity order parameter and (<bold>G</bold>) mesh order for each cell line combination coloured green and yellow for the first and second cell line in the named combination, respectively. Whiskers show data within 1.5 x IQR of upper and lower quartiles.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.016</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Heterogeneity in motion dynamics and quality of image acquisition.</title><p>A random selection of still images from videos are shown as examples of the variability in the acquired video frames. Cell combinations are labelled such that the first cell line name corresponds to the left sheet and the second cell line name the right sheet. The dye used is indicated as (R) for red and (G) for green. Left: Examples at 0 h at the start of the experiment. Middle: Examples when the red and green sheets first close the gap between them. The gap closure point varies among videos. An automatic method was used to detect this to ± 5 frames with 94% accuracy, (<xref ref-type="fig" rid="fig3s9">Figure 3—figure supplement 9</xref>). Right: at 96 h. All scale bars: 500 μm.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.017</object-id><label>Figure 3—figure supplement 2.</label><caption><title>The motion saliency map and boundary formation index for analysing motion sources.</title><p>(<bold>A</bold>) Illustration of the key steps in computing the motion saliency map and the boundary formation index. The term ‘values’ in the signal-to-noise ratio equation refers to the pixel intensity value of the motion saliency heat map image, which represents the degree of motion localisation at a given pixel location. Higher values indicate increased motion concentration. The terms ‘high’ and ‘low’ in the equation refer to a two-class clustering of the motion saliency image pixel values where a binary threshold is given by Otsu thresholding. All pixel values above the threshold are ‘high’ and those below the threshold are ‘low’. (<bold>B</bold>) Example video snapshots at 96 h of the three cell line combinations (EPC2:EPC2, EPC2:CP-A, EPC2:OE33) in 0% (top panel) and 5% serum (bottom panel) with corresponding motion saliency map. The computed boundary formation index is given below each image pair. All scale bars: 500 μm.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.018</object-id><label>Figure 3—figure supplement 3.</label><caption><title>MOSES mesh and boundary formation index captures multiple boundary formation.</title><p>The addition of high concentrations of an EGF inhibitor, Lapatnib, induces cell death in EPC2 cells, causing shrinkage at multiple sites and the effective formation of multiple boundaries. (<bold>A</bold>) Video snapshots of a representative EPC2(R):OE33(G) experiment in 5% serum with addition of 5 ng/ml Lapatnib (top row) with corresponding constructed MOSES mesh for each colour channel (middle and bottom rows). Time indicates hours after Lapatnib addition. (<bold>B</bold>) The corresponding mesh strain curve of EPC2 is irregular and the onset of cell death can be detected as early as 20 h even when the sheet appears relatively intact. (<bold>C</bold>) Snapshot of the MOSES mesh and induced strain ellipse distribution at 100 h. The formation of holes pushes local superpixels away whilst cell death sites bring neighbouring superpixels closer. Red ellipses highlight very high local concentration of superpixels. (<bold>D</bold>) Snapshot of final frame with corresponding motion saliency map and computed boundary formation index. All boundaries are detected but the boundary with the most movement, the leading edge of the OE33 (G, green) sheet is most highlighted. (<bold>E</bold>) Motion saliency map and boundary formation index for an EPC2 (R, red):CP-A (G, green) combination in 5% serum and addition of a more potent EGF inhibitor, Aeatinib (10 ng/ml). In this example, the CP-A sheet exhibits almost no movement and the multiple boundaries due to cell death are clearly highlighted. The MOSES motion saliency map thus captures the contribution from multiple motion sources.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig3-figsupp3-v2.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.019</object-id><label>Figure 3—figure supplement 4.</label><caption><title>The MOSES mesh stability index captures the stability of the local topology.</title><p>When cells cease to move and exhibit zero velocity, the MOSES mesh stability is always stable (value of 1) but the converse is not always true. This can be shown starting from an initially regular arrangement of cells (red grid) and simulating the resultant arrangement of cells if they move with a constant average velocity towards the bottom right over time (green and blue grid snapshots). If all cells experience the same velocity (blue box, blue lines) the location relations or topology between all cells are preserved at all timepoints. Consequently, these cells have a constant 0 line as its MOSES strain curve. In contrast, stochastic movement (orange box) whereby individual cells move in random directions but collectively exhibit the same global mean direction and speed leads to an ever-changing topology. This is reflected in the increasing shape of the MOSES strain curve (orange line). The MOSES mesh stability index thus is suited for monitoring stability based on the local collectiveness even when there is no difference in the mean velocity of the collective.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig3-figsupp4-v2.tif"/></fig><fig id="fig3s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.020</object-id><label>Figure 3—figure supplement 5.</label><caption><title>The mesh strain vector and collective motion.</title><p>(<bold>A</bold>) The mesh strain vector of a superpixel is the resultant displacement vector after summing together all individual displacement vectors of the superpixel to each connected ‘neighbour’ superpixel. (<bold>B</bold>) Comparison of the mesh strain vector with the velocity vector for two video examples in successive video frames. Top and bottom video is the MCF10-ctrl monolayer of Supp. Movie 3 and RAB5A monolayer of Supp. Movie 7 from <xref ref-type="bibr" rid="bib25">Malinverno et al. (2017)</xref>. See <xref ref-type="video" rid="video5">Video 5</xref> of this paper for the accompanying videos to this figure.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig3-figsupp5-v2.tif"/></fig><fig id="fig3s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.021</object-id><label>Figure 3—figure supplement 6.</label><caption><title>Velocity cross-correlation (VCC) for measuring the motion coordination of two epithelial sheets.</title><p>(<bold>A</bold>) A track is composed of sequential (<italic>x,y,t</italic>) points. (<bold>B</bold>) VCC evaluates the correlation between two given tracks at all possible time lags, yielding a curve of correlation vs time lag. (<bold>C</bold>) The maximum velocity cross-correlation corresponds to the highest value of this curve. (<bold>D</bold>) Example VCC evaluation between EPC2 (G, green cells) and CP-A (R, red cells). Each superpixel <inline-formula><mml:math id="inf15"><mml:mi>i</mml:mi></mml:math></inline-formula> is coloured (see colour map) according to the mean maximum VCC between it and every superpixel of the other colour that is <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mtext>VCC</mml:mtext><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>mean</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mtext>VCC</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">∀</mml:mi><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. For ‘before closure’, we use the (<italic>x,y</italic>) tracks from the initial frame up to <inline-formula><mml:math id="inf17"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:math></inline-formula> and for ‘after closure’ from <inline-formula><mml:math id="inf18"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn></mml:math></inline-formula> to the end frame where <inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the gap closure frame. Superpixel tracks are plotted at their initial position for ‘before closure’ and at <inline-formula><mml:math id="inf20"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn></mml:math></inline-formula> for ‘after closure’.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig3-figsupp6-v2.tif"/></fig><fig id="fig3s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.022</object-id><label>Figure 3—figure supplement 7.</label><caption><title>Ranking of 5% serum videos according to boundary formation index.</title><p>Final frame snapshots (96 or 144 h) ordered according to the MOSES boundary formation index in decreasing order reading from left to right, top to bottom, (n = 77). Values to 2 s.f. are given for the first video in each row and column. * demarcates the first image where a boundary does not form, according to the threshold set by our negative 0% serum controls from <xref ref-type="fig" rid="fig3">Figure 3</xref> (0.69), that is all videos to the left of and above the red dashed line are predicted by MOSES to form a boundary. Coloured dots indicate the cell line combinations cultured. AGS cells are derived from gastric adenocarcinoma. EPC2:AGS is included as another columnar cell and cancer control for comparison.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig3-figsupp7-v2.tif"/></fig><fig id="fig3s8" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.023</object-id><label>Figure 3—figure supplement 8.</label><caption><title>Quantitative assessment of boundary formation and sheet-sheet interaction dynamics of all 5% serum videos.</title><p>(<bold>A</bold>) Average speed of each cell line in each cell line combination in 5% serum. (<bold>B–D</bold>) Violin plots of (<bold>B</bold>) boundary formation index, (<bold>C</bold>) mesh stability index and (<bold>D</bold>) maximum (max.) velocity cross-correlation between the two sheets for all cell line combinations tested in 5% serum. Black dashed line in panels (<bold>B</bold>) and (<bold>C</bold>) is the threshold set using the 0% serum control as in <xref ref-type="fig" rid="fig3">Figure 3</xref>. In panel (<bold>D</bold>), for each paired violin, the left violin is before and the right violin is after gap closure. (<bold>E</bold>) Velocity cross-correlation difference before and after gap closure of (<bold>D</bold>). For all panels, each black point is a video, red solid line is the mean, black solid line is the median, shaded region is the probability density of the data whose width is proportional to the number of videos at this value, n = 77. Statistical two-tail test with Mann-Whitney U. (<bold>F,G</bold>) Boxplots of velocity order (<bold>F</bold>) and mesh order (<bold>G</bold>) for individual cell lines in each cell line combination with naming convention, cell line 1 (green):cell line 2 (yellow). AGS cells are derived from gastric adenocarcinoma. In all plots, EPC2:AGS is included as another columnar cell and cancer control for comparison.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig3-figsupp8-v2.tif"/></fig><fig id="fig3s9" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.024</object-id><label>Figure 3—figure supplement 9.</label><caption><title>Automatic determination of gap closure.</title><p>(<bold>A</bold>) Epithelial sheet segmentation using the individual red and green image channels for each RGB video frame. Solid white lines mark the sheet boundaries. (<bold>B</bold>) Boundary points identified using a sweepline algorithm (Materials and methods) subsample the respective coloured sheet boundaries. Each red point is paired with the closest green point, shown with white solid lines. (<bold>C</bold>) The gap closure frame is the point of inflexion in the plot of the average pairwise distances between boundary points (normalised gap size) vs time (given as frame numbers (abbreviated as No.)). The inflexion point is automatically estimated by finding the point of intersection between the fitted linear spline approximation (green line) of the distance (red dots) and the fitted baseline + 2 times standard deviation (dashed red line). The baseline (dashed black line) is an estimation of the background noise measurement of the gap size due to image artefacts. (<bold>D</bold>) Comparison of frame number (no.) at the time of gap closure predicted by the algorithm vs the consensus of two independent human countings given by the average of their independently annotated frame number. Each blue point is a video, n = 246 videos. Note that this analysis included more videos than those reported in this paper for the purpose of increasing the rigour of the validation. These videos were derived from additional experiments, performed with the three cell lines described in combination with an additional cell line (OE21, an esophageal squamous cell carcinoma) under a range of different media conditions. Solid black line is the ideal identity line. Dashed red lines show ± 5 frames from the black ideal identity line. (<bold>E</bold>) Histogram of the error as measured by the absolute difference in frame number between automated and consensus manual annotations. (<bold>F</bold>) Histogram as in (<bold>E</bold>), showing difference between the two individual manual annotations. In (<bold>E</bold>) and (<bold>F</bold>) the accuracy score is reported treating a difference &gt; 5 frames as a disagreement.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig3-figsupp9-v2.tif"/></fig><fig id="fig3s10" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.025</object-id><label>Figure 3—figure supplement 10.</label><caption><title>Cell infiltration, boundary shape and cell intermixing at the interface between two sheets.</title><p>(<bold>A</bold>) Boxplots showing the cell infiltration of individual cell lines into the other cell line in each cell combination with naming convention, cell line 1 (green):cell line 2 (yellow) as a fraction of the total cell count 3 h after gap closure. Image segmentation was used to find the boundary. (<bold>B</bold>) Snapshot of representative videos from each cell line combination grown in 0% or 5% serum 24 h after gap closure. Scale bar: 200 μm (<bold>C</bold>) Example snapshot with found ‘boundary’ line (solid white line), its straight line equivalent (solid yellow line) and definition of boundary shape. (<bold>D</bold>) Boxplots of the mean boundary shape over time in 0% and 5% serum. Boundaries were found in each video frame using the MOSES superpixel tracks. (<bold>E</bold>) Found boundary using image segmentation (top) and thresholding of the motion saliency map (bottom). When the cell motion is coordinated, the two are the same. (<bold>F,G</bold>) Boxplots of the intermixing coefficient (see Materials and methods) based on image segmentation at 72 h, (<bold>F</bold>) or based on thresholding of the motion saliency map, (<bold>G</bold>). (<bold>H</bold>) Violin plot of (<bold>G</bold>) with width proportional to the number of videos (black points). All boxplots depict median and interquartile range (IQR) of values with whiskers defined 1.5 x IQR above and below the quartiles. Coef. is used as the abbreviation for coefficient. AGS cells are derived from gastric adenocarcinoma. In all plots, EPC2:AGS is included as another columnar cell and cancer control for comparison.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig3-figsupp10-v2.tif"/></fig></fig-group><p>Using MOSES, we constructed a motion saliency map for visualising global motion patterns (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>) and designed four different additional measures as summarised in <xref ref-type="table" rid="table1">Table 1</xref> to quantitatively distinguish between different combinations of the three cell lines (EPC2, CP-A and OE33) used in our assay: i) boundary formation index, based on the degree that motion concentrates into a local spatial region (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplements 2</xref> and <xref ref-type="fig" rid="fig3s3">3</xref>); ii) mesh stability index, which measures the degree of movement between neighbouring cell groups locally within the sheet at the endpoint (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>); iii) mesh order to measure the degree of collective motion of the whole sheet (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref><xref ref-type="video" rid="video5">, Video 5</xref>) and iv) the maximum velocity cross-correlation, which measures the average correlation in motion between the two epithelial sheets from their movement history (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>). The first three are based on the mesh; the fourth uses the individual superpixel tracks. These measures represent examples of statistics derivable using MOSES and are not limited to wound-healing type assays. For technical details, see Materials and methods. Cells grown in 0% serum were used as a computational negative control to set appropriate cut-offs for detecting boundary formation in our computational analysis (see Materials and methods for details).</p><media id="video5" mime-subtype="mp4" mimetype="video" xlink:href="elife-40162-video5.mp4"><object-id pub-id-type="doi">10.7554/eLife.40162.032</object-id><label>Video 5.</label><caption><title>Comparison of the temporal stability of velocity and mesh strain vectors for measuring collective motion.</title><p>Individual velocity vectors are represented with red arrows, individual mesh strain vectors with green arrows. The large blue and black arrow are the global mean velocity and global mean mesh strain vector respectively. The corresponding derived MOSES mesh is shown on the right of the arrow plots in black. Bar: 100 μm.</p></caption></media><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.40162.026</object-id><label>Table 1.</label><caption><title>Summary of MOSES-derived measurements for discriminating boundary formation phenotype in this paper and their biological interpretation and application.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Proposed measures</th><th>Biological interpretation</th><th>Biological application</th></tr></thead><tbody><tr><td>Motion Saliency Map</td><td>‘Heatmap’-like image that highlights spatial regions that attract or repel local cellular motion over a defined time period.</td><td>Quantitative spatio-temporal readout of scratch or wound-healing assays. Highlights areas of salient motion activity spatially such as the migration of macrophages locally to inflicted wound sites.</td></tr><tr><td>Boundary formation index (value from 0 to 1)</td><td>Quantifies the concentration of movement within one region of space. Multiple ‘hotspots’ decrease this index. Uniform distributed movement (no attraction) scores 0. Concentration of movement in a single region for example a line or point scores 1.</td><td>Quantification of the spatial uniformity or ‘spread’ of motion activity. Highlights for example if all migrating cells move uniformly to close the wound in a wound-healing assay.</td></tr><tr><td>Mesh stability index (value from <inline-formula><mml:math id="inf21"><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic"/></mml:math></inline-formula>∞ to 1)</td><td>Measures the motion stability of local cell groups by measuring the change in relative spatial arrangement (topology) with respect to neighbouring cell groups at a given endpoint. Static epithelial sheets and epithelial sheets that move uniformly in a single direction preserve local cellular arrangement and scores 1. Motion that results in the local spatial rearrangement of cells such as neighbour exchange in embryos is unstable and scores &lt; 1.</td><td>Assessing the final global movement stability of a collective such as an embryo or epithelial sheet based on the movement of the cells that compose it.</td></tr><tr><td>Mesh order (value &gt; 0)</td><td>Measures the collectiveness of local cellular migration by the change in distance and direction of cells with respect to neighbouring cells. Hypothesizes that cells that are part of the same motion group exhibit the same ‘mesh’ force and move retaining the same local spatial arrangement.</td><td>Quantitative assessment of the extent of global sheet-like movement.</td></tr></tbody></table></table-wrap><p>Computing the proposed indices for all videos, the boundary formation index was ranked on a continuous scale for all 5% serum videos (<xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref>) by MOSES. The boundary formation index was highest (median 0.74) for EPC2:CP-A grown in 5% serum (n = 30/77) (<xref ref-type="fig" rid="fig3">Figure 3C</xref>, <xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8B</xref>), whilst EPC2:EPC2 and EPC2:OE33 in 5% serum were below the boundary formation cut-off. In 5% serum, EPC2:CP-A had the highest mesh stability index (median 0.90), compared to EPC2:EPC2 (0.76) and EPC2:OE33 (0.25) (<xref ref-type="fig" rid="fig3">Figure 3D</xref>, <xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8C</xref>). Together these results illustrate that only the squamous-columnar combination (EPC2:CP-A) formed a final stable boundary.</p><p>We next measured sheet-sheet interactions using the maximum velocity cross-correlation (VCC) before and after gap closure for the three cell line combinations. Gap closure was automatically determined (<xref ref-type="fig" rid="fig3s9">Figure 3—figure supplement 9</xref> , Materials and methods). For two initially diametrically opposed migrating sheets, a significant increase in VCC after gap closure compared to before gap closure is suggestive of increased sheet interaction. In 0% serum, no difference in velocity cross-correlation across all combinations was found before and after gap closure (<xref ref-type="fig" rid="fig3">Figure 3E</xref> ) - the two sheets do not move cohesively as a unit, as expected with minimal cell-cell contact. In serum, the difference for EPC2:CP-A (0.03 before and 0.20 after gap closure) was <inline-formula><mml:math id="inf22"><mml:mo>~</mml:mo></mml:math></inline-formula>3-6 times larger than for EPC2:EPC2 (0.01 to 0.08) and EPC2:OE33 (0.02 to 0.05) (c.f. left and right violin plots in <xref ref-type="fig" rid="fig3">Figure 3E</xref> ), suggesting potential physical interaction. Interestingly, CP-A:OE33 (Barrett’s:cancer, n = 6) also exhibited a substantial increase in VCC following gap closure (0.03 to 0.17) (<xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8D,E</xref>) but no substantial increase was observed for CP-A:CP-A (0.01 to 0.06) (<xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8D,E</xref>), confirming this observation was not simply CP-A cell line-specific. Both the velocity order parameter and our mesh order parameter (<xref ref-type="fig" rid="fig3">Figure 3F,G</xref>) indicate clear overall reduction in collective motion in cells grown in 0% serum compared to 5% serum.</p><p>Finally, we used MOSES with image segmentation and convolutional neural network (CNN) cell counting to assess morphological variations of the interface among all cell line combinations to check for ‘invasive fingers’ or boundary breakdowns that often exist in normal and tumour cell-formed boundaries (<xref ref-type="fig" rid="fig3s10">Figure 3—figure supplement 10A,B</xref>). Interestingly, we found non-invading boundaries in all cell line combinations except CP-A:OE33, where we observed clear infiltration with ‘finger-like’ protrusions of CP-A into the OE33 cell sheet grown in 5% serum (<xref ref-type="fig" rid="fig3s10">Figure 3—figure supplement 10B</xref>). No such ‘finger-like’ protrusions or significant intermixing of cells (<xref ref-type="fig" rid="fig3s10">Figure 3—figure supplement 10D,F–H</xref>) were detected in EPC2:CP-A under the same conditions. Altogether, our characterisation suggests that, among all tested cell-type combinations, we detect an ‘interacting’ final stable boundary uniquely in the squamous-columnar EPC2:CP-A combination grown in 5% serum (<xref ref-type="video" rid="video6">Video 6</xref>).</p><media id="video6" mime-subtype="mp4" mimetype="video" xlink:href="elife-40162-video6.mp4"><object-id pub-id-type="doi">10.7554/eLife.40162.027</object-id><label>Video 6.</label><caption><title>Representative videos of the sheet migration of all tested cell combinations in 5% FBS. (R) and (G) denote red and green dyed cells respectively.</title><p>Film duration 144 h. Bar: 500 μm.</p></caption></media></sec><sec id="s2-4"><title>MOSES can measure subtle phenotype changes induced by external stimuli</title><p>The ability to assess subtle phenotype changes with a minimal number of replicates is critical for high-content screening applications. We thus tested the ability of MOSES to detect changes in EPC2:CP-A boundary formation using an external perturbation. The epidermal growth factor receptor (EGFR) is frequently mutated in EAC, sometimes overexpressed in BE and is activated by bile acid reflux, the main observed cause of BE clinically (<xref ref-type="bibr" rid="bib12">Dixon et al., 2001</xref>; <xref ref-type="bibr" rid="bib46">Souza, 2010</xref>). In our experiments we thus used epidermal growth factor (EGF), the ligand of EGFR, as a biologically relevant external perturbation. Increasing amounts of EGF (0 ng/ml to 20 ng/ml) were added to the culture medium to assess incremental effects on cellular motion and boundary formation in the EPC2:CP-A combination. A total of 40 videos (each 144 h, one frame per h) were collected from three independent experiments, in a 24-well plate medium-throughput screen (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). With increasing EGF, the boundary position was displaced a distance farther from the initial point of contact between the two cell populations, with slightly enhanced cell speed and decreased boundary coherence (<xref ref-type="fig" rid="fig4">Figure 4A–D</xref>). This is quantitatively reflected in the shape of the mean normalised strain curve (<xref ref-type="fig" rid="fig4">Figure 4E</xref>) which measures the average distance between neighbouring cell groups (Materials and methods): at 0 ng/ml EGF, the curve linearly increases before plateauing around 72 h; as EGF concentration increases, the curve becomes more linear and the plateau is lost above 5 ng/ml.</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.40162.028</object-id><label>Figure 4.</label><caption><title>EGF titration at physiological levels disrupts boundary formation.</title><p>(<bold>A</bold>) Destabilisation of the junction with EGF addition. All in 5% serum with snapshots of endpoint (144 h). Shown also is the green channel CP-A MOSES mesh. The closeness of the lines indicates impeded motion leading to a local aggregation of superpixels in the vicinity and is suggestive of a boundary. The less lattice-like the mesh, the less ordered the motion. Blue triangles mark the boundary position in the image and its corresponding inferred position in the CP-A mesh. All scale bars: 500 μm. (<bold>B</bold>) Top: maximum projected video kymograph. Bottom: <italic>x</italic>-direction velocity kymograph computed from optical flow for the representative videos in (<bold>A</bold>). (<bold>C</bold>) Grouped boxplot of the average speed for the different cell lines in the combination in 5% serum with increasing EGF concentration. (<bold>D</bold>) Mean displaced distance of the boundary normalised by image width following gap closure with increasing EGF concentration in 5% serum. Mean displaced distance of EPC2:CP-A and EPC2:OE33 cultured in 5% serum from <xref ref-type="fig" rid="fig1">Figure 1G</xref> are also plotted for comparison. <italic>T</italic>-test was used with * indicating p = &lt; 0.05, ** p = &lt; 0.01, *** p = &lt; 0.001. Error bars are plotted for ± one standard deviation of the mean. (<bold>E</bold>) Mean normalised strain curves for EPC2:CP-A in 5% serum for each concentration of EGF. The mean curve for EPC2:OE33 videos in 5% serum without EGF in <xref ref-type="fig" rid="fig3">Figure 3</xref> is shown for comparison (black curve). (<bold>F–H</bold>) Violin plots of boundary formation index (<bold>F</bold>), mesh stability index (<bold>G</bold>) and maximum velocity cross-correlation (<bold>H</bold>) for each concentration of EGF and cells in 5% serum. Red solid line = mean, Black solid line = median. Dots are individual videos, total n = 40. Shaded region is the probability density of the data whose width is proportional to the number of videos at this value. Violins of respective measures for EPC2:OE33 in 5% serum without EGF with thresholds (horizontal black line) from <xref ref-type="fig" rid="fig3">Figure 3</xref> is shown for comparison. (<bold>I,J</bold>) Boxplots of velocity order (<bold>I</bold>) and mesh order (<bold>J</bold>) for individual cell lines (left) and pooled across the two cell lines in the combination (right). Values for EPC2:OE33 in 5% serum without EGF and threshold from <xref ref-type="fig" rid="fig3">Figure 3</xref> are shown for comparison.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.029</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Migration-independent cell counting to assess cell proliferation upon EGF addition to EPC2:CP-A in 5% serum.</title><p>(<bold>A</bold>) Example results of CNN counting on fluorescence videos as described in Materials and methods with switching of dyes. For each panel, the top row shows video snapshots, the bottom row shows the CNN heatmap output and the numbers below it are the CNN predicted number of cells within the image patch. Exemplar patches shown are all sampled from the initial video frame. Consistent cell numbers across all sampled cell patches enables the use of the averaged cell density as an estimate of the cell density in the entire migrating epithelial sheet. Similar cell counts using either red or green dye shows cell counting is unaffected by the dye. (<bold>B</bold>) Similar examples presented as in (<bold>A</bold>) but using the matched phase contrast videos to illustrate the changing appearance of cells over time. Top panel: cell patches sampled from the initial frame (0 h). Bottom panel: cell patches sampled from the final frame (144 h). Individual cell types in co-cultures are distinguished using the matched fluorescence videos for image masking. (<bold>C</bold>) Boxplots of mean cell density (top) and corresponding mean % change in cell density (bottom) of each cell population, labelled with red and green dyes, where the average change in cell density is normalised by the average cell density across all frames up to 48 h. (<bold>D</bold>) Similar boxplots of mean % change as in (<bold>C</bold>) but with cell density computed from phase contrast videos. (<bold>E</bold>) Surface plot of the temporal evolution of the red and green channel normalised image intensity histograms for a representative video over 144 h. Given an image intensity value, the darker the colour the higher the proportion of image pixels share this image intensity (normalised frequency). (<bold>F</bold>) Plot of the change in the modal image intensity value of (<bold>E</bold>) over time with lighter colours representing later times. (<bold>G</bold>) Spatiotemporal evolution of the image intensity histogram of (<bold>E</bold>) as a heatmap with time on the <italic>y</italic>-axis, image intensity on the <italic>x</italic>-axis and the colour representing the normalised frequency. (<bold>H</bold>) Spatiotemporal evolution of the image intensity histogram of (<bold>E</bold>) shown as an overlay of histograms using the progression of dark to light colours to show time. (<bold>I</bold>) Plot of the (image intensity, normalised frequency) pair for the histogram peak estimated at each time point. Passage of time is indicated by the progression of dark to light colours. Points fit a linear regression. The proliferation gradient is the negative of the gradient of the best fit line. (<bold>J,K</bold>) Boxplots of the extracted proliferation coefficient for increasing EGF concentrations for individual cell populations where EPC2 is dyed ‘red’ (<bold>J</bold>) and ‘green’ (<bold>K</bold>). Compared to fitting the image intensity vs time in (<bold>F</bold>) which shows too discrete a transition between intensity values, fitting the normalised frequency vs image intensity was found to be more robust whilst yielding the same conclusions when all videos are of the same temporal length (144 h) as was the case here for EGF addition to EPC2:CP-A. All boxplots depict median and interquartile range (IQR) of values with whiskers defined 1.5 x IQR above and below the quartiles.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.030</object-id><label>Figure 4—figure supplement 2.</label><caption><title>EGF addition to EPC2:CP-A in 0% serum does not induce boundary formation.</title><p>(<bold>A</bold>) Snapshots of the video (top) and fused red EPC2 and green CP-A MOSES mesh (bottom) at 144 h with increasing EGF concentration. (<bold>B</bold>) Top: maximum projected video kymograph. Bottom: <italic>x</italic>-direction velocity kymograph computed from optical flow for the representative videos in (<bold>A</bold>). The speed and direction of movement are indicated by the intensity and colour, respectively (blue, moving left; red, moving right). (<bold>C</bold>) Average speed of each cell line in each cell line combination for increasing concentrations of EGF. (<bold>D</bold>) Mean displaced distance of the boundary following gap closure with increasing EGF concentration. Mean displaced distance of EPC2:CP-A and EPC2:OE33 in 0% serum from <xref ref-type="fig" rid="fig1">Figure 1G</xref> are also plotted for comparison. <italic>T</italic>-test was used with * indicating p = &lt; 0.05, ** p = &lt; 0.01, *** p = &lt; 0.001. Error bars are plotted for ± one standard deviation of the mean. (<bold>E</bold>) Mean normalised strain curves for EPC2:CP-A in 0% serum with each tested EGF concentration. The mean curves for EPC2:OE33, 0% serum and EPC2:CP-A, 5% serum, EPC2:EPC2, 5% serum without EGF are also shown for comparison. (<bold>F</bold>) Evolution of the mean curves in (<bold>E</bold>) plotted onto the motion map of <xref ref-type="fig" rid="fig5">Figure 5</xref>. (<bold>G–I</bold>) Violin plots of (<bold>G</bold>) boundary formation index, (<bold>H</bold>) mesh stability index and (<bold>I</bold>) maximum (max.) velocity cross-correlation before and after gap closure, left and right violins respectively of each paired violin in (<bold>I</bold>). Shaded region represents the probability density of the data. Width of shaded region is proportional to the number of videos with that value. Each point is a video, black line is the median, red line is the mean. EPC2:OE33, 0% serum without EGF and thresholds in <xref ref-type="fig" rid="fig3">Figure 3</xref> are shown for comparison. (<bold>J,K</bold>) Box plots of the velocity order (<bold>J</bold>) and mesh order (<bold>K</bold>) for individual cell lines (left) and pooled over the combination (right). EPC2:OE33 in 0% serum without EGF from <xref ref-type="fig" rid="fig3">Figure 3</xref> is shown for comparison. (<bold>L,M</bold>) Boxplots of mean % change in cell density normalised by the average cell density (<bold>L</bold>) and mean cell density (<bold>M</bold>) of each cell for all frames up to 48 h. Each point is a video. All boxplots depict median and interquartile range (IQR) of values with whiskers defined 1.5 x IQR above and below the quartiles.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig4-figsupp2-v2.tif"/></fig></fig-group><p>The boundary formation index decreased with increasing EGF (0.74 at 0 ng/ml to 0.46 at 20 ng/ml, comparable to EPC2:OE33 without EGF (0.46)), indicating loss of the boundary (i.e. index below the 0.69 cut-off) (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). The mesh stability index decreased from 0.94 (stable, 0 ng/ml EGF) to 0.72 (unstable, 20 ng/ml) (<xref ref-type="fig" rid="fig4">Figure 4G</xref>), suggesting increased movement between neighbouring cells and the loss of interaction between the two cell populations since the maximum VCC difference before and after gap closure decreased from 0.16 (0 ng/ml EGF) to 0.04 (20 ng/ml EGF) (<xref ref-type="fig" rid="fig4">Figure 4H</xref>). The maximum VCC after gap closure was similar to that for EPC2:OE33 (0.02) (<xref ref-type="fig" rid="fig4">Figure 4H</xref>), but the mesh stability index remained higher (<xref ref-type="fig" rid="fig4">Figure 4G</xref>). Together these measures show that above 5 ng/ml EGF, the phenotype of EPC2:CP-A becomes similar to that between EPC2 and the EAC cell line, OE33 (<xref ref-type="video" rid="video7">Video 7</xref>). Cell counting and quantification of fluorescence decay suggest cell division is not the primary factor influencing the boundary at the cell density used in our experiments in 5% serum (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Of note, titrating EGF did not rescue the effect of serum absence, with non-significant changes in the boundary formation index (0 ng/ml: 0.60 ± 0.07, 20 ng/ml: 0.65 ± 0.03) and maximum velocity cross-correlation, although the mesh stability index decreased, likely due to increased cell movement (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref> (n = 25)).</p><media id="video7" mime-subtype="mp4" mimetype="video" xlink:href="elife-40162-video7.mp4"><object-id pub-id-type="doi">10.7554/eLife.40162.031</object-id><label>Video 7.</label><caption><title>Motion dynamics of EPC2(R):CP-A(G) under increasing EGF addition (0–20 ng/ml).</title><p>MOSES can also measure decreased collective migration in the green CP-A sheet with increasing EGF, a phenomena difficult to assess by eye. MOSES meshes are shown, red for red-dyed (R) EPC2 cells and yellow for green-dyed (G) CP-A cells, respectively. Bar: 500 μm.</p></caption></media><p>Using both the velocity order parameter and mesh order index to characterise collective motion, we found little change in collective motion upon EGF addition in 0% serum (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2J,K</xref>), which might explain the lack of boundary formation. However, in 5% serum plus EGF, the two measures exhibited opposite results: raising EGF concentration increased velocity order but decreased mesh order, <xref ref-type="fig" rid="fig4">Figure 4I,J</xref>. We note however that the mesh order, by explicitly accounting for the motion of neighbouring cells, better reflects human observation of motion in videos (<xref ref-type="video" rid="video5">Videos 5</xref>–<xref ref-type="video" rid="video7">7</xref>). This highlights the pitfalls of only quantifying the individual alignment of velocity vectors computed from one video frame. Cell counting for 0% serum again suggested minimal influence of cell proliferation (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2L,M</xref>). In summary, this example with EGF demonstrates that MOSES enables robust continuous-scale quantification of motion phenotype following systematic perturbation.</p></sec><sec id="s2-5"><title>MOSES generates motion signatures and 2D motion maps for unbiased characterisation of cellular motion phenotypes</title><p>High-content imaging screens are often explorative, with the aim of screening for unknown differences in complex cellular motions from a large number of videos in an unbiased manner (<xref ref-type="bibr" rid="bib56">Zaritsky et al., 2017</xref>). In general it is therefore not known <italic>a priori</italic> the behaviour of the imaged cells. MOSES addresses this need for an unbiased phenotyping approach by enabling the systematic generation of unique ‘motion signatures’ for individual videos in a manner similar to the relatively automatic generation of geometric features for cell shape quantification in high-content image screens (<xref ref-type="bibr" rid="bib5">Boutros et al., 2015</xref>; <xref ref-type="bibr" rid="bib6">Bray et al., 2016</xref>). Below we demonstrate that unsupervised machine learning techniques requiring no manual user annotation can be applied to MOSES generated signatures to visualise all videos onto a 2D motion phenotype map. This advanced feature of MOSES enables easy visual assessment of motion phenotype and the generation of hypotheses without the need to individually interrogate each video.</p><p>The general process for the motion map generation is illustrated in <xref ref-type="fig" rid="fig5">Figure 5A</xref>. To position each video on a 2D map, we applied principal component analysis (PCA) to the normalised mesh strain curves of the 77 videos of all cell line combinations cultured in 5% serum conditions to learn the principal component vectors that define the <italic>x</italic>-<italic>y</italic> axis of the 2D map. The normalised mesh strain curve for each video was used here as an example 1D motion signature to summarise the entire video motion (see Materials and methods for constructing more descriptive signatures). The constructed PCA map of the 77 videos from cells cultured in 5% serum (<xref ref-type="fig" rid="fig5">Figure 5B</xref>) shows that this unbiased approach automatically clusters all videos corresponding to each cell line combination. Furthermore, the videos were ordered in a continuous manner, as shown by the increasingly linear shape of the mean normalised strain curve when looking left to right across the plot in <xref ref-type="fig" rid="fig5">Figure 5B</xref> from CP-A:CP-A to EPC2:OE33. This clustering was not achieved with root mean squared displacement (RMSD), the non-mesh version of the MOSES-normalised mesh strain curve (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). Moreover, it appears independent of the particular dimensionality reduction technique used (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>), indicating that the signatures constructed using MOSES are intrinsically informative. Finally, the 1D MOSES-based motion signatures trained a machine learning classifier with no further processing to predict cell combination identity better than RMSD (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>).</p><fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.40162.033</object-id><label>Figure 5.</label><caption><title>MOSES generates motion signatures to produce a 2D motion map for unbiased characterisation of cellular motion phenotypes.</title><p>In all panels, each point represents a video (see legends for colour code). The position of each video on the 2D plot is based on the normalised mesh strain curves, analysed by PCA. (<bold>A</bold>) The mapping process for a single video. (<bold>B</bold>) The 5% serum videos (n = 77) were used to set the PCA that maps a strain curve to a point in the 2D motion map. (<bold>C</bold>) The 0% serum videos (n = 48) were plotted onto the same map defined by the 5% serum videos using the learnt PCA. In (<bold>B</bold>) and (<bold>C</bold>), the mean mesh strain curves for each cell combination are shown in the insets. Light blue region marks the two standard deviations with respect to the mean curve (solid black line). (<bold>D</bold>) Same map as in (<bold>C</bold>) with points coloured according to 0% or 5% serum. (<bold>E</bold>) The normalised mean strain curves for 0–20 ng/ml EGF addition to EPC2:CP-A from <xref ref-type="fig" rid="fig4">Figure 4E</xref> plotted onto the same map defined by the 5% serum videos.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.034</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Comparison of MOSES-normalised strain curves vs RMSD curves as motion signatures for motion map generation from 5% serum videos.</title><p>Left: Normalised strain curves for each video organised by cell line combination with MOSES (top) and RMSD (bottom). Each video is represented by a single dashed curve coloured according to the dye colour used for the first cell line in the combination indicated on each plot. Thus for combinations such as CP-A:CP-A where the green dyed CP-A is always the left sheet, there is only one green dashed line. Solid black line is the mean curve, blue shaded region marks ± two standard deviations of the mean curve, total n = 77 videos. Middle: PCA analysis applied to MOSES (top) and RMSD (bottom) shown with the respective derived principal components plotted above the PCA motion map. Percentage of variance explained by each principal component or PC is displayed in brackets. Each point is a video (see legends for colour code). Right: Classification report with the precision, recall and f1 score after fitting a balanced linear SVM (support vector machine) machine learning classifier trained on the normalised MOSES strain or RMSD curves of all the videos, n = 77. AGS cells are derived from gastric adenocarcinoma. In all plots, EPC2:AGS is included as another columnar cell and cancer control for comparison.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.40162.035</object-id><label>Figure 5—figure supplement 2.</label><caption><title>Comparison of motion map learning using different dimensional reduction techniques with MOSES strain curves and RMSD curves. </title><p>In each panel, the same 77 serum videos were used. From left to right, PCA - principal components analysis, MDS - multidimensional scaling, TSNE - t-distributed stochastic neighbour embedding and a neural network autoencoder. See Material and methods for details. Each point represents a video, as indicated in the legend. In all plots, EPC2:AGS is included as another columnar cell and cancer control for comparison.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig5-figsupp2-v2.tif"/></fig></fig-group><p>To demonstrate how such 2D motion phenotype maps can be used to compare videos, we next mapped the 48 videos from 0% serum cultures on the same axes as the videos from 5% serum cultures (<xref ref-type="fig" rid="fig5">Figure 5C,D</xref>). The videos from 0% serum mapped to a different area of the 2D plot, whilst preserving the continuous ordering of the previous videos. Therefore, without having watched the videos, it is easy to predict that the cells have markedly different motion dynamics in 0% serum compared to 5% serum. Furthermore, since the points for the 5% serum videos cover a larger area of the 2D plot than the 0% serum videos, one can predict more diversity of motion in 5% serum (<xref ref-type="fig" rid="fig5">Figure 5D</xref>).</p><p>The motion map can also capture subtle changes in dynamic behaviour. This is demonstrated by mapping the mean video motion for each concentration of EGF from 0 to 20 ng/ml (represented by the respective mean normalised strain curves for each concentration (one per concentration from a total n = 40 videos, <xref ref-type="fig" rid="fig4">Figure 4E</xref>) onto the same axis as the 5% serum videos in the absence of EGF (square points in <xref ref-type="fig" rid="fig5">Figure 5E</xref>). With increasing EGF, the squamous-columnar EPC2:CP-A motion dynamics become increasingly similar to squamous-cancer EPC2:OE33 above 5 ng/ml, as evidenced by the square points moving from the area of blue circular EPC2:CP-A points into the area of orange circular EPC2:OE33 points. Thus our motion map is consistent with the result using the specific derived measures (above). These results illustrate the ability to detect biological and technical variability across independent experiments and that MOSES possesses the required features for an algorithm to be used in an unbiased manner in high-content screens with minimal prior knowledge.</p></sec><sec id="s2-6"><title>Comparison between MOSES and PIV</title><p>Finally, to further illustrate the full potential of MOSES and to demonstrate its application, we compared MOSES with the widely used PIV method on two published timelapse microscopy datasets of epithelial monolayers. In the original publication, <xref ref-type="bibr" rid="bib25">Malinverno et al. (2017)</xref> used PIV to describe the induction of large-scale coordinated motility in MCF-10A RAB5A expressing cells compared to MCF-10A control cells. In the publication associated with the second dataset, <xref ref-type="bibr" rid="bib40">Rodríguez-Franco et al. (2017)</xref> used PIV to show the detection of deformation waves that propagate away from the cell boundary between two epithelial monolayers. The MDCK cell monolayers expressed EphB2 and its ligand ephrinB1, respectively.</p><p>Reanalysing the datasets with MOSES, we found that motion fields inferred from optical flow by MOSES were similar to those from PIV, yielding both similar speed curves and velocity kymographs. However, MOSES exhibited greater sensitivity to salient motion events (indicated in <xref ref-type="fig" rid="fig6">Figure 6A</xref>). Compared to PIV velocity vectors, MOSES superpixel tracks are a more data-efficient (see Discussion) encoding of the spatio-temporal velocity distribution that naturally enhances and preserves the salient motion. Reconstructed velocity kymographs from the MOSES motion trajectories capture not only the pattern of the full velocity kymograph but further selectively enhanced the detection of the deformation wave signature formed at the interface between EphB2/ephrinB1 epithelial monolayers (as indicated in <xref ref-type="fig" rid="fig6">Figure 6A</xref>, right panel). Thus, all velocity-based statistics that can be derived from PIV, such as the velocity order parameter, are fully preserved in MOSES. Yet, MOSES offers additional advanced possibilities. Firstly, instantaneous velocity-based measures from single videos commonly derived from PIV are noisy. For example, the velocity order parameter variation for the slower MCF-10A control cells is non-smooth and highly variable between consecutive time points (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). This leads to the misinterpretation that at certain time points, MCF-10A control cell motion is more collective than MCF-10A RAB5A expressing cells following induction. In contrast, the MOSES mesh order exploits long-time continuity and neighbourhood relations to robustly capture collective motion in a manner consistent with human observation (<xref ref-type="video" rid="video5">Video 5</xref>). Secondly, long-time MOSES tracks and superpixel mesh strain curves can unbiasedly cluster the global motion pattern into small spatio-temporal groups (<xref ref-type="fig" rid="fig6">Figure 6C</xref>, <xref ref-type="video" rid="video8">Video 8</xref>). This provides a systematic approach to the interrogation of motion sources (<xref ref-type="fig" rid="fig6">Figure 6D</xref>, <xref ref-type="video" rid="video9">Video 9</xref>). The computation of motion saliency maps from forward and backward tracked frames effectively highlight the spatial concentration of motion, and the boundary formation index attests to the efficacy of the MOSES-enabled measures across independent datasets. Finally, and uniquely, MOSES’ meshes and tracks present a systematic framework for users to define extensive sets of custom measures to comprehensively characterise complex motion phenotypes, such as the investigated boundary formation behaviour between epithelial cells. By exploiting this, we successfully constructed feature descriptors to generate interpretable motion maps for our large video dataset. <xref ref-type="fig" rid="fig6">Figure 6E</xref> summarises the key points of comparison between MOSES and PIV.</p><media id="video8" mime-subtype="mp4" mimetype="video" xlink:href="elife-40162-video8.mp4"><object-id pub-id-type="doi">10.7554/eLife.40162.037</object-id><label>Video 8.</label><caption><title>Long-time superpixel track extraction and unbiased track clustering using the mesh strain curve of each superpixel as the feature vector for Supp. </title><p>Movie 19 of <xref ref-type="bibr" rid="bib25">Malinverno et al. (2017)</xref>. Each cluster is highlighted with a unique colour. The colours are arbitrary. There is no colour matching between individual videos. Bar: 100 μm.</p></caption></media><media id="video9" mime-subtype="mp4" mimetype="video" xlink:href="elife-40162-video9.mp4"><object-id pub-id-type="doi">10.7554/eLife.40162.038</object-id><label>Video 9.</label><caption><title>Long-time superpixel track extraction and unbiased track clustering using the mesh strain curve for Supp. Movie 3 and 7 of <xref ref-type="bibr" rid="bib25">Malinverno et al. (2017)</xref>.</title><p>Each cluster is highlighted with a unique colour. The colours are arbitrary. There is no colour matching between individual videos. Bar: 100 μm.</p></caption></media><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.40162.036</object-id><label>Figure 6.</label><caption><title>Comparison between MOSES and PIV.</title><p>(<bold>A</bold>) Left: average speed curves of MCF-10A control (CTRL) and doxycycline inducible RAB5A-expressing (RAB5A) monolayer cell migration after doxycycline addition (Supp. Movie 3 of <xref ref-type="bibr" rid="bib25">Malinverno et al., 2017</xref>) computed using PIV and MOSES (optical flow). Green triangles indicate notable events in the movie; E1 (4 h): addition of doxycycline, E2 (16 h): first bright ‘flash’ in movie followed by accelerated movement of RAB5A expressing cells, E3 (25 h): timepoint at which RAB5A cells moved fastest. Right: velocity kymographs of Videos 1 and 2 (c.f. Figures 3 and 4 respectively in <xref ref-type="bibr" rid="bib40">Rodríguez-Franco et al. (2017)</xref>) computed from PIV and MOSES motion fields showing the presence of deformation waves (black dash-dot line) due to cell jamming following initial gap closure (green dashed line). The corresponding velocity kymographs reconstructed from a fixed number of 1000 MOSES superpixel tracks and a ‘dense’ number of superpixel tracks (starting with 1000 superpixels) is shown for comparison. The speed and direction of movement are indicated by the intensity and colour, respectively (blue, moving right; red, moving left). (<bold>B</bold>) Top and middle: velocity order parameter curves as defined in <xref ref-type="bibr" rid="bib25">Malinverno et al. (2017)</xref> for the MCF-10A control and RAB5A expressing cell lines was computed for the same movies as (<bold>A</bold>) using PIV and MOSES. Bottom: corresponding MOSES mesh order curve. Black vertical dashed line mark the addition of doxycycline. (<bold>C</bold>) MOSES superpixel tracks computed for wound-healing assay of MCF-10A and RAB5A cells (Supp. Video 19 of <xref ref-type="bibr" rid="bib25">Malinverno et al., 2017</xref>) were automatically clustered into distinct groupings and coloured uniquely according to their mesh strain curve using GMM with BIC model selection (Materials and methods, <xref ref-type="video" rid="video8">Video 8</xref> of this paper). (<bold>D</bold>) (i,ii) Automatic clustered superpixels and associated motion saliency maps (backward tracking to identify ‘initial’ motion, forward tracking to identify ‘final’ motion) for different videos of MCF10A-control (CTRL) and RAB5A monolayer migration in <xref ref-type="bibr" rid="bib25">Malinverno et al. (2017)</xref>, (see also <xref ref-type="video" rid="video9">Video 9</xref>). (iii) Left to right: snapshots of initial and final frames, MOSES superpixel tracks (1000 superpixels) overlaid on final frames, associated ‘final’ motion saliency map and boundary formation index for CTRL and RAB5A cells for same videos in (<bold>C</bold>). (iv) Snapshot of final frame, overlaid MOSES superpixel tracks (1000 superpixels) and associated ‘final’ motion saliency map and boundary formation index for the boundary formation between EphB2 and ephrinB1 expressing MDCK monolayers (<xref ref-type="bibr" rid="bib40">Rodríguez-Franco et al., 2017</xref>). (<bold>E</bold>) Summary of the comparison between MOSES and PIV. Long-time refers to the tracking of movement beyond one timepoint.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-fig6-v2.tif"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We have shown that MOSES combines the advantages of existing PIV and single-cell tracking methods to provide a single systematic approach for the analysis of complex motion and interaction patterns. Its operating principle builds upon two established and highly successful approaches, long-time trajectories and graphs/meshes. In computer vision, spatio-temporal ‘signatures’ constructed using long-time trajectories have proven superior to ‘signatures’ derived from PIV-type motion fields for encoding complex spatio-temporal events such as human actions in very large datasets (<xref ref-type="bibr" rid="bib50">Wang et al., 2011</xref>). Meshes/graphs are ubiquitously regarded as one of the best approaches to capture relationships between ‘objects’ across many disciplines, from Google search to protein-protein interaction networks (<xref ref-type="bibr" rid="bib48">Szklarczyk et al., 2015</xref>), flocking analyses (<xref ref-type="bibr" rid="bib3">Ballerini et al., 2008</xref>; <xref ref-type="bibr" rid="bib57">Zhou et al., 2013</xref>; <xref ref-type="bibr" rid="bib45">Shishika et al., 2014</xref>), to detection of cell jamming in biological physics (<xref ref-type="bibr" rid="bib20">Lačević et al., 2003</xref>; <xref ref-type="bibr" rid="bib34">Park et al., 2015</xref>). MOSES uniquely brings together these disparate uses of long-time trajectories and meshes into one general analysis framework. As a result, MOSES satisfies the four criteria (robust, sensitive, automatic, and unbiased) necessary for characterising and establishing new phenotypes from live cell imaging. The analysis of datasets that include variable quality videos and experiments with a small number of replicates demonstrates the potential of the proposed computational framework.</p><p>Importantly, MOSES is progress towards overcoming the individual limitations of single-cell tracking and PIV-type velocity methods. Single-cell tracks are notoriously problematic over long times; the track of a single cell may be lost or broken into many separate tracks. MOSES superpixel tracks avoids this and recovers the global motion patterns (c.f. motion saliency maps, derived measures and motion signatures). Side-by-side comparison of MOSES and the standard PIV method using published datasets demonstrates that MOSES not only enables all the measurements of PIV, but by further exploiting long-time tracks and neighbourhood relationships, delivers greater physical and biological insights. Complex salient spatio-temporal motion patterns and events such as boundary formation, deformation waves due to cell jamming between two cell populations and cell death can all be quantitatively captured by MOSES. Critically, the ability of MOSES to perform long-time tracking (up to 6 days demonstrated in this study) enabled spatial localisation of the cell populations involved in a particular motion phenotype.</p><p>MOSES does not require complex user settings to facilitate reproducibility in analyses because it does not aim to threshold or cluster out the moving objects or phenotypes during analysis, which would introduce intermediate processing errors. Rather its philosophy is to facilitate systematic generation of many motion-related measurements based on trajectory and mesh statistics sufficient for applying machine learning methods for data-driven object segmentation, video classification and phenotype detection in large video collections (e.g. <xref ref-type="fig" rid="fig5">Figure 5</xref>, motion map) with minimum prior information. The main parameter the user specifies is the number of initial superpixels, which determines the spatial resolution of analysis. No complicated fitting of complex models and no special hardware such as GPUs are required. MOSES is modular and its components can be readily adapted to suit specific applications, for example non-square superpixel shapes to better capture cells that undergo large shape changes. Analysis of 96 videos with 1344 × 1024 pixel resolution and 145 frames by tracking 1000 superpixels takes under 4 h on an unoptimized code implementation running on a single PC (3.2 GHz, 16 GB RAM). Results are stored efficiently (~1–2 MB per video) compared to ~0.1–1 GB per video, depending on the subsampling used to save the full spatio-temporal PIV/optical flow motion fields. Altogether our study illustrates the potential of MOSES as a powerful and systematic computational framework. It is particularly useful for unbiased explorative high-content screening with an aim to discover fundamental principles of cellular motion dynamics in biology and to identify factors or drugs that alter cellular motion dynamics in disease aetiology and treatment.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th>Reagent type (species) <break/>or resource</th><th>Designation</th><th>Source or <break/>reference</th><th>Identifiers</th><th>Additional <break/>information</th></tr></thead><tbody><tr><td>Cell line (<italic>H. sapiens</italic>)</td><td>EPC2</td><td><ext-link ext-link-type="uri" xlink:href="https://www.med.upenn.edu/molecular/documents/EPCcellprotocol032008.pdf">https://www.med.upenn.edu/molecular/documents/EPCcellprotocol032008.pdf</ext-link></td><td/><td>Prof. Hiroshi <break/>Nakagawa (University <break/>of Pennsylvania)</td></tr><tr><td>Cell line (<italic>H. sapiens</italic>)</td><td>CP-A</td><td>CP-A (KR-42421) <break/>(ATCC )</td><td>ATCC:CRL-4027; <break/>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/CVCL_C451">CVCL_C451</ext-link></td><td/></tr><tr><td>Cell line (<italic>H. sapiens</italic>)</td><td>OE33</td><td>ECACC</td><td>ECACC:96070808; <break/>RRID: <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/CVCL_0471">CVCL_0471</ext-link></td><td/></tr><tr><td>Cell line (<italic>H. sapiens</italic>)</td><td>AGS</td><td>AGS (ATCC CRL-1739)</td><td>ATCC:CRL-1739; <break/>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/CVCL_0139">CVCL_0139</ext-link></td><td/></tr><tr><td>Chemical <break/>compound, drug</td><td>KSFM</td><td>Gibco/Thermo Fisher</td><td>Cat#:17005042</td><td/></tr><tr><td>Chemical <break/>compound, drug</td><td>RPMI 1640 medium</td><td>Gibco/Thermo Fisher</td><td valign="bottom">Cat#:21875–034</td><td/></tr><tr><td>Chemical <break/>compound, drug</td><td>Human recombinant EGF</td><td>Gibco/Thermo Fisher</td><td valign="bottom">Cat#:PHG0313</td><td/></tr><tr><td>Chemical <break/>compound, drug</td><td>Celltracker Orange (CMRA)</td><td>Life Technologies/ <break/>Thermo Fisher</td><td>Cat#:C34551</td><td/></tr><tr><td>Chemical <break/>compound, drug</td><td>Celltracker Green (CMFDA)</td><td>Life Technologies/ <break/>Thermo Fisher</td><td>Cat#:C7025</td><td/></tr><tr><td>Chemical <break/>compound, drug</td><td>Celltracker DeepRed</td><td>Life Technologies/ <break/>Thermo Fisher</td><td>Cat#:C34565</td><td/></tr><tr><td>Chemical <break/>compound, drug</td><td>Image-iTTM FX <break/>Signal Enhancer</td><td>Thermo Fisher</td><td>Cat#:I36933</td><td/></tr><tr><td>Chemical <break/>compound, drug</td><td>Antibody diluent, <break/>background reducing</td><td>Agilent Dako</td><td>Cat#:S3022</td><td/></tr><tr><td>Chemical <break/>compound, drug</td><td>Antibody dilutent</td><td>Agilent Dako</td><td>Cat#:S0809</td><td/></tr><tr><td>Chemical <break/>compound, drug</td><td>Fluoromount-G</td><td>SouthernBiotech</td><td>Cat#:0100–01</td><td/></tr><tr><td>Chemical <break/>compound, drug</td><td>DAPI (1 mg/ml)</td><td>Thermo Fisher</td><td>Cat#:62248</td><td valign="bottom">1:1000 dilution</td></tr><tr><td>Antibody</td><td>Goat polyclonal <break/>anti-mouse Alexa <break/>Fluor 488</td><td>Thermo Fisher</td><td>Cat#:A-11001; <break/>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/AB_2534069">AB_2534069</ext-link></td><td valign="bottom">1:400 dilution</td></tr><tr><td>Antibody</td><td>Phalloidin Alexa <break/>Fluor 647</td><td>Thermo Fisher</td><td>Cat#:A22287; <break/>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/AB_2620155">AB_2620155</ext-link></td><td valign="bottom">1:400 dilution</td></tr><tr><td>Antibody</td><td>Mouse monoclonal <break/>anti E-cadherin</td><td>Becton, <break/>Dickinson U.K Ltd.</td><td>Cat#:610181; <break/>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/AB_397580">AB_397580</ext-link></td><td valign="bottom">1:400 dilution</td></tr><tr><td>Other</td><td>25 culture-inserts <break/>2-Well for <break/>self-insertion</td><td>Ibidi</td><td>Cat#:80209</td><td/></tr><tr><td>Software</td><td>Fiji ImageJ</td><td><ext-link ext-link-type="uri" xlink:href="https://imagej.net/Fiji">https://imagej.net/Fiji</ext-link></td><td>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_002285">SCR_002285</ext-link></td><td>TrackMate Plugin</td></tr><tr><td>Software <break/>/Algorithm</td><td>Motion Sensing <break/>Superpixels</td><td>This paper</td><td>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_016839">SCR_016839</ext-link></td><td><ext-link ext-link-type="uri" xlink:href="https://github.com/fyz11/MOSES">https://github.com/fyz11/MOSES</ext-link></td></tr></tbody></table></table-wrap><sec id="s4-1"><title>Cell lines and tissue culture</title><p>EPC2 (from Prof. Hiroshi Nakagawa, University of Pennsylvania, Perelman School of Medicine, Department of Gastroenterology, USA) and CP-A (ATCC) cells were grown in full KSFM (Thermo Fisher), AGS (ATCC) and OE33 (ECACC) in full RPMI with 10% FBS. Both were supplemented with glutamine and Penicillin streptomycin at 37°C and 5% CO<sub>2</sub> until 80% confluent. To passage EPC2 and CP-A, cells were resuspended after trypsinization for 5 min with PBS supplemented with soybean trypsin inhibitor (0.25 g/L, Sigma) to prevent cell death prior to resuspension in KSFM. To store, cells were resuspended at a concentration of 10<sup>6</sup> cells/ml with 90% FBS +10% DMSO freezing media following centrifugation and stored at −80°C before passing to liquid nitrogen storage. All cell lines were tested monthly for mycoplasma infection using MycoAlertTM PLUS Mycoplasma Detection Kit (Catalog #: LT07-705 from Lonza) at the Ludwig Cancer Institute, Oxford, UK and have not shown evidence of <italic>Mycoplasma</italic>. Cell lines have been authenticated by Eurofins.</p></sec><sec id="s4-2"><title>Fluorescent labelling</title><p>Cells were labelled using Celltracker Green CMFDA and Celltracker Orange CMRA dyes (Life Technologies) according to protocol. Two different concentrations 2.5 µM and 10 µM were used. The lower concentration still permits tracking but has fewer toxicity concerns.</p></sec><sec id="s4-3"><title>Immunofluorescence staining</title><p>Samples were washed twice with PBS and fixed with 4% PFA for 15 min. The samples were then washed twice and permeabilised with 0.1% Triton-X for 15 min. Samples were blocked with image-iT Fx signal enhancer for 1 h before incubation with E-cadherin (610181 Becton Dickinson U.K. Limited) overnight at a 1:400 dilution in Agilent Dako Antibody Diluent with Background Reducing Components (S3022, Agilent Dako) at 4°C. Following 3 washes of 10 min in PBS, samples were incubated for 2 h in the dark with Alexa 488 goat anti-mouse (A11001, Thermo Fisher) secondary antibody and Alexa Fluor 647 Phalloidin (A22287, ThermoFisher), both at a 1:400 dilution and DAPI (1 mg/mL) at 1:1000 dilution (62248, Thermo Fisher) in Agilent Dako Antibody dilutent (S0809, Agilent Dako). Finally, samples were washed three times with PBS and mounted using Fluoromount-G (0100–01, SouthernBiotech).</p></sec><sec id="s4-4"><title>Temporary divider Co-culture assay</title><p>In 70 µL of culture media, 70,000 labelled cells were seeded into each side of a cell culture insert (Ibidi) in one well of a 24-well plate. After 12 h, inserts were removed and the well washed three times with PBS to remove non-attached cells before adding the desired media (KSFM (0% serum in the text) or 1:1 mixture of KSFM:RPMI + 5% FBS (5% serum in the text)) for filming. For the perturbations, the effector, for example EGF, was also added to the media at the stated concentrations.</p></sec><sec id="s4-5"><title>Spike-in experiments</title><p>A third population of cells dyed with 2.5 µM of CellTracker DeepRed (Life Technologies) was diluted 1:200 into one of the other two populations dyed with either Celltracker Green CMFDA (Life Technologies) or Celltracker Orange CMRA (Life Technologies) of the same cell line. The mix was then added to one side of the insert (Ibidi) as with the two cell population experiments described in the main text.</p></sec><sec id="s4-6"><title>Image acquisition</title><p>The different conditions were filmed on a Nikon microscope for 96 or 144 h at a frequency of 1 image per hour. 2x and 4x objectives were used. The microscope filter wavelengths used to visualise the red and green dyes were 546 nm and 488 nm, respectively.</p></sec><sec id="s4-7"><title>Automated cell counting with convolutional neural networks</title><p>The convolutional neural network (CNN) density counting approach of <xref ref-type="bibr" rid="bib52">Xie et al., 2016</xref> was used to automatically count cells in confocal DAPI-stained nuclei images or fluorescent and phase contrast video frames. Once trained, given an input image the CNN model outputs a dot-like image with the property that the sum of all pixel intensities in the output dot-like image equals the number of cells within the image (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>). We describe the training method for DAPI images only. Other image modalities were trained in a similar manner details of which are given below under ‘Migration independent cell counting in videos’. To generate the training data for DAPI cell counting, 200 image patches (size 256 pixels x 256 pixels) were first randomly extracted from the acquired DAPI images of resolution 4096 pixels x 4096 pixels (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>). For each extracted 256 × 256 image patch, the stained nuclei centroids were manually marked using a ‘dot’. Then for each 256 × 256 image patch, 50 randomly sampled 64 pixel x 64 pixel patches were extracted to yield a total training set of 10,000 image patches (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>). The CNN training settings used for a 70:30 train-test split were 200 epochs, batch size 100, RMSprop (lr = 0.001, rho = 0.9, epsilon = 1e-08, decay = 0.0) with a mean absolute error (MAE) loss. The final test accuracy was reported as the mean absolute deviation (MAD) between manually counted and predicted cell counts on the result of applying the learnt CNN to the larger 256 × 256 manually labelled image patches (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B,C</xref>). To count specific cell types stained with different coloured dyes from confocal images, epithelial sheets were segmented from their respective channels by applying k-means clustering on the RGB image pixel intensity values with k = 3 (retaining the two clusters of highest intensity) after downsampling the full-size images (4096 × 4096 pixels) by a factor of 4 (to 1024 × 1024 pixels). Small objects (&lt;200 pixels) were removed, holes were filled and the largest connected component kept before upsampling the binary mask to its original resolution (4096 × 4096). The respective final binary mask was used to mask and count cells specific to each colour channel (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C</xref>). Counting of specific cell types in timelapse video frames, which are more variable in quality, is similar but uses the more optimized image segmentation protocol detailed below to segment individual epithelial sheets.</p></sec><sec id="s4-8"><title>Migration-independent cell counting in videos</title><p>To count the migrating cells in the videos, two different approaches were used. The first and default approach used in this paper is the automatic CNN counting described above trained on manual annotations of the fluorescent video frames (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A,B</xref>). To bypass the issue of moving areas, we first produced a binary mask based on image segmentation as described below to identify the respective ‘red’ and ‘green’ cell sheet areas to quantify. Using the mask, equal sized image patches of 64 × 64 were randomly sampled. These were then fed into the trained CNN to produce cell count estimates for each image patch. The average cell density over 100 random such image patches were taken as an estimate of cell density for the entire frame. This operation was repeated for each channel separately and for every time point to yield a temporal cell count profile. The proliferation rate was subsequently estimated as the average absolute cell density change in successive frames normalised by the mean cell density (computed over the desired time frame) (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1C</xref>). To check results were unaffected by the imaging modality, CNN based counting was also applied to the corresponding phase contrast images where the fluorescence channels were used to identify the individual cell types (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1D</xref>). The second approach exploits the change in dye fluorescence as cells proliferate (the cell dye intensity decreases as they divide) (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1E–H</xref>). For our videos, the image intensity exhibits too discrete a transition between time points (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1F</xref>) for accurate extraction of the fluorescence decay. Instead, given that all videos of EGF addition to EPC2:CP-A were of the same temporal length (144 h), we found that the modal image intensity and modal normalised frequency of the intensity histogram peak at every time point served as an alternative quantification of fluorescence decay that yields the same conclusions (data not shown) but could be robustly fitted with a linear best-fit line (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1I</xref>). The faster the fluorescence decay, the higher was the cell proliferation and the higher the absolute value of the fitted linear gradient that we used as a proxy proliferation coefficient (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1J,K</xref>).</p></sec><sec id="s4-9"><title>Image segmentation of epithelial sheets in timelapse video</title><p>Red and green channel images were anisotropically filtered (<xref ref-type="bibr" rid="bib37">Perona et al., 1994</xref>) to enhance image edges and suppress stochastic image noise. The entropy image was then computed to enhance the epithelial sheet. Otsu thresholding was subsequently applied to obtain red and green binary masks of the sheet. Finally ‘holes’ in the resultant masks were filled using a line rastering approach.</p></sec><sec id="s4-10"><title>Computing the distance displaced of the boundary following gap closure</title><p>A custom image edge finding script using Sobel filters to detect edges on downsampled fluorescent images was used to find the leading sheet edge (in terms of an average <italic>x</italic>-coordinate) of both cell populations for each time frame (the averaged <italic>y</italic>-coordinate of the boundary did not change significantly over the filmed duration). The gap closure point was determined by the intersection of the two <italic>x</italic>-coordinate curves. The displaced distance of the boundary following gap closure was computed as the absolute distance between the final frame averaged <italic>x</italic>-position and the gap-closure frame averaged <italic>x-</italic>position.</p></sec><sec id="s4-11"><title>MOSES framework</title><p>MOSES was developed using the Python Anaconda 2.7 distribution, in particular it uses Numpy, the Scipy-stack and OpenCV libraries. It comprises separately a cell tracking and data analysis component.</p></sec><sec id="s4-12"><title>Motion extraction</title><p>Regular superpixels were generated by applying the SLIC (<xref ref-type="bibr" rid="bib1">Achanta et al., 2012</xref>) algorithm in scikit-image on a blank image, the same size as the video frame. 1000 superpixels were used throughout in this paper. Motion fields for updating the superpixel centroid position over time were computed with OpenCV Farnebäck optical flow (<xref ref-type="bibr" rid="bib14">Farnebäck, 2003</xref>) using default parameters. For ease of implementation, displacement vectors were rounded to the nearest integer. Superpixels passing out of the frame progressively lose pixels and retain their last motion position for the tracking duration. For simplicity, lost area is not recovered. PIV was computed using the Python openpiv package, using the closest equivalent parameters to MOSES; window size of 16 pixels, overlap of 8 pixels and search area of 32 pixels.</p></sec><sec id="s4-13"><title>Motion feature-based sheet segmentation and superpixel assignment</title><p>Step 1: Given the tracks of one colour for example red, identify all superpixels that initially move by thresholding on the cumulatively moved distance within the first few frames, (here we used 2 frames, equivalent to 2 h). Step 2: Form the superpixel neighbourhood graph by connecting together all identified moving superpixels from step 1 to any other identified moving superpixel within a specified radial distance cutoff (1.2 x average superpixel width here) using their initial (<italic>x,y</italic>) centroid positions. The largest connected graph component is then found to approximate the covered area of the epithelial sheet at frame 0. Step 3: In some videos, image artefacts such as autofluorescence or the presence of isolated cells contributes superpixel tracks that are biologically irrelevant and affects quantification of the migrating sheet dynamics. Tracks associated with these noise sources must be removed. The need for such removal is automatically evaluated through a user-set cutoff based on prior knowledge of the expected maximum fraction of the field-of-view covered by any one of the red or green populations at time <inline-formula><mml:math id="inf23"><mml:mi>t</mml:mi></mml:math></inline-formula> = 0 (e.g. for a 50:50 plating of red and green cells, a conservative cut-off fraction of 0.70 is used here). Assuming that no red and green superpixel can jointly occupy the same (<italic>x</italic>,<italic>y</italic>) position in frame 0, joint filtering based on the degree of movement is applied to clean segmentation errors from previous steps. Step 4 (not required if running MOSES using dense tracking): The kept superpixels after steps 1-3, are then iteratively dynamically propagated to identify ‘activated’ superpixels (those that lie in the joint area occupied by the kept superpixels) frame-by-frame. Step 5 (potentially optional): In case the dynamic superpixel propagation identifies superpixels that do not move much over the entire video and to ensure the temporal continuity of superpixel positions, steps 1-2 are repeated. Step 6: To ensure the same number of superpixel tracks across all videos for statistical comparison, finally we assign constant tracks for all unused or inactivated superpixel tracks where for all frames their (<italic>x</italic>,<italic>y</italic>) positions are fixed to their initial centroid position. The procedure described is illustrated more concisely in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>.</p></sec><sec id="s4-14"><title>Dynamic mesh generation</title><p>To generate meshes, each superpixel is connected to its nearest ‘neighbours’. The notion of ‘neighbour’ is mathematically defined by the user (see below). For the MOSES mesh used here for visualisation and stability analysis, we defined ‘neighbours’ using a pre-set distance cut-off based on the distance between individual superpixel centroids at the start of tracking. The mesh strain curve thus measures the relative distortion between connected superpixels with respect to their initial mesh geometry over time. For computation of the boundary formation index, a different mesh was used where neighbours were independently determined frame-by-frame by a pre-set distance threshold. The specified threshold in both meshes are given in Euclidean distance as a multiplicative factor of the average superpixel width used. A factor of 1.2 for the mesh strain and 5.0 was used for the boundary formation index throughout.</p></sec><sec id="s4-15"><title>MOSES dynamic meshes – mining contextual relationships of spatio-temporal tracks using geometry and graph theory</title><p>Numerous ways exist to connect a collection of (<italic>x,y</italic>) points to form a graph or mesh. Depending on the mesh formed, different aspects of the movement can be enhanced and probed in interesting ways. In this paper, the presence of collective motion biologically motivates the mesh concept. More generally, meshes are ‘abstract’ constructs to assess relationships. In terms of motion analysis, in this paper, we recognise that different spatially located points may be correlated particularly if they are spatially close. In view of this, we first describe and explain the rationale of the two meshes constructed in the main text for visualising and quantifying epithelial sheet dynamics before describing possible extensions and how these may be more useful for specific experiments. The first and the primary mesh used throughout is what we term the MOSES mesh. It is constructed by joining each superpixel track with all superpixel tracks whose initial (<italic>x</italic>,<italic>y</italic>) centroids are within a user-specified constant Euclidean distance cut-off. Implicitly this assumes that under collective sheet migration, initially spatially close superpixels continue to remain spatially close. Violation of this assumption leads to large stretching or compression of the MOSES mesh, which can be used to derive a measure of motion collectiveness (see mesh order below). The second mesh is used to generate the motion saliency maps for localising boundary formation, a dynamic state that varies frame to frame. Each superpixel track is again connected to all superpixel tracks whose (<italic>x</italic>,<italic>y</italic>) centroids are within a user-specified Euclidean distance cut-off. However, contrary to the first mesh, which uses only the centroid positions in frame 0, here the distances are determined using the current position of all superpixels in the current frame. Thus the ‘neighbours’ continuously change frame-to-frame. We refer to this mesh as the radius neighbour graph and the motion saliency map is the result of counting the number of neighbours for each superpixel (i.e. the node degree). The number of surrounding neighbours increases in spatial areas where motion concentrates e.g. there exists a local chemoattractant or a physical impedance to cell movement such as a boundary. Thus boundaries are natural attraction motion centres; leading superpixels at the boundary cannot advance whilst those behind continue to move towards the boundary. This leads to an overall accumulation of superpixels at the boundary (c.f. motion saliency maps in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). In both meshes, tuning the distance cut-off threshold tunes the length-scale of the spatial interaction one wishes to analyse. For boundary formation, a phenomenon that spans the entire height of the image, one should choose a relatively large distance cut-off such as 5x the average superpixel width compared to, for example, identifying the localisation of a macrophage to a cell apoptosis site. In the latter, the attraction site is more point-like and a radius cut-off 1x the average superpixel width may be more accurate. Finally, whilst both of the presented meshes in our paper only utilise physical distance to define neighbours this is by no means the only possibility. In some applications such as flocking, the topological distance (i.e. the number of points away) not the physical distance may be more relevant (<xref ref-type="bibr" rid="bib3">Ballerini et al., 2008</xref>). In this situation, it is more common to construct the local kNN (k-nearest neighbour) graph, designating the closest k superpixels as neighbours. The kNN is also frequently used when the magnitude of the ‘interaction’ between points is not known <italic>a priori</italic> as a way to propagate local information and mine patterns in data c.f. t-SNE for dimensionality reduction, spectral clustering and similarity network fusion (<xref ref-type="bibr" rid="bib51">Wang et al., 2014</xref>) for combining multimodal datasets. Finally, superpixels may be joined not only spatially but also temporally to enforce consistent temporal neighbour relations (<xref ref-type="bibr" rid="bib9">Chang et al., 2011</xref>) as well as according to more ‘semantic’ notions of similarity for example similar image appearance, similar instantaneous velocities (<xref ref-type="bibr" rid="bib9">Chang et al., 2011</xref>). In short, by formalising motion analysis under the framework of dynamical meshes that connects together ‘neighbouring’ superpixels, we can analyse complex motion not just in terms of instantaneous speed and orientation but can additionally leverage powerful established tools developed in the fields of computational graph theory, network theory, topology etc. to effectively quantify and mine increasingly complex motion phenotypes in high-content screens.</p></sec><sec id="s4-16"><title>Mean squared displacement (MSD)</title><p>As a measure of cellular motions, MSD was computed as a function of time interval, <inline-formula><mml:math id="inf24"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula> as in (<xref ref-type="bibr" rid="bib34">Park et al., 2015</xref>).<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the position of the superpixel <inline-formula><mml:math id="inf26"><mml:mi>i</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf28"><mml:mo>⟨</mml:mo> <mml:mi/><mml:mo>⋅</mml:mo> <mml:mi/><mml:mo>⟩</mml:mo></mml:math></inline-formula> is the average over all time <inline-formula><mml:math id="inf29"><mml:mi>t</mml:mi></mml:math></inline-formula> and all superpixels. For small <inline-formula><mml:math id="inf30"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula>, the MSD increases as a power law <inline-formula><mml:math id="inf31"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, where the exponent <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is determined empirically by fitting. For unity exponent (<inline-formula><mml:math id="inf33"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>), the movement is uncorrelated random Brownian motion and cellular motion is diffusive. When <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, cellular motions are super-diffusive, and when <inline-formula><mml:math id="inf35"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>, motions are ‘ballistic’.</p></sec><sec id="s4-17"><title>Root Mean Squared Displacement (RMSD)</title><p>As a summary of the whole video motion and a measure of movement, the root mean squared displacement was computed as a function of time relative to the initial time <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>RMSD</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>⟩</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the position of the superpixel <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> at time <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mo>⋅</mml:mo><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the average over all time <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and all superpixels. For multi-channel videos, the average RMSD was used to describe video motion. Unless otherwise stated in the text, the normalised RMSD (here division by maximum value within the common time window of comparison) was plotted to permit comparison across different conditions. To compare across videos of different duration, in <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4B</xref> we instead compute the RMSD divided by its value at 96 h, the maximum timepoint shared by both our 96 h and 144 h videos. </p></sec><sec id="s4-18"><title>Normalised spatial correlation</title><p>For each superpixel <inline-formula><mml:math id="inf43"><mml:mi>i</mml:mi></mml:math></inline-formula> we define its neighbourhood, <inline-formula><mml:math id="inf44"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as all superpixels <inline-formula><mml:math id="inf45"><mml:mi>j</mml:mi></mml:math></inline-formula> which lie within a specified distance, <inline-formula><mml:math id="inf46"><mml:mi>r</mml:mi></mml:math></inline-formula>. Given the time-dependent velocity function <inline-formula><mml:math id="inf47"><mml:mi>V</mml:mi><mml:mo>≡</mml:mo><mml:mi>V</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> where <inline-formula><mml:math id="inf48"><mml:mi mathvariant="bold">r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is the track (all (<italic>x,y</italic>) positions) up to time <inline-formula><mml:math id="inf49"><mml:mi>t</mml:mi></mml:math></inline-formula>, the normalised spatial correlation of a video with a total of <inline-formula><mml:math id="inf50"><mml:mi>n</mml:mi></mml:math></inline-formula> superpixel tracks is defined as<disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">∀</mml:mi><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf51"><mml:mi mathvariant="double-struck">E</mml:mi><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mo>⋅</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula> is the mean function averaging over the superpixel neighbourhood, <inline-formula><mml:math id="inf52"><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mo>⋅</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> is the covariance function and <inline-formula><mml:math id="inf53"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> is the standard deviation of <inline-formula><mml:math id="inf54"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>. Computing spatial correlation as a function of <inline-formula><mml:math id="inf55"><mml:mi>r</mml:mi></mml:math></inline-formula> for our videos yields an exponential decay which can be fitted to an equation of the form <inline-formula><mml:math id="inf56"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>/</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> from which the initial correlation <italic><inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></italic> and characteristic correlation distance <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> can be determined for plotting, (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>). In our plots, the distance <inline-formula><mml:math id="inf59"><mml:mi>r</mml:mi></mml:math></inline-formula> is in terms of normalised units (i.e. the number of average superpixel widths away).</p></sec><sec id="s4-19"><title>Manual vs MOSES comparison on cell tracking challenge datasets</title><p>MOSES does not explicitly handle individual cells leaving and entering the field of view or cell divisions during filming. For fair comparison of motion capture ability with manually annotated tracks, the tracks were only compared for cells present in the initial frame as depicted with coloured masks (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Single-cell tracks were generated from MOSES (1000 superpixels) by identifying the superpixel track that has moved the greatest distance over the video duration amongst all superpixel tracks whose initial (<italic>x,y</italic>) position lies within the area of the individual cell of interest as marked out by manual annotation at <italic>t </italic>= 0 (<xref ref-type="video" rid="video3">Video 3</xref>). </p></sec><sec id="s4-20"><title>TrackMate single-cell tracking</title><p>The Fiji TrackMate plugin (<xref ref-type="bibr" rid="bib49">Tinevez et al., 2017</xref>) was run on the third blue image channel containing only the sparse population of DeepRed dyed cells with the following settings: estimated blob diameter, 10 pixel (default); threshold, 2.5; linking max distance, 50; gap-closing max distance, 50; and gap-closing max frame gap, 100. All other parameters were left at their default values.</p></sec><sec id="s4-21"><title>TrackMate vs MOSES comparison</title><p>As with the cell tracking challenge dataset for fair comparison of motion capture ability with single cell trackers like TrackMate, tracks were only compared for cells present in the initial frame as detected by TrackMate. To generate single-cell tracks using MOSES (with 10,000 superpixels) for the sparse DeepRed dyed cells, the nearest four superpixel tracks to each cell centroid were averaged to produce a single track. Similarly, to generate single cell tracks using MOSES (with 1000 superpixels) from the Green CMFDA dyed or Orange CMRA dyed sheet, for each cell, the nearest four green/red superpixel tracks were found to compute a mean track. Track similarity was computed by evaluating the normalised velocity cross-correlation (value between 0 and 1 as defined below) between each MOSES track and its corresponding TrackMate track with the average normalised velocity cross-correlation over all tracks reported for each video (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B</xref>, denoted M. for matched tracks). To assess the statistical significance of the resultant value, the track similarity from random pairing of the tracks were computed and the average of 10 permutations were reported (labelled P. for permuted in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B</xref>). All three combinations of cell types (EPC2:EPC2, EPC2:CP-A and EPC2:OE33) and all red/green dye combinations were tested, a total of 23 videos (each 144 h acquired with one image per h). The frame size of each acquired video was 512 × 672 pixels. As such, the mean spiked-in cell diameter was 5 pixels, the average superpixel width was 6 pixels (10,000 superpixels) and 19 pixels (1000 superpixels). From <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B</xref> and <xref ref-type="video" rid="video4">Video 4</xref>, MOSES achieves near perfect similarity compared to TrackMate. In some cases, the produced MOSES tracks are more desirable, guaranteeing a continuous track whereas TrackMate requires explicit linking of cell detections across frames and thus often tends to produce many ‘broken’ tracks when the same cell is unable to be detected across all time points.</p></sec><sec id="s4-22"><title>Motion saliency map</title><p>The motion saliency map illustrates in a heat map format spatial areas of motion sources and sinks, and was constructed using the MOSES dynamic meshes and superpixel tracks. It is inspired by Lagrangian fluid mechanics (<xref ref-type="bibr" rid="bib44">Shadden et al., 2005</xref>; <xref ref-type="bibr" rid="bib2">Ali and Shah, 2007</xref>). To compute this map for each frame, the radius neighbour graph was constructed (see above paragraph) using the spatial positions of superpixels in that frame and a blank image was populated at the (<italic>x,y</italic>) centroid position of each superpixel with the count of the number of surrounding neighbours according to the radius neighbour graph. This yielded an ‘image’ of size n_frames x n_rows x n_cols, where n_rows, n_cols are the video frame dimensions. We now have a multidimensional spatial heat map for each frame that captures the spatial-temporal motion saliency. To reveal long-time temporally persistent behaviour, we averaged the heatmap both spatially and temporally using the superpixel partition of the initial video frame as illustrated in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>. By construction, this spatial map is general for studying any phenomenon where spatial localisation plays a role.</p></sec><sec id="s4-23"><title>Quantification cut-offs</title><p>We assume normally/t- distributed statistics for all measures. Boundary formation cut-off was set one standard deviation above the pooled mean of 0% serum samples. Mesh stability index was set one standard deviation below the pooled mean of 0% serum EPC2:EPC2, EPC2:CP-A samples.</p></sec><sec id="s4-24"><title>Boundary formation index</title><p>The boundary formation index (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>) quantifies the extent to which motion concentrates into localised spatial regions in the motion saliency map as a signal-to-noise ratio with value from 0 to 1 suitable for global comparison across video datasets. For example a boundary concentrates motion along a ‘line’ whilst cell death may generate multiple spot-like concentrations (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). The higher the index, the more that motion is concentrated into a single spatial region. To compute the boundary formation index from the visual motion saliency image, the motion saliency image was segmented into ‘high’ and ‘low’ intensity using Otsu thresholding and the normalised signal-to-noise ratio was computed, defined by <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtext>high</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtext>low</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtext>high</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>(<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). The mean was used as the motion saliency map was computed from a sparse set of points given by the number of superpixels. Individual pixel statistics such as the maximum intensity are therefore noisy and not robust measures. The denominator was set to be the mean of the ‘high’ intensity region in order to give a numerical value bounded between 0–1 for standardised comparison. As this measure captures the ‘peakiness’ of the spatial distribution, it can also be used to quantify other localised spatial processes with adaptation for example cell death.</p></sec><sec id="s4-25"><title>Normalised mesh strain curves</title><p>For a superpixel, <inline-formula><mml:math id="inf61"><mml:mi>i</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> we define the mesh strain, <inline-formula><mml:math id="inf63"><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> of the local neighbourhood, <inline-formula><mml:math id="inf64"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> with <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> neighbours as the mean of the absolute difference in the distance between superpixel <inline-formula><mml:math id="inf66"><mml:mi>i</mml:mi></mml:math></inline-formula> and superpixel <inline-formula><mml:math id="inf67"><mml:mi>j</mml:mi></mml:math></inline-formula> in its neighbourhood at time <inline-formula><mml:math id="inf68"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf69"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and at the start at <inline-formula><mml:math id="inf70"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf71"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> so that <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf73"><mml:mo>|</mml:mo><mml:mo>⋅</mml:mo><mml:mo>|</mml:mo></mml:math></inline-formula> is the absolute value or <italic>L1</italic>-norm. The time-dependent mesh strain for one mesh is the mean local neighbourhood mesh strain over all superpixels for each time frame. The result is a vector the same length as the number of frames in the video. For multi-channels, the average vector is used to describe video motion. The absolute value of the strain curve is susceptible to the image acquisition conditions and geometry whilst the motion information is primarily encoded by the shape of the resulting curve. To permit comparison across different conditions, the normalised strain curve (here division by maximum strain within the common time window of comparison, 0-96 h here) up to 96 h (the maximum timepoint shared between 96 h and 144 h videos in this paper) was used as a simple signature to describe the global video motion pattern when computing motion maps.</p></sec><sec id="s4-26"><title>Normalised mesh strain, L1-norm and robustness</title><p>Here we provide more details as to why we chose the <italic>L1</italic>-norm for computing the mesh strain. When computing the ‘distance’ between two vectors, <inline-formula><mml:math id="inf74"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> both of length <inline-formula><mml:math id="inf75"><mml:mi>n</mml:mi></mml:math></inline-formula> one can define the notion of distance in different ways. A popular family of distances or norms to use is the <inline-formula><mml:math id="inf76"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>-norm denoted <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> defined mathematically as follows:<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac></mml:mrow></mml:msup><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> denotes the absolute difference. Within this family the most popular is the <italic>L1 <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></italic> and <italic>L2</italic> <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> norms. The <italic>L1</italic>-norm is also called the mean absolute deviation and the <italic>L2</italic>-norm the Euclidean or mean squared distance. The quadratic function of <italic>L2</italic> amplifies large differences (&gt; 1) and reduces the effect of smaller differences close to zero thus where differentiability is not a concern <italic>L1</italic> is the more robust choice. In our case where most of the distances are larger than 1 (as all superpixels are initially seeded at a distance &gt; 1), we chose to use <italic>L1</italic> which is more resistant to the effect of extremal values as a result of errors in motion extraction.</p></sec><sec id="s4-27"><title>Mesh stability index</title><p>The mesh stability index attempts to quantify the global stationarity (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>) across a moving collective such as an epithelial sheet by measuring the change in the average distance between each superpixel and its neighbours. Specifically, it measures the flatness of the normalised mesh strain curve as defined above. Note whilst a curve is flat only if its gradient is flat that is 0, it is more visually appealing to report increasing stability with increasing values therefore we define the mesh stability index as 1 minus the end gradient. The end gradient is most stable when it has a value of 0 therefore this index is upper bounded by 1. To standardise the value of the gradient for comparison, we normalise also across time such that for any length video, time is from 0 to 1. To compute the end gradient stably without curve fitting procedures, we assume the end point is locally linear with respect to time and average the first-order differences over the last few frames. For 96 h videos, the period of stability given by the curve plateau is shorter, therefore the last 10 frames (10 h) were used for computing the gradient. For 144 h videos, the last 24 frames (24 h) were used.</p></sec><sec id="s4-28"><title>Mesh order</title><p>Inspired by the definition of the velocity order parameter, the mesh order is identically defined but uses the local resultant mesh strain vector instead of instantaneous velocity vectors for computation (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>). In this paper, we used the MOSES mesh but any similar mesh construction is equally valid. Given a mesh, the mesh strain vector for a superpixel is the sum of the displacement vector of the superpixel relative to each neighbouring superpixel (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>). The mesh order is computed for each frame accordingly for a video. The mean value over all frames was reported for statistical comparison.</p></sec><sec id="s4-29"><title>Normalised velocity cross-correlation</title><p>Cross-correlation measures the similarity between two signals taking into account time delay, (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>). As ‘signals’, we use the time-dependent velocity <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> computed from the spatial displacement between the location <inline-formula><mml:math id="inf82"><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> at time <inline-formula><mml:math id="inf83"><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> and location <inline-formula><mml:math id="inf84"><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> at time <inline-formula><mml:math id="inf85"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf86"><mml:mi>V</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> which is spatially location-independent. Velocity is a vector quantity with both <inline-formula><mml:math id="inf87"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf88"><mml:mi>y</mml:mi></mml:math></inline-formula> components. Letting <inline-formula><mml:math id="inf89"><mml:mo>⋅</mml:mo></mml:math></inline-formula> denote the scalar product, the normalised velocity cross-correlation (VCC) of the tracks of red superpixel <inline-formula><mml:math id="inf90"><mml:mi>i</mml:mi></mml:math></inline-formula> and green superpixel <inline-formula><mml:math id="inf91"><mml:mi>j</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf92"><mml:mi>t</mml:mi></mml:math></inline-formula> and time lag <inline-formula><mml:math id="inf93"><mml:mi>m</mml:mi></mml:math></inline-formula> such that the extremas are bound by [-1,1] is<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mtext>VCC</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> , <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf96"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the mean and standard deviation of <inline-formula><mml:math id="inf97"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> respectively. <inline-formula><mml:math id="inf98"><mml:mi>T</mml:mi></mml:math></inline-formula> is the maximum time lag and is set to be the length of <inline-formula><mml:math id="inf99"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. VCC can be either positive or negative. We report the maximum absolute value for all red-green pairings and the average over all pairings as evidence of interaction between two epithelial sheets. In the main text, this is computed with tracks before (up to - 5 frames) and after (from + 5 frames) the gap closure point. The offset of 5 frames either side is based on the accuracy to which we could determine the gap closure point automatically (see below).</p></sec><sec id="s4-30"><title>Automatic gap closure determination</title><p>The frame of gap closure when the two epithelial sheets contact was found by finding the video frame in which the average distance between the migrating fronts of the two epithelial layers was minimised. To compute this distance as a function of time (frame number), first each epithelial sheet was independently segmented based on their respective colour channel pixel intensity (<xref ref-type="fig" rid="fig3s9">Figure 3—figure supplement 9A</xref>). For each sheet, images were preprocessed using a median filter (square kernel, the same size as the average superpixel width) and segmented using two class k-means clustering (for 0% serum, three class k-means was used to include the weaker pixel intensity of leading cells). The resulting segmentation was post-processed by binary morphological operations (binary closing with disk kernel of 5 pixels, removal of small objects (&lt; 5% total image size) and binary filling). Sheet boundary points were efficiently identified using a sweepline algorithm. The image was evenly divided into 100 horizontal strips or sweeps in the <italic>y</italic>-direction. For each sweep, one boundary point was identified by selecting either the right-most point (largest <italic>x-</italic>coordinate) if the sheet was moving right, or left-most point (smallest <italic>x-</italic>coordinate) if the sheet was moving left (<xref ref-type="fig" rid="fig3s9">Figure 3—figure supplement 9B</xref>). Doing this for both sheets, each of the boundary points was paired in the red/green sheet to the closest in the opposing colour by physical distance. The average distance between the migrating fronts of the two epithelial layers for a particular frame was then the average euclidean distance of all red-green boundary point pairs in the frame. Computing the average distance between the two sheets frame-by-frame, there was a change in the rate of decrease as the gap closed (<xref ref-type="fig" rid="fig3s9">Figure 3—figure supplement 9C</xref>). To estimate the frame at which this transition occurs, asymmetric least means squares (<xref ref-type="bibr" rid="bib13">Eilers and Boelens, 2005</xref>) was used to first fit the baseline (representing the contribution to the distance measurement due to image segmentation errors) and second a linear spline (smoothing factor 0.1*variance(curve)) was used to approximate the temporal average distance curve. The gap closure frame was then found as the first frame for which the fitted spline value falls below the fitted baseline + 2*std(fitted baseline), where std is the standard deviation operation. We validated the method using a total of n = 246 videos of different cell combinations in different media by comparing the inferred frame to the consensus (average frame) of two manual annotators. A strong Pearson correlation coefficient of r = 0.902 (<xref ref-type="fig" rid="fig3s9">Figure 3—figure supplement 9D</xref>) and an accuracy of 94% within ± 5 frames (<xref ref-type="fig" rid="fig3s9">Figure 3—figure supplement 9E</xref>) compared to an accuracy of 97% within ± 5 frames between two human annotators (<xref ref-type="fig" rid="fig3s9">Figure 3—figure supplement 9F</xref>) was found.</p></sec><sec id="s4-31"><title>Boundary detection</title><p>Boundaries were detected either i) by image segmentation (early timepoints) or ii) from the MOSES tracks (late time points). For image segmentation, red and green epithelial sheets were segmented as described above for timelapse video frames. The boundary binary mask was then found as the mathematical set intersection of red and green binary masks. To derive a boundary line, the non-zero image coordinates of the binary boundary mask were forced to form a line given by unique (<italic>x,y</italic>) coordinates by returning the average <italic>x</italic>-coordinate (along image horizontal) for each unique <italic>y</italic>-coordinate (along image vertical). A piece-wise cubic spline was subsequently fitted to enable interpolation of the boundary line. To derive the boundary line from the MOSES superpixel tracks, first all non-moving tracks that is all tracks that do not move a total distance greater than a predefined threshold was removed. Then at each frame, <inline-formula><mml:math id="inf100"><mml:mi>t</mml:mi></mml:math></inline-formula> we considered all superpixels that have moved since the previous frame <inline-formula><mml:math id="inf101"><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. We then attempted to match the red superpixels to green superpixels where we defined a match when the distance between two points is smaller than a predetermined cut-off. All red and green superpixel points that have at least one successful match were kept. Together these points form the boundary candidate points. As discussed, a boundary is a motion attractor thus we can robustly find the boundary points from the candidate points using an asymmetric least squares filter (<xref ref-type="bibr" rid="bib13">Eilers and Boelens, 2005</xref>). We modified the original formulation of <xref ref-type="bibr" rid="bib13">Eilers and Boelens, 2005</xref> to enforce density based filtering by using a cut-off based on the number of neighbours within a predefined distance. Finally, given the boundary points the boundary line was found as in the case of image segmentation.</p></sec><sec id="s4-32"><title>Cell infiltration</title><p>For a single video frame, the infiltration of the first colour cell type into the second colour cell type is defined as the fraction of first colour cells that lie on the side of the boundary line of the second coloured sheet. The boundary line was located from image segmentation as described above.</p></sec><sec id="s4-33"><title>Boundary shape</title><p>The boundary shape is defined as the total length of the boundary line (<inline-formula><mml:math id="inf102"><mml:mi>L</mml:mi></mml:math></inline-formula>) divided by the equivalent straight line length (<inline-formula><mml:math id="inf103"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>) illustrated as solid white and yellow lines respectively in <xref ref-type="fig" rid="fig3s10">Figure 3—figure supplement 10C</xref>.</p></sec><sec id="s4-34"><title>Intermixing coefficient</title><p>We computed two different measures to reflect the ‘intermixing’ behaviour of cells at the boundary, which we denoted either ‘(Image)’ or ‘(MOSES)’ in <xref ref-type="fig" rid="fig3s10">Figure 3—figure supplement 10</xref>. The image intermixing coefficient reflects the ‘spread’ of the wound after we perform image segmentation on the video frame. A heavily infiltrated and wavy boundary yields a larger binary mask and occupies a larger fraction of the image than a sharp, linear boundary. We capture this idea by defining the intermixing coefficient (image) as the area of the boundary mask relative to the total image area. This is however a static measure of intermixing. It does not account for the fact that the boundary is not static and can be highly dynamic such as in EPC2:EPC2 or how EPC2 cells appear to ‘flee’ OE33 cells with little coordination. We thus propose a second dynamic measure of intermixing coefficient based on measuring the spread in the motion behaviour. This intermixing coefficient (MOSES) is the area of the binary mask after thresholding the motion saliency map relative to the total image area. Of note, the two intermixing coefficients are identical if the final boundary is stable and the motion at the boundary during boundary formation is coordinated such as in EPC2:CP-A (<xref ref-type="fig" rid="fig3s10">Figure 3—figure supplement 10E</xref>).</p></sec><sec id="s4-35"><title>Kymographs</title><p>Boundaries were detected using the MOSES tracks as described. The kymograph of one time slice shows the median values of the projected <italic>x</italic>-direction velocities of all pixels as a function of the <italic>x-</italic>position. For superpixel tracks, the <italic>x</italic>-axis was binned with two times the number of unique <italic>x</italic>-coordinates based on the initial superpixel centroids (in line with Nyquist sampling theorem). This procedure was repeated for each timepoint to build the full kymograph over time.</p></sec><sec id="s4-36"><title>Generating feature descriptors for motion map generation</title><p>A feature descriptor for an image/video is a 1D numerical vector designed to summarise the image/video content in a compact code or signature. No universally optimal method exists to generate such a descriptor for all applications. In the main text, for simplicity to avoid the introduction of new concepts we used the normalised strain curve used to compute the mesh stability index as an example video feature vector for PCA. As we showed, this was sufficient to distinguish the different migration behaviour of the investigated cell combinations. However, the normalised strain curve is a coarse 1D approximation of the local MOSES mesh stretching and only one characteristic of the complex mesh dynamics. More generally, one can exploit other mesh constructions as discussed above to derive a plethora of graph theoretic measures such as the algebraic connectivity, the Laplacian spectrum and centrality, or supplement mesh-based statistics with trajectory-based measures such as turning angle and speed for a more comprehensive unbiased description of the spatio-temporal motion. In circumstances where cellular appearance exhibits large temporal changes such as in the case of migrating cells with lamellipodium, motion features alone may not provide a sufficiently descriptive signal for quantifying phenotypic differences. Here one could additionally supplement motion signatures with appearance-based features such as image texture descriptors (e.g. LBP, Haralick, HoG (histogram of oriented gradients) and SIFT (and its variants)) and construct the mesh semantically with the augmented motion-appearance descriptor.</p></sec><sec id="s4-37"><title>Dimensionality reduction experiments</title><p>We used the Python scikit-learn implementation of PCA (principal components analysis), MDS (multi-dimensional scaling) and TSNE (t-distributed stochastic neighbour embedding) and applied them to the ‘raw’ normalised mesh strain curves (no pre-processing). PCA was applied with n_components = 2 without input whitening. MDS used default scikit-learn parameters with n_components = 2, random_state = 0. TSNE used n_components = 2, learning_rate = 100, random_state = 0, init = ‘random’. A 97-20-2 fully connected neural network autoencoder was implemented and trained with Keras (Tensorflow backend) with mean squared error loss using the Adam optimizer (lr = 0.001, beta_1 = 0.5, beta_2 = 0.999, epsilon = 1e-08, decay = 0.0). 48/77 of the 5% serum videos were used for training and the remaining 29/77 for validation to check for model overfitting. Tanh activations were used throughout. To maximise gradient propagation in the linear range of the ‘tanh’ activation function, we subtract 0.5 from the input normalised strain curves (values between 0 and 1) as a pre-processing step for the neural network.</p></sec><sec id="s4-38"><title>Automatic clustering of superpixel tracks</title><p>To automatically cluster superpixel tracks, we first computed for each superpixel its local mesh strain curve with respect to its neighbours. This yields a matrix <italic>N</italic> rows by <italic>T</italic> columns for <italic>N</italic> superpixel tracks and a total of <italic>T</italic> timepoints. Gaussian mixture model (GMM) was then used to generate clusters using BIC (Bayesian Information Criterion) to select the optimal number of clusters (<xref ref-type="bibr" rid="bib15">Fraley, 1998</xref>).</p></sec><sec id="s4-39"><title>Software availability</title><p>The MOSES code is available open-source under a Ludwig non-commercial and academic license at GitHub, <ext-link ext-link-type="uri" xlink:href="https://github.com/fyz11/MOSES.git">https://github.com/fyz11/MOSES.git</ext-link> (<xref ref-type="bibr" rid="bib58">Zhou, 2019</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/MOSES">https://github.com/elifesciences-publications/MOSES</ext-link>) where it is maintained and updated. Example data for testing can be downloaded from Google Drive, <ext-link ext-link-type="uri" xlink:href="https://drive.google.com/open?id=0BwFVL6r9ww5BaTh6NExLR1JMUXM">https://drive.google.com/open?id=0BwFVL6r9ww5BaTh6NExLR1JMUXM</ext-link>. The full video dataset can be found under DOIs, <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.17632/j8yrmntc7x.1">https://dx.doi.org/10.17632/j8yrmntc7x.1</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.17632/vrhtsdhprr.1">https://dx.doi.org/10.17632/vrhtsdhprr.1</ext-link> for videos with and without EGF addition, respectively.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Prof. Hiroshi Nakagawa for generous donation of EPC2 cells and Profs. Roberto Cerbino and Xavier Trepat for making available the raw videos in their publications. We thank Dr. Mary Muers, Dr. Françoise Howe, Profs. Sebastian Nijman, Francis Szele, Colin Goding and Shankar Srinivas for critical reading of the manuscript; Mark Shipman for technical assistance with timelapse microscopy. This work is mainly funded by the Ludwig Institute for Cancer Research (LICR) with additional support from a CRUK grant to XL (C9720/A18513). FYZ is mainly funded through the EPSRC Life Sciences Interface Doctoral Training Centre EP/F500394/1, CRP and XL are funded by LICR, RPO is supported by LICR, the Oxford Health Services Research Committee and Oxford University Clinical Academic Graduate School supported by the National Institute for Health Research (NIHR) Biomedical Research Centre based at the Oxford University Hospitals Trust, Oxford, MJW is supported by CRUK (C5255/A19498, through an Oxford Cancer Research Centre Clinical Research Training Fellowship), and JR is funded by LICR and the EPSRC SeeBiByte Programme Grant (EP/M013774/1). The views expressed are those of the authors and not necessarily those of the NHS, the NIHR or the Department of Health.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>A patent is pending for MOSES (UK application no. GB1716893.1, International application no. PCT/GB2018/052935)). The code is available open-source and free for academic and non-profit users under a Ludwig academic and non-profit license.</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf3"><p>A patent is pending for MOSES (UK application no. GB1716893.1, International application no. PCT/GB2018/052935)). The code is available open-source and free for academic and non-profit users under a Ludwig academic and non-profit license.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing, Conceived and implemented all of MOSES and analysed all data</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Data curation, Validation, Investigation, Methodology, Writing—review and editing, Performed all live cell imaging videos. Established the 24-well plate based co-culture system.</p></fn><fn fn-type="con" id="con3"><p>Resources, Methodology, Writing—review and editing, Aided initial prototyping of MOSES with mixed co-culture timelapse videos</p></fn><fn fn-type="con" id="con4"><p>Resources, Methodology, Writing—review and editing, Aided initial prototyping of MOSES with mixed co-culture timelapse videos</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Supervision, Methodology, Project administration, Writing—review and editing, Provided computational supervision</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Supervision, Funding acquisition, Methodology, Writing—original draft, Project administration, Writing—review and editing, Provided overall project supervision</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><object-id pub-id-type="doi">10.7554/eLife.40162.039</object-id><label>Supplementary file 1.</label><caption><title>Table summary of video datasets and experiments analysed for 0% and 5% serum.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-40162-supp1-v2.docx"/></supplementary-material><supplementary-material id="supp2"><object-id pub-id-type="doi">10.7554/eLife.40162.040</object-id><label>Supplementary file 2.</label><caption><title>Table summary of video datasets and experiments analysed for EGF addition.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-40162-supp2-v2.docx"/></supplementary-material><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.40162.041</object-id><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-40162-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analysed during this study are included in the manuscript and supporting files. Source code files for MOSES are available and maintained on GitHub (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/MOSES">https://github.com/elifesciences-publications/MOSES</ext-link>). Analysed videos are made available online with unique DOIs ( <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.17632/j8yrmntc7x.1">http://dx.doi.org/10.17632/j8yrmntc7x.1</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.17632/vrhtsdhprr.1">http://dx.doi.org/10.17632/vrhtsdhprr.1</ext-link>) through Mendeley datasets.</p><p>The following datasets were generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>FY</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Normal 2 Cell Population Migration Dataset</data-title><source>Mendeley Data</source><pub-id assigning-authority="other" pub-id-type="doi">10.17632/j8yrmntc7x.1</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>FY</given-names></name><name><surname>Puig</surname><given-names>CR</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>EGF Addition to EPC2:CP-A</data-title><source>Mendeley Data</source><pub-id assigning-authority="other" pub-id-type="doi">10.17632/vrhtsdhprr.1</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Achanta</surname> <given-names>R</given-names></name><name><surname>Shaji</surname> <given-names>A</given-names></name><name><surname>Smith</surname> <given-names>K</given-names></name><name><surname>Lucchi</surname> <given-names>A</given-names></name><name><surname>Fua</surname> <given-names>P</given-names></name><name><surname>Süsstrunk</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>SLIC superpixels compared to state-of-the-art superpixel methods</article-title><source>IEEE Transactions on Pattern Analysis and Machine Intelligence</source><volume>34</volume><fpage>2274</fpage><lpage>2282</lpage><pub-id pub-id-type="doi">10.1109/TPAMI.2012.120</pub-id><pub-id pub-id-type="pmid">22641706</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Ali</surname> <given-names>S</given-names></name><name><surname>Shah</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title><italic>A lagrangian particle dynamics approach for crowd flow segmentation and stability analysis</italic></article-title><conf-name>IEEE Conference On Computer Vision and Pattern Recognition</conf-name><pub-id pub-id-type="doi">10.1109/CVPR.2007.382977</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ballerini</surname> <given-names>M</given-names></name><name><surname>Cabibbo</surname> <given-names>N</given-names></name><name><surname>Candelier</surname> <given-names>R</given-names></name><name><surname>Cavagna</surname> <given-names>A</given-names></name><name><surname>Cisbani</surname> <given-names>E</given-names></name><name><surname>Giardina</surname> <given-names>I</given-names></name><name><surname>Lecomte</surname> <given-names>V</given-names></name><name><surname>Orlandi</surname> <given-names>A</given-names></name><name><surname>Parisi</surname> <given-names>G</given-names></name><name><surname>Procaccini</surname> <given-names>A</given-names></name><name><surname>Viale</surname> <given-names>M</given-names></name><name><surname>Zdravkovic</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Interaction ruling animal collective behavior depends on topological rather than metric distance: evidence from a field study</article-title><source>PNAS</source><volume>105</volume><fpage>1232</fpage><lpage>1237</lpage><pub-id pub-id-type="doi">10.1073/pnas.0711437105</pub-id><pub-id pub-id-type="pmid">18227508</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boonstra</surname> <given-names>JJ</given-names></name><name><surname>van Marion</surname> <given-names>R</given-names></name><name><surname>Beer</surname> <given-names>DG</given-names></name><name><surname>Lin</surname> <given-names>L</given-names></name><name><surname>Chaves</surname> <given-names>P</given-names></name><name><surname>Ribeiro</surname> <given-names>C</given-names></name><name><surname>Pereira</surname> <given-names>AD</given-names></name><name><surname>Roque</surname> <given-names>L</given-names></name><name><surname>Darnton</surname> <given-names>SJ</given-names></name><name><surname>Altorki</surname> <given-names>NK</given-names></name><name><surname>Schrump</surname> <given-names>DS</given-names></name><name><surname>Klimstra</surname> <given-names>DS</given-names></name><name><surname>Tang</surname> <given-names>LH</given-names></name><name><surname>Eshleman</surname> <given-names>JR</given-names></name><name><surname>Alvarez</surname> <given-names>H</given-names></name><name><surname>Shimada</surname> <given-names>Y</given-names></name><name><surname>van Dekken</surname> <given-names>H</given-names></name><name><surname>Tilanus</surname> <given-names>HW</given-names></name><name><surname>Dinjens</surname> <given-names>WNM</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Verification and unmasking of widely used human esophageal adenocarcinoma cell lines</article-title><source>JNCI: Journal of the National Cancer Institute</source><volume>102</volume><fpage>271</fpage><lpage>274</lpage><pub-id pub-id-type="doi">10.1093/jnci/djp499</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boutros</surname> <given-names>M</given-names></name><name><surname>Heigwer</surname> <given-names>F</given-names></name><name><surname>Laufer</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Microscopy-based high-content screening</article-title><source>Cell</source><volume>163</volume><fpage>1314</fpage><lpage>1325</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.11.007</pub-id><pub-id pub-id-type="pmid">26638068</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bray</surname> <given-names>MA</given-names></name><name><surname>Singh</surname> <given-names>S</given-names></name><name><surname>Han</surname> <given-names>H</given-names></name><name><surname>Davis</surname> <given-names>CT</given-names></name><name><surname>Borgeson</surname> <given-names>B</given-names></name><name><surname>Hartland</surname> <given-names>C</given-names></name><name><surname>Kost-Alimova</surname> <given-names>M</given-names></name><name><surname>Gustafsdottir</surname> <given-names>SM</given-names></name><name><surname>Gibson</surname> <given-names>CC</given-names></name><name><surname>Carpenter</surname> <given-names>AE</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Cell painting, a high-content image-based assay for morphological profiling using multiplexed fluorescent dyes</article-title><source>Nature Protocols</source><volume>11</volume><fpage>1757</fpage><lpage>1774</lpage><pub-id pub-id-type="doi">10.1038/nprot.2016.105</pub-id><pub-id pub-id-type="pmid">27560178</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brox</surname> <given-names>T</given-names></name><name><surname>Bruhn</surname> <given-names>A</given-names></name><name><surname>Papenberg</surname> <given-names>N</given-names></name><name><surname>Weickert</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>High accuracy optical flow estimation based on a theory for warping</article-title><source>European Conference on Computer Vision</source><volume>3024</volume><fpage>25</fpage><lpage>36</lpage></element-citation></ref><ref id="bib8"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Brox</surname> <given-names>T</given-names></name><name><surname>Bregler</surname> <given-names>C</given-names></name><name><surname>Malik</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Large displacement optical flow</article-title><conf-name>IEEE International Conference on Computer Vision and Pattern Recognition</conf-name><fpage>41</fpage><lpage>48</lpage></element-citation></ref><ref id="bib9"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Chang</surname> <given-names>M-C</given-names></name><name><surname>Krahnstoever</surname> <given-names>N</given-names></name><name><surname>Ge</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Probabilistic group-level motion analysis and scenario recognition </article-title><conf-name> IEEE International Conference On Computer Vision</conf-name><fpage>747</fpage><lpage>754</lpage><pub-id pub-id-type="doi">10.1109/ICCV.2011.6126312</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Clark</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><source>The Molecular and Cellular Biology of Wound Repair</source><publisher-name>Springer Science &amp; Business Media</publisher-name></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dahmann</surname> <given-names>C</given-names></name><name><surname>Oates</surname> <given-names>AC</given-names></name><name><surname>Brand</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Boundary formation and maintenance in tissue development</article-title><source>Nature Reviews Genetics</source><volume>12</volume><fpage>43</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.1038/nrg2902</pub-id><pub-id pub-id-type="pmid">21164524</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dixon</surname> <given-names>MF</given-names></name><name><surname>Neville</surname> <given-names>PM</given-names></name><name><surname>Mapstone</surname> <given-names>NP</given-names></name><name><surname>Moayyedi</surname> <given-names>P</given-names></name><name><surname>Axon</surname> <given-names>AT</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Bile reflux gastritis and Barrett's oesophagus: further evidence of a role for duodenogastro-oesophageal reflux?</article-title><source>Gut</source><volume>49</volume><fpage>359</fpage><lpage>363</lpage><pub-id pub-id-type="doi">10.1136/gut.49.3.359</pub-id><pub-id pub-id-type="pmid">11511557</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="report"><person-group person-group-type="author"><name><surname>Eilers</surname> <given-names>PH</given-names></name><name><surname>Boelens</surname> <given-names>HF</given-names></name></person-group><year iso-8601-date="2005">2005</year><source>Baseline Correction with Asymmetric Least Squares Smoothing</source><publisher-name>Leiden University Medical Centre</publisher-name></element-citation></ref><ref id="bib14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Farnebäck</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2003">2003</year><source>Two-Frame Motion Estimation Based on Polynomial Expansion</source><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fraley</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>How many clusters? which clustering method? answers via model-based cluster analysis</article-title><source>The Computer Journal</source><volume>41</volume><fpage>578</fpage><lpage>588</lpage><pub-id pub-id-type="doi">10.1093/comjnl/41.8.578</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaddam</surname> <given-names>S</given-names></name><name><surname>Singh</surname> <given-names>M</given-names></name><name><surname>Balasubramanian</surname> <given-names>G</given-names></name><name><surname>Thota</surname> <given-names>P</given-names></name><name><surname>Gupta</surname> <given-names>N</given-names></name><name><surname>Wani</surname> <given-names>S</given-names></name><name><surname>Higbee</surname> <given-names>AD</given-names></name><name><surname>Mathur</surname> <given-names>SC</given-names></name><name><surname>Horwhat</surname> <given-names>JD</given-names></name><name><surname>Rastogi</surname> <given-names>A</given-names></name><name><surname>Young</surname> <given-names>PE</given-names></name><name><surname>Cash</surname> <given-names>BD</given-names></name><name><surname>Bansal</surname> <given-names>A</given-names></name><name><surname>Vargo</surname> <given-names>JJ</given-names></name><name><surname>Falk</surname> <given-names>GW</given-names></name><name><surname>Lieberman</surname> <given-names>DA</given-names></name><name><surname>Sampliner</surname> <given-names>RE</given-names></name><name><surname>Sharma</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Persistence of Nondysplastic Barrett's esophagus identifies patients at lower risk for esophageal adenocarcinoma: results from a large multicenter cohort</article-title><source>Gastroenterology</source><volume>145</volume><fpage>548</fpage><lpage>553</lpage><pub-id pub-id-type="doi">10.1053/j.gastro.2013.05.040</pub-id><pub-id pub-id-type="pmid">23714382</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goers</surname> <given-names>L</given-names></name><name><surname>Freemont</surname> <given-names>P</given-names></name><name><surname>Polizzi</surname> <given-names>KM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Co-culture systems and technologies: taking synthetic biology to the next level</article-title><source>Journal of the Royal Society Interface</source><volume>11</volume><elocation-id>20140065</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2014.0065</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harada</surname> <given-names>H</given-names></name><name><surname>Nakagawa</surname> <given-names>H</given-names></name><name><surname>Oyama</surname> <given-names>K</given-names></name><name><surname>Takaoka</surname> <given-names>M</given-names></name><name><surname>Andl</surname> <given-names>CD</given-names></name><name><surname>Jacobmeier</surname> <given-names>B</given-names></name><name><surname>von Werder</surname> <given-names>A</given-names></name><name><surname>Enders</surname> <given-names>GH</given-names></name><name><surname>Opitz</surname> <given-names>OG</given-names></name><name><surname>Rustgi</surname> <given-names>AK</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Telomerase induces immortalization of human esophageal keratinocytes without p16INK4a inactivation</article-title><source>Molecular Cancer Research : MCR</source><volume>1</volume><fpage>729</fpage><lpage>738</lpage><pub-id pub-id-type="pmid">12939398</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Held</surname> <given-names>M</given-names></name><name><surname>Schmitz</surname> <given-names>MH</given-names></name><name><surname>Fischer</surname> <given-names>B</given-names></name><name><surname>Walter</surname> <given-names>T</given-names></name><name><surname>Neumann</surname> <given-names>B</given-names></name><name><surname>Olma</surname> <given-names>MH</given-names></name><name><surname>Peter</surname> <given-names>M</given-names></name><name><surname>Ellenberg</surname> <given-names>J</given-names></name><name><surname>Gerlich</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>CellCognition: time-resolved phenotype annotation in high-throughput live cell imaging</article-title><source>Nature Methods</source><volume>7</volume><fpage>747</fpage><lpage>754</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1486</pub-id><pub-id pub-id-type="pmid">20693996</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lačević</surname> <given-names>N</given-names></name><name><surname>Starr</surname> <given-names>FW</given-names></name><name><surname>Schrøder</surname> <given-names>TB</given-names></name><name><surname>Glotzer</surname> <given-names>SC</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Spatially heterogeneous dynamics investigated via a time-dependent four-point density correlation function</article-title><source>The Journal of Chemical Physics</source><volume>119</volume><fpage>7372</fpage><lpage>7387</lpage><pub-id pub-id-type="doi">10.1063/1.1605094</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Landsberg</surname> <given-names>KP</given-names></name><name><surname>Farhadifar</surname> <given-names>R</given-names></name><name><surname>Ranft</surname> <given-names>J</given-names></name><name><surname>Umetsu</surname> <given-names>D</given-names></name><name><surname>Widmann</surname> <given-names>TJ</given-names></name><name><surname>Bittig</surname> <given-names>T</given-names></name><name><surname>Said</surname> <given-names>A</given-names></name><name><surname>Jülicher</surname> <given-names>F</given-names></name><name><surname>Dahmann</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Increased cell bond tension governs cell sorting at the Drosophila anteroposterior compartment boundary</article-title><source>Current Biology</source><volume>19</volume><fpage>1950</fpage><lpage>1955</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2009.10.021</pub-id><pub-id pub-id-type="pmid">19879142</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leoni</surname> <given-names>G</given-names></name><name><surname>Neumann</surname> <given-names>PA</given-names></name><name><surname>Sumagin</surname> <given-names>R</given-names></name><name><surname>Denning</surname> <given-names>TL</given-names></name><name><surname>Nusrat</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Wound repair: role of immune-epithelial interactions</article-title><source>Mucosal Immunology</source><volume>8</volume><fpage>959</fpage><lpage>968</lpage><pub-id pub-id-type="doi">10.1038/mi.2015.63</pub-id><pub-id pub-id-type="pmid">26174765</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Major</surname> <given-names>RJ</given-names></name><name><surname>Irvine</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Influence of Notch on dorsoventral compartmentalization and actin organization in the Drosophila wing</article-title><source>Development</source><volume>132</volume><fpage>3823</fpage><lpage>3833</lpage><pub-id pub-id-type="doi">10.1242/dev.01957</pub-id><pub-id pub-id-type="pmid">16049109</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Major</surname> <given-names>RJ</given-names></name><name><surname>Irvine</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Localization and requirement for myosin II at the dorsal-ventral compartment boundary of the Drosophila wing</article-title><source>Developmental Dynamics</source><volume>235</volume><fpage>3051</fpage><lpage>3058</lpage><pub-id pub-id-type="doi">10.1002/dvdy.20966</pub-id><pub-id pub-id-type="pmid">17013876</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malinverno</surname> <given-names>C</given-names></name><name><surname>Corallino</surname> <given-names>S</given-names></name><name><surname>Giavazzi</surname> <given-names>F</given-names></name><name><surname>Bergert</surname> <given-names>M</given-names></name><name><surname>Li</surname> <given-names>Q</given-names></name><name><surname>Leoni</surname> <given-names>M</given-names></name><name><surname>Disanza</surname> <given-names>A</given-names></name><name><surname>Frittoli</surname> <given-names>E</given-names></name><name><surname>Oldani</surname> <given-names>A</given-names></name><name><surname>Martini</surname> <given-names>E</given-names></name><name><surname>Lendenmann</surname> <given-names>T</given-names></name><name><surname>Deflorian</surname> <given-names>G</given-names></name><name><surname>Beznoussenko</surname> <given-names>GV</given-names></name><name><surname>Poulikakos</surname> <given-names>D</given-names></name><name><surname>Haur</surname> <given-names>OK</given-names></name><name><surname>Uroz</surname> <given-names>M</given-names></name><name><surname>Trepat</surname> <given-names>X</given-names></name><name><surname>Parazzoli</surname> <given-names>D</given-names></name><name><surname>Maiuri</surname> <given-names>P</given-names></name><name><surname>Yu</surname> <given-names>W</given-names></name><name><surname>Ferrari</surname> <given-names>A</given-names></name><name><surname>Cerbino</surname> <given-names>R</given-names></name><name><surname>Scita</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Endocytic reawakening of motility in jammed epithelia</article-title><source>Nature Materials</source><volume>16</volume><fpage>587</fpage><lpage>596</lpage><pub-id pub-id-type="doi">10.1038/nmat4848</pub-id><pub-id pub-id-type="pmid">28135264</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maška</surname> <given-names>M</given-names></name><name><surname>Ulman</surname> <given-names>V</given-names></name><name><surname>Svoboda</surname> <given-names>D</given-names></name><name><surname>Matula</surname> <given-names>P</given-names></name><name><surname>Matula</surname> <given-names>P</given-names></name><name><surname>Ederra</surname> <given-names>C</given-names></name><name><surname>Urbiola</surname> <given-names>A</given-names></name><name><surname>España</surname> <given-names>T</given-names></name><name><surname>Venkatesan</surname> <given-names>S</given-names></name><name><surname>Balak</surname> <given-names>DM</given-names></name><name><surname>Karas</surname> <given-names>P</given-names></name><name><surname>Bolcková</surname> <given-names>T</given-names></name><name><surname>Streitová</surname> <given-names>M</given-names></name><name><surname>Carthel</surname> <given-names>C</given-names></name><name><surname>Coraluppi</surname> <given-names>S</given-names></name><name><surname>Harder</surname> <given-names>N</given-names></name><name><surname>Rohr</surname> <given-names>K</given-names></name><name><surname>Magnusson</surname> <given-names>KE</given-names></name><name><surname>Jaldén</surname> <given-names>J</given-names></name><name><surname>Blau</surname> <given-names>HM</given-names></name><name><surname>Dzyubachyk</surname> <given-names>O</given-names></name><name><surname>Křížek</surname> <given-names>P</given-names></name><name><surname>Hagen</surname> <given-names>GM</given-names></name><name><surname>Pastor-Escuredo</surname> <given-names>D</given-names></name><name><surname>Jimenez-Carretero</surname> <given-names>D</given-names></name><name><surname>Ledesma-Carbayo</surname> <given-names>MJ</given-names></name><name><surname>Muñoz-Barrutia</surname> <given-names>A</given-names></name><name><surname>Meijering</surname> <given-names>E</given-names></name><name><surname>Kozubek</surname> <given-names>M</given-names></name><name><surname>Ortiz-de-Solorzano</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A benchmark for comparison of cell tracking algorithms</article-title><source>Bioinformatics</source><volume>30</volume><fpage>1609</fpage><lpage>1617</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu080</pub-id><pub-id pub-id-type="pmid">24526711</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meijering</surname> <given-names>E</given-names></name><name><surname>Dzyubachyk</surname> <given-names>O</given-names></name><name><surname>Smal</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Methods for cell and particle tracking</article-title><source>Methods in Enzymology</source><volume>504</volume><fpage>183</fpage><lpage>200</lpage><pub-id pub-id-type="doi">10.1016/B978-0-12-391857-4.00009-4</pub-id><pub-id pub-id-type="pmid">22264535</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merlo</surname> <given-names>LM</given-names></name><name><surname>Kosoff</surname> <given-names>RE</given-names></name><name><surname>Gardiner</surname> <given-names>KL</given-names></name><name><surname>Maley</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>An in vitro co-culture model of esophageal cells identifies ascorbic acid as a modulator of cell competition</article-title><source>BMC cancer</source><volume>11</volume><elocation-id>461</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2407-11-461</pub-id><pub-id pub-id-type="pmid">22026449</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milde</surname> <given-names>F</given-names></name><name><surname>Franco</surname> <given-names>D</given-names></name><name><surname>Ferrari</surname> <given-names>A</given-names></name><name><surname>Kurtcuoglu</surname> <given-names>V</given-names></name><name><surname>Poulikakos</surname> <given-names>D</given-names></name><name><surname>Koumoutsakos</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Cell image velocimetry (CIV): boosting the automated quantification of cell migration in wound healing assays</article-title><source>Integrative Biology</source><volume>4</volume><fpage>1437</fpage><lpage>1447</lpage><pub-id pub-id-type="doi">10.1039/c2ib20113e</pub-id><pub-id pub-id-type="pmid">23047374</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monier</surname> <given-names>B</given-names></name><name><surname>Pélissier-Monier</surname> <given-names>A</given-names></name><name><surname>Brand</surname> <given-names>AH</given-names></name><name><surname>Sanson</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>An actomyosin-based barrier inhibits cell mixing at compartmental boundaries in Drosophila embryos</article-title><source>Nature cell biology</source><volume>12</volume><fpage>60</fpage><lpage>65</lpage><pub-id pub-id-type="doi">10.1038/ncb2005</pub-id><pub-id pub-id-type="pmid">19966783</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neumann</surname> <given-names>B</given-names></name><name><surname>Held</surname> <given-names>M</given-names></name><name><surname>Liebel</surname> <given-names>U</given-names></name><name><surname>Erfle</surname> <given-names>H</given-names></name><name><surname>Rogers</surname> <given-names>P</given-names></name><name><surname>Pepperkok</surname> <given-names>R</given-names></name><name><surname>Ellenberg</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>High-throughput RNAi screening by time-lapse imaging of live human cells</article-title><source>Nature Methods</source><volume>3</volume><fpage>385</fpage><lpage>390</lpage><pub-id pub-id-type="doi">10.1038/nmeth876</pub-id><pub-id pub-id-type="pmid">16628209</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nketia</surname> <given-names>TA</given-names></name><name><surname>Sailem</surname> <given-names>H</given-names></name><name><surname>Rohde</surname> <given-names>G</given-names></name><name><surname>Machiraju</surname> <given-names>R</given-names></name><name><surname>Rittscher</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Analysis of live cell images: methods, tools and opportunities</article-title><source>Methods</source><volume>115</volume><fpage>65</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1016/j.ymeth.2017.02.007</pub-id><pub-id pub-id-type="pmid">28242295</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Padfield</surname> <given-names>D</given-names></name><name><surname>Rittscher</surname> <given-names>J</given-names></name><name><surname>Roysam</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Coupled minimum-cost flow cell tracking for high-throughput quantitative analysis</article-title><source>Medical image analysis</source><volume>15</volume><fpage>650</fpage><lpage>668</lpage><pub-id pub-id-type="doi">10.1016/j.media.2010.07.006</pub-id><pub-id pub-id-type="pmid">20864383</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname> <given-names>JA</given-names></name><name><surname>Kim</surname> <given-names>JH</given-names></name><name><surname>Bi</surname> <given-names>D</given-names></name><name><surname>Mitchel</surname> <given-names>JA</given-names></name><name><surname>Qazvini</surname> <given-names>NT</given-names></name><name><surname>Tantisira</surname> <given-names>K</given-names></name><name><surname>Park</surname> <given-names>CY</given-names></name><name><surname>McGill</surname> <given-names>M</given-names></name><name><surname>Kim</surname> <given-names>SH</given-names></name><name><surname>Gweon</surname> <given-names>B</given-names></name><name><surname>Notbohm</surname> <given-names>J</given-names></name><name><surname>Steward</surname> <given-names>R</given-names></name><name><surname>Burger</surname> <given-names>S</given-names></name><name><surname>Randell</surname> <given-names>SH</given-names></name><name><surname>Kho</surname> <given-names>AT</given-names></name><name><surname>Tambe</surname> <given-names>DT</given-names></name><name><surname>Hardin</surname> <given-names>C</given-names></name><name><surname>Shore</surname> <given-names>SA</given-names></name><name><surname>Israel</surname> <given-names>E</given-names></name><name><surname>Weitz</surname> <given-names>DA</given-names></name><name><surname>Tschumperlin</surname> <given-names>DJ</given-names></name><name><surname>Henske</surname> <given-names>EP</given-names></name><name><surname>Weiss</surname> <given-names>ST</given-names></name><name><surname>Manning</surname> <given-names>ML</given-names></name><name><surname>Butler</surname> <given-names>JP</given-names></name><name><surname>Drazen</surname> <given-names>JM</given-names></name><name><surname>Fredberg</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Unjamming and cell shape in the asthmatic airway epithelium</article-title><source>Nature Materials</source><volume>14</volume><fpage>1040</fpage><lpage>1048</lpage><pub-id pub-id-type="doi">10.1038/nmat4357</pub-id><pub-id pub-id-type="pmid">26237129</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pau</surname> <given-names>G</given-names></name><name><surname>Walter</surname> <given-names>T</given-names></name><name><surname>Neumann</surname> <given-names>B</given-names></name><name><surname>Hériché</surname> <given-names>JK</given-names></name><name><surname>Ellenberg</surname> <given-names>J</given-names></name><name><surname>Huber</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Dynamical modelling of phenotypes in a genome-wide RNAi live-cell imaging assay</article-title><source>BMC Bioinformatics</source><volume>14</volume><elocation-id>308</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2105-14-308</pub-id><pub-id pub-id-type="pmid">24131777</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname> <given-names>J</given-names></name><name><surname>Peng</surname> <given-names>S</given-names></name><name><surname>Jiang</surname> <given-names>A</given-names></name><name><surname>Wei</surname> <given-names>J</given-names></name><name><surname>Li</surname> <given-names>C</given-names></name><name><surname>Tan</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Asymmetric least squares for multiple spectra baseline correction</article-title><source>Analytica Chimica Acta</source><volume>683</volume><fpage>63</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1016/j.aca.2010.08.033</pub-id><pub-id pub-id-type="pmid">21094382</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Perona</surname> <given-names>P</given-names></name><name><surname>Shiota</surname> <given-names>T</given-names></name><name><surname>Malik</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1994">1994</year><source>Geometry-Driven Diffusion in Computer Vision</source><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petitjean</surname> <given-names>L</given-names></name><name><surname>Reffay</surname> <given-names>M</given-names></name><name><surname>Grasland-Mongrain</surname> <given-names>E</given-names></name><name><surname>Poujade</surname> <given-names>M</given-names></name><name><surname>Ladoux</surname> <given-names>B</given-names></name><name><surname>Buguin</surname> <given-names>A</given-names></name><name><surname>Silberzan</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Velocity fields in a collectively migrating epithelium</article-title><source>Biophysical Journal</source><volume>98</volume><fpage>1790</fpage><lpage>1800</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2010.01.030</pub-id><pub-id pub-id-type="pmid">20441742</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Progatzky</surname> <given-names>F</given-names></name><name><surname>Dallman</surname> <given-names>MJ</given-names></name><name><surname>Lo Celso</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>From seeing to believing: labelling strategies for in vivo cell-tracking experiments</article-title><source>Interface Focus</source><volume>3</volume><elocation-id>20130001</elocation-id><pub-id pub-id-type="doi">10.1098/rsfs.2013.0001</pub-id><pub-id pub-id-type="pmid">23853708</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodríguez-Franco</surname> <given-names>P</given-names></name><name><surname>Brugués</surname> <given-names>A</given-names></name><name><surname>Marín-Llauradó</surname> <given-names>A</given-names></name><name><surname>Conte</surname> <given-names>V</given-names></name><name><surname>Solanas</surname> <given-names>G</given-names></name><name><surname>Batlle</surname> <given-names>E</given-names></name><name><surname>Fredberg</surname> <given-names>JJ</given-names></name><name><surname>Roca-Cusachs</surname> <given-names>P</given-names></name><name><surname>Sunyer</surname> <given-names>R</given-names></name><name><surname>Trepat</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Long-lived force patterns and deformation waves at repulsive epithelial boundaries</article-title><source>Nature Materials</source><volume>16</volume><fpage>1029</fpage><lpage>1037</lpage><pub-id pub-id-type="doi">10.1038/nmat4972</pub-id><pub-id pub-id-type="pmid">28892054</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schaffer</surname> <given-names>CJ</given-names></name><name><surname>Nanney</surname> <given-names>LB</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Cell biology of wound healing</article-title><source>International Review of Cytology</source><volume>169</volume><fpage>151</fpage><lpage>181</lpage><pub-id pub-id-type="pmid">8843654</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schiegg</surname> <given-names>M</given-names></name><name><surname>Hanslovsky</surname> <given-names>P</given-names></name><name><surname>Haubold</surname> <given-names>C</given-names></name><name><surname>Koethe</surname> <given-names>U</given-names></name><name><surname>Hufnagel</surname> <given-names>L</given-names></name><name><surname>Hamprecht</surname> <given-names>FA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Graphical model for joint segmentation and tracking of multiple dividing cells</article-title><source>Bioinformatics</source><volume>31</volume><fpage>948</fpage><lpage>956</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu764</pub-id><pub-id pub-id-type="pmid">25406328</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmitz</surname> <given-names>MH</given-names></name><name><surname>Held</surname> <given-names>M</given-names></name><name><surname>Janssens</surname> <given-names>V</given-names></name><name><surname>Hutchins</surname> <given-names>JR</given-names></name><name><surname>Hudecz</surname> <given-names>O</given-names></name><name><surname>Ivanova</surname> <given-names>E</given-names></name><name><surname>Goris</surname> <given-names>J</given-names></name><name><surname>Trinkle-Mulcahy</surname> <given-names>L</given-names></name><name><surname>Lamond</surname> <given-names>AI</given-names></name><name><surname>Poser</surname> <given-names>I</given-names></name><name><surname>Hyman</surname> <given-names>AA</given-names></name><name><surname>Mechtler</surname> <given-names>K</given-names></name><name><surname>Peters</surname> <given-names>JM</given-names></name><name><surname>Gerlich</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Live-cell imaging RNAi screen identifies PP2A-B55alpha and importin-beta1 as key mitotic exit regulators in human cells</article-title><source>Nature Cell Biology</source><volume>12</volume><fpage>886</fpage><lpage>893</lpage><pub-id pub-id-type="doi">10.1038/ncb2092</pub-id><pub-id pub-id-type="pmid">20711181</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shadden</surname> <given-names>SC</given-names></name><name><surname>Lekien</surname> <given-names>F</given-names></name><name><surname>Marsden</surname> <given-names>JE</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Definition and properties of Lagrangian coherent structures from finite-time Lyapunov exponents in two-dimensional aperiodic flows</article-title><source>Physica D: Nonlinear Phenomena</source><volume>212</volume><fpage>271</fpage><lpage>304</lpage><pub-id pub-id-type="doi">10.1016/j.physd.2005.10.007</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shishika</surname> <given-names>D</given-names></name><name><surname>Manoukis</surname> <given-names>NC</given-names></name><name><surname>Butail</surname> <given-names>S</given-names></name><name><surname>Paley</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Male motion coordination in anopheline mating swarms</article-title><source>Scientific reports</source><volume>4</volume><elocation-id>6318</elocation-id><pub-id pub-id-type="doi">10.1038/srep06318</pub-id><pub-id pub-id-type="pmid">25212874</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Souza</surname> <given-names>RF</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The role of acid and bile reflux in oesophagitis and Barrett's metaplasia</article-title><source>Biochemical Society Transactions</source><volume>38</volume><fpage>348</fpage><lpage>352</lpage><pub-id pub-id-type="doi">10.1042/BST0380348</pub-id><pub-id pub-id-type="pmid">20298181</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szabó</surname> <given-names>B</given-names></name><name><surname>Szöllösi</surname> <given-names>GJ</given-names></name><name><surname>Gönci</surname> <given-names>B</given-names></name><name><surname>Jurányi</surname> <given-names>Z</given-names></name><name><surname>Selmeczi</surname> <given-names>D</given-names></name><name><surname>Vicsek</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Phase transition in the collective migration of tissue cells: experiment and model</article-title><source>Physical Review E</source><volume>74</volume><elocation-id>061908</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.74.061908</pub-id><pub-id pub-id-type="pmid">17280097</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szklarczyk</surname> <given-names>D</given-names></name><name><surname>Franceschini</surname> <given-names>A</given-names></name><name><surname>Wyder</surname> <given-names>S</given-names></name><name><surname>Forslund</surname> <given-names>K</given-names></name><name><surname>Heller</surname> <given-names>D</given-names></name><name><surname>Huerta-Cepas</surname> <given-names>J</given-names></name><name><surname>Simonovic</surname> <given-names>M</given-names></name><name><surname>Roth</surname> <given-names>A</given-names></name><name><surname>Santos</surname> <given-names>A</given-names></name><name><surname>Tsafou</surname> <given-names>KP</given-names></name><name><surname>Kuhn</surname> <given-names>M</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name><name><surname>Jensen</surname> <given-names>LJ</given-names></name><name><surname>von Mering</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>STRING v10: protein-protein interaction networks, integrated over the tree of life</article-title><source>Nucleic Acids Research</source><volume>43</volume><fpage>D447</fpage><lpage>D452</lpage><pub-id pub-id-type="doi">10.1093/nar/gku1003</pub-id><pub-id pub-id-type="pmid">25352553</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tinevez</surname> <given-names>JY</given-names></name><name><surname>Perry</surname> <given-names>N</given-names></name><name><surname>Schindelin</surname> <given-names>J</given-names></name><name><surname>Hoopes</surname> <given-names>GM</given-names></name><name><surname>Reynolds</surname> <given-names>GD</given-names></name><name><surname>Laplantine</surname> <given-names>E</given-names></name><name><surname>Bednarek</surname> <given-names>SY</given-names></name><name><surname>Shorte</surname> <given-names>SL</given-names></name><name><surname>Eliceiri</surname> <given-names>KW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>TrackMate: an open and extensible platform for single-particle tracking</article-title><source>Methods</source><volume>115</volume><fpage>80</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1016/j.ymeth.2016.09.016</pub-id><pub-id pub-id-type="pmid">27713081</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>H</given-names></name><name><surname>Kläser</surname> <given-names>A</given-names></name><name><surname>Schmid</surname> <given-names>C</given-names></name><name><surname>Liu</surname> <given-names>C-L</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Action recognition by dense trajectories </article-title><conf-name>IEEE Conference on Computer Vision and Pattern Recognition</conf-name><fpage>3169</fpage><lpage>3176</lpage><pub-id pub-id-type="doi">10.1109/CVPR.2011.5995407</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>B</given-names></name><name><surname>Mezlini</surname> <given-names>AM</given-names></name><name><surname>Demir</surname> <given-names>F</given-names></name><name><surname>Fiume</surname> <given-names>M</given-names></name><name><surname>Tu</surname> <given-names>Z</given-names></name><name><surname>Brudno</surname> <given-names>M</given-names></name><name><surname>Haibe-Kains</surname> <given-names>B</given-names></name><name><surname>Goldenberg</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Similarity network fusion for aggregating data types on a genomic scale</article-title><source>Nature Methods</source><volume>11</volume><fpage>333</fpage><lpage>337</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2810</pub-id><pub-id pub-id-type="pmid">24464287</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname> <given-names>W</given-names></name><name><surname>Noble</surname> <given-names>JA</given-names></name><name><surname>Zisserman</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Microscopy cell counting and detection with fully convolutional regression networks</article-title><source>Computer Methods in Biomechanics and Biomedical Engineering: Imaging &amp; Visualization</source><volume>6</volume><fpage>283</fpage><lpage>292</lpage></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaritsky</surname> <given-names>A</given-names></name><name><surname>Natan</surname> <given-names>S</given-names></name><name><surname>Ben-Jacob</surname> <given-names>E</given-names></name><name><surname>Tsarfaty</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Emergence of HGF/SF-induced coordinated cellular motility</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e44671</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0044671</pub-id><pub-id pub-id-type="pmid">22970283</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaritsky</surname> <given-names>A</given-names></name><name><surname>Kaplan</surname> <given-names>D</given-names></name><name><surname>Hecht</surname> <given-names>I</given-names></name><name><surname>Natan</surname> <given-names>S</given-names></name><name><surname>Wolf</surname> <given-names>L</given-names></name><name><surname>Gov</surname> <given-names>NS</given-names></name><name><surname>Ben-Jacob</surname> <given-names>E</given-names></name><name><surname>Tsarfaty</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Propagating waves of directionality and coordination orchestrate collective cell migration</article-title><source>PLOS Computational Biology</source><volume>10</volume><elocation-id>e1003747</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003747</pub-id><pub-id pub-id-type="pmid">25058592</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaritsky</surname> <given-names>A</given-names></name><name><surname>Welf</surname> <given-names>ES</given-names></name><name><surname>Tseng</surname> <given-names>YY</given-names></name><name><surname>Angeles Rabadán</surname> <given-names>M</given-names></name><name><surname>Serra-Picamal</surname> <given-names>X</given-names></name><name><surname>Trepat</surname> <given-names>X</given-names></name><name><surname>Danuser</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Seeds of locally aligned motion and stress coordinate a collective cell migration</article-title><source>Biophysical Journal</source><volume>109</volume><fpage>2492</fpage><lpage>2500</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2015.11.001</pub-id><pub-id pub-id-type="pmid">26682808</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaritsky</surname> <given-names>A</given-names></name><name><surname>Tseng</surname> <given-names>YY</given-names></name><name><surname>Rabadán</surname> <given-names>MA</given-names></name><name><surname>Krishna</surname> <given-names>S</given-names></name><name><surname>Overholtzer</surname> <given-names>M</given-names></name><name><surname>Danuser</surname> <given-names>G</given-names></name><name><surname>Hall</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Diverse roles of guanine nucleotide exchange factors in regulating collective cell migration</article-title><source>The Journal of Cell Biology</source><volume>216</volume><fpage>1543</fpage><lpage>1556</lpage><pub-id pub-id-type="doi">10.1083/jcb.201609095</pub-id><pub-id pub-id-type="pmid">28512143</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Zhou</surname> <given-names>B</given-names></name><name><surname>Tang</surname> <given-names>X</given-names></name><name><surname>Wang</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Measuring crowd collectiveness</article-title><conf-name>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</conf-name><conf-loc>United States</conf-loc><fpage>3049</fpage><lpage>3056</lpage></element-citation></ref><ref id="bib58"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Zhou</surname> <given-names>FY</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>MOSES (Motion Sensing Superpixels)</data-title><source>GitHub</source><version designator="9ab910f">9ab910f</version><ext-link ext-link-type="uri" xlink:href="https://github.com/fyz11/MOSES">https://github.com/fyz11/MOSES</ext-link></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.40162.047</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Mohammadi</surname><given-names>Hamid</given-names></name><role>Reviewing Editor</role><aff><institution>Francis Crick Institute</institution><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>[Editors’ note: a previous version of this study was rejected after peer review, but the authors submitted for reconsideration. The first decision letter after peer review is shown below.]</p><p>Thank you for submitting your work entitled &quot;Motion Sensing Superpixels (MOSES) is a systematic framework to quantify and discover cellular motion phenotypes&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and a Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Roberto Cerbino (Reviewer #3).</p><p>As you will note, the three expert reviewers find some merit in the MOSES method but raise many issues that preclude publication. As we feel the additional work needed to address the issues raised by the reviewers would take more than two months to complete, we are returning your submission to you now in case you wish to submit elsewhere for speedy publication. Further, the number and complexity of these issues make the editorial team reluctant to encourage a resubmission unless a very substantial amount of additional work was performed. In this case, <italic>eLife</italic> would be willing to look at a revised paper. Please note that it would be treated as a new submission with no guarantees of acceptance. The two most critical factors from an editorial perspective are:</p><p>i) Demonstrating the utility of the method on a diverse range of imaging inputs (reviewer #3 point #5 – there is also a reference to some suggested data) and;</p><p>ii) Increased biological measurements, including analysis of proliferation and/or cell density. Given that this study is focused on a new technique, the final decision on this work will be highly dependent on convincingly demonstrating the broad utility of the methodology to the cell migration and tissue morphogenesis community. In addition, it will be important to address the technical issues raised, including out of plane movement or loss of cells, further analysis of the 'boundary', and improving the readability of the study.</p><p>Our decision has been reached after consultation between the reviewers.</p><p><italic>Reviewer #1:</italic></p><p>In the manuscript &quot;Motion Sensing Superpixels (MOSES): A systematic framework to quantify and discover cellular motion phenotypes&quot;, Zhou et al. present a new method for measuring cell motility in epithelial sheets and apply this to boundary formation in Barrett's Esophagus.</p><p>The approach presented fills the technical gap between PIV/Optical flow measurements and single-cell tracking and provides a method to characterise, and through PCA, discover, motion phenotypes within 2D epithelia. This is certainly a technically interesting concept that is relatively simple to implement and provides insight into motion phenotypes within a tissue. This method will be broadly applicable to many problems in characterising cellular motion. In general I find the manuscript well written and comprehensive in its description of the technique, but not particularly easy to read.</p><p>One of the difficulties is that it is unclear to me whether the authors intend to reveal new insight into the fundamental phenomena or simply provide a framework for automating the analysis for e.g. drug discovery. I would argue that cell state (sub cellular protein levels, cell cycle, cell death/extrusion, as examined in Schmitz et al., 2010, Pau et al., 2013, Held et al., 2010) are equally important and are not addressed by the current method.</p><p>In the present manuscript, only the cell motion is considered and yet cell proliferation/density is likely to be very important also. Can the authors provide cell density measurements (a proxy for cell proliferation) as a function of time, perhaps using the CNN counting approach, to give some estimate of motion versus proliferation?</p><p>This would be particularly interesting in light of the experiments involving titration of EGF. These are very interesting and provide some insight into how collective dynamics/cell adhesion are important in the tissue mechanics in general.</p><p>Another consideration is that of axial/upward motion at the interface between the two epithelial monolayers as they meet. Presumably the MOSES approach would register very little motion in a region where cells are being extruded upward (as in Figure 1B). How do the authors envisage addressing this?</p><p>Overall, I think that this is a technically interesting manuscript, which provides a set of tools for measuring and characterising cell motion phenotypes from high-throughput time-lapse imaging. This is likely to be a broadly useful tool for the community and addresses a long-standing problem of characterising mesoscale behaviour with close to single-cell accuracy. In my opinion, a revised manuscript would need to provide some additional information regarding the proliferation/density/state of cells within the tissue also.</p><p><italic>Reviewer #2:</italic></p><p>In this study, the authors utilized their newly developed mesh-based computational framework, MOSES, to analyze the collective motion of the cells and interactions between epithelial monolayers before and after their lateral collision. They have examined three main epithelial interactions that occur in normal esophagus to esophageal adenocarcinoma progression. These interactions (Video 2) lead to formation of a stable boundary with highly dynamic motion of the two cell populations after collision (in squamous-squamous interactions), a stable boundary with less dynamic motion of cell populations after collision and having squamous monolayer pushed by columnar monolayer (squamous-columnar), and no boundary formation with retraction of squamous cell population after collision (squamous-cancer). Authors mainly define two measurements (boundary formation index and motion stability index) to quantify the differences of these boundaries. Both measurements result in selection of squamous-columnar as stable boundary while leave the other two cell combinations in the &quot;unstable boundary&quot; category. Further, authors investigate the effect of activation of EGFR signaling pathway in boundary formation using MOSES. While the approach is appropriate, the current level of analyses does not provide substantial enough improvement relative to other works to justify publication in <italic>eLife</italic>. There are a number of critiques that authors should address before considering this manuscript for publication.</p><p>1) Although the nature of boundaries between squamous-squamous and squamous-cancer are distinct, both are considered as &quot;no boundary&quot; based on boundary index analysis and &quot;unstable boundary&quot; based on stability index analysis. Authors should define new measurements to extract the differences between these two boundaries.</p><p>2) As stated by the authors, PIV can be also used for motion extraction in dense monolayers. Authors should clearly state how potential users might benefit using MOSES that otherwise would not be possible using PIV.</p><p>3) How would the mesh analysis be affected in case that there would be no continuity in monolayers after collision (i.e. occurrence of detached patches of cells after collision)? Could it be captured in disorder index analysis?</p><p>4) Authors have used no serum condition in order to disrupt the cell-cell contact within the monolayers. As serum may affect numerous cell functions, it is not clear if loss of collective sheet migration is because of the reduced cell-cell contacts. Authors are encouraged to use cells that have deleted intercellular adhesion (e.g. α catenin).</p><p>5) It would be beneficial to measure migratory behavior of each superpixel with respect to its distance from the boundary before and after collision.</p><p>6) How may the analyses change in cases that a combination of stable and unstable boundaries exist in the same field of view?</p><p>7) Authors state that in squamous-squamous interactions when cells are exposed to 20 ng/ml of EGF the values of boundary and stability indices are similar to that of squamous-cancer interactions. However, there is no retraction observed in squamous-squamous interactions (Video 7). Again, this needs to be resolved.</p><p><italic>Reviewer #3:</italic></p><p>The manuscript under review describes a method (MOSES) to quantify cell dynamics. The method is tested with epithelial monolayers made of different cell types. MOSES appears to be an interesting approach to the quantification of cell dynamics. However, for the reasons outlined below, I cannot recommend publication of the manuscript in the present form.</p><p>1) The paper is too technical to be really useful for potential users. In particular:</p><p>1a) The description of the track filtering and mesh formulation steps are so involved that in the end, I did not understand how a mesh is generated and used.</p><p>1b) In a similar manner, the boundary formation index (and to some extent also the motion stability index) is introduced in a way that requires a bona fide effort from the reader to believe that it really measures what is claimed. In my view, a methodological paper like this one, does not benefit from having all the important definitions in the Materials and methods section. Also, it would be greatly appreciated to be able to understand why the proposed parameters for the quantification of the cell dynamics outperform other possible choices.</p><p>1c) There are parts that are incomprehensible, such as for instance the paragraph entitled Automated cell counting with convolutional neural networks. This is a pity because the principal component analysis represents one of the most promising features of the method.</p><p>1d) Some quantities are not sufficiently defined. For instance, how is TrackMate similarity in Figure 2—figure supplement 2C defined? How is the distance defined in the vertical axis of Figure 1 - figure supplement 5B?</p><p>1e) Some choices are not clearly explained: why the cut-off for boundary formation and stability are defined by using the standard deviation? This choice seems to me to be an ambiguous one. For instance, a cut-off for boundary formation is &quot;defined statistically as one standard deviation <italic>higher</italic> than the pooled mean of all three combinations (Figure 3C). Above this cut-off, cell combinations are categorised as forming a boundary&quot;. Surprisingly, a few lines below the authors write &quot;Similarly, experiments in 0% serum were used to set the global motion stability threshold (0.87), one standard deviation <italic>below</italic> the pooled mean&quot; (Figure 3D). Can the authors explain this asymmetry? The use of standard deviations for fixing thresholds would need in my view that a band exists (pooled mean +/- standard deviation) where the behavior is not determined. Only below mean + sd and above mean - sd a clear behavior could be attributed.</p><p>I suggest that the authors consider seriously revising the structure of their paper to make it understandable to a wide audience and to enable the potential reader to properly evaluate the powerfulness and the limitations of the proposed approach.</p><p>2) The literature review presented in the Introduction is also not clear, being a puzzling mix of methods to quantify the cell dynamics (such as tracking and PIV) and models (such as the vertex model). To me, the authors fail in merging successfully these two branches of literature and, in particular, in explaining where does MOSES fit and why the previously available tools, are not as good as MOSES in terms of robustness, sensitivity, automatization, and unbiasedness.</p><p>3) There are some claims that seem not to be supported by the experimental results. Typical examples are:</p><p>3a) Subsection “In-vitro model to study the spatio-temporal dynamics of boundary formation between different cell populations”, first paragraph: Figure 1—figure supplement 2 is cited in support of the fact that cells labeled with different color dye move in a similar way. Inspection of SF2(Figure 1 - figure supplement 2) shows that in some cases the MSD can differ by about one order of magnitude. How is it that the authors consider this a proof of similarity?</p><p>3b) The method is allegedly working perfectly in an automatic and unbiased fashion. How comes that the boundary in Figure 3—figure supplement 9A does not seem to be adequately determined?</p><p>3c) The statement &quot;The mesh disorder index showed statistically significant increases with EGF concentration&quot; does not seem to be supported by the data in Supplementary Figure 9, where a non-monotonic behavior would also be compatible with the data.</p><p>4) There are some claims whose general validity (i.e. in other experiments) is rather dubious.</p><p>4a) The Authors claim that &quot;individual cells behave similarly to their neighbors so global motion patterns can be used as a proxy to study single cell behavior&quot;. I doubt that this is always true. For instance, for the liquid states found in [Nature Materials 16, 587-596 (2017)] I believe that this claim wouldn't be true.</p><p>4b) Given that the L1-norm at is not defined, what is the general validity of the statement &quot;We use L1 for robustness as this value is &gt; 1&quot;?</p><p>5) The authors propose MOSES as a robust, sensitive, automatic and unbiased method and I trust them that this might be true. However, the current version of the manuscript proves that MOSES works fairly well in the few cases selected by the authors and it is not clear to me that it could be really used successfully in all other cases. Maybe, the authors could comment on this by suggesting cases in which they expect MOSES to work and cases where they think it would not. For instance, do the authors think that MOSES would work for the experiments in [Nature Materials 16, 1029 (2017)]?</p><p>In summary, I do see some potential in MOSES but the current version is not making a good job in explaining clearly what the method does, why is it better than other approaches and when it should be applicable. I hope that the authors will be able to address the above issues.</p><p>[Editors’ note: what now follows is the decision letter after the authors submitted for further consideration.]</p><p>Thank you for submitting your article &quot;Motion Sensing Superpixels (MOSES): A systematic framework to quantify and discover cellular motion phenotypes&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Didier Stainier as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Roberto Cerbino (Reviewer #2); Alison McGuigan (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>This manuscript is well improved and of high scientific value; however two of the reviewers raised several significant points that need clarification. These should be addressed in detail to resolve their concerns. The issue of serum-free condition as negative control may require additional experimentation for validation.</p><p><italic>Reviewer #1:</italic></p><p>The second version of the manuscript has been improved extensively and reads better than the first one. However, there are a few criticisms the authors should address before considering this manuscript for publication.</p><p>An important feature of the tissue boundaries is their shape. It would be beneficial if authors could also incorporate the analysis of boundary roughness in their computational framework.</p><p>Authors stated that the &quot;cancer cell line OE33 pushed EPC2 out of the field of view&quot;. Since the traction forces applied at the interface between the two sheets is not presented in the manuscript, it is unclear whether the EPC2 cells retracted upon contact with OE33 cells or are continuously pushed by application of physical forces exerted by OE33 cells at the interface.</p><p>Authors have conducted new experiments, where the impact of depletion of Ca<sup>2+</sup> on boundary formation is examined, to elucidate how the absent of cell-cell contact may disrupt the collective motion of the epithelial sheets. However, it is still unclear how serum depletion impacts the proliferation rate of the cells and that affects the collective motion of the sheets.</p><p>In conclusion, authors should present how much their computational framework can potentially improve our knowledge in biological processes and how it could be used to tackle new challenges.</p><p><italic>Reviewer #2:</italic></p><p>The authors have done an extensive amount of work to try to address all the reviewers' comments. As a result, the manuscript is now more clear and convincing in describing the proposed MOSES approach for quantifying the motility of cells belonging to a collective. I thus recommend publication in <italic>eLife</italic>.</p><p><italic>Reviewer #3:</italic></p><p>This paper presents a potentially useful tool to enable quantification of cell movement from large numbers of movies to better identify molecules that modulate collective cell migration dynamics. The scale of the data collected is impressive but I found this paper incredibly challenging to read and to understand what the data measurements physically represented and what these measurements meant biologically for our understanding of cell cooperation during boundary formation. Furthermore, I did not really understand the argument made by the authors that serum free represents no boundary formation versus for example delayed boundary formation since cells will move slower and proliferate less (and have a gap to fill before a boundary can form). This manuscript is interesting but is not currently accessible to a broad readership in my opinion.</p><p>The major comment I had that I think could significantly improve the impact of the work is can the authors better highlight the functional importance of the metrics they are quantifying in terms of the biological behaviours. For example is a boundary the best thing to be describing here or is wound healing a better example to be able to extract out different cell movement regimes to highlight the power of the tool? I could not understand how the metrics highlighted here could give me new insight into how a boundary is formed therefore it was not clear what I could learn using the tool.</p><p>The use of serum free medium to prevent boundary formation does not seem the most robust approach as this also likely impacts cell movement and proliferation, which will impact the timing required to form the boundary in the model being used (since the cells have to proliferate to fill the open space between the two cell domains. I am not sure of the logic behind specifying that doing things in serum free media gives a negative control that corresponds to a no-boundary formation case.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.40162.048</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the author responses to the first round of peer review follow.]</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>In the manuscript &quot;Motion Sensing Superpixels (MOSES): A systematic framework to quantify and discover cellular motion phenotypes&quot;, Zhou et al. present a new method for measuring cell motility in epithelial sheets and apply this to boundary formation in Barrett's Esophagus.</p><p>The approach presented fills the technical gap between PIV/Optical flow measurements and single-cell tracking and provides a method to characterise, and through PCA, discover, motion phenotypes within 2D epithelia. This is certainly a technically interesting concept that is relatively simple to implement and provides insight into motion phenotypes within a tissue. This method will be broadly applicable to many problems in characterising cellular motion. In general I find the manuscript well written and comprehensive in its description of the technique, but not particularly easy to read.</p><p>One of the difficulties is that it is unclear to me whether the authors intend to reveal new insight into the fundamental phenomena or simply provide a framework for automating the analysis for e.g. drug discovery.</p></disp-quote><p>MOSES is a computational framework that was developed with an aim to reveal new insights into fundamental phenomena of cellular motion dynamics. However, the biological data generated in this study are best suited to demonstrate the potential of MOSES rather than to conclude any new insight into the fundamental biological principles of cellular motion dynamics. In the revised manuscript, we have carried out a comprehensive comparison between MOSES and a widely used biological motion analysis framework, PIV (Particle Image Velocimetry). We illustrated a number of advanced features of MOSES over PIV and additionally have now emphasised the potential of MOSES in automated high-throughput screening applications. The ability of MOSES to employ a systematic analysis pipeline to generate motion maps in an unbiased way that captures local and global motion patterns through a dynamic mesh construction, will enable future study of novel biological insights in cellular motion dynamics. These points have now been clarified in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>I would argue that cell state (sub cellular protein levels, cell cycle, cell death/extrusion, as examined in Schmitz et al., 2010, Pau et al., 2013, Held et al., 2010) are equally important and are not addressed by the current method.</p></disp-quote><p>General methods for quantifying cell states are indeed important and pattern recognition methods are being applied to analyse protein levels. When cells are sparse, existing published software such as TrackMate, CellProfiler, CIV can be used for single cell or particle tracking. Our work here, however, primarily focuses on the extraction and analysis of collective biological motion and complex phenotypes regardless of cellular density for which software is rarely available and current analysis capabilities are limited. We have now mentioned this in the Discussion.</p><disp-quote content-type="editor-comment"><p>In the present manuscript, only the cell motion is considered and yet cell proliferation/density is likely to be very important also. Can the authors provide cell density measurements (a proxy for cell proliferation) as a function of time, perhaps using the CNN counting approach, to give some estimate of motion versus proliferation?</p><p>This would be particularly interesting in light of the experiments involving titration of EGF. These are very interesting and provide some insight into how collective dynamics/cell adhesion are important in the tissue mechanics in general.</p></disp-quote><p>Thank you for the suggestion. We considered that for cell counting to accurately reflect cell proliferation rate, the whole field of view should be covered or the cell population should be largely static (not migratory). In our videos of migrating epithelial sheets, the cells are both moving and proliferating. In these circumstances we propose two approaches to estimate cell proliferation independent of migration.</p><p>i) Cell density counting using CNNs (Materials and methods). To avoid issues of moving areas, cells were counted from randomly sampled equal sized image window patches of 64x64 pixels with full cell coverage inside. The average cell density for each cell population was reported as the average over 100 random such windows per time point (Materials and methods).</p><p>ii) Quantification of the rate in fluorescence decay. As fluorescently stained cells divide, over time the dye intensity exponentially decays. The faster the division rate, the faster the decay rate. (Materials and methods).</p><p>As requested, we applied this to the EGF experiments. Results are shown in new Figure 4—figure supplement 1. Both methods show no differences in the cell proliferation rates of a confluent epithelial sheet with increasing EGF concentration in 5% serum. This is different from a sparse culture in which EGF concentration is more likely to influence cell proliferation rate.</p><disp-quote content-type="editor-comment"><p>Another consideration is that of axial/upward motion at the interface between the two epithelial monolayers as they meet. Presumably the MOSES approach would register very little motion in a region where cells are being extruded upward (as in Figure 1B). How do the authors envisage addressing this?</p></disp-quote><p>Our primary interest in developing a scalable approach for high-throughput screening led us to focus our work on monolayers of cells and 2D timelapse videos, which are the most readily available. However we note that Boquet-Pujadas et al. (BioFlow: a non-invasive, image-based method to measure speed, pressure and forces inside living cells. Scientific reports 7.1 (2017): 9178) have shown already that the optical flow method of motion extraction can be extended with additional mathematical constraints to capture out-of-plane motion. Although the current version of MOSES does not contain such a feature however it can be extended and applied on 3D+time imaging to capture such extrusion processes in the future. This possibility has been discussed in our revised manuscript (see revised main text).</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>[…] 1) Although the nature of boundaries between squamous-squamous and squamous-cancer are distinct, both are considered as &quot;no boundary&quot; based on boundary index analysis and &quot;unstable boundary&quot; based on stability index analysis. Authors should define new measurements to extract the differences between these two boundaries.</p></disp-quote><p>To address this reviewer’s comment, we quantified the observed differences between the squamous-squamous and squamous-cancer boundaries displaced distance and the results is now shown in the new Figure 1G.</p><disp-quote content-type="editor-comment"><p>2) As stated by the authors, PIV can be also used for motion extraction in dense monolayers. Authors should clearly state how potential users might benefit using MOSES that otherwise would not be possible using PIV.</p></disp-quote><p>We include a new section and a summary table in the revised manuscript that explicitly compares the benefits of MOSES with respect to PIV using two published datasets. Please see Results section “Comparison between MOSES and PIV” and new Figure 6.</p><disp-quote content-type="editor-comment"><p>3) How would the mesh analysis be affected in case that there would be no continuity in monolayers after collision (i.e. occurrence of detached patches of cells after collision)? Could it be captured in disorder index analysis?</p></disp-quote><p>To address this reviewer’s comments to perform the mesh analysis when there is no continuity in monolayers after collision we used a video of EPC2 (R):OE33 (G) cells with 5ng/ml of Lapatnib (EGF inhibitor). At this concentration, after the two sheets collide, EPC2 cells rapidly die and shrivel up, creating numerous ‘gaps’ in the epithelial sheet. The results are shown in the new Figure 3—figure supplement 3, where these irregular movements in EPC2 are clearly captured in snapshots of the mesh (Figure 3—figure supplement 3A), and registered in the corresponding mesh strain curve (Figure 3—figure supplement 3B).</p><disp-quote content-type="editor-comment"><p>4) Authors have used no serum condition in order to disrupt the cell-cell contact within the monolayers. As serum may affect numerous cell functions, it is not clear if loss of collective sheet migration is because of the reduced cell-cell contacts. Authors are encouraged to use cells that have deleted intercellular adhesion (e.g. α catenin).</p></disp-quote><p>Although we agree with this reviewer that depleting α catenin will disrupt cell/cell contact, to be able to disrupt and re-establish cell-cell contacts with high efficiency and reproducibility is crucial to test the robustness of MOSES. This is the reason why we did not use genetic manipulation to disrupt cell-cell contacts because the efficacy of RNAi or CRISPR mediated depletion of any given gene can be highly variable among different experimental conditions and it is not easily reversible.</p><p>Depletion of Ca<sup>2+</sup> is very well known to disrupt the cell-cell contacts in epithelial cells and addition of Ca+ can also induce the re-establishment of the cell/cell contacts. Thus we measured the corresponding boundary formation index in cells with Ca+ depletion or with various concentrations of Ca+ added back to culture mediums as indicated. Additionally we performed the experiment with different FBS concentrations and different media; KSFM, KSFM+RPMI and KSFM+RPMI+FBS, to control for potential media effects. To measure motion collectiveness we used the standard velocity order parameter. The results are shown in the <xref ref-type="fig" rid="respfig1">Author response image 1</xref>. Across all samples a significant correlation between the motion collectiveness as measured by the velocity order parameter and the boundary formation index (Pearson correlation coefficient, r = 0.41) was found when all n = 33 samples were pooled together (right hand scatter plot in <xref ref-type="fig" rid="respfig1">Author response image 1</xref>).</p><fig id="respfig1"><label>Author response image 1.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-resp-fig1-v2.tif"/></fig><p>All numerical concentrations without units in the figure refer to ng/ml, thus Cal:1000 denotes a 1000ng/ml concentration of Ca<sup>2+</sup>.</p><disp-quote content-type="editor-comment"><p>5) It would be beneficial to measure migratory behavior of each superpixel with respect to its distance from the boundary before and after collision.</p></disp-quote><p>Due to the difficulty of representing this information for all the superpixels (1000) across 144 frames and in 2D with a moving boundary, we approximated the interface between the two cells as a vertical line and constructed velocity kymographs from the extracted dense optical flow which the superpixels use to update their (<italic>x</italic>,<italic>y</italic>) positions, as in the paper of Trepat (Rodríguez-Franco et al., 2017). These are included as the new Figure 3A for the three principal cell combinations EPC2:EPC2, EPC2:CP-A and EPC2:OE33 in 0% and 5% serum, and as the new Figure 4B for EGF addition to EPC2:CP-A in serum.</p><disp-quote content-type="editor-comment"><p>6) How may the analyses change in cases that a combination of stable and unstable boundaries exist in the same field of view?</p></disp-quote><p>Unfortunately we do not have a video dataset where we have exclusively studied the coexistence of stable and unstable boundaries in the same field of view. However our experiments with EGF inhibition when applied to the cell combinations of EPC2:CP-A (squamous-columnar) and EPC2:OE33 (squamous-cancer) contain a small set of examples for illustration of the required changes and we report our results in <xref ref-type="fig" rid="respfig2">Author response image 2</xref>.</p><p>In <xref ref-type="fig" rid="respfig2">Author response image 2A</xref>, we observed partial rescue of the EPC2:OE33 phenotype upon EGF inhibition with motion behaviour more similar to EPC2:CP-A however at these concentrations the EGF inhibitor (Lapatnib) is toxic to the cells and leads to death. This effectively induces the formation of ‘multiple unstable boundaries’ in the EPC2 cells with a moving OE33 front. The boundary formation index cut-offs established in the paper in new Figure 3C implicitly assume the presence of one boundary. Applied here, whilst the boundary formation index still captures the motion concentration in the motion saliency map, as stated in the new main text, it will no longer be specific in only quantifying the interface (the boundary) between the two cell populations (<xref ref-type="fig" rid="respfig2">Author response image 2B</xref>). To handle the presence of multiple boundaries, one can segment the different unique boundaries by thresholding on the motion saliency map and deriving more specific measures such as counting the number of ‘spot-like’ sites.</p><fig id="respfig2"><label>Author response image 2.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-40162-resp-fig2-v2.tif"/></fig><disp-quote content-type="editor-comment"><p>7) Authors state that in squamous-squamous interactions when cells are exposed to 20 ng/ml of EGF the values of boundary and stability indices are similar to that of squamous-cancer interactions. However, there is no retraction observed in squamous-squamous interactions (Video 7). Again, this needs to be resolved.</p></disp-quote><p>We assume by retraction the reviewer is referring to the squamous-columnar (EPC2:CP-A) combination where the CP-A cells push the squamous EPC2 cells out of the field of view. We have quantified this displaced distance relative to the size of the image in the new Figure 4D with the EPC2:OE33 videos as reference. Grouping the displaced distance in terms of &lt;5ng/ml and &gt;=5ng/ml, the difference in displaced distance is highly significant, and there was no statistically significant difference in the displaced distance between EPC2:CP-A with 20ng/ml EGF and EPC2:OE33.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>The manuscript under review describes a method (MOSES) to quantify cell dynamics. The method is tested with epithelial monolayers made of different cell types. MOSES appears to be an interesting approach to the quantification of cell dynamics. However, for the reasons outlined below, I cannot recommend publication of the manuscript in the present form.</p><p>1) The paper is too technical to be really useful for potential users. In particular:</p><p>1a) The description of the track filtering and mesh formulation steps are so involved that in the end, I did not understand how a mesh is generated and used.</p></disp-quote><p>We have simplified the definitions and abstracted the details more in the main text and the Materials and methods section, and refer interested/more specialised users to the Materials and methods and source code. We have added a schematic diagram of MOSES as a new Figure 2, and the new Figure 2—figure supplement 1 illustrates the technical explanation of the track filtering, which is detailed in the Materials and methods.</p><p>Track Filtering:</p><p>Our regular spaced superpixels across the whole image act like mini-cameras that assess the local velocity. In the initial frames, only those superpixels that cover the epithelial sheet will move. The rest will remain static as they cover the background image pixels that are black. The objective of the track filtering is to only identify those ‘wanted’ superpixels that cover the movement of the epithelial sheet. Using the above observation, briefly the wanted superpixels can be captured by thresholding on the observed velocities of superpixels in the initial few frames. We have added new text on this in the Materials and methods section of the main text.</p><p>Mesh formulation:</p><p>The mesh formulation aims to capture the movement of individual superpixels with respect to its local neighbouring superpixels. This involves taking each individual superpixels and connecting it to its neighbours. What constitutes a neighbour? Mathematically this is user defined based on the particular application. For example the nearest k superpixels based on distance gives rise to the popular k-NN neighbour graph when considering flocking behaviour, or one can choose all superpixels within a cutoff distance d<sub>c</sub> as we have done here. The definition of neighbour can be recalculated at every time frame but here we only compute the neighbour at the initial timepoint, frame = 0 and assume the same neighbours are retained in all subsequent frames. By doing so if the distance between the neighbours increases dramatically this suggests disruptive motion (a group of cells that started close do not end up in the same spatial area). We have added new text also on this in the Materials and methods section of the main text.</p><disp-quote content-type="editor-comment"><p>1b) In a similar manner, the boundary formation index (and to some extent also the motion stability index) is introduced in a way that requires a bona fide effort from the reader to believe that it really measures what is claimed.</p></disp-quote><p>We apologise for being too complex in our descriptions, and have worked to improve them throughout the manuscript. The boundary formation index is derived from the motion saliency map which is theoretically motivated by Lagrangian mechanics (subsection “Quantitative measurement of</p><p>squamous and columnar epithelial boundary formation using MOSES”, second paragraph) in the new main text and above discussion regarding divergence of a motion field).</p><p>The mesh stability index (called motion stability index in the original manuscript) is introduced to measure the rate of movement of neighbouring superpixels relative to each other. If the distances between adjacent superpixels are constantly moving then this leads to an unstable mesh and a low stability index. On the other hand if the distance between adjacent cell groups do not change with respect to their initial configuration then the stability index is high. We highlight this property with simulated data (see new Figure 3—figure supplement 4), and have endeavoured to make all the descriptions easier for readers outside the field to follow.</p><disp-quote content-type="editor-comment"><p>In my view, a methodological paper like this one, does not benefit from having all the important definitions in the Materials and methods section. Also, it would be greatly appreciated to be able to understand why the proposed parameters for the quantification of the cell dynamics outperform other possible choices.</p></disp-quote><p>We have now ensured that the important definitions are explained in the main text and refer only to the very detailed definitions and methods in the supplementary material. We also now include a table (new Table 1) whereby each statistical indices in the paper has a biological definition/interpretation (e.g., mesh order measures the collectiveness of local cellular migration) and example biological applications. Finally a number of new figures have been introduced to illustrate these more complicated concepts (see new Figure 3—figure supplements 2-5).</p><disp-quote content-type="editor-comment"><p>1c) There are parts that are incomprehensible, such as for instance the paragraph entitled Automated cell counting with convolutional neural networks. This is a pity because the principal component analysis represents one of the most promising features of the method.</p></disp-quote><p>We apologise for the confusion. The paragraph entitled ‘automated cell counting with convolutional neural networks’ in the Materials and methods has now been edited for clarity. A new supplementary figure has been added (see new Figure 1—figure supplement 1) that clarifies better the training and application procedure of the convolutional neural network.</p><disp-quote content-type="editor-comment"><p>1d) Some quantities are not sufficiently defined. For instance, how is TrackMate similarity in Figure 2—figure supplement 2C defined? How is the distance defined in the vertical axis of Supplementary Figure 9D?</p></disp-quote><p>Similarity of MOSES tracks with TrackMate tracks are measured using the normalised cross-correlation between the paired tracks (see new Figure 2—figure supplement 2 legend). The potentially confusing original Supplementary Figure 9 showing the mesh disorder index is now removed and no longer part of the manuscript. The distance was in number of superpixels as in the spatial correlation computation of Figure 1—figure supplement 5B.</p><disp-quote content-type="editor-comment"><p>1e) Some choices are not clearly explained: why the cut-off for boundary formation and stability are defined by using the standard deviation? This choice seems to me to be an ambiguous one.</p></disp-quote><p>The metrics exhibit a unimodal distribution (see violin plots of new Figure 3C-E). Correspondingly it is statistically justified to use the standard deviation and the mean to set cut-offs. This practice is equivalent to using a t-distribution/normal distribution and in line with the standard practice of one-tailed t-tests. We have added a new section in the Materials and methods to explain this more clearly.</p><disp-quote content-type="editor-comment"><p>For instance, a cut-off for boundary formation is &quot;defined statistically as one standard deviation higher than the pooled mean of all three combinations (Figure 3B). Above this cut-off, cell combinations are categorised as forming a boundary&quot;.</p></disp-quote><p>The higher the boundary formation index, the greater the probability of forming a boundary. Thus we set one standard deviation higher than the pooled mean. This corresponds to a one-tailed t-test where we need to observe values at least as high as this threshold to confidently predict a boundary. The null hypothesis is the absence or insufficient evidence for boundary formation with the pooled combinations.</p><disp-quote content-type="editor-comment"><p>Surprisingly, a few lines below the authors write &quot;Similarly, experiments in 0% serum were used to set the global motion stability threshold (0.87), one standard deviation below the pooled mean&quot;. Can the authors explain this asymmetry?</p></disp-quote><p>Similarly the lower the mesh stability the more the epithelial sheet moves as a whole. We set one standard deviation lower than the pooled mean corresponding to the one-tailed test where we need to observe values at least as low as this to predict instability. The null hypothesis is that with the pooled combinations we already see mesh stability. Therefore the interesting phenomena to test for here is instability.</p><p>By choosing the cut-offs in this way we are being more stringent with what constitutes ‘boundary-forming’ and ‘unstable’ which are the two ‘interesting’ phenotypes contrary to the norm.</p><disp-quote content-type="editor-comment"><p>The use of standard deviations for fixing thresholds would need in my view that a band exists (pooled mean +/- standard deviation) where the behavior is not determined. Only below mean+ sd and above mean-sd a clear behavior could be attributed.</p></disp-quote><p>Our threshold choices are equivalent to fitting the data with a 2-class classifier. The reviewer’s suggestion of +/- cutoffs corresponds to a 3-class classifier is also a plausible model where the extra class is used as a ‘miscellaneous’ class where we are unsure of the phenotype. We believe that both models are justified. We chose to use the former which is more fitting in the context of drug screening.</p><disp-quote content-type="editor-comment"><p>I suggest that the authors consider seriously revising the structure of their paper to make it understandable to a wide audience and to enable the potential reader to properly evaluate the powerfulness and the limitations of the proposed approach.</p></disp-quote><p>We have improved the readability of the manuscript during our revision and the revised manuscript have been read by various colleagues including a former journal editor outside the field. We hope the revised manuscript is now more understandable to the broader reader.</p><disp-quote content-type="editor-comment"><p>2) The literature review presented in the Introduction is also not clear, being a puzzling mix of methods to quantify the cell dynamics (such as tracking and PIV) and models (such as the vertex model). To me, the authors fail in merging successfully these two branches of literature and, in particular, in explaining where does MOSES fit and why the previously available tools, are not as good as MOSES in terms of robustness, sensitivity, automatization, and unbiasedness.</p></disp-quote><p>We have carried out extensive modifications to the Introduction by providing more technical context for our work with respect to the existing literature. We have also included a new comprehensive comparison between MOSES and PIV, the most commonly used method and demonstrate the more advanced features of MOSES over PIV in the main text and Discussion.</p><disp-quote content-type="editor-comment"><p>3) There are some claims that seem not to be supported by the experimental results. Typical examples are:</p><p>3a) Subsection “In-vitro model to study the spatio-temporal dynamics of boundary formation between different cell populations”, first paragraph: Figure 1—figure supplement 2 is cited in support of the fact that cells labeled with different color dye move in a similar way. Inspection of SF2 (Figure 1—figure supplement 2) shows that in some cases the MSD can differ by about one order of magnitude. How is it that the authors consider this a proof of similarity?</p></disp-quote><p>Thank you for the comments. We have investigated the issue and found a batch effect inherent in the MSD calculation. In one batch of videos, one cell type was plated more asymmetrically (occupying ~70% of the image) as opposed to the normal 50% and we didn’t filter these tracks out in the MSD computation. The corrected quantification is presented in the new Figure 1—figure supplement 2 and statistical tests have been carried out on the extracted MSD components.</p><disp-quote content-type="editor-comment"><p>3b) The method is allegedly working perfectly in an automatic and unbiased fashion. How comes that the boundary in Figure 3—figure supplement 9A does not seem to be adequately determined?</p></disp-quote><p>Figure 3—figure supplement 9A illustrates the process by which we infer the gap closure frame starting from image segmentation of the fluorescent images. The objective was not to delineate perfectly the sheet boundaries but to accurately infer the time of gap closure for downstream analysis. Comparison of the inferred gap closure times over n = 246 videos with the corresponding consensus manual annotations of 3 independent researchers demonstrate high correlation (0.902 Pearson correlation) and an agreement of 94% within 5 frames, (new Figure 3—figure supplement 9E) which is very comparable to the 97% accuracy between individual humans. This justifies the initial quality of image segmentation used for the intended purpose of inferring the frame in which the gap between the two sheets are closed.</p><disp-quote content-type="editor-comment"><p>3c) The statement &quot;The mesh disorder index showed statistically significant increases with EGF concentration&quot; does not seem to be supported by the data in Supplementary Figure 9, where a non-monotonic behavior would also be compatible with the data.</p></disp-quote><p>During the revision, we carried out extensive testing using our own and published datasets and concluded that the newly proposed mesh order in the revised manuscript is more general than the initially proposed mesh order index as a measure of collective motion based on our MOSES mesh construction. The previously proposed mesh disorder index was only applicable between videos with identical initial configuration i.e. same type of cells and plating as in the case of the EGF titration videos. The results shown in Supplementary Figure 9 (original manuscript) was intended to highlight that the mesh disorder index deviates from uniformity when EGF concentrations &gt; 5ng/ml. Statistical tests were carried out to identify this deviation from a constant line model which is reasonable for 0-5ng/ml. Thus overall the behaviour is non-monotonic. With our new improved mesh order measurement, Supplementary Figure 9 of the original manuscript is now removed as we no longer use the mesh disorder index.</p><disp-quote content-type="editor-comment"><p>4) There are some claims whose general validity (i.e. in other experiments) is rather dubious.</p><p>4a) The Authors claim that &quot;individual cells behave similarly to their neighbors so global motion patterns can be used as a proxy to study single cell behavior&quot;. I doubt that this is always true. For instance, for the liquid states found in [Nature Materials 16, 587-596 (2017)] I believe that this claim wouldn't be true.</p></disp-quote><p>We address this point together with point 5 (see below).</p><disp-quote content-type="editor-comment"><p>4b) Given that the L1-norm at is not defined, what is the general validity of the statement &quot;We use L1 for robustness as this value is &gt; 1&quot;?</p></disp-quote><p>We apologise for neglecting to define this norm in our previous version of the manuscript. We have added a new section “Normalised Mesh Strain, L1-norm and robustness” in the Materials and methods explaining our design choice.</p><disp-quote content-type="editor-comment"><p>5) The authors propose MOSES as a robust, sensitive, automatic and unbiased method and I trust them that this might be true. However, the current version of the manuscript proves that MOSES works fairly well in the few cases selected by the authors and it is not clear to me that it could be really used successfully in all other cases. Maybe, the authors could comment on this by suggesting cases in which they expect MOSES to work and cases where they think it would not. For instance, do the authors think that MOSES would work for the experiments in [Nature Materials 16, 1029 (2017)]?</p></disp-quote><p>We thank the reviewer for their help in making available the raw videos of [Nature Materials 16, 587-596 (2017)] available. Together with the videos in [Nature Materials 16, 1029 (2017)] as our validation datasets we have refined our claims in the revised manuscript. In addition we profiled the similarity and differences between MOSES and PIV. The new results are included in the revised manuscript as a new section with an additional Figure 6 and accompanying summary table.</p><p>[Editors' note: the author responses to the re-review follow.]</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>The second version of the manuscript has been improved extensively and reads better than the first one. However, there are a few criticisms the authors should address before considering this manuscript for publication.</p><p>An important feature of the tissue boundaries is their shape. It would be beneficial if authors could also incorporate the analysis of boundary roughness in their computational framework.</p></disp-quote><p>We quantified the ‘boundary roughness’ according to the deviation of the geometrical boundary shape from a straight line, <italic>L</italic>/<italic>L</italic><sub>0</sub> where <italic>L</italic> is the length of the boundary and <italic>L</italic><sub>0</sub> is the length of the straight line joining the endpoints of the boundary as in Javaherian, Sahar, et al (Modulation of cellular polarization and migration by ephrin/Eph signal-mediated boundary formation.&quot; <italic>Integrative Biology</italic> 9.12 (2017): 934-946), (Figure 3—figure supplement 10). No significant departures from a straight line (<italic>L</italic>/<italic>L</italic><sub>0</sub>=1) were found. A new paragraph for extracting the boundary to calculate boundary shape has been added to the Materials and methods.</p><disp-quote content-type="editor-comment"><p>Authors stated that the &quot;cancer cell line OE33 pushed EPC2 out of the field of view&quot;. Since the traction forces applied at the interface between the two sheets is not presented in the manuscript, it is unclear whether the EPC2 cells retracted upon contact with OE33 cells or are continuously pushed by application of physical forces exerted by OE33 cells at the interface.</p></disp-quote><p>We acknowledge that without traction force measurements we can’t draw a clear conclusion about the forces at play in our assay, whether it was EPC2 cells which retracted or was continuously pushed by OE33 cells. The wording in our previous manuscript, “cancer cell line OE33 pushed EPC2 out of the field of view”, was used to describe the phenomenon of OE33 cells expanding into EPC2 cells resulting in their eventual disappearance from the field-of-view. This is supported by the derived motion field (Figure 1—figure supplement 3). Just before gap closure, EPC2 and OE33 cells are moving in opposite directions. After gap closure EPC2 cells near the interface continue to move in opposite directions to OE33 cells initially before they appear to be dominated by OE33 cells. This is suggestive of ‘pushing’. Unfortunately due to the large fluorescence decay in OE33 cells near the interface it is not fully conclusive whether this ‘pushing’ is continuously maintained for the full duration of the timelapse video. Confocal image of cell junctions in fixed samples at 72 h together with evidence of motion suggest continual application of physical forces. However further experimentation is required to confirm this under timelapse microscopy study. In the main we now state “in the squamous-cancer EPC2:OE33 combination, the cancer cell line OE33 expanded continuously, resulting in the disappearance of EPC2 from the field of view (Video 2, Figure 1E) as assessed by the motion field and confocal images (Figure 1—figure supplement 3). The forces that govern the behaviour of the two cell lines on contact are unknown and traction force microscopy is required to investigate the ‘retracting’ or ‘pushing’ behaviour of EPC2 or OE33 cells respectively in future studies”.</p><disp-quote content-type="editor-comment"><p>Authors have conducted new experiments, where the impact of depletion of Ca<sup>2+</sup> on boundary formation is examined, to elucidate how the absence of cell-cell contact may disrupt the collective motion of the epithelial sheets. However, it is still unclear how serum depletion impacts the proliferation rate of the cells and that affects the collective motion of the sheets.</p></disp-quote><p>To address this question, we used cell density as an indicator of cell proliferation. The mean cell density and mean change in cell density over the first 48 h (≈ 16 h before and 32 h after gap closure) were estimated from cells grown in serum (5% FBS) and no serum (0% FBS) conditions from individual video frames using the established convolutional neural network approach (Materials and methods). Our results, shown in the new Figure 1—figure supplement 4, suggest that under the experimental conditions used in these studies, the lack of serum has undetectable impact on cell density. This is in complete contrast to the observed increase in collective cell migration and presence of boundary formation in 5% serum. Together these results illustrate that serum-free medium has a profound impact on cell motion dynamics. We therefore used 0% serum in the paper as a computational negative control for the detection of boundary formation. We have modified wording in the text to provide explicit clarification to avoid confusion (see subsection “In-vitro model to study the spatio-temporal dynamics of boundary formation between different cell populations”, last paragraph).</p><disp-quote content-type="editor-comment"><p>In conclusion, authors should present how much their computational framework can potentially improve our knowledge in biological processes and how it could be used to tackle new challenges.</p></disp-quote><p>We thank the reviewer for the constructive comment. To address this we have rewritten the Introduction to provide additional rationale for the need of developing a computational framework like MOSES. In particular we highlight the advantage of MOSES over single-cell tracking and existing PIV/CIV type methods, “we developed Motion Sensing Superpixels (MOSES), a computational framework that aims to provide a flexible and general approach for biological motion extraction, characterisation and phenotyping. We empowered PIV-type methods with a mesh formulation that enables systematic measurement and unbiased extraction of rich motion features for single and collective cell motion suitable for high-throughput phenotypic screens.”</p><p>In the revised Discussion, the potential of MOSES to advance biological knowledge and its ability to tackle new challenges is stated as the following.</p><p>1) Single-cell tracks are notoriously problematic over long times; the track of a single cell may be lost or broken into many separate tracks. MOSES superpixel tracks avoids this and recovers the global motion patterns (c.f. motion saliency maps, derived measures and motion signatures). Whilst side-by-side comparison of MOSES and the standard PIV method using published datasets demonstrates that MOSES not only enables all the measurements of PIV, but by further exploiting long-time tracks and neighbourhood relationships, delivers greater physical and biological insights. (Discussion, second paragraph).</p><p>2) Complex salient spatio-temporal motion patterns and events such as boundary formation, deformation waves due to cell jamming between two cell populations and cell death can all be quantitatively captured by MOSES. Critically, the ability of MOSES to perform long-time tracking (up to 6 days demonstrated in this study) enabled spatial localisation of the cell populations involved in a particular motion phenotype. (Discussion, second paragraph).</p><p>3) MOSES does not require complex user settings to facilitate reproducibility in analyses because it does not aim to threshold or cluster out the moving objects or phenotypes during analysis, which would introduce intermediate processing errors. Rather its philosophy is to facilitate systematic generation of many motion-related measurements based on trajectory and mesh statistics sufficient for applying machine learning methods for data-driven object segmentation, video classification and phenotype detection in large video collections (e.g. Figure 5, motion map) with minimum prior information. The main parameter the user specifies is the number of initial superpixels, which determines the spatial resolution of analysis. No complicated fitting of complex models and no special hardware such as GPUs are required. (Discussion, last paragraph).</p><p>All of these illustrate the potential of MOSES as a powerful and systematic computational framework that is particularly useful for unbiased explorative high-content screening with an aim to discover fundamental principles of cellular motion dynamics in biology and to identify factors or drugs that can alter cellular motion dynamics in disease aetiology and treatment.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>This paper presents a potentially useful tool to enable quantification of cell movement from large numbers of movies to better identify molecules that modulate collective cell migration dynamics. The scale of the data collected is impressive but I found this paper incredibly challenging to read and to understand what the data measurements physically represented and what these measurements meant biologically for our understanding of cell cooperation during boundary formation. Furthermore, I did not really understand the argument made by the authors that serum free represents no boundary formation versus for example delayed boundary formation since cells will move slower and proliferate less (and have a gap to fill before a boundary can form). This manuscript is interesting but is not currently accessible to a broad readership in my opinion.</p><p>The major comment I had that I think could significantly improve the impact of the work is can the authors better highlight the functional importance of the metrics they are quantifying in terms of the biological behaviours. For example is a boundary the best thing to be describing here or is wound healing a better example to be able to extract out different cell movement regimes to highlight the power of the tool? I could not understand how the metrics highlighted here could give me new insight into how a boundary is formed therefore it was not clear what I could learn using the tool.</p></disp-quote><p>The aim of developing MOSES is as “a computational framework that aims to provide a flexible and general approach for biological motion extraction, characterisation and phenotyping. We empowered PIV-type methods with a mesh formulation that enables systematic measurement and unbiased extraction of rich motion features for single and collective cell motion suitable for high-throughput phenotypic screens.”. We have provided additional rationale for the need of developing such a computational framework in the revised Introduction. Accordingly in this paper the metrics are presented to highlight how MOSES offers a more flexible platform to define customized motion measures related to a specific biological phenomena compared to existing methods that better discriminates between the resulting motion phenotypes. Here we did not aim to specifically shed insight into how a boundary is formed. However it is important to note that further studies using our method to conduct a high-content screen following genetic or other experimental manipulations would enable us to reveal new mechanistic insights into boundary formation in an unbiased manner.</p><disp-quote content-type="editor-comment"><p>The use of serum free medium to prevent boundary formation does not seem the most robust approach as this also likely impacts cell movement and proliferation, which will impact the timing required to form the boundary in the model being used (since the cells have to proliferate to fill the open space between the two cell domains. I am not sure of the logic behind specifying that doing things in serum free media gives a negative control that corresponds to a no-boundary formation case.</p></disp-quote><p>This is a miscommunication on our part. In this paper our ‘negative’ control serves only to demonstrate the sensitivity of MOSES to distinguish between the clear boundary-like behaviour of EPC2:CP-A in 5% serum and the lack of in the corresponding ‘negative’ no-serum case. We do not attempt to claim any experimental conditions used in this study are biologically important in boundary formation as some of the conditions such as serum-free condition cannot be used as a rigorous biological control. Here we used serum-free medium as a condition to test the sensitivity of MOSES because it has a profound impact on cell motion dynamics with absence of boundary formation. We have now clearly stated this in the revised manuscript (subsection “<italic>In vitro</italic> model to study the spatio-temporal dynamics of boundary formation between different cell populations”, last paragraph, subsection “Quantitative measurement of squamous and columnar epithelial boundary formation using MOSES”, third paragraph).</p><p>To address this reviewer’s specific comments about the impact of serum on the timing and speed of boundary formation, we carried out further measurement during the revision and our results (new Figure 1—figure supplement 4, Figure 4—figure supplement 2) showed that:</p><p>1) The presence of serum causes variation in gap closure time (within +/- 5 h) but is not significant and consistent across all cell-line combinations (Figure 1—figure supplement 4A,B). This is in contrast to the notable average increased speed in serum across all cell combinations shown in Figure 3B.</p><p>2) The presence of serum does not have significant impact on the cell movement at the assay endpoint. All videos (96 h and 144 h) have the same normalized RMSD curves at late timepoints, (Figure 1—figure supplement 4B).</p><p>3) Consistent with our findings, serum has profound impact on cell movement. In 5% serum, cells moved more collectively (Figure 3F,G, Figure 1—figure supplement 5C) and moved quicker (Figure 3A,B). However increased cell movement speed alone does not contribute to boundary formation. Addition of EGF to EPC2:CP-A cells in no-serum conditions caused notable increase in cell movement speed but had minimal impact on collective migration and boundary formation (Figure 4—figure supplement 2C,G,J,K).</p></body></sub-article></article>