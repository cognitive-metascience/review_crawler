<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">53357</article-id><article-id pub-id-type="doi">10.7554/eLife.53357</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Structural Biology and Molecular Biophysics</subject></subj-group></article-categories><title-group><article-title>Top-down machine learning approach for high-throughput single-molecule analysis</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-66667"><name><surname>White</surname><given-names>David S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0164-0125</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-114412"><name><surname>Goldschen-Ohm</surname><given-names>Marcel P</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1466-9808</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-66669"><name><surname>Goldsmith</surname><given-names>Randall H</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9083-8592</contrib-id><email>rhg@chem.wisc.edu</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-5759"><name><surname>Chanda</surname><given-names>Baron</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4954-7034</contrib-id><email>chanda@wisc.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/><xref ref-type="fn" rid="pa1">†</xref></contrib><aff id="aff1"><label>1</label><institution>Department of Neuroscience, University of Wisconsin-Madison</institution><addr-line><named-content content-type="city">Madison</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Department of Chemistry, University of Wisconsin-Madison</institution><addr-line><named-content content-type="city">Madison</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Department of Neuroscience, University of Texas at Austin</institution><addr-line><named-content content-type="city">Austin</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution>Department of Biomolecular Chemistry University of Wisconsin-Madison</institution><addr-line><named-content content-type="city">Madison</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="senior_editor"><name><surname>Boudker</surname><given-names>Olga</given-names></name><role>Senior Editor</role><aff><institution>Weill Cornell Medicine</institution><country>United States</country></aff></contrib><contrib contrib-type="editor"><name><surname>Islas</surname><given-names>Leon D</given-names></name><role>Reviewing Editor</role><aff><institution>Universidad Nacional Autónoma de México</institution><country>Mexico</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Department of Anesthesiology, Washington University School of Medicine, St. Louis, United States</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>08</day><month>04</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e53357</elocation-id><history><date date-type="received" iso-8601-date="2019-11-06"><day>06</day><month>11</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2020-04-08"><day>08</day><month>04</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, White et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>White et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-53357-v2.pdf"/><abstract><p>Single-molecule approaches provide enormous insight into the dynamics of biomolecules, but adequately sampling distributions of states and events often requires extensive sampling. Although emerging experimental techniques can generate such large datasets, existing analysis tools are not suitable to process the large volume of data obtained in high-throughput paradigms. Here, we present a new analysis platform (DISC) that accelerates unsupervised analysis of single-molecule trajectories. By merging model-free statistical learning with the Viterbi algorithm, DISC idealizes single-molecule trajectories up to three orders of magnitude faster with improved accuracy compared to other commonly used algorithms. Further, we demonstrate the utility of DISC algorithm to probe cooperativity between multiple binding events in the cyclic nucleotide binding domains of HCN pacemaker channel. Given the flexible and efficient nature of DISC, we anticipate it will be a powerful tool for unsupervised processing of high-throughput data across a range of single-molecule experiments.</p></abstract><abstract abstract-type="executive-summary"><title>eLife digest</title><p>During a chemical or biological process, a molecule may transition through a series of states, many of which are rare or short-lived. Advances in technology have made it easier to detect these states by gathering large amounts of data on individual molecules. However, the increasing size of these datasets has put a strain on the algorithms and software used to identify different molecular states.</p><p>Now, White et al. have developed a new algorithm called DISC which overcomes this technical limitation. Unlike most other algorithms, DISC requires minimal input from the user and uses a new method to group the data into categories that represent distinct molecular states. Although this new approach produces a similar end-result, it reaches this conclusion much faster than more commonly used algorithms.</p><p>To test the effectiveness of the algorithm, White et al. studied how individual molecules of a chemical known as cAMP bind to parts of proteins called cyclic nucleotide binding domains (or CNDBs for short). A fluorescent tag was attached to single molecules of cAMP and data were collected on the behavior of each molecule. Previous evidence suggested that when four CNDBs join together to form a so-called tetramer complex, this affects the binding of cAMP. Using the DISC system, White et al. showed that individual cAMP molecules interact with all four domains in a similar way, suggesting that the binding of cAMP is not impacted by the formation of a tetramer complex.</p><p>Analyzing this data took DISC less than 20 minutes compared to existing algorithms which took anywhere between four hours and two weeks to complete. The enhanced speed of the DISC algorithm could make it easier to analyze much larger datasets from other techniques in addition to fluorescence. This means that a greater number of states can be sampled, providing a deeper insight into the inner workings of biological and chemical processes.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>divisive segmentation</kwd><kwd>zero mode waveguides</kwd><kwd>HCN channels</kwd><kwd>cooperativity</kwd><kwd>unsupervised analysis</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000065</institution-id><institution>National Institute of Neurological Disorders and Stroke</institution></institution-wrap></funding-source><award-id>NS-101723</award-id><principal-award-recipient><name><surname>Chanda</surname><given-names>Baron</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000065</institution-id><institution>National Institute of Neurological Disorders and Stroke</institution></institution-wrap></funding-source><award-id>NS-081320</award-id><principal-award-recipient><name><surname>Chanda</surname><given-names>Baron</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000065</institution-id><institution>National Institute of Neurological Disorders and Stroke</institution></institution-wrap></funding-source><award-id>NS-081293</award-id><principal-award-recipient><name><surname>Chanda</surname><given-names>Baron</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>GM007507</award-id><principal-award-recipient><name><surname>White</surname><given-names>David S</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>GM127957</award-id><principal-award-recipient><name><surname>Goldsmith</surname><given-names>Randall H</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>CHE-1856518</award-id><principal-award-recipient><name><surname>Goldsmith</surname><given-names>Randall H</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A new analysis algorithm (DISC) enables accurate analysis of data from high-throughput single-molecule paradigms and reveals a non-cooperative binding mechanism of cyclic nucleotide-binding domains from HCN ion channels.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Single-molecule methods are powerful tools for providing insight into heterogeneous dynamics underlying chemical and biological processes otherwise obscured in bulk-averaged measurements (<xref ref-type="bibr" rid="bib32">Moerner et al., 2015</xref>). Use of these techniques has expanded rapidly, with modalities spanning electrophysiology, fluorescence, and force spectroscopy to probe diverse physical phenomena. Generally, single-molecule data are obtained as a time trajectory where molecular behavior is observed as a series of transitions between a set of discrete states obscured by experimental noise. Following the growing realization that molecules involved in physiological and chemical processes exhibit complex kinetics and a diversity of behavior, there is an increasing demand for high-throughput technologies to adequately sample different sub-populations and rare but important events (<xref ref-type="bibr" rid="bib22">Hill et al., 2017</xref>). As a result, there has been tremendous progress in improving both the number of single molecules that can be observed simultaneously and the total observation time of each molecule. For example, the observation window prior to photobleaching in conventional fluorescence paradigms such as single-molecule Förster resonance energy transfer (smFRET) or colocalization single-molecule spectroscopy (CoSMoS) can be dramatically extended with recently developed photostable dyes (<xref ref-type="bibr" rid="bib18">Grimm et al., 2015</xref>; <xref ref-type="bibr" rid="bib3">Altman et al., 2012</xref>). The current generation of metal-oxide semiconductor (sCMOS) detectors enables simultaneous imaging of 1 × 10<sup>4</sup> molecules in a total internal fluorescence microscopy (TIRFM) configuration and can be coupled with nanofabricated zero-mode waveguides (ZMWs) to enable access to high concentrations (<xref ref-type="bibr" rid="bib29">Levene et al., 2003</xref>; <xref ref-type="bibr" rid="bib9">Chen et al., 2014</xref>; <xref ref-type="bibr" rid="bib26">Juette et al., 2016</xref>). Non-fluorescence-based single-molecule experiments such as plasmon rulers, scattering, magnetic tweezers, and single-molecule centrifugation generate a tremendous amount of data through parallel measurement of hundreds of molecules with orders of magnitude longer recordings than a typical fluorescence experiment (<xref ref-type="bibr" rid="bib4">Berghuis et al., 2016</xref>; <xref ref-type="bibr" rid="bib55">Ye et al., 2018</xref>; <xref ref-type="bibr" rid="bib54">Yang et al., 2016</xref>; <xref ref-type="bibr" rid="bib37">Popa et al., 2016</xref>; <xref ref-type="bibr" rid="bib56">Young and Kukura, 2019</xref>).</p><p>Unfortunately, despite these advances in generating statistically robust data sets, standard analysis algorithms impose a computational bottleneck at this scale of data generation (<xref ref-type="bibr" rid="bib22">Hill et al., 2017</xref>; <xref ref-type="bibr" rid="bib26">Juette et al., 2016</xref>). This is particularly true when the dynamics and physical states of a system are unknown.</p><p>Typical statistical modeling of single-molecule trajectories often adopts one of two approaches. The first is a probabilistic approach that models a molecule’s behavior as a Markov chain, wherein the molecule transitions between hidden discrete states whose outputs are measured experimentally (hidden Markov model, HMM). This involves estimating the transition probabilities between a small set of postulated states with defined outputs using methods to maximize the likelihood of the model given the observations or Bayesian inference to estimate model parameter distributions. Numerous software packages have been developed for implementing HMMs, such as QuB (<xref ref-type="bibr" rid="bib34">Nicolai and Sachs, 2013</xref>; <xref ref-type="bibr" rid="bib38">Qin et al., 2000</xref>), HaMMy (<xref ref-type="bibr" rid="bib31">McKinney et al., 2006</xref>), SMART (<xref ref-type="bibr" rid="bib17">Greenfeld et al., 2012</xref>), vbFRET (<xref ref-type="bibr" rid="bib7">Bronson et al., 2009</xref>), ebFRET (<xref ref-type="bibr" rid="bib50">van de Meent et al., 2014</xref>) and SPARTAN (<xref ref-type="bibr" rid="bib26">Juette et al., 2016</xref>), each of which utilize a different HMM training method. For example, QuB implements the fast segmental k-means algorithm (SKM) which combines k-means clustering and the Viterbi algorithm to identify transitions between postulated states (<xref ref-type="bibr" rid="bib25">Juang and Rabiner, 1990</xref>), whereas vbFRET adapts variational Bayesian inference for parameter estimation at faster speeds than traditional HMM training in both smFRET and single-particle tracking experiments (<xref ref-type="bibr" rid="bib6">Blanco and Walter, 2010</xref>; <xref ref-type="bibr" rid="bib36">Persson et al., 2013</xref>). Although powerful statistical tools are very useful for single-molecule analysis, HMMs have notable limitations, especially in the context of high-throughput analysis and unknown system dynamics. For example, HMMs are often used in a supervised manner where the user postulates model parameters such as the number of states, their measured outputs, and the allowed transitions between them. As this information is often not known a priori, it is desirable to test multiple models and rank them according to Bayesian probabilistic approaches or objective functions, such as the Bayesian Information Criterion (BIC). This process can dramatically increase the analysis time to ensure the parameters space has been sufficiently explored, which restrict their usefulness in high-throughput single-molecule analysis. Although variants such as infinite HMMs using Bayesian nonparametric inference try to naturally learn the trajectory of the states without the typical parametric model selection, these too are often computationally prohibitive for large data sets (<xref ref-type="bibr" rid="bib23">Hines et al., 2015</xref>; <xref ref-type="bibr" rid="bib44">Sgouralis and Pressé, 2017</xref>; <xref ref-type="bibr" rid="bib43">Sgouralis et al., 2018</xref>).</p><p>The second class of single-molecule analysis approaches idealization as an unsupervised clustering problem from machine learning (<xref ref-type="bibr" rid="bib30">Li and Yang, 2019</xref>). Typically, clusters of intensity values (e.g. states) are determined using bottom-up hierarchical agglomerative clustering (HAC) algorithms, which begin by treating each observation of <italic>N</italic> total observations as singleton clusters and perform <italic>N</italic>-1 iterations wherein pairs of clusters are merged until all data-points belong to a single cluster. For each number of possible clusters, an objective function can be minimized to find the optimal trade-off between the complexity and fit. This implementation results in time complexity of O(<italic>N</italic><sup>2</sup>) owning to the need of computing a <italic>N</italic>x<italic>N</italic> similarity matrix to determine which clusters should be merged at each iteration. In practice, a separate algorithm called change-point (CP) detection precedes HAC to reduce the solution domain of the objective function by identifying statistically significant stepwise changes in signal over time. We denote this combination of algorithms as CP-HAC. At each identified CP, the data are divided into two segments, each described by the mean values of the data-points between sequential change-points. By using the segments as initial clusters rather than all <italic>N</italic> data-points, the HAC computation can be dramatically reduced. The pioneering application of CP-HAC to single-molecule data addressed CP detection and clustering in the presence of Poisson noise (<xref ref-type="bibr" rid="bib53">Watkins and Yang, 2005</xref>). Variants of this framework such as STaSI use other merit functions for Gaussian noise, including the Student’s t-test for fast CP detection and minimum description length for state selection (<xref ref-type="bibr" rid="bib45">Shuang et al., 2014</xref>). An advantage of CP-HAC methods is that they only require a confidence interval and/or an objective function for the analysis, unlike HMMs which require a model to fit. This makes them very attractive in situations where there is no prior knowledge about the different physical states. In common experimental modalities such as smFRET, CP-HAC methods offer superior computational speed over HMM approaches; however, their quadratic time-complexity renders them inefficient on long trajectories (<xref ref-type="bibr" rid="bib45">Shuang et al., 2014</xref>). In addition, simulation studies have suggested CP-HAC algorithms yield lower event detection accuracy than HMM approaches (<xref ref-type="bibr" rid="bib19">Hadzic et al., 2018</xref>).</p><p>Despite the utility of HMM and CP-HAC methods, there is an outstanding need for an analysis platform to provide accurate model-free idealization with sufficiently high computational performance to keep up with the increasing scale of data generation. Although advances in computing hardware can, to a degree, mitigate these issues (<xref ref-type="bibr" rid="bib46">Smith et al., 2019</xref>; <xref ref-type="bibr" rid="bib47">Song and Yang, 2017</xref>), there remains a pressing need for more computationally efficient algorithms. Here, we present a new algorithm for efficient and accurate idealization of large single-molecule datasets in a model-independent manner. Our method, DISC (DIvisive Segmentation and Clustering), enhances existing statistical learning methods and enables rapid state and event detection. The DISC algorithm draws inspiration from other model-free algorithms like CP-HAC and SKM that rely on unsupervised algorithms, such as k-means and hierarchical clustering. We advance these ideas by adapting divisive clustering algorithms from data mining and information theory to improve the rate and accuracy of identifying signal amplitude clusters (states) in a top-down process as opposed to the typical bottom-up clustering (<xref ref-type="bibr" rid="bib35">Pelleg and Moore, 2000</xref>; <xref ref-type="bibr" rid="bib27">Karypis et al., 2000</xref>; <xref ref-type="bibr" rid="bib20">Hamerly and Elkan, 2003</xref>). We further couple our model-free state detection with the Viterbi algorithm to enable robust event detection on par with HMM methods (<xref ref-type="bibr" rid="bib25">Juang and Rabiner, 1990</xref>; <xref ref-type="bibr" rid="bib39">Qin, 2004</xref>; <xref ref-type="bibr" rid="bib51">Viterbi, 1967</xref>). Overall, DISC is an unsupervised method that combines statistical learning approaches with the high event detection accuracy of HMMs at a fraction of the computational cost, enabling convenient application to large datasets.</p><sec id="s1-1"><title>Theory</title><sec id="s1-1-1"><title>Motivation</title><p>The goal of the DISC algorithm is time series idealization: the hard assignment of data points into discrete states. DISC approaches the problem of idealization as an unsupervised problem in machine learning wherein the number of significant states for a given single-molecule trajectory are not known a priori. This process of learning both the significant states and the transitions between them is accomplished in three phases: 1) divisive segmentation, 2) HAC, and 3) the Viterbi algorithm (<xref ref-type="fig" rid="fig1">Figure 1a</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). The first two phases use unsupervised statistical learning to identify the intensities of states following an appropriate user-specified objective function. The second phase uses the Viterbi algorithm to decode the most probable sequence of transitions between the identified states.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of DISC.</title><p>(<bold>a</bold>) The major steps of the DISC algorithm combining unsupervised statistical learning with the Viterbi algorithm. (<bold>b</bold>) Stepwise discovery of states locally through divisive segmentation on a simulated trajectory. (<bold>c</bold>) HAC iteratively groups identified states to minimize an objective function for the fit of the whole trajectory to avoid overfitting. (<bold>d</bold>) The Viterbi algorithm is applied to identify the most probable hidden state sequence. The final fit by DISC (red) is overlaid against the true states in the simulation (dashed).</p><p><supplementary-material id="fig1sdata1"><label>Figure 1—source data 1.</label><caption><title>Plotted simulated data with DISC fit.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-53357-fig1-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Workflow of DISC.</title><p>Solid lines indicate the path DISC takes through divisive segmentation, hierarchical agglomerative clustering, and the Viterbi algorithm. IC = information criterion. General CP-HAC and HMM approaches are shown for comparison. Dotted lines indicate steps that do not overlap with DISC. Ovals indicate start/stop; rectangles indicate a process or computation; diamonds represent decisions. Note, most current uses of HMMs involve a single user-defined number of states.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig1-figsupp1-v2.tif"/></fig></fig-group><p>The primary distinction of DISC vs other model-free single-molecule analysis algorithms is the use of divisive clustering. Rather than being limited by the quadratic time-complexity of bottom-up HAC, DISC adopts the exact opposite hierarchical clustering algorithm: top-down divisive clustering. Divisive clustering initializes all data-points to a single cluster and iteratively splits data into sub-clusters until each data point is its own singleton cluster. Given that there are 2<italic> <sup>N</sup></italic><sup>−1</sup>-1 ways of spitting <italic>N</italic> data points into two sub-clusters, the complexity of top-down processes has led to their infrequent use. However, efficient implementations involving the use of sub-routines to determine how clusters should be split and whether the new clusters should be accepted has resulted in more efficient and accurate algorithms. For example, clusters can be sub-partitioned using k-means clustering and an objective function can determine if the fit of the data improves with an additional sub-cluster (<xref ref-type="bibr" rid="bib35">Pelleg and Moore, 2000</xref>; <xref ref-type="bibr" rid="bib27">Karypis et al., 2000</xref>; <xref ref-type="bibr" rid="bib20">Hamerly and Elkan, 2003</xref>). Therefore, unlike HAC which makes a final decision at the end of the clustering, top-down processes make a binary decision during each iteration. For each iteration, if the objective function does not improve with the addition of new sub-clusters, the split is rejected. If the fit does improve, the split is accepted and each sub-cluster is again further partitioned into two new sub-clusters. The algorithm terminates once clusters cannot be split for further improvement of the objective function. Given this internal heuristic of cluster acceptance or rejection, the most probable number of states is typically identified within a few iterations, as opposed to the <italic>N</italic>-1 iterations necessary for HAC. In addition, when using k-means for partitioning data points into sub-clusters, the top-down algorithms can reach O(<italic>N</italic>) time complexity (<xref ref-type="bibr" rid="bib27">Karypis et al., 2000</xref>). This simple implementation and accelerated computational speed make divisive clustering an attractive alternative that enables high-throughput single-molecule idealization.</p></sec><sec id="s1-1-2"><title>Divisive segmentation</title><p>The first phase of DISC is divisive segmentation. Consider an observed single-molecule trajectory <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>…</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> where each <inline-formula><mml:math id="inf2"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the observed intensity value <inline-formula><mml:math id="inf3"><mml:mi>x</mml:mi></mml:math></inline-formula> at time-stamp <italic>n</italic> for <italic>N</italic> total observations contaminated by Gaussian noise. Like CP-HAC, the goal of the divisive segmentation is to identify and allocate each data-point into the optimal number of idealized states denoted by <italic>K</italic>. Following our Gaussian assumption, each state <inline-formula><mml:math id="inf4"> <mml:mi/><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></inline-formula> is described by the mean (µ) and standard deviation (<inline-formula><mml:math id="inf5"><mml:mi>σ</mml:mi></mml:math></inline-formula>) of data points allocated to the state <inline-formula><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>. We denote a series of transitions between states as <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>…</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf8"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ∈ <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and 1 ≤ <italic>K</italic> ≤ <italic>N</italic>. Divisive segmentation aims to iteratively yield <inline-formula><mml:math id="inf10"><mml:mi>x</mml:mi></mml:math></inline-formula> by determining whether data-points in a given cluster are better described by one or two states. At the onset of divisive segmentation, it is assumed that <inline-formula><mml:math id="inf11"><mml:mi>x</mml:mi></mml:math></inline-formula> is described by a single idealized state. We will denote this initial fit as <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mn>0</mml:mn><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>…</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mn>0</mml:mn><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf13"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> ∈ <inline-formula><mml:math id="inf14"><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="inf15"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p><p>Allocating each data-point into two unique states is accomplished in two sequential phases: CP detection and k-means clustering. As opposed to standard divisive algorithms that allocate data points via k-means clustering only, we find CP identification prior to clustering advantageous. Not only does it reduce the solution domain of the objective function, but it also speeds up subsequent clustering while providing a reasonable estimate of state transitions. CP detection is performed with the popular recursive binary segmentation algorithm (<xref ref-type="bibr" rid="bib53">Watkins and Yang, 2005</xref>; <xref ref-type="bibr" rid="bib42">Scott and Knott, 1974</xref>). For each time stamp <italic>n</italic> in <inline-formula><mml:math id="inf16"><mml:mi>x</mml:mi></mml:math></inline-formula>, a hypothesis test is conducted to evaluate the probability that a CP occurred at position <italic>n</italic> via</p><list list-type="bullet"><list-item><p><italic>H<sub>0</sub></italic>: a CP did not occur at position <italic>n</italic></p></list-item><list-item><p><italic>H<sub>1</sub></italic>: a CP did occur as position <italic>n</italic></p></list-item></list><p>In the context of single-molecule idealization, a CP is the location indicating a significant difference in mean intensity values between the data segments separated at location <italic>n</italic>, where the mean values of each segment are computed by<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To determine whether there is a statistically significant difference between the two segments, we use a two-way Student’s t-test of unequal sample size but uniform variance to evaluate the differences in mean. This is the same approach used in STaSI (<xref ref-type="bibr" rid="bib45">Shuang et al., 2014</xref>). Specifically, a <italic>t</italic>-value is computed for each position <italic>n</italic> by<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula>where <italic>σ</italic> is the estimated standard deviation of uniform noise (<xref ref-type="bibr" rid="bib45">Shuang et al., 2014</xref>). The most probable CP location <italic>c</italic> corresponds to the maximum t-value <italic>t<sub>max</sub></italic> given by<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">r</mml:mi><mml:mi mathvariant="italic">g</mml:mi><mml:mi mathvariant="italic">m</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">x</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:munder><mml:mspace width="thinmathspace"/><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="italic">m</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">x</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:munder><mml:mspace width="thinmathspace"/><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For a user specified confidence interval, a critical value is used to determine whether to accept the change-point. If <italic>t<sub>max</sub></italic> &gt; critical-value, we reject <italic>H<sub>0</sub></italic> and the CP is accepted. This in turn segments the data at position <italic>c.</italic> As there are likely multiple CPs in <inline-formula><mml:math id="inf17"><mml:mi>x</mml:mi></mml:math></inline-formula>, the algorithm continues in a recursive manner by searching within each new segment <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. This process terminates when no significant changes in mean intensity are found within any segment. Importantly, the confidence interval set by the user plays a crucial role by acting as a hard threshold for false positive rate.</p><p>Following the completion of CP detection, times-series <inline-formula><mml:math id="inf20"><mml:mi>x</mml:mi></mml:math></inline-formula> can be described as a series of <italic>C</italic>+1 intensity segments where <italic>C</italic> is the total number of CP identified given by an idealized state trajectory where <inline-formula><mml:math id="inf21"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ∈ <inline-formula><mml:math id="inf22"><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></inline-formula> and 1 ≤ <italic>K</italic> ≤ <italic>C</italic>+1. Like CP-HAC, the next goal is to discover the optimal number of states <italic>K</italic> into which to cluster the <italic>C</italic>+1 intensity segments generated by CP detection. Rather than iteratively merging each segment like bottom-up algorithms, we use divisive segmentation to cluster the data points in a top-down fashion. For divisive segmentation, all identified segments are partitioned into two unique clusters using the k-means algorithm, where the center of each cluster is described by the mean values of the CP-idealized data points within the cluster. For efficiency, DISC uses a modified k-means algorithm that is both deterministic and faster than standard implementations through use of triangle inequality for computational reduction (<xref ref-type="bibr" rid="bib12">Elkan, 2003</xref>). Overall, this results in a series of transitions between two states <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>…</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> ∈ {<inline-formula><mml:math id="inf25"><mml:mi>ϕ</mml:mi></mml:math></inline-formula><italic><sub>1</sub>,</italic> <inline-formula><mml:math id="inf26"><mml:mi>ϕ</mml:mi></mml:math></inline-formula><italic><sub>2</sub></italic>} and <inline-formula><mml:math id="inf27"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> the corresponds to a state assignment for each observation in <inline-formula><mml:math id="inf28"><mml:mi>x</mml:mi></mml:math></inline-formula>.</p><p>Now that the data-points are allocated to two separate clusters with identified transitions, the goal is to determine if <inline-formula><mml:math id="inf29"><mml:mi>x</mml:mi></mml:math></inline-formula> is better fit with one or two states (<inline-formula><mml:math id="inf30"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> vs <inline-formula><mml:math id="inf31"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>). Like CP detection, this decision follows a hypothesis test where</p><list list-type="bullet"><list-item><p><italic>H<sub>0</sub></italic>: the data corresponds to one unique state</p></list-item><list-item><p><italic>H<sub>1</sub></italic>: the data corresponds to two unique states</p></list-item></list><p>To determine whether one or two states provides a better fit, we use the Bayesian Information Criterion (BIC) which is defined in a general form as<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mi>I</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="script">ℒ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="script">ℒ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the likelihood for the estimated model with <italic>M</italic> free parameters (<xref ref-type="bibr" rid="bib41">Schwarz, 1978</xref>). The likelihood that the observations <inline-formula><mml:math id="inf33"><mml:mi>x</mml:mi></mml:math></inline-formula> arose from a single state (<inline-formula><mml:math id="inf34"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>) is simply the product of the probability densities of a Gaussian distribution evaluated for each <inline-formula><mml:math id="inf35"> <mml:mi/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. For the multi-state fit of <inline-formula><mml:math id="inf36"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, the model extends to a mixture of 1D Gaussians whereby <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="script">ℒ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is computed as a linear combination of each <italic>K</italic> Gaussian components, corresponding to each state <inline-formula><mml:math id="inf38"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo> <mml:mi/></mml:math></inline-formula> with <inline-formula><mml:math id="inf39"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> weighted by a mixing coefficient (<inline-formula><mml:math id="inf40"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) (<xref ref-type="bibr" rid="bib5">Bishop, 2006</xref>).<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>σ</mml:mi><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="script">ℒ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>∗</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To test the null hypothesis that <inline-formula><mml:math id="inf41"><mml:mi>x</mml:mi></mml:math></inline-formula> is described by one state instead of two, BIC values are computed for <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> with a fit of a single-state (BIC<sub>1</sub>) and fit with two-states from divisive segmentation (BIC<sub>2</sub>). If BIC<sub>2</sub> &gt; BIC<sub>1</sub>, <italic>H<sub>0</sub></italic> is accepted and we believe <inline-formula><mml:math id="inf43"><mml:mi>x</mml:mi></mml:math></inline-formula> is sufficiently described by a single-state. If the BIC<sub>2</sub> ≤ BIC<sub>1</sub>, the <italic>H<sub>0</sub></italic> is rejected and <inline-formula><mml:math id="inf44"><mml:mi>x</mml:mi></mml:math></inline-formula> is split into two states. Assuming two-states are identified on the first iteration, the sequential process of CP detection and bi-partitioning with k-means clustering continues in a recursive fashion within data points belonging to each of the newly identified states (<xref ref-type="fig" rid="fig1">Figure 1b</xref>; <xref ref-type="bibr" rid="bib35">Pelleg and Moore, 2000</xref>). Divisive segmentation continues to identify sub-clusters within each identified cluster until no cluster can be further partitioned. Overall, the recursive bi-partitioning and binary decision making in both CP detection and divisive clustering result in a reduced time complexity on the order of O(<italic>N</italic>log(<italic>N</italic>)).</p></sec><sec id="s1-1-3"><title>Agglomerative clustering</title><p>Self-termination of divisive segmentation results in a series of estimated states and transitions within the trajectory. While this algorithm is exceptionally fast owing to its top-down greedy design, the reliance on local choices for state assignments rather than evaluation of the entire trajectory for an optimal decision can produce sub-optimal results. This error often surfaces as an over-sampling of the number of states and an under-sampling of the kinetic transitions. Over-fitting the number of states results from a downward dissemination of error from early splits: if bisecting a given cluster is suboptimal, two different parent clusters may each produce highly similar and redundant sub-clusters thereby overfitting the number of states. Fortunately, this over-estimate of the number of states can be corrected using bottom-up clustering. Therefore, the second phase of DISC uses HAC to compute the similarities between all identified states at a global level and assess the fit of the whole trajectory rather than segmented portions. Like CP-HAC schemes, an objective function is used to determine the overall fit and number of states in the trace by merging highly similar clusters whose separation may arise during divisive segmentation (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). For a general application, we continue to use BIC for evaluating fit vs complexity. The similarity between neighboring states <inline-formula><mml:math id="inf45"><mml:mi>ϕ</mml:mi></mml:math></inline-formula><italic><sub>i</sub></italic> and <inline-formula><mml:math id="inf46"><mml:mi>ϕ</mml:mi></mml:math></inline-formula><italic><sub>j</sub></italic> is computed using Ward’s minimum variance method (<xref ref-type="bibr" rid="bib52">Ward, 1963</xref>), which considers the number of data points in each state (<italic>n</italic>) and the Euclidean distance between the means of the states,<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:msqrt><mml:msub><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The improvement of HAC on divisive segmentation for state detection is shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. Although divisive segmentation alone tends to slightly over-estimate the number of states, it provides a more reasonable estimate than CP detection alone (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). The comparative performances in terms of speed and accuracy of these algorithms is further explored in <xref ref-type="fig" rid="fig2">Figure 2b</xref>. While CP detection alone (<xref ref-type="fig" rid="fig2">Figure 2b</xref>, blue) is very fast, it consistently yields a higher number of total states as compared to the ground truth. As CP-HAC frameworks must explore this large state space in its entirety, they can achieve higher accuracy than CP detection alone, but they are much slower algorithms (<xref ref-type="fig" rid="fig2">Figure 2b</xref>, green). In contrast, the use of top-down clustering in divisive segmentation dramatically reduces the total state-space for exploration, resulting in a faster algorithm than CP-HAC with much higher accuracy than CP detection alone (<xref ref-type="fig" rid="fig2">Figure 2b</xref>, purple). Finally, the sequential combination of divisive segmentation and HAC used in DISC lead to the highest state detection accuracy with minimal computational cost (<xref ref-type="fig" rid="fig2">Figure 2b</xref>, orange).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Refinement of divisive segmentation.</title><p>(<bold>a</bold>) Example trajectory simulated with five states (blue) at a SNR = 5 overlaid with fits obtained from change-point detection (red) and divisive segmentation (black). (<bold>b</bold>) Violin plots showing the number of identified states (top) and analysis time (bottom) of each algorithm across 500 simulated trajectories featuring five true states (red line). (<bold>c</bold>) Example simulations of a two-state system with a k<sub>on</sub> = 0.02 frames<sup>−1</sup> and varying k<sub>off</sub>. (<bold>d</bold>) Precision (top) and recall (bottom) values obtained with CP detection (no Viterbi) and Viterbi refinement obtained across 100 trajectories per k<sub>off</sub> (mean ± s.d.).</p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>Simulated data of varying dynamics.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-53357-fig2-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>The effect of state occupancy on DISC.</title><p>(<bold>a</bold>) Simulated kinetic scheme of <xref ref-type="fig" rid="fig2">Figure 2</xref> featuring two states with a constant k<sub>on</sub> (k<sub>on</sub> = 0.02 frames<sup>−1</sup>) and varying k<sub>off</sub>. (<bold>b</bold>) Occupancy of state 1 (blue circles) and state 2 (orange squares) for different simulated k<sub>off</sub> values (mean ± s.d.). (<bold>c, d</bold>) Density plot of idealization accuracy per trajectory vs the occupancy of state two across all simulations (N = 5000) for results obtained without (<bold>c</bold>) and with Viterbi refinement (<bold>d</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig2-figsupp1-v2.tif"/></fig></fig-group></sec><sec id="s1-1-4"><title>Viterbi algorithm</title><p>Following state refinement with HAC, the trajectory is again described as a series of temporal transitions between identified intensity states. Although the overall states are well estimated at this point, fast transitions are often missed during CP analysis of single-molecule trajectories (<xref ref-type="bibr" rid="bib19">Hadzic et al., 2018</xref>). To ensure events are accurately detected, the final phase of DISC applies the Viterbi algorithm (<xref ref-type="bibr" rid="bib51">Viterbi, 1967</xref>).</p><p>The goal of the Viterbi algorithm is to identify the most probable sequence of hidden states through a series of observations. In our scenario, we have <italic>K</italic> total states and <italic>N</italic> total observations in our trajectory . In a naïve manner, determining the most probable sequence of hidden states <italic>y</italic> could be accomplished by evaluating the likelihood of every possible hidden state sequence and choosing the most probable. However, as there are <italic>K<sup>N</sup></italic> possible paths though the trajectory, this quickly becomes computationally intractable. A solution to this problem is the Viterbi algorithm, which makes use of dynamics programming to store only the most optimal state sequencing leading up to a given time point. In general, the Viterbi algorithm uses the observation that that the most probable state sequence leading up to data point n can be deduced by examining the most probable path leading up to the previous time point, <italic>n-1</italic>. Dynamic programming is used to keep track of all the optimal state sequences leading to all possible states for a given time point <italic>n-1</italic> which reduces the amount of required computations. Since there are there are <italic>K</italic> states at time step <italic>n-1</italic>, the Viterbi algorithm stores <italic>K</italic> possible state sequences leading up the previous time point <italic>n-1</italic>. At time point <italic>n</italic>, there are now <italic>K<sup>2</sup></italic> paths to consider, given <italic>K</italic> possible paths leading out of <italic>K</italic> states. By examining the optimal sequence up to time point <italic>n</italic> and considering the probability of state transition between time points <italic>n-1</italic> and <italic>n</italic>, the most optimal state sequence up to time point <italic>n</italic> can be constructed. The state assignment of the first data point in the sequence can be determined by a provided initial probability of observing each state. Therefore, the time complexity of idealization with Viterbi is quadratic in the number of states <italic>K</italic> and linear with the number of observations <italic>N</italic>, <italic>O(K<sup>2</sup>N)</italic>, which is dramatically lower than an exhaustive search.</p><p>Formally, the Viterbi algorithm is described with a <italic>K x N</italic> trellis for states <inline-formula><mml:math id="inf47"><mml:mi>j</mml:mi> <mml:mi/><mml:mo>∈</mml:mo><mml:mi>K</mml:mi></mml:math></inline-formula> and observations <inline-formula><mml:math id="inf48"><mml:mi>n</mml:mi> <mml:mi/><mml:mo>∈</mml:mo><mml:mi>N</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). Each cell of trellis <inline-formula><mml:math id="inf49"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> represents the probability of being in state <italic>j</italic> after seeing the first <italic>n</italic> observations and passing through the most probable state sequence for the given model parameters, <inline-formula><mml:math id="inf50"><mml:mi>λ</mml:mi></mml:math></inline-formula>. The value <inline-formula><mml:math id="inf51"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is computed by recursively taking the most probable path up to this cell by<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo form="prefix">max</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:mo>⋅</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:mo>⋅</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf52"><mml:mi>λ</mml:mi></mml:math></inline-formula> is first order Markov process of <inline-formula><mml:math id="inf53"><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo> <mml:mi/><mml:mi>a</mml:mi><mml:mo>,</mml:mo> <mml:mi/><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. The primary components of a hidden Markov model include the initial probability of observing each state <inline-formula><mml:math id="inf54"><mml:mi>ϕ</mml:mi></mml:math></inline-formula><italic><sub>j</sub></italic> given by <inline-formula><mml:math id="inf55"><mml:mi>π</mml:mi></mml:math></inline-formula> where <inline-formula><mml:math id="inf56"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>; a transition probability matrix <inline-formula><mml:math id="inf57"><mml:mi>a</mml:mi></mml:math></inline-formula> of size <italic>K x K</italic> where each element <inline-formula><mml:math id="inf58"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the probability of moving from <inline-formula><mml:math id="inf59"><mml:mi>ϕ</mml:mi></mml:math></inline-formula><italic><sub>i</sub></italic> to <inline-formula><mml:math id="inf60"><mml:mi>ϕ</mml:mi></mml:math></inline-formula><italic><sub>j</sub></italic>, each element <inline-formula><mml:math id="inf61"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the probability of staying in <inline-formula><mml:math id="inf62"><mml:mi>ϕ</mml:mi></mml:math></inline-formula><italic><sub>i</sub></italic> and <inline-formula><mml:math id="inf63"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>; and an emission probability matrix <inline-formula><mml:math id="inf64"><mml:mi>b</mml:mi></mml:math></inline-formula> of size <italic>K x N</italic> where each element <inline-formula><mml:math id="inf65"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> is the probability of an observation <inline-formula><mml:math id="inf66"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> arising from <inline-formula><mml:math id="inf67"><mml:mi>ϕ</mml:mi></mml:math></inline-formula><italic><sub>j</sub></italic>. The values of each component are computed for each trajectory using the fits obtained from sequential steps of divisive segmentation and HAC. Using these parameters, we can compute the most probable path for arriving in <inline-formula><mml:math id="inf68"><mml:mi>ϕ</mml:mi></mml:math></inline-formula><italic><sub>j</sub></italic> at time points <italic>n</italic> by the following recursion<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo form="prefix">max</mml:mo><mml:mrow><mml:mi mathvariant="italic">i</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>∈</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="italic">N</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">i</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>∈</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="italic">N</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf69"><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is a helper function to store the <inline-formula><mml:math id="inf70"><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> state index <inline-formula><mml:math id="inf71"><mml:mi>i</mml:mi></mml:math></inline-formula> on the highest probability path.</p><p>Upon termination, the forward likelihood of the entire state sequence <italic>y</italic> up to time point N+1 having been produced by the given observations and HMM parameters is <disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo form="prefix">max</mml:mo><mml:mrow><mml:mi mathvariant="italic">i</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>∈</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="italic">N</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Deducing the most probable hidden state sequence <inline-formula><mml:math id="inf72"><mml:mi>y</mml:mi></mml:math></inline-formula> through observations <inline-formula><mml:math id="inf73"><mml:mi>x</mml:mi></mml:math></inline-formula> can be accomplished in a backtracking step by<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>N</mml:mi><mml:mo>≥</mml:mo><mml:mi>n</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To assess the improvement of the Viterbi algorithm for event detection, we simulated a two-state system with a constant k<sub>on</sub> and varying k<sub>off</sub> rate (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). As shown previously (<xref ref-type="bibr" rid="bib19">Hadzic et al., 2018</xref>), we found that results from CP detection alone were accurate for slower events, but often failed to identify faster transitions (<xref ref-type="fig" rid="fig2">Figure 2d</xref>). By refining the results of unsupervised clustering with the Viterbi algorithm, we found that event detection accuracy was significantly improved over CP detection and clustering alone across two-orders of magnitude of varying k<sub>off</sub> (<xref ref-type="fig" rid="fig2">Figure 2d</xref>). Notably, as the changes in rates also affect the change in state occupancy, the high accuracy values returned after Viterbi refinement further highlight the power of DISC for resolving short-lived and rare transitions (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). In general, this improvement was anticipated since we are not the first to apply the Viterbi algorithm to the problem of idealization using unsupervised clustering. Although commonly used in the application of HMMs for hard assignment of data-points into <italic>K</italic> discrete states, the SKM algorithm has shown that the Viterbi algorithm can successfully decode a path sequence following state clustering using k-means as opposed to more rigorous HMM training procedures (<xref ref-type="bibr" rid="bib25">Juang and Rabiner, 1990</xref>; <xref ref-type="bibr" rid="bib39">Qin, 2004</xref>). Therefore, both SKM and DISC can yield the event detection power of standard HMM approaches without the need of rigorous model training. However, unlike SKM, DISC has the added benefit of identifying the states naturally without the need for any user supervision such as initial state specification. This makes DISC a powerful alternative as a computationally efficient unsupervised single-molecule analysis algorithm.</p></sec><sec id="s1-1-5"><title>Modular nature of DISC</title><p>While the parameters used above are valid for trajectories with Gaussian noise, we do not claim they are optimal for all experimental modalities. We have intentionally developed DISC as a flexible framework for adaptation to different types of data. Although we used the Student’s t-test for CP detection in the presence of Gaussian noise, additional merit functions may be more appropriate in different situations (<xref ref-type="bibr" rid="bib47">Song and Yang, 2017</xref>; <xref ref-type="bibr" rid="bib53">Watkins and Yang, 2005</xref>; <xref ref-type="bibr" rid="bib30">Li and Yang, 2019</xref>). The same holds true for the use of BIC for state selection as other objective function can be substituted as needed. For example, the harsh penalty for parameters in BIC can lead to underfitting in certain cases; therefore, less stringent Akaike information criterion (AIC) or Hannan-Quinn information criterion (HQC) may be more appropriate depending on the separation of states and noise (<xref ref-type="bibr" rid="bib2">Akaike, 1974</xref>; <xref ref-type="bibr" rid="bib21">Hannan and Quinn, 1979</xref>). It is important to note that while DISC performs idealization through unsupervised clustering, obtaining accurate results does require the user to determine the appropriate information criterion and CP detection methods as idealization results heavily depend on these variables. Critically, the central innovation of DISC is to take advantage of the best features of both top-down and bottom-up forms of cluster identification that leads to both fast and accurate state detection.</p></sec></sec></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Validation of DISC on simulated data</title><p>We validate DISC using simulated single-molecule trajectories using kinetic parameters obtained from our recent studies exploring the regulatory mechanisms of cyclic nucleotide binding domains (CNBDs) from hyperpolarization-activated cyclic nucleotide gated ion channels (HCN) which regulate pacemaking in heart and brain cells (Materials and methods) (<xref ref-type="bibr" rid="bib16">Goldschen-Ohm et al., 2017</xref>; <xref ref-type="bibr" rid="bib15">Goldschen-Ohm et al., 2016</xref>). In these experiments, isolated CNBDs are tethered into ZMWs whereupon we monitor the binding and unbinding dynamics of fluorescent cyclic nucleotides (e.g. fcAMP) at physiological concentrations to uncover the elementary dynamics associated with channel gating. While ligand binding has been observed at the single-molecule level via both FRET and CoSMoS (co-localization), we adapt our simulations to the latter case so our dynamics are not limited in time by acceptor photobleaching. Notably, trajectories obtained with CoSMoS exhibit heterogeneous bound intensity values which vary with each binding event (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). While we are uncertain as to the exact source of this fluctuation, it is likely caused by shifts of the molecule in the heterogeneous excitation field of the ZMW or dye photodynamics (<xref ref-type="bibr" rid="bib29">Levene et al., 2003</xref>; <xref ref-type="bibr" rid="bib10">Dempsey et al., 2009</xref>). While the excitation field changes particularly sharply in ZMWs, TIRF and confocal microscopy also contain a heterogenous excitation field (<xref ref-type="bibr" rid="bib33">Moerner and Fromm, 2003</xref>). Minor changes in apparent dye brightness due to dye conformational or photodynamics (such as in Protein-induced fluorescence enhancement, PIFE), shifts of dye orientation, or partial quenching via electron transfer are all commonly observed (<xref ref-type="bibr" rid="bib48">Stennett et al., 2015</xref>). Thus, heterogeneous intensity values are a common and inconvenient feature in real life single-molecule fluorescence data. Including this additional noise source in our simulations yields a closer representation of experimentally obtained data.</p><p>In total, we simulated 4000 trajectories composed of 2000 data points each, totaling 8 × 10<sup>6</sup> data points. Each trajectory is 200 s in duration collected at frame rate of 10 Hz. We varied the complexity of the trajectory by simulating one to four independent CNBDs inside a given ZMW (two to five intensity states) and vary the signal to noise ratio (SNR) according to typical values from a ZMW experiment using Gaussian noise (Materials and methods) (<xref ref-type="bibr" rid="bib16">Goldschen-Ohm et al., 2017</xref>; <xref ref-type="bibr" rid="bib15">Goldschen-Ohm et al., 2016</xref>). We include the observed heterogenous bound intensities by randomly modulating each binding event according to our fit of the experimentally observed data (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). Given that each simulation features a different number of possible states, the total time spent within each state changes; therefore, these simulations also address the ability to capture states with unequal and even rare observation probabilities (see <xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>). We benchmark the results of DISC against commonly used HMM and CP-HAC methods: vbFRET and STaSI (<xref ref-type="bibr" rid="bib7">Bronson et al., 2009</xref>; <xref ref-type="bibr" rid="bib45">Shuang et al., 2014</xref>). These algorithms were chosen following the results of a recent comparative study that determined these to be the best performers among their class of analysis methods (<xref ref-type="bibr" rid="bib19">Hadzic et al., 2018</xref>). In addition, DISC, STaSI and vbFRET all perform trajectory-by-trajectory idealization and are written entirely in MATLAB (MathWorks) which standardizes computational performance (Materials and methods).</p><p>Across all the simulations, DISC provides the highest average accuracy, precision and recall (<xref ref-type="fig" rid="fig3">Figure 3a</xref>, terms defined in Materials and methods). While no algorithm can idealize a trajectory in the presence of SNR = 1, DISC returns the lowest accuracy at SNR = 2. We suspect this result is due to the use of robust BIC for state detection; accuracy would likely be improved with less penalizing objective functions, such as AIC. While vbFRET performs the best at SNR = 2, the overall accuracy is still quite low: an average accuracy value for each number of simulated states is near chance. This low value demonstrates the inability of many algorithms to analyze data in presence of high noise and reinforces the common practice of discarding noisy data to create a more reliable dataset. For SNR &gt; 3, which accounts for most of our experimentally obtained data (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1c</xref>), DISC performs exceptionally well with highest average accuracy (0.91 ± 0.05) and is robust against false positives (precision = 0.96 ± 0.04) and false negatives (recall = 0.93 ± 0.03) across all simulated conditions (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). While vbFRET matches the recall of DISC in this SNR range (0.94 ± 0.05), the tendency to overfit the number of states at higher SNR lowers precision (0.80 ± 0.18) and overall accuracy (0.76 ± 0.19). We find STaSI returns the lowest overall accuracy (0.47 ± 0.17) likely do to an overfitting the number of states (precision = 0.57 ± 0.2) and a tendency to miss transitions (recall = 0.75 ± 0.10). Notably, DISC is the only method unaffected by inclusion of heterogeneous state intensities of fcAMP likely due to the use of a Gaussian derived BIC for state selection (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Standardizing performance.</title><p>(<bold>a</bold>) Average accuracy (top), precision (middle) and recall values (bottom) computed for DISC, STaSI, and vbFRET across 100 trajectories at the specified signal to noise and number of states (Materials and methods). (<bold>b</bold>) Example simulated trajectory with four true states (red) fit and added Gaussian noise (grey) to SNR = 6 overlaid with fits (black) from DISC (top), STaSI (middle), or vbFRET (bottom).</p><p><supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Algorithm results of CNBD simulations.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-53357-fig3-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Characterization of fcAMP binding to monomeric CNBDs in ZMWs.</title><p>(<bold>a</bold>) Representative trajectory of a fcAMP binding to a monomeric CNBD in a ZMW (<bold>b</bold>) Intensity difference of bound (B) and unbound (U) states per trajectory with a log-normal fit (µ = 4.79, σ = 0.47, N = 861) (<bold>c</bold>) Signal-to-noise per trajectory with a log-normal fit (µ = 1.84, σ = 0.41, N = 861) (<bold>c</bold>). Quantification of unbound (<bold>d</bold>) and bound (<bold>e</bold>) event heterogeneity overlaid with exponential fits (unbound µ = 1.62, bound µ = 3.81).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Simulation with heterogenous fcAMP emission.</title><p>Representative SM simulation of a two-state system both without (top) and without (bottom) heterogeneous emission of fcAMP upon binding. Plots show simulated trajectory (red) overlaid with the addition of Gaussian noise (grey) and the average intensity value of each state (dashed black). Arrows indicate events where the heterogeneous intensities show prominent deviations away from the mean state value.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Algorithm performance on simulations without heterogenous fcAMP emission.</title><p>Recreation of simulations from <xref ref-type="fig" rid="fig3">Figure 3</xref> of the main text without the inclusion of heterogenous intensities per binding event. Each value is the average accuracy (top), precision (middle), and recall (bottom) across 100 trajectories 200-second-long trajectories collected at 10 Hz at the indicated SNR and number of states (Materials and methods).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig3-figsupp3-v2.tif"/></fig></fig-group><p>Critically, DISC not only returned high accuracy results, DISC was also much faster than the other methods. Idealization of all 4000 trajectories by DISC was completed in just over two minutes, whereas STaSI took over fifteen minutes and vbFRET took over twelve hours. To thoroughly explore the computational efficiency of DISC, we simulated data with increasing durations per trajectory at a constant SNR and number of states. Remarkably, we find DISC is 400-fold to 1,200-fold faster than vbFRET and 2-fold to 8,700-fold faster than STaSI due to STaSI’s quadratic time dependence (<xref ref-type="fig" rid="fig4">Figure 4a</xref>; <xref ref-type="bibr" rid="bib45">Shuang et al., 2014</xref>). For example, a trajectory of 10<sup>6</sup> data points can be analyzed by DISC in 10 s compared to 3 hr for vbFRET and 27 hr for STaSI. Thus, DISC can handle the analysis of long trajectories, unlike CP-HAC methods. While fluorescence measurements from a single fluorophore at room-temperature rarely contain this many data points, large trajectory lengths are common in non-fluorescence experiments or fluorescence experiments with replenishing fluorescent labels such as in single-molecule genome sequencing and studies of catalysts via fluorogenic reactions (<xref ref-type="bibr" rid="bib11">Eid et al., 2009</xref>; <xref ref-type="bibr" rid="bib13">English et al., 2006</xref>; <xref ref-type="bibr" rid="bib40">Sambur et al., 2016</xref>). To evaluate performance on more typical data, we compared the results of each algorithm on simulated smFRET trajectories that are limited in duration by acceptor photobleaching (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, Materials and methods). For simulations featuring two or three states FRET, we find DISC 5.5-fold faster than STaSI and 235-fold faster than vbFRET while maintaining the highest accuracy. This result validates the use of DISC for the analysis of large volumes of shorter fluorescence trajectories, especially compared to HMM approaches. This feature is particularly important as advances in hardware such as CMOS cameras and lab-on-chip methods generate larger smFRET data sets (<xref ref-type="bibr" rid="bib26">Juette et al., 2016</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>The effect of trajectory length on DISC performance.</title><p>(<bold>a</bold>) Computational time (mean ± s.d.) of each algorithm for analyzing single trajectories of varying lengths. The test was performed with an Intel Xeon, 3.50 GHz processor running MATLAB 2017a. (<bold>b</bold>) Accuracy (mean ± s.d., N = 5000) of DISC for simulated trajectories of a two-state model with varying SNR and total number of data points.</p><p><supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>Algorithm results across varying trajectory length.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-53357-fig4-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Algorithm performance on simulated smFRET data.</title><p>(<bold>a, b</bold>) Representative fits of simulated smFRET data with 2 (<bold>a</bold>) or 3 (<bold>b</bold>) states (red) overlaid with the idealized fits from DISC (black). (<bold>c, d</bold>) Scatter plot of accuracy vs analysis time of 100 simulated smFRET trajectories featuring 2 (<bold>c</bold>) or 3 (<bold>d</bold>) states analyzed by DISC (blue circles), STaSI (green triangles) and vbFRET (purple squares).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig4-figsupp1-v2.tif"/></fig></fig-group><p>Finally, we evaluate the effect of trajectory duration on DISC accuracy. As expected, we find that the accuracy increases with increasing number of data points per trajectory. This result also indicates the minimum number of data points needed for an accurate idealization for a given SNR (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). Overall, the results of our simulations suggest DISC is more or comparably accurate and critically, is substantially faster than standard idealization approaches, making it an enabling technology for analysis of high-throughput single-molecule experiments.</p></sec><sec id="s2-2"><title>The binding of cAMP to HCN CNBDs is non-cooperative</title><p>To verify performance of DISC in an experimental configuration with high volumes of experimental data, we analyzed a large single-molecule data set obtained from ZMWs that explore HCN dynamics (<xref ref-type="fig" rid="fig5">Figure 5a</xref>). Previous macroscopic studies of HCN channel gating have revealed that ligand binding to CNBDs exhibits both positive and negative cooperativity depending on the ligation state and the membrane potential (<xref ref-type="bibr" rid="bib28">Kusch et al., 2012</xref>; <xref ref-type="bibr" rid="bib49">Thon et al., 2015</xref>). Cyclic AMP regulates cardiac pacemaking via HCN channels and, therefore, this unusual allostery has significant physiological implications. However, as this allosteric analysis was based on global fits of ensemble binding data, the reliability of model parameters remains an open question (<xref ref-type="bibr" rid="bib23">Hines et al., 2015</xref>). Evaluating cooperativity is an experiment well-suited for single-molecule investigation given the ability to observe the total time a molecule spends in each liganded state and directly extract state transition probabilities. Therefore, to directly assess the cooperativity between HCN2 CNBDs upon ligand binding, we use single-molecule fluorescence and monitor the binding of individual fcAMP molecules to our previously described tetramerized CNBDs inside ZMWs. (<xref ref-type="fig" rid="fig5">Figure 5a</xref>; <xref ref-type="bibr" rid="bib15">Goldschen-Ohm et al., 2016</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>DISC analysis of HCN CNBDs.</title><p>(<bold>a</bold>) Representative ZMW arrays for observing fcAMP binding to tethered tetrameric CNBD. (<bold>b</bold>) Representative time series of 1 µM fcAMP binding to tetrameric CNBD fit with DISC with up to four fcAMP molecules binding simultaneously. (<bold>c</bold>) Observed distribution of fcAMP occupancy fit with a binomial distribution (orange). (<bold>d</bold>) Sequential model of four binding steps and one unbound state with globally optimized rate constants. The rate constants are given as s<sup>−1</sup> or s<sup>−1</sup>M<sup>−1</sup> where L is the ligand concentration in M. (<bold>e</bold>) Linear regression of rate constants k<sub>on</sub> (<italic>m</italic> = −8.5×10<sup>4</sup> s<sup>−1</sup>M<sup>−1</sup>, <italic>b</italic> = 4.35×10<sup>5</sup> s<sup>−1</sup>M<sup>−1</sup>, R<sup>2</sup> = 0.99) and k<sub>off</sub> (<italic>m</italic> = 0.18 s<sup>−1</sup>, <italic>b</italic> = 0.035 s<sup>−1</sup>, R<sup>2</sup> = 0.99) for each sequential state.</p><p><supplementary-material id="fig5sdata1"><label>Figure 5—source data 1.</label><caption><title>Plotted data and fits of tetrameric CNBD dynamics.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-53357-fig5-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Tetrameric CNBD analysis by DISC and STaSI.</title><p>Initial number of states found by DISC (<bold>a</bold>) and STaSI (<bold>b</bold>) when run on the tetrameric CNBD data set across 13,670 trajectories prior to trace selection (Materials and methods). The expected distribution is between 1 and 5 states per trajectory to account for empty ZMWs and fully occupied tetrameric CNBDs (four fcAMP bound states plus one unbound state). This analysis was not repeated using vbFRET as we estimated the process would take weeks to complete.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Non-specific fcAMP binding in ZMWs.</title><p>Representative trajectories of unoccupied ZMWs in the presence of 1 µM fcAMP. Trajectories are offset by 200 arbitrary units (a.u.) for visualization.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig5-figsupp2-v2.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 3.</label><caption><title>Asynchronous decay of tetrameric CNBD activity over excitation time.</title><p>(<bold>a</bold>) Average fraction bound of each molecule over time (binned every 40 s) before and after trajectory truncation (mean ± s.e.m., see Materials and methods). (<bold>b</bold>) Distribution of trajectory durations following truncation (N = 296). Each trajectory was initially 800 s. (<bold>c</bold>) Representative trajectories showing the truncated data kept for analysis (green) with idealized fit by DISC (black) and the discarded frames (grey).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig5-figsupp3-v2.tif"/></fig><fig id="fig5s4" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 4.</label><caption><title>Example trajectories of 1 µM fcAMP binding to tetrameric CNBDs in ZMWs.</title><p>Representative trajectories featuring up to 3 or four bound fcAMP molecules analyzed by DISC (left) with distribution fits (middle) and BIC curves for optimal state selection (right). Inset shows a zoomed portion of BIC curve to highlight the minimum BIC value identified. The lowest BIC value is indicated in red which corresponds to the final number of states fit to the trajectory. Each BIC plot may feature a different number of total possible states owning to the trajectory-by-trajectory results from divisive segmentation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig5-figsupp4-v2.tif"/></fig><fig id="fig5s5" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 5.</label><caption><title>Model comparison of HCN CNBDs.</title><p>Comparison of obtained state-occupancy distribution from single-molecule experiments with expected values from activated and non-activated HCN channel models.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53357-fig5-figsupp5-v2.tif"/></fig></fig-group><p>Our initial dataset included 13,670 ZMWs each monitored for 800 s at a sampling rate of 10 Hz (Materials and methods). All trajectories were obtained in the presence of 1 µM fcAMP which is near the ligand dissociation constant for individual CNBDs (<xref ref-type="bibr" rid="bib15">Goldschen-Ohm et al., 2016</xref>). As shown with other high-throughput collection platforms, an essential part of analysis at this scale is the application of stringent criteria to select traces that yield meaningful information about the system (<xref ref-type="bibr" rid="bib9">Chen et al., 2014</xref>; <xref ref-type="bibr" rid="bib26">Juette et al., 2016</xref>). Therefore, we first analyzed all trajectories with DISC to find reliable data prior to trace selection. DISC successfully processed this entire data set within 20 min using a standard MacBook Air (1.6 GHz Intel Core i5). The same analysis completed with STaSI yielded unphysical results in 4 hr (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). We estimated analysis with vbFRET would take weeks to complete and was therefore not performed. While correcting for non-specific binding is often a necessity in CoSMoS experiments, we find the passivated surfaces within the ZMWs greatly reduce non-specific absorption of fcAMP to either the metallic or glass surfaces, thus minimizing this concern (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>; <xref ref-type="bibr" rid="bib46">Smith et al., 2019</xref>; <xref ref-type="bibr" rid="bib11">Eid et al., 2009</xref>; <xref ref-type="bibr" rid="bib14">Foquet et al., 2008</xref>). Using the idealized fits obtained from DISC, we screened our data to select reliable trajectories for our analysis. Standard cut-offs in state separation, the total number of observed states, and a filter for kinetic activity ensured that each trajectory arose from a ZMW featuring a singly occupied and functional tetrameric CNBD. Notably, we noticed an asynchronous decay of protein activity over excitation time that may be caused by singlet-oxygen formation and subsequent inhibition of cyclic nucleotide binding to CNBDs (<xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>; <xref ref-type="bibr" rid="bib24">Idikuda et al., 2018</xref>). In conclusion, we retained 293 molecules totaling 1.2 × 10<sup>5</sup> s of combined protein activity across 53,474 events.</p><p>To determine if the binding of cAMP to CNBDs is cooperative, we first calculated the total time each molecule spends in each of the liganded states (0 to 4 fcAMPs) using the state assignments from the idealized fits (<xref ref-type="fig" rid="fig5">Figure 5b</xref>, <xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4</xref>). The resulting distribution of state occupancies is fit with a binomial distribution to evaluate the independence of each CNBD (<xref ref-type="fig" rid="fig5">Figure 5c</xref>, Materials and methods). Our binomial fit matches the distribution well and returns the probability of occupancy at 1 µM fcAMP for a single CNBD in the tetramer as 31% which is similar to our previous monomeric CNBDs studies (<xref ref-type="bibr" rid="bib15">Goldschen-Ohm et al., 2016</xref>), suggesting a lack of cooperativity between the CNBDs. Notably, our measured state-occupancy distribution is strikingly different that than the unusual cooperativity modeled from either activated or non-activated channels (<xref ref-type="fig" rid="fig5s5">Figure 5—figure supplement 5</xref>; <xref ref-type="bibr" rid="bib28">Kusch et al., 2012</xref>; <xref ref-type="bibr" rid="bib49">Thon et al., 2015</xref>). We further explored the underlying dynamics of our data using the idealized single-molecule transitions obtained from DISC. Using QuB, we built a simple HMM of sequential ligand binding across four binding sites that was globally optimized across each molecule’s idealized state trajecotry (<xref ref-type="bibr" rid="bib34">Nicolai and Sachs, 2013</xref>; <xref ref-type="bibr" rid="bib38">Qin et al., 2000</xref>; <xref ref-type="fig" rid="fig5">Figure 5d</xref>, Materials and methods). As expected for non-cooperative processes, the optimized k<sub>on</sub> and k<sub>off</sub> rates for each state transition exhibit a strong linear relationship (<xref ref-type="fig" rid="fig5">Figure 5e</xref>). Combined, these results strongly suggest that CNBD units act independently during ligand binding. We postulate that the macroscopically observed cooperativity is either an artifact of model fitting or that it requires the presence of the transmembrane domains of the HCN channel and is not an intrinsic property of the CNBDs.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We developed a new algorithm for rapid and accurate unsupervised idealization of single-molecule trajectories. Our approach combines unsupervised statistical learning of discrete states with the event detection power of the Viterbi algorithm to quickly identify both significant states and transitions in a model-independent manner. Software implementing the DISC algorithm that includes a graphical user interface is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ChandaLab/DISC">https://github.com/ChandaLab/DISC</ext-link> (<xref ref-type="bibr" rid="bib8">Chanda et al., 2019</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/DISC">https://github.com/elifesciences-publications/DISC</ext-link>).</p><p>Like CP-HAC methods, DISC is not a fully probabilistic approach. While fully probabilistic HMM training approaches are beneficial for providing unbiased estimates of the parameter distributions, their high accuracy comes at the cost of significantly increased computational time. This cost is especially apparent for the recently developed infinite HMM approaches that aim to learn the true number of states from a potentially infinite number of possibilities. However, accomplishing this task costs hundreds of iterations per trace to provide a reproducible fit with some approaches taking days to analyze single trajectories (<xref ref-type="bibr" rid="bib23">Hines et al., 2015</xref>; <xref ref-type="bibr" rid="bib44">Sgouralis and Pressé, 2017</xref>; <xref ref-type="bibr" rid="bib43">Sgouralis et al., 2018</xref>). Thus, while exhaustive search algorithms may be desirable in other contexts, they are clearly not suited for large datasets associated with high-throughput experiments. In contrast, by simulating data closely resembling the binding of fcAMP to pacemaker channels, we find that DISC surpasses the accuracy of common CP-HAC and HMM algorithms with a dramatic improvement in computational speed. Therefore, DISC satisfies the need for accuracy and speed in high-throughput analysis. In this regard, DISC is like the SKM algorithm for estimating the parameters of an HMM without direct HMM training. However, unlike SKM which relies on user-specified states, DISC uses unsupervised statistics to learn the states. Therefore, DISC offers the idealization power of SKM with the state-learning capabilities of CP-HAC.</p><p>We used DISC to analyze a large dataset obtained from ZMWs to evaluate cooperativity between CNBDs from pacemaker ion channels upon ligand binding. The rapid and robust idealization provided by DISC enabled stringent trace selection to ensure only reliable trajectories were analyzed. These data show that, in contrast to model inferences from ensemble measurements of HCN2 channels, CNBD tetramers do not exhibit cooperative ligand binding. This result suggests that allosteric interactions between binding sites may be coordinated by the channel’s transmembrane domains.</p><p>Although we have demonstrated the use of DISC on single-molecule fluorescence data, the framework can be easily extended to other data paradigms due to its modular nature. For example, the use of BIC for state determination or the Student’s t-test for change-point analysis could be interchanged with other information theoretic approaches or merit functions where appropriate. To allow for easy comparison of a given data set, the provided software and graphical user interface (GUI) allows the user to select from several options the desired parameters such as choice of information criteria. This flexibility makes DISC suitable for a wide array of experimental data provided it can be described as a series of transitions between discrete states, including, for example, single-channel current recordings, force spectroscopy and smFRET. However, there is no inherent knowledge within DISC to consider various sources of experimental noise, such as photo-blinking or baseline drift; therefore, correcting for these noise sources prior to DISC analysis will likely improve idealization accuracy.</p><p>Finally, our results show that DISC provides a dramatic improvement in computational speed over current state-of-the-art approaches while either improving or maintaining high accuracy for both state determination and event detection. This increase in speed is directly applicable to analyzing the growing datasets obtained in single-molecule fluorescence paradigms to adequately sample population dynamics. For example, the use of sCMOS camera enables smFRET measurements of tRNA conformational changes during protein translations across thousands of molecules simultaneously with millisecond resolution (<xref ref-type="bibr" rid="bib26">Juette et al., 2016</xref>). Additionally, magnetic tweezers have enabled week-long mechanical measurements of single-protein folding and unfolding, shifting observable dynamics to pathological time-scales and allowing the detection of rare events (<xref ref-type="bibr" rid="bib37">Popa et al., 2016</xref>). Thus, highly computationally efficient and robust algorithms such as DISC may be well suited for analysis of a wide variety of single molecule datasets beyond the standard smFRET data.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th valign="top">Reagent type <break/>(species) or resource</th><th valign="top">Designation</th><th valign="top">Source or reference</th><th valign="top">Identifiers</th><th valign="top">Additional <break/>information</th></tr></thead><tbody><tr><td valign="top">Biological sample</td><td valign="top">GCN4pLI-HCN2 tetramer</td><td valign="top">DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.20797">10.7554/eLife.20797</ext-link></td><td valign="top"/><td valign="top"/></tr><tr><td valign="top">Chemical compound, drug</td><td valign="top">Protocatechuate 3,4-Dioxygenase <break/></td><td valign="top">Millipore-Sigma</td><td valign="top">cas no. 9029-47-4</td><td valign="top">from <italic>Pseudomonas</italic> sp.</td></tr><tr><td valign="top">Chemical compound, drug</td><td valign="top">3,4-Dihydroxybenzoic acid</td><td valign="top">Millipore-Sigma</td><td valign="top">cas no. 99-50-3</td><td valign="top">Protocatechuic Acid</td></tr><tr><td valign="top">Chemical compound, drug</td><td valign="top">(±)-6-Hydroxy-2,5,7,8-tetramethylchromane-2-carboxylic acid <break/></td><td valign="top">Millipore-Sigma</td><td valign="top">cas no. 53188-07-1</td><td valign="top">Trolox</td></tr><tr><td valign="top">Chemical compound, drug</td><td>8-[DY-547]-AET-cAMP</td><td valign="top">BIOLOG</td><td valign="top">Cat. No.: D 109</td><td valign="top">DOI:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2010.05.022">10.1016/j.neuron.2010.05.022</ext-link></td></tr><tr><td valign="top">Software, algorithm</td><td valign="top">MATLAB</td><td valign="top">MathWorks</td><td valign="top">RID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_001622">SCR_001622</ext-link></td><td valign="top"/></tr><tr><td valign="top">Software, algorithm</td><td valign="top">QuB</td><td>DOI: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.1016%2Fj.bpj.2009.09.031">10.1142/1793048013300053</ext-link></td><td valign="top"/><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://qub.mandelics.com/">https://qub.mandelics.com/</ext-link></td></tr><tr><td valign="top">Software, algorithm</td><td valign="top">DISC</td><td valign="top">This work</td><td valign="top"/><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/ChandaLab/DISC">https://github.com/ChandaLab/DISC</ext-link></td></tr><tr><td valign="top">Software, algorithm</td><td valign="top">vbFRET</td><td valign="top">DOI: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.1016%2Fj.bpj.2009.09.031">10.1016/j.bpj.2009.09.031</ext-link></td><td valign="top"/><td valign="top"><ext-link ext-link-type="uri" xlink:href="http://vbfret.sourceforge.net/">http://vbfret.sourceforge.net/</ext-link></td></tr><tr><td valign="top">Software, algorithm</td><td valign="top">STaSI</td><td valign="top">DOI: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.1021%2Fjz501435p">10.1021/jz501435p</ext-link></td><td valign="top"/><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/LandesLab/STaSI">https://github.com/LandesLab/STaSI</ext-link></td></tr><tr><td valign="top">Other</td><td valign="top">Zero-Mode Waveguide</td><td valign="top">Pacific Biosciences</td><td valign="top">Non-Commercial Zero-Mode Waveguides (Astro Chips)</td><td valign="top"/></tr></tbody></table></table-wrap><sec id="s4-1"><title>Single-molecule simulations</title><p>Single-molecule trajectories were simulated as a Markov process of transitions between discrete states. All simulations were performed with a frame rate of 10 Hz and featured variable total durations, SNR, and number of states. The primary kinetic scheme used was adapted from our recent studies of fcAMP binding to isolated monomeric CNBDs (<xref ref-type="bibr" rid="bib15">Goldschen-Ohm et al., 2016</xref>). This model is a four-state scheme where both the unbound (U) and bound states (B) exhibit conformational changes (U’ ⇔ U ⇔ B ⇔ B’), yet exhibit only two different observable states (ie, U’/U are indistinguishable via fluorescence intensity, as are B/B’). fcAMP binding occurs between U and B. The rate constants (s<sup>−1</sup> or M<sup>−1</sup> s<sup>−1</sup>) are: k<sub>U’U</sub> = 0.15; k<sub>U,U’</sub>=0.04; k<sub>U,B</sub> = 2.3x10<sup>−6</sup> * [fcAMP]; k<sub>B,U</sub> = 0.95; k<sub>B,B’</sub>=0.51; k<sub>B’,B</sub> = 0.31 at 1 µM fcAMP. To mimic the tetrameric nature of HCN channels with no cooperativity, we extrapolated up to four bound states by summing independent CNBD trajectories prior to the addition of noise. To include realistic SNR, state-intensities, and heterogeneity distribution of bound intensities, we analyzed the direct fcAMP excitation and emission trajectories following acceptor photobleaching from the monomeric CNBD dataset used in our previous work (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>; <xref ref-type="bibr" rid="bib15">Goldschen-Ohm et al., 2016</xref>). This dataset consisted of 861 single molecules for a combined acquisition time of 44,090 s (4775 total binding events). All trajectories had a SNR &gt;2 and all events persisted for longer than two frames, which resulted in an imbalance in the bound and unbound events. For each simulated trajectory, state intensities were each drawn from log normal distributions fit to monomeric CNBD single-molecule data, with average intensities between subsequent states being uniform. Gaussian noise was applied to trajectories at specified SNR. To quantitate the heterogeneous intensities from fcAMP binding, the mean of individual bound event intensities were taken for each identified event, so long as the event was &gt;2 frames in duration. Heterogeneity was computed as the absolute percent difference for each event vs the mean bond intensity for the given trajectory by:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mi>H</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>I</mml:mi><mml:msub><mml:mo>&gt;</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mi>I</mml:mi><mml:msub><mml:mo>&gt;</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mi>I</mml:mi><mml:msub><mml:mo>&gt;</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mtext> </mml:mtext><mml:mn>100</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The heterogeneity of unbound events was minimal and was therefore not included in the simulations. For each simulated event, heterogenous bound intensity emissions were each drawn from an exponential fit monomeric CNBD single-molecule data. Gaussian noise was added to trajectories as specified.</p><p>Simulated smFRET data were downloaded from the kinSoftChallenge on June 11<sup>th</sup>, 2019 (<ext-link ext-link-type="uri" xlink:href="https://sites.google.com/view/kinsoftchallenge/home">https://sites.google.com/view/kinsoftchallenge/home</ext-link>). Data used came from the provided training data sets titled: ‘Level 1’ and ‘Level 2’ with folder names ‘sim_190212_194543_level1’ and ‘sim_190212_202530_level2’.</p></sec><sec id="s4-2"><title>Algorithm performance</title><p>DISC, STaSI, and vbFRET are all written entirely in MATLAB (MathWorks). Each algorithm was used outside of their graphical user interfaces (GUIs) to more accurately compare the computational time of native functions within each algorithm. User parameters in DISC include: the confidence interval of CP detection and the objective function for clustering. Unless otherwise stated, a 95% confidence interval was applied for CP detection and BIC was used for all clustering. For analysis with STaSI and vbFRET, we used the recommended default values set by their authors (<xref ref-type="bibr" rid="bib7">Bronson et al., 2009</xref>; <xref ref-type="bibr" rid="bib45">Shuang et al., 2014</xref>). For STaSI, this means a 99.8% confidence interval of CP detection. In vbFRET, users must provide the number of states and fitting attempts per trace (left at the default value of 10). To circumvent providing the number of states, we modified the provided <italic>vbFRET_no_gui.m</italic> script to perform analysis outside of the vbFRET GUI. The modified script begins by fitting the trace to one state and increases the number of states until two more beyond the number of states with the maximum evidence to ensure the maximum fit has been obtained. As no changes were made to native vbFRET functions, implementing this script has no effect on vbFRET’s accuracy. We expect changing parameters in both STaSI and vbFRET may lead to different results; however, it was not our goal to optimize the use of these algorithms. Also, as a thorough investigation into the performance of STaSI and vbFRET has been conducted elsewhere, we did not investigate why these algorithms presented lower performance than DISC (<xref ref-type="bibr" rid="bib19">Hadzic et al., 2018</xref>).</p><p>All quantifications of computational time were performed using the tic and toc functions in MATLAB. For idealization accuracy, each event returned by a given algorithm is classified as a True Positive (TP), False positive (FP), or False Negative (FN). We define a TP as being in the correct state (±10% the correct intensity level’s standard deviation) and correct event duration (±1 frame) for a given simulated event. FPs are either added events or correct events in the wrong state. FNs are missed events. For each trajectory, we computed accuracy, precision, and recall as:<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mi>A</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>y</mml:mi> <mml:mi/><mml:mo>=</mml:mo> <mml:mi/><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula><disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula><disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>Accuracy represents the overall performance, whereas precision and recall highlight the false positive error rate (overfitting the data) and false negative rate (underfitting the data), respectively.</p></sec><sec id="s4-3"><title>Single-molecule fluorescence microscopy in ZMWs</title><p>The expression, purification, biotinylation, and fluorescence labeling of tetrameric CNBDs were performed as previously described (<xref ref-type="bibr" rid="bib15">Goldschen-Ohm et al., 2016</xref>). Non-commercial arrays of ZMWs were purchased from Pacific Biosciences. These waveguides featured a polyphosphonate passivation layer on the aluminum walls and a biotinylated polyethylene glycol (PEG) layer on the glass surface to reduce non-specific binding (<xref ref-type="bibr" rid="bib14">Foquet et al., 2008</xref>; <xref ref-type="bibr" rid="bib11">Eid et al., 2009</xref>). The PEG-Biotin surface was incubated with 0.05 mg/mL streptavidin (Prospec, cat # PRO-791) for 5 min in a buffer containing: 40 mM HEPES, 600 mM NaCl, 20% glycerol, 2 mM TCEP, 0.1% LDAO (Sigma, cat no. 40236), 2 mg/mL bovine serum albumin (BSA), 1 mM Trolox (Sigma, cas no. 53188-07-1), 2.5 mM protocatechuic acid (Sigma, cas no. 99-50-3) (PCA), pH 7.5 (Buffer A). After incubation, the ZMW chip was thoroughly rinsed with Buffer A to remove unbound streptavidin. Next, biotinylated tetrameric-CNBDs were diluted in Buffer A with the addition of the PCA/PCD oxygen scavenging system by adding 250 nM of protocatechuate 3,4-dioxygenase (PCD) from Pseudomonas sp. (Sigma, cas no. 9029-47-4) to between 100 pM and 2 nM for surface immobilization in ZMWs (Buffer B) (<xref ref-type="bibr" rid="bib1">Aitken et al., 2008</xref>). This resulted in ≈100 occupied ZMWs out of the total ≈1000 ZMWs per field of view identified by fluorescence bleach steps of DY-650 that labels each of the four CNBDs. Fluorescently labeled cAMP (fcAMP; 8-(2-DY-547]-aminoethylthio) adenosine-3’,5’-cylic monophosphate) (BioLog, cat # D 109) was added at 1 µM for all single-molecule experiments in Buffer B.</p><p>ZMW chips were placed on top of an inverted microscope (Olympus IX-71, 100X, NA 1.49) and imaged under 532 nm (60 W/ cm<sup>2</sup>) or 640 nm (25 W/ cm<sup>2</sup>) (Coherent) as described previously (<xref ref-type="bibr" rid="bib16">Goldschen-Ohm et al., 2017</xref>; <xref ref-type="bibr" rid="bib15">Goldschen-Ohm et al., 2016</xref>). The only notable difference is that unlike previous experiments we did not use FRET to monitor binding in order to obtain data for extended periods (<xref ref-type="bibr" rid="bib15">Goldschen-Ohm et al., 2016</xref>). We excited DY-650 with 640 nm to identify ZMWs featuring DY-650-labeled tetrameric-CNBDs. Next, fcAMP was continuously imaged with 532 nm for 8000 frames at 10 Hz to monitor binding activity. All emission spectra were split with a 650 nm long pass dichroic (Semrock Brightline FF650) and bandpass filtered using pairs of edge filters (532–623.8 nm, 632.9–945 nm; Semrock Cy3/Cy5-A-OMF) and imaged onto two separate EMCCDs (Andor iXon Ultra X-9899) using Metamorph software (Molecular Devices). All data were collected using ZMWs of 150–200 nm diameter which are large enough to accommodate tetrameric CNBD complex (each monomeric CNBD is 4 × 6×20 nm) (<xref ref-type="bibr" rid="bib15">Goldschen-Ohm et al., 2016</xref>).</p></sec><sec id="s4-4"><title>Single-molecule ligand binding image analysis</title><p>All analysis was performed using custom software written in MATLAB (Mathworks) or ImageJ. Single-molecule trajectories of each ZMW were extracted from tiff stacks saved by Metamorph software using MATLAB. Locations of ZMWs were obtained using a threshold mask of the brightfield image of the whole ZMW array. ZMW locations were refined with a 2D Gaussian fit to the local intensity height map. The time-dependent fluorescence at each ZMW was obtained by projecting the average image intensity in a 5-pixel diameter circle onto the ZMW location throughout each image in the stack.</p></sec><sec id="s4-5"><title>Trace selection and analysis of binding activity</title><p>A total of 13,670 individual ZMWs (1.1 × 10<sup>8</sup> data points) were processed from the single-molecule tetrameric CNBD experiments. Each trajectory was idealized with DISC using a 95% confidence interval for CP detection and BIC for state selection (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). To reflect the ability to cleanly resolve the individual occupation states, we computed the separation of each sequential state vs the noise within a state by:<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula>where K is the total number of states, µ is the mean intensity value of a state, and σ is the standard deviation of the data points belonging to a state. This ensures that states are separated well enough to resolve, as would be expected for sequential ligand binding. Traces featuring 4 to 6 identified states with state separation ≥ 3 were retained for further analysis.</p><p>To ensure a given trajectory contained a functional tetrameric CNBD, we kept traces that spent less than 50% of the time in the unbound state, resulting in a total of 480 trajectories for visual inspection. The observed asynchronous decay of protein activity was corrected using the CP detection method to identify the most likely point in a given trajectory where protein behavior dramatically changed. This was accomplished using MATLAB's findchangepoint function using the change in standard deviation as the statistic. Data points following the identified CP location were discarded from the analysis to include only the frames of consistent fcAMP binding to presumably functional proteins (<xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>).</p><p>In conclusion, a total of 293 molecules totaling 1.2 × 10<sup>5</sup> s (≈34.5 hr) of combined protein activity across 53,474 events was included for the final analysis. Each trajectory exhibited four or five conformational states (3 to 4 fcAMPs bound). Binomial fitting of the total time spent in each state was performed using MATLAB’s mle function. HMM modeling of single-molecule binding events was performed with QuB (<xref ref-type="bibr" rid="bib34">Nicolai and Sachs, 2013</xref>; <xref ref-type="bibr" rid="bib38">Qin et al., 2000</xref>). Idealized trajectories from DISC were exported to QuB with the first and last events removed. A sequential model of 0 to 4 ligand binding sites was globally optimized to simultaneously describe the idealized binding trajectories for all molecules.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Dr. Mike Sanguinetti for the wild-type HCN2 plasmid and Dr. Vadim A Klenchin for the purification of the tetrameric-CNBD. We also thank Owen Rafferty for his assistance in the development of the GUI for running the DISC algorithm.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Reviewing editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Investigation, Methodology</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Software, Formal analysis, Investigation, Methodology</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Supervision, Investigation, Methodology, Project administration</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Supervision, Funding acquisition, Investigation, Methodology, Project administration</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-53357-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Simulated and raw data in addition to analysis scripts are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.3727917">https://doi.org/10.5281/zenodo.3727917</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>White</surname><given-names>D S</given-names></name><name><surname>Goldschnen-Ohm</surname><given-names>MP</given-names></name><name><surname>Goldsmith</surname><given-names>R</given-names></name><name><surname>Chanda</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Data Associated with Top-Down Machine Learning for High-Throughput Single-Molecule Analysis</data-title><source>Zenodo</source><pub-id assigning-authority="Zenodo" pub-id-type="doi">10.5281/zenodo.3727917</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aitken</surname> <given-names>CE</given-names></name><name><surname>Marshall</surname> <given-names>RA</given-names></name><name><surname>Puglisi</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>An oxygen scavenging system for improvement of dye stability in single-molecule fluorescence experiments</article-title><source>Biophysical Journal</source><volume>94</volume><fpage>1826</fpage><lpage>1835</lpage><pub-id pub-id-type="doi">10.1529/biophysj.107.117689</pub-id><pub-id pub-id-type="pmid">17921203</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akaike</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>A new look at the statistical model identification</article-title><source>IEEE Transactions on Automatic Control</source><volume>19</volume><fpage>716</fpage><lpage>723</lpage><pub-id pub-id-type="doi">10.1109/TAC.1974.1100705</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altman</surname> <given-names>RB</given-names></name><name><surname>Terry</surname> <given-names>DS</given-names></name><name><surname>Zhou</surname> <given-names>Z</given-names></name><name><surname>Zheng</surname> <given-names>Q</given-names></name><name><surname>Geggier</surname> <given-names>P</given-names></name><name><surname>Kolster</surname> <given-names>RA</given-names></name><name><surname>Zhao</surname> <given-names>Y</given-names></name><name><surname>Javitch</surname> <given-names>JA</given-names></name><name><surname>Warren</surname> <given-names>JD</given-names></name><name><surname>Blanchard</surname> <given-names>SC</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Cyanine fluorophore derivatives with enhanced photostability</article-title><source>Nature Methods</source><volume>9</volume><fpage>68</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1774</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berghuis</surname> <given-names>BA</given-names></name><name><surname>Köber</surname> <given-names>M</given-names></name><name><surname>van Laar</surname> <given-names>T</given-names></name><name><surname>Dekker</surname> <given-names>NH</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>High-throughput, high-force probing of DNA-protein interactions with magnetic tweezers</article-title><source>Methods</source><volume>105</volume><fpage>90</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1016/j.ymeth.2016.03.025</pub-id><pub-id pub-id-type="pmid">27038745</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bishop</surname> <given-names>CM</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Pattern Recognition and Machine Learning</source><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib6"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Blanco</surname> <given-names>M</given-names></name><name><surname>Walter</surname> <given-names>NG</given-names></name></person-group><year iso-8601-date="2010">2010</year><chapter-title>Analysis of Complex Single-Molecule FRET Time Trajectories</chapter-title><person-group person-group-type="editor"><name><surname>Walter</surname> <given-names>N. G</given-names></name></person-group><source>Single Molecule Tools: Fluorescence Based Approaches, Part A: Methods in Enzymology</source><volume>472</volume><publisher-name>Academic Press</publisher-name><fpage>153</fpage><lpage>178</lpage><pub-id pub-id-type="doi">10.1016/S0076-6879(10)72011-5</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bronson</surname> <given-names>JE</given-names></name><name><surname>Fei</surname> <given-names>J</given-names></name><name><surname>Hofman</surname> <given-names>JM</given-names></name><name><surname>Gonzalez</surname> <given-names>RL</given-names></name><name><surname>Wiggins</surname> <given-names>CH</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Learning rates and states from biophysical time series: a bayesian approach to model selection and single-molecule FRET data</article-title><source>Biophysical Journal</source><volume>97</volume><fpage>3196</fpage><lpage>3205</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2009.09.031</pub-id><pub-id pub-id-type="pmid">20006957</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Chanda</surname> <given-names>B</given-names></name><name><surname>Rafferty</surname> <given-names>O</given-names></name><name><surname>White</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Single-Molecule Trajectory Idealization Using Divisive Segmentation and Clustering (DISC)</data-title><source>GitHub</source><version designator="6e4c423">6e4c423</version><ext-link ext-link-type="uri" xlink:href="https://github.com/ChandaLab/DISC">https://github.com/ChandaLab/DISC</ext-link></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>J</given-names></name><name><surname>Dalal</surname> <given-names>RV</given-names></name><name><surname>Petrov</surname> <given-names>AN</given-names></name><name><surname>Tsai</surname> <given-names>A</given-names></name><name><surname>O'Leary</surname> <given-names>SE</given-names></name><name><surname>Chapin</surname> <given-names>K</given-names></name><name><surname>Cheng</surname> <given-names>J</given-names></name><name><surname>Ewan</surname> <given-names>M</given-names></name><name><surname>Hsiung</surname> <given-names>PL</given-names></name><name><surname>Lundquist</surname> <given-names>P</given-names></name><name><surname>Turner</surname> <given-names>SW</given-names></name><name><surname>Hsu</surname> <given-names>DR</given-names></name><name><surname>Puglisi</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>High-throughput platform for real-time monitoring of biological processes by multicolor single-molecule fluorescence</article-title><source>PNAS</source><volume>111</volume><fpage>664</fpage><lpage>669</lpage><pub-id pub-id-type="doi">10.1073/pnas.1315735111</pub-id><pub-id pub-id-type="pmid">24379388</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dempsey</surname> <given-names>GT</given-names></name><name><surname>Bates</surname> <given-names>M</given-names></name><name><surname>Kowtoniuk</surname> <given-names>WE</given-names></name><name><surname>Liu</surname> <given-names>DR</given-names></name><name><surname>Tsien</surname> <given-names>RY</given-names></name><name><surname>Zhuang</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Photoswitching mechanism of cyanine dyes</article-title><source>Journal of the American Chemical Society</source><volume>131</volume><fpage>18192</fpage><lpage>18193</lpage><pub-id pub-id-type="doi">10.1021/ja904588g</pub-id><pub-id pub-id-type="pmid">19961226</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eid</surname> <given-names>J</given-names></name><name><surname>Fehr</surname> <given-names>A</given-names></name><name><surname>Gray</surname> <given-names>J</given-names></name><name><surname>Luong</surname> <given-names>K</given-names></name><name><surname>Lyle</surname> <given-names>J</given-names></name><name><surname>Otto</surname> <given-names>G</given-names></name><name><surname>Peluso</surname> <given-names>P</given-names></name><name><surname>Rank</surname> <given-names>D</given-names></name><name><surname>Baybayan</surname> <given-names>P</given-names></name><name><surname>Bettman</surname> <given-names>B</given-names></name><name><surname>Bibillo</surname> <given-names>A</given-names></name><name><surname>Bjornson</surname> <given-names>K</given-names></name><name><surname>Chaudhuri</surname> <given-names>B</given-names></name><name><surname>Christians</surname> <given-names>F</given-names></name><name><surname>Cicero</surname> <given-names>R</given-names></name><name><surname>Clark</surname> <given-names>S</given-names></name><name><surname>Dalal</surname> <given-names>R</given-names></name><name><surname>Dewinter</surname> <given-names>A</given-names></name><name><surname>Dixon</surname> <given-names>J</given-names></name><name><surname>Foquet</surname> <given-names>M</given-names></name><name><surname>Gaertner</surname> <given-names>A</given-names></name><name><surname>Hardenbol</surname> <given-names>P</given-names></name><name><surname>Heiner</surname> <given-names>C</given-names></name><name><surname>Hester</surname> <given-names>K</given-names></name><name><surname>Holden</surname> <given-names>D</given-names></name><name><surname>Kearns</surname> <given-names>G</given-names></name><name><surname>Kong</surname> <given-names>X</given-names></name><name><surname>Kuse</surname> <given-names>R</given-names></name><name><surname>Lacroix</surname> <given-names>Y</given-names></name><name><surname>Lin</surname> <given-names>S</given-names></name><name><surname>Lundquist</surname> <given-names>P</given-names></name><name><surname>Ma</surname> <given-names>C</given-names></name><name><surname>Marks</surname> <given-names>P</given-names></name><name><surname>Maxham</surname> <given-names>M</given-names></name><name><surname>Murphy</surname> <given-names>D</given-names></name><name><surname>Park</surname> <given-names>I</given-names></name><name><surname>Pham</surname> <given-names>T</given-names></name><name><surname>Phillips</surname> <given-names>M</given-names></name><name><surname>Roy</surname> <given-names>J</given-names></name><name><surname>Sebra</surname> <given-names>R</given-names></name><name><surname>Shen</surname> <given-names>G</given-names></name><name><surname>Sorenson</surname> <given-names>J</given-names></name><name><surname>Tomaney</surname> <given-names>A</given-names></name><name><surname>Travers</surname> <given-names>K</given-names></name><name><surname>Trulson</surname> <given-names>M</given-names></name><name><surname>Vieceli</surname> <given-names>J</given-names></name><name><surname>Wegener</surname> <given-names>J</given-names></name><name><surname>Wu</surname> <given-names>D</given-names></name><name><surname>Yang</surname> <given-names>A</given-names></name><name><surname>Zaccarin</surname> <given-names>D</given-names></name><name><surname>Zhao</surname> <given-names>P</given-names></name><name><surname>Zhong</surname> <given-names>F</given-names></name><name><surname>Korlach</surname> <given-names>J</given-names></name><name><surname>Turner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Real-time DNA sequencing from single polymerase molecules</article-title><source>Science</source><volume>323</volume><fpage>133</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1126/science.1162986</pub-id><pub-id pub-id-type="pmid">19023044</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Elkan</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Using the triangle inequality to accelerate k-means</article-title><conf-name>Proceedings of the 20th International Conference on Machine Learning </conf-name><fpage>147</fpage><lpage>153</lpage><ext-link ext-link-type="uri" xlink:href="https://dl.acm.org/doi/10.5555/3041838.3041857">https://dl.acm.org/doi/10.5555/3041838.3041857</ext-link></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>English</surname> <given-names>BP</given-names></name><name><surname>Min</surname> <given-names>W</given-names></name><name><surname>van Oijen</surname> <given-names>AM</given-names></name><name><surname>Lee</surname> <given-names>KT</given-names></name><name><surname>Luo</surname> <given-names>G</given-names></name><name><surname>Sun</surname> <given-names>H</given-names></name><name><surname>Cherayil</surname> <given-names>BJ</given-names></name><name><surname>Kou</surname> <given-names>SC</given-names></name><name><surname>Xie</surname> <given-names>XS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Ever-fluctuating single enzyme molecules: michaelis-menten equation revisited</article-title><source>Nature Chemical Biology</source><volume>2</volume><fpage>87</fpage><lpage>94</lpage><pub-id pub-id-type="doi">10.1038/nchembio759</pub-id><pub-id pub-id-type="pmid">16415859</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foquet</surname> <given-names>M</given-names></name><name><surname>Samiee</surname> <given-names>KT</given-names></name><name><surname>Kong</surname> <given-names>X</given-names></name><name><surname>Chauduri</surname> <given-names>BP</given-names></name><name><surname>Lundquist</surname> <given-names>PM</given-names></name><name><surname>Turner</surname> <given-names>SW</given-names></name><name><surname>Freudenthal</surname> <given-names>J</given-names></name><name><surname>Roitman</surname> <given-names>DB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Improved fabrication of zero-mode waveguides for single-molecule detection</article-title><source>Journal of Applied Physics</source><volume>103</volume><elocation-id>034301</elocation-id><pub-id pub-id-type="doi">10.1063/1.2831366</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldschen-Ohm</surname> <given-names>MP</given-names></name><name><surname>Klenchin</surname> <given-names>VA</given-names></name><name><surname>White</surname> <given-names>DS</given-names></name><name><surname>Cowgill</surname> <given-names>JB</given-names></name><name><surname>Cui</surname> <given-names>Q</given-names></name><name><surname>Goldsmith</surname> <given-names>RH</given-names></name><name><surname>Chanda</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Structure and dynamics underlying elementary ligand binding events in human pacemaking channels</article-title><source>eLife</source><volume>5</volume><elocation-id>e20797</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.20797</pub-id><pub-id pub-id-type="pmid">27858593</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldschen-Ohm</surname> <given-names>MP</given-names></name><name><surname>White</surname> <given-names>DS</given-names></name><name><surname>Klenchin</surname> <given-names>VA</given-names></name><name><surname>Chanda</surname> <given-names>B</given-names></name><name><surname>Goldsmith</surname> <given-names>RH</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Observing Single-Molecule dynamics at Millimolar concentrations</article-title><source>Angewandte Chemie International Edition</source><volume>56</volume><fpage>2399</fpage><lpage>2402</lpage><pub-id pub-id-type="doi">10.1002/anie.201612050</pub-id><pub-id pub-id-type="pmid">28116856</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenfeld</surname> <given-names>M</given-names></name><name><surname>Pavlichin</surname> <given-names>DS</given-names></name><name><surname>Mabuchi</surname> <given-names>H</given-names></name><name><surname>Herschlag</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Single molecule analysis research tool (SMART): an integrated approach for analyzing single molecule data</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e30024</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0030024</pub-id><pub-id pub-id-type="pmid">22363412</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grimm</surname> <given-names>JB</given-names></name><name><surname>English</surname> <given-names>BP</given-names></name><name><surname>Chen</surname> <given-names>J</given-names></name><name><surname>Slaughter</surname> <given-names>JP</given-names></name><name><surname>Zhang</surname> <given-names>Z</given-names></name><name><surname>Revyakin</surname> <given-names>A</given-names></name><name><surname>Patel</surname> <given-names>R</given-names></name><name><surname>Macklin</surname> <given-names>JJ</given-names></name><name><surname>Normanno</surname> <given-names>D</given-names></name><name><surname>Singer</surname> <given-names>RH</given-names></name><name><surname>Lionnet</surname> <given-names>T</given-names></name><name><surname>Lavis</surname> <given-names>LD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A general method to improve fluorophores for live-cell and single-molecule microscopy</article-title><source>Nature Methods</source><volume>12</volume><fpage>244</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3256</pub-id><pub-id pub-id-type="pmid">25599551</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hadzic</surname> <given-names>M</given-names></name><name><surname>Börner</surname> <given-names>R</given-names></name><name><surname>König</surname> <given-names>SLB</given-names></name><name><surname>Kowerko</surname> <given-names>D</given-names></name><name><surname>Sigel</surname> <given-names>RKO</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Reliable state identification and state transition detection in fluorescence Intensity-Based Single-Molecule förster resonance Energy-Transfer data</article-title><source>The Journal of Physical Chemistry B</source><volume>122</volume><fpage>6134</fpage><lpage>6147</lpage><pub-id pub-id-type="doi">10.1021/acs.jpcb.7b12483</pub-id><pub-id pub-id-type="pmid">29737844</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Hamerly</surname> <given-names>G</given-names></name><name><surname>Elkan</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Learning the k in k-means</article-title><conf-name>Proceedings of the 16th International Conference on Neural Information Processing Systems</conf-name><fpage>281</fpage><lpage>288</lpage></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hannan</surname> <given-names>EJ</given-names></name><name><surname>Quinn</surname> <given-names>BG</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>The determination of the order of an autoregression</article-title><source>Journal of the Royal Statistical Society: Series B</source><volume>41</volume><fpage>190</fpage><lpage>195</lpage><pub-id pub-id-type="doi">10.1111/j.2517-6161.1979.tb01072.x</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hill</surname> <given-names>FR</given-names></name><name><surname>Monachino</surname> <given-names>E</given-names></name><name><surname>van Oijen</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The more the merrier: high-throughput single-molecule techniques</article-title><source>Biochemical Society Transactions</source><volume>45</volume><fpage>759</fpage><lpage>769</lpage><pub-id pub-id-type="doi">10.1042/BST20160137</pub-id><pub-id pub-id-type="pmid">28620037</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hines</surname> <given-names>KE</given-names></name><name><surname>Bankston</surname> <given-names>JR</given-names></name><name><surname>Aldrich</surname> <given-names>RW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Analyzing single-molecule time series via nonparametric bayesian inference</article-title><source>Biophysical Journal</source><volume>108</volume><fpage>540</fpage><lpage>556</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2014.12.016</pub-id><pub-id pub-id-type="pmid">25650922</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Idikuda</surname> <given-names>V</given-names></name><name><surname>Gao</surname> <given-names>W</given-names></name><name><surname>Grant</surname> <given-names>K</given-names></name><name><surname>Su</surname> <given-names>Z</given-names></name><name><surname>Liu</surname> <given-names>Q</given-names></name><name><surname>Zhou</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Singlet oxygen modification abolishes voltage-dependent inactivation of the sea urchin spHCN channel</article-title><source>Journal of General Physiology</source><volume>150</volume><fpage>1273</fpage><lpage>1286</lpage><pub-id pub-id-type="doi">10.1085/jgp.201711961</pub-id><pub-id pub-id-type="pmid">30042141</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Juang</surname> <given-names>B-H</given-names></name><name><surname>Rabiner</surname> <given-names>LR</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>The segmental K-means algorithm for estimating parameters of hidden markov models</article-title><source>IEEE Transactions on Acoustics, Speech, and Signal Processing</source><volume>38</volume><fpage>1639</fpage><lpage>1641</lpage><pub-id pub-id-type="doi">10.1109/29.60082</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Juette</surname> <given-names>MF</given-names></name><name><surname>Terry</surname> <given-names>DS</given-names></name><name><surname>Wasserman</surname> <given-names>MR</given-names></name><name><surname>Altman</surname> <given-names>RB</given-names></name><name><surname>Zhou</surname> <given-names>Z</given-names></name><name><surname>Zhao</surname> <given-names>H</given-names></name><name><surname>Blanchard</surname> <given-names>SC</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Single-molecule imaging of non-equilibrium molecular ensembles on the millisecond timescale</article-title><source>Nature Methods</source><volume>13</volume><fpage>341</fpage><lpage>344</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3769</pub-id><pub-id pub-id-type="pmid">26878382</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Karypis</surname> <given-names>MSG</given-names></name><name><surname>Kumar</surname> <given-names>V</given-names></name><name><surname>Steinbach</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>A comparison of document clustering techniques</article-title><conf-name>TextMining Workshop at KDD2000</conf-name></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kusch</surname> <given-names>J</given-names></name><name><surname>Thon</surname> <given-names>S</given-names></name><name><surname>Schulz</surname> <given-names>E</given-names></name><name><surname>Biskup</surname> <given-names>C</given-names></name><name><surname>Nache</surname> <given-names>V</given-names></name><name><surname>Zimmer</surname> <given-names>T</given-names></name><name><surname>Seifert</surname> <given-names>R</given-names></name><name><surname>Schwede</surname> <given-names>F</given-names></name><name><surname>Benndorf</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>How subunits cooperate in cAMP-induced activation of homotetrameric HCN2 channels</article-title><source>Nature Chemical Biology</source><volume>8</volume><fpage>162</fpage><lpage>169</lpage><pub-id pub-id-type="doi">10.1038/nchembio.747</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levene</surname> <given-names>MJ</given-names></name><name><surname>Korlach</surname> <given-names>J</given-names></name><name><surname>Turner</surname> <given-names>SW</given-names></name><name><surname>Foquet</surname> <given-names>M</given-names></name><name><surname>Craighead</surname> <given-names>HG</given-names></name><name><surname>Webb</surname> <given-names>WW</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Zero-mode waveguides for single-molecule analysis at high concentrations</article-title><source>Science</source><volume>299</volume><fpage>682</fpage><lpage>686</lpage><pub-id pub-id-type="doi">10.1126/science.1079700</pub-id><pub-id pub-id-type="pmid">12560545</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>H</given-names></name><name><surname>Yang</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Statistical learning of discrete states in time series</article-title><source>The Journal of Physical Chemistry B</source><volume>123</volume><fpage>689</fpage><lpage>701</lpage><pub-id pub-id-type="doi">10.1021/acs.jpcb.8b10561</pub-id><pub-id pub-id-type="pmid">30632755</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKinney</surname> <given-names>SA</given-names></name><name><surname>Joo</surname> <given-names>C</given-names></name><name><surname>Ha</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Analysis of single-molecule FRET trajectories using hidden markov modeling</article-title><source>Biophysical Journal</source><volume>91</volume><fpage>1941</fpage><lpage>1951</lpage><pub-id pub-id-type="doi">10.1529/biophysj.106.082487</pub-id><pub-id pub-id-type="pmid">16766620</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moerner</surname> <given-names>WE</given-names></name><name><surname>Shechtman</surname> <given-names>Y</given-names></name><name><surname>Wang</surname> <given-names>Q</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Single-molecule spectroscopy and imaging over the decades</article-title><source>Faraday Discussions</source><volume>184</volume><fpage>9</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1039/C5FD00149H</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moerner</surname> <given-names>WE</given-names></name><name><surname>Fromm</surname> <given-names>DP</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Methods of single-molecule fluorescence spectroscopy and microscopy</article-title><source>Review of Scientific Instruments</source><volume>74</volume><fpage>3597</fpage><lpage>3619</lpage><pub-id pub-id-type="doi">10.1063/1.1589587</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nicolai</surname> <given-names>C</given-names></name><name><surname>Sachs</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>SOLVING ION CHANNEL KINETICS WITH THE QuB SOFTWARE</article-title><source>Biophysical Reviews and Letters</source><volume>08</volume><fpage>191</fpage><lpage>211</lpage><pub-id pub-id-type="doi">10.1142/S1793048013300053</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Pelleg</surname> <given-names>D</given-names></name><name><surname>Moore</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>X-means: extending k-means with efficient estimation of thenumber of clusters</article-title><conf-name>Proceedings of the 17th International Conference on Machine Learning</conf-name><fpage>727</fpage><lpage>734</lpage></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Persson</surname> <given-names>F</given-names></name><name><surname>Lindén</surname> <given-names>M</given-names></name><name><surname>Unoson</surname> <given-names>C</given-names></name><name><surname>Elf</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Extracting intracellular diffusive states and transition rates from single-molecule tracking data</article-title><source>Nature Methods</source><volume>10</volume><fpage>265</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2367</pub-id><pub-id pub-id-type="pmid">23396281</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Popa</surname> <given-names>I</given-names></name><name><surname>Rivas-Pardo</surname> <given-names>JA</given-names></name><name><surname>Eckels</surname> <given-names>EC</given-names></name><name><surname>Echelman</surname> <given-names>DJ</given-names></name><name><surname>Badilla</surname> <given-names>CL</given-names></name><name><surname>Valle-Orero</surname> <given-names>J</given-names></name><name><surname>Fernández</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A HaloTag anchored ruler for Week-Long studies of protein dynamics</article-title><source>Journal of the American Chemical Society</source><volume>138</volume><fpage>10546</fpage><lpage>10553</lpage><pub-id pub-id-type="doi">10.1021/jacs.6b05429</pub-id><pub-id pub-id-type="pmid">27409974</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qin</surname> <given-names>F</given-names></name><name><surname>Auerbach</surname> <given-names>A</given-names></name><name><surname>Sachs</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>A direct optimization approach to hidden markov modeling for single channel kinetics</article-title><source>Biophysical Journal</source><volume>79</volume><fpage>1915</fpage><lpage>1927</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(00)76441-1</pub-id><pub-id pub-id-type="pmid">11023897</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qin</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Restoration of single-channel currents using the segmental k-means method based on hidden markov modeling</article-title><source>Biophysical Journal</source><volume>86</volume><fpage>1488</fpage><lpage>1501</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(04)74217-4</pub-id><pub-id pub-id-type="pmid">14990476</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sambur</surname> <given-names>JB</given-names></name><name><surname>Chen</surname> <given-names>TY</given-names></name><name><surname>Choudhary</surname> <given-names>E</given-names></name><name><surname>Chen</surname> <given-names>G</given-names></name><name><surname>Nissen</surname> <given-names>EJ</given-names></name><name><surname>Thomas</surname> <given-names>EM</given-names></name><name><surname>Zou</surname> <given-names>N</given-names></name><name><surname>Chen</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Sub-particle reaction and photocurrent mapping to optimize catalyst-modified photoanodes</article-title><source>Nature</source><volume>530</volume><fpage>77</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1038/nature16534</pub-id><pub-id pub-id-type="pmid">26842056</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwarz</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>Estimating the dimension of a model</article-title><source>The Annals of Statistics</source><volume>6</volume><fpage>461</fpage><lpage>464</lpage><pub-id pub-id-type="doi">10.1214/aos/1176344136</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scott</surname> <given-names>AJ</given-names></name><name><surname>Knott</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>A cluster analysis method for grouping means in the analysis of variance</article-title><source>Biometrics</source><volume>30</volume><elocation-id>507</elocation-id><pub-id pub-id-type="doi">10.2307/2529204</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sgouralis</surname> <given-names>I</given-names></name><name><surname>Whitmore</surname> <given-names>M</given-names></name><name><surname>Lapidus</surname> <given-names>L</given-names></name><name><surname>Comstock</surname> <given-names>MJ</given-names></name><name><surname>Pressé</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Single molecule force spectroscopy at high data acquisition: a bayesian nonparametric analysis</article-title><source>The Journal of Chemical Physics</source><volume>148</volume><elocation-id>123320</elocation-id><pub-id pub-id-type="doi">10.1063/1.5008842</pub-id><pub-id pub-id-type="pmid">29604816</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sgouralis</surname> <given-names>I</given-names></name><name><surname>Pressé</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>ICON: an adaptation of infinite HMMs for time traces with drift</article-title><source>Biophysical Journal</source><volume>112</volume><fpage>2117</fpage><lpage>2126</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2017.04.009</pub-id><pub-id pub-id-type="pmid">28538149</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shuang</surname> <given-names>B</given-names></name><name><surname>Cooper</surname> <given-names>D</given-names></name><name><surname>Taylor</surname> <given-names>JN</given-names></name><name><surname>Kisley</surname> <given-names>L</given-names></name><name><surname>Chen</surname> <given-names>J</given-names></name><name><surname>Wang</surname> <given-names>W</given-names></name><name><surname>Li</surname> <given-names>CB</given-names></name><name><surname>Komatsuzaki</surname> <given-names>T</given-names></name><name><surname>Landes</surname> <given-names>CF</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Fast step transition and state identification (STaSI) for discrete Single-Molecule data analysis</article-title><source>The Journal of Physical Chemistry Letters</source><volume>5</volume><fpage>3157</fpage><lpage>3161</lpage><pub-id pub-id-type="doi">10.1021/jz501435p</pub-id><pub-id pub-id-type="pmid">25247055</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname> <given-names>CS</given-names></name><name><surname>Jouravleva</surname> <given-names>K</given-names></name><name><surname>Huisman</surname> <given-names>M</given-names></name><name><surname>Jolly</surname> <given-names>SM</given-names></name><name><surname>Zamore</surname> <given-names>PD</given-names></name><name><surname>Grunwald</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>An automated bayesian pipeline for rapid analysis of single-molecule binding data</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>272</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-08045-5</pub-id><pub-id pub-id-type="pmid">30655518</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname> <given-names>N</given-names></name><name><surname>Yang</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Parallelization of change point detection</article-title><source>The Journal of Physical Chemistry A</source><volume>121</volume><fpage>5100</fpage><lpage>5109</lpage><pub-id pub-id-type="doi">10.1021/acs.jpca.7b04378</pub-id><pub-id pub-id-type="pmid">28616980</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stennett</surname> <given-names>EM</given-names></name><name><surname>Ciuba</surname> <given-names>MA</given-names></name><name><surname>Lin</surname> <given-names>S</given-names></name><name><surname>Levitus</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Demystifying PIFE: the photophysics behind the Protein-Induced fluorescence enhancement phenomenon in Cy3</article-title><source>The Journal of Physical Chemistry Letters</source><volume>6</volume><fpage>1819</fpage><lpage>1823</lpage><pub-id pub-id-type="doi">10.1021/acs.jpclett.5b00613</pub-id><pub-id pub-id-type="pmid">26263254</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thon</surname> <given-names>S</given-names></name><name><surname>Schulz</surname> <given-names>E</given-names></name><name><surname>Kusch</surname> <given-names>J</given-names></name><name><surname>Benndorf</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Conformational flip of nonactivated HCN2 channel subunits evoked by cyclic nucleotides</article-title><source>Biophysical Journal</source><volume>109</volume><fpage>2268</fpage><lpage>2276</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2015.08.054</pub-id><pub-id pub-id-type="pmid">26636938</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van de Meent</surname> <given-names>JW</given-names></name><name><surname>Bronson</surname> <given-names>JE</given-names></name><name><surname>Wiggins</surname> <given-names>CH</given-names></name><name><surname>Gonzalez</surname> <given-names>RL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Empirical bayes methods enable advanced population-level analyses of single-molecule FRET experiments</article-title><source>Biophysical Journal</source><volume>106</volume><fpage>1327</fpage><lpage>1337</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2013.12.055</pub-id><pub-id pub-id-type="pmid">24655508</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Viterbi</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>Error bounds for convolutional codes and an asymptotically optimum decoding algorithm</article-title><source>IEEE Transactions on Information Theory</source><volume>13</volume><fpage>260</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1109/TIT.1967.1054010</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ward</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="1963">1963</year><article-title>Hierarchical grouping to optimize an objective function</article-title><source>Journal of the American Statistical Association</source><volume>58</volume><fpage>236</fpage><lpage>244</lpage><pub-id pub-id-type="doi">10.1080/01621459.1963.10500845</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watkins</surname> <given-names>LP</given-names></name><name><surname>Yang</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Detection of intensity change points in time-resolved single-molecule measurements</article-title><source>The Journal of Physical Chemistry B</source><volume>109</volume><fpage>617</fpage><lpage>628</lpage><pub-id pub-id-type="doi">10.1021/jp0467548</pub-id><pub-id pub-id-type="pmid">16851054</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>D</given-names></name><name><surname>Ward</surname> <given-names>A</given-names></name><name><surname>Halvorsen</surname> <given-names>K</given-names></name><name><surname>Wong</surname> <given-names>WP</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Multiplexed single-molecule force spectroscopy using a centrifuge</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>11026</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms11026</pub-id><pub-id pub-id-type="pmid">26984516</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ye</surname> <given-names>W</given-names></name><name><surname>Götz</surname> <given-names>M</given-names></name><name><surname>Celiksoy</surname> <given-names>S</given-names></name><name><surname>Tüting</surname> <given-names>L</given-names></name><name><surname>Ratzke</surname> <given-names>C</given-names></name><name><surname>Prasad</surname> <given-names>J</given-names></name><name><surname>Ricken</surname> <given-names>J</given-names></name><name><surname>Wegner</surname> <given-names>SV</given-names></name><name><surname>Ahijado-Guzmán</surname> <given-names>R</given-names></name><name><surname>Hugel</surname> <given-names>T</given-names></name><name><surname>Sönnichsen</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Conformational dynamics of a single protein monitored for 24 h at video rate</article-title><source>Nano Letters</source><volume>18</volume><fpage>6633</fpage><lpage>6637</lpage><pub-id pub-id-type="doi">10.1021/acs.nanolett.8b03342</pub-id><pub-id pub-id-type="pmid">30251862</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname> <given-names>G</given-names></name><name><surname>Kukura</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Interferometric scattering microscopy</article-title><source>Annual Review of Physical Chemistry</source><volume>70</volume><fpage>301</fpage><lpage>322</lpage><pub-id pub-id-type="doi">10.1146/annurev-physchem-050317-021247</pub-id><pub-id pub-id-type="pmid">30978297</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.53357.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Islas</surname><given-names>Leon D</given-names></name><role>Reviewing Editor</role><aff><institution>Universidad Nacional Autónoma de México</institution><country>Mexico</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Islas</surname><given-names>Leon D</given-names></name><role>Reviewer</role><aff><institution>Universidad Nacional Autónoma de México</institution><country>Mexico</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Sigworth</surname><given-names>Fred</given-names> </name><role>Reviewer</role><aff><institution>Yale University</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This manuscript by White et al. describes a new statistical method for event detection in single-molecule biophysics. The performance of the new algorithm and workflow is higher than that of other well-established methods of single-molecule statistical analysis when probed against the same benchmarks. This new methodology combines a new top-down segmentation approach with other well-established event detection methods to yield a procedure that should accelerate and facilitate parameter extraction from single-molecule experiments.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;High-Throughput Single-Molecule Analysis via Divisive Segmentation and Clustering&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Leon D Islas as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Olga Boudker as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Fred Sigworth (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>The authors present us with a manuscript describing a new method to carry out idealization and parameter estimation of single-molecule data. The method merges several good-performing algorithms to segment the data and find transitions between states and finally discover the most probable number of states giving rise to the data. Importantly, they compare the performance of their DISC algorithm to other two well established methods and discover that DISC is faster and perhaps more accurate in certain experimental conditions.</p><p>The reviewers agree the DISC method is an important contribution to the arsenal of single-molecule trajectories analysis methods and the authors have provided a good characterization of its performance. The paper has merits and the method is an important contribution to the field, however, there are a number of important comments that were raised that need to be dealt with by the authors.</p><p>Essential revisions:</p><p>The paper needs to be rewritten in a manner that enough formal description of the method is given to allow the target readership (SM experimentalists, presumably) to understand how it works and what exactly it does. As it is, the paper reads more like an &quot;advertisement&quot; of an algorithm described in detail elsewhere.</p><p>1) The new Divisive Segmentation (DS) algorithm is described in general terms in the text but a formal description is not provided. A reasonable description of the CP analysis portion of DS is provided in Supplemental Note 2 (though a suitable pointer to this from the main text is not given). In the text you then note that you employ a modified k-means algorithm. The reader asks, what is the modification? The citations are unhelpful. Finally, the HAC part is also fairly well described in Supplemental Note 3. But the heart of the DS algorithm does not receive a similarly formal description. A similar problem arises with the mention of the Viterbi algorithm. We are told that you &quot;use&quot; it, but the only references are to the ion-channel and speech-recognition literature. Beside not explaining briefly what it does (for the naive reader's benefit), you do not explain what emission probability densities you use, nor how you set transition probabilities.</p><p>2) A question that arises regarding assumptions and parameters: how well does the DS/HSC perform for traces with rarely-visited states? Your selection of total fraction bound &gt; 0.5 (subsection “Trace selection and analysis of binding activity”) suggests that your approach might be best for situations where the various states are roughly equi-probable. An important point to check is the performance of DISC as a function of the kinetics of the underlying process. How well does DISC estimates the number of states for fast kinetics, with a small number of data points in each state (short dwell-times)? One of the goals of single-molecule analysis is the determination not only of the most probable number of states, but also the dwell-times in each state and the transition rates between them. Was an effort made to include dwell-time estimation in DISC?</p><p>3) The authors need to be careful using the term high throughput as this means different things to different scientific fields. For instance, high throughput drug discovery often means looking at millions of compounds. Certainly 4000 molecules is relatively high throughput compared to a handful, but even the earliest single-molecule fluorescence papers included a hundred traces, so does a 40x increase justify the semantic transition to high throughput?</p><p>4) As authors show in the assessment of simulated traces in Figure 3, none of the methods compared work in a meaningful way when looking at SNR less than or equal to 3. The data simulated in the manuscript appears to be &gt;10:1 according to a first approximation. So none of the methods assessed does a meaningful job revealing the 'true' number of states even when the data appear to be very good.</p><p>5) In the Introduction and Discussion sections, the authors downplay the general usefulness of existing Markov modeling methods. This is unfortunately misleading. The value of Markov modeling for time-series data analysis is proven in the extensive literature across a large number of fields using a variety of experimental approaches. While recent advancements in data throughput (e.g., sCMOS cameras) have put pressure on these algorithms to be efficient, this is a relatively minor problem that can be overcome by better implementations. Related to the above, Supplementary Note 1 includes a great deal of important introductory information that does a better job of placing DISC into the context of existing methods. This information belongs in the main text to substantively review the subject matter.</p><p>6) Given that the authors know (or should reasonably expect) that their experimental system has exactly five states, how does their &quot;model free&quot; approach compare to a traditional, model-based approach with a reasonable starting state (for example using SKM or any of the many HMM algorithms implemented in QuB, SPARTAN, or SMART)? This is important to justify the method being widely valuable, rather than just an incrementally better change-point algorithm.</p><p>7) The manuscript is lacking algorithm and implementation details. For example, the authors claim to use the Viterbi algorithm for idealization of time traces using the output of DISC, but the details of this step are never described. Looking at the code, it appears that the authors actually implemented the segmental k-means algorithm (SKM; Qin, 2004) using the state sequence from DISC as the input for the first iteration. SKM iteratively runs the Viterbi algorithm to identify the optimal state sequence followed by re-estimation of model parameters using this state sequence. Strictly speaking DISC does use Viterbi, but the description in the manuscript is not as novel as would appear. This is a critical point because it suggests that DISC just implements an existing, widely-used approach (SKM), and only differs in that it provides a means to initialize the starting model. If this is the case, it should simple be stated in this way. If this is not the case, then further clarity is definitely needed.</p><p>8) The SNR of the simulated traces in Figure 2A and Figure 3B seem to be far higher than specified. The most meaningful SNR, as it's usually defined, is the fluorescence intensity relative to the standard deviation of fluorescence background noise (or noise within the signal, if it is static). Correspondingly, SNR is a measure of experimental noise and is independent of the interpretation of the data. The authors instead define SNR in an unusual way that measures the noise in the signal relative to the separation between states (see Equation 2 in the Materials and methods). This may be a valuable metric, but it should not be called SNR. This is very misleading for the field. As used, it is also problematic because it has a circular dependence on the interpretation of the data.</p><p>9) In the system that was used to demonstrate the power of the DISC method the authors select for high SNR data and they know that there are five states. The question they sought to answer was whether or not the data exhibited random or cooperative transitions between states, hence, it is not clear that the data even needed to be idealized to assess this question. Gaussian fitting can be used to define the number of states – particularly when the SNR is this high; the idealization thus only provides access to kinetic information, which the authors do not appear as interested in. Hence, the biological question that appears to be of interest relates to the question of cooperativity potentially arising from the transmembrane domains, and this would have been a good way to showcase the method, but this assessment is not included.</p><p>10) Some important performance benchmarks are not discussed in the manuscript. For example, how well does it deal with changing or drifting baselines? It is a common feature of fluorescence measurements to be affected by steady reduction in the average fluorescence (drift). This is sometimes also encountered in other type of single-molecule experiments. It would be important for the authors to comment on the performance of DISC under such circumstances.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.53357.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>The paper needs to be rewritten in a manner that enough formal description of the method is given to allow the target readership (SM experimentalists, presumably) to understand how it works and what exactly it does. As it is, the paper reads more like an &quot;advertisement&quot; of an algorithm described in detail elsewhere.</p></disp-quote><p>We have taken this comment seriously and have made dramatic rewrites to the paper, particularity in the describing how the DISC algorithm works. The motivation and mathematics behind the DISC algorithm have been added in a newly written “Theory” section of the manuscript.</p><disp-quote content-type="editor-comment"><p>1) The new Divisive Segmentation (DS) algorithm is described in general terms in the text but a formal description is not provided. A reasonable description of the CP analysis portion of DS is provided in Supplemental Note 2 (though a suitable pointer to this from the main text is not given). In the text you then note that you employ a modified k-means algorithm. The reader asks, what is the modification? The citations are unhelpful. Finally, the HAC part is also fairly well described in Supplemental Note 3. But the heart of the DS algorithm does not receive a similarly formal description. A similar problem arises with the mention of the Viterbi algorithm. We are told that you &quot;use&quot; it, but the only references are to the ion-channel and speech-recognition literature. Beside not explaining briefly what it does (for the naive reader's benefit), you do not explain what emission probability densities you use, nor how you set transition probabilities.</p></disp-quote><p>We thank the reviewers for pointing out these shortcomings in our earlier version. We have added a new Theory section to clarify all aspects of the DISC algorithm. Details from the previous Supplementary Notes 2 and 3 have been added to the main text to elaborate on change-point detection, unsupervised clustering, and the use of the Viterbi algorithm. New text has been added to provide a formal introduction to the novel divisive segmentation algorithm. All modifications are included in the new Theory section.</p><disp-quote content-type="editor-comment"><p>2) A question that arises regarding assumptions and parameters: how well does the DS/HSC perform for traces with rarely-visited states? Your selection of total fraction bound &gt; 0.5 (subsection “Trace selection and analysis of binding activity”) suggests that your approach might be best for situations where the various states are roughly equi-probable. An important point to check is the performance of DISC as a function of the kinetics of the underlying process. How well does DISC estimates the number of states for fast kinetics, with a small number of data points in each state (short dwell-times)? One of the goals of single-molecule analysis is the determination not only of the most probable number of states, but also the dwell-times in each state and the transition rates between them. Was an effort made to include dwell-time estimation in DISC?</p></disp-quote><p>We agree with the reviewers that the ability to detect rarely-visited states and fast dwell times are important features of any idealization algorithm. We would like to clarify that our use of trace selection based on at least 50% bound fraction criteria was intended to ensure that we are analyzing trajectories of functional proteins. This criterion was applied only to the experimental data but not to simulated data traces which were used for benchmarking DISC with other existing idealization algorithms. Therefore, we do not think that the utility of DISC is limited to trajectories containing at least 50% bound fraction.</p><p>Our simulations also highlight the ability of DISC to resolve short lived states and fast dwell times. Figure 2 plots event detection vs varying rates across 2 orders of magnitude, wherein the fastest rate of k<sub>off</sub> = 1 frames<sup>-1</sup> is present on average ~3% of the time. This figure shows that DISC maintains a high precision and recall for fast rates. Similarly, our multiple ligand binding simulations show, as expected, that the state occupancies for each additional bound state is progressively lower and the state with four ligands appears only 1% of the time. DISC can resolve these states with high accuracy and precision.</p><p>To emphasize the changing state occupancies in each simulation, we have added Figure 2—figure supplement 1 and Figure 3—source data 1. Figure 2—figure supplement 1 shows the occupancy of each of the two states with varying k<sub>off</sub> values and plots accuracy values as a function of state occupancy. Figure 3—source data 1 contains a table that shows the average time spent in each liganded state for each simulated number of CNBDs. In regards to Figure 2—figure supplement 1, the following text has been added:</p><p>“Notably, as the changes in rates also affect the change in state occupancy, the high accuracy values returned after Viterbi refinement further highlight the power of DISC for resolving short-lived and rare transitions (Figure 2—figure supplement 1).”</p><disp-quote content-type="editor-comment"><p>3) The authors need to be careful using the term high throughput as this means different things to different scientific fields. For instance, high throughput drug discovery often means looking at millions of compounds. Certainly 4000 molecules is relatively high throughput compared to a handful, but even the earliest single-molecule fluorescence papers included a hundred traces, so does a 40x increase justify the semantic transition to high throughput?</p></disp-quote><p>We have toned down our use of the word “high-throughput” throughout the manuscript. However, we do wish to empathize that our analysis involved an initial 13,670 trajectories, each comprised of 8000 frames, totaling 1 x 10<sup>8</sup> data points. This dataset is dramatically larger than standard single-molecule experiments. This is not a 40x increase in the number of trajectories, but a &gt;100x increase in the number of trajectories, and with each trajectory recorded for 10x longer than typical single-molecule fluorescence trajectories. Therefore, the total experimental time analyzed was 1,000x larger than the norm. Importantly, other algorithms are insufficient to process data at this scale with accurate results, as we state in our text about this dataset:</p><p>“DISC successfully processed this entire data set within 20 minutes using a standard MacBook Air (1.6 GHz Intel Core i5). The same analysis completed with STaSI yielded unphysical results in 4 hours (Figure 5—figure supplement 1). We estimated analysis by vbFRET would take weeks to complete and was therefore not performed.”</p><disp-quote content-type="editor-comment"><p>4) As authors show in the assessment of simulated traces in Figure 3, none of the methods compared work in a meaningful way when looking at SNR less than or equal to 3. The data simulated in the manuscript appears to be &gt;10:1 according to a first approximation. So none of the methods assessed does a meaningful job revealing the 'true' number of states even when the data appear to be very good.</p></disp-quote><p>We agree with the reviewers that this is indeed a surprising result. The simulated data plotted in Figure 3 is of SNR = 6 as indicated in the figure caption. We believe STaSI and vbFRET overfit the number of states because of heterogenous intensities included in our simulations (Figure 3—figure supplements 1-3). Without the inclusion of this additional noise source, the accuracy of each algorithm improves (Figure 3—figure supplement 4); however, this is real noise we observe and its therefore a more accurate representation of the algorithm’s performance on real data, and a major advantage of our new method. The tendency of STaSI to overfit the data is additionally highlighted in Figure 5—figure supplement 1. We discuss this phenomenon in our text:</p><p>“For SNR &gt; 3, which accounts for most of our experimentally obtained data (Figure 2—figure supplement 1C), DISC performs exceptionally well with highest average accuracy (0.91 ± 0.05) and is robust against false positives (precision = 0.96 ± 0.04) and false negatives (recall = 0.93 ± 0.03) across all simulated conditions (Figure 3A). While vbFRET matches the recall of DISC in this SNR range (0.94 ± 0.05), the tendency to overfit the number of states at higher SNR lowers precision (0.80 ± 0.18) and overall accuracy (0.76 ± 0.19). We find STaSI returns the lowest overall accuracy (0.47 ± 0.17) likely do to an overfitting the number of states (precision = 0.57 ± 0.2) and a tendency to miss transitions (recall = 0.75 ± 0.10). Notably, DISC is the only method unaffected by inclusion of heterogeneous state intensities of fcAMP likely due to the use of a Gaussian derived BIC for state selection (Figure 3—figure supplement 4).”</p><p>For data less than an SNR of 2, we find different reasons for low accuracy. In the case of DISC and STaSI, often the algorithms return a fit of 1 state owing to the high noise level. In the case of vbFRET, we find that the states are better identified, but the events are poorly located. The ability to detect the states does lead to vbFRET having the highest accuracy for SNR = 2. As we state in our manuscript:</p><p>“While no algorithm can idealize a trajectory in the presence of SNR = 1, DISC returns the lowest accuracy at SNR = 2. We suspect this result is due to using the robust BIC for state detection and accuracy would likely be improved with less penalizing objective functions, such as AIC. While vbFRET performs the best at SNR = 2, the overall accuracy is still quite low: an average accuracy value for each number of simulated states is near chance. This low value demonstrates the inability of many algorithms to analyze data in presence of high noise and reinforces the common practice of discarding noisy data to create a more reliable data set.”</p><disp-quote content-type="editor-comment"><p>5) In the Introduction and Discussion sections, the authors downplay the general usefulness of existing Markov modeling methods. This is unfortunately misleading. The value of Markov modeling for time-series data analysis is proven in the extensive literature across a large number of fields using a variety of experimental approaches. While recent advancements in data throughput (e.g., sCMOS cameras) have put pressure on these algorithms to be efficient, this is a relatively minor problem that can be overcome by better implementations. Related to the above, Supplementary Note 1 includes a great deal of important introductory information that does a better job of placing DISC into the context of existing methods. This information belongs in the main text to substantively review the subject matter.</p></disp-quote><p>Your point is well-taken. We have rewritten our Introduction and Discussion sections to address these concerns. Specifically, Supplementary Note #1 was removed from the Supplementary Materials and reworked into our Introduction section. We believe the new section paints a fair portrait of the power of HMM for standard single-molecule analysis while also highlighting their current limitations for application to large datasets.</p><disp-quote content-type="editor-comment"><p>6) Given that the authors know (or should reasonably expect) that their experimental system has exactly five states, how does their &quot;model free&quot; approach compare to a traditional, model-based approach with a reasonable starting state (for example using SKM or any of the many HMM algorithms implemented in QuB, SPARTAN, or SMART)? This is important to justify the method being widely valuable, rather than just an incrementally better change-point algorithm.</p></disp-quote><p>We did reasonably expect our system to have 5 states which is one reason we chose this system to showcase our DISC results. By fitting all &gt; 13,000 trajectories with DISC, we see that 89% of the trajectories returned a fit between 1-5 states, which suggests DISC is doing a good job in identifying states of experimental data. The same analysis with STaSI yielded poor results (Figure 5—figure supplement 1).</p><p>Importantly, the inclusions of empty ZMWs, protein decay during excitation, and the probability of more than one protein per ZMW led to distribution of observed number of states. Since our data was heterogenous, it needed to be idealized on a trajectory-by-trajectory basis. If every trace was homogenous, we expect other model-building software such as QuB, SPARTAN, or SMART would do a better job, albeit perhaps slower. However, none of these algorithms can perform trajectory-by-trajectory analysis without a user manually building a separate model for each trace, making the analysis of &gt;13,000 unfeasible. It is for this reason we compared DISC against STaSI and vbFRET, which also perform trajectory-by-trajectory idealization. We state our rationale for choosing these algorithms in the manuscript:</p><p>“We benchmark the results of DISC against commonly used HMM and CP-HAC methods: vbFRET and STaSI (Bronson et al., 2009; Shuang et al., 2014). These algorithms were chosen following the results of a recent comparative study that determined these to be the best performers among their class of analysis methods (Hadzic et al., 2018). In addition, DISC, STaSI and vbFRET all perform trajectory-by-trajectory idealization and are written entirely in MATLAB (MathWorks) which standardizes computational performance (Materials and methods).”</p><disp-quote content-type="editor-comment"><p>7) The manuscript is lacking algorithm and implementation details. For example, the authors claim to use the Viterbi algorithm for idealization of time traces using the output of DISC, but the details of this step are never described. Looking at the code, it appears that the authors actually implemented the segmental k-means algorithm (SKM; Qin 2004) using the state sequence from DISC as the input for the first iteration. SKM iteratively runs the Viterbi algorithm to identify the optimal state sequence followed by re-estimation of model parameters using this state sequence. Strictly speaking DISC does use Viterbi, but the description in the manuscript is not as novel as would appear. This is a critical point because it suggests that DISC just implements an existing, widely-used approach (SKM), and only differs in that it provides a means to initialize the starting model. If this is the case, it should simple be stated in this way. If this is not the case, then further clarity is definitely needed.</p></disp-quote><p>We agree with the reviewer that our previous version did not draw close enough parallel between DISC and SKM. We have added the following text to our Theory section when discussing the resolving power of the Viterbi algorithm:</p><p>“In general, this improvement was anticipated since we are not the first to apply the Viterbi algorithm to the problem of idealization using unsupervised clustering. Although commonly used in the application of HMMs for hard assignment of data-points into <italic>K</italic> discrete states, the SKM algorithm has shown that the Viterbi algorithm can successfully decode a path sequence following state clustering using k-means as opposed to more rigorous HMM training procedures (Juang and Rabiner, 1990; Qin et al., 2004). Therefore, both SKM and DISC can yield the event detection power of standard HMM approaches without the need of rigorous model training. However, unlike SKM, DISC has the added benefit of identifying the states naturally without the need for any user supervision such as initial state specification. This makes DISC a powerful alternative as a computationally efficient unsupervised single-molecule analysis algorithm.”</p><disp-quote content-type="editor-comment"><p>8) The SNR of the simulated traces in Figure 2A and Figure 3B seem to be far higher than specified. The most meaningful SNR, as it's usually defined, is the fluorescence intensity relative to the standard deviation of fluorescence background noise (or noise within the signal, if it is static). Correspondingly, SNR is a measure of experimental noise and is independent of the interpretation of the data. The authors instead define SNR in an unusual way that measures the noise in the signal relative to the separation between states (see Equation 2 in the Materials and methods). This may be a valuable metric, but it should not be called SNR. This is very misleading for the field. As used, it is also problematic because it has a circular dependence on the interpretation of the data.</p></disp-quote><p>We agree with the reviewer that this term is indeed misleading for experimental data. Our goal was to create a metric that accounted for the separation between state intensities while also accounting for the noise. For the experimental traces, we have changed the term in the manuscript to “state separation” since the computed SNR value would indeed be a result of the idealization and not a true SNR. The term SNR was left unchanged for simulations as it is the appropriate term in that context, and uses the traditional definition that the reviewer describes. The Materials and methods section has been updated with the following text:</p><p>“To reflect the ability to cleanly resolve the individual occupation states, we computed the separation of each sequential state vs the noise within a state by:</p><p><table-wrap id="inlinetable2" position="anchor"><table frame="hsides" rules="groups"><tbody><tr><td/><td>StateSeparation=1K∑i=2K(µi-µi-1)σi-1</td><td/></tr></tbody></table></table-wrap></p><p>where K is the total number of states, μ is the mean intensity value of a state, and σ is the standard deviation of the data points belonging to a state. This ensures that states are separated well enough to resolve, as would be expected for sequential ligand binding. Therefore, traces featuring between 4-6 identified states with state separation ≥ 3 were retained for analysis.”</p><disp-quote content-type="editor-comment"><p>9) In the system that was used to demonstrate the power of the DISC method the authors select for high SNR data and they know that there are five states. The question they sought to answer was whether or not the data exhibited random or cooperative transitions between states, hence, it is not clear that the data even needed to be idealized to assess this question. Gaussian fitting can be used to define the number of states -particularly when the SNR is this high; the idealization thus only provides access to kinetic information, which the authors do not appear as interested in. Hence, the biological question that appears to be of interest relates to the question of cooperativity potentially arising from the transmembrane domains, and this would have been a good way to showcase the method, but this assessment is not included.</p></disp-quote><p>We agree with the reviewers that we did not use our idealization to their full potential. Therefore, we modeled our idealized trajectories in QuB to directly extract global rates for a five-state sequential HMM. The results of this analysis are now shown in Figure 5D,E. This process optimized on and off rates from our idealized trajectories show a linear relationship. This provides further evidence to the non-cooperative nature of our system. The manuscript has been updated to address this new analysis.</p><disp-quote content-type="editor-comment"><p>10) Some important performance benchmarks are not discussed in the manuscript. For example, how well does it deal with changing or drifting baselines? It is a common feature of fluorescence measurements to be affected by steady reduction in the average fluorescence (drift). This is sometimes also encountered in other type of single-molecule experiments. It would be important for the authors to comment on the performance of DISC under such circumstances.</p></disp-quote><p>We acknowledge that not all possible performance benchmarks have been addressed in this manuscript; however, we believe our simulations have thoroughly explored DISC accuracy across a variety of dynamics, number of states, signal-to-noise to be confident in its performance on typical single-molecule data. As with most idealization algorithms, pre-processing the data (e.g. filtering, baseline correction, etc.) prior to idealization will likely increase idealization accuracy. There is nothing inherently built in to the DISC algorithm to be aware of a drifting baseline and therefore DISC accuracy will likely decrease with the magnitude of drift. We have added the following to our Discussion section to ensure the readers are aware of this limitation:</p><p>“However, there is no inherent knowledge within DISC to consider varying sources of experimental noise, such as photo-blinking or baseline drift. Therefore, the idealization accuracy of DISC will likely be improved when used after typical pre-processing of single-molecule trajectories.”</p><p>[Editors' note: we include below the reviews that the authors received from another journal, along with the authors’ responses.]</p><p>We thank the reviewers for their continued feedback and critical assessment of our work. We have addressed the provided comments and, in the process, significantly strengthened the manuscript. Our new changes are specifically aimed to more concisely explain our approach and provide additional context for the use of DISC to a more general audience.</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>1) The revised manuscript has addressed my concerns regarding generality of the approach and improved presentation. The manuscript is now acceptable for publication in Nature Communications.</p></disp-quote><p>We thank the reviewer for their kind words and thoughtful comments that have helped strengthen our manuscript.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>I have reviewed this paper before. While the authors have addressed minor comments, the main difficulty lies with the heart of the paper itself.</p><p>Let me explain briefly again the heart of the problem. The Hidden Markov model (HMM) has been a paradigm shifting model across fields because, given a noise model and the assumption of Markov transitions between states, it finds: 1) noise parameters; 2) transition matrices; 3) trajectories consistent with those assumptions.</p><p>Because the HMM has a coupled kinetic and observation model (which is supported by Mathematics which are 100% clear), as we apply the HMM to data, it will sometimes adjust the noise level in one state to make sure that the Markovian (exponential waiting time) assumption is not violated overall.</p><p>Now the authors do not use the HMM as, in any HMM, the number of states must be specified. Fine.</p><p>Suppose, for argument’s sake, that the number of states was known and, for whatever reason, we chose not to use a (normal) HMM because perhaps the number of states was too large and the forward filter was too slow (e.g., too long a time trace). Now, suppose, as the authors do, that the data were to be messy, and we were first to denoise traces before learning kinetics. Then what?</p><p>The short answer is that any denoising/clustering step that were not simultaneously consistent with the Markov assumption and the noise model would give results that are then inconsistent with our starting assumptions. In other words, garbage in, garbage out.</p><p>In the case of the current paper, what I highlight here is just the very beginning (the divisive segmentation step) of the very many steps that run against the basic assumptions of the (unknown state) HMM that forms the heart of their problem.</p><p>Indeed, for the current work, the problems are much worse as the number of states themselves are unknown.</p><p>I understand the need, as the authors do, for an efficient state number identifier within the HMM paradigm. I think there are many approximate (or even deterministic/non-Bayesian) ways forward (perhaps a Laplacian approximation on a likelihood or an ABC within a Bayesian paradigm) that could be conceived of. But the math needs to make sense. Right now, the math makes no sense.</p><p>I have no doubt that the method proposed by the authors is efficient at what it does. But I would never use it, nor would I recommend anyone use it because the steps in the algorithm are mutually contradictory and the method (as captured in Figure 1 of the supplement) is just plain wrong.</p></disp-quote><p>While we accept the criticism that our method is not based on completely self-consistent first principle arguments (e.g. theoretically optimal scenario), we strongly assert that this tradeoff is completely acceptable given the significant consequent gains in performance (e.g. practicality and efficiency). In fact, the tradeoff for functionality over optimality in analysis is crucial for scientific progress. Consider super-resolution localization microscopy wherein in single emitters are identified beyond the diffraction limit by fitting to the point-spread function. Although the theoretically optimal scenario is to fit each emitter using a 2D Bessel Function, the entire community fits with 2D Gaussians. Not only would the more rigorous fitting be impractically slow, but no additional benefit can be derived by fitting with 2D Bessel functions under the relevant experimental conditions (finite noise, etc.). The use of 2D Gaussians is not as mathematically rigorous, but it is incredibly practical. Similarly, the semi-empirical force fields that make molecular dynamics simulations so accessible and powerful are not as rigorous as ab initio methods, but again, the community of users is fine with the compromise: a negligible degree of accuracy is sacrificed for a tremendous benefit in practicality. If anything, these less than optimal approaches are much more prevalent, by a wide margin, than the theoretically self-consistent methods.</p><p>In the case of DISC, we show the value of practical applicability provides tremendous and enabling advantages for large data sets. The fact that accuracy does not suffer in our method is direct evidence that the sacrifice of first principles rigor is miniscule and completely acceptable. In fact, the common tradeoffs that we found were being made in the larger big-data communities served as the inspiration for this work. For example, although reviewer 2 has clear issues with our use of a hybrid change-point and clustering algorithm for determining states in a trajectory, similar divisive clustering approaches minimizing “ad-hoc” objective-functions are extremely common in statistics (e.g. X-Means<sup>1</sup> [2,641 citations] and Bisecting K-Means<sup>2</sup> [3,157 citations]) and companies such as Twitter rely on change-point detection algorithms daily to analyze production and user experience data<sup>3</sup>. Further, the segmental k-means algorithm (SKM, 564 citations)<sup>4</sup> assigns data points into a set number of user-provided states using k-means clustering and uses the Viterbi algorithm to find events. Pioneering software such as QuB for analyzing single-ion channel trajectories heavily depend on the SKM algorithm owning to its computational speed and accuracy (202 primary citations)<sup>5</sup>. Indeed, a recent groundbreaking study in Nature Methods described the use of SKM to analyze their large dataset of &gt;10,000 molecules<sup>6</sup>. These authors make it abundantly clear that:</p><p>“State assignment is performed using SKM. Although several other Markov modeling utilities are available and could be used for this purpose (e.g., HaMMy, vbFRET, SMART, iSMS and TwoTone), SKM is much faster than the alternatives, and this facilitates analysis of the large data sets associated with sCMOS.”</p><p>Experimental labs on the forefront of technological breakthroughs need more efficient algorithms to keep up with the growing scale of data generation. Although some degree of efficiency can be achieved by more sophisticated hardware (as discussed below by reviewer 3), this by no means diminishes the value of new algorithms capable of performing high throughput analysis on standard computers. We believe our manuscript demonstrates that DISC offers dramatically superior speed with maintained accuracy for both simulated and real data sets. We expect the majority of biophysical investigators will have no issue trading theoretical optimality for practical applicability.Many groups have already contacted us about using DISC, providing conspicuous evidence of this prediction.</p><p>Also, in regards to Supplemental Figure 1, to our knowledge this figure is correct. However, if something is indeed wrong, we would appreciate a reviewer to tell what is wrong (and why) to strengthen our manuscript and ensure we properly convey information.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>Authors have done a good job with providing new material to answer the initial questions and technical/experimental concerns of this reviewer and in my opinion this article is now almost ready to showcase the DISC method in a fair manner. My main concern, that was brought upon with the authors before and here again to a lesser degree would remain, is the way information is presented for the most probable group of users: biologists. Since the goal in publishing any scientific paper is eventually to benefit the researchers who would want to implement and take advantage of the knowledge or techniques presented, I would suggest authors to name multiple real-world biology related application examples in the text so a user that doesn’t carry much technical knowledge in analysis techniques and machine learning, would be able to grasp the limitations and applications for their own class of projects. That said, my opinion about the scope and presentation of DISC is positive and would like to see it in print. There are still few areas that need attention and I will list them below. Out of the fourteen points this reviewer brought up with the authors before, nine are resolved and five need attention. Four of these five points will be resolved by adding a paragraph or changing parts of statements and more clarification/specification in the paper. The last one needs a new run of the simulation. Other than that, there are two suggestions with respect to figures that need to be addressed properly. To briefly point these out: Comments#1, #2, #5, and #6 can be resolved by adding/altering text in the article while comment#9 is of technical nature and needs to be resolved by plotting the requested information. With respect to Figures, Figure 1 needs details for the axis and Figure 4 needs a new run of simulation to present a vital information for the limiting case of lack of detection. Details come below.</p><p>Note: &quot;Comment#N&quot; is a comment to the provided answer by the authors to question #N in the former round of review by this reviewer.</p></disp-quote><p>We appreciate the thorough and thoughtful comments from this reviewer which have helped us strengthen our manuscript. We agree that the tone of our manuscript and the reliance on technical jargon (e.g. unsupervised clustering) is not friendly to non-expert audiences that will be the main users of our technology. As a result, a large portion of our “The DISC Algorithm” section has been rewritten to reduce unfamiliar jargon and make the assumptions and limitations of DISC clearer.</p><disp-quote content-type="editor-comment"><p>1) Comment#1: Including the reference and mentioning it in the text satisfies the question. A small point would be, the speed is not a main issue since high throughput data analysis can always get addressed with the introduction of new better hardware which happens every year.</p></disp-quote><p>We thank the reviewer for pointing this out. Although technological progress will certainly continue to improve computational speed, faster algorithms benefit everyone now rather than sometime in the future, and also benefit many labs that do not consistently have the very latest hardware or experience to build the optimal hardware platform.</p><disp-quote content-type="editor-comment"><p>2) Comment#2: although the answer provided is not convincing, the added part in the paper is good enough to cover this issue. The reason the answer is not convincing is: hardware advances happen every year and within a couple of years, there will be more options for faster analysis and on the other hand, in many labs, working with GPU and parallel processing is becoming routine and a computer science/electrical engineering/physics PhD student or postdoc can implement methods to achieve shorter analysis times this way.</p></disp-quote><p>See response to point #1 about hardware and other technological advances.</p><disp-quote content-type="editor-comment"><p>3) Comment#5: what the word “unsupervised” bears is on dispute here. The fact that after picking a function based on the parameters of the system and the hardware you don’t need supervision, doesn’t remove the need for picking that function and make sure that it is the correct function. That said, unsupervised learning has a specific meaning used in analysis which is in line with what authors include. So the issue would be mainly explaining this clearly for the readers. Author’s usage of the technical term unsupervised learning might be misleading for the reader who is not familiar with machine learning terminology and in search of a method for data analysis. So maybe authors want to rephrase their description to clearly state that the unsupervised analysis doesn’t mean that the user can’t implement the code in a wrong way and achieve results that are not trustable, but the user can only trust the results if the proper function is known and implemented initially. The fact that they took it from supplementary note 5 to the main text, is good and removes the initial apparent contradiction in their text. As long as the discussed point is stated clearly in the main text, the issue is resolved in the opinion of this reviewer.</p></disp-quote><p>We agree with the reviewer that our language was unclear and potentially misleading. We have therefore made corrections throughout the manuscript when appropriate to ensure the definition of “unsupervised” is conveyed and discuss exactly what the user has to do to provide a reasonable answer. We have also added the following text to the final paragraph of our “The DISC Algorithm” section to highlight the importance of implementing DISC correctly:</p><p>“However, it is important to note that while DISC performs idealization using unsupervised clustering, obtaining accurate results does require the user to determine the appropriate information criterion and change-point detection methods to use as obtained results heavily depend on these variables.”</p><disp-quote content-type="editor-comment"><p>4) Comment#6: A satisfying answer to this question would take into account different type of problems a biologist would be able to investigate with DISC method and give examples of real systems and problems. Authors have done this to some extent in discussion but giving real biological examples to show the abilities and limitations would always help. I clarify that this is not a suggestion for the authors to perform biological experiments but to showcase and discuss possible and specific applications and why they can benefit or not by this method.</p></disp-quote><p>We agree with the reviewer direct applications of DISC to specific biological problems was poorly showcased. We have modified our Discussion section to include the new text.</p><p>“Finally, our results show that DISC provides a dramatic improvement in computational speed over current state-of-the-art approaches while either improving or maintaining high accuracy for both state determination and event detection. This speed increase is directly applicable to analyzing the growing data-sets obtained in single-molecule fluorescence paradigms to adequately sample population dynamics. For example, the use of sCMOS cameras enabled smFRET measures of tRNA conformational changes during protein translations across thousands of molecules simultaneously with millisecond resolution<sup>7</sup>. Additionally, magnetic tweezers have enabled week-long mechanical measurements of single-protein folding and misfolding, shifting observable dynamics to pathological timescales and allowing the detection of incredibly rare events(Popa et al., 2016).”</p><disp-quote content-type="editor-comment"><p>5) Comment#9: Based on the answer authors prepared to this point, this question rises: if two points are closer than the detection ability of the method, the method wouldn’t be able to resolve them so the precision would fall, or as the authors rephrased in their answer to the review, the signal will reduce to noise (this case is not showcased in the color map in Figure 3.) meaning no detection happened for at least one of the points (since two or more points are seen as one) so since authors answered this question with a description related to noise level, such a result is not seen in the color panel since we see only signal to noise levels of above 3. It would be useful if the authors write a paragraph about this issue (meaning about the limitation of detection in too dense areas or too noisy areas) and then bring up their interpretation that states in such a case they interpret the unseen emitter as noise which then needs to be shown in their figure as signal to noise ratios of 1 and 2 (currently it shows 3 and above). This will clarify the resolution limit question the reviewer had before.</p></disp-quote><p>We remind the reviewer that we are looking at a <italic>signal-to-noise ratio</italic>, and not signal and/or noise separately. We therefore believe our simulations have addressed the valid concern of the reviewer, albeit in a different manner.</p><p>We compute signal-to-noise (SNR) as the height between states divided by the standard deviation of the data points in the previous state (as described in our Materials and methods). For example, if we have a two-state system with observed intensities of state [1] = 100 and state [2] = 200, then we have a step height of 100. If we apply Gaussian noise to this process at σ [1] = 20, then SNR = (200100) / 20 = 5. Now, if we were to only change the height of state [2] as the reviewer has suggested, say to state [2] = 150, then we would have: SNR = (150-100) / 20 = 2.5. Therefore, changing the step height without changing the σ [1] results in a changing of SNR. However, if we were to change σ [1], say to σ [1] = 10, we would have a SNR = (150-100) / 10 = 5. Thus, detecting a step height detection completely dependent on the noise in the trajectory and is not an independent entity.</p><p>Also, detecting a minimal step height is less translatable than assessing SNR ratios given that different experiments have different expected observed values. For example, while our EMCCD experiments obtain intensities values on the scale of 100s arbitrary units, correlative FRET experiments [e.g. smFRET] only has a range of 0 to 1.</p><p>In regards to Figure 3, we have updated the figure to include simulations are SNR = 1 and 2. The text has also been updated to address this change.</p><p>“Across all the simulations, DISC provides the highest average accuracy, precision and recall (Figure 3A). While no algorithm can idealize a trajectory in the presence of SNR = 1, DISC returns the lowest accuracy at SNR = 2 as result of using the robust BIC for state detection and would likely be improved with less penalizing objective functions, such as AIC. While vbFRET performs the best at SNR = 2, an average accuracy value for each number of simulated states is close to chance. This demonstrates the inability of many algorithms to analyze data in presence of high noise and reinforces the common practice of discarding noisy data to create a more reliable data set. For SNR &gt; 3, which accounts for the majority of our experimentally obtained data (Supplemental Figure 2), DISC performs exceptionally well with highest average accuracy (0.91 ± 0.05) and is robust against false positives (precision = 0.96 ± 0.04) and false negatives (recall = 0.93 ± 0.03) across all simulated conditions (Figure 3A). While vbFRET matches the recall of DISC in this SNR range (0.93 ± 0.05), the tendency to overfit the number of states at higher SNR lowers precision (0.80 ± 0.18) and overall accuracy (0.76 ± 0.19) (Figure 3A). Notably, DISC is the only method unaffected by inclusion of heterogenous state intensities of fcAMP likely due to the use of a Gaussian derived BIC for state selection (Supplemental Figure 8).”</p><disp-quote content-type="editor-comment"><p>6) Figure 1: sub figures a and b need specific indication for intensity and time so we know what is the time period we are looking at and if the intensity is normalized or not.</p></disp-quote><p>The goal of Figure 1 is only to convey how the algorithm works on an example trajectory and therefore have removed details for clarity (e.g. only showing 5 date points the Viterbi Trellis of Figure 1A and not showing BIC in Figure 1C). As we show the results of DISC on plenty of figures in the main text and supplemental, we prefer not to update this figure with additional details simply to reduce clutter.</p><disp-quote content-type="editor-comment"><p>7) Figure 4: It’s necessary that this plot includes the case for signal to noise ratio of 1. This would be a good test to see if the method is working fine in the limiting case where emitters are not recognized. If it provides an unreasonable accuracy at signal to noise ratio of 1, there would be a flaw in the model that needs to be taken care of before other people start to use the code. This is particularly important since in practical cases, samples might provide a range of signal to noise ratio in different locations even in a single experiment, so the user wouldn’t want to mistakenly take noise for data specifically if the method is running unsupervised and provides wrongly high accuracy for such situations. The current plot doesn’t investigate this possibility and takes it for granted.</p></disp-quote><p>We agree that showing that DISC will indeed fail in a scenario of low SNR is important to assess the reliability of the method. We have updated Figure 4 with a new simulation showing accuracy results of DISC at a SNR = 1 across varying number of data points. As expected, DISC performs poorly at this signal-to-noise ratio.</p><p>References</p><p>1) Pelleg, D. &amp; Moore, A. W. in <italic>Icml.</italic> 727-734.</p><p>2) Steinbach, M., Karypis, G. &amp; Kumar, V. in <italic>KDD workshop on text mining.</italic> 525-526 (Boston).</p><p>3) James, N. A., Kejariwal, A. &amp; Matteson, D. S. Leveraging Cloud Data to Mitigate User Experience from 'Breaking Bad'. <italic>2016 Ieee International Conference on Big Data (Big Data)</italic>, 3499-3508 (2016).</p><p>4) Juang, B.-H. &amp; Rabiner, L. R. The segmental K-means algorithm for estimating parameters of hidden Markov models. <italic>IEEE Transactions on acoustics, speech, and signal Processing</italic><bold>38</bold>, 1639-1641 (1990).</p><p>5) Qin, F. Restoration of single-channel currents using the segmental k-means method based on hidden Markov modeling. <italic>Biophysical Journal</italic><bold>86</bold>, 1488-1501, doi:10.1016/s00063495(04)74217-4 (2004).</p><p>6) Juette, M. F.et al. Single-molecule imaging of non-equilibrium molecular ensembles on the millisecond timescale. <italic>Nature Methods</italic><bold>13</bold>, 341-344, doi:10.1038/nmeth.3769 (2016).</p></body></sub-article></article>