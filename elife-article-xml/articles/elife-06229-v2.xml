<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">06229</article-id><article-id pub-id-type="doi">10.7554/eLife.06229</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Computations underlying <italic>Drosophila</italic> photo-taxis, odor-taxis, and multi-sensory integration</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-23588"><name><surname>Gepner</surname><given-names>Ruben</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-23724"><name><surname>Mihovilovic Skanata</surname><given-names>Mirna</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-23589"><name><surname>Bernat</surname><given-names>Natalie M</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-23586"><name><surname>Kaplow</surname><given-names>Margarita</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-23398"><name><surname>Gershow</surname><given-names>Marc</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Physics</institution>, <institution>New York University</institution>, <addr-line><named-content content-type="city">New York</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Center for Neural Science</institution>, <institution>New York University</institution>, <addr-line><named-content content-type="city">New York</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-1056"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing editor</role><aff><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><label>*</label>For correspondence: <email>mhg4@nyu.edu</email></corresp><fn fn-type="con" id="equal-contrib"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>06</day><month>05</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e06229</elocation-id><history><date date-type="received"><day>22</day><month>12</month><year>2014</year></date><date date-type="accepted"><day>05</day><month>05</month><year>2015</year></date></history><permissions><copyright-statement>© 2015, Gepner et al</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Gepner et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-06229-v2.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="article-reference" xlink:href="10.7554/eLife.06225"/><abstract><object-id pub-id-type="doi">10.7554/eLife.06229.001</object-id><p>To better understand how organisms make decisions on the basis of temporally varying multi-sensory input, we identified computations made by <italic>Drosophila</italic> larvae responding to visual and optogenetically induced fictive olfactory stimuli. We modeled the larva's navigational decision to initiate turns as the output of a Linear-Nonlinear-Poisson cascade. We used reverse-correlation to fit parameters to this model; the parameterized model predicted larvae's responses to novel stimulus patterns. For multi-modal inputs, we found that larvae linearly combine olfactory and visual signals upstream of the decision to turn. We verified this prediction by measuring larvae's responses to coordinated changes in odor and light. We studied other navigational decisions and found that larvae integrated odor and light according to the same rule in all cases. These results suggest that photo-taxis and odor-taxis are mediated by a shared computational pathway.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.001">http://dx.doi.org/10.7554/eLife.06229.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.06229.002</object-id><title>eLife digest</title><p>Living organisms can sense cues from their surroundings and respond in appropriate ways. For example, animals will often move towards the smell of food or away from potential threats, such as predators. However, it is not fully understood how an animal's nervous system is set up to allow sensory information to control how the animal navigates its environment. It is also not clear how animals ‘decide’ what to do when they receive conflicting information from different senses.</p><p>Optogenetics is a technique that allows neuroscientists to control the activities of individual nerve cells simply by shining light on to them. Fruit fly larvae have a simple but well-studied nervous system, and they are nearly transparent, so scientists can use optogenetics to activate nerve cells in freely moving larvae.</p><p>Fruit fly larvae move in a series of forward ‘runs’ and direction-changing ‘turns’ and use sensory cues to decide when to turn, how large of a turn to make, and whether to turn left or right. Gepner, Mihovilovic Skanata et al. used optogenetics to stimulate different combinations of sensory nerve cells in larvae, while tracking the larvae's movements to discover exactly what information they used to make these decisions. An independent study by Hernandez-Nunez et al. also used a similar approach.</p><p>Fruit fly larvae are attracted towards scents from rotting fruit and are repelled by light—in particular, larvae are most sensitive to blue light but cannot detect red light. Therefore, Gepner, Mihovilovic Skanata et al. could expose the larvae to blue light to activate light-sensing nerve cells as normal, and use red light to activate odor-sensing nerve cells via optogenetics. These experiments showed that larvae changed direction more often when the level of blue light was increased or when the level of red light (which simulated the detection of odors from rotting fruits) was decreased.</p><p>Analysis of the data from these experiments revealed that larvae essentially assign negative values to the blue light and positive values to the ‘odor-mimicking’ red light. The larvae then use the sum of these two values to dictate their next move. This suggests that navigation in response to both light and odors is supported by the same pathways in a larva's nervous system.</p><p>The approach of using optogenetics in combination with quantitative analysis, as used in these two independent studies, is now opening the door to a more complete understanding of the connections between the activities of sensory nerve cells and perception and behavior.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.002">http://dx.doi.org/10.7554/eLife.06229.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author keywords</title><kwd>olfaction</kwd><kwd>vision</kwd><kwd>multi-sensory integration</kwd><kwd>optogenetics</kwd><kwd>reverse-correlation</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100006732</institution-id><institution>New York University</institution></institution-wrap></funding-source><award-id>Startup</award-id><principal-award-recipient><name><surname>Gepner</surname><given-names>Ruben</given-names></name><name><surname>Mihovilovic Skanata</surname><given-names>Mirna</given-names></name><name><surname>Bernat</surname><given-names>Natalie M</given-names></name><name><surname>Gershow</surname><given-names>Marc</given-names></name></principal-award-recipient></award-group><funding-statement>The funder had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.3</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Optogenetics and reverse-correlation have decoded the computations by which the <italic>Drosophila</italic> larva makes navigational decisions on the basis of time-varying sensory neuron activity.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Many small organisms navigate their environments by decoding temporal variations in receptor activity to bias motor output decisions (<xref ref-type="bibr" rid="bib4">Berg and Brown, 1972</xref>; <xref ref-type="bibr" rid="bib53">Sawin et al., 1994</xref>; <xref ref-type="bibr" rid="bib46">Pierce-Shimomura et al., 1999</xref>; <xref ref-type="bibr" rid="bib51">Ryu and Samuel, 2002</xref>; <xref ref-type="bibr" rid="bib16">Fishilevich et al., 2005</xref>; <xref ref-type="bibr" rid="bib38">Louis et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Luo et al., 2008</xref>, <xref ref-type="bibr" rid="bib40">2010</xref>; <xref ref-type="bibr" rid="bib1">Albrecht and Bargmann, 2011</xref>; <xref ref-type="bibr" rid="bib20">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib37">Lockery, 2011</xref>; <xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>; <xref ref-type="bibr" rid="bib24">Kane et al., 2013</xref>). The dynamics of these organisms' decision-making are intimately linked to the properties of the underlying chemical or neural substrates (<xref ref-type="bibr" rid="bib56">Segall et al., 1986</xref>; <xref ref-type="bibr" rid="bib31">Korobkova et al., 2004</xref>; <xref ref-type="bibr" rid="bib43">Miller et al., 2005</xref>; <xref ref-type="bibr" rid="bib10">Chronis et al., 2007</xref>; <xref ref-type="bibr" rid="bib12">Clark et al., 2007</xref>; <xref ref-type="bibr" rid="bib14">Emonet and Cluzel, 2008</xref>; <xref ref-type="bibr" rid="bib59">Suzuki et al., 2008</xref>; <xref ref-type="bibr" rid="bib3">Asahina et al., 2009</xref>; <xref ref-type="bibr" rid="bib57">Shimizu et al., 2010</xref>; <xref ref-type="bibr" rid="bib6">Bretscher et al., 2011</xref>; <xref ref-type="bibr" rid="bib7">Busch et al., 2012</xref>; <xref ref-type="bibr" rid="bib25">Kato et al., 2014</xref>; <xref ref-type="bibr" rid="bib41">Luo et al., 2014</xref>). In their natural environments, animals are confronted with variable and frequently conflicting inputs arriving via multiple sensory pathways. How these simple organisms respond to multi-modal stimuli and how their neural circuits integrate and prioritize multi-sensory information remains unknown.</p><p>We sought to decode the computations underlying the <italic>Drosophila</italic> larva's response to visual and olfactory cues, when presented individually or in combination. The second instar larva uses a similar strategy for navigating environments with spatially varying odor concentrations, light levels, and temperatures. Larvae move forward in a series of relatively straight <italic>runs</italic> interspersed with reorienting <italic>turns</italic>, and increase the frequency and magnitude of their turns in response to unfavorable changes in the stimulus (<xref ref-type="bibr" rid="bib53">Sawin et al., 1994</xref>; <xref ref-type="bibr" rid="bib8">Busto et al., 1999</xref>; <xref ref-type="bibr" rid="bib54">Scantlebury et al., 2007</xref>; <xref ref-type="bibr" rid="bib38">Louis et al., 2008</xref>; <xref ref-type="bibr" rid="bib40">Luo et al., 2010</xref>; <xref ref-type="bibr" rid="bib20">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>; <xref ref-type="bibr" rid="bib24">Kane et al., 2013</xref>; <xref ref-type="bibr" rid="bib30">Klein et al., 2014</xref>). During turns, larvae survey the local environment using side-to-side head sweeps to determine the direction of the next run (<xref ref-type="bibr" rid="bib53">Sawin et al., 1994</xref>; <xref ref-type="bibr" rid="bib40">Luo et al., 2010</xref>; <xref ref-type="bibr" rid="bib20">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>; <xref ref-type="bibr" rid="bib24">Kane et al., 2013</xref>; <xref ref-type="bibr" rid="bib30">Klein et al., 2014</xref>). That the larva uses the same strategy to respond to a variety of stimuli suggests navigation may be mediated by a single circuit that combines input from the various sensory organs. Alternately, this apparent commonality might result from the larva's limited repertoire of motor outputs with which to implement a navigational response. Perhaps, independent circuits mediate the ‘decision’ portion of each navigational algorithm and only converge at the motor output level (<xref ref-type="bibr" rid="bib17">Frye and Dickinson, 2004</xref>).</p><p>We sought a computational model that could describe the transformation from sensory input to navigational decisions for uni- and multi-modal stimuli and that could differentiate between shared and parallel navigational circuits. The Linear-Nonlinear-Poisson (LNP) model (<xref ref-type="bibr" rid="bib9">Chichilnisky, 2001</xref>; <xref ref-type="bibr" rid="bib13">Dayan, 2001</xref>; <xref ref-type="bibr" rid="bib50">Ringach and Shapley, 2004</xref>; <xref ref-type="bibr" rid="bib5">Bialek and van Steveninck, 2005</xref>; <xref ref-type="bibr" rid="bib55">Schwartz et al., 2006</xref>; <xref ref-type="bibr" rid="bib28">Kim et al., 2011</xref>) is widely used to relate time-varying input to stochastic output. In this model, decisions (e.g., to initiate a turn, <xref ref-type="fig" rid="fig1">Figure 1A,B</xref>) are generated according to a Poisson process whose underlying rate at time <italic>t</italic> is:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>∗</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>∗</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>S</italic>(<italic>t</italic>) is the input signal, <italic>A</italic> is a linear filter, and <italic>f</italic> is a static nonlinear function (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Thus for uni-modal inputs, we aimed to develop models of the form:<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>odor</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>light</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf1"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>O</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf2"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the outputs of the linear filters for odor and for light, respectively. For multi-modal input, we sought either a model in which turns are initiated independently by separate circuits<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>O</mml:mi><mml:mo>−</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>independent pathways</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>or one in which odor and light information are combined more generally<disp-formula id="equ5"><mml:math id="m5"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>O</mml:mi><mml:mo>−</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>nonlinear integration</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.06229.003</object-id><label>Figure 1.</label><caption><title>Identifying computations underlying the decision to initiate a turn.</title><p>(<bold>A</bold>) Computation: on the basis of sensory input (light or odor in this work) the larva decides whether or not to end a run and begin a turn. (<bold>B</bold>) LNP model of the computation: Sensory input is processed by a linear filter to produce an intermediate signal. The rate at which the larva initiates turns is a nonlinear function of this signal. Turns are initiated stochastically according to a Poisson process with this underlying turn rate. (<bold>C</bold>) Reverse-correlation to determine LNP parameters: (<bold>1</bold>) We presented groups of larvae with either blue or red light with randomly varying intensity derivatives. Blue light provided a visual stimulus, while red light activated CsChrimson expressed in sensory neurons. In multi-sensory experiments, uncorrelated red light and blue light signals were presented simultaneously. Larvae were observed under infrared illumination, and their behaviors were analyzed with machine vision software. (<bold>2</bold>) We calculated the ‘turn-triggered average’ (TTA) or the reverse-correlation between turn initiation and stimulus by averaging the stimulus that preceded each moment any larva initiated a turn. The TTA approximates the convolution kernel for the linear response of the LNP model. (<bold>3</bold>) Using the TTA as a convolution kernel and the known input signal, we computed the intermediate filtered signal. (<bold>4</bold>) Using the inferred filtered signal and the observed times at which turns were initiated, we found the nonlinear rate function by dividing the distribution of filtered signal values at the time of turn initiation (‘turn-triggered-ensemble’) by the distribution of all filtered signal values. Illustrations adapted from (<xref ref-type="bibr" rid="bib24">Kane et al., 2013</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.003">http://dx.doi.org/10.7554/eLife.06229.003</ext-link></p></caption><graphic xlink:href="elife-06229-fig1-v2.tif"/></fig></p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Reverse-correlation with visual and fictive olfactory stimuli</title><p>We began by exploring larvae's responses to uni-modal stimuli. <italic>Drosophila</italic> larvae avoid light and carbon dioxide and are attracted to Ethyl Acetate (EtAc). The sensory input pathways are well-characterized for each of these stimuli. The larva's navigational response to light is mediated primarily by four photoreceptor neurons in each of two primitive eye-spots (<xref ref-type="bibr" rid="bib21">Hassan et al., 2005</xref>; <xref ref-type="bibr" rid="bib58">Sprecher and Desplan, 2008</xref>; <xref ref-type="bibr" rid="bib26">Keene et al., 2011</xref>; <xref ref-type="bibr" rid="bib27">Keene and Sprecher, 2012</xref>; <xref ref-type="bibr" rid="bib24">Kane et al., 2013</xref>). A single pair of Gr21a expressing receptor neurons mediates the larva's CO<sub>2</sub> response (<xref ref-type="bibr" rid="bib48">Python and Stocker, 2002</xref>; <xref ref-type="bibr" rid="bib15">Faucher, 2006</xref>; <xref ref-type="bibr" rid="bib23">Jones et al., 2007</xref>; <xref ref-type="bibr" rid="bib35">Kwon et al., 2007</xref>). Or42a and Or42b are the primary EtAc olfactory receptors (<xref ref-type="bibr" rid="bib33">Kreher et al., 2005</xref>, <xref ref-type="bibr" rid="bib34">2008</xref>; <xref ref-type="bibr" rid="bib3">Asahina et al., 2009</xref>), and larvae are capable of decoding odor gradients on the basis of only Or42a or Or42b receptor neurons (<xref ref-type="bibr" rid="bib38">Louis et al., 2008</xref>; <xref ref-type="bibr" rid="bib3">Asahina et al., 2009</xref>).</p><p>Larvae initiate turns in response to increasing light intensities (<xref ref-type="bibr" rid="bib53">Sawin et al., 1994</xref>; <xref ref-type="bibr" rid="bib21">Hassan et al., 2005</xref>; <xref ref-type="bibr" rid="bib54">Scantlebury et al., 2007</xref>; <xref ref-type="bibr" rid="bib24">Kane et al., 2013</xref>) and carbon dioxide concentrations (<xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>) and decreasing EtAc concentrations (<xref ref-type="bibr" rid="bib20">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>). To investigate the larva's decision to turn in response to visual cues, we presented 448 nm blue light to wild-type larvae. To probe olfactory computations, we expressed <italic>UAS-CsChrimson</italic> (<xref ref-type="bibr" rid="bib29">Klapoetke et al., 2014</xref>), a red light activable cation channel, in Gr21a, Or42a, and Or42b receptor neuron pairs. We used 655 nm red light (outside the sensitive range of the larva's visual pigments [<xref ref-type="bibr" rid="bib52">Salcedo et al., 1999</xref>]) to activate these neurons while presenting a constant dim blue light background (<xref ref-type="bibr" rid="bib29">Klapoetke et al., 2014</xref>) to mask any visual response to the red light.</p><p>We presented groups of larvae with fluctuating levels of red or blue light and analyzed their resulting behaviors using machine vision software (<xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>) to identify each navigational decision (<xref ref-type="fig" rid="fig1">Figure 1C-1</xref>). We determined the parameters of the LNP model by measuring the reverse-correlation (<xref ref-type="bibr" rid="bib9">Chichilnisky, 2001</xref>; <xref ref-type="bibr" rid="bib13">Dayan, 2001</xref>; <xref ref-type="bibr" rid="bib62">Westwick et al., 2003</xref>; <xref ref-type="bibr" rid="bib50">Ringach and Shapley, 2004</xref>; <xref ref-type="bibr" rid="bib5">Bialek and van Steveninck, 2005</xref>; <xref ref-type="bibr" rid="bib55">Schwartz et al., 2006</xref>; <xref ref-type="bibr" rid="bib28">Kim et al., 2011</xref>; <xref ref-type="bibr" rid="bib30">Klein et al., 2014</xref>, <xref ref-type="bibr" rid="bib63">Theobald et al., 2010</xref>) between the stimulus and evoked behaviors (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, <xref ref-type="other" rid="media1">Video 1</xref>).<media content-type="glencoe play-in-place height-250 width-310" id="media1" mime-subtype="mp4" mimetype="video" xlink:href="elife-06229-media1.mp4"><object-id pub-id-type="doi">10.7554/eLife.06229.015</object-id><label>Video 1.</label><caption><title>Calculating the turn-triggered average.</title><p><bold>Left panel:</bold> annotated video image of individual larva. Thin white line: larva's path (past and future). Gold dots: markers along midline of animal, used to determine posture. Upper left corner: time (since experiment start) and behavioral state. <bold>Right panels:</bold> top: light derivative (AU) vs. time; current time is indicated by dashed cyan line. Middle panels: speed and body bend angle, metrics used to determine behavioral state, vs. time. Shading indicates behavioral state (blue = run, white = turn; within turns, red = rejected head sweep, green = accepted head sweep). Current time is indicated by cyan dot. Bottom panel: turn-triggered average light (TTA) intensity derivative (AU), calculated based on turns preceding the one shown. <bold>Animation:</bold> The time preceding and following individual turns is featured. At the moment a larva initiates a turn, we ‘grab’ the sequence of light intensity derivatives and add it to a running average (shown at the bottom). As we include more turns in the average (number of included turns is indicated by ‘turn #’ above the left panel—note logarithmic spacing of turn #s), we build up a ‘TTA’ that approximates the linear filter in the LNP model.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.015">http://dx.doi.org/10.7554/eLife.06229.015</ext-link></p></caption></media></p><p>For light, odor, and carbon dioxide, the derivative of stimulus intensity is more salient to larvae than the stimulus value itself (<xref ref-type="bibr" rid="bib20">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>; <xref ref-type="bibr" rid="bib24">Kane et al., 2013</xref>; <xref ref-type="bibr" rid="bib19">Gomez-Marin and Louis, 2014</xref>). Typically in reverse-correlation experiments, rapidly changing uncorrelated stimulus intensities are provided (e.g. by choosing random binary values, random normally distributed values, or values from an M-sequence). Because of regression to the mean, these sequences have derivatives that are anticorrelated on time scales longer than the update period. Thus, if we provided uncorrelated stimulus intensities and larvae turned in response to an increase in light, we would expect an average decrease in light after turns. This would complicate analyses of decisions, like whether to accept or reject a head sweep, the larva makes following a turn. We therefore chose a stimulus optimized for analysis of the larva's response to derivatives, a Brownian random walk, whose derivatives (on all time scales) are independent identically distributed Gaussian variables.</p></sec><sec id="s2-2"><title>Computations underlying the decision to turn in response to visual or olfactory stimuli</title><p>First, we computed the turn-triggered average (TTA) of the light intensity derivatives (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). We found: wild-type larvae turn in response to an increase in blue light but were unresponsive to red light masked by dim blue light (even when fed all-trans-retinal); larvae expressing CsChrimson in EtAc sensing neurons (<italic>Or42a</italic>&gt;<italic>CsChrimson</italic>, <italic>Or42b</italic>&gt;<italic>CsChrimson</italic>) turned in response to a <italic>decrease</italic> in red light; and larvae expressing CsChrimson in the CO<sub>2</sub> receptor (<italic>Gr21a</italic>&gt;<italic>CsChrimson</italic>) turned in response to an <italic>increase</italic> in red light. These results match the larva's strategies for navigating static gradients of natural stimuli; turning in response to increases in light, decreases in EtAc, and increases in CO<sub>2</sub>. In all cases (excepting the wild-type red-light control), larvae considered changes over the previous ∼2.5 s when deciding to turn, and derivatives were maximally salient about 0.6–0.8 s before a turn was actually initiated.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.06229.004</object-id><label>Figure 2.</label><caption><title>Unimodal reverse-correlation experiments.</title><p>Top row, Berlin wild-type larvae were stimulated with blue (<italic>λ</italic><sub><italic>peak</italic></sub> = 448 nm; max intensity = 74 μW/cm<sup>2</sup>) light. All other rows, larvae of indicated genotype were stimulated with red light (<italic>λ</italic><sub><italic>peak</italic></sub> = 655 nm; max intensity = 911 μW/cm<sup>2</sup>) while constant dim blue light (intensity = 3.7 μW/cm<sup>2</sup>) served as a visual mask. Column <bold>A</bold>: Turn triggered average. Average stimulus preceding (and following) each turn initiation. Turns are initiated at time 0 (indicated with dashed line). The black line is the smoothed TTA used as the linear filter. Column <bold>B</bold>: Measured turn rates as a function of calculated filter output. Line and shaded region represent mean turn rate and standard error due to counting statistics. Black line is the nonlinear turn rate modeled as a ratio-of-Gaussians (<xref ref-type="bibr" rid="bib47">Pillow and Simoncelli, 2006</xref>). Column <bold>C</bold>: Step responses predicted by LNP model. Square waves of light with period 20 s and duty cycle 50% were presented to larvae. The LNP model was used to predict the resulting turn rates. Top graphs: light level vs time in cycle. A favorable change happens at t = 0 and an unfavorable change at t = 10 s. Bottom graphs: measured and predicted turn rates vs time in cycle. Black line and shaded region represent mean turn rate and standard error due to counting statistics. The cyan line is the exact prediction of the model using the parameters found from the corresponding reverse-correlation experiments. (<bold>A</bold>, <bold>B</bold>) The stimulus and analysis were cyclic, so the time range from −2 to 0 s is identical to that from 18–20 s. Column <bold>D</bold>: Size-sorted turn-triggered average. As in <bold>A</bold>, but turns were sorted into large (heading change during turn &gt; rms heading change) and small turns. Displayed averages are lowpassed with a Gaussian filter (<italic>σ</italic> = 0.5 s) to clarify the long time-scale features. Column <bold>E</bold>: Head-sweep triggered average (for first head-sweep of turn). Average stimulus surrounding accepted (teal) and rejected (red) head-sweeps. Head sweeps were initiated at time t = 0 and concluded at a variable time in the future. The mean head-sweep duration (1.25 s) is indicated by the shaded region. See <xref ref-type="table" rid="tbl1">Table 1</xref> for number of experiments, animals, and so on.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.004">http://dx.doi.org/10.7554/eLife.06229.004</ext-link></p></caption><graphic xlink:href="elife-06229-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06229.005</object-id><label>Figure 2—figure supplement 1.</label><caption><title>LNP model parameters are stable for duration of 20 min experiments.</title><p>Experiments of <xref ref-type="fig" rid="fig2">Figure 2</xref> analyzed separately using data only from the first 10 min of experiment (teal) or only from the second 10 min of experiment (purple) or from entire 20 min data set (black). Column <bold>A</bold>: Turn triggered average. As in <xref ref-type="fig" rid="fig2">Figure 2A</xref>. The same convolution kernel is recovered from all three data sets. Column <bold>B</bold>: Measured turn-rates as a function of calculated filter output. As in <xref ref-type="fig" rid="fig2">Figure 2B</xref>. The turn rates vary across the three data sets mainly at high values of the filter output (stimulus conditions most likely to lead to turning). Column <bold>C</bold>: LNP model fits can predict response to white noise signals. Data from the first 10 min of the experiments were used to find LNP model parameters. The parameterized models were then used to predict the turn rate at each time point during the second 10 min of experiments. The measured turn rate during the second 10 min is plotted as a function of the model predictions. At high turn rates, for visual and fictive attractive odor stimuli, the turn rate is lower in the final 10 min than predicted by fits to the first 10 min, suggesting modest adaptation. For fictive CO<sub>2</sub>, the measured turn rate is higher than predicted, suggesting modest sensitization. Error bars represent the uncertainty due to counting statistics.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.005">http://dx.doi.org/10.7554/eLife.06229.005</ext-link></p></caption><graphic xlink:href="elife-06229-fig2-figsupp1-v2.tif"/></fig></fig-group></p><p>For each set of reverse-correlation experiments, we used the TTA as the convolution kernel to calculate the linear filter outputs and computed the turn rate as a nonlinear function of the filter output (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). To test the predictive power of the LNP model, we presented larvae with light intensity square waves. We compared the resulting turn rates to those predicted by our LNP model fits (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). The cyan lines in <xref ref-type="fig" rid="fig2">Figure 2C</xref> show the exact predictions of the model, with no free parameters. We found that in all cases, except for <italic>Gr21a</italic>&gt;<italic>CsChrimson</italic>, the step response has a longer duration than predicted by the LNP model, and there is an unpredicted sustained decrease in turn rate following a favorable change (at t = 0), but given the inherent variability of behavior and the simplicity of the LNP model, the reverse-correlation experiments predicted the temporal course of the larva's response to step changes surprisingly well.</p><p>We were concerned that over the course of the 20 min behavioral experiments, continuous exposure to red light might exhaust the ability of CsChrimson to excite neural activity or that larvae might adapt to the stimulus presentation and cease responding. To test whether this was the case, we separately analyzed the first and second 10 min of the experiments (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). In all cases, we recovered the same TTA (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>) using data from only the first 10 min, only the second 10 min, or the entire data set. We found that for visual and attractive odor inputs, the slope of the nonlinear function was steeper (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>) in the first 10 min than in the second 10, indicating larvae were slightly less responsive to stimulus changes in the latter half of the experiments. For fictive CO<sub>2</sub>, on the other hand, we found that larvae were actually more responsive in the second 10 min, representing sensitization rather than adaptation. In all cases, the results for the two halves of the experiments were similar enough to justify using all 20 min of data in our analyses. To test the self-consistency of our model, we used the parameters extracted from the first 10 min of experiments to predict the larva's turning rate in the second 10 min (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>). We found excellent agreement between predictions and measurements at lower turn rates. At higher turn rates, we found that in the second 10 min, larvae turned less than predicted for light and attractive odor cues and more than predicted for CO<sub>2</sub> cues, again reflecting modest adaptation and sensitization.</p></sec><sec id="s2-3"><title>Computations determining turn size and turn direction</title><p>Next, we explored how larvae bias the size and directions of turns. Larvae make larger turns when subjected to unfavorably changing conditions (<xref ref-type="bibr" rid="bib40">Luo et al., 2010</xref>; <xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>; <xref ref-type="bibr" rid="bib24">Kane et al., 2013</xref>), so we calculated the TTA for large and small turns separately (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). For approximately 10–15 s prior to the start of large turns, there was an average gradual increase in blue light levels for visual experiments, and an average gradual decrease in red light levels for <italic>Or42a&gt;CsChrimson</italic> and <italic>Or42b</italic>&gt;<italic>CsChrimson</italic> experiments. Over the same time period, for small turns, there was a slight average decrease in blue light and increase in red light. Interestingly, immediately prior to the initiation of a turn, the average change in stimulus was the same for large and small turns. Thus, larvae consider the change in light intensity and attractive odor concentration over the previous 10–15 s when deciding the size of their turns, but the size of the stimulus change that leads the larva to actually initiate a turn appears not to influence turn size. In contrast, for <italic>Gr21a</italic>&gt;<italic>CsChrimson</italic> larvae, the size of a turn was determined by the magnitude of the increase immediately preceding a turn.</p><p>After initiating turns, larvae use head-sweeps as probes to find a favorable direction for the next run (<xref ref-type="bibr" rid="bib40">Luo et al., 2010</xref>; <xref ref-type="bibr" rid="bib20">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>; <xref ref-type="bibr" rid="bib24">Kane et al., 2013</xref>; <xref ref-type="bibr" rid="bib19">Gomez-Marin and Louis, 2014</xref>; <xref ref-type="bibr" rid="bib30">Klein et al., 2014</xref>). Head-sweeps in favorable directions are more likely to be accepted, beginning a new run in that direction. Head-sweeps in unfavorable directions are more likely to be rejected, resulting in one or more additional head-sweeps. To characterize the larva's decision to accept or reject a head-sweep, we measured the head-sweep triggered average, aligned to the start of a head-sweep, separately for rejected and accepted head-sweeps (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). All head-sweep triggered averages show a large change immediately before the start of the head-sweep; this is the stimulus change that triggered the larva's decision to turn. We found that during accepted head-sweeps, average blue light levels and Gr21a activity decreased and Or42a and Or42b activity increased, all favorable changes. During rejected head-sweeps, the reverse was true: average blue light and Gr21a activity levels increased and Or42a and Or42b activity decreased. Surprisingly, for <italic>Gr21a</italic>&gt;<italic>CsChrimson</italic> larvae, larger increases in activity prior to the head-sweep start led to an increased probability of rejecting the head-sweep.</p><p>Our uni-modal experiments showed that CsChrimson induced activity in olfactory neurons evokes navigational behaviors and that reverse correlation can be used to identify both visual and olfactory computations. We also found that activity in CO<sub>2</sub> receptor neurons is interpreted according to different rules than for light or attractive odors.</p></sec><sec id="s2-4"><title>Odor-light integration—computations underlying the decision to turn</title><p>We next asked how the larva integrates visual and olfactory information when making navigational decisions. We carried out reverse-correlation experiments with simultaneous uncorrelated light and attractive odor stimuli, using dim blue light to activate the visual system and intense red light to activate CsChrimson expressed in <italic>Or42a</italic> receptor neurons. We found the TTA for both signals (<xref ref-type="fig" rid="fig3">Figure 3A</xref>), and we applied the resulting filters to our input signals to find <italic>x</italic><sub><italic>O</italic></sub>(<italic>t</italic>) and <italic>x</italic><sub><italic>L</italic></sub>(<italic>t</italic>), the outputs of the linear odor and light filters, at each point in time. We scaled the filters so that <italic>x</italic><sub><italic>O</italic></sub>(<italic>t</italic>) and <italic>x</italic><sub><italic>L</italic></sub>(<italic>t</italic>) had unit variance in the stimulus ensemble (<xref ref-type="bibr" rid="bib47">Pillow and Simoncelli, 2006</xref>). To determine whether the larva's turning decisions result from independent olfactory and visual pathways, we examined the statistics of the <italic>turn-triggered ensemble</italic> (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). In our white noise experiments, <italic>x</italic><sub><italic>O</italic></sub>(<italic>t</italic>) and <italic>x</italic><sub><italic>L</italic></sub>(<italic>t</italic>) are independent Gaussian variables with mean 0, so it can be shown (<xref ref-type="bibr" rid="bib5">Bialek and van Steveninck, 2005</xref>)<disp-formula id="equ6"><mml:math id="m6"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>O</mml:mi><mml:mo>−</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mo>∂</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.06229.006</object-id><label>Figure 3.</label><caption><title>Multi-modal reverse-correlation experiments suggest attractive odor and light signals are combined linearly and early.</title><p><italic>Or42a</italic>&gt;<italic>CsChrimson</italic> larvae were presented with independently varying Brownian light intensities. Reverse-correlation analysis was carried out as in <xref ref-type="fig" rid="fig1">Figure 1</xref>. (<bold>A</bold>) TTA. Average change in red (fictive odor) and blue light intensities preceding turns. (<bold>B</bold>) Turn triggered ensemble. Top: 2D density histogram of calculated odor and light filter outputs at initiation of each turn. Bottom: 1D density histograms of filter outputs (<italic>x</italic><sub><italic>O</italic></sub>,<italic>x</italic><sub><italic>L</italic></sub>) and their linear combinations (<italic>u,v</italic>). D<sub>KL</sub>(P(<italic>x</italic>|turn)||P(<italic>x</italic>)) is the Kullback-Leibler divergence from the turn-triggered distribution to the distribution of x at all times. Larger values indicate that <italic>x</italic> carries more information about the decision to turn. (<bold>C</bold>, <bold>D</bold>) Predicted turn triggered ensemble according to, (<bold>C</bold>) independent pathways model and (<bold>D</bold>) early linear combination model. Top panel: predicted density. Bottom panel: difference between predicted density and measured density. D<sub>KL</sub>(data||model) is the Kullback-Leibler divergence of the model from the data; smaller values indicate a better match. ***** = P (Independent pathways model)/P (Early linear combination model) &lt; 0.00001; Aikake Information Criterion Test. (<bold>E</bold>) Coordinate rotation described in text and used in bottom panel of <bold>B</bold>. Orthogonal coordinates (<italic>u,v</italic>) are rotated 33° relative to (<italic>x</italic><sub><italic>O</italic></sub>,<italic>x</italic><sub><italic>L</italic></sub>). Rotation is shown overlaid on turn-triggered probability density (<bold>B</bold>). See <xref ref-type="table" rid="tbl1">Table 1</xref> for number of experiments, animals, and so on.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.006">http://dx.doi.org/10.7554/eLife.06229.006</ext-link></p></caption><graphic xlink:href="elife-06229-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06229.007</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Graphical explanation of the independent pathways model.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.007">http://dx.doi.org/10.7554/eLife.06229.007</ext-link></p></caption><graphic xlink:href="elife-06229-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06229.008</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Graphical explanation of the early linear combination model.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.008">http://dx.doi.org/10.7554/eLife.06229.008</ext-link></p></caption><graphic xlink:href="elife-06229-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06229.009</object-id><label>Figure 3—figure supplement 3.</label><caption><title>Visual and fictive olfactory stimuli do not cross-talk.</title><p>Larvae were presented with same red and blue Brownian light stimuli as in <xref ref-type="fig" rid="fig3">Figure 3</xref>. TTA of red and blue stimuli are shown on same axes as in <xref ref-type="fig" rid="fig3">Figure 3A</xref>. (<bold>A</bold>) Reproduced from <xref ref-type="fig" rid="fig3">Figure 3A</xref>: Larvae expressing CsChrimson in Or42a receptor neurons turn in response to increasing blue light and decreasing red light (fictive odor). (<bold>B</bold>) Genetically blinded larvae expressing CsChrimson in Or42a receptor neurons turn in response to decreasing red light (fictive odor) but are unresponsive to blue light. (<bold>C</bold>) Wild-type larvae not expressing CsChrimson turn in response to increasing blue light but are unresponsive to red light. See <xref ref-type="table" rid="tbl1">Table 1</xref> for number of experiments, animals, and so on.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.009">http://dx.doi.org/10.7554/eLife.06229.009</ext-link></p></caption><graphic xlink:href="elife-06229-fig3-figsupp3-v2.tif"/></fig></fig-group></p><p>In general, this value will be nonzero, but in the independent pathways model (<xref ref-type="fig" rid="fig3">Figure 3C</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>), the mixed partial derivative is identically 0, so<disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>independent pathways</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In fact, we found <inline-formula><mml:math id="inf3"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mo>=</mml:mo><mml:mn>0.23</mml:mn></mml:mrow></mml:math></inline-formula>, disfavoring the independent pathways hypothesis.</p><p>If larvae integrate odor and light information when making turning decisions, what form does this integration take? A potentially favorable (<xref ref-type="bibr" rid="bib42">Ma et al., 2006</xref>; <xref ref-type="bibr" rid="bib2">Angelaki et al., 2009</xref>) approach would be for the larva to use a simple linear combination of uni-modal filter outputs as the basis for downstream multi-modal processing (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). In this case, the turn rate would be given by<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>O</mml:mi><mml:mo>−</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>sin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>early linear combination</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <italic>θ</italic> is a constant reflecting the relative importance of each filter output to the computation (<italic>θ</italic> = 0 would mean larvae respond only to odor and <italic>θ</italic> = 90° would mean larvae respond only to light).</p><p>We used both the independent pathways and early linear combination models to fit the turn-triggered probability density of (<italic>x</italic><sub><italic>O</italic></sub>, <italic>x</italic><sub><italic>L</italic></sub>) and found better agreement between the data and the early linear combination prediction (<xref ref-type="fig" rid="fig3">Figure 3D</xref>) than the independent pathways prediction (<xref ref-type="fig" rid="fig3">Figure 3C</xref>).</p><p>In the early linear combination model, the turn rate is a function of a 1-dimensional stimulus vector—<inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>sin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>—so a rotation of odor-light convolution space (<xref ref-type="fig" rid="fig3">Figure 3E</xref>)<disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>sin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mi>sin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo> </mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>should produce a single parameter, <italic>u</italic>, that carries as much information about turn decisions as the pair (<italic>x</italic><sub><italic>O</italic></sub>, <italic>x</italic><sub><italic>L</italic></sub>) together, and an orthogonal parameter, <italic>v</italic>, that carries no information at all. The Kullback-Leibler divergence between the stimulus and turn-triggered distributions describes the amount of information stimulus parameters carry about the decision to initiate a turn (<xref ref-type="bibr" rid="bib47">Pillow and Simoncelli, 2006</xref>); we calculated this divergence for the pair (<italic>x</italic><sub><italic>O</italic></sub>, <italic>x</italic><sub><italic>L</italic></sub>) and for <italic>x</italic><sub><italic>O</italic></sub>, <italic>x</italic><sub><italic>L</italic></sub>, <italic>u</italic>, and <italic>v</italic> individually (<xref ref-type="fig" rid="fig3">Figure 3B</xref>) and found that <italic>u</italic> alone is nearly as informative as both <italic>x</italic><sub><italic>O</italic></sub> and <italic>x</italic><sub><italic>L</italic></sub> and that <italic>v</italic> contributes very little to the decision to turn, further supporting the early linear combination model.</p><p>Can the observed summation of visual and odor inputs be explained by blue light activation of the CsChrimson channel? To probe for cross-talk between visual and olfactory channels, we repeated the multi-sensory experiments (again presenting both red and blue stimuli simultaneously) using genetically blinded larvae expressing CsChrimson in Or42a neurons and using wild-type larvae not expressing CsChrimson (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). Blind larvae responded only to red light (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3B</xref>) while larvae not expressing CsChrimson responded only to blue light (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3C</xref>).</p><p>To further compare the independent pathways and early linear combination models, we measured larvae's responses to simultaneous step changes in <italic>Or42a</italic> receptor neuron activity and blue light (<xref ref-type="fig" rid="fig4">Figure 4</xref>). We presented larvae with all possible combinations of favorable, neutral, and unfavorable steps of red light (fictive odor) and blue light (visual cue). We used the kernels calculated from the reverse-correlation experiments and fit the nonlinear functions parameterizing the early linear combination and independent pathways model to the observed turn rates. We found that despite having fewer free fit parameters, the early linear combination model (magenta line, <xref ref-type="fig" rid="fig4">Figure 4</xref>) better predicted the response to conflicting and aligned multi-sensory input than the independent pathways model (cyan line, <xref ref-type="fig" rid="fig4">Figure 4</xref>).<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.06229.010</object-id><label>Figure 4.</label><caption><title>Multi-modal step responses support early linear combination of odor and light signals.</title><p>Turn rates vs time for <italic>Or42a</italic>&gt;<italic>CsChrimson</italic> larvae responding to coordinated increases and decreases of red and blue light. All steps occur at t = 0. Left column: no change in fictive odor, center column: red light increases at t = 0 right column: red light decreases at t = 0. Top row: no change in visual stimulus, center row: blue light increases at t = 0, bottom row: blue light decreases at t = 0. For instance, in panel iii blue light increased at time 0, while red light remained constant; in iv, both red and blue light increased at time 0; and in v, blue light increased and red light decreased at time 0. Black line and shaded region represent mean turn rate and standard error due to counting statistics. Cyan line is the best-fit (maximum likelihood estimate, 6 parameter fit) prediction of the independent pathways model. Magenta line is the best-fit (maximum likelihood estimate, 4 parameter fit) prediction of the early linear combination model. Note that the time axis is the same for each subplot, but the turn rate axis varies. ***** = P (Independent pathways model)/P (Early linear combination model) &lt; 0.00001; Aikake Information Criterion Test, measured for the entire data set. See <xref ref-type="table" rid="tbl1">Table 1</xref> for number of experiments, animals, and so on.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.010">http://dx.doi.org/10.7554/eLife.06229.010</ext-link></p></caption><graphic xlink:href="elife-06229-fig4-v2.tif"/></fig></p><p>For changes in only light or only odor, larvae increase their turn rates significantly more for unfavorable changes (panels ii and iii) than they decrease their turning in response to favorable changes (i and vi). Thus the independent pathways model, which sums separate rates for light and odor changes, predicts that in response to conflicting favorable and unfavorable changes (iv and viii), the larvae will still significantly increase their turning. Instead, conflicting changes in odor and light cancel each other out, as predicted by the early linear combination model. That larvae turn in response to increases in blue light (iii, v) but decreases in red light (ii, v) further confirms that the two light sources are activating different sensory pathways. For instance, if blue light were primarily activating CsChrimson, we would expect that decreasing blue and red light together (viii) would provoke more turning than decreasing red light alone (ii), but in fact <italic>increasing</italic> blue light while <italic>decreasing</italic> red light (v) provokes the largest increase in turning.</p></sec><sec id="s2-5"><title>Odor-light integration—computations underlying turn size and turn direction</title><p>We wondered whether the larva might use the same linear combination of light and odor signals to make other navigational decisions, like whether to accept or reject head-sweeps. Although we previously determined a maximally informative combination of <italic>filtered</italic> odor and light inputs, the convolution kernels have similar shapes, so we might reasonably use the same rules to combine the raw input stimuli.<disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>sin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mi>sin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo> </mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>/</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>;</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>/</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo> </mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf5"><mml:mrow><mml:mo> </mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf6"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> are the normalization factors required to make the convolution kernels have unit variance, and <italic>θ</italic> was determined as a parameter of the early linear combination model (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). We carried out reverse-correlation analysis on these rotated coordinates. We found: the turn triggered average of <italic>ν</italic>(<italic>t</italic>) was nearly 0 (<xref ref-type="fig" rid="fig5">Figure 5A</xref>); the size-sorted TTA of <italic>ν</italic>(<italic>t</italic>) was nearly 0 and the same for both small and large turns (<xref ref-type="fig" rid="fig5">Figure 5B</xref>); and the head-sweep triggered average of <italic>ν</italic>(<italic>t</italic>) was nearly 0 and the same for accepted and rejected head-sweeps (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). Thus, larvae used a single linear combination of odor and light—<italic>μ</italic>(<italic>t</italic>)—to determine whether to turn, how large of a turn to make, and whether to reject or accept head-sweeps, strongly suggesting odor and light inputs are combined at early stages of the navigational circuitry.<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.06229.011</object-id><label>Figure 5.</label><caption><title>All navigational decisions appear to be based on a single linear combination of odor and light inputs.</title><p>(<bold>A</bold>–<bold>C</bold>) Reverse correlation in rotated coordinate system. <italic>μ</italic>,<italic>ν</italic> are linear combinations of the raw input stimuli according to the same scaling as used to combine filtered odor and light signals in <xref ref-type="fig" rid="fig3">Figure 3</xref>. (<bold>A</bold>) Turn-triggered averages. Average change in <italic>μ</italic>,<italic>ν</italic> prior to start of a turn. (<bold>B</bold>) Size-sorted turn-triggered averages. Displayed averages are lowpassed with a Gaussian filter (<italic>σ</italic> = 0.5 s) to clarify the long time-scale features. (<bold>C</bold>) Head-sweep-triggered average (for first head-sweep of turn). Shaded region indicates mean head-sweep duration (1.25 s).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.011">http://dx.doi.org/10.7554/eLife.06229.011</ext-link></p></caption><graphic xlink:href="elife-06229-fig5-v2.tif"/></fig></p></sec><sec id="s2-6"><title>Odor-light integration—probing for shifts in attention</title><p>Finally, we asked whether the larva might shift its attention between stimulus inputs. For instance, if a larva initiates a turn due to an increase in light, might it prioritize light changes over odor changes in deciding whether or not to accept the turn's first head-sweep? To test this, we re-examined the head-sweep acceptances and rejections from the multi-stimulus white noise experiments, sorting them based on the favorability of light and odor changes preceding the turn start (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). For instance, in quadrant II, larvae turned following a recent favorable odor change and unfavorable light change. If an unfavorable light change caused otherwise neutral larvae to attend more strongly to light, we would expect that following a quadrant II turn, larvae would be more attentive to light changes than average. Alternately, if some larvae in the population were already attending to light more strongly than odor, we would expect them to be over-represented in the group of larvae turning in response to unfavorable changes in light coupled with favorable changes in odor. Thus, we would again expect that following a quadrant II turn, larvae would be attending more strongly to light than in the average population. Similarly, following quadrant IV turns, we would expect larvae to be attending more strongly to odor.<fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.06229.012</object-id><label>Figure 6.</label><caption><title>Probing for attentional shifts during multi-modal noise experiments.</title><p>(<bold>A</bold>) Turn-triggered ensemble (duplicated from <xref ref-type="fig" rid="fig3">Figure 3B</xref>), with quadrants highlighted. Color scale the same as in 3B. Quadrants I–IV indicate which stimulus or stimuli likely provoked the larva to turn (I—both odor and light stimulated turning; II—light, but not odor, stimulated turning; III—neither odor nor light were changing unfavorably; IV—odor, but not light, stimulated turning). Each turn was assigned to one of these quadrants based on the filtered signal values (<italic>x</italic><sub><italic>O</italic></sub>,<italic>x</italic><sub><italic>L</italic></sub>) at the time the turn started. (<bold>B</bold>, <bold>C</bold>) Difference in intensity changes during accepted and rejected head sweeps (first head-sweep of turn only). Difference in mean rate of change in intensity over mean head sweep duration (1.25 s, shaded region in 5C) between rejected and accepted head-sweeps. Error bars are ±1 s.e.m. (<bold>B</bold>) Changes in odor and light intensities. (<bold>C</bold>) Changes in rotated coordinate system. See <xref ref-type="table" rid="tbl1">Table 1</xref> for number of experiments, animals, and so on.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.012">http://dx.doi.org/10.7554/eLife.06229.012</ext-link></p></caption><graphic xlink:href="elife-06229-fig6-v2.tif"/></fig></p><p>To measure the importance of light and odor changes during head sweeps, we subtracted the average derivative of light level during accepted head sweeps from the average derivative of light level during rejected head sweeps (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). Regardless of which stimulus likely triggered the decision to turn, for both light and odor, we found the same differences between accepted and rejected head-sweeps. Thus, we found no evidence that the larva modulated the relative importance of light or odor changes when deciding whether to accept or reject a head-sweep. Indeed, for all combinations of light and odor changes preceding a turn, the same linear combination of odor and light inputs appeared to be equally salient in deciding whether to accept or reject a head-sweep (<xref ref-type="fig" rid="fig6">Figure 6C</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>A key step in ‘cracking’ neural circuits is defining the computations carried out by those circuits (<xref ref-type="bibr" rid="bib45">Olsen and Wilson, 2008</xref>; <xref ref-type="bibr" rid="bib11">Clark et al., 2013</xref>). Recent work has refined the measurements of circuits' behavioral outputs, for example, from simply counting animals accumulating near an odor source (<xref ref-type="bibr" rid="bib44">Monte et al., 1989</xref>) to specifying the sequence of motor outputs that allow odor gradient ascent (<xref ref-type="bibr" rid="bib20">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>; <xref ref-type="bibr" rid="bib19">Gomez-Marin and Louis, 2014</xref>). Here, we carried on this refinement, quantifying the transformation from sensory activity to motor decision with sub-second temporal resolution. Our reverse-correlation analysis captured the essential features of the larva's navigational decision making, including the time scales and stimulus features associated with various decisions (<xref ref-type="fig" rid="fig2">Figure 2</xref>).</p><p>Our results are consistent with the understanding of how larvae navigate natural environments previously developed by observing behavior in structured environments of light or gaseous odors. For instance, when placed in environments with spatially varying Ethyl Butyrate (<xref ref-type="bibr" rid="bib20">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib19">Gomez-Marin and Louis, 2014</xref>) or Ethyl Acetate (<xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>) concentrations, larvae initiate turns more frequently when headed in directions of decreasing concentrations of these attractive odors. In this work, we showed that larvae initiate turns in response to a decrease in activity in Or42a or Or42b receptor neurons, the primary receptors for Ethyl Acetate and Ethyl Butyrate. Additionally, we showed that larvae mainly use only the previous two seconds of receptor activity to decide whether to turn (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). This detail cannot be resolved from experiments in natural odor gradients, nor can the fact that larvae integrate changes in odor receptor activity over a much longer time period to decide the size of their turns (<xref ref-type="fig" rid="fig2">Figure 2D</xref>).</p><p>When larvae move their heads through a spatially heterogeneous environment, they generate changes in sensory input that could be used to decode local spatial gradients. It has been directly shown that warming a cold larva during a head-sweep causes the larva to accept that head-sweep, beginning a new run (<xref ref-type="bibr" rid="bib40">Luo et al., 2010</xref>). For light and odor, a strong circumstantial case has been made that larvae use information gathered during head-sweeps to bias turn direction: the first head-sweep of a turn is unbiased (<xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>; <xref ref-type="bibr" rid="bib24">Kane et al., 2013</xref>) but larvae are more likely to begin a run following a sweep in a direction of higher concentration of attractive odor, lower concentration of carbon dioxide, or lower luminosity (<xref ref-type="bibr" rid="bib20">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>; <xref ref-type="bibr" rid="bib24">Kane et al., 2013</xref>; <xref ref-type="bibr" rid="bib19">Gomez-Marin and Louis, 2014</xref>) and larvae with only a single functional odor receptor can still bias turn direction via head-sweeping (<xref ref-type="bibr" rid="bib19">Gomez-Marin and Louis, 2014</xref>). In this work, we directly show that larvae do in fact use changes in odor receptor activity and light level measured during head-sweeps to determine whether to begin a new run or initiate a second head-sweep (<xref ref-type="fig" rid="fig2">Figure 2E</xref>).</p><p>Our experiments with a single stimulus also found a previously unknown difference in how larvae use CO<sub>2</sub> receptor activity to modulate turn size and head-sweep acceptance compared to visual stimuli and to attractive olfactory receptor activity (<xref ref-type="fig" rid="fig2">Figure 2D,E</xref>). This could be related to a difference in how larvae modulate their forward motion in response to changes in CO<sub>2</sub> concentration compared to changes in light intensity or EtAc concentration. We previously measured larvae's responses to linear temporal ramps of light intensity (<xref ref-type="bibr" rid="bib24">Kane et al., 2013</xref>), and EtAc and CO<sub>2</sub> concentrations (<xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>). For light and EtAc, larvae changed their rate of turning and the size of their turns in response to changing environmental conditions, but when they were actually engaged in forward movement, their speed of progress was the same whether conditions were improving or declining. In contrast, larvae dramatically decreased their forward run speed in response to increases in the concentration of CO<sub>2</sub>. Larvae with non-functional CO<sub>2</sub> receptors did not change their speed at all in response to CO<sub>2</sub>, so this modulation was due to a sensory-motor transformation and not to metabolic effects.</p><p>Larvae move forward through a series of tail to head peristaltic waves of muscle contraction (<xref ref-type="bibr" rid="bib36">Lahiri et al., 2011</xref>; <xref ref-type="bibr" rid="bib22">Heckscher et al., 2012</xref>) and modulate their forward speed by changing the frequency with which they initiate these waves (<xref ref-type="bibr" rid="bib22">Heckscher et al., 2012</xref>). The observed CO<sub>2</sub> dependent speed modulation might therefore reflect the presence of a pathway by which Gr21a receptor neuron activity can down-regulate the probability of initiating forward peristaltic waves. In order to accept a head-sweep, that is, transition from head-sweeping to forward movement, larvae must initiate a new peristaltic wave (<xref ref-type="bibr" rid="bib36">Lahiri et al., 2011</xref>). If an increase in Gr21a activity decreases the probability of initiating such a wave, this would explain why an increase in Gr21a activity <italic>prior</italic> to head-sweep initiation results in an increased probability of head-sweep rejection (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). Similarly, an increase in Gr21a activity might bias the larva towards larger reorientations (<xref ref-type="fig" rid="fig2">Figure 2D</xref>) by decreasing the probability of quick, small course corrections.</p><p>In addition to defining the computations by which larvae navigate environments of varying light or varying odor, we also developed a quantitative model of odor-light integration. Previously, it has proven difficult to establish even a qualitative understanding of odor and light integration using static combinations of the two cues. Consider a simple experiment where a petri dish is divided into light and dark halves and a droplet of attractive odor is placed on the lighted half. If a larva moves towards the odor at the expense of moving out of darkness, is this because the larva naturally places more importance on odor than light regardless of intensity, because the particular concentrations of odor and intensities of light in the experiment favor a move towards odor, or because behavior is variable and larvae often make idiosyncratic choices? In our reverse-correlation experiments, we presented hundreds of larvae with thousands of combinations of light and odor variation and were thus able to resolve these ambiguities. We determined not just how larvae balance an overall attraction to odor and aversion to light, but how they combine transient odor and light signals to make individual navigational decisions.</p><sec id="s3-1"><title>Conclusion</title><p>Here, we demonstrated the power of reverse-correlation analysis of larvae's behavioral responses to white-noise visual and fictive olfactory stimuli to decode the computations underlying the <italic>Drosophila</italic> larva's navigation of natural environments. We showed that this analysis could be used to decode the rules by which the larva integrates signals from distinct sensory organs. Larvae appear to use a single linear combination of odor and light inputs to make all navigational decisions, suggesting these signals are combined at early stages of the navigational circuitry.</p><p>In this work, we used optogenetics to explore how <italic>perturbations in the activities</italic> of identified neurons are interpreted behaviorally. We expressed CsChrimson in specific neurons to relate patterns of activity in these neurons to decisions regulating the frequency, size, and direction of turns (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Using model parameters extracted from reverse-correlation experiments, we were able to predict how larvae would respond to novel perturbations of these neurons' activities (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). We explored how activity in one particular neuron type modulated the larva's responses to a natural light stimulus (<xref ref-type="fig" rid="fig3 fig5 fig6">Figures 3, 5, 6</xref>) and predicted how the larva's natural response to blue light steps (<xref ref-type="fig" rid="fig4">Figure 4-iii</xref>) would be altered by simultaneous perturbation of this neuron (<xref ref-type="fig" rid="fig4">Figure 4-iv,v</xref>). Here we addressed sensory neurons, but our approach can be used generally to identify computations carried out on activities of interneurons, to determine whether activity in a neuron is interpreted as attractive or aversive, to measure how that activity combines with other sources of information to produce decisions, and to find neurons most responsible for making navigational decisions (<xref ref-type="bibr" rid="bib32">Koulakov et al., 2005</xref>).</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Fly strains</title><p>The following strains were used: Canton-S and Berlin wild type (gift of Justin Blau), <italic>w</italic><sup><italic>1118</italic></sup>;;<italic>20XUAS-CsChrimson-mVenus</italic> (Bloomington Stock #55136, gift of Vivek Jayaraman and Julie Simpson, Janelia Research Campus), <italic>w*</italic>;;<italic>Gr21a-Gal4</italic> (Bloomington stock #23890), <italic>w*</italic>;;<italic>Or42a-Gal4</italic> (Bloomington stock #9969), <italic>w*</italic>;;<italic>Or42b-Gal4</italic> (Bloomington stock #9972), <italic>GMR-hid</italic>/<italic>CyO,P{sevRas1.V12}</italic> (Bloomington stock #5771).</p></sec><sec id="s4-2"><title>Crosses</title><p>40 virgin female <italic>UAS-CsChrimson</italic> flies were crossed with 20 males of the selected Gal4 line. F1 progeny of both sexes were used for experiments.</p></sec><sec id="s4-3"><title>Larva collection</title><p>Flies were placed in 60 mm embryo-collection cages (59–100, Genesee Scientific, San Diego, CA) and allowed to lay eggs for 3 hr at 25°C on enriched food media (‘Nutri-Fly German Food’, Genesee Scientific). For all experiments except the Berlin response to blue light (<xref ref-type="fig" rid="fig2">Figure 2</xref>, top row and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, top row), the food was supplemented with 0.1 mM all-trans-retinal (ATR, R2500, Sigma Aldrich, St. Louis, MO), and cages were kept in the dark during egg laying. When eggs were not being collected for experiments, flies were kept either on plain food or agar (neither containing ATR).</p><p>Petri dishes containing eggs and larvae were kept at 25°C (ATR+ plates were wrapped in foil) for 48–60 hr. Second instar larvae were separated from the food using 30% sucrose solution and washed in deionized water. Larval stage was verified by size and spiracle morphology. Preparations for experiments were carried out in a dark room, under dim red (for photo-taxis experiments) or blue (for CsChrimson experiments) illumination. Prior to beginning experiments, larvae were dark adapted on a clean 2.5% agar surface for a minimum of 10 min.</p></sec><sec id="s4-4"><title>Behavioral experiments</title><p>Approximately 30–50 larvae were transferred with a wet paintbrush to a 23 cm square dish (Corning BioAssay Dish #431111, Fisher Scientific, Pittsburgh, PA), containing 2.5% (wt/vol) bacteriological grade agar (Apex, cat#20-274, Genesee Scientific) and 0.75% (wt/vol) activated charcoal (DARCO G-60, Fisher Scientific). The charcoal darkened the agar and improved contrast in our dark-field imaging setup. The plate was placed in a darkened enclosure and larvae were observed under strobed 850 nm infrared illumination (ODL-300-850, Smart Vision Lights, Muskegon, MI) using a 14 fps 5 MP rolling shutter CMOS camera (Basler acA2500-14gm, Graftek Imaging, Austin, TX) in global-reset-release mode and an 18 mm c-mount lens (54-857, Edmund Optics, Barrington, NJ) equipped with an IR-pass filter (Hoya R-72, Edmund Optics). The experiments of <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3B</xref> were recorded using a 4 MP global shutter CMOS camera (Basler acA2040-90umNIR, Graftek Imaging) operating at 20 fps and a 35 mm focal length lens (Fujinon CF35HA-1, B&amp;H Photo, New York, NY). A microcontroller (Teensy++ 2.0, PJRC, Sherwood, OR) coordinated the infrared strobe and control of the stimulus light source, so stimulus presentation and images could be aligned to within the width of the strobe window (2–5 ms). Videos were recorded using custom software written in LABVIEW and analyzed using the MAGAT analyzer software package (<xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>). Further analysis was carried out using custom MATLAB scripts. <xref ref-type="table" rid="tbl1">Table 1</xref> gives the number of experiments, animals, turns, and head sweeps analyzed for each experimental condition. Software is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/GershowLab">https://github.com/GershowLab</ext-link>.<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.06229.013</object-id><label>Table 1.</label><caption><p>Numbers of experiments, animals, turns, and head sweeps for all figures</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.013">http://dx.doi.org/10.7554/eLife.06229.013</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Genotype</th><th>#expts</th><th>#animals</th><th>hours</th><th>#turns</th><th>rms turn size</th><th>#large turns</th><th>#small turns</th><th>#accepted head sweeps</th><th>#rejected head sweeps</th></tr></thead><tbody><tr><td colspan="10">Uni-modal reverse-correlation experiments (<xref ref-type="fig" rid="fig2">Figure 2A,B,D,E</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>)</td></tr><tr><td> Berlin</td><td>6</td><td>150</td><td>52.6</td><td>6594</td><td>76.4</td><td>2462</td><td>4132</td><td>4139</td><td>2455</td></tr><tr><td> Canton-S</td><td>7</td><td>334</td><td>117.7</td><td>8824</td><td>66.0</td><td>3086</td><td>5738</td><td>5570</td><td>3254</td></tr><tr><td> Or42a&gt;CsChrimson</td><td>5</td><td>180</td><td>61.1</td><td>6971</td><td>68.9</td><td>2531</td><td>4440</td><td>4122</td><td>2849</td></tr><tr><td> Or42b&gt;CsChrimson</td><td>6</td><td>246</td><td>64.4</td><td>9565</td><td>73.3</td><td>3480</td><td>6085</td><td>6215</td><td>3350</td></tr><tr><td> Gr21a&gt;CsChrimson</td><td>5</td><td>227</td><td>54.2</td><td>8760</td><td>75.1</td><td>3392</td><td>5368</td><td>5424</td><td>3336</td></tr><tr><td colspan="10">Uni-modal step experiments (<xref ref-type="fig" rid="fig2">Figure 2C</xref>)</td></tr><tr><td> Berlin</td><td>4</td><td>95</td><td>34.7</td><td>3674</td><td>–</td><td>–</td><td>–</td><td>–</td><td>–</td></tr><tr><td> Or42a&gt;CsChrimson</td><td>2</td><td>107</td><td>36.6</td><td>3905</td><td>–</td><td>–</td><td>–</td><td>–</td><td>–</td></tr><tr><td> Or42b&gt;CsChrimson</td><td>2</td><td>99</td><td>21.5</td><td>2599</td><td>–</td><td>–</td><td>–</td><td>–</td><td>–</td></tr><tr><td> Gr21a&gt;CsChrimson</td><td>2</td><td>111</td><td>22.1</td><td>2384</td><td>–</td><td>–</td><td>–</td><td>–</td><td>–</td></tr><tr><td colspan="10">Multi-modal reverse-correlation experiments (<xref ref-type="fig" rid="fig3 fig5 fig6">Figure 3, 5, 6</xref>, <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>)</td></tr><tr><td> Or42a&gt;CsChrimson</td><td>12</td><td>608</td><td>136</td><td>21,075</td><td>66.6</td><td>7225</td><td>13,850</td><td>12,795</td><td>8280</td></tr><tr><td>  quadrant I</td><td>–</td><td>–</td><td>–</td><td>10,363</td><td>–</td><td>–</td><td>–</td><td>6216</td><td>4147</td></tr><tr><td>  quadrant II</td><td>–</td><td>–</td><td>–</td><td>3301</td><td>–</td><td>–</td><td>–</td><td>2086</td><td>1215</td></tr><tr><td>  quadrant III</td><td>–</td><td>–</td><td>–</td><td>1684</td><td>–</td><td>–</td><td>–</td><td>1088</td><td>596</td></tr><tr><td>  quadrant IV</td><td>–</td><td>–</td><td>–</td><td>5727</td><td>–</td><td>–</td><td>–</td><td>3405</td><td>2322</td></tr><tr><td> GMR-Hid, Or42a&gt;CsChrimson</td><td>3</td><td>121</td><td>28.9</td><td>4842</td><td>–</td><td>–</td><td>–</td><td>–</td><td>–</td></tr><tr><td> Canton-S</td><td>3</td><td>166</td><td>39.9</td><td>3412</td><td>–</td><td>–</td><td>–</td><td>–</td><td>–</td></tr><tr><td colspan="10">Multi-modal step experiments (<xref ref-type="fig" rid="fig4">Figure 4</xref>)</td></tr><tr><td> Or42a&gt;CsChrimson</td><td>5</td><td>250</td><td>50</td><td>7859</td><td>–</td><td>–</td><td>–</td><td>–</td><td>–</td></tr></tbody></table><table-wrap-foot><fn><p>#expts: Number of 20 min experiments. For reverse-correlation experiments, each experiment presented a different stimulus sequence with the same statistical properties; for step experiments, the same stimulus pattern was presented in each experiment.</p></fn><fn><p>#animals: Approximate number of animals, taken by finding the maximum number of animals tracked in a 30-s window during each experiment.</p></fn><fn><p>#hours: total observation time in units of larva-hours. Observing 3 larvae for 20 min each would equal 1 larva-hour.</p></fn><fn><p>#turns: total number of turns observed and used in analysis.</p></fn><fn><p>rms turn size: root mean square turn size in degrees (defined as angular difference in run heading immediately before and after a turn) for the set of experiments.</p></fn><fn><p>#large/small turns: number of turns with angular changes larger/smaller than the rms turn size.</p></fn><fn><p>#accepted head sweeps: number of times the first head sweep of a turn was accepted, ending in a new run.</p></fn><fn><p>#rejected head sweeps: number of times the first head sweep of a turn was rejected, leading to another head sweep.</p></fn></table-wrap-foot></table-wrap><table-wrap id="tbl2" position="float"><object-id pub-id-type="doi">10.7554/eLife.06229.014</object-id><label>Table 2.</label><caption><p>Kullback-Leibler divergences for <xref ref-type="fig" rid="fig3">Figure 3</xref></p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06229.014">http://dx.doi.org/10.7554/eLife.06229.014</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>KL divergence</th><th>k-NN</th><th>model data as normally distributed</th><th>Szegö-PSD method</th></tr></thead><tbody><tr><td><xref ref-type="fig" rid="fig3">Figure 3B</xref>: <inline-formula><mml:math id="inf12"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>0.351</td><td>0.325</td><td>–</td></tr><tr><td><xref ref-type="fig" rid="fig3">Figure 3B</xref>: <inline-formula><mml:math id="inf13"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>0.236</td><td>0.223</td><td>0.235</td></tr><tr><td><xref ref-type="fig" rid="fig3">Figure 3B</xref>: <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>0.103</td><td>0.100</td><td>0.104</td></tr><tr><td><xref ref-type="fig" rid="fig3">Figure 3B</xref>: <inline-formula><mml:math id="inf15"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mtext>|</mml:mtext><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>0.334</td><td>0.324</td><td>0.333</td></tr><tr><td><xref ref-type="fig" rid="fig3">Figure 3B</xref>: <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mtext>|</mml:mtext><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>0.006</td><td>0.0002</td><td>0.003</td></tr><tr><td><xref ref-type="fig" rid="fig3">Figure 3C</xref>: <inline-formula><mml:math id="inf17"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>0.062</td><td>0.035</td><td>–</td></tr><tr><td><xref ref-type="fig" rid="fig3">Figure 3D</xref>: <inline-formula><mml:math id="inf18"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>0.030</td><td>0.007</td><td>–</td></tr></tbody></table><table-wrap-foot><fn><p>KL divergence: the divergence to be calculated. k-NN: divergence calculated using the k-nearest neighbors algorithm. This value is displayed in <xref ref-type="fig" rid="fig3">Figure 3</xref>. model data as normal distributed: the distributions are modeled as Gaussians, whose divergence is calculated analytically. Szegö-PSD method: divergence between 1D distributions calculated by an alternate method.</p></fn></table-wrap-foot></table-wrap></p></sec><sec id="s4-5"><title>Stimulus light source</title><p>We built a custom circuit board (Advanced Circuits, Colorado) containing 66 deep red high brightness LEDs (Philips Lumileds, LXM3-PD01, 655 nm central wavelength) and 12 royal blue high brightness LEDs (LXML-PR01-0500, 447.5 nm central wavelength) evenly distributed over ∼25 cm × 25 cm. The LEDs were driven at constant current by a switch-mode LED driver circuit (based on LT3518, linear technology) operating at a switching frequency of 2 MHz. The on-current was set by interchangeable feedback resistors and could be modulated separately for red and blue LEDs. The intensity of the red and blue LEDs was controlled separately by pulse-width-modulation. Illumination was provided from above the larvae; the LED circuit board was at the same height as the recording camera (∼50 cm above the behavioral arena).</p><p>For multi-sensory experiments, the maximum red light intensity (911 μW/cm<sup>2</sup>) was 300 times greater than the maximum blue light intensity (3 μW/cm<sup>2</sup>). CsChrimson is slightly more sensitive to 655 nm than 448 nm light, so the blue light signal perturbed olfactory receptor neuron activity by less than 0.3% of the red-light signal's perturbation.</p><p>We calibrated the optical power of the LEDs using a photodiode power meter (S121C, Thorlabs, New Jersey) set to the central wavelength of the LEDs. We measured the uniformity of the stimulus light sources by imaging a Lambertian projector screen (Dalite 41466, Cousin's Video, Ohio) placed in the plane of the experimental arena under stimulus LED illumination.</p></sec><sec id="s4-6"><title>Stimulus sequences</title><p>Stimulus protocols were generated with MATLAB and stored on an SD card for use by the microcontroller. Light intensity was modulated using pulse-width-modulation with a frequency of ∼112 Hz (constrained to update exactly 8 eight times per camera frame).</p></sec><sec id="s4-7"><title>Brownian light intensity</title><p>We chose a Brownian random walk, whose derivatives on all time scales are independent identically distributed Gaussian variables, to analyze the larva's response to derivatives of stimulus intensity. Light levels were specified by values between 0 (off) and 255 (maximum intensity). Sequences of light levels corresponding to a random walk with reflecting boundary conditions were generated according to these rules:<disp-formula id="equ11"><mml:math id="m11"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>127</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ12"><mml:math id="m12"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ13"><mml:math id="m13"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>510</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>255</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ14"><mml:math id="m14"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>N</italic>(0,<italic>σ</italic>) was a Gaussian random variable with mean 0 and variance <italic>σ</italic><sup>2</sup>. For the experiments described in this work <italic>σ</italic> = 3. At an update rate of 112 Hz, this represents a diffusion constant of 504 (light levels)<sup>2</sup>/s. After the sequence of light levels was generated, the levels were rounded to the nearest integer value before being transferred to the microcontroller for use in experiments. Sequences were not reused within an experimental group but might be reused between groups. For multi-modal experiments, independent sequences were used for each stimulus.</p></sec><sec id="s4-8"><title>Step responses</title><p>For step response experiments of <xref ref-type="fig" rid="fig2">Figure 2C</xref>, a square wave with a period of 20 s and duty cycle 50% (10 s high, 10 low) was presented. The low and high intensities were symmetrically distributed about the mean light intensity of the reverse-correlation experiments.</p><p>For the coordinated step response experiments of <xref ref-type="fig" rid="fig4">Figure 4</xref>, we presented steps of red and blue light intensity. Every 10 s, each signal either increased from low to high, decreased from high to low, or remained constant. The sequence of steps was chosen so that all combinations (except for both levels remaining constant) were presented. For each stimulus, the low and high intensities were symmetrically distributed about the mean light intensity of the reverse-correlation experiments.</p></sec><sec id="s4-9"><title>Data analysis</title><p>As described previously (<xref ref-type="bibr" rid="bib18">Gershow et al., 2012</xref>; <xref ref-type="bibr" rid="bib24">Kane et al., 2013</xref>), videos of behaving larvae were recorded using LabView software into a compressed image format (mmf) that discards the stationary background. These videos were processed using computer vision software (written in C++ using the openCV library) to find the position and posture (head, tail, midpoint, and midline) of each larva and to assemble these into tracks, each following the movement of a single larva through time. These tracks were analyzed by Matlab software to identify behaviors, especially runs, turns, and head sweeps.</p><p>The sequence of light intensities presented to the larvae was stored with the video recordings and used for reverse-correlation analysis.</p></sec><sec id="s4-10"><title>Reverse correlation analysis</title><sec id="s4-10-1"><title>Turn-triggered averages</title><p>Turn-triggered averages (<xref ref-type="fig" rid="fig2 fig3 fig5">Figures 2A, 3A, 5A</xref>) with a bin size of 0.1 s were computed by averaging stimulus values at the corresponding times relative to the start of a turn; for example, the TTA at −1 s represents the average value of the derivative of the light intensity at all times that were between −0.95 and −1.05 s before the initiation of a turn. The TTA at +1 s represents the same average for times 0.95 to 1.05 s after the initiation of a turn. We computed the TTA at positive times as a control—we expected the average to be nearly 0 at positive times because behavior is causal (decisions contain no information about the future stimulus). Due to the reflecting boundary conditions, on long time scales, derivatives of the stimulus were anti-correlated; thus the TTA is not exactly 0 at positive times.</p></sec><sec id="s4-10-2"><title>Convolution kernels</title><p>We smoothed the TTA by fitting it to the impulse response of a third order linear system used to describe the calcium dynamics of <italic>Caenorhabditis elegans</italic> olfactory neurons (<xref ref-type="bibr" rid="bib25">Kato et al., 2014</xref>). This fit was used only to smooth the TTA; we do not ascribe any biological significance to the fit parameters. The smoothed kernel is shown as a black line in <xref ref-type="fig" rid="fig2">Figure 2A</xref>.</p></sec><sec id="s4-10-3"><title>Filtered stimulus</title><p>We used the smoothed TTA as a convolution kernel to find the output of the linear filter stage of the LNP model. We scaled the kernel so that the variance of the filtered signal over the entire stimulus history was 1. For the Canton-S red light experiments (<xref ref-type="fig" rid="fig2">Figure 2</xref>, second row), a kernel could not be recovered from the TTA, so the kernel for Gr21a&gt;CsChrimson was used to calculate the turn-rate.</p></sec><sec id="s4-10-4"><title>Nonlinear turn rates</title><p>(<xref ref-type="fig" rid="fig2">Figure 2B</xref>) The turn rate <italic>r</italic>(<italic>x</italic><sub><italic>f</italic></sub>) and standard error <italic>σ</italic><sub><italic>r</italic></sub>(<italic>x</italic><sub><italic>f</italic></sub>) as a function of filtered signal value (<italic>x</italic><sub><italic>f</italic></sub>) were computed by<disp-formula id="equ15"><mml:math id="m15"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>∗</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ16"><mml:math id="m16"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>∗</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><italic>N</italic><sub><italic>turn</italic></sub> is the number of turns observed with the filtered signal within the histogram bin (size = 0.25) containing <italic>x</italic><sub><italic>f</italic></sub> and <italic>N</italic><sub><italic>all</italic></sub> is the total number of data points where the filtered signal was in the histogram bin and larvae were in runs and thus capable of initiating turns, and ∆<italic>t</italic> was the sampling period (1/14 s).</p><p>By construction, the stimulus ensemble is Gaussian distributed with mean 0 and variance 1. If the turn-triggered ensemble is also Gaussian distributed, then the turn rate is given by a ratio-of-Gaussians (<xref ref-type="bibr" rid="bib47">Pillow and Simoncelli, 2006</xref>)<disp-formula id="equ17"><mml:math id="m17"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>;</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:mfrac><mml:mo>;</mml:mo><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mtext>|</mml:mtext><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>T is the total time the larvae were in runs and therefore able to initiate turns. r<sub><italic>ROG</italic></sub>(<italic>x</italic>) is plotted in <xref ref-type="fig" rid="fig2">Figure 2B</xref> as a black line. This rate function was used for the predictions in <xref ref-type="fig" rid="fig2">Figure 2C</xref> (cyan lines), with <inline-formula><mml:math id="inf7"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> calculated directly from the turn-triggered ensemble.</p></sec><sec id="s4-10-5"><title>Size-sorted TTAs</title><p>Size-sorted TTAs (<xref ref-type="fig" rid="fig2 fig5">Figures 2D, 5B</xref>) were computed in the same manner, but the analysis was conducted separately for turns where the resulting heading change (difference in headings between end of the previous and beginning of the next runs) was larger or smaller than the rms heading change for the population over the course of the experiments. The turn-size is determined by the size of the initial head-sweep of the turn and by decisions made after turn-initiation (at positive times), so we did not expect the size-sorted TTA to be identically 0 at positive times.</p></sec><sec id="s4-10-6"><title>Head sweep triggered averages</title><p>(<xref ref-type="fig" rid="fig2 fig5">Figures 2E, 5C</xref>) As for the TTA, but the reference time (0) was chosen as the beginning of either rejected or accepted head sweeps. Because the decision to accept or reject a head sweep is made after the beginning of the head sweep, we expected that the average would be nonzero at positive times corresponding to the duration of a head sweep. To simplify interpretation of the resulting averages, we considered only the first head sweep of each turn.</p></sec></sec><sec id="s4-11"><title>Maximum-likelihood estimation of turn-rate parameters</title><p>In <xref ref-type="fig" rid="fig3 fig4">Figures 3, 4</xref>, we fit the nonlinear turn rate to the observed data using the ratio-of-Gaussians function with <inline-formula><mml:math id="inf8"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> as fit parameters. The probability of observing at least one turn in an interval ∆<italic>t</italic> given an underlying turn rate <italic>r</italic> is 1 − <italic>e</italic><sup>−<italic>r</italic>∆<italic>t</italic></sup>; in the limit of short ∆<italic>t</italic>, this reduces to <italic>r</italic>∆<italic>t</italic>. The probability of not observing a turn is <italic>e</italic><sup>−<italic>r</italic>∆<italic>t</italic></sup>. Therefore given a model of the turn rate, the probability of observing a particular experimental outcome is given by<disp-formula id="equ18"><mml:math id="m18"><mml:mrow><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="italic">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mo> </mml:mo><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>x</italic> is the filtered signal, <italic>r</italic>(<italic>x</italic>) is the turn rate predicted by the model, and ∆<italic>t</italic> is the sampling rate. <inline-formula><mml:math id="inf9"><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mo> </mml:mo><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:munder></mml:mrow></mml:math></inline-formula> is the sum over all points when larvae were in runs and thus capable of initiating turns. We used the MATLAB function fmincon to find the parameters that maximized this log-likelihood.</p><p>For <xref ref-type="fig" rid="fig3 fig4">Figures 3C, 4</xref> (cyan line), the separate pathways model rate function was given by<disp-formula id="equ19"><mml:math id="m19"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>O</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>O</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>O</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with fit parameters <inline-formula><mml:math id="inf10"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>r</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>r</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>For <xref ref-type="fig" rid="fig3 fig4">Figures 3D, 4</xref> (magenta line), the early linear combination model rate function was given by<disp-formula id="equ20"><mml:math id="m20"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>;</mml:mo><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>sin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with fit parameters <inline-formula><mml:math id="inf11"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-12"><title>Kullback-Leibler divergence</title><p>We estimated the KL divergences in <xref ref-type="fig" rid="fig3">Figure 3</xref> using the k-nearest neighbors algorithm (<xref ref-type="bibr" rid="bib61">Wang et al., 2009</xref>) as implemented in MATLAB by (<xref ref-type="bibr" rid="bib60">Szabó, 2014</xref>). As a check, for <xref ref-type="fig" rid="fig3">Figure 3B</xref>, we also analytically computed the KL divergence between Gaussian distributions with the same means and (co-)variances as the sampled turn-triggered and stimulus ensembles (<xref ref-type="bibr" rid="bib47">Pillow and Simoncelli, 2006</xref>), and for <xref ref-type="fig" rid="fig3">Figure 3C,D</xref>, we numerically calculated the KL divergence between the model predictions and a multivariate Gaussian with the same mean and covariance as the measured turn-triggered density. For the univariate distributions of 3B, we also estimated the divergence using an alternate method based on Szegö's theorem (<xref ref-type="bibr" rid="bib49">Ramırez et al., 2009</xref>) as implemented by (<xref ref-type="bibr" rid="bib60">Szabó, 2014</xref>). These estimates are shown in <xref ref-type="table" rid="tbl2">Table 2</xref>. None of the conclusions of this paper depend on the method of estimation used.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank S Nathasha Egodage and Ruben Contreras for assistance with experiments, and Damon Clark, Katherine Nagel, and Andrew Leifer for valuable comments on the manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>RG, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>MMS, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>NMB, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con4"><p>MK, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con5"><p>MG, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albrecht</surname><given-names>DR</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year>2011</year><article-title>High-content behavioral analysis of <italic>Caenorhabditis elegans</italic> in precise spatiotemporal chemical environments</article-title><source>Nature Methods</source><volume>8</volume><fpage>599</fpage><lpage>605</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1630</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angelaki</surname><given-names>DE</given-names></name><name><surname>Gu</surname><given-names>Y</given-names></name><name><surname>DeAngelis</surname><given-names>GC</given-names></name></person-group><year>2009</year><article-title>Multisensory integration: psychophysics, neurophysiology, and computation</article-title><source>Current Opinion in Neurobiology</source><volume>19</volume><fpage>452</fpage><lpage>458</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2009.06.008</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Asahina</surname><given-names>K</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name><name><surname>Piccinotti</surname><given-names>S</given-names></name><name><surname>Vosshall</surname><given-names>LB</given-names></name></person-group><year>2009</year><article-title>A circuit supporting concentration-invariant odor perception in <italic>Drosophila</italic></article-title><source>Journal of Biology</source><volume>8</volume><fpage>9</fpage><pub-id pub-id-type="doi">10.1186/jbiol108</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>HC</given-names></name><name><surname>Brown</surname><given-names>DA</given-names></name></person-group><year>1972</year><article-title>Chemotaxis in <italic>Escherichia coli</italic> analysed by three-dimensional tracking</article-title><source>Nature</source><volume>239</volume><fpage>500</fpage><lpage>504</lpage><pub-id pub-id-type="doi">10.1038/239500a0</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>van Steveninck</surname><given-names>RR</given-names></name></person-group><year>2005</year><article-title>Features and dimensions: motion estimation in fly vision</article-title><source>arXiv preprint q-bio/0505003</source></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bretscher</surname><given-names>AJ</given-names></name><name><surname>Kodama-Namba</surname><given-names>E</given-names></name><name><surname>Busch</surname><given-names>KE</given-names></name><name><surname>Murphy</surname><given-names>RJ</given-names></name><name><surname>Soltesz</surname><given-names>Z</given-names></name><name><surname>Laurent</surname><given-names>P</given-names></name><name><surname>de Bono</surname><given-names>M</given-names></name></person-group><year>2011</year><article-title>Temperature, oxygen, and salt-sensing neurons in <italic>C. elegans</italic> are carbon dioxide sensors that control avoidance behavior</article-title><source>Neuron</source><volume>69</volume><fpage>1099</fpage><lpage>1113</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.02.023</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Busch</surname><given-names>KE</given-names></name><name><surname>Laurent</surname><given-names>P</given-names></name><name><surname>Soltesz</surname><given-names>Z</given-names></name><name><surname>Murphy</surname><given-names>RJ</given-names></name><name><surname>Faivre</surname><given-names>O</given-names></name><name><surname>Hedwig</surname><given-names>B</given-names></name><name><surname>Thomas</surname><given-names>M</given-names></name><name><surname>Smith</surname><given-names>HL</given-names></name><name><surname>de Bono</surname><given-names>M</given-names></name></person-group><year>2012</year><article-title>Tonic signaling from O2 sensors sets neural circuit activity and behavioral state</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>581</fpage><lpage>591</lpage><pub-id pub-id-type="doi">10.1038/nn.3061</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Busto</surname><given-names>M</given-names></name><name><surname>Iyengar</surname><given-names>B</given-names></name><name><surname>Campos</surname><given-names>AR</given-names></name></person-group><year>1999</year><article-title>Genetic dissection of behavior: modulation of locomotion by light in the <italic>Drosophila melanogaster</italic> larva requires genetically distinct visual system functions</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>3337</fpage><lpage>3344</lpage></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></person-group><year>2001</year><article-title>A simple white noise analysis of neuronal light responses</article-title><source>Network-Computation in Neural Systems</source><volume>12</volume><fpage>199</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.1080/713663221</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chronis</surname><given-names>N</given-names></name><name><surname>Zimmer</surname><given-names>M</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year>2007</year><article-title>Microfluidics for in vivo imaging of neuronal and behavioral activity in <italic>Caenorhabditis elegans</italic></article-title><source>Nature Methods</source><volume>4</volume><fpage>727</fpage><lpage>731</lpage><pub-id pub-id-type="doi">10.1038/nmeth1075</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>DA</given-names></name><name><surname>Freifeld</surname><given-names>L</given-names></name><name><surname>Clandinin</surname><given-names>TR</given-names></name></person-group><year>2013</year><article-title>Mapping and cracking sensorimotor circuits in genetic model organisms</article-title><source>Neuron</source><volume>78</volume><fpage>583</fpage><lpage>595</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.05.006</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>DA</given-names></name><name><surname>Gabel</surname><given-names>CV</given-names></name><name><surname>Gabel</surname><given-names>H</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year>2007</year><article-title>Temporal activity patterns in thermosensory neurons of freely moving <italic>Caenorhabditis elegans</italic> encode spatial thermal gradients</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>6083</fpage><lpage>6090</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1032-07.2007</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dayan</surname><given-names>P</given-names></name></person-group><year>2001</year><source>Theoretical neuroscience: computational and mathematical modeling of neural systems</source><publisher-loc>Cambridge</publisher-loc><publisher-name>Mass: Massachusetts Institute of Technology Press</publisher-name></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emonet</surname><given-names>T</given-names></name><name><surname>Cluzel</surname><given-names>P</given-names></name></person-group><year>2008</year><article-title>Relationship between cellular response and behavioral variability in bacterial chemotaxis</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>105</volume><fpage>3304</fpage><lpage>3309</lpage><pub-id pub-id-type="doi">10.1073/pnas.0705463105</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faucher</surname><given-names>C</given-names></name></person-group><year>2006</year><article-title>Behavioral responses of <italic>Drosophila</italic> to biogenic levels of carbon dioxide depend on life-stage, sex and olfactory context</article-title><source>The Journal of Experimental Biology</source><volume>209</volume><fpage>2739</fpage><lpage>2748</lpage><pub-id pub-id-type="doi">10.1242/jeb.02297</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fishilevich</surname><given-names>E</given-names></name><name><surname>Domingos</surname><given-names>AI</given-names></name><name><surname>Asahina</surname><given-names>K</given-names></name><name><surname>Naef</surname><given-names>F</given-names></name><name><surname>Vosshall</surname><given-names>LB</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year>2005</year><article-title>Chemotaxis behavior mediated by single larval olfactory neurons in <italic>Drosophila</italic></article-title><source>Current Biology</source><volume>15</volume><fpage>2086</fpage><lpage>2096</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2005.11.016</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frye</surname><given-names>MA</given-names></name><name><surname>Dickinson</surname><given-names>MH</given-names></name></person-group><year>2004</year><article-title>Motor output reflects the linear superposition of visual and olfactory inputs in <italic>Drosophila</italic></article-title><source>The Journal of Experimental Biology</source><volume>207</volume><fpage>123</fpage><lpage>131</lpage><pub-id pub-id-type="doi">10.1242/jeb.00725</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Berck</surname><given-names>M</given-names></name><name><surname>Mathew</surname><given-names>D</given-names></name><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>Kane</surname><given-names>EA</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year>2012</year><article-title>Controlling airborne cues to study small animal navigation</article-title><source>Nature Methods</source><volume>9</volume><fpage>290</fpage><lpage>296</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1853</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gomez-Marin</surname><given-names>A</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year>2014</year><article-title>Multilevel control of run orientation in <italic>Drosophila</italic> larval chemotaxis</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>8</volume><fpage>38</fpage><pub-id pub-id-type="doi">10.3389/fnbeh.2014.00038</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gomez-Marin</surname><given-names>A</given-names></name><name><surname>Stephens</surname><given-names>GJ</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year>2011</year><article-title>Active sampling and decision making in <italic>Drosophila</italic> chemotaxis</article-title><source>Nature Communications</source><volume>2</volume><fpage>441</fpage><pub-id pub-id-type="doi">10.1038/ncomms1455</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hassan</surname><given-names>J</given-names></name><name><surname>Iyengar</surname><given-names>B</given-names></name><name><surname>Scantlebury</surname><given-names>N</given-names></name><name><surname>Rodriguez Moncalvo</surname><given-names>V</given-names></name><name><surname>Campos</surname><given-names>AR</given-names></name></person-group><year>2005</year><article-title>Photic input pathways that mediate the <italic>Drosophila</italic> larval response to light and circadian rhythmicity are developmentally related but functionally distinct</article-title><source>The Journal of Comparative Neurology</source><volume>481</volume><fpage>266</fpage><lpage>275</lpage><pub-id pub-id-type="doi">10.1002/cne.20383</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heckscher</surname><given-names>ES</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name><name><surname>Doe</surname><given-names>CQ</given-names></name></person-group><year>2012</year><article-title>Characterization of <italic>Drosophila</italic> larval crawling at the level of organism, segment, and somatic body wall musculature</article-title><source>The Journal of Neuroscience</source><volume>32</volume><fpage>12460</fpage><lpage>12471</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0222-12.2012</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>WD</given-names></name><name><surname>Cayirlioglu</surname><given-names>P</given-names></name><name><surname>Grunwald Kadow</surname><given-names>I</given-names></name><name><surname>Vosshall</surname><given-names>LB</given-names></name></person-group><year>2007</year><article-title>Two chemosensory receptors together mediate carbon dioxide detection in <italic>Drosophila</italic></article-title><source>Nature</source><volume>445</volume><fpage>86</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1038/nature05466</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kane</surname><given-names>EA</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Afonso</surname><given-names>B</given-names></name><name><surname>Larderet</surname><given-names>I</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Carter</surname><given-names>AR</given-names></name><name><surname>de Bivort</surname><given-names>BL</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year>2013</year><article-title>Sensorimotor structure of <italic>Drosophila</italic> larva phototaxis</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>110</volume><fpage>E3868</fpage><lpage>E3877</lpage><pub-id pub-id-type="doi">10.1073/pnas.1215295110</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kato</surname><given-names>S</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Cho</surname><given-names>CE</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year>2014</year><article-title>Temporal responses of <italic>C. elegans</italic> chemosensory neurons are preserved in behavioral dynamics</article-title><source>Neuron</source><volume>81</volume><fpage>616</fpage><lpage>628</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.11.020</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keene</surname><given-names>AC</given-names></name><name><surname>Mazzoni</surname><given-names>EO</given-names></name><name><surname>Zhen</surname><given-names>J</given-names></name><name><surname>Younger</surname><given-names>MA</given-names></name><name><surname>Yamaguchi</surname><given-names>S</given-names></name><name><surname>Blau</surname><given-names>J</given-names></name><name><surname>Desplan</surname><given-names>C</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name></person-group><year>2011</year><article-title>Distinct visual pathways mediate <italic>Drosophila</italic> larval light avoidance and circadian clock entrainment</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>6527</fpage><lpage>6534</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.6165-10.2011</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keene</surname><given-names>AC</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name></person-group><year>2012</year><article-title>Seeing the light: photobehavior in fruit fly larvae</article-title><source>Trends in Neurosciences</source><volume>35</volume><fpage>104</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2011.11.003</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>AJ</given-names></name><name><surname>Lazar</surname><given-names>AA</given-names></name><name><surname>Slutskiy</surname><given-names>YB</given-names></name></person-group><year>2011</year><article-title>System identification of <italic>Drosophila</italic> olfactory sensory neurons</article-title><source>Journal of Computational Neuroscience</source><volume>30</volume><fpage>143</fpage><lpage>161</lpage><pub-id pub-id-type="doi">10.1007/s10827-010-0265-0</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klapoetke</surname><given-names>NC</given-names></name><name><surname>Murata</surname><given-names>Y</given-names></name><name><surname>Kim</surname><given-names>SS</given-names></name><name><surname>Pulver</surname><given-names>SR</given-names></name><name><surname>Birdsey-Benson</surname><given-names>A</given-names></name><name><surname>Cho</surname><given-names>YK</given-names></name><name><surname>Morimoto</surname><given-names>TK</given-names></name><name><surname>Chuong</surname><given-names>AS</given-names></name><name><surname>Carpenter</surname><given-names>EJ</given-names></name><name><surname>Tian</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Xie</surname><given-names>Y</given-names></name><name><surname>Yan</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Chow</surname><given-names>BY</given-names></name><name><surname>Surek</surname><given-names>B</given-names></name><name><surname>Melkonian</surname><given-names>M</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name><name><surname>Constantine-Paton</surname><given-names>M</given-names></name><name><surname>Wong</surname><given-names>GK</given-names></name><name><surname>Boyden</surname><given-names>ES</given-names></name></person-group><year>2014</year><article-title>Independent optical excitation of distinct neural populations</article-title><source>Nature Methods</source><volume>11</volume><fpage>338</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2836</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Afonso</surname><given-names>B</given-names></name><name><surname>Vonner</surname><given-names>AJ</given-names></name><name><surname>Hernandez-Nunez</surname><given-names>L</given-names></name><name><surname>Berck</surname><given-names>M</given-names></name><name><surname>Tabone</surname><given-names>CJ</given-names></name><name><surname>Kane</surname><given-names>EA</given-names></name><name><surname>Pieribone</surname><given-names>VA</given-names></name><name><surname>Nitabach</surname><given-names>MN</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Garrity</surname><given-names>PA</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year>2014</year><article-title>Sensory determinants of behavioral dynamics in <italic>Drosophila</italic> thermotaxis</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>112</volume><fpage>E220</fpage><lpage>E229</lpage><pub-id pub-id-type="doi">10.1073/pnas.1416212112</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korobkova</surname><given-names>E</given-names></name><name><surname>Emonet</surname><given-names>T</given-names></name><name><surname>Vilar</surname><given-names>JM</given-names></name><name><surname>Shimizu</surname><given-names>TS</given-names></name><name><surname>Cluzel</surname><given-names>P</given-names></name></person-group><year>2004</year><article-title>From molecular noise to behavioural variability in a single bacterium</article-title><source>Nature</source><volume>428</volume><fpage>574</fpage><lpage>578</lpage><pub-id pub-id-type="doi">10.1038/nature02404</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koulakov</surname><given-names>AA</given-names></name><name><surname>Rinberg</surname><given-names>DA</given-names></name><name><surname>Tsigankov</surname><given-names>DN</given-names></name></person-group><year>2005</year><article-title>How to find decision makers in neural networks</article-title><source>Biological Cybernetics</source><volume>93</volume><fpage>447</fpage><lpage>462</lpage><pub-id pub-id-type="doi">10.1007/s00422-005-0022-z</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kreher</surname><given-names>SA</given-names></name><name><surname>Kwon</surname><given-names>JY</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name></person-group><year>2005</year><article-title>The molecular basis of odor Coding in the <italic>Drosophila</italic> larva</article-title><source>Neuron</source><volume>46</volume><fpage>445</fpage><lpage>456</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.04.007</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kreher</surname><given-names>SA</given-names></name><name><surname>Mathew</surname><given-names>D</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name></person-group><year>2008</year><article-title>Translation of sensory input into behavioral output via an olfactory system</article-title><source>Neuron</source><volume>59</volume><fpage>110</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.06.010</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kwon</surname><given-names>JY</given-names></name><name><surname>Dahanukar</surname><given-names>A</given-names></name><name><surname>Weiss</surname><given-names>LA</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name></person-group><year>2007</year><article-title>The molecular basis of CO2 reception in <italic>Drosophila</italic></article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>104</volume><fpage>3574</fpage><lpage>3578</lpage><pub-id pub-id-type="doi">10.1073/pnas.0700079104</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lahiri</surname><given-names>S</given-names></name><name><surname>Shen</surname><given-names>K</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Tang</surname><given-names>A</given-names></name><name><surname>Kane</surname><given-names>E</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Garrity</surname><given-names>P</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year>2011</year><article-title>Two alternating motor programs drive navigation in <italic>Drosophila</italic> larva</article-title><source>PLOS ONE</source><volume>6</volume><fpage>e23180</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0023180</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year>2011</year><article-title>The computational worm: spatial orientation and its neuronal basis in <italic>C. elegans</italic></article-title><source>Current Opinion in Neurobiology</source><volume>21</volume><fpage>782</fpage><lpage>790</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.06.009</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louis</surname><given-names>M</given-names></name><name><surname>Huber</surname><given-names>T</given-names></name><name><surname>Benton</surname><given-names>R</given-names></name><name><surname>Sakmar</surname><given-names>TP</given-names></name><name><surname>Vosshall</surname><given-names>LB</given-names></name></person-group><year>2008</year><article-title>Bilateral olfactory sensory input enhances chemotaxis behavior</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>187</fpage><lpage>199</lpage><pub-id pub-id-type="doi">10.1038/nn2031</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>Gabel</surname><given-names>CV</given-names></name><name><surname>Ha</surname><given-names>HI</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year>2008</year><article-title>Olfactory behavior of swimming C-elegans analyzed by measuring motile responses to temporal variations of odorants</article-title><source>Journal of Neurophysiology</source><volume>99</volume><fpage>2617</fpage><lpage>2625</lpage><pub-id pub-id-type="doi">10.1152/jn.00053.2008</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Rosenzweig</surname><given-names>M</given-names></name><name><surname>Kang</surname><given-names>K</given-names></name><name><surname>Fang-Yen</surname><given-names>C</given-names></name><name><surname>Garrity</surname><given-names>PA</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year>2010</year><article-title>Navigational decision making in <italic>Drosophila</italic> thermotaxis</article-title><source>The Journal of Neuroscience</source><volume>30</volume><fpage>4261</fpage><lpage>4272</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4090-09.2010</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>Wen</surname><given-names>Q</given-names></name><name><surname>Ren</surname><given-names>J</given-names></name><name><surname>Hendricks</surname><given-names>M</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Qin</surname><given-names>Y</given-names></name><name><surname>Greenwood</surname><given-names>J</given-names></name><name><surname>Soucy</surname><given-names>ER</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Smith-Parker</surname><given-names>HK</given-names></name><name><surname>Calvo</surname><given-names>AC</given-names></name><name><surname>Colón-Ramos</surname><given-names>DA</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name></person-group><year>2014</year><article-title>Dynamic encoding of perception, memory, and movement in a <italic>C. elegans</italic> chemotaxis circuit</article-title><source>Neuron</source><volume>82</volume><fpage>1115</fpage><lpage>1128</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.05.010</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>WJ</given-names></name><name><surname>Beck</surname><given-names>JM</given-names></name><name><surname>Latham</surname><given-names>PE</given-names></name><name><surname>Pouget</surname><given-names>A</given-names></name></person-group><year>2006</year><article-title>Bayesian inference with probabilistic population codes</article-title><source>Nature Neuroscience</source><volume>9</volume><fpage>1432</fpage><lpage>1438</lpage><pub-id pub-id-type="doi">10.1038/nn1790</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>AC</given-names></name><name><surname>Thiele</surname><given-names>TR</given-names></name><name><surname>Faumont</surname><given-names>S</given-names></name><name><surname>Moravec</surname><given-names>ML</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year>2005</year><article-title>Step-response analysis of chemotaxis in <italic>Caenorhabditis elegans</italic></article-title><source>The Journal of Neuroscience</source><volume>25</volume><fpage>3369</fpage><lpage>3378</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5133-04.2005</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monte</surname><given-names>P</given-names></name><name><surname>Woodard</surname><given-names>C</given-names></name><name><surname>Ayer</surname><given-names>R</given-names></name><name><surname>Lilly</surname><given-names>M</given-names></name><name><surname>Sun</surname><given-names>H</given-names></name><name><surname>Carlson</surname><given-names>J</given-names></name></person-group><year>1989</year><article-title>Characterization of the larval olfactory response in <italic>Drosophila</italic> and its genetic basis</article-title><source>Behavior Genetics</source><volume>19</volume><fpage>267</fpage><lpage>283</lpage><pub-id pub-id-type="doi">10.1007/BF01065910</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olsen</surname><given-names>SR</given-names></name><name><surname>Wilson</surname><given-names>RI</given-names></name></person-group><year>2008</year><article-title>Cracking neural circuits in a tiny brain: new approaches for understanding the neural circuitry of <italic>Drosophila</italic></article-title><source>Trends in Neurosciences</source><volume>31</volume><fpage>512</fpage><lpage>520</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2008.07.006</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierce-Shimomura</surname><given-names>JT</given-names></name><name><surname>Morse</surname><given-names>TM</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year>1999</year><article-title>The fundamental role of pirouettes in <italic>Caenorhabditis elegans</italic> chemotaxis</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>9557</fpage><lpage>9569</lpage></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pillow</surname><given-names>JW</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name></person-group><year>2006</year><article-title>Dimensionality reduction in neural models: an information-theoretic generalization of spike-triggered average and covariance analysis</article-title><source>Journal of Vision</source><volume>6</volume><fpage>414</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1167/6.4.9</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Python</surname><given-names>FO</given-names></name><name><surname>Stocker</surname><given-names>RF</given-names></name></person-group><year>2002</year><article-title>Adult-like complexity of the larval antennal lobe of <italic>D. melanogaster</italic> despite markedly low numbers of odorant receptor neurons</article-title><source>The Journal of Comparative Neurology</source><volume>445</volume><fpage>374</fpage><lpage>387</lpage><pub-id pub-id-type="doi">10.1002/cne.10188</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramırez</surname><given-names>D</given-names></name><name><surname>Vıa</surname><given-names>J</given-names></name><name><surname>Santamarıa</surname><given-names>I</given-names></name><name><surname>Crespo</surname><given-names>P</given-names></name></person-group><year>2009</year><article-title>Entropy and Kullback-Leibler divergence estimation based on Szego's theorem</article-title></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ringach</surname><given-names>D</given-names></name><name><surname>Shapley</surname><given-names>R</given-names></name></person-group><year>2004</year><article-title>Reverse correlation in neurophysiology</article-title><source>Cognitive Science</source><volume>28</volume><fpage>147</fpage><lpage>166</lpage><pub-id pub-id-type="doi">10.1207/s15516709cog2802_2</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryu</surname><given-names>WS</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year>2002</year><article-title>Thermotaxis in <italic>Caenorhabditis elegans</italic> analyzed by measuring responses to defined thermal stimuli</article-title><source>The Journal of Neuroscience</source><volume>22</volume><fpage>5727</fpage><lpage>5733</lpage></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salcedo</surname><given-names>E</given-names></name><name><surname>Huber</surname><given-names>A</given-names></name><name><surname>Henrich</surname><given-names>S</given-names></name><name><surname>Chadwell</surname><given-names>LV</given-names></name><name><surname>Chou</surname><given-names>WH</given-names></name><name><surname>Paulsen</surname><given-names>R</given-names></name><name><surname>Britt</surname><given-names>SG</given-names></name></person-group><year>1999</year><article-title>Blue- and green-absorbing visual pigments of <italic>Drosophila</italic>: ectopic expression and physiological characterization of the R8 photoreceptor cell-specific Rh5 and Rh6 rhodopsins</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>10716</fpage><lpage>10726</lpage></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sawin</surname><given-names>FP</given-names></name><name><surname>Harris</surname><given-names>LR</given-names></name><name><surname>Campos</surname><given-names>AR</given-names></name><name><surname>Sokolowski</surname><given-names>MB</given-names></name></person-group><year>1994</year><article-title>Sensorimotor transformation from light reception to phototactic behavior in <italic>Drosophila</italic> larvae (Diptera, Drosophilidae)</article-title><source>Journal of Insect Behavior</source><volume>7</volume><fpage>553</fpage><lpage>567</lpage><pub-id pub-id-type="doi">10.1007/BF02025449</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scantlebury</surname><given-names>N</given-names></name><name><surname>Sajic</surname><given-names>R</given-names></name><name><surname>Campos</surname><given-names>AR</given-names></name></person-group><year>2007</year><article-title>Kinematic analysis of <italic>Drosophila</italic> larval locomotion in response to intermittent light pulses</article-title><source>Behavior Genetics</source><volume>37</volume><fpage>513</fpage><lpage>524</lpage><pub-id pub-id-type="doi">10.1007/s10519-007-9146-3</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartz</surname><given-names>O</given-names></name><name><surname>Pillow</surname><given-names>JW</given-names></name><name><surname>Rust</surname><given-names>NC</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name></person-group><year>2006</year><article-title>Spike-triggered neural characterization</article-title><source>Journal of Vision</source><volume>6</volume><fpage>484</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1167/6.4.13</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Segall</surname><given-names>JE</given-names></name><name><surname>Block</surname><given-names>SM</given-names></name><name><surname>Berg</surname><given-names>HC</given-names></name></person-group><year>1986</year><article-title>Temporal comparisons in bacterial chemotaxis</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>83</volume><fpage>8987</fpage><lpage>8991</lpage><pub-id pub-id-type="doi">10.1073/pnas.83.23.8987</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shimizu</surname><given-names>TS</given-names></name><name><surname>Tu</surname><given-names>Y</given-names></name><name><surname>Berg</surname><given-names>HC</given-names></name></person-group><year>2010</year><article-title>A modular gradient-sensing network for chemotaxis in <italic>Escherichia coli</italic> revealed by responses to time-varying stimuli</article-title><source>Molecular Systems Biology</source><volume>6</volume><fpage>382</fpage><pub-id pub-id-type="doi">10.1038/msb.2010.37</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sprecher</surname><given-names>SG</given-names></name><name><surname>Desplan</surname><given-names>C</given-names></name></person-group><year>2008</year><article-title>Switch of rhodopsin expression in terminally differentiated <italic>Drosophila</italic> sensory neurons</article-title><source>Nature</source><volume>454</volume><fpage>533</fpage><lpage>537</lpage><pub-id pub-id-type="doi">10.1038/nature07062</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suzuki</surname><given-names>H</given-names></name><name><surname>Thiele</surname><given-names>TR</given-names></name><name><surname>Faumont</surname><given-names>S</given-names></name><name><surname>Ezcurra</surname><given-names>M</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name><name><surname>Schafer</surname><given-names>WR</given-names></name></person-group><year>2008</year><article-title>Functional asymmetry in <italic>Caenorhabditis elegans</italic> taste neurons and its computational role in chemotaxis</article-title><source>Nature</source><volume>454</volume><fpage>114</fpage><lpage>117</lpage><pub-id pub-id-type="doi">10.1038/nature06927</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szabó</surname><given-names>Z</given-names></name></person-group><year>2014</year><article-title>Information theoretical estimators toolbox</article-title><source>Journal of Machine Learning Research</source><volume>15</volume><fpage>283</fpage><lpage>287</lpage></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Theobald</surname><given-names>JC</given-names></name><name><surname>Ringach</surname><given-names>DL</given-names></name><name><surname>Frye</surname><given-names>MA</given-names></name></person-group><year>2010</year><article-title>Dynamics of optomotor responses in Drosophila to perturbations in optic flow</article-title><source>Journal of Experimental Biology</source><volume>213</volume><fpage>1366</fpage><lpage>1375</lpage><pub-id pub-id-type="doi">10.1242/jeb.037945</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Kulkarni</surname><given-names>SR</given-names></name><name><surname>Verdu</surname><given-names>S</given-names></name></person-group><year>2009</year><article-title>Divergence estimation for multidimensional densities via -nearest-neighbor distances</article-title><source>IEEE Transactions on Information Theory</source><volume>55</volume><fpage>2392</fpage><lpage>2405</lpage><pub-id pub-id-type="doi">10.1109/TIT.2009.2016060</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Westwick</surname><given-names>DT</given-names></name><name><surname>Medicine</surname><given-names>IE</given-names></name><name><surname>Biology</surname><given-names>S</given-names></name></person-group><year>2003</year><article-title>Identification of nonlinear physiological systems</article-title><publisher-loc>Hoboken, NJ:</publisher-loc><publisher-name>IEEE Press; Wiley-Interscience</publisher-name></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.06229.016</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing editor</role><aff><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see <ext-link ext-link-type="uri" xlink:href="http://elifesciences.org/review-process">review process</ext-link>). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers.</p></boxed-text><p>Thank you for sending your work entitled “Identification of computations underlying photo-taxis, odor-taxis, and multi-sensory integration” for consideration at <italic>eLife</italic>. Your article has been favorably evaluated by Eve Marder (Senior editor) and three reviewers, one of whom, Ronald L Calabrese, is a member of our Board of Reviewing Editors.</p><p>The Reviewing editor and the other reviewers discussed their comments before we reached this decision, and the Reviewing editor has assembled the following comments to help you prepare a revised submission.</p><p>The authors present a very intriguing and thorough behavioral analysis of the navigation of <italic>Drosophila</italic> larvae to visual and chemical stimuli, separately and combined. For this analysis they use light and optogenetically induced fictive olfactory stimuli whose derivatives were independent identically distributed Gaussian random variables: a Brownian random walk. In an automated system, they monitor large numbers of larvae to a variety of stimuli and a stimulus combination and apply a Linear-Nonlinear-Poisson (LNP) model. Their Results are consistent with a model where visual and chemical inputs are combined early rather than processed in parallel to effect orienting turns. Their Discussion suggests that the methods used can be generally applied in understanding how neuronal networks effect decisions. The writing is very clear and crisp and the figures well designed. The modeling is well conceived and based on established procedures and it appears competently and prudently applied. The Materials and methods section and the Figure legends are very clear and helpful. These results have important implications for behavioral analysis of decision making in animals and serve as an entry point for further mechanistic studies in the important model system. Moreover, the application of the techniques here can be a model for applications in other systems.</p><p>There are some concerns which the reviewers share that should be addressed:</p><p>1) To be sure that the blue light is not evoking responses in Chrimson expressing ORNs the authors should perform a control experiment in genetically blind larvae with a NorpA mutation while expressing Chrimson in Or42b neurons and presenting blue light. The need for this control is expressed well by one of the expert reviews:</p><p>“My biggest concern is that I am not entirely convinced that there is no cross talk between the visual stimuli and the fictive odors. This is because the channelrhodopsin Chrimson is still highly sensitive to blue light despite being red-shifted in its optimal excitation wavelength. <xref ref-type="bibr" rid="bib29">Klapoetke et al. 2014</xref> show that blue light is very effective at eliciting spikes in larval neurons even for very brief and dim light levels (Figure 3A). I disagree that simply because the red light is 300 times greater intensity than the blue light, that any blue light response would be 0.3% of the red light responses. This will depend on the light intensities at which the Chrimson saturates. The percentage could be much higher than reported. Additionally, dim blue light was used in the Chrimson experiments to mask out visual responses to the red light. They reference <xref ref-type="bibr" rid="bib29">Klapoetke et al. 2014</xref> for this approach. The problem is that <xref ref-type="bibr" rid="bib29">Klapoetke et al. 2014</xref> were using adult flies, in which blue light is known not to penetrate the cuticle. Thus blue light likely never reached the Chrimson molecules in their central neurons and thus blue-light masking is appropriate. This manuscript uses this approach in peripheral neurons in a transparent larva. Thus, this blue light is more likely to activate Chrimson.</p><p>The authors would ideally use physiology to demonstrate clear separation of their visual and fictive stimuli. At minimum a behavioral approach should be attempted. Could the authors not genetically blind larvae with a NorpA mutation while expressing Chrimson in Or42b neurons and presenting blue light? If the blue light still evokes turning, then there is cause for concern.”</p><p>2) The Discussion does not do justice to the Results, probably a holdover from this being originally conceived as a short communication. One of the expert reviewers has some good suggestions for amplifying the Discussion:</p><p>“The Discussion was too short and failed to put these new results in a broader perspective. What do these results reveal if anything about the strategy used by larvae to avoid blue light and go towards sources of attractive odorants? I.e., what does it mean about what happens when larvae are navigating “natural” environments where odorant and light have spatial structures with characteristic lengths, rather than being subjected to signals with Gaussian white noise derivative? How do these results fit in with previous studies? I wished the authors had discussed further the interesting differences they identify between decisions in response to ‘CO2 signals’ and those to ‘ethyl acetate’ and light. They mention the role of speed change in response to CO2 but do not discuss whether there is speed modulation in response to the other two signals.”</p><p>3) There is a more minor concern that the Chrimson responses might show adaptation over the course of the experiments. In the absence of a direct electrophysiological demonstration, is there any evidence the authors can provide that the adaptation is not a factor in for example the poor fit of the LNP model for the first 10s of the step response in <xref ref-type="fig" rid="fig2">Figure 2C</xref>?</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.06229.017</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>1) To be sure that the blue light is not evoking responses in Chrimson expressing ORNs the authors should perform a control experiment in genetically blind larvae with a NorpA mutation while expressing Chrimson in Or42b neurons and presenting blue light. The need for this control is expressed well by one of the expert reviews</italic>.</p><p>We have carried out the requested control experiment and now include it as <xref ref-type="fig" rid="fig3s3">Figure 3–figure supplement 3</xref>. We appreciate the reviewers suggesting this experiment, as it vividly demonstrates that we are successfully addressing the visual and olfactory systems separately. Rather than the NorpA mutation, we used GMR-hid to ablate larval photoreceptors. Our results show that <italic>GMR-hid</italic>, <italic>Or42a</italic>&gt;<italic>CsChrimson</italic> larva respond robustly to red light and are unable to perceive blue light.</p><p><xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig4">Figure 4</xref> also provide direct evidence that dim blue light activates mainly the visual system and that red light activates mainly CsChrimson. <italic>Or42a&gt;CsChrimson</italic> larvae turn in response to an <italic>increase</italic> in blue light and a <italic>decrease</italic> in red light. This is only possible if the red and blue light activate distinct sensory systems.</p><p>For instance, consider the right column of <xref ref-type="fig" rid="fig4">Figure 4</xref>. Larvae turn in response to a decrease in red light intensity (panel ii), because a decrease in CsChrimson activation of the Or42a receptor neurons is perceived as a decrease in attractive odor concentration. If blue light were mainly activating CsChrimson, we would expect a simultaneous increase in blue light intensity to at least partially offset the effects of decreasing red light. Instead, we see that an increase in blue light coupled to a decrease in red light actually causes more turning than a decrease in red light alone (v), and we see that a decrease in blue light offsets, rather than enhances, the effects of a red light decrease (viii). The larvae’s observed responses are entirely consistent with red light providing a fictive odor cue and blue light providing a visual cue, but impossible to reconcile with the hypothesis that, at the intensities used in our experiments, both red and blue light activate CsChrimson to comparable degrees. We have included a brief discussion of this point in the text.</p><p>In particular, the fact that red and blue light have opposite valences to <italic>Or42a&gt;CsChrimson</italic> larvae means that the odor-light integration model we derive cannot result from cross-activation of CsChrimson by blue light.</p><p>The expert reviewer also makes several astute technical points which we address below. We are afraid that this discussion might prove somewhat confusing for a more general audience, so we have not included it in our main text.</p><p><italic>“My biggest concern is that I am not entirely convinced that there is no cross talk between the visual stimuli and the fictive odors. This is because the channelrhodopsin Chrimson is still highly sensitive to blue light despite being red-shifted in its optimal excitation wavelength.</italic> <xref ref-type="bibr" rid="bib29"><italic>Klapoetke et al. 2014</italic></xref> <italic>show that blue light is very effective at eliciting spikes in larval neurons even for very brief and dim light levels (</italic><italic>Figure 3A</italic><italic>)</italic>.”</p><p>The blue light intensity in Klapoetke Figure 3A was 14 mW/cm<sup>2</sup>, while the blue light intensity in our experiments involving CsChrimson was always &lt; 4 μW/cm<sup>2</sup>, a factor of over 3,000 less. Even accounting for the fact that the stimulus of Figure 3A was pulsed, more blue light was delivered in the 1 ms pulse that failed to evoke EJPs than in 3.5 seconds of our constant blue light background.</p><p>In adult flies (Figure 3F), Klapoetke et al. found that the threshold peak intensity to achieve a behavioral response to blue light in <italic>Gr64f&gt;CsChrimson</italic> flies was 3.5 mW/cm<sup>2</sup>, a factor of 1000 greater than the light intensities used in our experiments. These experiments were also carried out with pulsed light, but the average intensity during stimulation was 560 μW/cm<sup>2</sup>, 100 times more intense than the blue light intensity we used. In Figure 3F, Klapoetke et al. show that a 600 ms pulse of blue light with mean intensity of 160 μW/cm<sup>2</sup> (peak intensity 1 mW/cm<sup>2</sup>) failed to evoke behavioral responses in <italic>Gr64f&gt;CsChrimson</italic> flies. This intensity was a factor of 40 greater than the intensity of our blue light mask<italic>.</italic></p><p><italic>“I disagree that simply because the red light is 300 times greater intensity than the blue light, that any blue light response would be 0.3% of the red light responses. This will depend on the light intensities at which the Chrimson saturates. The percentage could be much higher than reported</italic>.”</p><p>It is possible that the highest intensities in our experiments match the saturation limit of CsChrimson, but if the channel were saturating at significantly lower intensity, our reverse correlation experiments simply wouldn’t work, because for most of the time the larva would be experiencing a constant, rather than time-varying, stimulus.</p><p>The red light intensity we used in this work is actually fairly modest compared to that used in Klapoetke and in other labs with which we’ve discussed these experiments. In white-noise experiments not presented in this work, we used a significantly stronger red light intensity (peak 3 mW/cm<sup>2</sup>) to activate CsChrimson and found that reverse correlation still produces beautiful kernels and nonlinear rate functions, indicating that saturation is not a problem over the majority of the range of these experiments either.</p><p>Looking only at the data presented in the paper, we observe that <italic>Or42a</italic>&gt;<italic>CsChrimson</italic>, <italic>Or42b</italic>&gt;<italic>CsChrimson</italic>, and <italic>Gr21a</italic>&gt;<italic>CsChrimson</italic> larva all show robust responses to step changes in red light between 343 and 572 μW/cm<sup>2</sup> (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). Thus the channel is clearly not saturated at 340 μW/cm<sup>2</sup>. Based on this, we can conservatively set an upper limit of the effect of the ∼3 μW/cm<sup>2</sup> blue light stimulus at 1% of the red light stimulus.</p><p><italic>“Additionally, dim blue light was used in the Chrimson experiments to mask out visual responses to the red light. They reference</italic> <xref ref-type="bibr" rid="bib29"><italic>Klapoetke et al. 2014</italic></xref> <italic>for this approach. The problem is that</italic> <xref ref-type="bibr" rid="bib29"><italic>Klapoetke et al. 2014</italic></xref> <italic>were using adult flies, in which blue light is known not to penetrate the cuticle. Thus blue light likely never reached the Chrimson molecules in their central neurons and thus blue-light masking is appropriate. This manuscript uses this approach in peripheral neurons in a transparent larva. Thus, this blue light is more likely to activate Chrimson</italic>.”</p><p>We cited Klapoetke et al. here to give credit for the approach of suppressing the visual response to red light by using a dim blue stimulus. However, the success of this approach in the adult fly does support its use in the larva. To mask the startle response to 720 nm light in the Proboscis Extension Reflex (PER) assay, Klapoetke et al. used a random blue visual dot stimulus with mean intensity 4 μW/cm<sup>2</sup>, comparable to the intensity of our constant blue mask. These PER experiments were carried out in flies expressing CsChrimson in peripheral sensory neurons, not central brain neurons, using <italic>Gr64f-Gal4</italic> which labels sweet receptors in the labellum and legs (Dahanukar et al., 2007). These neurons are accessible to blue light, as shown by the fact that Klapoetke et al. were also able to evoke PERs using blue light (Figure 4F, 4G) and by recent experiments in which blue light was used to evoke PERs in <italic>Gr64f&gt;ChR2</italic> flies (French et al., 2015).</p><p>The uni-modal CsChrimson experiments of our <xref ref-type="fig" rid="fig2">Figure 2</xref> were conducted with constant blue light and varying red light intensities. In these experiments, we can account for the effect of blue light activation of CsChrimson by adding some constant offset to the red light intensity. The red light intensity ranged from 0 to 911 μW/cm<sup>2</sup> while the blue light intensity was 3.7 μW/cm<sup>2</sup>. If we assume that blue light is equally effective as red light in activating CsChrimson, we can represent the effect of the constant blue light mask on Chrimson activation by adding 3.7 μW to the time varying red light intensity, so that the red intensity instead ranges from 3.7 to 914.7 μW/cm<sup>2</sup>. Because all of our analysis is carried out on the derivative of light intensity, adding this constant offset has no effect on the data presented or the results derived from them.</p><p><italic>“The authors would ideally use physiology to demonstrate clear separation of their visual and fictive stimuli. At minimum a behavioral approach should be attempted. Could the authors not genetically blind larvae with a NorpA mutation while expressing Chrimson in Or42b neurons and presenting blue light? If the blue light still evokes turning, then there is cause for concern</italic>.”</p><p>We now present <xref ref-type="fig" rid="fig3s3">Figure 3–figure supplement 3</xref> which shows turn-triggered averages for genetically blinded (using GMR-hid) larvae expressing CsChrimson in Or42a neurons and for wild-type larvae not expressing CsChrimson. Both groups of larvae were exposed to the same multi-color stimulus used to generate <xref ref-type="fig" rid="fig3">Figure 3</xref>. Blind larvae respond only to red light fluctuations and “non-optogenetic” larvae respond only to blue light fluctuations. We thank the reviewer for suggesting these experiments.</p><p><italic>2) The Discussion does not do justice to the Results, probably a holdover from this being originally conceived as a short communication. One of the expert reviewers has some good suggestions for amplifying the Discussion</italic>:</p><p><italic>“The Discussion was too short and failed to put these new results in a broader perspective. What do these results reveal if anything about the strategy used by larvae to avoid blue light and go towards sources of attractive odorants? I.e., what does it mean about what happens when larvae are navigating “natural” environments where odorant and light have spatial structures with characteristic lengths, rather than being subjected to signals with Gaussian white noise derivative? How do these results fit in with previous studies? I wished the authors had discussed further the interesting differences they identify between decisions in response to “CO2 signals” and those to “ethyl acetate” and light. They mention the role of speed change in response to CO2 but do not discuss whether there is speed modulation in response to the other two signals</italic>.”</p><p>We present a greatly expanded Discussion section. We describe how our results fit in with previous measurements of larvae in structured odor environments. We spend considerably more time discussing the possible connection between speed modulation in CO<sub>2</sub> gradients and the differences we discovered in how the larva uses Gr21a activity to make turning decisions. We also use this section to amplify our discussion of the multi-sensory experiments.</p><p><italic>3) There is a more minor concern that the Chrimson responses might show adaptation over the course of the experiments. In the absence of a direct electrophysiological demonstration</italic>, <italic>is there any evidence the authors can provide that the adaptation is not a factor in for example the poor fit of the LNP model for the first 10s of the step response in</italic> <xref ref-type="fig" rid="fig2"><italic>Figure 2C</italic></xref>?</p><p>We now include <xref ref-type="fig" rid="fig2s1">Figure 2–figure supplement 1</xref>, which shows the analysis for the first 10 minutes and second 10 minutes of each 20 minute experiment separately. The turn-triggered averages are remarkably stable across the course of the experiments. The turn-rates decrease slightly at the high end of the animals’ responses for attractive odor stimulation. However, the turn-rate similarly decreases for visual stimulation, suggesting that this habituation might be a property of the animals’ behavior rather than adaptation of the channel. <italic>Gr21a</italic>&gt;<italic>CsChrimson</italic> larvae actually show increased turning in the second 10 minutes of the experiments, suggesting sensitization rather than adaptation. We have added a paragraph to the manuscript discussing this analysis.</p><p>We cannot exclude the possibility that larvae might adapt to variance in sensory input. While the mean light levels and mean light derivatives were matched for the white-noise and step-response experiments, the variance of the signals was much greater for the white-noise experiments. Perhaps this explains the failure of the LNP model to fully predict larvae’s step responses.</p></body></sub-article></article>