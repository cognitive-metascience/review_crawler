<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">56942</article-id><article-id pub-id-type="doi">10.7554/eLife.56942</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Flexible motor sequence generation during stereotyped escape responses</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-179659"><name><surname>Wang</surname><given-names>Yuan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0471-5754</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-179660"><name><surname>Zhang</surname><given-names>Xiaoqian</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5636-7950</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-179661"><name><surname>Xin</surname><given-names>Qi</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5748-8057</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-65881"><name><surname>Hung</surname><given-names>Wesley</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-106542"><name><surname>Florman</surname><given-names>Jeremy</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7578-3511</contrib-id><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-94586"><name><surname>Huo</surname><given-names>Jing</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-49877"><name><surname>Xu</surname><given-names>Tianqi</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-179663"><name><surname>Xie</surname><given-names>Yu</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3624-0252</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-14502"><name><surname>Alkema</surname><given-names>Mark J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1311-5179</contrib-id><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-33337"><name><surname>Zhen</surname><given-names>Mei</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0086-9622</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-87624"><name><surname>Wen</surname><given-names>Quan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0268-8403</contrib-id><email>qwen@ustc.edu.cn</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund7"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Hefei National Laboratory for Physical Sciences at the Microscale, Center for Integrative Imaging, School of Life Sciences, University of Science and Technology of China</institution><addr-line><named-content content-type="city">Hefei</named-content></addr-line><country>China</country></aff><aff id="aff2"><label>2</label><institution>Chinese Academy of Sciences Key Laboratory of Brain Function and Disease</institution><addr-line><named-content content-type="city">Hefei</named-content></addr-line><country>China</country></aff><aff id="aff3"><label>3</label><institution>Samuel Lunenfeld Research Institute, Mount Sinai Hospital</institution><addr-line><named-content content-type="city">Toronto</named-content></addr-line><country>Canada</country></aff><aff id="aff4"><label>4</label><institution>University of Toronto</institution><addr-line><named-content content-type="city">Toronto</named-content></addr-line><country>Canada</country></aff><aff id="aff5"><label>5</label><institution>Department of Neurobiology, University of Massachusetts Medical School</institution><addr-line><named-content content-type="city">Worcester</named-content></addr-line><country>United States</country></aff><aff id="aff6"><label>6</label><institution>Center for Excellence in Brain Science and Intelligence Technology, Chinese Academy of Sciences</institution><addr-line><named-content content-type="city">Shanghai</named-content></addr-line><country>China</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Zimmer</surname><given-names>Manuel</given-names></name><role>Reviewing Editor</role><aff><institution>Research Institute of Molecular Pathology, Vienna Biocenter and University of Vienna</institution><country>Austria</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Sengupta</surname><given-names>Piali</given-names></name><role>Senior Editor</role><aff><institution>Brandeis University</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>05</day><month>06</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e56942</elocation-id><history><date date-type="received" iso-8601-date="2020-03-15"><day>15</day><month>03</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-06-05"><day>05</day><month>06</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Wang et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Wang et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-56942-v2.pdf"/><abstract><p>Complex animal behaviors arise from a flexible combination of stereotyped motor primitives. Here we use the escape responses of the nematode <italic>Caenorhabditis elegans</italic> to study how a nervous system dynamically explores the action space. The initiation of the escape responses is predictable: the animal moves away from a potential threat, a mechanical or thermal stimulus. But the motor sequence and the timing that follow are variable. We report that a feedforward excitation between neurons encoding distinct motor states underlies robust motor sequence generation, while mutual inhibition between these neurons controls the flexibility of timing in a motor sequence. Electrical synapses contribute to feedforward coupling whereas glutamatergic synapses contribute to inhibition. We conclude that <italic>C. elegans</italic> generates robust and flexible motor sequences by combining an excitatory coupling and a winner-take-all operation via mutual inhibition between motor modules.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>motor sequence generation</kwd><kwd>feedforward excitation</kwd><kwd>winner-take-all</kwd><kwd>escape response</kwd><kwd>mutual inhibition</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>C. elegans</italic></kwd></kwd-group><funding-group><award-group id="fund5"><funding-source><institution-wrap><institution>Key Area R&amp;D Program of Guangdong Province</institution></institution-wrap></funding-source><award-id>2018B030338001</award-id><principal-award-recipient><name><surname>Wang</surname><given-names>Yuan</given-names></name><name><surname>Zhang</surname><given-names>Xiaoqian</given-names></name><name><surname>Huo</surname><given-names>Jing</given-names></name><name><surname>Xu</surname><given-names>Tianqi</given-names></name><name><surname>Wen</surname><given-names>Quan</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution>Chinese Academy of Sciences Strategic Priority Research Program</institution></institution-wrap></funding-source><award-id>XDPB10, XDB39000000</award-id><principal-award-recipient><name><surname>Wang</surname><given-names>Yuan</given-names></name><name><surname>Zhang</surname><given-names>Xiaoqian</given-names></name><name><surname>Xin</surname><given-names>Qi</given-names></name><name><surname>Huo</surname><given-names>Jing</given-names></name><name><surname>Xu</surname><given-names>Tianqi</given-names></name><name><surname>Xie</surname><given-names>Yu</given-names></name><name><surname>Wen</surname><given-names>Quan</given-names></name></principal-award-recipient></award-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id><institution>National Science Foundation of China</institution></institution-wrap></funding-source><award-id>NSFC-31471051</award-id><principal-award-recipient><name><surname>Wang</surname><given-names>Yuan</given-names></name><name><surname>Zhang</surname><given-names>Xiaoqian</given-names></name><name><surname>Xin</surname><given-names>Qi</given-names></name><name><surname>Huo</surname><given-names>Jing</given-names></name><name><surname>Xu</surname><given-names>Tianqi</given-names></name><name><surname>Xie</surname><given-names>Yu</given-names></name><name><surname>Wen</surname><given-names>Quan</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id><institution>National Science Foundation of China</institution></institution-wrap></funding-source><award-id>NSFC-91632102</award-id><principal-award-recipient><name><surname>Wang</surname><given-names>Yuan</given-names></name><name><surname>Zhang</surname><given-names>Xiaoqian</given-names></name><name><surname>Xin</surname><given-names>Qi</given-names></name><name><surname>Huo</surname><given-names>Jing</given-names></name><name><surname>Xu</surname><given-names>Tianqi</given-names></name><name><surname>Xie</surname><given-names>Yu</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000024</institution-id><institution>CIHR</institution></institution-wrap></funding-source><award-id>Foundation Scheme 154274</award-id><principal-award-recipient><name><surname>Hung</surname><given-names>Wesley</given-names></name><name><surname>Zhen</surname><given-names>Mei</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution>Fundamental Research Funds for the Central Universities</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Wen</surname><given-names>Quan</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Time-ordered and flexible motor sequences in <italic>C.elegans</italic> are generated by combining an excitatory feedforward coupling and mutual inhibitions between neurons in different functional modules.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Nervous systems transform sensation into a sequence of actions. The motor repertoire, constrained by the biomechanics of gait, comprises a finite number of motor primitives that are stereotyped across individuals (<xref ref-type="bibr" rid="bib2">Ahamed et al., 2019</xref>; <xref ref-type="bibr" rid="bib8">Berman et al., 2014</xref>; <xref ref-type="bibr" rid="bib34">Liu et al., 2018</xref>; <xref ref-type="bibr" rid="bib61">Stephens et al., 2008</xref>). On the other hand, behavioral flexibility allows an animal to explore the action space, and to select better strategies for acquiring rewards or avoiding danger in a changing environment (<xref ref-type="bibr" rid="bib64">Sutton and Barto, 2017</xref>).</p><p>Many factors contribute to behavioral flexibility (<xref ref-type="bibr" rid="bib15">Dhawale et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Gordus et al., 2015</xref>; <xref ref-type="bibr" rid="bib52">Remington et al., 2018a</xref>). Actions may be generated by an inherently noisy system: synapses are unreliable (<xref ref-type="bibr" rid="bib4">Allen and Stevens, 1994</xref>), neurons generate variable spike trains (<xref ref-type="bibr" rid="bib38">Mainen and Sejnowski, 1995</xref>), and neural circuits may operate near the edge of chaos (<xref ref-type="bibr" rid="bib66">van Vreeswijk and Sompolinsky, 1996</xref>). On the other hand, neural networks, whether adaptive or hard-wired, have structures that shape population neural dynamics onto a low dimensional manifold, where nonrandom and ordered activity patterns emerge (<xref ref-type="bibr" rid="bib18">Ganguli et al., 2008</xref>; <xref ref-type="bibr" rid="bib22">Harvey et al., 2012</xref>; <xref ref-type="bibr" rid="bib25">Inagaki et al., 2018</xref>). Computational models have promised to provide a unified view of these observations (<xref ref-type="bibr" rid="bib12">Burak and Fiete, 2012</xref>; <xref ref-type="bibr" rid="bib10">Brennan and Proekt, 2019</xref>; <xref ref-type="bibr" rid="bib40">Mastrogiuseppe and Ostojic, 2018</xref>; <xref ref-type="bibr" rid="bib54">Roberts et al., 2016</xref>), but a deep connection between theories and experiments remains to be established.</p><p>The initiation of escape responses of the nematode <italic>Caenorhabdtis elegans</italic> (<italic>C. elegans</italic>) has long been viewed as an instinctive reflex. Upon a gentle touch to its anterior body, the ventral cord-projecting premotor interneurons AVA/AVD/AVE relay mechanosensory inputs to motor neurons and reliably drive a backward movement (<xref ref-type="bibr" rid="bib13">Chalfie et al., 1985</xref>; <xref ref-type="bibr" rid="bib48">Pirri et al., 2009</xref>; <xref ref-type="bibr" rid="bib70">Wicks et al., 1996</xref>). While <italic>C. elegans</italic> stays committed to its escape decision, the animal remains flexible in its approach to complete the motor sequence. After the reversal, the animal may or may not reorient its body via a deep omega (Ω) turn, before moving forward (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). This allows the animal to resume forward movement in either the original or a new direction. Notably, which action to select and when to execute exhibit trial to trial variability, and they can be coupled. For example, a previous study (<xref ref-type="bibr" rid="bib20">Gray et al., 2005</xref>) has shown that a longer reversal is likely to be followed by an omega turn.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Flexible motor sequence generation during <italic>C. elegans</italic> escape responses.</title><p>(<bold>A</bold>) Optogenetic stimulation of mechanosensory neurons ALM/AVM (P<italic>mec-4</italic>::ChR2) was carried out with blue light (473 nm, 4.63 mW/mm<sup>2</sup>) for 1.5 s during animal forward movement. Identical stimuli could induce four different behavioral outputs: reversal followed by an omega turn, reversal followed by forward movement, pause state or forward movement (no response). (<bold>B</bold>) Deﬁnitions of type-I and type-II transitions. (<bold>C</bold>) Reversal length distribution (left) and transition rates (right) during ALM/AVM (P<italic>mec-4</italic>::ChR2) triggered escape responses. Total number of trials, <italic>n</italic> = 674; reversal without turn, <italic>n</italic> = 272; reversal with turn, <italic>n</italic> = 322; no response, <italic>n</italic> = 79; pause, <italic>n</italic> = 1. Number of animals used can be found in <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>. Here and below, the error bars of transition rates represent 95% binomial proportion conﬁdence interval. (<bold>D</bold>) Reversal length distribution (left) and transition rates (right) during thermal stimulus induced escape responses. Wild-type, <italic>n</italic> = 385. Animal heads were thermally stimulated by an infrared laser (1480 nm; 400 mA) for 0.75 s. Solid lines are theoretical ﬁts using <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> and fitted type-II transition rates pass goodness-of-fit test (p&gt;0.05).</p><p><supplementary-material id="fig1sdata1"><label>Figure 1—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-56942-fig1-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Definition of the type-II transition and statistical test of reversal length distribution.</title><p>(<bold>A</bold>) Left, examples of reorientation angle <italic>θ</italic> during the type-I (up) and the type-II transition (bottom). <italic>θ</italic> was measured as the angle between the head vector (BA) and the tail vector (DC). The worm body centerline was equally divided into 100 segments. The head vector (BA) is denoted as point B (mean coordinate of the 10th-14th segment) to A (mean coordinate of the 1st-5th segment), while the tail vector is denoted as point D (mean coordinate of 96th-100th segment) to C (mean coordinate of the 86th-90th segment). Immediately after the end of reversal, we identified a frame in which the worm exhibited a highly coiled body posture to calculate <italic>θ</italic>. If the head touched the body or tail, <italic>θ</italic> was computed from the frame before touching. Right, distribution of θ during ALM/AVM (P<italic>mec-4</italic>::ChR2) triggered escape responses. A type-II transition was identified by either the head touching the body (or tail) or <italic>θ</italic> &gt; 135° within a single head swing. Total trials, <italic>n</italic>=594; type-I transition, <italic>n</italic>=272; type-II transition (touching the body or tail), <italic>n</italic>=283; type-II transition (no touching), <italic>n</italic>=39. (<bold>B</bold>) A Gaussian mixture model to fit the reversal length distribution during ALM/AVM (P<italic>mec-4</italic>::ChR2) triggered escape responses. We performed the likelihood ratio test between the unimodal Gaussian distribution fit and the bimodal Gaussian mixture model fit. After computing the difference of the negative log likelihoods, we found a <italic>p</italic>-value = 5.4e-5 using the <inline-formula><mml:math id="inf1"><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> distribution, where <italic>k</italic> = 3 is the difference of the number of free parameters in the unimodal (total 2 parameters) and bimodal (total 5 parameters) distribution. At level <italic>α</italic>=0.01, we have sufficient evidence that the bimodal distribution fits the reversal length better than the unimodal distribution.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig1-figsupp1-v2.tif"/></fig><media id="fig1video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-56942-fig1-video1.mp4"><label>Figure 1—video 1.</label><caption><title>Three main types of escape responses, Related to <xref ref-type="fig" rid="fig1">Figure 1</xref>.</title><p>Optogenetic activation of ALM/AVM mechanosensory neurons in freely moving worms for 1.5 s induced three types of responses.</p></caption></media></fig-group><p>We sought to understand algorithms and circuit mechanisms for motor sequence generation by investigating recurrently connected interneurons, which are positioned between sensory neurons and motor neurons in the <italic>C. elegans</italic> nervous system (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>). Previous studies on this layer of neural network (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>) have implicated their roles in exploratory behaviors (<xref ref-type="bibr" rid="bib20">Gray et al., 2005</xref>; <xref ref-type="bibr" rid="bib24">Iino and Yoshida, 2009</xref>; <xref ref-type="bibr" rid="bib42">Mori and Ohshima, 1995</xref>; <xref ref-type="bibr" rid="bib47">Pierce-Shimomura et al., 1999</xref>). During navigation, <italic>C. elegans</italic> moves towards a new direction by making a reversal and/or a turn in a probabilistic manner. Cell ablation studies revealed that the frequencies of reversals or turns were differentially modulated by many local interneurons including AIB and RIB (<xref ref-type="bibr" rid="bib20">Gray et al., 2005</xref>). Here we ask whether and how activities of local interneurons and their synaptic interactions shape the dynamics of a motor sequence during escape responses.</p><p>Several models have been proposed to account for motor sequence generation. In a class of synaptic chain models (<xref ref-type="bibr" rid="bib1">Abeles, 1991</xref>; <xref ref-type="bibr" rid="bib35">Long et al., 2010</xref>; <xref ref-type="bibr" rid="bib72">Xiao et al., 2017</xref>), feedforward excitation between transiently activated groups of neurons controls the timing of actions hierarchically. Sequential neural activity may also emerge from a cooperation between external inputs and local synaptic interactions in a recurrent network (<xref ref-type="bibr" rid="bib51">Rajan et al., 2016</xref>; <xref ref-type="bibr" rid="bib55">Seeds et al., 2014</xref>). We find that neurons encoding distinct motor states, such as reversals and omega turns, use electrical coupling to reliably drive motor state transitions, whereas they exploit mutual inhibition to flexibly control the timing of an action in a sequence. We propose that a form of short-term plasticity in inhibitory synapses contributes to the time-dependent change of transition probability between motor states. Our findings provide new insights into how the nervous system organizes time-ordered and variable motor activities, by which stereotyped and flexible animal behaviors emerge.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Stereotypical and flexible motor patterns constitute <italic>C. elegans</italic> escape responses</title><p>A potentially threatening sensory stimulus will trigger an animal’s escape response. For example, a gentle touch on the <italic>C. elegans</italic> head, which activates specific mechanosensory neurons ALM/AVM (<xref ref-type="bibr" rid="bib13">Chalfie et al., 1985</xref>), can induce a reversal or an omega turn (<xref ref-type="fig" rid="fig1">Figure 1A</xref> and <xref ref-type="video" rid="fig1video1">Figure 1—video 1</xref>).</p><p>We quantitatively characterized the escape responses from transgenic animals in which channelrhodopsin-2 (ChR2) was expressed in ALM/AVM neurons (P<italic>mec-4</italic>::ChR2; <italic>lite</italic>-1), and optogenetic stimulation was given to the same sensory neurons at a defined light intensity and pulse duration during forward movement (see Materials and methods) (<xref ref-type="bibr" rid="bib30">Leifer et al., 2011</xref>). ALM/AVM-triggered backward movements responses were robust (only ~10% trials did not respond, <xref ref-type="fig" rid="fig1">Figure 1C</xref> left), but subsequent motor sequences constituting each trial varied. Animals exhibited two main types of motor patterns: (1) backward movement was followed by a deep omega turn, and the animal moved forward in a new direction that was different from that before stimulation; (2) an animal executed backward movement and then resumed forward movement in a similar direction as that before stimulation (<xref ref-type="fig" rid="fig1">Figure 1A</xref> and <xref ref-type="video" rid="fig1video1">Figure 1—video 1</xref>). The head and the tail were diametrically opposed to each other in an omega turn; whereas they were likely aligned to each other in a backward-to-forward movement (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>). Occasionally, an animal paused (1/674 trials) before resuming forward movement (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), which can be regarded as the third motor pattern.</p><p>The reversal length distribution is broad (<xref ref-type="fig" rid="fig1">Figure 1C</xref> left) and likely bimodal (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>). This observation motivated us to describe behavior statistics by introducing two types of transitions and the corresponding transition rates <italic>r</italic>(<italic>t</italic>). Among all reversals survived to time <italic>t</italic>, <italic>r</italic>(<italic>t</italic>)Δ<italic>t</italic> computes the fraction of events that will make a transition to another motor state within the time bin Δ<italic>t</italic>. The type-I (RF) transition rate, <italic>r</italic><sub>1</sub>, determines the transition probability from reversal to forward movement; the type-II (RT) transition rate, <italic>r</italic><sub>2</sub>, determines the transition probability from reversal to omega turn (<xref ref-type="fig" rid="fig1">Figure 1B</xref> and Materials and methods). <italic>r</italic><sub>1</sub>(<italic>t</italic>) rapidly plateaued in about one second, while <italic>r</italic><sub>2</sub>(<italic>t</italic>) increased and gradually became the dominant mode (<xref ref-type="fig" rid="fig1">Figure 1C</xref> right). The escape responses induced by a focused infrared laser light (<xref ref-type="bibr" rid="bib41">Mohammadi et al., 2013</xref>) exhibited qualitatively similar statistics to ALM/AVM-triggered responses (<xref ref-type="fig" rid="fig1">Figure 1D</xref>).</p><p>This quantification, which was consistent with a previous observation and description for spontaneous reversals during exploratory behaviors (<xref ref-type="bibr" rid="bib20">Gray et al., 2005</xref>), confirms the notion that the longer a reversal, the more likely the reversal is followed by a turn.</p></sec><sec id="s2-2"><title>Local interneurons in the backward module modulate motor state transitions</title><p>We ask how neural dynamics underlie the behavioral variation. Whole brain and multi-neuron calcium imaging of fixed and behaving animals suggested that population interneuron activities, which perform sensorimotor transformation, encode distinct motor states (<xref ref-type="bibr" rid="bib19">Gordus et al., 2015</xref>; <xref ref-type="bibr" rid="bib26">Kato et al., 2015</xref>; <xref ref-type="bibr" rid="bib27">Kawano et al., 2011</xref>; <xref ref-type="bibr" rid="bib31">Li et al., 2014</xref>; <xref ref-type="bibr" rid="bib37">Luo et al., 2014</xref>; <xref ref-type="bibr" rid="bib46">Nguyen et al., 2016</xref>; <xref ref-type="bibr" rid="bib54">Roberts et al., 2016</xref>; <xref ref-type="bibr" rid="bib68">Venkatachalam et al., 2016</xref>; <xref ref-type="fig" rid="fig2">Figure 2A</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>). Several interneurons, including the ventral-cord-projecting premotor interneurons AVA and AVE, and the local interneurons AIB and RIM, exhibited increased calcium activity during a backward movement (<xref ref-type="bibr" rid="bib26">Kato et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Laurent et al., 2015</xref>; <xref ref-type="bibr" rid="bib37">Luo et al., 2014</xref>; <xref ref-type="fig" rid="fig2">Figure 2A</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Interneurons AIB are crucial for motor state transitions.</title><p>(<bold>A</bold>) Simplified circuit diagram underlying the gentle touch induced escape responses. Neurons were grouped into four modules based on their functional roles and activity patterns. (<bold>B</bold>) Calcium activity of AIB during spontaneous reversals before type-I (<italic>n</italic> = 23) and type-II (<italic>n</italic> = 36) transitions in unrestrained behaving animals (P<italic>inx-1</italic>::GCaMP6;P<italic>inx-1</italic>::wCherry). Here, data are aligned to the ends of reversals (vertical dashed line, <italic>t</italic> = 0). Heat map across trials (up) and Δ<italic>R</italic>(<italic>t</italic>)/<italic>R</italic><sub>0</sub> (Mean ± SEM, bottom) are shown. (<bold>C</bold>) Ramping rate of calcium activity in AIB. Up, raw single trial Δ<italic>R</italic>(<italic>t</italic>)/<italic>R</italic><sub>0</sub> from reversal start to reversal end. The ramping rate is the slope of the red line, fitted by linear regression. Bottom, ramping rates of AIB during type-I and type-II transitions. Each color (Mean ± SEM) represents single animal data across multiple trials. Total nine animals (P<italic>inx-1</italic>::GCaMP6;P<italic>inx-1</italic>::wCherry) were tested. Very short reversals (less than 1.5 s) are excluded, for some of them have negative ramping rates and the slope estimate is susceptible to noise (but including those trials doesn’t affect our conclusion). **p&lt;0.01, two-way ANOVA. (<bold>D</bold>) Optogenetic activation of AIB (635 nm, 4.46 mW/mm<sup>2</sup>, 7 s) or inhibition of AIB (561 nm, 21.71 mW/mm<sup>2</sup>, 12 s) during ALM/AVM (473 nm, 14.71 mW/mm<sup>2</sup>, 1.5 s) triggered avoidance behaviors, reversal durations (bar graph) and fractions of animals executing omega turns (pie chart) are shown. Error bars are SEMs. Bar graph, Mann–Whitney U test. Pie chart, χ<sup>2</sup> test. *p&lt;0.05, ***p&lt;0.001, ****p&lt;0.0001. Here and below, the actual turning percentages (<italic>n</italic><sub>turn</sub>/<italic>n</italic><sub>total</sub>) are noted beside the pie chart and numbers within the bars indicate the number of trials with reversal. (<bold>E–F</bold>) Reversal length distribution (<bold>E</bold>) and transition rates (<bold>F</bold>) during escape responses when AIB were persistently hyperpolarized through an exogenous expression of the potassium channel TWK-18. Control group is from <xref ref-type="fig" rid="fig1">Figure 1C</xref>.</p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-56942-fig2-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Local interneurons AIB and RIM in the backward module differentially modulate motor state transitions.</title><p>(<bold>A</bold>) Schematic diagram of the <italic>C. elegans</italic> nervous system. (<bold>B</bold>) Multi-neuron calcium imaging in freely behaving animals (P<italic>nmr-1</italic>/P<italic>lim-4</italic>/P<italic>lgc-55</italic>/P<italic>npr-9</italic>::NLS::wCherry::SL2::GCaMP6). Interneurons in the backward and forward modules were simultaneously imaged using a confocal microscopy (see Materials and methods for details). Data are aligned to the onset of a reversal (up, vertical dashed lines, <italic>t</italic> = 0) or the end of a turn (bottom, vertical dashed lines, <italic>t</italic> = 0). Heat map across trials and Δ<italic>R</italic>(<italic>t</italic>)/<italic>R</italic><sub>0</sub> (Mean ± SEM) across trials are shown. (<bold>C</bold>) Ramping rate of AIB calcium activity during thermally-induced escape responses. Ramping rate is significantly higher in type-II transition (nine animals, each point has more than three trials). *p&lt;0.05, two-way ANOVA. (<bold>D–E</bold>) Characterization of the probability of type-II transition during optogenetic stimulation of two different interneurons AIB (left) and RIM (right) for varying durations. Longer activation of AIB consistently led to a higher probability of type-II transition (left). The control groups are animals performing spontaneous motor state transitions without optogenetic stimulation. A blue laser (473 nm, 14.71 mW/mm<sup>2</sup>) was used to stimulate ChR2 expressed neurons. (<bold>F–G</bold>) Hyperpolarization of RIM (P<italic>tdc-1</italic>::Arch) or AIB (P<italic>npr-9</italic>::Arch) both affected reversal duration (bar graph), but only inhibiting AIB affected the probability of type-II transition (pie chart). In <bold>F</bold>), simultaneous optogenetic activation of AIB (or RIM) (635 nm, 4.46 mW/mm<sup>2</sup> for AIB or 473 nm, 14.71 mW/mm<sup>2</sup> for RIM) and inhibition (561 nm, 6.80 mW/mm<sup>2</sup>) of RIM (or AIB) were carried out for 7 (or 5) seconds. In <bold>G</bold>), RIM were activated for varying durations, while AIB were inactivated through an exogenous expression of the potassium channel TWK-18. (<bold>H–I</bold>) Reversal length distribution and transition rates after optogenetic ablation of AIB. ALM/AVM were optogenetically activated for 1.5 s to trigger avoidance behavior. AIB were ablated by exogenous expression of a membrane targeted PH-miniSOG. Data from <xref ref-type="fig" rid="fig1">Figure 1C</xref>) are used as control. For reversal duration, error bars indicate SEMs. Mann–Whitney U test. For probability of turn, error bars indicate 95% binomial proportion confidence interval. χ<sup>2</sup> test. *p&lt;0.05, **p&lt;0.01, ***p&lt;0.001, ****p&lt;0.0001. All multiple comparisons were adjusted using Bonferroni correction.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig2-figsupp1-v2.tif"/></fig><media id="fig2video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-56942-fig2-video1.mp4"><label>Figure 2—video 1.</label><caption><title>AIB neurons are crucial for turn and backward movement, Related to <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>.</title><p>Optogenetic activation of AIB neurons in free-moving animals reliably triggered backward movement followed by omega turns. Inhibition of AIB neurons quickly terminated backward movement.</p></caption></media></fig-group><p>Structural and functional studies of AIB (<xref ref-type="bibr" rid="bib20">Gray et al., 2005</xref>; <xref ref-type="bibr" rid="bib69">White et al., 1986</xref>) indicate that they may play important roles in motor state transitions (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). First, AIB establish recurrent connections with the premotor interneurons AVA and AVE that potentiate backward movement either directly through chemical synapses or indirectly through electrical and chemical connections with RIM (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). Second, AIB form gap junctions with the inter/motor neurons RIV (<xref ref-type="bibr" rid="bib69">White et al., 1986</xref>), which play a role in generating a ventral-biased turning behavior (<xref ref-type="fig" rid="fig2">Figure 2A</xref>; <xref ref-type="bibr" rid="bib20">Gray et al., 2005</xref>). Third, AIB exhibit ramping calcium activity during reversals (<xref ref-type="bibr" rid="bib26">Kato et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Laurent et al., 2015</xref>; <xref ref-type="bibr" rid="bib37">Luo et al., 2014</xref>), and finally, laser ablation of AIB significantly reduces the frequency of reversals during food search behavior (<xref ref-type="bibr" rid="bib20">Gray et al., 2005</xref>).</p><p>We first examined neuronal correlate of behavioral flexibility in action selection. We compared the AIB ramping activity (P<italic>inx-1</italic>::GCaMP6; P<italic>inx-1</italic>::wCherry) in different action sequences during either spontaneous or thermal-stimulus-triggered behaviors (<xref ref-type="fig" rid="fig2">Figure 2B-C</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B-C</xref>). If the fluorescence signal (∆<italic>R</italic>(<italic>t</italic>)/<italic>R</italic><sub>0</sub>) reflects a change of intracellular free calcium concentration [Ca<sup>2+</sup>], the ramping rate, defined as <italic>ζ </italic>= <inline-formula><mml:math id="inf2"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), would be proportional to the calcium current. Higher <italic>ζ</italic> may reflect a larger depolarization of the neuronal membrane potential. In <xref ref-type="fig" rid="fig2">Figure 2B-C</xref>, 76% trials (91/120) in the type-I (RF) transition show a positive ramping rate, whereas the proportion rose to 95% (109/115, <italic>p</italic> &lt; 0.0001, χ<sup>2</sup> test) in the type-II (RT) transition. Among trials longer than 1.5 seconds, they all showed positive <italic>ζ</italic>, which during the type-II transition was significantly higher than that during the type-I transition (<xref ref-type="fig" rid="fig2">Figure 2C</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>). These results suggest that the more active AIB are, the more likely a worm would terminate its reversal with a turn.</p><p>Optogenetic activation of AIB (P<italic>npr-9</italic>::ChR2 or P<italic>npr-9</italic>::Chrimson) alone reliably triggered reversals followed by omega turns (<xref ref-type="fig" rid="fig2">Figure 2D</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1D</xref> and <xref ref-type="video" rid="fig2video1">Figure 2—video 1</xref>), whereas strong optogenetic inhibition of AIB (P<italic>mec-4</italic>::ChR2; P<italic>npr-9</italic>::Arch; <italic>lite-1</italic>) during ALM/AVM induced escape responses almost completely abolished omega turns (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). We also generated transgenic animals in which AIB were persistently hyperpolarized by an expression of exogenous potassium channels (P<italic>npr-9</italic>::TWK-18(<italic>gf</italic>)). Interestingly, the no-response fraction increased to ~20% (70/332, p&lt;0.0001, χ<sup>2</sup> test) upon stimulating ALM/AVM in these animals and a significantly larger portion of responses were pauses (35/332, p&lt;0.0001, χ<sup>2</sup> test, <xref ref-type="fig" rid="fig2">Figure 2E</xref>). We did not observe a significant change in the type-II transition rate <italic>r</italic><sub>2</sub> (Kolmogorov-Smirnov test, p=0.6, <xref ref-type="fig" rid="fig2">Figure 2F</xref>), which might be due to a weaker AIB inhibition in these animals. Furthermore, optogenetic ablation of AIB alone (P<italic>npr-</italic>9::PH-miniSOG, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1H</xref>; <xref ref-type="bibr" rid="bib50">Qi et al., 2012</xref>; <xref ref-type="bibr" rid="bib75">Xu and Chisholm, 2016</xref>) significantly suppressed the type-II transition rate (Kolmogorov-Smirnov test, p&lt;1e-20, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1I</xref>). RIM (<xref ref-type="fig" rid="fig2">Figure 2A</xref>) also promoted reversals (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B and E–G</xref>), but were less important in modulating the type-II transition (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1D–G</xref>). Together, our data strongly suggest that AIB play an important role in promoting reversal and turning behaviors.</p></sec><sec id="s2-3"><title>Feedforward coupling between the backward module and the turning module drives the omega turn</title><p>How do AIB drive turning behaviors? Whole brain imaging in immobilized animals implicated that AIB and their electrically-coupled partners RIV (<xref ref-type="fig" rid="fig2">Figure 2A</xref> and <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>) exhibited sequentially activated patterns (<xref ref-type="bibr" rid="bib26">Kato et al., 2015</xref>). We compared RIV activity patterns (P<italic>lim-4</italic>::GCaMP6) underlying different motor sequences during spontaneous behaviors. During the type-II (RT) transition, RIV calcium signal rose rapidly immediately before a turn began, whereas it remained largely quiescent during the type-I (RF) transition (<xref ref-type="fig" rid="fig3">Figure 3A</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2A</xref>). The calcium signal decayed towards baseline before the animal finished the turn and resumed forward movement (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2B</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Feedforward excitation via electrical coupling drives omega turns.</title><p>(<bold>A</bold>) Calcium activity of RIV during the type-I (<italic>n</italic> = 38) and the type-II (<italic>n</italic> = 18) transitions in spontaneous behaving animals (P<italic>lim-4</italic>::GCaMP6). Here, data are aligned to the ends of reversals (vertical dashed line, <italic>t</italic> = 0). Heat map across trials (left) and Δ<inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="fraktur">R</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>(<italic>t</italic>) (Mean ± SEM, right, also see Materials and Methods) are shown. (<bold>B</bold>) Optical neurophysiology for probing the feedforward coupling between the backward module and the turning module. (<bold>C</bold>) Simultaneous optogenetic activation of AIB (635 nm, 6.11 mW/mm<sup>2</sup>) and calcium imaging of RIV in immobilized animals. Δ<italic>R</italic>(<italic>t</italic>)/<italic>R</italic><sub>0</sub> (Mean ± SEM) under different genetic backgrounds are shown: control (ATR) is wild-type (dark blue); <italic>inx-1unc-9unc-7</italic> triple mutant (red); calcium imaging of RIV in the presence of moderate inhibition (561 nm, 1.94 mW/mm<sup>2</sup>) of RIV (light blue, P<italic>lim-4</italic>::Arch). The control (no ATR) represents imaging data from wild-type animals without feeding all-trans retinal (grey). ****p&lt;0.0001, two-way ANOVA. (<bold>D</bold>) Probability of a reversal followed by a turn (left) and type-II transition rates (right) for gap junction deficient mutants. AIB, expressing Chrimson, were optogenetically activated for 7 s (635 nm, 4.46 mW/mm<sup>2</sup>) in wild-type animals (green), gap junction deficient mutants <italic>inx-1</italic> (red), and <italic>inx-1</italic> mutants, in which INX-1 channels were restored specifically in AIB (blue). Error bars indicate 95% binomial proportion confidence interval. χ<sup>2</sup> test. ****p&lt;0.0001. (<bold>E</bold>) Simultaneous optogenetic activation of AIB (635 nm, 6.11 mW/mm<sup>2</sup>) and calcium imaging of RIV in unrestrained behaving animals. Left, calcium activity heatmap across trials. <italic>t</italic> &lt; 0 represents reversals. Omega turns start at <italic>t</italic> = 0. Right, <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi mathvariant="fraktur">R</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (mean ± SEM) are shown (blue). (<bold>F</bold>) Data are related to (E), but <italic>t</italic> = 0 is aligned to the beginning of AIB stimulation.</p><p><supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig3">Figure 3</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-56942-fig3-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Possible polysynaptic pathways from AIB to RIV (less than four layers are shown) according to <italic>C. elegans</italic> connectome.</title><p>SDQ were oxygen-sensing neurons and topological cluster analyses suggest ADA may be involved in chemosensation. RIM, RIS and RIV have direct electrical coupling with AIB.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Optogenetic activation of AIB and calcium imaging of RIV in different experimental conditions.</title><p>(<bold>A and C–F</bold>) Single trial data related to <xref ref-type="fig" rid="fig3">Figure 3A</xref>, (<bold>C</bold> and <bold>E–F</bold>). In (<bold>F</bold>), dashed lines indicate the start of a turn. (<bold>B</bold>) Calcium activity of RIV (P<italic>lim-4</italic>::GCaMP6, <italic>n</italic> = 20) during thermal stimulus induced escape responses in freely moving animals. Δ<inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="fraktur">R</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>(<italic>t</italic>) = [Δ<italic>R</italic>(<italic>t</italic>) - Δ<italic>R</italic>(<italic>t = 0</italic>)]/<italic>R</italic><sub>0</sub> (mean ± SEM) are shown. <italic>t</italic> = 0 is aligned to the initiation (up) or termination (bottom) of an omega turn.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig3-figsupp2-v2.tif"/></fig><media id="fig3video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-56942-fig3-video1.mp4"><label>Figure 3—video 1.</label><caption><title>Optogenetic activation of AIB under various genetic backgrounds, Related to <xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig4">Figure 4</xref>.</title><p>Optogenetic activation of AIB in <italic>eat-4</italic> glutamate vesicular transport deficient mutants or glutamate postsynaptic receptor mutants induced an omega turn preceded by a much shorter reversal. Specifically restoring <italic>eat-4</italic> in AIB or <italic>glc-1</italic> in AIY promoted a longer reversal. Activating AIB in gap junction deficient mutant <italic>inx-1</italic> reduced the probability of omega turn, which were rescued by restoring <italic>inx-1</italic> in AIB.</p></caption></media></fig-group><p>To directly probe the functional connectivity between AIB and RIV, we performed simultaneous optogenetic stimulation of AIB (P<italic>npr-</italic>9::Chrimson) and calcium imaging of RIV (P<italic>lim-4</italic>::GCaMP6::wCherry, <xref ref-type="fig" rid="fig3">Figure 3B</xref>). In immobilized wild-type animals, upon stimulating AIB at <italic>t = 0</italic>, RIV calcium signal rapidly rose (<xref ref-type="fig" rid="fig3">Figure 3C</xref> dark blue and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2C</xref>). Several innexin, including INX-1, UNC-7 and UNC-9, have been reported to be expressed in AIB and RIV (<xref ref-type="bibr" rid="bib5">Altun et al., 2009</xref>; <xref ref-type="bibr" rid="bib9">Bhattacharya et al., 2019</xref>). Some of these innexins were shown to form homotypic and/or heterotypic gap junctions (<xref ref-type="bibr" rid="bib27">Kawano et al., 2011</xref>; <xref ref-type="bibr" rid="bib33">Liu et al., 2013</xref>; <xref ref-type="bibr" rid="bib60">Starich et al., 2009</xref>; <xref ref-type="bibr" rid="bib74">Xu et al., 2018</xref>). To determine whether electrical synapses contribute to the observed functional coupling between AIB and RIV, we examined the effect of AIB stimulation in <italic>inx-1unc-9unc-</italic>7 triple innexin mutants. RIV remained quiescent upon AIB stimulation (<xref ref-type="fig" rid="fig3">Figure 3C</xref> red and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2D</xref>), indicating that gap junction coupling underlies AIB stimulation-mediated RIV calcium activity.</p><p>UNC-7 and UNC<italic>-</italic>9 are broadly expressed in the motor circuit, and <italic>unc-7</italic> or <italic>unc-9</italic> mutants exhibit uncoordinated movements that prohibit them from completing a motor sequence (<xref ref-type="bibr" rid="bib6">Barnes and Hekimi, 1997</xref>; <xref ref-type="bibr" rid="bib11">Brenner, 1974</xref>; <xref ref-type="bibr" rid="bib27">Kawano et al., 2011</xref>; <xref ref-type="bibr" rid="bib59">Starich et al., 1993</xref>; <xref ref-type="bibr" rid="bib74">Xu et al., 2018</xref>). <italic>inx-1</italic> single mutants exhibit superficially normal forward and backward movements, allowing us to examine the behavioral requirement of INX-1. The presence of multiple innexins in many <italic>C. elegans</italic> neurons implicates that they may function redundantly at electrical synapses. Consistent with this notion, we find that optogenetic activation of AIB was capable, but with less likelihood, to trigger a turn in <italic>inx-1</italic> mutants (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). Rescuing <italic>inx-1</italic> in AIB was sufficient to restore the turning probability (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). Because <italic>inx-1</italic> mutants were still capable of generating omega turns, we propose that either multiple innexins between AIB and RIV, or parallel circuit pathways are at play.</p><p>When we performed dual optogenetic activation and calcium imaging in wild-type animals that were allowed to move, an increase of RIV calcium activity was also observed. But we observed a delay in RIV calcium signal, with its increase arriving at variable times (<xref ref-type="fig" rid="fig3">Figure 3E</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2F</xref>) instead of an immediately rise after stimulation onset. In many trials, the rise of RIV calcium activity coincided with the initiation of an omega turn (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2F</xref>), an event that was used to realign all trials at <italic>t</italic> = 0 (<xref ref-type="fig" rid="fig3">Figure 3E</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2F</xref>).</p><p>Delayed depolarization of RIV in a moving animal may result from a convergence of excitatory- and inhibitory- inputs onto the turning module (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). When neural activity in behaving animals was aligned to the onset of optogenetic stimulation, a transient quiescence or decrease of RIV calcium activity indeed appeared after <italic>t</italic> = 0 (<xref ref-type="fig" rid="fig3">Figure 3F</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2F</xref>). We hypothesized that a rapid increase of calcium activity in <xref ref-type="fig" rid="fig3">Figure 3C</xref> (dark blue) could result from a stronger depolarization of RIV neurons in immobilized animals. Consistently, when the calcium imaging experiment in immobilized animals was combined with a weak and persistent optogenetic inhibition of RIV (P<italic>lim-4</italic>::Arch), we also observed a delayed and rectified excitation in RIV (<xref ref-type="fig" rid="fig3">Figure 3C</xref> light blue and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2E</xref>).</p><p>Taken together, our data suggest that the feedforward excitation between the backward module and the turning module takes the form of electrical synapses, likely between AIB and RIV. We considered an effective functional coupling through polysynaptic excitation highly unlikely. First, AIB triggered ventral-biased turning behaviors did not require glutamatergic synaptic transmission (<xref ref-type="fig" rid="fig4">Figure 4A</xref>), thus excluding polysynaptic pathways via chemical synapses from AIB. Second, two possible polysynaptic excitation pathways from AIB via electrical coupling involve interneurons RIM or RIS (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>), revealed by the <italic>C. elegans</italic> connectome (<xref ref-type="bibr" rid="bib69">White et al., 1986</xref>). Our optogenetic activation of AIB while inhibiting RIM did not modify the turning probability, whereas activating RIM while inhibiting AIB significantly reduced the turning probability (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1F–G</xref>). Activation of RIS would drive an animal to a pause state and abolish motor actions (<xref ref-type="bibr" rid="bib63">Steuer Costa et al., 2019</xref>). Both results argue against RIM and RIS being directly involved in driving turning behaviors.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Glutamatergic inhibition modulates type-II transition.</title><p>(<bold>A</bold>) Reversal durations (left) and type-II transition rates (right) in glutamatergic synaptic transmission deficient animals upon strong and persistent optogenetic activation of AIB. Optogenetic stimulation was delivered for 7 s using red light (635 nm, 4.46 mW/mm<sup>2</sup>). Right, compare <italic>r<sub>2</sub></italic> in <italic>eat-4</italic> mutant or in P<italic>npr-9</italic>::TeTx with control animals across the whole distribution (Kolmogorov-Smirnov test, <italic>p</italic>=6.2e-7, <italic>p</italic>=0.0026) or within a time window (χ<sup>2</sup> test: * <italic>p</italic>&lt;0.05, ** <italic>p</italic>&lt;0.01, *** <italic>p</italic>&lt;0.001, **** <italic>p</italic>&lt;0.0001). (<bold>B</bold>) Reversal durations (left) and type-II transition rates (right) in GluCl receptor mutants upon optogenetic activation of AIB (635 nm, 4.46 mW/mm<sup>2</sup>). Right, compare <italic>r<sub>2</sub></italic> in triple receptor mutant with control animals across the whole distribution (Kolmogorov-Smirnov test, <italic>p</italic>=5.9e-8) or within a time window (χ<sup>2</sup> test: * <italic>p</italic>&lt;0.05, ** <italic>p</italic>&lt;0.01). (<bold>C</bold>) Genes encoding GluCl receptors were expressed in local interneurons RIB and AIY respectively. GFP reporter lines were constructed using <italic>avr-14</italic>, <italic>avr-15</italic> and <italic>glc-1</italic> promoters, respectively; mCherry (or wCherry) reporters were used for cell identification. Expression pattern from one section is showed. Scale bar, 10 µm. (<bold>D</bold>) Simultaneous optogenetic activation of AIB (635nm, 6.11 mW/mm<sup>2</sup>) and calcium imaging of RIB in immobilized animals under wide-type (control (ATR)) (blue) or <italic>eat-4</italic> glutamate deficient mutant background (red). Δ<italic>R</italic>(<italic>t</italic>)/<italic>R</italic><sub>0</sub> (Mean ± SEM) are shown. <italic>t</italic> = 0 represents the beginning of AIB stimulation. The control group (no ATR) (grey) represents imaging data from animals without feeding all-trans retinal. ****<italic>p</italic>&lt;0.0001, two-way ANOVA. (<bold>E</bold>) Functional coupling between AIB and RIB neurons was directly tested through glutamate imaging. Upon stimulation of AIB (P<italic>npr-9</italic>::Chrimson), the process (red), cell body (green) of the RIB (P<italic>sto-3</italic>::iGluSnFR) and the RIB process in <italic>eat-4</italic> glutamate deficient mutants (grey) exhibited distinct fluorescence signals. The control group (blue) represents imaging data from animals without feeding all-trans retinal. Raw iGluSnFR imaging was recorded at 150 Hz. Trial average (bold color) and SEM (shaded region) are shown. Inset, the fluorescence signal of the process (red) is fitted with a double exponential function (blue), <inline-formula><mml:math id="inf6"><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>c</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf8"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></inline-formula><inline-formula><mml:math id="inf9"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are free parameters. <inline-formula><mml:math id="inf11"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> represents the time constant of glutamate signal decay, and <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the baseline constant, which was subtracted in the inset plot. For reversal duration, Error bars indicate SEM. Mann–Whitney U test: ***p&lt;0.001, ****p&lt;0.0001. All multiple comparisons were adjusted using Bonferroni correction.</p><p><supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplements 1</xref>–<xref ref-type="fig" rid="fig4s2">2</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-56942-fig4-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Glutamatergic inhibitions between AIB and RIB flexibly control the motor state transitions.</title><p>(<bold>A</bold>) Couplings between the backward, forward and turning modules. AIB, RIV and RIB are highlighted. (<bold>B</bold>) Reversal length during optogenetic activation of AIB in various glutamate postsynaptic receptor mutants and restoring <italic>eat-4</italic> specifically in AIB in different <italic>eat-4</italic> glutamate deficient mutants. GluCl single and double mutants exhibited longer reversals than the triple mutants (<xref ref-type="fig" rid="fig4">Figure 4B</xref>), suggesting that AVR-14, AVR-15 and GLC-1 proteins function synergistically to mediate feedforward inhibition. Error bars indicate SEMs. *p&lt;0.05, **p&lt;0.01, ****p&lt;0.0001. Mann–Whitney U test. All multiple comparisons were adjusted using Bonferroni correction. (<bold>C</bold>) Single trial data related to <xref ref-type="fig" rid="fig4">Figure 4D</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Functional coupling between AIB and RIB neurons was directly tested through glutamate imaging.</title><p>(<bold>A</bold>) Single trial data of the glutamatergic signal on the process of RIB after AIB activation onset, related to <xref ref-type="fig" rid="fig4">Figure 4E</xref>). Raw data and smoothed data (bold line) are showed. (<bold>B</bold>) Examination of AIB calcium activity after optogenetic activation of AIB, related to <xref ref-type="fig" rid="fig4">Figure 4E</xref>). Raw data and smoothed data (bold line) are showed.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig4-figsupp2-v2.tif"/></fig></fig-group></sec><sec id="s2-4"><title>Inhibitory glutamatergic synaptic transmission modulates the type-II transition</title><p>We next investigated behavioral flexibility in the timing of an action. Given the feedforward coupling between the backward module and the turning module, we asked why omega turns did not immediately follow the optogenetic activation of AIB. We hypothesized that a balance of feedforward excitation and an unknown inhibition provides a potential mechanism to shape the statistics of the type-II (RT) transition. Besides gap junctions, AIB make chemical synapses with neurons in other modules (<xref ref-type="fig" rid="fig2">Figure 2A</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A</xref>), which may facilitate this inhibition. AIB are glutamatergic (<xref ref-type="bibr" rid="bib56">Serrano-Saiz et al., 2013</xref>). In the glutamate vesicular transport deficient mutant <italic>eat-4</italic>, optogenetic activation of AIB robustly induced an omega turn that was preceded by a much shorter reversal (<xref ref-type="fig" rid="fig4">Figure 4A</xref> left and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B</xref>). Restoring <italic>eat-4</italic> expression specifically in AIB significantly prolonged the reversal length before the onset of an omega turn (<xref ref-type="fig" rid="fig4">Figure 4A</xref> left, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B</xref> and <xref ref-type="video" rid="fig3video1">Figure 3—video 1</xref>). Likewise, stimulating AIB while blocking chemical synaptic transmission from AIB (P<italic>npr-9</italic>::TeTx) triggered an omega turn preceded by a shorter reversal (<xref ref-type="fig" rid="fig4">Figure 4A</xref> left and <xref ref-type="video" rid="fig3video1">Figure 3—video 1</xref>). Consistently, <italic>r</italic><sub>2</sub> rose more rapidly when glutamatergic inputs from AIB were disrupted (<xref ref-type="fig" rid="fig4">Figure 4A</xref> right).</p><p><italic>C. elegans</italic> nervous system possesses a family of inhibitory glutamate-gated chloride (GluCl) channels (<xref ref-type="bibr" rid="bib14">Dent et al., 1997</xref>). Upon optogenetic stimulation AIB, the triple GluCl mutant <italic>avr-14</italic>(<italic>ad1035</italic>);<italic>avr-15</italic>(<italic>vu227</italic>)<italic>glc-1</italic>(<italic>pk54</italic>) exhibited a behavioral phenotype resembling that of the <italic>eat-4</italic> mutant (<xref ref-type="fig" rid="fig4">Figure 4B</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B</xref>). In some trials (19/112, p&lt;0.0001, Fisher’s exact test), AIB stimulation immediately triggered omega turns without delay (<xref ref-type="video" rid="fig3video1">Figure 3—video 1</xref>). This suggests that postsynaptic GluCl receptors work synergistically in modulating the onset timing of a turn. Using GFP reporter lines, we found <italic>avr-14</italic>, <italic>glc-1</italic> and <italic>avr-15</italic> expressed in many neurons. By focusing on overlaps with neurons known to encode motor states (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), we found that <italic>Pavr-14</italic> and <italic>Pglc-1</italic> reporters exhibited expression in AIY interneurons, while the <italic>Pavr-15</italic> reporter exhibited expression in RIB interneurons (<xref ref-type="fig" rid="fig4">Figure 4C</xref>).</p><p>Unlike AIY, RIB receive more and invariant synaptic inputs from AIB (<xref ref-type="bibr" rid="bib69">White et al., 1986</xref>; <xref ref-type="bibr" rid="bib71">Witvliet et al., 2020</xref>; <xref ref-type="fig" rid="fig2">Figure 2A</xref>), and hence are the prominent postsynaptic partners of AIB. Consistent with a glutamate mediated feedforward inhibition, RIB calcium activity (P<italic>sto-3::GCaMP6</italic>) significantly reduced upon optogenetic activation of AIB in immobilized animals, which was not observed in the glutamate vesicular transport deficient mutant <italic>eat-4</italic> animals (<xref ref-type="fig" rid="fig4">Figure 4D</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1C</xref>). Moreover, restoring either <italic>avr-15</italic> expression in RIB or <italic>avr-14</italic> (or <italic>glc-1</italic>) expression in AIY promoted a longer reversal before the onset of an omega turn (<xref ref-type="fig" rid="fig4">Figure 4B</xref> and <xref ref-type="video" rid="fig3video1">Figure 3—video 1</xref>) upon AIB activation.</p><p>To further investigate the functional connectivity between AIB and RIB, we imaged glutamate signaling (<xref ref-type="bibr" rid="bib39">Marvin et al., 2013</xref>) at RIB (P<italic>sto-3</italic>::iGluSnFR) upon persistent optogenetic stimulation of AIB (P<italic>npr-9</italic>::Chrimson; see Materials and methods). After the onset of stimulation, a rapid rise (<xref ref-type="fig" rid="fig4">Figure 4E</xref> inset plot,~10%Δ<italic>F</italic>/<italic>F</italic><sub>0</sub>) of iGluSnFR signal on RIB’s neurites (<xref ref-type="fig" rid="fig4">Figure 4E</xref> and <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2A</xref> up) was followed by a slow decay. The fluorescence signal change was well fit by<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>t</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>t</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf13"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn> <mml:mi/><mml:mi>s</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf14"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn> <mml:mi/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:math></inline-formula>. In animals without feeding all-trans retinal (a co-factor required for AIB optogenetic stimulation), we observed random and smaller amplitude (~5%Δ<italic>F</italic>/<italic>F</italic><sub>0</sub>) fluctuations of iGluSnFR signals (<xref ref-type="fig" rid="fig4">Figure 4E</xref>). Such dynamics was not observed in the glutamate vesicular transport deficient mutant <italic>eat-4</italic> animals (<xref ref-type="fig" rid="fig4">Figure 4E</xref> and <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2A</xref> bottom).</p></sec><sec id="s2-5"><title>Local interneurons RIB promote both turning and forward behaviors</title><p>Local interneurons RIB, together with the ventral cord-projecting premotor interneurons AVB, have been previously reported to encode forward movement state (<xref ref-type="bibr" rid="bib20">Gray et al., 2005</xref>; <xref ref-type="bibr" rid="bib26">Kato et al., 2015</xref>; <xref ref-type="bibr" rid="bib31">Li et al., 2014</xref>). Moreover, RIB form gap junctions with SMDV (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), motor neurons that have also been implicated in ventral biased omega turns (<xref ref-type="bibr" rid="bib20">Gray et al., 2005</xref>; <xref ref-type="bibr" rid="bib69">White et al., 1986</xref>). RIB calcium activity declined during reversals, and rose during the type-I (RF) and type-II (RT) transitions (<xref ref-type="fig" rid="fig5">Figure 5A</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A</xref>), which is characteristic of neurons in both forward and turning modules (<xref ref-type="fig" rid="fig2">Figure 2A</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Local interneurons RIB promote both turning and forward behaviors.</title><p>(<bold>A</bold>) Calcium activity of RIB during type-I (up, <italic>n</italic> = 41) and type-II transitions (bottom, <italic>n</italic> = 25). Δ<inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="fraktur">R</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>(<italic>t</italic>) (mean ± SEM) are shown. <italic>t</italic> = 0 is aligned to the initiation of forward movement (up) or an omega turn (bottom). (<bold>B</bold>) Statistics of motor state transitions (left) and representative curvature kymographs (right) upon optogenetic manipulation of RIB. Left, the probability for a transition and its 95% confidence limits were computed. RIB::Chrimson<sup>1</sup>, <italic>n</italic> = 65, red light (635 nm, 3.75 mW/mm<sup>2</sup>); RIB::Chrimson<sup>2</sup>, <italic>n</italic> = 82, red light (635 nm, 1.00 mW/mm<sup>2</sup>); RIB::Arch, <italic>n</italic> = 83, green light (561 nm, 8.14 mW/mm<sup>2</sup>). Right, animals crawled on fresh agar plates. Body curvature was normalized by a <italic>k</italic> · <italic>L</italic>, where <italic>L</italic> is the body length. Green (or red) shaded regions show selected spatiotemporal regions for optogenetic inhibition (or activation). The kymograph of turning behaviors exhibits longer cycles to complete body bending and larger body curvature, which are different from those during forward movement. (<bold>C</bold>) Reversal length distributions (left) and transition rates (right) when ALM/AVM activation was followed by optogenetic inhibition of RIB (12 s green light, 561 nm, 1.94 mW/mm<sup>2</sup>). P<italic>mec-4</italic>::ChR2;P<italic>sto-3</italic>::Arch, <italic>n</italic> = 173. Control group is from <xref ref-type="fig" rid="fig1">Figure 1C</xref>. (<bold>D</bold>) Calcium imaging of RIV in wild-type (blue) and RIB-ablated animals (orange) upon optogenetic stimulation of AIB in freely behaving animals. Δ<italic>R</italic>(<italic>t</italic>)/<italic>R</italic><sub>0</sub> (Mean ± SEM) are shown. (<bold>E</bold>) Data are related to (D), but all trials were aligned to the onset of omega turns. (<bold>F</bold>) Reversal length during ALM/AVM-triggered escape responses in RIB-ablated animals or in animals where chemical synaptic transmission from RIB was blocked. Error bars indicate SEM. Mann–Whitney U test, ****p&lt;0.0001. All multiple comparisons were adjusted using Bonferroni correction.</p><p><supplementary-material id="fig5sdata1"><label>Figure 5—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig5">Figure 5</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-56942-fig5-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>RIB receive feedforward inhibition to modulate type-II transition and neurons in the turning module might contribute to reversal termination.</title><p>(<bold>A</bold>) Single trial data related to <xref ref-type="fig" rid="fig5">Figure 5A</xref>). Dashed lines indicate the initiation of forward movement (up) or omega turns (bottom). (<bold>B</bold>) Persistent inhibition of RIB by expressing an exogenous histamine channel (HisCl) during ALM/AVM-triggered escape responses. Type-II transition quickly approached a plateau at a lower rate, which is consistent with our model prediction and <xref ref-type="fig" rid="fig5">Figure 5C</xref>). Control group is from <xref ref-type="fig" rid="fig1">Figure 1C</xref>). (<bold>C</bold>) Single trial data related to <xref ref-type="fig" rid="fig5">Figure 5D–E</xref>). (<bold>D</bold>) Left, simultaneous optogenetic activation of AIB and calcium imaging of RIV or SAAD/SMB (P<italic>npr-9</italic>::Chrimson;P<italic>lim-4</italic>::GCaMP6) in freely behaving animals. <italic>t</italic> = 0 is aligned to the onset of an omega turn. Δ<inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="fraktur">R</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>(<italic>t</italic>) (mean ± SEM) are shown. Right, smoothed single trial data. Dashed lines indicate the start of a turn.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig5-figsupp1-v2.tif"/></fig><media id="fig5video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-56942-fig5-video1.mp4"><label>Figure 5—video 1.</label><caption><title>Optogenetic manipulation of RIB can induce motor state transitions, Related to <xref ref-type="fig" rid="fig5">Figure 5</xref>.</title><p>Strong activation of RIB during forward movement reliably triggered turns; while inhibiting RIB during forward movement led to a pause state.</p></caption></media><media id="fig5video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-56942-fig5-video2.mp4"><label>Figure 5—video 2.</label><caption><title>Optogenetic inhibition of RIB or RIV/SAA/SMB neurons during escape responses prolonged reversal durations, Related to <xref ref-type="fig" rid="fig5">Figure 5</xref> and <xref ref-type="fig" rid="fig6">Figure 6</xref>.</title></caption></media></fig-group><p>Optogenetic manipulation of RIB in freely behaving animals further revealed their functions during motor control. Activating RIB (P<italic>sto-3</italic>::Chrimson) during reversals triggered a transition to either an omega turn or forward movement (<xref ref-type="fig" rid="fig5">Figure 5B</xref> left). Strong optogenetic activation (635 nm, 3.75 mW/mm<sup>2</sup>) of RIB during forward movement reliably triggered omega turns (<xref ref-type="fig" rid="fig5">Figure 5B</xref> right and <xref ref-type="video" rid="fig5video1">Figure 5—video 1</xref>). On the other hand, inhibiting RIB (P<italic>sto-3</italic>::Arch) during forward movement led to a pause state (<xref ref-type="fig" rid="fig5">Figure 5B</xref> right and <xref ref-type="video" rid="fig5video1">Figure 5—video 1</xref>).</p><p>When RIB interneurons were directly inhibited to mimic an inhibitory synaptic input, either optogenetically or by an expression of histamine-gated chloride channels (<xref ref-type="bibr" rid="bib49">Pokala et al., 2014</xref>), the type-II (RT) transition rate <italic>r<sub>2</sub></italic> plateaued at a significantly reduced value (<xref ref-type="fig" rid="fig5">Figure 5C</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B</xref>). Consistently, an escape response comprised of a much longer reversal before an omega turn was initiated (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B</xref> and <xref ref-type="video" rid="fig5video2">Figure 5—video 2</xref>), in agreement with the GluCl rescue results (<xref ref-type="fig" rid="fig4">Figure 4B</xref> left). The type-I transitions were also largely suppressed (<xref ref-type="fig" rid="fig5">Figure 5C</xref>), as RIB also potentiate forward movement. Optogenetic ablation (P<italic>sto-3</italic>::miniSOG) or blocking chemical synaptic transmission (P<italic>sto-3</italic>::TeTx) from RIB also led to prolonged reversals during ALM/AVM-triggered escape responses (<xref ref-type="fig" rid="fig5">Figure 5F</xref>).</p><p>We asked how RIB may mediate neural activity in the turning module. Upon optogenetic stimulation of AIB (<xref ref-type="fig" rid="fig5">Figure 5D–E</xref>), the rise of RIV calcium activity in RIB ablated animals showed the same rectified activation when all trials were aligned to the beginning of a turn (<xref ref-type="fig" rid="fig5">Figure 5E</xref>). However, RIV activity was preceded by a longer quiescent state when trials were aligned to the stimulus onset (<xref ref-type="fig" rid="fig5">Figure 5D</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1C</xref>). Thus, RIB modulate motor state transitions in part through indirect modulation of the timing of RIV activation (<xref ref-type="fig" rid="fig2">Figure 2A</xref>).</p></sec><sec id="s2-6"><title>Inhibitory feedback contributes to reversal termination</title><p>The beginning of a turn marks the end of a reversal. We next asked whether the type-II (RT) transition can be accounted for by self-termination of neural activity in the backward module (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), analogous to a feedforward synaptic chain model, or, whether activation of the turning module provides a feedback inhibition to terminate the activity in the backward module.</p><p>In a feedforward synaptic chain model, perturbing neural activity in the downstream neurons would not affect the dynamics of upstream neurons. To test this model, we generated transgenic animals that express Archaerhodopsin in RIV/SAA/SMB neurons (P<italic>lim-4</italic>::Arch; <xref ref-type="fig" rid="fig6">Figure 6A</xref>). RIV/SAAD all exhibited elevated calcium activity during omega turns, and could be regarded as downstream outputs of the backward module (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1D</xref>). However, optogenetic inhibition of RIV/SAA/SMB or RIV alone by spatially patterned illumination during escape responses promoted significantly longer reversals (<xref ref-type="fig" rid="fig6">Figure 6B</xref> and <xref ref-type="video" rid="fig5video2">Figure 5—video 2</xref>).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Feedback inhibition from the turning module contributes to reversal termination.</title><p>(<bold>A</bold>) Expression pattern of P<italic>lim-4</italic>::Arch::GFP. Scale bar, 10 µm. (<bold>B</bold>) Left, escape responses induced by optogenetic activation of AIB (blue text, 473 nm, 14.71 mW/mm<sup>2</sup>, 1.5 s) or thermal stimulus (pink text, 1480 nm, 0.75 s) followed by optogenetic inhibition of Arch-expressed interneurons (green text, 561 nm, 21.71 mW/mm<sup>2</sup>, 12 s). Bar graph, reversal durations, Mann–Whitney U test and error bars are SEMs. Pie chart, fractions of trials executing omega turns, χ<sup>2</sup> test. *p&lt;0.05, ***p&lt;0.001, ****p&lt;0.0001. All multiple comparisons were adjusted using Bonferroni correction. Right, schematic diagram for selective inhibition of RIV near animal head during thermally induced (1480 nm, 0.75 s) escape responses. (<bold>C</bold>) Up, reversal length distribution (left) and transition rate (right) in RIV/SAAD/SMB ablated animals. Bottom, spontaneous run length distribution (left) and transition rate from forward to backward movements (right) in wild-type animals. Insets are plots of survival functions: proportion of trials moving backward (up) or forward (bottom) until <italic>t</italic>. We fitted only trials with reversal duration ≥3 s and forward duration ≥2 s.</p><p><supplementary-material id="fig6sdata1"><label>Figure 6—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig6">Figure 6</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-56942-fig6-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig6-v2.tif"/></fig><media id="fig6video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-56942-fig6-video1.mp4"><label>Figure 6—video 1.</label><caption><title>RIV neurons are essential for omega turns, Related to <xref ref-type="fig" rid="fig6">Figure 6</xref>.</title><p>Optogenetic ablation of RIV/SAA/SMB neurons abolished type-II transition, and animals could no longer generate a complete turn but executed a much longer reversal.</p></caption></media></fig-group><p>Observations from optogenetic ablation of RIV/SAA/SMB (P<italic>lim-4</italic>::miniSOG) also argue against a pure feedforward synaptic chain model. The type-II transition was abolished since animals could no longer generate a complete omega turn (<xref ref-type="fig" rid="fig6">Figure 6C</xref> upper panel), while the ability of direct transition from a backward to a forward movement remained unaffected and the type-I (RF) transition rate <italic>r</italic><sub>1</sub> remained similar (<xref ref-type="fig" rid="fig6">Figure 6C</xref> upper panel) to wild-type animals. Notably, the reversal duration became much longer and approached 30 s in some trials, which had not been observed in wild-type animals (<xref ref-type="fig" rid="fig1">Figures 1C</xref> and <xref ref-type="fig" rid="fig6">6C</xref> upper panel and <xref ref-type="video" rid="fig6video1">Figure 6—video 1</xref>). These results indicate that during normal type-II transitions, persistent neural activity in the upstream backward module could be abolished through inhibitory feedback from the downstream activity in the turning module.</p><p>Both the type-I (RF) transition rate (<xref ref-type="fig" rid="fig6">Figure 6C</xref> upper panel) and the mirror transition rate (FR) from a forward movement to a spontaneous reversal in wild-type animals (<xref ref-type="fig" rid="fig6">Figure 6C</xref> bottom panel) are consistent with the homogeneous Poisson process at long timescale, leading to exponential survival functions (<xref ref-type="fig" rid="fig6">Figure 6C</xref> insets) — fraction of backward or forward movements survived to <italic>t</italic> (<xref ref-type="bibr" rid="bib7">Berg, 1993</xref>; <xref ref-type="bibr" rid="bib62">Stephens et al., 2011</xref>). We did not observe an exponential survival function of reversals in wild-type animals. In the <italic>absence</italic> of the turning module, the statistics of forward and backward movements (<xref ref-type="fig" rid="fig6">Figure 6C</xref>) became consistent with a simple dynamic model, where a system stochastically transitions between two attractor states at constant rates.</p><p>Together, our data suggest that the feedforward inhibition (<xref ref-type="fig" rid="fig4">Figure 4</xref>) and feedback inhibition (<xref ref-type="fig" rid="fig6">Figure 6</xref>) between the backward module and the turning module implement a winner-take-all computation for action selection. The motor module with the highest level of activity stays active by suppressing the activities of other modules.</p></sec><sec id="s2-7"><title>A biophysical model of the type-II transition</title><p>With both structural and functional evidence, we now propose a mathematical model for the type-II (RT) transition. The turning module, represented by RIV inter/motor neurons, receives opposing excitatory and inhibitory inputs during a reversal (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). The rapid increase of RIV activity coincides with the beginning of an omega turn (<xref ref-type="fig" rid="fig3">Figure 3A and E</xref>). To capture the essential process, we assumed that the membrane potential of RIV <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> fluctuates around a balanced state <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> during a reversal (<xref ref-type="fig" rid="fig7">Figure 7B</xref>), and its neural dynamics is governed by the Langevin equation:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> depends on, among others, the gap junction and inhibitory synaptic conductances (see Appendix); and <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> could be regarded as fluctuations in synaptic currents (<xref ref-type="bibr" rid="bib32">Lindsay et al., 2011</xref>; <xref ref-type="bibr" rid="bib45">Narayan et al., 2011</xref>) and other sources of noises that are not explicitly considered in the model. For simplicity, <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is treated as uncorrelated Gaussian white noise: <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> Once the membrane potential crosses the threshold <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, RIV become rapidly depolarized due to a nonlinear rectified activation (<xref ref-type="fig" rid="fig7">Figure 7B</xref>), immediately terminating the reversal via feedback inhibition and starting a turn by activating ventral muscles (<xref ref-type="fig" rid="fig7">Figure 7A and D</xref>).</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>A model summary for motor sequence generation.</title><p>(<bold>A</bold>) Schematics of neuronal circuit of <italic>C. elegans</italic> avoidance behavior. Feedforward excitation between local interneurons AIB and RIV triggers turning behavior. Glutamatergic inhibition between AIB and RIB flexibly controls the motor state transitions. Feedback inhibition from the turning module helps terminate backward behavior. (<bold>B</bold>) Illustration of the biophysical meaning of the type-II transition. The sub-threshold membrane potential of RIV fluctuates around the fixed point <italic>x<sub>0</sub></italic>, just like a particle (red) in an energy well. When RIV membrane potential crosses the threshold <italic>x<sub>th</sub></italic>, RIV along with other neurons in the turning module become fully activated and a turn starts. (<bold>C</bold>) A simple stochastic model without short-term synaptic plasticity cannot account for the experimentally observed transition rate. (<bold>D</bold>) Schematics of a three-module model based on the animal connectome and experimentally identified functional motifs. Short-term synaptic depression (STD) was introduced in the feedforward inhibition. (<bold>E</bold>) Type-II transition rate during ALM/AVM triggered escape responses. Pink line is a theoretical fit using <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>. <inline-formula><mml:math id="inf24"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> is given by the glutamate decay constant in <xref ref-type="fig" rid="fig4">Figure 4E</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56942-fig7-v2.tif"/></fig><p>The next step is to calculate the type-II transition rate <italic>r</italic><sub>2</sub>: the probability that <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> crosses <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> per unit time. It is currently impossible to measure <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, but we can proceed by making a prediction. Based on electrophysiological recordings of <italic>C. elegans</italic> interneurons (<xref ref-type="bibr" rid="bib32">Lindsay et al., 2011</xref>; <xref ref-type="bibr" rid="bib54">Roberts et al., 2016</xref>), the membrane time constant of a neuron (~10 milliseconds) is much smaller than the behavioral timescale (~seconds). As a result, the membrane potential of a model neuron rapidly approaches the fixed point <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. By solving this problem analytically using one-dimensional Fokker-Planck equation near the system equilibrium (see Appendix), we find<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>π</mml:mi></mml:mfrac><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msqrt><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:msqrt><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here <inline-formula><mml:math id="inf29"><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mi>d</mml:mi><mml:mi>z</mml:mi></mml:math></inline-formula> is the imaginary error function.</p><p><xref ref-type="disp-formula" rid="equ3">Equation 3</xref>, however, would lead to a constant rate on the behavioral timescale, like that during the type-I (RF) transition, as expected and confirmed by our computer simulation (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). To explain the experimental observation of the rising phase of <italic>r</italic><sub>2</sub> (<xref ref-type="fig" rid="fig1">Figure 1C–D</xref>), we incorporated a plasticity mechanism analogous to short-term synaptic depression (STD): the feedforward inhibition from the backward module to the turning module becomes weaker as the reversal lasts longer (<xref ref-type="fig" rid="fig7">Figure 7D</xref>). Consequently, the membrane potential moves towards the excitation threshold <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> to potentiate transition, allowing the analytical expression for <italic>r</italic><sub>2</sub>, <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>, to become time-dependent. Our hypothesis is consistent with the decay of the glutamate sensor signal on RIB neurites upon AIB stimulation (<xref ref-type="fig" rid="fig4">Figure 4E</xref>), an observation that may be explained by a depletion of available vesicles for release at the presynaptic site. Note that calcium activity in AIB cell body, like that during a reversal (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), kept increasing during persistent optogenetic stimulation (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2B</xref>), arguing against the possibility that an opsin-mediated membrane depolarization in the presynaptic neuron undergoes depression upon continuous light activation.</p><p>By incorporating the exponential decay of inhibitory synaptic strength (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>), we found that the functional form of the transition rate (see Appendix) can be approximated by<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>π</mml:mi></mml:mfrac><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf31"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn> <mml:mi/><mml:mi>s</mml:mi> <mml:mi/></mml:math></inline-formula> is the decay constant of the glutamate signal (<xref ref-type="fig" rid="fig4">Figure 4E</xref>). The experimentally measured type-II transition rate is well fit by <xref ref-type="disp-formula" rid="equ4">Equation 4.</xref></p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Complex motor behaviors arise from continual selection and transition among a number of motor primitives. Classic synaptic chain models, in which stereotyped motor sequences arise from feedforward excitation between different groups of neurons, are thought to underlie several motor behaviors such as Zebra Finch singing (<xref ref-type="bibr" rid="bib35">Long et al., 2010</xref>). A feedforward synaptic chain may underlie the replay of spatiotemporal activity patterns in hippocampus during sleep (<xref ref-type="bibr" rid="bib36">Louie and Wilson, 2001</xref>; <xref ref-type="bibr" rid="bib58">Skaggs and McNaughton, 1996</xref>), and generate temporally precise firing patterns that correspond to different actions in the motor cortex of behaving monkeys (<xref ref-type="bibr" rid="bib57">Shmiel et al., 2006</xref>). Alternatively, when several mutually inhibited modules are co-activated by sensory inputs, motor sequences could also emerge by a winner-take-all strategy, a proposed mechanism for the grooming behavior in <italic>Drosophila</italic> (<xref ref-type="bibr" rid="bib55">Seeds et al., 2014</xref>). In mice, mutually inhibitory neurons in the central amygdala have been shown to regulate dimorphic defensive behaviors — flight or freezing — triggered by looming visual stimuli (<xref ref-type="bibr" rid="bib17">Fadok et al., 2017</xref>). Here, we find the two schemes are likely integrated by the <italic>C. elegans</italic> nervous system to generate robust and flexible motor sequences (<xref ref-type="fig" rid="fig7">Figure 7D</xref>).</p><p>In <italic>C. elegans</italic>, feedforward excitation between the backward module and the turning module (<xref ref-type="fig" rid="fig7">Figure 7A</xref>) can reliably trigger an omega turn followed by forward movement through strong and persistent activation of local interneurons AIB (<xref ref-type="fig" rid="fig2">Figure 2D</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1D</xref>). In other words, the action in a motor sequence can be selected through feedforward excitation, triggered by either external sensory stimulus or fluctuations of internal circuit dynamics. The timing of an action can be tuned by augmenting the feedforward excitation with glutamatergic feedforward inhibition between AIB and RIB (<xref ref-type="fig" rid="fig7">Figure 7A</xref>), and likely by modulating the strength of inhibitory inputs through short term synaptic plasticity. Previously, a tyraminergic feedforward inhibition (<xref ref-type="bibr" rid="bib3">Alkema et al., 2005</xref>; <xref ref-type="bibr" rid="bib48">Pirri et al., 2009</xref>) from the RIM interneurons in the backward module to the SMD motor neurons in the turning module was shown to suppress head movement during reversals. We propose that these functional motifs — feedforward excitation and inhibition — are combined with a nonlinear activation of turning neurons (<xref ref-type="fig" rid="fig7">Figure 7D</xref>) to produce flexible type-II (RT) transitions.</p><p>A simple synaptic chain model predicts that abolishing neural activity in a downstream module would not directly affect upstream neural output. However, when RIV/SAA/SMB in the turning module were ablated or inhibited (<xref ref-type="fig" rid="fig6">Figure 6B–C</xref>), we observed prolonged reversals during escape responses. Hence, the turning module may provide feedback inhibition onto the backward module, contributing to the reversal termination during the type-II transition. The cellular and molecular mechanisms for inhibitory feedback remain to be identified. One possible implementation is cholinergic synaptic outputs from SAAD onto RIM and AVA interneurons in the backward module; another possibility is synaptic outputs from RIB onto AVA/AVE (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). Together, the feedforward coupling between the backward module and the turning module facilitates a defined sequential activity pattern, whereas the winner-take-all operation through mutual inhibition between the two modules avoids an action conflict.</p><p>Sensorimotor transformation depends on the initial condition of the network state (<xref ref-type="bibr" rid="bib52">Remington et al., 2018a</xref>; <xref ref-type="bibr" rid="bib53">Remington et al., 2018b</xref>). We show that when the backward motor state is suppressed via the hyperpolarization of interneurons AIB, an identical mechanosensory stimulus is less likely to elicit an escape response (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). A recent study also demonstrated that mechanosensory stimuli were unlikely to drive other motor programs when <italic>C. elegans</italic> was executing a turn (<xref ref-type="bibr" rid="bib34">Liu et al., 2018</xref>). We propose that the inhibition from the turning module to the backward module (<xref ref-type="fig" rid="fig7">Figure 7D</xref>) may account for this observation.</p><p>We view omega turn, a motor state encoded by transient activity in RIV, as a special manifold connecting two attractors represented by persistent activity in the forward or backward module (<xref ref-type="fig" rid="fig7">Figure 7D</xref>). Our finding — a combination of feedforward excitation and mutual inhibition between motor states — suggests a new way to control nonlinear dynamics towards a different fixed point (<xref ref-type="bibr" rid="bib43">Morrison et al., 2020</xref>). In our simplified model, neurons within a module were treated as a homogeneous population. Nevertheless, interneurons with heterogeneous functional properties have been found. For example, laser ablation of AIB and RIM in the backward module (<xref ref-type="fig" rid="fig2">Figure 2A</xref>) differentially affect the probability of spontaneous reversals (<xref ref-type="bibr" rid="bib20">Gray et al., 2005</xref>). While RIM showed increased calcium activity during reversals (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>) and promoted reversal upon optogenetic activation (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1E–G</xref>), they were less important in modulating the type-II transition than AIB did (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1D–G</xref>). The impact of functional heterogeneity on the attractor dynamics and motor state transitions remains to be understood.</p><p>Our biophysical model suggests that noises in a neural circuit (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>) contribute to behavior variability. We speculate that stochasticity in neural dynamics and behaviors may allow animals to efficiently explore the action space (<xref ref-type="bibr" rid="bib15">Dhawale et al., 2017</xref>; <xref ref-type="bibr" rid="bib16">Duffy et al., 2019</xref>; <xref ref-type="bibr" rid="bib65">Tumer and Brainard, 2007</xref>); learning, by which functional connectivity between motor modules is modified through synaptic plasticity, may optimize action selection and timing (<xref ref-type="bibr" rid="bib64">Sutton and Barto, 2017</xref>). We found that in <italic>C. elegans</italic>, the functional connectivity between motor modules consists of feedforward excitation and mutual inhibition. Conserved network motifs may be distributed among mammalian forebrain and midbrain circuits (<xref ref-type="bibr" rid="bib17">Fadok et al., 2017</xref>; <xref ref-type="bibr" rid="bib28">Klaus et al., 2019</xref>). Other animals could use similar algorithms to organize neuronal activities into sequential states to drive motor primitives, by which stereotyped and flexible behaviors emerge.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th>Reagent type (species) <break/>or resource</th><th>Designation</th><th>Source or reference</th><th>Identifiers</th><th>Additional information</th></tr></thead><tbody><tr><td>Strain, strain background (<italic>C. elegans</italic>)</td><td><italic>C. elegans</italic> strains used and generated in this study</td><td><italic>Caenorhabditis</italic> Genetics Center (CGC) and this paper</td><td/><td><xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref></td></tr><tr><td>Recombinant DNA reagent</td><td>Plasmids generated in this study</td><td>This paper</td><td/><td><xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref></td></tr><tr><td>Recombinant DNA reagent</td><td>Primers for genes (or promoters) used in this study</td><td>This paper</td><td/><td><xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref></td></tr><tr><td>Software, algorithm</td><td valign="top">MATLAB</td><td valign="top">Mathworks</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_001622">SCR_001622</ext-link></td><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com">https://www.mathworks.com</ext-link></td></tr><tr><td>Software, algorithm</td><td valign="top">CoLBeRT system</td><td valign="top">Samuel Lab</td><td valign="top"/><td valign="top"><ext-link ext-link-type="uri" xlink:href="http://colbert.physics.harvard.edu/">http://colbert.physics.harvard.edu/</ext-link></td></tr><tr><td>Software, algorithm</td><td valign="top">ImageJ</td><td valign="top">Media Cybernetics</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_003070">SCR_003070</ext-link></td><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://imagej.net/">https://imagej.net/</ext-link></td></tr><tr><td>Software, algorithm</td><td valign="top">LabVIEW</td><td valign="top">National Instruments</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_014325">SCR_014325</ext-link></td><td valign="top"><ext-link ext-link-type="uri" xlink:href="http://www.ni.com">http://www.ni.com</ext-link></td></tr></tbody></table></table-wrap><sec id="s4-1"><title><italic>C. elegans</italic> strains</title><p><italic>C. elegans</italic> strains including wild-type (N2), mutants, and transgenic worms were grown and cultivated according to standard procedures (<xref ref-type="bibr" rid="bib11">Brenner, 1974</xref>). All strains used in this paper can be found in the <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>. Transgenic worms for optogenetic experiments were cultivated in dark on NGM plates with OP50 bacteria and 0.4 mM all-trans retinal (ATR) for over 5 hr. We used young adult hermaphrodites to perform optogenetic and calcium imaging experiments, and L4 hermaphrodites to obtain expression patterns.</p></sec><sec id="s4-2"><title>Molecular biology</title><p>Standard molecular biology methods were used. Details of plasmids, promoters and rescue genomic DNA (or cDNA) sequences can be found in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>–<xref ref-type="supplementary-material" rid="supp3">3</xref>.</p></sec><sec id="s4-3"><title>Optogenetics</title><p>Worms were first washed in M9 buffer (or transferred onto an unseeded NGM plate for 1–3 min), then transferred onto a fresh agar plate [∼ 0.8% (w/v) agar in M9 buffer, without food], mounted on a motorized stage. Worms were left to freely explore the new environment for 3–5 min before testing, and were automatically tracked and retained within the field of view of a 10 × objective (Nikon Plan Apo, NA = 0.45) mounted on an inverted microscope (Nikon Ti-U, Japan) via dark field infrared illumination. Worm behaviors were recorded by a CMOS camera (Basler, aca2000-340kmNIR, Germany). MATLAB custom software (MathWorks, Inc Natick, MA, USA) was used for post-processing behavioral data and extracting moving directions and the kinematics of omega turns.</p><p>For freely roaming worms without optogenetic stimulation, we only recorded them for 5–8 min.</p><p>For worms with optogenetic stimulation, lasers and a digital micromirror device (DLI4130 0.7 XGA, Digital Light Innovations, TX, USA) were used to generate a defined spatiotemporal illumination pattern (<xref ref-type="bibr" rid="bib30">Leifer et al., 2011</xref>) at a specific wavelength (473 nm, 561 nm or 635 nm), and to manipulate the activities of neurons expressing light-activated channels (ChR2, Arch or Chrimson) (<xref ref-type="bibr" rid="bib23">Husson et al., 2012</xref>; <xref ref-type="bibr" rid="bib44">Nagel et al., 2005</xref>). To eliminate the effect of adaptation, single worm was stimulated 5–8 times with at least a 50 second inter-stimulus interval. For example:</p><list list-type="order"><list-item><p>To trigger escape responses, worms received 1.5 s blue light (short enough and over 80% trials showed responses in pilot experiments) to activate mechanosensory neurons ALM/AVM. All worms in the dataset had at least 20% probability to perform either type-I or type-II transitions. In other cases, 7 s (or 12 s) optogenetic illumination were used to ensure persistent activation/inhibition of local interneurons.</p></list-item><list-item><p>In some experiments, worms received sequential optogenetic stimulations with different colors and varying durations controlled by diaphragm shutters (GCI 7102M, Daheng Optics, China). For example, the 1.5 s blue light optogenetic stimulation (to trigger escape response) was followed by green light with a duration of 3–12 s to inhibit other interneurons in the motor control circuit.</p></list-item><list-item><p>We also performed selective optogenetic manipulation of interneurons when their cell body positions were sufficiently apart, given that the lateral resolution of our CoLBeRT system is up to ~ 5 μm. For example, RIV and SAAD neurons are separated by at least 20 μm along the dorsal-ventral axis (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). In order to inhibit SAAD or RIV independently (P<italic>lim-4</italic>::Arch::GFP), we generated a spatial pattern to selectively illuminate the dorsal or ventral side (<xref ref-type="fig" rid="fig6">Figure 6B</xref> right). At the same time, we monitored GFP emission signals from these neurons excited by the laser (473 nm) to ensure we targeted the correct region (<xref ref-type="fig" rid="fig6">Figure 6B</xref>).</p></list-item></list></sec><sec id="s4-4"><title>Calcium imaging</title><p>Calcium imaging was conducted on worms expressing a GCaMP6::wCherry (or mCardinal) fusion protein. Calcium activity was measured as a ratiometric change. For example, neural activity of AIB was measured as a fluorescence ratio of GFP to RFP (Δ<italic>R(t)</italic>/<italic>R</italic><sub>0</sub>) (GCaMP6/wCherry), where <italic>R</italic><sub>0</sub> is the baseline ratio. In some cases, we define a new normalized ratiometric measure, Δ<inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="fraktur">R</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>(<italic>t</italic>) = [Δ<italic>R</italic>(<italic>t</italic>)- Δ<italic>R</italic>(<italic>t</italic> = 0)]/ <italic>R</italic><sub>0</sub>.</p><p>When cell-specific promoters are available, including AIB and RIB, we performed calcium imaging using wide-field fluorescence microscopy. Unrestrained behaving worms were placed on fresh agarose plates [2% (w/v) agarose in M9 buffer], tracked by a motorized stage using the CoLBeRT system with infrared light illumination (<xref ref-type="bibr" rid="bib30">Leifer et al., 2011</xref>). Blue and green lights were employed to excite GCaMP6 and wCherry (or mCardinal) proteins. Green and red emission signals were captured by a 10 × objective (Nikon Plan Apo, WD = 4 mm; NA = 0.45, Japan) at 50 fps with an exposure time of 20 ms, separated by a dichroic mirror, relayed by an optical splitter (OptoSplit II, Cairn-Research, UK), and projected onto one-half of a sCMOS sensor (Andor Zyla 4.2, UK) simultaneously. Green and red channels were aligned and processed by custom-written MATLAB scripts (<xref ref-type="bibr" rid="bib74">Xu et al., 2018</xref>). Single worm was recorded for 3–10 min.</p><p>To image RIV neurons, which lack cell-specific promoters, we picked transgenic worms (P<italic>lim-4</italic>::GCaMP6::wCherry) with stronger fluorescence expression on RIV, and increased the exposure time (up to 50 ms) to obtain high signal-to-noise ratio images.</p></sec><sec id="s4-5"><title>Multi-neuron calcium imaging in a freely behaving worm</title><p>To image calcium activity of multiple neurons in a freely behaving worm (e.g., <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>), we combined a spinning disk confocal inverted microscope (Nikon Ti-U and Yokogawa CSU-W1, Japan) for calcium imaging with a customized upright light path for worm tracking and behavior recording. A worm was placed on an agarose pad [∼ 2% (w/v)] mounted on a motorized stage. We used a 40 × air objective (Nikon Plan Apo, WD 0.25–0.17 mm; NA = 0.95, Japan) or a 60 × water immersion objective (Nikon Plan Apo, WD 0.22 mm; NA = 1.20, Japan). The wavelengths of confocal excitation lasers were 488 nm and 561 nm; the emission lights were split (Andor Optosplit II, UK) in front of a sCMOS camera (Andor Zyla 4.2, UK). At the same time, we utilized a customized light path that was aligned to the same <italic>z</italic> axis to track the worm and to record behavioral data. In the upright path, a low magnification 10 × objective (Nikon Plan Fluor, WD 16 mm; NA = 0.30, Japan) was used to gather fluorescent light excited by confocal lasers, and the fluorescent signal was processed to identify worm positions. A real time feedback signal was sent to a motorized stage to keep the worm head within the center of field of view. Meanwhile, we illuminated the worm by an infrared ring surrounding the high magnification objective to record worm behavior through the upright light path.</p></sec><sec id="s4-6"><title>Simultaneous optogenetic manipulation and calcium imaging</title><p>To combine calcium imaging and optogenetic manipulation (e.g., <xref ref-type="fig" rid="fig3">Figure 3B</xref>), a 635 nm laser was added to activate Chrimson. Because blue light can also activate Chrimson, excitation light for GCaMP6 imaging and red light for optogenetic stimulation were synchronized using a TTL signal (LabJack Corp., U3-HV) controlled by LabVIEW (National Instruments Corp., USA). For example, to verify the connectivity between AIB and RIV, we activated AIB using red laser (635 nm) and recorded the calcium signal in RIV using blue LED excitation (M470L3-C1; Thorlabs, USA) for 7 s simultaneously. Both restrained and freely moving worms were tested. Restrained worms were placed on 10% (w/v) agarose plates with coverslips, whereas freely moving ones were placed on 2% (w/v) fresh agarose plates. Single worm was stimulated 5–8 times with at least a 50 s inter-trial interval.</p></sec><sec id="s4-7"><title>Thermally-induced escape responses</title><p>In addition to optogenetic stimulation of mechanosensory neurons, we also used a thermal stimulus to trigger escape responses. We illuminated the head of a worm with a focused infrared laser light (1480 nm; spot diameter ~120 μm, ΔT ~ 2 °C) for 0.75 s (short enough and over 80% trials showed responses in pilot experiments), and animals responded with reversals or omega turns to avoid the stimulus (<xref ref-type="bibr" rid="bib41">Mohammadi et al., 2013</xref>). The transition rates were qualitatively similar to ALM/AVM-induced escape responses (<xref ref-type="fig" rid="fig1">Figure 1C–D</xref>). Identical experimental protocols were used when thermally-induced escape responses were followed by optogenetic manipulation or calcium imaging of interneurons.</p></sec><sec id="s4-8"><title>Glutamate imaging</title><p>Glutamate imaging was conducted on worms expressing iGluSnFR (<xref ref-type="bibr" rid="bib39">Marvin et al., 2013</xref>) on RIB and Chrimson on AIB (<xref ref-type="fig" rid="fig4">Figure 4E</xref> and <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2A</xref>). All worms were restrained on fresh 10% (w/v) agarose plates with coverslips. We used 60 × water immersion objective. Both processes and cell body of RIB were imaged on the same focal plane. Imaging acquisition rate is 150 fps. Like calcium imaging, blue excitation light (weak enough to reduce the bleaching effect; M470L3-C1; Thorlabs) for glutamate imaging and red light (635 nm, 6.11 mW/mm<sup>2</sup>) for optogenetic stimulation were synchronized with a TTL signal. Glutamate signaling resulted in a change of the green fluorescence signal on the membrane of RIB interneurons. Stimulation and imaging sustained for more than 8 s. Single worm was stimulated 2–3 times with at least a 50 s inter-stimulus interval.</p></sec><sec id="s4-9"><title>Optogenetic ablation</title><p>We used miniSOG (mini Singlet Oxygen Generator) to ablate specific neurons in <italic>C. elegans</italic>. Upon blue light stimulation, a mitochondria-targeted miniSOG (TOMM20-miniSOG) (<xref ref-type="bibr" rid="bib50">Qi et al., 2012</xref>) or a membrane-targeted miniSOG (PH-miniSOG) (<xref ref-type="bibr" rid="bib75">Xu and Chisholm, 2016</xref>) were employed to induce cell death in cell-autonomous manner. L2/early L3 worms were transferred onto an unseeded NGM plate, restricted by a small ring of filter paper soaked with 100 μM CuCl<sub>2</sub>. Worms were illuminated for 40–60 min (TOMM20-miniSOG) or 2 min (PH-miniSOG) with blue LED (M470L3-C5; Thorlabs) at the intensity of 0.46 mW/mm<sup>2</sup>. After illumination, worms were transplanted back to OP50-seeded NGM plates, and were allowed to recover for 1–2 days before behavior testing.</p></sec><sec id="s4-10"><title>Behavioral assays and analysis</title><p>Recorded movies, in which worm body centerlines were extracted in real time, were further processed semi-automatically in MATLAB to identify locomotor states (forward locomotion, backward locomotion, pause and turn) and other statistical parameters. We also set up a Graphic User Interface (GUI) that allows human interference and proofreading.</p><p>Reversal duration was defined as the time from reversal start to reversal end. If one stimulus triggered several reversals, we always scored the first one. Omega turns were identified by either the head touching the body (or tail) or <italic>θ</italic> &gt;135° within a single head swing (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>). The end of a turn was identified when a worm opened its coiled posture and began to move forward.</p></sec><sec id="s4-11"><title>Transition rate calculation</title><p>Transition rates are calculated by the following equations<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>⋅</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>⋅</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We group trials into time bins. For example, here we use time bin <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for illustration. Let <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> denote the number of trials that end with type-I or type-II transition in the i-th time bin. <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> means there are 8 trials which terminate its reversal with forward movement from 0.0 s to 1.0 s; <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> means 12 trials terminate its reversal with a turn from 3.0 s to 4.0 s. Next, we shall use <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> to represent the number of trials among type-I or type-II transition which survive to the start of the i-th time bin. Naturally, we have <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. For example, <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the total number of trials that execute a turn. <inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> represents the number of all trials among type-I transition that survive to 2.0 s.</p></sec><sec id="s4-12"><title>Theoretical account of transition rates and model details</title><p>Detailed description can be found in Appendix.</p></sec><sec id="s4-13"><title>Quantification and statistical analysis</title><p>Quantiﬁcation and statistical parameters were indicated in the legends of each ﬁgure, including the statistical methods, error bars, <italic>n</italic> numbers (see <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref> for more details), and <italic>p</italic> values. We applied Mann–Whitney U test, χ<sup>2</sup> test or Fisher’s exact test among samples, two-way ANOVA to determine the signiﬁcance of difference between groups for two factors, and Kolmogorov-Smirnov test to compare <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Probability_distribution">probability distributions</ext-link> from two samples. All multiple comparisons were adjusted using Bonferroni correction. We considered <italic>p</italic> values of &lt; 0.05 signiﬁcant. All analyses were performed using MATLAB.</p></sec><sec id="s4-14"><title>Data availability</title><p>Raw data of calcium imaging experiments and all code used for modeling or figure generation are available for download from <ext-link ext-link-type="uri" xlink:href="https://github.com/Wenlab/Worm-Motor-Sequence-Generation">https://github.com/Wenlab/Worm-Motor-Sequence-Generation</ext-link> (<xref ref-type="bibr" rid="bib73">Xin et al., 2020</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/Worm-Motor-Sequence-Generation">https://github.com/elifesciences-publications/Worm-Motor-Sequence-Generation</ext-link>). Source data files have been provided for main figures.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Louis Tao and Shangbang Gao for discussions, Pinjie Li for analyzing the reorientation angles during the type-I and type-II transitions. This work was funded by Key Area R&amp;D Program of Guangdong Province with Grant No. 2018B030338001, the Strategic Priority Research Program of the Chinese Academy of Sciences (Pilot study, grant XDPB10, Grant No. XDB39000000), National Science Foundation of China Grants NSFC-31471051 and NSFC-91632102, Key scientific technological innovation research project by Ministry of Education, the Fundamental Research Funds for the Central Universities (QW), and the Canadian Institute of Health Research Foundation Scheme 154274 (MZ). Mei Zhen thanks her lab members Yangning Lu, Maria Lim, and Jyothsna Chitturi for sharing their unpublished optogenetic methods, observations, and reagents used in this study.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Resources, Data curation, Formal analysis, Investigation, Visualization, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Data curation, Software, Formal analysis, Visualization, modelling, Writing - original draft</p></fn><fn fn-type="con" id="con3"><p>Resources, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Resources</p></fn><fn fn-type="con" id="con5"><p>Resources, Investigation</p></fn><fn fn-type="con" id="con6"><p>Resources</p></fn><fn fn-type="con" id="con7"><p>Resources</p></fn><fn fn-type="con" id="con8"><p>Resources</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Supervision, Funding acquisition, Investigation, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Strains information.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-56942-supp1-v2.docx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Associated plasmids information.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-56942-supp2-v2.docx"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 3.</label><caption><title>Associated promoter and gene information.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-56942-supp3-v2.docx"/></supplementary-material><supplementary-material id="supp4"><label>Supplementary file 4.</label><caption><title>Sample size and replicate number for all experiments.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-56942-supp4-v2.docx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-56942-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analysed during this study are included in the manuscript.</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Abeles</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1991">1991</year><source>Corticonics: Neural Circuits of the Cerebral Cortex</source><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="bib2"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ahamed</surname> <given-names>T</given-names></name><name><surname>Costa</surname> <given-names>AC</given-names></name><name><surname>Stephens</surname> <given-names>GJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Capturing the continuous complexity of behavior in C. elegans</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1911.10559">https://arxiv.org/abs/1911.10559</ext-link></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alkema</surname> <given-names>MJ</given-names></name><name><surname>Hunter-Ensor</surname> <given-names>M</given-names></name><name><surname>Ringstad</surname> <given-names>N</given-names></name><name><surname>Horvitz</surname> <given-names>HR</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Tyramine functions independently of octopamine in the <italic>Caenorhabditis elegans</italic> nervous system</article-title><source>Neuron</source><volume>46</volume><fpage>247</fpage><lpage>260</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.02.024</pub-id><pub-id pub-id-type="pmid">15848803</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname> <given-names>C</given-names></name><name><surname>Stevens</surname> <given-names>CF</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>An evaluation of causes for unreliability of synaptic transmission</article-title><source>PNAS</source><volume>91</volume><fpage>10380</fpage><lpage>10383</lpage><pub-id pub-id-type="doi">10.1073/pnas.91.22.10380</pub-id><pub-id pub-id-type="pmid">7937958</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altun</surname> <given-names>ZF</given-names></name><name><surname>Chen</surname> <given-names>B</given-names></name><name><surname>Wang</surname> <given-names>ZW</given-names></name><name><surname>Hall</surname> <given-names>DH</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>High resolution map of <italic>Caenorhabditis elegans</italic> gap junction proteins</article-title><source>Developmental Dynamics : An Official Publication of the American Association of Anatomists</source><volume>238</volume><fpage>1936</fpage><lpage>1950</lpage><pub-id pub-id-type="doi">10.1002/dvdy.22025</pub-id><pub-id pub-id-type="pmid">19621339</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barnes</surname> <given-names>TM</given-names></name><name><surname>Hekimi</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The <italic>Caenorhabditis elegans</italic> avermectin resistance and anesthetic response gene unc-9 encodes a member of a protein family implicated in electrical coupling of excitable cells</article-title><source>Journal of Neurochemistry</source><volume>69</volume><fpage>2251</fpage><lpage>2260</lpage><pub-id pub-id-type="doi">10.1046/j.1471-4159.1997.69062251.x</pub-id><pub-id pub-id-type="pmid">9375655</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Berg</surname> <given-names>HC</given-names></name></person-group><year iso-8601-date="1993">1993</year><source>Random Walks in Biology</source><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname> <given-names>GJ</given-names></name><name><surname>Choi</surname> <given-names>DM</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>Shaevitz</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mapping the stereotyped behaviour of freely moving fruit flies</article-title><source>Journal of the Royal Society Interface</source><volume>11</volume><elocation-id>20140672</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2014.0672</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhattacharya</surname> <given-names>A</given-names></name><name><surname>Aghayeva</surname> <given-names>U</given-names></name><name><surname>Berghoff</surname> <given-names>EG</given-names></name><name><surname>Hobert</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Plasticity of the electrical connectome of <italic>C. elegans</italic></article-title><source>Cell</source><volume>176</volume><fpage>1174</fpage><lpage>1189</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.12.024</pub-id><pub-id pub-id-type="pmid">30686580</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brennan</surname> <given-names>C</given-names></name><name><surname>Proekt</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A quantitative model of conserved macroscopic dynamics predicts future motor commands</article-title><source>eLife</source><volume>8</volume><elocation-id>e46814</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.46814</pub-id><pub-id pub-id-type="pmid">31294689</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brenner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>The genetics of <italic>Caenorhabditis elegans</italic></article-title><source>Genetics</source><volume>77</volume><fpage>71</fpage><lpage>94</lpage><pub-id pub-id-type="pmid">4366476</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burak</surname> <given-names>Y</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Fundamental limits on persistent activity in networks of noisy neurons</article-title><source>PNAS</source><volume>109</volume><fpage>17645</fpage><lpage>17650</lpage><pub-id pub-id-type="doi">10.1073/pnas.1117386109</pub-id><pub-id pub-id-type="pmid">23047704</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chalfie</surname> <given-names>M</given-names></name><name><surname>Sulston</surname> <given-names>JE</given-names></name><name><surname>White</surname> <given-names>JG</given-names></name><name><surname>Southgate</surname> <given-names>E</given-names></name><name><surname>Thomson</surname> <given-names>JN</given-names></name><name><surname>Brenner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>The neural circuit for touch sensitivity in <italic>Caenorhabditis elegans</italic></article-title><source>The Journal of Neuroscience</source><volume>5</volume><fpage>956</fpage><lpage>964</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.05-04-00956.1985</pub-id><pub-id pub-id-type="pmid">3981252</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dent</surname> <given-names>JA</given-names></name><name><surname>Davis</surname> <given-names>MW</given-names></name><name><surname>Avery</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>avr-15 encodes a chloride channel subunit that mediates inhibitory glutamatergic neurotransmission and ivermectin sensitivity in <italic>Caenorhabditis elegans</italic></article-title><source>The EMBO Journal</source><volume>16</volume><fpage>5867</fpage><lpage>5879</lpage><pub-id pub-id-type="doi">10.1093/emboj/16.19.5867</pub-id><pub-id pub-id-type="pmid">9312045</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dhawale</surname> <given-names>AK</given-names></name><name><surname>Smith</surname> <given-names>MA</given-names></name><name><surname>Ölveczky</surname> <given-names>BP</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The role of variability in motor learning</article-title><source>Annual Review of Neuroscience</source><volume>40</volume><fpage>479</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-072116-031548</pub-id><pub-id pub-id-type="pmid">28489490</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duffy</surname> <given-names>A</given-names></name><name><surname>Abe</surname> <given-names>E</given-names></name><name><surname>Perkel</surname> <given-names>DJ</given-names></name><name><surname>Fairhall</surname> <given-names>AL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Variation in sequence dynamics improves maintenance of stereotyped behavior in an example from bird song</article-title><source>PNAS</source><volume>116</volume><fpage>9592</fpage><lpage>9597</lpage><pub-id pub-id-type="doi">10.1073/pnas.1815910116</pub-id><pub-id pub-id-type="pmid">31015294</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fadok</surname> <given-names>JP</given-names></name><name><surname>Krabbe</surname> <given-names>S</given-names></name><name><surname>Markovic</surname> <given-names>M</given-names></name><name><surname>Courtin</surname> <given-names>J</given-names></name><name><surname>Xu</surname> <given-names>C</given-names></name><name><surname>Massi</surname> <given-names>L</given-names></name><name><surname>Botta</surname> <given-names>P</given-names></name><name><surname>Bylund</surname> <given-names>K</given-names></name><name><surname>Müller</surname> <given-names>C</given-names></name><name><surname>Kovacevic</surname> <given-names>A</given-names></name><name><surname>Tovote</surname> <given-names>P</given-names></name><name><surname>Lüthi</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A competitive inhibitory circuit for selection of active and passive fear responses</article-title><source>Nature</source><volume>542</volume><fpage>96</fpage><lpage>100</lpage><pub-id pub-id-type="doi">10.1038/nature21047</pub-id><pub-id pub-id-type="pmid">28117439</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ganguli</surname> <given-names>S</given-names></name><name><surname>Bisley</surname> <given-names>JW</given-names></name><name><surname>Roitman</surname> <given-names>JD</given-names></name><name><surname>Shadlen</surname> <given-names>MN</given-names></name><name><surname>Goldberg</surname> <given-names>ME</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>One-dimensional dynamics of attention and decision making in LIP</article-title><source>Neuron</source><volume>58</volume><fpage>15</fpage><lpage>25</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.01.038</pub-id><pub-id pub-id-type="pmid">18400159</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gordus</surname> <given-names>A</given-names></name><name><surname>Pokala</surname> <given-names>N</given-names></name><name><surname>Levy</surname> <given-names>S</given-names></name><name><surname>Flavell</surname> <given-names>SW</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Feedback from network states generates variability in a probabilistic olfactory circuit</article-title><source>Cell</source><volume>161</volume><fpage>215</fpage><lpage>227</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.02.018</pub-id><pub-id pub-id-type="pmid">25772698</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gray</surname> <given-names>JM</given-names></name><name><surname>Hill</surname> <given-names>JJ</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>A circuit for navigation in <italic>Caenorhabditis elegans</italic></article-title><source>PNAS</source><volume>102</volume><fpage>3184</fpage><lpage>3191</lpage><pub-id pub-id-type="doi">10.1073/pnas.0409009101</pub-id><pub-id pub-id-type="pmid">15689400</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hänggi</surname> <given-names>P</given-names></name><name><surname>Talkner</surname> <given-names>P</given-names></name><name><surname>Borkovec</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Reaction-rate theory: fifty years after kramers</article-title><source>Reviews of Modern Physics</source><volume>62</volume><fpage>251</fpage><lpage>341</lpage><pub-id pub-id-type="doi">10.1103/RevModPhys.62.251</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harvey</surname> <given-names>CD</given-names></name><name><surname>Coen</surname> <given-names>P</given-names></name><name><surname>Tank</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Choice-specific sequences in parietal cortex during a virtual-navigation decision task</article-title><source>Nature</source><volume>484</volume><fpage>62</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1038/nature10918</pub-id><pub-id pub-id-type="pmid">22419153</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Husson</surname> <given-names>SJ</given-names></name><name><surname>Liewald</surname> <given-names>JF</given-names></name><name><surname>Schultheis</surname> <given-names>C</given-names></name><name><surname>Stirman</surname> <given-names>JN</given-names></name><name><surname>Lu</surname> <given-names>H</given-names></name><name><surname>Gottschalk</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Microbial light-activatable proton pumps as neuronal inhibitors to functionally dissect neuronal networks in <italic>C. elegans</italic></article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e40937</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0040937</pub-id><pub-id pub-id-type="pmid">22815873</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iino</surname> <given-names>Y</given-names></name><name><surname>Yoshida</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Parallel use of two behavioral mechanisms for chemotaxis in <italic>Caenorhabditis elegans</italic></article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>5370</fpage><lpage>5380</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3633-08.2009</pub-id><pub-id pub-id-type="pmid">19403805</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Inagaki</surname> <given-names>HK</given-names></name><name><surname>Inagaki</surname> <given-names>M</given-names></name><name><surname>Romani</surname> <given-names>S</given-names></name><name><surname>Svoboda</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Low-Dimensional and monotonic preparatory activity in mouse anterior lateral motor cortex</article-title><source>The Journal of Neuroscience</source><volume>38</volume><fpage>4163</fpage><lpage>4185</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3152-17.2018</pub-id><pub-id pub-id-type="pmid">29593054</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kato</surname> <given-names>S</given-names></name><name><surname>Kaplan</surname> <given-names>HS</given-names></name><name><surname>Schrödel</surname> <given-names>T</given-names></name><name><surname>Skora</surname> <given-names>S</given-names></name><name><surname>Lindsay</surname> <given-names>TH</given-names></name><name><surname>Yemini</surname> <given-names>E</given-names></name><name><surname>Lockery</surname> <given-names>S</given-names></name><name><surname>Zimmer</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Global brain dynamics embed the motor command sequence of <italic>Caenorhabditis elegans</italic></article-title><source>Cell</source><volume>163</volume><fpage>656</fpage><lpage>669</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.09.034</pub-id><pub-id pub-id-type="pmid">26478179</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawano</surname> <given-names>T</given-names></name><name><surname>Po</surname> <given-names>MD</given-names></name><name><surname>Gao</surname> <given-names>S</given-names></name><name><surname>Leung</surname> <given-names>G</given-names></name><name><surname>Ryu</surname> <given-names>WS</given-names></name><name><surname>Zhen</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>An imbalancing act: gap junctions reduce the backward motor circuit activity to <italic>Bias C. elegans</italic> for forward locomotion</article-title><source>Neuron</source><volume>72</volume><fpage>572</fpage><lpage>586</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.09.005</pub-id><pub-id pub-id-type="pmid">22099460</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klaus</surname> <given-names>A</given-names></name><name><surname>Alves da Silva</surname> <given-names>J</given-names></name><name><surname>Costa</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>What, if, and when to move: basal ganglia circuits and Self-Paced action initiation</article-title><source>Annual Review of Neuroscience</source><volume>42</volume><fpage>459</fpage><lpage>483</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-072116-031033</pub-id><pub-id pub-id-type="pmid">31018098</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laurent</surname> <given-names>P</given-names></name><name><surname>Soltesz</surname> <given-names>Z</given-names></name><name><surname>Nelson</surname> <given-names>GM</given-names></name><name><surname>Chen</surname> <given-names>C</given-names></name><name><surname>Arellano-Carbajal</surname> <given-names>F</given-names></name><name><surname>Levy</surname> <given-names>E</given-names></name><name><surname>de Bono</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Decoding a neural circuit controlling global animal state in <italic>C. elegans</italic></article-title><source>eLife</source><volume>4</volume><elocation-id>e04241</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.04241</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leifer</surname> <given-names>AM</given-names></name><name><surname>Fang-Yen</surname> <given-names>C</given-names></name><name><surname>Gershow</surname> <given-names>M</given-names></name><name><surname>Alkema</surname> <given-names>MJ</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Optogenetic manipulation of neural activity in freely moving <italic>Caenorhabditis elegans</italic></article-title><source>Nature Methods</source><volume>8</volume><fpage>147</fpage><lpage>152</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1554</pub-id><pub-id pub-id-type="pmid">21240279</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>Z</given-names></name><name><surname>Liu</surname> <given-names>J</given-names></name><name><surname>Zheng</surname> <given-names>M</given-names></name><name><surname>Xu</surname> <given-names>XZ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Encoding of both analog- and digital-like behavioral outputs by <italic>one C. elegans</italic> interneuron</article-title><source>Cell</source><volume>159</volume><fpage>751</fpage><lpage>765</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2014.09.056</pub-id><pub-id pub-id-type="pmid">25417153</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindsay</surname> <given-names>TH</given-names></name><name><surname>Thiele</surname> <given-names>TR</given-names></name><name><surname>Lockery</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Optogenetic analysis of synaptic transmission in the central nervous system of the nematode <italic>Caenorhabditis elegans</italic></article-title><source>Nature Communications</source><volume>2</volume><elocation-id>306</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms1304</pub-id><pub-id pub-id-type="pmid">21556060</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>P</given-names></name><name><surname>Chen</surname> <given-names>B</given-names></name><name><surname>Altun</surname> <given-names>ZF</given-names></name><name><surname>Gross</surname> <given-names>MJ</given-names></name><name><surname>Shan</surname> <given-names>A</given-names></name><name><surname>Schuman</surname> <given-names>B</given-names></name><name><surname>Hall</surname> <given-names>DH</given-names></name><name><surname>Wang</surname> <given-names>ZW</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Six innexins contribute to electrical coupling of <italic>C. elegans</italic> body-wall muscle</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e76877</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0076877</pub-id><pub-id pub-id-type="pmid">24130800</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>M</given-names></name><name><surname>Sharma</surname> <given-names>AK</given-names></name><name><surname>Shaevitz</surname> <given-names>JW</given-names></name><name><surname>Leifer</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Temporal processing and context dependency in <italic>Caenorhabditis elegans</italic> response to mechanosensation</article-title><source>eLife</source><volume>7</volume><elocation-id>e36419</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.36419</pub-id><pub-id pub-id-type="pmid">29943731</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Long</surname> <given-names>MA</given-names></name><name><surname>Jin</surname> <given-names>DZ</given-names></name><name><surname>Fee</surname> <given-names>MS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Support for a synaptic chain model of neuronal sequence generation</article-title><source>Nature</source><volume>468</volume><fpage>394</fpage><lpage>399</lpage><pub-id pub-id-type="doi">10.1038/nature09514</pub-id><pub-id pub-id-type="pmid">20972420</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louie</surname> <given-names>K</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Temporally structured replay of awake hippocampal ensemble activity during rapid eye movement sleep</article-title><source>Neuron</source><volume>29</volume><fpage>145</fpage><lpage>156</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(01)00186-6</pub-id><pub-id pub-id-type="pmid">11182087</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname> <given-names>L</given-names></name><name><surname>Wen</surname> <given-names>Q</given-names></name><name><surname>Ren</surname> <given-names>J</given-names></name><name><surname>Hendricks</surname> <given-names>M</given-names></name><name><surname>Gershow</surname> <given-names>M</given-names></name><name><surname>Qin</surname> <given-names>Y</given-names></name><name><surname>Greenwood</surname> <given-names>J</given-names></name><name><surname>Soucy</surname> <given-names>ER</given-names></name><name><surname>Klein</surname> <given-names>M</given-names></name><name><surname>Smith-Parker</surname> <given-names>HK</given-names></name><name><surname>Calvo</surname> <given-names>AC</given-names></name><name><surname>Colón-Ramos</surname> <given-names>DA</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Dynamic encoding of perception, memory, and movement in a <italic>C. elegans</italic> chemotaxis circuit</article-title><source>Neuron</source><volume>82</volume><fpage>1115</fpage><lpage>1128</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.05.010</pub-id><pub-id pub-id-type="pmid">24908490</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mainen</surname> <given-names>ZF</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Reliability of spike timing in neocortical neurons</article-title><source>Science</source><volume>268</volume><fpage>1503</fpage><lpage>1506</lpage><pub-id pub-id-type="doi">10.1126/science.7770778</pub-id><pub-id pub-id-type="pmid">7770778</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marvin</surname> <given-names>JS</given-names></name><name><surname>Borghuis</surname> <given-names>BG</given-names></name><name><surname>Tian</surname> <given-names>L</given-names></name><name><surname>Cichon</surname> <given-names>J</given-names></name><name><surname>Harnett</surname> <given-names>MT</given-names></name><name><surname>Akerboom</surname> <given-names>J</given-names></name><name><surname>Gordus</surname> <given-names>A</given-names></name><name><surname>Renninger</surname> <given-names>SL</given-names></name><name><surname>Chen</surname> <given-names>TW</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name><name><surname>Orger</surname> <given-names>MB</given-names></name><name><surname>Schreiter</surname> <given-names>ER</given-names></name><name><surname>Demb</surname> <given-names>JB</given-names></name><name><surname>Gan</surname> <given-names>WB</given-names></name><name><surname>Hires</surname> <given-names>SA</given-names></name><name><surname>Looger</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>An optimized fluorescent probe for visualizing glutamate neurotransmission</article-title><source>Nature Methods</source><volume>10</volume><fpage>162</fpage><lpage>170</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2333</pub-id><pub-id pub-id-type="pmid">23314171</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mastrogiuseppe</surname> <given-names>F</given-names></name><name><surname>Ostojic</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Linking connectivity, dynamics, and computations in Low-Rank recurrent neural networks</article-title><source>Neuron</source><volume>99</volume><fpage>609</fpage><lpage>623</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.07.003</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mohammadi</surname> <given-names>A</given-names></name><name><surname>Byrne Rodgers</surname> <given-names>J</given-names></name><name><surname>Kotera</surname> <given-names>I</given-names></name><name><surname>Ryu</surname> <given-names>WS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Behavioral response of <italic>Caenorhabditis elegans</italic> to localized thermal stimuli</article-title><source>BMC Neuroscience</source><volume>14</volume><elocation-id>66</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2202-14-66</pub-id><pub-id pub-id-type="pmid">23822173</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mori</surname> <given-names>I</given-names></name><name><surname>Ohshima</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Neural regulation of thermotaxis in <italic>Caenorhabditis elegans</italic></article-title><source>Nature</source><volume>376</volume><fpage>344</fpage><lpage>348</lpage><pub-id pub-id-type="doi">10.1038/376344a0</pub-id><pub-id pub-id-type="pmid">7630402</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Morrison</surname> <given-names>M</given-names></name><name><surname>Fieseler</surname> <given-names>C</given-names></name><name><surname>Kutz</surname> <given-names>JN</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title> Nonlinear control in the nematode C. elegans</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2001.08332">https://arxiv.org/abs/2001.08332</ext-link></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagel</surname> <given-names>G</given-names></name><name><surname>Brauner</surname> <given-names>M</given-names></name><name><surname>Liewald</surname> <given-names>JF</given-names></name><name><surname>Adeishvili</surname> <given-names>N</given-names></name><name><surname>Bamberg</surname> <given-names>E</given-names></name><name><surname>Gottschalk</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Light activation of Channelrhodopsin-2 in excitable cells of <italic>Caenorhabditis elegans</italic> Triggers Rapid Behavioral Responses</article-title><source>Current Biology</source><volume>15</volume><fpage>2279</fpage><lpage>2284</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2005.11.032</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Narayan</surname> <given-names>A</given-names></name><name><surname>Laurent</surname> <given-names>G</given-names></name><name><surname>Sternberg</surname> <given-names>PW</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Transfer characteristics of a thermosensory synapse in <italic>Caenorhabditis elegans</italic></article-title><source>PNAS</source><volume>108</volume><fpage>9667</fpage><lpage>9672</lpage><pub-id pub-id-type="doi">10.1073/pnas.1106617108</pub-id><pub-id pub-id-type="pmid">21606366</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname> <given-names>JP</given-names></name><name><surname>Shipley</surname> <given-names>FB</given-names></name><name><surname>Linder</surname> <given-names>AN</given-names></name><name><surname>Plummer</surname> <given-names>GS</given-names></name><name><surname>Liu</surname> <given-names>M</given-names></name><name><surname>Setru</surname> <given-names>SU</given-names></name><name><surname>Shaevitz</surname> <given-names>JW</given-names></name><name><surname>Leifer</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Whole-brain calcium imaging with cellular resolution in freely behaving <italic>Caenorhabditis elegans</italic></article-title><source>PNAS</source><volume>113</volume><fpage>E1074</fpage><lpage>E1081</lpage><pub-id pub-id-type="doi">10.1073/pnas.1507110112</pub-id><pub-id pub-id-type="pmid">26712014</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierce-Shimomura</surname> <given-names>JT</given-names></name><name><surname>Morse</surname> <given-names>TM</given-names></name><name><surname>Lockery</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>The fundamental role of pirouettes in <italic>Caenorhabditis elegans</italic> chemotaxis</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>9557</fpage><lpage>9569</lpage><pub-id pub-id-type="pmid">10531458</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pirri</surname> <given-names>JK</given-names></name><name><surname>McPherson</surname> <given-names>AD</given-names></name><name><surname>Donnelly</surname> <given-names>JL</given-names></name><name><surname>Francis</surname> <given-names>MM</given-names></name><name><surname>Alkema</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A tyramine-gated chloride channel coordinates distinct motor programs of a <italic>Caenorhabditis elegans</italic> escape response</article-title><source>Neuron</source><volume>62</volume><fpage>526</fpage><lpage>538</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.04.013</pub-id><pub-id pub-id-type="pmid">19477154</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pokala</surname> <given-names>N</given-names></name><name><surname>Liu</surname> <given-names>Q</given-names></name><name><surname>Gordus</surname> <given-names>A</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Inducible and titratable silencing of <italic>Caenorhabditis elegans</italic> neurons in vivo with histamine-gated chloride channels</article-title><source>PNAS</source><volume>111</volume><fpage>2770</fpage><lpage>2775</lpage><pub-id pub-id-type="doi">10.1073/pnas.1400615111</pub-id><pub-id pub-id-type="pmid">24550306</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qi</surname> <given-names>YB</given-names></name><name><surname>Garren</surname> <given-names>EJ</given-names></name><name><surname>Shu</surname> <given-names>X</given-names></name><name><surname>Tsien</surname> <given-names>RY</given-names></name><name><surname>Jin</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Photo-inducible cell ablation in <italic>Caenorhabditis elegans</italic> using the genetically encoded singlet oxygen generating protein miniSOG</article-title><source>PNAS</source><volume>109</volume><fpage>7499</fpage><lpage>7504</lpage><pub-id pub-id-type="doi">10.1073/pnas.1204096109</pub-id><pub-id pub-id-type="pmid">22532663</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rajan</surname> <given-names>K</given-names></name><name><surname>Harvey</surname> <given-names>CD</given-names></name><name><surname>Tank</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Recurrent network models of sequence generation and memory</article-title><source>Neuron</source><volume>90</volume><fpage>128</fpage><lpage>142</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.02.009</pub-id><pub-id pub-id-type="pmid">26971945</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Remington</surname> <given-names>ED</given-names></name><name><surname>Egger</surname> <given-names>SW</given-names></name><name><surname>Narain</surname> <given-names>D</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Jazayeri</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018a</year><article-title>A Dynamical Systems Perspective on Flexible Motor Timing</article-title><source>Trends in Cognitive Sciences</source><volume>22</volume><fpage>938</fpage><lpage>952</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2018.07.010</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Remington</surname> <given-names>ED</given-names></name><name><surname>Narain</surname> <given-names>D</given-names></name><name><surname>Hosseini</surname> <given-names>EA</given-names></name><name><surname>Jazayeri</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018b</year><article-title>Flexible sensorimotor computations through rapid reconfiguration of cortical dynamics</article-title><source>Neuron</source><volume>98</volume><fpage>1005</fpage><lpage>1019</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.05.020</pub-id><pub-id pub-id-type="pmid">29879384</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roberts</surname> <given-names>WM</given-names></name><name><surname>Augustine</surname> <given-names>SB</given-names></name><name><surname>Lawton</surname> <given-names>KJ</given-names></name><name><surname>Lindsay</surname> <given-names>TH</given-names></name><name><surname>Thiele</surname> <given-names>TR</given-names></name><name><surname>Izquierdo</surname> <given-names>EJ</given-names></name><name><surname>Faumont</surname> <given-names>S</given-names></name><name><surname>Lindsay</surname> <given-names>RA</given-names></name><name><surname>Britton</surname> <given-names>MC</given-names></name><name><surname>Pokala</surname> <given-names>N</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name><name><surname>Lockery</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A stochastic neuronal model predicts random search behaviors at multiple spatial scales in <italic>C. elegans</italic></article-title><source>eLife</source><volume>5</volume><elocation-id>e12572</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.12572</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seeds</surname> <given-names>AM</given-names></name><name><surname>Ravbar</surname> <given-names>P</given-names></name><name><surname>Chung</surname> <given-names>P</given-names></name><name><surname>Hampel</surname> <given-names>S</given-names></name><name><surname>Midgley</surname> <given-names>FM</given-names></name><name><surname>Mensh</surname> <given-names>BD</given-names></name><name><surname>Simpson</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A suppression hierarchy among competing motor programs drives sequential grooming in <italic>Drosophila</italic></article-title><source>eLife</source><volume>3</volume><elocation-id>e02951</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.02951</pub-id><pub-id pub-id-type="pmid">25139955</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Serrano-Saiz</surname> <given-names>E</given-names></name><name><surname>Poole</surname> <given-names>RJ</given-names></name><name><surname>Felton</surname> <given-names>T</given-names></name><name><surname>Zhang</surname> <given-names>F</given-names></name><name><surname>De La Cruz</surname> <given-names>ED</given-names></name><name><surname>Hobert</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Modular control of glutamatergic neuronal identity in <italic>C. elegans</italic> by distinct homeodomain proteins</article-title><source>Cell</source><volume>155</volume><fpage>659</fpage><lpage>673</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2013.09.052</pub-id><pub-id pub-id-type="pmid">24243022</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shmiel</surname> <given-names>T</given-names></name><name><surname>Drori</surname> <given-names>R</given-names></name><name><surname>Shmiel</surname> <given-names>O</given-names></name><name><surname>Ben-Shaul</surname> <given-names>Y</given-names></name><name><surname>Nadasdy</surname> <given-names>Z</given-names></name><name><surname>Shemesh</surname> <given-names>M</given-names></name><name><surname>Teicher</surname> <given-names>M</given-names></name><name><surname>Abeles</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Temporally precise cortical firing patterns are associated with distinct action segments</article-title><source>Journal of Neurophysiology</source><volume>96</volume><fpage>2645</fpage><lpage>2652</lpage><pub-id pub-id-type="doi">10.1152/jn.00798.2005</pub-id><pub-id pub-id-type="pmid">16885517</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Replay of neuronal firing sequences in rat Hippocampus during sleep following spatial experience</article-title><source>Science</source><volume>271</volume><fpage>1870</fpage><lpage>1873</lpage><pub-id pub-id-type="doi">10.1126/science.271.5257.1870</pub-id><pub-id pub-id-type="pmid">8596957</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Starich</surname> <given-names>TA</given-names></name><name><surname>Herman</surname> <given-names>RK</given-names></name><name><surname>Shaw</surname> <given-names>JE</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Molecular and genetic analysis of unc-7, a<italic>Caenorhabditis elegans</italic>gene required for coordinated locomotion</article-title><source>Genetics</source><volume>133</volume><fpage>527</fpage><lpage>541</lpage><pub-id pub-id-type="pmid">7681023</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Starich</surname> <given-names>TA</given-names></name><name><surname>Xu</surname> <given-names>J</given-names></name><name><surname>Skerrett</surname> <given-names>IM</given-names></name><name><surname>Nicholson</surname> <given-names>BJ</given-names></name><name><surname>Shaw</surname> <given-names>JE</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Interactions between innexins UNC-7 and UNC-9 mediate electrical synapse specificity in the <italic>Caenorhabditis elegans</italic> locomotory nervous system</article-title><source>Neural Development</source><volume>4</volume><elocation-id>16</elocation-id><pub-id pub-id-type="doi">10.1186/1749-8104-4-16</pub-id><pub-id pub-id-type="pmid">19432959</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname> <given-names>GJ</given-names></name><name><surname>Johnson-Kerner</surname> <given-names>B</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>Ryu</surname> <given-names>WS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Dimensionality and dynamics in the behavior of <italic>C. elegans</italic></article-title><source>PLOS Computational Biology</source><volume>4</volume><elocation-id>e1000028</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000028</pub-id><pub-id pub-id-type="pmid">18389066</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname> <given-names>GJ</given-names></name><name><surname>Bueno de Mesquita</surname> <given-names>M</given-names></name><name><surname>Ryu</surname> <given-names>WS</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Emergence of long timescales and stereotyped behaviors in <italic>Caenorhabditis elegans</italic></article-title><source>PNAS</source><volume>108</volume><fpage>7286</fpage><lpage>7289</lpage><pub-id pub-id-type="doi">10.1073/pnas.1007868108</pub-id><pub-id pub-id-type="pmid">21502536</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steuer Costa</surname> <given-names>W</given-names></name><name><surname>Van der Auwera</surname> <given-names>P</given-names></name><name><surname>Glock</surname> <given-names>C</given-names></name><name><surname>Liewald</surname> <given-names>JF</given-names></name><name><surname>Bach</surname> <given-names>M</given-names></name><name><surname>Schüler</surname> <given-names>C</given-names></name><name><surname>Wabnig</surname> <given-names>S</given-names></name><name><surname>Oranth</surname> <given-names>A</given-names></name><name><surname>Masurat</surname> <given-names>F</given-names></name><name><surname>Bringmann</surname> <given-names>H</given-names></name><name><surname>Schoofs</surname> <given-names>L</given-names></name><name><surname>Stelzer</surname> <given-names>EHK</given-names></name><name><surname>Fischer</surname> <given-names>SC</given-names></name><name><surname>Gottschalk</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A GABAergic and peptidergic sleep neuron as a locomotion stop neuron with compartmentalized Ca2+ dynamics</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>4095</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-12098-5</pub-id><pub-id pub-id-type="pmid">31506439</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sutton</surname> <given-names>RS</given-names></name><name><surname>Barto</surname> <given-names>AG</given-names></name></person-group><year iso-8601-date="2017">2017</year><source>Reinforcement Learning: An Introduction</source><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tumer</surname> <given-names>EC</given-names></name><name><surname>Brainard</surname> <given-names>MS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Performance variability enables adaptive plasticity of 'crystallized' adult birdsong</article-title><source>Nature</source><volume>450</volume><fpage>1240</fpage><lpage>1244</lpage><pub-id pub-id-type="doi">10.1038/nature06390</pub-id><pub-id pub-id-type="pmid">18097411</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Vreeswijk</surname> <given-names>C</given-names></name><name><surname>Sompolinsky</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Chaos in neuronal networks with balanced excitatory and inhibitory activity</article-title><source>Science</source><volume>274</volume><fpage>1724</fpage><lpage>1726</lpage><pub-id pub-id-type="doi">10.1126/science.274.5293.1724</pub-id><pub-id pub-id-type="pmid">8939866</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varshney</surname> <given-names>LR</given-names></name><name><surname>Chen</surname> <given-names>BL</given-names></name><name><surname>Paniagua</surname> <given-names>E</given-names></name><name><surname>Hall</surname> <given-names>DH</given-names></name><name><surname>Chklovskii</surname> <given-names>DB</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Structural properties of the <italic>Caenorhabditis elegans</italic> neuronal network</article-title><source>PLOS Computational Biology</source><volume>7</volume><elocation-id>e1001066</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1001066</pub-id><pub-id pub-id-type="pmid">21304930</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Venkatachalam</surname> <given-names>V</given-names></name><name><surname>Ji</surname> <given-names>N</given-names></name><name><surname>Wang</surname> <given-names>X</given-names></name><name><surname>Clark</surname> <given-names>C</given-names></name><name><surname>Mitchell</surname> <given-names>JK</given-names></name><name><surname>Klein</surname> <given-names>M</given-names></name><name><surname>Tabone</surname> <given-names>CJ</given-names></name><name><surname>Florman</surname> <given-names>J</given-names></name><name><surname>Ji</surname> <given-names>H</given-names></name><name><surname>Greenwood</surname> <given-names>J</given-names></name><name><surname>Chisholm</surname> <given-names>AD</given-names></name><name><surname>Srinivasan</surname> <given-names>J</given-names></name><name><surname>Alkema</surname> <given-names>M</given-names></name><name><surname>Zhen</surname> <given-names>M</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Pan-neuronal imaging in roaming <italic>Caenorhabditis elegans</italic></article-title><source>PNAS</source><volume>113</volume><fpage>E1082</fpage><lpage>E1088</lpage><pub-id pub-id-type="doi">10.1073/pnas.1507109113</pub-id><pub-id pub-id-type="pmid">26711989</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname> <given-names>JG</given-names></name><name><surname>Southgate</surname> <given-names>E</given-names></name><name><surname>Thomson</surname> <given-names>JN</given-names></name><name><surname>Brenner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>The structure of the nervous system of the nematode<italic>Caenorhabditis elegans</italic></article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>314</volume><fpage>1</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1098/rstb.1986.0056</pub-id><pub-id pub-id-type="pmid">22462104</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wicks</surname> <given-names>SR</given-names></name><name><surname>Roehrig</surname> <given-names>CJ</given-names></name><name><surname>Rankin</surname> <given-names>CH</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>A dynamic network simulation of the nematode tap withdrawal circuit: predictions concerning synaptic function using behavioral criteria</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>4017</fpage><lpage>4031</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-12-04017.1996</pub-id><pub-id pub-id-type="pmid">8656295</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Witvliet</surname> <given-names>D</given-names></name><name><surname>Mulcahy</surname> <given-names>B</given-names></name><name><surname>Mitchell</surname> <given-names>JK</given-names></name><name><surname>Meirovitch</surname> <given-names>Y</given-names></name><name><surname>Berger</surname> <given-names>DK</given-names></name><name><surname>Wu</surname> <given-names>Y</given-names></name><name><surname>Holmyard</surname> <given-names>DJb</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Connectomes across development reveal principles of brain maturation in <italic>C. elegans</italic> </article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.04.30.066209</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiao</surname> <given-names>Z</given-names></name><name><surname>Zhang</surname> <given-names>J</given-names></name><name><surname>Sornborger</surname> <given-names>AT</given-names></name><name><surname>Tao</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Cusps enable line attractors for neural computation</article-title><source>Physical Review E</source><volume>96</volume><elocation-id>052308</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.96.052308</pub-id><pub-id pub-id-type="pmid">29347715</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Xin</surname> <given-names>Q</given-names></name><name><surname>Zhang</surname> <given-names>X</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Open source codes for C. elegans motor sequence generation</data-title><source>GitHub</source><version designator="df3e930 ">df3e930 </version><ext-link ext-link-type="uri" xlink:href="https://github.com/Wenlab/Worm-Motor-Sequence-Generation">https://github.com/Wenlab/Worm-Motor-Sequence-Generation</ext-link></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname> <given-names>T</given-names></name><name><surname>Huo</surname> <given-names>J</given-names></name><name><surname>Shao</surname> <given-names>S</given-names></name><name><surname>Po</surname> <given-names>M</given-names></name><name><surname>Kawano</surname> <given-names>T</given-names></name><name><surname>Lu</surname> <given-names>Y</given-names></name><name><surname>Wu</surname> <given-names>M</given-names></name><name><surname>Zhen</surname> <given-names>M</given-names></name><name><surname>Wen</surname> <given-names>Q</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Descending pathway facilitates undulatory wave propagation in <italic>Caenorhabditis elegans</italic> through gap junctions</article-title><source>PNAS</source><volume>115</volume><fpage>E4493</fpage><lpage>E4502</lpage><pub-id pub-id-type="doi">10.1073/pnas.1717022115</pub-id><pub-id pub-id-type="pmid">29686107</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname> <given-names>S</given-names></name><name><surname>Chisholm</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Highly efficient optogenetic cell ablation in <italic>C. elegans</italic> using membrane-targeted miniSOG</article-title><source>Scientific Reports</source><volume>6</volume><elocation-id>21271</elocation-id><pub-id pub-id-type="doi">10.1038/srep21271</pub-id><pub-id pub-id-type="pmid">26861262</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><p>This note provides a theoretical account of the time-dependent type-II (RT) transition rate. First, we shall consider how the type-II transition arises through a rapid change of neuronal activity, represented experimentally by inter/motor neurons RIV. Second, we shall argue that the introduction of short-term synaptic depression (STD) in the inhibitory synapses may provide an explanation of the type-II transition rate.</p><sec id="s8" sec-type="appendix"><title>A biophysical model</title><p>Consider a model neuron (e.g. RIV) in the turning module receiving excitatory inputs through gap junction and inhibitory inputs through chemical synapses (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). The following equation describes the membrane potential <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> of a neuron determined by the gap junction conductance, inhibitory synaptic conductance and leaky conductance, represented by <inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf46"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf47"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> respectively (<xref ref-type="bibr" rid="bib67">Varshney et al., 2011</xref>).<disp-formula id="equ7"><label>(1.1)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mtext>c</mml:mtext></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow/><mml:mrow><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Since the excitatory gap junction input is from AIB, here we use <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> to represent the voltage of AIB in the first term. <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> denote the reversal potential of inhibitory synapse and the resting potential. <inline-formula><mml:math id="inf51"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is Gaussian white noise, which could be regarded as the fluctuation of synaptic currents and other sources of noises that are not explicitly considered in the model.</p><p>For simplicity, let us first assume that all the inputs, <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf53"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf54"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, are constants. This assumption will be relaxed later when we introduce short-term synaptic plasticity in inhibitory synapses, with which <inline-formula><mml:math id="inf55"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> decreases while <inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf57"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> remain unchanged. <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, the membrane potential of AIB is treated as a constant, provided that the backward module exhibits persistent activity during a reversal. The fixed point <inline-formula><mml:math id="inf59"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is given by<disp-formula id="equ8"><label>(1.2)</label><mml:math id="m8"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mi>e</mml:mi></mml:msup><mml:msup><mml:mi>G</mml:mi><mml:mi>g</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mi>c</mml:mi></mml:msup><mml:msup><mml:mi>G</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mi>g</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>m</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:mstyle><mml:msup><mml:mi>G</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>m</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> denotes all kinds of inputs, including gap junctions, chemical synapses and leaky channels. <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are the conductance of an input and the corresponding target voltage.</p><p>With small perturbation <inline-formula><mml:math id="inf63"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, we make an approximation<disp-formula id="equ9"><label>(1.3)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>m</mml:mi></mml:munder><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula>provided that the synaptic inputs from other neurons are insensitive to small fluctuation of the membrane potential of a postsynaptic neuron. In this case, the membrane potential can be viewed as a one-dimensional Brownian particle which obeys the following equation<disp-formula id="equ10"><label>(1.4)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf64"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mi>m</mml:mi><mml:mrow/></mml:munderover><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>, and <italic>η</italic> is gaussian white noise. We assume that the membrane potential <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> fluctuates around <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> during a reversal. Once the noise drives the membrane potential across a threshold <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, the system transits to a different state: RIV neurons become rapidly depolarized due to a nonlinear rectified activation (<xref ref-type="fig" rid="fig3">Figure 3E</xref> and <xref ref-type="fig" rid="fig7">Figure 7B</xref>), starting a turn by activating ventral muscles and terminating the reversal via feedback inhibition (<xref ref-type="fig" rid="fig7">Figure 7A and D</xref>).</p></sec><sec id="s9" sec-type="appendix"><title>Calculating the stationary probability density near fixed point with Fokker-Plank equation</title><p>Fokker-Planck equation that describes the probability density of the particle position (<xref ref-type="bibr" rid="bib21">Hänggi et al., 1990</xref>) is<disp-formula id="equ11"><label>(2.1)</label><mml:math id="m11"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>[</mml:mo><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf68"><mml:mi>σ</mml:mi></mml:math></inline-formula> determines the amplitude of noise. According to Einstein’s theory on Brownian motion, <inline-formula><mml:math id="inf69"><mml:mi>σ</mml:mi></mml:math></inline-formula> and the variance of Gaussian white noise <inline-formula><mml:math id="inf70"><mml:mi>η</mml:mi></mml:math></inline-formula> has the following relation:<disp-formula id="equ12"><label>(2.2)</label><mml:math id="m12"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>⟨</mml:mo> <mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf71"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> is the time step.</p><p>The stationary solution for Fokker-Planck equation <inline-formula><mml:math id="inf72"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is given by:<disp-formula id="equ13"><label>(2.3)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula>which is similar to Boltzmann distribution, where <inline-formula><mml:math id="inf73"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> can be viewed as the potential energy <inline-formula><mml:math id="inf74"><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf75"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> plays the role of temperature <inline-formula><mml:math id="inf76"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s10" sec-type="appendix"><title>Biophysical understanding of the type-II transition</title><p>Now consider a terminal threshold <inline-formula><mml:math id="inf77"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, beyond which the system transits to a different state. Assuming that the barrier is high and the particle is restricted in the energy well, we shall next calculate the small, albeit not negligible probability current <inline-formula><mml:math id="inf78"><mml:mi>J</mml:mi></mml:math></inline-formula> crossing the barrier.</p><p>From Fokker-Planck <xref ref-type="disp-formula" rid="equ11">Equation 2.1</xref> we have:<disp-formula id="equ14"><label>(3.1)</label><mml:math id="m14"><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>[</mml:mo><mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>[</mml:mo><mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>J</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Current <inline-formula><mml:math id="inf79"><mml:mi>J</mml:mi></mml:math></inline-formula> can be rewritten in another form<disp-formula id="equ15"><label>(3.2)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>J</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Considering a stationary state, we have <inline-formula><mml:math id="inf80"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf81"><mml:mrow><mml:mi>J</mml:mi><mml:mo>≈</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula><disp-formula id="equ16"><label>(3.3)</label><mml:math id="m16"><mml:mrow><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>[</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mi>J</mml:mi><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>Integrate <xref ref-type="disp-formula" rid="equ16">Equation 3.3</xref> between <inline-formula><mml:math id="inf82"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf83"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula><disp-formula id="equ17"><label>(3.4)</label><mml:math id="m17"><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mi>J</mml:mi><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math></disp-formula></p><p>Since the particle is restricted around <inline-formula><mml:math id="inf84"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf85"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, then we have<disp-formula id="equ18"><label>(3.5)</label><mml:math id="m18"><mml:mrow><mml:mi>J</mml:mi><mml:mtext>=</mml:mtext><mml:mfrac><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>To get <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ18">Equation 3.5</xref>, note that the probability of finding the particle around <inline-formula><mml:math id="inf87"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> should be 1, and <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> according to <xref ref-type="disp-formula" rid="equ13">Equation 2.3</xref>, we have<disp-formula id="equ19"><label>(3.6)</label><mml:math id="m19"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></disp-formula></p><p>Let <inline-formula><mml:math id="inf89"><mml:mi>A</mml:mi></mml:math></inline-formula> denote <inline-formula><mml:math id="inf90"><mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula><disp-formula id="equ20"><label>(3.7)</label><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt><mml:mi>A</mml:mi></mml:mfrac><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p> where <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>x</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle><mml:mi>d</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> is the error function.</p><p>By taking the limit <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>h</mml:mi><mml:mo>→</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf93"><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mi>h</mml:mi><mml:mo>)</mml:mo><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, we find<disp-formula id="equ21"><label>(3.8)</label><mml:math id="m21"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>A</mml:mi><mml:mrow><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>The denominator <inline-formula><mml:math id="inf94"><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ18">Equation 3.5</xref> can be calculated directly<disp-formula id="equ22"><label>(3.9)</label><mml:math id="m22"><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>A</mml:mi></mml:mrow></mml:mfrac><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>x</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle><mml:mi>d</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> is imaginary error function</p><p>Substituting <xref ref-type="disp-formula" rid="equ21">Equations 3.8–﻿3.9</xref> into <xref ref-type="disp-formula" rid="equ18">Equation 3.5</xref>, we finally obtain the transition rate <inline-formula><mml:math id="inf96"><mml:mi>r</mml:mi></mml:math></inline-formula><disp-formula id="equ23"><label>(3.10)</label><mml:math id="m23"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>π</mml:mi></mml:mfrac><mml:mo>⋅</mml:mo><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s11" sec-type="appendix"><title>Transition rate with short-term synaptic depression</title><p>Since the membrane time constant of a neuron (~10 ms) is much smaller than the behavioral timescale (~s), the probability density approaches the stationary state rapidly and <xref ref-type="disp-formula" rid="equ23">Equation 3.10</xref> is a constant rather than a function of time, resulting in an exponential distribution of the survival function. To explain the time-dependent type-II transition rate (<xref ref-type="fig" rid="fig1">Figure 1C–D</xref>), we introduce plasticity in the inhibitory synapses, analogous to short-term synaptic depression (STD).</p><p>As the inhibition onto the model neuron becomes weaker, fixed point <inline-formula><mml:math id="inf97"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> moves towards threshold <inline-formula><mml:math id="inf98"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>; <inline-formula><mml:math id="inf99"><mml:mi>k</mml:mi></mml:math></inline-formula>, which characterizes the steepness of the potential energy, becomes shallower. Both analytical calculation and simulation suggest that the change of <inline-formula><mml:math id="inf100"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> has a much larger effect on the transition rate in the region <inline-formula><mml:math id="inf101"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≪</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mtext>e</mml:mtext></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>.</p><p>In this regime, consider a simple case when <inline-formula><mml:math id="inf102"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> varies with time for a fixed <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Assuming the strength of synaptic inhibition decreases exponentially, we have<disp-formula id="equ24"><label>(4.1)</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>π</mml:mi></mml:mfrac><mml:mo>⋅</mml:mo><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msqrt><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:msqrt><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>π</mml:mi></mml:mfrac><mml:mo>⋅</mml:mo><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msqrt><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:msqrt><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>π</mml:mi></mml:mfrac><mml:mo>⋅</mml:mo><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ24">Equation 4.1</xref> was used to fit the type-II transition rate.</p></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.56942.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Zimmer</surname><given-names>Manuel</given-names></name><role>Reviewing Editor</role><aff><institution>Research Institute of Molecular Pathology, Vienna Biocenter and University of Vienna</institution><country>Austria</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>To execute competent behaviours, animals have to select, time and orchestrate their individual actions into orderly action sequences. By studying the escape response of <italic>C. elegans</italic>, Wang and colleagues provide intriguing insights into the underlying neuronal circuit mechanisms. While excitatory electrical signalling between an interneuron and a motoneuron ensures the sequential execution of actions, mutual inhibition via chemical synapses affects variable choices and timing. Such a combined excitatory feed-forward and winner-takes-all mutual-inhibition mechanism might be a general principle by which larger organism also organise more complex action sequences.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Flexible Motor Sequence Generation during Stereotyped Escape Responses&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Piali Sengupta as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers were very enthusiastic about your manuscript and this decision has been arrived at following extensive consultation among them. The Reviewing Editor has drafted this decision to help you prepare a revised submission based on the detailed comments below.</p><p>As the editors have judged that your manuscript is of interest, but as described below that additional experiments and/or analyses are required before it is published, we would like to draw your attention to changes in our revision policy that we have made in response to COVID-19 (https://elifesciences.org/articles/57162). First, because many researchers have temporarily lost access to the labs, we will give authors as much time as they need to submit revised manuscripts. We are also offering, if you choose, to post the manuscript to bioRxiv (if it is not already there) along with this decision letter and a formal designation that the manuscript is &quot;in revision at <italic>eLife</italic>&quot;. Please let us know if you would like to pursue this option.</p><p>Summary:</p><p>In &quot;Flexible Motor Sequence Generation during Stereotyped Escape Responses&quot;, Wang et al. use behavioral analysis, calcium and glutamate imaging, optogenetics and a biophysical model to investigate the circuit mechanisms that generate an action sequence, the escape response of <italic>C. elegans</italic>. First, the authors characterize the motor sequences triggered either by optogenetic activation of mechanosensory neurons ALM/AVM or via a heat stimulus. Using a biophysical model, they classify the escape response into distinct action patterns (forward-reverse-omega turn vs forward-reverse-forward). Then, the authors investigate the role of the AIB interneurons in the transition from reversal to omega turns and find evidence that gap junctions between AIB and inter/motor neuron RIV mediate this transition. The authors then investigate the role of inhibitory glutamate signaling from AIB to RIB, an interneuron upstream of RIV, in shaping the dynamics of the reverse/turn transition. Lastly, they look into the role of turning module neurons (RIV, SAA and SMB) and find some initial evidence supporting that these neurons promote reversal termination. These results strongly support a model for the generation of behavioral sequences: as opposed to a feed-forward excitatory synaptic chain mechanism, the authors propose a mechanism involving concomitant feed-forward excitation and inhibition together with feedback inhibition that enables a more flexible control of the action sequence. This model is very interesting and potentially relevant for our understanding of motor control in general.</p><p>Essential revisions:</p><p>1) Flexibility of the escape response is observed in two ways: variability in the timing of behavioral motifs, as well as the choice between transitions type I and II; these outcomes seem to be interrelated as was observed in previous work. This concept should be better introduced and made clear throughout the text.</p><p>2) The authors describe the escape response with an alternative choice between two discrete and distinct transitions (type I vs type II). Here, they rely on a cutoff at 135 degrees reorientation angle; although this cutoff was used a few times in the past literature, to date it seems largely arbitrary. Since this is a key step in their analyses convincing evidence should be provided that justifies this distinction. Is there a bimodal distributions of reorientation angles, supporting this cutoff, under the present experimental conditions?</p><p>Note, that Kaplan et al., 2020 (see Figure S5I) reported such a bimodal distribution but here the cutoff should be around 100 degrees; based on Pierce-Shimomura et al., 1999 (Figure 9) bimodality is less obvious and if at all supporting a cutoff of around 45 degrees. Moreover, Szigeti et al., 2016 makes a strong argument of a continuum in omega turns, hence no subdivision should be made at all. On the other extreme, Broekmans et al., 2016 suggest a third transition (δ turn). In the light of these different findings, the authors need to show whether under their conditions the distribution of post-reversal reorientation angles is indeed bimodal and perhaps determine a more objective cutoff to support such behavioral classification into transitions I (no turn) and II (omega turn).</p><p>3) Model: reviewer #1: The authors claim that &quot;the statistics were better described by introducing two types of transitions and the corresponding transition rates <italic>r(t)</italic>.&quot; However, no evidence is provided that this model indeed outperforms alternative models, e.g. a single transition rate with a continuum of post reversal reorientation angles. Or a model without plasticity in inhibitory synapses. Please provide additional sophisticated analysis scrutinizing the favoured model against alternative hypotheses.</p><p>The biophysical model is largely presented as a black box throughout the main text and little guidance to the general reader is provided, so that one has to work through the supplemental note, which is very difficult for the non-modeling-expert to follow. Which components of the model were crucial to obtain good fits and does the final model really outperforms simpler/alternative models?</p><p>Reviewer #2: The model isn't well integrated into the main text. The model is referred to in the Discussion and in relation to Figure 7 but appears to have a tenuous connection at this point. Ultimately, it only provides a fit function for the time-dependent transition rate. However, the Discussion suggests that the authors want to give more weight to the model as a basis for understanding the underlying neural circuit.</p><p>There are a few issues with the model as presented in the supplementary note:</p><p>- Assumptions are stated but are not justified or tested for their impact on the conclusion. For example, the assumption of the white-noise inputs from other neurons and the ad hoc assumption that the synaptic inhibition decreases exponentially.</p><p>- In the end the function has 3 (4?) free parameters to fit a curve. We are not surprised that the fit quality is good, but from the sparse description of the model it is unclear if it adds anything that goes substantially beyond just fitting an error function to the data.</p><p>4) At present, this study provides no evidence of neuronal correlates distinguishing transitions type I vs II. Simply triggering activity to reversal starts, reversal ends, and turns has been done in previous literature. The difference in mean amplitudes of AIB activity (type I vs II) could support the continuous model equally and/or be simply a result of different reversal durations. Moreover, we are surprised that it is not shown how the activity of RIV during type I vs. II differ? How is AIB and RIV activity distributed and can one predict type I vs type II just from certain features in AIB/RIV activity?</p><p>5) The <italic>inx-1, unc-7, unc-9</italic> triple mutant data are hard to interpret because UNC-7 and UNC-9 are broadly expressed and previous literature shows that these mutants have substantial locomotion defects, thus there could be pleiotropic and additive effects from mutating several innexins. This should also be made clear in the main text, since at present, the authors mention that &quot;several innexin proteins including INX-1, UNC-7 and UNC-9, are reported to express in AIB and RIV inter/motor neurons&quot; but do not mention that especially UNC-7 and UNC-9 are expressed broadly in most other neurons.</p><p>Similarly, paragraph two of subsection “Feedforward coupling between the backward and turning modules drives omega turns” read that the <italic>inx-1</italic> mutants still execute omega turns, leading the authors to conclude that multiple innexins are at play. However, it could also be that multiple neurons are at play, this possibility cannot be ruled out at this stage. The reasoning for performing the calcium imaging of RIV during AIB activation in the triple mutants is not clear. Was this experiment performed in the <italic>inx-1</italic> single mutants, which is more specifically expressed in AIB? If so, these data should be shown.</p><p>6) There is no consensus on what marks the end of an omega turn. Please provide the definition and justification for this study. Otherwise, Figure 3A and Figure 2—figure supplement 1B are difficult to interpret.</p><p>7) One thing that might be nice would be if they could address the issue of stochasticity a bit more in the Discussion. Do the authors have any speculation why the behaviour is not more deterministic? And does their model give any insight into turn and reversal coupling in unstimulated animals undergoing spontaneous reversals?</p><p>8) Language:</p><p>The type-I /type-II language makes the text hard to read. It would be much easier for readability if the two cases were using an abbreviation that connects to the behaviors, for example type-I could be called RF and type-II – RT. This way the reader doesn't have to remember a somewhat arbitrary assignment of I/II.</p><p>9) Introduction: “(…) but a deep connection between theories and experiments remains yet to be established”. What constitutes a “deep connection”? Text suggests the authors are claiming they are providing one, which we don't see based on how little the model is integrated in the main text.</p><p>10) Discussion: &quot; Several mechanisms may explain the decay of the iGluSnFR sensor signal, one being a depletion of available vesicles for release at the presynaptic site, analogous to short-term synaptic depression&quot;. It would be relevant to name alternative mechanisms here.</p><p>11) Discussion: &quot;(…) are thought to underlie several motor behaviors such as Zebra Finch singing&quot; would benefit from more examples and citations.</p><p>12) Winner-takes all strategy:</p><p>While this aspect can be understood from the data, the winner-takes all strategy should be more explicitly connected to the data in the Results section and explained in the Discussion.</p><p>13) Materials and methods:</p><p>The extensive documentation of strains, primers, promoters is great, yet it is often unclear which method was used for each figure panel. The Materials and methods section could be improved by a finer substructure with more subsections within similar groupings of experiments, that were performed using different instruments (e.g. optogenetics).</p><p>14) For multi-color imaging the Materials and methods section should explain how camera alignment was achieved.</p><p>15) Data availability:</p><p>We found the code accessible online. The link is included in the transparent reporting form but should also be repeated in the Materials and methods. A statement that custom MATLAB scripts were used is insufficient.</p><p>16) The order of neuronal activations involved in the action sequence (forward – reversal – post-reversal turn – forward) showing concomitant activity of AIB with reversal neurons followed by activation of RIV with turning neurons SMD and then RIB was shown already for immobilized worms in Kato et al., 2015. Moreover, ramping AIB activity during reversal has been shown before in Luo et al., 2014; Kato et al., 2015; Laurent et al., 2015, all for freely moving worms. The relationships of interneuron activities with reversal starts in freely moving worms (Figure 2—figure supplement 1B) were all shown already in Kato, 2015 and multiple other studies. It would be fair to credit this work and thereby highlighting better what is really new to this present study.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.56942.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Flexibility of the escape response is observed in two ways: variability in the timing of behavioral motifs, as well as the choice between transitions type I and II; these outcomes seem to be interrelated as was observed in previous work. This concept should be better introduced and made clear throughout the text.</p></disp-quote><p>Thanks for the suggestion. We have now amended the following sentences in the Introduction:</p><p>“Notably, which action to select and when to execute exhibit trial to trial variability, and they can be coupled. For example, a previous study (Gray et al., 2005) has shown that a longer reversal is likely to be followed by an omega turn.”</p><p>In the Results section:</p><p>“We first examined neuronal correlate of behavioral flexibility in action selection. We compared the AIB ramping activity (P<italic>inx-1</italic>::GCaMP6; P<italic>inx-1</italic>::wCherry) in different action sequences during either spontaneous or thermal-stimulus-triggered behaviors (Figure 2B-C and Figure 2—figure supplement 1B-C).” and “We next investigated behavioral flexibility in the timing of an action.”</p><disp-quote content-type="editor-comment"><p>2) The authors describe the escape response with an alternative choice between two discrete and distinct transitions (type I vs type II). Here, they rely on a cutoff at 135 degrees reorientation angle; although this cutoff was used a few times in the past literature, to date it seems largely arbitrary. Since this is a key step in their analyses convincing evidence should be provided that justifies this distinction. Is there a bimodal distributions of reorientation angles, supporting this cutoff, under the present experimental conditions?</p></disp-quote><p>Thanks for bringing up this important point. We reanalyzed our dataset by computing post-reversal orientation angle between the head and the tail (Figure 1—figure supplement 1A). Intuitively, the head and the tail were diametrically opposed to each other in the type-II transition; whereas they were likely aligned to each other in the type-I transition. Indeed, this was what we found from our dataset and the distribution is apparently bimodal.</p><disp-quote content-type="editor-comment"><p>Note, that Kaplan et al., 2020 (see Figure S5I) reported such a bimodal distribution but here the cutoff should be around 100 degrees; based on Pierce-Shimomura et al., 1999 (Figure 9) bimodality is less obvious and if at all supporting a cutoff of around 45 degrees. Moreover, Szigeti et al., 2016 makes a strong argument of a continuum in omega turns, hence no subdivision should be made at all. On the other extreme, Broekmans et al., 2016 suggest a third transition (δ turn). In the light of these different findings, the authors need to show whether under their conditions the distribution of post-reversal reorientation angles is indeed bimodal and perhaps determine a more objective cutoff to support such behavioral classification into transitions I (no turn) and II (omega turn).</p></disp-quote><p>Our analysis in Figure 1—figure supplement 1A supports the classification. Note that during the escape responses, most turns during the type-II transition were ended with head touching the body or tail (283/322, Figure 1—figure supplement 1A). Our experimental conditions are different from those in Szigeti et al., 2016, which argues for a continuum in omega turns.</p><disp-quote content-type="editor-comment"><p>3) Model: reviewer #1: The authors claim that &quot;the statistics were better described by introducing two types of transitions and the corresponding transition rates r(t).&quot; However, no evidence is provided that this model indeed outperforms alternative models, e.g. a single transition rate with a continuum of post reversal reorientation angles. Or a model without plasticity in inhibitory synapses. Please provide additional sophisticated analysis scrutinizing the favoured model against alternative hypotheses.</p></disp-quote><p>We apologize that the original sentences in the main text may have caused some confusion. There are three reasons that motivate us to introduce two types of transitions. First, the distribution of post-reversal orientation angles is bimodal (Figure 1—figure supplement 1A), as addressed above. Second, the distribution of reversal length is statistically better described by a bimodal distribution (Figure 1—figure supplement 1B, tested using Gaussian mixture model). Third and most importantly, our cell ablation study (Figure 6C) could abolish the type-II transition without affecting the type-I transition. The ablation led to an exponent distribution of the survival function (Figure 6C insets), which was not observed in the statistics of wild type animals. These experimental observations and analysis argue strongly for considering two types of transitions.</p><p>We thank the reviewer for asking an alternative model without plasticity in inhibitory synapses. In new Figure 7C, we showed by simulation that the type-II transition rate would be time-independent in the absence of synaptic plasticity. We also explained in the main text why this would be the case.</p><disp-quote content-type="editor-comment"><p>The biophysical model is largely presented as a black box throughout the main text and little guidance to the general reader is provided, so that one has to work through the supplemental note, which is very difficult for the non-modeling-expert to follow. Which components of the model were crucial to obtain good fits and does the final model really outperforms simpler/alternative models?</p></disp-quote><p>We agree with the reviewer that the model should be better integrated with the text. We have outlined the essential ingredients of the model in the Results section.</p><p>1) We explain why short-term synaptic plasticity could account for the time-dependent type-II transition rate. We show with both simulation and analytical arguments that an alternative model without introducing synaptic plasticity would lead to a constant transition rate (Figure 7C).</p><p>2) We fit the experimentally measured type-II transition rate with <inline-formula><mml:math id="inf104"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mi>/</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> , a formula derived from our model. One of the parameters – the decay time constant of synaptic strength <inline-formula><mml:math id="inf105"><mml:msub><mml:mi>τ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> – was directly obtained from the decay of glutamate sensor signal on RIB upon AIB optogenetic activation.</p><p>3) We show that our formula provides a better fit than the standard sigmoid function <inline-formula><mml:math id="inf106"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mi>/</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula> with the same <italic>number</italic> of free parameters <inline-formula><mml:math id="inf107"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:math></inline-formula>. We think that the introduction of imaginary error function contributes to a better fit of the transition rate (<italic>Figure 7E</italic>).</p><disp-quote content-type="editor-comment"><p>Reviewer #2: The model isn't well integrated into the main text. The model is referred to in the Discussion and in relation to Figure 7 but appears to have a tenuous connection at this point. Ultimately, it only provides a fit function for the time-dependent transition rate. However, the Discussion suggests that the authors want to give more weight to the model as a basis for understanding the underlying neural circuit.</p></disp-quote><p>These questions are similar to those raised by reviewer #1. See above for our responses.</p><disp-quote content-type="editor-comment"><p>There are a few issues with the model as presented in the supplementary note:</p><p>- Assumptions are stated but are not justified or tested for their impact on the conclusion. For example, the assumption of the white-noise inputs from other neurons and the ad hoc assumption that the synaptic inhibition decreases exponentially.</p></disp-quote><p>We apologize for being not very clear in explaining this point. <inline-formula><mml:math id="inf108"><mml:mi>η</mml:mi></mml:math></inline-formula> could be regarded as fluctuations in synaptic currents (Lindsay, Thiele and Lockery, 2011; Narayan, Laurent and Sternberg, 2011) and other sources of noises that are not explicitly considered in the model. Because we are agnostic to the temporal structure of fluctuations, by the principle of Occam’s Razor, we treated <inline-formula><mml:math id="inf109"><mml:mi>η</mml:mi></mml:math></inline-formula> as Gaussian white noise.</p><p>We made a direct connection between the decay of inhibitory synaptic strength and the glutamate fluorescent signal. Glutamate signal can be well fit by an exponential function at long timescale (Figure 4E) and we used the time constant <inline-formula><mml:math id="inf110"><mml:msub><mml:mi>τ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> as a constraint in our model. In the main text we now stated “Our hypothesis is consistent with the decay of the glutamate sensor signal on RIB neurites upon AIB stimulation (Figure 4E), an observation that may be explained by a depletion of available vesicles for release at the presynaptic site. … ”</p><disp-quote content-type="editor-comment"><p>- In the end the function has 3 (4?) free parameters to fit a curve. We are not surprised that the fit quality is good, but from the sparse description of the model it is unclear if it adds anything that goes substantially beyond just fitting an error function to the data.</p></disp-quote><p>We addressed these questions above.</p><disp-quote content-type="editor-comment"><p>4) At present, this study provides no evidence of neuronal correlates distinguishing transitions type I vs II. Simply triggering activity to reversal starts, reversal ends, and turns has been done in previous literature. The difference in mean amplitudes of AIB activity (type I vs II) could support the continuous model equally and/or be simply a result of different reversal durations. Moreover, we are surprised that it is not shown how the activity of RIV during type I vs. II differ? How is AIB and RIV activity distributed and can one predict type I vs type II just from certain features in AIB/RIV activity?</p></disp-quote><p>Thanks for the questions. Our analysis suggests that the mean amplitude of AIB calcium signal is not a good predictor of whether the animal would execute type-I or type-II transitions. A better predictor of action selection is the ramping rate of calcium fluorescent signal, that is <inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>. The higher the ramping rate of AIB, the more likely the animal will end its reversal with a turn. We have made the text more clearly, see subsection “Local interneurons in the backward module modulate motor state transitions”.</p><p>We have also added new calcium imaging experiments of RIV (Figure 3A). RIV calcium activity remained quiescent during the type-I transition and rapidly rose immediately before the type-II transition. These results have also been added to the main text, see subsection “Feedforward coupling between the backward module and the turning module drives the omega turn”.</p><disp-quote content-type="editor-comment"><p>5) The inx-1, unc-7, unc-9 triple mutant data are hard to interpret because UNC-7 and UNC-9 are broadly expressed and previous literature shows that these mutants have substantial locomotion defects, thus there could be pleiotropic and additive effects from mutating several innexins. This should also be made clear in the main text, since at present, the authors mention that &quot;several innexin proteins including INX-1, UNC-7 and UNC-9, are reported to express in AIB and RIV inter/motor neurons&quot; but do not mention that especially UNC-7 and UNC-9 are expressed broadly in most other neurons.</p></disp-quote><p>In order to better explain the rationale of our experimental design, we have rearranged the content of this section. Please see subsection “Feedforward coupling between the backward module and the turning module drives the omega turn”. Briefly, we clarify a few points.</p><p>1) In Figure 3B-C, we tested the consequence of connectivity between AIB and RIV. We probe their functional connectivity by activating AIB using Chrimson and observing calcium changes in RIV. The prominent connections between AIB and RIV is gap junction (Figure 2A), and UNC-7, UNC-9 and INX-1 are all reported to be expressed in AIB and RIV. By using the triple mutant, instead of single mutant, the gap junction between these two neurons should be more severely impaired if not completely removed.</p><p>Although these innexins are expressed widely in the nervous system, the effect of the loss of gap junctions in other circuits is irrelevant to our analysis: we are testing the effect of direct activation of AIB on RIV activity. The effect of the loss of these innexins severely impairs the increase in RIV activity in response to AIB activation, suggesting that AIB connect to RIV through gap junctions.</p><p>We now added: “Several innexin, including INX-1, UNC-7 and UNC-9, have been reported to be expressed in AIB and RIV (Altun et al., 2009; Bhattacharya et al., 2019). […] RIV remained quiescent upon AIB stimulation (Figure 3C red and Figure 3—figure supplement 1D), indicating that gap junction coupling underlies AIB stimulation-mediated RIV calcium activity.”</p><p>We also apologize for not clarifying that these innexins are widely expressed. We have amended the text to reflect this notion.</p><disp-quote content-type="editor-comment"><p>Similarly, paragraph two of subsection “Feedforward coupling between the backward and turning modules drives omega turns” read that the inx-1 mutants still execute omega turns, leading the authors to conclude that multiple innexins are at play. However, it could also be that multiple neurons are at play, this possibility cannot be ruled out at this stage. The reasoning for performing the calcium imaging of RIV during AIB activation in the triple mutants is not clear. Was this experiment performed in the inx-1 single mutants, which is more specifically expressed in AIB? If so, these data should be shown.</p></disp-quote><p>2) Our logic for performing calcium imaging experiment in triple innexin mutants, instead of single mutant like the loss of INX-1 alone, is due to high possibility that multiple innexins function redundantly at the gap junction between AIB and RIV. In this case, <italic>inx-1</italic> single mutant would only have a partial behavioral defect in turning variability and restoring INX-1 alone should restore the turning probability (Figure 3D).</p><p>However, we agree with the reviewer that these experiments did not exclude the possibility that multiple circuit pathways can trigger turning behaviors. We therefore have amended the text to reflect this notion.</p><p>“UNC-7 and UNC<italic>-</italic>9 are broadly expressed in the motor circuit, and <italic>unc-7</italic> or <italic>unc-9</italic> mutants exhibit uncoordinated movements that prohibit them from completing a motor sequence (Barnes and Hekimi, 1997; Brenner, 1974; Kawano et al., 2011; Starich et al., 1993; Xu et al., 2018. […] Because <italic>inx-1</italic> mutants were still capable of generating omega turns, we propose that either multiple innexins between AIB and RIV, or parallel circuit pathways are at play.”</p><disp-quote content-type="editor-comment"><p>6) There is no consensus on what marks the end of an omega turn. Please provide the definition and justification for this study. Otherwise, Figure 3A and Figure 2—figure supplement 1B are difficult to interpret.</p></disp-quote><p>We have amended the definition of turn ends in Behavioral assays and analysis section in Materials and methods:</p><p>“The end of a turn was identified when a worm opened its coiled posture and began to move forward.”</p><disp-quote content-type="editor-comment"><p>7) One thing that might be nice would be if they could address the issue of stochasticity a bit more in the Discussion. Do the authors have any speculation why the behaviour is not more deterministic? And does their model give any insight into turn and reversal coupling in unstimulated animals undergoing spontaneous reversals?</p></disp-quote><p>Thank you for the suggestion. We think the internal noise, such as the fluctuation of synaptic currents, may make an important contribution to behavioral variability. We have added:</p><p>“Our biophysical model suggests that noises in a neural circuit (Equation 2) contributes to behavior variability. We speculate that stochasticity in neural dynamics and behaviors may allow animals to efficiently explore the action space (Dhawale et al., 2017; Duffy et al., 2019; Tumer and Brainard, 2007); learning, by which functional connectivity between motor modules is modified through synaptic plasticity, may optimize action selection and timing (Sutton and Barto, 2017).”</p><p>Regarding turn and reversal coupling in spontaneous movements, we speculate that fluctuation of internal brain dynamics could trigger feedforward excitation between motor modules. We have added:</p><p>“In <italic>C. elegans</italic>, feedforward excitation between the backward module and the turning module (Figure 7A) can reliably trigger an omega turn followed by forward movement through strong and persistent activation of local interneurons AIB (Figure 2D and Figure 2—figure supplement 1D). In other words, the action in a motor sequence can be selected through feedforward excitation, triggered by either external sensory stimulus or fluctuations of internal circuit dynamics.”</p><disp-quote content-type="editor-comment"><p>8) Language:</p><p>The type-I /type-II language makes the text hard to read. It would be much easier for readability if the two cases were using an abbreviation that connects to the behaviors, for example type-I could be called RF and type-II – RT. This way the reader doesn't have to remember a somewhat arbitrary assignment of I/II.</p></disp-quote><p>Thanks for the suggestion. In the main text, we have changed type-I transition to type-I (RF) transition, and type-II transition to type-II (RT) transition.</p><disp-quote content-type="editor-comment"><p>9) Introduction: “(…) but a deep connection between theories and experiments remains yet to be established”. What constitutes a “deep connection”? Text suggests the authors are claiming they are providing one, which we don't see based on how little the model is integrated in the main text.</p></disp-quote><p>We have integrated the model to the Results section.</p><disp-quote content-type="editor-comment"><p>10) Discussion: &quot; Several mechanisms may explain the decay of the iGluSnFR sensor signal, one being a depletion of available vesicles for release at the presynaptic site, analogous to short-term synaptic depression&quot;. It would be relevant to name alternative mechanisms here.</p></disp-quote><p>We have revised this sentence.</p><disp-quote content-type="editor-comment"><p>11) Discussion: &quot;(…) are thought to underlie several motor behaviors such as Zebra Finch singing&quot; would benefit from more examples and citations.</p></disp-quote><p>We now added:</p><p>“Classic synaptic chain models, in which stereotyped motor sequences arise from feedforward excitation between different groups of neurons, are thought to underlie several motor behaviors such as Zebra Finch singing (Long et al., 2010). A feedforward synaptic chain may underlie the replay of spatiotemporal activity patterns in hippocampus during sleep (Louie and Wilson, 2001; Skaggs and McNaughton, 1996), and generate temporally precise firing patterns that correspond to different actions in the motor cortex of behaving monkeys (Shmiel et al., 2006). ”</p><disp-quote content-type="editor-comment"><p>12) Winner-takes all strategy:</p><p>While this aspect can be understood from the data, the winner-takes all strategy should be more explicitly connected to the data in the Results section and explained in the Discussion.</p></disp-quote><p>Thanks for the suggestion. In the Results section, we now added:</p><p>“Together, our data suggest that the feedforward inhibition (Figure 4) and feedback inhibition (Figure 6) between the backward module and the turning module implement a winner-take-all computation for action selection. The motor module with the highest level of activity stays active by suppressing the activities of other modules.”</p><p>In the Discussion section, we now added:</p><p>“Together, the feedforward coupling between the backward module and the turning module facilitates a defined sequential activity pattern, whereas the winner-take-all operation through mutual inhibition between the two modules avoids an action conflict.”</p><disp-quote content-type="editor-comment"><p>13) Materials and methods:</p><p>The extensive documentation of strains, primers, promoters is great, yet it is often unclear which method was used for each figure panel. The Materials and methods section could be improved by a finer substructure with more subsections within similar groupings of experiments, that were performed using different instruments (e.g. optogenetics).</p></disp-quote><p>Thanks. We have revised the Materials and methods section accordingly.</p><disp-quote content-type="editor-comment"><p>14) For multi-color imaging the Materials and methods section should explain how camera alignment was achieved.</p></disp-quote><p>Thanks. We have added details to the calcium imaging section:</p><p>“Green and red emission signals were captured by a 10 × objective (Nikon Plan Apo, WD = 4 mm; NA = 0.45, Japan) at 50 fps with an exposure time of 20 ms, separated by a dichroic mirror, relayed by an optical splitter (OptoSplit II, Cairn-Research, UK), and projected onto one-half of a sCMOS sensor (Andor Zyla 4.2, UK) simultaneously. Green and red channels were aligned and processed by custom-written MATLAB scripts (Xu T et al., 2018).”</p><disp-quote content-type="editor-comment"><p>15) Data availability:</p><p>We found the code accessible online. The link is included in the transparent reporting form but should also be repeated in the Materials and methods. A statement that custom MATLAB scripts were used is insufficient.</p></disp-quote><p>We have added the Data availability to the end of the Materials and methods section.</p><disp-quote content-type="editor-comment"><p>16) The order of neuronal activations involved in the action sequence (forward – reversal – post-reversal turn – forward) showing concomitant activity of AIB with reversal neurons followed by activation of RIV with turning neurons SMD and then RIB was shown already for immobilized worms in Kato et al., 2015. Moreover, ramping AIB activity during reversal has been shown before in Luo et al., 2014; Kato et al., 2015; Laurent et al., 2015, all for freely moving worms. The relationships of interneuron activities with reversal starts in freely moving worms (Figure 2—figure supplement 1B) were all shown already in Kato, 2015 and multiple other studies. It would be fair to credit this work and thereby highlighting better what is really new to this present study.</p></disp-quote><p>Thanks for pointing this out. We have revised and presented a more comprehensive review of earlier works at the beginning of the Results section. We added:</p><p>“Structural and functional studies of AIB (Gray et al., 2005; White, Southgate, Thomson and Brenner, 1986) indicate that they may play important roles in motor state transitions (Figure 2A). […] Third, AIB exhibite ramping calcium activity during reversals (Kato et al., 2015; Laurent et al., 2015; Luo et al., 2014), and finally, laser ablation of AIB significantly reduces the frequency of reversals during food search behavior (Gray et al., 2005).”</p><p>and</p><p>“How do AIB drive turning behaviors? Whole brain imaging in immobilized animals implicated that AIB and their electrically-coupled partners RIV (Figure 2A and Figure 3—figure supplement 2) exhibited sequentially activated patterns (Kato et al., 2015). We compared RIV activity patterns (P<italic>lim-4</italic>::GCaMP6) underlying different motor sequences during spontaneous behaviors.”</p></body></sub-article></article>