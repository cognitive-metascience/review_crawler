<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">41703</article-id><article-id pub-id-type="doi">10.7554/eLife.41703</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Computational mechanisms of curiosity and goal-directed exploration</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-107733"><name><surname>Schwartenbeck</surname><given-names>Philipp</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8943-9965</contrib-id><email>pschwartenbeck@gmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-120969"><name><surname>Passecker</surname><given-names>Johannes</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4366-2691</contrib-id><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-120970"><name><surname>Hauser</surname><given-names>Tobias U</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7997-8137</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-120971"><name><surname>FitzGerald</surname><given-names>Thomas HB</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-120972"><name><surname>Kronbichler</surname><given-names>Martin</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-11070"><name><surname>Friston</surname><given-names>Karl J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7984-8909</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Wellcome Centre for Human Neuroimaging</institution><institution>University College London</institution><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Centre for Cognitive Neuroscience</institution><institution>University of Salzburg</institution><addr-line><named-content content-type="city">Salzburg</named-content></addr-line><country>Austria</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Neuroscience Institute</institution><institution>Christian-Doppler-Klinik, Paracelsus Medical University Salzburg</institution><addr-line><named-content content-type="city">Salzburg</named-content></addr-line><country>Austria</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Oxford Centre for Functional MRI of the Brain, Nuffield Department of Clinical Neurosciences</institution><institution>University of Oxford</institution><addr-line><named-content content-type="city">Oxford</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Department for Cognitive Neurobiology, Center for Brain Research</institution><institution>Medical University Vienna</institution><addr-line><named-content content-type="city">Vienna</named-content></addr-line><country>Austria</country></aff><aff id="aff6"><label>6</label><institution>Max Planck University College London Centre for Computational Psychiatry and Ageing Research</institution><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff7"><label>7</label><institution content-type="dept">Department of Psychology</institution><institution>University of East Anglia</institution><addr-line><named-content content-type="city">Norwich</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff8"><label>8</label><institution>Mortimer B. Zuckerman Mind Brain and Behavior Institute</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Frank</surname><given-names>Michael J</given-names></name><role>Reviewing Editor</role><aff><institution>Brown University</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Frank</surname><given-names>Michael J</given-names></name><role>Senior Editor</role><aff><institution>Brown University</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>10</day><month>05</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e41703</elocation-id><history><date date-type="received" iso-8601-date="2018-09-04"><day>04</day><month>09</month><year>2018</year></date><date date-type="accepted" iso-8601-date="2019-04-17"><day>17</day><month>04</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Schwartenbeck et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Schwartenbeck et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-41703-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.41703.001</object-id><p>Successful behaviour depends on the right balance between maximising reward and soliciting information about the world. Here, we show how different types of information-gain emerge when casting behaviour as surprise minimisation. We present two distinct mechanisms for goal-directed exploration that express separable profiles of active sampling to reduce uncertainty. ‘Hidden state’ exploration motivates agents to sample unambiguous observations to accurately infer the (hidden) state of the world. Conversely, ‘model parameter’ exploration, compels agents to sample outcomes associated with high uncertainty, if they are informative for their representation of the task structure. We illustrate the emergence of these types of information-gain, termed active inference and active learning, and show how these forms of exploration induce distinct patterns of ‘Bayes-optimal’ behaviour. Our findings provide a computational framework for understanding how distinct levels of uncertainty systematically affect the exploration-exploitation trade-off in decision-making.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>exploration</kwd><kwd>exploitation</kwd><kwd>active learning</kwd><kwd>active inference</kwd><kwd>curiosity</kwd><kwd>intrinsic motivation</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id><institution>Wellcome</institution></institution-wrap></funding-source><award-id>088130/Z/09/Z</award-id><principal-award-recipient><name><surname>Friston</surname><given-names>Karl J</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003986</institution-id><institution>Jacobs Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Hauser</surname><given-names>Tobias U</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id><institution>Wellcome</institution></institution-wrap></funding-source><award-id>211155/Z/18/Z</award-id><principal-award-recipient><name><surname>Hauser</surname><given-names>Tobias U</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>Starting Grant 804701</award-id><principal-award-recipient><name><surname>FitzGerald</surname><given-names>Thomas HB</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Distinct computational levels of uncertainty compel agents to gain information about hidden states in the world (‘active inference’) or optimise their ‘world model’ as such (‘active learning’).</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The balance between <italic>exploitation</italic>, that is choosing the most valuable option given current beliefs about the world, and <italic>exploration</italic>, that is choosing options that allow us to forage and learn about our environment, lies at the heart of decision-making and adaptive behaviour (<xref ref-type="bibr" rid="bib19">Cohen et al., 2007</xref>; <xref ref-type="bibr" rid="bib35">Gottlieb et al., 2013</xref>). The trade-off between choosing to exploit or explore is a key focus of computational theories of behaviour in both artificial intelligence and neuroscience, such as in reinforcement learning and Bayesian models of behaviour (<xref ref-type="bibr" rid="bib27">Friston et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Friston et al., 2017a</xref>; <xref ref-type="bibr" rid="bib84">Sun et al., 2011</xref>; <xref ref-type="bibr" rid="bib85">Sutton and Barto, 1998a</xref>; <xref ref-type="bibr" rid="bib39">Houthooft et al., 2016</xref>; <xref ref-type="bibr" rid="bib38">Hauser, 2018</xref>). Importantly, recent behavioural evidence suggests that humans perform a mixture of both <italic>random</italic> and <italic>goal-directed</italic> exploration (<xref ref-type="bibr" rid="bib32">Gershman, 2018a</xref>; <xref ref-type="bibr" rid="bib98">Wilson et al., 2014a</xref>). Random exploration has been introduced in early accounts of exploratory behaviour (<xref ref-type="bibr" rid="bib20">Daw et al., 2006</xref>; <xref ref-type="bibr" rid="bib85">Sutton and Barto, 1998a</xref>). This behaviour is defined as a deviation from the currently most valuable policy by randomly sampling any other option. A classical way of formalising random exploration is via <inline-formula><mml:math id="inf1"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>-greedy or softmax choice rules, where in the latter the tendency towards randomness is governed by an inverse temperature parameter (<xref ref-type="bibr" rid="bib85">Sutton and Barto, 1998a</xref>). A more refined account of random exploration has been introduced via Thompson sampling (<xref ref-type="bibr" rid="bib91">Thompson, 1933</xref>), where an agent samples from a posterior over reward statistics and chooses the most valuable option with respect to this sample, thus taking its uncertainty over reward statistics into account (<xref ref-type="bibr" rid="bib2">Agrawal and Goyal, 2011</xref>; <xref ref-type="bibr" rid="bib80">Speekenbrink and Konstantinidis, 2015</xref>).</p><p>In contrast to random exploration, goal-directed, information-seeking exploration is guided by the uncertainty in an agent’s model of the structure of the world. This implies that agents will selectively sample options that are informative, that is that are associated with the highest uncertainty. A prominent example of uncertainty-sensitive exploration is the upper confidence bound algorithm (<xref ref-type="bibr" rid="bib1">Agrawal, 1995</xref>; <xref ref-type="bibr" rid="bib3">Auer et al., 2002</xref>; <xref ref-type="bibr" rid="bib45">Kaelbling, 1994</xref>; <xref ref-type="bibr" rid="bib85">Sutton and Barto, 1998a</xref>), which adds an uncertainty bonus (<xref ref-type="bibr" rid="bib46">Kakade and Dayan, 2002</xref>) to options that have not been sampled for a long time or that are associated with high uncertainty. See (<xref ref-type="bibr" rid="bib32">Gershman, 2018a</xref>; <xref ref-type="bibr" rid="bib33">Gershman, 2018b</xref>) for a discussion of these two types of exploration and specific predictions arising from these formulations.</p><p>It is challenging to provide a formal account of the trade-off between behaviour that aims at maximising reward and fulfils an agent’s preferences over states on the one hand, and acquiring information about the world on the other. Furthermore, an important challenge lies in moving beyond descriptive accounts of behaviour towards understanding the generative mechanisms of information gain that could be implemented by a biological system. A particularly challenging aspect lies in providing a formal account of goal-directed exploration, where agents are ‘intrinsically motivated’ to minimise uncertainty and actively learn about the world, closely linked to the concept of curiosity (<xref ref-type="bibr" rid="bib49">Kidd and Hayden, 2015</xref>; <xref ref-type="bibr" rid="bib64">Oudeyer and Kaplan, 2007</xref>). This is particularly delicate because one can dissociate different types of uncertainties. For example, if an agent is offered an option that may have a positive or a negative outcome, she will be in a state of uncertainty at two levels. First, she has no idea about the probabilities of winning or losing. For example, there could be a 50% or 99% chance of winning. Second, even if she knew the probability of winning exactly (e.g. 50%), there will still be some uncertainty about the outcome if she chose the option (whether she wins or not). These types of uncertainties have been termed unexpected and expected uncertainty (<xref ref-type="bibr" rid="bib101">Yu and Dayan, 2005</xref>) or, in economics, ambiguity and risk. The key point is that it is necessary to resolve ambiguity first before agents can assess the value of options and their associated risk.</p><p>We discuss these different aspects of uncertainty-reduction in terms of Bayesian inference, by casting choice behaviour and planning as variational probabilistic inference (<xref ref-type="bibr" rid="bib25">Friston et al., 2013</xref>; <xref ref-type="bibr" rid="bib29">Friston et al., 2017a</xref>). Here, agents are assumed to form expectations over observable states (outcomes) and infer policies that minimise the expected information-theoretic surprise about these observations. These expectations reflect an agent’s preferences over observations, such that undesired outcomes will be (a priori) unexpected and surprising. Thus, by minimising surprise, agents find policies that make visiting preferred states more likely. This information-theoretic quantity can be approximated by the expected free energy, which is a function of (approximate posterior) beliefs about the states of the world, formed under a generative model based on a Markov decision process, as will be described below.</p><p>Under this approach, different types of exploitative and exploratory behaviour emerge. The key aspect that motivates goal-directed uncertainty reduction is the mapping from (hidden) states to observations. This form of uncertainty reduction becomes relevant in partially observable problems, where in addition to inferring the best policy; agents also have to infer the current (hidden) state that caused an observation. In order to minimise uncertainty about the current state, agents can try to navigate to (observable) outcomes, where the mapping to the underlying hidden state is unambiguous. A simple example is a bird that is searching for prey: in the case of high uncertainty about the prey’s location, a bird might go to a vantage point first to minimise uncertainty about the prey’s location (i.e. the underlying hidden state), before predation. Another example is contextual inference, where an agent needs to disclose the current context (i.e. the hidden state), in order to infer what to do (e.g. is there milk in the fridge?). In case of contextual uncertainty, agents will prefer to sample outcomes that allow for precise inference about the current context (e.g. sample the fridge), before making a choice about whether to look for reward (e.g. whether or not to make tea). Formally, this means that agents will try to actively sample outcomes that have an unambiguous (low conditional entropy) mapping to hidden states – hence <italic>active inference</italic> allowing for ‘hidden state exploration’.</p><p>Importantly, the exact same imperatives apply to beliefs about model parameters that describe a subject’s knowledge about state transitions or the probability of various outcomes given the underlying (hidden) states. In other words, uncertainty about states of the world is accompanied by uncertainties about the contingencies that underwrite state transitions and the relationship between hidden states and observable outcomes. In contrast to the examples above, which reflect uncertainty about the underlying hidden state, given an agent’s model of the task this form of uncertainty reflects an agent’s ignorance about the causal structure of the model per se. For example, agents can be uncertain about the current context that determines the value of options (<italic>uncertainty about a hidden state</italic>, 'is there milk in my tea?') or uncertain about the value of options given a current context (<italic>uncertainty about model parameters</italic>, 'what does milky tea taste like?'). To reduce the latter type of uncertainty, agents can expose themselves to observations that complete ‘knowledge gaps’ and thereby learn the probabilistic structure of unknown and unexplored (novel) contingencies – hence <italic>active learning</italic> allowing for ‘model parameter exploration’.</p><p>In the following, we introduce the theoretical framework underlying active inference and active learning and use simulations to illustrate the emergence of these particular types of exploratory behaviour. We consider the resolution of uncertainty about <italic>states</italic> and <italic>parameters</italic> in terms of <italic>salience</italic> and <italic>novelty</italic> respectively; where ‘salience is to inference’ as ‘novelty is to learning’. We use a simple two-armed bandit problem in which a subject has to choose between a risky high reward and a safe low reward, where the probabilities of the risky option are unknown. Minimising expected free energy leads to curiosity-driven <italic>active learning</italic> that initially favours the novel risky option, because this option provides uncertainty reduction about an agent’s parameterisation of the task. We show how the same computational framework motivates <italic>active inference</italic> in situations where certain actions disclose salient information about hidden states, such as whether there is currently a high or low reward probability in the risky option. Based on this paradigm, we illustrate different sorts of explorative behaviour, contrast them with random exploration or purely exploitative choices, and consider how different tendencies emerge under different priors over beliefs about outcomes and the precision of those beliefs.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>A generative model of a Markov decision process</title><p>Our theoretical approach assumes that agents, such as brains or economists, minimise the expected free energy of future outcomes and hidden states. This premise allows us to derive generic update rules for action (i.e. policy selection), perception, and learning based on variational Bayes, which is described in more detail in the Materials and methods section and previous work (<xref ref-type="bibr" rid="bib25">Friston et al., 2013</xref>; <xref ref-type="bibr" rid="bib29">Friston et al., 2017a</xref>). In the following, we provide a brief conceptual outline of this computational architecture to frame the discussion of active inference and active learning in the remainder of the paper.</p><p>Active inference and active learning rest upon a generative model of observed outcomes as illustrated in <xref ref-type="fig" rid="fig1">Figure 1</xref>. This generative model is used to infer the most likely causes of outcomes, that is what is the most likely true (hidden) state of the world (e.g. a current context) that caused a given observation (e.g. a win or a loss). These states are called <italic>hidden</italic> because they are usually not or only partially observable and can only be inferred through observations. Inferring beliefs about hidden states (i.e. state estimation) is cast as an optimisation problem based on minimising variational free energy, which finds the most likely (posterior) expectations about states of the world, given current observations. This is the same optimisation found in machine learning, where (negative) free energy is known as an evidence lower bound (ELBO). Importantly, agents can also infer different policies, defined as sequences of actions, that determine the most likely observations they will make. This means that observations depend upon policies, which requires the generative model to infer expectations about future outcomes under different policies. Thus, in addition to forming posterior beliefs about hidden states, active inference and learning rest on posterior expectations about the best policy to pursue in a given context. In other words, agents are assumed to infer ‘what is the current state of the world’ and ‘what are the best actions to pursue’ based on the same generative model of the environment.</p><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.002</object-id><label>Figure 1.</label><caption><title>Generative model.</title><p>A generative model specifies the joint probability of observations and their hidden causes. The model is expressed in terms of an <italic>observation model</italic> (<italic>likelihood function</italic>, that is the probability of observations given true states) and priors over causes. Here, this likelihood is specified by a matrix (<bold>A</bold>) whose rows are the probability of an outcome under all possible hidden states, <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. The (empirical) priors in this model pertain to transitions among hidden states (<bold>B</bold>) that depend upon policies (i.e. sequences of actions), <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and beliefs about policies contingent on an agent’s precision or inverse randomness, <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>γ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, as well as (full) priors on precision (specified by a Gamma distribution) and an agent’s observation model (specified by a Dirichlet distribution). The key aspect of this generative model is that policies are more probable a priori if they minimise the (sum or path integral of) expected free energy <inline-formula><mml:math id="inf5"><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. This implies that policies become valuable if they maximise information gain by learning about model parameters (first term) or hidden states (second term) and realise an agent’s preferences. Approximate inference on the hidden causes (i.e. the current state, policy, precision and observation model) proceeds using variational Bayes (see Materials and methods). Right side depicts the dependency graph of the generative model, with blue circles denoting hidden causes that can be inferred. <inline-formula><mml:math id="inf6"><mml:mi>σ</mml:mi></mml:math></inline-formula>=Softmax function, Dir = Dirichlet distribution, <inline-formula><mml:math id="inf7"><mml:mi mathvariant="normal">Γ</mml:mi></mml:math></inline-formula>= Gamma distribution, Q = (approximate) posterior. See Materials and methods for details.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-fig1-v1.tif"/></fig><p>Variational free energy is a function of observations and probabilistic beliefs about hidden states (see Materials and methods), and can be understood as a statistical quantity that measures the mismatch (i.e. ‘surprise’) between true observations and predictions about those observations under the generative model. Minimising this mismatch ensures that these beliefs approximate the true states, given observations and maximises the (negative log) evidence of an agent’s generative model. The key assumption of active inference and active learning is that we can apply the same logic to inference about hidden states <italic>and policies</italic>. In the context of inference about policies (‘what am I going to do now?&quot;), valuable policies are those that minimise variational free energy expected under that policy, that is the mismatch between preferred and predicted outcomes, under a given policy. Effectively, this compels agents to select policies that avoid surprising outcomes. This (expected) free energy is a proxy for surprise or model evidence, and thus allows one to cast choice behaviour as minimising expected surprise or, equivalently, maximising expected model evidence (<xref ref-type="bibr" rid="bib27">Friston et al., 2015</xref>). This provides a formal grounding for the notion of the ‘value’ of a policy: the value is defined with respect to an agent’s generative model of the world, and valuable policies maximise the expected log-evidence of that model.</p><p>Importantly, as illustrated in <xref ref-type="fig" rid="fig1">Figure 1</xref> (see Materials and methods section, <xref ref-type="disp-formula" rid="equ8">Equation 7</xref> for details), the value (goodness) of a policy <inline-formula><mml:math id="inf8"><mml:mi>G</mml:mi></mml:math></inline-formula> is determined by both <italic>extrinsic</italic> reward and <italic>intrinsic</italic> information gain. Depending on an agent’s prior uncertainty about the world, gaining information can refer to exploring hidden states underlying observations, that is ‘active inference’, or exploring the correct parameterisation of the agent’s world model, that is ‘active learning’. Interestingly, these two tendencies can make opposing predictions about behaviour. Active learning allows for ‘model parameter exploration’ and compels agents to actively seek novel combinations of hidden states and outcomes to learn about the way in which outcomes are generated. Active inference allows for ‘hidden state exploration’ and compels agents to actively seek (known) salient observations that enable them to infer the underlying hidden states unambiguously. For example, if an agent is certain that a risky option has a 0.5 probability of being rewarded, this ‘certain ambiguity’ will be aversive (depending on her risk preferences, see appendix I). However, if she is uncertain about a 0.5 probability, however, this ‘uncertain ambiguity’ means there is an opportunity to resolve uncertainty and motivate active learning. In the following, we will explore this dialectic between ‘active learning’ and ‘active inference’ and speculate about their behavioural and neuronal underpinnings.</p><p>We will restrict our discussion of active inference and active learning to the context of discrete-time Markov Decision Processes (<xref ref-type="bibr" rid="bib25">Friston et al., 2013</xref>; <xref ref-type="bibr" rid="bib27">Friston et al., 2015</xref>). In this setting, agents are assumed to perform approximate inference based on variational Bayes, which casts a difficult and usually intractable inference problem as a bound optimisation problem (<xref ref-type="bibr" rid="bib7">Beal, 2003</xref>; <xref ref-type="bibr" rid="bib11">Bogacz, 2017</xref>; <xref ref-type="bibr" rid="bib34">Gershman, 2019</xref>). This implies that expectations about hidden states are updated to minimise variational free energy under a generative model. <xref ref-type="fig" rid="fig1">Figure 1</xref> provides an illustration of the Markovian generative model used in the simulations below. Observable outcomes <inline-formula><mml:math id="inf9"><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> at a particular discrete time-step depend upon true hidden states <inline-formula><mml:math id="inf10"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in the world, while hidden states evolve according to Markovian transition probabilities contingent upon actions emitted by an agent. The generative model is specified by two sets of arrays. The first, <inline-formula><mml:math id="inf11"><mml:mi mathvariant="bold-italic">A</mml:mi></mml:math></inline-formula>, maps from hidden states to outcomes. That means that <inline-formula><mml:math id="inf12"><mml:mi mathvariant="bold-italic">A</mml:mi></mml:math></inline-formula> models an agent’s observation model or the emission function in a hidden Markov model, specifying the likelihood of an observation under a given hidden state. The second, <inline-formula><mml:math id="inf13"><mml:mi mathvariant="bold-italic">B</mml:mi></mml:math></inline-formula>, prescribe the transitions among hidden states, contingent on a policy <inline-formula><mml:math id="inf14"><mml:mi>π</mml:mi></mml:math></inline-formula>. These transitions are Markovian, such that the probability of the subsequent state is fully determined by the current state and action. The arrays <bold>c</bold> and <bold>d</bold> encode prior expectations about observations, and initial states, respectively. The former specifies an agent’s preferences or utilities over outcomes and determines the ‘extrinsic’ reward component of a policy’s value, whereas the latter specifies an agent’s prior beliefs about the starting point in a task. We refer to the Appendix I for a more detailed discussion of the role of <bold>c</bold> and <bold>d</bold> in exploitative and exploratory behaviour. Finally, the precision <inline-formula><mml:math id="inf15"><mml:mi>γ</mml:mi></mml:math></inline-formula> reflects an agent’s stochasticity or randomness in behaviour. This precision term is parameterised by a rate parameter <inline-formula><mml:math id="inf16"><mml:mi>β</mml:mi></mml:math></inline-formula>, such that the expected value of <inline-formula><mml:math id="inf17"><mml:mi>γ</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf18"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>. Note that under this generative model, <inline-formula><mml:math id="inf19"><mml:mi>γ</mml:mi></mml:math></inline-formula> is a hidden state that can be inferred. In the following simulations, however, we will focus on the role of <inline-formula><mml:math id="inf20"><mml:mi>β</mml:mi></mml:math></inline-formula> in determining an agent’s overall level of stochasticity (i.e. ‘<italic>random exploration’</italic>) in behaviour, but we discuss time-dependent updates of precision in the section on potential neuronal correlates of active inference and active learning (section ‘Behavioural and neural predictions’).</p><p>In the following simulations of active learning and active inference (available online, cf. <xref ref-type="bibr" rid="bib76">Schwartenbeck, 2019a</xref>), we focus on the two kinds of information gain, namely, foraging for information about the correct parameterisation of the observation model (active learning or ‘model parameter exploration’) and using the observation model to accurately infer hidden states (active inference or ‘hidden state exploration’). We will assume that state transitions as well as the number and type of observations and initial states are already learned. How the state space and the dimensions of the different matrices that determine the mapping between these states are themselves learned is an important and interesting question but goes beyond the scope of this paper (see <xref ref-type="bibr" rid="bib53">Laversanne-Finot et al., 2018</xref> for a discussion of curiosity-driven learning of goal states, for instance).</p></sec><sec id="s2-2"><title>Model parameter exploration via active learning</title><p>In this section, we simulate the effects of active learning or ‘model parameter exploration’ on behaviour (first term in <xref ref-type="disp-formula" rid="equ8">Equation 7</xref>, Materials and methods section and <xref ref-type="fig" rid="fig1">Figure 1</xref>). The aim of this section is to characterise the behavioural phenotype of active learning in different task settings, and contrast this type of goal-directed exploration with random exploration. We simulate a simple experiment, where an agent has to choose between a safe and a risky option, such as a rat in a T-shaped maze seeking reward in one of two goal arms. . We assume that the agent knows that it can only sample one of the two arms and that one arm (left arm in <xref ref-type="fig" rid="fig2">Figure 2</xref>) contains a certain small reward whereas the other arm (right arm in <xref ref-type="fig" rid="fig2">Figure 2</xref>) contains an uncertain, high reward. Importantly, however, the agent does not know about the reward probabilities in the uncertain arm in the beginning of the experiment, but can learn about these contingencies by updating its observation model via experience-dependent learning. Learning the observation model (i.e. building the A-matrix) is cast as updating the concentration parameters of a Dirichlet distribution that specifies the mapping from hidden states to observations (see Materials and methods for details). These updates effectively reflect normalised counts of experienced particular state-outcome mappings, as will be illustrated below.</p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.003</object-id><label>Figure 2.</label><caption><title>Generative Model of a T-maze task, in which an agent (e.g. a rat) has to choose between a safe option (left arm) and an ambiguous risky option (right arm).</title><p>There are three different states in this task reflecting the rat’s location in the maze; namely, being located at the starting position or sampling the safe or risky arm. Further, there are four possible observations, namely being located at the starting position, obtaining a small reward in the safe option, obtaining a high reward in the risky option and obtaining no reward in the risky option. (<bold>A</bold>) The A-matrix (<italic>observation</italic> or <italic>emission</italic> model) maps from hidden states (columns) to observable outcome states (rows, resulting in a 4x3 matrix). There is a deterministic mapping when the agent is in the starting position or samples the safe reward. When the agent samples the risky option, there is a probabilistic mapping to receiving a high reward or no reward. The A-matrix depends on concentration parameters <inline-formula><mml:math id="inf21"><mml:mi>a</mml:mi></mml:math></inline-formula> that are updated due to observing transitions between states and observations (in this example: receiving a high or no reward in the risky option), where <inline-formula><mml:math id="inf22"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> reflects the prior concentration parameters without having made any observation yet (prior to normalisation over columns). (<bold>B</bold>) The B-matrix encodes the transition probabilities, that is the mapping from the current hidden state (columns) to the next hidden state (rows) contingent on the action taken by the agent. Thus, one needs as many B-matrices as there are different policies available to the agent (shown here: choose safe or choose risky). Here, the action simply changes the location of the agent. (<bold>C</bold>) The c-vector specifies the preferences over outcome states. In this example, the agent prefers (expects) to end up in a reward state and dislikes to end up in a no reward state, whereas it is somewhat indifferent about the ‘intermediate’ states. Note that these preferences are represented as log-probabilities (to which a softmax function is applied). For example, these preferences imply that visiting the high reward state is <inline-formula><mml:math id="inf23"><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:mn>4</mml:mn><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:mn>55</mml:mn></mml:math></inline-formula> times more likely than the starting point (<inline-formula><mml:math id="inf24"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>) at the end of a trial. The d-vector specifies beliefs about the initial state of a trial. Here, the agent knows that its initial state is the starting point of the maze.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-fig2-v1.tif"/></fig><sec id="s2-2-1"><title>Model structure</title><p>To simulate behaviour, one needs to specify the parameterisation of the generative model, which has been described in detail in previous work (<xref ref-type="bibr" rid="bib28">Friston et al., 2016</xref>). In this task, we need to define a hyperprior on the precision of policy (choice) selection (<inline-formula><mml:math id="inf25"><mml:mi>β</mml:mi></mml:math></inline-formula> in <xref ref-type="fig" rid="fig1">Figure 1</xref>), which reflects the randomness in policy selection. Unless otherwise specified, we have set <inline-formula><mml:math id="inf26"><mml:mi>β</mml:mi></mml:math></inline-formula> to a (standard rate parameter) value of 1. As shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>, we define three different states in this task – as determined by the rat’s location in the maze; namely, being located at the starting position or sampling the safe or risky arm. Further, we define four possible observations; namely, being located at the starting position, obtaining a small reward in the safe option, obtaining a high reward in the risky option and obtaining no reward in the risky option. The <bold><italic>A</italic></bold>-matrix (observation model) then determines the mapping from states to observations, while the <bold><italic>B</italic></bold>-matrix (transition probabilities) specifies the mapping between hidden states given an action (which we assume to be learned). Further, we need to specify an agent’s expectations over observations that reflect its preferences. These expectations are encoded in a <bold>c</bold>-vector, which we have set to <inline-formula><mml:math id="inf27"><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn> <mml:mi/></mml:mtd><mml:mtd><mml:mn>2</mml:mn></mml:mtd><mml:mtd><mml:mn>4</mml:mn></mml:mtd><mml:mtd><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></inline-formula> in the following simulations, reflecting an agent’s preference for being in the starting position, obtaining a safe reward, obtaining a high reward and obtaining no reward in a risky option, respectively. Note that here and below these preferences are defined as an agent’s <italic>log-expectations</italic> over outcomes, which means that preferences are passed through a softmax function and correspond to log probabilities (giving <inline-formula><mml:math id="inf28"><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>-</mml:mo><mml:mn>4.15</mml:mn> <mml:mi/></mml:mtd><mml:mtd><mml:mo>-</mml:mo><mml:mn>2.15</mml:mn></mml:mtd><mml:mtd><mml:mo>-</mml:mo><mml:mn>0.15</mml:mn></mml:mtd><mml:mtd><mml:mo>-</mml:mo><mml:mn>6.15</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></inline-formula>). For example, the definition of these preferences implies that the agent believes that visiting the high reward state is <inline-formula><mml:math id="inf29"><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:mn>4</mml:mn><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:mn>55</mml:mn></mml:math></inline-formula> times more likely than visiting the starting point (<inline-formula><mml:math id="inf30"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>) at the end of a trial. The <bold>d</bold>-vector encodes an agent’s expectations about the initial state, which was defined to reflect full certainty about starting each trial in the starting position of the maze. In simulations that include learning, we set the initial concentration parameters for obtaining a high reward (or not) to 0.25 (i.e. position (3,3) and (4,3) in the A-matrix in <xref ref-type="fig" rid="fig2">Figure 2</xref>), and these concentration parameters are updated according to a learning rate <inline-formula><mml:math id="inf31"><mml:mi>η</mml:mi></mml:math></inline-formula>, which was set to 0.5. <xref ref-type="fig" rid="fig2">Figure 2</xref> illustrates the architecture of the generative model of this task.</p></sec><sec id="s2-2-2"><title>Active learning</title><p><xref ref-type="fig" rid="fig3">Figure 3A</xref> illustrates an experiment that was simulated under active learning with an underlying high-reward probability of 50% in the risky option. The bottom panel illustrates the evolution of beliefs (concentration parameters) about the underlying emission probabilities of the task for every trial of the experiment, which in turn determine policy selection as illustrated in the first panel. Note that at the start of the experiment, the agent assigns equal probability to receiving a high reward and no reward at the risky option, but these beliefs have very low certainty (i.e. very small concentration parameters). This leads the agent to explore and gather information in the beginning of the experiment by choosing the risky option, that is to <italic>learn actively</italic>. After trial 10, the agent (correctly) assigns a probability of 50% to a high reward in the risky option, but now with higher confidence (i.e. larger concentration parameters). Consequently, the agent now prefers to exploit and sample the safe option, driven by both the expected value of this option and a preference for visiting unambiguous states. Note that this result also depends on the agent’s risk preferences, as discussed in Appendix I.</p><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.004</object-id><label>Figure 3.</label><caption><title>Simulated responses during active learning.</title><p>This figure illustrates responses and belief updates during a simulated experiment with 32 trials. The first panel illustrates whether the agent sampled the safe or risky option as indicated by the blue dots, as well as the agent’s beliefs about which action to select. Darker background implies higher certainty about selecting a particular action. The second panel illustrates the outcomes at each trial and the utility of each outcome. Outcomes are represented as coloured dots, where purple refers to a small and safe reward, green to a high reward and red to no reward in the risky option. Black bars reflect the utilities of the outcome. Note that these utilities are defined as log-probabilities over outcomes (see main text and <xref ref-type="fig" rid="fig2">Figure 2</xref>), thus a value closer to zero reflects higher utility of an outcome. The third panel illustrates the evolution of beliefs about the reward probabilities in the risky option (red = belief about no reward, green = belief about high reward). The fourth panel illustrates the evolution of the corresponding concentration parameters of the observation model over time (red = concentration parameter for the mapping from risky option to no reward, green = concentration parameter for the mapping from risky option to high reward, cf. <xref ref-type="fig" rid="fig2">Figure 2A</xref>). (<bold>A</bold>) In this example, the simulated agent makes predominantly curious and novelty-seeking choices in the beginning of the experiment. After the tenth trial, the agent is confident that the risky option provides a probability of 0.5 for receiving a high reward, which compels it to choose the safe option afterwards. (<bold>B</bold>) Same setup as in (<bold>A</bold>), but now the true reward probability of the risky option is set to 0.75. After sampling the risky option in the beginning of the experiment and learning about the high reward probability of that option, the agent becomes increasingly certain that the risky option has a high probability of a reward. This compels the agent to continue sampling the risky option and only rarely visiting the safe option with low certainty, as illustrated in panel one.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-fig3-v1.tif"/></fig><p><xref ref-type="fig" rid="fig3">Figure 3B</xref> illustrates the same task but with a reward probability of 0.75 for the risky option. Here, after a similar number of exploration trials as in <xref ref-type="fig" rid="fig3">Figure 3A</xref>, the agent becomes confident that it should select the risky option, given its higher expected value. This can be seen by the fact that the agent continues to select the risky option (blue dots) with high confidence (shaded area behind blue dots, first panel) because the risky option is mostly rewarded (green dots, second panel).</p></sec><sec id="s2-2-3"><title>The role of stochasticity in active learning</title><p>The above simulations highlight an important aspect of exploratory behaviour, namely behaviour that is goal-directed and aims at reducing uncertainty about a specific part of an agent’s model, in this example the part of the A-matrix (i.e. the observation or emission function) that specifies the mapping from sampling the risky option to obtaining a high or low reward. This means that the agent tries to gain insight into a particular part of the structure of world that it is unsure about. Importantly, this predicts that this sort of exploratory behaviour will be most prevalent if there is high uncertainty about the structure of a task, such as in the beginning of a game. This also suggests an important confound when investigating the influence of reward and uncertainty on behaviour; namely, the fact that the rewarding options will often be associated with the lowest uncertainty because they are sampled most frequently (<xref ref-type="bibr" rid="bib98">Wilson et al., 2014a</xref>). This confound highlights the importance of analysing behaviour at the beginning of an experiment when there is high uncertainty about all available options (<xref ref-type="bibr" rid="bib33">Gershman, 2018b</xref>; <xref ref-type="bibr" rid="bib32">Gershman, 2018a</xref>).</p><p>As illustrated earlier, goal-directed information-gain can be contrasted with random exploration, such as in <inline-formula><mml:math id="inf32"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>-greedy or softmax choice rules where the degree of randomness is governed by an inverse temperature parameter (<xref ref-type="bibr" rid="bib85">Sutton and Barto, 1998a</xref>). In its simplest form, random exploration implies that exploratory behaviour will not be informed by an agent’s uncertainty about different options or its uncertainty about different parts of the world. This implies that such behaviour will not decrease uncertainty per se but may cause ‘accidental’ belief-updating due to random or stochastic selection of different policies. Here, this sort of behaviour is controlled by the precision of policy selection (see <xref ref-type="disp-formula" rid="equ5">Equation 4</xref> in Materials and methods). This means that random exploration can be understood as imprecise behaviour. Importantly, the precision of behaviour does not depend on an agent’s uncertainty about the world, such that there is no predicted relationship between ‘random exploration’ and the time-course of an experiment (see below). <xref ref-type="fig" rid="fig4">Figure 4</xref> illustrates the effects of highly imprecise (<inline-formula><mml:math id="inf33"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, <xref ref-type="fig" rid="fig4">Figure 4A</xref>) and highly precise (<inline-formula><mml:math id="inf34"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, <xref ref-type="fig" rid="fig4">Figure 4B</xref>) types of behaviour. Note that the expected value of precision is the inverse of <inline-formula><mml:math id="inf35"><mml:mi>β</mml:mi></mml:math></inline-formula>, that is <inline-formula><mml:math id="inf36"><mml:mi mathvariant="double-struck">E</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.005</object-id><label>Figure 4.</label><caption><title>Effects of precision on behaviour.</title><p>Same setup as in <xref ref-type="fig" rid="fig3">Figure 3</xref>, but now with varying levels of stochasticity. (<bold>A</bold>) A high degree of <italic>random</italic> exploration results from very imprecise behaviour (<inline-formula><mml:math id="inf37"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>), whereas (<bold>B</bold>) highly precise behaviour (<inline-formula><mml:math id="inf38"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>) results in very low randomness in behaviour.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-fig4-v1.tif"/></fig></sec><sec id="s2-2-4"><title>Broken ‘active learning’</title><p>Active learning predicts that the ability to learn about the environment and minimise uncertainty is a determining factor of the value of policies. This can be illustrated by disabling the influence of active learning on policy evaluation, as shown in <xref ref-type="fig" rid="fig5">Figure 5</xref>. In this case, policies cannot be distinguished in terms of their uncertainty reduction about model parameters. Consequently, the value of policies is determined by visiting preferred and unambiguous outcomes. This means that agents will not exhibit active learning, and the only way to learn about the environment is by accidently (randomly) sampling a non-preferred option. <xref ref-type="fig" rid="fig5">Figure 5</xref> illustrates this problem: here, the true reward probability of the risky option is 0.75, but in the absence of any active learning, the agent can only find out about the value of the risky option by randomly sampling this alternative. Thus, if the agent shows very precise (non-random) behaviour (<xref ref-type="fig" rid="fig5">Figure 5A</xref>), it is very unlikely to discover that the risky option is better than the safe option, and only by showing very imprecise behaviour (<xref ref-type="fig" rid="fig5">Figure 5B</xref>) the agent will be able to develop a (weak) preference for the risky option. This illustrates an intriguing point, namely that random exploration may serve an adaptive function in the absence of goal-directed exploratory behaviour, for example due to an agent’s inability to evaluate its uncertainty about the world.</p><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.006</object-id><label>Figure 5.</label><caption><title>‘Broken’ active learning (parameter exploration).</title><p>Same setup as in <xref ref-type="fig" rid="fig3">Figure 3</xref>, but now with a true reward probability of 0.75 and no active learning as a determinant of the value of policies (first term of <xref ref-type="disp-formula" rid="equ8">Equation 7</xref>, Materials and methods section). (<bold>A</bold>) If behaviour is very precise (<inline-formula><mml:math id="inf39"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>), the agent will never find out that the risky option is more preferable than the safe option, because there is no active sampling of its environment. (<bold>B</bold>) In contrast, if the agent’s behaviour has a higher degree of randomness (low precision, <inline-formula><mml:math id="inf40"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>), then it will eventually learn about the reward statistics in the risky option from randomly sampling this alternative, and infer that it is preferable over the safe option.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-fig5-v1.tif"/></fig></sec><sec id="s2-2-5"><title>Time courses of exploratory behaviour</title><p>A general problem when investigating the role of exploration in value-based decision-making is that if an agent is allowed to move around freely, there will be a relationship between the reward statistics of an option and its associated uncertainty. Rewarding arms will be associated with a lower level of uncertainty simply because they are sampled more often (<xref ref-type="bibr" rid="bib32">Gershman, 2018a</xref>; <xref ref-type="bibr" rid="bib33">Gershman, 2018b</xref>; <xref ref-type="bibr" rid="bib98">Wilson et al., 2014a</xref>). To compare different computational architectures that might underlie exploratory behaviour and information-gain, it is therefore important to investigate the time-course of behaviour, as illustrated in <xref ref-type="fig" rid="fig6">Figure 6</xref> based on a true reward probability of 0.5 in many simulations of the active learning task. <xref ref-type="fig" rid="fig6">Figure 6A</xref> illustrates the time-course of behaviour under active learning conditioned on the concentration parameters of the A-matrix (observation model,)</p><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.007</object-id><label>Figure 6.</label><caption><title>Time-course of active learning and random exploration.</title><p>Simulations of 1000 experiments with 32 trials each under a true reward probability of 0.5. (<bold>A</bold>) Probability to choose the risky option as a function of the concentration parameters for high reward and no reward in the risky option under active learning. The probability to choose the risky (uncertain) option is high if there is high uncertainty about this option at the beginning of a task. Note how the probability of choosing the risky option decreases as the agent becomes more certain that the true reward probability of the risky option is 0.5 (gradient along the diagonal). (<bold>B</bold>) When there is no active learning but high randomness (low prior precision, <inline-formula><mml:math id="inf41"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>), there is no uncertainty-bonus for the risky option if the agent is uncertain about the reward mapping (lower left corner). The probability to sample the risky option increases only gradually with increasing certainty about a high reward probability (gradient along x-axis). (<bold>C</bold>) Average probability to choose the risky option as a function of time for active learning (as in <bold>A</bold>), random exploration (as in <bold>B</bold>) and in the absence of any learning. Active learning induces a clear preference for sampling the informative (risky) option at early trials. In contrast, random exploration without active learning does not induce a preference for uncertainty-reduction at early trials, and the probability to choose the risky option quickly converges as the estimate of the true reward probability converges to 0.5 due to random sampling of the risky option. In the absence of any learning, the probability to choose the risky option is constant and reflects the precision or randomness in an agent’s generative model (simulated with, <inline-formula><mml:math id="inf42"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-fig6-v1.tif"/></fig><p>Unsurprisingly, the agent strongly prefers to choose the risky option when she believes that the reward probability is high (right bottom corner in <xref ref-type="fig" rid="fig6">Figure 6A</xref>) and strongly prefers to choose the safe option if the probability of a high reward is low (left upper corner in <xref ref-type="fig" rid="fig6">Figure 6A</xref>). Importantly, we also observe a gradient across the diagonal, such that agents have a strong preference to choose the risky option if there is high uncertainty about its reward contingencies (i.e. both concentration parameters of the <bold><italic>A</italic></bold>-matrix are low, lower left corner in <xref ref-type="fig" rid="fig6">Figure 6A</xref>). In contrast, the probability to choose the risky option is very low if the agent is very certain that the probability to receive a high reward is 0.5 (i.e. both concentration parameters of the <bold><italic>A</italic></bold>-matrix are high, upper right corner in <xref ref-type="fig" rid="fig6">Figure 6A</xref>). In line with this, the probability of choosing the risky option over time under active learning shows that there is a very high preference for sampling the risky (uncertain) option in the beginning of a trial, which then monotonically decreases over time (<xref ref-type="fig" rid="fig6">Figure 6C</xref>).</p><p><xref ref-type="fig" rid="fig6">Figure 6B</xref> illustrates the time-course of behaviour without active learning but with a high degree of random exploration (low prior precision), where the only way to learn about the true reward probabilities is by randomly sampling the risky option. The pattern of <xref ref-type="fig" rid="fig6">Figure 6B</xref> reflects a noisier version of <xref ref-type="fig" rid="fig6">Figure 6A</xref>. Aside from the larger randomness in behaviour, there is also an important difference when uncertainty about the true reward statistics is high (lower left corner): in the absence of active learning, there is no preference for the risky option when the relevant concentration parameters of the A-matrix are both low (lower left corner of <xref ref-type="fig" rid="fig6">Figure 6B</xref>). This also becomes apparent when looking at the time course of choosing the risky option, such that there is no initial preference for the risky option reflecting uncertainty reduction in the beginning of a trial (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). Rather, the probability to select the risky option remains relatively stable across trials and reflects the overall level of randomness in behaviour. If there is no learning at all (i.e. the concentration parameters of the A-matrix do not change), the probability to choose the risky option is constant and simply reflects the stochasticity of individual behaviour (<xref ref-type="fig" rid="fig6">Figure 6C</xref>).</p></sec></sec><sec id="s2-3"><title>Hidden state exploration via active inference</title><p>In this section, we illustrate a second type of behaviour that aims at gaining information about the world, namely exploring about hidden states of a task, as reflected by the second term of <xref ref-type="disp-formula" rid="equ8">Equation 7</xref> (Materials and methods section). In contrast to ‘model parameter exploration’, which motivates <italic>active learning</italic> to reduce uncertainty about an agent’s model of the world, ‘hidden state exploration’ motivates <italic>active inference</italic> to form accurate beliefs about the current state of the world, based on an agent’s model of the task. One example of this behaviour is inferring the current context, which we illustrate in the following simulations, using a slightly adjusted version of the previous task. We now assume that the agent has learned that she could be in two possible (hidden) states in this task, namely either in a context where the risky option provides high or low probability for obtaining a reward, but this contextual information is hidden from her. However, in this version of the task, she can also choose to sample a cue before choosing the safe or risky option, which tells her about the reward probabilities (i.e. context) of the current trial.</p><sec id="s2-3-1"><title>Model structure</title><p>The generative model of the ‘hidden state exploration’ task is illustrated in <xref ref-type="fig" rid="fig7">Figure 7</xref>. We have used the same formalisation as in the previous model, except that the agent now performs inference about sampling the safe or risky option directly, or sampling a cue first that signifies the current context, namely a high (75%) or a low (25%) probability to obtain a reward in the risky option. In comparison to the previous generative model illustrated in <xref ref-type="fig" rid="fig2">Figure 2</xref>, this increases the size of the state space by the additional cue location and the (hidden) context factor, resulting in eight different (hidden) states (columns of A-matrix in <xref ref-type="fig" rid="fig7">Figure 7</xref>). The B-matrix encodes the transitions between different locations from the starting position of the maze; namely, sampling the cue, the safe option, or the risky option. The c- and d-vectors are defined analogously to the previous example, except that the d-vector now reflects a uniform prior about starting the maze in one of the two contexts. We did not include any curiosity-driven learning in these simulations, except that we allowed for experience-based updates of the d-vector in one simulation (<xref ref-type="fig" rid="fig8">Figure 8B</xref>), which describe a task in which the true state of the task can be learned gradually. Updates of the (concentration parameters of the) d-vector are implemented analogously to the updates of the A-matrix in the ‘parameter exploration’ example above. Note that, in principle, such updates would also allow the agent to continuously learn about the current reward probabilities of the risky option without sampling the cue first, analogously to the ‘model parameter exploration’ example. Importantly, however, parameter exploration will not work if the context changes rapidly, such as on a trial-by-trial basis. This provides an important illustration of the different time-courses of inference and learning (see ‘comparing model parameter and hidden state exploration’ section below). In the following, we will illustrate active inference in a task with a volatile and a stable context, and show how an agent fails to perform goal-directed exploration of hidden states if active inference is compromised.</p><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.008</object-id><label>Figure 7.</label><caption><title>Generative model of a T-maze task, in which an agent (e.g. a rat) has to choose between a safe option (left arm) and a risky option (right arm).</title><p>In contrast to the previous task, the rat can now be in two different contexts that define the reward probability of the risky option, which can be high (75%) or low (25%). Besides sampling the safe or risky option, it can now also sample a cue that signifies the current context. This results in a state space of eight possible states, defined by the factors location (starting point, cue location, safe option, risky option) and context (high or low reward probability in risky option). Further, there are seven possible observations the agent could make, namely being at the starting position, sampling the safe option, obtaining a/no reward in the risky option, and sampling the cue that indicates a high/low reward probability. (<bold>A</bold>) The A-matrix (<italic>observation</italic> or <italic>emission</italic> model) maps from hidden states (columns) to observable outcome states (rows, resulting in an 8 × 7 matrix). There is a deterministic mapping when the agent is in the starting position, samples the safe reward or samples the cue. When the agent samples the risky option, there is a probabilistic mapping to receiving a high reward or no reward that depends on the current context. In contrast to the previous example, no updates of the A-matrix take place in this task. (<bold>B</bold>) The B-matrix encodes the transition probabilities, that is the mapping from the current hidden state (columns) to the next hidden state (rows) contingent on the action taken by the agent, which simply changes the location of the agent. For simplicity, only the transition probabilities for the factor location are shown, which replicate across the two contexts (resulting in an 8 × 8 transition matrix). (<bold>C</bold>) The c-vector specifies the preferences over outcome states. In this example, the agent prefers (expects) to end up in a reward state and dislikes to end up in a no reward state, whereas it is indifferent about the ‘intermediate’ states (starting position or cue location). The d-vector specifies beliefs about the initial state of a trial. Here, the agent knows that its initial state is the starting point of the maze, but has a uniform prior over the two contexts. In experiments where the context is stable, this uniform prior can be updated to reflect experience-dependent expectations about the current context.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-fig7-v1.tif"/></fig><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.009</object-id><label>Figure 8.</label><caption><title>Simulated responses during inference.</title><p>In this experiment, the current context indicates either a high (75%) or low (25%) reward probability in the risky option. The agent can gain information about the current context of a trial by sampling a cue, which signifies the current context. (<bold>A</bold>) Simulated experiment with 32 trials and a random context that changes on a trial-by-trial basis: the first panel illustrates the choice of the agent at the beginning of a trial and the agent’s beliefs about action selection (darker means more likely). Note that the agent always chooses to sample the cue first before choosing the safe or risky option. The second panel illustrates the outcomes of every trial (purple = safe option, green = high reward in risky option, red = no reward in risky option) and their utilities (black bars, closer to zero indicates higher utility). Note that a green or red outcome indicates that the agent has chosen the risky option after sampling the cue. Dark red and green dots indicate the current context as signified by the cue (dark red = low reward probability in risky option, dark green = high reward probability in risky option). Note that the agent only samples the risky option if the cue indicates a high reward context. The third panel shows the evolution of beliefs concerning the current state (i.e. high or low reward context). (<bold>B</bold>) Same setup as before, but now with a constant context that indicates a high reward probability in the risky option. Here, the agent becomes increasingly confident that it is in a high reward context, which compels it to sample the risky option directly after about one third of the experiment, whilst gathering information in the cue location in the first third of the experiment. (<bold>C</bold>) Time-course of the probability to sample the cue first as a function of trial number in an experiment (in 1000 simulated experiments). If the context is random, there is a nearly 100% probability to sample the cue first at every trial. In a stable context, the probability to sample the cue shows a sharp decrease once the agent has gathered enough information about the current (hidden) state.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-fig8-v1.tif"/></fig></sec><sec id="s2-3-2"><title>Active inference</title><p><xref ref-type="fig" rid="fig8">Figure 8A</xref> illustrates ‘hidden state exploration’ in an experiment, where the current context cannot be learned, that is changes randomly on a trial by trial basis. <italic>Active inference</italic> predicts that the agent will always sample the cue at the beginning of every trial to reduce ambiguity about the current hidden state (context) (first and third panel of <xref ref-type="fig" rid="fig8">Figure 8A</xref> and blue line in <xref ref-type="fig" rid="fig8">Figure 8C</xref>). The subsequent behaviour in a trial depends on the information obtained at the cue. If the cue signifies a context with high reward probability (dark green dots in second panel of <xref ref-type="fig" rid="fig8">Figure 8A</xref>), the agent will choose the risky option. In contrast, if the cue indicates a context with a small reward probability, she will choose the safe option.</p><p>This simulation illustrates an important difference to the active learning simulations above: in these simulations, there is nothing to be learned about the state of the world, because the current state changes randomly on a trial by trial basis. Thus, this task could not be solved by learning the reward-mapping of the risky option, because there is no knowledge about the reward statistics that could be carried over from one trial to the next. This highlights the necessity to perform trial-by-trial inference about the current state of the world, as opposed to continuous parameter learning.</p><p><xref ref-type="fig" rid="fig8">Figure 8B</xref> illustrates simulations of the same task, but now with a stable context of a high reward probability in the risky option, allowing for experience-dependent updates of the agent’s prior over initial contexts (parameters in the d-vector, cf. <xref ref-type="fig" rid="fig7">Figure 7</xref>) based on information obtained from the cue. In the first third of the experiment, we observe the same choice bias as in <xref ref-type="fig" rid="fig8">Figure 8A</xref>, namely a preference to sample the cue first before choosing the safe or risky option. In this experiment, however, the agent always obtains the same information from the cue location, indicating a stable environment with a high reward probability in the risky option. Once the agent becomes confident enough in its beliefs about the current context, it starts to sample the risky option without sampling the cue first (cf. red line in <xref ref-type="fig" rid="fig8">Figure 8C</xref>, see Appendix I for a more detailed discussion of the ‘cost’ of sampling the cue). Note that in contrast to the ‘parameter exploration’ simulations above, the agent updates its beliefs based on the (hidden state) information provided by the cue, not the actual outcome (i.e. obtaining a reward). This can be seen in the belief-updating after trial five, for instance: the agent samples the cue, which indicates a high reward probability context, and obtains no reward from the risky option. Despite the negative outcome, it increases its belief about being in the high reward context (third panel of <xref ref-type="fig" rid="fig8">Figure 8B</xref>), due to the information obtained from the cue.</p></sec><sec id="s2-3-3"><title>Broken ‘active inference’</title><p>What happens if an agent fails to perform ‘hidden state exploration’? <xref ref-type="fig" rid="fig9">Figure 9</xref> shows simulations of behaviour when information-gain about the hidden state is not considered during policy selection. This implies that the cue location has no informative value, and is equally preferable to the starting location of the maze (because they have the same utility, cf. c-vector of <xref ref-type="fig" rid="fig8">Figure 8</xref>). This results in a constant preference for the safe option, because this agent is insensitive to the informative value of the cue. In the example illustrated in <xref ref-type="fig" rid="fig9">Figure 9</xref>, the agent fails to acknowledge that there is a high reward probability in the risky option and continues to prefer the safe option. Analogously to <xref ref-type="fig" rid="fig6">Figure 6</xref>, the only way to sample the cue (and other options) more frequently would be by increasing the randomness in behaviour.</p><fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.010</object-id><label>Figure 9.</label><caption><title>‘Broken’ active inference.</title><p>Same setup as in <xref ref-type="fig" rid="fig8">Figure 8</xref>, but now without a ‘hidden state exploration’ bias in policy selection (second term of <xref ref-type="disp-formula" rid="equ8">Equation 7</xref>, Materials and methods section). The agent fails to learn that there is a constant high reward probability for the risky option because it does not gain information about the current hidden state (context). Consequently, it continues to prefer the safe option. The probabilities to sample different options (first panel) now simply reflect the agent’s prior preferences as encoded in the c-vector (cf., <xref ref-type="fig" rid="fig7">Figure 7</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-fig9-v1.tif"/></fig></sec></sec><sec id="s2-4"><title>Comparing model parameter and hidden state exploration</title><p>We have shown that distinct response profiles for exploratory behaviour arise from different types of uncertainties, namely uncertainty about model parameters and uncertainty about hidden states. Active learning arises when agents choose options that decrease their uncertainty about the correct parameterisation of the world, such as the reward probability in a risky option. Active inference, on the other hand, aims at gathering information about the current (hidden) state of the world, for example the current context. These behavioural tendencies can align or result in opposing predictions for behaviour in different tasks. In this section, we provide direct comparisons of <italic>active learning</italic> (parameter exploration) and <italic>active inference</italic> (hidden state exploration) in different variants of the tasks introduced above. In these simulations, we use an identical parameterisation for these two types of behaviour except that active learning is only governed by the first and third terms of <xref ref-type="disp-formula" rid="equ8">Equation 7</xref> (model updating and realising preferences) and active inference is only governed by the last two terms of <xref ref-type="disp-formula" rid="equ8">Equation 7</xref> (realising preferences and minimising ambiguity). We contrast these types of goal-directed exploration with a ‘random exploration’ agent with a higher degree of stochasticity in its behaviour (see Materials and methods for details), but no bias for (goal-directed) parameter or hidden state exploration, which serves as a baseline for the other two types of exploratory behaviour. Thus, this agent will be solely governed by the (third) realising preferences term in <xref ref-type="disp-formula" rid="equ8">Equation 7</xref>, but can still update its model of the task due to randomly sampling different options. We compare these agents in situations where the risky option is either advantageous (reward probability of 85%) or disadvantageous (reward probability of 15%). We use the average cumulative reward in 100 simulated experiments with 32 trials each as a measure of performance for these three agents, where we define a low reward as one food pellet and a high reward as four food pellets that could be obtained by the agent.</p><p><xref ref-type="fig" rid="fig10">Figure 10</xref> depicts the behaviour of these three agents in the task illustrated at the top of <xref ref-type="fig" rid="fig2">Figure 2</xref>, where a rat has to choose between a certain safe and an uncertain risky option. In line with the previous simulations, we observe that the ‘parameter exploration’ agent quickly learns to prefer the risky option if there is a high reward probability (left upper panel of <xref ref-type="fig" rid="fig10">Figure 10</xref>) and to avoid the risky option if there is a low reward probability (right upper panel). The ‘random exploration’ agent also converges on these estimates, but much slower. Interestingly, we observe that the ‘hidden state exploration’ agent fails to adjust to the reward statistics of this task. This is because, from the perspective of this agent, there is no hidden state to explore that could be informative about the current reward statistics. The only way to learn about the statistics of the task would be by sampling observations that are a priori associated with high ambiguity. Such observations, however, are aversive for a pure <italic>active inference</italic> agent, because they are associated with a high entropy (ambiguity) in their mapping to underlying hidden states, which an <italic>active inference</italic> agent is compelled to <italic>minimise</italic>. Consequently, it will always sample the safe option in this task. This induces a performance pattern in which the ‘parameter exploration’ agent is superior to the other two agents if the reward probability in the risky option is high, but not if the reward probability is low and the best course of action is to sample the safe option (left and right lower panel of <xref ref-type="fig" rid="fig10">Figure 10</xref>).</p><fig id="fig10" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.011</object-id><label>Figure 10.</label><caption><title>Response profiles of a ‘state exploration’, ‘parameter exploration’ and ‘random exploration’ agent in a task that requires learning.</title><p>In the task described at the top of <xref ref-type="fig" rid="fig2">Figure 2</xref>, only the ‘parameter exploration’ agent (no state exploration) flexibly adapts to the current reward statistics, whilst the ‘state exploration’ (no parameter learning) agent fails to form a representation of the task statistics. Upper panel: probability for each of the three agents to choose the risky option if it is associated with a high (left, 85%) or low (right, 15%) reward probability. Lower panel: average cumulative reward (measured in pellets, where low reward = one pellet and high reward = four pellets) in 100 simulated experiments in a high (left) and low (right) reward probability setting, indicating an advantage for the ‘parameter exploration’ agent when the risky option is associated with a high reward probability.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-fig10-v1.tif"/></fig><p>In situations where state exploration is a necessary means for good performance, we should expect a state exploration agent to outperform the other two. <xref ref-type="fig" rid="fig11">Figure 11</xref> compares the three agents in the task introduced in <xref ref-type="fig" rid="fig8">Figure 8</xref>, where the current context (high or low reward probability in the risky option) changes unpredictably on a trial-by-trial basis but can be inferred from sampling a cue that signifies the current context. This illustrates the opposite situation to <xref ref-type="fig" rid="fig10">Figure 10</xref>: here, the ‘state exploration’ agent clearly outperforms the ‘parameter exploration’ and ‘random exploration’ agent. Importantly, this illustrates that when the context changes randomly, there is no knowledge that could be carried over from one trial to the next. Thus, <italic>active learning</italic>, which focuses on making observations that allow to transfer insights from one trial to the next, will be ineffective. In contrast, <italic>active inference</italic>, which focuses on making observations that allow for precise inference about the current hidden state (context) at a trial, provides an effective solution to this problem (cf. <xref ref-type="fig" rid="fig7">Figure 7</xref>), such that this agent always correctly infers the current context of a trial and, in consequence, whether to sample the safe or risky option.</p><fig id="fig11" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.012</object-id><label>Figure 11.</label><caption><title>Response profiles of a ‘state exploration’, ‘parameter exploration’ and ‘random exploration’ agent in a task that requires inference.</title><p>In the problem introduced in <xref ref-type="fig" rid="fig7">Figure 7</xref>, where an agent can infer the randomly changing context from a cue, ‘parameter exploration’ will be ineffective, because there is no insight that could be transferred from one trial to the next. ‘State exploration’, in contrast, provides an effective solution to this task, because it allows an agent to infer the current context on a trial-by-trial basis. Left panel: probability to choose the informative cue at the beginning of a trial. This shows that only the ‘state exploration’ agent correctly infers that it has to sample the cue at the beginning of every trial to adjust its behaviour to the current context (defined as a high or low reward probability in the risky option). Consequently, it outperforms the ‘parameter exploration’ and ‘random exploration’ agent in its cumulative earnings in this task (right panel).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-fig11-v1.tif"/></fig><p><xref ref-type="fig" rid="fig12">Figure 12</xref> compares the three agents in the task introduced in <xref ref-type="fig" rid="fig8">Figure 8</xref>, which has the same design as the previous example but now with a stable (high or low) reward context across the entire experiment. This task can be solved with both active learning and active inference. The active learning agent has a high bias for sampling the risky option in the beginning of the experiment, and will thus learn whether it is associated with a high or low reward probability. The active inference agent has a strong preference for sampling the cue in the beginning of the experiment, but can adjust its prior over the current context due to stable (high or low reward) feedback from the cue (as illustrated in <xref ref-type="fig" rid="fig8">Figure 8</xref>). Thus, both the ‘state exploration’ and ‘parameter exploration’ agent will clearly outperform the ‘random exploration’ agent.</p><fig id="fig12" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.013</object-id><label>Figure 12.</label><caption><title>Response profiles of a ‘state exploration’, ‘parameter exploration’ and ‘random exploration’ agent in a task that requires learning or inference.</title><p>Same problem as in <xref ref-type="fig" rid="fig11">Figure 11</xref>, but now with a stable high or low reward context (as in <xref ref-type="fig" rid="fig8">Figure 8B</xref>). This task can be solved by either sampling the risky option to learn about its reward statistics (‘parameter exploration’), or sampling the cue to learn about the current context and adjusting the prior over contexts due to constant feedback from the cue (‘state estimation’). This can be seen in the response profiles in the upper panel, such that the ‘parameter exploration’ agent has a strong preference for sampling the uncertain risky option in the beginning of the trial (left and right), while the ‘state exploration’ agent only starts sampling the risky option at the beginning of the trial if it has sampled the cue several times before, which always indicates a high reward context (left, cf. <xref ref-type="fig" rid="fig8">Figure 8</xref>﻿). This leads to a similar performance level of these two agents as measured by the cumulative reward, which exceeds the performance of the ‘random exploration’ agent (lower panel).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-fig12-v1.tif"/></fig><p>In sum, we have outlined different types of goal-directed exploratory behaviour that emerge under a probabilistic account of behaviour. In tasks where there is no hidden state that can inform an agent about current reward contingencies, an active learning agent performing parameter exploration will outperform an active inference agent performing hidden state exploration. In contrast, if there is an informative hidden state that changes unpredictably, active inference outperforms active learning. Only if there is a stable hidden state for a longer period in a task, both active learning (by learning from observations) and active inference (by gathering information about the hidden state) will lead to adaptive behaviour. This illustrates an important difference between active learning and active inference. Active learning is most efficient over longer timescales if information remains relevant over trials, whereas active inference is most efficient over shorter timescales, when contingencies can change on a trial-by-trial basis.</p><p>This concludes our investigation of the different response profiles of parameter exploration and hidden state estimation in different tasks (but see appendix for further simulations on the effect of other parameters on these behaviours). Next, we explore how these types of goal-directed exploration relate to empirical results on information gain in animals. We refer to Appendix 2 for a discussion of other computational frameworks of curiosity and exploration and their relation to the computational architecture we have presented here.</p></sec><sec id="s2-5"><title>Behavioural and neuronal predictions</title><p>In this section, we will discuss key behavioural and neuronal predictions of active inference and active learning, serving two purposes. First, we present testable predictions for behaviour and the neuronal mechanisms of active learning and active inference. Second, we discuss empirical evidence in relation to these predictions. Despite using a ‘rat’ as an exemplar agent above, the model-based predictions reported here are not restricted to rodents. Consequently, we will discuss various predictions by drawing from the entire animal literature.</p><sec id="s2-5-1"><title>Active inference and active learning in behaviour</title><p>While active inference and active learning provide a general and flexible architecture for inferring individual differences in behaviour (see appendix), it nevertheless makes specific predictions about the interplay of exploitative and exploratory behaviour. A key prediction is that information should have an <italic>additive</italic> effect in relation to reward (cf., <xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="disp-formula" rid="equ8">Equation 7</xref>, Materials and methods section). This means that an agent’s reward- and information-sensitivity can be manipulated separately. Importantly, there is an <italic>implicit</italic> weighting for the tendency towards exploitation and (goal-directed) exploration. This weighing is determined by two factors: the precision of prior preferences and the degree of uncertainty about the world. If there is a high degree of uncertainty in an agent’s observation model or beliefs about the current state, there will be a strong motivation for (intrinsic) active learning or active inference, respectively. If an agent’s preferences over outcomes are very precise, on the other hand, then the (extrinsic) ‘realising preferences’ component will have a stronger impact on policy selection. These precision and uncertainty effects are distinct from the precision of policy selection that determine an agent’s randomness – akin to an inverse temperature parameter in softmax response rules.</p><p>The implicit weighting between (intrinsic) information and (extrinsic) reward predicts that an agent’s information-seeking behaviour will not be directly informed by the agent’s utilities (cf., <xref ref-type="bibr" rid="bib100">Yang et al., 2016</xref>, Box 2); for example, by being more sensitive to information about highly rewarding options. This implies that states can become ‘interesting’ that are entirely ‘uninteresting’ from an extrinsic reward perspective. However, empirical evidence shows that highly rewarding options may be more <italic>salient</italic> than options that are associated with a low reward, which is an important interaction that we will discuss in more detail below (<xref ref-type="fig" rid="fig13">Figure 13</xref>).</p><fig id="fig13" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.014</object-id><label>Figure 13.</label><caption><title>Dynamic relationship between reward and information.</title><p>(<bold>A</bold>) Empirical findings from <xref ref-type="bibr" rid="bib9">Blanchard et al., 2015</xref> suggest a modulatory effect of reward on the value of information. The higher the expected reward of the options, the more do monkeys prefer the option with the additional information about the reward identity during the delay period. For example, the preference for the informative option will be stronger if both options offer 315μL of water compared to both options offering 75μL of water. (<bold>B</bold>) Assuming a constant salience of different offer amounts (i.e. a constant precision of policy selection), active learning (and inference) predicts a preference for the informative option that is constant across different reward amounts (simulated from 0 to 10 pellets). That means that the preference for the informative option is the same when both options offer 1 or 10 pellets, for instance. (<bold>C</bold>) When taking a dynamic change of the precision of policy selection for different offer amounts into account (ranging parametrically between <inline-formula><mml:math id="inf43"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> for zero pellets in both offers and <inline-formula><mml:math id="inf44"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> for 10 pellets in both offers), the simulated preferences match the empirical results from <xref ref-type="bibr" rid="bib9">Blanchard et al., 2015</xref>. This highlights the importance of the interplay between the (extrinsic and intrinsic) values of options in active learning and active inference.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-fig13-v1.tif"/><permissions><copyright-statement>© 2014 Neuron. All rights reserved</copyright-statement><copyright-year>2014</copyright-year><copyright-holder>Neuron</copyright-holder><license><license-p>Reprinted from <xref ref-type="bibr" rid="bib9">Blanchard et al. (2015)</xref> with permission from Elsevier. This panel is not available under CC-BY and is exempt from the CC-BY 4.0 license</license-p></license></permissions></fig><p>Another prediction for behaviour concerns the interplay of exploration and exploitation over time. In the simulations above, an agent’s preference distribution is assumed to be stable, whereas her uncertainty about the world changes. Consequently, goal-directed information-gain will be prevalent at the beginning of a trial, whereas exploitative behaviour and stochastic action selection remain constant throughout a task. Note that we have focused on a simple one-shot active learning or two-shot active inference task; however, the present framework also accommodates exploration-exploitation trade-offs for larger policy depths, based on the sum of the expected free energies over time (<xref ref-type="disp-formula" rid="equ5">Equation 4</xref>, Materials and methods section). This will make an agent sensitive to large information (or reward) gains at later time-steps and not just the subsequent step (i.e., the agent will not be myopic).</p><p>Several lines of experimental work suggest that animals are sensitive to information gain, and assign a value to information that competes with a reward-based (extrinsic) value of an option. Often, these behavioural tests are based on ‘cue signalling tasks’. In these tasks, an animal chooses between two options followed by a reward after a delay. Crucially, in one of these options the outcome is signalled to the animal during the delay; such that the animal can resolve its uncertainty about the upcoming reward. This additional signal – during the delay – has no instrumental value and does not shorten the delay period. It is debatable to what extend this task truly reflects an explicit value of information in exploratory (curious) behaviour as simulated above (<xref ref-type="bibr" rid="bib95">Wang et al., 2018</xref>); rather than just a change in the anticipation of rewards that may itself be attractive (<xref ref-type="bibr" rid="bib42">Iigaya et al., 2016</xref>). Either way, however, this paradigm assesses an animal’s preference for non-instrumental information, as opposed to pure exploitative behaviour. In the following, we use empirical paradigms inspired by the ‘cue signalling task’ to discuss behavioural and neuronal evidence for the encoding of ‘information’ implicit in active inference and learning.</p><p>Past work has shown that animals assign a value to gaining information about the outcome in such ‘cue signalling tasks’. Pigeons appear to prefer (on average) a two pellet option over a ‘safe’ three pellet option, if the two pellet option includes an additional signal about the reward size during the delay period (<xref ref-type="bibr" rid="bib103">Zentall and Stagner, 2012</xref>; <xref ref-type="bibr" rid="bib102">Zentall and Stagner, 2011</xref>). Analogously, starlings show a preference for an option with a lower reward probability, if there is an informative cue in the delay period (<xref ref-type="bibr" rid="bib93">Vasconcelos et al., 2015</xref>). This effect is stronger if the cue is shown shortly after the animal’s choice, as opposed to close to the outcome delivery. The same – from an economic perspective ‘suboptimal’ or 'bounded rational' behaviour – has been found in rats (<xref ref-type="bibr" rid="bib18">Chow et al., 2017</xref>), monkeys (<xref ref-type="bibr" rid="bib9">Blanchard et al., 2015</xref>; <xref ref-type="bibr" rid="bib13">Bromberg-Martin and Hikosaka, 2009</xref>; <xref ref-type="bibr" rid="bib78">Smith et al., 2017</xref>), and humans (<xref ref-type="bibr" rid="bib42">Iigaya et al., 2016</xref>).</p><p>These empirical results suggest that non-instrumental information provides an additional value to an option, in addition to its external reward. Importantly, this additional informative value can render an option more valuable even though its objective (economic or extrinsic) value is lower than alternative options. As previously noted, one central prediction from the computational framework presented here is that information provides an additive value to an option, which is evaluated alongside its extrinsic value. This resonates closely with the above results, where the signalling cue provides an additional value to an option and makes it more likely than alternative options that have higher extrinsic (economic) value.</p><p>However, the assumption that the value of an option reflects the linear sum of its extrinsic and intrinsic value may not always be true. Importantly, <xref ref-type="bibr" rid="bib9">Blanchard et al., 2015</xref> have found that monkeys are <italic>more</italic> sensitive to information if the option has higher extrinsic value (see <xref ref-type="fig" rid="fig13">Figure 13A</xref>). Using water as reward, they report that “the value of information may have a multiplicative effect on the value of water amount, just as probability does in a conventional gambling task, time does in a discounting task, or effort does in an effort task’’. That means that the more water was at stake for a given gamble, the more monkeys preferred to choose the option that included a signal during the delay period before receiving the outcome.</p><p><xref ref-type="fig" rid="fig13">Figure 13</xref> reproduces the effects reported by Blanchard et al., based on an active learning agent (assuming that now there are two options with a 0.5 probability for obtaining a reward, but with an information bonus for one of the two options). We find a strong behavioural bias towards the informative option, confirming the experimentally observed information bias in monkeys. This is in line with the additive effect of information on the value of a policy as predicted by active learning. <xref ref-type="fig" rid="fig13">Figure 13B</xref> shows that this additive effect results in a constant preference for sampling the option that is associated with higher uncertainty, irrespective of the reward magnitude of the two options (simulated for 0 to 10 pellets). In other words, the agent will consistently prefer the uncertain option if the objective values are the same (diagonal of <xref ref-type="fig" rid="fig13">Figure 13b</xref>). This agent, however, is insensitive to the total amount of reward, such that it will exhibit the same preference for the informative option if both options offer 1 or 10 units of reward, for instance, which is in contradiction with Blanchard et al.’s empirical findings. Importantly, active learning and active inference can also account for an interaction between reward and information, as reported in the original results (shown in <xref ref-type="fig" rid="fig13">Figure 13A</xref>). A supra-additive effect (as seen by Blanchard et al.) is expressed when taking a dynamic nature of the precision of policy selection into account. Previous studies have shown that reward or information modulate attention (by acting as a salience signal), which in active learning and active inference is reflected by a change in the level of the precision in policy selection (<xref ref-type="bibr" rid="bib24">Friston et al., 2012</xref>; <xref ref-type="bibr" rid="bib21">Feldman and Friston, 2010</xref>; <xref ref-type="bibr" rid="bib58">Moran et al., 2013</xref>; <xref ref-type="bibr" rid="bib75">Schwartenbeck et al., 2016</xref>). This is in line with previous work on curiosity and exploration, where attention and salience have been identified as mechanisms that modulate curiosity. For example, Kidd et al. have found that infants direct less attention towards information about overly simple or overly complex stimuli (<xref ref-type="bibr" rid="bib47">Kidd et al., 2012</xref>; <xref ref-type="bibr" rid="bib48">Kidd et al., 2014</xref>), suggesting that they ‘implicitly decide to direct attention to maintain intermediate rates of information absorption’ (<xref ref-type="bibr" rid="bib49">Kidd and Hayden, 2015</xref>). Further, it has been shown that a neuronal effect for novelty critically depends on attention towards the reward-predicting feature of a stimulus, as opposed to when subjects had to make reward-unrelated judgements about stimuli (<xref ref-type="bibr" rid="bib52">Krebs et al., 2009</xref>). Importantly, these results suggest that attention towards the rewarding properties of a stimulus modulate the effects of its informative value.</p><p><xref ref-type="fig" rid="fig13">Figure 13C</xref> illustrates this point by assuming a change in the precision of policy selection as a function of the value of options (precision ranging parametrically from <inline-formula><mml:math id="inf45"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> for zero pellets in both options to <inline-formula><mml:math id="inf46"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> for 10 pellets in both options). Assuming policy precision is itself optimised, our model expresses a remarkably similar pattern to that observed in Blanchard et al., confirming the supra-additive effect of information. Thus, from the perspective of active learning (and inference), the empirical observation of a modulatory effect of reward on information speaks to an interplay between the value of different options, which provide empirically testable behavioural and neuronal predictions (see open questions below). Note that in the simulations of <xref ref-type="fig" rid="fig13">Figure 13C</xref> we varied the (hyper-)prior (<inline-formula><mml:math id="inf47"><mml:mi>β</mml:mi></mml:math></inline-formula> in <xref ref-type="fig" rid="fig1">Figure 1</xref>) on precision in analogy to our simulations above. An extensive body of work, however, investigates the time-sensitive updating of precision (<inline-formula><mml:math id="inf48"><mml:mi>γ</mml:mi></mml:math></inline-formula> in <xref ref-type="fig" rid="fig1">Figure 1</xref>) itself by treating it as a hidden state that can be inferred (<xref ref-type="bibr" rid="bib23">FitzGerald et al., 2015</xref>; <xref ref-type="bibr" rid="bib26">Friston et al., 2014</xref>; <xref ref-type="bibr" rid="bib29">Friston et al., 2017a</xref>), to which we will return below.</p></sec><sec id="s2-5-2"><title>Neuronal mechanisms of active inference and active learning</title><p>While the focus of this work is on the computational mechanisms of exploratory and curiosity-driven behaviour, the theoretical framework of active learning and inference also makes predictions about the neuronal encoding of information and ensuing curiosity. It is thereby crucial to understand how (i) (expected) intrinsic and extrinsic value are represented neuronally, and (ii) how their neuronal encoding allows the processing and <italic>updating</italic> of information during active sampling. In particular, we will focus on two key results about the neuronal basis of information-gain and curiosity that have been reported across different species; namely, the encoding of information in subcortical dopaminergic structures and the orbitofrontal cortex (OFC).</p><p>The OFC has been reported to encode relevant task variables (predictions) during reward-guided decision-making in an orthogonal manner, such as the expected reward and the reward probability of different options (<xref ref-type="bibr" rid="bib65">Padoa-Schioppa and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib69">Rudebeck et al., 2008</xref>; <xref ref-type="bibr" rid="bib70">Rushworth et al., 2011</xref>; <xref ref-type="bibr" rid="bib82">Stalnaker et al., 2018</xref>; <xref ref-type="bibr" rid="bib99">Wilson et al., 2014b</xref>). Most importantly, <xref ref-type="bibr" rid="bib9">Blanchard et al., 2015</xref> have detected different populations of neurons in OFC that encode expected reward (water) and expected information. This implies that OFC neurons signal reward and information in an independent and not integrated way, such that ﻿OFC may serve as a kind of workshop that represents elements of reward that can guide choice but not a single domain general value signal&quot; (<xref ref-type="bibr" rid="bib49">Kidd and Hayden, 2015</xref>). This is an important observation, because exactly this form of neuronal representation is predicted by the construction of an additive value signal based on active inference and learning, and thus makes OFC a key candidate for the encoding of extrinsic and intrinsic value of different options as predicted under this framework (<xref ref-type="disp-formula" rid="equ8">Equation 7</xref> in Materials and methods).</p><p>A second key candidate for the neuronal implementation of active inference and learning is the dopaminergic midbrain. Dopamine is known to play a key role in orchestrating the cost-benefit trade-off implicated in the active inference examples above (<xref ref-type="bibr" rid="bib37">Hauser et al., 2017</xref>, see Appendix 1 for a more detailed discussion). In addition, dopamine neurons have been shown to encode ‘information prediction errors’ analogously to ‘reward prediction errors’ (<xref ref-type="bibr" rid="bib57">Montague et al., 1996</xref>; <xref ref-type="bibr" rid="bib72">Schultz et al., 1997</xref>). <xref ref-type="bibr" rid="bib13">Bromberg-Martin and Hikosaka (2009)</xref> found that dopaminergic neurons signal the information content conveyed by an informative cue in a cue signalling task, just as they signal unexpected (omissions of) reward. Importantly, this suggests that these neurons did not differentiate between (extrinsic) reward and (intrinsic) information. Second, a more recent study has shown that dopamine neurons signal prediction errors in reward as well as sensory prediction errors about reward identity that are orthogonal to the reward magnitude (<xref ref-type="bibr" rid="bib89">Takahashi et al., 2017</xref>). These results suggest that the sum firing of dopamine neurons may reflect a ‘common currency’ for prediction errors about task information and extrinsic reward. Similar signals in dopamine-rich midbrain regions have been implicated in recent studies in humans (<xref ref-type="bibr" rid="bib12">Boorman et al., 2016</xref>; <xref ref-type="bibr" rid="bib41">Iglesias et al., 2013</xref>; <xref ref-type="bibr" rid="bib61">Nour et al., 2018</xref>; <xref ref-type="bibr" rid="bib75">Schwartenbeck et al., 2016</xref>).</p><p>These empirical observations above are closely aligned with the formalism of active inference and learning as illustrated here. In the setting of active inference and learning, the function of dopamine has been linked to the role of the precision of policy selection (<xref ref-type="bibr" rid="bib26">Friston et al., 2014</xref>; <xref ref-type="bibr" rid="bib24">Friston et al., 2012</xref>). The role of this precision is twofold: as illustrated above, the (hyper-)prior on precision (<inline-formula><mml:math id="inf49"><mml:mi>β</mml:mi></mml:math></inline-formula> in <xref ref-type="fig" rid="fig1">Figure 1</xref>) reflects the overall level of randomness (goal directedness) in behaviour. Additionally, precision is updated on a trial-by-trial basis based on variational (approximate) inference (not discussed or simulated above). These variational precision updates have the form of a prediction error between the prior and posterior expected free energy of policies (as described in <xref ref-type="fig" rid="fig1">Figure 1</xref> or <xref ref-type="disp-formula" rid="equ8">Equation 7</xref> in Materials and methods, see <xref ref-type="bibr" rid="bib29">Friston et al. (2017a)</xref> for a detailed treatment and derivation of these variational updates). In other words, the predicted dopamine responses will reflect the difference between the expected (prior) and actual (posterior) reward, model update and knowledge about hidden states (i.e. the difference between prior and posterior beliefs about the value of a policy). These predictions for dopaminergic signals correspond closely with empirical results reported in (<xref ref-type="bibr" rid="bib13">Bromberg-Martin and Hikosaka, 2009</xref>; <xref ref-type="bibr" rid="bib89">Takahashi et al., 2017</xref>), since an ‘information’ or ‘identity’ prediction error results from the difference between prior and posterior beliefs about model parameters and hidden states.</p><p>Dopaminergic neurons are a key target area of OFC, and it has been hypothesised that the prediction error signal in dopamine neurons may critically rely on OFC input (<xref ref-type="bibr" rid="bib49">Kidd and Hayden, 2015</xref>; <xref ref-type="bibr" rid="bib88">Takahashi et al., 2011</xref>), and that error-driven learning critically depends on the interplay between those two regions (<xref ref-type="bibr" rid="bib44">Jones et al., 2012</xref>; <xref ref-type="bibr" rid="bib87">Takahashi et al., 2009</xref>). Intriguingly, these speculations resonate with the fact that it required both the (intrinsic and extrinsic) value of options as well as the precision of policy selection in <xref ref-type="fig" rid="fig13">Figure 13C</xref> to reproduce the behavioural effect reported by Blanchard et al. (<xref ref-type="fig" rid="fig13">Figure 13A</xref>). Taken together, these simulations and empirical results suggest that active inference and active learning may critically depend on a factorised (intrinsic and extrinsic) value representation in OFC and a unified update signal in dopaminergic nuclei.</p><p>It is important to note that, besides the encoding of information in the OFC and dopaminergic nuclei, the physiological basis of exploration and active sampling has also been associated with other neuronal mechanisms. There has been much recent interest in the neuronal basis of active sensing in animals, such as whisking (<xref ref-type="bibr" rid="bib16">Bush et al., 2016</xref>; <xref ref-type="bibr" rid="bib17">Campagner et al., 2016</xref>; <xref ref-type="bibr" rid="bib36">Grant et al., 2009</xref>; <xref ref-type="bibr" rid="bib68">Ranade et al., 2013</xref>; <xref ref-type="bibr" rid="bib100">Yang et al., 2016</xref>). Further, in humans exploratory choices and information gain have been correlated with activity in the insula and dorsal anterior cingulate cortex (<xref ref-type="bibr" rid="bib10">Blanchard and Gershman, 2018</xref>; <xref ref-type="bibr" rid="bib51">Kolling et al., 2012</xref>; <xref ref-type="bibr" rid="bib60">Muller et al., 2019</xref>; <xref ref-type="bibr" rid="bib92">van Lieshout et al., 2018</xref>) as well as the rostrolateral prefrontal cortex (<xref ref-type="bibr" rid="bib5">Badre et al., 2012</xref>; <xref ref-type="bibr" rid="bib20">Daw et al., 2006</xref>; <xref ref-type="bibr" rid="bib54">Ligneul et al., 2018</xref>).</p></sec><sec id="s2-5-3"><title>Outstanding questions</title><p>While some of the key predictions from active learning and inference are closely aligned with empirical results, open questions remain, which we briefly outline below.</p><list list-type="bullet"><list-item><p>It remains to be established to what extent active learning and active inference are mechanisms dissociable in behaviour and brain function, and to what degree these mechanisms make use of different cognitive and physiological resources. For instance, it is unclear whether the preference for advance information in the ‘cue signalling task’ can be attributed to active learning or active inference. One possible way to dissociate these processes is by investigating the time-course of information-seeking behaviour. Active learning predicts a decrease of exploratory behaviour over time, because the agent’s uncertainty over its observation model decreases with accumulated sensory experience. Active inference does not necessarily predict a decrease in information seeking in tasks where there is no enduring context that could be learned (<xref ref-type="fig" rid="fig7">Figure 7</xref>). Under such circumstances, active inference predicts a constant preference for sampling a cue (which appears more in line with empirical results from the ‘cue signalling task’).</p></list-item><list-item><p>Timing effects have been shown to modulate information gain behaviour in the ‘cue signalling task’, such as a stronger effect of an informative cue right after a choice – as opposed to closer in time to the presentation of the outcome (<xref ref-type="bibr" rid="bib93">Vasconcelos et al., 2015</xref>). Our framework currently makes no predictions about such temporal effects but could well be extended to accommodate such timing effects.</p></list-item><list-item><p>Similarly, in the framework presented here one would not expect to see horizon effects in behaviour, such that information about the task becomes more valuable with an extended temporal horizon. This contrasts with empirical results on exploration (<xref ref-type="bibr" rid="bib98">Wilson et al., 2014a</xref>). It will be important for future work to accommodate such effects, for example, in terms of an (inverse) discounting parameter for information.</p></list-item><list-item><p>Active inference and active learning predict a factorised value representation in its neuronal encoding, such as in OFC neurons. Importantly, in a task where animals can gain information about models and states, ‘value’ neurons should exhibit a factorised representation for the expected information about model parameters, states and reward. This is in line with but goes beyond a factorised representation of information and value as reported elsewhere (<xref ref-type="bibr" rid="bib9">Blanchard et al., 2015</xref>).</p></list-item><list-item><p>If the value of a policy is constituted by potential information about models, states and reward, then we would expect to see a prediction error for these three quantities. For example, dopamine neurons should signal the difference between expected and actual reward, but also between the expected and actual information about model parameters and hidden states (in line with <xref ref-type="bibr" rid="bib89">Takahashi et al., 2017</xref>), for instance). Further, given that information about models and states as well as reward are measured in a common currency (i.e., expected free energy), one would expect to see trade-offs between those quantities. For example, one would expect a positive dopaminergic response for a mildly aversive but highly informative outcome.</p></list-item><list-item><p>Our simulations predict that the supra-additive effect found by Blanchard et al., depends on the interplay between dopaminergic neurons and neurons in the OFC. This implies that if one disrupts dopaminergic input after extensively training an animal on the task, OFC neurons should reflect an additive (<xref ref-type="fig" rid="fig13">Figure 13B</xref>) but not supra-additive (<xref ref-type="fig" rid="fig13">Figure 13C</xref>) effect of reward and information.</p></list-item></list><p>Learning about the structure of a task, besides maximising extrinsic reward, likely depends on a yet unknown integrated circuit of neuronal systems. For example, it has been shown that representations of task structure in OFC critically depend on input from the ventral subiculum (<xref ref-type="bibr" rid="bib97">Wikenheiser et al., 2017</xref>), but the neuronal encoding that underlies structure learning in the hippocampal formation, OFC and neuromodulatory systems (and their interaction) is largely unknown.</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We have illustrated the emergence of active inference and active learning when casting choice behaviour as probabilistic inference. Under the assumption that behaviour maximises model evidence or (equivalently) minimises surprise over future outcomes, this implies that choice behaviour will reflect a tendency to fulfil preferences and maximise utility, but also to minimise uncertainty about the current state of the environment and the relevant task contingencies. Whilst the tendency to fulfil ones preferences reflects exploitative behaviour, uncertainty reduction induces exploratory behaviour. We have contrasted such ‘goal-directed’ exploratory behaviour with ‘random’ exploration caused by imprecise and stochastic behaviour that is unrelated to an agent’s uncertainty about the world.</p><p>This perspective makes specific predictions for behaviour. In particular, it introduces a distinction between the uncertainty about current states, which can be resolved by active inference, and uncertainty about model parameters, which can be resolved via active learning. Both uncertainties motivate goal-directed exploration but make different predictions for actual decision-making. Minimising the uncertainty over hidden states predicts that agents will seek observations from which there is a clear and precise mapping to the underlying hidden state, such as moving to a vantage point to infer the location of prey or sampling a cue that allows to infer the current context. Importantly, this sort of uncertainty reduction depends on a particular representation of the structure of the task and a particular parameterisation of that representation, which allows an agent to assess the mapping from observations to hidden states. We argue that agents are also driven by minimising the uncertainty about this parameterisation itself, as illustrated in the first simulations on ‘parameter exploration’. Minimising the uncertainty over model parameters can even result in behaviour that conflicts with minimising the uncertainty over hidden states – in situations where agents try to sample options that are associated with high ambiguity but also with high novelty or information gain. Consequently, a key prediction for behaviour is that the uncertainty about contingencies will modulate the effect of uncertainty about hidden states on behaviour. An option will be very interesting (i.e. informative) if its outcomes are ambiguous due to high uncertainty about the mapping from this option to possible outcomes, but the same option will be highly aversive if the agent is very certain that it leads to ambiguous outcomes.</p><p>In other instances, ‘model parameter exploration’ and ‘hidden state exploration’ can motivate similar types of behaviour. Our simulations, however, highlight an important conceptual distinction between active learning and active inference in their respective time courses. As mentioned above, it is possible to cast our ‘hidden state exploration’ example as an active learning problem, if we assume that the current context is stable enough to be learned over time. A key requirement for <italic>learning</italic> the context, however, is that it is possible to carry information from one trial to the next. If this continuity is broken, for example by changing the context randomly on every trial, the agent has to rely on active inference in order to gain information about the task. Thus, our framework predicts that active learning will be particularly useful if there are stable regularities or rules in the world that can be learned. Active inference, on the other hand, will be useful if behaviour has to adapt to trial-by-trial changes. In other tasks, active inference and active learning may interact, such as by learning about specific contingencies within a particular context. For example, imagine your favourite craft beer brewery introduces a novel beer based on the flavour of coffee and oranges. This might present a suitable instance for actively learning about the parameterisation of your preferences for coffee and orange flavoured beer, resulting in a large curiosity-bonus for this choice. However, you might be aware that you have a strong preference for Lager over Stout. Consequently, it might be useful to actively infer the hidden state of the novel beverage by asking the bartender what sort of beer you will obtain before placing your curiosity-driven order.</p><p>These considerations highlight the distinction between ‘goal-directed’ exploratory behaviour in the form of minimising uncertainty about hidden states or model parameters, ‘random’ exploratory (i.e., imprecise) behaviour and exploitative decision-making. The trade-off between these behavioural tendencies is governed by their relative precision. For example, if an agent strongly prefers one particular outcome over all other outcomes, she will display predominantly exploitative behaviour with the aim of attaining this outcome. In contrast, if there is one option that is associated with very high uncertainty about its mappings to outcomes, behaviour will be dominated by sampling that option until its associated uncertainty is resolved. Our simulations also illustrate that random exploration becomes adaptive if active learning or active inference is broken (or impossible). If the uncertainty about model parameters and hidden states fails to inform behaviour, the only way to learn about the world is through a higher degree of random sampling of different options. Our simulations have shown that this is the only way to (slowly and inefficiently) learn about the advantage of novel options in the absence of goal-directed exploratory behaviour. Further, it is important to note that these types of exploration themselves depend on a model of the task, such as an observation model or a model of the transitions between states. It will be a key challenge for future work to understand how agents build and compare these models in the first place, which provide the basis for inference and learning.</p><p>The distinction between active learning and active inference resonates with previous accounts of minimising different types of uncertainty, for example, the difference between unexpected and expected uncertainty (<xref ref-type="bibr" rid="bib101">Yu and Dayan, 2005</xref>). However, the distinction between active learning and active inference emphasises the difference between uncertainty about model parameters and uncertainty about (hidden) states. This distinction can also be thought of as different <italic>modes</italic> of addressing different types of uncertainties. For example, an agent could reduce her unexpected uncertainty (‘is the reward probability 50% or 99%?’) via actively learning the ‘reward parameterisation’ of an option or via actively inferring the ‘reward state’. Whilst active inference can often be a faster and more efficient way of reducing uncertainty, it also requires additional (structural) knowledge about the task, for example, that there is either a 50% or 99% ‘reward probability state’ but nothing in-between. Likewise, an agent can arrive at an accurate estimate of the expected uncertainty of an option (‘there is a 50% chance that there will be a reward’) via active learning and accumulating evidence that the true ‘reward parameter’ is 0.5, or via active inference and forming a precise belief that the current ‘reward state’ is 0.5.</p><p>This framework also promises a refined understanding of goal-directed cognitive deficits within the spectrum of neuropsychiatric disorders and accompanying animal models. For example, individuals diagnosed with Schizophrenia and schizoaffective disorders are reported to suffer from cognitive deficits associated with both active inference and active learning (<xref ref-type="bibr" rid="bib50">Koch et al., 2010</xref>; <xref ref-type="bibr" rid="bib59">Morris et al., 2008</xref>; <xref ref-type="bibr" rid="bib94">Waltz et al., 2007</xref>; <xref ref-type="bibr" rid="bib96">Weickert et al., 2009</xref>). However, a specific characterisation of how diagnosed individuals differ in their information gain during adaptive behaviour has remained elusive. In a scenario where an individual suffers predominantly from working memory deficits or contextual integration failures, active inference may become impaired, resulting in reduced adaption to task contingencies. On the other hand, reduced efficiency in trial and error learning and attentional outcome deficits may speak to impairments predominantly in active learning. Whilst active inference and active learning may not always be entirely independent, this framework proposes the translation of individual performance into measurable parameters that reflect these different strategies in behaviour. A successful empirical dissociation of these behavioural phenotypes promises a refined assessment of cognitive deficits due to a more accurate understanding of the underlying neuropathological mechanisms, resulting in improved differentiability and predictability of cognitive dysfunction in individual subjects.</p><p>In summary, we have highlighted the distinction between learning about the world as a consequence of random or imprecise behaviour (‘random exploration’) and goal-directed uncertainty reduction. Further, we have shown how these types of behaviour arise when casting behaviour as probabilistic inference. We have identified two types of goal-directed exploratory behaviour, namely <italic>active learning</italic> that reduces the uncertainty that relates to the parameterisation of an agent’s generative model of the world, and <italic>active inference</italic> that reduces uncertainty about hidden states in the world given an agent’s generative model. This former type of uncertainty-reduction will compel an agent to sample novel contingencies that enable learning about the true mappings and thus induce ‘model parameter exploration’. The latter type of uncertainty-reduction about hidden states motivates agents to sample salient observations that allow for precise, unambiguous inference about the current state, thus performing ‘hidden state exploration’. We have shown that this distinction makes relevant predictions for the predominance of different types of exploration in different tasks depending on whether active learning or active inference is more adaptive. This will be critical for understanding the different motives underlying curiosity and information-seeking in animals and artificial intelligence, and provides mechanistic insight into suboptimal choice behaviour arising from broken <italic>active inference</italic> or <italic>active learning</italic>.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>The generative model illustrated in <xref ref-type="fig" rid="fig1">Figure 1</xref> implies that outcomes (observations) are generated in the following way: first, a policy is selected using a softmax function of expected free energy for each policy (see below), which also depends on the agent’s degree of randomness (precision) in behaviour. Sequences of hidden states are then generated based on the probability transitions specified by the selected policy. These hidden states then generate outcomes. State inference corresponds to inverting the generative model given a sequence of outcomes, while (parameter) learning corresponds to updating the mapping between hidden states and outcomes. Consequently, ‘perception’ corresponds to inferring (optimising) expectations about hidden causes with respect to variational free energy, while learning corresponds to accumulating concentration parameters. These variables constitute the sufficient statistics of the approximate posterior beliefs, denoted by the probability distribution <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are the hidden or unknown variables (see below).</p><sec id="s4-1"><title>Variational free energy and inference</title><p>In variational Bayesian inference (<italic>model inversion</italic>), one has to specify the form of an approximate posterior distribution. This form uses a mean field approximation, in which posterior beliefs are approximated by the product of marginal distributions over hidden causes. Here, this approximate posterior takes the following form:<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where Cat refers to a categorical distribution and Dir to a Dirichlet distribution. Note that we do not address belief updating about precision (<inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>) in our simulations, which have been discussed in detail in previous work (<xref ref-type="bibr" rid="bib23">FitzGerald et al., 2015</xref>; <xref ref-type="bibr" rid="bib30">Friston et al., 2017b</xref>).</p><p>Having specified a Markovian generative model and the approximate posterior, one can define the variational free energy and resulting update equations that are used to infer hidden causes, as well as the expected free energy over future states under policies, which defines the value of a policy.</p><p>Variational Bayesian inference implies that by minimising variational free energy with respect to the specified posterior <inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> over hidden causes <inline-formula><mml:math id="inf54"><mml:mi>x</mml:mi></mml:math></inline-formula> (where <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> in our example) we approximate the true posterior <inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi>o</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(1)</mml:mtext></mml:mtd><mml:mtd><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:munder><mml:mi>argmin</mml:mi><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mi>F</mml:mi><mml:mo>≈</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi>o</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>There are several equivalent expressions for variational free energy: one is in terms of the entropy minus energy:<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mi>F</mml:mi></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mi>o</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi>o</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>o</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mrow/></mml:mtd></mml:mtr><mml:mlabeledtr><mml:mtd><mml:mtext>(2)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi>o</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>o</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>o</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> denotes observations up until the current time <inline-formula><mml:math id="inf58"><mml:mi>t</mml:mi></mml:math></inline-formula>. Because the (KL) divergence cannot be less than zero, the last equality means that free energy is minimised when the approximate posterior <inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> becomes the true posterior <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi>o</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. In this case, the variational free energy becomes the negative log evidence for the generative model.</p><p>Rewriting <xref ref-type="disp-formula" rid="equ3">Equation (2)</xref> shows that variational free energy can also be written as<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(3)</mml:mtext></mml:mtd><mml:mtd><mml:mi>F</mml:mi></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>o</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This implies that minimising variational free energy maximises the expected likelihood of observations under the approximate posterior (‘accuracy’) whilst minimising the divergence between the approximate and true distribution over hidden causes (‘complexity’). Having defined the objective function, the sufficient statistics encoding posterior beliefs can be updated by minimising variational free energy, as discussed in detail in (<xref ref-type="bibr" rid="bib29">Friston et al., 2017a</xref>; see also appendix of <xref ref-type="bibr" rid="bib66">Parr and Friston, 2018</xref> for the derivation of these updates). Given the focus of this paper, we will discuss inference on valuable policies in detail below.</p><p>As we have shown above, minimising free energy ensures that expectations about hidden causes are close to the true posterior over hidden causes, given observed outcomes. However, if we want to apply this notion to define the value of actions and policies, we need to consider potential <italic>future</italic> outcomes and states under a given policy. This can be achieved by making the log prior probability of a policy the (negative) free energy expected under that policy (<xref ref-type="bibr" rid="bib30">Friston et al., 2017b</xref>):<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo>⋅</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr><mml:mlabeledtr><mml:mtd><mml:mtext>(4)</mml:mtext></mml:mtd><mml:mtd><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:munder><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf61"><mml:mi>τ</mml:mi></mml:math></inline-formula> refers to a time-step in the future, <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> with <inline-formula><mml:math id="inf63"><mml:mi>t</mml:mi></mml:math></inline-formula> reflecting the current time step. Note that the expected free energy over future states that determines the value of a policy resembles the expected value of future reward in reinforcement learning (<xref ref-type="bibr" rid="bib85">Sutton and Barto, 1998a</xref>), although there is no discount parameter over future states. <inline-formula><mml:math id="inf64"><mml:mi>γ</mml:mi></mml:math></inline-formula> reflects a precision parameter that governs an agent’s goal-directedness and randomness in behaviour, parameterised by a gamma function with rate parameter <inline-formula><mml:math id="inf65"><mml:mi>β</mml:mi></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). Based on these beliefs about policies, agents sample an action, where the randomness of this sampling is governed by a precision parameter <inline-formula><mml:math id="inf66"><mml:mi>α</mml:mi></mml:math></inline-formula> (see below). Here, we simulate ‘one-shot’ experiments, in which there is no time-sensitive updating of precision, but we illustrate the role of the hyper-prior on precision (<inline-formula><mml:math id="inf67"><mml:mi>β</mml:mi></mml:math></inline-formula>) to simulate stochasticity or ‘random exploration’ in behaviour.</p><p>Using the same definition of free energy as in <xref ref-type="disp-formula" rid="equ2">Equation 1</xref>), we can now define the expected free energy that defines the value of a policy. To do so, we need to make two changes to the definition of the free energy in <xref ref-type="disp-formula" rid="equ2">Equation 1</xref>). First, we need to define an approximate posterior conditioned on a policy. Second, given that we evaluate policies with respect to future observations that have not yet occurred, the expectation in <xref ref-type="disp-formula" rid="equ2">Equation 1</xref>) needs to incorporate those future states (<xref ref-type="bibr" rid="bib66">Parr and Friston, 2018</xref>). Consequently, we obtain <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, and by defining <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, we can write the free energy as (see <xref ref-type="bibr" rid="bib79">Solopchuck, 2018</xref> for a step-by-step tutorial of this derivation):<disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(5)</mml:mtext></mml:mtd><mml:mtd><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ7"><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mlabeledtr><mml:mtd><mml:mtext>(6)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mi/><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>And eventually (cf. <xref ref-type="bibr" rid="bib29">Friston et al., 2017a</xref>; Equation 2.2):<disp-formula id="equ8"><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(7)</mml:mtext></mml:mtd><mml:mtd><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:munder><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:munder></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This formulation of behaviour predicts that choices will be governed by three principles; namely, minimising uncertainty about model parameters (<italic>parameter exploration</italic> or <italic>active learning</italic>), minimising uncertainty about hidden states (<italic>hidden state exploration</italic> or <italic>active inference</italic>) and obtaining preferred outcomes (<italic>realising preferences</italic> or <italic>goals</italic>).</p><p>Preferences over outcomes are defined as prior (log-) expectations over outcomes (<bold>c</bold> in <xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="fig" rid="fig2">Figure 2C</xref>). Thus, policies become valuable if they minimise the deviation between expected and actual outcomes, which introduces the concept of surprise minimisation to choice behaviour. The focus of the present paper, however, is on the first two terms of the value of a policy.</p><p>The first term in the equation above reflects the mutual information between beliefs about <italic>model parameters</italic> before and after making a new observation and reflects <italic>active learning</italic> (cf., <xref ref-type="bibr" rid="bib100">Yang et al., 2016</xref>). The notion of finding policies that maximise mutual information is equivalent to maximising (expected) Bayesian surprise (<xref ref-type="bibr" rid="bib43">Itti and Baldi, 2009</xref>), where Bayesian surprise is the divergence between posterior and prior beliefs about hidden causes. Because mutual information cannot be less than zero, it disappears when the (predictive) posterior ceases to be informed by new observations. This means that ‘active learning’ will search out observations that resolve uncertainty about the world (e.g. foraging to resolve uncertainty about the reward probability of a risky option). However, when there is no posterior uncertainty – and the agent is confident about the structure of the world – there can be no further information gain and preferences over outcomes (i.e. rewards or utility) will dominate policy selection. This resolution of uncertainty is closely related to satisfying artificial curiosity (<xref ref-type="bibr" rid="bib71">Schmidhuber, 1991</xref>; <xref ref-type="bibr" rid="bib83">Still and Precup, 2012</xref>) and the ‘value of information’ (<xref ref-type="bibr" rid="bib40">Howard, 1966</xref>). The second term of the value of a policy, on the other hand, reflects the mutual information of believes about <italic>states</italic> before and after making an observation and reflects <italic>active inference</italic>. This term quantifies how well agents can infer the underlying cause of an observation, and motivates agents to seek observations that decrease uncertainty about the current hidden state with respect to this mapping. Taken together, these two terms predict that policies will be preferred if they allow agents to optimise the parameterisation of their observation model and at the same time make observations that enable precise inference about the state of the world, given their observation model.</p><p>The posterior mapping from hidden states to outcomes (<bold><italic>A</italic></bold>) is parameterised as Dirichlet distribution, whose sufficient statistics are concentration parameters (<xref ref-type="bibr" rid="bib28">Friston et al., 2016</xref>). These concentration parameters effectively reflect the (normalised) number of times a particular combination of states and outcomes has been encountered.</p><p>Actual updates of an agent’s observation model (A-matrix) at time-point <inline-formula><mml:math id="inf70"><mml:mi>t</mml:mi></mml:math></inline-formula> take place via updating these concentration parameters with respect to current observations and an individual learning rate <inline-formula><mml:math id="inf71"><mml:mi>η</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib28">Friston et al., 2016</xref>):<disp-formula id="equ9"><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(8)</mml:mtext></mml:mtd><mml:mtd><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>A</mml:mi></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf72"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> reflects the update of the concentration parameters depending on the observed state-outcome mapping at trial <inline-formula><mml:math id="inf73"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>⋅</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>⊗</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the cross-product), and <inline-formula><mml:math id="inf76"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> reflects the (prior) concentration parameters at the beginning of the experiment, with <inline-formula><mml:math id="inf77"><mml:mi>ψ</mml:mi></mml:math></inline-formula> referring to a psi- or digamma-function (i.e. a column-wise normalisation of concentration parameters). Note that <inline-formula><mml:math id="inf78"><mml:mi>a</mml:mi></mml:math></inline-formula> refer to the concentration parameters specifying an agent’s observation model via <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Effectively, <xref ref-type="disp-formula" rid="equ9">Equation (8)</xref> implies that learning of the observation model takes place by counting the number of transitions from one particular hidden state to a particular outcome, modulated by an individual learning rate.</p><p>From the perspective of this paper, the two key terms that define the value of a policy are the opportunities for information gain pertaining to the mapping between hidden states and outcomes (first term), and about hidden states (second term). The former reflects an agent’s reduction in uncertainty about model parameters, whilst the latter reflects an agent’s reduction in uncertainty about hidden states. These two terms imply that policies will be preferred if they resolve uncertainty about the way in which hidden states generate outcomes (‘model parameter exploration’) and about the hidden states underlying observations (‘hidden state exploration’).</p><p>In addition to the precision (stochasticity) of policy selection, one can define a precision of action selection under inferred policies, <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>: <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>⋅</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf82"><mml:mi>Q</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> reflects the approximate posterior beliefs about policies <inline-formula><mml:math id="inf83"><mml:mi>π</mml:mi></mml:math></inline-formula>. In the above simulations, we have set <inline-formula><mml:math id="inf84"><mml:mi>α</mml:mi></mml:math></inline-formula> to 4 in the active learning simulations and to 16 in the active inference examples. Note that we have defined different values for <inline-formula><mml:math id="inf85"><mml:mi>α</mml:mi></mml:math></inline-formula> based on the difference in the number of available policies in these two examples, but the results of our simulations do not depend on particular values of <inline-formula><mml:math id="inf86"><mml:mi>α</mml:mi></mml:math></inline-formula>. In the section on ‘Comparing model parameter and hidden state exploration’, we have set <inline-formula><mml:math id="inf87"><mml:mi>α</mml:mi></mml:math></inline-formula> to 8 for both the active learning and active inference agent to ensure comparability of the two agents, and we have set <inline-formula><mml:math id="inf88"><mml:mi>α</mml:mi></mml:math></inline-formula> to 1 to create a random exploration agent (to ensure consistency across the different simulated tasks).</p></sec><sec id="s4-2"><title>Code availability</title><p>The above simulations are based on routines available that are available as Matlab code in the SPM academic software: <ext-link ext-link-type="uri" xlink:href="http://www.fil.ion.ucl.ac.uk/spm/">http://www.fil.ion.ucl.ac.uk/spm/</ext-link> based on the epistemic learning demo in the DEM toolbox of SPM.</p><p>The exact simulations and figures of this paper can be reproduced based on code at the following github repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/schwartenbeckph/Mechanisms_Exploration_Paper">https://github.com/schwartenbeckph/Mechanisms_Exploration_Paper</ext-link> using the Curiosity_Paper_Figures.m File (<xref ref-type="bibr" rid="bib76">Schwartenbeck, 2019a</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/Mechanisms_Exploration_Paper">https://github.com/elifesciences-publications/Mechanisms_Exploration_Paper</ext-link>).</p><p>These simulations are based on a broader tutorial on active inference and active learning that can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/schwartenbeckph/CPC_ActiveInference2018">https://github.com/schwartenbeckph/CPC_ActiveInference2018</ext-link> (<xref ref-type="bibr" rid="bib77">Schwartenbeck, 2019b</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/CPC_ActiveInference2018">https://github.com/elifesciences-publications/CPC_ActiveInference2018</ext-link>). This tutorial includes important procedures for fitting such models to real behaviour – and evaluating parameter recovery (i.e. identifiability). This application goes beyond the scope of this paper but represents a crucial step in applying active inference and learning models to empirical data.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Rani Moran and Timothy Müller for very helpful comments on an earlier version of this manuscript. KJF is funded by the Wellcome Trust (Ref: 088130/Z/09/Z). TUH is supported by a Wellcome Sir Henry Dale Fellowship (211155/Z/18/Z), a grant from the Jacobs Foundation (2017-1261-04), the Medical Research Foundation, and a 2018 NARSAD Young Investigator grant (27023) from the Brain and Behavior Research Foundation. THBF is supported by a European Research Council (ERC) Starting Grant under the Horizon 2020 program (Grant Agreement 804701). The Max Planck UCL Centre is a joint initiative supported by UCL and the Max Planck Society. The Wellcome Centre for Human Neuroimaging is supported by core funding from the Wellcome Trust (203147/Z/16/Z).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Investigation, Writing—original draft</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Writing—original draft</p></fn><fn fn-type="con" id="con3"><p>Formal analysis, Investigation, Writing—original draft</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Investigation, Writing—original draft</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Supervision, Investigation, Writing—original draft</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Resources, Formal analysis, Supervision, Investigation, Methodology, Writing—original draft</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.41703.015</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-41703-transrepform-v1.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Our submission only contains theoretical and simulation work, there are no datasets that could be made available. All the routines that are used for these simulations are available in the academic software SPM (<ext-link ext-link-type="uri" xlink:href="https://www.fil.ion.ucl.ac.uk/spm/">https://www.fil.ion.ucl.ac.uk/spm/</ext-link>, DEM toolbox, 'epistemic value' routine), as indicated and described in the main text of our manuscript. Further, all code and data to reproduce the specific simulations of this manuscript are publicly available on github (<ext-link ext-link-type="uri" xlink:href="https://github.com/schwartenbeckph/Mechanisms_Exploration_Paper">https://github.com/schwartenbeckph/Mechanisms_Exploration_Paper</ext-link>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/Mechanisms_Exploration_Paper">https://github.com/elifesciences-publications/Mechanisms_Exploration_Paper</ext-link>).</p><p>The following datasets were generated:</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Agrawal</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Sample mean based index policies by O(log n) regret for the multi-armed bandit problem</article-title><source>Advances in Applied Probability</source><volume>27</volume><fpage>1054</fpage><lpage>1078</lpage><pub-id pub-id-type="doi">10.2307/1427934</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Agrawal</surname> <given-names>S</given-names></name><name><surname>Goyal</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Analysis of Thompson sampling for the multi-armed bandit problem</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1111.1797">https://arxiv.org/abs/1111.1797</ext-link></element-citation></ref><ref id="bib3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Auer</surname> <given-names>P</given-names></name><name><surname>Cesa-Bianchi</surname> <given-names>N</given-names></name><name><surname>Fischer</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2002">2002</year><chapter-title>Finite-time analysis of the multiarmed bandit problem</chapter-title><source>Machine Learning</source><volume>3</volume><publisher-name>Springer Link</publisher-name><fpage>235</fpage><lpage>256</lpage></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Auer</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Using confidence bounds for Exploitation-Exploration Trade-offs</article-title><source>Journal of Machine Learning Research</source><volume>3</volume><fpage>397</fpage><lpage>422</lpage></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Badre</surname> <given-names>D</given-names></name><name><surname>Doll</surname> <given-names>BB</given-names></name><name><surname>Long</surname> <given-names>NM</given-names></name><name><surname>Frank</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Rostrolateral prefrontal cortex and individual differences in uncertainty-driven exploration</article-title><source>Neuron</source><volume>73</volume><fpage>595</fpage><lpage>607</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.12.025</pub-id><pub-id pub-id-type="pmid">22325209</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Barto</surname> <given-names>AG</given-names></name></person-group><year iso-8601-date="2013">2013</year><chapter-title>Intrinsic Motivation and Reinforcement Learning</chapter-title><source>Intrinsically Motivated Learning in Natural and Artificial Systems</source><publisher-name>cornell</publisher-name><fpage>17</fpage><lpage>47</lpage></element-citation></ref><ref id="bib7"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Beal</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><source>Variational Algorithms for Approximate Bayesian Inference</source><publisher-loc>London</publisher-loc><publisher-name>University of London Press</publisher-name></element-citation></ref><ref id="bib8"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bellemare</surname> <given-names>MG</given-names></name><name><surname>Srinivasan</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><source>Unifying Count-Based Exploration and Intrinsic Motivation</source><publisher-name>Neural Information Processing Systems Foundation, Inc (NIPS)</publisher-name></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blanchard</surname> <given-names>TC</given-names></name><name><surname>Hayden</surname> <given-names>BY</given-names></name><name><surname>Bromberg-Martin</surname> <given-names>ES</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Orbitofrontal cortex uses distinct codes for different choice attributes in decisions motivated by curiosity</article-title><source>Neuron</source><volume>85</volume><fpage>602</fpage><lpage>614</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.12.050</pub-id><pub-id pub-id-type="pmid">25619657</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blanchard</surname> <given-names>TC</given-names></name><name><surname>Gershman</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Pure correlates of exploration and exploitation in the human brain</article-title><source>Cognitive, Affective, &amp; Behavioral Neuroscience</source><volume>18</volume><fpage>117</fpage><lpage>126</lpage><pub-id pub-id-type="doi">10.3758/s13415-017-0556-2</pub-id><pub-id pub-id-type="pmid">29218570</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bogacz</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A tutorial on the free-energy framework for modelling perception and learning</article-title><source>Journal of Mathematical Psychology</source><volume>76</volume><fpage>198</fpage><lpage>211</lpage><pub-id pub-id-type="doi">10.1016/j.jmp.2015.11.003</pub-id><pub-id pub-id-type="pmid">28298703</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boorman</surname> <given-names>ED</given-names></name><name><surname>Rajendran</surname> <given-names>VG</given-names></name><name><surname>O'Reilly</surname> <given-names>JX</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Two anatomically and computationally distinct learning signals predict changes to Stimulus-Outcome associations in hippocampus</article-title><source>Neuron</source><volume>89</volume><fpage>1343</fpage><lpage>1354</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.02.014</pub-id><pub-id pub-id-type="pmid">26948895</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bromberg-Martin</surname> <given-names>ES</given-names></name><name><surname>Hikosaka</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Midbrain dopamine neurons signal preference for advance information about upcoming rewards</article-title><source>Neuron</source><volume>63</volume><fpage>119</fpage><lpage>126</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.06.009</pub-id><pub-id pub-id-type="pmid">19607797</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Burda</surname> <given-names>Y</given-names></name><name><surname>Edwards</surname> <given-names>H</given-names></name><name><surname>Pathak</surname> <given-names>D</given-names></name><name><surname>Storkey</surname> <given-names>A</given-names></name><name><surname>Darrell</surname> <given-names>T</given-names></name><name><surname>Efros</surname> <given-names>AA</given-names></name></person-group><year iso-8601-date="2018">2018a</year><article-title>Large-Scale study of Curiosity-Driven learning</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1808.04355">https://arxiv.org/abs/1808.04355</ext-link></element-citation></ref><ref id="bib15"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Burda</surname> <given-names>Y</given-names></name><name><surname>Edwards</surname> <given-names>H</given-names></name><name><surname>Storkey</surname> <given-names>A</given-names></name><name><surname>Klimov</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2018">2018b</year><article-title>Exploration by random network distillation</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1810.12894">https://arxiv.org/abs/1810.12894</ext-link></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname> <given-names>NE</given-names></name><name><surname>Solla</surname> <given-names>SA</given-names></name><name><surname>Hartmann</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Whisking mechanics and active sensing</article-title><source>Current Opinion in Neurobiology</source><volume>40</volume><fpage>178</fpage><lpage>188</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.08.001</pub-id><pub-id pub-id-type="pmid">27632212</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Campagner</surname> <given-names>D</given-names></name><name><surname>Evans</surname> <given-names>MH</given-names></name><name><surname>Bale</surname> <given-names>MR</given-names></name><name><surname>Erskine</surname> <given-names>A</given-names></name><name><surname>Petersen</surname> <given-names>RS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Prediction of primary somatosensory neuron activity during active tactile exploration</article-title><source>eLife</source><volume>5</volume><elocation-id>e10696</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.10696</pub-id><pub-id pub-id-type="pmid">26880559</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chow</surname> <given-names>JJ</given-names></name><name><surname>Smith</surname> <given-names>AP</given-names></name><name><surname>Wilson</surname> <given-names>AG</given-names></name><name><surname>Zentall</surname> <given-names>TR</given-names></name><name><surname>Beckmann</surname> <given-names>JS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Suboptimal choice in rats: incentive salience attribution promotes maladaptive decision-making</article-title><source>Behavioural Brain Research</source><volume>320</volume><fpage>244</fpage><lpage>254</lpage><pub-id pub-id-type="doi">10.1016/j.bbr.2016.12.013</pub-id><pub-id pub-id-type="pmid">27993692</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname> <given-names>JD</given-names></name><name><surname>McClure</surname> <given-names>SM</given-names></name><name><surname>Yu</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Should I stay or should I go? how the human brain manages the trade-off between exploitation and exploration</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>362</volume><fpage>933</fpage><lpage>942</lpage><pub-id pub-id-type="doi">10.1098/rstb.2007.2098</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daw</surname> <given-names>ND</given-names></name><name><surname>O'Doherty</surname> <given-names>JP</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name><name><surname>Seymour</surname> <given-names>B</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Cortical substrates for exploratory decisions in humans</article-title><source>Nature</source><volume>441</volume><fpage>876</fpage><lpage>879</lpage><pub-id pub-id-type="doi">10.1038/nature04766</pub-id><pub-id pub-id-type="pmid">16778890</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feldman</surname> <given-names>H</given-names></name><name><surname>Friston</surname> <given-names>KJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Attention, uncertainty, and free-energy</article-title><source>Frontiers in Human Neuroscience</source><volume>4</volume><elocation-id>215</elocation-id><pub-id pub-id-type="doi">10.3389/fnhum.2010.00215</pub-id><pub-id pub-id-type="pmid">21160551</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Findling</surname> <given-names>C</given-names></name><name><surname>Skvortsova</surname> <given-names>V</given-names></name><name><surname>Dromnelle</surname> <given-names>R</given-names></name><name><surname>Palminteri</surname> <given-names>S</given-names></name><name><surname>Wyart</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Computational noise in reward-guided learning drives behavioral variability in volatile environments</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/439885</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>FitzGerald</surname> <given-names>TH</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name><name><surname>Friston</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dopamine, reward learning, and active inference</article-title><source>Frontiers in Computational Neuroscience</source><volume>9</volume><elocation-id>136</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2015.00136</pub-id><pub-id pub-id-type="pmid">26581305</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname> <given-names>KJ</given-names></name><name><surname>Shiner</surname> <given-names>T</given-names></name><name><surname>FitzGerald</surname> <given-names>T</given-names></name><name><surname>Galea</surname> <given-names>JM</given-names></name><name><surname>Adams</surname> <given-names>R</given-names></name><name><surname>Brown</surname> <given-names>H</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name><name><surname>Moran</surname> <given-names>R</given-names></name><name><surname>Stephan</surname> <given-names>KE</given-names></name><name><surname>Bestmann</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Dopamine, affordance and active inference</article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002327</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002327</pub-id><pub-id pub-id-type="pmid">22241972</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname> <given-names>K</given-names></name><name><surname>Schwartenbeck</surname> <given-names>P</given-names></name><name><surname>Fitzgerald</surname> <given-names>T</given-names></name><name><surname>Moutoussis</surname> <given-names>M</given-names></name><name><surname>Behrens</surname> <given-names>T</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The anatomy of choice: active inference and agency</article-title><source>Frontiers in Human Neuroscience</source><volume>7</volume><elocation-id>598</elocation-id><pub-id pub-id-type="doi">10.3389/fnhum.2013.00598</pub-id><pub-id pub-id-type="pmid">24093015</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname> <given-names>K</given-names></name><name><surname>Schwartenbeck</surname> <given-names>P</given-names></name><name><surname>FitzGerald</surname> <given-names>T</given-names></name><name><surname>Moutoussis</surname> <given-names>M</given-names></name><name><surname>Behrens</surname> <given-names>T</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The anatomy of choice: dopamine and decision-making</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>369</volume><elocation-id>20130481</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2013.0481</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname> <given-names>K</given-names></name><name><surname>Rigoli</surname> <given-names>F</given-names></name><name><surname>Ognibene</surname> <given-names>D</given-names></name><name><surname>Mathys</surname> <given-names>C</given-names></name><name><surname>Fitzgerald</surname> <given-names>T</given-names></name><name><surname>Pezzulo</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Active inference and epistemic value</article-title><source>Cognitive Neuroscience</source><volume>6</volume><fpage>187</fpage><lpage>214</lpage><pub-id pub-id-type="doi">10.1080/17588928.2015.1020053</pub-id><pub-id pub-id-type="pmid">25689102</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname> <given-names>K</given-names></name><name><surname>FitzGerald</surname> <given-names>T</given-names></name><name><surname>Rigoli</surname> <given-names>F</given-names></name><name><surname>Schwartenbeck</surname> <given-names>P</given-names></name><name><surname>O Doherty</surname> <given-names>J</given-names></name><name><surname>Pezzulo</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Active inference and learning</article-title><source>Neuroscience &amp; Biobehavioral Reviews</source><volume>68</volume><fpage>862</fpage><lpage>879</lpage><pub-id pub-id-type="doi">10.1016/j.neubiorev.2016.06.022</pub-id><pub-id pub-id-type="pmid">27375276</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname> <given-names>K</given-names></name><name><surname>FitzGerald</surname> <given-names>T</given-names></name><name><surname>Rigoli</surname> <given-names>F</given-names></name><name><surname>Schwartenbeck</surname> <given-names>P</given-names></name><name><surname>Pezzulo</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017a</year><article-title>Active inference: a process theory</article-title><source>Neural Computation</source><volume>29</volume><fpage>1</fpage><lpage>49</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00912</pub-id><pub-id pub-id-type="pmid">27870614</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname> <given-names>KJ</given-names></name><name><surname>Lin</surname> <given-names>M</given-names></name><name><surname>Frith</surname> <given-names>CD</given-names></name><name><surname>Pezzulo</surname> <given-names>G</given-names></name><name><surname>Hobson</surname> <given-names>JA</given-names></name><name><surname>Ondobaka</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017b</year><article-title>Active inference, curiosity and insight</article-title><source>Neural Computation</source><volume>29</volume><fpage>2633</fpage><lpage>2683</lpage><pub-id pub-id-type="doi">10.1162/neco_a_00999</pub-id><pub-id pub-id-type="pmid">28777724</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Fu</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Exploration with exemplar models for deep reinforcement learning</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1703.01260">https://arxiv.org/abs/1703.01260</ext-link></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gershman</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2018">2018a</year><article-title>Deconstructing the human algorithms for exploration</article-title><source>Cognition</source><volume>173</volume><fpage>34</fpage><lpage>42</lpage><pub-id pub-id-type="doi">10.1016/j.cognition.2017.12.014</pub-id><pub-id pub-id-type="pmid">29289795</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Gershman</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2018">2018b</year><article-title>Uncertainty and exploration</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/265504</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Gershman</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>What does the free energy principle tell Us about the brain?</article-title><source>Bioarxiv</source><ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1901.07945">http://arxiv.org/abs/1901.07945</ext-link></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gottlieb</surname> <given-names>J</given-names></name><name><surname>Oudeyer</surname> <given-names>PY</given-names></name><name><surname>Lopes</surname> <given-names>M</given-names></name><name><surname>Baranes</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Information-seeking, curiosity, and attention: computational and neural mechanisms</article-title><source>Trends in Cognitive Sciences</source><volume>17</volume><fpage>585</fpage><lpage>593</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2013.09.001</pub-id><pub-id pub-id-type="pmid">24126129</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grant</surname> <given-names>RA</given-names></name><name><surname>Mitchinson</surname> <given-names>B</given-names></name><name><surname>Fox</surname> <given-names>CW</given-names></name><name><surname>Prescott</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Active touch sensing in the rat: anticipatory and regulatory control of whisker movements during surface exploration</article-title><source>Journal of Neurophysiology</source><volume>101</volume><fpage>862</fpage><lpage>874</lpage><pub-id pub-id-type="doi">10.1152/jn.90783.2008</pub-id><pub-id pub-id-type="pmid">19036871</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hauser</surname> <given-names>TU</given-names></name><name><surname>Eldar</surname> <given-names>E</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Separate mesocortical and mesolimbic pathways encode effort and reward learning signals</article-title><source>PNAS</source><volume>114</volume><fpage>E7395</fpage><lpage>E7404</lpage><pub-id pub-id-type="doi">10.1073/pnas.1705643114</pub-id><pub-id pub-id-type="pmid">28808037</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hauser</surname> <given-names>TU</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Is human curiosity neurobiologically unique?</article-title><source>CDS Newsletter</source></element-citation></ref><ref id="bib39"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Houthooft</surname> <given-names>R</given-names></name><name><surname>Chen</surname> <given-names>X</given-names></name><name><surname>Duan</surname> <given-names>Y</given-names></name><name><surname>Schulman</surname> <given-names>J</given-names></name><name><surname>De Turck</surname> <given-names>F</given-names></name><name><surname>Abbeel</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>VIME: variational information maximizing exploration</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1605.09674">http://arxiv.org/abs/1605.09674</ext-link></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Howard</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1966">1966</year><article-title>Information value theory</article-title><source>IEEE Transactions on Systems Science and Cybernetics</source><volume>2</volume><fpage>22</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1109/TSSC.1966.300074</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iglesias</surname> <given-names>S</given-names></name><name><surname>Mathys</surname> <given-names>C</given-names></name><name><surname>Brodersen</surname> <given-names>KH</given-names></name><name><surname>Kasper</surname> <given-names>L</given-names></name><name><surname>Piccirelli</surname> <given-names>M</given-names></name><name><surname>den Ouden</surname> <given-names>HE</given-names></name><name><surname>Stephan</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Hierarchical prediction errors in midbrain and basal forebrain during sensory learning</article-title><source>Neuron</source><volume>80</volume><fpage>519</fpage><lpage>530</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.09.009</pub-id><pub-id pub-id-type="pmid">24139048</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iigaya</surname> <given-names>K</given-names></name><name><surname>Story</surname> <given-names>GW</given-names></name><name><surname>Kurth-Nelson</surname> <given-names>Z</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The modulation of savouring by prediction error and its effects on choice</article-title><source>eLife</source><volume>5</volume><elocation-id>e13747</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.13747</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Itti</surname> <given-names>L</given-names></name><name><surname>Baldi</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Bayesian surprise attracts human attention</article-title><source>Vision Research</source><volume>49</volume><fpage>1295</fpage><lpage>1306</lpage><pub-id pub-id-type="doi">10.1016/j.visres.2008.09.007</pub-id><pub-id pub-id-type="pmid">18834898</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>JL</given-names></name><name><surname>Esber</surname> <given-names>GR</given-names></name><name><surname>McDannald</surname> <given-names>MA</given-names></name><name><surname>Gruber</surname> <given-names>AJ</given-names></name><name><surname>Hernandez</surname> <given-names>A</given-names></name><name><surname>Mirenzi</surname> <given-names>A</given-names></name><name><surname>Schoenbaum</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Orbitofrontal cortex supports behavior and learning using inferred but not cached values</article-title><source>Science</source><volume>338</volume><fpage>953</fpage><lpage>956</lpage><pub-id pub-id-type="doi">10.1126/science.1227489</pub-id><pub-id pub-id-type="pmid">23162000</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaelbling</surname> <given-names>LP</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Associative reinforcement learning: a generate and test algorithm</article-title><source>Machine Learning</source><volume>15</volume><fpage>299</fpage><lpage>319</lpage><pub-id pub-id-type="doi">10.1007/BF00993348</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kakade</surname> <given-names>S</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Dopamine: generalization and bonuses</article-title><source>Neural Networks</source><volume>15</volume><fpage>549</fpage><lpage>559</lpage><pub-id pub-id-type="doi">10.1016/S0893-6080(02)00048-5</pub-id><pub-id pub-id-type="pmid">12371511</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kidd</surname> <given-names>C</given-names></name><name><surname>Piantadosi</surname> <given-names>ST</given-names></name><name><surname>Aslin</surname> <given-names>RN</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The goldilocks effect: human infants allocate attention to visual sequences that are neither too simple nor too complex</article-title><source>PLoS ONE</source><volume>7</volume><elocation-id>e36399</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0036399</pub-id><pub-id pub-id-type="pmid">22649492</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kidd</surname> <given-names>C</given-names></name><name><surname>Piantadosi</surname> <given-names>ST</given-names></name><name><surname>Aslin</surname> <given-names>RN</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The goldilocks effect in infant auditory attention</article-title><source>Child Development</source><volume>85</volume><fpage>1795</fpage><lpage>1804</lpage><pub-id pub-id-type="doi">10.1111/cdev.12263</pub-id><pub-id pub-id-type="pmid">24990627</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kidd</surname> <given-names>C</given-names></name><name><surname>Hayden</surname> <given-names>BY</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The psychology and neuroscience of curiosity</article-title><source>Neuron</source><volume>88</volume><fpage>449</fpage><lpage>460</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.09.010</pub-id><pub-id pub-id-type="pmid">26539887</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koch</surname> <given-names>K</given-names></name><name><surname>Schachtzabel</surname> <given-names>C</given-names></name><name><surname>Wagner</surname> <given-names>G</given-names></name><name><surname>Schikora</surname> <given-names>J</given-names></name><name><surname>Schultz</surname> <given-names>C</given-names></name><name><surname>Reichenbach</surname> <given-names>JR</given-names></name><name><surname>Sauer</surname> <given-names>H</given-names></name><name><surname>Schlösser</surname> <given-names>RG</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Altered activation in association with reward-related trial-and-error learning in patients with schizophrenia</article-title><source>NeuroImage</source><volume>50</volume><fpage>223</fpage><lpage>232</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2009.12.031</pub-id><pub-id pub-id-type="pmid">20006717</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolling</surname> <given-names>N</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>Mars</surname> <given-names>RB</given-names></name><name><surname>Rushworth</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Neural mechanisms of foraging</article-title><source>Science</source><volume>336</volume><fpage>95</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1126/science.1216930</pub-id><pub-id pub-id-type="pmid">22491854</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krebs</surname> <given-names>RM</given-names></name><name><surname>Schott</surname> <given-names>BH</given-names></name><name><surname>Schütze</surname> <given-names>H</given-names></name><name><surname>Düzel</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The novelty exploration bonus and its attentional modulation</article-title><source>Neuropsychologia</source><volume>47</volume><fpage>2272</fpage><lpage>2281</lpage><pub-id pub-id-type="doi">10.1016/j.neuropsychologia.2009.01.015</pub-id><pub-id pub-id-type="pmid">19524091</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Laversanne-Finot</surname> <given-names>A</given-names></name><name><surname>Péré</surname> <given-names>A</given-names></name><name><surname>Oudeyer</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Curiosity driven exploration of learned disentangled goal spaces</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1807.01521">https://arxiv.org/abs/1807.01521</ext-link></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ligneul</surname> <given-names>R</given-names></name><name><surname>Mermillod</surname> <given-names>M</given-names></name><name><surname>Morisseau</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>From relief to surprise: dual control of epistemic curiosity in the human brain</article-title><source>NeuroImage</source><volume>181</volume><fpage>490</fpage><lpage>500</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2018.07.038</pub-id><pub-id pub-id-type="pmid">30025853</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luciw</surname> <given-names>M</given-names></name><name><surname>Kompella</surname> <given-names>V</given-names></name><name><surname>Kazerounian</surname> <given-names>S</given-names></name><name><surname>Schmidhuber</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>An intrinsic value system for developing multiple invariant representations with incremental slowness learning</article-title><source>Frontiers in Neurorobotics</source><volume>7</volume><elocation-id>9</elocation-id><pub-id pub-id-type="doi">10.3389/fnbot.2013.00009</pub-id><pub-id pub-id-type="pmid">23755011</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mnih</surname> <given-names>V</given-names></name><name><surname>Kavukcuoglu</surname> <given-names>K</given-names></name><name><surname>Silver</surname> <given-names>D</given-names></name><name><surname>Rusu</surname> <given-names>AA</given-names></name><name><surname>Veness</surname> <given-names>J</given-names></name><name><surname>Bellemare</surname> <given-names>MG</given-names></name><name><surname>Graves</surname> <given-names>A</given-names></name><name><surname>Riedmiller</surname> <given-names>M</given-names></name><name><surname>Fidjeland</surname> <given-names>AK</given-names></name><name><surname>Ostrovski</surname> <given-names>G</given-names></name><name><surname>Petersen</surname> <given-names>S</given-names></name><name><surname>Beattie</surname> <given-names>C</given-names></name><name><surname>Sadik</surname> <given-names>A</given-names></name><name><surname>Antonoglou</surname> <given-names>I</given-names></name><name><surname>King</surname> <given-names>H</given-names></name><name><surname>Kumaran</surname> <given-names>D</given-names></name><name><surname>Wierstra</surname> <given-names>D</given-names></name><name><surname>Legg</surname> <given-names>S</given-names></name><name><surname>Hassabis</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Human-level control through deep reinforcement learning</article-title><source>Nature</source><volume>518</volume><fpage>529</fpage><lpage>533</lpage><pub-id pub-id-type="doi">10.1038/nature14236</pub-id><pub-id pub-id-type="pmid">25719670</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montague</surname> <given-names>PR</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>A framework for mesencephalic dopamine systems based on predictive hebbian learning</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>1936</fpage><lpage>1947</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-05-01936.1996</pub-id><pub-id pub-id-type="pmid">8774460</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moran</surname> <given-names>RJ</given-names></name><name><surname>Campo</surname> <given-names>P</given-names></name><name><surname>Symmonds</surname> <given-names>M</given-names></name><name><surname>Stephan</surname> <given-names>KE</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name><name><surname>Friston</surname> <given-names>KJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Free energy, precision and learning: the role of cholinergic neuromodulation</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>8227</fpage><lpage>8236</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4255-12.2013</pub-id><pub-id pub-id-type="pmid">23658161</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname> <given-names>SE</given-names></name><name><surname>Heerey</surname> <given-names>EA</given-names></name><name><surname>Gold</surname> <given-names>JM</given-names></name><name><surname>Holroyd</surname> <given-names>CB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Learning-related changes in brain activity following errors and performance feedback in schizophrenia</article-title><source>Schizophrenia Research</source><volume>99</volume><fpage>274</fpage><lpage>285</lpage><pub-id pub-id-type="doi">10.1016/j.schres.2007.08.027</pub-id><pub-id pub-id-type="pmid">17889510</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muller</surname> <given-names>TH</given-names></name><name><surname>Mars</surname> <given-names>RB</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>O'Reilly</surname> <given-names>JX</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Control of entropy in neural models of environmental state</article-title><source>eLife</source><volume>8</volume><elocation-id>e39404</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.39404</pub-id><pub-id pub-id-type="pmid">30816090</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nour</surname> <given-names>MM</given-names></name><name><surname>Dahoun</surname> <given-names>T</given-names></name><name><surname>Schwartenbeck</surname> <given-names>P</given-names></name><name><surname>Adams</surname> <given-names>RA</given-names></name><name><surname>FitzGerald</surname> <given-names>THB</given-names></name><name><surname>Coello</surname> <given-names>C</given-names></name><name><surname>Wall</surname> <given-names>MB</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name><name><surname>Howes</surname> <given-names>OD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dopaminergic basis for signaling belief updates, but not surprise, and the link to paranoia</article-title><source>PNAS</source><volume>115</volume><fpage>E10167</fpage><lpage>E10176</lpage><pub-id pub-id-type="doi">10.1073/pnas.1809298115</pub-id><pub-id pub-id-type="pmid">30297411</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ostrovski</surname> <given-names>G</given-names></name><name><surname>Bellemare</surname> <given-names>MG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Count-Based exploration with neural density models</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1703.01310">https://arxiv.org/abs/1703.01310</ext-link></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oudeyer</surname> <given-names>P-Y</given-names></name><name><surname>Kaplan</surname> <given-names>F</given-names></name><name><surname>Hafner</surname> <given-names>VV</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Intrinsic motivation systems for autonomous mental development</article-title><source>IEEE Transactions on Evolutionary Computation</source><volume>11</volume><fpage>265</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1109/TEVC.2006.890271</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oudeyer</surname> <given-names>PY</given-names></name><name><surname>Kaplan</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>What is intrinsic motivation? <italic>A typology of computational</italic> approaches</article-title><source>Frontiers in Neurorobotics</source><volume>1</volume><pub-id pub-id-type="doi">10.3389/neuro.12.006.2007</pub-id><pub-id pub-id-type="pmid">18958277</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Padoa-Schioppa</surname> <given-names>C</given-names></name><name><surname>Assad</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Neurons in the orbitofrontal cortex encode economic value</article-title><source>Nature</source><volume>441</volume><fpage>223</fpage><lpage>226</lpage><pub-id pub-id-type="doi">10.1038/nature04676</pub-id><pub-id pub-id-type="pmid">16633341</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parr</surname> <given-names>T</given-names></name><name><surname>Friston</surname> <given-names>KJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The computational anatomy of visual neglect</article-title><source>Cerebral Cortex</source><volume>28</volume><fpage>777</fpage><lpage>790</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhx316</pub-id><pub-id pub-id-type="pmid">29190328</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pezzulo</surname> <given-names>G</given-names></name><name><surname>Rigoli</surname> <given-names>F</given-names></name><name><surname>Friston</surname> <given-names>KJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Hierarchical active inference: a theory of motivated control</article-title><source>Trends in Cognitive Sciences</source><volume>22</volume><fpage>294</fpage><lpage>306</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2018.01.009</pub-id><pub-id pub-id-type="pmid">29475638</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ranade</surname> <given-names>S</given-names></name><name><surname>Hangya</surname> <given-names>B</given-names></name><name><surname>Kepecs</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Multiple modes of phase locking between sniffing and whisking during active exploration</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>8250</fpage><lpage>8256</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3874-12.2013</pub-id><pub-id pub-id-type="pmid">23658164</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rudebeck</surname> <given-names>PH</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>Kennerley</surname> <given-names>SW</given-names></name><name><surname>Baxter</surname> <given-names>MG</given-names></name><name><surname>Buckley</surname> <given-names>MJ</given-names></name><name><surname>Walton</surname> <given-names>ME</given-names></name><name><surname>Rushworth</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Frontal cortex subregions play distinct roles in choices between actions and stimuli</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>13775</fpage><lpage>13785</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3541-08.2008</pub-id><pub-id pub-id-type="pmid">19091968</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rushworth</surname> <given-names>MF</given-names></name><name><surname>Noonan</surname> <given-names>MP</given-names></name><name><surname>Boorman</surname> <given-names>ED</given-names></name><name><surname>Walton</surname> <given-names>ME</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Frontal cortex and reward-guided learning and decision-making</article-title><source>Neuron</source><volume>70</volume><fpage>1054</fpage><lpage>1069</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.05.014</pub-id><pub-id pub-id-type="pmid">21689594</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Schmidhuber</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Curious Model-Building control systems</article-title><conf-name> In: Proc International Joint Conference on Neural Networks, Singapore. IEEE</conf-name><fpage>1458</fpage><lpage>1463</lpage></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schultz</surname> <given-names>W</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name><name><surname>Montague</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>A neural substrate of prediction and reward</article-title><source>Science</source><volume>275</volume><fpage>1593</fpage><lpage>1599</lpage><pub-id pub-id-type="doi">10.1126/science.275.5306.1593</pub-id><pub-id pub-id-type="pmid">9054347</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulz</surname> <given-names>E</given-names></name><name><surname>Gershman</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The algorithmic architecture of exploration in the human brain</article-title><source>Current Opinion in Neurobiology</source><volume>55</volume><fpage>7</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2018.11.003</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartenbeck</surname> <given-names>P</given-names></name><name><surname>FitzGerald</surname> <given-names>TH</given-names></name><name><surname>Mathys</surname> <given-names>C</given-names></name><name><surname>Dolan</surname> <given-names>R</given-names></name><name><surname>Friston</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The dopaminergic midbrain encodes the expected certainty about desired outcomes</article-title><source>Cerebral Cortex</source><volume>25</volume><fpage>3434</fpage><lpage>3445</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhu159</pub-id><pub-id pub-id-type="pmid">25056572</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartenbeck</surname> <given-names>P</given-names></name><name><surname>FitzGerald</surname> <given-names>THB</given-names></name><name><surname>Dolan</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Neural signals encoding shifts in beliefs</article-title><source>NeuroImage</source><volume>125</volume><fpage>578</fpage><lpage>586</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.10.067</pub-id><pub-id pub-id-type="pmid">26520774</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Schwartenbeck</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019a</year><data-title><italic>Mechanisms_Exploration_Paper</italic></data-title><source>Github</source><version designator="14270b6">14270b6</version><ext-link ext-link-type="uri" xlink:href="https://github.com/schwartenbeckph/Mechanisms_Exploration_Paper">https://github.com/schwartenbeckph/Mechanisms_Exploration_Paper</ext-link></element-citation></ref><ref id="bib77"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Schwartenbeck</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019b</year><data-title>CPC_ActiveInference2018</data-title><source>GitHub</source><version designator="8c8edf5">8c8edf5</version><ext-link ext-link-type="uri" xlink:href="https://github.com/schwartenbeckph/CPC_ActiveInference2018">https://github.com/schwartenbeckph/CPC_ActiveInference2018</ext-link></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname> <given-names>TR</given-names></name><name><surname>Beran</surname> <given-names>MJ</given-names></name><name><surname>Young</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Gambling in rhesus macaques (Macaca mulatta): The effect of cues signaling risky choice outcomes</article-title><source>Learning &amp; Behavior</source><volume>45</volume><fpage>288</fpage><lpage>299</lpage><pub-id pub-id-type="doi">10.3758/s13420-017-0270-5</pub-id><pub-id pub-id-type="pmid">28421468</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solopchuck</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Tutorial on active inference</article-title><source>Neuroscience</source></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Speekenbrink</surname> <given-names>M</given-names></name><name><surname>Konstantinidis</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Uncertainty and exploration in a restless bandit problem</article-title><source>Topics in Cognitive Science</source><volume>7</volume><fpage>351</fpage><lpage>367</lpage><pub-id pub-id-type="doi">10.1111/tops.12145</pub-id><pub-id pub-id-type="pmid">25899069</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Srinivas</surname> <given-names>N</given-names></name><name><surname>Krause</surname> <given-names>A</given-names></name><name><surname>Kakade</surname> <given-names>SM</given-names></name><name><surname>Seeger</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Gaussian process optimization in the bandit setting: no regret and experimental design</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/pdf/0912.3995.pdf">https://arxiv.org/pdf/0912.3995.pdf</ext-link></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stalnaker</surname> <given-names>TA</given-names></name><name><surname>Liu</surname> <given-names>TL</given-names></name><name><surname>Takahashi</surname> <given-names>YK</given-names></name><name><surname>Schoenbaum</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Orbitofrontal neurons signal reward predictions, not reward prediction errors</article-title><source>Neurobiology of Learning and Memory</source><volume>153</volume><fpage>137</fpage><lpage>143</lpage><pub-id pub-id-type="doi">10.1016/j.nlm.2018.01.013</pub-id><pub-id pub-id-type="pmid">29408053</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Still</surname> <given-names>S</given-names></name><name><surname>Precup</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>An information-theoretic approach to curiosity-driven reinforcement learning</article-title><source>Theory in Biosciences</source><volume>131</volume><fpage>139</fpage><lpage>148</lpage><pub-id pub-id-type="doi">10.1007/s12064-011-0142-z</pub-id><pub-id pub-id-type="pmid">22791268</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname> <given-names>Y</given-names></name><name><surname>Gomez</surname> <given-names>F</given-names></name><name><surname>Schmidhuber</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Planning to be surprised: optimal bayesian exploration in dynamic environments</article-title><source>Artificial Intelligence</source><volume>6830</volume><fpage>41</fpage><lpage>51</lpage></element-citation></ref><ref id="bib85"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sutton</surname> <given-names>R</given-names></name><name><surname>Barto</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1998">1998a</year><source>Reinforcement Learning. an Introduction</source><publisher-loc>Cambridge, MA</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sutton</surname> <given-names>RS</given-names></name><name><surname>Barto</surname> <given-names>AG</given-names></name></person-group><year iso-8601-date="1998">1998b</year><article-title>Reinforcement learning: an introduction</article-title><source>Advances in Cancer Research</source><volume>104</volume><elocation-id>322</elocation-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takahashi</surname> <given-names>YK</given-names></name><name><surname>Roesch</surname> <given-names>MR</given-names></name><name><surname>Stalnaker</surname> <given-names>TA</given-names></name><name><surname>Haney</surname> <given-names>RZ</given-names></name><name><surname>Calu</surname> <given-names>DJ</given-names></name><name><surname>Taylor</surname> <given-names>AR</given-names></name><name><surname>Burke</surname> <given-names>KA</given-names></name><name><surname>Schoenbaum</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The orbitofrontal cortex and ventral tegmental area are necessary for learning from unexpected outcomes</article-title><source>Neuron</source><volume>62</volume><fpage>269</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.03.005</pub-id><pub-id pub-id-type="pmid">19409271</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takahashi</surname> <given-names>YK</given-names></name><name><surname>Roesch</surname> <given-names>MR</given-names></name><name><surname>Wilson</surname> <given-names>RC</given-names></name><name><surname>Toreson</surname> <given-names>K</given-names></name><name><surname>O'Donnell</surname> <given-names>P</given-names></name><name><surname>Niv</surname> <given-names>Y</given-names></name><name><surname>Schoenbaum</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Expectancy-related changes in firing of dopamine neurons depend on orbitofrontal cortex</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>1590</fpage><lpage>1597</lpage><pub-id pub-id-type="doi">10.1038/nn.2957</pub-id><pub-id pub-id-type="pmid">22037501</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takahashi</surname> <given-names>YK</given-names></name><name><surname>Batchelor</surname> <given-names>HM</given-names></name><name><surname>Liu</surname> <given-names>B</given-names></name><name><surname>Khanna</surname> <given-names>A</given-names></name><name><surname>Morales</surname> <given-names>M</given-names></name><name><surname>Schoenbaum</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Dopamine neurons respond to errors in the prediction of sensory features of expected rewards</article-title><source>Neuron</source><volume>95</volume><fpage>1395</fpage><lpage>1405</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.08.025</pub-id><pub-id pub-id-type="pmid">28910622</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Tang</surname> <given-names>H</given-names></name><name><surname>Houthooft</surname> <given-names>R</given-names></name><name><surname>Foote</surname> <given-names>D</given-names></name><name><surname>Stooke</surname> <given-names>A</given-names></name><name><surname>Chen</surname> <given-names>X</given-names></name><name><surname>Duan</surname> <given-names>Y</given-names></name><name><surname>Abbeel</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title><italic>#Exploration: A Study of Count-Based Exploration for Deep Reinforcement Learning</italic></article-title><conf-name>Advances in Neural Information Processing Systems 30 (NIPS 2017)</conf-name></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname> <given-names>WR</given-names></name></person-group><year iso-8601-date="1933">1933</year><article-title>On the likelihood that one unknown probability exceeds another in view of the evidence of two samples</article-title><source>Biometrika</source><volume>25</volume><fpage>285</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1093/biomet/25.3-4.285</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Lieshout</surname> <given-names>LLF</given-names></name><name><surname>Vandenbroucke</surname> <given-names>ARE</given-names></name><name><surname>Müller</surname> <given-names>NCJ</given-names></name><name><surname>Cools</surname> <given-names>R</given-names></name><name><surname>de Lange</surname> <given-names>FP</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Induction and relief of curiosity elicit parietal and frontal activity</article-title><source>The Journal of Neuroscience</source><volume>38</volume><fpage>2579</fpage><lpage>2588</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2816-17.2018</pub-id><pub-id pub-id-type="pmid">29439166</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vasconcelos</surname> <given-names>M</given-names></name><name><surname>Monteiro</surname> <given-names>T</given-names></name><name><surname>Kacelnik</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Irrational choice and the value of information</article-title><source>Scientific Reports</source><volume>5</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1038/srep13874</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waltz</surname> <given-names>JA</given-names></name><name><surname>Frank</surname> <given-names>MJ</given-names></name><name><surname>Robinson</surname> <given-names>BM</given-names></name><name><surname>Gold</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Selective reinforcement learning deficits in schizophrenia support predictions from computational models of striatal-cortical dysfunction</article-title><source>Biological Psychiatry</source><volume>62</volume><fpage>756</fpage><lpage>764</lpage><pub-id pub-id-type="doi">10.1016/j.biopsych.2006.09.042</pub-id><pub-id pub-id-type="pmid">17300757</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>MZ</given-names></name><name><surname>Sweis</surname> <given-names>BM</given-names></name><name><surname>Hayden</surname> <given-names>BY</given-names></name></person-group><year iso-8601-date="2018">2018</year><source>A Testable Definition of Curiosity</source><publisher-name>CDS Newsletter</publisher-name></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weickert</surname> <given-names>TW</given-names></name><name><surname>Goldberg</surname> <given-names>TE</given-names></name><name><surname>Callicott</surname> <given-names>JH</given-names></name><name><surname>Chen</surname> <given-names>Q</given-names></name><name><surname>Apud</surname> <given-names>JA</given-names></name><name><surname>Das</surname> <given-names>S</given-names></name><name><surname>Zoltick</surname> <given-names>BJ</given-names></name><name><surname>Egan</surname> <given-names>MF</given-names></name><name><surname>Meeter</surname> <given-names>M</given-names></name><name><surname>Myers</surname> <given-names>C</given-names></name><name><surname>Gluck</surname> <given-names>MA</given-names></name><name><surname>Weinberger</surname> <given-names>DR</given-names></name><name><surname>Mattay</surname> <given-names>VS</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Neural correlates of probabilistic category learning in patients with schizophrenia</article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>1244</fpage><lpage>1254</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4341-08.2009</pub-id><pub-id pub-id-type="pmid">19176832</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wikenheiser</surname> <given-names>AM</given-names></name><name><surname>Marrero-Garcia</surname> <given-names>Y</given-names></name><name><surname>Schoenbaum</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Suppression of ventral hippocampal output impairs integrated orbitofrontal encoding of task structure</article-title><source>Neuron</source><volume>95</volume><fpage>1197</fpage><lpage>1207</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.08.003</pub-id><pub-id pub-id-type="pmid">28823726</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>RC</given-names></name><name><surname>Geana</surname> <given-names>A</given-names></name><name><surname>White</surname> <given-names>JM</given-names></name><name><surname>Ludvig</surname> <given-names>EA</given-names></name><name><surname>Cohen</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2014">2014a</year><article-title>Humans use directed and random exploration to solve the explore–exploit dilemma</article-title><source>Journal of Experimental Psychology: General</source><volume>143</volume><fpage>2074</fpage><lpage>2081</lpage><pub-id pub-id-type="doi">10.1037/a0038199</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>RC</given-names></name><name><surname>Takahashi</surname> <given-names>YK</given-names></name><name><surname>Schoenbaum</surname> <given-names>G</given-names></name><name><surname>Niv</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014b</year><article-title>Orbitofrontal cortex as a cognitive map of task space</article-title><source>Neuron</source><volume>81</volume><fpage>267</fpage><lpage>279</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.11.005</pub-id><pub-id pub-id-type="pmid">24462094</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>SC-H</given-names></name><name><surname>Wolpert</surname> <given-names>DM</given-names></name><name><surname>Lengyel</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Theoretical perspectives on active sensing</article-title><source>Current Opinion in Behavioral Sciences</source><volume>11</volume><fpage>100</fpage><lpage>108</lpage><pub-id pub-id-type="doi">10.1016/j.cobeha.2016.06.009</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname> <given-names>AJ</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Uncertainty, neuromodulation, and attention</article-title><source>Neuron</source><volume>46</volume><fpage>681</fpage><lpage>692</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.04.026</pub-id><pub-id pub-id-type="pmid">15944135</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zentall</surname> <given-names>TR</given-names></name><name><surname>Stagner</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Maladaptive choice behaviour by pigeons: an animal analogue and possible mechanism for gambling (sub-optimal human decision-making behaviour)</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>278</volume><fpage>1203</fpage><lpage>1208</lpage><pub-id pub-id-type="doi">10.1098/rspb.2010.1607</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zentall</surname> <given-names>TR</given-names></name><name><surname>Stagner</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Do pigeons prefer information in the absence of differential reinforcement?</article-title><source>Learning &amp; Behavior</source><volume>40</volume><fpage>465</fpage><lpage>475</lpage><pub-id pub-id-type="doi">10.3758/s13420-012-0067-5</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.41703.016</object-id><sec id="s8" sec-type="appendix"><title>Effects of other model parameters</title><p>While our focus is on comparing ‘state exploration’ and ‘model parameter exploration’, that is <italic>active inference</italic> and <italic>active learning</italic>, respectively, it is important to note that the behaviour illustrated in our simulations also depends on other key parameters, which we consider in the following. In particular, we will address the role of an agent’s (prior) parameterisation of its observation model, an agent’s preferences over outcomes and the parameterisation of beliefs about hidden states. We will refer to the task with no cue and an uncertain reward probability in the risky option as the <italic>learning task</italic>, and to the task with a cue and an unknown hidden state that determines the reward statistics as the <italic>inference task</italic>.</p><p>Active inference and active learning provide a general and flexible framework for understanding individual variation in exploitative and exploratory behaviour. Animals can differ markedly in their risk preferences, learning speed or sensitivity to uncertainty. As we will show in this appendix, different risk preferences result from an agents’ preference distribution over outcomes. A predominance of risk-averse or risk-seeking behaviour arises from highly precise prior preferences that either emphasize not forgoing a small reward or obtaining a large reward, respectively. Further, a flat preference distribution induces a diminished prevalence of reward-based, extrinsically motivated behaviour and renders the animal more sensitive to information gain. The tendency towards epistemic foraging is also determined by an agent’s learning rate, which affects the time-course of intrinsically motivated behaviour, and prior confidence, which (in analogy with prior preferences), determines overall sensitivity to information. Inferring such individual differences in an animal’s ‘world model’ requires careful fitting of choice behaviour and model comparisons given a particular task of interest (see ‘code availability’ section).</p><sec id="s8-1"><title>Prior uncertainty over the observation model determines the value of information</title><p>In active learning, the key prior that determines an agent’s sensitivity to information is specified by the concentration parameters of the agent’s observation model (in <xref ref-type="fig" rid="fig2">Figure 2</xref>). The effects of these concentration parameters are illustrated in <xref ref-type="fig" rid="fig6">Figure 6A</xref>, which affords two key insights. First, an agent prefers the risky option if it beliefs that receiving a reward is likely (lower right corner of <xref ref-type="fig" rid="fig6">Figure 6A</xref>) but prefers the safe option if it beliefs that receiving a reward is unlikely (upper left corner of <xref ref-type="fig" rid="fig6">Figure 6A</xref>). Second, and more importantly from the perspective of active learning, the agent will prefer to sample the risky option if it has an <italic>uncertain</italic> uniform prior about the reward statistics (lower left corner of <xref ref-type="fig" rid="fig6">Figure 6A</xref>) but prefer the safe option if it has a <italic>certain</italic> uniform prior about receiving a reward (upper right corner of <xref ref-type="fig" rid="fig6">Figure 6A</xref>).</p><p>The agent’s prior over its observation model, however, incorporates additional knowledge about the task structure, such as the mapping from the safe location to a small reward or the observations in the starting position. The role of this parameterisation is illustrated in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>. <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1A</xref> illustrates an experiment where an agent has a very imprecise prior over the observation model, by specifying <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> as<disp-formula id="equ10"><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><fig id="app1fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.017</object-id><label>Appendix 1—figure 1.</label><caption><title>The agent’s prior on the observation model determines the value of information of the risky option.</title><p>Same setup as in <xref ref-type="fig" rid="fig3">Figures 3</xref>–<xref ref-type="fig" rid="fig5">5</xref>, but with different priors over the observation model. (<bold>A</bold>) Full uncertainty over an agent’s observation model induces the same information value for all three options, whereas uncertainty over the mapping from the starting point or safe option induce a specific epistemic value for these options (<bold>B and C</bold>). These priors can also induce optimistic (<bold>D</bold>) or pessimistic (<bold>E</bold>) behaviour, based on a high (prior) reward expectation in a low reward probability (0.25) task or a low (prior) reward expectation in a high reward task (0.75), respectively. (<bold>F</bold>) A lower learning rate leads to slower learning about a low reward probability (0.25) in the risky option or, equivalently, to a longer dominance of information-seeking behaviour.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-app1-fig1-v1.tif"/></fig><p>This leads to a uniform probability for choosing to stay at the starting position, or choosing the safe or risky option at the first time-step. In this example, once the agent has sampled the starting position at the first time-step, it will then choose the safe or risky option at the second time-step, because now these two options have the highest information gain. Only after choosing the safe and risky option at time-step two and three, respectively, the agent starts to explore – and exploit in a more goal-directed manner. How long this pure information gain period lasts also depends on an agent’s learning rate (see description of <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1F</xref> below). <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1B and 1C</xref> illustrate the same type of behaviour, but now with an imprecise mapping – from the starting position or the safe option – to different outcomes. Note that the information gain period lasts longer if there is uncertainty about the safe option compared to the starting position, because there is an additional exploitative motivation for choosing the safe option that delivers a small reward.</p><p>Figure <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1D and 1E</xref> illustrate the effects of non-uniform priors over reward statistics on active learning. <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1D</xref> corresponds to prior concentration parameters that reflect the upper right corner of <xref ref-type="fig" rid="fig6">Figure 6</xref> by specifying <inline-formula><mml:math id="inf90"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> as<disp-formula id="equ11"><mml:math id="m11"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>8</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>This induces a highly optimistic prior belief about obtaining a reward in the risky option. Simulating task performance under a low reward probability (p(reward)=0.25) shows that the agent samples the risky option several times before the observations overcome the (pathologic) optimism induced by the agent’s prior. In contrast, <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1E</xref> illustrates the opposite pattern (with the prior concentration parameter for receiving no reward in the risky option set to 2). This induces pessimistic behaviour – that results in a persistent preference for choosing the safe option. In this example, the agent never learns that it lives in an environment with a high reward probability (p(reward)=0.75), because it never samples the risky option, which would allow it to overcome its pessimistic prior beliefs.</p><p>Finally, <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1F</xref> illustrates a task where the agent learns only slowly from observations (<inline-formula><mml:math id="inf91"><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:math></inline-formula> instead of 0.5 as in the simulations above, see <xref ref-type="disp-formula" rid="equ9">Equation 8</xref>). Here, it takes the agent about the first third of the experiment to learn about the low reward probability (0.25) in the risky option. In other words, the value of information of the risky option dominates behaviour for a longer period than in the simulations illustrated in <xref ref-type="fig" rid="fig3">Figures 3</xref>–<xref ref-type="fig" rid="fig5">5</xref>.</p></sec><sec id="s8-2"><title>Prior preferences over outcomes determine risk preferences and the cost of information</title><p>Besides an agent’s prior beliefs about the likelihood of outcomes, another key determinant of active learning and inference is an agent’s prior preference over different outcomes. In the simulations above, we defined an agent’s preferences as c = [0 2 4 -2], which reflect its preferences for the starting position, a small reward, a high reward, and no reward, respectively (see <xref ref-type="fig" rid="fig2">Figure 2</xref>). Note that in active learning and inference, these preferences are defined as log-probabilities over outcomes. For example, the above specification implies that the agent expects to end up in a high reward state <inline-formula><mml:math id="inf92"><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:mn>4</mml:mn><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:mn>55</mml:mn></mml:math></inline-formula> times more than in the starting position (<inline-formula><mml:math id="inf93"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>). Consequently, the agent tries to infer behaviour that maximises these log-probabilities over observations, and thus minimises surprise.</p><p>Importantly, these preferences over outcomes determine an agent’s risk preferences. <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref> illustrates these effects in the active learning task, with a true underlying reward probability of 0.5 for the risky option. The ensuing behaviour shows that different risk preferences change the response profile for choosing the risky option over time.</p><fig id="app1fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.018</object-id><label>Appendix 1—figure 2.</label><caption><title>Prior preferences over outcomes determine an agent’s risk preferences.</title><p>Same setup as in <xref ref-type="fig" rid="fig6">Figure 6A</xref> but with varying preferences over outcomes, compared to the reference specification of c = [0 2 4 –2] in log-space used above (bright blue line), which reflects an agent’s preference for the starting position, the small safe reward, the high reward and no reward, respectively. Dark blue line reflects the same information seeking behaviour in the beginning of an experiment but less risk aversion in later trials by equating an agent’s preference for obtaining no reward to staying in the safe position (c = [0 2 4 0]). Purple line reflects a risk seeking agent (c = [0 2 8 –2]) whereas red line reflects a risk averse agent (c = [0 2 4 –4]). Yellow line reflects an agent that has an equal preference for the high and low reward (c = [0 4 4 –2]), and consequently never chooses the risky option. Green line reflects an agent with flat preferences (c = [0 0 0 0]), which is purely driven by information gain until it converges on a stable probability for choosing the risky option. Time-course averaged over 1000 experiments.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-app1-fig2-v1.tif"/></fig><p>The above preference specification implies that – in log-space – obtaining no reward in the risky option is equivalent to losing the low reward of the safe option. <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref> shows that a prior of c = [0 2 4 0] (dark blue line), which equates the preference for no reward with the starting position, makes the agent less risk averse compared to a prior of c = [0 2 4 –2] (bright blue line). In both parameterisations, behaviour is dominated initially by information gain, but converges to a higher probability for choosing the risky option over time, if the agent is less risk averse. Alternatively, a preference for no reward of −4 (red line) makes the agent much more risk (i.e., no reward) averse – with a zero probability of choosing the risky option, after the true reward probability is learned. This contrasts with a risk seeking agent that has a strong preference for obtaining a high reward (c = [0 2 8 –2], purple line). If the agent has the same preference for the small reward as for the high reward (c = [0 4 4 0], yellow line), the agent will never sample the risky option, because the extrinsic reward dominates policy selection. In contrast, if the agent has flat preferences over observations (c = [0 0 0 0], green line), behaviour will be dominated by information gain (in the risky option) in early trials and slowly converges towards a uniform preference for any of the three options (stay at starting point, safe or risky option).</p><p>Note that in the above parameterisation of an agent’s preferences one would not necessarily distinguish between rewards (or their omission) and punishments, even though one could also introduce these as separate factors over outcomes (<xref ref-type="bibr" rid="bib67">Pezzulo et al., 2018</xref>).</p><p>A central aspect of these simulations is that these preferences not only control an agent’s risk preferences in active learning tasks, but also the cost of information as illustrated in the active inference task. This follows because log-preferences can be thought of in terms of cost (or, formally, counter-evidence to an agent’s model). By navigating to preferred (expected) outcomes, the agent minimises cost (i.e., surprise).</p><p>This is illustrated in <xref ref-type="fig" rid="fig8">Figure 8B</xref>, where the agent infers a stable high reward context and shifts from sampling the cue at the beginning of a trial towards sampling the risky option immediately. There is no actual need to switch to sampling the risky option immediately, because there still are two time-steps available. However, given it has formed precise beliefs about the current task state, there is no additional value of information for sampling the cue. Sampling the cue is costly, because it is less preferred (expected) than obtaining a reward in the safe or risky option. This results from specifying an agent’s preferences as c = [0 2 4 –2 0 0], reflecting its preferences for the starting location, the safe reward, the high reward, no reward and visiting the cue (signalling a high or low reward), respectively. This specification induces a cost for visiting the cue location as opposed to sampling the preferred option immediately. This cost for sampling the cue has to be matched by the information gain imparted by the cue, hence the shift from sampling the cue to sampling the risky option immediately at the beginning of a trial in <xref ref-type="fig" rid="fig8">Figure 8B</xref>.</p><p><xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref> illustrates this point further. Compared to a neutral agent illustrated in <xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3B</xref> (equivalent to <xref ref-type="fig" rid="fig8">Figure 8B</xref>), an agent that has a preference for sampling the cue (c = [0 2 4 –2 0.5 0.5], <xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3A</xref>) will always go to the cue at the beginning of a trial, no matter how certain it is about the current context. In contrast, if the cue is even more costly (c = [0 2 4 –2 −0.5 –0.5], <xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3C</xref>), the agent has a preference for leaving it as early as possible, but may have to return several times because it has not fully resolved its uncertainty. Figure <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref> illustrates these time-sensitive behaviours over multiple simulated experiments.</p><fig id="app1fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.019</object-id><label>Appendix 1—figure 3.</label><caption><title>Prior preferences over outcomes determine the cost of sampling information in the active inference task – single experiment simulations.</title><p>(<bold>A</bold>) An agent that prefers sampling the cue will continue to sample the cue at the beginning of a trial, even if its uncertainty about the hidden state has been resolved. (<bold>B</bold>) An agent with neutral preferences for the cue will switch to sampling the preferred (risky) option immediately once its uncertainty about the (high reward) hidden state is sufficiently resolved (equivalent to <xref ref-type="fig" rid="fig8">Figure 8B</xref>). (<bold>C</bold>) An agent with a negative preference for the cue will try to switch to the preferred option as quickly as possible, but may go back to sample the cue more often because its uncertainty has not been resolved sufficiently.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-app1-fig3-v1.tif"/></fig><fig id="app1fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.020</object-id><label>Appendix 1—figure 4.</label><caption><title>Prior preferences over outcomes determine the cost of information sampling in the active inference task – simulations over multiple experiments – simulations over 1000 experiments..</title><p>The yellow line reflects the agent introduced in <xref ref-type="fig" rid="fig8">Figure 8B</xref> with neutral preferences for the cue location, specified as c = [0 2 4 –2 0 0], which reflects its preferences for the starting location, safe reward, high reward, no reward and the cue location (signalling a high or low reward state), respectively. Agents with a slight preference for visiting the cue only slowly decrease their preference for sampling the cue at the beginning of a trial (purple: c = [0 2 4 –2 0.25 0.25]; green: c = [0 2 4 –2 0.5 0.5]). Agents with a negative preference for the cue location move away from sampling the cue quicker (red: c = [0 2 4 –2 −0.25 –0.25]; blue: c = [0 2 4 –2 −0.5 –0.5]). Time-course averaged over 1000 experiments.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-app1-fig4-v1.tif"/></fig></sec><sec id="s8-3"><title>Beliefs about hidden states in dynamic environments</title><p>Importantly, all simulations above are based on environments with a static structure, which allows agents to converge on one stable representation of the task over time. In reality, however, environments are volatile and change over time, such that new statistics have to be learned or novel hidden states have to be inferred. The simplest example of a dynamic environment is a reversal task, in which the true hidden state changes over time.</p><p>A detailed treatment of this issue goes beyond the scope of this paper. However, an important quality check for the present formulation is whether behaviour adapts to a changing environment. <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref> and <xref ref-type="fig" rid="app1fig6">6</xref> illustrate adaptive behaviour in the active inference task. Here, we introduced a reversal of the hidden state after half of the experimental trials, such that the agent is in a high reward context in the first 16 trials followed by a low reward context in the next 16 trials (as indicated by a change from ‘green’ context to ‘red’ context in the second panel of <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5A</xref> and <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5B</xref>). <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5A</xref> shows that an active inference agent correctly infers the high reward context and moves slowly towards choosing the risky option immediately at the beginning of the trial (first time-step). After the switch to a low reward context in trial 16, however, the agent starts sampling the cue again. This behaviour is induced by a negative feedback in the risky option in trial 17 and is then reinforced by feedback from the cue, which now signals a low reward context. Thus, the active inference agent correctly infers whether the current context has changed, and whether a recent increase in its uncertainty about the current context increases the value of information at the cue location again.</p><fig id="app1fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.021</object-id><label>Appendix 1—figure 5.</label><caption><title>An active inference agent correctly infers a change in the environment – single experiment simulations.</title><p>(<bold>A</bold>) An active inference agent correctly learns that it starts in a high reward environment, and slowly begins to sample the risky option at the beginning of a trial once it has inferred a high reward context. After a switch of context to a low reward environment in trial 16, however, the agent starts sampling the cue again. This is induced by a negative outcome at trial 17 and then further reinforced by a different context signalled by the cue. Thus, the active inference agent correctly infers when to start sampling information again as a function of its uncertainty about the world. (<bold>B</bold>) If an agent has optimistic prior expectations about being in a high reward context, it starts sampling the risky option immediately even at the beginning of the experiment, and it will take the agent longer to infer a switch of context in the second half of the experiment.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-app1-fig5-v1.tif"/></fig><fig id="app1fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.022</object-id><label>Appendix 1—figure 6.</label><caption><title>An active inference agent correctly infers a change in the environment – simulations over multiple experiments.</title><p>Same agents as in <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref> (<bold>A</bold> and <bold>B</bold>) simulated over 1000 experiments. The neutral active inference agent correctly infers a switch after the first half of the experiment and starts sampling the cue again. The optimistic active inference agent does not sample the cue in the first half of the experiment, but starts visiting the cue location once it has inferred that the context has changed.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-app1-fig6-v1.tif"/></fig><p>As introduced above, a central aspect of these simulations are an agent’s beliefs about the current context, which can be parameterised with concentration parameters akin to an agent’s observation model. These priors over beliefs about the context are specified in an agent’s d-vector (see <xref ref-type="fig" rid="fig7">Figure 7</xref>). In <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5A</xref>, the d-vector reflects an uncertain uniform prior over being in one of the two contexts (d = [0.25 0.25 0 0 0 0 0 0]). <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5B</xref> illustrates an example where the agent has a strong prior expectation about starting in a high reward context (d = [8 0.25 0 0 0 0 0 0]). This motivates the agent to sample the risky option immediately without sampling the cue first, and only when it has sampled enough evidence in favour of a change of context (several trials after the actual change) it starts sampling the cue at the beginning of a trial again. <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref> illustrates the time-course of behaviour for these two agents over multiple experiments.</p></sec></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.41703.023</object-id><sec id="s9" sec-type="appendix"><title>Relationship to other computational approaches to exploration</title><p>There has been much recent interest in understanding the mechanisms of exploration and curiosity. As mentioned in the introduction, the simplest account of exploration has been cast in terms of <inline-formula><mml:math id="inf94"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>-greedy and softmax choice rules with an inverse temperature parameter (<xref ref-type="bibr" rid="bib86">Sutton and Barto, 1998b</xref>), which governs the randomness in behaviour and thus the deviation from rational, exploitative choices. However, this account of exploration can be problematic because often it is unclear whether this truly captures (random) exploratory tendencies or just different forms of noise (e.g., Findling, Skvortsova, Dromnelle, Palminteri, &amp; Wyart, 2018). In active inference and learning, the tendency towards randomness is captured by the (prior) precision of policy selection (<inline-formula><mml:math id="inf95"><mml:mi>β</mml:mi></mml:math></inline-formula>) as shown in the simulations in the main text. In the one-shot and two-shot tasks simulated here, this (prior) precision plays a very similar role to an inverse temperature parameter. In more sophisticated tasks with larger policy depths, precision itself will be updated (inferred) over time, implying that an agent’s ‘inverse temperature’ has a time-sensitive Bayes optimal solution and the agent infers the ‘best’ level of randomness based on task events.</p><p>Two prominent examples of more sophisticated routines for goal-directed and random exploration are upper confidence bounds (UCB) and Thompson sampling, respectively. These computational frameworks have been discussed in much detail in previous work (<xref ref-type="bibr" rid="bib32">Gershman, 2018a</xref>; <xref ref-type="bibr" rid="bib33">Gershman, 2018b</xref>; <xref ref-type="bibr" rid="bib73">Schulz and Gershman, 2019</xref>). The central idea of UCB is to add an additional value to an option that reflects its informative value. Similar to a novelty bonus (<xref ref-type="bibr" rid="bib46">Kakade and Dayan, 2002</xref>), this additional value can reflect the number of times this option has been sampled previously (<xref ref-type="bibr" rid="bib4">Auer, 2002</xref>; <xref ref-type="bibr" rid="bib3">Auer et al., 2002</xref>) or the variance in an agent’s beliefs about the value of this option (<xref ref-type="bibr" rid="bib81">Srinivas et al., 2010</xref>). Thompson sampling, on the other hand, is a more sophisticated algorithm for random exploration. Here, the key idea is that agent’s sample from beliefs about the reward statistics of different options, and then exploit (i.e., take the most valuable option) with respect to this sample. Thus, the uncertainty about the reward statistics guides the degree of randomness in behaviour, and consequently controls the degree of random exploration.</p><p>As shown in <xref ref-type="bibr" rid="bib32">Gershman (2018a)</xref> and <xref ref-type="bibr" rid="bib33">Gershman (2018b)</xref>, these two classes of algorithms have different effects on the exploitation-exploration trade-off. Uncertainty bonuses such as UCB add a value to sampling an option in addition to its expected value. This induces an intercept shift in the probability for sampling this option, as shown in <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref> (left panel). The higher the uncertainty bonus, the higher is the agent’s preference for sampling this option, even if its expected value is smaller than other options (in line with the additive aspects of Blanchard et al.’s findings). In contrast, random exploration, such as Thompson sampling, induces a change of the slope in the choice function, such that more randomness induces a flatter choice function (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref> right panel). <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1B</xref> illustrates that these effects closely correspond to the effects of active learning or active inference and precision on behaviour. ‘Model parameter exploration’ or ‘hidden state exploration’ is defined as an additive term in the agent’s value function (<xref ref-type="disp-formula" rid="equ8">Equation 7</xref>, Materials and methods section) and can thus be seen as aspects of information-directed exploration. Thus, it induces an intercept shift analogously to UCB (displayed in <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1B</xref> left panel for ‘model parameter exploration’ in active learning, effects for active inference are analogous). Precision, or randomness, on the other hand, affects the slope of the agent’s preference function (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1B</xref>, right panel) and plays a very similar role to an inverse temperature parameter.</p><fig id="app2fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.41703.024</object-id><label>Appendix 2—figure 1.</label><caption><title>Effects of different algorithms for exploration on choice probabilities.</title><p>(<bold>A</bold>) <italic>Left panel:</italic> Algorithms based on an uncertainty bonus, such as UCB, change the intercept in the probability for choosing the uncertain option, plotted as a function of the difference in expected value between the uncertain option and an alternative option. <italic>Right panel:</italic> Algorithms based on randomness, such as Thompson sampling, change the slope of the choice probability, where an increase in randomness decreases the steepness of the choice curve. Reproduced from (<xref ref-type="bibr" rid="bib32">Gershman, 2018a</xref>) (<bold>B</bold>) <italic>Left panel:</italic> ‘model parameter exploration’ in active inference acts as an uncertainty bonus and, analogously to UCB, changes the intercept of the probability to sample an uncertain option as a function of the prior uncertainty over this option. Different lines reflect different concentration parameters for the mapping to high or no reward in the risky option (cf., <xref ref-type="fig" rid="fig2">Figure 2</xref>, CP = concentration parameter). ‘Hidden state exploration’ in active inference has analogous effects. <italic>Right panel:</italic> prior precision of policy selection (<inline-formula><mml:math id="inf96"><mml:mi>β</mml:mi></mml:math></inline-formula>) affects the randomness of choice behaviour, and consequently the slope of the choice function.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-41703-app2-fig1-v1.tif"/><permissions><copyright-statement>© 2017 Cognition. All rights reserved</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Cognition</copyright-holder><license><license-p>Reprinted from <xref ref-type="bibr" rid="bib32">Gershman (2018a)</xref> with permission from Elsevier. This panel is not available under CC-BY and is exempt from the CC-BY 4.0 license.</license-p></license></permissions></fig><p>The recent interest in deep neural networks their application to more realistic tasks has led to an increased focus on algorithms for exploration. This is motivated by a characteristic failure of ‘deep reinforcement learning’ models in tasks that require goal-directed exploratory behaviour, such as the Atari game Montezuma’s revenge (<xref ref-type="bibr" rid="bib15">Burda et al., 2018b</xref>; <xref ref-type="bibr" rid="bib56">Mnih et al., 2015</xref>). These tasks are difficult because reward is sparse and many states are only visited once, if at all, and thus motivate a more flexible definition of an intrinsic reward that guides behaviour.</p><p>Much progress in this field is based on defining intrinsic motivation as the expected learning progress in a given problem, such that agents ‘plan to be surprised’ (<xref ref-type="bibr" rid="bib6">Barto, 2013</xref>; <xref ref-type="bibr" rid="bib14">Burda et al., 2018a</xref>; <xref ref-type="bibr" rid="bib55">Luciw et al., 2013</xref>; <xref ref-type="bibr" rid="bib63">Oudeyer et al., 2007</xref>; <xref ref-type="bibr" rid="bib64">Oudeyer and Kaplan, 2007</xref>; <xref ref-type="bibr" rid="bib71">Schmidhuber, 1991</xref>; <xref ref-type="bibr" rid="bib84">Sun et al., 2011</xref>; <xref ref-type="bibr" rid="bib43">Itti and Baldi, 2009</xref>). This is conceptually similar to defining an uncertainty bonus for a given option. Given that these methods are often difficult to apply to large-scale problems, other algorithms for novelty detection have been proposed. Count-based methods use previous visits of a state as a measure for their novelty, with a recent extension of pseudo-count methods to generalise these methods to more complicated (non-tabular) problems (<xref ref-type="bibr" rid="bib8">Bellemare and Srinivasan, 2016</xref>; <xref ref-type="bibr" rid="bib62">Ostrovski and Bellemare, 2017</xref>; <xref ref-type="bibr" rid="bib90">Tang et al., 2016</xref>). Other forms of novelty detection are based on (exemplar) classification methods (<xref ref-type="bibr" rid="bib31">Fu, 2017</xref>) or ‘network distillation‘, where the difference between a trained and a random network is used as a measure for novelty, based on how much an observation deviates from the training set (<xref ref-type="bibr" rid="bib15">Burda et al., 2018b</xref>).</p><p>Perhaps closest to the framework presented here is the Variational Information Maximising Exploration algorithm (<xref ref-type="bibr" rid="bib39">Houthooft et al., 2016</xref>), which is based on the idea of finding future trajectories (policies) that maximise the sum of entropy reduction in beliefs about environment dynamics. This means that agents should visit states that maximise the mutual information of prior and posterior beliefs about transition probabilities in the environment. Note that this follows a very similar logic to our treatment of active inference, except that it is applied to the agent’s transition probabilities (B-matrix in <xref ref-type="fig" rid="fig2">Figure 2</xref>) rather than its observation model (A-matrix in <xref ref-type="fig" rid="fig2">Figure 2</xref>).</p><p>Note that, while many of the above algorithms have successfully introduced the notion of exploration and novelty to large-scale problems, a key motivation behind our proposed framework is understanding the generative mechanisms that underlie information gain and its trade-off with reward maximisation. How inference based on these generative mechanisms proceeds in more complicated tasks – where a representation of the feature or state space needs to be learned in the first place to build the A, B, c, and d-matrices of <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig7">7</xref> – is an important question for future work.</p></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.41703.026</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Frank</surname><given-names>Michael J</given-names></name><role>Reviewing Editor</role><aff><institution>Brown University</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for sending your article entitled &quot;Computational mechanisms of curiosity and goal-directed exploration&quot; for peer review at <italic>eLife</italic>. Your article is being evaluated by Michael Frank as the Senior Editor and Reviewing Editor, and two reviewers.</p><p>Summary:</p><p>The authors explore the computational mechanisms of curiosity/information-seeking, focusing particularly on the distinction between two forms of goal-directed exploration. In particular they clarify through theoretical analysis and simulations the distinction between active inference (to reduce uncertainty about which world model is valid) and active learning (reducing uncertainty about the parameters of that model; e.g., outcome distributions or state transition probabilities), both within a framework of free energy reduction. The authors also outline circumstances in which active learning and/or active inference may be exposed as a function of the environment's structure and parameterization. Overall this is original work and the topics are timely.</p><p>Essential revisions:</p><p>Despite the strengths of the manuscript, the reviewers both had substantial reservations that would need to be addressed in a revision. The two reviewer points are consolidated below.</p><p>1) The reviewers were both concerned about the lack of connection of the analysis to empirical data that could be used to constrain or falsify it. They felt that the simulations are simple enough that there should be some data out there that could corroborate their model's predictions, and that for a life sciences (instead of purely computational) journal this is important.</p><p>- For example, the authors outline clear behavioral patterns that should be observed when an animal begins a simple t-maze task with risky options, or an experiment with a disambiguating cue. Are there existing data that could help support the model's claims here? Some evidence showing that rats preferentially sample from a risky option early, but switch to the low-risk option over time would certainly seem to be available in the corpus of animal behavior literature. In so doing, the reviewers also agreed that it would be important to compare your model to some alternatives, even if not doing formal model comparison with quantitative fitting, but at least qualitatively.</p><p>2) They also both agreed that there was very little connection to neural mechanisms despite various work that has been conducted in this domain. One reviewer noted &quot;The decision to sample a cue to infer a hidden state involves cost-benefit tradeoffs relying on specific neural substrates but these are not mentioned at all. It also involves active sensing behaviors – such as whisking, about which a lot is known – but there is no real mention of any active sensing literature. The simulations in Figure 3 predict clear-cut risk aversion but there is no discussion of the fact that animals show mixtures of risk seeking and risk aversion when tested in these conditions. Active learning and active inference are associated with different neural substrates and behaviors but this is never mentioned when discussing the two mechanisms.&quot;</p><p>3) Technically, there were also a few important concerns that would have to be addressed:</p><p>- One concern was the flexibility of the free-energy framework, and how sensitive/robust it might be with respect to initial conditions and priors. For example, the agent in the first simulation takes an initialization as specified in Figure 2. Given that the agent is tasked with updating A, how dependent are these results on the initialization of A (a0 in this case). In particular, how robust are these results to variation in the a0 prior. From the prior used here, it appears as though the agent already has some knowledge of what to expect when it samples the risky option.</p><p>- Further to the issue of the prior – how robust are these results to the reward prior specified in matrix c? Can the authors justify the use of zero reward in all non rewarding states, but a -2 reward for a state that omits a reward? Do results depend on this initialization? More traditional models would encode the omission of a reward as zero – would punishment be encoded any differently (e.g. small foot shock instead of reward omission)?</p><p>- If the model is to be used for quantification of real datasets (i.e., fitting), then it would be necessary to verify that its parameters are recoverable / identifiable.</p><p>4) Other scenarios regarding the generality of the conclusions:</p><p>- The results outlined in Figure 10 show that the agent adapts to the consistent structure found in the environment, opting not to sample the informative cue once it has determined that the risky outcome will in fact be found reliably. If the environment were switched to offer a high reward 25% of the time once the agent was confident that it would get a reward 75% of the time would it resample the cue? That is, can the agent adapt its active inference to accommodate environments with low volatility periods?</p><p>- Behavior is often associated with some cost, which complicates the decision as to whether a cue should be sampled prior to reward pursuit. Does the model behave reasonably if there's a cost associated with sampling the cue?</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Computational mechanisms of curiosity and goal-directed exploration&quot; for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by Michael Frank (Senior Editor), a Reviewing Editor, and two reviewers.</p><p>As you will see the two reviewers had polarized views on the merits of the paper. The main concern is that some of the connections to empirical data are misleading, and that the paper is difficult to read. After discussion with them, and reading it myself, I think the latter concern partially reflects the fact that you thoroughly responded to original concerns during the triage process and those in the reviews, which may have made the case more compelling but also the paper became a little unwieldy (and part of that is to be expected for technical papers). Thus, I am asking that you again revise the paper, but this time mostly for clarity.</p><p>Essential revisions:</p><p>My first suggestion is thus that you take a full editing pass through the paper again (perhaps offering to an arms-length colleague for comments) to try to streamline the readability – I will leave it up to you how to do this. My second suggestion is to also try to tighten up the language in reference to the empirical data that reviewer 2 found to be 'vague'. Finally, it is great that you made all code accessible so that anyone can test the properties of the model themselves, but if there are additional ways you can expose key falsifiable predictions of the theory (beyond those that are postdictions of existing data) that would be useful.</p><p><italic>Reviewer #1:</italic> </p><p>I feel that the authors sufficiently addressed most issues that we raised with the initial manuscript. They don't offer a demonstration that model parameters are recoverable, but I agree with their argument that perhaps this isn't necessary here. My only remaining issue is that, as a paper, it feels a bit long winded and somewhat fragmented – but this is more a matter of taste than it is of publishability.</p><p><italic>Reviewer #2:</italic> </p><p>This is a revision of a paper that tries to explain the free energy framework and its significance for exploration and exploitation. The authors responded to the requests from the previous round of reviews to include a discussion of how their data can capture empirical observations by adding 7 (!) new figures, bringing the total to 21 (!) figures in the main text.</p><p>I am afraid that, although I do appreciate their effort, this revision does little to address my concerns. This, in my view, remains an engineering paper, concerned primarily on how to make a system that generates exploration and exploitation. It is not a paper that carefully considers – or even understands – empirical work, or that provides a model that makes *falsifiable* predictions or can be tested against *competing* models of empirical results.</p><p>The discussion of empirical results that the authors added is riddled with vague and meaningless – and often entirely wrong statements. Let me give just one example from subsection “Active inference and active learning in behavior”: &quot;This is in line with previous work on curiosity and exploration, where attention and salience have been identified as central mechanisms that modulate curiosity.…&quot; I am quite familiar with the papers that are cited and I am positive that they said very little about how &quot;attention&quot; and &quot;salience&quot; &quot;modulate&quot; curiosity. I wonder what the authors mean by this. Do they mean that the papers manipulated attention and tested if people were more curious when attention was diverted one way or another? (This was not the case). Did they mean that those papers manipulate salience and test how this produces curiosity? (Again, not the case.) And so on.</p><p>This is but one example – but the paper is *full* of such statements, to the extent that I find it, quite frankly, unreadable. I am very sorry to be so negative, especially since I appreciate the work the authors put in. I return to my original opinion – this time with even more conviction after this review – that this paper is simply not suitable for an empirical journal – it is a paper about computer science and engineering.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.41703.027</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>Despite the strengths of the manuscript, the reviewers both had substantial reservations that would need to be addressed in a revision. The two reviewer points are consolidated below.</p><p>1) The reviewers were both concerned about the lack of connection of the analysis to empirical data that could be used to constrain or falsify it. They felt that the simulations are simple enough that there should be some data out there that could corroborate their model's predictions, and that for a life sciences (instead of purely computational) journal this is important.</p><p>- For example, the authors outline clear behavioral patterns that should be observed when an animal begins a simple t-maze task with risky options, or an experiment with a disambiguating cue. Are there existing data that could help support the model's claims here? Some evidence showing that rats preferentially sample from a risky option early, but switch to the low-risk option over time would certainly seem to be available in the corpus of animal behavior literature.</p></disp-quote><p>We agree with the referees that this analysis would substantially improve our manuscript. We now discuss specific behavioural (and neuronal, see below) predictions from our computational perspective in an additional subsection called “Behavioural and neuronal predictions”. The contribution of this section is twofold. First, we outline key behavioural and neuronal predictions that can be used to validate or falsify certain aspects of the model, such as the relationship between the (extrinsic) value of an option and its (intrinsic) informativeness. Second, we discuss these predictions in the light of existing behavioural and neuronal results in the animal literature (similar to Yu and Dayan, 2005, for instance). For example, we discuss behavioural evidence for an additive value of information in addition to reward (e.g., Vasconcelos, Monteiro and Kacelnik, 2015 in starlings) or a preference for sampling a risky option motivated by information gain, even if the safe option has higher expected utility (Smith, Beran and Young, 2017 in macaques). In particular, we discuss and simulate results from Blanchard, Hayden and Bromberg-Martin, (2015), showing evidence for a supra-additive effect of ‘information’ on the value of an option as a function of its (extrinsic) reward. Importantly, despite using a ‘rat’ as an example agent, the model-based predictions reported here are not restricted to rodents. Consequently, we discuss these predictions based on different examples from the entire animal literature.</p><p>We would be happy to include and discuss any additional results or references that we might have missed during our literature review.</p><disp-quote content-type="editor-comment"><p>In so doing, the reviewers also agreed that it would be important to compare your model to some alternatives, even if not doing formal model comparison with quantitative fitting, but at least qualitatively.</p></disp-quote><p>We agree that this is a useful extension to our manuscript. To address this, we have included an additional subsection called “Relationship to other computational models of exploration”, where we discuss some of the most prominent existing computational frameworks for exploration in reinforcement learning and deep neural networks, such as Thompson sampling or upper confidence bounds (similar to Gershman, 2018).</p><disp-quote content-type="editor-comment"><p>2) They also both agreed that there was very little connection to neural mechanisms despite various work that has been conducted in this domain. One reviewer noted &quot;The decision to sample a cue to infer a hidden state involves cost-benefit tradeoffs relying on specific neural substrates but these are not mentioned at all. It also involves active sensing behaviors – such as whisking, about which a lot is known – but there is no real mention of any active sensing literature. The simulations in Figure 3 predict clear-cut risk aversion but there is no discussion of the fact that animals show mixtures of risk seeking and risk aversion when tested in these conditions. Active learning and active inference are associated with different neural substrates and behaviors but this is never mentioned when discussing the two mechanisms.&quot;</p></disp-quote><p>We agree that this discussion provides an important and useful addition to our manuscript. We now outline specific neuronal predictions based on active inference and active learning in the subsection “Behavioural and neuronal predictions” alongside key behavioural implications. We also assess the evidence for these predictions in relation to reported results on the neuronal implementation of active inference and active learning (e.g. Blanchard, Hayden and Bromberg-Martin, 2015 in monkeys; Ligneul, Mermillod and Morisseau, 2018 in humans and as discussed in Gottlieb, Oudeyer, Lopes and Baranes, 2013; Kidd and Hayden, 2015) and their relation to the active sensing literature (e.g., Yang, Lengyel and Wolpert, 2016; Yang, Wolpert and Lengyel, 2018). The model-based predictions described in our paper are also strongly aligned with identity (information) prediction errors that have recently been reported in rodents (Takahashi et al., 2017), which we now discuss in more detail. As above, given that our computational predictions are not limited to rodents, we discuss different examples from the animal literature that illustrate the neuronal implementation of active inference and active learning.</p><p>The issue of risk seeking and risk avoiding behaviour and its relation to ambiguity reduction is a very important one. We now discuss this in more detail in the subsection “Effects of other model parameters’”, please see below). Risk preferences are determined by an agent’s preferences over outcomes (c-vector), which can induce risk seeking or risk avoiding behaviour in agents.</p><disp-quote content-type="editor-comment"><p>3) Technically, there were also a few important concerns that would have to be addressed:</p><p>- One concern was the flexibility of the free-energy framework, and how sensitive/robust it might be with respect to initial conditions and priors. For example, the agent in the first simulation takes an initialization as specified in Figure 2. Given that the agent is tasked with updating A, how dependent are these results on the initialization of A (a0 in this case). In particular, how robust are these results to variation in the a0 prior. From the prior used here, it appears as though the agent already has some knowledge of what to expect when it samples the risky option.</p><p>- Further to the issue of the prior – how robust are these results to the reward prior specified in matrix c? Can the authors justify the use of zero reward in all non rewarding states, but a -2 reward for a state that omits a reward? Do results depend on this initialization? More traditional models would encode the omission of a reward as zero – would punishment be encoded any differently (e.g. small foot shock instead of reward omission)?</p></disp-quote><p>We agree that these are important issues to discuss. As we briefly mention in the manuscript, predicted behaviour also depends on other parameters in the model, including an agent’s prior on the observation model (a0) and preferences over outcomes (cost/utility function, c-vector). In the subsection “Effects of other model parameters” we now discuss the effects of these parameters (all available at https://github.com/schwartenbeckph/Mechanisms_Exploration_Paper).</p><p>We illustrate that the current specification of the prior on an agent’s observation model as reported in the manuscript implies high uncertainty about obtaining a reward in the risky option, by assigning an imprecise (i.e., low concentration parameters) uniform prior over the reward statistics in the risky option. Changing these priors affects an agent’s expectations about obtaining a reward in the risky option, either by inducing more optimistic or pessimistic expectations about the reward statistics, or by making the uniform prior more precise. We will illustrate the effects of such priors on resultant behaviour. The only other knowledge that this prior reflects is basic task-specific information, such as the fact that there will be no high reward in the safe option or no reward at all in the starting position. It is possible to assign prior uncertainty to the mappings in the safe option and starting position as well, which would associate these states with information gain, as we briefly illustrate in the manuscript ().</p><p>Second, we now illustrate the effects of an agent’s prior preferences on behaviour, including simulations where the omission of a reward is parameterised with a value of zero (as in Friston et al., 2015 or Schwartenbeck and Friston, 2016, for instance, see subsection “Prior preferences over outcomes determine risk preferences and the cost of information”). This does not affect the general behaviour or claims of the paper. Further, we also discuss the role of these priors in terms of their role as a cost or (negative) utility function. In the simulations presented in this manuscript, both rewards and punishments are accounted for in the same preference function (c-vector) and ‘punishment’ would simply have a more negative value than the omission of a reward (see subsection “Prior preferences over outcomes determine risk preferences and the cost of information”). Because prior preferences can also be understood as (negative) costs, visiting the cue before sampling the most valuable option is costly and needs to be justified by the information gain imparted by the cue (please see below).</p><disp-quote content-type="editor-comment"><p>- If the model is to be used for quantification of real datasets (i.e., fitting), then it would be necessary to verify that its parameters are recoverable / identifiable.</p></disp-quote><p>We feel that the point of our paper is a more theoretical and general one similar to recent discussions of theoretical accounts of exploration (e.g., Gershman, 2017; 2018), which also do not mention the specifics of model fitting procedures or parameter recovery. We believe that an additional subsection on model fitting and parameter recovery would be beyond the scope of this manuscript. Model fitting procedures and tests for parameter recovery are illustrated in detail in a recent tutorial on active inference and active learning (‘practical_II.m’ at https://github.com/schwartenbeckph/CPC_ActiveInference20182, also discussed in Schwartenbeck and Friston, 2016, for instance, which we now mention in subsection “Behavioural and neuronal predictions” and in our ‘code availability’ statement).</p><p>However, if the reviewers believe that including a subsection on model fitting and parameter recovery would be necessary, then we would be happy to add this to the manuscript or a supplement.</p><disp-quote content-type="editor-comment"><p>4) Other scenarios regarding the generality of the conclusions:</p><p>- The results outlined in figure 10 show that the agent adapts to the consistent structure found in the environment, opting not to sample the informative cue once it has determined that the risky outcome will in fact be found reliably. If the environment were switched to offer a high reward 25% of the time once the agent was confident that it would get a reward 75% of the time would it resample the cue? That is, can the agent adapt its active inference to accommodate environments with low volatility periods?</p></disp-quote><p>This is an important observation that speaks to the implementation of active inference and learning in problems like reversal learning paradigms. We now discuss this in the final part of the subsection “Effects of other model parameters”. We show that active inference can accommodate reversals and dynamic changes in the environment. Active inference predicts that an agent will start to sample the cue again if its uncertainty about the current context increases following observations that indicate a change in task structure. We also show that this behaviour depends on prior expectations about the (stability of the) task structure.</p><disp-quote content-type="editor-comment"><p>- Behavior is often associated with some cost, which complicates the decision as to whether a cue should be sampled prior to reward pursuit. Does the model behave reasonably if there's a cost associated with sampling the cue?</p></disp-quote><p>This point speaks to the definition of the c-vector as the agent’s cost function or (negative) expected utilities. In fact, in the simulations that we present in this manuscript there is a cost for sampling the cue, because the cue is less valuable than sampling the safe (or high reward risky) option. That is the reason why the agent chooses to sample the safe or risky option right away once the ambiguity about the risk probabilities is resolved – even though it could still sample the cue first, because every trial consists of two time-steps. This is because sampling the cue has higher cost compared to the safe option (or risky option if it is associated with a reward probability of more than 0.5). One could also make the cue costlier by assigning it with a lower value in the c-vector, which would allocate a higher cost for visiting the cue compared to staying at the starting position, for instance. In general, in any situation where the safe (and high reward risky) option has lower cost (higher utility) than the cue, the value of information has to exceed the cost of visiting the cue to motivate the agent to explore the cue first at the beginning of a trial.</p><p>We now illustrate this sort of behaviour (subsection “Prior preferences over outcomes determine risk preferences and the cost of information”).</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>As suggested, we have thoroughly revised our manuscript with the aim of making it more readable and improving its clarity.</p><p>In particular, we have made the following changes:</p><p>We have now moved two subsections of the main manuscript to an appendix, namely the subsection “Effects of other model parameters” and subsection “‘Relationship to other computational approaches to exploration’”. While we believe that these are important sections, they are less critical for conveying the general claims of the paper, and we hope that the main manuscript has become more coherent that way.</p><p>Consequently, we have also reduced the number of figures from 21 to 13 in the main text.</p><p>We have tried to clarify the language throughout the paper (changes are marked in yellow), with particular emphasis on the issues raised by referee 2.</p><p>As suggested, we have re-written and clarified our subsection on open questions and empirical predictions, following our discussion of empirical evidence for active inference and active learning. In behaviour, it is often possible to find a prior parameterisation that explains individual behaviour that seems suboptimal or deviant from model predictions. Nevertheless, we discuss specific predictions from our model that arise from the (supra) additivity assumption of information and reward and the discounting of future information. Neuronally, we discuss predictions and open questions about the neuronal encoding of information as predicted by our framework, in particular (empirically testable) predictions about dopaminergic responses to information and the interplay of a factorised (prefrontal cortex) and a conjunctive (dopamine neurons) value code.</p><p>We have now split up our description of the model into a more conceptual description in our Results section and a more technical description in our Materials and methodsmethods section at the end of the manuscript.</p><p>We have also tried to make the manuscript less “fragmented” (pointed out by referee 1) by describing how the different sections connect to each other at the beginning and end of the individual sections.</p><p>We hope that this is what you had in mind and that the manuscript has become more readable now. We would be happy to treat any of these aspects in more detail if you feel that our treatment of any of the raised issues was not sufficient.</p></body></sub-article></article>