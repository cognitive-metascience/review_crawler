<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">46923</article-id><article-id pub-id-type="doi">10.7554/eLife.46923</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Microbiology and Infectious Disease</subject></subj-group></article-categories><title-group><article-title>Consistent and correctable bias in metagenomic sequencing experiments</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-134822"><name><surname>McLaren</surname><given-names>Michael R</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1575-473X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-135560"><name><surname>Willis</surname><given-names>Amy D</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2802-4317</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-134821"><name><surname>Callahan</surname><given-names>Benjamin J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8752-117X</contrib-id><email>benjamin.j.callahan@gmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Population Health and Pathobiology</institution><institution>North Carolina State University</institution><addr-line><named-content content-type="city">Raleigh</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Biostatistics</institution><institution>University of Washington</institution><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Bioinformatics Research Center</institution><institution>North Carolina State University</institution><addr-line><named-content content-type="city">Raleigh</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Turnbaugh</surname><given-names>Peter</given-names></name><role>Reviewing Editor</role><aff><institution>University of California, San Francisco</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Garrett</surname><given-names>Wendy S</given-names></name><role>Senior Editor</role><aff><institution>Harvard T.H. Chan School of Public Health</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>10</day><month>09</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e46923</elocation-id><history><date date-type="received" iso-8601-date="2019-03-16"><day>16</day><month>03</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2019-08-10"><day>10</day><month>08</month><year>2019</year></date></history><permissions><copyright-statement>Â© 2019, McLaren et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>McLaren et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-46923-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.46923.001</object-id><p>Marker-gene and metagenomic sequencing have profoundly expanded our ability to measure biological communities. But the measurements they provide differ from the truth, often dramatically, because these experiments are biased toward detecting some taxa over others. This experimental bias makes the taxon or gene abundances measured by different protocols quantitatively incomparable and can lead to spurious biological conclusions. We propose a mathematical model for how bias distorts community measurements based on the properties of real experiments. We validate this model with 16S rRNA gene and shotgun metagenomics data from defined bacterial communities. Our model better fits the experimental data despite being simpler than previous models. We illustrate how our model can be used to evaluate protocols, to understand the effect of bias on downstream statistical analyses, and to measure and correct bias given suitable calibration controls. These results illuminate new avenues toward truly quantitative and reproducible metagenomics measurements.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>metagenomics</kwd><kwd>microbiome</kwd><kwd>16S rRNA gene</kwd><kwd>reproducibility</kwd><kwd>bias</kwd><kwd>calibration</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><funding-statement>The authors declare that there was no funding for this work.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A mathematical model of bias in marker-gene and metagenomic sequencing measurements explains systematic errors in defined mixtures of microbial species, and enables quantitative and reproducible investigation of biological communities.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Marker-gene and metagenomic sequencing (jointly, MGS) have transformed the study of biological communities. Extracting and sequencing total DNA from a community can identify thousands of taxa along with their genes and potential functions, while sequencing a phylogenetic marker gene (e.g. 16S rRNA) can quantify taxon abundances (<xref ref-type="bibr" rid="bib38">Li, 2015</xref>; <xref ref-type="bibr" rid="bib52">Quince et al., 2017</xref>). MGS measurements of microbial communities are yielding fundamental new insights into the structure and dynamics of microbial ecosystems and the roles of microbes as drivers of host and ecosystem health (<xref ref-type="bibr" rid="bib73">Zeevi et al., 2015</xref>; <xref ref-type="bibr" rid="bib26">Graham et al., 2016</xref>; <xref ref-type="bibr" rid="bib33">Knight et al., 2017</xref>; <xref ref-type="bibr" rid="bib9">Callahan et al., 2017</xref>; <xref ref-type="bibr" rid="bib36">Lehman et al., 2015</xref>). Applications of MGS, often under the alternative terms eDNA sequencing or metabarcoding, increasingly extend beyond microbes to the measurement and monitoring of plants, insects, and vertebrates (<xref ref-type="bibr" rid="bib5">Bell et al., 2019</xref>; <xref ref-type="bibr" rid="bib34">Krehenwinkel et al., 2017</xref>; <xref ref-type="bibr" rid="bib63">Thomas et al., 2016</xref>). MGS methods are now being adopted in fields ranging from food safety (<xref ref-type="bibr" rid="bib10">Cocolin et al., 2018</xref>) to wastewater remediation (<xref ref-type="bibr" rid="bib55">Rosso et al., 2018</xref>) to forensics (<xref ref-type="bibr" rid="bib43">Metcalf et al., 2017</xref>) along with biology and medicine. Unfortunately, however, the community compositions measured by MGS are wrong.</p><p>MGS measurements are <italic>biased</italic>: The measured relative abundances of the taxa and genes in the sample are systematically distorted from their true values (<xref ref-type="bibr" rid="bib8">Brooks, 2016</xref>; <xref ref-type="bibr" rid="bib59">Sinha et al., 2017</xref>). Bias arises because each step in an experimental MGS workflow preferentially measures (i.e. preserves, extracts, amplifies, sequences, or bioinformatically identifies) some taxa over others (<xref ref-type="bibr" rid="bib8">Brooks, 2016</xref>; <xref ref-type="bibr" rid="bib30">Hugerth and Andersson, 2017</xref>; <xref ref-type="bibr" rid="bib50">Pollock et al., 2018</xref>). For example, bacterial species differ in how easily they are lysed and therefore how much DNA they yield during DNA extraction (<xref ref-type="bibr" rid="bib44">Morgan et al., 2010</xref>; <xref ref-type="bibr" rid="bib11">Costea et al., 2017</xref>), and they differ in their number of 16S rRNA gene copies and thus how much PCR product we expect to obtain per cell (<xref ref-type="bibr" rid="bib31">Kembel et al., 2012</xref>). Most sources of bias are protocol-dependent: Different PCR primers preferentially amplify different sets of taxa (<xref ref-type="bibr" rid="bib60">Sipos et al., 2007</xref>), different extraction protocols can produce 10-fold or greater differences in the measured proportion of a taxon from the same sample (<xref ref-type="bibr" rid="bib11">Costea et al., 2017</xref>), and almost every choice in an MGS experiment has been implicated as contributing to bias (<xref ref-type="bibr" rid="bib12">D'Amore et al., 2016</xref>;Â <xref ref-type="bibr" rid="bib30">Hugerth and Andersson, 2017</xref>; <xref ref-type="bibr" rid="bib59">Sinha et al., 2017</xref>; <xref ref-type="bibr" rid="bib50">Pollock et al., 2018</xref>). Every MGS experiment is biased to some degree, and measurements from different protocols are quantitatively incomparable (<xref ref-type="bibr" rid="bib45">Nayfach and Pollard, 2016</xref>; <xref ref-type="bibr" rid="bib28">Hiergeist et al., 2016</xref>; <xref ref-type="bibr" rid="bib39">Mallick et al., 2017</xref>; <xref ref-type="bibr" rid="bib59">Sinha et al., 2017</xref>; <xref ref-type="bibr" rid="bib21">Gibbons et al., 2018</xref>).</p><p>The biases of MGS protocols and the error those biases introduce remain unknown. Thus we do not know whether the measured taxonomic or gene compositions derived from MGS are accurate, or to what extent the biological conclusions derived from them are valid. It is common to assume that conclusions drawn from measurements using the same protocol are robust to MGS bias. But simulated examples have shown that bias can lead to qualitatively incorrect conclusions about which taxa dominate different samples (<xref ref-type="bibr" rid="bib31">Kembel et al., 2012</xref>; <xref ref-type="bibr" rid="bib15">Edgar, 2017</xref>), which ecosystems are more similar (<xref ref-type="bibr" rid="bib31">Kembel et al., 2012</xref>), and which taxa are associated with a given disease (<xref ref-type="bibr" rid="bib8">Brooks, 2016</xref>). Furthermore, variation in bias limits our ability to make the direct comparisons between results from different experiments that are central to the scientific process. It has been suggested that these issues would be circumvented if bias were the same in every experiment, leading to a number of efforts to define and promulgate standardized MGS protocols (<xref ref-type="bibr" rid="bib22">Gilbert et al., 2014</xref>; <xref ref-type="bibr" rid="bib11">Costea et al., 2017</xref>). However, methodological standardization has several limitations. For example, it can be overly restrictive given the variety of ecosystems and biological questions where MGS methods are applied as well as the continual advance in technology, and unmeasured technical variability can introduce experiment-specific biases into nominally standardized methods (<xref ref-type="bibr" rid="bib71">Yeh et al., 2018</xref>). More important, standardized protocols remain biased and thus still do not provide accurate measurements of the underlying communities.</p><p>Current attempts to counter bias are limited and of unknown efficacy because of our poor understanding of how bias across the full experimental workflow distorts MGS measurements. Hundreds of published studies compare MGS measurements of defined samples to their expected composition in an effort to characterize the bias of the given protocol (many cited in <xref ref-type="bibr" rid="bib30">Hugerth and Andersson, 2017</xref>; <xref ref-type="bibr" rid="bib50">Pollock et al., 2018</xref>). But this approach has limited value so long as we do not know how the error observed in one sample translates to differently composed samples. If we understood how bias acts across samples we might be able to estimate the effect of bias from measurements of samples of defined composition and use those estimates to calibrate measurements of samples of interest to their true values (<xref ref-type="bibr" rid="bib63">Thomas et al., 2016</xref>; <xref ref-type="bibr" rid="bib27">Hardwick et al., 2017</xref>). Alternatively, natural communities measured by multiple experiments could be used to calibrate measurements between experiments using different protocols. A quantitative understanding of how bias distorts MGS measurements would also elucidate how statistical analyses and diagnostics are affected by bias and suggest more robust alternatives.</p><p>Here we propose and test a mathematical model of how bias distorts taxonomic compositions measured by MGS from their true values. In our model, bias manifests as a multiplication of the true relative abundances by taxon- and protocol-specific factors that are constant across samples of varying compositions. We validate key components of this model, including that bias acts independently on each taxon in a sample, in 16S rRNA gene and shotgun metagenomic sequencing data from bacterial communities of defined composition. We use our proposed model to quantify bias, to partition bias into steps such as DNA extraction and PCR amplification, and to reason about the effects of bias on downstream statistical analyses. Finally, we demonstrate how this model can be used to correct biased MGS measurements when suitable controls are available.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>A mathematical model of MGS bias</title><p>Consider a marker-gene or metagenomic sequencing (MGS) experiment as a multi-step transformation that takes as input biological material and provides as output the taxonomic profile corresponding to each sampleâthe set of measured taxa and their associated relative abundances (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Each step introduces systematic and random errors that cumulatively lead to error in the measured taxonomic profiles. <italic>Bias</italic> is a particular, ubiquitous form of systematic error that arises from the different efficiencies with which various taxa are measured (i.e. preserved, extracted, amplified, sequenced, or bioinformatically identified and quantified) at each step.</p><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.46923.002</object-id><label>Figure 1.</label><caption><title>Bias arises throughout an MGS workflow, creating systematic error between the observed and actual compositions.</title><p>Panel <bold>A</bold> illustrates a hypothetical marker-gene measurement of an even mixture of three taxa. The observed composition differs from the actual composition due to the bias at each step in the workflow. Panel <bold>B</bold> illustrates our mathematical model of bias, in which bias multiplies across steps to create the bias for the MGS protocol as a whole.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46923-fig1-v1.tif"/></fig><p>Many bias mechanisms are thought to act multiplicatively on the taxon abundances, at least to first approximation. For instance, the DNA concentration of a taxon after DNA extraction equals its initial cell concentration multiplied by its DNA yield per cell. This per-cell yield indicates the efficiency of extraction for the taxon, which is is expected to depend on factors such as genome size and the structure of the taxonâs cell wall (<xref ref-type="bibr" rid="bib44">Morgan et al., 2010</xref>). Therefore, we expect extraction efficiencies to vary among taxa, but be approximately constant for any specific taxon across samples treated with the same protocol. Other multiplicative sources of bias include variation in PCR binding and amplification efficiencies (<xref ref-type="bibr" rid="bib67">Wagner et al., 1994</xref>; <xref ref-type="bibr" rid="bib62">Suzuki and Giovannoni, 1996</xref>; <xref ref-type="bibr" rid="bib51">Polz and Cavanaugh, 1998</xref>; <xref ref-type="bibr" rid="bib15">Edgar, 2017</xref>) and in marker-gene copy number (<xref ref-type="bibr" rid="bib31">Kembel et al., 2012</xref>).</p><p>Inspired by these observations, we propose that at every step in an MGS experiment, the output abundances of individual taxa differ from the input abundances by taxon-specific multiplicative factors (<xref ref-type="fig" rid="fig1">Figure 1</xref>), which we refer to as the <italic>measurement efficiencies</italic> in that step. The measurement efficiencies are determined by the interaction between the experimental protocol and the biological/chemical/physical/informatic state of each taxon in that step, and are therefore independent of the composition of the sample. Typical MGS experiments only measure relative rather than absolute abundances (<xref ref-type="bibr" rid="bib23">Gloor et al., 2017</xref>), and the change in the <italic>relative abundances</italic> during a step depend only on the <italic>relative efficiencies</italic>. This yields the following mathematical model of bias (<xref ref-type="fig" rid="fig1">Figure 1</xref>): The relative abundances measured in an MGS experiment are equal to the input relative abundances multiplied by taxon-specific but composition-independent factors (the relative efficiencies) at every step.</p><p>The mathematical accounting of bias is simplified by the use of <italic>compositional vectors</italic>: vectors for which only the ratios among elements carry meaning. The relative abundances and relative efficiencies can be described as compositional vectors with <inline-formula><mml:math id="inf1"><mml:mi>K</mml:mi></mml:math></inline-formula> non-negative elements, where <inline-formula><mml:math id="inf2"><mml:mi>K</mml:mi></mml:math></inline-formula> is the number of possible taxa. Two vectors <inline-formula><mml:math id="inf3"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf4"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> are <italic>compositionally equivalent</italic>, denoted <inline-formula><mml:math id="inf5"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¼</mml:mo><mml:mi mathvariant="bold">ð</mml:mi></mml:mrow></mml:math></inline-formula>, if <inline-formula><mml:math id="inf6"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold">ð</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> for some positive constant <inline-formula><mml:math id="inf7"><mml:mi>a</mml:mi></mml:math></inline-formula> because the ratios among the elements of <inline-formula><mml:math id="inf8"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf9"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> are the same: <inline-formula><mml:math id="inf10"><mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>â¢</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>Â (<xref ref-type="bibr" rid="bib4">BarcelÃ³-Vidal et al., 2001</xref>). A compositional vector <inline-formula><mml:math id="inf11"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> of relative abundances can be converted to proportions, which we denote <inline-formula><mml:math id="inf12"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>â¡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, by dividing the taxon abundances by their sum, <inline-formula><mml:math id="inf13"><mml:mrow><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>â¡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">â</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, without changing its meaning in terms of the ratios among taxa. For example, the vector of observed proportions in <xref ref-type="fig" rid="fig1">Figure 1</xref> of (4%, 72%, 24%) is compositionally equivalent to the vector (1,Â 18,Â 6) obtained by dividing all abundances by that of the first taxon.</p><p>For a given sample, let <inline-formula><mml:math id="inf14"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> be the vector of actual relative abundances and <inline-formula><mml:math id="inf15"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> be the vector of observed (measured) relative abundances. Subscripts denoteÂ specific taxa; forÂ example <inline-formula><mml:math id="inf16"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the relative abundance of taxon <inline-formula><mml:math id="inf17"><mml:mi>i</mml:mi></mml:math></inline-formula>. Similarly, let <inline-formula><mml:math id="inf18"><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> be the vector of the relative efficiencies of each taxon at step <inline-formula><mml:math id="inf19"><mml:mi>l</mml:mi></mml:math></inline-formula> in Protocol <inline-formula><mml:math id="inf20"><mml:mi>P</mml:mi></mml:math></inline-formula>. (Interactions between steps are allowed; see Appendix 1.) Our model of bias can be stated mathematically as<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¼</mml:mo><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â</mml:mo><mml:mpadded width="+2.8pt"><mml:mi mathvariant="normal">â¯</mml:mi></mml:mpadded><mml:mo>â</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf21"><mml:mo>â</mml:mo></mml:math></inline-formula> denotes element-wise multiplication of two vectors (<xref ref-type="fig" rid="fig1">Figure 1</xref>). We define the bias of Protocol <inline-formula><mml:math id="inf22"><mml:mi>P</mml:mi></mml:math></inline-formula> by the product over all steps, <inline-formula><mml:math id="inf23"><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â¼</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â</mml:mo><mml:mpadded width="+2.8pt"><mml:mi mathvariant="normal">â¯</mml:mi></mml:mpadded><mml:mo>â</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. The observed composition is then simply the actual composition multiplied by the protocolâs bias,<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">O</mml:mi></mml:mrow><mml:mo>â¼</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo>â</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>When considering samples measured by the same protocol, we will drop the superscript <inline-formula><mml:math id="inf24"><mml:mi>P</mml:mi></mml:math></inline-formula> and simply refer to the total protocol bias as <inline-formula><mml:math id="inf25"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula>.</p><p>From <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> we see that the ratio between the observed relative abundances of any two taxa <inline-formula><mml:math id="inf26"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf27"><mml:mi>j</mml:mi></mml:math></inline-formula> is<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>and the observed proportion of taxon <inline-formula><mml:math id="inf28"><mml:mi>i</mml:mi></mml:math></inline-formula> is<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mi>Pr</mml:mi><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">â</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>O</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>Pr</mml:mi><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">â</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mi>Pr</mml:mi><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The denominator, <inline-formula><mml:math id="inf29"><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">â</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mi>Pr</mml:mi><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, is the <italic>sample mean efficiency</italic>âthe average efficiency of the sampled individuals.</p><p>The systematic error in the measured composition under our model is <inline-formula><mml:math id="inf30"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="bold">ð</mml:mi></mml:mrow><mml:mo>â¼</mml:mo><mml:mi mathvariant="bold">ð</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf31"><mml:mo>/</mml:mo></mml:math></inline-formula> denotes element-wise division and is referred to as the compositional difference (<xref ref-type="bibr" rid="bib2">Aitchison, 1992</xref>). The compositional difference unites the experimental notion of biasâvariation in the efficiencies with which different taxa are measuredâwith the statistical notion of biasâthe difference between the expected value of an estimate and the true valueâwith the understanding we are considering the compositional difference rather than the conventional Euclidean difference between compositions.</p><sec id="s2-1-1"><title>Properties and implications of the model</title><sec id="s2-1-1-1"><title>Bias is fully described by the relative efficiencies of the total workflow</title><p>The bias of individual steps only influences the measurement error through their product, <inline-formula><mml:math id="inf32"><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>. Consequently, knowledge of the total protocol bias is sufficient to determine how bias affects the measured taxonomic profiles even if the biases of the individual protocol steps (the <inline-formula><mml:math id="inf33"><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>) remain unknown. The bias <inline-formula><mml:math id="inf34"><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> has just <inline-formula><mml:math id="inf35"><mml:mi>K</mml:mi></mml:math></inline-formula>â1 parameters, denoting the relative efficiencies with which the <inline-formula><mml:math id="inf36"><mml:mi>K</mml:mi></mml:math></inline-formula> taxa of interest are measured by the protocol as a whole, and fully describes the effect of bias on measurements of those <inline-formula><mml:math id="inf37"><mml:mi>K</mml:mi></mml:math></inline-formula> taxa in all samples.</p></sec><sec id="s2-1-1-2"><title>Systematic error in taxon ratios, but not in taxon proportions, is independent of sample composition</title><p>The fold-error in the observed ratios of the abundances of taxon <inline-formula><mml:math id="inf38"><mml:mi>i</mml:mi></mml:math></inline-formula> and taxon <inline-formula><mml:math id="inf39"><mml:mi>j</mml:mi></mml:math></inline-formula> relative to the actual ratio in their abundances is <inline-formula><mml:math id="inf40"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>O</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). This error depends only on the ratio between the total protocol efficiencies of taxon <inline-formula><mml:math id="inf41"><mml:mi>i</mml:mi></mml:math></inline-formula> and taxon <inline-formula><mml:math id="inf42"><mml:mi>j</mml:mi></mml:math></inline-formula> and is independent of the rest of the sample. Critically, this means that the systematic error in taxon ratios caused by bias will remain the same in samples of varying composition.</p><p>In contrast, the error in the proportion of a taxon depends on the sample composition. The fold-error in the observed proportion of taxon <inline-formula><mml:math id="inf43"><mml:mi>i</mml:mi></mml:math></inline-formula> relative to its actual proportion is<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi>Pr</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">O</mml:mi></mml:mrow><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi>Pr</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:munderover><mml:mo>â</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mi>Pr</mml:mi><mml:mo>â¡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This error depends on the sample mean efficiency <inline-formula><mml:math id="inf44"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">â</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mi>Pr</mml:mi><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and thus depends on the proportions of all the other taxa in the sample. Intuitively, bias leads to over-estimation of taxa that are more easily measured than the community average in the given sample. As a result, the same taxon can be over-estimated in samples dominated by low-efficiency taxa and under-estimated in samples dominated by high-efficiency taxa.</p><p>To illustrate, we consider the hypothetical measurement of a second community sample (Sample <inline-formula><mml:math id="inf45"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> in <xref ref-type="fig" rid="fig2">Figure 2</xref>) alongside that of the even sample from <xref ref-type="fig" rid="fig1">Figure 1</xref> (Sample <inline-formula><mml:math id="inf46"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> in <xref ref-type="fig" rid="fig2">Figure 2</xref>). The dominance of the low-efficiency Taxon 1 in Sample <inline-formula><mml:math id="inf47"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> substantially lowers its sample mean efficiency compared to the even-mixture Sample <inline-formula><mml:math id="inf48"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, changing the fold-error in all taxon proportions. In particular, Taxon 3 changes from having a lower-than-average efficiency in Sample <inline-formula><mml:math id="inf49"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> to a higher-than-average efficiency in Sample <inline-formula><mml:math id="inf50"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>. As a result, its observed proportion is lower than its actual proportion in Sample <inline-formula><mml:math id="inf51"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, but higher than its actual proportion in Sample <inline-formula><mml:math id="inf52"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>! Yet the fold-error in the ratios among taxa is identical in both samples and equal to the bias (<xref ref-type="fig" rid="fig2">Figure 2</xref>, bottom row).</p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.46923.003</object-id><label>Figure 2.</label><caption><title>Consistent multiplicative bias causes systematic error in taxon ratios, but not taxon proportions, that is independent of sample composition.</title><p>The even community from <xref ref-type="fig" rid="fig1">Figure 1</xref> and a second community containing the same three taxa in different proportions are measured by a common MGS protocol. Measurements of both samples are subject to the same bias, but the magnitude and direction of error in the taxon proportions depends on the underlying composition (top row). In contrast, when the relative abundances and bias are both viewed as ratios to a fixed taxon (here, Taxon 1), the consistent action of bias across samples is apparent (bottom row).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46923-fig2-v1.tif"/></fig></sec><sec id="s2-1-1-3"><title>Analyses based on fold-changes in taxon ratios are insensitive to bias, while analyses based on taxon proportions can give spurious results</title><p>Although it is widely understood that bias distorts individual community profiles, it is often thought to effectively âcancel outâ when analyzing the differences between samples that have been measured by the same protocol. Unfortunately, simulating measurement under our model easily provides examples where common analyses give qualitatively incorrect results. In <xref ref-type="fig" rid="fig2">Figure 2</xref>, for example, bias causes the uneven Sample <inline-formula><mml:math id="inf53"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> to appear to have a more even distribution of taxa than the perfectly even Sample <inline-formula><mml:math id="inf54"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>. As a result, any analysis of alpha diversity that incorporates evenness (e.g. the Shannon or Inverse Simpson indices) will incorrectly conclude that Sample <inline-formula><mml:math id="inf55"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> is more diverse. The previous section provides a general explanation as to why, for many analyses, bias does not simply cancel: The underlying statistics are functions of the individual taxon proportions, the error of which varies inconsistently across samples. Consequently, proportion-based analyses can lead to qualitatively incorrect conclusions. As a further example, the actual proportion of Taxon 3 decreases from Sample <inline-formula><mml:math id="inf56"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> to Sample <inline-formula><mml:math id="inf57"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> in <xref ref-type="fig" rid="fig2">Figure 2</xref>, but the measured proportion increases!</p><p>In contrast, the fold-error in taxon ratios is independent of sample composition, and fold-changes in taxon ratios across samples are insensitive to bias. Consider the fold-change in the ratio of a pair of taxa <inline-formula><mml:math id="inf58"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf59"><mml:mi>j</mml:mi></mml:math></inline-formula> between two samples <inline-formula><mml:math id="inf60"><mml:mi>s</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf61"><mml:mi>t</mml:mi></mml:math></inline-formula>. Following <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>, the observed change is<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo fence="true" maxsize="2.470em" minsize="2.470em" stretchy="true" symmetric="true">/</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo fence="true" maxsize="2.470em" minsize="2.470em" stretchy="true" symmetric="true">/</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo fence="true" maxsize="2.470em" minsize="2.470em" stretchy="true" symmetric="true">/</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>and thus equals the true change. That is, <italic>the fold-change in taxon ratios between samples is invariant to bias</italic>. More generally, the compositional difference between samples is invariant to multiplication by a fixed vector (<xref ref-type="bibr" rid="bib2">Aitchison, 1992</xref>) and thus to bias,<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="bold">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>â¼</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>â</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>â</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>â¼</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Returning to the samples in <xref ref-type="fig" rid="fig2">Figure 2</xref>, the actual and observed ratios of Taxon 2 to Taxon 1 both change by the same factor of 1/15 from Sample <inline-formula><mml:math id="inf62"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> to Sample <inline-formula><mml:math id="inf63"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, and the actual and observed compositional difference between samples is (1,Â 1/15,Â 4/15). <xref ref-type="disp-formula" rid="equ7">Equation 7</xref> shows that any analysis that depends only on the compositional differences between samples will be invariant to bias under our model.</p></sec><sec id="s2-1-1-4"><title>The systematic difference between measurements from different protocols is given by the difference in their biases</title><p>Consider Protocol <inline-formula><mml:math id="inf64"><mml:mi>P</mml:mi></mml:math></inline-formula> with bias <inline-formula><mml:math id="inf65"><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> and reference Protocol <inline-formula><mml:math id="inf66"><mml:mi>R</mml:mi></mml:math></inline-formula> with bias <inline-formula><mml:math id="inf67"><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>. If both protocols measure the same sample with actual composition <inline-formula><mml:math id="inf68"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula>, the compositional difference between their measurements is<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">O</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="bold">O</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â¼</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo>â</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo>â</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The actual composition drops from the equations and the difference in their measurements is simply the compositional difference in the biases of each protocol, which we refer to as the differential bias <inline-formula><mml:math id="inf69"><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â¡</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> of Protocol <inline-formula><mml:math id="inf70"><mml:mi>P</mml:mi></mml:math></inline-formula> relative to the reference Protocol <inline-formula><mml:math id="inf71"><mml:mi>R</mml:mi></mml:math></inline-formula>. Measurements on common samples are related to one another by <inline-formula><mml:math id="inf72"><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â¼</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, independent of the actual composition of the sample. Usefully, differential bias is mathematically equivalent to bias if we consider the âreferenceâ compositions measured by Protocol <inline-formula><mml:math id="inf73"><mml:mi>R</mml:mi></mml:math></inline-formula> as the truth.</p></sec><sec id="s2-1-1-5"><title>Estimates of bias from control samples can be used to correct measurements of other samples</title><p>The consistency of bias across samples makes it possible to estimate bias from samples of known composition, referred to as <italic>calibration controls</italic>, and to use that estimate <inline-formula><mml:math id="inf74"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> to <italic>calibrate</italic>, or remove the bias from, measurements of other samples with unknown compositions. A point estimate of the bias of <inline-formula><mml:math id="inf75"><mml:mi>K</mml:mi></mml:math></inline-formula> taxa present with known relative abundances in control sample <inline-formula><mml:math id="inf76"><mml:mi>c</mml:mi></mml:math></inline-formula> is given by the compositional difference between the observed and actual compositions, <inline-formula><mml:math id="inf77"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¼</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="bold">ð</mml:mi></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. In Materials and methods, we describe a general method for estimating bias from multiple controls by maximizing the explained compositional error in the control measurements. Measurements from controls containing different taxa can be combined into a single estimate of bias provided that the controls have sufficient taxonomic overlap (Appendix 2).</p><p>Once bias has been estimated for a set of taxa, it can be used to calibrate the relative abundances of those taxa in an unknown sample. Letting <inline-formula><mml:math id="inf78"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> denote the measured relative abundances for these taxa, the estimate <inline-formula><mml:math id="inf79"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> of the actual relative abundances is<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>â¼</mml:mo><mml:mrow><mml:mi mathvariant="bold">O</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>That is, the calibrated abundances are found by compositionally subtracting the estimated bias from the original measurement. Through its use of compositional vectors, <xref ref-type="disp-formula" rid="equ9">Equation 9</xref> automatically accounts for differences in composition between the controls and the target sample. Calibrated estimates of the true taxon proportions are obtained by normalizing the elements of <inline-formula><mml:math id="inf80"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> to sum to 1.</p><p>An alternative form of calibration we call <italic>reference calibration</italic> can be performed using control samples whose true composition is unknown but that have been measured by a reference Protocol <inline-formula><mml:math id="inf81"><mml:mi>R</mml:mi></mml:math></inline-formula>. Estimation and calibration proceed as before but with the control composition <inline-formula><mml:math id="inf82"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> replaced by the reference measurement <inline-formula><mml:math id="inf83"><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In this case, the calibrated composition is an estimate of the measurement we would expect if the target sample had been measured by the reference protocol.</p></sec></sec></sec><sec id="s2-2"><title>Testing the model with mock communities</title><p>We tested our model of bias in data from two studies, <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> and <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref>, that evaluated the bias of marker-gene and shotgun metagenomic sequencing, respectively, using mock microbial communities in samples of varying composition.</p><sec id="s2-2-1"><title>Marker-gene sequencing of even mixtures of various bacterial taxa</title><p><xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> generated taxonomic profiles from 71 samples of 58 unique mock communities by amplicon sequencing ofÂ the V1-V3 region of the 16S rRNA gene. Each unique mock community consisted of an even mixture of between two and seven bacterial taxa. Each sample was measured in three experiments employing a common experimental workflow, but beginning from different starting points: even mixtures of cells, of extracted DNA, and of PCR product. The authors reported large systematic errors in the taxon proportions measured from the cell and DNA mixtures, which they explained in part by a highly parameterized linear model with many interaction terms. Here we re-analyze the data from this study in order to evaluate our model of bias and its performance relative to alternatives.</p><p>The proportions measured from the cell-mixture mock communities differed greatly from the expected even proportions of each taxon (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). The ratios between pairs of taxa also diverged sharply from the ratio of 1 expected in these even mixtures (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). However, and as predicted by our model (see Properties and implications), the error in the ratios was consistent across samples (<xref ref-type="fig" rid="fig3">Figure 3D</xref>) while the error in the proportions varied dramatically in both magnitude and direction (<xref ref-type="fig" rid="fig3">Figure 3C</xref>).</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.46923.004</object-id><label>Figure 3.</label><caption><title>Our model of bias explains the systematic error observed in the <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> cell-mixture experiment.</title><p>The top row compares the observed proportions of individual taxa to the actual proportions (Panel <bold>A</bold>) and to those predicted by our fitted bias model (Panel <bold>B</bold>). Panel <bold>A</bold> shows significant error across all taxa and mixture types that is almost entirely removed once bias is accounted for in Panel <bold>B</bold>. Panel <bold>C</bold> shows the observed error in proportions of individual taxa, while Panel <bold>D</bold> shows the error in the ratios of pairs of taxa for five of the seven taxa. The ratio predicted by the fitted model is given by the black cross in Panel <bold>D</bold>. As predicted by our model, the error in individual proportions (Panel <bold>C</bold>) depends highly on sample composition, while the error in ratios (Panel <bold>D</bold>) does not.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46923-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46923.005</object-id><label>Figure 3âfigure supplement 1.</label><caption><title>The observed error in taxon ratios for all three mixture experiments.</title><p>The observed error in taxon ratios (colored dots) against the fitted model prediction (black cross) for the three mixture experiments of <xref ref-type="bibr" rid="bib7">Brooks et al. (2015)</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46923-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46923.006</object-id><label>Figure 3âfigure supplement 2.</label><caption><title>Observed vs. expected proportions under no bias, copy-number bias only, and the estimated bias.</title><p>Comparison of the observed proportions with three types of expected proportionsâthe actual proportions, the proportions predicted from the estimated 16S copy numbers in <xref ref-type="table" rid="table3">Table 3</xref>, and the proportions predicted by the fitted bias modelâfor the three mixture experiments of <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref>. Proportions <inline-formula><mml:math id="inf84"><mml:mi>p</mml:mi></mml:math></inline-formula> are transformed to log-odds (<inline-formula><mml:math id="inf85"><mml:mrow><mml:mi>ln</mml:mi><mml:mo>â¡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) to avoid compressing errors near <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and average mean squared error (MSE) of the log-odds are shown.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46923-fig3-figsupp2-v1.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46923.007</object-id><label>Figure 3âfigure supplement 3.</label><caption><title>Comparison between the simple linear model, the linear interactions model of <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref>, and our model.</title><p>Comparison of the model fits for the simple linear model, the linear interactions model of <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref>, and our model. The simple linear model has a poor fit, while the <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> model closely fits the data but does so by having more parameters per taxon (63 per taxon) than distinct sample compositions (58). Our model fits nearly as well as the <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> model for the Cells and DNA mixtures, while having vastly fewer parameters (6 versus 441 for all taxa). Proportions <inline-formula><mml:math id="inf88"><mml:mi>p</mml:mi></mml:math></inline-formula> are transformed to log-odds (<inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>ln</mml:mi><mml:mo>â¡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) to avoid compressing errors near <inline-formula><mml:math id="inf90"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The simple linear model with and without an intercept term gives nearly identical results except near zero; here shown without. Only taxa with non-zero actual abundance are plotted, and proportions predicted to be greater than one by the simple linear model are not shown.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46923-fig3-figsupp3-v1.tif"/></fig></fig-group><p>Our model explained almost all of the error in the measured compositions of the cell mixtures. We estimated bias from all samples by a simple point-estimation procedure (Materials andÂ methods; <xref ref-type="table" rid="table1">Table 1</xref>). We then used the estimated bias to predict the observed compositions from the expected even mixtures using <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>. The measured pairwise ratios closely matched the ratios predicted by our modelâthe ratios of the efficiencies of the two taxa (black crosses in <xref ref-type="fig" rid="fig3">Figure 3D</xref>). The proportions predicted from the fitted model reduced the mean squared error by 98.8% and closely matched the observed proportions (<xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.46923.008</object-id><label>Table 1.</label><caption><title>Estimated bias for the three <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> mixture experiments.</title><p>The first three columns show the bias estimated in each mixture experiment; the second three columns show the bias estimated for individual protocol steps from the mixture estimates. In each case, bias is shown as relative to the average taxon; that is, the efficiency of each taxon is divided by the geometric mean efficiency of all seven taxa. The last three rows summarize the multiplicative error in taxon ratios due to bias and noise. Taxa are ordered by decreasing efficiency in the cell mixtures. Abbreviations: PCR prod.: PCR product; Seq.Â +Â Inf.: SequencingÂ +Â Informatics.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th align="left" colspan="3">Mixtures</th><th align="left" colspan="3">Steps</th></tr><tr><th>Taxon</th><th align="right">Cells</th><th align="right">DNA</th><th align="right">PCR prod.</th><th align="right">Extraction</th><th align="right">PCR</th><th align="right">Seq.+Inf.</th></tr></thead><tbody><tr><td><italic>Lactobacillus iners</italic></td><td align="right">4.7</td><td align="right">2.3</td><td align="right">1.2</td><td align="right">2.0</td><td align="right">1.9</td><td align="right">1.2</td></tr><tr><td><italic>Sneathia amnii</italic></td><td align="right">4.6</td><td align="right">2.4</td><td align="right">1.3</td><td align="right">1.9</td><td align="right">1.8</td><td align="right">1.3</td></tr><tr><td><italic>Lactobacillus crispatus</italic></td><td align="right">2.3</td><td align="right">0.5</td><td align="right">0.9</td><td align="right">4.3</td><td align="right">0.6</td><td align="right">0.9</td></tr><tr><td><italic>Prevotella bivia</italic></td><td align="right">1.8</td><td align="right">0.4</td><td align="right">0.9</td><td align="right">4.6</td><td align="right">0.4</td><td align="right">0.9</td></tr><tr><td><italic>Atopobium vaginae</italic></td><td align="right">0.3</td><td align="right">1.1</td><td align="right">1.0</td><td align="right">0.3</td><td align="right">1.0</td><td align="right">1.0</td></tr><tr><td><italic>Streptococcus agalactiae</italic></td><td align="right">0.2</td><td align="right">2.0</td><td align="right">0.9</td><td align="right">0.1</td><td align="right">2.2</td><td align="right">0.9</td></tr><tr><td><italic>Gardnerella vaginalis</italic></td><td align="right">0.2</td><td align="right">0.4</td><td align="right">0.8</td><td align="right">0.4</td><td align="right">0.5</td><td align="right">0.8</td></tr><tr><td/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/></tr><tr><td>Max pairwise bias</td><td align="right">29.3</td><td align="right">6.1</td><td align="right">1.6</td><td align="right">36.6</td><td align="right">5.2</td><td align="right">1.6</td></tr><tr><td>Avg. pairwise bias</td><td align="right">5.6</td><td align="right">2.7</td><td align="right">1.2</td><td align="right">5.5</td><td align="right">2.3</td><td align="right">1.2</td></tr><tr><td>Avg. pairwise noise</td><td align="right">1.2</td><td align="right">1.2</td><td align="right">1.3</td><td align="right">â</td><td align="right">â</td><td align="right">â</td></tr></tbody></table></table-wrap><p>The DNA and PCR-product mixture experiments confirmed that our model can also effectively describe partial MGS workflows. The compositions measured from DNA mixtures were affected by large systematic errors that were well explained by our model, while the systematic error in compositions measured from the PCR mixtures was small compared to the random errors (<xref ref-type="fig" rid="fig3s1">Figure 3âfigure supplement 1</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3âfigure supplement 2</xref>). Notably, the bias in DNA mixtures substantially differed from the bias in the cell mixtures (<xref ref-type="table" rid="table1">Table 1</xref> and <xref ref-type="fig" rid="fig3s1">Figure 3âfigure supplement 1</xref>). This observation suggests that PCR (performed in both experiments) and DNA extraction (performed only in the cell-mixture experiment) are both large, independent sources of bias that each act in accordance with our model.</p><p>Our model better explains the data from the cell and DNA mixtures than proposed alternatives while employing a small number of parameters (6, equal to the number of taxa minus 1). Two recent studies (<xref ref-type="bibr" rid="bib34">Krehenwinkel et al., 2017</xref>; <xref ref-type="bibr" rid="bib5">Bell et al., 2019</xref>) used simple linear regression of the observed proportion of a taxon against its actual proportion, which uses 7 or 14 parameters for all taxa depending on whether intercept terms are included. Such models do not constrain the observed proportions to the [0,Â 1] interval. More critically, they cannot explain that the observed proportion of a given taxon can be higher than or lower than its actual proportion in samples of different composition (e.g. <italic>L. crispatus</italic> in <xref ref-type="fig" rid="fig3">Figure 3C</xref>), while such behavior is a straightforward consequence of our model. <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> attempted to overcome this limitation by adding second and third-order interaction terms between taxa to the linear model. This model obtains a close fit at the cost of vastly increased model complexityâ441 parameters for all taxa instead of just 6. As a result, the interactions model is likely to overfit and poorly predict the measured compositions with different compositions from which it is trained on. <xref ref-type="fig" rid="fig3s3">Figure 3âfigure supplement 3</xref> compares the fit of our model to the simple linear model and the linear interactions model.</p></sec><sec id="s2-2-2"><title>Metagenomic sequencing of fecal samples with a spike-in mock community</title><p>The Phase III experiment of <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> performed shotgun metagenomic sequencing of a cellular mock community spiked into fecal samples. The mock spike-in contained 10 bacterial taxa with known abundance spanning 2.5 orders of magnitude and (unintentionally) an <italic>Escherichia/Shigella</italic> contaminant with unknown true abundance. It was added to fecal specimens from eight individuals as well as a blank âmock-onlyâ sample. DNA was then extracted from each specimen using three distinct DNA extraction protocols (Protocols H, Q, and W) and measured via a common shotgun sequencing protocol. Here we test whether bias among the spike-in taxa is consistent across the varying backgrounds of the nine specimens.</p><p>Taxonomic profiles measured by MetaPhlAn2 (Materials and methods) showed substantial variation in the native bacterial composition across fecal specimens and in the proportion formed by the spike-in, both of which were protocol-dependent (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). In contrast, the observed relative abundances of the spike-in taxa were consistent across specimens for a given protocol (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). This observation is what we expect given that the true spike-in composition is fixed, since our model predicts that the error in the ratios among the spike-in taxa is independent of the presence and abundance of other taxa. <xref ref-type="fig" rid="fig4">Figure 4A</xref> shows abundances relative to the geometric mean of the 10 mock taxa. The average difference between the observed and actual abundance for each taxon estimates the bias of the protocol in terms of the taxonâs efficiency relative to the average taxon (<xref ref-type="fig" rid="fig4s1">Figure 4âfigure supplement 1</xref> and <xref ref-type="table" rid="table2">Table 2</xref>). The bias shows qualitative differences between protocols, with certain mock taxa being enriched by one protocol and diminished by another. Also, the consistent difference in the observed relative abundance of the contaminant indicates a consistent differential bias between Protocol W and the other two protocols of the contaminant relative to the 10 mock taxa. These results indicate a consistent and unique bias associated with each protocol when bias is measured in accordance to our model.</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.46923.009</object-id><label>Figure 4.</label><caption><title>Bias of the mock spike-in in the <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> experiment is consistent across samples with varying background compositions.</title><p>Panel <bold>A</bold> shows the variation in bacterial composition across protocols and specimens (Labels 1 through 8 denote fecal specimens; M denotes the mock-only specimen) and Panel <bold>B</bold> shows the relative abundance of the 10 mock taxa and the spike-in contaminant (dots) against the actual composition (black line). In Panel <bold>A</bold>, color indicates source (mock, contaminant, or native gut taxon) and Family for native bacterial taxa with a proportion of 0.02 in at least one sample. Families are colored by phylum (Red: <italic>Actinobacteria</italic>, Green: <italic>Bacteroidetes</italic>, Blue: <italic>Firmicutes</italic>, Orange: <italic>Verrucomicrobia</italic>). In Panel <bold>B</bold>, abundance is divided by the geometric mean of the mock (non-contaminant) taxa in that sample.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46923-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46923.010</object-id><label>Figure 4âfigure supplement 1.</label><caption><title>Estimated bias for the mock taxa for the three protocols.</title><p>Estimated bias for the 10 mock taxa for the three protocols in the <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> experiment. Bias is shown as relative to the average taxon; that is, the efficiency of each taxon is divided by the geometric mean efficiency of all taxa. The estimated efficiencies are shown as the best estimate (dark dot) multiplied and divided by two geometric standard errors (lines), along with the observations from individual samples (translucent dots).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46923-fig4-figsupp1-v1.tif"/></fig></fig-group><table-wrap id="table2" position="float"><object-id pub-id-type="doi">10.7554/eLife.46923.011</object-id><label>Table 2.</label><caption><title>Estimated bias and differential bias among the spike-in taxa for the three protocols (Protocols H, Q, and W) in the <xref ref-type="bibr" rid="bib11">Costea et al.Â (2017)</xref> experiment.</title><p>The first three columns show the bias of the given protocol for the 10 mock taxa; the second three columns show the differential bias between protocols for the 10 mock taxa and the contaminant. In each case, bias is shown as relative to the average mock (non-contaminant) taxon; that is, the efficiency of each taxon is divided by the geometric mean efficiency of the 10 mock taxa. The last three rows summarize the multiplicative error in taxon ratios due to bias and noise; the contaminant is excluded from these statistics to allow direct comparison between bias and differential bias. Taxa are ordered as in <xref ref-type="fig" rid="fig4">Figure 4B</xref>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th align="left" colspan="3">Protocol</th><th align="left" colspan="3">Protocol/Reference</th></tr><tr><th><bold>Taxon</bold></th><th align="right">H</th><th align="right">Q</th><th align="right">W</th><th align="right">H/Q</th><th align="right">H/W</th><th align="right">Q/W</th></tr></thead><tbody><tr><td><italic>Prevotella melaninogenica</italic></td><td align="right">2.81</td><td align="right">1.55</td><td align="right">1.37</td><td align="right">1.82</td><td align="right">2.05</td><td align="right">1.12</td></tr><tr><td><italic>Clostridium perfringens</italic></td><td align="right">1.18</td><td align="right">0.49</td><td align="right">1.14</td><td align="right">2.41</td><td align="right">1.04</td><td align="right">0.43</td></tr><tr><td><italic>Salmonella enterica</italic></td><td align="right">1.77</td><td align="right">2.29</td><td align="right">0.79</td><td align="right">0.77</td><td align="right">2.25</td><td align="right">2.90</td></tr><tr><td><italic>Clostridium difficile</italic></td><td align="right">0.11</td><td align="right">0.09</td><td align="right">0.22</td><td align="right">1.24</td><td align="right">0.49</td><td align="right">0.40</td></tr><tr><td><italic>Lactobacillus plantarum</italic></td><td align="right">0.02</td><td align="right">0.77</td><td align="right">0.35</td><td align="right">0.02</td><td align="right">0.05</td><td align="right">2.18</td></tr><tr><td><italic>Vibrio cholerae</italic></td><td align="right">2.10</td><td align="right">1.16</td><td align="right">0.89</td><td align="right">1.81</td><td align="right">2.37</td><td align="right">1.31</td></tr><tr><td><italic>Clostridium saccharolyticum</italic></td><td align="right">1.21</td><td align="right">1.44</td><td align="right">0.59</td><td align="right">0.84</td><td align="right">2.05</td><td align="right">2.45</td></tr><tr><td><italic>Yersinia pseudotuberculosis</italic></td><td align="right">1.46</td><td align="right">1.35</td><td align="right">0.66</td><td align="right">1.08</td><td align="right">2.21</td><td align="right">2.05</td></tr><tr><td><italic>Blautia hansenii</italic></td><td align="right">0.54</td><td align="right">0.74</td><td align="right">1.80</td><td align="right">0.72</td><td align="right">0.30</td><td align="right">0.41</td></tr><tr><td><italic>Fusobacterium nucleatum</italic></td><td align="right">46.29</td><td align="right">4.98</td><td align="right">16.51</td><td align="right">9.30</td><td align="right">2.80</td><td align="right">0.30</td></tr><tr><td>Contaminant</td><td align="right">â</td><td align="right">â</td><td align="right">â</td><td align="right">0.89</td><td align="right">2.13</td><td align="right">2.38</td></tr><tr><td/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/></tr><tr><td>Max pairwiseÂ bias</td><td align="right">2751</td><td align="right">56</td><td align="right">74</td><td align="right">428</td><td align="right">59</td><td align="right">10</td></tr><tr><td>Avg. pairwise bias</td><td align="right">9.7</td><td align="right">3.2</td><td align="right">3.5</td><td align="right">4.7</td><td align="right">3.9</td><td align="right">2.8</td></tr><tr><td>Avg. pairwise noise</td><td align="right">1.3</td><td align="right">1.5</td><td align="right">1.1</td><td align="right">1.5</td><td align="right">1.3</td><td align="right">1.5</td></tr></tbody></table></table-wrap></sec></sec><sec id="s2-3"><title>Applications of the model</title><sec id="s2-3-1"><title>Calibration</title><p>Our model implies that a protocolâs bias can be estimated from control sample(s) of known composition and used to calibrate (through <xref ref-type="disp-formula" rid="equ9">Equation 9</xref>) the measured compositions of unknown samples towards their true compositions. In the <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> cell mixtures, we estimated the bias from two samples containing all seven taxa and used this estimate to calibrate the measurements of the other 69 samples. Calibration reduced the mean squared error of the proportions in the calibrated samples by 92.6% and the average Bray-Curtis dissimilarity between the actual and observed compositions from 0.35 to 0.08. In the <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> dataset, the measured composition of the spike-in mock community deviated from the truth in aÂ protocol-specific fashion (<xref ref-type="fig" rid="fig5">Figure 5</xref>, top row). We estimated the bias of each protocol on the mock taxa from three fecal specimens and used those estimates to calibrate all samples (Materials and methods). Calibration removed most of the systematic error and greatly increased the accuracy of the measurements (<xref ref-type="fig" rid="fig5">Figure 5</xref>, middle row).</p><fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.46923.012</object-id><label>Figure 5.</label><caption><title>Calibration can remove bias and make MGS measurements from different protocols quantitatively comparable.</title><p>For the sub-community defined by the mock spike-in of the <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> dataset, we estimated bias from three specimens (the estimation set âEstâ) and used the estimate to calibrate all specimens. The left column shows taxon relative abundances as in <xref ref-type="fig" rid="fig4">Figure 4B</xref> and the right column shows the first two principal components from a compositional principle-components analysis (<xref ref-type="bibr" rid="bib23">Gloor et al., 2017</xref>). The top row shows the measurements before calibration; the middle, after calibration to the actual composition; and the bottom, after calibration to Protocol W.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46923-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46923.013</object-id><label>Figure 5âfigure supplement 1.</label><caption><title>Precision in the bias estimate vs.Â the number of control samples for Protocol H.</title><p>Precision in bias estimate decreases with the number of control samples and depends on the noise associated with each taxon. For Protocol H in the <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> experiment, Panel A shows the geometric standard error in the relative efficiencies of the 10 mock taxa (which jointly form the estimated bias) versus the number of control samples used to estimate the bias. As elsewhere, the efficiency of each taxon is divided by the geometric mean efficiency of all 10 mock taxa. Panel B shows the observed against the actual relative abundances, as in <xref ref-type="fig" rid="fig4">Figure 4</xref>. The two marked samples (from Individual 5 and the mock-only sample M) have unusually high observed abundances of <italic>L. plantarum</italic> and <italic>B. hansenii</italic> and are largely responsible for the much higher standard error seen for these two taxa.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46923-fig5-figsupp1-v1.tif"/></fig></fig-group><p>Random error, or noise, in the measurement process creates error in the estimated bias that propagates into the calibrated measurements. To evaluate the effect of noise on the accuracy of bias estimation, we picked the protocol with an intermediate noise level (Protocol H) and estimated the standard error in the relative efficiencies as a function of the number of control samples (<xref ref-type="fig" rid="fig5s1">Figure 5âfigure supplement 1</xref>). Because noise was much weaker than bias, standard errors were less than the bias even for a single control measurement, suggesting substantial benefits from calibration even with a limited number of control observations. The results further suggest that three or four control measurements for a taxon substantially reduces the risk of inaccurate bias estimates due to occasional large random errors.</p><p>Differential bias between experiments (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref>) can be estimated from samples common to each experiment, even if the actual composition of the common samples is unknown. Differential bias can then be used to calibrate measurements from various experiments to those of a chosen reference protocol, thereby making measured compositions from different experiments quantitatively comparable even if their fidelity to the true compositions remains unclear. We illustrate calibration to a reference protocol using the multi-protocol design of the <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> experiment (<xref ref-type="fig" rid="fig5">Figure 5</xref>). We defined the measurements by Protocol W as the reference composition that was then used in place of the actual composition in our calibration procedure. This greatly reduced the systematic differences between measurements from different protocols, without necessarily improving the accuracy compared to the actual composition (<xref ref-type="fig" rid="fig5">Figure 5</xref>, bottom row).</p></sec><sec id="s2-3-2"><title>Bias measurement as a means of evaluating and improving protocols</title><p>Under our model, the compositional vector of relative efficiencies completely describes the effect of bias in samples of any composition, and thus is the correct way to measure and evaluate bias.</p><p>For the purpose of selecting less-biased protocols, the overall magnitude of bias can be quantified through the use of ratio-based summary statistics. We provide two such statistics for the <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> experiment in <xref ref-type="table" rid="table1">Table 1</xref> and the <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> experiment in <xref ref-type="table" rid="table2">Table 2</xref>. The maximum pairwise bias, equal to the geometric range of the relative efficiencies, indicates the maximum error due to bias in the ratio of any two taxa. The average pairwise bias indicates the magnitude of the multiplicative error averaged over all pairs of taxa. For the three shotgun protocols in <xref ref-type="table" rid="table2">Table 2</xref>, these statistics indicate that Protocol H has a much larger bias than the other two protocols, though one should keep in mind that the large values for Protocol H are heavily influenced by its extremely low efficiency for <italic>L. plantarum</italic> and high efficiency for <italic>F. nucleatum</italic>. Summarizing the residual error in the control samples leads to an analogous average pairwise measure of the noise, or random error, associated with each protocol, which we also include in the tables. The noise measure for the three shotgun protocols indicates that, in this case, the least biased protocol (Protocol Q) also yielded the noisiest measurements of the mock taxa. However, the average noise of the protocols decreases with the propensity of the protocol to sequence the mock over the native gut taxa (<xref ref-type="fig" rid="fig4">Figure 4A</xref>), indicating that the greater noise of Protocol Q may be at least partially an artifact of limited sequencing depth.</p><p>Given suitable experimental designs, the estimated vectors of relative efficiencies can be used to quantify the bias attributable to specific parts of the workflow (Materials and methods and Appendix 1). In the <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> study, the same MGS workflow was run from different starting points: cells, extracted DNA, and PCR product. Comparing the bias resulting from different starting points leads to estimates of the bias attributable to DNA extraction, PCR amplification, and sequencing plus (bio)informatics (<xref ref-type="fig" rid="fig3">Figure 3</xref>; <xref ref-type="fig" rid="fig6">Figure 6A</xref>). For instance, dividing the relative efficiencies measured in the cell mixtures by those in the PCR mixtures provides an estimate of the bias that arises during DNA extraction. These estimates indicate that for these taxa and workflow, DNA extraction is the largest single source of bias, although PCR bias was also substantial. We can alternately understand these estimates through their predicted effect on the composition of an even mixture of taxa as it moves through the experimental workflow (<xref ref-type="fig" rid="fig6">Figure 6B</xref>), which clearly shows how extraction and PCR can oppose each other or work together. PCR and extraction bias acted in opposite directions for some taxa, such as <italic>L. crispatus</italic> and <italic>P. bivia</italic>, and in the same direction for others, such as <italic>G. vaginalis</italic> and for <italic>L. iners</italic>, leading to more moderate or extreme total relative efficiencies, respectively.</p><fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.46923.014</object-id><label>Figure 6.</label><caption><title>In the <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> experiment, bias is primarily driven by DNA extraction and is not substantially reduced by 16S copy-number (CN) correction.</title><p>Panel <bold>A</bold> shows the bias estimate for each step in the experimental workflow (DNA extraction, PCR amplification, and sequencing + (bio)informatics), as well as the bias imposed by performing 16S CN correction (i.e. dividing by the estimated number of 16S copies per genome). Bias is shown as relative to the average taxonâthat is, the efficiency of each taxon is divided by the geometric mean efficiency of all seven taxaâand the estimated efficiencies are shown as the best estimate multiplied and divided by two geometric standard errors. Panel <bold>B</bold> shows the composition through the workflow, starting from an even mixture of all seven taxa, obtained by sequentially multiplying the best estimates in Panel <bold>A</bold>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46923-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46923.015</object-id><label>Figure 6âfigure supplement 1.</label><caption><title>PCR bias and total bias vs.Â bias predicted by 16S copy number.</title><p>In the <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> experiment, variation in 16S copy number is moderately predictive of PCR bias (<bold>A</bold>) but not of total bias (<bold>B</bold>). The grey line corresponds to <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, or perfect agreement between CN and the estimated bias.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46923-fig6-figsupp1-v1.tif"/></fig></fig-group><p>In the <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> study, the same MGS workflow with different DNA extraction protocols was used to measure a common set of samples. This design implies that the differential bias between protocols (<xref ref-type="table" rid="table2">Table 2</xref>) can be attributed specifically to the effect of extraction (including possible effects of extraction on downstream steps; see Appendix 1). The differential bias of Protocol H relative to Protocols Q or W is substantially less than its bias (relative to the actual abundances), as can be seen from the summary statistics in <xref ref-type="table" rid="table2">Table 2</xref> and visually in <xref ref-type="fig" rid="fig4s1">Figure 4âfigure supplement 1</xref>. This observation suggests that components of bias are shared between protocols, either due to similarities among the extraction protocols or bias from shared steps such as library preparation.</p><p>Estimates of bias can be used to test mechanistic hypotheses and proposed methods for predicting bias. To demonstrate this application, we considered the effect of 16S copy number (CN) on bias in the <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> data. We estimated 16S CN per genome and per bp for the seven taxa using available CN and genome size estimates (Materials and methods; <xref ref-type="table" rid="table3">Table 3</xref>). We then compared the bias predicted by CN to the estimated PCR bias and the estimated bias of the total protocol <italic>without</italic> CN correction (<xref ref-type="fig" rid="fig6s1">Figure 6âfigure supplement 1</xref>). 60% of the variance in estimated PCR bias was explained by CN variation (log relative efficiency scale; coefficient of determination <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>â</mml:mo><mml:mn>0.60</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>;Â <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>â</mml:mo><mml:mn>0.021</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> by permutation test). In contrast, total bias was poorly explained by CN variation (coefficient of determination <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>â</mml:mo><mml:mn>0.10</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>;Â <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>â</mml:mo><mml:mn>0.23</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> by permutation test). Accordingly, CN correction reduced the mean squared error in the taxon proportions by about half in the DNA mixtures but only slightly in the cell mixtures (<xref ref-type="fig" rid="fig3s2">Figure 3âfigure supplement 2</xref>). The limited effect of CN correction can also be seen in <xref ref-type="fig" rid="fig6">Figure 6B</xref>. These results indicate that CN variation is just one component of PCR bias, which itself is just one component of total bias, and thus even perfect correction of CN bias may not substantially ameliorate total bias in marker-gene sequencing experiments.</p><table-wrap id="table3" position="float"><object-id pub-id-type="doi">10.7554/eLife.46923.016</object-id><label>Table 3.</label><caption><title>Estimated genome size and 16S copy number for the seven mock taxa in the <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> experiment (MaterialsÂ andÂ methods).</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Taxon</th><th>Genome size (Mbp)</th><th>Copy number</th></tr></thead><tbody><tr><td><italic>Atopobium vaginae</italic></td><td>1.44</td><td>2*</td></tr><tr><td><italic>Gardnerella vaginalis</italic></td><td>1.64</td><td>2</td></tr><tr><td><italic>Lactobacillus crispatus</italic></td><td>2.04</td><td>4</td></tr><tr><td><italic>Lactobacillus iners</italic></td><td>1.28</td><td>5*</td></tr><tr><td><italic>Prevotella bivia</italic></td><td>2.52</td><td>4*</td></tr><tr><td><italic>Sneathia amnii</italic></td><td>1.33</td><td>3*</td></tr><tr><td><italic>Streptococcus agalactiae</italic></td><td>2.16</td><td>7</td></tr></tbody></table><table-wrap-foot><fn><p>*Denotes copy numbers that were instead estimated to be 1 by <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref>.</p></fn></table-wrap-foot></table-wrap></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The lack of a rigorous understanding of how bias distorts marker-gene and metagenomic sequencing (jointly, MGS) measurements stands in the way of accurate and reproducible community-composition measurements. Previous analyses of bias in MGS experiments have largely relied on descriptive statistical models (<xref ref-type="bibr" rid="bib7">Brooks et al., 2015</xref>; <xref ref-type="bibr" rid="bib59">Sinha et al., 2017</xref>; <xref ref-type="bibr" rid="bib34">Krehenwinkel et al., 2017</xref>; <xref ref-type="bibr" rid="bib5">Bell et al., 2019</xref>) whose parameters cannot be identified with biophysical quantities that one might expect to apply to differently composed samples. Failure to develop more mechanistic models may have stemmed from the seeming hopelessness of accounting for the many verified sources of bias. Here we proposed a mathematical model of bias in MGS experiments as a set of taxon-specific factors (the relative efficiencies) that multiply the true relative abundances to produce the measured relative abundances. Our model was inspired by the observation that many sources of bias, such as differences in DNA extraction efficiency (<xref ref-type="bibr" rid="bib44">Morgan et al., 2010</xref>), PCR primer binding and amplification efficiency (<xref ref-type="bibr" rid="bib67">Wagner et al., 1994</xref>; <xref ref-type="bibr" rid="bib62">Suzuki and Giovannoni, 1996</xref>; <xref ref-type="bibr" rid="bib51">Polz and Cavanaugh, 1998</xref>; <xref ref-type="bibr" rid="bib15">Edgar, 2017</xref>), and marker-gene copy number (<xref ref-type="bibr" rid="bib31">Kembel et al., 2012</xref>), are thought to act multiplicatively, and hence so could their cumulative effect. The parameters in our model (the relative efficiencies) have biophysical interpretations as the relative yield per unit of input for each taxon, for individual steps or for the workflow overall. Our hypothesis that the relative efficiencies are consistent across samples is grounded in existing understanding of individual bias mechanisms and was supported by marker-gene and shotgun-metagenomic sequencing measurements of mock bacterial communities with varying composition. We further showed how our model could be used to measure, understand, and correct bias.</p><p>We found bias to be independent of sample composition only after accounting for the compositional nature of MGS measurements. Bias appeared inconsistent when viewed in terms of taxon proportionsâfor example the measured proportion of <italic>L. crispatus</italic> was both higher and lower than its true value in different samples (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). However, these apparent inconsistencies did not reflect inconsistency in the action of bias, but instead were a consequence of the compositional nature of MGS data. A limited number of sequencing reads are generated from each sample, so if one taxon is enriched by bias then other taxa must be correspondingly diminished. Therefore, a taxon's proportional over- or under-representation depends not on its absolute measurement efficiency but on its efficiency relative to the average individual (e.g. microbial cell) in the sampleâ<italic>L. crispatus</italic> increased in proportion when its efficiency was greater than the sample average, and decreased otherwise. Models that do not account for this effect (such as those of <xref ref-type="bibr" rid="bib7">Brooks et al., 2015</xref>; <xref ref-type="bibr" rid="bib34">Krehenwinkel et al., 2017</xref>; <xref ref-type="bibr" rid="bib5">Bell et al., 2019</xref>; <xref ref-type="bibr" rid="bib32">Kevorkian et al., 2018</xref>) will yield parameter estimates that do not extrapolate to differently-composed samples. Once we accounted for compositionality it became clear that relative efficiencies were consistent across differently composed samples. Bias had the same effect in each sample when we divided out the effect of compositionality by considering ratios of taxa (<xref ref-type="fig" rid="fig3">Figure 3D</xref>), and when we fully modeled the normalization involved in constructing proportions we found that a single set of relative efficiencies explained the observed proportions in every sample (<xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p><p>A quantitative model allows the sensitivity of downstream analyses to bias to be rigorously evaluated. Consider the often unstated assumption that analyses of the differences between samples measured in the same experiment should be robust to bias, because each sample is biased in the same way. We can formally evaluate this assumption in the simple numerical example shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>: Sample <inline-formula><mml:math id="inf97"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> has higher Shannon diversity than Sample <inline-formula><mml:math id="inf98"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> but the measured diversity of Sample <inline-formula><mml:math id="inf99"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> is lower than Sample <inline-formula><mml:math id="inf100"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, and Sample <inline-formula><mml:math id="inf101"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> has a higher proportion of Taxon 3 than Sample <inline-formula><mml:math id="inf102"><mml:msub><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> but is observed to have a lower proportion of Taxon 3, despite the same bias distorting each sample. Whether such qualitative errors are likely can be investigated by simulating our model with empirical distributions of bias and community compositions. For example, consider the <italic>Bacteroidetes:Firmicutes</italic> ratio, a repeatedly-proposed diagnostic of gut health (<xref ref-type="bibr" rid="bib37">Ley et al., 2006</xref>; <xref ref-type="bibr" rid="bib20">Finucane et al., 2014</xref>). The range of relative efficiencies within the <italic>Firmicutes</italic> indicates that the <italic>Bacteroidetes:Firmicutes</italic> ratio measured by the metagenomic sequencing protocols evaluated in <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> can differ from the true ratio by very little, or by as much as 100-fold, depending on which Firmicutes species is dominant in the sample!</p><p>If bias acts (as we propose) as a consistent multiplication of the relative abundances, then analyses of MGS data based on taxon ratios could reduce the possibility for spurious results and make results from different experiments more comparable. The key insight is that the fold changes between samples in the ratios between taxa is invariant to consistent multiplicative bias, because the relative efficiencies divide out (<xref ref-type="disp-formula" rid="equ6">Equation 6</xref> and <xref ref-type="disp-formula" rid="equ7">Equation 7</xref>). In contrast, such canceling does not occur for the fold-changes in taxon proportions, as exemplified by the spurious observed increase of Taxon 2 in <xref ref-type="fig" rid="fig2">Figure 2</xref>. To be clear, this bias-invariance property for ratio-based analyses only holds for samples biased in the same way, so these analyses still must be conducted within experiments sharing a common MGS protocol. But by controlling for study-specific bias, these analyses may give results that are more concordant across studies than other analyses. One ready source of such methods is the field of Compositional Data Analysis (CoDA) (<xref ref-type="bibr" rid="bib1">Aitchison, 1986</xref>; <xref ref-type="bibr" rid="bib23">Gloor et al., 2017</xref>). In fact, our model of bias is equivalent to what is referred to as a compositional perturbation in the CoDA field; many CoDA methods are invariant to compositional perturbations (<xref ref-type="bibr" rid="bib3">Aitchison, 2003</xref>; <xref ref-type="bibr" rid="bib66">van den Boogaart and Tolosana-Delgado, 2013</xref>) and thus would be invariant to bias. CoDA methods are being increasingly used to analyze MGS data, but to date this has been motivated by the need to account for the compositionality of MGS data. The possibility that such methods could also reduce or remove the effect of bias has not been widely appreciated.</p><p>Studies investigating bias and/or optimizing protocols should evaluate the systematic errors introduced by bias in a way that accounts for the compositional nature of MGS data. Most previous studies of bias quantified bias with taxon proportions (e.g.Â <xref ref-type="bibr" rid="bib7">Brooks et al., 2015</xref>; <xref ref-type="bibr" rid="bib34">Krehenwinkel et al., 2017</xref>; <xref ref-type="bibr" rid="bib5">Bell et al., 2019</xref>) or proportion-based summary statistics such as Bray-Curtis dissimilarities (<xref ref-type="bibr" rid="bib59">Sinha et al., 2017</xref>) or differences in Shannon diversity (<xref ref-type="bibr" rid="bib61">Song et al., 2016</xref>). Proportion-based measurements do not consistently measure bias in differently composed samples, and thus are difficult to interpret and can mislead researchers attempting to reduce the effect of bias on their experiments. The adoption of compositionally aware analytical methods to study bias may lead to insights that generalize beyond the specific sample compositions considered in these studies. In particular, quantification of bias in the form of the âbias vectorâ of relative efficiencies we proposed here has a natural biological interpretation as the relative yields of each taxon and can be naturally decomposed into an element-wise product of bias vectors for each step in a workflow, allowing for granular investigation of MGS protocol choices.</p><p>Our results suggest that calibration could become a practical approach to improving the accuracy of MGS analyses and diagnostics. If bias is composition independent, then it can be estimated from one or more control samples and those estimates used to correct the relative abundances in target samples. Our results overcomes major limitations in recent attempts at MGS calibration (<xref ref-type="bibr" rid="bib7">Brooks et al., 2015</xref>; <xref ref-type="bibr" rid="bib63">Thomas et al., 2016</xref>; <xref ref-type="bibr" rid="bib34">Krehenwinkel et al., 2017</xref>; <xref ref-type="bibr" rid="bib5">Bell et al., 2019</xref>) by indicating how to obtain a compositionally independent estimate of bias for many taxa from a small number of control samples. Intriguingly, we show that the differential bias between protocols behaves in the same manner as the bias of an individual protocol. This property opens the possibility of calibration based on a reference protocol's measurements of control samples even if their true composition is not known. Reference calibration does not give the abundances in terms of biologically tangible units like cell concentration, but can make measurements from differently biased experiments quantitatively comparable, allowing diagnostic criteria to be applied outside of the lab in which they were defined. Reference calibration may sidestep the practical challenges of creating defined cellular mixtures of many taxa by using natural samples (or aggregations of natural samples) as calibration controls that would then contain the full range of taxa naturally present.</p><sec id="s3-1"><title>Limitations and next steps</title><p>We found bias to act multiplicatively in accordance with our model in two mock-community experiments; however, many sources of bias may deviate from multiplicativity under non-ideal conditions. For example, it has been observed that the efficiency of a target sequence is altered by saturation during PCR amplification when the target is either rare or highly abundant (<xref ref-type="bibr" rid="bib62">Suzuki and Giovannoni, 1996</xref>; <xref ref-type="bibr" rid="bib25">Gonzalez et al., 2012</xref>). In a non-microbial marker-gene experiment, <xref ref-type="bibr" rid="bib63">Thomas et al. (2016)</xref> found a strong and consistent saturation effect that may have been caused by such a mechanism. The opposite of saturation, where taxa have lower efficiencies when rarer in the sample, may occur if low-abundance taxa are culled by the minimum-abundance thresholds used by taxonomic profilers such as MetaPhlAn2 (<xref ref-type="bibr" rid="bib64">Truong et al., 2015</xref>). Such deviations from multiplicativity may be eliminated through protocol design (e.g. to avoid PCR saturation; <xref ref-type="bibr" rid="bib51">Polz and Cavanaugh, 1998</xref>) or accounted for with extensions allowing for deterministic and random variation in efficiencies.</p><p>Even when bias does act multiplicatively on individual microbial taxa, that multiplicativity will not hold for aggregates of taxa that vary in their efficiencies (Appendix 1). Consider again the <italic>Bacteroidetes:Firmicutes</italic> ratio diagnostic. We know that within the <italic>Firmicutes</italic> phylum there is tremendous phenotypic variation, and that variation manifested itself in the <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> study as order-of-magnitude differences between the relative efficiencies of various <italic>Firmicutes</italic> species. As a result, consistent multiplicative bias could dramatically enrich or diminish the relative abundance of the <italic>Firmicutes</italic> phylum depending on which <italic>Firmicutes</italic> species were present. Unfortunately, the potential for bias to act inconsistently on aggregates of taxa cannot be entirely circumvented by eschewing aggregation in our analyses because even the fundamental units we derive from MGS data effectively aggregate variation at some level (<xref ref-type="bibr" rid="bib42">McLaren and Callahan, 2018</xref>). In the bacterial context, the traditional 97% ribosomal OTU groups variation at roughly the genus level (<xref ref-type="bibr" rid="bib70">Yarza et al., 2014</xref>), exact short-read ribosomal sequence variants and common shotgun profilers group variation at roughly the species level (<xref ref-type="bibr" rid="bib16">Edgar, 2018</xref>; <xref ref-type="bibr" rid="bib29">Hillmann et al., 2018</xref>), and metagenome assembly combines strains too similar to be separated by the assembler or by the subsequent binning (<xref ref-type="bibr" rid="bib14">Dick, 2018</xref>, p. 79). This does not make bias an intractable problem, but it does mean that additional work is needed to understand the phylogenetic scales over which bias significantly varies. Methods to control bias will need to operate on taxonomic objects with commensurate or finer resolution than that of variation in the bias phenotype (<xref ref-type="bibr" rid="bib42">McLaren and Callahan, 2018</xref>).</p><p>Cellular phenotype and matrix chemistry can vary substantially between samples of different types, which may cause bias to vary among samples. For example, different cellular growth states may change the cellular membrane and thus the efficiency of DNA extraction for a given taxon, and inhibitors in soil samples are known to influence the efficiency of PCR (<xref ref-type="bibr" rid="bib57">Schrader et al., 2012</xref>). In the <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> experiment, protocols differentially extracted the mock and native gut taxa (<xref ref-type="fig" rid="fig4">Figure 4A</xref>), which may have been due to physiological differences between the lab-grown cells and the preserved fecal cells. Potential phenotype and matrix effects are particularly relevant for calibration applications, as accurate calibration will require that bias measured in the controls is representative of the bias in the target samples.</p><p>The development of effective calibration methodologies will be limited by our ability to develop control samples that cover the range of taxa present in target communities. The bias estimation procedure we developed here is limited to those taxa present in the controls, and thus only allows for partial calibration of the subcomposition of the target samples consisting of those taxa. However, even partial calibration is useful when controls with key taxa in the target community are available. For example, vaginal microbiome samples from a patient over several clinical visits analyzed by <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> were mostly comprised of the seven taxa in their mock mixtures. It may be possible to effectively augment the range of taxa with credible bias estimates beyond those included in control samples by using phylogenetic inference methods to predict the bias of related taxa (<xref ref-type="bibr" rid="bib24">Goberna and VerdÃº, 2016</xref>). It will be easier to broadly cover the taxa in a given environment when calibrating to a reference protocol, because any sample measured by the reference protocol can be used as a reference calibration control, including samples from the environment of interest.</p><p>Our discussion has so far ignored another ubiquitous source of error in MGS experimentsâcontamination, either from the lab, reagents, or other samples (<xref ref-type="bibr" rid="bib18">Eisenhofer et al., 2019</xref>). Contamination may be more important than bias in certain scenarios, such as the study of low biomass samples or analyses that are sensitive to very low frequency taxa, and bias correction may be insufficient for accurate measurement and inference in such settings. Accurate bias inference also requires accurate removal of contaminant reads prior to estimation through manual filtering or automated removal methods (<xref ref-type="bibr" rid="bib13">Davis et al., 2018</xref>; <xref ref-type="bibr" rid="bib35">Larsson et al., 2018</xref>). Incorporation of our bias model with models of contamination may allow for simultaneous and improved estimation and correction of both error processes.</p><p>The model of bias we explored in this paper treats bias and measurement error more generally as deterministic. In practice, however, there is variability in the error of taxon ratios around the mean (<xref ref-type="fig" rid="fig3">Figure 3D</xref>; <xref ref-type="fig" rid="fig4s1">Figure 4âfigure supplement 1</xref>). We developed a point-estimation method with a bootstrapping procedure to estimate the bias with associated uncertainty from random observations (Materials and methods). However, robust estimation and calibration may require a statistical model of bias that explicitly accounts for sources of random error such as variation in relative efficiencies across samples and limited sequencing depth. A statistical model would facilitate the construction of confidence intervals for the calibrated taxon proportions in a sample. Challenges associated with building such a model include modeling the presence of taxa thought to be absent from the community (but observed due to contamination or index switching; <xref ref-type="bibr" rid="bib18">Eisenhofer et al., 2019</xref>), the absence of taxa known to be present (<xref ref-type="bibr" rid="bib71">Yeh et al., 2018</xref>), and accounting for the noise associated with the count nature of sequencing data. Our finding that multiplicative error in taxon ratios provides a parsimonious model for bias paves the way for the development of a such a statistical model, which we leave for future work.</p></sec><sec id="s3-2"><title>Conclusion</title><p>We suggest a simple yet profound change in how researchers view MGS measurements. Currently, researchers tend to either 1) take MGS measurements as telling us only about presence and absence of detectable taxa, 2) hope that bias in the measurements of individual samples will somehow cancel out when analyzing differences between samples within a given experiment, or 3) pretend bias doesnât exist. We propose a new view in which the measured relative abundances within an experiment are biased by unknownâbut constantâmultiplicative factors. When bias acts consistently in this manner it can be accounted for through the use of bias-insensitive analyses or corrected by a calibration procedure. Our results lay a foundation for the rigorous understanding of bias in marker-gene and metagenomic sequencing measurements that is required for accurate and reproducible research using MGS methods and for the development of reliable MGS diagnostics and interventions.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Bias estimation</title><p>We describe a procedure for averaging multiple control observations to obtain a single estimate of the protocolâs bias; additional details and motivation are given in Appendix 2. For sample <inline-formula><mml:math id="inf103"><mml:mi>s</mml:mi></mml:math></inline-formula> in a set of control samples <inline-formula><mml:math id="inf104"><mml:mi>S</mml:mi></mml:math></inline-formula>, let <inline-formula><mml:math id="inf105"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denote the actual composition and <inline-formula><mml:math id="inf106"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> be the observed composition. We assume that <inline-formula><mml:math id="inf107"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are non-zero for the same taxa; in practice, this assumption requires ignoring sequencing reads from taxa not supposed to be in the sample and adding a small abundance to taxa actually present but not detected. Under our deterministic model, the observed composition is given exactly by <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>. In practice, however, each measurement will varyâfor example, due to random error in sample construction, variation in sample handling, and random sampling of reads during sequencing. We decompose the error <inline-formula><mml:math id="inf109"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="bold">ð</mml:mi></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> into a deterministic component <inline-formula><mml:math id="inf110"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> and a random component <inline-formula><mml:math id="inf111"><mml:mrow><mml:mi>Ïµ</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>,<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>â¼</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>â</mml:mo><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â</mml:mo><mml:mi>Ïµ</mml:mi></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The random error <inline-formula><mml:math id="inf112"><mml:mrow><mml:mi>Ïµ</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a random compositional vector that we assume has an expected value of <inline-formula><mml:math id="inf113"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in the compositional Aitchison geometry (given by the element-wise geometric mean; <xref ref-type="bibr" rid="bib3">Aitchison, 2003</xref>, p. 38). Intuitively, we estimate <inline-formula><mml:math id="inf114"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> by the vector <inline-formula><mml:math id="inf115"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> that minimizes the residual errors, <inline-formula><mml:math id="inf116"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>Ïµ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>â¼</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>â</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>We quantify the magnitude of errors by the <italic>Aitchison norm</italic>. The Aitchison norm (<xref ref-type="bibr" rid="bib48">Pawlowsky-Glahn, 2015</xref>; <xref ref-type="bibr" rid="bib3">Aitchison, 2003</xref>, Chapter 2) of a <inline-formula><mml:math id="inf117"><mml:mi>K</mml:mi></mml:math></inline-formula>-element composition <inline-formula><mml:math id="inf118"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> is given by<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo symmetric="true">â</mml:mo><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo symmetric="true">â</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:munder><mml:mo>â</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>â¡</mml:mo><mml:mfrac><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo>=</mml:mo><mml:msqrt><mml:munderover><mml:mo>â</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>â¡</mml:mo><mml:mfrac><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf119"><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">â</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the geometric mean of the elements of <inline-formula><mml:math id="inf120"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula>. When estimating the bias from a sample <inline-formula><mml:math id="inf121"><mml:mi>s</mml:mi></mml:math></inline-formula> that is missing some of the taxa, the elements of <inline-formula><mml:math id="inf122"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="bold">ð</mml:mi></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and of the residual error <inline-formula><mml:math id="inf123"><mml:mrow><mml:mover accent="true"><mml:mi>Ïµ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> corresponding to the missing taxa are undefined. We define <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo symmetric="true">â</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>Ïµ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo symmetric="true">â</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> in this case by restricting to just the defined elements (and adjusting <inline-formula><mml:math id="inf125"><mml:mi>K</mml:mi></mml:math></inline-formula> accordingly) before applying <xref ref-type="disp-formula" rid="equ11">Equation 11</xref>.</p><p>We take our estimate of <inline-formula><mml:math id="inf126"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> to be the compositional vector that minimises the sum of squared residual error over all samples,<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>â¼</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mo>â¡</mml:mo><mml:munder><mml:mo>â</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>â</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo symmetric="true">â</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>â</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo symmetric="true">â</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This definition equates <inline-formula><mml:math id="inf127"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> with the compositional mean, or <italic>center</italic>, of the compositional errors <inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> when the center is defined to allow missing values (Appendix 2). If all samples contain all <inline-formula><mml:math id="inf129"><mml:mi>K</mml:mi></mml:math></inline-formula> taxa, then <inline-formula><mml:math id="inf130"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is given by the element-wise geometric mean of theÂ setÂ <inline-formula><mml:math id="inf131"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="bold">ð</mml:mi></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>,<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>â¼</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>â</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>â</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>â¦</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>â</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>â</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the number of samples in the set <inline-formula><mml:math id="inf133"><mml:mi>S</mml:mi></mml:math></inline-formula>. More generally, the solution to <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> can be computed using the projection approach of <xref ref-type="bibr" rid="bib65">van den Boogaart et al. (2006)</xref>. The solution is unique up to compositional equivalence given sufficient taxonomic overlap among the samples (Appendix 2).</p><p>Differential bias of the given protocol to a reference Protocol <inline-formula><mml:math id="inf135"><mml:mi>R</mml:mi></mml:math></inline-formula> that has also measured the samples in <inline-formula><mml:math id="inf136"><mml:mi>S</mml:mi></mml:math></inline-formula> can be estimated without knowing the actual sample compositions by replacing the actual compositions <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>A</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in the above with the reference measurements <inline-formula><mml:math id="inf138"><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>We describe a bootstrap procedure for estimating the uncertainty of the bias estimate in Appendix 2. Each bootstrap replicate consists of drawing either multinomial or Dirichlet weights for the control samples and computing the weighted center to obtain the replicate value of <inline-formula><mml:math id="inf139"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. Standard errors for the relative efficiencies are estimated by the geometric standard deviation of the corresponding efficiency ratio across replicates.</p></sec><sec id="s4-2"><title>Bioinformatics and statistical analysis</title><sec id="s4-2-1"><title>Data and code availability</title><p>Functions and a tutorial for estimating and visualizing bias and performing calibration are provided in the âmetacalâ R package, available on GitHub (<xref ref-type="bibr" rid="bib40">McLaren, 2019a</xref>, copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/metacal">https://github.com/elifesciences-publications/metacal</ext-link>). The raw data for our analysis is available in the âAdditional filesâ of <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> and in European Nucleotide Archive studyÂ accession <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ena/data/view/PRJEB14847">PRJEB14847</ext-link> for <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref>. The processed dataâalong with all code used to download and process the raw data, perform all statistical analyses, and generate all figures and tablesâis contained in the manuscriptâs GitHub repository (<xref ref-type="bibr" rid="bib41">McLaren, 2019b</xref>, copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/mgs-bias-manuscript">https://github.com/elifesciences-publications/mgs-bias-manuscript</ext-link>). Analysis and visualization is performed using the R software environment (<xref ref-type="bibr" rid="bib53">R Development Core Team, 2018</xref>) with the âmetacalâ package, the âtidyverseâ suite of R packages (<xref ref-type="bibr" rid="bib68">Wickham, 2019</xref>), and the âcowplotâ R package (<xref ref-type="bibr" rid="bib69">Wilke, 2019</xref>). Analysis code is contained in R-markdown documents that can be executed to generate all numerical results, tables, and figures. Versions that have been âknitâ into html documents showing code interlaced with output and figures are available in the GitHub repository.</p></sec><sec id="s4-2-2"><title><xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> experiment</title><p>We used taxonomic profiles generated in the original study and provided as supplemental information. Specifically, we used the sample information and read assignments in Additional Files 2, 10, and 11 ofÂ <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref>Â to build a table of amplicon sequences assigned to each of the seven mock taxa in each sample. <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> used a classification method and 16S reference database designed for species-level classification of vaginally associated taxa from V1-V3 region amplicons (<xref ref-type="bibr" rid="bib19">Fettweis et al., 2012</xref>). Reads were assigned to species in the database according to a 97% sequence identity threshold, resulting in 93.5% of reads assigned and for which the vast majority (99.98%) were assigned to species corresponding to the seven mock taxa. We discarded the small fraction (0.0002%) of reads assigned to other species. Most samples were assigned a small fraction of their reads from species not expected to be in the sample. These out-of-sample species generally had much lower frequency than the expected species, suggesting they were the result of cross-sample contamination rather than mislabeling or misconstruction of the samples. We therefore removed these reads before evaluating and estimating bias.</p><p>We took the actual composition of each sample to be an even mixture of the taxa added to that sample, in units of cell concentration, DNA concentration, or PCR-product concentration. <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> constructed the cell mixtures to be even mixtures based on CFUs (a proxy for cell concentration); the DNA mixtures based on DNA concentration; and the PCR mixtures based on volume from amplification of a fixed weight of DNA. Extraction and PCR protocols differed somewhat when using pure cultures to create the DNA and PCR-product mixtures than when applied to communities in the cell experiment. Thus, the DNA and PCR product in the second and third experiments may differ qualitatively from that in the cell mixture experiments, which could in principle affect the bias of downstream steps.</p><p>We estimated genome size and 16S copy number for the seven mock taxa from available genome databases and experimental measurements. We estimated genome size by the average genome size for the given species in NCBI RefSeq release 86 as collated by the GTDB (<xref ref-type="bibr" rid="bib47">Parks et al., 2018</xref>). We estimated 16S copy number (CN) through a combination of RefSeq annotations for the given species; CN estimates in the rrnDB for the given species or their nearby relatives identified in the GTDB phylogeny (<xref ref-type="bibr" rid="bib47">Parks et al., 2018</xref>); and measurement by pulse-field gel electrophoresis reported by <xref ref-type="bibr" rid="bib72">Yuan et al. (2012)</xref> for <italic>A. vaginae</italic> and <italic>L. iners</italic>. A full account is given in the manuscript GitHub repository. The resulting genome size estimates approximately agree with those of <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref>, but the 16SÂ CN estimates differ substantially for several taxa (compare our <xref ref-type="table" rid="table3">Table 3</xref> to their Table 5). In particular, <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> estimated four taxa to have CNs of 1 based on NCBI annotations then available, but we suspect these numbers to be artifacts of poor assembly and annotation.</p><p>We estimated the bias predicted due to CN variation for each mixture type as follows. Cell mixtures: CN bias is simply the compositional vector of CNs (16S copies per genome). DNA mixtures: CN bias is the compositional vector of CN divided by genome size (16S copies per bp). PCR-product mixtures: CN bias is the compositional identity vector (1,...,Â 1) (i.e. no bias). Denoting the estimated CN bias as <inline-formula><mml:math id="inf140"><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>CN</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> for the given experiment, the CN-corrected proportions are <inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>â¡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>/</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>CN</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>For each mixture experiment, we estimated bias as described aboveÂ inÂ âBias estimationâ. We then used these estimates to partition our estimate of the total protocol bias into three stepsâ1) DNA extraction, 2) PCR amplification, and 3) sequencing and bioinformaticsâunder the simplifying assumption that the bias of shared steps are the same across experiments. We assume the bias of the cell mixture experiments is <inline-formula><mml:math id="inf142"><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mtext>(Cells)</mml:mtext></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, of the DNA mixtures is <inline-formula><mml:math id="inf143"><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mtext>(DNA)</mml:mtext></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and of the PCR-product mixtures is <inline-formula><mml:math id="inf144"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>PCR\ product</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. We therefore estimate the extraction bias as <inline-formula><mml:math id="inf145"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>(Cells)</mml:mtext></mml:msup><mml:mo>/</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>(DNA)</mml:mtext></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, the PCR bias as <inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>PCR\ product</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>DNA</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, and the sequencing and bioinformatics bias as <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>PCR\ product</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-2-3"><title><xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> Phase III experiment</title><p>We downloaded raw sequencing reads for the Phase III experiment from European Nucleotide Archive study accession <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ena/data/view/PRJEB14847">PRJEB14847</ext-link>Â and generated taxonomic profiles using MetaPhlAn2 version 2.7.6 (<xref ref-type="bibr" rid="bib64">Truong et al., 2015</xref>) with the command-line options <monospace>--min_cu_len 0 --stat avg_g</monospace>. These options were chosen to increase sensitivity and accuracy for the rarest spike-in taxa and resulted in the detection of all spike-in taxa in every sample. Taxonomic profiles generated by MetaPhlAn2 provide estimated proportions of taxa at various taxonomic levels. We restricted our analysis to species-level abundances and the kingdom Bacteria, which constituted over 99% of non-viral abundance in each sample.</p><p><xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> reported <italic>Escherichia coli</italic> as a likely spike-in contaminant due to its presence in sequence data from the mock-only samples. Consistent with this report, the MetaPhlAn2 profiles showed a substantial presence of <italic>Shigella flexneri</italic> in the mock-only samples and we identified this species as the âContaminantâ in our subsequent analyses and in all figures and tables.</p><p>We estimated the true mock-community composition using the flow cytometry (FACS) measurements reported in <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref>. We used the arithmetic mean of two replicate measurements where available and ignored any measurement error in the resulting actual mock composition for our analysis. The FACS measurements provided by <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> disagree with those shown in their Figure 6 for three taxa (<italic>V. cholerae</italic>, <italic>C. saccharolyticum</italic>, and <italic>Y. pseudotuberculosis</italic>). Analysis of our MetaPhlAn2 profiles indicates that these taxa are most likely mislabeled in the figure and not in the FACS measurements. A mislabeling in the FACS measurements would change the specific bias values we estimate for these taxa but not our main results or conclusions.</p><p>We estimated the bias of each protocol and the differential bias between protocols as described in âBias estimationâ. We estimated standard errors using the Dirichlet-weighted bootstrap method described in Appendix 2. To determine how precision in the bias estimate for Protocol H varies with the number of control samples (<xref ref-type="fig" rid="fig4s1">Figure 4âfigure supplement 1</xref>), we computed standard errors using the multinomial-weighted bootstrap method with the number of trials in the multinomial distribution equal to the specified number of control samples (Appendix 2).</p><p>To demonstrate calibration, we randomly chose three fecal specimens to use as the âestimation setâ to estimate bias, and then calibrated all samples using <xref ref-type="disp-formula" rid="equ9">Equation 9</xref>. We excluded the mock-only specimen from the estimation set since its atypical values for a few taxa resulted in an unrepresentative picture of the success of calibration; however, we included it when evaluating the effect of noise on bias estimation in <xref ref-type="fig" rid="fig4s1">Figure 4âfigure supplement 1</xref>.</p></sec></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Glen Satten and David Clausen for valuable discussions.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Data curation, Formal analysis, Validation, Investigation, Visualization, Methodology, Writingâoriginal draft, Writingâreview and editing</p></fn><fn fn-type="con" id="con2"><p>Methodology, Writingâoriginal draft, Writingâreview and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Supervision, Funding acquisition, Investigation, Methodology, Writingâoriginal draft, Writingâreview and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.46923.017</object-id><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-46923-transrepform-v1.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data analysed in this study are publicly available through the 'Additional files' of <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2180/15/66">http://www.biomedcentral.com/1471-2180/15/66</ext-link> (data derived from NCBI BioProject PRJNA267701) and through ENA Study PRJEB14847.</p><p>The following previously published datasets were used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Brooks</surname><given-names>JP</given-names></name><name><surname>Edwards</surname><given-names>DJ</given-names></name><name><surname>Harwich</surname><given-names>MD</given-names></name><name><surname>Rivera</surname><given-names>MC</given-names></name><name><surname>Fettweis</surname><given-names>JM</given-names></name><name><surname>Serrano</surname><given-names>MG</given-names></name><name><surname>Reris</surname><given-names>RA</given-names></name><name><surname>Sheth</surname><given-names>NU</given-names></name><name><surname>Huang</surname><given-names>B</given-names></name><name><surname>Girerd</surname><given-names>P</given-names></name><name><surname>Strauss</surname><given-names>JF</given-names></name><name><surname>Jefferson</surname><given-names>KK</given-names></name><name><surname>Buck</surname><given-names>GA</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>Quantifying Bias in 16S rRNA Experiments due to DNA Extraction, PCR Amplification, and Sequencing and Classification</data-title><source>NCBI BioProject</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/267701">PRJNA267701</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Costea</surname><given-names>PI</given-names></name><name><surname>Zeller</surname><given-names>G</given-names></name><name><surname>Sunagawa</surname><given-names>S</given-names></name><name><surname>Pelletier</surname><given-names>E</given-names></name><name><surname>Alberti</surname><given-names>A</given-names></name><name><surname>Levenez</surname><given-names>F</given-names></name><name><surname>Tramontano</surname><given-names>M</given-names></name><name><surname>Driessen</surname><given-names>M</given-names></name><name><surname>Hercog</surname><given-names>R</given-names></name><name><surname>Jung</surname><given-names>F-E</given-names></name><name><surname>Kultima</surname><given-names>JR</given-names></name><name><surname>Hayward</surname><given-names>MR</given-names></name><name><surname>Coelho</surname><given-names>LP</given-names></name><name><surname>Allen-Vercoe</surname><given-names>E</given-names></name><name><surname>Bertrand</surname><given-names>L</given-names></name><name><surname>Blaut</surname><given-names>M</given-names></name><name><surname>Brown</surname><given-names>JRM</given-names></name><name><surname>Carton</surname><given-names>T</given-names></name><name><surname>Cools-Portier</surname><given-names>S</given-names></name><name><surname>Daigneault</surname><given-names>M</given-names></name><name><surname>Derrien</surname><given-names>M</given-names></name><name><surname>Druesne</surname><given-names>A</given-names></name><name><surname>de</surname><given-names>Vos WM</given-names></name><name><surname>Finlay</surname><given-names>BB</given-names></name><name><surname>Flint</surname><given-names>HJ</given-names></name><name><surname>Guarner</surname><given-names>F</given-names></name><name><surname>Hattori</surname><given-names>M</given-names></name><name><surname>Heilig</surname><given-names>H</given-names></name><name><surname>Luna</surname><given-names>RA</given-names></name><name><surname>van</surname><given-names>Hylckama Vlieg J</given-names></name><name><surname>Junick</surname><given-names>J</given-names></name><name><surname>Klymiuk</surname><given-names>I</given-names></name><name><surname>Langella</surname><given-names>P</given-names></name><name><surname>Le</surname><given-names>Chatelier E</given-names></name><name><surname>Mai</surname><given-names>V</given-names></name><name><surname>Manichanh</surname><given-names>C</given-names></name><name><surname>Martin</surname><given-names>JC</given-names></name><name><surname>Mery</surname><given-names>C</given-names></name><name><surname>Morita</surname><given-names>H</given-names></name><name><surname>O'Toole</surname><given-names>PW</given-names></name><name><surname>Orvain</surname><given-names>C</given-names></name><name><surname>Patil</surname><given-names>KR</given-names></name><name><surname>Penders</surname><given-names>J</given-names></name><name><surname>Persson</surname><given-names>S</given-names></name><name><surname>Pons</surname><given-names>N</given-names></name><name><surname>Popova</surname><given-names>M</given-names></name><name><surname>Salonen</surname><given-names>A</given-names></name><name><surname>Saulnier</surname><given-names>D</given-names></name><name><surname>Scott</surname><given-names>KP</given-names></name><name><surname>Singh</surname><given-names>B</given-names></name><name><surname>Slezak</surname><given-names>K</given-names></name><name><surname>Veiga</surname><given-names>P</given-names></name><name><surname>Versalovic</surname><given-names>J</given-names></name><name><surname>Zhao</surname><given-names>L</given-names></name><name><surname>Zoetendal</surname><given-names>EG</given-names></name><name><surname>Ehrlich</surname><given-names>SD</given-names></name><name><surname>Dore</surname><given-names>J</given-names></name><name><surname>Bork</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>International Human Microbiome Standards</data-title><source>European Nucleotide Archive</source><pub-id assigning-authority="EBI" pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/ena/data/view/PRJEB14847">PRJEB14847</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Aitchison</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1986">1986</year><source>The Statistical Analysis of Compositional Data</source><publisher-loc>London</publisher-loc><publisher-name>Chapman and Hall</publisher-name></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aitchison</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>On criteria for measures of compositional difference</article-title><source>Mathematical Geology</source><volume>24</volume><fpage>365</fpage><lpage>379</lpage><pub-id pub-id-type="doi">10.1007/BF00891269</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Aitchison</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>A concise guide to compositional data analysis</article-title><conf-name>2nd Compositional Data Analysis Workshop</conf-name><ext-link ext-link-type="uri" xlink:href="http://ima.udg.edu/Activitats/CoDaWork05/A_concise_guide_to_compositional_data_analysis.pdf">http://ima.udg.edu/Activitats/CoDaWork05/A_concise_guide_to_compositional_data_analysis.pdf</ext-link></element-citation></ref><ref id="bib4"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>BarcelÃ³-Vidal</surname> <given-names>C</given-names></name><name><surname>MartÃ­n-FernÃ¡ndez</surname> <given-names>JA</given-names></name><name><surname>Pawlowsky-Glahn</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Mathematical foundations of compositional data analysis</article-title><conf-name>Proceedings of IAMG'01âThe Sixth Annual Conference of the International Association for Mathematical Geology</conf-name><ext-link ext-link-type="uri" xlink:href="http://ima.udg.edu/~barcelo/index_archivos/Cancun.pdf">http://ima.udg.edu/~barcelo/index_archivos/Cancun.pdf</ext-link></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>KL</given-names></name><name><surname>Burgess</surname> <given-names>KS</given-names></name><name><surname>Botsch</surname> <given-names>JC</given-names></name><name><surname>Dobbs</surname> <given-names>EK</given-names></name><name><surname>Read</surname> <given-names>TD</given-names></name><name><surname>Brosi</surname> <given-names>BJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Quantitative and qualitative assessment of pollen DNA metabarcoding using constructed species mixtures</article-title><source>Molecular Ecology</source><volume>28</volume><fpage>431</fpage><lpage>455</lpage><pub-id pub-id-type="doi">10.1111/mec.14840</pub-id><pub-id pub-id-type="pmid">30118180</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Bren</surname> <given-names>M</given-names></name><name><surname>Tolosana-Delgado</surname> <given-names>R</given-names></name><name><surname>van den Boogaart</surname> <given-names>KG</given-names></name></person-group><year iso-8601-date="2008">2008</year><data-title>News from &quot;compositions&quot;, the R package</data-title><ext-link ext-link-type="uri" xlink:href="https://core.ac.uk/download/pdf/132548286.pdf">https://core.ac.uk/download/pdf/132548286.pdf</ext-link></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brooks</surname> <given-names>JP</given-names></name><name><surname>Edwards</surname> <given-names>DJ</given-names></name><name><surname>Harwich</surname> <given-names>MD</given-names></name><name><surname>Rivera</surname> <given-names>MC</given-names></name><name><surname>Fettweis</surname> <given-names>JM</given-names></name><name><surname>Serrano</surname> <given-names>MG</given-names></name><name><surname>Reris</surname> <given-names>RA</given-names></name><name><surname>Sheth</surname> <given-names>NU</given-names></name><name><surname>Huang</surname> <given-names>B</given-names></name><name><surname>Girerd</surname> <given-names>P</given-names></name><collab>Vaginal Microbiome Consortium</collab><name><surname>Strauss</surname> <given-names>JF</given-names></name><name><surname>Jefferson</surname> <given-names>KK</given-names></name><name><surname>Buck</surname> <given-names>GA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The truth about metagenomics: quantifying and counteracting Bias in 16S rRNA studies</article-title><source>BMC Microbiology</source><volume>15</volume><elocation-id>66</elocation-id><pub-id pub-id-type="doi">10.1186/s12866-015-0351-6</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brooks</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Challenges for case-control studies with microbiome data</article-title><source>Annals of Epidemiology</source><volume>26</volume><fpage>336</fpage><lpage>341</lpage><pub-id pub-id-type="doi">10.1016/j.annepidem.2016.03.009</pub-id><pub-id pub-id-type="pmid">27255739</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Callahan</surname> <given-names>BJ</given-names></name><name><surname>DiGiulio</surname> <given-names>DB</given-names></name><name><surname>Goltsman</surname> <given-names>DSA</given-names></name><name><surname>Sun</surname> <given-names>CL</given-names></name><name><surname>Costello</surname> <given-names>EK</given-names></name><name><surname>Jeganathan</surname> <given-names>P</given-names></name><name><surname>Biggio</surname> <given-names>JR</given-names></name><name><surname>Wong</surname> <given-names>RJ</given-names></name><name><surname>Druzin</surname> <given-names>ML</given-names></name><name><surname>Shaw</surname> <given-names>GM</given-names></name><name><surname>Stevenson</surname> <given-names>DK</given-names></name><name><surname>Holmes</surname> <given-names>SP</given-names></name><name><surname>Relman</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Replication and refinement of a vaginal microbial signature of preterm birth in two racially distinct cohorts of US women</article-title><source>PNAS</source><volume>114</volume><fpage>9966</fpage><lpage>9971</lpage><pub-id pub-id-type="doi">10.1073/pnas.1705899114</pub-id><pub-id pub-id-type="pmid">28847941</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cocolin</surname> <given-names>L</given-names></name><name><surname>Mataragas</surname> <given-names>M</given-names></name><name><surname>Bourdichon</surname> <given-names>F</given-names></name><name><surname>Doulgeraki</surname> <given-names>A</given-names></name><name><surname>Pilet</surname> <given-names>M-F</given-names></name><name><surname>Jagadeesan</surname> <given-names>B</given-names></name><name><surname>Rantsiou</surname> <given-names>K</given-names></name><name><surname>Phister</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Next generation microbiological risk assessment meta-omics: the next need for integration</article-title><source>International Journal of Food Microbiology</source><volume>287</volume><fpage>10</fpage><lpage>17</lpage><pub-id pub-id-type="doi">10.1016/j.ijfoodmicro.2017.11.008</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Costea</surname> <given-names>PI</given-names></name><name><surname>Zeller</surname> <given-names>G</given-names></name><name><surname>Sunagawa</surname> <given-names>S</given-names></name><name><surname>Pelletier</surname> <given-names>E</given-names></name><name><surname>Alberti</surname> <given-names>A</given-names></name><name><surname>Levenez</surname> <given-names>F</given-names></name><name><surname>Tramontano</surname> <given-names>M</given-names></name><name><surname>Driessen</surname> <given-names>M</given-names></name><name><surname>Hercog</surname> <given-names>R</given-names></name><name><surname>Jung</surname> <given-names>FE</given-names></name><name><surname>Kultima</surname> <given-names>JR</given-names></name><name><surname>Hayward</surname> <given-names>MR</given-names></name><name><surname>Coelho</surname> <given-names>LP</given-names></name><name><surname>Allen-Vercoe</surname> <given-names>E</given-names></name><name><surname>Bertrand</surname> <given-names>L</given-names></name><name><surname>Blaut</surname> <given-names>M</given-names></name><name><surname>Brown</surname> <given-names>JRM</given-names></name><name><surname>Carton</surname> <given-names>T</given-names></name><name><surname>Cools-Portier</surname> <given-names>S</given-names></name><name><surname>Daigneault</surname> <given-names>M</given-names></name><name><surname>Derrien</surname> <given-names>M</given-names></name><name><surname>Druesne</surname> <given-names>A</given-names></name><name><surname>de Vos</surname> <given-names>WM</given-names></name><name><surname>Finlay</surname> <given-names>BB</given-names></name><name><surname>Flint</surname> <given-names>HJ</given-names></name><name><surname>Guarner</surname> <given-names>F</given-names></name><name><surname>Hattori</surname> <given-names>M</given-names></name><name><surname>Heilig</surname> <given-names>H</given-names></name><name><surname>Luna</surname> <given-names>RA</given-names></name><name><surname>van Hylckama Vlieg</surname> <given-names>J</given-names></name><name><surname>Junick</surname> <given-names>J</given-names></name><name><surname>Klymiuk</surname> <given-names>I</given-names></name><name><surname>Langella</surname> <given-names>P</given-names></name><name><surname>Le Chatelier</surname> <given-names>E</given-names></name><name><surname>Mai</surname> <given-names>V</given-names></name><name><surname>Manichanh</surname> <given-names>C</given-names></name><name><surname>Martin</surname> <given-names>JC</given-names></name><name><surname>Mery</surname> <given-names>C</given-names></name><name><surname>Morita</surname> <given-names>H</given-names></name><name><surname>O'Toole</surname> <given-names>PW</given-names></name><name><surname>Orvain</surname> <given-names>C</given-names></name><name><surname>Patil</surname> <given-names>KR</given-names></name><name><surname>Penders</surname> <given-names>J</given-names></name><name><surname>Persson</surname> <given-names>S</given-names></name><name><surname>Pons</surname> <given-names>N</given-names></name><name><surname>Popova</surname> <given-names>M</given-names></name><name><surname>Salonen</surname> <given-names>A</given-names></name><name><surname>Saulnier</surname> <given-names>D</given-names></name><name><surname>Scott</surname> <given-names>KP</given-names></name><name><surname>Singh</surname> <given-names>B</given-names></name><name><surname>Slezak</surname> <given-names>K</given-names></name><name><surname>Veiga</surname> <given-names>P</given-names></name><name><surname>Versalovic</surname> <given-names>J</given-names></name><name><surname>Zhao</surname> <given-names>L</given-names></name><name><surname>Zoetendal</surname> <given-names>EG</given-names></name><name><surname>Ehrlich</surname> <given-names>SD</given-names></name><name><surname>Dore</surname> <given-names>J</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Towards standards for human fecal sample processing in metagenomic studies</article-title><source>Nature Biotechnology</source><volume>35</volume><fpage>1069</fpage><lpage>1076</lpage><pub-id pub-id-type="doi">10.1038/nbt.3960</pub-id><pub-id pub-id-type="pmid">28967887</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>D'Amore</surname> <given-names>R</given-names></name><name><surname>Ijaz</surname> <given-names>UZ</given-names></name><name><surname>Schirmer</surname> <given-names>M</given-names></name><name><surname>Kenny</surname> <given-names>JG</given-names></name><name><surname>Gregory</surname> <given-names>R</given-names></name><name><surname>Darby</surname> <given-names>AC</given-names></name><name><surname>Shakya</surname> <given-names>M</given-names></name><name><surname>Podar</surname> <given-names>M</given-names></name><name><surname>Quince</surname> <given-names>C</given-names></name><name><surname>Hall</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A comprehensive benchmarking study of protocols and sequencing platforms for 16S rRNA community profiling</article-title><source>BMC Genomics</source><volume>17</volume><fpage>55</fpage><pub-id pub-id-type="doi">10.1186/s12864-015-2194-9</pub-id><pub-id pub-id-type="pmid">26763898</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davis</surname> <given-names>NM</given-names></name><name><surname>Proctor</surname> <given-names>DM</given-names></name><name><surname>Holmes</surname> <given-names>SP</given-names></name><name><surname>Relman</surname> <given-names>DA</given-names></name><name><surname>Callahan</surname> <given-names>BJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Simple statistical identification and removal of contaminant sequences in marker-gene and metagenomics data</article-title><source>Microbiome</source><volume>6</volume><elocation-id>226</elocation-id><pub-id pub-id-type="doi">10.1186/s40168-018-0605-2</pub-id><pub-id pub-id-type="pmid">30558668</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dick</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><source>Genomic Approaches in Earth and Environmental Sciences</source><publisher-loc>Chichester, UK</publisher-loc><publisher-name>John Wiley &amp; Sons, Ltd</publisher-name></element-citation></ref><ref id="bib15"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Edgar</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>UNBIAS: an attempt to correct abundance Bias in 16S sequencing, with limited success</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/124149</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Updating the 97% identity threshold for 16S ribosomal RNA OTUs</article-title><source>Bioinformatics</source><volume>34</volume><fpage>2371</fpage><lpage>2375</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bty113</pub-id><pub-id pub-id-type="pmid">29506021</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Efron</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Bootstrap methods: another look at the jackknife</article-title><source>The Annals of Statistics</source><volume>7</volume><fpage>1</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1214/aos/1176344552</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eisenhofer</surname> <given-names>R</given-names></name><name><surname>Minich</surname> <given-names>JJ</given-names></name><name><surname>Marotz</surname> <given-names>C</given-names></name><name><surname>Cooper</surname> <given-names>A</given-names></name><name><surname>Knight</surname> <given-names>R</given-names></name><name><surname>Weyrich</surname> <given-names>LS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Contamination in low microbial biomass microbiome studies: issues and recommendations</article-title><source>Trends in Microbiology</source><volume>27</volume><fpage>105</fpage><lpage>117</lpage><pub-id pub-id-type="doi">10.1016/j.tim.2018.11.003</pub-id><pub-id pub-id-type="pmid">30497919</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fettweis</surname> <given-names>JM</given-names></name><name><surname>Serrano</surname> <given-names>MG</given-names></name><name><surname>Sheth</surname> <given-names>NU</given-names></name><name><surname>Mayer</surname> <given-names>CM</given-names></name><name><surname>Glascock</surname> <given-names>AL</given-names></name><name><surname>Brooks</surname> <given-names>JP</given-names></name><name><surname>Jefferson</surname> <given-names>KK</given-names></name><name><surname>Buck</surname> <given-names>GA</given-names></name><collab>Vaginal Microbiome Consortium (additional members)</collab></person-group><year iso-8601-date="2012">2012</year><article-title>Species-level classification of the vaginal microbiome</article-title><source>BMC Genomics</source><volume>13 Suppl 8</volume><elocation-id>S17</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2164-13-S8-S17</pub-id><pub-id pub-id-type="pmid">23282177</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finucane</surname> <given-names>MM</given-names></name><name><surname>Sharpton</surname> <given-names>TJ</given-names></name><name><surname>Laurent</surname> <given-names>TJ</given-names></name><name><surname>Pollard</surname> <given-names>KS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A taxonomic signature of obesity in the microbiome? getting to the guts of the matter</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e84689</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0084689</pub-id><pub-id pub-id-type="pmid">24416266</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gibbons</surname> <given-names>SM</given-names></name><name><surname>Duvallet</surname> <given-names>C</given-names></name><name><surname>Alm</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Correcting for batch effects in case-control microbiome studies</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006102</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006102</pub-id><pub-id pub-id-type="pmid">29684016</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilbert</surname> <given-names>JA</given-names></name><name><surname>Jansson</surname> <given-names>JK</given-names></name><name><surname>Knight</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The earth microbiome project: successes and aspirations</article-title><source>BMC Biology</source><volume>12</volume><elocation-id>69</elocation-id><pub-id pub-id-type="doi">10.1186/s12915-014-0069-1</pub-id><pub-id pub-id-type="pmid">25184604</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gloor</surname> <given-names>GB</given-names></name><name><surname>Macklaim</surname> <given-names>JM</given-names></name><name><surname>Pawlowsky-Glahn</surname> <given-names>V</given-names></name><name><surname>Egozcue</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Microbiome datasets are compositional: and this is not optional</article-title><source>Frontiers in Microbiology</source><volume>8</volume><elocation-id>2224</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2017.02224</pub-id><pub-id pub-id-type="pmid">29187837</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goberna</surname> <given-names>M</given-names></name><name><surname>VerdÃº</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Predicting microbial traits with phylogenies</article-title><source>The ISME Journal</source><volume>10</volume><fpage>959</fpage><lpage>967</lpage><pub-id pub-id-type="doi">10.1038/ismej.2015.171</pub-id><pub-id pub-id-type="pmid">26371406</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonzalez</surname> <given-names>JM</given-names></name><name><surname>Portillo</surname> <given-names>MC</given-names></name><name><surname>Belda-Ferre</surname> <given-names>P</given-names></name><name><surname>Mira</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Amplification by PCR artificially reduces the proportion of the rare biosphere in microbial communities</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e29973</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0029973</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graham</surname> <given-names>EB</given-names></name><name><surname>Knelman</surname> <given-names>JE</given-names></name><name><surname>Schindlbacher</surname> <given-names>A</given-names></name><name><surname>Siciliano</surname> <given-names>S</given-names></name><name><surname>Breulmann</surname> <given-names>M</given-names></name><name><surname>Yannarell</surname> <given-names>A</given-names></name><name><surname>Beman</surname> <given-names>JM</given-names></name><name><surname>Abell</surname> <given-names>G</given-names></name><name><surname>Philippot</surname> <given-names>L</given-names></name><name><surname>Prosser</surname> <given-names>J</given-names></name><name><surname>Foulquier</surname> <given-names>A</given-names></name><name><surname>Yuste</surname> <given-names>JC</given-names></name><name><surname>Glanville</surname> <given-names>HC</given-names></name><name><surname>Jones</surname> <given-names>DL</given-names></name><name><surname>Angel</surname> <given-names>R</given-names></name><name><surname>Salminen</surname> <given-names>J</given-names></name><name><surname>Newton</surname> <given-names>RJ</given-names></name><name><surname>BÃ¼rgmann</surname> <given-names>H</given-names></name><name><surname>Ingram</surname> <given-names>LJ</given-names></name><name><surname>Hamer</surname> <given-names>U</given-names></name><name><surname>Siljanen</surname> <given-names>HM</given-names></name><name><surname>Peltoniemi</surname> <given-names>K</given-names></name><name><surname>Potthast</surname> <given-names>K</given-names></name><name><surname>BaÃ±eras</surname> <given-names>L</given-names></name><name><surname>Hartmann</surname> <given-names>M</given-names></name><name><surname>Banerjee</surname> <given-names>S</given-names></name><name><surname>Yu</surname> <given-names>RQ</given-names></name><name><surname>Nogaro</surname> <given-names>G</given-names></name><name><surname>Richter</surname> <given-names>A</given-names></name><name><surname>Koranda</surname> <given-names>M</given-names></name><name><surname>Castle</surname> <given-names>SC</given-names></name><name><surname>Goberna</surname> <given-names>M</given-names></name><name><surname>Song</surname> <given-names>B</given-names></name><name><surname>Chatterjee</surname> <given-names>A</given-names></name><name><surname>Nunes</surname> <given-names>OC</given-names></name><name><surname>Lopes</surname> <given-names>AR</given-names></name><name><surname>Cao</surname> <given-names>Y</given-names></name><name><surname>Kaisermann</surname> <given-names>A</given-names></name><name><surname>Hallin</surname> <given-names>S</given-names></name><name><surname>Strickland</surname> <given-names>MS</given-names></name><name><surname>Garcia-Pausas</surname> <given-names>J</given-names></name><name><surname>Barba</surname> <given-names>J</given-names></name><name><surname>Kang</surname> <given-names>H</given-names></name><name><surname>Isobe</surname> <given-names>K</given-names></name><name><surname>Papaspyrou</surname> <given-names>S</given-names></name><name><surname>Pastorelli</surname> <given-names>R</given-names></name><name><surname>Lagomarsino</surname> <given-names>A</given-names></name><name><surname>LindstrÃ¶m</surname> <given-names>ES</given-names></name><name><surname>Basiliko</surname> <given-names>N</given-names></name><name><surname>Nemergut</surname> <given-names>DR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Microbes as engines of ecosystem function: when does community structure enhance predictions of ecosystem processes?</article-title><source>Frontiers in Microbiology</source><volume>7</volume><elocation-id>214</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2016.00214</pub-id><pub-id pub-id-type="pmid">26941732</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardwick</surname> <given-names>SA</given-names></name><name><surname>Deveson</surname> <given-names>IW</given-names></name><name><surname>Mercer</surname> <given-names>TR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Reference standards for next-generation sequencing</article-title><source>Nature Reviews Genetics</source><volume>18</volume><fpage>473</fpage><lpage>484</lpage><pub-id pub-id-type="doi">10.1038/nrg.2017.44</pub-id><pub-id pub-id-type="pmid">28626224</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hiergeist</surname> <given-names>A</given-names></name><name><surname>Reischl</surname> <given-names>U</given-names></name><name><surname>Gessner</surname> <given-names>A</given-names></name><collab>Priority Program 1656 Intestinal Microbiota Consortium/ quality assessment participants</collab></person-group><year iso-8601-date="2016">2016</year><article-title>Multicenter quality assessment of 16S ribosomal DNA-sequencing for microbiome analyses reveals high inter-center variability</article-title><source>International Journal of Medical Microbiology</source><volume>306</volume><fpage>334</fpage><lpage>342</lpage><pub-id pub-id-type="doi">10.1016/j.ijmm.2016.03.005</pub-id><pub-id pub-id-type="pmid">27052158</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hillmann</surname> <given-names>B</given-names></name><name><surname>Al-Ghalith</surname> <given-names>GA</given-names></name><name><surname>Shields-Cutler</surname> <given-names>RR</given-names></name><name><surname>Zhu</surname> <given-names>Q</given-names></name><name><surname>Gohl</surname> <given-names>DM</given-names></name><name><surname>Beckman</surname> <given-names>KB</given-names></name><name><surname>Knight</surname> <given-names>R</given-names></name><name><surname>Knights</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Evaluating the information content of shallow shotgun metagenomics</article-title><source>mSystems</source><volume>3</volume><elocation-id>e00069-18</elocation-id><pub-id pub-id-type="doi">10.1128/mSystems.00069-18</pub-id><pub-id pub-id-type="pmid">30443602</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hugerth</surname> <given-names>LW</given-names></name><name><surname>Andersson</surname> <given-names>AF</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Analysing microbial community composition through amplicon sequencing: from sampling to hypothesis testing</article-title><source>Frontiers in Microbiology</source><volume>8</volume><elocation-id>1561</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2017.01561</pub-id><pub-id pub-id-type="pmid">28928718</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kembel</surname> <given-names>SW</given-names></name><name><surname>Wu</surname> <given-names>M</given-names></name><name><surname>Eisen</surname> <given-names>JA</given-names></name><name><surname>Green</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Incorporating 16S gene copy number information improves estimates of microbial diversity and abundance</article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002743</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002743</pub-id><pub-id pub-id-type="pmid">23133348</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kevorkian</surname> <given-names>R</given-names></name><name><surname>Bird</surname> <given-names>JT</given-names></name><name><surname>Shumaker</surname> <given-names>A</given-names></name><name><surname>Lloyd</surname> <given-names>KG</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Estimating population turnover rates by relative quantification methods reveals microbial dynamics in marine sediment</article-title><source>Applied and Environmental Microbiology</source><volume>84</volume><elocation-id>e01443-17</elocation-id><pub-id pub-id-type="doi">10.1128/AEM.01443-17</pub-id><pub-id pub-id-type="pmid">29054869</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knight</surname> <given-names>R</given-names></name><name><surname>Callewaert</surname> <given-names>C</given-names></name><name><surname>Marotz</surname> <given-names>C</given-names></name><name><surname>Hyde</surname> <given-names>ER</given-names></name><name><surname>Debelius</surname> <given-names>JW</given-names></name><name><surname>McDonald</surname> <given-names>D</given-names></name><name><surname>Sogin</surname> <given-names>ML</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The microbiome and human biology</article-title><source>Annual Review of Genomics and Human Genetics</source><volume>18</volume><fpage>65</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1146/annurev-genom-083115-022438</pub-id><pub-id pub-id-type="pmid">28375652</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krehenwinkel</surname> <given-names>H</given-names></name><name><surname>Wolf</surname> <given-names>M</given-names></name><name><surname>Lim</surname> <given-names>JY</given-names></name><name><surname>Rominger</surname> <given-names>AJ</given-names></name><name><surname>Simison</surname> <given-names>WB</given-names></name><name><surname>Gillespie</surname> <given-names>RG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Estimating and mitigating amplification Bias in qualitative and quantitative arthropod metabarcoding</article-title><source>Scientific Reports</source><volume>7</volume><elocation-id>17668</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-017-17333-x</pub-id><pub-id pub-id-type="pmid">29247210</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larsson</surname> <given-names>AJM</given-names></name><name><surname>Stanley</surname> <given-names>G</given-names></name><name><surname>Sinha</surname> <given-names>R</given-names></name><name><surname>Weissman</surname> <given-names>IL</given-names></name><name><surname>Sandberg</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Computational correction of index switching in multiplexed sequencing libraries</article-title><source>Nature Methods</source><volume>15</volume><fpage>305</fpage><lpage>307</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4666</pub-id><pub-id pub-id-type="pmid">29702636</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lehman</surname> <given-names>RM</given-names></name><name><surname>Acosta-Martinez</surname> <given-names>V</given-names></name><name><surname>Buyer</surname> <given-names>JS</given-names></name><name><surname>Cambardella</surname> <given-names>CA</given-names></name><name><surname>Collins</surname> <given-names>HP</given-names></name><name><surname>Ducey</surname> <given-names>TF</given-names></name><name><surname>Halvorson</surname> <given-names>JJ</given-names></name><name><surname>Jin</surname> <given-names>VL</given-names></name><name><surname>Johnson</surname> <given-names>JMF</given-names></name><name><surname>Kremer</surname> <given-names>RJ</given-names></name><name><surname>Lundgren</surname> <given-names>JG</given-names></name><name><surname>Manter</surname> <given-names>DK</given-names></name><name><surname>Maul</surname> <given-names>JE</given-names></name><name><surname>Smith</surname> <given-names>JL</given-names></name><name><surname>Stott</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Soil biology for resilient, healthy soil</article-title><source>Journal of Soil and Water Conservation</source><volume>70</volume><fpage>12A</fpage><lpage>18</lpage><pub-id pub-id-type="doi">10.2489/jswc.70.1.12A</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ley</surname> <given-names>RE</given-names></name><name><surname>Turnbaugh</surname> <given-names>PJ</given-names></name><name><surname>Klein</surname> <given-names>S</given-names></name><name><surname>Gordon</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Human gut microbes associated with obesity</article-title><source>Nature</source><volume>444</volume><fpage>1022</fpage><lpage>1023</lpage><pub-id pub-id-type="doi">10.1038/4441022a</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Microbiome, metagenomics, and High-Dimensional compositional data analysis</article-title><source>Annual Review of Statistics and Its Application</source><volume>2</volume><fpage>73</fpage><lpage>94</lpage><pub-id pub-id-type="doi">10.1146/annurev-statistics-010814-020351</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mallick</surname> <given-names>H</given-names></name><name><surname>Ma</surname> <given-names>S</given-names></name><name><surname>Franzosa</surname> <given-names>EA</given-names></name><name><surname>Vatanen</surname> <given-names>T</given-names></name><name><surname>Morgan</surname> <given-names>XC</given-names></name><name><surname>Huttenhower</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Experimental design and quantitative analysis of microbial community multiomics</article-title><source>Genome Biology</source><volume>18</volume><elocation-id>228</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-017-1359-z</pub-id><pub-id pub-id-type="pmid">29187204</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>McLaren</surname> <given-names>MR</given-names></name></person-group><year iso-8601-date="2019">2019a</year><data-title>metacal</data-title><version designator="006b343">006b343</version><ext-link ext-link-type="uri" xlink:href="https://github.com/mikemc/metacal">https://github.com/mikemc/metacal</ext-link></element-citation></ref><ref id="bib41"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>McLaren</surname> <given-names>MR</given-names></name></person-group><year iso-8601-date="2019">2019b</year><data-title>mgs-bias-manuscript</data-title><version designator="4812a65">4812a65</version><ext-link ext-link-type="uri" xlink:href="https://github.com/mikemc/mgs-bias-manuscript">https://github.com/mikemc/mgs-bias-manuscript</ext-link></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLaren</surname> <given-names>MR</given-names></name><name><surname>Callahan</surname> <given-names>BJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>In nature, there is only diversity</article-title><source>mBio</source><volume>9</volume><elocation-id>e02149-17</elocation-id><pub-id pub-id-type="doi">10.1128/mBio.02149-17</pub-id><pub-id pub-id-type="pmid">29295915</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metcalf</surname> <given-names>JL</given-names></name><name><surname>Xu</surname> <given-names>ZZ</given-names></name><name><surname>Bouslimani</surname> <given-names>A</given-names></name><name><surname>Dorrestein</surname> <given-names>P</given-names></name><name><surname>Carter</surname> <given-names>DO</given-names></name><name><surname>Knight</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Microbiome tools for forensic science</article-title><source>Trends in Biotechnology</source><volume>35</volume><fpage>814</fpage><lpage>823</lpage><pub-id pub-id-type="doi">10.1016/j.tibtech.2017.03.006</pub-id><pub-id pub-id-type="pmid">28366290</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morgan</surname> <given-names>JL</given-names></name><name><surname>Darling</surname> <given-names>AE</given-names></name><name><surname>Eisen</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Metagenomic sequencing of an in vitro-simulated microbial community</article-title><source>PLOS ONE</source><volume>5</volume><elocation-id>e10209</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0010209</pub-id><pub-id pub-id-type="pmid">20419134</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nayfach</surname> <given-names>S</given-names></name><name><surname>Pollard</surname> <given-names>KS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Toward accurate and quantitative comparative metagenomics</article-title><source>Cell</source><volume>166</volume><fpage>1103</fpage><lpage>1116</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.08.007</pub-id><pub-id pub-id-type="pmid">27565341</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Newman</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><source>Networks: An Introduction, 1st Ed</source><publisher-loc>Oxford</publisher-loc><publisher-name>Oxford University Press</publisher-name></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parks</surname> <given-names>DH</given-names></name><name><surname>Chuvochina</surname> <given-names>M</given-names></name><name><surname>Waite</surname> <given-names>DW</given-names></name><name><surname>Rinke</surname> <given-names>C</given-names></name><name><surname>Skarshewski</surname> <given-names>A</given-names></name><name><surname>Chaumeil</surname> <given-names>PA</given-names></name><name><surname>Hugenholtz</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A standardized bacterial taxonomy based on genome phylogeny substantially revises the tree of life</article-title><source>Nature Biotechnology</source><volume>36</volume><fpage>996</fpage><lpage>1004</lpage><pub-id pub-id-type="doi">10.1038/nbt.4229</pub-id><pub-id pub-id-type="pmid">30148503</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pawlowsky-Glahn</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><chapter-title>The Aitchison geometry</chapter-title><source>Modelling and Analysis of Compositional Data</source><volume>3</volume><publisher-loc>Chichester, UK</publisher-loc><publisher-name>John Wiley &amp; Sons, Ltd</publisher-name><fpage>23</fpage><lpage>31</lpage></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pawlowsky-Glahn</surname> <given-names>V</given-names></name><name><surname>Egozcue</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>BLU estimators and compositional data</article-title><source>Mathematical Geology</source><volume>34</volume><fpage>259</fpage><lpage>274</lpage><pub-id pub-id-type="doi">10.1023/A:1014890722372</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pollock</surname> <given-names>J</given-names></name><name><surname>Glendinning</surname> <given-names>L</given-names></name><name><surname>Wisedchanwet</surname> <given-names>T</given-names></name><name><surname>Watson</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The madness of microbiome: attempting to find consensus &quot;Best Practice&quot; for 16S Microbiome Studies</article-title><source>Applied and Environmental Microbiology</source><volume>84</volume><elocation-id>e02627-17</elocation-id><pub-id pub-id-type="doi">10.1128/AEM.02627-17</pub-id><pub-id pub-id-type="pmid">29427429</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Polz</surname> <given-names>MF</given-names></name><name><surname>Cavanaugh</surname> <given-names>CM</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Bias in template-to-product ratios in multitemplate PCR</article-title><source>Applied and Environmental Microbiology</source><volume>64</volume><fpage>3724</fpage><lpage>3730</lpage><pub-id pub-id-type="pmid">9758791</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quince</surname> <given-names>C</given-names></name><name><surname>Walker</surname> <given-names>AW</given-names></name><name><surname>Simpson</surname> <given-names>JT</given-names></name><name><surname>Loman</surname> <given-names>NJ</given-names></name><name><surname>Segata</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Shotgun metagenomics, from sampling to analysis</article-title><source>Nature Biotechnology</source><volume>35</volume><fpage>833</fpage><lpage>844</lpage><pub-id pub-id-type="doi">10.1038/nbt.3935</pub-id><pub-id pub-id-type="pmid">28898207</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="software"><person-group person-group-type="author"><collab>R Development Core Team</collab></person-group><year iso-8601-date="2018">2018</year><data-title>R: A Language and Environment for Statistical Computing</data-title><source>R Foundation for Statistical Computing</source><publisher-loc>Vienna, Austria</publisher-loc><publisher-name>R Foundation for Statistical Computing</publisher-name><ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">https://www.r-project.org/</ext-link></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rivera-Pinto</surname> <given-names>J</given-names></name><name><surname>Egozcue</surname> <given-names>JJ</given-names></name><name><surname>Pawlowsky-Glahn</surname> <given-names>V</given-names></name><name><surname>Paredes</surname> <given-names>R</given-names></name><name><surname>Noguera-Julian</surname> <given-names>M</given-names></name><name><surname>Calle</surname> <given-names>ML</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Balances: a new perspective for microbiome analysis</article-title><source>mSystems</source><volume>3</volume><elocation-id>e00053</elocation-id><pub-id pub-id-type="doi">10.1128/mSystems.00053-18</pub-id><pub-id pub-id-type="pmid">30035234</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosso</surname> <given-names>GE</given-names></name><name><surname>Muday</surname> <given-names>JA</given-names></name><name><surname>Curran</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Tools for metagenomic analysis at wastewater treatment plants:application to a foaming episode</article-title><source>Water Environment Research</source><volume>90</volume><fpage>258</fpage><lpage>268</lpage><pub-id pub-id-type="doi">10.2175/106143017X15054988926352</pub-id><pub-id pub-id-type="pmid">28962671</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubin</surname> <given-names>DB</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>The bayesian bootstrap</article-title><source>The Annals of Statistics</source><volume>9</volume><fpage>130</fpage><lpage>134</lpage><pub-id pub-id-type="doi">10.1214/aos/1176345338</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schrader</surname> <given-names>C</given-names></name><name><surname>Schielke</surname> <given-names>A</given-names></name><name><surname>Ellerbroek</surname> <given-names>L</given-names></name><name><surname>Johne</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>PCR inhibitors - occurrence, properties and removal</article-title><source>Journal of Applied Microbiology</source><volume>113</volume><fpage>1014</fpage><lpage>1026</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2672.2012.05384.x</pub-id><pub-id pub-id-type="pmid">22747964</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silverman</surname> <given-names>JD</given-names></name><name><surname>Washburne</surname> <given-names>AD</given-names></name><name><surname>Mukherjee</surname> <given-names>S</given-names></name><name><surname>David</surname> <given-names>LA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A phylogenetic transform enhances analysis of compositional Microbiota data</article-title><source>eLife</source><volume>6</volume><elocation-id>e21887</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.21887</pub-id><pub-id pub-id-type="pmid">28198697</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sinha</surname> <given-names>R</given-names></name><name><surname>Abu-Ali</surname> <given-names>G</given-names></name><name><surname>Vogtmann</surname> <given-names>E</given-names></name><name><surname>Fodor</surname> <given-names>AA</given-names></name><name><surname>Ren</surname> <given-names>B</given-names></name><name><surname>Amir</surname> <given-names>A</given-names></name><name><surname>Schwager</surname> <given-names>E</given-names></name><name><surname>Crabtree</surname> <given-names>J</given-names></name><name><surname>Ma</surname> <given-names>S</given-names></name><name><surname>Abnet</surname> <given-names>CC</given-names></name><name><surname>Knight</surname> <given-names>R</given-names></name><name><surname>White</surname> <given-names>O</given-names></name><name><surname>Huttenhower</surname> <given-names>C</given-names></name><collab>Microbiome Quality Control Project Consortium</collab></person-group><year iso-8601-date="2017">2017</year><article-title>Assessment of variation in microbial community amplicon sequencing by the microbiome quality control (MBQC) project consortium</article-title><source>Nature Biotechnology</source><volume>35</volume><fpage>1077</fpage><lpage>1086</lpage><pub-id pub-id-type="doi">10.1038/nbt.3981</pub-id><pub-id pub-id-type="pmid">28967885</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sipos</surname> <given-names>R</given-names></name><name><surname>SzÃ©kely</surname> <given-names>AJ</given-names></name><name><surname>Palatinszky</surname> <given-names>M</given-names></name><name><surname>RÃ©vÃ©sz</surname> <given-names>S</given-names></name><name><surname>MÃ¡rialigeti</surname> <given-names>K</given-names></name><name><surname>Nikolausz</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Effect of primer mismatch, annealing temperature and PCR cycle number on 16S rRNA gene-targetting bacterial community analysis</article-title><source>FEMS Microbiology Ecology</source><volume>60</volume><fpage>341</fpage><lpage>350</lpage><pub-id pub-id-type="doi">10.1111/j.1574-6941.2007.00283.x</pub-id><pub-id pub-id-type="pmid">17343679</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname> <given-names>SJ</given-names></name><name><surname>Amir</surname> <given-names>A</given-names></name><name><surname>Metcalf</surname> <given-names>JL</given-names></name><name><surname>Amato</surname> <given-names>KR</given-names></name><name><surname>Xu</surname> <given-names>ZZ</given-names></name><name><surname>Humphrey</surname> <given-names>G</given-names></name><name><surname>Knight</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Preservation methods differ in fecal microbiome stability, affecting suitability for field studies</article-title><source>mSystems</source><volume>1</volume><elocation-id>e00021-16</elocation-id><pub-id pub-id-type="doi">10.1128/mSystems.00021-16</pub-id><pub-id pub-id-type="pmid">27822526</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suzuki</surname> <given-names>MT</given-names></name><name><surname>Giovannoni</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Bias caused by template annealing in the amplification of mixtures of 16S rRNA genes by PCR</article-title><source>Applied and Environmental Microbiology</source><volume>62</volume><fpage>625</fpage><lpage>630</lpage><pub-id pub-id-type="pmid">8593063</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomas</surname> <given-names>AC</given-names></name><name><surname>Deagle</surname> <given-names>BE</given-names></name><name><surname>Eveson</surname> <given-names>JP</given-names></name><name><surname>Harsch</surname> <given-names>CH</given-names></name><name><surname>Trites</surname> <given-names>AW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Quantitative DNA metabarcoding: improved estimates of species proportional biomass using correction factors derived from control material</article-title><source>Molecular Ecology Resources</source><volume>16</volume><fpage>714</fpage><lpage>726</lpage><pub-id pub-id-type="doi">10.1111/1755-0998.12490</pub-id><pub-id pub-id-type="pmid">26602877</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Truong</surname> <given-names>DT</given-names></name><name><surname>Franzosa</surname> <given-names>EA</given-names></name><name><surname>Tickle</surname> <given-names>TL</given-names></name><name><surname>Scholz</surname> <given-names>M</given-names></name><name><surname>Weingart</surname> <given-names>G</given-names></name><name><surname>Pasolli</surname> <given-names>E</given-names></name><name><surname>Tett</surname> <given-names>A</given-names></name><name><surname>Huttenhower</surname> <given-names>C</given-names></name><name><surname>Segata</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>MetaPhlAn2 for enhanced metagenomic taxonomic profiling</article-title><source>Nature Methods</source><volume>12</volume><fpage>902</fpage><lpage>903</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3589</pub-id><pub-id pub-id-type="pmid">26418763</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van den Boogaart</surname> <given-names>KG</given-names></name><name><surname>Tolosana-Delgado</surname> <given-names>R</given-names></name><name><surname>Bren</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Concepts for handling of zeros and missing values in compositional data</article-title><source>Proc. IAMG</source><volume>6</volume><fpage>1</fpage><lpage>4</lpage></element-citation></ref><ref id="bib66"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>van den Boogaart</surname> <given-names>KG</given-names></name><name><surname>Tolosana-Delgado</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><source>Analyzing Compositional Data with R</source><publisher-loc>Berlin, Heidelberg</publisher-loc><publisher-name>Springer Berlin Heidelberg</publisher-name></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname> <given-names>A</given-names></name><name><surname>Blackstone</surname> <given-names>N</given-names></name><name><surname>Cartwright</surname> <given-names>P</given-names></name><name><surname>Dick</surname> <given-names>M</given-names></name><name><surname>Misof</surname> <given-names>B</given-names></name><name><surname>Snow</surname> <given-names>P</given-names></name><name><surname>Wagner</surname> <given-names>GP</given-names></name><name><surname>Bartels</surname> <given-names>J</given-names></name><name><surname>Murtha</surname> <given-names>M</given-names></name><name><surname>Pendleton</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Surveys of gene families using polymerase chain reaction: pcr selection and PCR drift</article-title><source>Systematic Biology</source><volume>43</volume><fpage>250</fpage><lpage>261</lpage><pub-id pub-id-type="doi">10.1093/sysbio/43.2.250</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Wickham</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>tidyverse: Easily install and load packages from the tidyverse</data-title><ext-link ext-link-type="uri" xlink:href="https://github.com/tidyverse/tidyverse">https://github.com/tidyverse/tidyverse</ext-link></element-citation></ref><ref id="bib69"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Wilke</surname> <given-names>CO</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>cowplot: Streamlined plot theme and plot annotations for âggplot2â</data-title><ext-link ext-link-type="uri" xlink:href="https://github.com/wilkelab/cowplot">https://github.com/wilkelab/cowplot</ext-link></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yarza</surname> <given-names>P</given-names></name><name><surname>Yilmaz</surname> <given-names>P</given-names></name><name><surname>Pruesse</surname> <given-names>E</given-names></name><name><surname>GlÃ¶ckner</surname> <given-names>FO</given-names></name><name><surname>Ludwig</surname> <given-names>W</given-names></name><name><surname>Schleifer</surname> <given-names>KH</given-names></name><name><surname>Whitman</surname> <given-names>WB</given-names></name><name><surname>EuzÃ©by</surname> <given-names>J</given-names></name><name><surname>Amann</surname> <given-names>R</given-names></name><name><surname>RossellÃ³-MÃ³ra</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Uniting the classification of cultured and uncultured Bacteria and archaea using 16S rRNA gene sequences</article-title><source>Nature Reviews Microbiology</source><volume>12</volume><fpage>635</fpage><lpage>645</lpage><pub-id pub-id-type="doi">10.1038/nrmicro3330</pub-id><pub-id pub-id-type="pmid">25118885</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeh</surname> <given-names>YC</given-names></name><name><surname>Needham</surname> <given-names>DM</given-names></name><name><surname>Sieradzki</surname> <given-names>ET</given-names></name><name><surname>Fuhrman</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Taxon disappearance from microbiome analysis reinforces the value of mock communities as a standard in every sequencing run</article-title><source>mSystems</source><volume>3</volume><elocation-id>e00023-18</elocation-id><pub-id pub-id-type="doi">10.1128/mSystems.00023-18</pub-id><pub-id pub-id-type="pmid">29629423</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuan</surname> <given-names>S</given-names></name><name><surname>Cohen</surname> <given-names>DB</given-names></name><name><surname>Ravel</surname> <given-names>J</given-names></name><name><surname>Abdo</surname> <given-names>Z</given-names></name><name><surname>Forney</surname> <given-names>LJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Evaluation of methods for the extraction and purification of DNA from the human microbiome</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e33865</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0033865</pub-id><pub-id pub-id-type="pmid">22457796</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeevi</surname> <given-names>D</given-names></name><name><surname>Korem</surname> <given-names>T</given-names></name><name><surname>Zmora</surname> <given-names>N</given-names></name><name><surname>Israeli</surname> <given-names>D</given-names></name><name><surname>Rothschild</surname> <given-names>D</given-names></name><name><surname>Weinberger</surname> <given-names>A</given-names></name><name><surname>Ben-Yacov</surname> <given-names>O</given-names></name><name><surname>Lador</surname> <given-names>D</given-names></name><name><surname>Avnit-Sagi</surname> <given-names>T</given-names></name><name><surname>Lotan-Pompan</surname> <given-names>M</given-names></name><name><surname>Suez</surname> <given-names>J</given-names></name><name><surname>Mahdi</surname> <given-names>JA</given-names></name><name><surname>Matot</surname> <given-names>E</given-names></name><name><surname>Malka</surname> <given-names>G</given-names></name><name><surname>Kosower</surname> <given-names>N</given-names></name><name><surname>Rein</surname> <given-names>M</given-names></name><name><surname>Zilberman-Schapira</surname> <given-names>G</given-names></name><name><surname>DohnalovÃ¡</surname> <given-names>L</given-names></name><name><surname>Pevsner-Fischer</surname> <given-names>M</given-names></name><name><surname>Bikovsky</surname> <given-names>R</given-names></name><name><surname>Halpern</surname> <given-names>Z</given-names></name><name><surname>Elinav</surname> <given-names>E</given-names></name><name><surname>Segal</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Personalized nutrition by prediction of glycemic responses</article-title><source>Cell</source><volume>163</volume><fpage>1079</fpage><lpage>1094</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.11.001</pub-id><pub-id pub-id-type="pmid">26590418</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.46923.018</object-id><sec id="s8" sec-type="appendix"><title>Model details</title><sec id="s8-1"><title>Qualitative or downstream effects of a step</title><p>In the most general formulation of our model first presented in the Results, we allow for the possibility that the protocol choice at a step influences the qualitative, as well as the quantitative, properties of the taxa. For instance, DNA extraction protocols yield differently fragmented DNA (<xref ref-type="bibr" rid="bib11">Costea et al., 2017</xref>), which may affect the bias of downstream steps such as PCR and sequencing. Therefore, the bias at a step in general will depend on the protocol for that step as well as for all previous steps. To make this dependence explicit, let <inline-formula><mml:math id="inf148"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt">â£</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denote the <inline-formula><mml:math id="inf149"><mml:mi>l</mml:mi></mml:math></inline-formula>-th step of protocol <inline-formula><mml:math id="inf150"><mml:mi>P</mml:mi></mml:math></inline-formula> performed after steps <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> through <inline-formula><mml:math id="inf152"><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> of protocol <inline-formula><mml:math id="inf153"><mml:mi>P</mml:mi></mml:math></inline-formula>. The bias of protocol <inline-formula><mml:math id="inf154"><mml:mi>P</mml:mi></mml:math></inline-formula> is then<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt">â£</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt">â£</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>â</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>â</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt">â£</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:mi mathvariant="normal">â¯</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Our core assumption is that the bias at each step is fixed within the context of the total protocol <inline-formula><mml:math id="inf155"><mml:mi>P</mml:mi></mml:math></inline-formula>, but independent of the composition of the sample. All properties and implications of bias or differential bias of the total protocols described in the main text are valid under this condition in the presence of such qualitative or downstream effects.</p><p>Downstream effects are important to consider, however, when attempting to estimate the bias of an individual step or protocol choice. Consider using differential bias to estimate the effect of DNA extraction protocol in the <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> experiment, where the protocols differ only at the extraction step. The differential bias between Protocols H and W, <inline-formula><mml:math id="inf156"><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mo>/</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, includes both the direct effect of the differential bias at the extraction step as well as the indirect downstream effects the extraction protocol has on later steps. Here we cannot distinguish the two, as estimating the size of indirect effects requires experiments where protocols at different steps are varied in a combinatorial fashion.</p><p>A different but related issue arises in our estimation of bias from different steps in the <xref ref-type="bibr" rid="bib7">Brooks et al.Â (2015)</xref> experiment. There, DNA extraction from pure cultures to create the DNA mixtures differed from extraction in the community samples (the cell mixtures). In order to estimate the bias during extraction, we must assume that there is no qualitative difference in the DNA, and so the bias of PCR, sequencing, etc. will be the same whether starting from the cell or the DNA mixtures. In other words, we must assume that the bias at a step <inline-formula><mml:math id="inf157"><mml:msub><mml:mi>P</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> is only a property of the individual step.</p></sec><sec id="s8-2"><title>Aggregates of taxa</title><p>Aggregating groups of taxa through the standard method of summing their abundances can cause bias to appear to vary among samples with different compositions. Consider four taxa with bias <inline-formula><mml:math id="inf158"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> such that Taxon 1 is in Phylum 1, Taxon 2 is in Phylum 2, and Taxon 3 and Taxon 4 are both in Phylum 3. In a sample with actual composition <inline-formula><mml:math id="inf159"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, the observed composition is <inline-formula><mml:math id="inf160"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. If we aggregate taxa within phyla by the standard method, we observe the phylum-level composition <inline-formula><mml:math id="inf161"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The bias we observe at the phylum level is<disp-formula id="equ15"><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The observed efficiency of Phylum 1 relative to Phylum 2 remains <inline-formula><mml:math id="inf162"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, independent of sample composition, but the efficiency of Phylum 3 relative to the other phyla depends on the relative abundances of Taxon 3 andÂ Taxon 4.</p><p>The above example illustrates the general result that if we sum taxa that differ in their efficiencies, bias will no longer be independent of composition. As a result, estimates of bias at the aggregate level may find bias to vary among samples and perturbation-invariant analyses applied to taxonomic aggregates may not be invariant to bias.</p><p>When our measurement has sufficient taxonomic resolution to distinguish taxa at the level at which bias is conserved, then we can overcome these limitations by using the compositional approach to combining elements, which involves multiplying rather than summing the elements within each group (<xref ref-type="bibr" rid="bib66">van den Boogaart and Tolosana-Delgado, 2013</xref>). For instance, if we multiply rather than sum taxa within a phylum we see that the error is again independent of composition,<disp-formula id="equ16"><mml:math id="m16"><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>â</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mo>â¢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>â</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>â</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Bias remains independent when individual taxa are replaced with products of taxa, and analyses that are perturbation invariant to bias on taxa will remain so when applied to taxa products. CoDA analyses that use this approach are typically based on <italic>balances</italic>, which are scaled and log-transformed ratios of the products of groups of taxa (<xref ref-type="bibr" rid="bib66">van den Boogaart and Tolosana-Delgado, 2013</xref>). Applications of balances to microbiome analyses are described in <xref ref-type="bibr" rid="bib58">Silverman et al. (2017)</xref> and <xref ref-type="bibr" rid="bib54">Rivera-Pinto et al. (2018)</xref>.</p></sec></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.46923.019</object-id><sec id="s9" sec-type="appendix"><title>Bias-estimation details</title><p>Bias estimation is complicated by the compositional nature of MGS measurement, particularly if different control samples contain different taxa. Because only relative abundances are measured, the measurement of a control sample <inline-formula><mml:math id="inf163"><mml:mi>s</mml:mi></mml:math></inline-formula> only provides information about the efficiencies of the taxa in the sample <italic>relative to each other</italic>. If we restrict our scope to a set of <inline-formula><mml:math id="inf164"><mml:mi>K</mml:mi></mml:math></inline-formula> possible taxa, then we can write the actual and observed compositions of <inline-formula><mml:math id="inf165"><mml:mi>s</mml:mi></mml:math></inline-formula> as <inline-formula><mml:math id="inf166"><mml:mi>K</mml:mi></mml:math></inline-formula>-element compositions denoted <inline-formula><mml:math id="inf167"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf168"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The measurement error can now be described by the compositional difference, <inline-formula><mml:math id="inf169"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="bold">ð</mml:mi></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which we denote <inline-formula><mml:math id="inf170"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Recall that the compositional difference is computed by element-wise division. If the sample <inline-formula><mml:math id="inf171"><mml:mi>s</mml:mi></mml:math></inline-formula> contains all taxaâthat is, if all of the elements of <inline-formula><mml:math id="inf172"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are positiveâthen <inline-formula><mml:math id="inf173"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is fully defined. But if <inline-formula><mml:math id="inf174"><mml:mi>s</mml:mi></mml:math></inline-formula> does not contain all taxa, then some of the elements of <inline-formula><mml:math id="inf175"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are <inline-formula><mml:math id="inf176"><mml:mrow><mml:mn>0</mml:mn><mml:mo>/</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> or undefined. The undefined elements of <inline-formula><mml:math id="inf177"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> indicate that the control measurement tells us nothing about the bias between the taxa that are in <inline-formula><mml:math id="inf178"><mml:mi>s</mml:mi></mml:math></inline-formula> and taxa that are not in <inline-formula><mml:math id="inf179"><mml:mi>s</mml:mi></mml:math></inline-formula>.</p><p>This appendix first summarizes concepts from the field of Compositional Data Analysis for computing the mean of a set of compositional vectors with undefined elements. These concepts allow us to equate the estimator of bias defined in <xref ref-type="disp-formula" rid="equ13">Equation 13</xref> with theÂ compositional mean, or <italic>center</italic>, of the compositional errors observed in the control samples,<disp-formula id="equ17"><label>(15)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¼</mml:mo><mml:mrow><mml:mi>cen</mml:mi><mml:mo>â¡</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We then describe the condition for sufficient taxonomic overlap among the control samples for this estimate to be fully defined. Finally, we describe a bootstrap procedure for approximating the sampling distribution of the center that can be used to estimate uncertainty in the bias estimate.</p><sec id="s9-1"><title>Distances and means in the compositional Aitchison geometry</title><p>The Aitchison geometry (<xref ref-type="bibr" rid="bib48">Pawlowsky-Glahn, 2015</xref>; <xref ref-type="bibr" rid="bib3">Aitchison, 2003</xref>, Chapter 2) defines a normed vector space for compositional vectors of a given length <inline-formula><mml:math id="inf180"><mml:mi>K</mml:mi></mml:math></inline-formula>, in which vector addition and subtraction are performed by element-wise multiplication and division and distance is measured according to the Aitchison norm. <xref ref-type="disp-formula" rid="equ11">Equation 11</xref> shows that the Aitchison norm of <inline-formula><mml:math id="inf181"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> grows with the pairwise ratios among the elements or, equivalently, with the ratios of the elements to their geometric mean. The distance between two compositions <inline-formula><mml:math id="inf182"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf183"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> in the Aitchison geometry is given by the Aitchison norm of their (compositional) difference and equals<disp-formula id="equ18"><label>(16)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo symmetric="true">â</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow></mml:mrow><mml:mo symmetric="true">â</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:munder><mml:mo>â</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>â¡</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo>=</mml:mo><mml:msqrt><mml:munderover><mml:mo>â</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>â¡</mml:mo><mml:mfrac><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>â</mml:mo><mml:mi>ln</mml:mi><mml:mo>â¡</mml:mo><mml:mfrac><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ18">Equation 16</xref> shows that the Aitchison distance between two compositions grows with the fold-difference in the element ratios between <inline-formula><mml:math id="inf184"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf185"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula>.</p><p>The compositional mean, or <italic>center</italic>, of a set <inline-formula><mml:math id="inf186"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>â£</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>â</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> of compositional vectors with no undefined elements is typically defined by their element-wise geometric mean (<xref ref-type="bibr" rid="bib66">van den Boogaart and Tolosana-Delgado, 2013</xref>, p. 74),<disp-formula id="equ19"><label>(17)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>cen</mml:mi><mml:mo>â¡</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>â¼</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>â</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>â</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>â¦</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>â</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>â</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf187"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the number of elements in the set <inline-formula><mml:math id="inf188"><mml:mi>S</mml:mi></mml:math></inline-formula>. Alternatively, we can define the center geometrically as the vector that minimizes the sum of squared distances between the compositions in <inline-formula><mml:math id="inf189"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> and their center (<xref ref-type="bibr" rid="bib49">Pawlowsky-Glahn and Egozcue, 2002</xref>),<disp-formula id="equ20"><label>(18)</label><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>â¼</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mo>â¡</mml:mo><mml:munder><mml:mo>â</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>â</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo symmetric="true">â</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow></mml:mrow><mml:mo symmetric="true">â</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In this way, the compositional mean can be seen to be directly analogous to the familiar mean in Euclidean geometry, which minimizes the sum of squared Euclidean distances between the vectors and their mean.</p><p>The geometric definition <xref ref-type="disp-formula" rid="equ20">Equation 18</xref> can be used even when some of the compositions have elements that are undefined, provided that we first define the Aitchison distance between vectors with undefined elements. In the scenario we are interested in, the elements of <inline-formula><mml:math id="inf190"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> are undefined because the taxa corresponding to these elements were not present in the sample <inline-formula><mml:math id="inf191"><mml:mi>s</mml:mi></mml:math></inline-formula>, leaving us with no information aboutÂ their ratios to the elements corresponding to the present taxa. It is therefore natural to compute the distance between <inline-formula><mml:math id="inf192"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> and a candidate estimate of the center <inline-formula><mml:math id="inf193"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> with <xref ref-type="disp-formula" rid="equ18">Equation 16</xref> restricted to just the defined elements. Equivalently, we can define the norm of <inline-formula><mml:math id="inf194"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¼</mml:mo><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="bold">ð</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> as the norm of the smallest-normed <inline-formula><mml:math id="inf195"><mml:mi>K</mml:mi></mml:math></inline-formula>-element vector that has the same ratios among the defined elements of <inline-formula><mml:math id="inf196"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula>. This definition of the norm amounts to computing the norm of the <inline-formula><mml:math id="inf197"><mml:msup><mml:mi>K</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>-element vector of the defined elements, as commented below <xref ref-type="disp-formula" rid="equ11">Equation 11</xref>. To see why, note that the smallest <inline-formula><mml:math id="inf198"><mml:mi>K</mml:mi></mml:math></inline-formula>-element vector consistent with <inline-formula><mml:math id="inf199"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> is given by setting the undefined elements of <inline-formula><mml:math id="inf200"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> equal to the geometric mean of the defined elements. When we compute its norm using the second form in <xref ref-type="disp-formula" rid="equ11">Equation 11</xref>, the logarithmic terms corresponding to these elements equal zero and so do not contribute to the sum.</p><p>This generalized definition of the norm now lets us use <xref ref-type="disp-formula" rid="equ20">Equation 18</xref> to define the center of a set of compositional vectors that may have undefined elements. This definition can be used to compute the center numerically by minimizing the sum of squared distances. However, <xref ref-type="bibr" rid="bib65">van den Boogaart et al. (2006)</xref> have developed an analytical approach based on projections of the log-transformed compositions; we refer readers to <xref ref-type="bibr" rid="bib65">van den Boogaart et al. (2006)</xref> and <xref ref-type="bibr" rid="bib6">Bren et al. (2008)</xref> for an explanation of this approach, which we use for all bias estimation in our analysis.</p></sec><sec id="s9-2"><title>Taxonomic overlap among control samples needed for a fully-determined bias estimate</title><p>Recall that the biasÂ <inline-formula><mml:math id="inf201"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is a compositional vector and so is defined only up to compositional equivalence, or an arbitrary positive constant multiplied by all elements. The bias estimate <inline-formula><mml:math id="inf202"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is uniquely determined (up to compositional equivalence) for all taxa present in at least one control sample only if there is sufficient taxonomic overlap among the samples. Here we explain the intuition for why this is the case and describe the general condition for sufficient overlap.</p><p>Suppose that there are two control samples; the first contains Taxon 1 and Taxon 2 and the second contains Taxon 3 and Taxon 4. Each sample allows us to learn the efficiencies of its taxa relative to others in that sample but not in the other sample. The first sample allows us to estimate <inline-formula><mml:math id="inf203"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and the second to estimate <inline-formula><mml:math id="inf204"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, but we cannot estimate <inline-formula><mml:math id="inf205"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. The situation improves if there is a third sample containing Taxon 2 and Taxon 4, allowing us to also estimate <inline-formula><mml:math id="inf206"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Now we can estimate <inline-formula><mml:math id="inf207"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> by the relation <inline-formula><mml:math id="inf208"><mml:mrow><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>With just the first two samples, the bias estimate <inline-formula><mml:math id="inf209"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is not well-defined. Because we have no information about the ratios between the two groups of taxa, we can always multiply the estimated efficiencies of one group (say, <inline-formula><mml:math id="inf210"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf211"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>) by a constant <inline-formula><mml:math id="inf212"><mml:mi>a</mml:mi></mml:math></inline-formula> while leaving the other group unchanged. The resulting distinct compositional vector would be just as consistent with the data from the control measurements in the sense that the residual sum of squared errors (RSS) would be unaffected. However, once we have the third sample, changing the ratios between the two groups of taxa in such a manner would increase the RSS and yield a worse estimate of the bias. Thus, with the inclusion of the third sample there is a unique estimate <inline-formula><mml:math id="inf213"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> that minimizes the RSS and the bias estimate is well-defined.</p><p>The general condition for determining if there is sufficient taxonomic overlap to uniquely determine <inline-formula><mml:math id="inf214"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> can be stated using the concept from network theory of a network component. A (<italic>connected</italic>) <italic>component</italic> of an undirected network is a subnetwork whose nodes are connected by paths through the network and are not connected to nodes in any other component (<xref ref-type="bibr" rid="bib46">Newman, 2010</xref>, p. 142). Define the <italic>taxon co-occurrence network</italic> as the network with taxa as nodes and undirected edges between any pair of taxa that co-occur in the same sample. Each component of the taxon co-occurrence network defines a set of taxa within which bias can be estimated, but for which the bias to other taxa cannot be estimated. Thus the estimate <inline-formula><mml:math id="inf215"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is uniquely determined if and only if the taxon co-occurrence network has a single component. When there are multiple components, the bias estimation method we have implemented (using the projection method of <xref ref-type="bibr" rid="bib65">van den Boogaart et al., 2006</xref>) resolves ambiguities by giving the value of <inline-formula><mml:math id="inf216"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> with the smallest Aitchison norm. The resulting estimate can still be used to analyze the bias as long as only the efficiency ratios between taxa that share a component are considered as having any meaning.</p></sec><sec id="s9-3"><title>Bootstrap method for estimating uncertainty in the bias</title><p>We describe two bootstrap (resampling) methods for estimating the uncertainty in the estimated bias. In the first method, based on the standard bootstrap introduced by <xref ref-type="bibr" rid="bib17">Efron (1979)</xref>, the weights assigned to the control measurements in each resampling are drawn from a multinomial distribution. In the second method, based on theÂ Bayesian bootstrap introduced by <xref ref-type="bibr" rid="bib56">Rubin (1981)</xref>, the weights are drawn from a Dirichlet distribution. The two methods give approximately the same standard errors if all samples contain all taxa, but the second method avoids a pathology of the first when different samples contain different taxa.</p><p>Each method works by approximating the sampling distribution of <inline-formula><mml:math id="inf217"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> by computing <inline-formula><mml:math id="inf218"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> for a large number, <inline-formula><mml:math id="inf219"><mml:mi>R</mml:mi></mml:math></inline-formula>, of resamplings of the observed compositional errors, <inline-formula><mml:math id="inf220"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="bold">ð</mml:mi></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. We first describe the multinomial resampling (standard bootstrap) method in the simple case where all control samples contain all taxa. In this method, a single bootstrap replicate consists of drawing <inline-formula><mml:math id="inf221"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> error measurements by sampling with replacement from <inline-formula><mml:math id="inf222"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> and computing the center of the resulting error measurements. Equivalently, we first draw a length-<inline-formula><mml:math id="inf223"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> vector <inline-formula><mml:math id="inf224"><mml:mi mathvariant="bold">ð°</mml:mi></mml:math></inline-formula> from a <inline-formula><mml:math id="inf225"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>Multinomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>â¦</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> distribution to specify the weights assigned to the <inline-formula><mml:math id="inf226"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> original measurements and compute the weighted center, <inline-formula><mml:math id="inf227"><mml:mrow><mml:mi>cen</mml:mi><mml:mo>â¡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="bold">ð°</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, defined by<disp-formula id="equ21"><label>(19)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>â¼</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mo>â¡</mml:mo><mml:munder><mml:mo>â</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>â</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo symmetric="true">â</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow></mml:mrow><mml:mo symmetric="true">â</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>From each bootstrap replicate <inline-formula><mml:math id="inf228"><mml:mi>r</mml:mi></mml:math></inline-formula> we obtain an estimate <inline-formula><mml:math id="inf229"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>cen</mml:mi><mml:mo>â¡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">ð°</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> of the bias that, because each sample contains all taxa, is necessarily a fully-determined <inline-formula><mml:math id="inf230"><mml:mi>K</mml:mi></mml:math></inline-formula>-element compositional vector.</p><p>We now use the approximate resampling distribution given by <inline-formula><mml:math id="inf231"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> for a large number of replicates (<inline-formula><mml:math id="inf232"><mml:mi>R</mml:mi></mml:math></inline-formula>) to estimate the uncertainty in <inline-formula><mml:math id="inf233"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. In order to respect the compositional nature of bias, we propose quantifying the uncertainty in <inline-formula><mml:math id="inf234"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> by the geometric (multiplicative) standard errors in the relative efficiencies of various taxa. In the tables and figures, we typically present bias relative to the average taxon, which amounts to dividing the relative efficiency of each taxon by the geometric mean efficiency of all taxa. To estimate the geometric standard errors of the relative efficiencies in this case, we first geometrically center the elements of each <inline-formula><mml:math id="inf235"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> (by taking <inline-formula><mml:math id="inf236"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mo>â¦</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>) and then compute the element-wise geometric standard deviations over the <inline-formula><mml:math id="inf237"><mml:mi>R</mml:mi></mml:math></inline-formula> replicates,<disp-formula id="equ22"><label>(20)</label><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mtext>gm.\ std.\ err.\ of\Â </mml:mtext><mml:mrow><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>â¡</mml:mo><mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>R</mml:mi><mml:mo>â</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>â</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>â¡</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>â</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>R</mml:mi></mml:mfrac><mml:munderover><mml:mo>â</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:mi>ln</mml:mi><mml:mo>â¡</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This standard error quantifies the uncertainty in the ratio of the efficiency of Taxon <inline-formula><mml:math id="inf238"><mml:mi>i</mml:mi></mml:math></inline-formula> to the geometric mean efficiency of all taxa. Other ratios are also useful for understanding the uncertainty in the estimated bias. For example, one can estimate the standard error in the bias between taxa <inline-formula><mml:math id="inf239"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf240"><mml:mi>j</mml:mi></mml:math></inline-formula> by the geometric standard deviation of <inline-formula><mml:math id="inf241"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> over the <inline-formula><mml:math id="inf242"><mml:mi>R</mml:mi></mml:math></inline-formula> replicates.</p><p>The above procedure can fail if different samples have different taxa. Multinomial resamplings typically leave out some samples and thus can lack sufficient taxonomic overlap to give a fully-determined bias estimate even if <inline-formula><mml:math id="inf243"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is fully determined. A simple way to overcome this problem is to instead use Dirichlet resampling, as in the Bayesian bootstrap (<xref ref-type="bibr" rid="bib56">Rubin, 1981</xref>). Procedurally, the Bayesian bootstrap proceeds like the weight-based formulation of the standard bootstrap given above, except that the weights <inline-formula><mml:math id="inf244"><mml:msub><mml:mi mathvariant="bold">ð°</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> are sampled from a <inline-formula><mml:math id="inf245"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>Dirichlet</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>â¦</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> distribution rather than the multinomial distribution. Each sample now receives a positive weight (with probability 1), ensuring that each replicate estimate <inline-formula><mml:math id="inf246"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> is fully determined so long as <inline-formula><mml:math id="inf247"><mml:mover accent="true"><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is. We can then proceed to compute compositional standard errors as before. The Dirichlet and multinomial weights of the two methods have the same expected value and approximately the same variance (<xref ref-type="bibr" rid="bib56">Rubin, 1981</xref>). Consequently, the two methods will give approximately the same standard errors when all samples have all taxa.</p><p>To determine how much the precision of the bias estimate for Protocol H of <xref ref-type="bibr" rid="bib11">Costea et al. (2017)</xref> varied with the number of control samples (<xref ref-type="fig" rid="fig4s1">Figure 4âfigure supplement 1</xref>), we computed standard errors using the multinomial-weighted bootstrap method with the number of trials in the multinomial distribution equal to the specified number of control samples. That is, to estimate the precision associated with a given number <inline-formula><mml:math id="inf248"><mml:mi>n</mml:mi></mml:math></inline-formula> of control samples (<inline-formula><mml:math id="inf249"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mo>â¤</mml:mo><mml:mi>n</mml:mi><mml:mo>â¤</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), we drew the length-<inline-formula><mml:math id="inf250"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> weight vector <inline-formula><mml:math id="inf251"><mml:mi mathvariant="bold">ð°</mml:mi></mml:math></inline-formula> from a <inline-formula><mml:math id="inf252"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>Multinomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>â¦</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> distribution.</p></sec></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.46923.026</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Turnbaugh</surname><given-names>Peter</given-names></name><role>Reviewing Editor</role><aff><institution>University of California, San Francisco</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Turnbaugh</surname><given-names>Peter</given-names> </name><role>Reviewer</role><aff><institution>University of California, San Francisco</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Quince</surname><given-names>Christopher</given-names> </name><role>Reviewer</role><aff><institution>University of Warwick</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Gibbons</surname><given-names>Sean</given-names> </name><role>Reviewer</role><aff><institution/></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Consistent and correctable bias in metagenomic sequencing experiments&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Peter Turnbaugh as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Wendy Garrett as the Senior Editor. The following individuals involved in review of your submission have also agreed to reveal their identity: Christopher Quince (Reviewer #2); Sean Gibbons (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>The independent replication of microbiome research can produce very different results due to biases inherent in different protocols for studying complex microbial communities. Here, McLaren, Willis, and Callahan focus on multiplicative biases in microbiome experiments and quantify their effect on distorting the resulting abundance distributions. The authors formulate a rigorous framework in treating multiplicative biases based on individual protocol steps and derive a correction of that bias. Application of their correction methods to two mock community data sets validates their findings and provides improved estimates of microbial abundances. Together, this work provides an important framework to begin to more robustly compare data across experiments and research groups. This work is incredibly timely and provides a significant advance in our understanding of biases in microbiome data and a framework that will be built on to address them in the future.</p><p>Essential revisions:</p><p>1) The github repository is great but might not be enough of a tutorial for inexperienced users. I'd recommend writing a step by step tutorial (a la http://qiime.org/tutorials/).</p><p>Also, are there any plans in place to update this code as new approaches become available? It may also help to name the package/tool.</p><p>2) More discussion is needed regarding the propagation of noise or errors across multiplicative factors as opposed to bias. For instance, is noise in the extraction protocol more important than PCR because it occurs earlier? Or are the errors simply multiplicative too so that there is no purpose in trying to reduce noise in the earlier steps? In any case noise is perhaps more important than bias as it cannot be corrected so in their Tables 1 and 2 it would be good to have an estimate of the average error associated with each protocol. In some cases, a more biased but reproducible protocol could be preferable.</p><p>3) Both data sets used by the authors are derived from mock communities with known ground truth. The authors argue that their methods can be used even in the absence of a ground truth by using relative efficiencies. I feel that this is an important use case for real-world data sets. Standard communities, including all/most of the detected taxa across a set of real-world samples, are usually not available for any given microbiome study. Here, one could still estimate relative efficiencies by using technical replicates (samples co-processed across batches â how many samples need to be co-processed across batches for this approach to be useful?). However, that particular use case is discussed only briefly and there is no quantitative study with any data set that is not a mock data set. I feel that inclusion of a non-mock data set with technical replicates may be more informative here since that is closer to most published microbiome data sets. Based on that the authors could formulate a protocol that can be proposed for future microbiome experiments and that would allow systematic elimination of multiplicative biases. One challenge I foresee is that relative efficiencies will be very difficult to estimate for low-abundance taxa that are often unique to a small number of samples, unless every sample is processed across all batches.</p><p>4) The authors start by arguing that major biases should be multiplicative. Even though they provide a wide array of references describing the existence of bias in microbiome assays, there is no reference that supports the assumption that the strongest bias has to be multiplicative. This is addressed later in the manuscript by showing that multiplicative bias captures the error in mock communities well and by stating this multiplicative limitation in the Discussion. I would have liked a more systematic study of the potential magnitudes of multiplicative vs. additive/other biases.</p><p>a) For instance, what is the amount of variance explained by multiplicative bias vs. potentially additive biases (e.g. saturating effects, contamination from external sources, or well-to-well contamination)? I would expect that additive biases, like well-to-well contamination, to be more important in low-biomass samples. Further discussion of this point would be useful.</p><p>b) In the two data sets analyzed in this study the authors removed contamination manually. However, this approach likely won't be possible for non-mock data.</p><p>c) All bias estimates reported in the text are usually reported without dispersion measures, even though the formulated point estimate should induce an appropriate dispersion measure as well. It would be interesting to see how much uncertainty there is regarding the bias as a function of samples used for correction. This could aid in determining how many samples should be used to estimate the bias.</p><p>5) It would be worthwhile to discuss the observed bias structure with other data transformations (not only the ones from compositional data analysis). For instance, Equation 7 essentially makes fold changes of the same taxon across samples invariant to the bias. This would mean that the established transformation from RNA-seq analysis would also be applicable here (log-transformation and comparison by log-fold change rather than absolute difference).</p><p>6) I feel that some further investigation into correlations of the identified biases with taxonomy may be helpful to gain mechanistic insight into the sources of bias. For instance, does the bias correlate with the abundance of the taxon, or do phylogenetically similar taxa show similar biases? This could help to formulate strategies for estimating bias for taxa that are undetected in the batch replicates. The authors also argue that summarization of taxa into higher phylogenetic ranks may introduce additional errors, but they do not state which rank is permissible here (species, genus, family?).</p><p>The reviewers were all enthusiastic about publication and realize that all of these points may be difficult to accomplish within the next couple months. We would encourage the authors to use their best judgement in deciding what can be addressed in a substantive way and which points would be best addressed with additional discussion.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.46923.027</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) The github repository is great but might not be enough of a tutorial for inexperienced users. I'd recommend writing a step by step tutorial (a la http://qiime.org/tutorials/).</p><p>Also, are there any plans in place to update this code as new approaches become available? It may also help to name the package/tool.</p></disp-quote><p>We agree with the reviewers that a more accessible and better documented R package would be useful, and have now created a named package and a step-by-step tutorial.</p><p>We split off the generically useful functions into an R package called âmetacalâ (for âmetagenomics calibrationâ), hosted on Github at https://github.com/mikemc/metacal. This package should be considered âalphaâ but contains functions that can be used to measure bias in quality-control experiments that include samples of known composition. The GitHub Issues tracker will host discussions about the needs of potential users. We will update this package as we develop improved estimation and calibration methods.</p><p>We have added a tutorial to the R package that takes users through the process of estimating bias and performing calibration in the special case where the bias of all taxa can be directly measured from the control samples. The tutorial is viewable online at https://mikemc.github.io/metacal/articles/tutorial.html. We plan to expand upon this tutorial as we further our methods.</p><p>We have also taken several steps during the revision that make the package a more robust and useful tool for analyses beyond the present manuscript. In particular, we have:</p><list list-type="bullet"><list-item><p>Added functions to facilitate computing ratio-based statistics and diagnostic plots;</p></list-item><list-item><p>Added a bootstrap procedure for estimating uncertainty in bias estimates (now described in Appendix 2 section âBootstrap method for estimating uncertainty in the biasâ);</p></list-item><list-item><p>Implemented an analytical solution to the bias estimator for the case where different samples have different taxa, which is much faster than our previous optimization method and allows fast bootstrapping (described in Materials and methods section âBias estimationâ and motivated in Appendix 2 section âDistances and means in the compositional Aitchison geometryâ);</p></list-item><list-item><p>Added functions to check if there is sufficient taxonomic overlap among the control samples to obtain a fully determined bias estimate, or to find the disjoint groups of taxa within which bias can be estimated (fully explained in Appendix 2 section âTaxonomic overlap among control samples needed for a fully-determined bias estimateâ).</p></list-item></list><p>Each of these features is demonstrated in the tutorial.</p><disp-quote content-type="editor-comment"><p>2) More discussion is needed regarding the propagation of noise or errors across multiplicative factors as opposed to bias. For instance, is noise in the extraction protocol more important than PCR because it occurs earlier? Or are the errors simply multiplicative too so that there is no purpose in trying to reduce noise in the earlier steps? In any case noise is perhaps more important than bias as it cannot be corrected so in their Tables 1 and 2 it would be good to have an estimate of the average error associated with each protocol. In some cases, a more biased but reproducible protocol could be preferable.</p></disp-quote><p>We have now added a measure of multiplicative noise to Tables 1 and 2 and described this measure and its application to the Costea et al. (2017) experiment in the second paragraph of the subsection âBias measurement as a means of evaluating and improving protocolsâ. To allow direct comparison, we now use the analogous measure of bias instead of the previously used geometric standard deviation, although the new measure has a similar interpretation. In the Brooks et al. (2015) experiments (Table 1), we see the highest noise in the PCR mixtures, which is likely due to random error during sample construction resulting in imprecise estimates of the actual compositions, rather than noise during the MGS measurement. In the Costea et al. experiment (Table 2), the noise is smaller for protocols that preferentially measured the spike-in, suggesting that limited sequencing depth or other discrete-sampling effects may be having an effect.</p><p>Our quantification of noise assumes a multiplicative model of noise, and found that it gave reasonable results consistent with our expectations (e.g. noise &lt;&lt; bias in most cases). However, we have not proven that all sources of noise in MGS measurements are multiplicative. Some noise mechanisms are likely to be well-modeled as multiplicative. For example, PCR amplification efficiencies may vary based on location of the PCR tube in the PCR machine, introducing random variation in a multiplicative factor (the efficiencies) that is independent of the sampleâs composition. However, at least one source of noise is known to not be well-modeled as multiplicative: the random variation around the relative abundances introduced by the sequencing sampling process is larger and more asymmetric for rare taxa.</p><p>In general, we expect that noise will be reasonably modeled as multiplicative for reasonably abundant taxa. This means that, as the reviewers noted, the effect of multiplicative noise will be the same whether it arises in an early step or a late step. However, further investigation is warranted, and we expect at a minimum that a proper accounting for the non-multiplicative noise introduced by the generation of discrete sequencing reads will be necessary for robust bias estimation in low abundance taxa.</p><disp-quote content-type="editor-comment"><p>3) Both data sets used by the authors are derived from mock communities with known ground truth. The authors argue that their methods can be used even in the absence of a ground truth by using relative efficiencies. I feel that this is an important use case for real-world data sets. Standard communities, including all/most of the detected taxa across a set of real-world samples, are usually not available for any given microbiome study. Here, one could still estimate relative efficiencies by using technical replicates (samples co-processed across batches â how many samples need to be co-processed across batches for this approach to be useful?). However, that particular use case is discussed only briefly and there is no quantitative study with any data set that is not a mock data set. I feel that inclusion of a non-mock data set with technical replicates may be more informative here since that is closer to most published microbiome data sets. Based on that the authors could formulate a protocol that can be proposed for future microbiome experiments and that would allow systematic elimination of multiplicative biases. One challenge I foresee is that relative efficiencies will be very difficult to estimate for low-abundance taxa that are often unique to a small number of samples, unless every sample is processed across all batches.</p></disp-quote><p>We agree with the reviewers that the restriction of our analyses to mock communities is a major limitation of the present study. We are actively working towards demonstrating the utility of our methods on natural samples from other experiments, with the ultimate goal of formulating protocols for both mock and non-mock calibration in future microbiome experiments. However, we determined that a thorough investigation of differential bias in natural samples would require follow-up article(s) for reasons we outline below.</p><p>First, as the reviewers noted, most species are not present in most samples in real-world datasets, and many of the taxa that are present are at very low abundances. These complications make robust estimation of the relative efficiencies more difficult in natural samples than in controls. Second, consistent matching between the taxa identified by different protocols is challenging in natural samples in which many similar taxa may be present. Consider a set of <italic>E. coli</italic> and <italic>Shigella flexneri</italic> strains that are present in the real-world dataset. The way that a 16S rRNA protocol and a shotgun metagenomics protocol will divide these strains into taxonomic units will be different, and matching between the taxonomic units derived from different MGS protocols can be surprisingly challenging. This issue is avoided in control samples that contain collections of strains that are taxonomically well-separated. Third, most currently available datasets that could be used for investigating differential bias (i.e. that contain multiple samples measured by different MGS protocols) do not include technical replicate measurements, which are necessary to be able to distinguish inconsistent bias from contamination, random error, or sample mislabeling. For example, such technical replicate measurements of the same samples are not present in the Costea et al. (2017) dataset we analyzed, which otherwise would be a useful dataset for investigating differential bias in the natural fecal portion of the measured communities. We believe that the problems posed by noise, contamination, and taxonomic matching in real-world datasets can be overcome by more careful modeling and data curation, but require further substantial work and dataset development that would overly complicate the present manuscript.</p><p>Despite these challenges, we believe that differential bias is a non-obvious concept that is critical for understanding and developing methods to reduce technical disagreement between studies, and that it is therefore worth introducing in this manuscript. In order to better support its practical utility given the reviewersâ concerns, we expanded the illustration of differential bias in the revised manuscript: 1) We added the spike-in contaminant in the Costea et al. (2017) experiment to Figure 4B to illustrate how a consistent differential bias can be observed even when the true abundance of the taxon is unknown (subsection âMetagenomic sequencing of fecal samples with a spike-in mock communityâ, last paragraph). 2) We added estimates of differential bias between the Costea et al. (2017) protocols including the contaminant taxon to Table 2. While not equivalent to demonstration on a completely natural community, we believe this at least shows the utility of differential bias in the case where true abundances are not known.</p><disp-quote content-type="editor-comment"><p>4) The authors start by arguing that major biases should be multiplicative. Even though they provide a wide array of references describing the existence of bias in microbiome assays, there is no reference that supports the assumption that the strongest bias has to be multiplicative. This is addressed later in the manuscript by showing that multiplicative bias captures the error in mock communities well and by stating this multiplicative limitation in the Discussion. I would have liked a more systematic study of the potential magnitudes of multiplicative vs. additive/other biases.</p><p>a) For instance, what is the amount of variance explained by multiplicative bias vs. potentially additive biases (e.g. saturating effects, contamination from external sources, or well-to-well contamination)? I would expect that additive biases, like well-to-well contamination, to be more important in low-biomass samples. Further discussion of this point would be useful.</p></disp-quote><p>Note: To be consistent with the manuscript, we use the term âbiasâ exclusively for the systematic error caused by differences in the measurement efficiency among taxa.</p><p>Our aim has been to determine how the error due to bias behaves and can be addressed. In particular, we do not consider error due to contamination and taxonomic misassignment, which can lead to measurements of taxa not actually in the sample and cannot be expressed in our simple multiplicative framework. These other sources of error may be more important than bias in some contexts and efforts to obtain accurate and reproducible metagenomics measurements must ultimately grapple with all three types of error. We have added a paragraph to the Discussion (subsection âLimitations and Next Stepsâ) to clarify the potential for contamination to limit effective application of the present work. In this response, we discuss further the role of contamination in obtaining quantitative measurements of community differences. We discuss practical solutions for dealing with contamination in our response to 4 b).</p><p><bold>Contamination:</bold> Like bias, contamination (either from the lab environment or reagents or cross-contamination between samples) is a ubiquitous source of systematic error in metagenomics experiments. Whether bias or contamination is more important will depend on the experimental platform and system and the specific goals of the experiment. For example, contamination will increase in importance for sequencing platforms with high rates of index/barcode switching, for low biomass samples, and for downstream analyses that are sensitive to taxa found in very small proportions. The measures we propose for quantifying bias are challenged by the presence of contamination, as evidenced by the fact that an arbitrary amount of contamination from a taxon not in the sample yields an infinite multiplicative error. Future work that incorporates our bias model with models of contamination can lead to improved measurement of each error type and improved understanding of the joint error process in applications. We have summarized these points in the Discussion subsection âLimitations and Next Stepsâ.</p><p><bold>Saturation and other systematic variation in taxon efficiencies:</bold> Saturation â where a taxonâs efficiency decreases with its relative or absolute abundance in the sample â is a special case of the relative efficiencies systematically depending on sample composition. The residual compositional errors, <inline-formula><mml:math id="inf253"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>Ïµ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>â¼</mml:mo><mml:mrow><mml:mi mathvariant="bold">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>â</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, include systematic and random variation in the efficiencies and so place an upper bound on the strength of such effects. With the exception of the Brooks et al. (2015) PCR-product mixtures, the residuals are much smaller than the bias (Figure 3âfigure supplement 1; Figure 4âfigure supplement 1), and the large residuals in the PCR-product mixtures can plausibly be explained by random sample construction error. These observations indicate that saturation or other systematic variation in the bias is not significant in the experiments we analyzed. It is possible that saturation would become apparent in samples with more extreme variation in taxon abundances, we note one potential example of this (Thomas et al., 2016) in the Discussion and further testing is warranted. Our model can serve as a null model for future researchers to look for such effects in their own protocols; since it properly accounts for compositionality, deviations from our model can correctly be interpreted as efficiencies varying with sample composition. Protocol design should strive for consistent efficiencies, which is likely to be much more attainable than eliminating bias.</p><disp-quote content-type="editor-comment"><p>b) In the two data sets analyzed in this study the authors removed contamination manually. However, this approach likely won't be possible for non-mock data.</p></disp-quote><p>Removal of contamination is indeed more difficult in natural control samples where the true taxa present in the sample are not known a priori. However, removal of contamination using current practices â such as filtering out taxa below a minimum frequency above which out-of-sample contribution is assumed negligible or applying a specialized contamination-removal procedure (Davis et al., 2018; Larsson et al., 2018) â can be used instead of manual removal. Because our model and method for estimating bias consider only the ratios among taxa, they apply equally well to arbitrary subcompositions of taxa from each sample. Therefore, one can restrict to the taxa in each sample one is confident are not contaminants and proceed to estimate bias from these subcompositions with the methods we describe. Future Bayesian or maximum-likelihood methods that jointly model contamination and bias may make it possible to avoid the loss of information associated with current contaminant filtering approaches. We have summarized these points in the Discussion subsection âLimitations and Next Stepsâ.</p><disp-quote content-type="editor-comment"><p>c) All bias estimates reported in the text are usually reported without dispersion measures, even though the formulated point estimate should induce an appropriate dispersion measure as well. It would be interesting to see how much uncertainty there is regarding the bias as a function of samples used for correction. This could aid in determining how many samples should be used to estimate the bias.</p></disp-quote><p>We agree with the reviewers that applications of bias estimation should account for uncertainty in the estimated bias, and understanding of the structure of this uncertainty for different control-sample designs should inform experimental planning. Towards these ends, we have taken several steps in this revision.</p><p>We now implement a bootstrap procedure for estimating the uncertainty in the estimate of bias. This procedure is described in Appendix 2 section âBootstrap method for estimating uncertainty in the biasâ, implemented in the R package, and demonstrated in the tutorial. We are developing more sophisticated maximum-likelihood and Bayesian estimation procedures that we plan to add R package and tutorials in the future and that overcome some limitations of our bootstrap method (namely, not accounting for sequencing depth and potentially suboptimal performance when different control samples contain different taxa).</p><p>In the online R Markdown documents, we use the bootstrap procedure to estimate standard errors for all bias estimates reported in the manuscript. Due to the large sample size of these experiments, the standard errors are small relative to the estimated bias parameters and we exclude them from the tables for clarity. Standard errors for the estimated bias for the Costea et al. (2017) experiment are plotted in Figure 4âfigure supplement 1 and for the estimated bias of individual workflow steps for the Brooks et al. (2015) experiment in Figure 6.</p><p>We also examined how the precision of the bias estimate varies with number of control samples for the protocol with an intermediate degree of noise (Protocol H) in the Costea et al. (2017) experiment. To estimate the (geometric) standard errors for N control samples (from N=1 to N=9), we performed multinomial bootstrap resampling of N samples and computed the geometric standard deviation of the resulting efficiency estimates. Figure 5âfigure supplement 1 shows the resulting geometric standard errors as a function of N, alongside the observed compositions for help in interpretation. This figure and analysis is discussed in the subsection âCalibrationâ. When noise in the controls is much lower than bias, as it is here, measuring just 1 control sample gives a sufficiently accurate estimate to be useful in calibration. However, multiple samples are needed to allow estimating uncertainty and may be essential if âheavy-tailâ random errors are common (such as those seen in two samples in the figure).</p><disp-quote content-type="editor-comment"><p>5) It would be worthwhile to discuss the observed bias structure with other data transformations (not only the ones from compositional data analysis). For instance, Equation 7 essentially makes fold changes of the same taxon across samples invariant to the bias. This would mean that the established transformation from RNA-seq analysis would also be applicable here (log-transformation and comparison by log-fold change rather than absolute difference).</p></disp-quote><p>Equation 6 and Equation 7 demonstrate that bias cancels out in analyses based on fold changes (FCs) in the ratios of taxa. However, bias does not cancel out in non-ratio based analyses due to the reasons stated in the section âSystematic error in taxon ratios, but not in taxon proportions, is independent of sample compositionâ. Here we present the general result for the error in the estimated proportional FC of a taxon between two samples, which provides a direct point of comparison to Equation 6 and Equation 7. From Equation 4, we have that the proportional FC of taxon <inline-formula><mml:math id="inf254"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> from sample <inline-formula><mml:math id="inf255"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to sample <inline-formula><mml:math id="inf256"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is<disp-formula id="equ24"><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>â</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:munder><mml:mo>â</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>â</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:munder><mml:mo>â</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>â</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>â</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo>â</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The bias partially cancels, but not fully, due to the dependence of the observed proportions on the sample mean efficiency (SME); the result is an error in the estimated proportional FC equal to the reciprocal of the FC in the SME. This can even results in a sign if the true proportional FC of a taxon is smaller than and opposing the FC in the SME. We give a numerical example of such a sign error for Taxon 3 in Figure 2 (subsection âAnalyses based on fold-changes in taxon ratios are insensitive to bias, while analyses based on taxon proportions can give spurious resultsâ, first paragraph) where the taxon is observed to have a proportional FC greater than 1 but in fact has a proportional FC that is less than 1. In a recent paper, Kevorkian et al. (2018) suggested that bias cancels when computing the proportional FC between samples. However, their derivation did not properly account for the compositional nature of MGS measurements, which causes the appearance of the sample mean efficiency in our Equation 4 but that is missing in their Equation 3.</p><p>Whether spurious associations (or missed true associations) are a serious worry in applications appears to us an open question. It is easy to come up with examples of spurious associations in a given taxon due to another taxon changing from high to low frequency between samples (such as Taxon 1 in Figure 2; see also Brooks, 2016, p. 338). Such large single-species changes might be uncommon in some ecosystems; but large phylum-level changes could similarly cause spurious results if speciesâ efficiencies are similar within the phylum. On the other hand, it is possible that the SME is fairly stable across samples. In this case, the partial canceling may be sufficient for accurate estimates of differential abundance. Because the observed FCs of all taxa are multiplied by the same error term, the observed log-FCs remain correlated with the actual log-FCs. A plot of observed vs. actual log-FCs will appear systematically shifted from the y = x line by the log-FC in the SME; but such a shift might often be obscured in real data by noise. This result could explain the high correlation and apparent lack of a systematic shift seen in D'Amore et al. (2016) Figure 7, which considers this relationship for the FCs in proportions between two DNA mock communities. Thus determining the conditions in which bias causes spurious taxonomic associations remains an important line of future work.</p><p>Other non-ratio-based transformations currently employed in RNA-seq and microbiome differential-abundance analysis, such as rank transformation and quantile normalization, face a similar problem. However, the practical implications of bias for such analyses again remain unclear and requires further consideration via theory and/or simulation, for which our model can provide a conceptual foundation.</p><disp-quote content-type="editor-comment"><p>6) I feel that some further investigation into correlations of the identified biases with taxonomy may be helpful to gain mechanistic insight into the sources of bias. For instance, does the bias correlate with the abundance of the taxon, or do phylogenetically similar taxa show similar biases? This could help to formulate strategies for estimating bias for taxa that are undetected in the batch replicates. The authors also argue that summarization of taxa into higher phylogenetic ranks may introduce additional errors, but they do not state which rank is permissible here (species, genus, family?).</p></disp-quote><p>We agree that understanding the extent to which bias is conserved among phylogenetically similar species is critical for understanding the causes and consequences of bias and for developing practical estimation and correction methods. The patterns we observe provide some anecdotal evidence about the nature of phylogenetic conservation of bias. For example, the variation in efficiencies seen among the five Firmicute species in the Costea et al. (2017) experiment shows that bias is not universally conserved at the phylum level and may pose a problem for analyses based on Phylum-level aggregation (as noted in the third paragraph of the Discussion). As further evidence, we visualized differential bias against phylogeny for the spike-in taxa in the Costea et al. (2017) experiment including the contaminant <italic>Shigella flexneri</italic>, (see <xref ref-type="fig" rid="respfig1">Author response image 1</xref>). <xref ref-type="fig" rid="respfig1">Author response image 1</xref> shows that the three most closely related species â <italic>S. flexneri, S. enterica</italic>, and <italic>Y. pseudotuberculosis â</italic> have very similar relative efficiencies. These three taxa are all within the family <italic>Enterobacteriaceae</italic>. On the other hand, the next two most closely related species, <italic>B. hansenii</italic> and <italic>C. saccharolyticum</italic> in the family <italic>Lachnospiraceae</italic>, do not have similar relative efficiencies. Thus these results are ambiguous regarding how conserved bias is at the family level.</p><fig id="respfig1"><object-id pub-id-type="doi">10.7554/eLife.46923.021</object-id><label>Author response image 1.</label><caption/><graphic mime-subtype="png" mimetype="image" xlink:href="elife-46923-resp-fig1-v1"/></fig><p>Our ability to draw firm conclusions about the phylogenetic conservation of bias is limited by the small number of taxa in these datasets. For instance, only two taxa in the Brooks et al. (2015) dataset, <italic>L. iners</italic> and <italic>L. crispatus</italic>, share a genus, while none of the spike-in taxa in the Costea et al. (2017) experiment do. Our future plans include using additional mock and non-mock datasets to estimate the phylogenetic conservation of bias more broadly, so as to give more concrete guidance on when bias is (or is not) likely to remain consistent when aggregating at a given taxonomic level.</p><p>Certain phenotypes are known to interact mechanistically with the MGS measurement process to introduce bias. In this revision, we improved our analysis of the relationship between bias and one such phenotype â 16S copy number (CN) â by performing a more rigorous estimation of CN (described in Materials and methods subsection âData and analysis code availabilityâ and shown in an R-markdown document online) and improving the figure showing the relationship between bias and CN (Figure 6âfigure supplement 1). Previously we followed Brooks et al. (2015) in basing our estimates of 16S CN on RefSeq annotations for the given species. We have now revised our CN estimates for <italic>A. vaginae</italic> from 1 to 2 and for <italic>L. iners</italic> from 1 to 5 (Table 3). Previously 16S CN did not predict total bias or PCR bias, and that 16S CN correction actually made the estimated proportions worse than no correction in both cell and DNA mixtures. With these new numbers, we find that 16S CN variation explains a substantial amount of estimated PCR bias and that CN correction substantially improves the estimated proportions for the DNA mixtures. We thus substantially revised our previous conclusion that CN does not explain PCR bias in this experiment; however, it remains that CN explains at best a small fraction of total bias. These new results are reflected in the last paragraph of the Results subsection âBias measurement as a means of evaluating and improving protocolsâ and reflected in the improved fit in the middle column of Figure 3âfigure supplement 2. Investigation of other potential phenotypic predictors of bias is of interest, but we are again limited in our ability to systematically survey potentially relevant phenotypes by the limited number of taxa in our datasets.</p></body></sub-article></article>