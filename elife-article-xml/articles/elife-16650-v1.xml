<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">16650</article-id><article-id pub-id-type="doi">10.7554/eLife.16650</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Short Report</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Breaking down hierarchies of decision-making in primates</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-21200"><name><surname>Hyafil</surname><given-names>Alexandre</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0566-651X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-53062"><name><surname>Moreno-Bote</surname><given-names>Rubén</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>CBC, DTIC, Universitat Pompeu Fabra</institution>, <addr-line><named-content content-type="city">Barcelona</named-content></addr-line>, <country>Spain</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Serra Húnter Fellow Programme</institution>, <institution>Universitat Pompeu Fabra</institution>, <addr-line><named-content content-type="city">Barcelona</named-content></addr-line>, <country>Spain</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Gold</surname><given-names>Joshua I</given-names></name><role>Reviewing editor</role><aff><institution>University of Pennsylvania</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>alexandre.hyafil@gmail.com</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>26</day><month>06</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e16650</elocation-id><history><date date-type="received"><day>05</day><month>04</month><year>2016</year></date><date date-type="accepted"><day>24</day><month>03</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Hyafil et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Hyafil et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-16650-v1.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="article-reference" xlink:href="10.7554/eLife.17331"/><abstract><object-id pub-id-type="doi">10.7554/eLife.16650.001</object-id><p>Possible options in a decision often organize as a hierarchy of subdecisions. A recent study concluded that perceptual processes in primates mimic this hierarchical structure and perform subdecisions in parallel. We argue that a flat model that directly selects between final choices accounts more parsimoniously for the reported behavioral and neural data. Critically, a flat model is characterized by decision signals integrating evidence at different hierarchical levels, in agreement with neural recordings showing this integration in localized neural populations. Our results point to the role of experience for building integrated perceptual categories where sensory evidence is merged prior to decision.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16650.001">http://dx.doi.org/10.7554/eLife.16650.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.16650.002</object-id><title>eLife digest</title><p>Should you go for coffee with Jules, or go to the movie theater with Jim? Both options require you to make additional decisions, for example, which café would you go to, or what movie could you see? Many of our day-to-day decisions have multiple layers of sub-decisions embedded within them that are not necessarily independent. Our opinions of the cafés in town and the movies showing at the theater may influence our decision over whom to spend the afternoon with.</p><p>In 2015, researchers at the Netherlands Institute for Neuroscience performed experiments in macaques to try to work out how the brain makes these decisions. The monkeys learned to choose between two visual stimuli (decision 1). The outcome of decision 1 determined whether the animals then had to make decision 2 or decision 3. The results suggested that the monkeys initially made all three comparisons independently and in parallel, before combining the evidence to select their overall strategy. This process is referred to as hierarchical decision-making. In the analogy above, one would compare the relative merits of Jules versus Jim, café A versus café B, and a horror movie versus a comedy at the same time before deciding what to do.</p><p>Hyafil and Moreno Bote have now reanalyzed the data published in 2015 using new computer simulations. This second analysis suggests the results are in fact more consistent with an alternative model of decision-making called a flat model, in which the brain compares all of the final options simultaneously (Jules + café A; Jules + café B; Jim + horror movie; Jim + comedy) before choosing between them.</p><p>Making decisions by comparing the final outcomes becomes easier as the brain learns through experience to associate stimuli that often occur together. Hyafil and Moreno Bote hypothesize that in response to a new situation, the brain may sometimes start off by using hierarchical decision-making before switching to a more accurate flat model as experience allows.</p><p>In response to the findings of Hyafil and Moreno Bote, the researchers who conducted the work reported in 2015 have also reanalyzed the original data, and carried out a new experiment in human volunteers. They argue that the flat model provides a poor fit to the original data and struggles to explain the new data. Future studies can build on these conflicting findings by further exploring the limits of parallel decision-making, which may help us to understand how the brain is able to make multiple decisions while keeping the future consequences in mind.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16650.002">http://dx.doi.org/10.7554/eLife.16650.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>perception</kwd><kwd>decision-making</kwd><kwd>computational model</kwd><kwd>perceptual accumulation</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>Rhesus macaque</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000780</institution-id><institution>European Commission</institution></institution-wrap></funding-source><award-id>Marie Curie IEF - CEMNET (agreement 629613)</award-id><principal-award-recipient><name><surname>Hyafil</surname><given-names>Alexandre</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003329</institution-id><institution>Ministerio de Economía y Competitividad</institution></institution-wrap></funding-source><award-id>PSI2013-44811-P</award-id><principal-award-recipient><name><surname>Moreno-Bote</surname><given-names>Rubén</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Computational modeling of behavioral and neural data from monkeys points towards a flat decision-making process in which the brain considers all possible final outcomes simultaneously.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Coffee with Jules (if so, which cafe?) or cinema with Jim (if so, what movie?) ? A recent study by Lorteije and colleagues investigated how perceptual mechanisms implement such hierarchically-structured decisions that fill up our daily lives (<xref ref-type="bibr" rid="bib10">Lorteije et al., 2015</xref>). Monkeys performed saccades to one of 4 possible targets based on the information provided at the primary branching and at secondary branching points (the 'correct' and 'incorrect' branching points) leading to the targets (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Patterns of responses convincingly indicated that monkeys can integrate information from all branching points in parallel. But does the decision space mimic the hierarchical organization, with parallel decisions going on (about Jules/Jim, coffee place, movie) (<xref ref-type="fig" rid="fig1">Figure 1B</xref>), or does it directly compare final options (with Jules at Moe's vs. Sicario with Jim vs. etc.)(<xref ref-type="fig" rid="fig1">Figure 1C</xref>)? Lorteije and colleagues report two behavioral and two neural effects that they argue speak unanimously in favor of the former hierarchical model against the latter non-hierarchical ‘flat model’ of decision-making. We show in contrast that all four effects can equally (and more parsimoniously) be explained by the flat model of decision-making, which is also perfectly compatible with the new effects from the same dataset described in the companion paper by Zylberberg and colleagues (<xref ref-type="bibr" rid="bib19">Zylberberg et al., 2017</xref>).<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.16650.003</object-id><label>Figure 1.</label><caption><title>Hierarchical vs. flat models of perceptual decision during a hierarchically-structured visual task.</title><p>(<bold>A</bold>) Structure of the task. At each trial monkeys must detect the correct option out of four possible responses based on the visual information provided at the primary branching point L1 and at two secondary branching points L2 and L2’. Visual information consists of segments of flickering luminosity at the start of each branch (color segments in our depiction; visual samples changing every 50 ms for a total period of 1000 ms). Animals must make a saccade towards the final point that passes through branches of maximal luminosity; that is, must decide based on information scattered across the visual field. Each of the four responses is categorized as TT, TD, DT or DD depending on whether it corresponds to a target T (correct branch) or distractor D (incorrect branch) at first and second branching points. Detailed description of the task can be found in [<xref ref-type="bibr" rid="bib10">Lorteije et al., 2015</xref>]. (<bold>B</bold>) Hierarchical decision model of perception. In the hierarchical model, parallel decision processes run at each branching point (L1, L2 and L2’) and are integrated into a motor response at a later stage. It can be implemented as a race model composed of three races, each with two possible sub-choices. (<bold>C</bold>) Flat decision model of perception. In the flat model, the decision space is composed of the four possible final responses, so for each response the animal must sum the information provided at the corresponding primary and secondary branches (here depicted by the sum of the two luminosity signals). (<bold>D</bold>) Implementation of the flat decision model. (Left panel) Four units coding for the four possible responses integrate information from both L1 and L2 branches leading to that response, as represented by the pattern of connections from sensory units (coding for instantaneous sensory value). Connectivity include self-excitation as well as homogeneous cross-inhibition between all units. Black and red arrows indicate respectively excitatory and inhibitory connections. (Right panel) Simulation for one trial, depicting the activity of each unit across time during perceptual integration. Activity is bounded to positive values (rectification). When activity of one unit reaches the decision threshold, the related response is selected.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16650.003">http://dx.doi.org/10.7554/eLife.16650.003</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-16650-fig1-v1"/></fig></p></sec><sec id="s2" sec-type="results"><title>Results</title><p>First, stimulus difficulty at the primary branch (L1) was shown to have no influence on the performance at the secondary branch (L2), a result that was replicated by a race-model implementation of hierarchical decision-making, but not of the flat decision-making. However, this result seems a particular feature of their specific choice of implementation of the race model (<xref ref-type="bibr" rid="bib17">Vickers, 1979</xref>; <xref ref-type="bibr" rid="bib5">Drugowitsch et al., 2014</xref>), which included neither inhibition between option representations, nor activation rectification (i.e. enforcing non-negative unit activation), two classical ingredients of race models (<xref ref-type="bibr" rid="bib16">Usher and McClelland, 2001</xref>; <xref ref-type="bibr" rid="bib15">Tsetsos et al., 2012</xref>; <xref ref-type="bibr" rid="bib2">Churchland and Ditterich, 2012</xref>). Inhibition between option representations and rectification may underlie the well-known reduction of choice-related neural activity when more choice alternatives are provided (<xref ref-type="bibr" rid="bib2">Churchland and Ditterich, 2012</xref>). We simulated a race model implementation of the flat model with both rectified activation, cross-inhibition and self-excitation, whereby each of the four options competed during accumulation of evidence (<xref ref-type="fig" rid="fig1">Figure 1D</xref>, see Material and methods). Self-excitation models the instability present at the initial point of the race in attractor models of decision-making (<xref ref-type="bibr" rid="bib14">Roxin and Ledberg, 2008</xref>) and can be at the heart of well-known urgency signals to speed up decisions (<xref ref-type="bibr" rid="bib4">Drugowitsch et al., 2012</xref>). Noise in the model did not scale with stimulus intensity, in line with recent results suggesting that noise in perceptual accumulation tasks is associated with the accumulation rather than with the sensory process (<xref ref-type="bibr" rid="bib6">Drugowitsch et al., 2016</xref>), and as it is typically assumed in drift-diffusion models of decision making (<xref ref-type="bibr" rid="bib8">Gold and Shadlen, 2007</xref>). We used a non-absorbing decision threshold (i.e. activity after the decision as not bounded), but found the same results for simulations with an absorbing bound. Parameters were tuned to reproduce qualitatively the proportion for each of the four possible response types, as well as the impact of each sample in the stream and the psychometric curve for both L1 and L2 decision (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 2A–D</xref>). The impact of L1 difficulty onto L2 for the flat model indeed disappeared when we used this common implementation of the race model (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 2E</xref>).</p><p>In the companion paper (<xref ref-type="bibr" rid="bib19">Zylberberg et al., 2017</xref>), Zylberberg and colleagues question the generality of this finding, arguing that it may not be compatible with the pattern of short reaction times they provide in a new analysis for the same monkey dataset. However, our mathematical analysis (Appendix 1) shows that a clear influence of L1 difficulty onto L2 performance emerges principally when L1 difficulty strongly modulates reaction times, and thus the time of integration of L2 evidence. Short reaction times with low modulation by task difficulty as described in the companion article are thus perfectly compatible with lack of influence of L1 difficulty onto L2 performance. This result was indeed reproduced in a simulation where the threshold was lowered to produce shorter reaction times, and the boundary was eliminated for the first 10 samples (<xref ref-type="fig" rid="fig2">Figure 2A–F</xref>). This choice of the threshold implements a form of time-dependent, collapsing bound (<xref ref-type="bibr" rid="bib2">Churchland and Ditterich, 2012</xref>; <xref ref-type="bibr" rid="bib4">Drugowitsch et al., 2012</xref>) and it is consistent with the minimum viewing time imposed on monkeys (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Without such time-dependent bound, the model can produce either a large proportion of premature responses or very large mean reaction times. The discrepancy between results from these simulations with those performed in the companion paper (who do find dependency of L2 performance on L1 difficulty with short reaction times) may emerge from early responses (&lt;500 ms) in easy trials that are present in their simulations, but prohibited in our simulations by the absence of decision boundary for the first 10 samples.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.16650.004</object-id><label>Figure 2.</label><caption><title>Behavioral properties of the flat race model reproduce original monkey data.</title><p>The figures presented here correspond to a parameter set adjusted to reproduce reaction times (see Introduction). (<bold>A</bold>) Response type for the flat model. We simulated a simple race model with four possible options that compete for selection, based on a standard implementation of race models [<xref ref-type="bibr" rid="bib5">Drugowitsch et al., 2014</xref>]. The histogram shows the distribution of each of the four response types (TT, TD, DT, DD) for each level of trial difficulty from simulations of the race implementation of the flat model. (<bold>B</bold>) Influence of luminance fluctuations on the L1 decisions. Weights for each of the target (orange) and distractor (blue) samples across a trial for L1 decisions, as measured with logistic regression. The model reproduces the primacy effect observed in monkey behavioural data, whereby earlier samples have larger influence on L1 choices than later samples. Shades indicating 95% confidence intervals (barely visible) are nearly collapsed to the main line. Weights have been normalized. (<bold>C</bold>) Influence of luminance fluctuations on the L2 decisions. Legend same as B. (<bold>D</bold>) Psychometric curve. The curve represents the probability that the right segment was selected at the first (L1, red curve) and second (L2, light blue curve) level depending on the strength of the evidence in favor or right vs. left path at the corresponding branching point. Steeper curve indicates better performance at the primary than secondary branches. (<bold>E</bold>) Influence of L1 difficulty onto L2 performance. Psychometric curve for L2 decision was computed separately for easy and difficult L1 trials. Unlike the flat model implemented in the original study, we find no difference in L2 performance (permutation test; p&gt;0.4), in accordance with observed animal behavior. The null effect emerges because the minimum accumulation time before reaching a decision impedes early response even in the presence of strong evidence in L1 (see Supp. Material). When inhibition was removed, a significance interaction was recovered (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>). (<bold>F</bold>) Mean reaction times. Reaction times for the 3 types of difficulty level (E: easy. I: intermediate, D:difficult) reproduce those reported in the companion paper by Zylberberg and colleagues (<xref ref-type="bibr" rid="bib19">Zylberberg et al., 2017</xref>). (<bold>G</bold>) Influence of L2 and L2’ difficulty onto L1 choice. Psychometric curve is plotted separately for trials where decision is easier at the left than right secondary branch (green curve), and where decision is easier at right than left secondary branch (red curve). Inset represents the distribution of difference in evidence between the two branches. The effect emerges because strong evidence at one secondary branch will bias the race towards selecting the corresponding final option, thus appearing as a bias in L1 decision towards selecting the primary branch leading to this secondary branch. Information provided at secondary branches biases choice at L1 towards selecting the branch that leads to easier secondary branch, as observed in animal behavior. Lower panel represents the difference between the two psychometric curves. (Right Panel): Influence of difficulty of L2 on the L1 decision across time, as estimated from the logistic regression. Grey shades indicate 95% confidence intervals. L1 choice is affected by difference in perceptual difficulty between L2 and L2’ branches in early visual samples.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16650.004">http://dx.doi.org/10.7554/eLife.16650.004</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16650-fig2-v1"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16650.005</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Reciprocal influence of L1 and L2 evidence and decisions.</title><p>(<bold>A</bold>) Influence of L1 difficulty on L2 performance for model without inhibition. The analysis of interaction between L1 difficulty and L2 performance was repeated in a control network without inhibition (<inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). Threshold is set to six to yield similar level of performance and primacy effect; all other parameters remain unchanged. When removing inhibition performance for difficult L1 trials was degraded comparer to easy L1 trials (permutation test, p&lt;10<sup>−4</sup>), exactly as observed in the original simulations of Lorteije and colleagues.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16650.005">http://dx.doi.org/10.7554/eLife.16650.005</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16650-fig2-figsupp1-v1"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16650.006</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Behavioral and neural effects for a parameter set yielding longer reaction times than in monkey data.</title><p>In this original simulation set, commented in Zylberberg et al., decision threshold is large and there is no minimal viewing time before reaching a decision (see Methods). All qualitative behavioural (panels A-F) as well as neural (panels G-H) effects are qualitatively similar to those reported in main text (<xref ref-type="fig" rid="fig2">Figures 2</xref>–<xref ref-type="fig" rid="fig3">3</xref>) and in agreement with experimental findings of [<xref ref-type="bibr" rid="bib10">Lorteije et al., 2015</xref>].</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16650.006">http://dx.doi.org/10.7554/eLife.16650.006</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16650-fig2-figsupp2-v1"/></fig></fig-group></p><p>The second interesting observation from monkey behavior reported by Lorteije and colleagues was that L1 decisions were biased towards the branch that leads to the easier L2 decision. The effect could only be explained in the hierarchical model by invoking an extra modulatory signal passed on from L2 to L1 that must be carefully tuned (and was not implemented in the race model of [<xref ref-type="bibr" rid="bib10">Lorteije et al., 2015</xref>]). By contrast, such effect is readily accounted for by the flat model, as a strong signal at a secondary branch will boost the chances of selecting the corresponding final option, and thus bias towards selecting the L1 path leading to this option. Indeed, the effect was reproduced in the simulations (<xref ref-type="fig" rid="fig2">Figure 2G</xref>). This relates to one important advantage of the flat model over the hierarchical one: the flat model, by integrating the strength of evidence from each level, takes optimally into account uncertainty in each of the decisions, leading to more accurate responses. By contrast, the hierarchical model integrates decisions at each level independently of the level of evidence in support of each decision. This can only be amended by <italic>ad hoc</italic> mechanisms such as that proposed by Lorteije and colleagues, that probably do not scale up adequately when more than two options are available at each level.</p><p>At the physiological level, neural groups in visual cortex integrated information conveyed at the primary and secondary branching points leading to the path in their receptive field. Selection signals were shown to first differentiate options at the level of secondary branches irrespective of whether the branch is the correct or incorrect one (L2 or L2' branching), and subsequently grow larger for the L2 than for L2' branching. In the hierarchical model, this can only be explained by referring to a modulating signal once decision is reached in L1 that differentially modulates the L2 race signals corresponding to the selected and non-selected L1 branches. In the flat model, such dynamics emerges naturally with activation rectification, because activation corresponding to the two incorrect options in the incorrect L1 branch vanish as L1 signals favor the two alternative options, and so their difference is also reduced (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). Indeed, activation rectification plays a role in the dynamics of recorded neural responses, that reach a floor value (0) in the final part of the integration period in non-selected branches (Figure 4 of [<xref ref-type="bibr" rid="bib10">Lorteije et al., 2015</xref>]). Finally, an interaction between L2 and L2' selection signals was reported: clear evidence in favor of one of the two options in L2 reduced the selection signal in L2', and vice versa. In the hierarchical model, this would require complex modulatory signals passing on from L2 to L1 to L2'. By contrast, both effects are observed in the flat model (<xref ref-type="fig" rid="fig3">Figure 3B</xref>): strong evidence for one option will decrease the activation of all other three options through inhibition, increase their chance of collapsing at the zero boundary, and thus reduce the selection signal in the opposite secondary branch.<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.16650.007</object-id><label>Figure 3.</label><caption><title>Signal properties of the flat race model reproduce original monkey neural data.</title><p>(<bold>A</bold>) Amplification of L2 signals by L1 choice. Decision signals for L2 (resp. L2’), depicted here in cyan (resp. dark blue) curves, correspond to the difference between the activation of the units coding for the target and distractor in that branch, i.e. TT-TD (resp. DT-DD). Lower panel represents the difference between the two selection signals, i.e. (TT-TD)-(DT-DD). While the two decision signals first increase in parallel, the selection signal rapidly turns much larger for the correct than for the incorrect branches, due to the inhibition between activation of options across different branches. Dynamics closely resembles that observed in neural multi-unit activity in V4. S.e.m. are too small to be visualized. (<bold>B</bold>) Cross-talk between L2 and L2’ selection signals. Selection signal for L2 was reduced when the first visual samples in L2’ provide clear information in favour of one option (left panel, blue curve for lowerL2' evidence, green curve for higher L2' evidence). The effect readily emerges in the flat model because of inhibition between options across the different branches. The converse effect of L2 difficulty impacting L2’ selection signal was also observed (right panel), and both effects reproduce observation from monkey visual cortex. S.e.m. are too small to be visualized. The horizontal bar indicates samples with significant activity difference (t-test, p&lt;0.05). (<bold>C</bold>) Selection signals integrate L1 level of evidence. Unit activity is modulated by evidence at both L1 and L2 levels. Mean activity in each four units (classified as TT, TD, DT, DD) for 4 quartiles of strength of L1 evidence. TT and TD units show positive modulations with L1 evidence, while DT and DD units display negative modulations, consistent with the fact that larger L1 evidence biases competition towards the two options in the correct L1 branch. Right panel displays absolute value of Spearman’s rho correlation between strength of evidence and mean activity for all four branches.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16650.007">http://dx.doi.org/10.7554/eLife.16650.007</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16650-fig3-v1"/></fig></p><p>Overall we show that all four observations that were taken as evidence in favor of the hierarchical model could be accounted for with a standard race-model implementation of the flat model. These observations were robust and did not rely on fine tuning of the parameters. <xref ref-type="table" rid="tbl1">Table 1</xref> summarizes how each of these observed properties depend on the features of the model. Note that all these features are classical constituents of race models and not ad hoc mechanisms. Overall the flat model provides a more parsimonious explanation of the data, as it does not require appending modulatory signals between parallel decisions as the hierarchical model does.<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.16650.008</object-id><label>Table 1.</label><caption><p>Each of reported behavioral and neural effects and the associated features from the flat decision model required to display such effects.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16650.008">http://dx.doi.org/10.7554/eLife.16650.008</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">Effect</th><th valign="top">Required model features</th></tr></thead><tbody><tr><td valign="top">Independence of L2 from L1 difficulty</td><td valign="top">Signal-independent noise, low dependence of RTs on L1 difficulty</td></tr><tr><td valign="top">Bias of L1 choice by L2 difficulty</td><td valign="top">none</td></tr><tr><td valign="top">Amplification of L2 signals by L1 choice</td><td valign="top">Activation rectification</td></tr><tr><td valign="top">Cross-talk between L2 and L2' signals</td><td valign="top">Activation rectification</td></tr></tbody></table></table-wrap></p><p>These behavioral and neural effects reported in the original study provide however no univocal evidence in favor of either model. One fundamental difference between the two is indeed that selection signals in the flat model mix evidence from both L1 and L2 branches, while the hierarchical model predicts unmixed selection signals (the influence across branches can only occur posterior to decision). [At this point, an important distinction has to be made in the flat model between localized activations, which indeed mix evidence from both branches, and selection signals at L2, extracted by looking at the difference between two units in the same L1 branch, and which as shown above are largely insensitive to L1 signals]. In the companion paper, Zylberberg et al. now provide data showing that selection signals in at least 3 out of 4 L2 branches mixes evidence from both L1 and L2 branches (their Figure 4). We believe this observation is most compatible with the flat model and by itself rules out the hierarchical model that relies on complete neural segregation of integration of L1 and L2 evidence (although the possibility remains that these level-mixing integrative neural signals are completely non-causal in monkey decisions). Our simulations reproduce these effects: signals in TT is larger for stronger L1 evidence, while signals in DT and DD are weaker (p&lt;10<sup>−9</sup>, <xref ref-type="fig" rid="fig3">Figure 3C</xref>; see Also Appendix 2). As pointed out by Zylberberg and colleagues, our simulations also display a positive modulation in TD signals, unlike the null effect found in monkey data. However, despite a single source of inhibition, the modulation was not equally strong in all four branches: indeed, it was by far the weakest precisely in the TD branch (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). This weaker effect may have explained the lack of significance in monkey data. Moreover, modulation in TD could be reduced or abolished if the flat model implied stronger inhibition between options related to the same L1 branch (TT-TD and DT-DD) than between options related to distinct L1 branches (e.g. TT-DT, TT-DD). Stronger inhibition between local circuits is indeed a general pattern of cortical connectivity (<xref ref-type="bibr" rid="bib3">Douglas and Martin, 2004</xref>; <xref ref-type="bibr" rid="bib11">Lund et al., 2003</xref>).</p><p>Zylberberg and colleagues produced a last analysis of the original dataset, showing that in the flat model errors in L1 are associated with higher sensitivity at L2, whereas monkeys display no such effect. While we acknowledge that this result challenges the current implementation of the flat model, it is at this point equally unknown whether the hierarchical model proposed by the authors could avoid this feature (the reward maximization introduced in the hierarchical model to account for the influence of L2 bias onto L1 choice may produce the same interaction).</p></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>It is unclear whether selection signals recorded in visual cortex are generated locally or reflect feedback process from higher regions where integration of evidence takes place. The flat model is arguably more consistent with the latter hypothesis, as it implies integration from and inhibition across distant locations in visual field, which are more typically associated with higher cortical regions (<xref ref-type="bibr" rid="bib18">Wimmer et al., 2015</xref>). In any case, these selection signals certainly represent neural markers for a specific integration process along one subbranch.</p><p>One important limitation of flat models is they require to learn high-order representations of the environment that can appropriately integrate evidence from all relevant sensory sources, i.e. the structure of connectivity described in <xref ref-type="fig" rid="fig1">Figure 1D</xref> may take time to be acquired (<xref ref-type="bibr" rid="bib7">Garrard et al., 1997</xref>; <xref ref-type="bibr" rid="bib12">McClelland and Rumelhart, 1985</xref>). Here, monkeys performed ~60,000 trials each, possibly long enough to learn appropriate global representations linking all visual cues relevant to each response. When such time is not afforded, the system may rely on less efficient strategies such as a hierarchical model. Indeed, the comparison of flat and hierarchical models in this visual task sheds new light to the ancient debate of whether information from distinct sources is integrated before or after the decision stage, analogous respectively to the flat and hierarchical strategies. In multimodal integration such as object localization or motion detection, different modalities provide complementary cues about common objects or features of the environment (object motion, phoneme identity, etc.), so over the lifetime the brain can learn the appropriate crossmodal representations and integrate bimodal information directly over those representations. Indeed, in such context both sources of information are merged prior to decision (<xref ref-type="bibr" rid="bib9">Körding and Wolpert, 2004</xref>). By contrast, when subjects must detect the presence of either a visual or an auditory cue, requires to mapping arbitrarily two distinct unimodal signals into a single response, the relevant crossmodal representations are not formed, and therefore integration could by default only be formed following unimodal decisions, as it has been found experimentally (<xref ref-type="bibr" rid="bib13">Otto and Mamassian, 2012</xref>). One important hypothesis we make is that the level of integration could strongly depend on experience, gradually switching from post-decision (i.e. hierarchical) to pre-decision (i.e. flat) integration.</p><p>Finally, an important distinction has to be made between the hierarchical vs. flat nature of the integration process, and the serial vs. parallel nature of the integration process. While the former has to deal with the level and the structure of the representations at which integration takes place before reaching a decision, the latter corresponds to whether evidence from different sources can be integrated at the same time in these representations. The flat model is perfectly compatible with serial integration of evidence, for example if attentional constraints limit the capacity to process evidence from distant visual locations, such as when subjects must integrate from three distinct levels (<xref ref-type="bibr" rid="bib20">Zylberberg et al., 2012</xref>).</p><p>In summary, despite premature conclusions, we think that the experimental framework developed by Lorteije and colleagues opens a new promising venue for understanding the level at which evidence is accumulated and individual perceptual decisions are taken in ecological settings.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><p>We present here the equations governing the flat race model of decision-making used for simulations. Our implementation of the flat model departs from the one in [<xref ref-type="bibr" rid="bib10">Lorteije et al., 2015</xref>] in the following aspects, which are typically subsumed in many standard implementations: (1) added noise is constant instead of being proportional to signal strength, (2) there is a positive loop (i.e. negative leak) in the integration process and mutual inhibition between competitors and (3) activities cannot be negative (i.e. activation rectification). The variable <inline-formula><mml:math id="inf2"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the activity of the activation unit <italic>i</italic> (from 1 to 4) at sample <italic>t</italic>, and evolves according to:<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf3"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is the constant input, <inline-formula><mml:math id="inf4"><mml:mi>α</mml:mi></mml:math></inline-formula> is the auto-excitation term (negative if leaking, positive if positive loop providing bistability), <inline-formula><mml:math id="inf5"><mml:mi>β</mml:mi></mml:math></inline-formula> is the inhibition strength, <inline-formula><mml:math id="inf6"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is the sensory evidence at sample <italic>t,</italic> and the last term represents white noise of variance <inline-formula><mml:math id="inf7"><mml:mi>σ</mml:mi></mml:math></inline-formula>. Inhibition is homogeneous and all-to-all between activations units, that is, each unit inhibits equally the other unit from the same branch and the two units from the alternative branch. Sensory evidence integrates information from the primary and secondary branching points:<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf8"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf9"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> represent the sensitivity to evidence at level 1 and 2 respectively, <inline-formula><mml:math id="inf10"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the information provided at level 1 in favor of the corresponding branch (i.e. the difference between instantaneous luminosity in that branch and luminosity in the alternative branch at sample <italic>t</italic>), <inline-formula><mml:math id="inf11"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the information provided at level 2 in favor of the corresponding branch.</p><p>We enforce non-negative values for unit activity by using rectification:<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>All units are initiated from the same starting point <inline-formula><mml:math id="inf12"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>, and the decision is reached whenever any of the units reaches threshold <italic>K</italic> (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). If no decision is reached after presentation of all samples, the response corresponding to the unit with highest final activity is selected. Parameters are: input strength at primary branching point k<sub>1</sub> = 0.016, at secondary branching points k<sub>2</sub> = 0.012, auto-excitation <inline-formula><mml:math id="inf13"><mml:mi>α</mml:mi></mml:math></inline-formula> =0.1, inhibition <inline-formula><mml:math id="inf14"><mml:mi>β</mml:mi></mml:math></inline-formula> = 0.07, constant input <inline-formula><mml:math id="inf15"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>= 0.5, decision threshold = 50, initial values <inline-formula><mml:math id="inf16"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>= 0.5, white noise variance = 1. We chose parameters to reproduce qualitatively the monkey behavioral and neuronal data. We simulated 100,000 trials, which is the same order of magnitude as used in the original experiment. All analyses performed on simulated data strictly reproduced those realized in the original experiment. Results from these analyses are presented in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 2</xref>.</p><p>In the simulation set of <xref ref-type="fig" rid="fig2">Figure 2</xref>, designed to reproduce the pattern of reaction times described in the companion paper, we lowered the decision threshold to 30 to produce shorter reaction times. We introduced a minimum integration time of 10 samples (i.e. no boundary for the first 10 samples), consistent with the minimal time of 500 ms after stimulus onset monkeys had to wait before performing a responses saccade. We also changed inhibition to 0.05 and auto-excitation to 0.12. All other parameters were unchanged.</p><p>A matlab script for all simulations and analyses is available at <ext-link ext-link-type="uri" xlink:href="http://bit.ly/hyafilmoreno2017">http://bit.ly/hyafilmoreno2017</ext-link>.</p></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>The authors thank Jan Drugowitsch for his comments on the manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>AH, Conceptualization, Software, Formal analysis, Funding acquisition, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>RM-B, Supervision, Investigation, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunton</surname><given-names>BW</given-names></name><name><surname>Botvinick</surname><given-names>MM</given-names></name><name><surname>Brody</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Rats and humans can optimally accumulate evidence for decision-making</article-title><source>Science</source><volume>340</volume><fpage>95</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1126/science.1233912</pub-id><pub-id pub-id-type="pmid">23559254</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Churchland</surname><given-names>AK</given-names></name><name><surname>Ditterich</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>New advances in understanding decisions among multiple alternatives</article-title><source>Current Opinion in Neurobiology</source><volume>22</volume><fpage>920</fpage><lpage>926</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2012.04.009</pub-id><pub-id pub-id-type="pmid">22554881</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Douglas</surname><given-names>RJ</given-names></name><name><surname>Martin</surname><given-names>KA</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Neuronal circuits of the neocortex</article-title><source>Annual Review of Neuroscience</source><volume>27</volume><fpage>419</fpage><lpage>451</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.27.070203.144152</pub-id><pub-id pub-id-type="pmid">15217339</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drugowitsch</surname> <given-names>J</given-names></name><name><surname>Moreno-Bote</surname><given-names>R</given-names></name><name><surname>Churchland</surname><given-names>AK</given-names></name><name><surname>Shadlen</surname><given-names>MN</given-names></name><name><surname>Pouget</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The cost of accumulating evidence in perceptual decision making</article-title><source>Journal of Neuroscience</source><volume>32</volume><fpage>3612</fpage><lpage>3628</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4010-11.2012</pub-id><pub-id pub-id-type="pmid">22423085</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drugowitsch</surname><given-names>J</given-names></name><name><surname>Moreno-Bote</surname><given-names>R</given-names></name><name><surname>Pouget</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Relation between belief and performance in perceptual decision making</article-title><source>PLoS One</source><volume>9</volume><elocation-id>e96511</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0096511</pub-id><pub-id pub-id-type="pmid">24816801</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drugowitsch</surname><given-names>J</given-names></name><name><surname>Wyart</surname><given-names>V</given-names></name><name><surname>Devauchelle</surname><given-names>AD</given-names></name><name><surname>Koechlin</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Computational Precision of Mental Inference as Critical Source of Human Choice Suboptimality</article-title><source>Neuron</source><volume>92</volume><fpage>1398</fpage><lpage>1411</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.11.005</pub-id><pub-id pub-id-type="pmid">27916454</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garrard</surname><given-names>P</given-names></name><name><surname>Perry</surname><given-names>R</given-names></name><name><surname>Hodges</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Disorders of semantic memory</article-title><source>Journal of Neurology, Neurosurgery &amp; Psychiatry</source><volume>62</volume><fpage>431</fpage><lpage>435</lpage><pub-id pub-id-type="doi">10.1136/jnnp.62.5.431</pub-id><pub-id pub-id-type="pmid">9153596</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gold</surname><given-names>JI</given-names></name><name><surname>Shadlen</surname><given-names>MN</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The neural basis of decision making</article-title><source>Annual Review of Neuroscience</source><volume>30</volume><fpage>535</fpage><lpage>574</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.29.051605.113038</pub-id><pub-id pub-id-type="pmid">17600525</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Körding</surname><given-names>KP</given-names></name><name><surname>Wolpert</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The loss function of sensorimotor learning</article-title><source>PNAS</source><volume>101</volume><fpage>9839</fpage><lpage>9842</lpage><pub-id pub-id-type="doi">10.1073/pnas.0308394101</pub-id><pub-id pub-id-type="pmid">15210973</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lorteije</surname><given-names>JA</given-names></name><name><surname>Zylberberg</surname><given-names>A</given-names></name><name><surname>Ouellette</surname><given-names>BG</given-names></name><name><surname>De Zeeuw</surname><given-names>CI</given-names></name><name><surname>Sigman</surname><given-names>M</given-names></name><name><surname>Roelfsema</surname><given-names>PR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The formation of hierarchical decisions in the visual cortex</article-title><source>Neuron</source><volume>87</volume><fpage>1344</fpage><lpage>1356</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.08.015</pub-id><pub-id pub-id-type="pmid">26365766</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lund</surname><given-names>JS</given-names></name><name><surname>Angelucci</surname><given-names>A</given-names></name><name><surname>Bressloff</surname><given-names>PC</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Anatomical substrates for functional columns in macaque monkey primary visual cortex</article-title><source>Cerebral Cortex</source><volume>13</volume><fpage>15</fpage><lpage>24</lpage><pub-id pub-id-type="doi">10.1093/cercor/13.1.15</pub-id><pub-id pub-id-type="pmid">12466211</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McClelland</surname><given-names>JL</given-names></name><name><surname>Rumelhart</surname><given-names>DE</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Distributed memory and the representation of general and specific information</article-title><source>Journal of Experimental Psychology: General</source><volume>114</volume><fpage>159</fpage><lpage>188</lpage><pub-id pub-id-type="doi">10.1037/0096-3445.114.2.159</pub-id><pub-id pub-id-type="pmid">3159828</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otto</surname><given-names>TU</given-names></name><name><surname>Mamassian</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Noise and correlations in parallel perceptual decision making</article-title><source>Current Biology</source><volume>22</volume><fpage>1391</fpage><lpage>1396</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2012.05.031</pub-id><pub-id pub-id-type="pmid">22771043</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roxin</surname><given-names>A</given-names></name><name><surname>Ledberg</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Neurobiological models of two-choice decision making can be reduced to a one-dimensional nonlinear diffusion equation</article-title><source>PLoS Computational Biology</source><volume>4</volume><elocation-id>e1000046</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000046</pub-id><pub-id pub-id-type="pmid">18369436</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsetsos</surname><given-names>K</given-names></name><name><surname>Gao</surname><given-names>J</given-names></name><name><surname>McClelland</surname><given-names>JL</given-names></name><name><surname>Usher</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Using Time-Varying Evidence to Test Models of Decision Dynamics: Bounded Diffusion vs. the Leaky Competing Accumulator Model</article-title><source>Frontiers in Neuroscience</source><volume>6</volume><elocation-id>79</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2012.00079</pub-id><pub-id pub-id-type="pmid">22701399</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Usher</surname><given-names>M</given-names></name><name><surname>McClelland</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title><italic>The time course of perceptual choice: the leaky</italic>, competing accumulator model</article-title><source>Psychological Review</source><volume>108</volume><fpage>550</fpage><lpage>592</lpage><pub-id pub-id-type="doi">10.1037/0033-295X.108.3.550</pub-id><pub-id pub-id-type="pmid">11488378</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Vickers</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1979">1979</year><source>Decision Processes in Visual Perception</source><publisher-name>Academic Press</publisher-name></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wimmer</surname><given-names>K</given-names></name><name><surname>Compte</surname><given-names>A</given-names></name><name><surname>Roxin</surname><given-names>A</given-names></name><name><surname>Peixoto</surname><given-names>D</given-names></name><name><surname>Renart</surname><given-names>A</given-names></name><name><surname>de la Rocha</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Sensory integration dynamics in a hierarchical network explains choice probabilities in cortical area MT</article-title><source>Nature Communications</source><volume>6</volume><elocation-id>6177</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms7177</pub-id><pub-id pub-id-type="pmid">25649611</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zylberberg</surname><given-names>A</given-names></name><name><surname>Lorteije</surname><given-names>JAM</given-names></name><name><surname>Ouellette</surname><given-names>BG</given-names></name><name><surname>De Zeeuw</surname><given-names>CI</given-names></name><name><surname>Sigman</surname><given-names>M</given-names></name><name><surname>Roelfsema</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Serial, parallel and hierarchical decisionmaking in primates</article-title><source>eLife</source><volume>6</volume><elocation-id>e17331</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.17331</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zylberberg</surname><given-names>A</given-names></name><name><surname>Ouellette</surname><given-names>B</given-names></name><name><surname>Sigman</surname><given-names>M</given-names></name><name><surname>Roelfsema</surname><given-names>PR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Decision making during the psychological refractory period</article-title><source>Current Biology</source><volume>22</volume><fpage>1795</fpage><lpage>1799</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2012.07.043</pub-id><pub-id pub-id-type="pmid">22921368</pub-id></element-citation></ref></ref-list><app-group><app id="app1"><title>Appendix 1</title><boxed-text><sec id="s6" sec-type="appendix"><title>Dependence of L2 performance on L1</title><p>Lorteije and colleagues defend that a flat model would necessarily yield a dependence of L2 performance on L1 difficulty. In the flat race model described above, the selection signals at branches L2 (<inline-formula><mml:math id="inf17"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>) and at L2' (<inline-formula><mml:math id="inf18"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>) evolve according to:<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>with <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf20"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>'</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></p><p>The impact of each sample onto L2 selection signal can be directly derived as<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf21"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula></p><p>In other words the selection signals at levels 2 are only influenced by information provided at level two branches <inline-formula><mml:math id="inf22"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, and not by information provided at level 1 <inline-formula><mml:math id="inf23"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. It is thus expected as a general result that L2 selection does not depend on L1 difficulty nor any other L1-related variable, contrary to the predictions of Lorteije and colleagues. We detail below four factors that could in principle go against this conclusion. We found however than in practice none induced a significant bias in our simulations:</p><list list-type="roman-lower"><list-item><p>the above formula is only valid when activation remain above the non-negative boundary. Nevertheless we observed in our simulations that the independence of L2 performance on L1 difficulty still held, even when the zero boundary played an active role (as is the case for the chosen parameter set).</p></list-item><list-item><p>the decision boundary biases towards earlier choices when L1 task is easy compared to when L1 task is hard. In turn, this would mean lower average integration time for L2 choice and thus a decrement of L2 performance. This is exactly what is observed in the original simulation of the flat race model by Lorteije and colleagues. Evidence for a relatively small decision boundary was taken from the primacy effect, whereby earlier samples had larger impacts onto the decision than later samples in the trial (their <xref ref-type="fig" rid="fig2">Figure 2E</xref>). However, such primacy effect can alternatively emerge from inhibition, as soon as it outweighs leak: indeed, the weight of each sample <inline-formula><mml:math id="inf24"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> decreases when sample position <inline-formula><mml:math id="inf25"><mml:mi>u</mml:mi></mml:math></inline-formula> increases (Suppl. <xref ref-type="fig" rid="fig1">Figure 1A</xref>). We can thus replicate primacy effect and independence of L2 on L1 difficulty by implementing a relatively high decision threshold, consistent with findings from another fixed-duration perceptual accumulation task (<xref ref-type="bibr" rid="bib1">Brunton et al., 2013</xref>). Indeed, very similar results were observed when we used an infinite threshold.</p></list-item><list-item><p>whether L2 decision corresponds to selection signals at L2 or L2' depends ultimately on which unit finally wins the race. Thus, while both L2 decision are independent of L1, the <italic>observed</italic> L2 selection signal can be influenced by L1. In practice, we found this had no impact for the parameters reported above and in a large part of the parameter space.</p></list-item><list-item><p>when additive noise in the units is stimulus-dependent, i.e. if it grows larger when the intensity of the stimulus is larger (our simulations used stimulus-independent noise). In such case, since easier L1 trials correspond to stronger L1 signals, then easier L1 trials also induce larger noise added to the integration process. This could thus deteriorate L2 selection process.</p></list-item></list></sec></boxed-text></app><app id="app2"><title>Appendix 2</title><boxed-text><sec id="s7" sec-type="appendix"><title>Dependence of selection signals on L1 evidence</title><p>When the zero bound for unit activity is hypothesized to play no role, activity for each of the 4 units (TT, TD, DT, DD) at each time step can be decomposed as the sum of a term relative to integration of L1 information, a term relative to integration of L2 information, and a noise term:<disp-formula id="equ6"><mml:math id="m6"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The first term in each equation induces a positive correlation between evidence at L1 and activity at TT and TD units, and a negative one between evidence at L1 and activity at DT and DD units. Furthermore, the design of the experiment with three different difficulty levels for trials creates correlations between evidence at the different levels, as each difficulty level <italic>d</italic> associated with a given mean <inline-formula><mml:math id="inf26"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf27"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for the intensity of the individual samples. The correlation across trials between sensory evidence at two different levels (L1 and L2/L2’) and at two different sample positions (t and t’) is:<disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac bevelled="true"><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf28"><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf29"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mo>.</mml:mo><mml:mo>&gt;</mml:mo></mml:mrow></mml:math></inline-formula> represent the variance and mean over the different difficulty levels, respectively. Such correlation between samples increases the correlation between TT activity and L1 evidence, but decreases the correlation between TD and L1 evidence, hence the difference observed in <xref ref-type="fig" rid="fig3">Figure 3C</xref> (in the other branch, the amplitude of the negative correlation with L1 evidence is enhanced for DD units and decreased for DT units). The other source of heterogeneity of the impact of L1 evidence is the rectification, which impacts more the activity of DD, DT and TD units. Overall, the flat model predicts different levels of modulation of unit activity by evidence in L1 for the four different branches, and an especially low (positive) correlation for the case of the TD unit.</p></sec></boxed-text></app></app-group></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.16650.009</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Gold</surname><given-names>Joshua I</given-names></name><role>Reviewing editor</role><aff><institution>University of Pennsylvania</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Breaking down hierarchies in perceptual decision-making&quot; for consideration by <italic>eLife</italic>. Your article has been favorably evaluated by Timothy Behrens (Senior Editor) and three reviewers, one of whom is a member of our Board of Reviewing Editors. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>These two papers present an enlightened and useful discussion about the interpretation of results previously published by Lorteije and colleagues. In that prior study, monkeys performed a task that required them to make a saccadic eye movement to the appropriate endpoint of a visual branching pattern with three bifurcations: one at the top, then two others under each branch, resulting in four distinct endpoints. Each bifurcation had a modulating luminance cue at each branch that determined the correct path: always choose the brighter (on average) branch. Through analyses of behavior and the activity of neurons in cortical areas V1 and V4 whose receptive fields corresponded to the locations of the luminance cues, a primary conclusion from that study was that the monkeys solved the task in a hierarchical manner, with decisions about the top- and lower-level branches first occurring in parallel, then combined for a final choice.</p><p>That landmark paper spawned several interesting discussions in the field. Hyafil and Moreno-Bote's technical comment encapsulates one of the critical lines of discussion about whether it is possible to truly distinguish a hierarchical decision-making process from a flat process based on the experimental data of Lorteije and colleagues. It is a critical and complex question. The reply by Zylerberg and colleagues adds further to the discussion, presenting several counter-arguments to the claims of Hyafil and Moreno-Bote.</p><p>All three reviewers were impressed by the tone and content of the submissions and agree that both represent worthwhile contributions to the literature. As noted by one of the reviewers, this kind of debate is &quot;very valuable and generally underappreciated.&quot;</p><p>The above comments are included, verbatim, in our decision letters to both groups of submitting authors. We also will now make both initial submissions available to both groups, so that any potential revisions can fully take into account the claims made in the other submission. We will then allow for one more iteration: if and when we receive revised submissions and deem them appropriate, we will then again make each available to the other group for further revisions and clarifications.</p><p>Below are summaries of the discussions among the reviewers that are specific to your submission.</p><p>Essential revisions:</p><p>The reviewers agreed with the key point, that a &quot;flat&quot; mechanism that includes mutual inhibition can account for many features of the data and generally act like a hierarchical process. However, they also raised several concerns that should be addressed:</p><p>1) It would be useful to provide more intuitions about the specific assumptions and parameter values in the flat model that give rise to key types of output. It is critical to note that only some instantiations of the flat model are compatible with the data. The explanation in the legend of <xref ref-type="fig" rid="fig2">Figure 2E</xref> is useful but inadequate. Dedicating one or two paragraphs of the main text to model parameters and predictions will make the technical comment much more accessible. For example, why and under what parameter regimes inhibition in a flat model makes the accuracy of L2 decision independent of L1 stimulus strength? Likewise, can you provide better intuitions for the effect of scaling of noise with stimulus strength and rectification of the accumulators? Finally, the flat model explains the late influence of L1 on L2 and L2' choices, removing the need for complex interactions imposed by the hierarchical model. However, it also predicts that different L1 stimulus strengths should cause different magnitudes of suppression on TD neural responses, a prediction that does not match the data, as pointed out by Lorteije et al. It will be useful for readers to know that this prediction stems from Hyafil and Moreno-Bote's assumption that each accumulator equally suppresses the other accumulators. It is likely that suppression is not uniform, causing a TT choice to suppress TD less than DD because TD is a closer option to TT in the decision space than DD. Non-uniform suppression has been reported in various sensory processes and is quite likely to apply to multi-choice decisions.</p><p>2) A figure that recapitulates the task and the flat race-mode would also be useful.</p><p>3) The authors should be clearer on how they think their model relates to sensory and/or decision circuits. A race-model with mutual inhibition seems plausible in a decision-making area, but in a sensory area? Or do the authors assume the dynamics to play out in higher area and then feed back to V1 and V4? Making their argument explicit in the context of a model like that by Wimmer et al. 2015 would be very helpful. This point also seems strongly related to their claim that Figure 4 in Lorteije et al. argues against the hierarchical model because &quot;localized selection signals merge information provided at different levels.&quot; Perhaps these sensory neurons are getting decision-related feedback?</p><p>4) The conclusion that the flat model is a &quot;more parsimonious&quot; explanation for the data than the model proposed by Lorteije et al. might be reconsidered, or at least clarified in the context of other lines of evidence from other studies that relate to flat versus hierarchical processing.</p><p>5) Zylberberg et al. argue that the RTs produced by the flat model presented by Hyafil and Moreno-Bote were unrealistic (although note that the task did not have a true RT design, and the measured RTs had only a weak dependence on signal strength). Can any version of the flat model (e.g., with collapsing bounds) produce the reported RTs?</p><p>6) It would be useful if both model code and relevant data files could be made available.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Breaking down hierarchies of decision-making in visual cortex&quot; for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by Timothy Behrens (Senior Editor) and Joshua Gold (Reviewing Editor).</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below. We also note that our plan is as follows: once we receive an acceptable response to these issues, we will send the updated manuscript to Zylberberg and colleagues, so they have an opportunity to revise their manuscript accordingly. We then will share both papers with both groups, but at that point, if any further changes are desired, they have to be essential and very well justified.</p><p>1) Both papers discuss the new analysis by Zylberberg et al. showing that the strength of evidence at L1 affects V4 activity elicited by the L2 and L2' branches. They are in agreement with the finding but disagree with the interpretation. Part of the disagreement appears to stem from misunderstandings from some comments in the Hyafil and Moreno Bote manuscript. Specifically, as quoted by Zylberberg et al., Hyafil and Moreno Bote state in Appendix A that the flat model predicts that &quot;selection signals at levels 2 are only influenced by information provided at level 2 branches […] and not by information provided at level 1.&quot; The new analyses by Zylberberg et al. clearly contradict this prediction. However, in their main text, Hyafil and Moreno Bote state that &quot;this observation is most compatible with the flat model and by itself rules out the hierarchical model that relies on complete neural segregation of integration of L1 and L2 evidence.&quot; At the very least, please reconcile their statements in the Appendix and the main text.</p><p>2) <xref ref-type="fig" rid="fig2">Figure 2</xref> vs. <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>: why not just show the <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref> panels in the main figure? Panels H and I could be relegated to the supplement.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.16650.010</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Essential revisions:</italic> </p><p><italic>The reviewers agreed with the key point, that a &quot;flat&quot; mechanism that includes mutual inhibition can account for many features of the data and generally act like a hierarchical process. However, they also raised several concerns that should be addressed:</italic> </p><p><italic>1) It would be useful to provide more intuitions about the specific assumptions and parameter values in the flat model that give rise to key types of output. It is critical to note that only some instantiations of the flat model are compatible with the data. The explanation in the legend of <xref ref-type="fig" rid="fig2">Figure 2E</xref> is useful but inadequate. Dedicating one or two paragraphs of the main text to model parameters and predictions will make the technical comment much more accessible. For example, why and under what parameter regimes inhibition in a flat model makes the accuracy of L2 decision independent of L1 stimulus strength? Likewise, can you provide better intuitions for the effect of scaling of noise with stimulus strength and rectification of the accumulators?</italic> </p><p>We agree with the reviewers that the relationship between the observed properties of the modelled network and its underlying ingredients was not clearly presented in the manuscript. We have improved the revised version to point for each observed properties what ingredients are necessary for this to occur: inhibition, rectification, thresholds, etc. Some parts of it were present in supplementary data and has been moved to main text (the rest is in the new Appendix A). Importantly, we have added a table that precisely summarizes this correspondence between features of the model and observed behavioral/neural properties.</p><p><italic>Finally, the flat model explains the late influence of L1 on L2 and L2' choices, removing the need for complex interactions imposed by the hierarchical model. However, it also predicts that different L1 stimulus strengths should cause different magnitudes of suppression on TD neural responses, a prediction that does not match the data, as pointed out by Lorteije et al. It will be useful for readers to know that this prediction stems from Hyafil and Moreno-Bote's assumption that each accumulator equally suppresses the other accumulators. It is likely that suppression is not uniform, causing a TT choice to suppress TD less than DD because TD is a closer option to TT in the decision space than DD. Non-uniform suppression has been reported in various sensory processes and is quite likely to apply to multi-choice decisions.</italic> </p><p>We thank the reviewers for the suggestion than non-uniform inhibition in the flat model may allow us to reproduce this observed null effect in the fourth branch (TD). Non-uniform inhibition is indeed a key component of cortical networks that could play a decisive role in this null effect. Actually, we think that the pattern of inhibition should be stronger local inhibition (from TT to TD) may create reduced activity in TD for stronger L1 evidence (because L1 and L2 evidence are correlated, see below), and cancel the positive modulation with L1 evidence observed in the current model.</p><p>Even in the current model, we observed that the modulation was not uniform across all branches but was weakest precisely in the TD branch (2.5-4 times weaker than in other branches according to rho’s). As explained in new Appendix B, this effect was caused by the correlation between the strength of L1 and L2 evidence in the design structure of the sensory samples, as a result of the 3 levels of difficulty. As a result, the null statistical effect in TD branch could simply be due to the relative weakness of the modulation in this branch.</p><p>This interesting discussion has been added in a new paragraph in main text, complemented by new Appendix B and <xref ref-type="fig" rid="fig3">Figure 3C</xref>.</p><p>Beyond this point, our interpretation of new analysis in Figure 4 of Zylberberg et al. radically diverges from that of its authors. It is indeed the clearest signature of the flat model that each unit integrates information from all available sources prior to decision, and so its activity should be sensitive to both L1 and L2 evidence. The new analysis by Zylberberg and colleagues report effect from single localized populations, analogous to single unit activity from the model, thus perfectly compatible with modulation by L1 information. Thus, we would like to stress that the fact that selection signals in (at least) 3 of the 4 branches are modulated by evidence provided at both L1 and L2 branches is strongly suggestive of the flat model, and directly contradicts the hierarchical model. Indeed, the most essential element of hierarchical model is that evidence from different branches is not integrated within the same neural populations; integration and modulatory effects only occur prior to decision. This discussion has also been added in our manuscript.</p><p><italic>2) A figure that recapitulates the task and the flat race-mode would also be useful.</italic> </p><p>Thanks for the suggestion. We have added in <xref ref-type="fig" rid="fig1">Figure 1 a</xref> representation of the implementation of the flat race-mode as well as one exemplar simulation (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) In the figure legend, we now point to the original manuscript by Lorteije et al. for further description of the task.</p><p><italic>3) The authors should be clearer on how they think their model relates to sensory and/or decision circuits. A race-model with mutual inhibition seems plausible in a decision-making area, but in a sensory area? Or do the authors assume the dynamics to play out in higher area and then feed back to V1 and V4? Making their argument explicit in the context of a model like that by Wimmer et al. 2015 would be very helpful. This point also seems strongly related to their claim that Figure 4 in Lorteije et al. argues against the hierarchical model because &quot;localized selection signals merge information provided at different levels.&quot; Perhaps these sensory neurons are getting decision-related feedback?</italic> </p><p>We agree that the point about localized selection signals merging information provided at different levels was not a good one, mostly because it was not clear from that figure whether what is integrated is perceptual evidence or local decisions. The new figure from Zylberberg points to the latter process, as discussed above. The sentence was accordingly removed.</p><p>We thank the reviewers for pointing to the Wimmer et al. paper. As we now briefly discuss in the manuscript, it is not clear whether selection signals recorded in visual cortex emerge locally or reflect feedback from higher areas (this is clearly discussed in Lorteije et al. paper). The flat model assumes integration of evidence from across the visual field, and inhibition between the associated representations, and is thus more compatible with the view that integration takes place at a higher cortical area.</p><p><italic>4) The conclusion that the flat model is a &quot;more parsimonious&quot; explanation for the data than the model proposed by Lorteije et al. might be reconsidered, or at least clarified in the context of other lines of evidence from other studies that relate to flat versus hierarchical processing.</italic> </p><p>Thanks for the suggestions. We would like to say that we do not mean that the flat model offers a more parsimonious model for all sorts of hierarchical tasks, and thus we have make sure that we do not make such a claim in our manuscript. However, we think that the flat model offers a more parsimonious explanation for the data of the presented experiment, in that all described effects can be explained by classical ingredients of the race model and not ad hoc mechanisms. Following the reviewers’ suggestion, and in light of this comment and the manuscript by Zylberberg et al., we have clarified our point in the final paragraphs of the manuscript about what the comparative advantages of flat vs. hierarchical model, and under what circumstances we hypothesize that each model will prevail.</p><p>In particular, we stress now what is believed is an important distinction between the hierarchical vs. flat nature of the integration process, and the serial vs. parallel nature of the timing of integration. The evidence from previous studies related in the first part of Zylberberg et al.’s manuscript only addresses the second question (when integration is serial or parallel), but speaks very little to the underlying structure of the representations that integrate evidence. Thus, we do not rule out that a flat model integrating evidence serially is also present in these other tasks.</p><p><italic>5) Zylberberg et al. argue that the RTs produced by the flat model presented by Hyafil and Moreno-Bote were unrealistic (although note that the task did not have a true RT design, and the measured RTs had only a weak dependence on signal strength). Can any version of the flat model (e.g., with collapsing bounds) produce the reported RTs?</italic> </p><p>We had no access to RTs beforehand so did not place much attention to it our first simulations. Actually, as pointed out by the reviewers, this is not a true RT design but rather a mixed RT-fixed duration one, as monkeys had to wait for at least 500 ms (10 samples) before responding, but could wait even more to accumulate more evidence. We have now taken this into account by removing the decision boundary for the first 10 samples, and then a fixed (finite) threshold (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). The value of the finite threshold was adapted to yield approximately the same mean reaction times depending on task difficulty as reported by Zylberberg et al. Apart from the reported RTs, all previously reported behavioral and neural effects were reproduced, including the lack of modulation of L2 performance by L1 difficulty (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p><p>We would like to add that Zylberberg et al. report that after a simple modulation of a fixed threshold in the flat model (unlike the double threshold strategy we implemented), L2 performance was not independent anymore or L1 difficulty. We believe that the discrepancies between their simulations and ours stems from the distribution of early responses in the two models. As commented in point 1, modulation of L2 performance by L1 difficulty emerges mostly when L1 difficulty has a large impact on reaction times, and hence on the timing of L2 integration. With a single fixed threshold as used in simulation by Zylberberg and colleagues, there is a significant portion of easy L1 trials with early responses (RT&lt;500 ms), which robustly degrades L2 performance. By contrast, by ensuring that decisions integrate at least the 10 first samples, we make sure that there is a minimum integration window for L2 decision. Note that this time-dependent bound is a form of collapsing bound, so we agree with the reviewer that indeed that is a plausible mechanism that can explain the observed RTs. We would like to conclude by saying that we have provided the results for the modified version of the network as supplementary figure, and left the original as main figure. We think this presentation better reflects the discussion that has taken place between the two manuscripts. We could also provide the new results in the main figures in place of the former ones, if judged more adequate by editors and reviewers.</p><p><italic>6) It would be useful if both model code and relevant data files could be made available.</italic> </p><p>This is a good point. We are working on adapting the code to be readily usable by any matlab user. It will comprise both generation of synthetic data and its subsequent analysis (there is no middle way data files). It will be accessible within the next few days at the following link: bit.ly/flatdecision</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p><italic>[…] 1) Both papers discuss the new analysis by Zylberberg et al. showing that the strength of evidence at L1 affects V4 activity elicited by the L2 and L2' branches. They are in agreement with the finding but disagree with the interpretation. Part of the disagreement appears to stem from misunderstandings from some comments in the Hyafil and Moreno Bote manuscript. Specifically, as quoted by Zylberberg et al., Hyafil and Moreno Bote state in Appendix A that the flat model predicts that &quot;selection signals at levels 2 are only influenced by information provided at level 2 branches […] and not by information provided at level 1.&quot; The new analyses by Zylberberg et al. clearly contradict this prediction. However, in their main text, Hyafil and Moreno Bote state that &quot;this observation is most compatible with the flat model and by itself rules out the hierarchical model that relies on complete neural segregation of integration of L1 and L2 evidence.&quot; At the very least, please reconcile their statements in the Appendix and the main text.</italic> </p><p>We would like to thank the reviewers for making this point, as indeed there has been some confusion between our two manuscripts.</p><p>Specifically, we believe that Zylberberg et al. made a confusion between two things: “unit activity”, i.e. the localized selection signal in each of the four units; and “selection signals for L2” that we compute by taking the difference between the activities of two units within the same branch. While in the latter the influence of L1 evidence is effectively removed (as described in Annex A), in the former influence of L1 is essential: it is indeed the clearest signature of the flat model that each unit integrates information from all available sources prior to decision, and so its activity should be sensitive to both L1 and L2 evidence. The new analysis by Zylberberg and colleagues report effect from single localized populations, analogous to single unit activity from the model, in which we indeed predict modulation by L1 information.</p><p>We have now made this important distinction clearer in the manuscript, by adding the following note in the corresponding section:</p><p>“At this point, an important distinction has to be made in the hierarchical model between localized activations, which indeed mix evidence from both branches, and selection signals at L2, extracted by looking at the difference between two units in the same L1 branch, and which as shown above are largely insensitive to L1 signals.”</p><p><italic>2) <xref ref-type="fig" rid="fig2">Figure 2</xref> vs. <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>: why not just show the <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref> panels in the main figure? Panels H and I could be relegated to the supplement.</italic> </p><p>Actually we could not decide in our previous submission which was the better presentation: to put either the original analysis (with incorrect reaction times distribution) or the new analysis in the main figure. We thought that the former solution would allow to present the very data that Zylberberg et al. are commenting on in the companion paper. But we agree that the alternative option that the reviewers present is more straightforward. Changes were made accordingly.</p></body></sub-article></article>