<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">38070</article-id><article-id pub-id-type="doi">10.7554/eLife.38070</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Generative modeling of multi-mapping reads with mHi-C advances analysis of Hi-C studies</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-113377"><name><surname>Zheng</surname><given-names>Ye</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8806-2761</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-104110"><name><surname>Ay</surname><given-names>Ferhat</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-112131"><name><surname>Keles</surname><given-names>Sunduz</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9048-0922</contrib-id><email>keles@stat.wisc.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Statistics</institution><institution>University of Wisconsin-Madison</institution><addr-line><named-content content-type="city">Madison</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>La Jolla Institute for Allergy and Immunology</institution><addr-line><named-content content-type="city">La Jolla</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">School of Medicine</institution><institution>University of California, San Diego</institution><addr-line><named-content content-type="city">La Jolla</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Department of Biostatistics and Medical Informatics</institution><institution>University of Wisconsin-Madison</institution><addr-line><named-content content-type="city">Madison</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ren</surname><given-names>Bing</given-names></name><role>Reviewing Editor</role><aff><institution>University of California, San Diego School of Medicine</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Barkai</surname><given-names>Naama</given-names></name><role>Senior Editor</role><aff><institution>Weizmann Institute of Science</institution><country>Israel</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>31</day><month>01</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e38070</elocation-id><history><date date-type="received" iso-8601-date="2018-05-03"><day>03</day><month>05</month><year>2018</year></date><date date-type="accepted" iso-8601-date="2019-01-30"><day>30</day><month>01</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Zheng et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Zheng et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-38070-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.38070.001</object-id><p>Current Hi-C analysis approaches are unable to account for reads that align to multiple locations, and hence underestimate biological signal from repetitive regions of genomes. We developed and validated <italic>mHi-C</italic>, a <italic>m</italic>ulti-read mapping strategy to probabilistically allocate Hi-C multi-reads. mHi-C exhibited superior performance over utilizing only uni-reads and heuristic approaches aimed at rescuing multi-reads on benchmarks. Specifically, mHi-C increased the sequencing depth by an average of 20% resulting in higher reproducibility of contact matrices and detected interactions across biological replicates. The impact of the multi-reads on the detection of significant interactions is influenced marginally by the relative contribution of multi-reads to the sequencing depth compared to uni-reads, <italic>cis</italic>-to-<italic>trans</italic> ratio of contacts, and the broad data quality as reflected by the proportion of mappable reads of datasets. Computational experiments highlighted that in Hi-C studies with short read lengths, mHi-C rescued multi-reads can emulate the effect of longer reads. mHi-C also revealed biologically supported <italic>bona fide</italic> promoter-enhancer interactions and topologically associating domains involving repetitive genomic regions, thereby unlocking a previously masked portion of the genome for conformation capture studies.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>chromosome chromatin capture</kwd><kwd>Hi-C</kwd><kwd>multi-reads</kwd><kwd>probabilistic modeling</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id><institution>National Human Genome Research Institute</institution></institution-wrap></funding-source><award-id>HG009744</award-id><principal-award-recipient><name><surname>Keles</surname><given-names>Sunduz</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution>La Jolla Institute for Allergy and Immunology</institution></institution-wrap></funding-source><award-id>Institute Leadership Funds</award-id><principal-award-recipient><name><surname>Ay</surname><given-names>Ferhat</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id><institution>National Human Genome Research Institute</institution></institution-wrap></funding-source><award-id>HG007019</award-id><principal-award-recipient><name><surname>Keles</surname><given-names>Sunduz</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A statistical model rescues multi-mapping reads with high accuracy and demonstrates their impact in all facets of the analysis of genome-wide high throughput conformation capture datasets.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>DNA is highly compressed in the nucleus and organized into a complex three-dimensional structure. This compressed form brings distal functional elements into close spatial proximity of each other (<xref ref-type="bibr" rid="bib12">Dekker et al., 2002</xref>; <xref ref-type="bibr" rid="bib11">de Laat and Duboule, 2013</xref>) and has a far-reaching influence on gene regulation. Changes in DNA folding and chromatin structure remodeling may result in cell malfunction with devastating consequences (<xref ref-type="bibr" rid="bib9">Corradin et al., 2016</xref>; <xref ref-type="bibr" rid="bib50">Won et al., 2016</xref>; <xref ref-type="bibr" rid="bib26">Javierre et al., 2016</xref>; <xref ref-type="bibr" rid="bib42">Rosa-Garrido et al., 2017</xref>; <xref ref-type="bibr" rid="bib45">Spielmann et al., 2018</xref>). Hi-C technique (<xref ref-type="bibr" rid="bib34">Lieberman-Aiden et al., 2009</xref>; <xref ref-type="bibr" rid="bib41">Rao et al., 2014</xref>) emerged as a high throughput technology for interrogating the three-dimensional configuration of the genome and identifying regions that are in close spatial proximity in a genome-wide fashion. Thus, Hi-C data is powerful for discovering key information on the roles of the chromatin structure in the mechanisms of gene regulation.</p><p>There are a growing number of published and well-documented Hi-C analysis tools and pipelines (<xref ref-type="bibr" rid="bib22">Heinz et al., 2010</xref>; <xref ref-type="bibr" rid="bib24">Hwang et al., 2015</xref>; <xref ref-type="bibr" rid="bib1">Ay et al., 2014a</xref>; <xref ref-type="bibr" rid="bib44">Servant et al., 2015</xref>; <xref ref-type="bibr" rid="bib37">Mifsud et al., 2015</xref>; <xref ref-type="bibr" rid="bib35">Lun and Smyth, 2015</xref>), and their operating characteristics were recently studied (<xref ref-type="bibr" rid="bib3">Ay and Noble, 2015</xref>; <xref ref-type="bibr" rid="bib19">Forcato et al., 2017</xref>; <xref ref-type="bibr" rid="bib53">Yardımcı et al., 2017</xref>) in detail. However, a key and common step in these approaches is the exclusive use of uniquely mapping reads. Limiting the usable reads to only uniquely mapping reads underestimates signal originating from repetitive regions of the genome which are shown to be critical for tissue specificity (<xref ref-type="bibr" rid="bib51">Xie et al., 2013</xref>). Such reads from repetitive regions can be aligned to multiple positions (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) and are referred to as multi-mapping reads or multi-reads for short. The critical drawbacks of discarding multi-reads have been recognized in other classes of genomic studies such as transcriptome sequencing (RNA-seq) (<xref ref-type="bibr" rid="bib32">Li and Dewey, 2011</xref>), chromatin immunoprecipitation followed by high throughput sequencing (ChIP-seq) (<xref ref-type="bibr" rid="bib8">Chung et al., 2011</xref>; <xref ref-type="bibr" rid="bib55">Zeng et al., 2015</xref>), as well as genome-wide mapping of protein-RNA binding sites (CLIP-seq or RIP-seq) (<xref ref-type="bibr" rid="bib57">Zhang and Xing, 2017</xref>). More recently, (<xref ref-type="bibr" rid="bib46">Sun et al., 2018</xref>) and (<xref ref-type="bibr" rid="bib10">Cournac et al., 2016</xref>) argued for a fundamental role of repeat elements in the 3D folding of genomes, highlighting the role of higher order chromatin architecture in repeat expansion disorders. However, the ambiguity of multi-reads alignment renders it a challenge to investigate the repetitive elements co-localization with the true 3D interaction architecture and signals. In this work, we developed mHi-C (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s2">2</xref>), a hierarchical model that probabilistically allocates Hi-C multi-reads to their most likely genomic origins by utilizing specific characteristics of the paired-end reads of the Hi-C assay. mHi-C is implemented as a full analysis pipeline (<ext-link ext-link-type="uri" xlink:href="https://github.com/keleslab/mHiC">https://github.com/keleslab/mHiC</ext-link>) that starts from unaligned read files and produces a set of statistically significant interactions at a given resolution. We evaluated mHi-C both by leveraging replicate structure of public of Hi-C datasets of different species and cell lines across six different studies, and also with computational trimming and data-driven simulation experiments.</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.38070.002</object-id><label>Figure 1.</label><caption><title>Overview of multi-reads and mHi-C pipeline.</title><p>(<bold>A</bold>) Standard Hi-C pipelines utilize uni-reads while discarding multi-mapping reads which give rise to multiple potential contacts. (<bold>B</bold>) The total number of reads in different categories as a result of alignment to reference genome across the study datasets. Percentages of high-quality multi-reads compared to uni-reads are depicted on top of each bar. (<bold>C</bold>) Multi-mapping reads can be reduced to uni-reads within validation checking and genome binning pre-processing steps. (<bold>D</bold>) Aligned reads after validation checking and binning. Percentage improvements in sequencing depths due to multi-reads becoming uni-reads are depicted on top of each bar. (<bold>E</bold>) mHi-C modeling starts from the prior built by only uni-reads to quantify the relationship between random contact probabilities and the genomic distance between the contacts. This prior is updated by leveraging local bin pair contacts including both uni- and multi-reads and results in posterior probabilities that quantify the evidence for each potential contact to be the true genomic origin.</p><p><supplementary-material id="fig1sdata1"><object-id pub-id-type="doi">10.7554/eLife.38070.009</object-id><label>Figure 1—source data 1.</label><caption><title>Detailed summary of study datasets.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-38070-fig1-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>mHi-C pipeline (Alignment - Read end pairing - Valid fragment filtering).</title><p>1. Read ends are aligned to reference genome separately allowing multi-reads and chimeric reads to be rescued. 2. Read ends are paired by their read query names. Multi-reads form more than one read pair with the same read query name. Read ends that fail to align form either unmapped reads or singleton reads and are discarded. Multi-reads with ends aligning to more than 99 positions are regarded as low-quality multi-reads and are excluded from the downstream analysis. 3. Validation checking to filter short-range contacts and alignments far away from restriction enzyme recognition sites. Contacts residing within the same restriction fragment, that is dangling end or self-circle, as well as adjacent fragments (religation) are discarded. The above three processing steps are applied to each read independently enabling parallel implementation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.004</object-id><label>Figure 1—figure supplement 2.</label><caption><title>mHi-C pipeline (Duplicate removal - Genome binning - mHi-C).</title><p>4. PCR duplicates are removed to ensure that when a uni-read and a multi-read have the same alignment position and strand direction, the uni-read is kept. In the case of multi-reads that overlap with other multi-reads, the ones with alphabetically larger IDs are removed. 5. Genome is split into fix-sized non-overlapping intervals, that is bins or a fixed number of restriction fragments and, as a result, read alignment position pairs are reduced to bin pairs. Multi-reads, candidate alignment positions of which fall into the same bin, are reduced to uni-bin pairs. 6. mHi-C model estimates an allocation probability for each potential contact and enables filtering of contacts by thresholding this allocation probability.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.005</object-id><label>Figure 1—figure supplement 3.</label><caption><title>Coverage and <italic>cis</italic>-to-<italic>trans</italic> ratios across individual replicates of the study datasets as indicators of data quality.</title><p>(<bold>A</bold>) Coverage is approximated as the ratio of the sequencing depth to the genome size. (<bold>B</bold>) <italic>Cis</italic>-to-<italic>trans</italic> ratio is defined as the number of valid intra-chromosomal contacts divided by the number of valid inter-chromosomal contacts.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig1-figsupp3-v2.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.006</object-id><label>Figure 1—figure supplement 4.</label><caption><title>Percentages of (<bold>A</bold>) mappable and (<bold>B</bold>) valid reads over the set of all reads for individual replicates of the study datasets as an indicator of data quality.</title><p>Both the aligned uni-reads and multi-reads are taken into consideration.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig1-figsupp4-v2.tif"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.007</object-id><label>Figure 1—figure supplement 5.</label><caption><title>Categorization of reads after alignment across study datasets.</title><p>(<bold>A</bold>) Percentages of mapped reads in different alignment categories. (<bold>B</bold>) Percentages of valid reads with both ends uniquely aligned to reference genome (Uni-reads), at least one end aligning to multiple positions and resulting in only one valid alignment after validation and binning (Multi-reads (Reduce to Uni-reads)), and reads with multiple potential valid alignment positions (Multi-reads (Modeling)).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig1-figsupp5-v2.tif"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.008</object-id><label>Figure 1—figure supplement 6.</label><caption><title>Comparison of the prevalence of multi-reads and chimeric reads, both of which require additional processing.</title><p>(<bold>A</bold>) Numbers of multi-reads compared to the numbers of chimeric reads at each read end level. For Hi-C datasets with shorter read lengths, multi-reads constitute a larger percentage of the usable reads compared to chimeric reads. (<bold>B</bold>) Proportion of multi-reads among full-length alignable reads compared with that among chimeric reads. As expected, chimeric reads lead to larger percentages of multi-reads.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig1-figsupp6-v2.tif"/></fig></fig-group></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Multi-reads significantly increase the sequencing depths of Hi-C data</title><p>For developing mHi-C and studying its operating characteristics, we utilized six published studies, resulting in eight datasets with multiple replicates, as summarized in <xref ref-type="table" rid="table1">Table 1</xref> and with more details in <xref ref-type="supplementary-material" rid="fig1sdata1">Figure 1—source data 1</xref>: Table 1. These datasets represent a variety of study designs from different organisms, that is human and mouse cell lines as examples of large genomes and three different stages of <italic>Plasmodium falciparum</italic> red blood cell cycle as an example of a small and AT-rich genome. Specifically, they span a wide range of sequencing depths (<xref ref-type="fig" rid="fig1">Figure 1B</xref>), coverages and <italic>cis</italic>-to-<italic>trans</italic> ratios (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>), and have different proportions of mappable and valid reads (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). Before applying mHi-C to these datasets and investigating biological implications, we first established the substantial contribution of multi-reads to the sequencing depth across these datasets with diverse characteristics. At read-end level (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> for terminology), after the initial step of aligning to the reference genome (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s2">2</xref>), multi-reads constitute approximately 10% of all the mappable read ends (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5A</xref>). Moreover, the contribution of multi-reads to the set of aligned reads further increases by an additional 8% when chimeric reads (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>) are also taken into account (<xref ref-type="supplementary-material" rid="fig1sdata1">Figure 1—source data 1</xref>: Table 2). Most notably, <xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6A</xref> demonstrates that, in datasets with shorter read lengths, multi-reads constitute a larger percentage of usable reads compared to uniquely mapping chimeric reads that are routinely rescued in Hi-C analysis pipelines (<xref ref-type="bibr" rid="bib44">Servant et al., 2015</xref>; <xref ref-type="bibr" rid="bib35">Lun and Smyth, 2015</xref>; <xref ref-type="bibr" rid="bib16">Durand et al., 2016</xref>). Moreover, multi-reads also make up a significant proportion of the rescued chimeric reads (<xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6B</xref>). At the read pair level, after joining of both ends, multi-reads increase the sequencing depth by 18% to 23% for shorter read length datasets and 10% to 15% for longer read lengths, thereby providing a substantial increase to the depth before the read pairs are further processed into bin pairs (<xref ref-type="fig" rid="fig1">Figure 1C</xref>; <xref ref-type="supplementary-material" rid="fig1sdata1">Figure 1—source data 1</xref>: Table 3).</p><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.38070.010</object-id><label>Table 1.</label><caption><title>Hi-C Data Summary.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Cell line</th><th>Replicate</th><th>Read length (bp)</th><th>Restriction enzyme</th><th>HiC protocol</th><th>Source</th><th>Resolution (kb)</th></tr></thead><tbody><tr><td>IMR90</td><td>rep1-6</td><td>36</td><td>HindIII</td><td>dilution</td><td>(<xref ref-type="bibr" rid="bib27">Jin et al., 2013</xref>)</td><td>40</td></tr><tr><td>GM12878</td><td>rep2-9</td><td>101</td><td>MboI</td><td>in situ</td><td>(<xref ref-type="bibr" rid="bib41">Rao et al., 2014</xref>)</td><td>5, 10*, 40*</td></tr><tr><td>GM12878</td><td>rep32, rep33</td><td>101</td><td>DpnII</td><td>in situ</td><td>(<xref ref-type="bibr" rid="bib41">Rao et al., 2014</xref>)</td><td>5</td></tr><tr><td>A549</td><td>rep1-4</td><td>151</td><td>MboI</td><td>in situ</td><td>(<xref ref-type="bibr" rid="bib15">Dixon et al., 2018</xref>)</td><td>10, 40</td></tr><tr><td>ESC(2012)</td><td>rep1, rep2</td><td>36</td><td>HindIII</td><td>dilution</td><td>(<xref ref-type="bibr" rid="bib13">Dixon et al., 2012</xref>)</td><td>40</td></tr><tr><td>ESC(2017)</td><td>rep1-4</td><td>50</td><td>DpnII</td><td>in situ</td><td>(<xref ref-type="bibr" rid="bib6">Bonev et al., 2017</xref>)</td><td>10, 40</td></tr><tr><td>Cortex</td><td>rep1-4</td><td>50</td><td>DpnII</td><td>in situ</td><td>(<xref ref-type="bibr" rid="bib6">Bonev et al., 2017</xref>)</td><td>10, 40</td></tr><tr><td><italic>P. falciparum</italic></td><td>three stages</td><td>40</td><td>MboI</td><td>dilution</td><td>(<xref ref-type="bibr" rid="bib2">Ay et al., 2014b</xref>)</td><td>10, 40</td></tr></tbody></table><table-wrap-foot><fn><p><sup>*</sup>Replicates 2, 3, 4, and 6 of the GM12878 cell line datasets were process at 10 kb and 40 kb resolutions.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s2-2"><title>Multi-reads can be rescued at multiple processing stages of mHi-C pipeline</title><p>As part of the post-alignment pre-processing steps, Hi-C reads go through a series of validation checking to ensure that the reads that represent biologically meaningful fragments are retained and used for downstream analysis (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s2">2</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). mHi-C pipeline tracks multi-reads through these processing steps. Remarkably, in the application of mHi-C to all six studies, a subset of the high-quality multi-reads are reduced to uni-reads either in the validation step when only one candidate contact passes the validation screening, or because all the alignments of a multi-read reside within the same bin (<xref ref-type="fig" rid="fig1">Figure 1C</xref>; <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> and see Materials and methods). Collectively, mHi-C can rescue as high as 6.7% more valid read pairs (<xref ref-type="fig" rid="fig1">Figure 1D</xref>) that originate from multi-reads and are mapped unambiguously without carrying out any multi-reads specific procedure for large genomes and 10.4% for <italic>P. falciparum</italic>. Such improvement corresponds to millions of reads for deeper sequenced datasets (<xref ref-type="supplementary-material" rid="fig1sdata1">Figure 1—source data 1</xref>: Table 4). For the remaining multi-reads (<xref ref-type="fig" rid="fig1">Figure 1D</xref>, colored in pink), which, on average, make up 18% of all the valid reads (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5B</xref>), mHi-C implements a novel multi-mapping model and probabilistically allocates them.</p><p>mHi-C generative model (<xref ref-type="fig" rid="fig1">Figure 1E</xref> and see Materials and methods) is constructed at the bin-pair level to accommodate the typical signal sparsity of genomic interactions. The bins are either fixed-size non-overlapping genome intervals or a fixed number of restriction fragments derived from the Hi-C protocol. The resolutions at which seven cell lines are processed are summarized in <xref ref-type="table" rid="table1">Table 1</xref>. In the mHi-C generative model, we denote the observed alignment indicator vector for a given paired-end read <inline-formula><mml:math id="inf1"><mml:mi>i</mml:mi></mml:math></inline-formula> by vector <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and use unobserved hidden variable vector <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> to indicate its true genomic origin. Contacts captured by Hi-C assay can arise as random contacts of nearby genomic positions or true biological interactions. mHi-C generative model acknowledges this feature by utilizing data-driven priors, <inline-formula><mml:math id="inf4"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> for bin pairs <inline-formula><mml:math id="inf5"><mml:mi>j</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf6"><mml:mi>k</mml:mi></mml:math></inline-formula>, as a function of contact distance between the two bins. mHi-C updates these prior probabilities for each candidate bin pair that a multi-read can be allocated to by leveraging local contact counts. As a result, for each multi-read <inline-formula><mml:math id="inf7"><mml:mi>i</mml:mi></mml:math></inline-formula>, it estimates posterior probabilities of genomic origin variable <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Specifically, <inline-formula><mml:math id="inf9"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> = 1 <inline-formula><mml:math id="inf10"><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝒀</mml:mi><mml:mi mathvariant="bold-italic">𝒊</mml:mi></mml:msub></mml:math></inline-formula><inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> denotes the posterior probability, that is allocation probability, that the two read ends of multi-read <inline-formula><mml:math id="inf12"><mml:mi>i</mml:mi></mml:math></inline-formula> originate from bin pairs <inline-formula><mml:math id="inf13"><mml:mi>j</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf14"><mml:mi>k</mml:mi></mml:math></inline-formula>. These posterior probabilities, which can also be viewed as fractional contacts of multi-read <inline-formula><mml:math id="inf15"><mml:mi>i</mml:mi></mml:math></inline-formula>, are then utilized to assign each multi-read to the most likely genomic origin. Our results in this paper only utilized reads with allocation probability greater than 0.5. This ensured the output of mHi-C to be compatible with the standard input of the downstream normalization and statistical significance estimation methods (<xref ref-type="bibr" rid="bib25">Imakaev et al., 2012</xref>; <xref ref-type="bibr" rid="bib30">Knight and Ruiz, 2013</xref>; <xref ref-type="bibr" rid="bib1">Ay et al., 2014a</xref>).</p></sec><sec id="s2-3"><title>Probabilistic assignment of multi-reads results in more complete contact matrices and significantly improves reproducibility across replicates</title><p>Before quantifying mHi-C model performance, we provide a direct visual comparison of the contact matrices between Uni-setting and Uni&amp;Multi-setting using raw and normalized contact counts. <xref ref-type="fig" rid="fig2">Figure 2A</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplements 1</xref>–<xref ref-type="fig" rid="fig2s4">4</xref> clearly illustrate how multi-mapping reads fill in the low mappable regions and lead to more complete matrices, corroborating that repetitive genomic regions are under-represented without multi-reads. Quantitatively, for the combined replicates of GM12878, 99.61% of the 5 kb bins with interaction potential are covered by at least 100 raw contacts under the Uni&amp;Multi-setting, compared to 98.72% under Uni-setting, thereby allowing us to study 25.55 Mb more of the genome. For normalized contact matrices, the coverage increases from 99.42% in Uni-setting to 99.97% in Uni&amp;Multi-setting (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>). In addition to increasing the sequencing depth in extremely low contact bins for both raw and normalized contact counts, higher bin-level coverage after leveraging multi-mapping reads appears as a global pattern across the genome for raw contact matrices (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplements 6</xref> and <xref ref-type="fig" rid="fig2s7">7</xref>). <xref ref-type="fig" rid="fig2s8">Figure 2—figure supplement 8</xref> provides the histogram of bin-level differences of normalized contact counts between the two settings and indicates a positive average difference. While some bins appear to have their contact counts decreased in the Uni&amp;Multi-setting compared to Uni-setting after normalization (purple bar in <xref ref-type="fig" rid="fig2s8">Figure 2—figure supplement 8A</xref>), comparison of the raw contact counts in <xref ref-type="fig" rid="fig2s8">Figure 2—figure supplement 8B</xref> shows that these bins do indeed have lower raw contact counts in the Uni-setting compared to Uni&amp;Multi-setting and that the reduction observed is an artifact of normalization. This also highlights that multi-reads alleviate the inflation of low raw contact count regions due to normalization. These major improvements in coverage provide direct evidence that mHi-C is rescuing multi-reads that originate from biologically valid fragments.</p><p>We assessed the impact of multi-reads rescued by mHi-C on the reproducibility from the point of both raw contact counts and significant interactions detected. We used the stratum-adjusted correlation coefficient proposed in HiCRep (<xref ref-type="bibr" rid="bib52">Yang et al., 2017</xref>) for evaluating the reproducibility of Hi-C contact matrices. <xref ref-type="fig" rid="fig2">Figure 2B</xref> and <xref ref-type="fig" rid="fig2s9">Figure 2—figure supplements 9</xref> and <xref ref-type="fig" rid="fig2s10">10</xref> illustrate that integrating multi-reads leads to increased reproducibility and reduced variability of stratum-adjusted correlation coefficients among biological replicates across all the study datasets. Furthermore, we observe that, for some chromosomes, for example, chr17 of IMR90 and chr16 of GM12878, the improvement in reproducibility stands out, without a systematic behavior across datasets. A close examination of improvement in reproducibility as a function of the ratio of rescued multi-reads to uni-reads across chromosomes highlights the larger proportion of multi-reads rescued for these chromosomes (<xref ref-type="fig" rid="fig2s11">Figure 2—figure supplement 11</xref>). To further assess that the improvement in reproducibility did not manifest due to an unaccounted systematic bias in the assignment of multi-reads, we evaluated reproducibility similarly between replicates of GM12878 and replicates of IMR90. <xref ref-type="fig" rid="fig2s12">Figure 2—figure supplement 12</xref> shows that Uni-setting and Uni&amp;Multi-setting lead to similar levels of reproducibility between replicates of these unrelated samples with all Wilcoxon rank-sum test p-values of the pairwise comparisons between Uni- and Uni&amp;Multi-settings &gt; 0.21; therefore, ruling out the possibility of a systematic bias as the source of improvement in reproducibility due to multi-reads.</p><p>In addition to the direct comparison of the raw contact matrices and their reproducibility, we identified the set of significant interactions by Fit-Hi-C (<xref ref-type="bibr" rid="bib1">Ay et al., 2014a</xref>) and assessed the reproducibility of the identified interactions. <xref ref-type="fig" rid="fig2">Figure 2C</xref> shows that mHi-C significantly improves reproducibility of detected interactions across all the pairwise comparisons of replicates within each study dataset. <xref ref-type="fig" rid="fig2s13">Figure 2—figure supplement 13A</xref> presents more details on the degree of overlap among the significant interactions identified at 5% and 10% false discovery rate (FDR) across replicates for the IMR90 datasets. These comparisons highlight that significant interactions specific to Uni&amp;Multi-setting have consistently higher reproducibility than those specific to Uni-setting across all pairwise comparisons. Since random contacts tend to arise due to short genomic distances between loci, we stratified the significant interactions based on distance and reassessed the reproducibility as a function of the genomic distance between the contacts (<xref ref-type="fig" rid="fig2s13">Figure 2—figure supplement 13B</xref>). Notably, significant interactions identified only by the Uni-setting and those common to both settings have a stronger gradual descending trend as a function of the genomic distance, indicating decaying reproducibility for long-range interactions. In contrast, Uni&amp;Multi-setting maintains a relatively higher and stable reproducibility for longer genomic distances.</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.38070.011</object-id><label>Figure 2.</label><caption><title>Global impact of multi-reads in Hi-C analysis.</title><p>(<bold>A</bold>) Contact matrices of GM12878 with combined reads from replicates 2–9 are compared under Uni-setting and Uni&amp;Multi-setting using raw and normalized contact counts for chr6:25.5 Mb - 28.5 Mb. White gaps of Uni-reads contact matrix, due to lack of reads from repetitive regions, are filled in by multi-reads, hence resulting in a more complete contact matrix. Such gaps remain in the Uni-setting even after normalization. Red squares at the left bottom of the matrices indicate the color scale. (<bold>B</bold>) Reproducibility of Hi-C contact matrices by HiCRep across all pairwise comparisons between replicates under the Uni- and Uni&amp;Multi-settings (IMR90 and GM12878 are displayed). (<bold>C</bold>) Reproducibility of the significant interactions across replicates of the study datasets. Reproducibility is assessed by overlapping interactions detected at FDR of 5% for pairs of replicates within each study dataset.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.012</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Raw and normalized contact matrices of GM12878 under Uni-setting and Uni&amp;Multi-setting on chromosome 1.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.013</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Raw and normalized contact matrices of GM12878 under Uni-setting and Uni&amp;Multi-setting on chromosome 2.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.014</object-id><label>Figure 2—figure supplement 3.</label><caption><title>Raw and normalized contact matrices of GM12878 under Uni-setting and Uni&amp;Multi-setting on chromosome 3.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.015</object-id><label>Figure 2—figure supplement 4.</label><caption><title>Raw and normalized contact matrices of GM12878 under Uni-setting and Uni&amp;Multi-setting on chromosome 5.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-figsupp4-v2.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.016</object-id><label>Figure 2—figure supplement 5.</label><caption><title>Proportion of bins that are covered by at least 100 (row 1) or 1000 (row 2) contacts for raw contact matrices (column 1) and normalized contact matrices (column2) under Uni- and Uni&amp;Multi-settings for GM12878 with combined reads from replicates 2–9 at 5 kb resolution.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-figsupp5-v2.tif"/></fig><fig id="fig2s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.017</object-id><label>Figure 2—figure supplement 6.</label><caption><title>Bin coverage improvement of raw contact matrices under Uni&amp;Multi-setting compared to Uni-setting for GM12878 with combined reads from replicates 2–9 at 5 kb.</title><p>Only chromosome 1–9 are shown and the pattern for the rest chromosomes are very similar. The dashed line is y = x.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-figsupp6-v2.tif"/></fig><fig id="fig2s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.018</object-id><label>Figure 2—figure supplement 7.</label><caption><title>Bin coverage improvement of raw contact matrices under Uni&amp;Multi-setting compared to Uni-setting for IMR90 at the individual replicate level for two different allocation probability thresholds.</title><p>Uni&amp;Multi-setting for (<bold>A</bold>) includes multi-reads with a posterior probability &gt; 0.5, whereas (<bold>B</bold>) depicts more strict filtering with an allocation probability &gt; 0.9 The dashed line is y = x. mHi-C rescues multi-reads from valid ligation fragments, resulting in a significant increase in contact counts.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-figsupp7-v2.tif"/></fig><fig id="fig2s8" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.019</object-id><label>Figure 2—figure supplement 8.</label><caption><title>Bin coverage comparison of normalized contact matrices under Uni&amp;Multi- and Uni-settings for GM12878 with combined reads from replicates 2–9 at 5 kb.</title><p>(<bold>A</bold>) Histogram of the bin-level differences between normalized contact counts of the Uni&amp;Multi- and Uni-settings. Green bars represent increased counts under the Uni&amp;Multi-setting, and purple ones indicate no change or decrease. Bins in the purple bar group are low coverage bins under the Uni-setting and have inflated normalized contact counts. Only chromosome 1–3 are shown, and the pattern for the rest of the chromosomes are very similar. (<bold>B</bold>) Raw contact count comparison of the top 0.01% bins of Panel A with drastically higher normalized contact counts under the Uni-setting compared to the Uni&amp;Multi-setting (purple bars). The contact counts of these bins get inflated by normalization. The dashed lines are y = x.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-figsupp8-v2.tif"/></fig><fig id="fig2s9" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.020</object-id><label>Figure 2—figure supplement 9.</label><caption><title>Reproducibility at the contact matrix level under the Uni- and Uni&amp;Multi-settings in A549, ESC-2017 and Cortex cell lines.</title><p>Note that the box plots for the ESC-2012 cell line which only has two replicates are not displayed.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-figsupp9-v2.tif"/></fig><fig id="fig2s10" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.021</object-id><label>Figure 2—figure supplement 10.</label><caption><title>Reproducibility at the contact matrix level at resolutions 40 kb (low) and 10 kb (high) across study datasets.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-figsupp10-v2.tif"/></fig><fig id="fig2s11" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.022</object-id><label>Figure 2—figure supplement 11.</label><caption><title>Percent improvement in reproducibility due to the Uni&amp;Multi-setting versus the proportion of the number of valid multi-reads compared to the number of the uni-reads in the datasets.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-figsupp11-v2.tif"/></fig><fig id="fig2s12" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.023</object-id><label>Figure 2—figure supplement 12.</label><caption><title>Reproducibility at the contact matrix level under the Uni- and Uni&amp;Multi-settings between GM12878 and IMR90 at 40 kb resolution.</title><p>Each box contains reproducibility measurements on 23 chromosomes between every two pairs of replicates from GM12878 and IMR90. Within each panel, one GM12878 replicate contact matrix is compared with each of the six IMR90 replicates respectively for Uni- and Uni&amp;Multi-settings.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-figsupp12-v2.tif"/></fig><fig id="fig2s13" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.024</object-id><label>Figure 2—figure supplement 13.</label><caption><title>Reproducibility of significant interactions for IMR90.</title><p>(<bold>A</bold>) Significant interactions are classified into three categories: Uni-setting specific or Uni&amp;Multi-setting specific or common to both. Reproducibility is evaluated by the percentage of significant interactions reproduced in another replicate within the same category. (<bold>B</bold>) Reproducibility of significant interactions stratified by genomic distance. Reproducibility is evaluated by the percentage of significant interactions reproduced in another replicate within the same category and genomic distance range.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig2-figsupp13-v2.tif"/></fig></fig-group></sec><sec id="s2-4"><title>2.4 Multi-reads detect novel significant interactions</title><p>At 5% false discovery rate, mHi-C detects 20% to 50% more novel significant interactions for relatively highly sequenced study datasets (<xref ref-type="fig" rid="fig3">Figure 3A</xref> and <xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>; <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> for other FDR thresholds and resolutions). The gains are markedly larger for datasets with smaller sequencing depths (e.g., ESC-2012) or extremely high coverage (e.g., <italic>P. falciparum</italic>). Overall gains in the number of novel contacts persist as the cutoff for mHi-C posterior probabilities of multi-read assignments varies (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). At fixed FDR, significant interactions identified by the Uni&amp;Multi-setting also include the majority of significant interactions inferred from the Uni-setting, indicating that incorporating multi-reads is extending the significant interaction list (low level of purple lines in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>).</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.38070.025</object-id><label>Figure 3.</label><caption><title>Gain in the numbers of novel significant interactions by mHi-C and their characterization by chromatin marks.</title><p>(<bold>A</bold>) Percentage increase in detected significant interactions (FDR 5%) by comparing contacts identified in Uni&amp;Multi-setting with those of Uni-setting across study datasets at 40 kb resolution. (<bold>B</bold>) Percentage change in the numbers of significant interactions (FDR 5%) as a function of the percentage of mHi-C rescued multi-reads in comparison to uni-read and <italic>cis</italic>-to-<italic>trans</italic> ratios of individual datasets at 40 kb resolution. (<bold>C</bold>) Recovery of significant interactions identified at 1% FDR by analysis at 10% FDR, aggregated over the replicates of GM12878 at 40 kb resolution. Detailed descriptions of the groups are provided in <xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>. (<bold>D</bold>) Average number of contacts falling within the significant interactions (5% FDR) that overlapped with each chromHMM annotation category across six replicates of IMR90 identified by Uni- and Uni&amp;Multi-settings. (<bold>E</bold>) Average number of contacts (5% FDR) that overlapped with significant interactions and different types of ChIP-seq peaks associated with different genomic functions (IMR90 six replicates). Red/Green labels denote smaller/larger differences between the two settings compared to the differences observed in the ”Others’ category that depict non-peak regions.</p><p><supplementary-material id="fig3sdata1"><object-id pub-id-type="doi">10.7554/eLife.38070.043</object-id><label>Figure 3—source data 1.</label><caption><title>Percentage of improvement in the number of significant interactions across six studies at resolution 40 kb.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-38070-fig3-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.026</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Percentage change in the numbers of significant interactions under the Uni&amp;Multi-setting compared to Uni-setting at 0.1%, 1%, 5% and 10% FDR thresholds and resolutions (<bold>A</bold>) 40 kb and (<bold>B</bold>) 10 kb.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.027</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Comparison of significant interactions as a function of posterior probabilities of multi-read assignment (IMR90 40 kb).</title><p>Percentage change in the numbers of significant interactions gained (Green) and lost (Purple) by the Uni&amp;Multi-setting compared to the Uni-setting across individual IMR90 replicates for varying FDR and allocation probability thresholds.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.028</object-id><label>Figure 3—figure supplement 3.</label><caption><title>Heatmap for marginal correlations of percentage increase in the number of identified significant interactions (FDR 5%) with indicators of data quality across study datasets excluding <italic>P. falciparum</italic> at 40 kb.</title><p>The relative percentage of multi-reads added to uni-reads as well as <italic>cis</italic>-to-<italic>trans</italic> ratio is leading impact factors (with p-values <inline-formula><mml:math id="inf16"><mml:mo>≤</mml:mo></mml:math></inline-formula> 0.005) followed by the percentage of mappable reads and valid reads.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp3-v2.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.029</object-id><label>Figure 3—figure supplement 4.</label><caption><title>Percentage change in the numbers of significant interactions with respect to <italic>cis</italic>-to-<italic>trans</italic> ratio excluding <italic>P. falciparum</italic> at 40 kb.</title><p><italic>Cis</italic>-to-<italic>trans</italic> ratio is defined as the number of valid intra-chromosomal contact counts divided by the number of valid inter-chromosomal contact counts.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp4-v2.tif"/></fig><fig id="fig3s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.040</object-id><label>Figure 3—figure supplement 5.</label><caption><title>Percentage change in the numbers of significant interactions of GM12878 datasets at different resolutions.</title><p>(<bold>A</bold>) Percentage change in the numbers of significant interactions of GM12878 datasets at 5 kb, 10 kb, 40 kb resolutions, respectively, across varying FDR thresholds. (<bold>B</bold>) Percentage change in the numbers of significant interactions of 8 replicates that are based on MboI as the restriction enzyme and two replicates with DpnII as restriction enzyme at 5 kb resolution across different FDR thresholds. (<bold>C</bold>) Percentage change in the numbers of significant interactions with respect to the replicate sequencing depth of all 10 replicates of GM12878 at 5 kb resolution across different FDR thresholds.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp5-v2.tif"/></fig><fig id="fig3s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.041</object-id><label>Figure 3—figure supplement 6.</label><caption><title>Percentage change in the numbers of significant interactions with respect to coverage at 40 kb.</title><p>Coverage is approximated as the ratio of the sequencing depth to the genome size.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp6-v2.tif"/></fig><fig id="fig3s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.030</object-id><label>Figure 3—figure supplement 7.</label><caption><title>Percentage change in the numbers of significant interactions as a function of the percentage of mHi-C rescued multi-reads in comparison to uni-reads and <italic>cis</italic>-to-<italic>trans</italic> ratios at 40 kb.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp7-v2.tif"/></fig><fig id="fig3s8" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.031</object-id><label>Figure 3—figure supplement 8.</label><caption><title>Recovery of significant interactions identified at FDR 1% by analysis at FDR 10% for each of six replicates of IMR90 at 40 kb.</title><p>Uni&amp;Multi-setting. Specific (Uni FDR 10%) is the set of significant interactions identified at 1% FDR by the Uni&amp;Multi-setting but are still unrecoverable by the Uni-setting even with a liberal FDR of 10%. The detailed descriptions of the groups are as follows: Uni-setting (FDR 1%): # of significant interactions identified by the Uni-setting at 1% FDR. Uni&amp;Multi-setting (FDR 1%): # of significant interactions identified by the Uni&amp;Multi-setting at 1% FDR. Uni-setting.Specific (Uni&amp;Multi FDR 1%): # of significant interactions identified by Uni-setting (FDR 1%) but not by Uni&amp;Multi-setting at 1% FDR. Uni-setting.Specific (Uni&amp;Multi FDR 10%): # of significant interactions identified by Uni-setting (FDR 1%) but not by Uni&amp;Multi-setting at 10% FDR. Uni&amp;Multi-setting.Specific (Uni FDR 1%): # of significant interactions identified by Uni&amp;Multi-setting (FDR 1%) but not by Uni-setting at 1% FDR. Uni&amp;Multi-setting.Specific (Uni FDR 10%): # of significant interactions identified by Uni&amp;Multi-setting (FDR 1%) but not by Uni-setting at 10% FDR.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp8-v2.tif"/></fig><fig id="fig3s9" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.032</object-id><label>Figure 3—figure supplement 9.</label><caption><title>Recovery of significant interactions identified at FDR 1% by analysis at FDR 10% for each of four replicates of GM12878 at 40 kb resolution.</title><p>Color labels are the same as <xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp9-v2.tif"/></fig><fig id="fig3s10" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.033</object-id><label>Figure 3—figure supplement 10.</label><caption><title>Recovery of significant interactions identified at FDR 1% by analysis at FDR 10% for each of four replicates of GM12878 at 10 kb resolution.</title><p>Color labels are the same as <xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp10-v2.tif"/></fig><fig id="fig3s11" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.034</object-id><label>Figure 3—figure supplement 11.</label><caption><title>Recovery of significant interactions identified at FDR 1% by analysis at FDR 10% for each of ten replicates of GM12878 at 5 kb resolution.</title><p>Color label is the same as <xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp11-v2.tif"/></fig><fig id="fig3s12" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.042</object-id><label>Figure 3—figure supplement 12.</label><caption><title>Recovery of significant interactions identified at FDR 1% by analysis at FDR 10% for GM12878 summed across replicates at 5 kb, 10 kb, and 40 kb resolutions.</title><p>Color label is the same as <xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp12-v2.tif"/></fig><fig id="fig3s13" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.035</object-id><label>Figure 3—figure supplement 13.</label><caption><title>ROC and PR curves for replicates 5 and 6 of IMR90.</title><p>Sets of ‘True’ interactions and ‘True’ non-interactions are defined by reproducible significant/insignificant interactions across replicate 1–4 of both Uni-setting and Uni&amp;Multi-setting (See Materials and methods). Significant interactions of replicates 5 and 6 are utilized to compare ROC (<bold>A</bold>) and PR (<bold>B</bold>) curves among the Uni- and Uni&amp;Multi-settings.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp13-v2.tif"/></fig><fig id="fig3s14" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.036</object-id><label>Figure 3—figure supplement 14.</label><caption><title>Quantification of significant interactions for chromHMM states and ChIP-seq peak regions (IMR90).</title><p>(<bold>A</bold>) Grouping the significant interactions into three groups (Uni-setting specific, Uni&amp;Multi-setting specific, Common to both settings) reveals the largest enrichment differences in chromHMM annotation categories related to repetitive regions, such as Zinc Finger Genes &amp; Repeats as well as Heterochromatin. (<bold>B</bold>) Average number of significant interactions across regions with a variety of ChIP-seq signals. Red/green labels denote smaller/larger differences between Uni-setting specific and Uni&amp;Multi-setting specific compared to the differences observed in the ‘Others’ category that depicts non-peak regions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp14-v2.tif"/></fig><fig id="fig3s15" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.037</object-id><label>Figure 3—figure supplement 15.</label><caption><title>Marginalized Hi-C signal (contact counts aggregated across the genomic coordinates for six replicates of IMR90), ChIP-seq coverage and peaks and gene expression for chr1:16,000,000–18,000,000.</title><p>Highlighted in grey is a region with significantly different marginal Hi-C signal between Uni-setting and Uni&amp;Multi-setting.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp15-v2.tif"/></fig><fig id="fig3s16" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.038</object-id><label>Figure 3—figure supplement 16.</label><caption><title>Marginalized Hi-C signal (contact counts aggregated across the genomic coordinates for six replicates of IMR90), ChIP-seq coverage and peaks and gene expression for chr2:113460,000–116,000,000.</title><p>Highlighted in grey is a region with significantly different marginal Hi-C signal between Uni-setting and Uni&amp;Multi-setting.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp16-v2.tif"/></fig><fig id="fig3s17" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.039</object-id><label>Figure 3—figure supplement 17.</label><caption><title>Marginalized Hi-C signal (contact counts aggregated across the genomic coordinates for six replicates of IMR90), ChIP-seq coverage and peaks and gene expression for chr9:66,250,000–66,950,000.</title><p>Highlighted in grey is a region with significantly different marginal Hi-C signal between Uni-setting and Uni&amp;Multi-setting.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig3-figsupp17-v2.tif"/></fig></fig-group><p>We leveraged the diverse characteristics of the study datasets and investigated the factors that impacted the gain in the detected significant interactions due to multi-reads. The top row of <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref> summarizes the marginal correlations of the percentage change in the number of identified significant interactions (at 40 kb resolution and FDR of 0.05) with the data characteristics commonly used to indicate the quality of Hi-C datasets (excluding the high coverage <italic>P. falciparum</italic> dataset). These marginal associations highlight the significant impact of the relative contribution of multi-reads to the sequencing depth compared to uni-reads and <italic>cis</italic>-to-<italic>trans</italic> ratio of contacts (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>). <xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref> increase in the number of novel significant interactions for the GM12878 datasets in more detail across a set of FDR thresholds and at different resolutions, and includes two types of restriction enzymes. Specifically, <xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5C</xref> illustrates a clear negative association between the sequencing depth and the percent improvement in the number of identified significant interactions at 5 kb resolution due to the larger impact of multi-reads on the smaller depth replicates. As an exception, we note that <italic>P. falciparum</italic> datasets tend to exhibit significantly higher gains in the number of identified contacts especially under stringent FDR thresholds (<xref ref-type="fig" rid="fig3">Figure 3A</xref>), possibly due to the ultra-high coverage of these datasets (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>). In addition to these marginal associations, <xref ref-type="fig" rid="fig3">Figure 3B</xref> and <xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref> display the percentage increase in the number of identified significant interactions as a function of the percentage increase in the real depth due to multi-reads and the <italic>cis</italic>-to-<italic>trans</italic> ratio across all the study datasets. A consistent pattern highlights that short read datasets with large proportion of mHi-C rescued multi-reads compared to uni-reads enjoy a larger increase in the number of identified significant interactions regardless of the FDR threshold, while for datasets with similar relative contribution of multi-reads, for example within lower depth IMR90, <italic>cis</italic>-to-<italic>trans</italic> ratios positively correlate with the increase in the number of identified significant interactions.</p><p>We next asked whether novel significant interactions due to rescued multi-reads could have been identified under the Uni-setting by employing a more liberal FDR threshold. Leveraging multi-reads with posterior probability larger than 0.5 and controlling the FDR at 1%, Fit-Hi-C identified 32.49% more significant interactions compared to Uni-setting (comparing dark green to dark purple bar in <xref ref-type="fig" rid="fig3">Figure 3C</xref>) and 36.43% of all significant interactions are unique to Uni&amp;Multi-setting (light green bar over dark green bar in <xref ref-type="fig" rid="fig3">Figure 3C</xref>) collectively for all the four replicates of GM12878 at 40 kb resolution. We observed that 34.89% of these novel interactions (yellow bar over the light green bar in <xref ref-type="fig" rid="fig3">Figure 3C</xref>) at 1% FDR (i.e., 12.71% compared to the all the significant interactions under Uni&amp;Multi-setting) cannot be recovered even by a more liberal significant interaction list under Uni-setting at 10% FDR. Conversely, Uni&amp;Multi-setting is unable to recover only 4.60% of the Uni-setting contacts once the FDR is controlled at 10% for the Uni&amp;Multi-setting (light blue over dark purple bar in <xref ref-type="fig" rid="fig3">Figure 3C</xref>), highlighting again that Uni&amp;Multi-setting predominantly adds on novel significant interactions while retaining interactions that are identifiable under the Uni-setting. A similar analysis for individual replicates of IMR90 are provided in <xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8</xref> as well as those of GM12878 at the individual replicate level or collective analysis at 5 kb, 10 kb, and 40 kb resolutions in <xref ref-type="fig" rid="fig3s9">Figure 3—figure supplements 9</xref>–<xref ref-type="fig" rid="fig3s12">12</xref>. We further confirmed this consistent power gain by a Receiver Operating Characteristic (ROC) and a Precision-Recall (PR) analysis (<xref ref-type="fig" rid="fig3s13">Figure 3—figure supplement 13</xref>). The PR curve illustrates that at the same false discovery rate (1-precision), mHi-C achieves consistently higher power (recall) than the Uni-setting in addition to better AUROC performance.</p></sec><sec id="s2-5"><title>Chromatin features of novel significant interactions</title><p>To further establish the biological implications of mHi-C rescued multi-reads, we investigated genomic features of novel contacts. Annotation of the significant interactions with ChromHMM segmentations from the Roadmap Epigenomics project (<xref ref-type="bibr" rid="bib31">Kundaje et al., 2015</xref>) highlights marked enrichment of significant interactions in annotations involving repetitive DNA (<xref ref-type="fig" rid="fig3">Figure 3D</xref>, <xref ref-type="fig" rid="fig3s14">Figure 3—figure supplement 14A</xref>). Most notably, ZNF genes and repeats and Heterochromatin states exhibit the largest discrepancy of the average significant interaction counts between the Uni- and Uni&amp;Multi-settings. To complement the evaluation with ChromHMM annotations, we evaluated the Uni-setting and Uni&amp;Multi-setting significant interaction enrichment of genomic regions harboring histone marks and other biochemical signals (<xref ref-type="bibr" rid="bib17">ENCODE Project Consortium, 2012</xref>; <xref ref-type="bibr" rid="bib27">Jin et al., 2013</xref>) (See Materials and methods) by comparing their average contact counts to those without such signal (<xref ref-type="fig" rid="fig3">Figure 3E</xref> and data on Dryad, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.v7k3140">https://doi.org/10.5061/dryad.v7k3140</ext-link>). Notably, while we observe that multi-reads boost the average number of contacts with biochemically active regions of the genome, they contribute more to regions that harbor H3K27me3 peaks (<xref ref-type="fig" rid="fig3">Figure 3E</xref>, <xref ref-type="fig" rid="fig3s14">Figure 3—figure supplement 14B</xref>). Such regions are associated with downregulation of nearby genes through forming heterochromatin structure (<xref ref-type="bibr" rid="bib18">Ferrari et al., 2014</xref>). <xref ref-type="fig" rid="fig3s15">Figure 3—figure supplement 15</xref>–<xref ref-type="fig" rid="fig3s17">17</xref> further provide specific examples of how increased marginal contact counts due to multi-reads are supported by signals of histone modifications, CTCF binding sites, and gene expression. Many genes of biological significance reside in these regions. For example, NBPF1 (<xref ref-type="fig" rid="fig3s15">Figure 3—figure supplement 15</xref>) is implicated in many neurogenetic diseases and its family consists of dozens of recently duplicated genes primarily located in segmental duplications (<xref ref-type="bibr" rid="bib43">Safran et al., 2010</xref>). In addition, RABL2A within the highlighted region of <xref ref-type="fig" rid="fig3s16">Figure 3—figure supplement 16</xref> is a member of RAS oncogene family.</p></sec><sec id="s2-6"><title>Multi-reads discover novel promoter-enhancer interactions</title><p>We found that a significant impact of multi-reads is on the detection of promoter-enhancer interactions. Overall, mHi-C identifies 14.89% more significant promoter-enhancer interactions at 5% FDR collectively for six replicates for IMR90 (<xref ref-type="supplementary-material" rid="fig4sdata1">Figure 4—source data 1</xref>: Table 1 and <xref ref-type="supplementary-material" rid="fig4sdata2">Figure 4—source data 2</xref>). Of these interactions, 13,313 are reproducible among all six replicates under Uni&amp;Multi-setting (<xref ref-type="supplementary-material" rid="fig4sdata1">Figure 4—source data 1</xref>: Table 2) and 62,971 are reproducible for at least two replicates (<xref ref-type="supplementary-material" rid="fig4sdata1">Figure 4—source data 1</xref>: Table 3) leading to 15.84% more novel promoter-enhancer interactions specific to Uni&amp;Multi-setting. <xref ref-type="fig" rid="fig4">Figure 4A</xref> provides WashU epigenome browser (<xref ref-type="bibr" rid="bib59">Zhou et al., 2011</xref>) display of such novel reproducible promoter-enhancer interactions on chromosome 1. <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplements 1</xref>–<xref ref-type="fig" rid="fig4s2">2</xref> provides more such reproducible examples and <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref> depicts the reproducibility of these interactions in more details across the six replicates.</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.38070.045</object-id><label>Figure 4.</label><caption><title>Novel promoter-enhancer interactions are reproducible and associated with actively expressed genes.</title><p>(<bold>A</bold>) mHi-C identifies novel significant promoter-enhancer interactions (green arcs) that are reproducible among at least two replicates in addition to those reproducible under the Uni-setting (purple arcs). Shaded and the boxed regions correspond to the anchor and target bins, respectively. The top track displays the contact counts associated with the anchor bin under Uni- and Uni&amp;Multi-settings. Related chromHMM annotation color labels are added around the track. The complete color labels are consistent with ChromHMM 15-state model at <ext-link ext-link-type="uri" xlink:href="https://egg2.wustl.edu/roadmap/web_portal/chr_state_learning.html">https://egg2.wustl.edu/roadmap/web_portal/chr_state_learning.html</ext-link>. (<bold>B</bold>) Average gene expression with standard errors for five different scenarios of interactions that group promoters into six different categories. In the first panel, significant interactions involving promoters are classified into five settings, and the average gene expressions across genes with the corresponding promoters are depicted. The second panel involves two alignment settings and genes without any promoter interactions at 5% FDR. This panel is further separated into two categories: promoters that overlap with enhancer annotated regions and those that do not. The latter one serves as the baseline for average expression. Genes contributing to the third and fourth panel have promoter-enhancer, promoter-promoter interactions at 5% FDR. The fifth panel considers genes promoters of which have significant interactions with non-enhancer and non-promoter regions. Numbers in the parenthesis correspond to the number of transcripts in each category.</p><p><supplementary-material id="fig4sdata1"><object-id pub-id-type="doi">10.7554/eLife.38070.049</object-id><label>Figure 4—source data 1.</label><caption><title>The number of significant promoter-enhancer Hi-C interactions at FDR 5% under Uni-setting and Uni&amp;Multi-setting, respectively, for six replicates of IMR90.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-38070-fig4-data1-v2.xlsx"/></supplementary-material></p><p><supplementary-material id="fig4sdata2"><object-id pub-id-type="doi">10.7554/eLife.38070.050</object-id><label>Figure 4—source data 2.</label><caption><title>Significant promoter-enhancer interactions at FDR 5% under Uni-setting and Uni&amp;Multi-setting for six replicates of IMR90 with the number of contacts.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-38070-fig4-data2-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.046</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Examples of significant promoter-enhancer interactions reproducible among six replicates under Uni- and Uni&amp;Multi-settings (IMR90) on chromosome 7.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.051</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Examples of significant promoter-enhancer interactions reproducible among 6 replicates under Uni- and Uni&amp;Multi-settings (IMR90) on chromosome 17.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig4-figsupp2-v2.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.047</object-id><label>Figure 4—figure supplement 3.</label><caption><title>Significant promoter-emhancer interactions under Uni- and Uni&amp;Multi-settings across 6 IMR90 replicates (Chromosome 17).</title><p>This is the individual replicate level data for <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref> in a large genome region.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig4-figsupp3-v2.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.048</object-id><label>Figure 4—figure supplement 4.</label><caption><title>Expression distribution of genes promoters of which have significant promoter interactions (IMR90).</title><p>Genes harboring significant interactions (at 5% FDR) within their promoters are grouped into different gene expression categories.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig4-figsupp4-v2.tif"/></fig></fig-group><p>We next validated the novel promoter-enhancer interactions by investigating the expression levels of the genes contributing promoters to these interactions. <xref ref-type="fig" rid="fig4">Figure 4B</xref> supports that genes with significant interactions in their promoters generally exhibit higher expression levels (comparing bars 1–5 to bars 8–9 in <xref ref-type="fig" rid="fig4">Figure 4B</xref>). Furthermore, if these interactions involve an enhancer, the average gene expression can be 38.17% higher than that of the overall promoters with significant interactions (comparing bars 10–11 to bars 1–2 in <xref ref-type="fig" rid="fig4">Figure 4B</xref>). Most remarkably, newly detected significant promoter-enhancer interactions (bar 13 in <xref ref-type="fig" rid="fig4">Figure 4B</xref>) exhibit a stably higher gene expression level, highlighting that, without multi-reads, biologically supported promoter-enhancer interactions are underestimated. In addition, an overall evaluation of significant interactions (5% FDR) that considers interactions from promoters with low expression (TPM <inline-formula><mml:math id="inf17"><mml:mo>≤</mml:mo></mml:math></inline-formula> 1) as false positives illustrate that mHi-C specific significant promoter interactions have false positive rates comparable to or smaller than those of significant promoter interactions common to Uni- and Uni&amp;Multi-settings (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>). In contrast, Uni-setting specific interactions have elevated false positive rates.</p></sec><sec id="s2-7"><title>Multi-reads refine the boundaries of topologically associating domains</title><p>We next investigated the impact of mHi-C rescued multi-reads on the topologically associating domains (TADs) (<xref ref-type="bibr" rid="bib40">Pombo and Dillon, 2015</xref>), where we used a broad definition of TADs to include contact and loop domains. We used the DomainCaller (<xref ref-type="bibr" rid="bib13">Dixon et al., 2012</xref>; <xref ref-type="bibr" rid="bib14">Dixon et al., 2015</xref>) to infer TADs of IMR90 datasets at 40 kb resolution and Arrowhead (<xref ref-type="bibr" rid="bib41">Rao et al., 2014</xref>) for GM12878 datasets at 5 kb resolution under Uni&amp;Multi-settings (<xref ref-type="supplementary-material" rid="fig5sdata1">Figure 5—source data 1</xref> and <xref ref-type="supplementary-material" rid="fig5sdata2">2</xref>). The detected TADs are compared to those under the Uni-setting. While this comparison did not reveal stark differences in the numbers of TADs identified under the two settings (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>), we found that Uni&amp;Multi-setting identifies 2.01% more reproducible TADs with 2.36% lower non-reproducible TADs across replicates (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). Several studies have revealed the role of CTCF in establishing the boundaries of genome architecture (<xref ref-type="bibr" rid="bib38">Ong and Corces, 2014</xref>; <xref ref-type="bibr" rid="bib47">Tang et al., 2015</xref>; <xref ref-type="bibr" rid="bib23">Hsu et al., 2017</xref>). While this is an imperfect indicator of TAD boundaries, we observed that a slightly higher proportion of the detected TADs have CTCF peaks with convergent CTCF motif pairs at the boundaries once multi-reads are utilized (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2A–C</xref>). <xref ref-type="fig" rid="fig5">Figure 5B</xref> provides an explicit example of how the gap in the contact matrix due to depletion of multi-reads biases the inferred TAD structure. In addition to discovery of novel TADs (<xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>) by filling in the gaps in the contact matrix and boosting the domain signals, mHi-C also refines TAD boundaries (<xref ref-type="fig" rid="fig5s4">Figure 5—figure supplements 4</xref> and <xref ref-type="fig" rid="fig5s5">5</xref>), and eliminates potential false positive TADs that are split by the contact depleted gaps in Uni-setting (<xref ref-type="fig" rid="fig5s6">Figure 5—figure supplements 6</xref>–<xref ref-type="fig" rid="fig5s8">8</xref>). The novel, adjusted, and eliminated TADs are largely supported by CTCF signal identified using both uni- and multi-reads ChIP-seq datasets (<xref ref-type="bibr" rid="bib55">Zeng et al., 2015</xref>) as well as convergent CTCF motifs (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2D</xref>), providing support for mHi-C driven modifications to these TADs and revealing a slightly lower false discovery rate for mHi-C compared to Uni-setting (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2E</xref>, and <xref ref-type="fig" rid="fig5s9">Figure 5—figure supplement 9</xref>).</p><fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.38070.052</object-id><label>Figure 5.</label><caption><title>mHi-C rescued multi-reads refine detected topologically associating domains.</title><p>(<bold>A</bold>) Percentage of topologically associating domains (TADs) that are reproducibly detected under Uni-setting and Uni&amp;Multi-setting. TADs that are not detected in at least 4 of the six replicates are considered as non-reproducible. (<bold>B</bold>) Comparison of the contact matrices with superimposed TADs between Uni- and Uni&amp;Multi-setting for chr10:72,550,000–97,550,000. Red squares at the left bottom of the matrices indicate the color scale. TADs affected by white gaps involving repetitive regions are highlighted in light green. Light green outlined areas correspond to new TAD boundaries. (<bold>C</bold>) False discovery rate of TADs detected under two settings. TADs that are not reproducible and lack CTCF peaks at the TAD boundaries are labeled as false positives. (<bold>D</bold>) Average number of repetitive elements at the boundaries of reproducible TADs compared to those within TADs and genomewide intervals of the same size for GM12878 at 5 kb resolution.</p><p><supplementary-material id="fig5sdata1"><object-id pub-id-type="doi">10.7554/eLife.38070.064</object-id><label>Figure 5—source data 1.</label><caption><title>Topologically associating domains detected by DomainCaller (<xref ref-type="bibr" rid="bib13">Dixon et al., 2012</xref>) under Uni&amp;Multi-setting for six replicates of IMR90.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-38070-fig5-data1-v2.zip"/></supplementary-material></p><p><supplementary-material id="fig5sdata2"><object-id pub-id-type="doi">10.7554/eLife.38070.065</object-id><label>Figure 5—source data 2.</label><caption><title>Topologically associating domains detected by Arrowhead (<xref ref-type="bibr" rid="bib41">Rao et al., 2014</xref>) under Uni&amp;Multi-setting for ten replicates of GM12878.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-38070-fig5-data2-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.053</object-id><label>Figure 5—figure supplement 1.</label><caption><title>The number of topologically associating domains (TADs) detected in each chromosome under Uni-setting and Uni&amp;Multi-setting (IMR90).</title><p>(<bold>A</bold>) Total number of TADs identified across six replicates for each chromosome. (<bold>B</bold>) Total number of TADs identified across 23 chromosomes for each replicate.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.054</object-id><label>Figure 5—figure supplement 2.</label><caption><title>Comparison of CTCF peaks at the boundaries of topologically associating domains (TADs) under Uni-setting and Uni&amp;Multi-setting across six replicates of IMR90.</title><p>(<bold>A</bold>) Percentages of TADs that have CTCF peaks at boundaries. (<bold>B</bold>) Percentages of TADs that have both CTCF peaks and convergent CTCF motifs at the boundaries. (<bold>C</bold>) Percentages of four types of CTCF motifs orientations at TAD boundaries. Convergent motif pairs are those with a forward strand motif upstream of TAD boundaries and a reverse strand motif downstream of TAD boundaries. Tandem Right, similarly, represents forward-forward CTCF motif pairs. Tandem Left refers to reverse-reverse motif pairs. Divergent is reverse-forward motif pairs (<bold>D</bold>) Some TAD boundaries are adjusted under Uni&amp;Multi-setting. Box plots depict the percentage of adjusted TADs that have convergent CTCF motifs at the boundaries. (<bold>E</bold>). False discovery rate of TADs detected under the two settings. TADs that are not reproducible and lack CTCF convergent motifs at the TAD boundaries are considered as false positives.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig5-figsupp2-v2.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.055</object-id><label>Figure 5—figure supplement 3.</label><caption><title>Novel topologically associating domains (TADs) with CTCF peaks at TAD boundaries (IMR90).</title><p>Gene tracks, 24mer mappability tracks as well as CTCF peaks are displayed above the contact matrices. (<bold>A</bold>) Example at chr6:5,350,000–33,850,000. Even in the lack of obviously low mappable contact gaps, multi-reads can enhance the existing interaction signal and reveal detectable TAD structures supported by CTCF peaks. (<bold>B</bold>) Example on chr9:15,150,000–43,650,000. TAD structure, supported by CTCF peaks at the TAD boundaries, becomes detectable as multi-reads fill in the gap in the contact matrix. Red squares at the left bottom of the matrices indicate the color scale.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig5-figsupp3-v2.tif"/></fig><fig id="fig5s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.056</object-id><label>Figure 5—figure supplement 4.</label><caption><title>Existing topologically associating domains (TADs) with adjusted boundaries supported by CTCF peaks at the new TAD boundaries (IMR90).</title><p>(<bold>A</bold>) An example from chr1:66,800,000–95,300,000. (<bold>B</bold>) An example from chr5:0–28,500,000. Red squares at the left bottom of the matrices indicate the color scale.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig5-figsupp4-v2.tif"/></fig><fig id="fig5s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.057</object-id><label>Figure 5—figure supplement 5.</label><caption><title>Existing topologically associating domains (TADs) with adjusted boundaries supported by CTCF peaks at the new TAD boundaries (IMR90).</title><p>(<bold>A</bold>) An example from chr12:0–25,000,000. (<bold>B</bold>) An example from chr13:42,800,000–71,300,000. Red squares at the left bottom of the matrices indicate the color scale.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig5-figsupp5-v2.tif"/></fig><fig id="fig5s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.058</object-id><label>Figure 5—figure supplement 6.</label><caption><title>False positive topologically associating domains (TADs) detected by the Uni-setting due to the missing reads in low mappability regions (IMR90).</title><p>TADs that are split by white gaps are no longer detected once multi-reads are incorporated, indicating that they are highly likely false positives under the Uni-setting. (<bold>A</bold>) Example on chr2:105,600,000–134,100,000. (<bold>B</bold>) Example on chr3:60,000,000–88,500,000. Red squares at the left bottom of the matrices indicate the color scale.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig5-figsupp6-v2.tif"/></fig><fig id="fig5s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.059</object-id><label>Figure 5—figure supplement 7.</label><caption><title>False positive topologically associating domains (TADs) detected by the Uni-setting due to the missing reads in low mappability regions (IMR90).</title><p>TADs that are split by white gaps are no longer detected once multi-reads are incorporated, indicating that they are highly likely false positives under the Uni-setting. (<bold>A</bold>) Example on chr4:0–28,500,000. (<bold>B</bold>) Example on chr16:0–28,500,000. Red squares at the left bottom of the matrices indicate the color scale.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig5-figsupp7-v2.tif"/></fig><fig id="fig5s8" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.060</object-id><label>Figure 5—figure supplement 8.</label><caption><title>False positive topologically associating domains (TADs) detected by the Uni-setting due to the missing reads in low mappability regions (IMR90).</title><p>TADs that are split by white gaps are no longer detected once multi-reads are incorporated, indicating that they are highly likely false positives under the Uni-setting. (<bold>A</bold>) Example on chr21:14,350,000–42,850,000. (<bold>B</bold>) Example on chrX:60,800,000–117,800,000. Red squares at the left bottom of the matrices indicate the color scale.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig5-figsupp8-v2.tif"/></fig><fig id="fig5s9" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.061</object-id><label>Figure 5—figure supplement 9.</label><caption><title>False discovery rate of TADs detected under Uni-setting and Uni&amp;Multi-setting (IMR90).</title><p>TADs that are not reproducible are labeled as false positives without considering the CTCF peaks at the TAD boundaries.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig5-figsupp9-v2.tif"/></fig><fig id="fig5s10" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.062</object-id><label>Figure 5—figure supplement 10.</label><caption><title>Percentage of TAD boundaries co-localized with different types of repetitive elements under Uni-setting and Uni&amp;Multi-setting for IMR90 at 40 kb and GM12878 at 5 kb.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig5-figsupp10-v2.tif"/></fig><fig id="fig5s11" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.063</object-id><label>Figure 5—figure supplement 11.</label><caption><title>Average number of repetitive elements at the reproducible topologically associating domains detected under Uni-setting and Uni&amp;Multi-setting for IMR90 at 40 kb.</title><p>Such enrichment is compared to those within TADs and genomewide intervals of the same size.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig5-figsupp11-v2.tif"/></fig></fig-group><p>Next, we assessed the abundance of different classes of repetitive elements, from the RepeatMasker (<xref ref-type="bibr" rid="bib39">Open R, 2015</xref>) and UCSC genome browser (<xref ref-type="bibr" rid="bib49">Tyner et al., 2017</xref>) hg19 assembly, at the reproducible TAD boundaries. Specifically, we considered segmental duplications (DUP), short interspersed nuclear elements (SINE), long interspersed nuclear elements (LINE), long terminal repeat elements (LTR), DNA transposon (DNA) and satellites (SATE). We utilized ± bin on either side of the edge coordinate of a given domain as its TAD boundary. At a lower resolution, that is 40 kb for IMR90, each boundary is 120 kb region and the percentages of TAD boundaries with each type of repetitive element illustrate negligible differences between the Uni-setting and Uni&amp;Multi-setting (<xref ref-type="fig" rid="fig5s10">Figure 5—figure supplement 10A</xref>). Similarly, due to the large sizes of the TAD boundaries, a majority of TAD boundaries harbor SINE, LINE, LTR, and DNA transposon elements. However, higher resolution analysis of the GM12878 dataset at 5 kb reveals SINE elements as the leading category of elements that co-localizes with more than 99% of TAD boundaries followed by LINEs (<xref ref-type="fig" rid="fig5s10">Figure 5—figure supplement 10B</xref>). This is consistent with the fact that SINE and LINE elements are relatively short and cover a larger portion of the human genome compared to other subfamilies (15% for SINE and 21% for LINE; <xref ref-type="bibr" rid="bib48">Treangen and Salzberg, 2012</xref>). We further quantified the enrichment of repetitive elements at TAD boundaries by comparing their average abundance with those within TADs and the genomic intervals of the same size across the whole genome as the baseline. <xref ref-type="fig" rid="fig5">Figure 5D</xref> and <xref ref-type="fig" rid="fig5s11">Figure 5—figure supplement 11</xref> show that SINE elements, satellites, and segmental duplications are markedly enriched at the TAD boundaries compared to the whole genome and within TADs. More interestingly, at higher resolution, that is 5 kb for GM12878, the SINE category both have the highest average enrichment and is enhanced by mHi-C (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). In summary, under Uni&amp;Multi-setting, the detected TAD boundaries tend to harbor more SINE elements supporting prior work that human genome folding is markedly associated with the SINE family (<xref ref-type="bibr" rid="bib10">Cournac et al., 2016</xref>).</p></sec><sec id="s2-8"><title>Large-scale evaluation of mHi-C with computational trimming experiments and simulations establishes its accuracy</title><p>Before further investigating the accuracy of mHi-C rescued multi-reads with computational experiments, we considered heuristic strategies for rescuing multi-reads at different stages of the Hi-C analysis pipeline as alternatives to mHi-C (<xref ref-type="fig" rid="fig6">Figure 6A</xref>; see Materials and methods for detailed descriptions of the model-free approaches and related analysis). Specifically, AlignerSelect and DistanceSelect rescue multi-reads by simply choosing one of the alignments of a multi-read pair by default aligner strategy and based on distance, respectively. In addition to these, we designed a direct alternative to mHi-C, named SimpleSelect, as a model-free approach that imposes genomic distance priority in contrast to leveraging of the local interaction signals of the bins by mHi-C (e.g., local contact counts due to other read pairs in candidate bin pairs).</p><fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.38070.066</object-id><label>Figure 6.</label><caption><title>Assessing the accuracy of mHi-C allocation by trimming experiments with the A549 study set of 151 bp reads.</title><p>(<bold>A</bold>) Intuitive heuristic strategies (AlignerSelect, DistanceSelect, SimpleSelect) for model-free assignment of multi-reads at various stages the of Hi-C analysis pipeline. (<bold>B</bold>) Accuracy of mHi-C in allocating trimmed multi-reads with respect to trimmed read length, compared with model-free approaches as well as random selection as a baseline. (<bold>C</bold>) Allocation accuracy with respect to mappability for 75 bp reads. Red solid line depicts the overall accuracy trend. ‘Not assigned’ category refers to multi-reads with a maximum posterior probability of assignment <inline-formula><mml:math id="inf18"><mml:mo>≤</mml:mo></mml:math></inline-formula> 0.5. (<bold>D</bold>) mHi-C accuracy among different repetitive element classes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.067</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Summary of the sequencing depths of the full length and trimmed datasets of A549.</title><p>(<bold>A</bold>) Numbers of uni-reads and multi-reads across trimmed read lengths compared to the sequencing depth of uni-reads of full read length A549 dataset (replicate 2), not including uni-reads rescued from chimeric reads. (<bold>B</bold>) Percentage of multi-reads over uni-reads in the full-length A549 datasets (four replicates, excluding uni-reads from chimeric reads) and the trimmed datasets. Multi-to-uni percentages of the read sets in the trimmed datasets cover the range of the percentages observed in the study datasets. (<bold>C</bold>) Numbers of multi-reads from different trimming lengths compared to sequencing depths of the full read length A549 datasets. For the trimming setting (ii) described in Materials and methods, multi-reads (green bars) added to the uni-read datasets (blue bars) constitute a smaller percentage of the sequencing depth while enabling analysis at the higher resolution of 10 kb.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.068</object-id><label>Figure 6—figure supplement 2.</label><caption><title>Allocation accuracy at the 40 kb resolution among different mappability regions for trimmed reads of varying lengths.</title><p>mHi-C &gt; 0.5 refers to the fact that only the allocations with posterior probability of assignment greater than 0.5 are evaluated.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig6-figsupp2-v2.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.069</object-id><label>Figure 6—figure supplement 3.</label><caption><title>Intra-chromosomal and intra&amp;inter-chromosomal allocation accuracy with respect to trimmed read length using uni-reads of replicate 1, 3, and 4 combined with multi-reads of replicate 2 (trimming setting (ii)).</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig6-figsupp3-v2.tif"/></fig><fig id="fig6s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.070</object-id><label>Figure 6—figure supplement 4.</label><caption><title>Evaluating accuracy of mHi-C allocation with simulations.</title><p>(<bold>A</bold>) Allocation accuracy of mHi-C at 40 kb and 10 kb resolutions. (<bold>B</bold>) Allocation accuracy for simulated reads of different lengths among regions of varying mappability.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig6-figsupp4-v2.tif"/></fig><fig id="fig6s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.071</object-id><label>Figure 6—figure supplement 5.</label><caption><title>Allocation accuracy across different mappability regions for trimmed reads of 36 bp, 50 bp, 75 bp, 100 bp, and 125 bp, using uni-reads of replicate 1, 3, and 4, respectively.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig6-figsupp5-v2.tif"/></fig><fig id="fig6s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.072</object-id><label>Figure 6—figure supplement 6.</label><caption><title>Allocation accuracy across different classes of repetitive elements at 10 kb and 40 kb resolutions using uni-reads of replicates one, three, and combined with multi-reads of replicate two (trimming setting (ii)).</title><p>(<bold>A</bold>) mHi-C accuracy among different types of repetitive element classes with respect to trimmed read length. (<bold>B</bold>) Allocation accuracy across different classes of repetitive elements at 10 kb and 40 kb resolutions using uni-reads of replicate 1, 3, and 4 combined with multi-reads of replicate 2 (trimming setting (ii)).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig6-figsupp6-v2.tif"/></fig><fig id="fig6s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.073</object-id><label>Figure 6—figure supplement 7.</label><caption><title>Comparison of significant interactions with respect to genomic distance and life stages between SimpleSelect and mHi-C.</title><p>(<bold>A</bold>) Comparison of genomic distance distributions of significant interactions between SimpleSelect and mHi-C for IMR90 rep5 (FDR <inline-formula><mml:math id="inf19"><mml:mo>&lt;</mml:mo></mml:math></inline-formula> 0.001). (<bold>B</bold>) Comparison of significant interactions among the three life stages of <italic>P. falciparum</italic>. Y-axis in each panel, namely rings, trophozoites, and schizonts, depicts the percentage of contacts that are significant only in the panel condition compared to the other two conditions. Under varying FDR thresholds, mHi-C and Uni-setting tend to have similar percentages of differential interactions among ring - trophozoites - schizonts plasmodium life stages. In contrast, SimpleSelect tends to underestimate differential interactions due to over-emphasizing contact distance prior.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig6-figsupp7-v2.tif"/></fig></fig-group><p>To evaluate the accuracy of mHi-C in a setting with ground truth, we carried out trimming experiments with the A549 151 bp read length dataset and Hi-C data simulations where we compared mHi-C to both a random allocation strategy as the baseline and the additional heuristic approaches we developed (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). Specifically, we trimmed the set of 151 bp uni-reads from A549 into read lengths of 36 bp, 50 bp, 75 bp, 100 bp, and 125 bp. As a result, a subset of uni-reads at the full read length of 151 bp with known alignment positions were reduced into multi-reads, generating gold-standard multi-read sets with known true origins. The resulting numbers of valid uni- and multi-reads are summarized in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref> in comparison with the numbers of valid uni-reads in the original A549 datasets. The corresponding multi-to-uni ratios of these settings vary with the lengths of the trimmed reads, and their range covers the typical multi-to-uni ratios observed in the full read length datasets (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref>).</p><p>We first investigated the multi-read allocation accuracy with respect to trimmed read length, sequencing depth, and mappability at resolution 40 kb. <xref ref-type="fig" rid="fig6">Figure 6B</xref> exhibits superior performance of mHi-C over both the model-free methods and the random baseline in correctly allocating multi-reads of different lengths to their true origins across intra- and inter-chromosomal contacts. As expected and illustrated by <xref ref-type="fig" rid="fig6">Figure 6B</xref>, the accuracy of multi-read assignment has an increasing trend with the read length. Specifically, it ranges between 70% and 90% for mHi-C and 20% and 35% for the random allocation strategy for the shortest and longest trimmed read lengths of 36 bp and 125 bp, respectively. When the allocated multi-reads are stratified as a function of the mappability, reads with the lowest mappability (&lt;0.1) have accuracy levels of less than 32% to 70% across the trimmed read lengths (<xref ref-type="fig" rid="fig6">Figure 6C</xref> for 75 bp, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref> for the other trimming lengths). Notably, the accuracy quickly reaches 74% to 87% for reads with mappability of at least 0.5 (<xref ref-type="fig" rid="fig6">Figure 6C</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>).</p><p>Next, we assessed the allocation accuracy among different classes of repetitive elements (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). Allocations involving segmental duplication regions exhibit a systematically lower performance compared to other repeat classes and the overall average across the whole genome for all five trimming settings. Notably, even for these segmental duplication regions, the accuracy of mHi-C is markedly higher than both the model-free approaches and the random selection baseline displayed in <xref ref-type="fig" rid="fig6">Figure 6B</xref>. To finalize the accuracy investigation, we further varied the trimming setting by mixing uni-reads and multi-reads from different replicates (see setting (ii) of trimming strategies in Materials and methods) and considering resolutions of 10 kb and 40 kb in addition to an empirical Hi-C simulation. <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplements 3</xref>–<xref ref-type="fig" rid="fig6s6">6</xref> provide accuracy results closely following the results presented in this section from these additional settings and further validate significantly better performance of mHi-C compared to the random allocation and other heuristic approaches across different trimmed read lengths.</p><p>After establishing accuracy, we evaluated the impact of mHi-C rescued multi-reads of the trimmed datasets on the recovery of the (original) full read length contact matrices, topological domain structures, and significant interactions. To assess the recovery of the original contact matrix, we compared both the trimmed Uni- and Uni&amp;Multi-settings with the gold standard Uni-setting at the full read length utilizing HiCRep (<xref ref-type="bibr" rid="bib52">Yang et al., 2017</xref>). <xref ref-type="fig" rid="fig7">Figure 7A</xref> and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref> illustrate that mHi-C achieves significant improvement in the reproducibility across all chromosomes under all trimming settings compared to the Uni-setting. While the pattern of reproducibility with different read lengths in <xref ref-type="fig" rid="fig7">Figure 7A</xref> is consistent with the expectation that the longer trimmed reads should yield contact matrices that are more similar to the full read length one, the improvement in reproducibility due to mHi-C is markedly larger compared to the gains from longer read sequences making multi-read rescue essential. For example, the reproducibility for Uni&amp;Multi-setting at 50 bp is 8.84% to 27.33% higher than that of Uni-setting at 125 bp. We further evaluated reproducibility under each trimming setting across replicates and benchmarked the results against the reproducibility of the Uni-setting with the original read length of 151 bp. <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplements 2</xref> and <xref ref-type="fig" rid="fig7s3">3</xref> confirm the gain in reproducibility across replicates due to Uni&amp;Multi-setting for all the trimming lengths. As expected, the reproducibility across replicates based on the uni-reads of the original read length is higher than the levels achievable by the Uni&amp;Multi-Setting at trimmed read lengths. This comparison further supports that mHi-C assigns multi-reads in a biologically meaningful manner as was evidenced earlier by the increased reproducibility among replicates of the same condition (<xref ref-type="fig" rid="fig2">Figure 2B</xref> and <xref ref-type="fig" rid="fig2s9">Figure 2—figure supplements 9</xref> and <xref ref-type="fig" rid="fig2s10">10</xref>) but not across replicates of the different conditions (<xref ref-type="fig" rid="fig2s12">Figure 2—figure supplement 12</xref>). It also rules out the possibility of inflation of the reproducibility metric by consistent but biologically irrelevant assignment of multi-reads to certain loci. TAD identification with these trimmed sets highlights the sensitivity of TAD boundary detection to the sequencing depth. <xref ref-type="fig" rid="fig7">Figure 7B</xref> and <xref ref-type="fig" rid="fig7s4">Figure 7—figure supplements 4</xref>–<xref ref-type="fig" rid="fig7s7">7</xref> display examples where the trimmed Uni&amp;Multi-setting achieved better recovery of TAD structure of the full-length dataset compared to trimmed Uni-setting. Overall, this performance is attributable to the accuracy of mHi-C assignments and the resulting increase in sequencing depth of the trimmed uni-read dataset. Finally, we compared the significant interactions detected by the trimmed Uni- and Uni&amp;Multi-settings and observed that mHi-C rescued multi-reads in trimmed datasets enable detection of a larger number of interactions across a range of FDR thresholds (<xref ref-type="fig" rid="fig7s8">Figure 7—figure supplement 8</xref>). Most notably, an evaluation of detection power for the top 10K significant interactions of the full-length dataset demonstrates that, while the Uni-setting can only recover 50% of these at the trimmed read length of 36 bp, Uni&amp;Multi-setting recovers 70% (<xref ref-type="fig" rid="fig7">Figure 7C</xref> and <xref ref-type="fig" rid="fig7s9">Figure 7—figure supplement 9</xref>). We note that these power values are slightly underestimated because the full-length uni-read dataset also included chimeric reads that were rescued as uni-reads. In contrast, trimmed reads in the trimming experiments were generated from uni-reads without rescuing chimeric reads (see Materials and methods; <xref ref-type="fig" rid="fig7s10">Figure 7—figure supplement 10</xref>). Despite this, the 26.19% increase in sequencing depth due to multi-reads at the trimmed read length of 36 bp (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref>) translated into a significantly better recovery of the significant interactions. Further assessment by ROC and PR analysis (<xref ref-type="fig" rid="fig7">Figure 7D, E</xref> and <xref ref-type="fig" rid="fig7s11">Figure 7—figure supplement 11</xref>) of the set of significant contacts identified by both settings illustrates that Uni&amp;Multi-setting exhibits these advantages without inflating the false discoveries. As reads get longer towards the full length, the ROC and PR curves converge under the two settings (<xref ref-type="fig" rid="fig7s11">Figure 7—figure supplement 11</xref>).</p><fig-group><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.38070.074</object-id><label>Figure 7.</label><caption><title>Trimmed uni- and multi-reads to recover the original contact matrix of the longer read dataset A549.</title><p>(<bold>A</bold>) mHi-C rescued multi-reads of the trimmed dataset along with trimmed uni-reads lead to contact matrices that are significantly more similar to original contact matrices compared to only using trimmed uni-reads. (<bold>B</bold>) TAD detection on chromosome six with the original longer uni-reads contact matrix with black TAD boundaries, trimmed uni-reads (36 bp) contact matrix with green TAD boundaries, and trimmed uni- and multi-reads (36 bp) contact matrix with blue TAD boundaries. (<bold>C</bold>) The power of recovering top 10,000 significant interactions of full read length dataset using trimmed reads under FDR10%. (<bold>D, E</bold>) Receiver Operating Characteristic (ROC) and Precision-Recall (PR) curves for trimmed Uni- and Uni&amp;Multi-setting. The ground truth for these curves is based on the significant interactions identified by the full read length dataset at FDR of 10%. The dashed line is y = x.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.075</object-id><label>Figure 7—figure supplement 1.</label><caption><title>Reproducibility of trimmed Uni-setting and trimmed Uni&amp;Multi-setting across different read lengths at 40 kb resolution.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig7-figsupp1-v2.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.076</object-id><label>Figure 7—figure supplement 2.</label><caption><title>Reproducibility comparison between original Uni-setting and trimmed Uni-setting and Uni&amp;Multi-setting across replicates at 40 kb resolution.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig7-figsupp2-v2.tif"/></fig><fig id="fig7s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.077</object-id><label>Figure 7—figure supplement 3.</label><caption><title>Reproducibility comparison between original Uni-setting and trimmed Uni- and Uni&amp;Multi-settings across chromosomes at 40 kb resolution.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig7-figsupp3-v2.tif"/></fig><fig id="fig7s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.078</object-id><label>Figure 7—figure supplement 4.</label><caption><title>TAD detection on chromosome 3 of original longer uni-reads contact matrix with black TAD boundaries, trimmed uni-reads (36 bp) contact matrix with green TAD boundaries and trimmed uni- and multi-reads (36 bp) contact matrix with blue TAD boundaries.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig7-figsupp4-v2.tif"/></fig><fig id="fig7s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.079</object-id><label>Figure 7—figure supplement 5.</label><caption><title>TAD detection on chromosome 7 of original longer uni-reads contact matrix, trimmed uni-reads (36 bp) contact matrix and trimmed uni- and multi-reads (36 bp) contact matrix.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig7-figsupp5-v2.tif"/></fig><fig id="fig7s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.080</object-id><label>Figure 7—figure supplement 6.</label><caption><title>TAD detection on chromosome 7 of original longer uni-reads contact matrix, trimmed uni-reads (36 bp) contact matrix and trimmed uni- and multi-reads (36 bp) contact matrix.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig7-figsupp6-v2.tif"/></fig><fig id="fig7s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.081</object-id><label>Figure 7—figure supplement 7.</label><caption><title>TAD detection on chromosome 10 of original longer uni-reads contact matrix with black TAD boundaries, trimmed uni-reads (36 bp) contact matrix with green TAD boundaries and trimmed uni- and multi-reads (36 bp) contact matrix with blue TAD bounaries.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig7-figsupp7-v2.tif"/></fig><fig id="fig7s8" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.082</object-id><label>Figure 7—figure supplement 8.</label><caption><title>Numbers of significant interactions identified with trimmed reads under Uni- and Uni&amp;Multi-settings at FDR 0.1%, 1%, 5%, 10%.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig7-figsupp8-v2.tif"/></fig><fig id="fig7s9" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.083</object-id><label>Figure 7—figure supplement 9.</label><caption><title>Power is computed as the percentage of top 10,000 significant interactions of the full read length dataset detected by the analysis of trimmed read datasets under FDR of 10%.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig7-figsupp9-v2.tif"/></fig><fig id="fig7s10" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.084</object-id><label>Figure 7—figure supplement 10.</label><caption><title>Comparison of read decompositions of ‘rep2’ with ‘rep2-NonChimericReads’ sequencing depths indicates that in the full read length dataset, a large proportion of the uni-reads are due to rescued chimeric reads (i.e., these are Uni- or Multi-reads in rep2 and Singletons in rep2-NonChimericReads).</title><p>Downstream analysis of trimming experiments beyond evaluating the accuracy of multi-read assignments utilized Uni-reads of rep2 displayed here for deriving gold standard interaction sets.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig7-figsupp10-v2.tif"/></fig><fig id="fig7s11" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38070.085</object-id><label>Figure 7—figure supplement 11.</label><caption><title>ROC and PR curves for detection of full read length dataset significant interactions by the analysis of trimmed read datasets under the trimmed Uni- and Uni&amp;Multi-settings at read lengths of 50 bp, 75 bp, 100 bp, and 125 bp.</title><p>In the ROC curves, the false positive rates are displayed up until 10% as the values of both the x- and y-axis rates shoot up to one after this value. Ground truth for these curves is based on the significant interactions identified by the full read length dataset at FDR of 10%.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-38070-fig7-figsupp11-v2.tif"/></fig></fig-group></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Hi-C data are powerful for identifying long-range interacting loci, chromatin loops, topologically associating domains (TADs), and A/B compartments (<xref ref-type="bibr" rid="bib34">Lieberman-Aiden et al., 2009</xref>; <xref ref-type="bibr" rid="bib54">Yu and Ren, 2017</xref>). Multi-mapping reads, however, are absent from the typical Hi-C analysis pipelines, resulting in under-representation and under-study of three-dimensional genome organization involving repetitive regions. Consequently, downstream analysis of Hi-C data relies on the incomplete Hi-C contact matrices which have frequent and, sometimes, severe interaction gaps spanning across the whole matrix. While centromeric regions contribute to such gaps, our results indicate that lack of multi-reads in the analysis is a significant contributor. Our Hi-C multi-read mapping strategy, mHi-C, probabilistically allocates high-quality multi-reads to their most likely positions (<xref ref-type="fig" rid="fig1">Figure 1E</xref>) and successfully fills in the missing chunks of contact matrices (<xref ref-type="fig" rid="fig2">Figure 2A</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplements 1</xref>–<xref ref-type="fig" rid="fig2s4">4</xref>). As a result, incorporating multi-reads yields remarkable increase in sequencing depth which is translated into significant and consistent gains in reproducibility of the raw contact counts (<xref ref-type="fig" rid="fig2">Figure 2B</xref>) and detected interactions (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). Analysis with mHi-C rescued reads identifies novel significant interactions (<xref ref-type="fig" rid="fig3">Figure 3</xref>), promoter-enhancer interactions (<xref ref-type="fig" rid="fig4">Figure 4</xref>), and refines domain structures (<xref ref-type="fig" rid="fig5">Figure 5</xref>). Our computational experiments with trimmed and simulated Hi-C reads validate mHi-C and elucidate the significant impact of multi-reads in all facets of the Hi-C data analysis. We demonstrate that even for the shortest read length of 36 bp, mHi-C accuracy exceeds 74% (85% for longer trimmed reads) for regions with underlying mappability of at least 0.5 (<xref ref-type="fig" rid="fig6">Figure 6C</xref> and <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). mHiC significantly outperforms a baseline random allocation strategy as well as several other model-free and intuitive multi-read allocation strategies while achieving its worst allocation accuracy of 63% for reads originating from segmental duplications (<xref ref-type="fig" rid="fig6">Figure 6B and D</xref>). Trimming experiments further demonstrated the utility of multi-reads for contact matrix, TAD, and significant interaction recovery (<xref ref-type="fig" rid="fig7">Figure 7</xref>).</p><p>The default setting of mHi-C is intentionally conservative. In this default setting, mHi-C rescues high-quality multi-reads that can be allocated to a candidate alignment position with a high probability of at least 0.5. mHi-C allows relaxation of this strict filtering where instead of keeping reads with allocation probability greater than 0.5, these posterior allocation probabilities can be utilized as fractional contacts. We chose not to pursue this approach in this work as the current downstream analysis pipelines do not accommodate such fractional contacts. Currently, mHi-C model does not take into account potential copy number variations and genome arrangements across the genome. While mHi-C model can be extended to take into account estimated copy number and arrangement maps of the underlying sample genomes as we have done for other multi-read problems (<xref ref-type="bibr" rid="bib56">Zhang and Keleş, 2014</xref>), our computational experiments with cancerous human alveolar epithelial cells A549 does not reveal any notable deterioration in mHi-C accuracy for these cells with copy number alternations.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>mHi-C workflow</title><p>We developed a complete pipeline customized for incorporating high-quality multi-mapping reads into the Hi-C data analysis workflow. The overall pipeline, illustrated in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s2">2</xref>, incorporates the essential steps of the Hi-C analysis pipelines. In what follows, we outline the major steps of the analysis to explicitly track multi-reads and describe how mHi-C utilizes them.</p><sec id="s4-1-1"><title>Read end alignment: uni- and multi-reads and chimeric reads</title><p>The first step in the mHi-C pipeline is the alignment of each read end separately to the reference genome. The default aligner in the mHi-C software is BWA (<xref ref-type="bibr" rid="bib33">Li and Durbin, 2010</xref>); however mHi-C can work with any aligner that outputs multi-reads. The default alignment parameters are (i) edit distance maximum of 2 including mismatches and gap extension; and (ii) a maximum number of gap open of 1. mHi-C sets the maximum number of alternative hits saved in the XA tag to be 99 to keep track of multi-reads. If the number of alternative alignments exceeds the threshold of 99 in the default setting, these alignments are not recorded in XA tag. We regarded these alignments as low-quality multi-mapping reads compared to those multi-mapping reads that have a relatively smaller number of alternative alignments. In summary, low-quality multi-mapping reads are discarded together with unmapped reads, only leaving uniquely mapping reads and high-quality multi-mapping reads for downstream analysis. mHi-C pipeline further restricts the maximum number of mismatches (maximum to be 2 compared to three in BWA default setting) to ensure that the alignment quality of multi-reads is comparable to that of standard Hi-C pipeline.</p><p>Chimeric reads, that span ligation junction of the Hi-C fragments (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>) are also a key component of Hi-C analysis pipelines. The ligation junction sequence can be derived from the restriction enzyme recognition sites and used to rescue chimeric reads. mHi-C adapts the pre-splitting strategy of diffHiC (<xref ref-type="bibr" rid="bib35">Lun and Smyth, 2015</xref>), which is modified from the existing Cutadapt (<xref ref-type="bibr" rid="bib36">Martin, 2011</xref>) software. Specifically, the read ends are trimmed to the center of the junction sequence. If the trimmed left 5' ends are not too short, for example ≥ 25 bps, these chimeric reads are remapped to the reference genome. As the lengths of the chimeric reads become shorter, these reads tend to become multi-reads.</p></sec><sec id="s4-1-2"><title>Valid fragment filtering</title><p>While each individual read end is aligned to reference genome separately, inferring interacting loci relies on alignment information of paired-ends. Therefore, read ends are paired after unmapped and singleton read pairs as well as low-quality multi-mapping ends (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> and <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>) are discarded. After pairing, read end alignments are further evaluated for their representation of valid ligation fragments that originate from biologically meaningful long-range interactions (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). First, reads that do not originate from around restriction enzyme digestion sites are eliminated since they primarily arise due to random breakage by sonication (<xref ref-type="bibr" rid="bib5">Belaghzal et al., 2017</xref>). This is typically achieved by filtering the reads based on the total distance of two read end alignments to the restriction site. We required the total distance to be within 50–800 bps for the mammalian datasets and 50–500 bps for <italic>P. falciparum</italic>. The lower bound of 50 for this parameter is motivated by the chimeric reads with as short as 25 bps on both ends. Second, a single Hi-C interaction ought to involve two restriction fragments. Therefore, read ends falling within the same fragment, either due to dangling end or self-circle ligation, are filtered. Third, because the nature of chromatin folding leads to the abundance of random short-range interactions, interactions between two regions that are too close in the genomic distance are highly likely to be random interaction without regulatory implications. As a result, reads with ends aligning too close to each other are also filtered according to the twice the resolution rule. Notably, as a result of this valid fragment filtering, some multi-mapping reads can be counted as uniquely mapping reads (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1 - 2b</xref>). This is because, although a read pair has multiple potential genomic origins dictated by its multiple alignments, only one of them ends up passing the validation screening. Once the multi-mapping uncertainty is eliminated, such read pairs are passed to the downstream analysis as uni-reads. We remark here that standard Hi-C analysis pipelines do not rescue these multi-reads.</p></sec><sec id="s4-1-3"><title>Duplicate removal</title><p>To remove PCR duplicates, mHi-C considers the following two issues. First, due to allowing a maximum number of 2 mismatches in alignment, some multi-reads may have the exact same alignment position and strand direction with uni-reads. If such duplicates arise, uni-reads are granted higher priority and the overlapping multi-reads together with all their potential alignment positions are discarded completely. This ensures that the uni-reads that arise in standard Hi-C analysis pipelines will not be discarded as PCR duplicates in the mHi-C pipeline. Second, if a multi-mapping read alignment is duplicated with another multi-read, the read with smaller alphabetical read query name will be preserved. More often than not, if multi-read A overlaps multi-read B at a position, then it is highly likely that they will overlap at other positions as well. This convention ensures that it is always the read pair A alignments that are being retained (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>).</p></sec><sec id="s4-1-4"><title>Genome binning</title><p>Due to the typically limited sequencing depths of Hi-C experiments, the reference genome is divided into small non-overlapping intervals, that is bins, to secure enough number of contact counts across units. The unit can be fix-sized genomic intervals or a fixed number of consecutive restriction fragments. mHi-C can switch between the two unit options with ease. After binning, the interaction unit reduces from alignment position pairs to bin pairs. Remarkably, multi-mapping reads, ends of which are located within the same bin pair, reduce to uni-reads as their potential multi-mapping alignment position pairs support the same bin pair contact. Therefore, there is no need to distinguish the candidate alignments within the same bin (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> and <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1 - 3b</xref>).</p></sec><sec id="s4-1-5"><title>mHi-C generative model and parameter estimation</title><p>mHi-C infers genomic origins of multi-reads at the bin pair level (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). We denoted the whole alignment vector for a given paired-end read <inline-formula><mml:math id="inf20"><mml:mi>i</mml:mi></mml:math></inline-formula> by vector <inline-formula><mml:math id="inf21"><mml:msub><mml:mi mathvariant="bold">𝐘</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. If the two read ends of read <inline-formula><mml:math id="inf22"><mml:mi>i</mml:mi></mml:math></inline-formula> align to only bin <inline-formula><mml:math id="inf23"><mml:mi>j</mml:mi></mml:math></inline-formula> and bin <inline-formula><mml:math id="inf24"><mml:mi>k</mml:mi></mml:math></inline-formula>, respectively, we set the respective components of the alignment vector as: <inline-formula><mml:math id="inf25"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> = 1 and <inline-formula><mml:math id="inf26"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf27"><mml:mrow><mml:mrow><mml:mo>∀</mml:mo><mml:mo mathvariant="italic" separator="true"> </mml:mo><mml:msup><mml:mi>j</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mrow><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf28"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>. Index of read, <inline-formula><mml:math id="inf29"><mml:mi>i</mml:mi></mml:math></inline-formula>, ranges from 1 to <inline-formula><mml:math id="inf30"><mml:mi>N</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf31"><mml:mi>N</mml:mi></mml:math></inline-formula> is total number of valid Hi-C reads, including both uni-reads and multi-reads that pass the essential processing in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s2">2</xref>. Overall, the reference genome is divided into <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> bins and <inline-formula><mml:math id="inf33"><mml:mi>j</mml:mi></mml:math></inline-formula> represents the bin index of the end, alignment position of which is upstream compared to the other read end position indicated by <inline-formula><mml:math id="inf34"><mml:mi>k</mml:mi></mml:math></inline-formula>. Namely, <inline-formula><mml:math id="inf35"><mml:mi>j</mml:mi></mml:math></inline-formula> takes on a value from 1 to <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>−</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf37"><mml:mi>k</mml:mi></mml:math></inline-formula> runs from <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to the maximum value <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. For uniquely mapping reads, only one alignment is observed, that is <inline-formula><mml:math id="inf40"><mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. However, for multi-mapping reads, we have <inline-formula><mml:math id="inf41"><mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>We next defined a hidden variable <inline-formula><mml:math id="inf42"><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> to denote the true genomic origin of read <inline-formula><mml:math id="inf43"><mml:mi>i</mml:mi></mml:math></inline-formula>. If read <inline-formula><mml:math id="inf44"><mml:mi>i</mml:mi></mml:math></inline-formula> originates from position bin pairs <inline-formula><mml:math id="inf45"><mml:mi>j</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf46"><mml:mi>k</mml:mi></mml:math></inline-formula>, we have <inline-formula><mml:math id="inf47"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. In addition, a read can only originate from one alignment position pair on the genome; thus, <inline-formula><mml:math id="inf48"><mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for both uni- and multi-reads. We define <inline-formula><mml:math id="inf49"><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> = <inline-formula><mml:math id="inf50"><mml:mo stretchy="false">{</mml:mo></mml:math></inline-formula>(<inline-formula><mml:math id="inf51"><mml:mi>j</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf52"><mml:mi>k</mml:mi></mml:math></inline-formula>): <inline-formula><mml:math id="inf53"><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> = 1<inline-formula><mml:math id="inf54"><mml:mo stretchy="false">}</mml:mo></mml:math></inline-formula> to represent true genomic origin of read <inline-formula><mml:math id="inf55"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf56"><mml:msub><mml:mi>S</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> as the set of location pairs that read pair <inline-formula><mml:math id="inf57"><mml:mi>i</mml:mi></mml:math></inline-formula> can align to. Hence, <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1, if (<inline-formula><mml:math id="inf59"><mml:mi>j</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf60"><mml:mi>k</mml:mi></mml:math></inline-formula>) <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∈</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Under the assumption that the true alignment can only originate from those observed alignable positions, <inline-formula><mml:math id="inf62"><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> must be one of the location pairs in <inline-formula><mml:math id="inf63"><mml:msub><mml:mi>S</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>. We further assume that the indicators of true origin for read <inline-formula><mml:math id="inf64"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf65"><mml:msub><mml:mi mathvariant="bold-italic">𝒁</mml:mi><mml:mi mathvariant="bold-italic">𝒊</mml:mi></mml:msub></mml:math></inline-formula> = <inline-formula><mml:math id="inf66"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are random draws from a Dirichlet - Multinomial distribution. Specifically,<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi mathvariant="normal">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf67"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> can be interpreted as contact probability between bin <inline-formula><mml:math id="inf68"><mml:mi>j</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf69"><mml:mi>k</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>). We further assume that<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf72"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> is a function of genomic distance and quantifies random contact probability. Specifically, we adapt the univariate spline fitting approach from Fit-Hi-C (<xref ref-type="bibr" rid="bib1">Ay et al., 2014a</xref>) for estimating random contact probabilities with respect to genomic distance and set <inline-formula><mml:math id="inf73"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mtext>Spline</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. Here, <inline-formula><mml:math id="inf74"><mml:mi>N</mml:mi></mml:math></inline-formula> is the total number of valid reads as defined above and <inline-formula><mml:math id="inf75"><mml:mrow><mml:mtext>Spline</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the spline estimate of the random contact probability between bins <inline-formula><mml:math id="inf76"><mml:mi>j</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf77"><mml:mi>k</mml:mi></mml:math></inline-formula>. Therefore, <inline-formula><mml:math id="inf78"><mml:mrow><mml:mrow><mml:mtext>Spline</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> is the average random contact counts (i.e., pseudo-counts) between bin <inline-formula><mml:math id="inf79"><mml:mi>j</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf80"><mml:mi>k</mml:mi></mml:math></inline-formula>. As a result, the probability density function of <inline-formula><mml:math id="inf81"><mml:mi>π</mml:mi></mml:math></inline-formula> can be written as:<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"/></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We next derive the full data joint distribution function.</p><p><bold>Lemma 1</bold>. Given the true genomic origin under the mHi-C setting, the set of location pairs that a read pair can align to will have observed alignments with probability <inline-formula><mml:math id="inf82"><mml:mn>1</mml:mn></mml:math></inline-formula>.</p><p><bold>Proof</bold>.<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∉</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mn>1.</mml:mn><mml:mspace width="2em"/><mml:mrow><mml:mi>◻</mml:mi></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Based on Lemma 1, we can get the joint distribution <inline-formula><mml:math id="inf83"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐘</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐙</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Using the Dirichlet-Multinomial conjugacy, we derive the posterior distribution of <inline-formula><mml:math id="inf84"><mml:mi>π</mml:mi></mml:math></inline-formula> as<disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∝</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We next derive an Expectation-Maximization algorithm for fitting this model.</p><p><bold>E-step</bold>.<disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝒀</mml:mi><mml:mi mathvariant="bold-italic">𝒊</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝝅</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mstyle><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><bold>M-step</bold>.<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Estimate of the contact probability <inline-formula><mml:math id="inf85"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> in the M-step can be viewed as an integration of local interaction signal, encoded in <inline-formula><mml:math id="inf86"><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, and random contact signal due to prior, that is, <inline-formula><mml:math id="inf87"><mml:mrow><mml:mrow><mml:mtext>Spline</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>The by-products of the EM algorithm are posterior probabilities, P(<inline-formula><mml:math id="inf88"><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula>=1 <inline-formula><mml:math id="inf89"><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝒀</mml:mi><mml:mi mathvariant="bold-italic">𝒊</mml:mi></mml:msub></mml:math></inline-formula><inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>), which are utilized for assigning each multi-read to the most likely genomic origin. To keep mHi-C output compatible with the input required for the widely used significant interaction detection methods, we filtered multi-reads with maximum allocation posterior probability less than or equal to 0.5 and assigned the remaining multi-reads to their most likely bin pairs. This ensured the use of at most one bin pair for each multi-read pair. We repeated our computational evaluations by varying this threshold on the posterior probabilities to ensure robustness of the overall conclusions to this threshold.</p></sec></sec><sec id="s4-2"><title>Assessing false positive rates for significant interactions and TADs identification under the Uni- and Uni&amp;Multi-settings</title><p>To quantify false positive rates of the Uni- and Uni&amp;Multi-settings at the significant interaction level, we defined true positives and true negatives by leveraging deeply sequenced replicates of the IMR90 dataset (replicates 1–4). Significant interactions reproducibly identified across all four replicates at 0.1% FDR by both the Uni- and Uni&amp;Multi-settings were labeled as true positives (i.e., true interactions). True negatives were defined as all the interactions that were not deemed significant at 25% FDR in any of the four replicates. We then evaluated significant interactions identified by smaller depth replicates 5 and 6 with ROC and PR curves (<xref ref-type="fig" rid="fig3s13">Figure 3—figure supplement 13</xref>) by using these sets of true positives and negatives as the gold standard. To quantify false positive rates at the topologically associating domains (TADs) level (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2E</xref>), we utilized TADs that are reproducible in more than three replicates of the IMR90 dataset and/or harbor CTCF peaks at the boundaries as true positives. The rest of the TADs are supported neither by multiple replicates nor by CTCF, hence are regarded as false positives.</p></sec><sec id="s4-3"><title>Evaluating reproducibility</title><p>Reproducibility in contact matrices was evaluated using HiCRep in the default settings. We further assessed the reproducibility in terms of identified interactions by grouping them into three categories: those only detected under Uni-setting, those unique to Uni&amp;Multi-setting, and those that are detected under both settings. The reproducibility is calculated by overlapping significant interactions between every two replicates and recording the percentage of interactions that are also deemed significant in another replicate (<xref ref-type="fig" rid="fig2s13">Figure 2—figure supplement 13</xref>).</p></sec><sec id="s4-4"><title>Chromatin states of novel significant interactions</title><p>We annotated the novel significant interactions with the 15 states ChromHMM segmentations for IMR90 epigenome (ID E017) from the Roadmap Epigenomics project (<xref ref-type="bibr" rid="bib31">Kundaje et al., 2015</xref>). All six replicates of IMR90 are merged together in calculating the average enrichment of significant interactions among the 15 states (<xref ref-type="fig" rid="fig3">Figure 3D</xref> and <xref ref-type="fig" rid="fig3s14">Figure 3—figure supplement 14A</xref>).</p></sec><sec id="s4-5"><title>ChIP-seq analysis</title><p>ChIP-seq peak sets for IMR90 cells were obtained from ENCODE portal (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/">https://www.encodeproject.org/</ext-link>) and GEO (<xref ref-type="bibr" rid="bib4">Barrett et al., 2013</xref>). Specifically, we utilized H3K4me1 (ENCSR831JSP), H3K4me3 (ENCSR087PFU), H3K36me3 (ENCSR437ORF), H3K27ac (ENCSR002YRE), H3K27me3 (ENCSR431UUY) and CTCF (ENCSR000EFI) from the ENCODE project and p65 (GSM1055810), p300 (GSM1055812) and PolII (GSM1055822) from GEO (<xref ref-type="bibr" rid="bib4">Barrett et al., 2013</xref>). In addition, raw data files in fastq format were processed by Permseq (<xref ref-type="bibr" rid="bib55">Zeng et al., 2015</xref>) utilizing DNase-seq of IMR90 (ENCODE accession ENCSR477RTP) to incorporate multi-reads and, subsequently, peaks were identified using ENCODE uniform ChIP-seq data processing pipeline (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/pages/pipelines/#DNA-binding">https://www.encodeproject.org/pages/pipelines/#DNA-binding</ext-link>). CTCF motif quantification for topologically associating domains was carried out with FIMO (<xref ref-type="bibr" rid="bib20">Grant et al., 2011</xref>) under the default settings using CTCF motif frequency matrix from JASPAR (<xref ref-type="bibr" rid="bib29">Khan et al., 2017</xref>).</p></sec><sec id="s4-6"><title>Promoters with significant interactions</title><p>Significant interactions across six replicates of the IMR90 study were annotated with GENCODE V19 (<xref ref-type="bibr" rid="bib21">Harrow et al., 2012</xref>) gene annotations and enhancer regions from ChromHMM. Gene expression calculations utilized RNA-seq quantification results from the ENCODE project with accession number ENCSR424FAZ.</p></sec><sec id="s4-7"><title>Marginal Hi-C tracks in <xref ref-type="fig" rid="fig3s15">Figure 3—figure supplement 15</xref>–<xref ref-type="fig" rid="fig3s17">17</xref></title><p>Uni-setting and Uni&amp;Multi-setting Hi-C tracks displayed on the UCSC genome browser figures (<xref ref-type="fig" rid="fig3s15">Figure 3—figure supplement 15</xref>–<xref ref-type="fig" rid="fig3s17">17</xref>) are obtained by aggregating contact counts of six replicates of IMR90 for each genomic coordinate along the genome.</p></sec><sec id="s4-8"><title>Visualization of contact matrices and interactions</title><p>We utilized Juicebox (<xref ref-type="bibr" rid="bib16">Durand et al., 2016</xref>), HiGlass (<xref ref-type="bibr" rid="bib28">Kerpedjiev et al., 2017</xref>), and WashU epigenome browser (<xref ref-type="bibr" rid="bib59">Zhou et al., 2011</xref>) for depicting contact matrices and interactions, respectively, throughout the paper. Normalization of the contact matrices for visualization was carried out by the Knight-Ruiz Matrix Balancing Normalization (<xref ref-type="bibr" rid="bib30">Knight and Ruiz, 2013</xref>) provided by Juicebox (<xref ref-type="bibr" rid="bib16">Durand et al., 2016</xref>).</p></sec><sec id="s4-9"><title>Model-free multi-reads allocation strategies</title><p>The simplified and intuitive strategies depicted in <xref ref-type="fig" rid="fig6">Figure 6A</xref> correspond to rescuing multi-reads at different essential stages of the Hi-C analysis pipeline. AlignerSelect relies on the base aligner, for example BWA, to determine the primary alignment of each individual end of a multi-read pair. DistanceSelect enables the distance prior to dominate. It selects the read end alignments closest in the genomic distance as the origins of the multi-read pair and defaults to the primary alignment selected by base aligner for inter-chromosomal multi-reads. Finally, SimpleSelect follows the overall mHi-C pipeline closely by making use of the standard Hi-C validation checking and binning procedures. For the reads that align to multiple bins, it selects the bin pair closest in the genomic distance as the allocation of the multi-read pair. Bin-pair allocations for inter-chromosomal multi-reads are set randomly in this strategy.</p></sec><sec id="s4-10"><title>Comparison of mHi-C with model-free multi-reads allocation for their impact on identifying differential interactions</title><p>We evaluated the direct biological consequence of heavily biasing read assignment by genomic distance, as employed by SimpleSelect, by comparing the significant interactions among three life stages of <italic>P. falciparum</italic>. We reasoned that the better multi-reads allocation strategy would reveal a differential analysis pattern more consistent with the Uni-setting, whereas a genomic distance biased strategy - SimpleSelect - will underestimate differences since multi-reads will be more likely to be allocated to candidate bin pairs with shortest genomic distance regardless of other local contact signals (<xref ref-type="fig" rid="fig6s7">Figure 6—figure supplement 7A</xref>). <xref ref-type="fig" rid="fig6s7">Figure 6—figure supplement 7B</xref> corroborates this drawback of SimpleSelect and demonstrates that mHi-C differential patterns agree better with that of the Uni-setting. Moreover, <xref ref-type="fig" rid="fig6s7">Figure 6—figure supplement 7B</xref> suggests that rings stage is more similar to schizonts, an observation consistent with existing findings on <italic>P. falciparum</italic> life stages (<xref ref-type="bibr" rid="bib2">Ay et al., 2014b</xref>; <xref ref-type="bibr" rid="bib7">Bunnik et al., 2018</xref>).</p></sec><sec id="s4-11"><title>Trimming procedures</title><p>We considered two approaches for generating evaluation datasets where we combined the trimmed multi-reads from replicate two, which has the median sequencing depth among all replicates of the A549 study set, with (i) trimmed reads of replicate two that remain uniquely aligned to the reference genome at the same trimmed read length (<xref ref-type="fig" rid="fig6">Figures 6</xref> and <xref ref-type="fig" rid="fig7">7</xref>), and (ii) uni-reads from other replicates, that is, replicates one, three, and four in the A549 dataset individually (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplements 3</xref>, <xref ref-type="fig" rid="fig6s5">5</xref> and <xref ref-type="fig" rid="fig6s6">6</xref>). The first setting enables a direct comparison of the set of uni- and multi-reads at trimmed read length compared to uni-reads at the full read length to evaluate accuracy. The numbers of reads are summarized in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref> along with multi-to-uni ratios in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref>. In the second trimming setting (ii), the uni-read sets are of the original sequencing depth and the added multi-reads constitute a smaller proportion compared to observed levels in the data (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C</xref>) due to the chimeric read rescue that was part of full-length datasets (<xref ref-type="fig" rid="fig7s10">Figure 7—figure supplement 10</xref>). Therefore, for this setting, we leverage the higher overall depth of the datasets and evaluate the multi-read assignment accuracy at different resolutions, that is, 10 kb and 40 kb.</p></sec><sec id="s4-12"><title>Simulation procedures</title><p>We devised a simulation strategy that utilizes parameters learned from the Hi-C data and results in data with a similar signal to noise characteristics as the actual data.</p><list list-type="order"><list-item><p><italic>Construction of the interaction prior based on the uni-reads fragment interaction frequency list of GM12878 dataset (replicate 6).</italic> The frequency list from the prior encompasses both the genomic distance effect and local interaction signal strength and forms the basis for simulating restriction fragment interactions.</p></list-item><list-item><p><italic>Generating the restriction enzyme cutting sites for each simulated fragment pair.</italic> After sampling interacting fragments using the frequency list from Step 1, a genomic coordinate within ± bp of the restriction enzyme cutting site and a strand direction are selected randomly. Reads of different lengths (36 bp, 50 bp, 75 bp, 100 bp) are generated starting from these cutting sites.</p></list-item><list-item><p><italic>Mutating the resulting reads.</italic> Mutation and gap rates are empirically estimated based on the aligned uni-reads of replicate 6. The reads from Step two are uniformly mutated with these rates allowing up to 2 mutations and one gap.</p></list-item><list-item><p><italic>Simulate sequence quality scores of the reads.</italic> We utilize the empirical estimation of the distribution regarding the sequence base quality scores across individual locations of the read length and simulate for each read its sequence quality scores at the nucleotide level.</p></list-item><list-item><p><italic>Alignment to the reference genome.</italic> The simulated reads are aligned to the reference genome and filtered for validation as we outline in the mHi-C pipeline, resulting in the set of multi-reads that are utilized by mHi-C.</p></list-item></list><p>We generated numbers of multi-reads comparable to those of replicate six. In the final step of the simulation studies, we merged the simulated set of multi-reads with uni-reads of replicates three and six and ran mHi-C step4 (binning) - step5 (prior already available) - step6 (assign multi-reads posterior probability) independently at resolutions 10 kb and 40 kb.</p></sec><sec id="s4-13"><title>Software availability</title><p>mHi-C pipeline is implemented in Python and accelerated by C. The source codes and instructions for running mHi-C are publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/keleslab/mHiC">https://github.com/keleslab/mHiC</ext-link> (<xref ref-type="bibr" rid="bib58">Zheng and Keleş, 2019</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/mHiC">https://github.com/elifesciences-publications/mHiC</ext-link>). Each step is organized into an independent script with flexible user-defined parameters and implementation options. Therefore, analysis can be carried out from any step of the work-flow and easily fits in high-performance computing environments for parallel computations.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>This work was supported by NIH HG009744 and NIH HG007019 (SK). FA is partially supported by Institute Leadership Funds from La Jolla Institute for Allergy and Immunology. We thank Peigen Zhou from the University of Wisconsin–Madison for the insightful discussions on accelerating the pipeline. We also thank the peer reviewers and the Reviewing and Senior <italic>eLife</italic> Editors of this work for their constructive comments.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Data curation, Software, Investigation, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><object-id pub-id-type="doi">10.7554/eLife.38070.086</object-id><label>Supplementary file 1.</label><caption><title>Hi-C and mHi-C terminology.</title></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-38070-supp1-v2.pdf"/></supplementary-material><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.38070.087</object-id><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-38070-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>GEO and ENCODE accession codes for all the data analyzed in this manuscript are provided in the manuscript. Source data files have been provided for Figures 1, 3, 4, and 5 (some via Dryad <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.v7k3140">http://dx.doi.org/10.5061/dryad.v7k3140</ext-link>). The mHiC software is made available on github <ext-link ext-link-type="uri" xlink:href="https://github.com/keleslab/mHiC">https://github.com/keleslab/mHiC</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/mHiC">https://github.com/elifesciences-publications/mHiC</ext-link>) with proper documentation.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>Y</given-names></name><name><surname>Ay</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Data from: Generative Modeling of Multi-mapping Reads with mHi-C Advances Analysis of Hi-C Studies</data-title><source>Dryad Digital Repository</source><pub-id assigning-authority="Dryad" pub-id-type="doi">10.5061/dryad.v7k3140</pub-id></element-citation></p><p>The following previously published datasets were used:</p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>F</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Dixon</surname><given-names>JR</given-names></name><name><surname>Selvaraj</surname><given-names>S</given-names></name><name><surname>Ye</surname><given-names>Z</given-names></name><name><surname>Lee</surname><given-names>AY</given-names></name><name><surname>Yen</surname><given-names>CA</given-names></name><name><surname>Schmitt</surname><given-names>AD</given-names></name><name><surname>Espinoza</surname><given-names>C</given-names></name><name><surname>Ren</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><data-title>IMR90 Hi-C Dataset</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE43070">GSE43070</pub-id></element-citation></p><p><element-citation id="dataset3" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Ay</surname><given-names>F</given-names></name><name><surname>Bunnik</surname><given-names>EM</given-names></name><name><surname>Varoquaux</surname><given-names>N</given-names></name><name><surname>Bol</surname><given-names>SM</given-names></name><name><surname>Prudhomme</surname><given-names>J</given-names></name><name><surname>Vert</surname><given-names>JP</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name><name><surname>Le</surname><given-names>Roch KG</given-names></name></person-group><year iso-8601-date="2014">2014</year><data-title>Plasmodium Hi-C Dataset</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE50199">GSE50199</pub-id></element-citation></p><p><element-citation id="dataset4" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Rao</surname><given-names>SSP</given-names></name><name><surname>Huntley</surname><given-names>MH</given-names></name><name><surname>Durand</surname><given-names>NC</given-names></name><name><surname>Stamenova</surname><given-names>EK</given-names></name><name><surname>Bochkov</surname><given-names>ID</given-names></name><name><surname>Robinson</surname><given-names>JT</given-names></name><name><surname>Sanborn</surname><given-names>AL</given-names></name><name><surname>Machol</surname><given-names>I</given-names></name><name><surname>Omer</surname><given-names>AD</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Aiden</surname><given-names>EL A</given-names></name></person-group><year iso-8601-date="2014">2014</year><data-title>GM12878 Hi-C Dataset</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE63525">GSE63525</pub-id></element-citation></p><p><element-citation id="dataset5" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Dixon</surname><given-names>JR</given-names></name><name><surname>Selvaraj</surname><given-names>S</given-names></name><name><surname>Yue</surname><given-names>F</given-names></name><name><surname>Kim</surname><given-names>A</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Shen</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>M</given-names></name><name><surname>Liu</surname><given-names>JS</given-names></name><name><surname>Ren</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2012">2012</year><data-title>ESC(2012) Hi-C Dataset</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE35156">GSE35156</pub-id></element-citation></p><p><element-citation id="dataset6" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Dixon</surname><given-names>JR</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Dileep</surname><given-names>V</given-names></name><name><surname>Zhan</surname><given-names>Y</given-names></name><name><surname>Song</surname><given-names>F</given-names></name><name><surname>Le</surname><given-names>VT</given-names></name><name><surname>Galip</surname><given-names>Gurkan Yardımcı AC</given-names></name><name><surname>Bann</surname><given-names>DV</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Clark</surname><given-names>R</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Iyyanki</surname><given-names>S</given-names></name><name><surname>An</surname><given-names>L</given-names></name><name><surname>Pool</surname><given-names>C</given-names></name><name><surname>Sasaki</surname><given-names>T</given-names></name><name><surname>Rivera-Mulia</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>A549 Hi-C Dataset</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE92819">GSE92819</pub-id></element-citation></p><p><element-citation id="dataset7" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Bonev</surname><given-names>B</given-names></name><name><surname>Cohen</surname><given-names>NM</given-names></name><name><surname>Szabo</surname><given-names>Q</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>ESC(2017) &amp; Cortex Hi-C Datasets</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE96107">GSE96107</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ay</surname> <given-names>F</given-names></name><name><surname>Bailey</surname> <given-names>TL</given-names></name><name><surname>Noble</surname> <given-names>WS</given-names></name></person-group><year iso-8601-date="2014">2014a</year><article-title>Statistical confidence estimation for Hi-C data reveals regulatory chromatin contacts</article-title><source>Genome Research</source><volume>24</volume><fpage>999</fpage><lpage>1011</lpage><pub-id pub-id-type="doi">10.1101/gr.160374.113</pub-id><pub-id pub-id-type="pmid">24501021</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ay</surname> <given-names>F</given-names></name><name><surname>Bunnik</surname> <given-names>EM</given-names></name><name><surname>Varoquaux</surname> <given-names>N</given-names></name><name><surname>Bol</surname> <given-names>SM</given-names></name><name><surname>Prudhomme</surname> <given-names>J</given-names></name><name><surname>Vert</surname> <given-names>JP</given-names></name><name><surname>Noble</surname> <given-names>WS</given-names></name><name><surname>Le Roch</surname> <given-names>KG</given-names></name></person-group><year iso-8601-date="2014">2014b</year><article-title>Three-dimensional modeling of the P. falciparum genome during the erythrocytic cycle reveals a strong connection between genome architecture and gene expression</article-title><source>Genome Research</source><volume>24</volume><fpage>974</fpage><lpage>988</lpage><pub-id pub-id-type="doi">10.1101/gr.169417.113</pub-id><pub-id pub-id-type="pmid">24671853</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ay</surname> <given-names>F</given-names></name><name><surname>Noble</surname> <given-names>WS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Analysis methods for studying the 3D architecture of the genome</article-title><source>Genome Biology</source><volume>16</volume><elocation-id>183</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-015-0745-7</pub-id><pub-id pub-id-type="pmid">26328929</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barrett</surname> <given-names>T</given-names></name><name><surname>Wilhite</surname> <given-names>SE</given-names></name><name><surname>Ledoux</surname> <given-names>P</given-names></name><name><surname>Evangelista</surname> <given-names>C</given-names></name><name><surname>Kim</surname> <given-names>IF</given-names></name><name><surname>Tomashevsky</surname> <given-names>M</given-names></name><name><surname>Marshall</surname> <given-names>KA</given-names></name><name><surname>Phillippy</surname> <given-names>KH</given-names></name><name><surname>Sherman</surname> <given-names>PM</given-names></name><name><surname>Holko</surname> <given-names>M</given-names></name><name><surname>Yefanov</surname> <given-names>A</given-names></name><name><surname>Lee</surname> <given-names>H</given-names></name><name><surname>Zhang</surname> <given-names>N</given-names></name><name><surname>Robertson</surname> <given-names>CL</given-names></name><name><surname>Serova</surname> <given-names>N</given-names></name><name><surname>Davis</surname> <given-names>S</given-names></name><name><surname>Soboleva</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>NCBI GEO: archive for functional genomics data sets—update</article-title><source>Nucleic Acids Research</source><volume>41</volume><fpage>D991</fpage><lpage>D995</lpage><pub-id pub-id-type="doi">10.1093/nar/gks1193</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Belaghzal</surname> <given-names>H</given-names></name><name><surname>Dekker</surname> <given-names>J</given-names></name><name><surname>Gibcus</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Hi-C 2.0: an optimized Hi-C procedure for high-resolution genome-wide mapping of chromosome conformation</article-title><source>Methods</source><volume>123</volume><fpage>56</fpage><lpage>65</lpage><pub-id pub-id-type="doi">10.1016/j.ymeth.2017.04.004</pub-id><pub-id pub-id-type="pmid">28435001</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonev</surname> <given-names>B</given-names></name><name><surname>Mendelson Cohen</surname> <given-names>N</given-names></name><name><surname>Szabo</surname> <given-names>Q</given-names></name><name><surname>Fritsch</surname> <given-names>L</given-names></name><name><surname>Papadopoulos</surname> <given-names>GL</given-names></name><name><surname>Lubling</surname> <given-names>Y</given-names></name><name><surname>Xu</surname> <given-names>X</given-names></name><name><surname>Lv</surname> <given-names>X</given-names></name><name><surname>Hugnot</surname> <given-names>JP</given-names></name><name><surname>Tanay</surname> <given-names>A</given-names></name><name><surname>Cavalli</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Multiscale 3D genome rewiring during mouse neural development</article-title><source>Cell</source><volume>171</volume><fpage>557</fpage><lpage>572</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.09.043</pub-id><pub-id pub-id-type="pmid">29053968</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bunnik</surname> <given-names>EM</given-names></name><name><surname>Cook</surname> <given-names>KB</given-names></name><name><surname>Varoquaux</surname> <given-names>N</given-names></name><name><surname>Batugedara</surname> <given-names>G</given-names></name><name><surname>Prudhomme</surname> <given-names>J</given-names></name><name><surname>Cort</surname> <given-names>A</given-names></name><name><surname>Shi</surname> <given-names>L</given-names></name><name><surname>Andolina</surname> <given-names>C</given-names></name><name><surname>Ross</surname> <given-names>LS</given-names></name><name><surname>Brady</surname> <given-names>D</given-names></name><name><surname>Fidock</surname> <given-names>DA</given-names></name><name><surname>Nosten</surname> <given-names>F</given-names></name><name><surname>Tewari</surname> <given-names>R</given-names></name><name><surname>Sinnis</surname> <given-names>P</given-names></name><name><surname>Ay</surname> <given-names>F</given-names></name><name><surname>Vert</surname> <given-names>JP</given-names></name><name><surname>Noble</surname> <given-names>WS</given-names></name><name><surname>Le Roch</surname> <given-names>KG</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Changes in genome organization of parasite-specific gene families during the plasmodium transmission stages</article-title><source>Nature Communications</source><volume>9</volume><pub-id pub-id-type="doi">10.1038/s41467-018-04295-5</pub-id><pub-id pub-id-type="pmid">29765020</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chung</surname> <given-names>D</given-names></name><name><surname>Kuan</surname> <given-names>PF</given-names></name><name><surname>Li</surname> <given-names>B</given-names></name><name><surname>Sanalkumar</surname> <given-names>R</given-names></name><name><surname>Liang</surname> <given-names>K</given-names></name><name><surname>Bresnick</surname> <given-names>EH</given-names></name><name><surname>Dewey</surname> <given-names>C</given-names></name><name><surname>Keleş</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Discovering transcription factor binding sites in highly repetitive regions of genomes with multi-read analysis of ChIP-Seq data</article-title><source>PLoS Computational Biology</source><volume>7</volume><elocation-id>e1002111</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002111</pub-id><pub-id pub-id-type="pmid">21779159</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corradin</surname> <given-names>O</given-names></name><name><surname>Cohen</surname> <given-names>AJ</given-names></name><name><surname>Luppino</surname> <given-names>JM</given-names></name><name><surname>Bayles</surname> <given-names>IM</given-names></name><name><surname>Schumacher</surname> <given-names>FR</given-names></name><name><surname>Scacheri</surname> <given-names>PC</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Modeling disease risk through analysis of physical interactions between genetic variants within chromatin regulatory circuitry</article-title><source>Nature Genetics</source><volume>48</volume><fpage>1313</fpage><lpage>1320</lpage><pub-id pub-id-type="doi">10.1038/ng.3674</pub-id><pub-id pub-id-type="pmid">27643537</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cournac</surname> <given-names>A</given-names></name><name><surname>Koszul</surname> <given-names>R</given-names></name><name><surname>Mozziconacci</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The 3D folding of metazoan genomes correlates with the association of similar repetitive elements</article-title><source>Nucleic Acids Research</source><volume>44</volume><fpage>245</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1093/nar/gkv1292</pub-id><pub-id pub-id-type="pmid">26609133</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Laat</surname> <given-names>W</given-names></name><name><surname>Duboule</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Topology of mammalian developmental enhancers and their regulatory landscapes</article-title><source>Nature</source><volume>502</volume><fpage>499</fpage><lpage>506</lpage><pub-id pub-id-type="doi">10.1038/nature12753</pub-id><pub-id pub-id-type="pmid">24153303</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dekker</surname> <given-names>J</given-names></name><name><surname>Rippe</surname> <given-names>K</given-names></name><name><surname>Dekker</surname> <given-names>M</given-names></name><name><surname>Kleckner</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Capturing chromosome conformation</article-title><source>Science</source><volume>295</volume><fpage>1306</fpage><lpage>1311</lpage><pub-id pub-id-type="doi">10.1126/science.1067799</pub-id><pub-id pub-id-type="pmid">11847345</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dixon</surname> <given-names>JR</given-names></name><name><surname>Selvaraj</surname> <given-names>S</given-names></name><name><surname>Yue</surname> <given-names>F</given-names></name><name><surname>Kim</surname> <given-names>A</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Shen</surname> <given-names>Y</given-names></name><name><surname>Hu</surname> <given-names>M</given-names></name><name><surname>Liu</surname> <given-names>JS</given-names></name><name><surname>Ren</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title><source>Nature</source><volume>485</volume><fpage>376</fpage><lpage>380</lpage><pub-id pub-id-type="doi">10.1038/nature11082</pub-id><pub-id pub-id-type="pmid">22495300</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dixon</surname> <given-names>JR</given-names></name><name><surname>Jung</surname> <given-names>I</given-names></name><name><surname>Selvaraj</surname> <given-names>S</given-names></name><name><surname>Shen</surname> <given-names>Y</given-names></name><name><surname>Antosiewicz-Bourget</surname> <given-names>JE</given-names></name><name><surname>Lee</surname> <given-names>AY</given-names></name><name><surname>Ye</surname> <given-names>Z</given-names></name><name><surname>Kim</surname> <given-names>A</given-names></name><name><surname>Rajagopal</surname> <given-names>N</given-names></name><name><surname>Xie</surname> <given-names>W</given-names></name><name><surname>Diao</surname> <given-names>Y</given-names></name><name><surname>Liang</surname> <given-names>J</given-names></name><name><surname>Zhao</surname> <given-names>H</given-names></name><name><surname>Lobanenkov</surname> <given-names>VV</given-names></name><name><surname>Ecker</surname> <given-names>JR</given-names></name><name><surname>Thomson</surname> <given-names>JA</given-names></name><name><surname>Ren</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Chromatin architecture reorganization during stem cell differentiation</article-title><source>Nature</source><volume>518</volume><fpage>331</fpage><lpage>336</lpage><pub-id pub-id-type="doi">10.1038/nature14222</pub-id><pub-id pub-id-type="pmid">25693564</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dixon</surname> <given-names>JR</given-names></name><name><surname>Xu</surname> <given-names>J</given-names></name><name><surname>Dileep</surname> <given-names>V</given-names></name><name><surname>Zhan</surname> <given-names>Y</given-names></name><name><surname>Song</surname> <given-names>F</given-names></name><name><surname>Le</surname> <given-names>VT</given-names></name><name><surname>Yardımcı</surname> <given-names>GG</given-names></name><name><surname>Chakraborty</surname> <given-names>A</given-names></name><name><surname>Bann</surname> <given-names>DV</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Clark</surname> <given-names>R</given-names></name><name><surname>Zhang</surname> <given-names>L</given-names></name><name><surname>Yang</surname> <given-names>H</given-names></name><name><surname>Liu</surname> <given-names>T</given-names></name><name><surname>Iyyanki</surname> <given-names>S</given-names></name><name><surname>An</surname> <given-names>L</given-names></name><name><surname>Pool</surname> <given-names>C</given-names></name><name><surname>Sasaki</surname> <given-names>T</given-names></name><name><surname>Rivera-Mulia</surname> <given-names>JC</given-names></name><name><surname>Ozadam</surname> <given-names>H</given-names></name><name><surname>Lajoie</surname> <given-names>BR</given-names></name><name><surname>Kaul</surname> <given-names>R</given-names></name><name><surname>Buckley</surname> <given-names>M</given-names></name><name><surname>Lee</surname> <given-names>K</given-names></name><name><surname>Diegel</surname> <given-names>M</given-names></name><name><surname>Pezic</surname> <given-names>D</given-names></name><name><surname>Ernst</surname> <given-names>C</given-names></name><name><surname>Hadjur</surname> <given-names>S</given-names></name><name><surname>Odom</surname> <given-names>DT</given-names></name><name><surname>Stamatoyannopoulos</surname> <given-names>JA</given-names></name><name><surname>Broach</surname> <given-names>JR</given-names></name><name><surname>Hardison</surname> <given-names>RC</given-names></name><name><surname>Ay</surname> <given-names>F</given-names></name><name><surname>Noble</surname> <given-names>WS</given-names></name><name><surname>Dekker</surname> <given-names>J</given-names></name><name><surname>Gilbert</surname> <given-names>DM</given-names></name><name><surname>Yue</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Integrative detection and analysis of structural variation in cancer genomes</article-title><source>Nature Genetics</source><volume>50</volume><fpage>1388</fpage><lpage>1398</lpage><pub-id pub-id-type="doi">10.1038/s41588-018-0195-8</pub-id><pub-id pub-id-type="pmid">30202056</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durand</surname> <given-names>NC</given-names></name><name><surname>Robinson</surname> <given-names>JT</given-names></name><name><surname>Shamim</surname> <given-names>MS</given-names></name><name><surname>Machol</surname> <given-names>I</given-names></name><name><surname>Mesirov</surname> <given-names>JP</given-names></name><name><surname>Lander</surname> <given-names>ES</given-names></name><name><surname>Aiden</surname> <given-names>EL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Juicebox provides a visualization system for Hi-C contact maps with unlimited zoom</article-title><source>Cell Systems</source><volume>3</volume><fpage>99</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2015.07.012</pub-id><pub-id pub-id-type="pmid">27467250</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>ENCODE Project Consortium</collab></person-group><year iso-8601-date="2012">2012</year><article-title>An integrated encyclopedia of DNA elements in the human genome</article-title><source>Nature</source><volume>489</volume><fpage>57</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1038/nature11247</pub-id><pub-id pub-id-type="pmid">22955616</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferrari</surname> <given-names>KJ</given-names></name><name><surname>Scelfo</surname> <given-names>A</given-names></name><name><surname>Jammula</surname> <given-names>S</given-names></name><name><surname>Cuomo</surname> <given-names>A</given-names></name><name><surname>Barozzi</surname> <given-names>I</given-names></name><name><surname>Stützer</surname> <given-names>A</given-names></name><name><surname>Fischle</surname> <given-names>W</given-names></name><name><surname>Bonaldi</surname> <given-names>T</given-names></name><name><surname>Pasini</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Polycomb-dependent H3K27me1 and H3K27me2 regulate active transcription and enhancer fidelity</article-title><source>Molecular Cell</source><volume>53</volume><fpage>49</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2013.10.030</pub-id><pub-id pub-id-type="pmid">24289921</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Forcato</surname> <given-names>M</given-names></name><name><surname>Nicoletti</surname> <given-names>C</given-names></name><name><surname>Pal</surname> <given-names>K</given-names></name><name><surname>Livi</surname> <given-names>CM</given-names></name><name><surname>Ferrari</surname> <given-names>F</given-names></name><name><surname>Bicciato</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Comparison of computational methods for Hi-C data analysis</article-title><source>Nature Methods</source><volume>14</volume><fpage>679</fpage><lpage>685</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4325</pub-id><pub-id pub-id-type="pmid">28604721</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grant</surname> <given-names>CE</given-names></name><name><surname>Bailey</surname> <given-names>TL</given-names></name><name><surname>Noble</surname> <given-names>WS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>FIMO: scanning for occurrences of a given motif</article-title><source>Bioinformatics</source><volume>27</volume><fpage>1017</fpage><lpage>1018</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr064</pub-id><pub-id pub-id-type="pmid">21330290</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrow</surname> <given-names>J</given-names></name><name><surname>Frankish</surname> <given-names>A</given-names></name><name><surname>Gonzalez</surname> <given-names>JM</given-names></name><name><surname>Tapanari</surname> <given-names>E</given-names></name><name><surname>Diekhans</surname> <given-names>M</given-names></name><name><surname>Kokocinski</surname> <given-names>F</given-names></name><name><surname>Aken</surname> <given-names>BL</given-names></name><name><surname>Barrell</surname> <given-names>D</given-names></name><name><surname>Zadissa</surname> <given-names>A</given-names></name><name><surname>Searle</surname> <given-names>S</given-names></name><name><surname>Barnes</surname> <given-names>I</given-names></name><name><surname>Bignell</surname> <given-names>A</given-names></name><name><surname>Boychenko</surname> <given-names>V</given-names></name><name><surname>Hunt</surname> <given-names>T</given-names></name><name><surname>Kay</surname> <given-names>M</given-names></name><name><surname>Mukherjee</surname> <given-names>G</given-names></name><name><surname>Rajan</surname> <given-names>J</given-names></name><name><surname>Despacio-Reyes</surname> <given-names>G</given-names></name><name><surname>Saunders</surname> <given-names>G</given-names></name><name><surname>Steward</surname> <given-names>C</given-names></name><name><surname>Harte</surname> <given-names>R</given-names></name><name><surname>Lin</surname> <given-names>M</given-names></name><name><surname>Howald</surname> <given-names>C</given-names></name><name><surname>Tanzer</surname> <given-names>A</given-names></name><name><surname>Derrien</surname> <given-names>T</given-names></name><name><surname>Chrast</surname> <given-names>J</given-names></name><name><surname>Walters</surname> <given-names>N</given-names></name><name><surname>Balasubramanian</surname> <given-names>S</given-names></name><name><surname>Pei</surname> <given-names>B</given-names></name><name><surname>Tress</surname> <given-names>M</given-names></name><name><surname>Rodriguez</surname> <given-names>JM</given-names></name><name><surname>Ezkurdia</surname> <given-names>I</given-names></name><name><surname>van Baren</surname> <given-names>J</given-names></name><name><surname>Brent</surname> <given-names>M</given-names></name><name><surname>Haussler</surname> <given-names>D</given-names></name><name><surname>Kellis</surname> <given-names>M</given-names></name><name><surname>Valencia</surname> <given-names>A</given-names></name><name><surname>Reymond</surname> <given-names>A</given-names></name><name><surname>Gerstein</surname> <given-names>M</given-names></name><name><surname>Guigó</surname> <given-names>R</given-names></name><name><surname>Hubbard</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>GENCODE: the reference human genome annotation for the ENCODE project</article-title><source>Genome Research</source><volume>22</volume><fpage>1760</fpage><lpage>1774</lpage><pub-id pub-id-type="doi">10.1101/gr.135350.111</pub-id><pub-id pub-id-type="pmid">22955987</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinz</surname> <given-names>S</given-names></name><name><surname>Benner</surname> <given-names>C</given-names></name><name><surname>Spann</surname> <given-names>N</given-names></name><name><surname>Bertolino</surname> <given-names>E</given-names></name><name><surname>Lin</surname> <given-names>YC</given-names></name><name><surname>Laslo</surname> <given-names>P</given-names></name><name><surname>Cheng</surname> <given-names>JX</given-names></name><name><surname>Murre</surname> <given-names>C</given-names></name><name><surname>Singh</surname> <given-names>H</given-names></name><name><surname>Glass</surname> <given-names>CK</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title><source>Molecular Cell</source><volume>38</volume><fpage>576</fpage><lpage>589</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id><pub-id pub-id-type="pmid">20513432</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hsu</surname> <given-names>SC</given-names></name><name><surname>Gilgenast</surname> <given-names>TG</given-names></name><name><surname>Bartman</surname> <given-names>CR</given-names></name><name><surname>Edwards</surname> <given-names>CR</given-names></name><name><surname>Stonestrom</surname> <given-names>AJ</given-names></name><name><surname>Huang</surname> <given-names>P</given-names></name><name><surname>Emerson</surname> <given-names>DJ</given-names></name><name><surname>Evans</surname> <given-names>P</given-names></name><name><surname>Werner</surname> <given-names>MT</given-names></name><name><surname>Keller</surname> <given-names>CA</given-names></name><name><surname>Giardine</surname> <given-names>B</given-names></name><name><surname>Hardison</surname> <given-names>RC</given-names></name><name><surname>Raj</surname> <given-names>A</given-names></name><name><surname>Phillips-Cremins</surname> <given-names>JE</given-names></name><name><surname>Blobel</surname> <given-names>GA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The BET protein BRD2 cooperates with CTCF to enforce transcriptional and architectural boundaries</article-title><source>Molecular Cell</source><volume>66</volume><fpage>102</fpage><lpage>116</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2017.02.027</pub-id><pub-id pub-id-type="pmid">28388437</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hwang</surname> <given-names>YC</given-names></name><name><surname>Lin</surname> <given-names>CF</given-names></name><name><surname>Valladares</surname> <given-names>O</given-names></name><name><surname>Malamon</surname> <given-names>J</given-names></name><name><surname>Kuksa</surname> <given-names>PP</given-names></name><name><surname>Zheng</surname> <given-names>Q</given-names></name><name><surname>Gregory</surname> <given-names>BD</given-names></name><name><surname>Wang</surname> <given-names>LS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>HIPPIE: a high-throughput identification pipeline for promoter interacting enhancer elements</article-title><source>Bioinformatics</source><volume>31</volume><fpage>1290</fpage><lpage>1292</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu801</pub-id><pub-id pub-id-type="pmid">25480377</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Imakaev</surname> <given-names>M</given-names></name><name><surname>Fudenberg</surname> <given-names>G</given-names></name><name><surname>McCord</surname> <given-names>RP</given-names></name><name><surname>Naumova</surname> <given-names>N</given-names></name><name><surname>Goloborodko</surname> <given-names>A</given-names></name><name><surname>Lajoie</surname> <given-names>BR</given-names></name><name><surname>Dekker</surname> <given-names>J</given-names></name><name><surname>Mirny</surname> <given-names>LA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Iterative correction of Hi-C data reveals hallmarks of chromosome organization</article-title><source>Nature Methods</source><volume>9</volume><fpage>999</fpage><lpage>1003</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2148</pub-id><pub-id pub-id-type="pmid">22941365</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Javierre</surname> <given-names>BM</given-names></name><name><surname>Burren</surname> <given-names>OS</given-names></name><name><surname>Wilder</surname> <given-names>SP</given-names></name><name><surname>Kreuzhuber</surname> <given-names>R</given-names></name><name><surname>Hill</surname> <given-names>SM</given-names></name><name><surname>Sewitz</surname> <given-names>S</given-names></name><name><surname>Cairns</surname> <given-names>J</given-names></name><name><surname>Wingett</surname> <given-names>SW</given-names></name><name><surname>Várnai</surname> <given-names>C</given-names></name><name><surname>Thiecke</surname> <given-names>MJ</given-names></name><name><surname>Burden</surname> <given-names>F</given-names></name><name><surname>Farrow</surname> <given-names>S</given-names></name><name><surname>Cutler</surname> <given-names>AJ</given-names></name><name><surname>Rehnström</surname> <given-names>K</given-names></name><name><surname>Downes</surname> <given-names>K</given-names></name><name><surname>Grassi</surname> <given-names>L</given-names></name><name><surname>Kostadima</surname> <given-names>M</given-names></name><name><surname>Freire-Pritchett</surname> <given-names>P</given-names></name><name><surname>Wang</surname> <given-names>F</given-names></name><name><surname>Stunnenberg</surname> <given-names>HG</given-names></name><name><surname>Todd</surname> <given-names>JA</given-names></name><name><surname>Zerbino</surname> <given-names>DR</given-names></name><name><surname>Stegle</surname> <given-names>O</given-names></name><name><surname>Ouwehand</surname> <given-names>WH</given-names></name><name><surname>Frontini</surname> <given-names>M</given-names></name><name><surname>Wallace</surname> <given-names>C</given-names></name><name><surname>Spivakov</surname> <given-names>M</given-names></name><name><surname>Fraser</surname> <given-names>P</given-names></name><collab>BLUEPRINT Consortium</collab></person-group><year iso-8601-date="2016">2016</year><article-title>Lineage-Specific genome architecture links enhancers and Non-coding disease variants to target gene promoters</article-title><source>Cell</source><volume>167</volume><fpage>1369</fpage><lpage>1384</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.09.037</pub-id><pub-id pub-id-type="pmid">27863249</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname> <given-names>F</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Dixon</surname> <given-names>JR</given-names></name><name><surname>Selvaraj</surname> <given-names>S</given-names></name><name><surname>Ye</surname> <given-names>Z</given-names></name><name><surname>Lee</surname> <given-names>AY</given-names></name><name><surname>Yen</surname> <given-names>CA</given-names></name><name><surname>Schmitt</surname> <given-names>AD</given-names></name><name><surname>Espinoza</surname> <given-names>CA</given-names></name><name><surname>Ren</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A high-resolution map of the three-dimensional chromatin interactome in human cells</article-title><source>Nature</source><volume>503</volume><fpage>290</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1038/nature12644</pub-id><pub-id pub-id-type="pmid">24141950</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kerpedjiev</surname> <given-names>P</given-names></name><name><surname>Abdennur</surname> <given-names>N</given-names></name><name><surname>Lekschas</surname> <given-names>F</given-names></name><name><surname>McCallum</surname> <given-names>C</given-names></name><name><surname>Dinkla</surname> <given-names>K</given-names></name><name><surname>Strobelt</surname> <given-names>H</given-names></name><name><surname>Luber</surname> <given-names>JM</given-names></name><name><surname>Ouellette</surname> <given-names>SB</given-names></name><name><surname>Ahzir</surname> <given-names>A</given-names></name><name><surname>Kumar</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>HiGlass: web-based visual comparison and exploration of genome interaction maps</article-title><source>Genome Biology </source><pub-id pub-id-type="doi">10.1186/s13059-018-1486-1</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname> <given-names>A</given-names></name><name><surname>Fornes</surname> <given-names>O</given-names></name><name><surname>Stigliani</surname> <given-names>A</given-names></name><name><surname>Gheorghe</surname> <given-names>M</given-names></name><name><surname>Castro-Mondragon</surname> <given-names>JA</given-names></name><name><surname>van der Lee</surname> <given-names>R</given-names></name><name><surname>Bessy</surname> <given-names>A</given-names></name><name><surname>Chèneby</surname> <given-names>J</given-names></name><name><surname>Kulkarni</surname> <given-names>SR</given-names></name><name><surname>Tan</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>JASPAR 2018: update of the open-access database of transcription factor binding profiles and its web framework</article-title><source>Nucleic Acids Research</source><pub-id pub-id-type="doi">10.1093/nar/gkx1126</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knight</surname> <given-names>PA</given-names></name><name><surname>Ruiz</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A fast algorithm for matrix balancing</article-title><source>IMA Journal of Numerical Analysis</source><volume>33</volume><fpage>1029</fpage><lpage>1047</lpage><pub-id pub-id-type="doi">10.1093/imanum/drs019</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kundaje</surname> <given-names>A</given-names></name><name><surname>Meuleman</surname> <given-names>W</given-names></name><name><surname>Ernst</surname> <given-names>J</given-names></name><name><surname>Bilenky</surname> <given-names>M</given-names></name><name><surname>Yen</surname> <given-names>A</given-names></name><name><surname>Heravi-Moussavi</surname> <given-names>A</given-names></name><name><surname>Kheradpour</surname> <given-names>P</given-names></name><name><surname>Zhang</surname> <given-names>Z</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Ziller</surname> <given-names>MJ</given-names></name><name><surname>Amin</surname> <given-names>V</given-names></name><name><surname>Whitaker</surname> <given-names>JW</given-names></name><name><surname>Schultz</surname> <given-names>MD</given-names></name><name><surname>Ward</surname> <given-names>LD</given-names></name><name><surname>Sarkar</surname> <given-names>A</given-names></name><name><surname>Quon</surname> <given-names>G</given-names></name><name><surname>Sandstrom</surname> <given-names>RS</given-names></name><name><surname>Eaton</surname> <given-names>ML</given-names></name><name><surname>Wu</surname> <given-names>YC</given-names></name><name><surname>Pfenning</surname> <given-names>AR</given-names></name><name><surname>Wang</surname> <given-names>X</given-names></name><name><surname>Claussnitzer</surname> <given-names>M</given-names></name><name><surname>Liu</surname> <given-names>Y</given-names></name><name><surname>Coarfa</surname> <given-names>C</given-names></name><name><surname>Harris</surname> <given-names>RA</given-names></name><name><surname>Shoresh</surname> <given-names>N</given-names></name><name><surname>Epstein</surname> <given-names>CB</given-names></name><name><surname>Gjoneska</surname> <given-names>E</given-names></name><name><surname>Leung</surname> <given-names>D</given-names></name><name><surname>Xie</surname> <given-names>W</given-names></name><name><surname>Hawkins</surname> <given-names>RD</given-names></name><name><surname>Lister</surname> <given-names>R</given-names></name><name><surname>Hong</surname> <given-names>C</given-names></name><name><surname>Gascard</surname> <given-names>P</given-names></name><name><surname>Mungall</surname> <given-names>AJ</given-names></name><name><surname>Moore</surname> <given-names>R</given-names></name><name><surname>Chuah</surname> <given-names>E</given-names></name><name><surname>Tam</surname> <given-names>A</given-names></name><name><surname>Canfield</surname> <given-names>TK</given-names></name><name><surname>Hansen</surname> <given-names>RS</given-names></name><name><surname>Kaul</surname> <given-names>R</given-names></name><name><surname>Sabo</surname> <given-names>PJ</given-names></name><name><surname>Bansal</surname> <given-names>MS</given-names></name><name><surname>Carles</surname> <given-names>A</given-names></name><name><surname>Dixon</surname> <given-names>JR</given-names></name><name><surname>Farh</surname> <given-names>KH</given-names></name><name><surname>Feizi</surname> <given-names>S</given-names></name><name><surname>Karlic</surname> <given-names>R</given-names></name><name><surname>Kim</surname> <given-names>AR</given-names></name><name><surname>Kulkarni</surname> <given-names>A</given-names></name><name><surname>Li</surname> <given-names>D</given-names></name><name><surname>Lowdon</surname> <given-names>R</given-names></name><name><surname>Elliott</surname> <given-names>G</given-names></name><name><surname>Mercer</surname> <given-names>TR</given-names></name><name><surname>Neph</surname> <given-names>SJ</given-names></name><name><surname>Onuchic</surname> <given-names>V</given-names></name><name><surname>Polak</surname> <given-names>P</given-names></name><name><surname>Rajagopal</surname> <given-names>N</given-names></name><name><surname>Ray</surname> <given-names>P</given-names></name><name><surname>Sallari</surname> <given-names>RC</given-names></name><name><surname>Siebenthall</surname> <given-names>KT</given-names></name><name><surname>Sinnott-Armstrong</surname> <given-names>NA</given-names></name><name><surname>Stevens</surname> <given-names>M</given-names></name><name><surname>Thurman</surname> <given-names>RE</given-names></name><name><surname>Wu</surname> <given-names>J</given-names></name><name><surname>Zhang</surname> <given-names>B</given-names></name><name><surname>Zhou</surname> <given-names>X</given-names></name><name><surname>Beaudet</surname> <given-names>AE</given-names></name><name><surname>Boyer</surname> <given-names>LA</given-names></name><name><surname>De Jager</surname> <given-names>PL</given-names></name><name><surname>Farnham</surname> <given-names>PJ</given-names></name><name><surname>Fisher</surname> <given-names>SJ</given-names></name><name><surname>Haussler</surname> <given-names>D</given-names></name><name><surname>Jones</surname> <given-names>SJ</given-names></name><name><surname>Li</surname> <given-names>W</given-names></name><name><surname>Marra</surname> <given-names>MA</given-names></name><name><surname>McManus</surname> <given-names>MT</given-names></name><name><surname>Sunyaev</surname> <given-names>S</given-names></name><name><surname>Thomson</surname> <given-names>JA</given-names></name><name><surname>Tlsty</surname> <given-names>TD</given-names></name><name><surname>Tsai</surname> <given-names>LH</given-names></name><name><surname>Wang</surname> <given-names>W</given-names></name><name><surname>Waterland</surname> <given-names>RA</given-names></name><name><surname>Zhang</surname> <given-names>MQ</given-names></name><name><surname>Chadwick</surname> <given-names>LH</given-names></name><name><surname>Bernstein</surname> <given-names>BE</given-names></name><name><surname>Costello</surname> <given-names>JF</given-names></name><name><surname>Ecker</surname> <given-names>JR</given-names></name><name><surname>Hirst</surname> <given-names>M</given-names></name><name><surname>Meissner</surname> <given-names>A</given-names></name><name><surname>Milosavljevic</surname> <given-names>A</given-names></name><name><surname>Ren</surname> <given-names>B</given-names></name><name><surname>Stamatoyannopoulos</surname> <given-names>JA</given-names></name><name><surname>Wang</surname> <given-names>T</given-names></name><name><surname>Kellis</surname> <given-names>M</given-names></name><collab>Roadmap Epigenomics Consortium</collab></person-group><year iso-8601-date="2015">2015</year><article-title>Integrative analysis of 111 reference human epigenomes</article-title><source>Nature</source><volume>518</volume><fpage>317</fpage><lpage>330</lpage><pub-id pub-id-type="doi">10.1038/nature14248</pub-id><pub-id pub-id-type="pmid">25693563</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>B</given-names></name><name><surname>Dewey</surname> <given-names>CN</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title><source>BMC Bioinformatics</source><volume>12</volume><elocation-id>323</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id><pub-id pub-id-type="pmid">21816040</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>H</given-names></name><name><surname>Durbin</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Fast and accurate long-read alignment with Burrows-Wheeler transform</article-title><source>Bioinformatics</source><volume>26</volume><fpage>589</fpage><lpage>595</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp698</pub-id><pub-id pub-id-type="pmid">20080505</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lieberman-Aiden</surname> <given-names>E</given-names></name><name><surname>van Berkum</surname> <given-names>NL</given-names></name><name><surname>Williams</surname> <given-names>L</given-names></name><name><surname>Imakaev</surname> <given-names>M</given-names></name><name><surname>Ragoczy</surname> <given-names>T</given-names></name><name><surname>Telling</surname> <given-names>A</given-names></name><name><surname>Amit</surname> <given-names>I</given-names></name><name><surname>Lajoie</surname> <given-names>BR</given-names></name><name><surname>Sabo</surname> <given-names>PJ</given-names></name><name><surname>Dorschner</surname> <given-names>MO</given-names></name><name><surname>Sandstrom</surname> <given-names>R</given-names></name><name><surname>Bernstein</surname> <given-names>B</given-names></name><name><surname>Bender</surname> <given-names>MA</given-names></name><name><surname>Groudine</surname> <given-names>M</given-names></name><name><surname>Gnirke</surname> <given-names>A</given-names></name><name><surname>Stamatoyannopoulos</surname> <given-names>J</given-names></name><name><surname>Mirny</surname> <given-names>LA</given-names></name><name><surname>Lander</surname> <given-names>ES</given-names></name><name><surname>Dekker</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title><source>Science</source><volume>326</volume><fpage>289</fpage><lpage>293</lpage><pub-id pub-id-type="doi">10.1126/science.1181369</pub-id><pub-id pub-id-type="pmid">19815776</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lun</surname> <given-names>AT</given-names></name><name><surname>Smyth</surname> <given-names>GK</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>diffHic: a bioconductor package to detect differential genomic interactions in Hi-C data</article-title><source>BMC Bioinformatics</source><volume>16</volume><elocation-id>258</elocation-id><pub-id pub-id-type="doi">10.1186/s12859-015-0683-0</pub-id><pub-id pub-id-type="pmid">26283514</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Cutadapt removes adapter sequences from high-throughput sequencing reads</article-title><source>EMBnet.journal</source><volume>17</volume><elocation-id>10</elocation-id><pub-id pub-id-type="doi">10.14806/ej.17.1.200</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mifsud</surname> <given-names>B</given-names></name><name><surname>Tavares-Cadete</surname> <given-names>F</given-names></name><name><surname>Young</surname> <given-names>AN</given-names></name><name><surname>Sugar</surname> <given-names>R</given-names></name><name><surname>Schoenfelder</surname> <given-names>S</given-names></name><name><surname>Ferreira</surname> <given-names>L</given-names></name><name><surname>Wingett</surname> <given-names>SW</given-names></name><name><surname>Andrews</surname> <given-names>S</given-names></name><name><surname>Grey</surname> <given-names>W</given-names></name><name><surname>Ewels</surname> <given-names>PA</given-names></name><name><surname>Herman</surname> <given-names>B</given-names></name><name><surname>Happe</surname> <given-names>S</given-names></name><name><surname>Higgs</surname> <given-names>A</given-names></name><name><surname>LeProust</surname> <given-names>E</given-names></name><name><surname>Follows</surname> <given-names>GA</given-names></name><name><surname>Fraser</surname> <given-names>P</given-names></name><name><surname>Luscombe</surname> <given-names>NM</given-names></name><name><surname>Osborne</surname> <given-names>CS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Mapping long-range promoter contacts in human cells with high-resolution capture Hi-C</article-title><source>Nature Genetics</source><volume>47</volume><fpage>598</fpage><lpage>606</lpage><pub-id pub-id-type="doi">10.1038/ng.3286</pub-id><pub-id pub-id-type="pmid">25938943</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ong</surname> <given-names>CT</given-names></name><name><surname>Corces</surname> <given-names>VG</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>CTCF: an architectural protein bridging genome topology and function</article-title><source>Nature Reviews Genetics</source><volume>15</volume><fpage>234</fpage><lpage>246</lpage><pub-id pub-id-type="doi">10.1038/nrg3663</pub-id><pub-id pub-id-type="pmid">24614316</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Open R</collab></person-group><year iso-8601-date="2015">2015</year><data-title>RepeatMasker</data-title><version designator="4.0">4.0</version><ext-link ext-link-type="uri" xlink:href="https://www.repeatmasker.org">https://www.repeatmasker.org</ext-link></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pombo</surname> <given-names>A</given-names></name><name><surname>Dillon</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Three-dimensional genome architecture: players and mechanisms</article-title><source>Nature Reviews Molecular Cell Biology</source><volume>16</volume><fpage>245</fpage><lpage>257</lpage><pub-id pub-id-type="doi">10.1038/nrm3965</pub-id><pub-id pub-id-type="pmid">25757416</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rao</surname> <given-names>SS</given-names></name><name><surname>Huntley</surname> <given-names>MH</given-names></name><name><surname>Durand</surname> <given-names>NC</given-names></name><name><surname>Stamenova</surname> <given-names>EK</given-names></name><name><surname>Bochkov</surname> <given-names>ID</given-names></name><name><surname>Robinson</surname> <given-names>JT</given-names></name><name><surname>Sanborn</surname> <given-names>AL</given-names></name><name><surname>Machol</surname> <given-names>I</given-names></name><name><surname>Omer</surname> <given-names>AD</given-names></name><name><surname>Lander</surname> <given-names>ES</given-names></name><name><surname>Aiden</surname> <given-names>EL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A 3D map of the human genome at Kilobase resolution reveals principles of chromatin looping</article-title><source>Cell</source><volume>159</volume><fpage>1665</fpage><lpage>1680</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id><pub-id pub-id-type="pmid">25497547</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosa-Garrido</surname> <given-names>M</given-names></name><name><surname>Chapski</surname> <given-names>DJ</given-names></name><name><surname>Schmitt</surname> <given-names>AD</given-names></name><name><surname>Kimball</surname> <given-names>TH</given-names></name><name><surname>Karbassi</surname> <given-names>E</given-names></name><name><surname>Monte</surname> <given-names>E</given-names></name><name><surname>Balderas</surname> <given-names>E</given-names></name><name><surname>Pellegrini</surname> <given-names>M</given-names></name><name><surname>Shih</surname> <given-names>TT</given-names></name><name><surname>Soehalim</surname> <given-names>E</given-names></name><name><surname>Liem</surname> <given-names>D</given-names></name><name><surname>Ping</surname> <given-names>P</given-names></name><name><surname>Galjart</surname> <given-names>NJ</given-names></name><name><surname>Ren</surname> <given-names>S</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Ren</surname> <given-names>B</given-names></name><name><surname>Vondriska</surname> <given-names>TM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>High-Resolution mapping of chromatin conformation in cardiac myocytes reveals structural remodeling of the epigenome in heart failure</article-title><source>Circulation</source><volume>136</volume><fpage>1613</fpage><lpage>1625</lpage><pub-id pub-id-type="doi">10.1161/CIRCULATIONAHA.117.029430</pub-id><pub-id pub-id-type="pmid">28802249</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Safran</surname> <given-names>M</given-names></name><name><surname>Dalah</surname> <given-names>I</given-names></name><name><surname>Alexander</surname> <given-names>J</given-names></name><name><surname>Rosen</surname> <given-names>N</given-names></name><name><surname>Iny Stein</surname> <given-names>T</given-names></name><name><surname>Shmoish</surname> <given-names>M</given-names></name><name><surname>Nativ</surname> <given-names>N</given-names></name><name><surname>Bahir</surname> <given-names>I</given-names></name><name><surname>Doniger</surname> <given-names>T</given-names></name><name><surname>Krug</surname> <given-names>H</given-names></name><name><surname>Sirota-Madi</surname> <given-names>A</given-names></name><name><surname>Olender</surname> <given-names>T</given-names></name><name><surname>Golan</surname> <given-names>Y</given-names></name><name><surname>Stelzer</surname> <given-names>G</given-names></name><name><surname>Harel</surname> <given-names>A</given-names></name><name><surname>Lancet</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>GeneCards version 3: the human gene integrator</article-title><source>Database</source><volume>2010</volume><elocation-id>baq020</elocation-id><pub-id pub-id-type="doi">10.1093/database/baq020</pub-id><pub-id pub-id-type="pmid">20689021</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Servant</surname> <given-names>N</given-names></name><name><surname>Varoquaux</surname> <given-names>N</given-names></name><name><surname>Lajoie</surname> <given-names>BR</given-names></name><name><surname>Viara</surname> <given-names>E</given-names></name><name><surname>Chen</surname> <given-names>CJ</given-names></name><name><surname>Vert</surname> <given-names>JP</given-names></name><name><surname>Heard</surname> <given-names>E</given-names></name><name><surname>Dekker</surname> <given-names>J</given-names></name><name><surname>Barillot</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>HiC-Pro: an optimized and flexible pipeline for Hi-C data processing</article-title><source>Genome Biology</source><volume>16</volume><elocation-id>259</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-015-0831-x</pub-id><pub-id pub-id-type="pmid">26619908</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spielmann</surname> <given-names>M</given-names></name><name><surname>Lupiáñez</surname> <given-names>DG</given-names></name><name><surname>Mundlos</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Structural variation in the 3D genome</article-title><source>Nature Reviews Genetics</source><volume>19</volume><fpage>453</fpage><lpage>467</lpage><pub-id pub-id-type="doi">10.1038/s41576-018-0007-0</pub-id><pub-id pub-id-type="pmid">29692413</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname> <given-names>JH</given-names></name><name><surname>Zhou</surname> <given-names>L</given-names></name><name><surname>Emerson</surname> <given-names>DJ</given-names></name><name><surname>Phyo</surname> <given-names>SA</given-names></name><name><surname>Titus</surname> <given-names>KR</given-names></name><name><surname>Gong</surname> <given-names>W</given-names></name><name><surname>Gilgenast</surname> <given-names>TG</given-names></name><name><surname>Beagan</surname> <given-names>JA</given-names></name><name><surname>Davidson</surname> <given-names>BL</given-names></name><name><surname>Tassone</surname> <given-names>F</given-names></name><name><surname>Phillips-Cremins</surname> <given-names>JE</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Disease-Associated short tandem repeats Co-localize with chromatin domain boundaries</article-title><source>Cell</source><volume>175</volume><fpage>224</fpage><lpage>238</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.08.005</pub-id><pub-id pub-id-type="pmid">30173918</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname> <given-names>Z</given-names></name><name><surname>Luo</surname> <given-names>OJ</given-names></name><name><surname>Li</surname> <given-names>X</given-names></name><name><surname>Zheng</surname> <given-names>M</given-names></name><name><surname>Zhu</surname> <given-names>JJ</given-names></name><name><surname>Szalaj</surname> <given-names>P</given-names></name><name><surname>Trzaskoma</surname> <given-names>P</given-names></name><name><surname>Magalska</surname> <given-names>A</given-names></name><name><surname>Wlodarczyk</surname> <given-names>J</given-names></name><name><surname>Ruszczycki</surname> <given-names>B</given-names></name><name><surname>Michalski</surname> <given-names>P</given-names></name><name><surname>Piecuch</surname> <given-names>E</given-names></name><name><surname>Wang</surname> <given-names>P</given-names></name><name><surname>Wang</surname> <given-names>D</given-names></name><name><surname>Tian</surname> <given-names>SZ</given-names></name><name><surname>Penrad-Mobayed</surname> <given-names>M</given-names></name><name><surname>Sachs</surname> <given-names>LM</given-names></name><name><surname>Ruan</surname> <given-names>X</given-names></name><name><surname>Wei</surname> <given-names>CL</given-names></name><name><surname>Liu</surname> <given-names>ET</given-names></name><name><surname>Wilczynski</surname> <given-names>GM</given-names></name><name><surname>Plewczynski</surname> <given-names>D</given-names></name><name><surname>Li</surname> <given-names>G</given-names></name><name><surname>Ruan</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>CTCF-Mediated human 3D genome architecture reveals chromatin topology for transcription</article-title><source>Cell</source><volume>163</volume><fpage>1611</fpage><lpage>1627</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.11.024</pub-id><pub-id pub-id-type="pmid">26686651</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Treangen</surname> <given-names>TJ</given-names></name><name><surname>Salzberg</surname> <given-names>SL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Repetitive DNA and next-generation sequencing: computational challenges and solutions</article-title><source>Nature Reviews Genetics</source><volume>13</volume><fpage>36</fpage><lpage>46</lpage><pub-id pub-id-type="doi">10.1038/nrg3117</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tyner</surname> <given-names>C</given-names></name><name><surname>Barber</surname> <given-names>GP</given-names></name><name><surname>Casper</surname> <given-names>J</given-names></name><name><surname>Clawson</surname> <given-names>H</given-names></name><name><surname>Diekhans</surname> <given-names>M</given-names></name><name><surname>Eisenhart</surname> <given-names>C</given-names></name><name><surname>Fischer</surname> <given-names>CM</given-names></name><name><surname>Gibson</surname> <given-names>D</given-names></name><name><surname>Gonzalez</surname> <given-names>JN</given-names></name><name><surname>Guruvadoo</surname> <given-names>L</given-names></name><name><surname>Haeussler</surname> <given-names>M</given-names></name><name><surname>Heitner</surname> <given-names>S</given-names></name><name><surname>Hinrichs</surname> <given-names>AS</given-names></name><name><surname>Karolchik</surname> <given-names>D</given-names></name><name><surname>Lee</surname> <given-names>BT</given-names></name><name><surname>Lee</surname> <given-names>CM</given-names></name><name><surname>Nejad</surname> <given-names>P</given-names></name><name><surname>Raney</surname> <given-names>BJ</given-names></name><name><surname>Rosenbloom</surname> <given-names>KR</given-names></name><name><surname>Speir</surname> <given-names>ML</given-names></name><name><surname>Villarreal</surname> <given-names>C</given-names></name><name><surname>Vivian</surname> <given-names>J</given-names></name><name><surname>Zweig</surname> <given-names>AS</given-names></name><name><surname>Haussler</surname> <given-names>D</given-names></name><name><surname>Kuhn</surname> <given-names>RM</given-names></name><name><surname>Kent</surname> <given-names>WJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The ucsc genome browser database: 2018 update</article-title><source>Nucleic Acids Research</source><volume>45</volume><pub-id pub-id-type="doi">10.1093/nar/gkw1134</pub-id><pub-id pub-id-type="pmid">27899642</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Won</surname> <given-names>H</given-names></name><name><surname>de la Torre-Ubieta</surname> <given-names>L</given-names></name><name><surname>Stein</surname> <given-names>JL</given-names></name><name><surname>Parikshak</surname> <given-names>NN</given-names></name><name><surname>Huang</surname> <given-names>J</given-names></name><name><surname>Opland</surname> <given-names>CK</given-names></name><name><surname>Gandal</surname> <given-names>MJ</given-names></name><name><surname>Sutton</surname> <given-names>GJ</given-names></name><name><surname>Hormozdiari</surname> <given-names>F</given-names></name><name><surname>Lu</surname> <given-names>D</given-names></name><name><surname>Lee</surname> <given-names>C</given-names></name><name><surname>Eskin</surname> <given-names>E</given-names></name><name><surname>Voineagu</surname> <given-names>I</given-names></name><name><surname>Ernst</surname> <given-names>J</given-names></name><name><surname>Geschwind</surname> <given-names>DH</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Chromosome conformation elucidates regulatory relationships in developing human brain</article-title><source>Nature</source><volume>538</volume><fpage>523</fpage><lpage>527</lpage><pub-id pub-id-type="doi">10.1038/nature19847</pub-id><pub-id pub-id-type="pmid">27760116</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname> <given-names>M</given-names></name><name><surname>Hong</surname> <given-names>C</given-names></name><name><surname>Zhang</surname> <given-names>B</given-names></name><name><surname>Lowdon</surname> <given-names>RF</given-names></name><name><surname>Xing</surname> <given-names>X</given-names></name><name><surname>Li</surname> <given-names>D</given-names></name><name><surname>Zhou</surname> <given-names>X</given-names></name><name><surname>Lee</surname> <given-names>HJ</given-names></name><name><surname>Maire</surname> <given-names>CL</given-names></name><name><surname>Ligon</surname> <given-names>KL</given-names></name><name><surname>Gascard</surname> <given-names>P</given-names></name><name><surname>Sigaroudinia</surname> <given-names>M</given-names></name><name><surname>Tlsty</surname> <given-names>TD</given-names></name><name><surname>Kadlecek</surname> <given-names>T</given-names></name><name><surname>Weiss</surname> <given-names>A</given-names></name><name><surname>O'Geen</surname> <given-names>H</given-names></name><name><surname>Farnham</surname> <given-names>PJ</given-names></name><name><surname>Madden</surname> <given-names>PA</given-names></name><name><surname>Mungall</surname> <given-names>AJ</given-names></name><name><surname>Tam</surname> <given-names>A</given-names></name><name><surname>Kamoh</surname> <given-names>B</given-names></name><name><surname>Cho</surname> <given-names>S</given-names></name><name><surname>Moore</surname> <given-names>R</given-names></name><name><surname>Hirst</surname> <given-names>M</given-names></name><name><surname>Marra</surname> <given-names>MA</given-names></name><name><surname>Costello</surname> <given-names>JF</given-names></name><name><surname>Wang</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>DNA hypomethylation within specific transposable element families associates with tissue-specific enhancer landscape</article-title><source>Nature Genetics</source><volume>45</volume><fpage>836</fpage><lpage>841</lpage><pub-id pub-id-type="doi">10.1038/ng.2649</pub-id><pub-id pub-id-type="pmid">23708189</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>T</given-names></name><name><surname>Zhang</surname> <given-names>F</given-names></name><name><surname>Yardımcı</surname> <given-names>GG</given-names></name><name><surname>Song</surname> <given-names>F</given-names></name><name><surname>Hardison</surname> <given-names>RC</given-names></name><name><surname>Noble</surname> <given-names>WS</given-names></name><name><surname>Yue</surname> <given-names>F</given-names></name><name><surname>Li</surname> <given-names>Q</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>HiCRep: assessing the reproducibility of Hi-C data using a stratum-adjusted correlation coefficient</article-title><source>Genome Research</source><volume>27</volume><fpage>1939</fpage><lpage>1949</lpage><pub-id pub-id-type="doi">10.1101/gr.220640.117</pub-id><pub-id pub-id-type="pmid">28855260</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Yardımcı</surname> <given-names>G</given-names></name><name><surname>Özadam</surname> <given-names>H</given-names></name><name><surname>Sauria</surname> <given-names>ME</given-names></name><name><surname>Ursu</surname> <given-names>O</given-names></name><name><surname>Yan</surname> <given-names>K-K</given-names></name><name><surname>Yang</surname> <given-names>T</given-names></name><name><surname>Chakraborty</surname> <given-names>A</given-names></name><name><surname>Kaul</surname> <given-names>A</given-names></name><name><surname>Lajoie</surname> <given-names>BR</given-names></name><name><surname>Song</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Measuring the reproducibility and quality of Hi-C data</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/188755</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname> <given-names>M</given-names></name><name><surname>Ren</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The Three-Dimensional organization of mammalian genomes</article-title><source>Annual Review of Cell and Developmental Biology</source><volume>33</volume><fpage>265</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1146/annurev-cellbio-100616-060531</pub-id><pub-id pub-id-type="pmid">28783961</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeng</surname> <given-names>X</given-names></name><name><surname>Li</surname> <given-names>B</given-names></name><name><surname>Welch</surname> <given-names>R</given-names></name><name><surname>Rojo</surname> <given-names>C</given-names></name><name><surname>Zheng</surname> <given-names>Y</given-names></name><name><surname>Dewey</surname> <given-names>CN</given-names></name><name><surname>Keleş</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Perm-seq: mapping Protein-DNA interactions in segmental duplication and highly repetitive regions of genomes with Prior-Enhanced read mapping</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004491</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004491</pub-id><pub-id pub-id-type="pmid">26484757</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>Q</given-names></name><name><surname>Keleş</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>CNV-guided multi-read allocation for ChIP-seq</article-title><source>Bioinformatics</source><volume>30</volume><fpage>2860</fpage><lpage>2867</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu402</pub-id><pub-id pub-id-type="pmid">24966364</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>Z</given-names></name><name><surname>Xing</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>CLIP-seq analysis of multi-mapped reads discovers novel functional RNA regulatory sites in the human transcriptome</article-title><source>Nucleic Acids Research</source><volume>45</volume><fpage>9260</fpage><lpage>9271</lpage><pub-id pub-id-type="doi">10.1093/nar/gkx646</pub-id><pub-id pub-id-type="pmid">28934506</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Zheng</surname> <given-names>Y</given-names></name><name><surname>Keleş</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Source code for mHi-C</data-title><version designator="250f0a3">250f0a3</version><publisher-name>GitHub</publisher-name><ext-link ext-link-type="uri" xlink:href="https://github.com/keleslab/mHiC">https://github.com/keleslab/mHiC</ext-link></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname> <given-names>X</given-names></name><name><surname>Maricque</surname> <given-names>B</given-names></name><name><surname>Xie</surname> <given-names>M</given-names></name><name><surname>Li</surname> <given-names>D</given-names></name><name><surname>Sundaram</surname> <given-names>V</given-names></name><name><surname>Martin</surname> <given-names>EA</given-names></name><name><surname>Koebbe</surname> <given-names>BC</given-names></name><name><surname>Nielsen</surname> <given-names>C</given-names></name><name><surname>Hirst</surname> <given-names>M</given-names></name><name><surname>Farnham</surname> <given-names>P</given-names></name><name><surname>Kuhn</surname> <given-names>RM</given-names></name><name><surname>Zhu</surname> <given-names>J</given-names></name><name><surname>Smirnov</surname> <given-names>I</given-names></name><name><surname>Kent</surname> <given-names>WJ</given-names></name><name><surname>Haussler</surname> <given-names>D</given-names></name><name><surname>Madden</surname> <given-names>PA</given-names></name><name><surname>Costello</surname> <given-names>JF</given-names></name><name><surname>Wang</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The human epigenome browser at Washington university</article-title><source>Nature Methods</source><volume>8</volume><fpage>989</fpage><lpage>990</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1772</pub-id><pub-id pub-id-type="pmid">22127213</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.38070.102</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Ren</surname><given-names>Bing</given-names></name><role>Reviewing Editor</role><aff><institution>University of California, San Diego School of Medicine</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Spivakov</surname><given-names>Mikhail</given-names> </name><role>Reviewer</role><aff><institution>The Babraham Institute</institution><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Statistical Methods for Profiling 3-Dimensional Chromatin Interactions from Repetitive Regions of Genomes&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and a Senior Editor. The following individual involved in review of your submission has agreed to reveal his identity: Mikhail Spivakov (Reviewer #1).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Zheng et al. describe a new approach and associated software tool (mHi-C) that attempts to rescue multi-mappers from Hi-C data. Multi-mappers are normally discarded in most analysis pipelines, but including them may help improve analysis results, particularly at and near repetitive regions of the genome. mHi-C uses a probabilistic model to assign likely multi-read alignment locations based on the expected properties of Hi-C read-pairs, including their average interaction profile as a function of distance between regions along the genome. The authors evaluate the impact mHi-C has on a variety of Hi-C analysis results, including the identification of significant contacts, analysis reproducibility, and TAD boundary identification, ultimately concluding that mHi-C identifies additional chromatin interaction features and generally improves the accuracy and interpretation of Hi-C data.</p><p>This work is very timely as there are few (if any) suitable methods available that address multi-mapping reads from Hi-C experiments. mHi-C has the potential to make Hi-C data analysis more complete by avoiding discarding data and could potentially enable the analysis of how repetitive regions interact in the nucleus, which until this point has been largely ignored.</p><p>While the authors' approach appears reasonable, the main limitation of the manuscript is that the improvement in Hi-C analysis enabled by using mHi-C to re-interpret multi-mappers is difficult to judge, even for someone with experience looking at Hi-C data. More specifically, the primary concern is that the analysis lacks a gold standard and negative control datasets to properly interpret the reported improvement in Hi-C analysis afforded by mHi-C.</p><p>Essential revisions:</p><p>1) In an effort to improve the interpretation of mHi-C's impact on Hi-C analysis results, the authors should take a different approach for the evaluation of their method that would improve the manuscript. For example:</p><p>- It would be good to have a clearer idea of the method's accuracy at different ranges of read mappability – ideally, on simulated data derived using methods such as Sim3C (https://doi.org/10.1093/gigascience/gix103).</p><p>- The authors use a single mammalian dataset for validation, but it would be useful to evaluate its accuracy and gain in interaction detection power for a range of mammalian datasets of different quality (as assessed, for example, by cis/trans-ratios) and coverage, generated by different labs.</p><p>- Take a set of publicly available long read Hi-C experiments and artificially truncate the sequencing reads to create a gold-standard data set that could be used to evaluate how well mHi-C &quot;recovers&quot; the true alignment positions using the truncated reads. The truncated data, the original data, and the inferred mHi-C analysis of the truncated data could then be compared to evaluate how accurately mHi-C recovered the original read alignment positions, and then the improvement of Hi-C analysis metrics could be compared to see how mHi-C does compared to the true positive result of comparing the original read alignments vs. the truncated set. This would provide the needed context to evaluate how these metrics and analysis scores should be interpreted with respect to a true positive. It would be even better to include a negative control for comparison based on the random assignment of multi-mapper positions using a uniform prior (i.e. randomly take one of the valid read-pair alignments without considering distance etc.).</p><p>With these datasets you can estimate how much better the TADs should look if multi-mapper assignment was perfect, and how many more significant interactions there should be, etc., by comparing the true positive data to the truncated data. This analysis has the added benefit of enabling a direct calculation of mHi-C assignment accuracy and could identify which types of multi-mappers are more problematic, and may provide evidence of which repetitive features (i.e. LINE/SINE/segmental duplications/centromeres/etc.) are easy or hard to assign multi-mappers to.</p><p>2) Comparison with normalized Hi-C matrix: the authors need to compare their results with either ICE normalized or model-based method normalized Hi-C matrix. As mappability is one of the most important factors during normalization procedure, the results of comparison can be valuable to demonstrate the significance of this work.</p><p>3) Figure 5: it would be much more convincing if the authors can further zoom in, and clearly show a few examples where a specific enhancer-promoter interaction is captured only by mHi-C? Maybe virtual 4C is the best way for this purpose.</p><p>4) What is the purpose of Figure 3? Why is there a need to introduce an alternative approach to mHi-C model and make it into a main figure?</p><p>5) The title suggests that the authors will explore the chromatin interactions from repetitive regions. However, not much analysis was provided on this perspective. It would be really interesting if the authors could delve into this topic. For example, whether certain repetitive elements or sub-class of repetitive elements are involved with the formation of chromatin looping or TADs.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Generative Modeling of Multi-mapping Reads with mHi-C Advances Analysis of Hi-C Studies&quot; for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by a Senior Editor, a Reviewing Editor, and three reviewers.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</p><p>One primary concern is &quot;why including multi-mappers would increase the reproducibility of Hi-C contact maps.&quot; This might be related to how the concept of 'reproducibility' (Figure 2 and other panels, subsection “Probabilistic assignment of multi-reads results in more complete contact matrices and significantly improves reproducibility across replicates”) is defined. It would be important to clearly establish how the improvement in reproducibility by multi-mapper is not a consequence of artifacts. There are other concerns with the TAD analysis, and unsatisfactory responses to two issues raised by one reviewer (#3).</p><p><italic>Reviewer #1:</italic> </p><p>I am happy with the changes made and recommend accepting the paper for publication.</p><p><italic>Reviewer #2:</italic> </p><p>The authors have considerably improved the manuscript, implementing many of the suggestions from the previous review and refining their results.</p><p>Concerns on the revision:</p><p>The primary concern in the revision is how the authors discuss the concept of 'reproducibility' (Figure 2 and other panels, subsection “Probabilistic assignment of multi-reads results in more complete contact matrices and significantly improves reproducibility across replicates”). Specifically, it is not clear conceptually why including multi-mappers would increase the reproducibility of Hi-C contact maps. It is clear that proper inclusion of multi-mappers should increase the completeness of the data, but since there is still a decent chance of mis-assignment when assigning multi-mappers (~25% based on Figure 6B), it's hard to understand how the 'reproducibility' should increase with the inclusion of multi-mappers. One would expect the uni-mappers to be the most 'reproducible' part of the data since they can be accurately placed, so adding data with 'less reproducible' mapping rates to the experiment should, if anything, reduce the actual reproducibility.</p><p>One (likely) explanation for this is that mHi-C assigns multi-mappers 'reproducibly' to the same loci across multiple experiments (even if these assignments are not appropriate), which might give the illusion of higher reproducibility. An important control for this is to compare the computationally trimmed dataset reproducibility to the original uni-read reproducibility, which is unfortunately omitted in Figure 7A, which only compares trimmed uni-mappers to trimmed uni+multi mappers. If the original uni-reads are in fact less reproducible than the trimmed-uniq+multi mapper experiments, there is a very good chance the reproducibility metric is being inflated by consistent assignment of multimappers to certain loci by mHi-C. This is not necessarily a major problem with the method (since the authors demonstrate nicely that mHi-C provides many benefits for Hi-C analysis), but it is a major problem with the interpretation of mHi-C's benefits with respect to reproducibility, which is stated many times throughout the manuscript.</p><p>The TAD analysis is still not very convincing (Figure 7B). The contact matrices look really similar between all conditions, but the called TADs for the Trimmed Uni-reads looks different for some reason. For example, the big TAD on the upper left doesn't seem to adhere to the likely TAD in the contact map. This may be a quirk of the TAD identification algorithm, but it doesn't make for a convincing visual case. The contact map intensity for many of the figures is getting clipped at local interactions (i.e. the region near the diagonal is essentially the same color of red), making it hard to see where the key differences are that drive the difference in the TAD calling. I would highly recommend either zooming in on smaller regions and/or changing the color scheme/scaling so that the TAD calls and the contact map can be more clearly evaluated by the reader.</p><p><italic>Reviewer #3:</italic> </p><p>The authors have addressed most of my concerns. Two questions remain:</p><p>1) Figure 4A: I am confused. First of all, the second track shouldn't be there – that's the whole chromosome. I think what the authors intended to plotted is the region in the tiny blue box. Second comment about this figure: if you look at the first track (virtual 4C), in the middle, there is a strong Uni&amp;Multi peak, but when you look at the bottom two tracks (arcs), it shows it is uni-specific interaction. Can author clarify what happened?</p><p>2) Regarding this response about its performance on normalized Hi-C matrix, the authors commented that &quot;We updated all the visualizations to display both the normalized and unnormalized versions (Figure 2A, Figure 2—f – —figure supplements 1-4). While the normalized Uni-setting matrices look less incomplete highlighting the impact of normalization, mHi-C generated matrices look visually more complete and display the impact of multi-reads. We provided several such examples as supplementary figures.&quot;</p><p>I found the answer is not satisfactory – the authors need to provide quantitative evaluation of this claim.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.38070.103</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) In an effort to improve the interpretation of mHi-C's impact on Hi-C analysis results, the authors should take a different approach for the evaluation of their method that would improve the manuscript. For example:</p><p>- It would be good to have a clearer idea of the method's accuracy at different ranges of read mappability – ideally, on simulated data derived using methods such as Sim3C (https://doi.org/10.1093/gigascience/gix103).</p></disp-quote><p>We have addressed this point both with trimming experiments where we trim long read datasets to generate shorter read sets and also with simulations where we simulate Hi-C multi-reads. The results displayed in Figures 6B, C and Figure 6—figure supplements 2-5 demonstrate mHi-C’s accuracy in finding correct assignments for multi reads.</p><p>These results are incorporated into the subsection “Large-scale evaluation of mHi-C with computational trimming experiments and simulations establishes its accuracy” as follows:</p><p>“We first investigated the multi-read allocation accuracy with respect to trimmed read length, sequencing depth, and mappability at resolution 40 kb. […] Figure 6—figure supplements 3-6 provide accuracy results closely following the results presented in this section from these additional settings and further validate significantly better performance of mHi-C compared to the random allocation and other heuristic approaches across different trimmed read lengths.”</p><disp-quote content-type="editor-comment"><p>- The authors use a single mammalian dataset for validation, but it would be useful to evaluate its accuracy and gain in interaction detection power for a range of mammalian datasets of different quality (as assessed, for example, by cis/trans-ratios) and coverage, generated by different labs.</p></disp-quote><p>We have now included 8 datasets from 6 different studies, totaling 4 human, 3 mice, and a <italic>Plasmodium falciparum</italic> dataset with varying characteristics and showed that our main conclusions are consistent across the board. The results pertaining abundance of multi-reads (Figure 1B, D and Figure 1—figure supplements 3-6), their impact on reproducibility (Figure 2B, C and Figure 2—figure supplements 6-9), and gain in power (Figure 3A, B and Figure 3—figure supplements 1-7) are updated with results across all datasets. We further utilized IMR90 and GM12878 datasets along with long read A459 dataset for more detailed analysis, trimming experiments, and simulations. Discussion on the datasets selected is included into the subsection “Multi-reads significantly increase the sequencing depths of Hi-C data” as follows:</p><p>“For developing mHi-C and studying its operating characteristics, we utilized six published studies, resulting in eight datasets with multiple replicates, as summarized in Table 1 with more details in Figure 1—source data 1: Table 1. […] Specifically, they span a wide range of sequencing depths (Figure 1B), coverages and <italic>cis</italic>-to-<italic>trans</italic> ratios (Figure 1—figure supplement 3), and have different proportions of mappable and valid reads (Figure 1—figure supplement 4).”</p><disp-quote content-type="editor-comment"><p>- Take a set of publicly available long read Hi-C experiments and artificially truncate the sequencing reads to create a gold-standard data set that could be used to evaluate how well mHi-C &quot;recovers&quot; the true alignment positions using the truncated reads. The truncated data, the original data, and the inferred mHi-C analysis of the truncated data could then be compared to evaluate how accurately mHi-C recovered the original read alignment positions, and then the improvement of Hi-C analysis metrics could be compared to see how mHi-C does compared to the true positive result of comparing the original read alignments vs. the truncated set. This would provide the needed context to evaluate how these metrics and analysis scores should be interpreted with respect to a true positive. It would be even better to include a negative control for comparison based on the random assignment of multi-mapper positions using a uniform prior (i.e. randomly take one of the valid read-pair alignments without considering distance etc.).</p><p>With these datasets you can estimate how much better the TADs should look if multi-mapper assignment was perfect, and how many more significant interactions there should be, etc., by comparing the true positive data to the truncated data. This analysis has the added benefit of enabling a direct calculation of mHi-C assignment accuracy and could identify which types of multi-mappers are more problematic, and may provide evidence of which repetitive features (i.e. LINE/SINE/segmental duplications/centromeres/etc.) are easy or hard to assign multi-mappers to.</p></disp-quote><p>We would like to thank the reviewers for these excellent suggestions. We carried out the trimming experiment utilizing the long read (151bp) A549 dataset. Specifically, we leveraged this dataset to evaluate mHi-C in terms of:</p><p>i) multi-read allocation accuracy, both overall and stratified with respect to read length, mappability, and repetitive elements. Such accuracy is compared with model-free approaches as well as random selection as a baseline. (Figure 6 and Figure 6—figure supplements 2-6);</p><p>ii) the ability to recover contact matrix of the full read length dataset that the trimming is based on (Figure 7A, Figure 7—figure supplement 1), ability to recover TAD calls of the full read length dataset (Figure 7B, Figure 7—figure supplements 2-5) and ability to detect significant interactions that can be detected by the full read length dataset (Figure 7C-E and Figure 7—figure supplements 6-8).</p><p>The subsection “Large-scale evaluation of mHi-C with computational trimming experiments and simulations establishes its accuracy” is largely dedicated to the results from these trimming experiments.</p><disp-quote content-type="editor-comment"><p>2) Comparison with normalized Hi-C matrix: the authors need to compare their results with either ICE normalized or model-based method normalized Hi-C matrix. As mappability is one of the most important factors during normalization procedure, the results of comparison can be valuable to demonstrate the significance of this work.</p></disp-quote><p>We updated all the visualizations to display both the normalized and unnormalized versions (Figure 2A, Figure 2—figure supplements 1-4). While the normalized Uni-setting matrices look less incomplete highlighting the impact of normalization, mHi-C generated matrices look visually more complete and display the impact of multi-reads. We provided several such examples as supplementary figures.</p><disp-quote content-type="editor-comment"><p>3) Figure 5: it would be much more convincing if the authors can further zoom in, and clearly show a few examples where a specific enhancer-promoter interaction is captured only by mHi-C? Maybe virtual 4C is the best way for this purpose.</p></disp-quote><p>Figure 4A and Figure 4—figure supplements 1-2 now provide higher resolution examples of reproducibly detected novel promoter-enhancer interactions with a 4C like display.</p><disp-quote content-type="editor-comment"><p>4) What is the purpose of Figure 3? Why is there a need to introduce an alternative approach to mHi-C model and make it into a main figure?</p></disp-quote><p>Great question! When we discuss multi-reads in various research communities, everyone seems to come up with various suggestions that have not been applied or implemented yet. Nonetheless, we wanted to summarize the reasonable, albeit heuristic, approaches of allocating multi-reads and compare these with mHi-C. We have now included this figure as supplement (Figure 6—figure supplement 7) and reorganized the related analysis in the subsection “Comparison of mHi-C with model-free multi-reads allocation for their impact on identifying differential interactions”. More importantly, we were able to evaluate these heuristic approaches along with a baseline method of randomly selecting one of the alignments in our trimming experiments and simulations (Figure 6 and Figure 6—figure supplements 3, 4).</p><disp-quote content-type="editor-comment"><p>5) The title suggests that the authors will explore the chromatin interactions from repetitive regions. However, not much analysis was provided on this perspective. It would be really interesting if the authors could delve into this topic. For example, whether certain repetitive elements or sub-class of repetitive elements are involved with the formation of chromatin looping or TADs.</p></disp-quote><p>We completely agree that delving more into this topic would be very interesting. For this manuscript, we evaluated the abundance of repetitive elements at TAD boundaries. This analysis indicated that at lower resolutions (e.g., 40 kb bin size), there are not significant differences in the abundance of repetitive elements under the Uni and Uni&amp;Multi-settings. However, the analysis of GM12878 datasets at the 5 kb resolution clearly illustrates enrichment of the SINE elements, segmental duplications, and satellite repeats at the TAD boundaries compared to within boundaries and intervals of the same size genome-wide intervals (Figure 5D). More interestingly, the SINE category both has the highest average enrichment and is enhanced by mHi-C (Figure 5—figure supplement 11B).</p><p>This analysis is now incorporated into the subsection <italic>“</italic>Multi-reads refine the boundaries of topologically associating domains” as follows.</p><p>“Next, we assessed the abundance of different classes of repetitive elements, from the RepeatMasker (Open, 2015) and UCSC genome browser (Casper et al., 2017) hg19 assembly, at the reproducible TAD boundaries. […] In summary, under Uni&amp;Multi-setting, the detected TAD boundaries tend to harbor more SINE elements supporting prior work that human genome folding is markedly associated with the SINE family Cournac et al. (2015).”</p><p>We also thought that the title “Generative Modeling of Multi-mapping Reads with mHi-C Advances Analysis of High Throughput Genome-wide Conformation Capture Studies” is now more reflective of the research presented in this paper.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>The authors have considerably improved the manuscript, implementing many of the suggestions from the previous review and refining their results.</p><p>Concerns on the revision:</p><p>The primary concern in the revision is how the authors discuss the concept of 'reproducibility' (Figure 2 and other panels, subsection “Probabilistic assignment of multi-reads results in more complete contact matrices and significantly improves reproducibility across replicates”). Specifically, it is not clear conceptually why including multi-mappers would increase the reproducibility of Hi-C contact maps. It is clear that proper inclusion of multi-mappers should increase the completeness of the data, but since there is still a decent chance of mis-assignment when assigning multi-mappers (~25% based on Figure 6B), it's hard to understand how the 'reproducibility' should increase with the inclusion of multi-mappers. One would expect the uni-mappers to be the most 'reproducible' part of the data since they can be accurately placed, so adding data with 'less reproducible' mapping rates to the experiment should, if anything, reduce the actual reproducibility.</p><p>One (likely) explanation for this is that mHi-C assigns multi-mappers 'reproducibly' to the same loci across multiple experiments (even if these assignments are not appropriate), which might give the illusion of higher reproducibility. An important control for this is to compare the computationally trimmed dataset reproducibility to the original uni-read reproducibility, which is unfortunately omitted in Figure 7A, which only compares trimmed uni-mappers to trimmed uni+multi mappers. If the original uni-reads are in fact less reproducible than the trimmed-uniq+multi mapper experiments, there is a very good chance the reproducibility metric is being inflated by consistent assignment of multimappers to certain loci by mHi-C. This is not necessarily a major problem with the method (since the authors demonstrate nicely that mHi-C provides many benefits for Hi-C analysis), but it is a major problem with the interpretation of mHi-C's benefits with respect to reproducibility, which is stated many times throughout the manuscript.</p></disp-quote><p>We would like to emphasize that the improvement in reproducibility is due to increase in read depth by correctly assigned multi-reads. That said, we welcomed the opportunity to investigate whether there is a systematic bias in multi-read assignment. We looked at this tissue from two angles. First, if there is a systematic bias in multi-read assignment, one might expect the reproducibility of unrelated samples to increase by incorporation of multi-reads. In Figure 2B and Figure 2—figure supplements 9 and 10, we showed that mHi-C leads to significant gains in reproducibility for IMR90 and GM12878. In contrast, Figure 2—figure supplement 12 presents the results from a pairwise replicate reproducibility analysis between 4 replicates of GM12878 and 6 replicates of IMR90 and shows that incorporation of multi-reads do not lead to any significant gain in reproducibility for replicates from unrelated samples (IMR90 vs GM12878) (all Wilcoxon rank-sum test p-values of the pairwise comparisons between Uni- and Uni&amp;Multi-settings &gt; 0.2).</p><p>Next, we performed the calculations suggested by the reviewer in the trimming experiments. Figure 7—figure supplements 2 and 3 show that reproducibility across the four replicates of A549 based on the uni-reads of the original read length is higher than the levels achievable by the Uni&amp;Multi-Setting at trimmed read lengths. These two points are incorporated in the text.</p><p>In addition, we examined all the incorrectly allocated multi-reads in trimming experiments to explicitly assess whether these multi-reads were consistently being assigned to the same incorrect locations across replicates regardless of the replicate experiment-specific biological signal. The trimmed datasets have uni-reads of replicates 1 to 4 combined with multi-reads resulting from trimming of replicate 2 uni-reads. In each replicate dataset, mHi-C ends up either assigning each multi-read to its true originating location or to an incorrect location. Unless assigned to the true origin, each multi-read can potentially be misassigned to up to 4 different positions (i.e., one wrong location per replicate). <xref ref-type="fig" rid="respfig1">Author response image 1</xref> displays the distribution of the numbers of misassigned multi-reads assigned to exactly 1, 2, 3, and 4 locations. We observe that a large portion of the multi-reads are assigned to the same location across the four replicates – while this proportion is large, it is still only 4.78% to 7.79% of all the multi-reads. To evaluate whether these incorrect assignments are nonetheless consistent with the available replicate-specific biological signal, we asked whether their assigned positions corresponded to the ones with the highest local uni-read counts among the candidate positions of the multi-read within each replicate, i.e., comparing the local uni-read counts of all the available assignment positions for the multi-read within a replicate. This analysis indicated that, at all the trimmed read lengths, only a small fraction of the multi-reads (less than 12% for trimmed read length of 36bp and less than 4% for other read lengths and these percentages correspond to 1.45% and 0.76% of all the multi-reads in their respective settings), that were incorrectly assigned to the same location across the four replicates, were not assigned to the location with the maximum local uni-read signal. For the rest of the incorrectly assigned multi-reads, the final allocation position either had the highest local uni-read signal (56% to 61% of the incorrectly assigned multi-reads across all the trimmed read lengths) or had maximum local uni-read signal of zero.</p><fig id="respfig1"><label>Author response image 1.</label><caption><title>Distribution of numbers of distinct assignment positions for incorrectly assigned multi-reads across 4 replicates of A549 at 40 kb resolution.</title><p>mHi-C utilizes the trimmed uni-reads individually from four replicates to assign the same trimmed multi-reads from replicate 2 in the analysis of each trimmed replicate experiment. Each multi-read is either assigned to its true origin or can be incorrectly assigned to up to four different positions. Multi-reads that were incorrectly assigned to the same position are further stratified into three categories as: (i) assigned to the candidate position with the highest uni-reads signal (pink) (7.77% of all the multi-reads for trimming at 36bp); (ii) not assigned to the highest uni-reads enriched position (purple) (1.45% of all the multi-reads for trimming at 36bp); (iii) none of the candidate positions have any uni-reads (orange) (4.64% of all the multi-reads for trimming at 36bp).</p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-38070-resp-fig1-v2"/></fig><disp-quote content-type="editor-comment"><p>The TAD analysis is still not very convincing (Figure 7B). The contact matrices look really similar between all conditions, but the called TADs for the Trimmed Uni-reads looks different for some reason. For example, the big TAD on the upper left doesn't seem to adhere to the likely TAD in the contact map. This may be a quirk of the TAD identification algorithm, but it doesn't make for a convincing visual case. The contact map intensity for many of the figures is getting clipped at local interactions (i.e. the region near the diagonal is essentially the same color of red), making it hard to see where the key differences are that drive the difference in the TAD calling. I would highly recommend either zooming in on smaller regions and/or changing the color scheme/scaling so that the TAD calls and the contact map can be more clearly evaluated by the reader.</p></disp-quote><p>Thanks for pointing this out. We updated Figure 7B and Figure 7—figure supplements 4-7 to better highlight the discrepancies in the contact matrices due to the exclusion of multi-reads and the resulting impact on boundary detection. In addition, we adjusted the color scale and zoomed in the region to highlight the major differences. The low sequencing depth in the trimmed Uni-setting does have a profound effect on the detection of TAD boundaries.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>The authors have addressed most of my concerns. Two questions remain:</p><p>1) Figure 4A: I am confused. First of all, the second track shouldn't be there – that's the whole chromosome. I think what the authors intended to plotted is the region in the tiny blue box. Second comment about this figure: if you look at the first track (virtual 4C), in the middle, there is a strong Uni&amp;Multi peak, but when you look at the bottom two tracks (arcs), it shows it is uni-specific interaction. Can author clarify what happened?</p></disp-quote><p>We have removed the second track of the complete genome in Figure 4A and Figure 4—figure supplements 1 and 2. The following clarification addresses the second comment. The last track in Figure 4A contains all the significant interactions under Uni-setting and thus includes the ones that are common between the Uni- and Uni&amp;Multi-settings. Originally, the second to the last track highlights all the novel significant interactions identified under Uni&amp;Multi-setting, apart from those in the last track. Therefore, there is also a significant interaction from the region with a strong Uni&amp;Multi-peak in the middle of the first track under Uni&amp;Multi-setting. For clarity, we have changed the second to the last track into Uni&amp;Multi-setting and therefore the ones not in the last track are novel promoter-enhancer interactions.</p><disp-quote content-type="editor-comment"><p>2) Regarding this response about its performance on normalized Hi-C matrix, the authors commented that &quot;We updated all the visualizations to display both the normalized and unnormalized versions (Figure 2A, Figure 2—figure supplements 1-4). While the normalized Uni-setting matrices look less incomplete highlighting the impact of normalization, mHi-C generated matrices look visually more complete and display the impact of multi-reads. We provided several such examples as supplementary figures.&quot;</p><p>I found the answer is not satisfactory – the authors need to provide quantitative evaluation of this claim.</p></disp-quote><p>We extended the original coverage analysis and directly quantified the difference between the normalized contact matrices under the Uni- and Uni&amp;Multi-settings to highlight coverage improvement due to multi-reads.</p><p>The following paragraph, included in the main text, summarizes this quantification.</p><p>“Quantitatively, for the combined replicates of GM12878, 99.61% of the 5 kb bins with interaction potential are covered by at least 100 raw contacts under the Uni&amp;Multi-setting, compared to 98.72% under Uni-setting, thereby allowing us to study 25.55Mb more of the genome. […] This also highlights that multi-reads alleviate the inflation of low raw contact count regions due to normalization. These major improvements in coverage provide direct evidence that mHi-C is rescuing multi-reads that originate from biologically valid fragments.”</p></body></sub-article></article>