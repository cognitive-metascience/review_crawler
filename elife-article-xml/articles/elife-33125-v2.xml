<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">33125</article-id><article-id pub-id-type="doi">10.7554/eLife.33125</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Structural Biology and Molecular Biophysics</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Robust model-based analysis of single-particle tracking experiments with Spot-On</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-71432"><name><surname>Hansen</surname><given-names>Anders S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7540-7858</contrib-id><email>anders.sejr.hansen@berkeley.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-100123"><name><surname>Woringer</surname><given-names>Maxime</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2581-9808</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-8727"><name><surname>Grimm</surname><given-names>Jonathan B</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-40158"><name><surname>Lavis</surname><given-names>Luke D</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf3"/></contrib><contrib contrib-type="author" corresp="yes" id="author-23201"><name><surname>Tjian</surname><given-names>Robert</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0539-8217</contrib-id><email>jmlim@berkeley.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf4"/></contrib><contrib contrib-type="author" corresp="yes" id="author-3967"><name><surname>Darzacq</surname><given-names>Xavier</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2537-8395</contrib-id><email>darzacq@berkeley.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Molecular and Cell Biology, Li Ka Shing Center for Biomedical and Health Sciences, CIRM Center of Excellence</institution><institution>University of California, Berkeley</institution><addr-line><named-content content-type="city">Berkeley</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Howard Hughes Medical Institute</institution><addr-line><named-content content-type="city">Berkeley</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Unité Imagerie et Modélisation</institution><institution>Institut Pasteur</institution><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">UPMC Univ Paris 06</institution><institution>Sorbonne Universités</institution><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff><aff id="aff5"><label>5</label><institution>Janelia Research Campus, Howard Hughes Medical Institute</institution><addr-line><named-content content-type="city">Ashburn</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-6700"><name><surname>Sherratt</surname><given-names>David</given-names></name><role>Reviewing Editor</role><aff id="aff6"><institution>University of Oxford</institution><country>United Kingdom</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>04</day><month>01</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>7</volume><elocation-id>e33125</elocation-id><history><date date-type="received" iso-8601-date="2017-10-27"><day>27</day><month>10</month><year>2017</year></date><date date-type="accepted" iso-8601-date="2018-01-03"><day>03</day><month>01</month><year>2018</year></date></history><permissions><copyright-statement>© 2018, Hansen et al</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>Hansen et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-33125-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.33125.001</object-id><p>Single-particle tracking (SPT) has become an important method to bridge biochemistry and cell biology since it allows direct observation of protein binding and diffusion dynamics in live cells. However, accurately inferring information from SPT studies is challenging due to biases in both data analysis and experimental design. To address analysis bias, we introduce ‘Spot-On’, an intuitive web-interface. Spot-On implements a kinetic modeling framework that accounts for known biases, including molecules moving out-of-focus, and robustly infers diffusion constants and subpopulations from pooled single-molecule trajectories. To minimize inherent experimental biases, we implement and validate stroboscopic photo-activation SPT (spaSPT), which minimizes motion-blur bias and tracking errors. We validate Spot-On using experimentally realistic simulations and show that Spot-On outperforms other methods. We then apply Spot-On to spaSPT data from live mammalian cells spanning a wide range of nuclear dynamics and demonstrate that Spot-On consistently and robustly infers subpopulation fractions and diffusion constants.</p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.33125.002</object-id><title>eLife digest</title><p>Proteins, the molecules that make up the cells’ internal machinery, are responsible for almost every process that keeps cells alive. Watching how proteins move and interact within a living cell can help scientists to better understand these biological mechanisms. Single-particle tracking is a recent technique that makes these observations possible by taking ‘live’ recordings of individual proteins in a cell. Typically, the goal of a single-particle tracking experiment is to assign proteins into groups, or subpopulations, based on the way they move in the cell. For example, one subpopulation may be bound to other cellular structures, a second moving freely at a high speed, and a third diffusing slowly. This informs on the biological roles of the proteins.</p><p>The method involves an experimental stage and an analysis stage. During the experiment, proteins of interest are labeled with a small dye molecule that produces light when excited by a laser. The laser then illuminates the cell, stimulating all the labels in a thin layer. The position of each molecule is then determined with a microscope and a ‘snapshot’ taken. By repeating this process over multiple images, the movement of each molecule over time can be tracked. However, experimental problems can make the interpretation difficult. Motion blurring takes place when the proteins move so fast they appear as blurs in the images; tracking errors happen when so many proteins are present in the same space their trajectories overlap.</p><p>Here, Hansen, Woringer et al. combine two pre-existing methods to improve the experimental set-up. Using lasers that flash like a strobe light reduces motion blurring by essentially taking snapshots of the proteins at short time intervals. Tracking errors are addressed by a technique whereby only one protein at a time produces light.</p><p>Once the images are obtained and analyzed to yield trajectories, the trajectories themselves need to be analyzed to determine the number and properties of the protein subpopulations. Several factors can skew this analysis stage. For example, there is often a bias against fast-moving particles because the laser only lights up a thin layer of the cell. The proteins travelling slowly stay in focus long enough to be detected across many images; the fast ones quickly move out of the layer and are therefore counted less often. Hansen, Woringer et al. designed a free and user-friendly algorithm package called Spot-On to correct for this issue. Spot-On was thoroughly benchmarked against other solutions, demonstrating both its accuracy and robustness.</p><p>Single-particle tracking can lead to misleading results if used incorrectly. It is essential to publically share solutions that help make this technique more rigorous, especially since a growing number of scientists have already started to use the method.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>single particle tracking</kwd><kwd>transcription factor</kwd><kwd>dynamics</kwd><kwd>single molecule</kwd><kwd>kinetic modeling</kwd><kwd>super-resolution</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>UO1-EB021236</award-id><principal-award-recipient><name><surname>Darzacq</surname><given-names>Xavier</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>U54-DK107980</award-id><principal-award-recipient><name><surname>Darzacq</surname><given-names>Xavier</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000900</institution-id><institution>California Institute for Regenerative Medicine</institution></institution-wrap></funding-source><award-id>LA1-08013</award-id><principal-award-recipient><name><surname>Darzacq</surname><given-names>Xavier</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id><institution>Howard Hughes Medical Institute</institution></institution-wrap></funding-source><award-id>003061</award-id><principal-award-recipient><name><surname>Tjian</surname><given-names>Robert</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id><institution>Howard Hughes Medical Institute</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Lavis</surname><given-names>Luke D</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution>Siebel Stem Cell Institute</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Hansen</surname><given-names>Anders S</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Spot-On is an easy-to-use website that makes a rigorous and bias-corrected modeling framework for analysis of single-molecule tracking experiments available to all.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Advances in imaging technologies, genetically encoded tags and fluorophore development have made single-particle tracking (SPT) an increasingly popular method for analyzing protein dynamics (<xref ref-type="bibr" rid="bib20">Liu et al., 2015</xref>). Recent biological applications of SPT have revealed that transcription factors (TFs) bind mitotic chromosomes (<xref ref-type="bibr" rid="bib39">Teves et al., 2016</xref>), how Polycomb interacts with chromatin (<xref ref-type="bibr" rid="bib44">Zhen et al., 2016</xref>), that ‘pioneer factor’ TFs bind chromatin dynamically (<xref ref-type="bibr" rid="bib37">Swinstead et al., 2016</xref>), that TF binding time correlates with transcriptional activity (<xref ref-type="bibr" rid="bib21">Loffreda et al., 2017</xref>) and that different nuclear proteins adopt distinct target search mechanisms (<xref ref-type="bibr" rid="bib12">Izeddin et al., 2014</xref>; <xref ref-type="bibr" rid="bib32">Rhodes et al., 2017</xref>). Compared with indirect and bulk techniques such as Fluorescence Recovery After Photobleaching (FRAP) or Fluorescence Correlation Spectroscopy (FCS), SPT is often seen as less biased and less model-dependent (<xref ref-type="bibr" rid="bib7">Goulian and Simon, 2000</xref>; <xref ref-type="bibr" rid="bib29">Mueller et al., 2013</xref>; <xref ref-type="bibr" rid="bib36">Shen et al., 2017</xref>). In particular, SPT makes it possible to directly follow single molecules over time in live cells and has provided clear evidence that proteins often exist in several subpopulations that can be characterized by their distinct diffusion coefficients (<xref ref-type="bibr" rid="bib29">Mueller et al., 2013</xref>; <xref ref-type="bibr" rid="bib36">Shen et al., 2017</xref>). For example, nuclear proteins such as TFs and chromatin binding proteins typically show a quasi-immobile chromatin-bound fraction and a freely diffusing fraction inside the nucleus. However, while SPT of slow-diffusing membrane proteins is an established technology (<xref ref-type="bibr" rid="bib43">Weimann et al., 2013</xref>), 2D-SPT of proteins freely diffusing inside a 3D nucleus introduces several biases that must be corrected for in order to obtain accurate estimates of subpopulations. First, while a frame is acquired, fast-diffusing molecules move and spread out their emitted photons over multiple pixels causing a ‘<italic>motion-blur</italic>’ artifact (<xref ref-type="bibr" rid="bib1">Berglund, 2010</xref>; <xref ref-type="bibr" rid="bib4">Deschout et al., 2012</xref>; <xref ref-type="bibr" rid="bib6">Frost et al., 2012</xref>; <xref ref-type="bibr" rid="bib7">Goulian and Simon, 2000</xref>; <xref ref-type="bibr" rid="bib12">Izeddin et al., 2014</xref>), whereas immobile or slow-diffusing molecules resemble point spread functions (PSFs; <xref ref-type="fig" rid="fig1">Figure 1A</xref>). This results in under-counting of the fast-diffusing subpopulation. Second, high particle densities tend to cause <italic>tracking errors</italic> when localized molecules are connected into trajectories. This can result in incorrect displacement estimates (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Third, since SPT generally employs 2D imaging of 3D motion, immobile or slow-diffusing molecules will generally remain in-focus until they photobleach and therefore exhibit long trajectories, whereas fast-diffusing molecules in 3D rapidly move out-of-focus, thus resulting in short trajectories (we refer to this as ‘<italic>defocalization</italic>’; <xref ref-type="fig" rid="fig1">Figure 1C</xref>). This results in a time-dependent under-counting of fast-diffusing molecules (<xref ref-type="bibr" rid="bib7">Goulian and Simon, 2000</xref>; <xref ref-type="bibr" rid="bib14">Kues and Kubitscheck, 2002</xref>). Fourth, SPT <italic>analysis methods</italic> themselves may introduce biases; to avoid this, an accurate and validated method is needed (<xref ref-type="fig" rid="fig1">Figure 1D</xref>).</p><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.33125.003</object-id><label>Figure 1.</label><caption><title>Bias in single-particle tracking (SPT) experiments and analysis methods.</title><p>(<bold>A</bold>) ‘Motion-blur’ bias. Constant excitation during acquisition of a frame will cause a fast-moving particle to spread out its emission photons over many pixels and thus appear as a motion-blur, which make detection much less likely with common PSF-fitting algorithms. In contrast, a slow-moving or immobile particle will appear as a well-shaped PSF and thus readily be detected. (<bold>B</bold>) Tracking ambiguities. Tracking at high particle densities prevents unambiguous connection of particles between frames and tracking errors will cause displacements to be misidentified. (<bold>C</bold>) Defocalization bias. During 2D-SPT, fast-moving particles will rapidly move out-of-focus resulting in short trajectories, whereas immobile particles will remain in-focus until they photobleach and thus exhibit very long trajectories. This results in a bias toward slow-moving particles, which must be corrected for. (<bold>D</bold>) Analysis method. Any analysis method should ideally avoid introducing biases and accurately correct for known biases in the estimation of subpopulation parameters such as <italic>D</italic><sub>FREE</sub>, <italic>F</italic><sub>BOUND</sub>, <italic>D</italic><sub>BOUND</sub>.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig1-v2"/></fig><p>Here, we introduce an integrated approach to overcome all four biases. The first two biases must be minimized at the data acquisition stage and we describe an experimental SPT method to do so (spaSPT), whereas the latter two can be overcome using a previously developed kinetic modeling framework (<xref ref-type="bibr" rid="bib11">Hansen et al., 2017</xref>; <xref ref-type="bibr" rid="bib24">Mazza et al., 2012</xref>) now extended and implemented in Spot-On. Spot-On is available as a web-interface (<ext-link ext-link-type="uri" xlink:href="https://SpotOn.berkeley.edu">https://SpotOn.berkeley.edu</ext-link>) as well as Python and Matlab packages.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Overview of Spot-On</title><p>Spot-On is a user-friendly web-interface that pedagogically guides the user through a series of quality-checks of uploaded datasets consisting of pooled single-molecule trajectories. It then performs kinetic model-based analysis that leverages the histogram of molecular displacements over time to infer the fraction and diffusion constant of each subpopulation (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Spot-On does not directly analyze raw microscopy images, since a large number of localization and tracking algorithms exist that convert microscopy images into single-molecule trajectories (for a comparison of particle tracking methods, see (<xref ref-type="bibr" rid="bib3">Chenouard et al., 2014</xref>); moreover, Spot-On can be one-click interfaced with TrackMate (<xref ref-type="bibr" rid="bib40">Tinevez et al., 2017</xref>), which allows inspection of trajectories before uploading to Spot-On).</p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.33125.004</object-id><label>Figure 2.</label><caption><title>Overview of Spot-On interface.</title><p>To use Spot-On, a user uploads raw SPT data in the form of pooled SPT trajectories to the Spot-On web-interface. Spot-On then calculates displacement histograms. The user inputs relevant experimental descriptors and chooses a model to fit. After model-fitting, the user can then download model-inferred parameters, meta-data and download publication-quality figures.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig2-v2"/></fig><p>To use Spot-On, a user uploads their SPT trajectory data in one of several formats (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Spot-On then generates useful meta-data for assessing the quality of the experiment (e.g. localization density, number of trajectories etc.). Spot-On also allows a user to upload multiple datasets (e.g. different replicates) and merge them. Spot-On then calculates and displays histograms of displacements over multiple time delays. The next step is model fitting. Spot-On models the distribution of displacements for each subpopulation using Brownian motion under steady-state conditions without state transitions (full model description in Materials and Methods). Spot-On also accounts for localization errors (either user-defined or inferred from the SPT data). Crucially, Spot-On corrects for defocalization bias (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) by explicitly calculating the probability that molecules move out-of-focus as a function of time and their diffusion constant (<xref ref-type="video" rid="video1">Video 1</xref>). In fact, Spot-On uses the gradual loss of freely diffusing molecules over time as additional information to infer the diffusion constant and size of each subpopulation.</p><media id="video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-33125-video1.mp4"><object-id pub-id-type="doi">10.7554/eLife.33125.005</object-id><label>Video 1.</label><caption><title>Related to <xref ref-type="fig" rid="fig1">Figure 1</xref>.</title><p>Illustration of defocalization bias. Illustration of a single-particle tracking experiment with two subpopulations (one ‘immobile’, D = 0.001 µm²/s, the other ‘free’, D = 4 µm²/s with a 1:1 ratio, observed using 20 ms time interval). The red region corresponds to the axial detection range (1 µm) and molecules randomly appear when they photo-activate. For each trajectory, the detected localizations inside the detection range are shown as red spheres and undetected localizations outside the detection range are shown as white spheres. Each particle has a mean lifetime of 15 frames, 25 nm localization error and trajectories consisting of at least two frames are plotted. Epi illumination is assumed. The SPT data was simulated and plotted using simSPT (available at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacq-lab/simSPT">https://gitlab.com/tjian-darzacq-lab/simSPT</ext-link>).</p></caption></media><p>Spot-On considers either 2 or 3 subpopulations. For instance, TFs in nuclei can generally exist in both a chromatin-bound state characterized by slow diffusion and a freely diffusing state associated with rapid diffusion. In this case, a 2-state model is generally appropriate (‘bound’ vs. ‘free’). Spot-On allows a user to choose their desired model and parameter ranges and then fits the model to the data. Using the previous example of TF dynamics, this allows the user to infer the bound fraction and the diffusion constants. Finally, once a user has finished fitting an appropriate model to their data, Spot-On allows easy download of publication-quality figures and relevant data (<xref ref-type="fig" rid="fig2">Figure 2</xref>; Full tutorial in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>).</p></sec><sec id="s2-2"><title>Validation of Spot-On using simulated SPT data and comparison to other methods</title><p>We first evaluated whether Spot-On could accurately infer subpopulations (<xref ref-type="fig" rid="fig1">Figure 1D</xref>) and successfully account for known biases (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) using simulated data. We compared Spot-On to a popular alternative approach of first fitting the mean square displacement (MSD) of individual trajectories of a minimum length and then fitting the distribution of estimated diffusion constants (we refer to this as ‘MSD<sub>i</sub>’) as well as a sophisticated Hidden-Markov Model-based Bayesian inference method (vbSPT) (<xref ref-type="bibr" rid="bib30">Persson et al., 2013</xref>). Since most SPT data is collected using highly inclined illumination (<xref ref-type="bibr" rid="bib41">Tokunaga et al., 2008</xref>) (HiLo), we simulated TF binding and diffusion dynamics (2-state model: ‘bound vs. free’) confined inside a 4 µm radius mammalian nucleus under realistic HiLo SPT experimental settings subject to a 25 nm localization error (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). We considered the effect of the exposure time (1 ms, 4 ms, 7 ms, 13 ms, 20 ms), the free diffusion constant (from 0.5 µm²/s to 14.5 µm²/s in 0.5 µm²/s increments) and the bound fraction (from 0% to 95% in 5% increments) yielding a total of 3480 different conditions that span the full range of biologically plausible dynamics (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplements 2</xref>–<xref ref-type="fig" rid="fig3s3">3</xref>; Appendix 1).</p><p>Spot-On accurately inferred subpopulation sizes with minimal error (<xref ref-type="fig" rid="fig3">Figure 3A–B</xref>, <xref ref-type="table" rid="table1">Table 1</xref>), but slightly underestimated the diffusion constant (−4.8%; <xref ref-type="fig" rid="fig3">Figure 3B</xref>; <xref ref-type="table" rid="table1">Table 1</xref>). However, this underestimate was due to particle confinement inside the nucleus: Spot-On correctly inferred the diffusion constant when the confinement was relaxed (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>; 20 µm nuclear radius instead of 4 µm). This emphasizes that diffusion constants measured by SPT inside cells should be viewed as apparent diffusion constants. In contrast, the MSD<sub>i</sub> method failed under most conditions regardless of whether all trajectories were used (MSD<sub>i</sub> (all)) or a fitting filter applied (MSD<sub>i</sub> (<italic>R</italic><sup>2</sup> &gt;0.8); <xref ref-type="fig" rid="fig3">Figure 3A–B</xref>; <xref ref-type="table" rid="table1">Table 1</xref>). vbSPT performed almost as well as Spot-On for slow-diffusing proteins, but showed larger deviations for fast-diffusing proteins (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplements 2</xref>–<xref ref-type="fig" rid="fig3s3">3</xref>).</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.33125.006</object-id><label>Figure 3.</label><caption><title>Validation of Spot-On using simulations and comparisons to other methods.</title><p>(<bold>A–B</bold>) Simulation results. Experimentally realistic SPT data was simulated inside a spherical mammalian nucleus with a radius of 4 μm subject to highly-inclined and laminated optical sheet illumination (<xref ref-type="bibr" rid="bib41">Tokunaga et al., 2008</xref>) (HiLo) of thickness 4 μm illuminating the center of the nucleus. The axial detection window was 700 nm with Gaussian edges and particles were subject to a 25 nm localization error in all three dimensions. Photobleaching corresponded to a mean trajectory length of 4 frames inside the HiLo sheet and 40 outside. 3480 experiments were simulated with parameters of <italic>D</italic><sub>FREE</sub>=[0.5;14.5] in steps of 0.5 μm<sup>2</sup>/s and <italic>F</italic><sub>BOUND</sub>=[0;95% in steps of 5% and the frame rate correspond to <bold><italic>Δ</italic></bold>τ=[1,4,7,10,13,20] ms. Each experiment was then fitted using Spot-On, using vbSPT (maximum of 2 states allowed) (<xref ref-type="bibr" rid="bib30">Persson et al., 2013</xref>), MSD<sub>i</sub> using all trajectories of at least five frames (MSD<sub>i</sub> (all)) or MSD<sub>i</sub> using all trajectories of at least five frames where the MSD-curvefit showed at least <italic>R</italic><sup>2</sup> &gt;0.8 (MSD<sub>i</sub> (<italic>R</italic><sup>2</sup> &gt;0.8)). (<bold>A</bold>) shows the distribution of absolute errors in the <italic>F</italic><sub>BOUND</sub>–estimate and (<bold>B</bold>) shows the distribution of relative errors in the <italic>D</italic><sub>FREE</sub>–estimate. (<bold>C</bold>) Single simulation example with <italic>D</italic><sub>FREE</sub> = 2.0 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 70%; 7 ms per frame. The table on the right uses numbers from CDF-fitting, but for simplicity the fits to the histograms (PDF) are shown in the three plots. (<bold>D</bold>) Single simulation example with <italic>D</italic><sub>FREE</sub> = 14.0 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 50%; 20 ms per frame. Full details on how SPT data was simulated and analyzed with the different methods is given in Appendix 1.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig3-v2"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.007</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Overview of SPT simulations.</title><p>(<bold>A</bold>) Trajectories were simulated in a confined volume: a ‘nucleus’ of 8 µm diameter, in which molecules are photoactivated at random and photobleach when located within the HiLo volume (a ~4 µm thick slice). Molecules are detected when they are within the axial detection range of the objective (~700 nm). (<bold>B</bold>) confinement within the nucleus was achieved by specular reflections against the nuclear envelope: a particle bumping on the nuclear envelope is ballistically reflected inside. (<bold>C</bold>) axial detection profile used for the simulation (blue): flat-top Gaussian with 600 nm plateau and 100 nm FWHM for the Gaussian edges. (red): approximated axial detection profile assumed by Spot-On (step function with 700 nm width).</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig3-figsupp1-v2"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.008</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Comparison of Spot-On, vbSPT and MSDi estimates of <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub> to ground-truth simulation results inside a 4 µm radius nucleus.</title><p>Heatmaps showing errors in Spot-On, vbSPT and MSD<sub>i</sub> estimates of <italic>D</italic><sub>FREE</sub> (<bold>A</bold>) and <italic>F</italic><sub>BOUND</sub> (<bold>B</bold>). To comprehensively test Spot-On and alternative analysis methods such as vbSPT and MSD<sub>i</sub> (Appendix 1), we analyzed 3480 simulations using these methods. The simulations are available for download (see ‘Data availability’) and the code used for the simulations is available at GitLab (<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacq-lab/simSPT">https://gitlab.com/tjian-darzacq-lab/simSPT</ext-link>). Briefly, experimentally realistic SPT experiments were simulated assuming 2-state (free or bound) Brownian motion inside a nucleus of 4 µm radius illuminated using HiLo illumination (assuming a HiLo beam width of 4 µm), with an axial detection range of ~700 nm, centered at the middle of the HiLo beam. In (<bold>A</bold>), the heatmaps show the relative error and in (<bold>B</bold>) the heatmaps show the absolute error. In a few rare cases (marked by black squares), the MSD<sub>i</sub>-method failed such that no estimate was possible. Cumulative distribution function (CDF) plots of the relative error in the <italic>D</italic><sub>FREE</sub>–estimate (<bold>C</bold>) and the absolute error in the <italic>F</italic><sub>BOUND</sub>–estimate (<bold>D</bold>).</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig3-figsupp2-v2"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.009</object-id><label>Figure 3—figure supplement 3.</label><caption><title>Representative fits for Spot-On, vbSPT and MSDi to ground-truth simulations.</title><p>(<bold>A</bold>) fits to simulation where <italic>D</italic><sub>FREE</sub> = 2.0 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 75%; 1 ms per frame. First column: Spot-On CDF-fit with JumpsToConsider = 4; only CDF-fit at 3Δt is shown. Second column: Spot-On CDF-fit using all jumps; only CDF-fit at 3Δt is shown. Third column: MSD<sub>i</sub>-CDF-fit to log<sub>10</sub>(<italic>D</italic><sub>FREE</sub>) considering only trajectories of at least five frames, where the MSD-fit to a single trajectory was good (<italic>R</italic><sup>2</sup> &gt;0.8). Fourth column: MSD<sub>i</sub>-CDF-fit to log<sub>10</sub>(<italic>D</italic><sub>FREE</sub>) considering only trajectories of at least five frames, but without a MSD-fit threshold. Fifth column: table comparing all the four methods as well as vbSPT (2-state) estimates of <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub> to the ground truth used for the simulations. (<bold>B</bold>) fits to simulation where <italic>D</italic><sub>FREE</sub> = 10.0 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 10%; 4 ms per frame. Each column is described in (<bold>A</bold>). (<bold>C</bold>) fits to simulation where <italic>D</italic><sub>FREE</sub> = 6.0 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 5%; 7 ms per frame. Each column is described in (<bold>A</bold>). (<bold>D</bold>) fits to simulation where <italic>D</italic><sub>FREE</sub> = 2.5 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 40%; 10 ms per frame. Each column is described in (<bold>A</bold>). (<bold>E</bold>) fits to simulation where <italic>D</italic><sub>FREE</sub> = 3.5 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 70%; 13 ms per frame. Each column is described in (<bold>A</bold>). (<bold>F</bold>) fits to simulation where <italic>D</italic><sub>FREE</sub> = 13.0 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 55%; 20 ms per frame. Each column is described in (<bold>A</bold>).</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig3-figsupp3-v2"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.010</object-id><label>Figure 3—figure supplement 4.</label><caption><title>Comparison of Spot-On, vbSPT and MSDi estimates of <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub> to ground-truth simulations inside a 20 µm radius nucleus.</title><p>Heatmaps showing errors in Spot-On, vbSPT and MSD<sub>i</sub> estimates of <italic>D</italic><sub>FREE</sub> (<bold>A</bold>) and <italic>F</italic><sub>BOUND</sub> (<bold>B</bold>). To comprehensively test Spot-On and alternative analysis methods such as vbSPT (<xref ref-type="bibr" rid="bib30">Persson et al., 2013</xref>) and MSD<sub>i</sub> (Appendix 1), we analyzed 3480 simulations (described in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>) using these methods. In (<bold>A</bold>), the heatmaps show the relative error and in (<bold>B</bold>) the heatmaps show the absolute error. In a few rare cases (marked by black squares), the MSD<sub>i</sub>-method failed such that no estimate was possible. Note that whereas Spot-On would always underestimate <italic>D</italic><sub>FREE</sub> inside a small 4 µm radius nucleus, when the confinement is largely relaxed by considering a 20 µm radius nucleus, Spot-On now shows essentially no bias in its <italic>D</italic><sub>FREE</sub>–estimate. Cumulative distribution function (CDF) plots and summary tables of the relative error in the <italic>D</italic><sub>FREE</sub>–estimate (<bold>C</bold>) and the absolute error in the <italic>F</italic><sub>BOUND</sub>–estimate (<bold>D</bold>). Bias refers to the mean error, ‘std’ is the standard deviation and ‘iqr’ is the inter-quartile range (difference between the 75th and 25th percentile).</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig3-figsupp4-v2"/></fig><fig id="fig3s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.011</object-id><label>Figure 3—figure supplement 5.</label><caption><title>Effect of defocalization bias correction.</title><p>In order to determine how important correcting for defocalization bias is, we analyzed the 3480 simulations using Spot-On (all) and exactly the same parameters as in <xref ref-type="fig" rid="fig3">Figure 3A–B</xref> except without the defocalization bias correction, <italic>Z</italic><sub>CORR</sub>. Heatmaps show errors in Spot-On (all; with <italic>Z</italic><sub>CORR</sub>) and Spot-On (all; without <italic>Z</italic><sub>CORR</sub>) estimates of <italic>D</italic><sub>FREE</sub> (<bold>A</bold>) and <italic>F</italic><sub>BOUND</sub> (<bold>B</bold>). Histogram plots and summary statistics tables of the relative error in the <italic>D</italic><sub>FREE</sub>–estimate (<bold>C</bold>) and the absolute error in the <italic>F</italic><sub>BOUND</sub>–estimate (<bold>D</bold>). As can be seen, correcting for defocalization bias slightly improves the <italic>D</italic><sub>FREE</sub>–estimate, but is essential for an accurate <italic>F</italic><sub>BOUND</sub>–estimate. As expected, the longer the lag time, the more important it is to correct for defocalization bias.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig3-figsupp5-v2"/></fig><fig id="fig3s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.012</object-id><label>Figure 3—figure supplement 6.</label><caption><title>Evaluation of the 3-states model.</title><p>Trajectories were simulated using simSPT for a 3-state model. Three representative fractions were picked and for each of them, one state was always bound (D<sub>BOUND</sub> = 0.001 µm²/s) and the two other states were varied (0.5–11 µm²/s), together with the framerate (1–20 ms), yielding 720 conditions. The simulations were then either fitted with Spot-On or vbSPT constrained to infer up to three states. (<bold>A</bold>) Distribution of the error of five of the inferred parameters (<italic>D</italic><sub>SLOW</sub>, <italic>D</italic><sub>FAST</sub>, <italic>F</italic><sub>BOUND</sub>, <italic>F</italic><sub>SLOW</sub>, <italic>F</italic><sub>FAST</sub>) with respect to ground truth for Spot-On (red) and vbSPT (blue). The top row shows the distribution and the bottom row the cumulative distribution. (<bold>B-G</bold>) For each of the three fractions configurations (25/25/50, 25/50/25, 50/25/25%, for <bold>B-C, D-E, F-G</bold>, respectively), detailed error on five inferred parameters (columns) for different frame rates (rows) and various <italic>D</italic><sub>SLOW</sub> and <italic>D</italic><sub>FAST</sub> (rows and columns of the matrix, respectively). (<bold>H</bold>) summary table showing the mean error (bias) and standard deviation over all the simulations.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig3-figsupp6-v2"/></fig><fig id="fig3s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.013</object-id><label>Figure 3—figure supplement 7.</label><caption><title>Sensitivity of Spot-On to the axial detection range estimate.</title><p>Heatmaps showing errors in Spot-On estimates of <italic>D</italic><sub>FREE</sub> (<bold>A</bold>) and <italic>F</italic><sub>BOUND</sub> (<bold>B</bold>) as a function of the axial detection range, <bold><italic>Δ</italic></bold>z. The simulations were as described in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>. Rather than an unrealistic step function, the simulated axial detection range has Gaussian edges with FWHM of 700 nm. Spot-On analysis parameters were exactly as for Spot-On (all) in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, except the axial detection range, <bold><italic>Δ</italic></bold>z, was set to either 500 nm, 600 nm, 700 nm, 800 nm or 900 nm. As can be seen, Spot-On is only mildly sensitive to small errors (~100 nm) in the axial detection range estimate. In (<bold>A</bold>), the heatmaps show the relative error and in (<bold>B</bold>) the heatmaps show the absolute error. Cumulative distribution function (CDF) plots of the relative error in the <italic>D</italic><sub>FREE</sub>–estimate (<bold>C</bold>) and the absolute error in the <italic>F</italic><sub>BOUND</sub>–estimate (<bold>D</bold>) as well as summary tables.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig3-figsupp7-v2"/></fig><fig id="fig3s8" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.014</object-id><label>Figure 3—figure supplement 8.</label><caption><title>Sensitivity of Spot-On to the number of time points considered.</title><p>Heatmaps showing errors in Spot-On estimates of <italic>D</italic><sub>FREE</sub> (<bold>A</bold>) and <italic>F</italic><sub>BOUND</sub> (<bold>B</bold>) as a function of the number of time points considered. Note that if TimePoints = n, the number of displacements that will be considered goes from one to (n-1). The simulations were as described in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>. Spot-On analysis parameters were exactly as for Spot-On (all) in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, except the TimePoints parameter was set to either 3, 5, 7, 9 or dependent on the frame rate (TimePoints(<bold><italic>Δ</italic>τ</bold>)) as in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> and described in Appendix 1. As can be seen, Spot-On is not very sensitive to how many TimePoints were considered. However, when working with small datasets of experimental data, if there is not enough data at higher TimePoints values, noise can make the estimates unreliable. In (<bold>A</bold>), the heatmaps show the relative error and in (<bold>B</bold>) the heatmaps show the absolute error. Cumulative distribution function (CDF) plots of the relative error in the <italic>D</italic><sub>FREE</sub>–estimate (<bold>C</bold>) and the absolute error in the <italic>F</italic><sub>BOUND</sub>–estimate (<bold>D</bold>) as well as summary tables.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig3-figsupp8-v2"/></fig><fig id="fig3s9" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.015</object-id><label>Figure 3—figure supplement 9.</label><caption><title>Comparison of Spot-On and MSDi estimates of <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub> to ground-truth simulation results inside a 4 µm radius nucleus using PDF-fitting.</title><p>Heatmaps showing errors in Spot-On and MSD<sub>i</sub> estimates of <italic>D</italic><sub>FREE</sub> (<bold>A</bold>) and <italic>F</italic><sub>BOUND</sub> (<bold>B</bold>). The analysis was performed identically to <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> except PDF-fitting was performed instead of CDF-fitting. In (<bold>A</bold>), the heatmaps show the relative error and in (<bold>B</bold>) the heatmaps show the absolute error. Cumulative distribution function (CDF) plots of the relative error in the <italic>D</italic><sub>FREE</sub>–estimate (<bold>C</bold>) and the absolute error in the <italic>F</italic><sub>BOUND</sub>–estimate (<bold>D</bold>).</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig3-figsupp9-v2"/></fig><fig id="fig3s10" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.016</object-id><label>Figure 3—figure supplement 10.</label><caption><title>Sensitivity of Spot-On to state changes and comparison with vbSPT.</title><p>For six different representative conditions (combinations of <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub>; <italic>D</italic><sub>BOUND</sub> = 0.001 µm²/s; σ = 25 nm), we simulated 100,000 trajectories using simSPT and included state transitions (e.g. transition from bound to free) considering six different lag time (1, 4, 7, 10, 13 and 20 ms) and <italic>k</italic><sub>ON</sub> values from 0.1 s<sup>−1</sup> to 200 s<sup>−1</sup> yielding a total of 396 simulations. The data were analyzed using Spot-On (all) as in <xref ref-type="fig" rid="fig3">Figure 3A–B</xref>. (<bold>A</bold>) For one example parameter set, (<bold>A</bold>) shows how the histogram of displacements and the goodness of the Spot-On model-fit changes as state transition go from more frequent than the frame rate (left) to very infrequent (right). (<bold>B-G</bold>), First row: shows sensitivity of the Spot-On estimate of <italic>D</italic><sub>FREE</sub> to the timescale of state transitions. The values of <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub> are shown above the plot. (<bold>B-G</bold>), Second row: shows sensitivity of the Spot-On estimate of <italic>F</italic><sub>BOUND</sub> to the timescale of state transitions. (<bold>B-G</bold>), Third row: shows sensitivity of the vbSPT estimate of <italic>D</italic><sub>FREE</sub> to the timescale of state transitions. The values of <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub> are shown above the top plot. (<bold>B-G</bold>), Fourth row: shows sensitivity of the vbSPT estimate of <italic>F</italic><sub>BOUND</sub> to the timescale of state transitions. As expected, since Spot-On ignores state transitions, the inference breaks down when the timescale of state transitions becomes comparable to the frame rate. Perhaps surprisingly, vbSPT also breaks down when state transitions are frequent despite explicitly modeling this in the Hidden Markov Model. Also as expected, a faster frame rate (e.g. 1 ms in dark blue) can support a faster state transition rate. Nevertheless, as long as the timescale of transitions is at least a few hundred milliseconds, Spot-On is not strongly affected. For comparison, the residence time of most mammalian transcription factors is tens of seconds.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig3-figsupp10-v2"/></fig><fig id="fig3s11" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.017</object-id><label>Figure 3—figure supplement 11.</label><caption><title>Robustness of localization error estimates from Spot-On.</title><p>For six different representative conditions (combinations of <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub>; <italic>D</italic><sub>BOUND</sub> = 0.001 µm²/s), we simulated 100,000 trajectories using simSPT keeping everything as in <xref ref-type="fig" rid="fig3">Figure 3A–B</xref> except varying the localization error (σ) from 10 nm to 75 nm in 5 nm steps and considering six different lag time (1, 4, 7, 10, 13 and 20 ms) yielding a total of 504 simulations. The data were analyzed using Spot-On (all) as in <xref ref-type="fig" rid="fig3">Figure 3A–B</xref> except here the localization error was inferred from the fitting. (<bold>A-F</bold>), top row: show how well the Spot-On inferred the localization error vs. the simulated localization error and the lag times are color coded. The values of <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub> are shown above the plot. (<bold>A-F</bold>), bottom row: histograms showing the distribution of errors in the localization error estimate across all lag time and σ-values for a given combinations of <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub>. (<bold>G</bold>) Table showing summary statistics from the fitting in (<bold>A-F</bold>). We note that in all cases where the bound fraction is significant (&gt;10%), Spot-On robustly infers the localization error (mean error below 1.5 nm), whereas in cases where the bound fraction is small (10% or below), the localization error estimate becomes less robust (mean error ~3–6 nm). This is because Spot-On can most reliably use how the displacement distribution of the bound fraction changes over time to infer the localization error (see also Materials and Methods).</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig3-figsupp11-v2"/></fig><fig id="fig3s12" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.018</object-id><label>Figure 3—figure supplement 12.</label><caption><title>Sensitivity of Spot-On, vbSPT and MSD<sub>i</sub> (<italic>R</italic><sup>2</sup> &gt;0.8) to sample size.</title><p>(<bold>A</bold>) Jack-knife data sampling for simulation with <italic>D</italic><sub>FREE</sub> = 2.0 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 75%; 1 ms per frame. Simulated data (inside a 4 µm radius nucleus) was used. 100,000 trajectories with a mean photo-bleaching life-time of 4 frames were simulated and then subsampled 50 times without replacement. Sample sizes of either 30, 100, 300, 1,000, 3,000, 10,000, 30,000 or 100,000 trajectories were then fit using Spot-On (all), vbSPT (2-state model) or MSD<sub>i</sub> (<italic>R</italic><sup>2</sup> &gt;0.8) as described in the analysis of simulations section. Error bars show standard deviation among the 50 sub-samplings. We note that occasionally, no more than ~5% of the time in the case of 30 trajectories, not a single trajectory of sufficient length for Spot-On or MSD<sub>i</sub> (<italic>R</italic><sup>2</sup> &gt;0.8) was found. In these cases, we re-sampled to obtain at least one trajectory of sufficient length. Left plot shows effect of sample size on the <italic>D</italic><sub>FREE</sub>–estimate. Right plot shows effect of sample size on the <italic>F</italic><sub>BOUND</sub>–estimate. The dashed line shows the ground truth used to simulate the SPT data. (<bold>A</bold>) Jack-knife data sampling for simulation with <italic>D</italic><sub>FREE</sub> = 10.0 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 10%; 4 ms per frame. Everything else is as described in (<bold>A</bold>). (<bold>C</bold>) Jack-knife data sampling for simulation with <italic>D</italic><sub>FREE</sub> = 3.5 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 50%; 7 ms per frame. Everything else is as described in (<bold>A</bold>). (<bold>D</bold>) Jack-knife data sampling for simulation with <italic>D</italic><sub>FREE</sub> = 3.5 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 70%; 13 ms per frame. Everything else is as described in (<bold>A</bold>). (<bold>E</bold>) Jack-knife data sampling for simulation with <italic>D</italic><sub>FREE</sub> = 13.0 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 55%; 20 ms per frame. Everything else is as described in (<bold>A</bold>).</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig3-figsupp12-v2"/></fig></fig-group><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.33125.019</object-id><label>Table 1.</label><caption><title>Summary of simulation results and comparison of methods.</title><p>The table shows the bias (mean error), ‘std’ (standard deviation) and ‘iqr’ (inter-quartile range: difference between the 75th and 25th percentile) for each method for all 3480 simulations. The left column shows the relative bias/std/iqr for the <italic>D</italic><sub>FREE</sub>-estimate and the right column shows the absolute bias/std/iqr for the <italic>F</italic><sub>BOUND</sub>-estimate.</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2" valign="top">Analysis method</th><th align="center" colspan="3" valign="top"><italic>D</italic><sub>FREE</sub></th><th align="center" colspan="3" valign="top"><italic>F</italic><sub>BOUND</sub></th></tr><tr><th>bias</th><th>std</th><th>iqr</th><th>bias</th><th>std</th><th>iqr</th></tr></thead><tbody><tr><td valign="top">Spot-On (all)</td><td valign="top">−4.8%</td><td valign="top">3.3%</td><td valign="top">3.5%</td><td valign="top">−1.7%</td><td valign="top">1.2%</td><td valign="top">1.8%</td></tr><tr><td valign="top">vbSPT (2-state)</td><td valign="top">0.8%</td><td valign="top">12.5%</td><td valign="top">6.8%</td><td valign="top">5.0%</td><td valign="top">4.6%</td><td valign="top">6.1%</td></tr><tr><td valign="top">MSD<sub>i</sub> (R<sup>2</sup> &gt; 0.8)</td><td valign="top">8.0%</td><td valign="top">28.5%</td><td valign="top">4.9%</td><td valign="top">−20.6%</td><td valign="top">26.4%</td><td valign="top">32.1%</td></tr><tr><td valign="top">MSD<sub>i</sub> (all)</td><td valign="top">−39.6%</td><td valign="top">41.8%</td><td valign="top">19.0%</td><td valign="top">22.0%</td><td valign="top">15.8%</td><td valign="top">17.8%</td></tr></tbody></table></table-wrap><p>To illustrate how the methods could give such divergent results when run on the same SPT data, we considered two example simulations (<xref ref-type="fig" rid="fig3">Figure 3C–D</xref>; more examples in <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). First, we considered a mostly bound and relatively slow diffusion case (<italic>D</italic><sub>FREE</sub>: 2.0 µm²/s; <italic>F</italic><sub>BOUND</sub>: 70%; <italic>Δ</italic>τ: 7 ms; <xref ref-type="fig" rid="fig3">Figure 3C</xref>). Spot-On and vbSPT accurately inferred both <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub>. In contrast, MSD<sub>i</sub> (<italic>R</italic><sup>2</sup> &gt; 0.8) greatly underestimated <italic>F</italic><sub>BOUND</sub> (13.6% vs. 70%), whereas MSD<sub>i</sub> (all) slightly overestimated <italic>F</italic><sub>BOUND</sub>. Since MSD<sub>i</sub>-based methods apply two thresholds (first, minimum trajectory length: here five frames; second, filtering based on <italic>R</italic><sup>2</sup>) in many cases less than 5% of all trajectories passed these thresholds and this example illustrate how sensitive MSD<sub>i</sub>-based methods are to these thresholds. Note that although we show the fits to the probability density function since this is more intuitive (PDF; histogram), we performed the fitting to the cumulative distribution function (CDF). Second, we considered an example with a slow frame rate and fast diffusion, such that the free population rapidly moves out-of-focus (<italic>D</italic><sub>FREE</sub>: 14.0 µm²/s; <italic>F</italic><sub>BOUND</sub>: 50%; <italic>Δ</italic>τ: 20 ms; <xref ref-type="fig" rid="fig3">Figure 3D</xref>). Spot-On again accurately inferred <italic>F</italic><sub>BOUND</sub>, and slightly underestimated <italic>D</italic><sub>FREE</sub> due to high nuclear confinement (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>). Although vbSPT generally performed well, because it does not correct for defocalization bias (vbSPT was developed for bacteria, where defocalization bias is minimal), vbSPT strongly overestimated <italic>F</italic><sub>BOUND</sub> in this case (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). Consistent with this, Spot-On without defocalization-bias correction also strongly overestimates the bound fraction (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>). We conclude that correcting for defocalization bias is critical. The MSD<sub>i</sub>-based methods again gave divergent results despite seemingly fitting the data well. Thus, a good fit to a histogram of log(D) does not necessarily imply that the inferred <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub> are accurate. A full discussion and comparison of the methods is given in Appendix 1. Finally, we extended this analysis of simulated SPT data to three states (one ‘bound’, two ‘free’ states) and compared Spot-On and vbSPT. Spot-On again accurately inferred both the diffusion constants and subpopulation fractions of each population and slightly outperformed vbSPT (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>).</p><p>Having established that Spot-On is accurate, we next tested whether it was also robust. Spot-On’s ability to infer <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub> was robust to misestimates of the axial detection range of ~100–200 nm (<xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref>), was minimally affected by the number of timepoints considered and fitting parameters (<xref ref-type="fig" rid="fig3s8">Figure 3—figure supplements 8</xref>–<xref ref-type="fig" rid="fig3s9">9</xref>; see also Appendix 2 for parameter considerations) and was not strongly affected by state changes (e.g. binding or unbinding) provided the time-scale of state changes is significantly longer than the frame rate (<xref ref-type="fig" rid="fig3s10">Figure 3—figure supplement 10</xref>). Moreover, Spot-On inferred the localization error with nanometer precision provided that a significant bound fraction is present (<xref ref-type="fig" rid="fig3s11">Figure 3—figure supplement 11</xref>). Finally, we sub-sampled the data sets and found that just ~3000 short trajectories (mean length ~3–4 frames) were sufficient for Spot-On to reliably infer the underlying dynamics (<xref ref-type="fig" rid="fig3s12">Figure 3—figure supplement 12</xref>). We conclude that Spot-On is robust.</p><p>Taken together, this analysis of simulated SPT data suggests that Spot-On successfully overcomes defocalization and analysis method biases (<xref ref-type="fig" rid="fig1">Figure 1C–D</xref>), accurately and robustly estimates subpopulations and diffusion constants across a wide range of dynamics and, finally, outperforms other methods.</p></sec><sec id="s2-3"><title>spaSPT minimizes biases in experimental SPT acquisitions</title><p>Having validated Spot-On on simulated data, which is not subject to experimental biases (<xref ref-type="fig" rid="fig1">Figure 1A–B</xref>), we next sought to evaluate Spot-On on experimental data. To generate SPT data with minimal acquisition bias we performed stroboscopic photo-activation SPT (spaSPT; <xref ref-type="fig" rid="fig4">Figure 4A</xref>), which integrates previously and separately published ideas to minimize experimental biases. First, spaSPT minimizes motion-blurring, which is caused by particle movement during the camera exposure time (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), by using stroboscopic excitation (<xref ref-type="bibr" rid="bib5">Elf et al., 2007</xref>; <xref ref-type="bibr" rid="bib6">Frost et al., 2012</xref>). We found that the bright and photo-stable dyes PA-JF<sub>549</sub> and PA-JF<sub>646</sub> (<xref ref-type="bibr" rid="bib9">Grimm et al., 2016a</xref>) in combination with the HaloTag (‘Halo’) labeling strategy made it possible to achieve a signal-to-background ratio greater than 5 with just 1 ms excitation pulses, thus providing a good compromise between minimal motion-blurring and high signal (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). Second, spaSPT minimizes tracking errors (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) by using photo-activation (<xref ref-type="fig" rid="fig4">Figure 4A</xref>) (<xref ref-type="bibr" rid="bib9">Grimm et al., 2016a</xref>; <xref ref-type="bibr" rid="bib22">Manley et al., 2008</xref>). Tracking errors are generally caused by high particles densities. Photo-activation allows tracking at extremely low densities (≤1 molecule per nucleus per frame) and thereby minimizes tracking errors (<xref ref-type="bibr" rid="bib12">Izeddin et al., 2014</xref>), whilst at the same time generating thousands of trajectories. To consider the full spectrum of nuclear protein dynamics, we studied histone H2B-Halo (overwhelmingly bound; fast diffusion; <xref ref-type="fig" rid="fig4">Figure 4C</xref>), Halo-CTCF (<xref ref-type="bibr" rid="bib11">Hansen et al., 2017</xref>) (largely bound; slow diffusion; <xref ref-type="fig" rid="fig4">Figure 4D</xref>) and Halo-NLS (overwhelmingly free; very fast diffusion; <xref ref-type="fig" rid="fig4">Figure 4F</xref>) in human U2OS cells and Halo-Sox2 (<xref ref-type="bibr" rid="bib39">Teves et al., 2016</xref>) (largely free; intermediate diffusion; <xref ref-type="fig" rid="fig4">Figure 4E</xref>) in mouse embryonic stem cells (mESCs). We labeled Halo-tagged proteins in live cells with the HaloTag ligands PA-JF<sub>549</sub> or PA-JF<sub>646</sub> (<xref ref-type="bibr" rid="bib9">Grimm et al., 2016a</xref>) and performed spaSPT using HiLo illumination (<xref ref-type="video" rid="video2">Video 2</xref>). To generate a large dataset to comprehensively test Spot-On, we performed 1064 spaSPT experiments across 60 different conditions.</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.33125.020</object-id><label>Figure 4.</label><caption><title>Overview of spaSPT and experimental results.</title><p>(<bold>A</bold>) spaSPT. HaloTag-labeling with UV (405 nm) photo-activatable dyes enable spaSPT. spaSPT minimizes tracking errors through photo-activation which maintains low densities. (<bold>B</bold>) Example data. Raw spaSPT images for Halo-CTCF tracked in human U2OS cells at 134 Hz (1 ms stroboscopic 633 nm excitation of JF<sub>646</sub>). (<bold>C–F</bold>) Histograms of displacements for multiple <bold><italic>Δ</italic></bold>τ of histone H2B-Halo in U2OS cells (<bold>C</bold>), Halo-CTCF in U2OS cells (<bold>d</bold>), Halo-Sox2 in mES cells (<bold>E</bold>) and Halo-3xNLS in U2OS cells (<bold>F</bold>). (<bold>G–H</bold>) Effect of frame-rate on <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub>. spaSPT was performed at 200 Hz, 167 Hz, 134 Hz, 100 Hz, 74 Hz and 50 Hz using the 4 cell lines and the data fit using Spot-On and a 2-state model. Each experiment on each cell line was performed in four replicates on different days and ~5 cells imaged each day. (<bold>I</bold>) Motion-blur experiment. To investigate the effect of ‘motion-blurring’, the total number of excitation photons was kept constant, but delivered during pulses of duration 1, 2, 4, 7 ms or continuous (cont) illumination. (<bold>J–K</bold>) Effect of motion-blurring on <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub>. spaSPT data was recorded at 100 Hz and 2-state model-fitting performed with Spot-On. The inferred <italic>D</italic><sub>FREE</sub> (<bold>J</bold>) and <italic>F</italic><sub>BOUND</sub> (<bold>K</bold>) were plotted as a function of excitation pulse duration. Each experiment on each cell line was performed in four replicates on different days and ~5 cells imaged each day. Error bars show standard deviation between replicates.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig4-v2"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.021</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Experimental measurement of axial detection range.</title><p>To determine the axial detection range, mESC C59 Halo-mCTCF (<xref ref-type="bibr" rid="bib11">Hansen et al., 2017</xref>) and U2OS C32 Halo-hCTCF (<xref ref-type="bibr" rid="bib11">Hansen et al., 2017</xref>) cells were grown overnight on plasma-cleaned coverslips, labelled with 250 pM JF<sub>646</sub>, fixed in 4% PFA in PBS for 20 min, washed with PBS and then imaged in PBS with 0.01% (w/v) NaN<sub>3</sub>. We imaged the fixed cells using longer exposure times and very low 633 nm laser intensity to minimize photo-bleaching and collected a 6 µm z-stack spanning most of a nucleus using 20 nm steps. We optimized the imaging conditions to give near identical signal-to-noise to our spaSPT conditions and the data shown is merged data from at least 15 different cells for each cell line. We then localized and ‘tracked’ molecules to determine the experimental axial detection range. (<bold>A-B</bold>) show empirical survival probability distribution for PFA-fixed mESC C59 <sup>JF646</sup>Halo-mCTCF (<bold>A</bold>) and PFA-fixed U2OS C32 <sup>JF646</sup>Halo-hCTCF (<bold>B</bold>). A minimal threshold, τ<sub>MIN</sub>, was set to filter out noise and the left plot shows τ<sub>MIN</sub>=10 frames and the right plot τ<sub>MIN</sub>=15 frames. The raw data is shown in red and a model-fit is overlaid. The estimated axial detection range is also shown. We note that the numbers depend somewhat on the threshold set and differ a bit between U2OS and mES cells. As an approximate average, we used 700 nm here. Importantly, we note that Spot-On is relatively robust to the axial detection range estimate and that changing it by 100 nm only marginally changes the results (<xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref>) (<bold>C</bold>) summary of the model that was fit to the data and the key model parameters. The model assumes that photo-bleaching is a Poisson process and that the axial detection range can be modeled as a Gaussian CDF. Raw data used to plot (<bold>A-B</bold>) and code for reproducing this figure and the model-fitting is available on GitLab: <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacq-lab/estimateaxialdetectionrange">https://gitlab.com/tjian-darzacq-lab/estimateaxialdetectionrange</ext-link>.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig4-figsupp1-v2"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.022</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Sensitivity of Spot-On to anomalous diffusion.</title><p>(<bold>A</bold>) MSD-fit and Spot-On for U2OS H2B-Halo PA-JF646 spaSPT at 134 Hz. First column: A power law was fit to the time- and –ensemble-averaged mean squared displacement (MSD) and the anomalous diffusion exponent, α, inferred. To calculate the MSD from only the free population, vbSPT with an enforced 2-state model was used to classify trajectories into either bound or free and the MSD calculated from the vbSPT-classified free population. Error bars were obtained from jackknife sampling: random 50% subsamples of the data were taken, the MSD calculated and this repeated 20 times. Error bars show standard deviation among subsamplings. The best-fit α-value as well as 95% confidence intervals (CI) are shown. Second column: Spot-On inferred <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub> from spaSPT experiments at a range of frame rates from 50 Hz to 200 Hz. Despite anomalous diffusion, Spot-On is nevertheless able to estimate reasonably consistent <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub> across a wide range of frame-rates. Third to fifth column: Spot-On (JumpsToConsider = 4; 2-state model) CDF-fits at three selected time-points, showing that even with significant anomalous diffusion and only three fitted parameters, Spot-On can nonetheless fit the data reasonably well. (<bold>B</bold>) MSD-fit and Spot-On for U2OS C32 Halo-CTCF PA-JF646 spaSPT at 134 Hz. Each column is described in (<bold>A</bold>). (<bold>C</bold>) MSD-fit and Spot-On for mESC C3 Halo-Sox2 PA-JF646 spaSPT at 134 Hz. Each column is described in (<bold>A</bold>). (<bold>D</bold>) MSD-fit and Spot-On for U2OS Halo-3xNLS PA-JF646 spaSPT at 134 Hz. Each column is described in (<bold>A</bold>). (<bold>E</bold>) MSD-fit and Spot-On for simulated data with <italic>D</italic><sub>FREE</sub> = 3.5 µm<sup>2</sup>/s; <italic>F</italic><sub>BOUND</sub> = 50%; 7 ms per frame.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig4-figsupp2-v2"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33125.023</object-id><label>Figure 4—figure supplement 3.</label><caption><title>Re-analysis of experimental data using vbSPT.</title><p>We re-analyzed the experimental data shown in <xref ref-type="fig" rid="fig4">Figure 4G–K</xref> using vbSPT (allowing up to two states) instead of Spot-On. (<bold>A-B</bold>) Effect of frame-rate on <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub>. spaSPT was performed at 200 Hz, 167 Hz, 134 Hz, 100 Hz, 74 Hz and 50 Hz using the 4 cell lines and the data analyzed using vbSPT (max two states). Each experiment on each cell line was performed in four replicates on different days and ~5 cells imaged each day. Error bars show standard deviation between replicates. (<bold>C</bold>) Motion-blur experiment. To investigate the effect of ‘motion-blurring’, the total number of excitation photons was kept constant, but delivered during pulses of duration 1, 2, 4, 7 ms or continuous (cont) illumination. (<bold>D-E</bold>) Effect of motion-blurring on <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub>. spaSPT data was recorded at 100 Hz and the data analyzed using vbSPT (max two states). The inferred <italic>D</italic><sub>FREE</sub> (<bold>D</bold>) and <italic>F</italic><sub>BOUND</sub> (<bold>E</bold>) were plotted as a function of excitation pulse duration. Each experiment on each cell line was performed in four replicates on different days and ~5 cells imaged each day. Error bars show standard deviation between replicates. Compared to Spot-On (<xref ref-type="fig" rid="fig4">Figure 4G–K</xref>; repeated below), vbSPT generally reports a higher bound fraction (e.g. vbSPT reports a total bound fraction for Halo-Sox2 of ~60–65%, which is much higher than previously reported [<xref ref-type="bibr" rid="bib39">Teves et al., 2016</xref>]). vbSPT most likely overestimates the bound fraction because it does not account for defocalization bias.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-33125-fig4-figsupp3-v2"/></fig></fig-group><media id="video2" mime-subtype="avi" mimetype="video" xlink:href="elife-33125-video2.mp4"><object-id pub-id-type="doi">10.7554/eLife.33125.024</object-id><label>Video 2.</label><caption><title>Related to <xref ref-type="fig" rid="fig4">Figure 4</xref>.</title><p>Representative raw spaSPT movie (Halo-hCTCF at 134 Hz). spaSPT movie (1 ms of 633 nm laser delivered at the beginning of each frame; 405 nm laser photo-activation pulses delivered in between frames) of endogenously tagged CTCF (C32 Halo-hCTCF) in human U2OS cells imaged at ~134 Hz (7.477 ms per frame). Dye: PA-JF<sub>646</sub>. One pixel: 160 nm.</p></caption></media></sec><sec id="s2-4"><title>Validation of Spot-On using spaSPT data at different frame rates</title><p>First, we studied whether Spot-On could consistently infer subpopulations over a wide range of frame rates. We experimentally determined the axial detection range to be ~700 nm (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) and performed spaSPT at 200 Hz, 167 Hz, 134 Hz, 100 Hz, 74 Hz and 50 Hz using the four cell lines. Spot-On consistently inferred the diffusion constant (<xref ref-type="fig" rid="fig4">Figure 4G</xref>) and total bound fraction across the wide range of frame rates (<xref ref-type="fig" rid="fig4">Figure 4H</xref>). This is notable since all four proteins exhibit apparent anomalous diffusion (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>) and this demonstrates that Spot-On is also robust to anomalous diffusion despite modeling Brownian motion. While the ground-truth is unknown when considering experiments, Spot-On gave biologically reasonable results: histone H2B was overwhelmingly bound and free Halo-3xNLS was overwhelmingly unbound (comparison with vbSPT: <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). These results provide additional validation for the bias corrections implemented in Spot-On. We also note that although Spot-On was validated on spaSPT data, SPT data with non-photoactivatable dyes is also suitable for Spot-On analysis provided that the density is sufficiently low to minimize tracking errors (see also Appendix 3: &quot;Which datasets are appropriate for Spot-On?”). Finally, we demonstrated above that just ~3000 short trajectories (mean length ~3–4 frames) were sufficient for Spot-On to accurately infer <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub> (<xref ref-type="fig" rid="fig3s12">Figure 3—figure supplement 12</xref>). Here we obtain well above 3000 trajectories per cell even at ~1 localization/frame. More generally, with spaSPT this should be generally achievable for all but the most lowly expressed nuclear proteins. Thus, this now makes it possible to study biological cell-to-cell variability in TF dynamics.</p></sec><sec id="s2-5"><title>Effect of motion-blur bias on parameter estimates</title><p>Having validated Spot-On on experimental SPT data, we next applied Spot-On to estimate the effect of motion-blurring on the estimation of subpopulations. As mentioned, since most localization algorithms (<xref ref-type="bibr" rid="bib3">Chenouard et al., 2014</xref>; <xref ref-type="bibr" rid="bib35">Sergé et al., 2008</xref>) achieve super-resolution through PSF-fitting, this may cause motion-blurred molecules to be undersampled, resulting in a bias towards slow-moving molecules (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). We estimated the extent of the bias by imaging the four cell lines at 100 Hz and keeping the total number of excitation photons constant, but varying the excitation pulse duration (1 ms, 2 ms, 4 ms, 7 ms, constant; <xref ref-type="fig" rid="fig4">Figure 4I</xref>). For generality, we performed these experiments using both PA-JF<sub>549</sub> and PA-JF<sub>646</sub> dyes (<xref ref-type="bibr" rid="bib9">Grimm et al., 2016a</xref>). We used Spot-On to fit the data and plotted the apparent free diffusion constant (<xref ref-type="fig" rid="fig4">Figure 4J</xref>) and apparent total bound fraction (<xref ref-type="fig" rid="fig4">Figure 4K</xref>) as a function of the excitation pulse duration. For fast-diffusing proteins like Halo-3xNLS and H2B-Halo, motion-blurring resulted in a large underestimate of the free diffusion constant, whereas the effect on slower proteins like CTCF and Sox2 was minor (<xref ref-type="fig" rid="fig4">Figure 4J</xref>). Regarding the total bound fraction, motion-blurring caused a ~2 fold overestimate for rapidly diffusing Halo-3xNLS (<xref ref-type="fig" rid="fig4">Figure 4K</xref>), but had a minor effect on slower proteins like H2B, CTCF and Sox2. Similar results were obtained for both dyes for proteins with a significant bound fraction, but we note that JF<sub>549</sub> appears to better capture the dynamics of proteins with a minimal bound fraction such as Halo-3xNLS (<xref ref-type="fig" rid="fig4">Figure 4J–K</xref>). Finally, we note that the extent of the bias due to motion-blurring will likely be very sensitive to the localization algorithm. Here, using the MTT-algorithm (<xref ref-type="bibr" rid="bib35">Sergé et al., 2008</xref>), motion-blurring caused up to a 2-fold error in both the <italic>D</italic><sub>FREE</sub> and <italic>F</italic><sub>BOUND</sub> estimates.</p><p>Taken together, these results suggest that Spot-On can reliably be used even for SPT data collected under constant illumination provided that protein diffusion is sufficiently slow and, moreover, provides a helpful guide for optimizing SPT imaging acquisitions (we include a full discussion of considerations for SPT acquisitions and a proposal for minimum reporting standards in SPT in Appendix 3 and 4).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In summary, SPT is an increasingly popular technique and has been revealing important new biological insight. However, a clear consensus on how to perform and analyze SPT experiments is currently lacking. In particular, 2D SPT of fast-diffusing molecules inside 3D cells is subject to a number of inherent experimental (<xref ref-type="fig" rid="fig1">Figure 1A–B</xref>) and analysis (<xref ref-type="fig" rid="fig1">Figure 1C–D</xref>) biases, which can lead to inaccurate conclusions if not carefully corrected for.</p><p>Here, we introduce approaches for accounting for both experimental and analysis biases. Several methods are available for localization/tracking (<xref ref-type="bibr" rid="bib3">Chenouard et al., 2014</xref>; <xref ref-type="bibr" rid="bib35">Sergé et al., 2008</xref>) and for classification of individual trajectories (<xref ref-type="bibr" rid="bib28">Monnier et al., 2015</xref>; <xref ref-type="bibr" rid="bib30">Persson et al., 2013</xref>). Spot-On now complements these tools by providing a bias-corrected, comprehensive open-source framework for inferring subpopulations and diffusion constants from pooled SPT data and makes this platform available through a convenient web-interface. This platform can easily be extended to other diffusion regimes (<xref ref-type="bibr" rid="bib25">Metzler et al., 2014</xref>) and models (<xref ref-type="bibr" rid="bib16">Lee et al., 2017</xref>) and, as 3D SPT methods mature, to 3D SPT data. Moreover, spaSPT provides an acquisition protocol for tracking fast-diffusing molecules with minimal bias. We hope that these validated tools will help make SPT more accessible to the community and contribute positively to the emergence of ‘gold-standard’ acquisition and analysis procedures for SPT.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th>Reagent type (species) <break/>or resource</th><th>Designation</th><th>Source or reference</th><th>Identifiers</th><th>Additional information</th></tr></thead><tbody><tr><td>cell line (<italic>Homo sapiens</italic>)</td><td>Halo-CTCF</td><td>Hansen <italic>et al</italic>. <italic>eLife</italic> 2017;6:e25776; <break/>PMID 28467304; <break/>doi: 10.7554/eLife.25776</td><td>U2OS C32 <break/>FLAG-Halo-CTCF</td><td>Previously reported homozygous <break/>endogenous knock-in cell line where <break/>all endogenous copies of CTCF <break/>have been N-terminally tagged with <break/>FLAG-HaloTag</td></tr><tr><td>cell line (<italic>Homo sapiens</italic>)</td><td>Halo-3xNLS</td><td>Hansen <italic>et al</italic>. <italic>eLife</italic> 2017;6:e25776; <break/>PMID 28467304; <break/>doi: 10.7554/eLife.25776</td><td>U2OS Halo-3xNLS</td><td>U2OS cell line stably expressing <break/>Halo-3xNLS (3 copies of the SV40 Nuclear <break/>Localization Signal) generated by <break/>G418 selection. Generously provided <break/>by David T McSwiggen.</td></tr><tr><td>cell line (<italic>Homo sapiens</italic>)</td><td>H2B-Halo</td><td>Hansen <italic>et al</italic>. <italic>eLife</italic> 2017;6:e25776; <break/>PMID 28467304; <break/>doi: 10.7554/eLife.25776</td><td>U2OS H2B-Halo-SNAP</td><td>U2OS cell line stably expressing histone <break/>H2B-Halo-SNAP generated by G418 <break/>selection. Generously provided <break/>by David T McSwiggen.</td></tr><tr><td>cell line (<italic>Mus musculus</italic>)</td><td>Halo-Sox2</td><td>Teves <italic>et al. eLife</italic> 2016;5:e22280; <break/>PMID 27855781; <break/>doi: 10.7554/eLife.22280</td><td>mESC JM8.N4 C3 <break/>Halo-FLAG-Sox2</td><td>Previously reported homozygous <break/>endogenous knock-in cell line where <break/>both endogenous copies of Sox2 have <break/>been N-terminally tagged with <break/>HaloTag-FLAG. Generously provided <break/>by Sheila S Teves.</td></tr><tr><td>software, algorithm</td><td>Spot-On Matlab</td><td>this paper</td><td>Spot-On Matlab</td><td>Please see Materials and Methods <break/>for a full description. Open-source code <break/>is freely available at GitLab: : <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacqlab/spot-on-matlab">https://gitlab.com/tjian-darzacqlab/spot-on-matlab</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/spot-on-matlab">https://github.com/elifesciences-publications/spot-on-matlab</ext-link>)</td></tr><tr><td>software, algorithm</td><td>Spot-On Python</td><td>this paper</td><td>Spot-On Python</td><td>Please see Materials and Methods for <break/>a full description. Open-source code is <break/>freely available at GitLab: <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacqlab/Spot-On-cli">https://gitlab.com/tjian-darzacqlab/Spot-On-cli</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/spot-on-cli">https://github.com/elifesciences-publications/spot-on-cli</ext-link>)</td></tr><tr><td>software, algorithm</td><td>Spot-On</td><td>this paper</td><td>Spot-On</td><td>Please see Materials and Methods for a <break/>full description. The web-interface can be <break/>found at <ext-link ext-link-type="uri" xlink:href="https://spoton.berkeley.edu/">https://spoton.berkeley.edu/</ext-link> <break/>and the underlying source-code is <break/>freely available at GitLab: <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacqlab/Spot-On">https://gitlab.com/tjian-darzacqlab/Spot-On</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/spot-on">https://github.com/elifesciences-publications/spot-on</ext-link>)</td></tr><tr><td>software, algorithm</td><td>simSPT</td><td>this paper</td><td>simSPT</td><td>Code for efficiently simulating experimentally <break/>realistic SPT data. Please see Materials and <break/>Methods for a full description. <break/>Open-source code is <break/>freely available at GitLab: <break/><ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacq-lab/simSPT">https://gitlab.com/tjian-darzacq-lab/simSPT</ext-link></td></tr><tr><td>software, algorithm</td><td>MSDi; vbSPT;</td><td>this paper and Persson <italic>et al.</italic> <break/><italic>Nature Methods</italic> 2013; <break/>PMID: 23396281; <break/>DOI: 10.1038/nmeth.2367</td><td>MSDi; vbSPT;</td><td>Supplementary software used for MSDi <break/>and vbSPT analysis as well as for <break/>generating the simulated data can be <break/>found at: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/835171">https://zenodo.org/record/835171</ext-link></td></tr><tr><td>chemical compound, drug</td><td>PA-JF<sub>549</sub></td><td>Grimm <italic>et al. Nature</italic> <break/><italic>Methods</italic> 2016; <break/>PMID 27776112; <break/>DOI: 10.1038/nmeth.4034</td><td>PA-JF<sub>549</sub></td><td>Please contact Luke D Lavis for distribution.</td></tr><tr><td>chemical compound, drug</td><td>PA-JF<sub>646</sub></td><td>Grimm <italic>et al. Nature</italic> <break/><italic>Methods</italic> 2016; <break/>PMID 27776112; <break/>DOI: 10.1038/nmeth.4034</td><td>PA-JF<sub>646</sub></td><td>Please contact Luke D Lavis for distribution.</td></tr></tbody></table></table-wrap><sec id="s4-1"><title>Spot-On model</title><p>Spot-On implements and extends a kinetic modeling framework first described in <xref ref-type="bibr" rid="bib24">Mazza et al. (2012)</xref> and later extended in <xref ref-type="bibr" rid="bib11">Hansen et al. (2017)</xref>. Briefly, the model infers the diffusion constant and relative fractions of two or three subpopulations from the distribution of displacements (or histogram of displacements) computed at increasing lag time (1<inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, 2<inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>,. ..). This is performed by fitting a semi-analytical model to the empirical histogram of displacements using non-linear least squares fitting. Defocalization is explicitly accounted for by modeling modeling the fraction of particles that remain in focus over time as a function of their diffusion constant.</p><p>Mathematically, the evolution over time of a concentration of particles located at the origin as a Dirac delta function and which follows free diffusion in two dimensions with a diffusion constant <italic>D</italic> can be described by a propagator (also known as Green’s function). Properly normalized, the probability of a particle starting at the origin ending up at a location <italic>r</italic> = (<italic>x</italic>,<italic>y</italic>) after a time delay, <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, is given by:<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mi>D</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here <italic>N</italic> is a normalization constant with units of length. Spot-On integrates this distribution over a small histogram bin window, Δ<italic>r</italic>, to obtain a normalized distribution, the distribution of displacement lengths to compare to binned experimental data. For simplicity, we will therefore leave out <italic>N</italic> from subsequent expressions. Since experimental SPT data is subject to a significant mean localization error, <inline-formula><mml:math id="inf4"><mml:mi>σ</mml:mi></mml:math></inline-formula>, Spot-On also accounts for this (<xref ref-type="bibr" rid="bib23">Matsuoka et al., 2009</xref>):<disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Many proteins studied by SPT can generally exist in a quasi-immobile state (e.g. a chromatin-bound state in the case of transcription factors) and one or more mobile states. We will first consider the 2-state model. Under most conditions, state transitions can be ignored ((<xref ref-type="bibr" rid="bib11">Hansen et al., 2017</xref>) and <xref ref-type="fig" rid="fig3s10">Figure 3—figure supplement 10</xref>). Thus, the steady-state 2-state model considered by Spot-On becomes:<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, the quasi-immobile subpopulation has diffusion constant, <inline-formula><mml:math id="inf5"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, and makes up a fraction, <inline-formula><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, whereas the freely diffusing subpopulation has diffusion constant, <inline-formula><mml:math id="inf7"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, and makes up a fraction, <inline-formula><mml:math id="inf8"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>. To account for defocalization bias (<xref ref-type="fig" rid="fig1">Figure 1C</xref>), Spot-On explicitly considers the probability of the freely diffusing subpopulation moving out of the axial detection range, <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, during each time delay, <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. This is important. For example, only ~25% of freely-diffusing molecules will remain in focus for at least five frames (assuming <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 10 ms; <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>=700 nm; one gap allowed; <italic>D</italic> = 5 µm²/s), resulting in a 4-fold undercounting if uncorrected for. If we assume absorbing boundaries such that any molecule that contacts the edges of the axial detection range located at <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>MAX</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>MIN</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> is permanently lost, the fraction of freely diffusing molecules with diffusion constant, <inline-formula><mml:math id="inf15"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, that remain at time delay, <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, is given by (<xref ref-type="bibr" rid="bib2">Carslow and Jaeger, 1959</xref>; <xref ref-type="bibr" rid="bib14">Kues and Kubitscheck, 2002</xref>):<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>remaining</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtext>erfc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:msqrt><mml:mn>4</mml:mn><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:msqrt></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>erfc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:msqrt><mml:mn>4</mml:mn><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:msqrt></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>However, this analytical expression overestimates the fraction lost since there is a significant probability that a molecule that briefly contacted or exceeded the boundary re-enters the axial detection range. The re-entry probability depends on the number of gaps allowed in the tracking (<inline-formula><mml:math id="inf17"><mml:mi>g</mml:mi></mml:math></inline-formula>), <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and can be approximately accounted for by considering a corrected axial detection range, <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, larger than <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>: <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msqrt><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:msqrt><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Although <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> depend on the number of gaps (<italic>g</italic>) allowed in the tracking, we will leave it out for simplicity in the following. We determined the coefficients <italic>a</italic> and <italic>b</italic> from Monte Carlo simulations. For a given diffusion constant, <italic>D</italic>, 50,000 molecules were randomly placed one-dimensionally along the <italic>z</italic>-axis drawn from a uniform distribution from <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>MIN</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>MAX</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Next, using a time-step <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, one-dimensional Brownian diffusion was simulated along the <italic>z</italic>-axis using the Euler-Maruyama scheme. For time delays from 1<inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to 15<inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the fraction of molecules that were lost was calculated in the range of <italic>D</italic>=[1;12] μm<sup>2</sup>/s. <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> were then estimated through least-squares fitting of <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>remaining</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to the simulated fraction remaining. The process was repeated over a grid of plausible values of (<inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) to derive a grid of 134,865 (<italic>a</italic>,<italic>b</italic>) parameter pairs. This pre-calculated library of (<italic>a</italic>,<italic>b</italic>) parameters enables Spot-On to perform model fitting on nearly any SPT dataset with minimal overhead.</p><p>Thus, the 2-state model Spot-On uses for kinetic modeling of SPT data is given by:<disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mspace width="negativethinmathspace"/><mml:mspace width="negativethinmathspace"/><mml:mspace width="negativethinmathspace"/><mml:mspace width="negativethinmathspace"/><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mtext>CORR</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where:<disp-formula id="equ7"><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mtext>CORR</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtext>erfc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:msqrt><mml:mn>4</mml:mn><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:msqrt></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>erfc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:msqrt><mml:mn>4</mml:mn><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:msqrt></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>z</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Having derived the 2-state model, generalization to a 3-state model with 1 bound and 2 diffusive states is straightforward. If the three subpopulations have diffusion constants <inline-formula><mml:math id="inf33"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf34"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf35"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FAST</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, and fractions <inline-formula><mml:math id="inf36"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf37"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf38"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>FAST</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, such that <inline-formula><mml:math id="inf39"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>FAST</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>=1, then the 3-state model considered by Spot-On becomes:<disp-formula id="equ8"><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mspace width="negativethinmathspace"/><mml:mspace width="negativethinmathspace"/><mml:mspace width="negativethinmathspace"/><mml:mspace width="negativethinmathspace"/><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mtext>CORR</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mtext>CORR</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FAST</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FAST</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FAST</mml:mtext></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Where <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mtext>CORR</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is as described above.</p></sec><sec id="s4-2"><title>Numerical implementation of models in Spot-On</title><p>Spot-On calculates the empirical histogram of displacements based on a user-defined bin width. Spot-On allows the user to choose between PDF- and CDF-fitting of the kinetic model to the empirical displacement distributions; CDF-fitting is generally most accurate for smaller datasets and the two are similar for large datasets (<xref ref-type="fig" rid="fig3s9">Figure 3—figure supplement 9</xref>). The integral in <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mtext>CORR</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mtext>corr</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> was numerically evaluated using the midpoint method over 200 points and the terms of the series computed until the term falls below a threshold of 10<sup>−10</sup>. Model fitting and parameter optimization was performed using a non-linear least squares algorithm (Levenberg-Marquardt). Random initial parameter guesses are drawn uniformly from the user-specified parameter range. The optimization is then repeated several times with different initialization parameters to avoid local minima. Spot-On constrains each fraction to be between 0 and 1 and for the sum of the fractions to equal 1.</p></sec><sec id="s4-3"><title>Theoretical characteristics and limitations of the model</title><p>Although Spot-On performs well on both experimental and simulated SPT data, the model implemented by Spot-On has several limitations. First, the kinetic model assumes diffusion to be <italic>ideal Brownian motion</italic>, even though it is widely acknowledged that the motion of most proteins inside a cell shows some degree of anomalous diffusion. Nevertheless, <xref ref-type="fig" rid="fig4">Figure 4G–H</xref> and <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref> show that the parameter inference for experimental data of proteins presenting various degrees of anomalous diffusion is quite robust.</p><p>Second, Spot-On models the localization error as the <italic>static mean localization error</italic> and this feature can be used to infer the actual localization error from the data. However, the localization error is affected both by the position of the particle with respect to the focal plane (<xref ref-type="bibr" rid="bib18">Lindén et al., 2017</xref>) and by motion blur (<xref ref-type="bibr" rid="bib4">Deschout et al., 2012</xref>). Even though a high signal-to-background ratio and fast framerate/stroboscopic illumination help to mitigate these disparities, it is likely that the localization error of fast moving particles will be higher than the bound/slow-moving particles. In that case, one would expect Spot-On to infer a localization error that is the weighted mean of the ‘bound/static’ localization error and the ‘free’ localization error. However, in many situations D<sub>free</sub><inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>&gt;&gt; <inline-formula><mml:math id="inf43"><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> (even assuming a 2 µm²/s particle imaged at a 5 ms framerate with a ~30 nm localization error, there is still an order of magnitude difference between the two terms). As a consequence, the estimate of <inline-formula><mml:math id="inf44"><mml:mi>σ</mml:mi></mml:math></inline-formula> reflects the static localization error (that is, the localization error of the bound fraction), and the localization error estimate becomes less reliable if the bound fraction is very small (<xref ref-type="fig" rid="fig3s11">Figure 3—figure supplement 11</xref>).</p><p>Third, following (<xref ref-type="bibr" rid="bib14">Kues and Kubitscheck, 2002</xref>) the <italic>axial detection profile</italic> is assumed to be a step function, which is an approximation. However, all simulations here were performed using a detection profile with Gaussian edges (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>) and as shown in <xref ref-type="fig" rid="fig3">Figure 3A–B</xref> Spot-On still works quite well and moreover is relatively robust to slight mismatches in the axial detection range (<xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref>).</p><p>Fourth, unlike the original implementation by <xref ref-type="bibr" rid="bib24">Mazza et al. (2012)</xref>, Spot-On ignores <italic>state transitions</italic>. This reduces the number of fitted parameters and simplifies the generalization to more than two states, but as shown in <xref ref-type="fig" rid="fig3s10">Figure 3—figure supplement 10</xref> it also causes the parameter inference to fail unless the timescale of state changes is at least 10–50 times longer than the frame rate. Thus, in cases where a molecule is known to exhibit state changes on a time-scale of tens to a few hundreds of milliseconds, Spot-On may not be appropriate.</p><p>Fifth and finally, Spot-On ignores correlations between adjacent displacements, although taking such information into account can potentially improve the parameter inference (<xref ref-type="bibr" rid="bib42">Vestergaard et al., 2014</xref>).</p></sec><sec id="s4-4"><title>Cell culture</title><p>Halo-Sox2 (<xref ref-type="bibr" rid="bib39">Teves et al., 2016</xref>) knock-in JM8.N4 mouse embryonic stem cells ((<xref ref-type="bibr" rid="bib31">Pettitt et al., 2009</xref>) Research Resource Identifier: RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/CVCL_J962">CVCL_J962</ext-link>; obtained from the KOMP Repository at UC Davis) were grown on plates pre-coated with a 0.1% autoclaved gelatin solution (Sigma-Aldrich, St. Louis, MO, G9391) under feeder free conditions in knock-out DMEM with 15% FBS and LIF (full recipe: 500 mL knockout DMEM (ThermoFisher, Waltham, MA, #10829018), 6 mL MEM NEAA (ThermoFisher #11140050), 6 mL GlutaMax (ThermoFisher #35050061), 5 mL Penicillin-streptomycin (ThermoFisher #15140122), 4.6 μL 2-mercapoethanol (Sigma-Aldrich M3148), 90 mL fetal bovine serum (HyClone Logan, UT, FBS SH30910.03 lot #AXJ47554)) and LIF. mES cells were fed by replacing half the medium with fresh medium daily and passaged every two days by trypsinization. Halo-3xNLS, H2B-Halo-SNAP and knock-in C32 Halo-CTCF (<xref ref-type="bibr" rid="bib11">Hansen et al., 2017</xref>) Human U2OS osteosarcoma cells (Research Resource Identifier: RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/CVCL_0042">CVCL_0042</ext-link>) were grown in low glucose DMEM with 10% FBS (full recipe: 500 mL DMEM (ThermoFisher #10567014), 50 mL fetal bovine serum (HyClone FBS SH30910.03 lot #AXJ47554) and 5 mL Penicillin-streptomycin (ThermoFisher #15140122)) and were passaged every 2–4 days before reaching confluency. For live-cell imaging, the medium was identical except DMEM without phenol red was used (ThermoFisher #31053028). Both mouse ES and human U2OS cells were grown in a Sanyo copper alloy IncuSafe humidified incubator (MCO-18AIC(UV)) at 37°C/5.5% CO<sub>2</sub>. Cell lines were pathogen tested and authenticated through STR profiling (U2OS) as described previously (<xref ref-type="bibr" rid="bib11">Hansen et al., 2017</xref>; <xref ref-type="bibr" rid="bib39">Teves et al., 2016</xref>). All cell lines will be provided upon request.</p></sec><sec id="s4-5"><title>Single-molecule imaging</title><p>The indicated cell line was grown overnight on plasma-cleaned 25 mm circular no 1.5H cover glasses (Marienfeld, Germany, High-Precision 0117650) either directly (U2OS) or MatriGel coated (mESCs; Fisher Scientific, Hampton, NH, #08-774-552 according to manufacturer’s instructions just prior to cell plating). After overnight growth, cells were labeled with 5–50 nM PA-JF<sub>549</sub> or PA-JF<sub>646</sub> (<xref ref-type="bibr" rid="bib9">Grimm et al., 2016a</xref>) for ~15–30 min and washed twice (one wash: medium removed; PBS wash; replenished with fresh medium). At the end of the final wash, the medium was changed to phenol red-free medium keeping all other aspects of the medium the same. Single-molecule imaging was performed on a custom-built Nikon TI microscope (Nikon Instruments Inc., Melville, NY) equipped with a 100x/NA 1.49 oil-immersion TIRF objective (Nikon apochromat CFI Apo TIRF 100x Oil), EM-CCD camera (Andor, Concord, MA, iXon Ultra 897; frame-transfer mode; vertical shift speed: 0.9 μs; −70°C), a perfect focusing system to correct for axial drift and motorized laser illumination (Ti-TIRF, Nikon), which allows an incident angle adjustment to achieve highly inclined and laminated optical sheet illumination (<xref ref-type="bibr" rid="bib41">Tokunaga et al., 2008</xref>). The incubation chamber maintained a humidified 37°C atmosphere with 5% CO<sub>2</sub> and the objective was also heated to 37°C. Excitation was achieved using the following laser lines: 561 nm (1 W, Genesis Coherent, Santa Clara, CA) for PA-JF<sub>549</sub>; 633 nm (1 W, Genesis Coherent, Pala Alto, CA) for PA-JF<sub>646</sub>; 405 nm (140 mW, OBIS, Coherent) for all photo-activation experiments. The excitation lasers were modulated by an acousto-optic Tunable Filter (AA Opto-Electronic, France, AOTFnC-VIS-TN) and triggered with the camera TTL exposure output signal. The laser light is coupled into the microscope by an optical fiber and then reflected using a multi-band dichroic (405 nm/488 nm/561 nm/633 nm quad-band, Semrock, Rochester, NY) and then focused in the back focal plane of the objective. Fluorescence emission light was filtered using a single band-pass filter placed in front of the camera using the following filters: PA-JF549: Semrock 593/40 nm bandpass filter; PA-JF<sub>646</sub>: Semrock 676/37 nm bandpass filter. The microscope, cameras, and hardware were controlled through NIS-Elements software (Nikon).</p></sec><sec id="s4-6"><title>spaSPT experiments and analysis</title><p>The spaSPT experimental settings for <xref ref-type="fig" rid="fig4">Figure 4G–H</xref> were as follows: 1 ms 633 nm excitation (100% AOTF) of PA-JF<sub>646</sub> was delivered at the beginning of the frame; 405 nm photo-activation pulses were delivered during the camera integration time (~447 μs) to minimize background and their intensity optimized to achieve a mean density of ≤1 molecule per frame per nucleus. 30,000 frames were recorded per cell per experiment. The camera exposure times were: 4.5 ms, 5.5 ms, 7 ms, 9.5 ms, 13 ms and 19.5 ms.</p><p>For the motion-blur spaSPT experiments (<xref ref-type="fig" rid="fig4">Figure 4I–K</xref>), the camera exposure was fixed to 9.5 ms and photo-activation performed as above. To keep the total number of delivered photons constant, we generated an AOTF-laser intensity calibration curve using a power meter and adjusted the AOTF transmission accordingly for each excitation pulse duration. The excitation settings were as follows: 1 ms, 561 nm 100% AOTF, 633 nm 100% AOTF; 2 ms, 561 nm 43% AOTF, 633 nm 40% AOTF; 4 ms, 561 nm 28% AOTF, 633 nm 27% AOTF; 7 ms, 561 nm 20% AOTF, 633 nm 19% AOTF; constant illumination, 561 nm 17% AOTF, 633 nm 16% AOTF.</p><p>spaSPT data was analyzed (localization and tracking) and converted into trajectories using a custom-written Matlab implementation of the MTT-algorithm (<xref ref-type="bibr" rid="bib35">Sergé et al., 2008</xref>) and the following settings: Localization error: 10<sup>-6.25</sup>; deflation loops: 0; Blinking (frames): 1; max competitors: 3; max <italic>D</italic> (μm<sup>2</sup>/s): 20. The spaSPT trajectory data was then analyzed using the Matlab version of Spot-On (v1.0; GitLab tag 1f9f782b) and the following parameters: dZ = 0.7 µm; GapsAllowed = 1; TimePoints: 4 (50 Hz), 6 (74 Hz), 7 (100 Hz), 8 (134 Hz), 9 (167 and 200 Hz); JumpsToConsider = 4; ModelFit = 2; NumberOfStates = 2; FitLocError = 0; LocError = 0.035 µm; D_Free_2State=[0.4;25]; D_Bound_2State=[0.00001;0.08];</p></sec><sec id="s4-7"><title>SPT simulations</title><p>We developed a utility to simulate diffusing proteins in a confined geometry (simSPT). Briefly, simSPT simulates the diffusion of an arbitrary number of populations of molecules characterized by their diffusion coefficient, under a steady state assumption. Particles are drawn at random between the populations and their location in the 3D nucleus is initialized following a uniform law within the confinement volume. The lifetime of the particle (in frames) is also drawn following an exponential law of mean lifetime <inline-formula><mml:math id="inf45"><mml:mi>β</mml:mi></mml:math></inline-formula>. Then, the particle diffuses in 3D until it bleaches. Diffusion is simulated by drawing jumps following a normal law of parameters <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msqrt><mml:mn>2</mml:mn><mml:mi>D</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <italic>D</italic> is the diffusion coefficient and <inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> the exposure time. Finally, a localization error (<inline-formula><mml:math id="inf48"><mml:mi>N</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>) is added to each (<italic>x</italic>,<italic>y</italic>,<italic>z</italic>) localization in the simulated trajectories.</p><p>For comparisons of Spot-On, MSD<sub>i</sub> and vbSPT using a 2-state scenario, we parameterized simSPT to consider two subpopulations of particles diffusing in a sphere (the nucleus) of 8 µm diameter illuminated using HiLo illumination (assuming a HiLo beam width of 4 µm), with an axial detection range of ~700 nm, centered at the middle of the HiLo beam with Gaussian edges. Molecules are assumed to have a mean lifetime of 4 frames (when inside the HiLo beam) and of 40 frames when outside the HiLo beam. The localization error was set to 25 nm and the simulation was run until 100,000 in-focus trajectories were recorded. More specifically, the effect of the exposure time (1 ms, 4 ms, 7 ms, 13 ms, 20 ms), the free diffusion constant (from 0.5 µm²/s to 14.5 µm²/s in 0.5 µm²/s increments) and the fraction bound (from 0% to 95% in 5% increments) were investigated, yielding a dataset consisting of 3480 simulations. More details on the simulations, including scripts to reproduce the dataset, are available on GitLab as detailed in the ‘Computer code’ section. Full details on how the simulations were analyzed by Spot-On, vbSPT and MSD<sub>i</sub> are given in Appendix 1.</p><p>We also considered a 3-state scenario featuring a bound subpopulation (‘bound’), a relatively slow diffusing free subpopulation (‘slow’) and a relatively faster diffusing free subpopulation (‘free’). In this case, we only compared Spot-On and vbSPT (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>), since the MSD<sub>i</sub> methods did not perform well. As in the 2-state simulations, we parameterized simSPT to consider that three subpopulations of particles diffusing in a sphere (the nucleus) of 8 µm diameter illuminated using HiLo illumination (assuming a HiLo beam width of 4 µm), with an axial detection range of ~700 nm, centered at the middle of the HiLo beam with Gaussian edges. Molecules are assumed to have a mean lifetime of 4 frames (when inside the HiLo beam) and of 40 frames when outside the HiLo beam. The localization error was set to 40 nm and the simulation was run until 100,000 in-focus trajectories were recorded. We considered three different subpopulation conditions: (1) <italic>F</italic><sub>BOUND</sub> = 25%; <italic>F</italic><sub>SLOW</sub> = 25%; <italic>F</italic><sub>FAST</sub> = 50%; (2) <italic>F</italic><sub>BOUND</sub> = 25%; <italic>F</italic><sub>SLOW</sub> = 50%; <italic>F</italic><sub>FAST</sub> = 25%; (3) <italic>F</italic><sub>BOUND</sub> = 50%; <italic>F</italic><sub>SLOW</sub> = 25%; <italic>F</italic><sub>FAST</sub> = 25%. Specifically, for each of these condition, the effect of of the exposure time (1 ms, 4 ms, 7 ms, 10 ms, 13 ms, 20 ms), the slower free diffusion constant (from 0.5 µm²/s to 2.5 µm²/s in 0.5 µm²/s increments) and the faster free diffusion constant (from 4 µm²/s to 11 µm²/s in 1 µm²/s increments) were investigated, yielding a dataset of 720 simulations. Both vbSPT and Spot-On (all) were constrained to three subpopulations. Full details on how the simulations were analyzed by Spot-On and vbSPT are given in Appendix 1.</p></sec><sec id="s4-8"><title>Data availability</title><p>All raw 1064 spaSPT experiments (<xref ref-type="fig" rid="fig4">Figure 4</xref>) as well as the 3480 simulations (<xref ref-type="fig" rid="fig3">Figure 3</xref>) are freely available in Spot-On readable Matlab and CSV file formats in the form of SPT trajectories at Zenodo. The experimental data is available at: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/834781">https://zenodo.org/record/834781</ext-link>; The simulations are available in Matlab format at: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/835541">https://zenodo.org/record/835541</ext-link>; The simulations are available in CSV format at: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/834787">https://zenodo.org/record/834787</ext-link>; And supplementary software used for MSD<sub>i</sub> and vbSPT analysis as well as for generating the simulated data at: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/835171">https://zenodo.org/record/835171</ext-link></p></sec><sec id="s4-9"><title>Computer code</title><p>Spot-On is fully open-source. The web-interface can be found at: <ext-link ext-link-type="uri" xlink:href="https://SpotOn.berkeley.edu.">https://SpotOn.berkeley.edu.</ext-link> All raw code is available at GitLab: <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacq-lab.">https://gitlab.com/tjian-darzacq-lab.</ext-link> The web-interface code can be found at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacq-lab/Spot-On">https://gitlab.com/tjian-darzacq-lab/Spot-On</ext-link>; the Matlab command-line version of Spot-On can be found at: <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacq-lab/spot-on-matlab">https://gitlab.com/tjian-darzacq-lab/spot-on-matlab</ext-link>; the Python command-line version of Spot-On can be found at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacq-lab/Spot-On-cli">https://gitlab.com/tjian-darzacq-lab/Spot-On-cli</ext-link>; the SPT simulation code (simSPT) can be found at: <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacq-lab/simSPT">https://gitlab.com/tjian-darzacq-lab/simSPT</ext-link>; finally, the ‘TrackMate to Spot-On connector’ plugin, which adds an extra menu to TrackMate which allows one-click upload of datasets to Spot-On can be found at: <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacq-lab/Spot-On-TrackMate">https://gitlab.com/tjian-darzacq-lab/Spot-On-TrackMate</ext-link></p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>ASH and MW contributed equally to this work and are alphabetically listed. We are very grateful to Davide Mazza who inspired this work and provided invaluable comments on Spot-On, to Florian Mueller for suggestions on the web-application, Christophe Zimmer for insightful discussions, David McSwiggen and Sheila Teves for kindly providing cell lines, Carolyn Elya and Chiahao Tsui for the name ‘Spot-On’, and to members of the Tjian/Darzacq labs and Maxime Dahan for discussions. We also thank Astou Tangara and Anatalia Robles for microscope maintenance. ASH is a postdoctoral fellow of the Siebel Stem Cell Institute. This work was supported by NIH grants UO1-EB021236 and U54-DK107980 (XD), the California Institute of Regenerative Medicine grant LA1-08013 (XD), by the Howard Hughes Medical Institute (003061, RT) and used the computational and storage services (TARS cluster) provided by the IT department at Institut Pasteur, Paris.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>has filed patent applications (e.g. PCT/US2015/023953) whose value may be affected by this publication</p></fn><fn fn-type="COI-statement" id="conf3"><p>Luke D Lavis: has filed patent applications (e.g. PCT/US2015/023953) whose value may be affected by this publication</p></fn><fn fn-type="COI-statement" id="conf4"><p>One of the three founding funders of eLife and a member of eLife's Board of Directors</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceived of the project, Developed Spot-On, Performed simulations, Performed experiments, Analyzed experiments, Drafted and edited the manuscript</p></fn><fn fn-type="con" id="con2"><p>Conceived of the project, Developed Spot-On, Performed simulations, Analyzed experiments, Drafted and edited the manuscript</p></fn><fn fn-type="con" id="con3"><p>Developed and contributed JF dyes, Edited the manuscript</p></fn><fn fn-type="con" id="con4"><p>Developed and contributed JF dyes, Edited the manuscript</p></fn><fn fn-type="con" id="con5"><p>Supervised the research, Reviewed and edited the manuscript</p></fn><fn fn-type="con" id="con6"><p>Conceived of the project, Supervised the research, Reviewed and edited the manuscript</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><object-id pub-id-type="doi">10.7554/eLife.33125.025</object-id><label>Supplementary file 1.</label><caption><title>PDF of step-by-step manual for using Spot-On.</title></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-33125-supp1-v2.pdf"/></supplementary-material><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.33125.026</object-id><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-33125-transrepform-v2.docx"/></supplementary-material><sec id="s11" sec-type="datasets"><title>Major datasets</title><p>The following datasets were generated:</p><p><related-object content-type="generated-dataset" id="dataset1" source-id="https://doi.org/10.5281/zenodo.834781" source-id-type="uri"><collab collab-type="author">Hansen AS</collab><collab collab-type="author">Woringer M</collab><collab collab-type="author">Grimm JB</collab><collab collab-type="author">Lavis LD</collab><collab collab-type="author">Tjian R</collab><collab collab-type="author">Darzacq X</collab><year>2017</year><source>Experimental data for &quot;Spot-On: robust model-based analysis of single-particle tracking experiments&quot;</source><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.834781">https://doi.org/10.5281/zenodo.834781</ext-link><comment>Publicly available at Zenodo (https://zenodo.org/)</comment></related-object></p><p><related-object content-type="generated-dataset" id="dataset2" source-id="https://doi.org/10.5281/zenodo.835541" source-id-type="uri"><collab collab-type="author">Hansen AS</collab><collab collab-type="author">Woringer M</collab><collab collab-type="author">Grimm JB</collab><collab collab-type="author">Lavis LD</collab><collab collab-type="author">Tjian R</collab><collab collab-type="author">Darzacq X</collab><year>2017</year><source>Simulated data for &quot;Spot-On: robust model-based analysis of single-particle tracking experiments&quot; (MATLAB format)</source><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.835541">https://doi.org/10.5281/zenodo.835541</ext-link><comment>Publicly available at Zenodo (https://zenodo.org/)</comment></related-object></p><p><related-object content-type="generated-dataset" id="dataset3" source-id="https://doi.org/10.5281/zenodo.834787" source-id-type="uri"><collab collab-type="author">Hansen AS</collab><collab collab-type="author">Woringer M</collab><collab collab-type="author">Grimm JB</collab><collab collab-type="author">Lavis LD</collab><collab collab-type="author">Tjian R</collab><collab collab-type="author">Darzacq X</collab><year>2017</year><source>Simulated data for &quot;Spot-On: robust model-based analysis of single-particle tracking experiments&quot;</source><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.834787">https://doi.org/10.5281/zenodo.834787</ext-link><comment>Publicly available at Zenodo (https://zenodo.org/)</comment></related-object></p><p><related-object content-type="generated-dataset" id="dataset4" source-id="https://doi.org/10.5281/zenodo.835171" source-id-type="uri"><collab collab-type="author">Hansen AS</collab><collab collab-type="author">Woringer M</collab><collab collab-type="author">Grimm JB</collab><collab collab-type="author">Lavis LD</collab><collab collab-type="author">Tjian R</collab><collab collab-type="author">Darzacq X</collab><year>2017</year><source>Software used for &quot;Spot-On: robust model-based analysis of single-particle tracking experiments&quot;</source><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.835171">https://doi.org/10.5281/zenodo.835171</ext-link><comment>Publicly available at Zenodo (https://zenodo.org/)</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berglund</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Statistics of camera-based single-particle tracking</article-title><source>Physical Review E</source><volume>82</volume><pub-id pub-id-type="doi">10.1103/PhysRevE.82.011917</pub-id><pub-id pub-id-type="pmid">20866658</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Carslow</surname> <given-names>HS</given-names></name><name><surname>Jaeger</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="1959">1959</year><source>Conduction of Heat in Solids</source></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chenouard</surname> <given-names>N</given-names></name><name><surname>Smal</surname> <given-names>I</given-names></name><name><surname>de Chaumont</surname> <given-names>F</given-names></name><name><surname>Maška</surname> <given-names>M</given-names></name><name><surname>Sbalzarini</surname> <given-names>IF</given-names></name><name><surname>Gong</surname> <given-names>Y</given-names></name><name><surname>Cardinale</surname> <given-names>J</given-names></name><name><surname>Carthel</surname> <given-names>C</given-names></name><name><surname>Coraluppi</surname> <given-names>S</given-names></name><name><surname>Winter</surname> <given-names>M</given-names></name><name><surname>Cohen</surname> <given-names>AR</given-names></name><name><surname>Godinez</surname> <given-names>WJ</given-names></name><name><surname>Rohr</surname> <given-names>K</given-names></name><name><surname>Kalaidzidis</surname> <given-names>Y</given-names></name><name><surname>Liang</surname> <given-names>L</given-names></name><name><surname>Duncan</surname> <given-names>J</given-names></name><name><surname>Shen</surname> <given-names>H</given-names></name><name><surname>Xu</surname> <given-names>Y</given-names></name><name><surname>Magnusson</surname> <given-names>KE</given-names></name><name><surname>Jaldén</surname> <given-names>J</given-names></name><name><surname>Blau</surname> <given-names>HM</given-names></name><name><surname>Paul-Gilloteaux</surname> <given-names>P</given-names></name><name><surname>Roudot</surname> <given-names>P</given-names></name><name><surname>Kervrann</surname> <given-names>C</given-names></name><name><surname>Waharte</surname> <given-names>F</given-names></name><name><surname>Tinevez</surname> <given-names>JY</given-names></name><name><surname>Shorte</surname> <given-names>SL</given-names></name><name><surname>Willemse</surname> <given-names>J</given-names></name><name><surname>Celler</surname> <given-names>K</given-names></name><name><surname>van Wezel</surname> <given-names>GP</given-names></name><name><surname>Dan</surname> <given-names>HW</given-names></name><name><surname>Tsai</surname> <given-names>YS</given-names></name><name><surname>Ortiz de Solórzano</surname> <given-names>C</given-names></name><name><surname>Olivo-Marin</surname> <given-names>JC</given-names></name><name><surname>Meijering</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Objective comparison of particle tracking methods</article-title><source>Nature Methods</source><volume>11</volume><fpage>281</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2808</pub-id><pub-id pub-id-type="pmid">24441936</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deschout</surname> <given-names>H</given-names></name><name><surname>Neyts</surname> <given-names>K</given-names></name><name><surname>Braeckmans</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The influence of movement on the localization precision of sub-resolution particles in fluorescence microscopy</article-title><source>Journal of Biophotonics</source><volume>5</volume><fpage>97</fpage><lpage>109</lpage><pub-id pub-id-type="doi">10.1002/jbio.201100078</pub-id><pub-id pub-id-type="pmid">22083848</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elf</surname> <given-names>J</given-names></name><name><surname>Li</surname> <given-names>GW</given-names></name><name><surname>Xie</surname> <given-names>XS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Probing transcription factor dynamics at the single-molecule level in a living cell</article-title><source>Science</source><volume>316</volume><fpage>1191</fpage><lpage>1194</lpage><pub-id pub-id-type="doi">10.1126/science.1141967</pub-id><pub-id pub-id-type="pmid">17525339</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frost</surname> <given-names>NA</given-names></name><name><surname>Lu</surname> <given-names>HE</given-names></name><name><surname>Blanpied</surname> <given-names>TA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Optimization of cell morphology measurement via single-molecule tracking PALM</article-title><source>PLoS One</source><volume>7</volume><elocation-id>e36751</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0036751</pub-id><pub-id pub-id-type="pmid">22570741</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goulian</surname> <given-names>M</given-names></name><name><surname>Simon</surname> <given-names>SM</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Tracking single proteins within cells</article-title><source>Biophysical Journal</source><volume>79</volume><fpage>2188</fpage><lpage>2198</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(00)76467-8</pub-id><pub-id pub-id-type="pmid">11023923</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grimm</surname> <given-names>JB</given-names></name><name><surname>English</surname> <given-names>BP</given-names></name><name><surname>Chen</surname> <given-names>J</given-names></name><name><surname>Slaughter</surname> <given-names>JP</given-names></name><name><surname>Zhang</surname> <given-names>Z</given-names></name><name><surname>Revyakin</surname> <given-names>A</given-names></name><name><surname>Patel</surname> <given-names>R</given-names></name><name><surname>Macklin</surname> <given-names>JJ</given-names></name><name><surname>Normanno</surname> <given-names>D</given-names></name><name><surname>Singer</surname> <given-names>RH</given-names></name><name><surname>Lionnet</surname> <given-names>T</given-names></name><name><surname>Lavis</surname> <given-names>LD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A general method to improve fluorophores for live-cell and single-molecule microscopy</article-title><source>Nature Methods</source><volume>12</volume><fpage>244</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3256</pub-id><pub-id pub-id-type="pmid">25599551</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grimm</surname> <given-names>JB</given-names></name><name><surname>English</surname> <given-names>BP</given-names></name><name><surname>Choi</surname> <given-names>H</given-names></name><name><surname>Muthusamy</surname> <given-names>AK</given-names></name><name><surname>Mehl</surname> <given-names>BP</given-names></name><name><surname>Dong</surname> <given-names>P</given-names></name><name><surname>Brown</surname> <given-names>TA</given-names></name><name><surname>Lippincott-Schwartz</surname> <given-names>J</given-names></name><name><surname>Liu</surname> <given-names>Z</given-names></name><name><surname>Lionnet</surname> <given-names>T</given-names></name><name><surname>Lavis</surname> <given-names>LD</given-names></name></person-group><year iso-8601-date="2016">2016a</year><article-title>Bright photoactivatable fluorophores for single-molecule imaging</article-title><source>Nature Methods</source><volume>13</volume><fpage>985</fpage><lpage>988</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4034</pub-id><pub-id pub-id-type="pmid">27776112</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grimm</surname> <given-names>JB</given-names></name><name><surname>Klein</surname> <given-names>T</given-names></name><name><surname>Kopek</surname> <given-names>BG</given-names></name><name><surname>Shtengel</surname> <given-names>G</given-names></name><name><surname>Hess</surname> <given-names>HF</given-names></name><name><surname>Sauer</surname> <given-names>M</given-names></name><name><surname>Lavis</surname> <given-names>LD</given-names></name></person-group><year iso-8601-date="2016">2016b</year><article-title>Synthesis of a Far-Red Photoactivatable Silicon-Containing Rhodamine for Super-Resolution Microscopy</article-title><source>Angewandte Chemie International Edition</source><volume>55</volume><fpage>1723</fpage><lpage>1727</lpage><pub-id pub-id-type="doi">10.1002/anie.201509649</pub-id><pub-id pub-id-type="pmid">26661345</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hansen</surname> <given-names>AS</given-names></name><name><surname>Pustova</surname> <given-names>I</given-names></name><name><surname>Cattoglio</surname> <given-names>C</given-names></name><name><surname>Tjian</surname> <given-names>R</given-names></name><name><surname>Darzacq</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>CTCF and cohesin regulate chromatin loop stability with distinct dynamics</article-title><source>eLife</source><volume>6</volume><elocation-id>e25776</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.25776</pub-id><pub-id pub-id-type="pmid">28467304</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izeddin</surname> <given-names>I</given-names></name><name><surname>Récamier</surname> <given-names>V</given-names></name><name><surname>Bosanac</surname> <given-names>L</given-names></name><name><surname>Cissé</surname> <given-names>II</given-names></name><name><surname>Boudarene</surname> <given-names>L</given-names></name><name><surname>Dugast-Darzacq</surname> <given-names>C</given-names></name><name><surname>Proux</surname> <given-names>F</given-names></name><name><surname>Bénichou</surname> <given-names>O</given-names></name><name><surname>Voituriez</surname> <given-names>R</given-names></name><name><surname>Bensaude</surname> <given-names>O</given-names></name><name><surname>Dahan</surname> <given-names>M</given-names></name><name><surname>Darzacq</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Single-molecule tracking in live cells reveals distinct target-search strategies of transcription factors in the nucleus</article-title><source>eLife</source><volume>3</volume><elocation-id>e2230</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.02230</pub-id><pub-id pub-id-type="pmid">28467304</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knight</surname> <given-names>SC</given-names></name><name><surname>Xie</surname> <given-names>L</given-names></name><name><surname>Deng</surname> <given-names>W</given-names></name><name><surname>Guglielmi</surname> <given-names>B</given-names></name><name><surname>Witkowsky</surname> <given-names>LB</given-names></name><name><surname>Bosanac</surname> <given-names>L</given-names></name><name><surname>Zhang</surname> <given-names>ET</given-names></name><name><surname>El Beheiry</surname> <given-names>M</given-names></name><name><surname>Masson</surname> <given-names>JB</given-names></name><name><surname>Dahan</surname> <given-names>M</given-names></name><name><surname>Liu</surname> <given-names>Z</given-names></name><name><surname>Doudna</surname> <given-names>JA</given-names></name><name><surname>Tjian</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dynamics of CRISPR-Cas9 genome interrogation in living cells</article-title><source>Science</source><volume>350</volume><fpage>823</fpage><lpage>826</lpage><pub-id pub-id-type="doi">10.1126/science.aac6572</pub-id><pub-id pub-id-type="pmid">26564855</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kues</surname> <given-names>T</given-names></name><name><surname>Kubitscheck</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Single molecule motion perpendicular to the focal plane of a microscope: Application to splicing factor dynamics within the cell nucleus</article-title><source>Single Molecules</source><volume>3</volume><fpage>218</fpage><lpage>224</lpage><pub-id pub-id-type="doi">10.1002/1438-5171(200208)3:4&lt;218::AID-SIMO218&gt;3.0.CO;2-C</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lavis</surname> <given-names>LD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Chemistry is dead. Long live chemistry!</article-title><source>Biochemistry</source><volume>56</volume><fpage>5165</fpage><lpage>5170</lpage><pub-id pub-id-type="doi">10.1021/acs.biochem.7b00529</pub-id><pub-id pub-id-type="pmid">28704030</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>A</given-names></name><name><surname>Tsekouras</surname> <given-names>K</given-names></name><name><surname>Calderon</surname> <given-names>C</given-names></name><name><surname>Bustamante</surname> <given-names>C</given-names></name><name><surname>Pressé</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Unraveling the thousand word picture: an introduction to super-resolution data analysis</article-title><source>Chemical Reviews</source><volume>117</volume><fpage>7276</fpage><lpage>7330</lpage><pub-id pub-id-type="doi">10.1021/acs.chemrev.6b00729</pub-id><pub-id pub-id-type="pmid">28414216</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>L</given-names></name><name><surname>Liu</surname> <given-names>H</given-names></name><name><surname>Dong</surname> <given-names>P</given-names></name><name><surname>Li</surname> <given-names>D</given-names></name><name><surname>Legant</surname> <given-names>WR</given-names></name><name><surname>Grimm</surname> <given-names>JB</given-names></name><name><surname>Lavis</surname> <given-names>LD</given-names></name><name><surname>Betzig</surname> <given-names>E</given-names></name><name><surname>Tjian</surname> <given-names>R</given-names></name><name><surname>Liu</surname> <given-names>Z</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Real-time imaging of Huntingtin aggregates diverting target search and gene transcription</article-title><source>eLife</source><volume>5</volume><elocation-id>e17056</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.17056</pub-id><pub-id pub-id-type="pmid">27484239</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindén</surname> <given-names>M</given-names></name><name><surname>Ćurić</surname> <given-names>V</given-names></name><name><surname>Amselem</surname> <given-names>E</given-names></name><name><surname>Elf</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Pointwise error estimates in localization microscopy</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>15115</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms15115</pub-id><pub-id pub-id-type="pmid">28466844</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>Z</given-names></name><name><surname>Legant</surname> <given-names>WR</given-names></name><name><surname>Chen</surname> <given-names>BC</given-names></name><name><surname>Li</surname> <given-names>L</given-names></name><name><surname>Grimm</surname> <given-names>JB</given-names></name><name><surname>Lavis</surname> <given-names>LD</given-names></name><name><surname>Betzig</surname> <given-names>E</given-names></name><name><surname>Tjian</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>3D imaging of Sox2 enhancer clusters in embryonic stem cells</article-title><source>eLife</source><volume>3</volume><elocation-id>e04236</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.04236</pub-id><pub-id pub-id-type="pmid">25537195</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>Z</given-names></name><name><surname>Lavis</surname> <given-names>LD</given-names></name><name><surname>Betzig</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Imaging live-cell dynamics and structure at the single-molecule level</article-title><source>Molecular Cell</source><volume>58</volume><elocation-id>644</elocation-id><lpage>659</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2015.02.033</pub-id><pub-id pub-id-type="pmid">26000849</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loffreda</surname> <given-names>A</given-names></name><name><surname>Jacchetti</surname> <given-names>E</given-names></name><name><surname>Antunes</surname> <given-names>S</given-names></name><name><surname>Rainone</surname> <given-names>P</given-names></name><name><surname>Daniele</surname> <given-names>T</given-names></name><name><surname>Morisaki</surname> <given-names>T</given-names></name><name><surname>Bianchi</surname> <given-names>ME</given-names></name><name><surname>Tacchetti</surname> <given-names>C</given-names></name><name><surname>Mazza</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Live-cell p53 single-molecule binding is modulated by C-terminal acetylation and correlates with transcriptional activity</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>313</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-017-00398-7</pub-id><pub-id pub-id-type="pmid">28827596</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manley</surname> <given-names>S</given-names></name><name><surname>Gillette</surname> <given-names>JM</given-names></name><name><surname>Patterson</surname> <given-names>GH</given-names></name><name><surname>Shroff</surname> <given-names>H</given-names></name><name><surname>Hess</surname> <given-names>HF</given-names></name><name><surname>Betzig</surname> <given-names>E</given-names></name><name><surname>Lippincott-Schwartz</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>High-density mapping of single-molecule trajectories with photoactivated localization microscopy</article-title><source>Nature Methods</source><volume>5</volume><fpage>155</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1176</pub-id><pub-id pub-id-type="pmid">18193054</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsuoka</surname> <given-names>S</given-names></name><name><surname>Shibata</surname> <given-names>T</given-names></name><name><surname>Ueda</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Statistical analysis of lateral diffusion and multistate kinetics in single-molecule imaging</article-title><source>Biophysical Journal</source><volume>97</volume><fpage>1115</fpage><lpage>1124</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2009.06.007</pub-id><pub-id pub-id-type="pmid">19686659</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mazza</surname> <given-names>D</given-names></name><name><surname>Abernathy</surname> <given-names>A</given-names></name><name><surname>Golob</surname> <given-names>N</given-names></name><name><surname>Morisaki</surname> <given-names>T</given-names></name><name><surname>McNally</surname> <given-names>JG</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A benchmark for chromatin binding measurements in live cells</article-title><source>Nucleic Acids Research</source><volume>40</volume><elocation-id>e119</elocation-id><pub-id pub-id-type="doi">10.1093/nar/gks701</pub-id><pub-id pub-id-type="pmid">22844090</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metzler</surname> <given-names>R</given-names></name><name><surname>Jeon</surname> <given-names>JH</given-names></name><name><surname>Cherstvy</surname> <given-names>AG</given-names></name><name><surname>Barkai</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Anomalous diffusion models and their properties: non-stationarity, non-ergodicity, and ageing at the centenary of single particle tracking</article-title><source>Phys. Chem. Chem. Phys.</source><volume>16</volume><fpage>24128</fpage><lpage>24164</lpage><pub-id pub-id-type="doi">10.1039/C4CP03465A</pub-id><pub-id pub-id-type="pmid">25297814</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michalet</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Mean square displacement analysis of single-particle trajectories with localization error: Brownian motion in an isotropic medium</article-title><source>Physical Review E</source><volume>82</volume><pub-id pub-id-type="doi">10.1103/PhysRevE.82.041914</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michalet</surname> <given-names>X</given-names></name><name><surname>Berglund</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Optimal diffusion coefficient estimation in single-particle tracking</article-title><source>Physical Review E</source><volume>85</volume><pub-id pub-id-type="doi">10.1103/PhysRevE.85.061916</pub-id><pub-id pub-id-type="pmid">23005136</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monnier</surname> <given-names>N</given-names></name><name><surname>Barry</surname> <given-names>Z</given-names></name><name><surname>Park</surname> <given-names>HY</given-names></name><name><surname>Su</surname> <given-names>KC</given-names></name><name><surname>Katz</surname> <given-names>Z</given-names></name><name><surname>English</surname> <given-names>BP</given-names></name><name><surname>Dey</surname> <given-names>A</given-names></name><name><surname>Pan</surname> <given-names>K</given-names></name><name><surname>Cheeseman</surname> <given-names>IM</given-names></name><name><surname>Singer</surname> <given-names>RH</given-names></name><name><surname>Bathe</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Inferring transient particle transport dynamics in live cells</article-title><source>Nature Methods</source><volume>12</volume><fpage>838</fpage><lpage>840</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3483</pub-id><pub-id pub-id-type="pmid">26192083</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mueller</surname> <given-names>F</given-names></name><name><surname>Stasevich</surname> <given-names>TJ</given-names></name><name><surname>Mazza</surname> <given-names>D</given-names></name><name><surname>McNally</surname> <given-names>JG</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Quantifying transcription factor kinetics: at work or at play?</article-title><source>Critical Reviews in Biochemistry and Molecular Biology</source><volume>48</volume><fpage>492</fpage><lpage>514</lpage><pub-id pub-id-type="doi">10.3109/10409238.2013.833891</pub-id><pub-id pub-id-type="pmid">24025032</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Persson</surname> <given-names>F</given-names></name><name><surname>Lindén</surname> <given-names>M</given-names></name><name><surname>Unoson</surname> <given-names>C</given-names></name><name><surname>Elf</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Extracting intracellular diffusive states and transition rates from single-molecule tracking data</article-title><source>Nature Methods</source><volume>10</volume><fpage>265</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2367</pub-id><pub-id pub-id-type="pmid">23396281</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pettitt</surname> <given-names>SJ</given-names></name><name><surname>Liang</surname> <given-names>Q</given-names></name><name><surname>Rairdan</surname> <given-names>XY</given-names></name><name><surname>Moran</surname> <given-names>JL</given-names></name><name><surname>Prosser</surname> <given-names>HM</given-names></name><name><surname>Beier</surname> <given-names>DR</given-names></name><name><surname>Lloyd</surname> <given-names>KC</given-names></name><name><surname>Bradley</surname> <given-names>A</given-names></name><name><surname>Skarnes</surname> <given-names>WC</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Agouti C57BL/6N embryonic stem cells for mouse genetic resources</article-title><source>Nature Methods</source><volume>6</volume><fpage>493</fpage><lpage>495</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1342</pub-id><pub-id pub-id-type="pmid">19525957</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rhodes</surname> <given-names>J</given-names></name><name><surname>Mazza</surname> <given-names>D</given-names></name><name><surname>Nasmyth</surname> <given-names>K</given-names></name><name><surname>Uphoff</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Scc2/Nipbl hops between chromosomal cohesin rings after loading</article-title><source>eLife</source><volume>6</volume><elocation-id>e30000</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.30000</pub-id><pub-id pub-id-type="pmid">28914604</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Rigano</surname> <given-names>A</given-names></name><name><surname>Strambio De Castillia</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Proposal for minimum information guidelines to report and reproduce results of particle tracking and motion analysis</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/155036</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname> <given-names>JC</given-names></name><name><surname>Zaug</surname> <given-names>AJ</given-names></name><name><surname>Cech</surname> <given-names>TR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Live cell imaging reveals the dynamics of telomerase recruitment to telomeres</article-title><source>Cell</source><volume>166</volume><fpage>1188</fpage><lpage>1197</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.07.033</pub-id><pub-id pub-id-type="pmid">27523609</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sergé</surname> <given-names>A</given-names></name><name><surname>Bertaux</surname> <given-names>N</given-names></name><name><surname>Rigneault</surname> <given-names>H</given-names></name><name><surname>Marguet</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Dynamic multiple-target tracing to probe spatiotemporal cartography of cell membranes</article-title><source>Nature Methods</source><volume>5</volume><fpage>687</fpage><lpage>694</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1233</pub-id><pub-id pub-id-type="pmid">18604216</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname> <given-names>H</given-names></name><name><surname>Tauzin</surname> <given-names>LJ</given-names></name><name><surname>Baiyasi</surname> <given-names>R</given-names></name><name><surname>Wang</surname> <given-names>W</given-names></name><name><surname>Moringo</surname> <given-names>N</given-names></name><name><surname>Shuang</surname> <given-names>B</given-names></name><name><surname>Landes</surname> <given-names>CF</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Single Particle Tracking: From Theory to Biophysical Applications</article-title><source>Chemical Reviews</source><volume>117</volume><fpage>7331</fpage><lpage>7376</lpage><pub-id pub-id-type="doi">10.1021/acs.chemrev.6b00815</pub-id><pub-id pub-id-type="pmid">28520419</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Swinstead</surname> <given-names>EE</given-names></name><name><surname>Miranda</surname> <given-names>TB</given-names></name><name><surname>Paakinaho</surname> <given-names>V</given-names></name><name><surname>Baek</surname> <given-names>S</given-names></name><name><surname>Goldstein</surname> <given-names>I</given-names></name><name><surname>Hawkins</surname> <given-names>M</given-names></name><name><surname>Karpova</surname> <given-names>TS</given-names></name><name><surname>Ball</surname> <given-names>D</given-names></name><name><surname>Mazza</surname> <given-names>D</given-names></name><name><surname>Lavis</surname> <given-names>LD</given-names></name><name><surname>Grimm</surname> <given-names>JB</given-names></name><name><surname>Morisaki</surname> <given-names>T</given-names></name><name><surname>Grøntved</surname> <given-names>L</given-names></name><name><surname>Presman</surname> <given-names>DM</given-names></name><name><surname>Hager</surname> <given-names>GL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Steroid receptors reprogram FoxA1 occupancy through dynamic chromatin transitions</article-title><source>Cell</source><volume>165</volume><fpage>593</fpage><lpage>605</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.02.067</pub-id><pub-id pub-id-type="pmid">27062924</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tarantino</surname> <given-names>N</given-names></name><name><surname>Tinevez</surname> <given-names>JY</given-names></name><name><surname>Crowell</surname> <given-names>EF</given-names></name><name><surname>Boisson</surname> <given-names>B</given-names></name><name><surname>Henriques</surname> <given-names>R</given-names></name><name><surname>Mhlanga</surname> <given-names>M</given-names></name><name><surname>Agou</surname> <given-names>F</given-names></name><name><surname>Israël</surname> <given-names>A</given-names></name><name><surname>Laplantine</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>TNF and IL-1 exhibit distinct ubiquitin requirements for inducing NEMO-IKK supramolecular structures</article-title><source>The Journal of Cell Biology</source><volume>204</volume><fpage>231</fpage><lpage>245</lpage><pub-id pub-id-type="doi">10.1083/jcb.201307172</pub-id><pub-id pub-id-type="pmid">24446482</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teves</surname> <given-names>SS</given-names></name><name><surname>An</surname> <given-names>L</given-names></name><name><surname>Hansen</surname> <given-names>AS</given-names></name><name><surname>Xie</surname> <given-names>L</given-names></name><name><surname>Darzacq</surname> <given-names>X</given-names></name><name><surname>Tjian</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A dynamic mode of mitotic bookmarking by transcription factors</article-title><source>eLife</source><volume>5</volume><elocation-id>e22280</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.22280</pub-id><pub-id pub-id-type="pmid">27855781</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tinevez</surname> <given-names>JY</given-names></name><name><surname>Perry</surname> <given-names>N</given-names></name><name><surname>Schindelin</surname> <given-names>J</given-names></name><name><surname>Hoopes</surname> <given-names>GM</given-names></name><name><surname>Reynolds</surname> <given-names>GD</given-names></name><name><surname>Laplantine</surname> <given-names>E</given-names></name><name><surname>Bednarek</surname> <given-names>SY</given-names></name><name><surname>Shorte</surname> <given-names>SL</given-names></name><name><surname>Eliceiri</surname> <given-names>KW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>TrackMate: An open and extensible platform for single-particle tracking</article-title><source>Methods</source><volume>115</volume><fpage>80</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1016/j.ymeth.2016.09.016</pub-id><pub-id pub-id-type="pmid">27713081</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tokunaga</surname> <given-names>M</given-names></name><name><surname>Imamoto</surname> <given-names>N</given-names></name><name><surname>Sakata-Sogawa</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Highly inclined thin illumination enables clear single-molecule imaging in cells</article-title><source>Nature Methods</source><volume>5</volume><fpage>159</fpage><lpage>161</lpage><pub-id pub-id-type="doi">10.1038/nmeth1171</pub-id><pub-id pub-id-type="pmid">18176568</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vestergaard</surname> <given-names>CL</given-names></name><name><surname>Blainey</surname> <given-names>PC</given-names></name><name><surname>Flyvbjerg</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Optimal estimation of diffusion coefficients from single-particle trajectories</article-title><source>Physical Review E</source><volume>89</volume><pub-id pub-id-type="doi">10.1103/PhysRevE.89.022726</pub-id><pub-id pub-id-type="pmid">25353527</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weimann</surname> <given-names>L</given-names></name><name><surname>Ganzinger</surname> <given-names>KA</given-names></name><name><surname>McColl</surname> <given-names>J</given-names></name><name><surname>Irvine</surname> <given-names>KL</given-names></name><name><surname>Davis</surname> <given-names>SJ</given-names></name><name><surname>Gay</surname> <given-names>NJ</given-names></name><name><surname>Bryant</surname> <given-names>CE</given-names></name><name><surname>Klenerman</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A quantitative comparison of single-dye tracking analysis tools using Monte Carlo simulations</article-title><source>PLoS One</source><volume>8</volume><fpage>e64287</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0064287</pub-id><pub-id pub-id-type="pmid">23737978</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhen</surname> <given-names>CY</given-names></name><name><surname>Tatavosian</surname> <given-names>R</given-names></name><name><surname>Huynh</surname> <given-names>TN</given-names></name><name><surname>Duc</surname> <given-names>HN</given-names></name><name><surname>Das</surname> <given-names>R</given-names></name><name><surname>Kokotovic</surname> <given-names>M</given-names></name><name><surname>Grimm</surname> <given-names>JB</given-names></name><name><surname>Lavis</surname> <given-names>LD</given-names></name><name><surname>Lee</surname> <given-names>J</given-names></name><name><surname>Mejia</surname> <given-names>FJ</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Yao</surname> <given-names>T</given-names></name><name><surname>Ren</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Live-cell single-molecule tracking reveals co-recognition of H3K27me3 and DNA targets polycomb Cbx7-PRC1 to chromatin</article-title><source>eLife</source><volume>5</volume><elocation-id>e17667</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.17667</pub-id><pub-id pub-id-type="pmid">27723458</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s7" sec-type="appendix"><title>Fitting of simulations using Spot-On, vbSPT and MSD<sub>i</sub></title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.33125.027</object-id><p>To systematically evaluate the performance of Spot-On as well as other common analysis tools such as MSD<sub>i</sub> and vbSPT (<xref ref-type="bibr" rid="bib30">Persson et al., 2013</xref>), we developed simSPT, a simulation tool to generate a comprehensive set of realistic SPT simulations spanning the range of plausible dynamics (almost a billion trajectories were simulated in total). simSPT is freely available at GitLab: <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/tjian-darzacq-lab/simSPT.">https://gitlab.com/tjian-darzacq-lab/simSPT.</ext-link> simSPT simulates 3D SPT trajectories arising from an arbitrary number of subpopulations confined inside a sphere under HiLo illumination and takes into account a limited axial detection range, realistic photobleaching rates and optionally state interconversion. The simulation methods are described in detail at GitLab.</p><p>Briefly, we parameterized simSPT to consider that particles diffuse inside a sphere (the nucleus) of 8 µm diameter illuminated using HiLo illumination (assuming a HiLo beam width of 4 µm), with an axial detection range of ~700 nm with Gaussian edges, centered at the middle of the HiLo beam. Molecules are assumed to have a mean lifetime of 4 frames (when inside the HiLo beam) and of 40 frames when outside the HiLo beam.</p><p>For the 2-state comparisons, the localization error was set to 25 nm and the simulation was run until 100,000 in-focus trajectories were recorded. More specifically, the effect of the time between frames (1 ms, 4 ms, 7 ms, 13 ms, 20 ms), the free diffusion constant (from 0.5 µm²/s to 14.5 µm²/s in 0.5 µm²/s increments) and the fraction bound (from 0% to 95% in 5% increments) were investigated, yielding a dataset consisting of 3480 simulations. All 3480 simulated datasets are also available (see Data Availability section). The advantage of simulations is that the ground truth is known.</p><p>For the 3-state comparisons (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>), the localization error was set to 40 nm and the simulation was run until 100,000 in-focus trajectories were recorded. We then simulated one bound state (<inline-formula><mml:math id="inf49"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>=0.001 µm²/s) and two free states (<inline-formula><mml:math id="inf50"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>=0.5 to 2.5 µm²/s in 0.5 µm²/s increments; <inline-formula><mml:math id="inf51"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FAST</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>= 4.0 to 11.0 µm²/s in 1.0 µm²/s increments) and also varying the fractions (<inline-formula><mml:math id="inf52"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>=25%, <inline-formula><mml:math id="inf53"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>=25%, <inline-formula><mml:math id="inf54"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>FAST</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>= 50%; or <inline-formula><mml:math id="inf55"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>=25%, <inline-formula><mml:math id="inf56"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>=50%, <inline-formula><mml:math id="inf57"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>FAST</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>= 25%; or <inline-formula><mml:math id="inf58"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>=50%, <inline-formula><mml:math id="inf59"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>=25%, <inline-formula><mml:math id="inf60"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>FAST</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>= 25%;) as was the time between frames (1 ms, 4 ms, 7 ms, 10, 13 ms, 20 ms).</p><p>For more specific simulations, extra parameters were varied, such as the width of the axial detection range (<xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref>), localization error (<xref ref-type="fig" rid="fig3s11">Figure 3—figure supplement 11</xref>), or the presence/absence of interconversion between states (<xref ref-type="fig" rid="fig3s10">Figure 3—figure supplement 10</xref>).</p><sec id="s7-1"><title>Comparison of methods for 2-state simulations</title><p>In the case of the main 3480 simulated SPT datasets for the 2-state comparison, we analyzed the data using the Matlab version of Spot-On (either using JumpsToConsider = 4 or all), MSD<sub>i</sub> (either <italic>R</italic><sup>2</sup> &gt;0.8 or all) or vbSPT. We describe the analysis in details below.</p></sec><sec id="s7-2"><title>Spot-On (4 jumps)</title><sec id="s7-2-1"><title>Rational and parameters</title><p>Spot-On allows a user to use the entirety of each trajectory or to use only the first <italic>n</italic> jumps by adjusting the parameter, <italic>JumpsToConsider</italic>. For example, consider a trajectory consisting of 6 localizations and without gaps. If JumpsToConsider = 4 and TimePoints = 6, then this trajectory will contribute four displacements to the 1<inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> histogram, four displacements to the 2<inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> histogram, three displacements to the 3<inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> histogram, two displacements to the 4<inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> histogram and one displacement to the 5<inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> histogram. Thus, even though the trajectory contains 5 1<inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> displacements, only the first four will be used for analysis if JumpsToConsider = 4. While on simulated data, using a subset of the trajectories is always slightly less accurate than using the entire trajectory since it slightly underestimates the bound fraction, we previously (<xref ref-type="bibr" rid="bib11">Hansen et al., 2017</xref>) used this as an empirical way of compensating for all the other experimental biases that cause undercounting of freely diffusing molecules that cannot fully be taken into account in simulations. We therefore also tested this approach in the simulations. To fit the simulations using Spot-On we fed the following parameters to the function SpotOn_core.m (v1.0; GitLab tag 1f9f782b):</p><list list-type="bullet"><list-item><p>dZ = 0.700;</p></list-item><list-item><p>GapsAllowed = 1;</p></list-item><list-item><p>BinWidth = 0.010;</p></list-item><list-item><p>UseAllTraj = 0;</p></list-item><list-item><p>JumpsToConsider = 4;</p></list-item><list-item><p>MaxJump = 6.05;</p></list-item><list-item><p>ModelFit = 2;</p></list-item><list-item><p>DoSingleCellFit = 0;</p></list-item><list-item><p>NumberOfStates = 2;</p></list-item><list-item><p>FitIterations = 2;</p></list-item><list-item><p>FitLocError = 0;</p></list-item><list-item><p>LocError = 0.0247;</p></list-item><list-item><p>D_Free_2State = [0.4 25];</p></list-item><list-item><p>D_Bound_2State = [0.00001 0.08];</p></list-item><list-item><p>TimePoints: 10 if 1 ms; 9 if 4 ms; 8 if 7 ms; 7 if 10 ms; 6 if 13 ms; 5 if 20 ms;</p></list-item><list-item><p>The empirical a,b parameters used to correct for defocalization bias were as follows:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 ms; <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.0387 s<sup>12</sup>; b = 0.3189 µm;</p></list-item><list-item><p><inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 4 ms; <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.1472 s<sup>1/2</sup>; b = 0.2111 µm;</p></list-item><list-item><p><inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 7 ms; <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.1999 s<sup>1/2</sup>; b = 0.2058 µm;</p></list-item><list-item><p><inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 10 ms; <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.2379 s<sup>1/2</sup>; b = 0.2017 µm;</p></list-item><list-item><p><inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 13 ms; <inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.2656 s<sup>1/2</sup>; b = 0.2118 µm;</p></list-item><list-item><p><inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 20 ms; <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.3133 s<sup>1/2</sup>; b = 0.2391 µm;</p></list-item></list></list-item></list><p>CDF-fitting was then performed in MATLAB R2014b using the Matlab version of Spot-On (v1.0; GitLab tag 1f9f782b) and the estimated free diffusion constant, <inline-formula><mml:math id="inf79"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, and bound fraction, <inline-formula><mml:math id="inf80"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, recorded for each of the 3480 simulations. The estimated <inline-formula><mml:math id="inf81"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf82"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> were then compared to the ground truth known from the simulations. Three parameters were estimated in the fit.</p></sec><sec id="s7-2-2"><title>Performance evaluation</title><p>Spot-On (4 jumps) performs slightly worse than Spot-On (all) when it comes to estimating <inline-formula><mml:math id="inf83"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> as expected and essentially identically to Spot-On (all) for estimating <inline-formula><mml:math id="inf84"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>. The mean error (bias) for estimating <inline-formula><mml:math id="inf85"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> was −6.4%, the inter-quartile range (IQR) was 5.9% and the standard deviation 3.6%. The origin of the error is the undercounting of the bound population due to considering only the first 4 jumps. Since bound molecules remain in focus until they bleach, they always yield only a single trajectory, whereas a single freely diffusing molecule has a probability of yielding multiple trajectories by diffusing in-focus for a while, then moving out-of-focus for a while and then moving back in-focus. For estimating <inline-formula><mml:math id="inf86"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> the bias for Spot-On (4 jumps) was −5.4%, the IQR 3.6% and the standard deviation 3.2%. However, as shown in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplements 2</xref> and <xref ref-type="fig" rid="fig3s4">4</xref>, the slight underestimate of the free diffusion constant is not due to a limitation of Spot-On, but instead due to confinement inside the nucleus (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>). For example, a diffusing molecule close to the nuclear boundary moving towards the nuclear boundary will ‘bounce back’ resulting in a large distance travelled, but only a smaller recorded displacement. We validated that this indeed is the origin of the underestimate of <inline-formula><mml:math id="inf87"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> by considering a nucleus with virtually no confinement (20 μm radius) and found that the <inline-formula><mml:math id="inf88"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>-underestimate was now minimal (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>). Finally, Spot-On always estimated the bound diffusion constant, <inline-formula><mml:math id="inf89"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, with minimal error unlike MSD<sub>i</sub> or vbSPT, which were not able to accurately estimate <inline-formula><mml:math id="inf90"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>. However, since there is generally less interest in <inline-formula><mml:math id="inf91"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, we did not use this further for evaluating the performance of the different methods.</p></sec></sec><sec id="s7-3"><title>Spot-On (all)</title><p><bold>Rational and parameters</bold>: Spot-On (all) was run on the simulations identically to Spot-On (4 jumps) except the entirety of each trajectory was used for calculating the histograms. To fit the simulations using Spot-On we fed the following parameters to the function SpotOn_core.m (v1.0; GitLab tag 1f9f782b):</p><list list-type="bullet"><list-item><p>dZ = 0.700;</p></list-item><list-item><p>GapsAllowed = 1;</p></list-item><list-item><p>BinWidth = 0.010;</p></list-item><list-item><p>UseAllTraj = 1;</p></list-item><list-item><p>MaxJump = 6.05;</p></list-item><list-item><p>ModelFit = 2;</p></list-item><list-item><p>DoSingleCellFit = 0;</p></list-item><list-item><p>NumberOfStates = 2;</p></list-item><list-item><p>FitIterations = 2;</p></list-item><list-item><p>FitLocError = 0;</p></list-item><list-item><p>LocError = 0.0247;</p></list-item><list-item><p>D_Free_2State = [0.4 25];</p></list-item><list-item><p>D_Bound_2State = [0.00001 0.08];</p></list-item><list-item><p>TimePoints: 10 if 1 ms; 9 if 4 ms; 8 if 7 ms; 7 if 10 ms; 6 if 12 ms; 5 if 20 ms;</p></list-item><list-item><p>The empirical a,b parameters used to correct for defocalization bias were as follows:</p><list list-type="bullet"><list-item><p>o <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 ms; <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.0387 s<sup>1/2</sup>; b = 0.3189 µm;</p></list-item><list-item><p>o <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 4 ms; <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.1472 s<sup>1/2</sup>; b = 0.2111 µm;</p></list-item><list-item><p>o <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 7 ms; <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.1999 s<sup>1/2</sup>; b = 0.2058 µm;</p></list-item><list-item><p>o <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 10 ms; <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.2379 s<sup>1/2</sup>; b = 0.2017 µm;</p></list-item><list-item><p>o <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 13 ms; <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.2656 s<sup>1/2</sup>; b = 0.2118 µm;</p></list-item><list-item><p>o <inline-formula><mml:math id="inf102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 20 ms; <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.3133 s<sup>1/2</sup>; b = 0.2391 µm;</p></list-item></list></list-item></list><p>As above, CDF-fitting was performed and the <inline-formula><mml:math id="inf104"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>-estimate and <inline-formula><mml:math id="inf105"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>-estimate compared to the ground truth for each of the 3480 simulations for which the ground truth is known. Three parameters were estimated in the fit.</p><sec id="s7-3-1"><title>Performance evaluation</title><p>Spot-On (all) out-performed all other approaches. The mean error (bias) for estimating <inline-formula><mml:math id="inf106"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> was −1.7%, the inter-quartile range (IQR) was 1.8% and the standard deviation 1.2%. For estimating <inline-formula><mml:math id="inf107"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> the bias for Spot-On (all) was −4.8%, the IQR 3.5% and the standard deviation 3.3%. But as mentioned above, the slight underestimate of <inline-formula><mml:math id="inf108"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> is simply due to diffusion being confined inside a 4 μm radius nucleus (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>). This also helps to emphasize the point that diffusion constants measured inside a nucleus should be interpreted as apparent diffusion constants.</p></sec></sec><sec id="s7-4"><title>MSD<sub>i</sub> (<italic>R</italic><sup>2</sup>&gt;0.8)</title><sec id="s7-4-1"><title>Rational and parameters</title><p>A large number of papers have use different variations of the MSD<sub>i</sub> approach (<xref ref-type="bibr" rid="bib13">Knight et al., 2015</xref>; <xref ref-type="bibr" rid="bib17">Li et al., 2016</xref>; <xref ref-type="bibr" rid="bib19">Liu et al., 2014</xref>; <xref ref-type="bibr" rid="bib34">Schmidt et al., 2016</xref>; <xref ref-type="bibr" rid="bib44">Zhen et al., 2016</xref>). This approach is of course very sensitive to how the MSD is estimated. For example, it is well-known that accurately estimating diffusion constants from short trajectories (&lt;100 frames) subject to significant localization error is all but impossible as shown by Michalet and Berglund (<xref ref-type="bibr" rid="bib27">Michalet and Berglund, 2012</xref>). Nevertheless, several papers assign diffusion constants to individual trajectories based on a MSD-fit. While the exact method differs somewhat from paper to paper, the most popular approach is to set a threshold of a certain number of localizations per trajectory (most commonly 5; though we note that some reports explicitly attempt to compensate for the bias introduced by setting such a threshold (<xref ref-type="bibr" rid="bib44">Zhen et al., 2016</xref>)). Each trajectory with at least five localizations are then fit, often using the Matlab library MSDAnalyzer (<xref ref-type="bibr" rid="bib38">Tarantino et al., 2014</xref>), and thus assigned an apparent diffusion constant. An additional threshold is then applied: only if the fit to the MSD curve is judged sufficiently good, is the diffusion constant then used. Otherwise the trajectory is ignored. This fitting threshold is frequently set based on the coefficient of determination as <italic>R</italic><sup>2</sup>&gt;0.8 in some recent papers (<xref ref-type="bibr" rid="bib13">Knight et al., 2015</xref>; <xref ref-type="bibr" rid="bib17">Li et al., 2016</xref>; <xref ref-type="bibr" rid="bib34">Schmidt et al., 2016</xref>). Next, after analyzing all trajectories in this way, a distribution of diffusion constants is then obtained. The analysis is then performed on the logarithm of these diffusion constants (‘LogD histogram’) (<xref ref-type="bibr" rid="bib13">Knight et al., 2015</xref>; <xref ref-type="bibr" rid="bib17">Li et al., 2016</xref>; <xref ref-type="bibr" rid="bib34">Schmidt et al., 2016</xref>). Both the CDF (<xref ref-type="bibr" rid="bib13">Knight et al., 2015</xref>) and PDF (<xref ref-type="bibr" rid="bib13">Knight et al., 2015</xref>; <xref ref-type="bibr" rid="bib17">Li et al., 2016</xref>; <xref ref-type="bibr" rid="bib34">Schmidt et al., 2016</xref>; <xref ref-type="bibr" rid="bib44">Zhen et al., 2016</xref>) can be considered. These are then fitted with a sum of Gaussian distributions: either two (<xref ref-type="bibr" rid="bib13">Knight et al., 2015</xref>; <xref ref-type="bibr" rid="bib34">Schmidt et al., 2016</xref>; <xref ref-type="bibr" rid="bib44">Zhen et al., 2016</xref>) or three (<xref ref-type="bibr" rid="bib34">Schmidt et al., 2016</xref>; <xref ref-type="bibr" rid="bib44">Zhen et al., 2016</xref>). We note that it is not immediately clear which distribution fitted diffusion constants should actually follow (e.g. Log-normal, Gamma, Normal, etc.). No justification is given for sums of Gaussians (<xref ref-type="bibr" rid="bib13">Knight et al., 2015</xref>; <xref ref-type="bibr" rid="bib17">Li et al., 2016</xref>; <xref ref-type="bibr" rid="bib34">Schmidt et al., 2016</xref>), though we note that the fit is often quite good both in the previous reports (<xref ref-type="bibr" rid="bib13">Knight et al., 2015</xref>; <xref ref-type="bibr" rid="bib17">Li et al., 2016</xref>; <xref ref-type="bibr" rid="bib34">Schmidt et al., 2016</xref>) and also here as shown in <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>. Please note that fitting a sum of normal distributions to the LogD histogram is equivalent to fitting a sum of log-normal distributions to the D histogram. We also note here, that in a theoretical study Michalet previously showed that the distribution of diffusion constants is approximately Gaussian, but only under a set of stringent criteria (<xref ref-type="bibr" rid="bib26">Michalet, 2010</xref>). Since CDF-fitting is generally less susceptible to noise from binning and since in this comparison Spot-On also uses CDF-fitting, we fit the LogD histogram with a sum of 2 Gaussians using CDF-fitting. We refer to this whole procedure as MSD<sub>i</sub> (<italic>R</italic><sup>2</sup>&gt;0.8). Examples of fits are shown in <xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref> and the Matlab code to perform the fitting is available together with the data (see “Data availability’). Five parameters were estimated in the fit.</p></sec><sec id="s7-4-2"><title>Performance evaluation</title><p>Overall, MSD<sub>i</sub> (<italic>R</italic><sup>2</sup>&gt;0.8) generally performs reasonably well when it comes to estimating <inline-formula><mml:math id="inf109"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, but extremely poorly when it comes to <inline-formula><mml:math id="inf110"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf111"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>. The mean error (bias) for estimating <inline-formula><mml:math id="inf112"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> was 8.0%, the inter-quartile range (IQR) was 4.9% and the standard deviation 28.5%. For estimating <inline-formula><mml:math id="inf113"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> the bias for MSD<sub>i</sub> (<italic>R</italic><sup>2</sup>&gt;0.8) was −20.6%, the IQR 32.1% and the standard deviation 26.4%. We note that since <inline-formula><mml:math id="inf114"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> necessarily has to take a value between 0% and 95% in the simulations and since half the simulations have <inline-formula><mml:math id="inf115"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>&lt;50%, a mean error of −20.6% is actually quite large. Although the bias for <inline-formula><mml:math id="inf116"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> is much smaller, in ~5% of all cases, the error in estimating <inline-formula><mml:math id="inf117"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> is bigger than 2-fold. Moreover, in a few very rare cases, not a single trajectory out of the 100,000 simulated trajectories pass both thresholds (<italic>R</italic><sup>2</sup>&gt;0.8; at least five frames). Why is MSD<sub>i</sub> (<italic>R</italic><sup>2</sup>&gt;0.8) fitting so unreliable? It is instructive to consider an example. In the example dataset provided with the MSD<sub>i</sub> code (simulation with <inline-formula><mml:math id="inf118"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>=2; <inline-formula><mml:math id="inf119"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula>0.75; 1 ms frame rate), the estimated <inline-formula><mml:math id="inf120"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>=2.06 is very good, but the estimated <inline-formula><mml:math id="inf121"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula>0.16 is extremely poor. Even though the simulation dataset contains 100,000 simulated trajectories, only 3726 of them actually pass the threshold (<italic>R</italic><sup>2</sup>&gt;0.8; at least five frames). Thus, MSD<sub>i</sub> (<italic>R</italic><sup>2</sup>&gt;0.8) only uses around 4% of the data. Since the tiny fraction of the dataset that is used for analysis is chosen based on how well it fits an MSD-curve and since displacements of bound molecules are dominated by localization errors and therefore generally poorly fit by MSD-analysis, the procedure enriches for the free population, which is why the estimated bound fraction (16%) is so much lower than the true bound fraction (75%). Additionally, we note that MSD<sub>i</sub>-based analysis is extremely sensitive to the fitting threshold: if instead of <italic>R</italic><sup>2</sup>&gt;0.8, all trajectories had been used the estimated bound fraction would be 87% instead of 16%.</p><p>In conclusion, MSD<sub>i</sub> (<italic>R</italic><sup>2</sup>&gt;0.8) is unreliable for estimating <inline-formula><mml:math id="inf122"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> when short trajectories are at stake, which is the usual case when performing intracellular SPT of fast-diffusing molecules. MSD<sub>i</sub> (<italic>R</italic><sup>2</sup>&gt;0.8) most likely fails due to a combination of the following reasons among others. First, it poorly handles localization errors, which dominate the displacements of bound molecules. Second, by only considering trajectories of a certain length (normally at least five frames), it only analyzes a small subsample of the dataset. Third, there is no correction for defocalization bias. Since fast-diffusing molecules move out-of-focus and thus have shorter trajectories, the 5-frame threshold introduces a large bias against freely-diffusing molecules. Fourth, the fitting threshold (<italic>R</italic><sup>2</sup>&gt;0.8) is relatively arbitrary and the results of the analysis is extremely sensitive to this threshold. Accordingly, in these simulations MSD<sub>i</sub> (<italic>R</italic><sup>2</sup>&gt;0.8) only analyzes a small fraction (~5%) of all the trajectories; note that this bias against the bound population provides a compensatory bias against the bound population to account for the bias against the free population due to defocalization bias. Fifth, it is difficult to justify the use of Gaussian distributions. Even in cases where the CDF-fit to the data is excellent, the fitted <inline-formula><mml:math id="inf123"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>-value is often very far off the ground truth. Thus, the goodness of the fit cannot be used to judge how well the parameter-estimation went. Finally, we note that several variants of the MSD<sub>i</sub>-based method exist (e.g. the approach used by Zhen <italic>et al</italic>. (<xref ref-type="bibr" rid="bib44">Zhen et al., 2016</xref>)) is a bit different than the one used here. However, a full validation test of all MSD<sub>i</sub>-based methods is beyond the scope of this work.</p></sec></sec><sec id="s7-5"><title>MSD<sub>i</sub> (all)</title><sec id="s7-5-1"><title>Rational and parameters</title><p>The MSD<sub>i</sub> (all) analysis was identical to MSD<sub>i</sub> (<italic>R</italic><sup>2</sup>&gt;0.8) except for a single difference: instead of only using trajectories of at least five frames where the MSD-fit to individual trajectories was judged good (<italic>R</italic><sup>2</sup>&gt;0.8), all trajectories of at least five frames were used, regardless of how good the MSD-fit was. five parameters were estimated in the fit.</p></sec><sec id="s7-5-2"><title>Performance evaluation</title><p>MSD<sub>i</sub> (all) analysis performed very poorly both when it comes to estimating <inline-formula><mml:math id="inf124"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf125"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>. The mean relative error (bias) for estimating <inline-formula><mml:math id="inf126"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> was −39.6%, the inter-quartile range (IQR) was 19.0% and the standard deviation 41.8%. For estimating <inline-formula><mml:math id="inf127"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> the bias for MSD<sub>i</sub> (all) was 22.0%, the IQR 17.8% and the standard deviation 15.8%. Thus, in all but a few edge cases, MSD<sub>i</sub> (all) cannot reliably estimate <inline-formula><mml:math id="inf128"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> or <inline-formula><mml:math id="inf129"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>. As for MSD<sub>i</sub> (<italic>R</italic><sup>2</sup>&gt;0.8), examples of fits are shown in <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref> and the Matlab code to perform the fitting is available together with the data (see “Data availability’). In the case of MSD<sub>i</sub> (all), the main reason for the unreliable estimates is due to defocalization bias. Since fast-diffusing molecules move out-of-focus and thus have shorter trajectories, the 5-frame threshold introduces a large bias against freely-diffusing molecules. Overall, consistent with previous benchmarking efforts on membrane proteins (<xref ref-type="bibr" rid="bib43">Weimann et al., 2013</xref>), MSD<sub>i</sub> (all) performed least well among the tested methods.</p></sec></sec><sec id="s7-6"><title>vbSPT</title><sec id="s7-6-1"><title>Rational and parameters</title><p>vbSPT performs single-trajectory classification using Hidden-Markov Modeling (HMM) and Bayesian inference (<xref ref-type="bibr" rid="bib30">Persson et al., 2013</xref>) and can assign different segments of a single trajectory to different diffusive states, each associated with a particular diffusion constant. vbSPT uses the information from all the estimates on single trajectories to consolidate an estimate of diffusion coefficients and associated fractions in each state.</p><p>vbSPT additionally uses a statistical model to infer the most likely number of diffusive states assuming all states to exhibit Brownian motion. Since the simulations used to evaluate vbSPT performed contain only two states, it was not clear how to assign <inline-formula><mml:math id="inf130"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> or <inline-formula><mml:math id="inf131"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> in cases where e.g. three diffusive states were inferred. Therefore, to optimize the performance of vbSPT and perform the fairest comparison, we restricted vbSPT to two states such that vbSPT would infer the diffusion coefficient of up to two states and provide the associated fractions. This method conceptually differs from the MSD<sub>i</sub> approach in several ways:</p><list list-type="bullet"><list-item><p>The inferred parameters are not based on the MSD</p></list-item><list-item><p>A specific and rigorous Bayesian statistical model is used to aggregate the parameters estimated on single trajectories to global diffusion states.</p></list-item></list><p>vbSPT was initially designed for SPT of diffusing proteins in bacteria (<xref ref-type="bibr" rid="bib30">Persson et al., 2013</xref>), where defocalization biases are virtually nonexistent since the axial dimension of most bacteria are generally comparable to or smaller than the microscope axial detection range. Furthermore, vbSPT does not explicitly model the localization error. It is then expected that the software performs poorly when the localization error is high, as can be expected when imaging intranuclear factors.</p><p>In practice, the following parameters were used to assess vbSPT performance. The software was run on the full set of 3480 simulations. The priors and optimization parameters were left as default and the scripts to perform the analysis are provided together with the experimental data (please see Data Availability section):</p><p>dim = 2;</p><p>trjLmin = 2;</p><p>runs = 3;</p><p>maxHidden = 2;</p><p>bootstrapNum = 10;</p><p>fullBootstrap = 0;</p><p>init_D = [0.001, 16];</p><p>init_tD = [2, 20]*timestep;</p></sec><sec id="s7-6-2"><title>Performance evaluation</title><p>Over the 3480 simulations, vbSPT accurately estimated both <inline-formula><mml:math id="inf132"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf133"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>. The mean relative error (bias) for estimating <inline-formula><mml:math id="inf134"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> was 0.8%, the inter-quartile range (IQR) was 6.8% and the standard deviation 12.5%. For estimating <inline-formula><mml:math id="inf135"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> the bias for vbSPT was 5.0%, the IQR 6.1% and the standard deviation 4.6%. Thus, vbSPT estimated values were quite consistent (IQR &lt;7% for both <inline-formula><mml:math id="inf136"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf137"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>). These values were very close to Spot-On in performance.</p><p>When looking at the heatmaps (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>) more closely, it appeared that vbSPT performs poorly on the estimation of the free diffusion constant when the mean displacements are small. This case occurs either with small free diffusion constants (0.5–2 µm²/s), or with short frame rates (1 ms) and could be explained by the fact that in such conditions, the displacements of the free population and localization error have comparable magnitudes, and that vbSPT does not account for localization error.</p><p>Regarding the estimate of the fraction bound, vbSPT tends to overestimate it more and more as the mean displacement of the free population increases (that is, either the exposure time or <inline-formula><mml:math id="inf138"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>). This is most likely because vbSPT does not correct for defocalization bias. Thus, the more free molecules diffuse out-of-focus, the more vbSPT will overestimate <inline-formula><mml:math id="inf139"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>. Finally, we note that these two biases somewhat compensate for each other: not considering localization errors causes a small overestimate of the free population, whereas not correcting for defocalization bias causes an underestimate of the free population.</p><p>In summary, for conditions where the mean jump length of the free population can be distinguished from the localization error, vbSPT performs reasonably well, while being slightly outperformed by Spot-On.</p></sec></sec><sec id="s7-7"><title>Comparison of methods for 3-state simulations</title><p>In the case of the 720 simulated SPT datasets for the 3-state comparison, we analyzed the data using the Matlab version of Spot-On (all) and vbSPT. We describe the analysis in details below.</p></sec><sec id="s7-8"><title>Spot-On (all)</title><sec id="s7-8-1"><title>Rational and parameters</title><p>Spot-On (all) was run on the simulations identically to the 2-state situation above except with one added freely diffusive state. To fit the simulations using Spot-On we fed the following parameters to the function SpotOn_core.m (v1.0; GitLab tag 1f9f782b):</p><list list-type="bullet"><list-item><p>dZ = 0.700;</p></list-item><list-item><p>GapsAllowed = 1;</p></list-item><list-item><p>BinWidth = 0.010;</p></list-item><list-item><p>UseAllTraj = 1;</p></list-item><list-item><p>MaxJump = 6.05;</p></list-item><list-item><p>ModelFit = 2;</p></list-item><list-item><p>DoSingleCellFit = 0;</p></list-item><list-item><p>NumberOfStates = 3;</p></list-item><list-item><p>FitIterations = 8;</p></list-item><list-item><p>FitLocError = 0;</p></list-item><list-item><p>LocError = 0.04;</p></list-item><list-item><p>D_Free1_3State = [0.4 10];</p></list-item><list-item><p>D_Free2_3State = [0.4 25];</p></list-item><list-item><p>D_Bound_3State = [0.00001 0.04];</p></list-item><list-item><p>TimePoints: 10 if 1 ms; 9 if 4 ms; 8 if 7 ms; 7 if 10 ms; 6 if 12 ms; 5 if 20 ms;</p></list-item><list-item><p>The empirical a,b parameters used to correct for defocalization bias were as follows:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf140"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 ms; <inline-formula><mml:math id="inf141"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.0387 s<sup>1/2</sup>; b = 0.3189 µm;</p></list-item><list-item><p><inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 4 ms; <inline-formula><mml:math id="inf143"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.1472 s<sup>1/2</sup>; b = 0.2111 µm;</p></list-item><list-item><p><inline-formula><mml:math id="inf144"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 7 ms; <inline-formula><mml:math id="inf145"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.1999 s<sup>1/2</sup>; b = 0.2058 µm;</p></list-item><list-item><p><inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 10 ms; <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.2379 s<sup>1/2</sup>; b = 0.2017 µm;</p></list-item><list-item><p><inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 13 ms; <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.2656 s<sup>1/2</sup>; b = 0.2118 µm;</p></list-item><list-item><p><inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 20 ms; <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.7 µm; 1 gap: a = 0.3133 s<sup>1/2</sup>; b = 0.2391 µm;</p></list-item></list></list-item></list><p>As above, CDF-fitting was performed and the diffusion constant- and subpopulation fraction estimates compared to the ground truth for each of the 720 simulations for which the ground truth is known. Five parameters were estimated in the fit.</p></sec><sec id="s7-8-2"><title>Performance evaluation</title><p>As in the 2-state comparison, Spot-On (all) slightly, but significantly, outperformed vbSPT also in the case of 3 states. The biggest error (bias) in estimating any of the subpopulation fractions was 3% and the biggest standard deviation (3.6% std) was also small (see <xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref> for a full table for statistics). In the case of the diffusion constants, Spot-On also accurately inferred all of these with minimal error. The main limitation of Spot-On 3-state fitting, is that it sometimes gets stuck in local minima (we estimate this happens in &lt;1% of cases). Therefore, it was necessary to increase the number of fitting iterations to 8. Nevertheless, Spot-On was very robust and accurately estimated all five parameters with minimal error and outperformed vbSPT.</p></sec></sec><sec id="s7-9"><title>vbSPT</title><sec id="s7-9-1"><title>Rational and parameters</title><p>vbSPT analysis was performed exactly as in the 2-state case, except with three hidden states instead of 2:</p><p>dim = 2;</p><p>trjLmin = 2;</p><p>runs = 3;</p><p>maxHidden = 3;</p><p>bootstrapNum = 10;</p><p>fullBootstrap = 0;</p><p>init_D = [0.001, 16];</p><p>init_tD = [2, 20]*timestep;</p><p>Although vbSPT was constrained to three states, it occasionally inferred that only 1 or 2 states exist. In case vbSPT inferred less than three states (1 or 2), the inferred diffusion coefficients were matched to the closest diffusion coefficient of the ground truth, and the proportion of the one or two unmatched diffusion coefficients was set to zero.</p></sec><sec id="s7-9-2"><title>Performance evaluation</title><p>vbSPT generally performed quite well. The maximal error (bias) in estimating any of the subpopulation fractions was 6% and the maximal standard deviation (6.3% std; see <xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref> for a full table for statistics). The main limitation of vbSPT was its inability to infer <inline-formula><mml:math id="inf152"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>: the mean error (bias) for estimating <inline-formula><mml:math id="inf153"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> was 36.6% and the standard deviation was 64.7%. Therefore, vbSPT performed almost as well as Spot-On for estimating the subpopulation fractions and for estimating <inline-formula><mml:math id="inf154"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FAST</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, but vbSPT was unable to accurately estimate both <inline-formula><mml:math id="inf155"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf156"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>SLOW</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> and thus failed when estimating 2 out of the five parameters. In conclusion, vbSPT performs almost as well as Spot-On when estimating subpopulation fractions, but quite poorly when estimating diffusion constants unless they are very high.</p></sec></sec></boxed-text></sec></app><app id="appendix-2"><title>Appendix 2</title><sec id="s8" sec-type="appendix"><title>Considerations for choosing Spot-On parameters</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.33125.028</object-id><p>In order to run Spot-On, the user has to set a number of parameters. While some are determined by the acquisition protocol (e.g. time between frames), others will have to be carefully chosen. We provide a discussion of how to choose these here.</p><sec id="s8-1"><title>JumpsToConsider</title><p>Users can either choose to use all displacements from all trajectories (set ‘Use all trajectories’ to ‘Yes’ in the web-version of Spot-On or ‘UseAllTraj = 1’ in the Matlab version of Spot-On) or to use only a subset by controlling the JumpsToConsider variable. For example, consider a trajectory consisting of 6 localizations and without gaps. If JumpsToConsider = 4 and TimePoints = 6, then this trajectory will contribute four displacements to the 1<inline-formula><mml:math id="inf157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> histogram, four displacements to the 2<inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> histogram, three displacements to the 3<inline-formula><mml:math id="inf159"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> histogram, two displacements to the 4<inline-formula><mml:math id="inf160"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> histogram and one displacement to the 5<inline-formula><mml:math id="inf161"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> histogram. Thus, even though the trajectory contains 5 1<inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> displacements, only the first four will be used for analysis if JumpsToConsider = 4. Why would we want to limit the number of jumps that were used? Since freely-diffusing molecules move out-of-focus, almost all very long trajectories will be bound molecules. For example, a single trajectory of 21 localizations will provide 20 displacements to the 1<inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> histogram, whereas freely diffusing molecules with short trajectories will provide fewer (e.g. 10 trajectories with three localizations would be necessary to also provide 20 displacements to the 1<inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> histogram). Thus, by limiting JumpsToConsider, one is biasing the displacement histogram against bound molecules. However, as demonstrated in the simulations shown in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, whether all jumps or JumpsToConsider = 4 is used has almost no effect on the <inline-formula><mml:math id="inf165"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>-estimate, but using JumpsToConsider = 4 causes <inline-formula><mml:math id="inf166"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> to be underestimated by on average of −5% (percentage points) relative to SpotOn (all). We see a similar ~5–10% difference between Spot-On (four jumps) and Spot-On (all) on the experimental spaSPT data shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>. As we have discussed previously (<xref ref-type="bibr" rid="bib11">Hansen et al., 2017</xref>), restricting JumpsToConsider to four is a way one can compensate for all the many acquisition biases (such as motion-blur) that generally cause undercounting for fast-diffusing molecules and which cannot readily be taken into account in simulations. While the optimal value will depend on the trajectory length distribution (JumpsToConsider should not take a value much smaller than the mean trajectory length), we found that JumpsToConsider = 4 provides a good compromise for our experimental data. We strongly recommend including experimental controls (such as histone H2B-Halo and Halo-3xNLS to ensure that experimental and analysis parameters have been reasonably set).</p></sec><sec id="s8-2"><title>Number of timepoints</title><p>Spot-On considers how the histogram of displacement changes over time for multiple <inline-formula><mml:math id="inf167"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The number of <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> that will be considered is equal to the number of timepoints – 1. So, if timepoints = 8, the displacements from 1<inline-formula><mml:math id="inf169"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to 7<inline-formula><mml:math id="inf170"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> will be considered. How many timepoints to consider will depend on how much data you have and the frame-rate. For example, if the mean trajectory length is two frames, setting timepoints to 20 will cause problems since only a tiny fraction of trajectories will be at least 20 frames long and thus contribute to the 19<inline-formula><mml:math id="inf171"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> histogram. Moreover, the correction for defocalization is approximate, so considering timepoints where more than &gt;95% of free molecules have moved out-of-focus is also not recommended; when this happens will further depend on the free diffusion constant. Nevertheless, as long as there is sufficient data to reasonably populate the displacement histograms at all timepoints, Spot-On is highly robust to how this parameter is set (<xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8</xref>). As a rule of thumb we generally do not recommend setting timepoints above 10 or considering <inline-formula><mml:math id="inf172"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> beyond 80 ms.</p></sec><sec id="s8-3"><title>Iterations for fitting</title><p>Spot-On almost always converges optimally in the first iteration, so generally 2 or three is more than sufficient when using the 2-state model. For the 3-state model, the parameter estimation is more complicated and here we recommend eight iterations as a starting point.</p></sec><sec id="s8-4"><title>PDF or CDF fitting</title><p>Although for large datasets PDF- and CDF-fitting perform similarly as shown in <xref ref-type="fig" rid="fig3s9">Figure 3—figure supplement 9</xref>, CDF-fitting tends to provide more reliable estimates of <inline-formula><mml:math id="inf173"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf174"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> when the number of trajectories decreases, likely because PDF-fitting is more susceptible to binning noise. Thus, for quantitative analysis we always recommend CDF-fitting, though PDF-fitting can be convenient for making figures since most people find histograms more intuitive.</p></sec><sec id="s8-5"><title>Fitting localization error</title><p>Spot-On can either use a user-supplied localization error or fit it from the data. As long as there is a significant bound fraction, Spot-On will infer this with nanometer precision (<xref ref-type="fig" rid="fig3s11">Figure 3—figure supplement 11</xref>), though we note that this is an average localization error that mostly reflects the localization error of the bound fraction, and the actual localization error for each individual localization will vary (<xref ref-type="bibr" rid="bib4">Deschout et al., 2012</xref>; <xref ref-type="bibr" rid="bib18">Lindén et al., 2017</xref>). In cases, where the bound population is very small, fitting the localization error can be less accurate. Thus, in situations where comparisons are being made between the same protein under different conditions or e.g. between different mutants of the same protein, we recommend fitting to obtain a mean localization error and then keeping it fixed in the comparisons.</p></sec><sec id="s8-6"><title>Choosing allowed ranges for diffusion constants</title><p>Spot-On comes with default allowed ranges. For example, for the 2-state model, <inline-formula><mml:math id="inf175"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>;</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula><mml:math id="inf176"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mn>0.0001</mml:mn><mml:mo>;</mml:mo><mml:mn>0.08</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>. These ranges are generally reasonable, but may not be appropriate for all datasets. Whenever Spot-On infers a diffusion constant that is equal to the min or max, caution is needed and it may be necessary to change these limits. In particular, unless a molecule is bound to an unusually dynamic scaffold, <inline-formula><mml:math id="inf177"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>=0.08 µm²/s is almost certainly too high. Thus, we recommend imaging a protein that is overwhelmingly bound, such as histone H2B or H3, fitting the histone data with Spot-On and then use the inferred <inline-formula><mml:math id="inf178"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> for histone proteins or a slightly larger value as the maximally allowed <inline-formula><mml:math id="inf179"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>BOUND</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> value.</p></sec><sec id="s8-7"><title>2-state or 3-state model</title><p>Spot-On considers either a 2-state or 3-state model. Since the 3-state model contains two additional fitted parameters, the 3-state fit is almost always better. While there are many cases where a 2-state model would be inappropriate (e.g. a transcription factor that can exist as either a monomer or tetramer, thus exhibiting two very different diffusive states), generally speaking, we prefer fitting a 2-state model for most transcription factors or similar nuclear chromatin-interacting proteins. In part, deviations from the 2-state model will be due to anomalous diffusion and confinement inside cells, which cause deviation from the ideal Brownian motion model implemented by Spot-On. For this reason, traditional model-selection techniques such as Akaike’s Information Criterion (AIC) or the Bayesian Information Criterion (BIC) can also be misleading.</p></sec></boxed-text></sec></app><app id="appendix-3"><title>Appendix 3</title><sec id="s9" sec-type="appendix"><title>SPT acquisition considerations in spaSPT experiments</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.33125.029</object-id><sec id="s9-1"><title>Considerations for minimizing bias in SPT acquisitions</title><p>To obtain a good single-molecule tracking dataset, a series of requirements have to be met. First of all, it must be possible to image single-molecules at a high signal-to-noise ratio. This is now relatively straightforward thanks to developments in fluorescence labeling strategies and imaging modalities (<xref ref-type="bibr" rid="bib15">Lavis, 2017</xref>; <xref ref-type="bibr" rid="bib20">Liu et al., 2015</xref>). The development of the HaloTag protein-labeling system and bright, photo-stable organic Halo-dyes such as TMR and the JF dyes (<xref ref-type="bibr" rid="bib8">Grimm et al., 2015</xref>) now make it possible to easily visualize single protein molecules inside live cells. Moreover, imaging modalities such as highly inclined and laminated optical sheet illumination (‘HiLo’)(<xref ref-type="bibr" rid="bib41">Tokunaga et al., 2008</xref>) are relatively straightforward to implement and combined with a high-quality EM-CCD camera make it possible to image single-molecules at high signal-to-noise suitable for generating high-quality 2D SPT data. For details of our imaging setup, which combines HaloTag-labeling with HiLo-illumination and which is relatively common and easy to operate, please see the methods section. But we note that many other imaging modalities, e.g. light-sheet or even epi-fluorescence imaging can generate high-quality single-molecule tracking data.</p><p>Thus, in the following we will assume that the above condition is met: namely, that single protein molecules can be tracked inside live cells at high signal-to-noise ratio. Nevertheless, even if this condition is met, there are at least four other major sources of bias:</p><list list-type="order"><list-item><p>Detection: minimize ‘motion-blurring’</p></list-item><list-item><p>Tracking: minimize tracking errors</p></list-item><list-item><p>3D loss: correct for molecules moving out-of-focus (defocalization bias)</p></list-item><list-item><p>Analysis methods: infer subpopulations with minimal bias</p></list-item></list><p>Spot-On addresses point 3 and 4, as described elsewhere, but point 1 and 2 must be addressed in the experimental design. We discuss strategies to minimize these biases below (spaSPT).</p></sec><sec id="s9-2"><title>1. Detection – minimizing ‘motion-blurring’</title><p>Almost all localization algorithms achieve sub-diffraction localization accuracy (‘super-resolution’) by treating individual fluorophores as point-source emitters, which generate blurred images that can be described by the Point-Spread-Function (PSF) of the microscope. Modeling of the PSF (typically as a 2-dimensional Gaussian) then allows extraction of the particle centroid with a precision of tens of nanometers. But as illustrated in <xref ref-type="fig" rid="fig1">Figure 1A</xref>, while this works extremely well for bound molecules, fast-diffusing molecules will spread out their photons over many pixels during the camera exposure and thus appear as ‘motion-blurs’. Thus, localization algorithms will reliably detect bound molecules, but may fail to detect fast-moving molecules as has also been observed previously (<xref ref-type="bibr" rid="bib1">Berglund, 2010</xref>; <xref ref-type="bibr" rid="bib4">Deschout et al., 2012</xref>; <xref ref-type="bibr" rid="bib5">Elf et al., 2007</xref>; <xref ref-type="bibr" rid="bib12">Izeddin et al., 2014</xref>; <xref ref-type="bibr" rid="bib18">Lindén et al., 2017</xref>). Clearly, the extent of the bias will depend on the exposure time and the diffusion constant: the longer the exposure and higher <italic>D</italic>, the worse the problem. Assuming Brownian motion, we can calculate the fraction of molecules that will move more than some distance, <inline-formula><mml:math id="inf180"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, during an exposure time, <inline-formula><mml:math id="inf181"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>exp</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, given a free diffusion constant of <inline-formula><mml:math id="inf182"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> using the following equation:<disp-formula id="equ9"><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>FREE</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>exp</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For example, if we define motion-blurring as moving more than two pixels (&gt;320 nm assuming a 160 nm pixel size) during the excitation, an exposure time of 10 ms and a typical free diffusion constant of 3.5 μm<sup>2</sup>/s (e.g. ~Sox2), we get:<disp-formula id="equ10"><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0.32</mml:mn><mml:mrow><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0.32</mml:mn><mml:mrow><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>⋅</mml:mo><mml:mn>3.5</mml:mn><mml:mfrac><mml:mrow><mml:mi>μ</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mtext>s</mml:mtext></mml:mfrac><mml:mo>⋅</mml:mo><mml:mn>0.010</mml:mn><mml:mtext>s</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.48</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Thus, even for a relatively slowly diffusing protein, with a 10 ms exposure we should expect almost half (48%) of all free molecules to show significant motion-blurring, if we assume that molecules move with a constant speed during the exposure. The most straightforward solution, therefore, is to limit the exposure time: in the limit of an infinitely short exposure time, there is no motion-blur. In practice, most EM-CCD cameras can only image at ~100–200 Hz for reasonably sized ROIs. Moreover, it is generally desirable for the mean jump lengths to be significantly bigger than the localization error, thus for most nuclear factors in mammalian cells it is not desirable to image at above &gt;250 Hz. Accordingly, a reasonable solution is therefore to use stroboscopic illumination. That is, using brief excitation laser pulses that last shorter than the camera frame rate (e.g. 1 ms excitation pulse, 10 ms camera exposure time for a 100 Hz experiment): this achieves minimal motion-blurring while maintaining a useful frame-rate. However, this highlights a key experimental trade-off: shorter excitation pulses minimize motion-blurring, but also minimize the signal-to-noise. Therefore, a reasonable compromise has to be determined. Here we use 1 ms excitation pulses: this achieves minimal motion blurring (0.067% &gt; 320 nm using <italic>D</italic> = 3.5 μm<sup>2</sup>/s) and still yields very good signal (signal-to-background &gt;5). But users will need to decide this based on their expected <italic>D</italic> and their experimental setup (signal-to-noise). Moreover, different localization algorithms (<xref ref-type="bibr" rid="bib3">Chenouard et al., 2014</xref>; <xref ref-type="bibr" rid="bib4">Deschout et al., 2012</xref>) have different sensitivities to motion-blurring; thus, the extent of the bias will also depend on the user’s localization algorithm. As we show here, in the case of the MTT-algorithm (<xref ref-type="bibr" rid="bib35">Sergé et al., 2008</xref>), the estimation of <italic>D</italic> is quite sensitive to motion-blurring, but the estimation of the bound fraction is less sensitive as long as the diffusion constant is &lt;5 μm<sup>2</sup>/s. But other localization algorithms may be more or less sensitive. Generally speaking, we do not recommend imaging at a signal-to-background &lt;3 and do not recommend using excitation pulses &gt;5 ms, but the optimal conditions will need to be determined on a case-by-case basis.</p><p>In conclusion, experimentally implementing stroboscopic excitation makes it possible to minimize the bias coming from motion-blurring, while still achieving a sufficient signal for reliable localization.</p></sec><sec id="s9-3"><title>2. Tracking – minimizing tracking errors</title><p>It is necessary to minimize tracking errors in order to obtain high-quality SPT data. Tracking errors bias the estimation of essentially all parameters we could want to estimate from SPT experiments including diffusion constants, subpopulations, anomalous diffusion etc. While many different tracking algorithms exist, it is fundamentally impossible to perform tracking, that is connecting localized molecules between subsequent frames, at high densities without introducing many tracking errors. Thus, the simplest solution is to image at low densities: in principle, if there is only one labeled molecule per cell, there can be no tracking errors. Yet, because dyes generally bleach quite quickly under most SPT imaging conditions, this has traditionally led to a serious trade-off between data quality and the number of trajectories which can be obtained. However, with the recent development of bright photo-activatable JF-dyes (<xref ref-type="bibr" rid="bib9">Grimm et al., 2016a</xref>; <xref ref-type="bibr" rid="bib10">2016b</xref>) (PA-dye), it is now possible to combine the superior brightness of the Halo-JF dyes with photo-activation SPT (also called sptPALM (<xref ref-type="bibr" rid="bib22">Manley et al., 2008</xref>)). That is, a large fraction of Halo-tagged proteins in a cell can be labeled with Halo-PA-JF dyes and then photo-activated one at a time: this allows imaging at extremely low densities (&lt;1 fluorescent molecule per cell per frame) and nevertheless tens of thousands of trajectories from a single cell can be obtained. Thus, PA-dyes now make it possible to nearly eliminate tracking errors without compromising on signal-to-noise or amount of data. In fact, imaging at extremely low densities generally also improves signal-to-noise since out-of-focus background is reduced and overlapping point emitters are avoided (<xref ref-type="bibr" rid="bib12">Izeddin et al., 2014</xref>).</p><p>Nevertheless, even with paSPT it is still necessary to decide on an optimal density. The key parameters are size of the ROI (ideally the whole nucleus for studies in cells) and <italic>D</italic>: a large nucleus and a slow <italic>D</italic> can support a higher density than fast-diffusing molecules in a small nucleus. As a general rule of thumb, we recommend a density of ~1 fluorescent molecule per ROI per frame. This will keep tracking errors at a minimum and still support rapid acquisition of large datasets. All data acquired for this study was acquired at approximately this density.</p><p>In practice, keeping an optimal density will require some trial-and-error optimization of the 405 nm photo-activation laser intensity. 405 nm excitation does contribute background fluorescence, so we prefer to pulse the 405 nm laser during the camera ‘dead-time’ (~0.5 ms in our case) to avoid this. Moreover, this also makes it easier to keep the photo-activation level constant when changing the frame rate. However, the optimal photo-activation power will depend on the expression level of the protein, protein half-life and the dye concentration and will therefore have to be optimized in each case. We recommend recording initial datasets and then analyzing them using Spot-On which reports the mean number of localizations per frame and then using this information to determine the optimal photo-activation level. However, even then some cell-to-cell variation may be unavoidable: especially in transient transfection experiments where there is large cell-to-cell variation in expression level or when studying proteins expressed from stably integrated transgenes (e.g. Halo-3xNLS and H2b-Halo in our case). In these cases, some cells will likely exhibit too high a density. To deal with this, Spot-On includes the option to analyze datasets from individual cells first and then excluding a cell with too high a density before analyzing the merged dataset.</p></sec><sec id="s9-4"><title>Which datasets are appropriate for Spot-On?</title><p>In the sections above, we have discussed how to minimize common experimental biases in SPT experiments and proposed spaSPT as a general solution. However, many 2D SPT datasets recorded under different conditions are also appropriate for Spot-On. For example, SPT experiments without photo-activation or with continuous illumination may also be appropriate for analysis with Spot-On. For example, there may be situations where photo-activation SPT is not possible: in such cases, it will be essential to keep the labeling density sufficiently low that tracking errors are minimized and it might thus be necessary to image substantially more cells to get enough statistics. Likewise, as we show in <xref ref-type="fig" rid="fig4">Figure 4JK</xref>, motion-blurring is a major concern for fast-diffusing molecules, but for a slowly diffusing molecule like Halo-CTCF it makes only a small difference. Thus SPT datasets recorded with continuous illumination may also be appropriate provided that the protein of interest is known to diffuse sufficiently slowly.</p><p>We also note that since Spot-On uses the loss of fast-diffusing molecules over time to correct for bias and to estimate the free population, it is essential that all trajectories are included in Spot-On for analysis. For example, some tracking and localization algorithms ignore all trajectories below a certain length (e.g. five frames), but this will cause Spot-On to misestimate the loss of molecules moving out-of-focus and thus it is imperative that trajectories of all lengths be included when analyzing data using Spot-On. Furthermore, trajectories of only a single localization are required to accurately compute the average number of localizations per frame, which is a key quality-control metric for SPT data.</p><p>Moreover, Spot-On does not currently support 3D SPT data. Furthermore, Spot-On assumes diffusion to be Brownian. This is a reasonable approximation even for molecules exhibiting some levels of anomalous diffusion as shown in <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>, but Spot-On is not appropriate for molecules undergoing directed motion (e.g. a protein moving on microtubules). Additionally, in cases where there are frequent state transitions at a time-scale similar to the frame rate (e.g. transcription factor with a 10 ms residence time imaged at 100 Hz), Spot-On may give inaccurate results since it ignores state transitions (<xref ref-type="fig" rid="fig3s10">Figure 3—figure supplement 10</xref>). Finally, the correction for molecules moving out-of-focus assumes that molecules are not fully confined within small compartments, that prevent molecules from moving out-of-focus.</p></sec></boxed-text></sec></app><app id="appendix-4"><title>Appendix 4</title><sec id="s10" sec-type="appendix"><title>Proposed minimal reporting guidelines for SPT data and kinetic modeling analysis</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.33125.030</object-id><p>To ensure reproducibility of results and subsequent analyses, datasets, statistics and analysis metrics should be provided. This should allow the reader to quickly assess the quality and statistical significance of the presented results and datasets. So far, to our knowledge, no consensus exists on minimal reporting guidelines for single particle tracking datasets and kinetic modeling analyses. We note, however, that a recent preprint suggests a similar conceptual framework, although less applicable to single-molecule experiments (<xref ref-type="bibr" rid="bib33">Rigano and Strambio De Castillia, 2017</xref>),</p><p>We propose that published single-particle datasets be published and reported accompanied with the following metadata. We suggest that these metrics constitute a minimal reporting guideline for single-particle datasets and subsequent kinetic modeling (though additional information may be appropriate and necessary in some cases).</p><sec id="s10-1"><title>Dataset description</title><p><table-wrap id="inlinetable1" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th valign="top">Criterion</th><th valign="top">How to obtain it</th><th valign="top">Example value</th></tr></thead><tbody><tr><td valign="top">Exposure time</td><td valign="top">Determined at the acquisition step</td><td valign="top">5 ms</td></tr><tr><td valign="top">Signal-to-background ratio</td><td valign="top">Mean peak value of detected particle divided by mean background value</td><td valign="top">5</td></tr><tr><td valign="top">Detection algorithm used</td><td valign="top"/><td valign="top">MTT (version xxx)</td></tr><tr><td valign="top">Tracking algorithm used</td><td valign="top"/><td valign="top">MTT (version xxx)</td></tr><tr><td valign="top">Number of particles per frame</td><td valign="top">Provided by Spot-On</td><td valign="top">Mean: 0.76</td></tr><tr><td valign="top">Number of detections</td><td valign="top">Provided by Spot-On</td><td valign="top">360000</td></tr><tr><td valign="top">Number of trajectories of length &gt;3</td><td valign="top">Provided by Spot-On</td><td valign="top">10000</td></tr><tr><td valign="top">Mean trajectory length</td><td valign="top">Provided by Spot-On</td><td valign="top">4.5 frames</td></tr><tr><td valign="top">Localization error</td><td valign="top">Provided by Spot-On</td><td valign="top">30 nm</td></tr></tbody></table></table-wrap></p></sec><sec id="s10-2"><title>Spot-On parameters</title><p>In addition to these metrics, it is important to report the parameters specified in the detection and tracking algorithms, since this can greatly affect the results. For Spot-On, we recommend reporting the following parameters:</p><list list-type="bullet"><list-item><p>Jump length distribution parameters: BinWidth (µm), Number of timepoints, Jumps to consider or Use all trajectories, MaxJump (µm),</p></list-item><list-item><p>Fitting parameters: Number of states (2 or 3), localization error fitted from data (Yes or No, if no, specify the value, in nm), dZ (µm), a (s<sup>-1/2</sup>), b (µm), PDF or CDF fit (PDF or CDF), number of iterations. Finally, the bounds used for the fitting algorithm should be reported, e.g:</p><list list-type="bullet"><list-item><p>D<sub>bound</sub>: [0.0005, 0.08] µm²/s</p></list-item><list-item><p>D<sub>free</sub> [0.15, 25] µm²/s</p></list-item><list-item><p>F<sub>bound</sub> [0,1]</p></list-item><list-item><p>Obviously, if a 3-state model is used, the bounds for the additional subpopulation should also be reported.</p></list-item></list></list-item></list><p>In case a custom-modified version of Spot-On is used, we recommend that the code be made available and that a summary of the modifications be included in the methods section.</p></sec></boxed-text></sec></app></app-group></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.33125.041</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Sherratt</surname><given-names>David</given-names></name><role>Reviewing Editor</role><aff id="aff7"><institution>University of Oxford</institution><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Spot-On: robust model-based analysis of single-particle tracking experiments&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by two peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Kevin Struhl as the Senior Editor. The following individual involved in review of your submission has agreed to reveal his identity: Lothar Schermelleh (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>This 'Resource' manuscript describes an integrated approach for single-particle tracking (SPT) microscopy using stroboscopic photoactivation (spaSPT) and present &quot;Spot-On&quot;, an open-access software analysis tool for SPT data. The latter can be applied to any kind of SPT data and uses model fitting to calculate diffusion rates and bound and mobile population sizes. The authors convincingly validate and compare their approach with other available tools using ground-truth simulations and analysing a number of Halo-tagged nuclear proteins with differential dynamic properties in U2OS cells and labelled with photoactivatable JF dyes.</p><p>Both reviewers are enthusiastically supportive of this being published, although a small number of minor comments and corrections are appended below.</p><p>1) A practical issue – could some of the information on the website also be loaded as a supplemental tutorial file (some helpful screenshots?)?</p><p>2) The software in its current form is restricted to 2D-SPT analyses. Why is 3D-tracking not implemented, and is there a planned route for a future upgrade? With many imaging systems offering astigmatism-based 3D localisation option, would this not offer potential benefits? We understand that a package for 3D analysis may be out of the scope of the present article, but whether there is a prospect for such a package in the future might be indicated/commented on.</p><p>3) Along with the software, the authors describe spaSPT as a beneficial approach to minimize motion-blur and tracking errors. What would be the difference between spaSPT and SPT with very low concentration of non-photoactivatable JF dyes? The authors may want to discuss application of Spot-On with alternative imaging approaches in cases where photoactivation is either not possible (e.g. due to lack of laser lines or suitable dyes) or not desired (potential damage, blue channel is already used).</p><p>4) It would be desirable to have a function for visualising tracks with the option to differentially select and display subsets of tracks that fall into different categories (immobile/mobile or other criteria). This would enable the user to directly see spatial patterns of differential dynamics.</p><p>5) i) <xref ref-type="fig" rid="fig4">Figure 4K</xref> and subsection “Effect of motion-blur bias on parameter estimates”, first paragraph: Why is there is a small but significant difference between PA-JF<sub>549</sub> and PA-JF<sub>646</sub>?</p><p>ii) Subsection “Validation of Spot-On using spaSPT data at different frame rates”: The axial detection range should be specified (around 700 nm?).</p><p>iii) Abbreviations CDF and PDF may need to be introduced in the main text as well, not only the figure legend.</p><p>iv) <xref ref-type="fig" rid="fig4">Figure 4</xref>—figure – supplement 3 legend – last paragraph: Does the &quot;total bound fraction of ~60-65%&quot; refer to Halo-<italic>Sox2</italic>? Please specify.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.33125.042</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>[…] Both reviewers are enthusiastically supportive of this being published, although a small number of minor comments and corrections are appended below.</p><p>1) A practical issue – could some of the information on the website also be loaded as a supplemental tutorial file (some helpful screenshots?)?</p></disp-quote><p>This is a good suggestion. We adapted the online tutorial and attach it as <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>. To accommodate future revisions of the interface, it includes a reference to the online version, that will follow the upgrades of the platform.</p><disp-quote content-type="editor-comment"><p>2) The software in its current form is restricted to 2D-SPT analyses. Why is 3D-tracking not implemented, and is there a planned route for a future upgrade? With many imaging systems offering astigmatism-based 3D localisation option, would this not offer potential benefits? We understand that a package for 3D analysis may be out of the scope of the present article, but whether there is a prospect for such a package in the future might be indicated/commented on.</p></disp-quote><p>This is a very interesting suggestion and one we have thought a lot about. Currently, there are two main options for 3D tracking: 1) PSF shaping (such as astigmatism)-based 3D SPT (e.g. cylindrical lens or adaptive optics) and 2) 3D SPT using a Multi-Focal Microscope (MFM) (Abrahamsson et al., Nature Methods, 2013). We will discuss both here.</p><p>1) astigmatism-based 3D SPT data will give a truncated 3D displacement distribution. In x,y there are minor restrictions on displacement lengths, but in z, the max displacement will be equal to the axial detection range (~700 nm total; 0 +/- 350 nm). For example, a molecule 200 nm above the focal plane, will defocalize if it moves more than 150 nm up or more than 550 nm down. For this reason, the expected distribution of 3D displacements is not the simple 3D Brownian distribution, but a complicated convolution of a truncated axial distribution (max 700 nm; position-dependent) and the 2D x,y-distribution considered by Spot-On. To our knowledge there is no straightforward way of extending the z-correction currently implemented in Spot-On to 3D. The simulations in <xref ref-type="fig" rid="respfig1">Author response image 1</xref> compare the jump length distributions derived from data simulated (D=6.0µm²/s, dt=13ms, sigma=35nm) inside a nucleus of diameter 8µm with increasing axial detection range (400nm, 700nm and full nucleus). Although (right panel) the 2D projection from simulated data is only marginally affected by changes in the axial detection depth, in 3D (left panel), the jump length distribution is sensitive to the axial detection depth, and the lower the axial detection depth, the more truncated the distribution. More work is necessary to determine how mathematically tractable this problem is (and we agree that this will be an interesting future direction), but currently we are not sure if the additional information justifies the approach and of course 3D-astigmatism data can always be 2D-projected and then analyzed by Spot-On.</p><fig id="respfig1"><object-id pub-id-type="doi">10.7554/eLife.33125.032</object-id><label>Author response image 1.</label><caption/><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-33125-resp-fig1-v2"/></fig><p>2) the truncated 3D displacement distribution issue can in theory be solved with MFM which can in principle yield whole-nucleus 3D SPT data. However, this comes with serious limitations. First, in the 9-focal plane implementation, the signal is split into 9 and due to other losses, the signal-to-noise is reduced by about a factor of ~15-20. Although the JF-dyes are very bright, this big a loss of signal is a serious limitation. Second, since the full field-of-view is required, the frame rate is necessarily slow (33 Hz in Chen Cell 2014 with EM-CCD). While sCMOS cameras might solve the speed issue, this comes at the cost of further loss of signal. Thus, in MFM-based 3D SPT, continuous illumination was necessary to collect enough signal resulting in 30 ms continuous exposure time. This leads to serious motion-blurring and likely undercounting of the fast-moving population. Third, while incredibly elegant, the MFM microscope is quite complicated to set up (we have set it up in our lab recently) and not in regular use in many labs. But as the reviewers also suggest, this is likely to improve in the future, though we note that no Z-correction for defocalization would be necessary in whole-nucleus MFM.</p><p>In summary, we believe that 3D tracking methods are currently not sufficiently mature to provide enough added value. But we nevertheless fully agree with the reviewers that this is very likely to change in the future and we have now added a sentence to the Discussion that extending Spot-On to 3D SPT data is an exciting future direction and one that we are potentially interested in pursuing. Specifically, we now write that: “This platform can easily be extended to other diffusion regimes (Metzler et al., 2014) and models (Lee et al., 2017) and, as 3D SPT methods mature, to 3D SPT data.”</p><disp-quote content-type="editor-comment"><p>3) Along with the software, the authors describe spaSPT as a beneficial approach to minimize motion-blur and tracking errors. What would be the difference between spaSPT and SPT with very low concentration of non-photoactivatable JF dyes? The authors may want to discuss application of Spot-On with alternative imaging approaches in cases where photoactivation is either not possible (e.g. due to lack of laser lines or suitable dyes) or not desired (potential damage, blue channel is already used).</p></disp-quote><p>This is an important point and as the reviewers suggest, there is in principle no difference between doing SPT with very low concentrations of non-PA dye and spaSPT. It’s just that with non-PA dyes, once the dyes have bleached no more data can be obtained from the cell in question and thus, many more cells have to be imaged to obtain enough data. So spaSPT is more convenient. But to clarify this important point, we now write: “We also note that although Spot-On was validated on spaSPT data, SPT data with non-photoactivatable dyes is also suitable for Spot-On analysis provided that the density is sufficiently low to minimize tracking errors. (see also Appendix 3: “Which datasets are appropriate for Spot-On?”)”.</p><disp-quote content-type="editor-comment"><p>4) It would be desirable to have a function for visualising tracks with the option to differentially select and display subsets of tracks that fall into different categories (immobile/mobile or other criteria). This would enable the user to directly see spatial patterns of differential dynamics.</p></disp-quote><p>We thank the reviewers for this important consideration. Indeed, track visualization is crucial as it can be used both to (1) perform quality controls and spot several kinds of biases and (2) refine data analysis, for instance using track segmentation and we discuss both below.</p><p>Quality controls (1): visual inspection of the output of the tracking algorithm is indeed crucial, and can be used to detect biases such as tracking errors or issues with a detection threshold. In that case, such visual inspection is much more useful when trajectories and raw images can be overlayed. To draw the full potential of such approach, one would need to upload the raw data to Spot-On, in addition to the tracked data.</p><p>Although tracked datasets (trajectories) are easily amenable to online processing (a typical SPT tracking file has a size of the order of a few MB), raw images often weigh several GB, making their interactive processing more challenging. For this reason, we do not believe such an option will work for a web-based platform like Spot-On.</p><p>Conversely, several imageJ/Fiji plugins are capable of interactive display of raw images and trajectories. In our opinion, one of the most mature Fiji plugins is TrackMate (Tinevez et al., Methods, 2017). TrackMate can save/reopen tracking files that contain a full description of the tracking parameters, allowing for a careful inspection of the raw movies and overlaid trajectories.</p><p>In order to facilitate the integration between a track-visualization software (TrackMate) and a SPT analysis tool (Spot-On), we developed a “TrackMate to Spot-On connector” (available at: https://gitlab.com/tjian-darzacq-lab/Spot-On-TrackMate). This plugin adds an extra menu to TrackMate that allows a one-click upload of a dataset to Spot-On. Thus, a manually inspected file can automatically be uploaded to Spot-On.</p><p>We now mention this tool: “Spot-On does not directly analyze raw microscopy images, since a large number of localization and tracking algorithms exist that convert microscopy images into single-molecule trajectories (for a comparison of particle tracking methods, see (Chenouard et al., 2014); moreover, Spot-On can be interfaced with TrackMate (Tinevez et al., 2017), which allows inspection of trajectories before uploading to Spot-On).” Finally, we acknowledge that this approach restricts the inspection of trajectories to the ones tracked using the TrackMate software, and that a tool accepting a wider range of file formats would be desirable. Our group is currently pursuing efforts in that direction, but this is a longer-term project that is not within the scope of this paper.</p><p>Track segmentation/classification (2): even though Spot-On can infer diffusion constants and relative fraction of several subpopulations, it does not perform single-trajectory classification. Indeed, this latter problem is significantly harder, or even impossible, depending on the length of the track to classify (see for instance Michalet and Berglund, 2012), and several recently developed approaches already deal with this problem (Persson et al. 2013, Monnier et al., 2015), mostly relying on hidden Markov models (HMMs). Furthermore, since trajectories derived from 3D-diffusing factors entering and exiting the focal plane are inherently short, only a very small fraction of them are actually amenable to single-trajectory inference. Therefore, while we agree that assigning trajectories into particular subcategories (e.g. immobile vs. mobile) is interesting, since HMM-based approaches already exist, we feel that adding this functionality is outside the scope of this paper.</p><p>In summary, we thank the reviewers for the suggestion and have implemented a one-click open-source connector between TrackMate and Spot-On that makes visualizing the trajectories before uploading them to Spot-On easy and intuitive.</p><disp-quote content-type="editor-comment"><p>5) i) <xref ref-type="fig" rid="fig4">Figure 4K</xref> and subsection “Effect of motion-blur bias on parameter estimates”, first paragraph: Why is there is a small but significant difference between PA-JF<sub>549</sub> and PA-JF<sub>646</sub>?</p></disp-quote><p>This is a good point and we have noticed this as well. For proteins with a significant bound fraction (i.e. &gt;25%), we find that both PA-JF<sub>549</sub> and PA-JF<sub>646</sub> give identical results. However, we find that for proteins with a negligible bound fraction (e.g. Halo-3xNLS or Halo-CTCF without the DNA binding domain), PA-JF<sub>646</sub> has a “bound fraction floor” of about 10-15% which it cannot go below, whereas PA-JF<sub>549</sub> appears to be able to capture the dynamics of all proteins and we have observed bound fractions &lt;5% for PA-JF<sub>549</sub>. We believe this is the reason for the difference and we are pretty confident in this effect: it has been highly reproducible in both U2OS and mES cells and we have observed it for several different proteins. We do not have a clear explanation for this, however; one possibility is that JF<sub>646</sub> and its conjugates are a little more hydrophobic due to the extra methyl groups in the Si-rhodamine structure. This effect is unlikely to be a case of tracking “free dye ligand”, since JF<sub>646</sub> shows negligible photoactivation unless bound to the HaloTag (see Grimm 2016) and since small dyes like JF<sub>549/646</sub> are expected to have diffusion constants ~250 um2/s and thus are unlikely to be trackable. Since we do not have a clear explanation of this effect, we prefer not to speculate in the manuscript, but we now state that JF<sub>549</sub> appears to be more reliable for SPT (which could be helpful to know for other labs) and specifically write that “Similar results were obtained for both dyes for proteins with a significant bound fraction, but we note that JF<sub>549</sub> appears to better capture the dynamics of proteins with a minimal bound fraction such as Halo-3xNLS (<xref ref-type="fig" rid="fig4">Figure 4J-K</xref>)”.</p><disp-quote content-type="editor-comment"><p>ii) Subsection “Validation of Spot-On using spaSPT data at different frame rates”: The axial detection range should be specified (around 700 nm?).</p></disp-quote><p>Yes, we agree and have updated the sentence. Thanks for pointing this out.</p><disp-quote content-type="editor-comment"><p>iii) Abbreviations CDF and PDF may need to be introduced in the main text as well, not only the figure legend.</p></disp-quote><p>Yes, this is another good point. We now added this to the Discussion around <xref ref-type="fig" rid="fig3">Figure 3C</xref> and state that: “Note that although we show the fits to the probability density function since this is more intuitive (PDF; histogram), we performed the fitting to the cumulative distribution function (CDF).”</p><disp-quote content-type="editor-comment"><p>iv) <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref> legend – last paragraph: Does the &quot;total bound fraction of ~60-65%&quot; refer to Halo-Sox2? Please specify.</p></disp-quote><p>Thanks for catching this error. The reviewer is correct; it referred to Halo-<italic>Sox2</italic> and we have now corrected this.</p></body></sub-article></article>