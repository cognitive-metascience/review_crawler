<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">39733</article-id><article-id pub-id-type="doi">10.7554/eLife.39733</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Metabolic network percolation quantifies biosynthetic capabilities across the human oral microbiome</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-117884"><name><surname>Bernstein</surname><given-names>David B</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6091-4021</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-117885"><name><surname>Dewhirst</surname><given-names>Floyd E</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-27316"><name><surname>Segrè</surname><given-names>Daniel</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4859-1914</contrib-id><email>dsegre@bu.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund7"/><xref ref-type="other" rid="fund8"/><xref ref-type="other" rid="fund9"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Biomedical Engineering</institution><institution>Boston University</institution><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Biological Design Center</institution><institution>Boston University</institution><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>The Forsyth Institute</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution>Harvard School of Dental Medicine</institution><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Bioinformatics Program</institution><institution>Boston University</institution><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff><aff id="aff6"><label>6</label><institution content-type="dept">Department of Biology</institution><institution>Boston University</institution><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff><aff id="aff7"><label>7</label><institution content-type="dept">Department of Physics</institution><institution>Boston University</institution><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Shou</surname><given-names>Wenying</given-names></name><role>Reviewing Editor</role><aff><institution>Fred Hutchinson Cancer Research Center</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Barkai</surname><given-names>Naama</given-names></name><role>Senior Editor</role><aff><institution>Weizmann Institute of Science</institution><country>Israel</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>13</day><month>06</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e39733</elocation-id><history><date date-type="received" iso-8601-date="2018-07-05"><day>05</day><month>07</month><year>2018</year></date><date date-type="accepted" iso-8601-date="2019-06-13"><day>13</day><month>06</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Bernstein et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Bernstein et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-39733-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.39733.001</object-id><p>The biosynthetic capabilities of microbes underlie their growth and interactions, playing a prominent role in microbial community structure. For large, diverse microbial communities, prediction of these capabilities is limited by uncertainty about metabolic functions and environmental conditions. To address this challenge, we propose a probabilistic method, inspired by percolation theory, to computationally quantify how robustly a genome-derived metabolic network produces a given set of metabolites under an ensemble of variable environments. We used this method to compile an atlas of predicted biosynthetic capabilities for 97 metabolites across 456 human oral microbes. This atlas captures taxonomically-related trends in biomass composition, and makes it possible to estimate inter-microbial metabolic distances that correlate with microbial co-occurrences. We also found a distinct cluster of fastidious/uncultivated taxa, including several <italic>Saccharibacteria</italic> (TM7) species, characterized by their abundant metabolic deficiencies. By embracing uncertainty, our approach can be broadly applied to understanding metabolic interactions in complex microbial ecosystems.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>oral microbial flora</kwd><kwd>human microbiome</kwd><kwd>oral prokaryotes</kwd><kwd>Saccharibacteria (TM7)</kwd><kwd>uncultivated bacteria</kwd><kwd>metabolic modeling</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000072</institution-id><institution>National Institute of Dental and Craniofacial Research</institution></institution-wrap></funding-source><award-id>R37DE016937</award-id><principal-award-recipient><name><surname>Dewhirst</surname><given-names>Floyd E</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R01GM121950</award-id><principal-award-recipient><name><surname>Segrè</surname><given-names>Daniel</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000185</institution-id><institution>Defense Advanced Research Projects Agency</institution></institution-wrap></funding-source><award-id>HR0011-15-C-0091</award-id><principal-award-recipient><name><surname>Segrè</surname><given-names>Daniel</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100006206</institution-id><institution>Biological and Environmental Research</institution></institution-wrap></funding-source><award-id>DE-SC0012627</award-id><principal-award-recipient><name><surname>Segrè</surname><given-names>Daniel</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000072</institution-id><institution>National Institute of Dental and Craniofacial Research</institution></institution-wrap></funding-source><award-id>R01DE024468</award-id><principal-award-recipient><name><surname>Dewhirst</surname><given-names>Floyd E</given-names></name><name><surname>Segrè</surname><given-names>Daniel</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>T32GM008764</award-id><principal-award-recipient><name><surname>Bernstein</surname><given-names>David B</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1457695</award-id><principal-award-recipient><name><surname>Segrè</surname><given-names>Daniel</given-names></name></principal-award-recipient></award-group><award-group id="fund8"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>NSFOCE-BSF 1635070</award-id><principal-award-recipient><name><surname>Segrè</surname><given-names>Daniel</given-names></name></principal-award-recipient></award-group><award-group id="fund9"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004412</institution-id><institution>Human Frontier Science Program</institution></institution-wrap></funding-source><award-id>RGP0020/2016</award-id><principal-award-recipient><name><surname>Segrè</surname><given-names>Daniel</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A novel metabolic network analysis method enables large-scale computational predictions of biosynthetic capabilities across the human oral microbiome, revealing a unique cluster of fastidious microorganisms and potential metabolic interdependencies.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Metabolism, in addition to enabling growth and homeostasis for individual microbes, contributes to the organization of complex, dynamic microbial communities. Within these communities, different microbes have diverse metabolic capabilities that lead to interactions driving microbial community structure and dynamics at multiple spatial and temporal scales (<xref ref-type="bibr" rid="bib93">Ponomarova and Patil, 2015</xref>; <xref ref-type="bibr" rid="bib90">Phelan et al., 2012</xref>; <xref ref-type="bibr" rid="bib113">Watrous et al., 2013</xref>; <xref ref-type="bibr" rid="bib47">Harcombe et al., 2014</xref>; <xref ref-type="bibr" rid="bib33">Embree et al., 2015</xref>). For example, through cross-feeding, a compound produced by one species might benefit another, leading to a network of metabolic interdependences (<xref ref-type="bibr" rid="bib33">Embree et al., 2015</xref>; <xref ref-type="bibr" rid="bib44">Goldford et al., 2017</xref>; <xref ref-type="bibr" rid="bib75">Mee et al., 2014</xref>; <xref ref-type="bibr" rid="bib88">Pande et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">D'Souza et al., 2018</xref>; <xref ref-type="bibr" rid="bib121">Zengler and Zaramela, 2018</xref>; <xref ref-type="bibr" rid="bib87">Pacheco et al., 2019</xref>; <xref ref-type="bibr" rid="bib76">Mee and Wang, 2012</xref>). This type of interaction has been proposed as one of the main reasons for the prevalence, in natural microbial communities, of uncultivated (or fastidious) microbes (<xref ref-type="bibr" rid="bib106">Stewart, 2012</xref>; <xref ref-type="bibr" rid="bib36">Epstein, 2013</xref>; <xref ref-type="bibr" rid="bib89">Pande and Kost, 2017</xref>; <xref ref-type="bibr" rid="bib105">Staley and Konopka, 1985</xref>). These microbes do not grow in pure culture on standard laboratory conditions as they may depend on diffusible metabolites produced by neighboring microbes (<xref ref-type="bibr" rid="bib89">Pande and Kost, 2017</xref>). The prominence of uncultivated/fastidious microbial organisms across the tree of life and their potential importance in microbial community structure is highlighted by the recent identification of the candidate phyla radiation – a large branch of the tree of life consisting mainly of uncultivated organisms with small genomes and unique metabolic properties (<xref ref-type="bibr" rid="bib55">Kantor et al., 2013</xref>; <xref ref-type="bibr" rid="bib18">Brown et al., 2015</xref>; <xref ref-type="bibr" rid="bib51">Hug et al., 2016</xref>). Efforts towards understanding this important component of microbial communities require further knowledge of metabolic interdependencies driven by biosynthetic deficiencies.</p><p>Some of the most promising strides in understanding metabolic interdependences between microbes have been taken in the study of the human oral microbiome. The human oral microbiome serves as an excellent model system for microbial communities research, due to its importance for human health and ease of access for researchers (<xref ref-type="bibr" rid="bib31">Dewhirst et al., 2010</xref>; <xref ref-type="bibr" rid="bib112">Wade, 2013</xref>). For example, the order of colonization of species in dental plaque has been characterized physically (<xref ref-type="bibr" rid="bib58">Kolenbrander et al., 2010</xref>) and metabolically (<xref ref-type="bibr" rid="bib73">Mazumdar et al., 2013</xref>), and visualized microscopically (<xref ref-type="bibr" rid="bib71">Mark Welch et al., 2016</xref>). The human oral microbiome consists of roughly 700 different microbial species, identified by 16S rRNA microbiome sequencing and cataloged in the human oral microbiome database (<xref ref-type="bibr" rid="bib31">Dewhirst et al., 2010</xref>; <xref ref-type="bibr" rid="bib22">Chen et al., 2010</xref>). Importantly, 63% of species in the human oral microbiome have been sequenced, including several uncultivated and recently-cultivated strains implicated in oral health and disease (<xref ref-type="bibr" rid="bib60">Krishnan et al., 2017</xref>; <xref ref-type="bibr" rid="bib103">Siqueira Jr and Rôças, 2013</xref>). Exciting recent work has led to successful laboratory co-cultivation of at least three previously uncultivated organisms, the <italic>Saccharibacteria</italic> (TM7) phylum taxa: <italic>Saccharibacteria</italic> bacterium HMT-952 strain TM7x (<xref ref-type="bibr" rid="bib9">Bedree et al., 2018</xref>; <xref ref-type="bibr" rid="bib48">He et al., 2015</xref>; <xref ref-type="bibr" rid="bib13">Bor et al., 2016</xref>; <xref ref-type="bibr" rid="bib14">Bor et al., 2018</xref>), <italic>Saccharibacteria</italic> bacterium HMT-488 strain AC001 (<xref ref-type="bibr" rid="bib25">Collins et al., 2019a</xref>), and <italic>Saccharibacteria</italic> bacterium HMT-955 strain PM004 (<xref ref-type="bibr" rid="bib26">Collins et al., 2019b</xref>). <italic>Saccharibacteria</italic> are prominent in the oral cavity and relevant for periodontal disease (<xref ref-type="bibr" rid="bib17">Brinig et al., 2003</xref>; <xref ref-type="bibr" rid="bib85">Ouverney et al., 2003</xref>). Due to their importance, they were among the first uncultivated organisms from the oral microbiome to be fully sequenced via single-cell sequencing methods (<xref ref-type="bibr" rid="bib70">Marcy et al., 2007</xref>), and represent the first co-cultivated members of the candidate phyla radiation (<xref ref-type="bibr" rid="bib48">He et al., 2015</xref>). Thus, their metabolic and phenotypic properties are of great interest for oral health and microbiology in general.</p><p>In parallel to achieving laboratory growth of diverse and uncultivated bacteria, a major unresolved challenge is understanding the detailed metabolic mechanisms that may underlie their dependencies. Ideally, one would want to computationally predict, directly from the genome of an organism, its biosynthetic capabilities and deficiencies, so as to translate sequence information into mechanisms and community-level phenotypes (<xref ref-type="bibr" rid="bib115">Widder et al., 2016</xref>). A number of approaches, based on computational analyses of metabolic networks, have contributed significant progress towards this goal (<xref ref-type="bibr" rid="bib100">Schuster et al., 2000</xref>; <xref ref-type="bibr" rid="bib79">Oberhardt et al., 2009</xref>; <xref ref-type="bibr" rid="bib65">Lewis et al., 2012</xref>). At the heart of these methods are metabolic network reconstructions, formal encodings of the stoichiometry of all metabolic reactions in an organism, that are readily amenable to multiple types of in silico analyses and simulations (<xref ref-type="bibr" rid="bib37">Feist et al., 2009</xref>). Recent exciting progress has led to the automated generation of ‘draft’ metabolic network reconstructions for any organism with a sequenced genome (<xref ref-type="bibr" rid="bib50">Henry et al., 2010</xref>), opening the door for the quantitative study of large and diverse microbial communities. The most commonly used metabolic network analysis methods – flux balance analysis (FBA) (<xref ref-type="bibr" rid="bib82">Orth et al., 2010a</xref>) and its dynamic version (dFBA) (<xref ref-type="bibr" rid="bib69">Mahadevan et al., 2002</xref>) – have been extensively applied to study microbial communities (<xref ref-type="bibr" rid="bib47">Harcombe et al., 2014</xref>; <xref ref-type="bibr" rid="bib33">Embree et al., 2015</xref>; <xref ref-type="bibr" rid="bib87">Pacheco et al., 2019</xref>; <xref ref-type="bibr" rid="bib67">Magnúsdóttir et al., 2017</xref>; <xref ref-type="bibr" rid="bib68">Magnúsdóttir and Thiele, 2018</xref>; <xref ref-type="bibr" rid="bib119">Zarecki et al., 2014</xref>; <xref ref-type="bibr" rid="bib107">Stolyar et al., 2007</xref>; <xref ref-type="bibr" rid="bib57">Klitgord and Segrè, 2010</xref>; <xref ref-type="bibr" rid="bib41">Freilich et al., 2011</xref>; <xref ref-type="bibr" rid="bib120">Zelezniak et al., 2015</xref>; <xref ref-type="bibr" rid="bib28">Cook and Nielsen, 2017</xref>; <xref ref-type="bibr" rid="bib11">Biggs et al., 2015</xref>; <xref ref-type="bibr" rid="bib122">Zomorrodi and Segrè, 2016</xref>). However, FBA and dFBA are not easily applicable to automatically-generated draft metabolic networks due to gaps (missing or incorrect reactions) in the metabolic network, and are thus difficult to scale to large and diverse microbial communities. Methods for ‘gap-filling’ draft reconstructions can address this problem, and ensemble methods potentially present a promising approach (<xref ref-type="bibr" rid="bib12">Biggs and Papin, 2017</xref>; <xref ref-type="bibr" rid="bib66">Machado et al., 2018</xref>). However, any gap-filling comes at the expense of an increased risk for false positive predictions. Additionally, gap-filling typically requires specific knowledge or assumptions on the growth media composition – which are often difficult to obtain for diverse environmental isolates and by definition unknown for uncultivated organisms. Alternatively, topology-based metabolic network analysis methods, such as network expansion (<xref ref-type="bibr" rid="bib32">Ebenhöh et al., 2004</xref>) and NetSeed-based methods (<xref ref-type="bibr" rid="bib15">Borenstein et al., 2008</xref>), are less dependent on gap-filling and have been applied to the analysis of draft metabolic reconstructions. These methods have provided valuable large-scale insight into metabolic processes in microbial communities, including the biosynthetic potentials of organisms and metabolites (<xref ref-type="bibr" rid="bib7">Basler et al., 2008</xref>; <xref ref-type="bibr" rid="bib72">Matthäus et al., 2008</xref>), the chance of cooperation or competition between species (<xref ref-type="bibr" rid="bib21">Carr and Borenstein, 2012</xref>; <xref ref-type="bibr" rid="bib59">Kreimer et al., 2012</xref>; <xref ref-type="bibr" rid="bib63">Levy et al., 2015</xref>; <xref ref-type="bibr" rid="bib81">Opatovsky et al., 2018</xref>), and the relationship between organisms and environment (<xref ref-type="bibr" rid="bib15">Borenstein et al., 2008</xref>; <xref ref-type="bibr" rid="bib40">Freilich et al., 2009</xref>; <xref ref-type="bibr" rid="bib46">Handorf et al., 2008</xref>), for example in the human gut microbiome (<xref ref-type="bibr" rid="bib64">Levy and Borenstein, 2013</xref>). While all of these approaches are promising, an additional issue that continues to limit the use of metabolic network analysis for prediction of biosynthetic capabilities is the difficulty of generating these predictions when the chemical environment of the microbes is unknown. In complex microbial communities, such as the human microbiome, the exact chemical composition of the environment is difficult to estimate, due both to the molecular complexity of the environment itself, and to the likely prevalence of secretions, lysing and cross-feeding within the community. Thus, the capacity to provide metabolic predictions based on unelaborated genome annotation, and on limited knowledge about an organism’s growth environment remains an important open challenge.</p><p>Here we introduce a new method, which begins to address the above limitations, and provides a novel prediction of an organism’s biosynthetic capabilities. Our method applies a probabilistic approach to define and compute a metric that estimates which metabolites, such as biomass components, are robustly synthesized by a given metabolic network and which would likely need to be supplied from the environment/community. Discrepancies in these calculated estimates between organisms can be used to generate hypotheses regarding microbial auxotrophy and metabolic exchange in microbial communities. Importantly, our metric has the capacity to estimate biosynthetic capabilities in spite of uncertainty about environmental conditions by randomly sampling many different possible nutrient combinations. In this study, we first demonstrated our method on <italic>E. coli</italic> to clarify its performance and interpretation. Next, we applied our method to a large number of organisms from the human oral microbiome, and predicted broad trends in biosynthetic capabilities associated with taxonomy and microbial co-occurrence. We further focused our analysis on uncultivated microorganisms, including three recently co-cultivated <italic>Saccharibacteria</italic> (TM7) strains. In addition to highlighting their biosynthetic deficiencies, we developed specific hypotheses for their metabolic exchange with growth-supporting partner microbes.</p><sec id="s1-1"><title>Analysis method</title><p>Our newly developed method quantifies the robustness with which a given metabolic network can produce a given metabolite from variable metabolic precursors. In essence, we quantify a metabolic network specific metric for metabolite producibility by probabilistically sampling sets of possible environments. While the probabilistic sampling can be adjusted to reflect a specific environment, its power lies largely in the capacity to explicitly incorporate in a statistical way the lack of knowledge about environmental composition.</p><p>The inspiration for this method comes from the statistical physics concept of percolation. Percolation theory has been applied in a wide range of fields, including the study of cascading metabolic failure upon gene deletions in metabolism (<xref ref-type="bibr" rid="bib104">Smart et al., 2008</xref>; <xref ref-type="bibr" rid="bib6">Barabási, 2015</xref>). In percolation theory the robustness of a network can be characterized by randomly adding or removing components (nodes or edges) of a network and assessing network connectivity (<xref ref-type="bibr" rid="bib6">Barabási, 2015</xref>). The smaller the number of components that need to be randomly added to the network before it becomes connected, the more robust it is to perturbations. We utilized this concept to characterize the network robustness of a particular metabolic network towards producing a specified target metabolite by randomly adding input metabolites to the network and assessing the network’s ability to produce the target.</p><p>To implement our method, we first introduced a probabilistic framework for analyzing metabolic networks (<xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). In this framework, every metabolite can be considered to be drawn from a Bernoulli distribution, i.e. present in the network with a given input probability (<italic>P<sub>in</sub></italic>). These probabilities could represent beliefs about the environment, chances of metabolites being available from a host organism, or any arbitrary prior assumption on metabolite inputs. Throughout the majority of our analyses we have assigned <italic>P<sub>in</sub></italic> to be an identical value for all input metabolites. However, as illustrated in an example in our results section (<italic>Metabolite producibility in a protein vs. carbohydrate-enriched environment</italic>) this probabilistic framework can utilize <italic>P<sub>in</sub></italic> values that vary across metabolites. Following the assignment of <italic>P<sub>in</sub></italic>, the network structure is used to calculate the output probability (<italic>P<sub>out</sub></italic>) of some specified target metabolite. In practice, random sampling of probabilistically drawn input metabolite sets is used to calculate the probability of producing the target metabolite. For each random sample, a modified version of FBA (<xref ref-type="bibr" rid="bib82">Orth et al., 2010a</xref>) is used to assess the network's ability to produce the target metabolite (for a complete explanation of how FBA is implemented in this context, see methods section: Algorithm functions, <italic>feas</italic>).</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.39733.002</object-id><label>Figure 1.</label><caption><title>A probabilistic framework for calculating the producibility metric (PM).</title><p>(<bold>A</bold>) Random samples of input metabolites are added to the metabolic network with probability <italic>P<sub>in</sub></italic>. Samples are shown here with gray or red circles. Sampled input metabolites are then used to calculate if a specified target output metabolite can be produced or not. Here the solid red circled sample leads to production of the target metabolite while the dotted gray circled samples do not. The probability of producing the target output metabolite (<italic>P<sub>out</sub></italic>) is calculated by taking many random samples at a specified <italic>P<sub>in</sub></italic>. (<bold>B</bold>) A producibility curve is calculated which represents <italic>P<sub>out</sub></italic> as function of <italic>P<sub>in</sub></italic>. Points along this curve are sampled by assigning the <italic>P<sub>in</sub></italic> value and estimating <italic>P<sub>out</sub></italic>. The <italic>P<sub>in</sub></italic> value at which <italic>P<sub>out</sub></italic> = 0.5 (<italic>P<sub>in,0.5</sub></italic>) is used to define the producibility metric (PM) as PM = 1-<italic>P<sub>in</sub><sub>,0.5</sub></italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39733.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Probabilistic framework simple example.</title><p>(<bold>A</bold>) Input probabilities (<italic>P<sub>in</sub></italic>) are assigned to each input metabolite to designate the probability of adding that metabolite to the network. Random sets of input metabolites are sampled, based on <italic>P<sub>in</sub></italic>, and a modified version of flux balance analysis is used to determine if the network can produce a specified target output metabolite for each random sample. Many random samples are taken to estimate the output probability (<italic>P<sub>out</sub></italic>) of the target output metabolite. Three examples of <italic>P<sub>in</sub></italic> values and the corresponding <italic>P<sub>out</sub></italic> values are shown for a very simple network with three reactions, four input metabolites and one target metabolite. For this simple example, the output probabilities can be calculated using the probabilistic equation <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>∗</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>. For more information on this theoretical calculation please refer to <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>. (<bold>B</bold>) A producibility curve is calculated which represents <italic>P<sub>out</sub></italic> as a function of <italic>P<sub>in</sub></italic>. Points along this curve are sampled by assigning the <italic>P<sub>in</sub></italic> value and estimating <italic>P<sub>out</sub></italic>. The three examples from A are shown in red on the curve in B. The PM is equal to one minus the value of <italic>P<sub>in</sub></italic> at which <italic>P<sub>out</sub></italic> equals 0.5 (<italic>P<sub>in,0.5</sub></italic>), such that increasing PM correspond to increasing producibility. In our implementation the PM for a particular metabolic network and metabolite is calculated efficiently using a non-linear fitting algorithm to find <italic>P<sub>in,0.5</sub></italic>. For further details on our exact implementation see the methods section “Algorithm functions: <italic>calc_PM_fit_nonlin</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39733.004</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Theoretical properties of the producibility curve.</title><p>Theoretically, our method is closely related to the minimal precursor sets of a metabolic network. The minimal precursor sets describe all minimal subsets of metabolites that can be used to synthesize a particular metabolite or set of metabolites. A combinatorial formula was developed to calculate the value of <italic>P<sub>out</sub></italic> from the set of minimal precursor sets (S) and the value of <italic>P<sub>in</sub></italic>. Using this formula, an exact producibility curve can be plotted and theoretical values of the producibility metric (PM) can be calculated. This calculation is shown for increasingly complicated and general minimal precursor set structures. (<bold>A</bold>) In the simplest case, a single metabolite serves as the minimal precursor set for the target. This leads to a straight line producibility curve (<italic>P<sub>out</sub></italic> = <italic>P<sub>in</sub></italic>) and an expected PM value of 0.5. (<bold>B</bold>) If the target metabolite can be produced from one minimal precursor set of size m <italic>P<sub>out</sub></italic> is equal to <italic>P<sub>in</sub></italic> raised to the power of m due to the assumption that all metabolites are added independently. As m increases the producibility curve bows outward towards <italic>P<sub>in</sub></italic> = 1, and the PM decreases below 0.5. (<bold>C</bold>) If the target metabolite can be produced from n different minimal precursor sets of size 1 <italic>P<sub>out</sub></italic> can be defined based on the probabilistic rule for an or relationship, or it can be represented with a combinatorial formula. <inline-formula><mml:math id="inf2"><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></inline-formula> represents the binomial coefficients for n choose i. As n increases the producibility curve bows inward towards <italic>P<sub>in</sub></italic> = 0, and the PM increases above 0.5. (<bold>D</bold>) In the most general case, minimal precursor sets can be overlapping and any size/number. The producibility curve and PM vary depending on these properties. A combinatorial formula can be used to represent this general case. <inline-formula><mml:math id="inf3"><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is the cardinality of the set of minimal precursor sets (the total number of minimal precursor sets). <inline-formula><mml:math id="inf4"><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mrow><mml:msubsup><mml:mo>⋃</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula> is the cardinality of the union of the minimal precursor sets being enumerated by the recursive sum (the number of unique metabolites in the combination of minimal precursor sets being enumerated). The recursive sum over <italic>j<sub>i</sub></italic> enumerates all possible combinations of <italic>i</italic> minimal precursor sets by summing over the indices <italic>j<sub>i</sub></italic> where <italic>j<sub>i</sub></italic> is between <italic>j<sub>i-1</sub></italic> and <inline-formula><mml:math id="inf5"><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, thus enumerating binomial combinations. The outer sum implements the inclusion exclusion principle.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig1-figsupp2-v2.tif"/></fig></fig-group><p>Using the above probabilistic framework, we defined a novel metric quantifying biosynthetic capabilities, the producibility metric (PM) (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). The PM is calculated as follows: First, a producibility curve describing <italic>P<sub>out</sub></italic> as a function of <italic>P<sub>in</sub></italic> is generated for a given metabolic network and metabolite target. This curve can be estimated by sampling input metabolites for different values of <italic>P<sub>in</sub></italic> (between 0 and 1), and calculating <italic>P<sub>out</sub></italic>. Next, we calculated the <italic>P<sub>in</sub></italic> value along the producibility curve at which <italic>P<sub>out</sub></italic> is equal to 0.5 (<italic>P<sub>in,0.5</sub>,</italic> analogous to the <italic>K<sub>m</sub></italic> in the Michaelis-Menten curve). Finally, PM is defined as PM = 1-<italic>P<sub>in</sub><sub>,0.5</sub></italic>, such that larger PM values correspond to increased robustness. Our method calculates PM efficiently by random sampling and a nonlinear fitting algorithm (for details, see methods section: Algorithm functions <italic>calc_PM_fit_nonlin</italic>). In addition to calculating PM computationally for arbitrary metabolic networks and metabolites, we also derived a way to calculate PM analytically using combinatorial equations. The combinatorial equations are built up from simple scenarios to the most general in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>. This analytical result, verified in detail for one specific pathway (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>) clarifies the connection between our metric and the concept of minimal precursor sets (<xref ref-type="bibr" rid="bib3">Andrade et al., 2016</xref>). It describes mathematically how the PM captures the multiplicity of routes through which a given target metabolite can be produced, and could serve as the basis for further theoretical work on the fundamental properties of metabolic networks.</p><p>The algorithms used to implement our method are written in MATLAB and designed as a set of modular functions that interface with the COBRA toolbox – a popular metabolic modeling software compendium (<xref ref-type="bibr" rid="bib97">Schellenberger et al., 2011</xref>; <xref ref-type="bibr" rid="bib49">Heirendt et al., 2019</xref>). The methodology behind each function is further explained in the methods section. The code is freely available online at <ext-link ext-link-type="uri" xlink:href="https://github.com/segrelab/biosynthetic_network_robustness">https://github.com/segrelab/biosynthetic_network_robustness</ext-link> (<xref ref-type="bibr" rid="bib10">Bernstein, 2019</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/biosynthetic_network_robustness">https://github.com/elifesciences-publications/biosynthetic_network_robustness</ext-link>).</p></sec></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Using the <italic>E. coli</italic> core metabolic network to demonstrate features of metabolite producibility</title><p>Before applying our approach to the systematic study of genome-scale metabolic networks from the human oral microbiome, we used the model organism <italic>E. coli</italic> to illustrate the performance and interpretation of our method. We started with the <italic>E. coli</italic> core metabolic network, a simplified network consisting of central carbon metabolism and lacking peripheral metabolic pathways, such as amino acid or cofactor biosynthesis (<xref ref-type="bibr" rid="bib83">Orth et al., 2010b</xref>). We calculated the PM for all intracellular metabolites in this network using a uniform ensemble of environments (as described in the methods). The results are shown in <xref ref-type="fig" rid="fig2">Figure 2A</xref>, overlaid on the <italic>E. coli</italic> core metabolic network itself, with each node’s color indicating its PM value and node size indicating its degree of connectivity. Consistent with the high connectivity of the <italic>E. coli</italic> core metabolic network, most metabolites have high PM values (PM &gt;0.950). For example, the metabolites H<sup>+</sup> and pyruvate are both highly connected in the metabolic network and have high PM (PM = 0.968 and 0.952 respectively). However, the network also contains several metabolites that are well connected, but have lower PM values. These include, for example, the cofactors AMP/ADP/ATP and NAD<sup>+</sup>/NADH, which have PM values of ~0.7 and ~0.5 respectively, because they can be produced from each other, but not biosynthesized in this network. The network also includes several examples of metabolites that are poorly connected but have high PM values. One example is D-lactate, which is produced only via Lactate Dehydrogenase from the high PM metabolites Pyruvate and H<sup>+</sup> (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). This reaction also consumes NADH and produces NAD<sup>+</sup> but because these cofactors can be easily recycled from each other by a large number of different reactions, their relatively low PM (as described above) has minimal influence on the PM value of D-lactate (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). This example demonstrates the fact that our metric captures metabolites which are easily produced because their precursors are easily produced, and that the PM of recycled cofactors has minimal influence on the PM of a target metabolite. Overall, there is also no significant correlation between the PM values and the node degree of a metabolite in the network (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>), indicating that our metric describes a more complex property of a metabolite in a network that is not captured simply by node degree.</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.39733.005</object-id><label>Figure 2.</label><caption><title><italic>E. coli</italic> core metabolic network metabolite producibility.</title><p>(<bold>A</bold>) The <italic>E. coli</italic> core metabolic network is represented as a bipartite graph with metabolites shown as circles and reactions shown as squares. Reactions shown with a black border are irreversible in the model, those with no border are reversible. All intracellular metabolites are colored based on their PM value (low – blue, high – red). Reactions and metabolite nodes are sized based on their total node degree. Several key metabolites of interest are highlighted with their corresponding PM values shown. Central metabolites such as H<sup>+</sup> and Pyruvate have high degree and high PM. Cofactors such as AMP/ADP/ATP and NAD<sup>+</sup>/NADH have high degree but low PM, as they cannot be synthesized in this network. Oxygen is an example of a PM=0 metabolite that cannot be produced from any other metabolites in this network. D-lactate is an example of a metabolite with low degree and high PM that is it is easily produced but not well-connected. (<bold>B</bold>) The lactate dehydrogenase reaction producing D-Lactate is shown as an example to illustrate that poorly connected metabolites can display a high PM, and how recycled cofactors have minimal impact on PM values. Lactate dehydrogenase produces D-lactate and NAD<sup>+</sup> from pyruvate, H<sup>+</sup> and NADH. The metabolite D-lactate has high PM despite being produced only by this one reaction in the metabolic network because it can be produced from the high PM metabolites pyruvate and H<sup>+</sup>, which are themselves produced from a large number of possible precursors. Although NADH is also used to produce D-lactate, and has a relatively low PM in this core model, it has minimal impact on the PM of D-lactate as NADH can be recycled from NAD<sup>+</sup> by a large number of reactions (represented by the arrows at the bottom of the figure) and thus production of NADH is not necessary for the production of D-lactate.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39733.006</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Node degree and producibility metric do not correlate for <italic>E. coli</italic> core metabolic network intracellular metabolites.</title><p>Different forms of the node degree (ND) are plotted against the producibility metric (PM) for all intracellular metabolites in the <italic>E. coli</italic> core network. No correlation (Spearman’s rank correlation) is observed between the PM and any form of node degree. (<bold>A</bold>) The in node degree (ND in) is the sum of the number of reactions producing the metabolite. (<bold>B</bold>) The out node degree (ND out) is the sum of the number of reactions consuming the metabolite. (<bold>C</bold>) The total node degree (ND total) is the sum of the in and out node degrees. (<bold>D</bold>) The total degree without double counting reversible reactions (ND total no Rev) is the total node degree when counting reversible reactions only once.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39733.007</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Producibility analysis of the histidine biosynthetic pathway.</title><p>(<bold>A</bold>) A network representation of the histidine biosynthetic pathway is shown. Reactions are represented as squares, histidine is shown as a red circle, main intermediate metabolites are shown as black circles, cofactors metabolites are shown as gray circles. Different histidine auxotrophs were generated by removing reactions at increasing distance from histidine in the <italic>E. coli</italic> iJO1366 metabolic network. (<bold>B</bold>) The producibility metric (PM) for histidine was calculated for the different simulated <italic>E. coli</italic> auxotrophs (blue dots). The theoretical PM values, calculated using the formula from <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2C</xref> and assuming minimal precursor sets of size corresponding to the number of main intermediate metabolites that remain attached to histidine in a particular auxotroph are also plotted (black X’s). (<bold>C</bold>) The presence of the histidine biosynthetic pathway was measured across 456 different oral microbiome metabolic networks in two different ways: pathway sum – the total number of reactions from the pathway present in an organism’s metabolic network, and pathway length – the number of reactions in the pathway starting at histidine and counting until the first missing reaction. These two metrics were compared to the PM for histidine across oral microbiome organisms, both metrics were correlated with the PM for histidine with pathway length being more strongly correlated (pathway sum: spearman correlation = 0.79, p-value=8.5e-99; pathway length: spearman correlation = 0.88, p-value=3.6e-145).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig2-figsupp2-v2.tif"/></fig></fig-group></sec><sec id="s2-2"><title>Producibility of metabolites differs from pathway completeness and captures minimal precursor set structure</title><p>We next applied our method in detail to a specific biosynthetic pathway within a genome-scale model to demonstrate how our PM provides information that is richer than what can be learned from simply counting the percent of reactions present in a given biosynthetic pathway. Specifically, we analyzed the histidine biosynthetic pathway in the curated <italic>E. coli</italic> iJO1366 genome-scale metabolic network (<xref ref-type="bibr" rid="bib84">Orth et al., 2011</xref>), and checked how the two methods differ in their capacity to capture the effect of reaction knock-outs along the pathway (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). The PM is more sensitive than pathway completeness, as it captures features beyond the percent of reactions in the biosynthetic pathway. For different knockouts in the histidine biosynthetic pathway (which counts nine distinct reactions) the PM is related to the distance of the removed reaction from the target metabolite (histidine), whereas the completeness score would be the same (8 out of 9) for each auxotroph (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B</xref>). This same capacity of PM to capture finer details of the effect of missing reactions in a pathway is also confirmed by a similar analysis of histidine biosynthesis across all oral microbiome draft metabolic networks (oral microbiome network reconstruction and analysis described later in the manuscript) (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2C</xref>).</p><p>In general, in contrast with the percent completion of the biosynthetic pathway, the PM depends deeply on the pathway structure, ultimately capturing the number of different routes through which the target metabolite can be synthesized (also called the minimal precursor sets; <xref ref-type="bibr" rid="bib3">Andrade et al., 2016</xref>). This property stems intuitively from the way the PM is defined, and is explained precisely by our combinatorial theory (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). While our method’s computational estimate of the PM is based on sampling the space of possible precursor sets, the combinatorial theory provides an exact value for the producibility of a molecule with a given minimal precursor set structure. The close match between the sample-based PM and the combinatorial theory for the histidine biosynthetic pathway (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B</xref>) suggests that the PM indeed captures the complex multiplicity of avenues for producing a given metabolite.</p></sec><sec id="s2-3"><title>Producibility analysis shows improved tolerance to missing reactions compared to flux balance analysis</title><p>One of the challenges we wished to address with our method is the possibility of making robust inferences about the metabolic capabilities of different organisms in spite of missing reactions – a situation often encountered upon reconstructing metabolic networks from newly sequenced genomes. To assess the performance of our approach in this context, we compared it with flux balance analysis (FBA) calculations for a genome-scale metabolic networks with a given number of randomly removed reactions. In particular, we applied both FBA and our method to the <italic>E. coli</italic> iJO1366 genome-scale metabolic network, which we gradually perturbed by removing an increasing number of randomly chosen reactions. In this performance test, the unperturbed iJO1366 metabolic network was used as a ground truth against which the predictions of our method and FBA on perturbed metabolic networks were compared. <xref ref-type="fig" rid="fig3">Figure 3</xref> shows the accuracy of both FBA and the PM as a function of the percentage of reactions removed from the iJO1366 metabolic network. While the output of our method (the PM for any metabolite) is different from that of FBA (the flux through all reactions), one can use the PM values observed across all biomass components as a proxy for the growth capacity of an organism, providing a metric that is comparable with the FBA-predicted biomass production flux. The specific metrics used to compare the PM and FBA predictions for biomass production are described further in the <xref ref-type="fig" rid="fig3">Figure 3</xref> legend. One can see that both the FBA and the PM predictions become worse as the metabolic networks are further perturbed. However, the PM predictions are more tolerant to missing reactions than the FBA predictions. While the FBA production of biomass becomes infeasible for the majority of the perturbed metabolic networks after removing less than 1% of the reactions, the PM results remain fairly quantitatively accurate when removing up to 10% of the reactions. This analysis provides insight into the accuracy of our method for analyzing metabolic networks with gaps, such as draft (non-gap-filled) metabolic networks produced through automated reconstruction pipelines.</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.39733.008</object-id><label>Figure 3.</label><caption><title>The accuracy of flux balance analysis and the producibility metric for different perturbed <italic>E. coli</italic> genome-scale metabolic networks.</title><p>Reactions were randomly removed from the <italic>E. coli</italic> iJO1366 metabolic network generating 50 different networks at five different levels of reaction removal. These networks were then analyzed with the producibility metric (PM) and flux balance analysis (FBA) in a minimal and complete medium. The accuracy of the PM and FBA results were assessed through two different measures and plotted as a function of the number of reactions removed on a semi-log plot. (<bold>A</bold>) Quantitative difference accuracy – The accuracy was measured quantitatively based on the L1 norm of the difference between the original network metric and the randomly perturbed network metric. For FBA the L1 norm was computed as the absolute value of the difference between the biomass flux of the original network and the perturbed network. For the PM the L1 norm was calculated as the sum of the absolute value of the difference between each PM value. The L1 norm for both metrics was then normalized and subtracted from one to give a measure of accuracy. The mean of 50 different randomly perturbed networks at five different reaction removal levels is shown with dots connected by solid lines (FBA on minimal medium: Blue, FBA on complete medium: Red, PM: Purple). The standard error of the metric is shown as a shaded region around the line. (<bold>B</bold>) Biomass production accuracy – The accuracy was measured by the fraction of randomly perturbed metabolic networks that were capable of producing biomass. For FBA this was calculated as the fraction of networks capable of producing biomass flux above 1% of the unperturbed biomass flux (FBA on minimal medium: Blue, FBA on complete medium: Red). For the PM, the biomass production accuracy was calculated as the fraction of networks capable of producing all biomass components above a specified PM threshold. The threshold was either PM &gt;0.1 (solid purple) or PM &gt;0.6 (dashed purple).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39733.009</object-id><label>Figure 3—figure supplement 1.</label><caption><title><italic>E.</italic> coli auxotroph co-cultures metabolite producibility.</title><p>(<bold>A</bold>) The producibility metric (PM) was calculated for all essential biomass metabolites for different <italic>E. coli</italic> auxotrophs that were co-cultured in <xref ref-type="bibr" rid="bib116">Wintermute and Silver (2010)</xref>. Auxotrophs were simulated from the <italic>E. coli</italic> iJO1366 metabolic network. The genes removed in the auxotroph are labeled along the rows. The metabolites are labeled along the columns. Auxotroph PM vectors were clustered hierarchical using average distances between clusters. The overall distance between auxotroph PM values was positively correlated with synergistic growth from <xref ref-type="bibr" rid="bib116">Wintermute and Silver (2010)</xref> (Mantel test: rho = 0.1919, p-value=0.0181). (<bold>B</bold>) The amino acid PM values are extracted and sorted to demonstrate the reduced PM of amino acids with knock-outs in their pathway. Auxotrophs are shown on the row labels, grouped by the amino acid pathway of the auxotroph. Amino acids are shown on the column labels ordered in corresponding order to the auxotrophs. Trends are highlighted by colored outlines. Green outlines show auxotrophs within the same pathway that show corresponding decrease in PM for the associated amino acid. The blue outline shows a cross-pathway interaction where an auxotroph in the glutamine pathway causes a decrease in histidine PM. The purple outline shows an auxotroph in the branched chain amino acid pathway that has decreased PM for branched chain amino acids, but increased synergistic growth with other auxotrophs of this pathway. (<bold>C</bold>) Co-culture growth data from Wintermute et al. is plotted for 28 amino acid auxotrophs (average of day 4 replicates 1 and 2 from supplemental information of <xref ref-type="bibr" rid="bib116">Wintermute and Silver, 2010</xref>). Trends are highlighted by colored outlines. Green outlines demonstrate auxotrophs in the same pathway that result in decreased synergistic growth. The blue outline illustrates an example of a cross-pathway interaction where an auxotroph in the glutamine pathway shows decreased synergistic growth with auxotrophs in the histidine pathway. The purple outline demonstrates an unexpected result where an auxotroph in the branched chain amino acid pathway shows increased synergistic growth with other auxtrophs in branched chain amino acid pathways. (<bold>D</bold>) The correlation between auxotrophs PM values and average synergistic growth across all partner auxotrophs was calculated. For the entire dataset, there was no significant correlation between average PM and average synergistic growth (Spearman’s ρ: −0.1671, p-value: 0.2662). However, for the specific example of knockouts in the tryptophan biosynthetic pathway, we observed a significant correlation between tryptophan PM and average synergistic growth (Spearman’s ρ: 1.000, p-value: 0.0167).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig3-figsupp1-v2.tif"/></fig></fig-group></sec><sec id="s2-4"><title>Metabolite producibility points to putative metabolic mechanisms for <italic>E. coli</italic> auxotroph co-cultures</title><p>As a first test of our approach in its capacity to provide metabolic insight about experimental measurements of inter-microbial interactions, we used the PM to estimate the capacity of different <italic>E. coli</italic> auxotrophs to compensate for each other’s metabolic limitations. In particular, we compared experimental data from co-cultures of <italic>E. coli</italic> auxotrophs from <xref ref-type="bibr" rid="bib116">Wintermute and Silver (2010)</xref> with corresponding PM calculations. After reconstructing in silico the specific auxotroph strains used in this work (based on the <italic>E. coli</italic> iJO1366 metabolic network), we calculated the PM for all essential biomass components in each auxotroph and compared the PM values to the experimentally measured synergistic growth of auxotroph pairs (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Different auxotrophs, clustered by PM, were seen to group based on the pathway of the removed gene, and auxotrophs with knockouts in different locations of the same biosynthetic pathway showed a graded decrease in PM for the corresponding biomass component, similar to what was seen in our histidine biosynthetic pathway analysis in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>. The overall distance between auxotroph PM values was positively correlated with synergistic growth, suggesting that auxotrophs with different biosynthetic capabilities could better support each other’s growth (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A</xref>). Several examples and counter-examples that further elaborate this trend are highlighted in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B and C</xref>. This analysis also gave us the opportunity to query in more depth the capacity of our approach to provide insight into whether auxotrophs with higher PM values may be more easily supplemented by partner auxotrophs. We did not detect a clear general signal on whether auxotrophs could rescue each other based on the average PM across all biomass components. However, for a specific instance, namely auxotrophs for tryptophan, we found a correlation between tryptophan PM and average synergistic growth with other auxotrophs (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1D</xref>), possibly suggesting that the PM captures the ease with which auxotrophs in this pathway can be supplemented by other auxotrophs. Overall, our method enables the comparison of model-based producibility predictions with experimental data on auxotrophic interdependencies. These predictions helped identify metabolic complementarity patterns, but did not fully capture all of the complexity of interactions between <italic>E. coli</italic> auxotrophs.</p></sec><sec id="s2-5"><title>Reconstruction of human oral microbiome metabolic networks</title><p>We next applied our method to the human oral microbiome, aiming at a mechanistic characterization of the biochemical capabilities of different microbes in this community based on metabolic networks reconstructed directly from their genomes. As a first step, we reconstructed metabolic networks for 456 different microbial strains representing a diverse set of human oral microbes whose annotated genomes were available from the Human Oral Microbiome Database. These organisms represent 371 different species, 124 genera, 64 families, 35 orders, 22 classes, and 12 phyla. Metadata related to the selected organisms can be found in <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>. Notably, the database includes several sequenced yet uncultivated or recently co-cultivated organisms. In particular, the following sequenced yet uncultivated, or recently co-cultivated, strains were included in our analysis: <italic>Saccharibacteria</italic> (TM7) bacterium HMT-952 strain TM7x (<xref ref-type="bibr" rid="bib48">He et al., 2015</xref>), <italic>Saccharibacteria</italic> (TM7) bacterium HMT-955 strain PM004 (<xref ref-type="bibr" rid="bib26">Collins et al., 2019b</xref>), <italic>Saccharibacteria</italic> (TM7) bacterium HMT-488 strain AC001 (<xref ref-type="bibr" rid="bib25">Collins et al., 2019a</xref>), <italic>Tannerella</italic> HMT-286 strain W11667 (<xref ref-type="bibr" rid="bib110">Vartoukian et al., 2016a</xref>), <italic>Anaerolineae</italic> (<italic>Chloroflexi</italic> phylum) bacterium HMT-439 strain Chl2 (<xref ref-type="bibr" rid="bib111">Vartoukian et al., 2016b</xref>), <italic>Absconditabacteria</italic> (SR1) bacterium HMT-874 strain MGEHA (<xref ref-type="bibr" rid="bib19">Campbell et al., 2013a</xref>), and <italic>Desulfobulbus</italic> HMT-041 strains Dsb2 and Dsb3 (<xref ref-type="bibr" rid="bib20">Campbell et al., 2013b</xref>). All of the selected genomes were used to reconstruct sequence-specific draft metabolic networks using the Department of Energy Systems Biology Knowledgebase (KBase) ‘build metabolic model’ app (<xref ref-type="bibr" rid="bib50">Henry et al., 2010</xref>; <xref ref-type="bibr" rid="bib4">Arkin et al., 2018</xref>; <xref ref-type="bibr" rid="bib86">Overbeek et al., 2014</xref>). The networks were reconstructed without any gap-filling. A KBase narrative containing the genomes and draft metabolic network reconstructions can be found at: <ext-link ext-link-type="uri" xlink:href="https://narrative.kbase.us/narrative/ws.27853.obj.935">https://narrative.kbase.us/narrative/ws.27853.obj.935</ext-link>. The complete collection of all network models is also available for download in MATLAB (.mat) format at <ext-link ext-link-type="uri" xlink:href="https://github.com/segrelab/biosynthetic_network_robustness">https://github.com/segrelab/biosynthetic_network_robustness</ext-link> (<xref ref-type="bibr" rid="bib10">Bernstein, 2019</xref>).</p></sec><sec id="s2-6"><title>Large-scale patterns in biosynthetic capabilities identified across the human oral microbiome</title><p>We analyzed the PM for 88 different biomass metabolites across the aforementioned 456 metabolic networks from the human oral microbiome. The 88 biomass metabolites included all biomass building blocks considered to be essential for either Gram-negative or Gram-positive biomass, as listed in the KBase build metabolic models app (<xref ref-type="bibr" rid="bib50">Henry et al., 2010</xref>; <xref ref-type="bibr" rid="bib4">Arkin et al., 2018</xref>; <xref ref-type="bibr" rid="bib86">Overbeek et al., 2014</xref>) (listed in <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>). Through this analysis we calculated 40,128 PM values which represent an atlas of predicted biosynthetic capabilities across these human oral microbiome organisms. The ensuing atlas is represented as a hierarchically clustered matrix of PM values for all 456 organisms and 88 metabolites in <xref ref-type="fig" rid="fig4">Figure 4</xref>. The same data are available in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> (clustered by taxonomy), and in <xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref>.</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.39733.010</object-id><label>Figure 4.</label><caption><title>Human oral microbiome organisms PM matrix.</title><p>The producibility metric (PM) was calculated for 456 different oral microbiome organisms (columns) and 88 different essential biomass metabolites (rows). The resulting matrix is hierarchically clustered based on average distances between organisms and metabolites PM values. Organism Gram-stain and phylum/class are indicated by several annotation columns at the top of the matrix. The biomass metabolites analyzed consisted of several different types of metabolites indicated with different colors. Several metabolites that showed interesting patterns across oral microbiome organisms are highlighted with roman numerals. The most distinct cluster of organisms, highlighted and annotated (top left), consisted of fastidious reduced-genome organisms (<italic>Mycoplasma</italic>, <italic>Treponema</italic>) and uncultivated or recently cultivated organisms (<italic>SR1, TM7, Desulfobulbus, Anaerolineae</italic>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39733.011</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Taxonomically ordered human oral microbiome organisms PM matrix.</title><p>The producibility metric (PM) was calculated for 456 different oral microbiome organisms (columns) and 88 different essential biomass metabolites (rows). The columns are arranged in taxonomic order based on phylum and class, and the rows are clustered hierarchically based on average distances between PM values.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39733.012</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Prediction of average producibility metric using genome size and taxonomic parameters.</title><p>(<bold>A</bold>) The average producibility metric (PM) across all biomass metabolites for each organism is correlated with the log of the genome size (log base 10 of base pairs) for each organism. A linear (blue) and quadratic (red) regression model are shown. (<bold>B, C</bold>) The fit is improved when adding nominal taxonomic parameters of varying resolution. The Akaike information criterion (AIC), and the Bayesian information criterion (BIC) are plotted to summarize the improvement in model performance as nominal taxonomic parameters are added on top of genome size to the regression model. A linear regression model is shown in blue and quadratic model in red. Improved fit is indicated by a decreased AIC or BIC value. The AIC tends to be biased towards overly complex models while the BIC has a larger penalty for additional parameters that biases it towards simpler models. The AIC improves up to the genus taxonomic level and the BIC improves up to the order level, indicating that the data can be additionally explained beyond genome size by taxonomic features.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig4-figsupp2-v2.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39733.013</object-id><label>Figure 4—figure supplement 3.</label><caption><title>Taxonomic parameters as predictors of metabolite specific producibility.</title><p>Regression modeling was used to determine which taxonomic parameters were associated strongly with the producibility metric (PM) values of specific metabolites. The log likelihood ratio between a quadratic regression model using the log of genome size as a predictor of metabolite specific PM values and a regression model with an additional binary taxonomic parameter is shown on the heatmap (large log likelihood ratio – black, small – white). The taxonomic parameters used were: Gram-stain (+or -), phylum (belong to 1 of 12 phyla or not), and class (belonging to 1 of 22 classes or not) (top). The most highly significant points are highlighted indicating if the group of organisms had increased (blue dots) or decreased (red x’s) PM values for that specified metabolite (log likelihood ratio test, alpha &lt;10<sup>−6</sup> with Bonferroni correction). The columns in the heat map are arranged in taxonomic order such that trends can be mapped with greater specificity. The rows in the heat map are arranged in the clustered order from <xref ref-type="fig" rid="fig4">Figure 4</xref>, and metabolites of interest are highlighted with roman numerals.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig4-figsupp3-v2.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39733.014</object-id><label>Figure 4—figure supplement 4.</label><caption><title>Producibility of different organic acids across human oral microbiome organisms.</title><p>The distribution of producibility metric (PM) values across all oral microbiome organisms is shown for nine different organic acids. Blue dots show a jitter plot of individual data points such that the distribution can be visualized. Red dot indicates the median value. The distribution of PM values for Butyrate is also shown for three different genera: <italic>Fusobacterium</italic> (F), <italic>Porphyromonas</italic> (Po), and <italic>Prevotella</italic> (Pr). Purple dots are individual data points, and the red dot indicates the median value.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig4-figsupp4-v2.tif"/></fig><fig id="fig4s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39733.015</object-id><label>Figure 4—figure supplement 5.</label><caption><title>Analysis of metabolite producibility change for a proteolytic organism (<italic>Porphyromonas gingivalis</italic>) and a saccharolytic organism (<italic>Streptococcus mutans</italic>) in a protein enriched environment.</title><p>The difference in producibility metric (PM) as the PM in a protein-enriched environment minus the PM in a random environtment is shown by the color in the plot above for a proteolytic organism (<italic>Porphyromonas gingivalis</italic> W83), and a saccharolytic organism (<italic>Streptococcus mutans</italic> UA 159). In contrast to the default PM calculations where all intracellular metabolites are added as input metabolites randomly (excluding the target metabolite), the PM was calculated in a protein-enriched environment by fixing all amino acids to always be present (<italic>P<sub>in</sub></italic> = 1) and then adding all intracellular metabolites randomly with increasing <italic>P<sub>in</sub></italic> (again excluding the target metabolite). The mean increase in PM in the protein-enriched environment for the proteolytic organism was 0.006 and the max was 0.173, the mean increase in PM for the saccharolytic organism was 0.004 and the max was 0.104. A similar analysis was done in a carbohydrate-enriched environement in which D-glucose was added with <italic>P<sub>in</sub></italic> = 1. In this case, only very small changes in the PM value of all metabolites for the proteolytic and saccharolytic organisms where observed. The mean increase in PM in the carbohydrate-enriched environment for the proteolytic organism was 0.000 and the max was 0.014, the mean increase in PM for the saccharolytic organism was 0.001 and the max was 0.026.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig4-figsupp5-v2.tif"/></fig><fig id="fig4s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39733.016</object-id><label>Figure 4—figure supplement 6.</label><caption><title>Correlations of various pairwise metabolic metrics.</title><p>We calculated a number of different pairwise metabolic metrics using our method, and others, across oral microbiome organisms (pairwise metabolic metrics are described in more detail in the methods section). The different metrics are shown plotted against each other and Spearman’s rank correlation and P-value are shown as calculated using a Mantel test with 1000 permutations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig4-figsupp6-v2.tif"/></fig><fig id="fig4s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39733.017</object-id><label>Figure 4—figure supplement 7.</label><caption><title>Comparison of PM complementarity vs Seed complementarity.</title><p>Two alternative complementarity metrics, PM complementarity and Seed complementarity, were compared to each other in further detail. Fastidious/uncultivated organisms are highlighted with different colors on the scatter plot showing complementarity scores from all oral microbiome organisms to those specified in the figure legend. Log-scale histograms display the distribution of complementarities for each method. The histograms show that the PM complementarity has a bi-modality that distinguishes between interactions involving fastidious/uncultivated organisms from those that do not, while the Seed complementarity does not display a similar distribution.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig4-figsupp7-v2.tif"/></fig></fig-group><p>The hierarchically clustered heat map (<xref ref-type="fig" rid="fig4">Figure 4</xref>) shows extensive variability in the PM values of different organisms and metabolites across the oral microbiome. There are three main large clusters of metabolites: one cluster with consistently high PM (top), one cluster with low PM (middle), and one cluster with variable PM (bottom). Different classes of metabolites cluster quite differently across this landscape. In addition to simple ubiquitous metabolites, such as H<sub>2</sub>O or glycine (<xref ref-type="fig" rid="fig4">Figure 4 I</xref>), all nucleotides have high PM across the oral microbiome organisms. Amino acids generally have high PM as well, with the notable exception of tryptophan (<xref ref-type="fig" rid="fig4">Figure 4 II</xref>). Interestingly, tryptophan is known to be a particularly difficult amino acid to synthesize (<xref ref-type="bibr" rid="bib1">Akashi and Gojobori, 2002</xref>). Metal ions generally had PM value of 0 across all organisms, serving as an expected negative control. Some exceptions, such as Mg<sup>2+</sup>, Co<sup>2+</sup>, Cl<sup>-</sup>, Fe<sup>3+</sup>, and Fe<sup>2+</sup>, can be explained based on their presence in larger compounds, such as porphyrins. For example, Co<sup>2+</sup> has increased PM values in a pattern that closely follows the PM values of the cobalt containing vitamin cobamamide (<xref ref-type="fig" rid="fig4">Figure 4 III</xref>).</p><p>Before analyzing in detail the patterns identifiable in the PM matrix of <xref ref-type="fig" rid="fig4">Figure 4</xref>, we showed that such patterns could not be simply attributed to the broad property of genome size – even if genome size is known to be an important predictor of the overall biosynthetic capabilities of an organism (<xref ref-type="bibr" rid="bib119">Zarecki et al., 2014</xref>). Fastidious or parasitic organisms tend to have reduced genomes and consequently reduced metabolic capabilities. In our data, the overall average PM value for each organism can be partially predicted by genome size. A linear regression model and quadratic regression model which used the log of genome size to predict the average PM value across all metabolites for each organism had R-squared values of 0.498 and 0.551 respectively (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2 A</xref>). The fit of this model was further improved by adding taxonomic information as additional parameters (see methods section for additional details on adding taxonomic information). We inferred this by using the Akaike information criterion (AIC) and Bayesian information criterion (BIC), two measures of model accuracy that include a penalty for added parameters to discourage over-fitting (<xref ref-type="bibr" rid="bib24">Clarke et al., 2009</xref>). The BIC has a stronger penalty for additional parameters and improved up to the order level, while the AIC improved up to the genus level (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2 B, C</xref>). These improvements in AIC and BIC indicate that our data contain additional structure that is described by taxonomy beyond simply genome size.</p></sec><sec id="s2-7"><title>Taxonomic trends capture biosynthetic patterns across human oral microbiome organisms</title><p>Many of the patterns in our large-scale analysis of the human oral microbiome PM matrix indicated taxonomic trends in the PM of different metabolites across organisms. While the clustering of the PM matrix was not entirely driven by taxonomy (<xref ref-type="fig" rid="fig4">Figure 4</xref>), we did see significant taxonomic trends in our data beyond what was explained simply be genome size (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). We further investigated, quantitatively, which specific phyla and orders were associated with specific PM trends by calculating the log likelihood ratio between a quadratic regression model predicting the PM values for a particular metabolite-based solely on genome size against one that incorporates a specific taxonomic parameter of interest (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). This allowed us to highlight metabolites with highly significant increased or decreased PM values in certain taxonomic groups, and to confirm patterns that we observed by eye in <xref ref-type="fig" rid="fig4">Figure 4</xref>. Numerous patterns and details of the PM matrix could be relevant for addressing specific biological questions or model refinement challenges. Here we focus in detail on two specific classes of compounds: (i) cell-wall and membrane components, which tend to vary broadly across organisms, and are important for antimicrobial susceptibility and immune system recognition; and (ii) amino acids and essential factors (e.g. vitamins), which could be relevant for understanding metabolic exchange among bacteria and with the host.</p><p>A first striking pattern in the PM matrix is the complexity of cell-wall and membrane components of different taxa. Some aspects of this pattern are consistent with standard attribution of metabolites associated with the Gram staining categories (estimated using the KBase build metabolic model app [<xref ref-type="bibr" rid="bib50">Henry et al., 2010</xref>; <xref ref-type="bibr" rid="bib4">Arkin et al., 2018</xref>; <xref ref-type="bibr" rid="bib86">Overbeek et al., 2014</xref>]). However, we also observed interesting deviations, which could be partially attributed to known finer resolution in the specific membrane components across taxa. Compared to other metabolites, cell-wall components generally tend to have variable or low PM values across the oral microbiome organisms. We analyzed in detail fifteen different teichoic acids, a class of metabolites expected to be found in the cell wall of Gram-positive organisms that play an important role in microbial physiology and interactions with the host (<xref ref-type="bibr" rid="bib114">Weidenmaier and Peschel, 2008</xref>). Of these, nine were found to have higher PM values in Gram-positive organisms, as expected (<xref ref-type="fig" rid="fig4">Figure 4 IV</xref>). In particular, the D-alanine substituted lipoteichoic acids had high PM values in the phylum <italic>Firmicutes</italic> and specifically the class <italic>Bacilli</italic>. However, there was another set of 6 teichoic acids that had intermediate PM values across a large number of organisms and didn’t follow Gram-staining trends (<xref ref-type="fig" rid="fig4">Figure 4 V</xref>). These consisted of three N-acetyl-D-glucosamine linked and three unsubstituted teichoic acids. This mismatch in expected patterns suggests that the metabolic pathways involving these particular cell-wall components may merit closer inspection in the network reconstruction process.</p><p>We further observed clear trends associated with several lipids which are expected to be found in the cell membrane of both Gram-positive and Gram-negative organisms. In particular, we found a strong increase in the PM value for three phosphatidylethanolamine lipids in Gram-negative organisms (<xref ref-type="fig" rid="fig4">Figure 4 VI</xref>). Interestingly, these lipids have been previously observed to be more commonly produced in Gram-negative organisms, and have implications for antimicrobial susceptibility (<xref ref-type="bibr" rid="bib34">Epand et al., 2007</xref>; <xref ref-type="bibr" rid="bib35">Epand and Epand, 2009</xref>). We also identified trends associated with three cardiolipin and three phosphatidylglycerol lipids that display generally similar PM patterns across different species (<xref ref-type="fig" rid="fig4">Figure 4 VII</xref>). One class of organisms that stands out with respect to lipid biosynthesis are the <italic>Negativicutes</italic>. These organisms have relatively high PM values for phosphatidylethanolamine but PM values of 0 for cardiolipin and phosphatidylglycerol lipids. Consistent with this result, it has been previously observed that the <italic>Negativicutes</italic> organism <italic>Selenomonas ruminantium</italic> lacks cardiolipin and phosphatidylglycerol lipids in its inner and outer cell membranes, but does have phosphatidylethanolamine (<xref ref-type="bibr" rid="bib54">Kamio and Takahashi, 1980</xref>). It has been hypothesized that the membrane stabilizing role of these two missing lipids could be partially fulfilled by peptidoglycan bound polyamines, including spermidine, in <italic>Selenomonadales</italic> organisms (<xref ref-type="bibr" rid="bib54">Kamio and Takahashi, 1980</xref>; <xref ref-type="bibr" rid="bib45">Hamana et al., 2012</xref>). Concordantly, we see an increased PM value for the polyamine spermidine across <italic>Negativicutes</italic> in our data (<xref ref-type="fig" rid="fig4">Figure 4 VIII</xref>). These patterns suggest that the PM could be used to obtain organism-specific estimates of biomass composition from genomes for metabolic network reconstruction, facilitating assignments beyond gram positive/negative compositions.</p><p>Aside from lipids and cell-wall components, there are a number of interesting trends related to several amino acids and other essential factors in our data. A number of metabolites had increased PM in the phylum <italic>Proteobacteria</italic> and decreased PM values in the phylum <italic>Bacteroidetes</italic>. A notable example is heme, which can be seen to follow this trend (<xref ref-type="fig" rid="fig4">Figure 4 IX</xref>). Heme plays an important role in microbe host interactions, as bacterial pathogens often acquire it from their human host (<xref ref-type="bibr" rid="bib23">Choby and Skaar, 2016</xref>). In the context of the human oral microbiome, the oral pathogen <italic>Porphyromonas gingivalis</italic> (belonging to the phylum <italic>Bacteroidetes</italic>) is known to scavenge heme (<xref ref-type="bibr" rid="bib80">Olczak et al., 2005</xref>), compatible with the above pattern. Other metabolites that displayed the same trend include: arginine, cysteine, methionine, tryptophan, and glutathione. Arginine can be catabolized via the arginine deiminase pathway to regenerate ATP and is thus an interesting exchange metabolite beyond its use as a protein building block (<xref ref-type="bibr" rid="bib91">Plugge and Stams, 2001</xref>; <xref ref-type="bibr" rid="bib99">Schink, 2006</xref>). Tryptophan is one of the highest cost amino acids to biosynthesize (<xref ref-type="bibr" rid="bib1">Akashi and Gojobori, 2002</xref>), and thus is an intriguing exchange candidate. Methionine and Cysteine are the only two sulfur containing standard amino acids, and glutathione is synthesized from Cysteine. It is possible that the discrepancies between PM values observed here are indicative of broad amino acid and vitamin exchange between the phyla <italic>Proteobacteria</italic> and <italic>Bacteroidetes</italic> in the human oral microbiome.</p></sec><sec id="s2-8"><title>Organic acid production predicted for human oral microbiome organisms</title><p>In addition to calculating the producibility of biomass components, we were interested in applying the PM to other metabolites that could be produced by microbes and impact microbial community structure or function in the human oral microbiome. We thus used our method to compute the PM of various organic acids across oral microbiome organisms. We analyzed nine different organic acids and observed a large amount of variability in PM (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>). Acetate had the highest median PM while butyrate had variable PM, with most organisms having PM of 0 but some having relatively high PM. In particular, <italic>Fusobacterium</italic> genus organisms were found to have high PM for butyrate, reflecting observations obtained from transcriptomic data, with important implications for periodontal disease (<xref ref-type="bibr" rid="bib53">Jorth et al., 2014</xref>). Additionally, increased butyrate PM was observed in some but not all <italic>Porphyromonas</italic> and <italic>Prevotella</italic> species, which have been further implicated in periodontal disease due to their potential production of inflammation inducing organic acids (<xref ref-type="bibr" rid="bib108">Takahashi, 2015</xref>). For reference, the organic acids analyzed in this section were added to <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>, and the calculated PMs were added to <xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref>.</p></sec><sec id="s2-9"><title>Metabolite producibility in a protein vs. carbohydrate-enriched environment</title><p>Although one of the most useful features of our method is the capacity to provide an environment-independent measure of metabolite producibility, it can also be tailored to ask environment-specific questions. To exemplify this capability, we applied our method to investigate the biosynthetic capabilities of a proteolytic organism (<italic>Porphyromonas gingivalis</italic>) and a saccharolytic organism (<italic>Streptococcus mutans</italic>) in a protein and a carbohydrate-enriched environment. The hypothesis was that the proteolytic organism would have a higher PM increase in the protein enriched environment as it is able to breakdown amino acids to synthesize other biomass components and likewise the saccharolytic organism would have a higher PM increase in the carbohydrate-enriched environment. We simulated a protein-enriched environment by fixing all amino acids to always be present (<italic>P<sub>in</sub></italic> = 1) when calculating the PM, and simulated a carbohydrate-enriched environment by fixing D-glucose to always be present (<italic>P<sub>in</sub></italic> = 1). Target metabolites were never fixed to be present; for example when calculating the PM of an amino acid in the protein-enriched environment we did not fix that amino acid to be present. We measured the increase in PM in the enriched environments relative to the originally calculated PM, for all 88 biomass metabolites and nine organic acids (<xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5</xref>). Overall, we saw only small increases in PM in the enriched environments, with particularly small increases in the carbohydrate-enriched environment. The modest trends that we identified matched our expectation, with the proteolytic organism showing a larger increase in PM in the protein-rich environment and the saccharolytic organism showing a larger increase in PM in the carbohydrate-enriched environment. One possible reason for the small effects observed in this analysis is the fact that our baseline random environment is fairly rich. For example, fixing D-glucose to be available in the carbohydrate-enriched environment had minimal effect as D-glucose already had a high PM in the original random environment. However, this application does highlight the value of further exploring variants of our method that explicitly translate environmental information into non-uniform metabolite input probabilities.</p></sec><sec id="s2-10"><title>Metabolic similarity correlates with microbial co-occurrence in the human oral microbiome</title><p>Our approach is a bottom-up approach, that starts from genomes and predicts metabolic capabilities that could underlie interactions. A key question in the field of metabolic modeling is whether these bottom-up metrics can be compared to and provide insight into top-down analyses of large datasets, such as the patterns of co-occurrence of microbial taxa from microbiome sequencing data. To address this question for our approach, we used the PM to calculate pairwise measures of metabolic difference or complementarity between any two organisms and assessed the correlation of these metrics with microbial co-occurrence. Through this analysis we sought to identify metabolic trends associated with co-occurring microbes. We simultaneously evaluated the correlation between microbial co-occurrence and other previously defined metrics (<xref ref-type="bibr" rid="bib21">Carr and Borenstein, 2012</xref>; <xref ref-type="bibr" rid="bib59">Kreimer et al., 2012</xref>; <xref ref-type="bibr" rid="bib63">Levy et al., 2015</xref>), so that we could compare these to the performance of the PM. While there are a few additional methods that have utilized gap-filled metabolic models to provide insight into microbial co-occurrence data (<xref ref-type="bibr" rid="bib41">Freilich et al., 2011</xref>; <xref ref-type="bibr" rid="bib120">Zelezniak et al., 2015</xref>), in this study we focused our direct comparison on alternative methods that could be used to analyze draft (non-gap-filled) metabolic networks as these were closest in scope and applicability to our own method. Future analyses could broaden the scope of this comparison. All of the pairwise metabolic metrics we calculated are described further in the methods section. For co-occurrence data, we analyzed the supplementary data from <xref ref-type="bibr" rid="bib43">Friedman and Alm (2012)</xref>, which contains microbial co-occurrences identified from 16S rRNA sequencing data using their SparCC method for seven different oral microbiome sites. The correlations between all pairwise metabolic metrics and microbial co-occurrence in all seven oral microbiome sites are presented in <xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref>.</p><p>Across the seven different oral microbiome sites, the pairwise metabolic metric ‘PM distance’ (see methods section for description of metrics) showed the most consistent significant correlation with co-occurrence of any pairwise metabolic metric. The PM distance was consistently negatively correlated with the co-occurrence, indicating that organisms that are more similar in PM tend to co-occur. Several other pairwise metabolic metrics were found to be correlated with co-occurrence, although in a less consistent manner than the PM distance (<xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref>). Additionally, many of the pairwise metabolic metrics that we analyzed were highly correlated with each other as we show in <xref ref-type="fig" rid="fig4s6">Figure 4—figure supplement 6</xref>. To further disentangle correlations between pairwise metabolic metrics and co-occurrence data, we looked at the partial-correlation between a pairwise metabolic metric and co-occurrence when controlling for another pairwise metabolic metric. We found that the PM distance always had significant partial-correlation with co-occurrence when controlling for any of the other pairwise metabolic network metrics, a trend not observed for the other metrics. We further repeated this entire correlation analysis for co-occurrence measured by Pearson’s correlation (also from the supplementary data of <xref ref-type="bibr" rid="bib43">Friedman and Alm, 2012</xref>.), and interestingly found that correlations between pairwise metabolic metrics and co-occurrence were weaker and less consistent when using Pearson’s correlation, in line with previously reported inconsistency in co-occurrence prediction by Pearson’s correlation (<xref ref-type="bibr" rid="bib43">Friedman and Alm, 2012</xref>). Overall, our analysis corroborates and enhances previous analyses showing how co-occurrences in 16S rRNA sequencing data from the human microbiome project tend to reflect ‘habitat filtering’, where organisms with similar metabolic capabilities tend to co-occur (<xref ref-type="bibr" rid="bib41">Freilich et al., 2011</xref>; <xref ref-type="bibr" rid="bib120">Zelezniak et al., 2015</xref>; <xref ref-type="bibr" rid="bib64">Levy and Borenstein, 2013</xref>).</p><p>We next examined more closely the correlation between the pairwise metabolic metrics PM complementarity and Seed complementarity (see Methods and <xref ref-type="fig" rid="fig4s7">Figure 4—figure supplement 7</xref>). These measures of complementarity summarize the potential for any one organism to provide metabolic products to another. While the two metrics are highly correlated with each other, the distribution of their values display some significant differences. In particular, the PM complementarity displays a clear bi-modal distribution, which is absent from the distribution of Seed complementarity values. The high-valued peak of the PM complementarity distribution captures most of the interactions between small-genome/fastidious microorganisms and their partners. This indicates that our method is good at resolving biosynthetic deficiencies in fastidious/uncultivated organisms, as further investigated next.</p></sec><sec id="s2-11"><title>Biosynthetic properties predicted in a cluster of fastidious human oral microbiome organisms</title><p>In addition to dissecting the patterns associated with specific metabolites, one can analyze the PM landscape of <xref ref-type="fig" rid="fig4">Figure 4</xref> from the perspective of the organisms and their agglomeration into clusters. Strikingly, in our large clustered PM matrix, the most distinct hierarchical cluster of organisms consisted of a number of fastidious organisms (<xref ref-type="fig" rid="fig4">Figure 4</xref> top left). This cluster included all of the <italic>Mycoplasma</italic> genomes that we analyzed, and one <italic>Treponema</italic> genome. <italic>Mycoplasma</italic> and <italic>Treponema</italic> are genera that are known to be parasitic and have evolved to have reduced genomes and metabolic capabilities (<xref ref-type="bibr" rid="bib38">Fraser et al., 1995</xref>; <xref ref-type="bibr" rid="bib39">Fraser et al., 1998</xref>; <xref ref-type="bibr" rid="bib77">Meseguer et al., 2003</xref>; <xref ref-type="bibr" rid="bib30">Davis et al., 2013</xref>; <xref ref-type="bibr" rid="bib96">Razin, 1978</xref>). The remaining members of this cluster included nearly all of the sequenced yet uncultivated, or recently co-cultivated, organisms in our study. The organisms included were from the phyla: <italic>Absconditabacteria</italic> (SR1), <italic>Saccharibacteria</italic> (TM7), <italic>Proteobacteria</italic> (genus <italic>Desulfobulbus</italic>), and <italic>Chloroflexi</italic> (class <italic>Anaerolineae</italic>). Many of these organisms are thought to have reduced genomes and limited metabolic capabilities underlying their fastidious nature, much like <italic>Mycoplasma.</italic> Only one of the previously uncultivated organism we analyzed was found outside of this fastidious cluster, namely <italic>Tannerella</italic> HMT-286. Interestingly, this bacterium is hypothesized to rely on externally supplied siderophores to support its growth (<xref ref-type="bibr" rid="bib110">Vartoukian et al., 2016a</xref>). This type of dependency is not captured by our metabolic analysis and highlights the fact that, while uncultivability can be driven by many different mechanisms, our method captures the prominent effect of reduced biosynthetic capacity.</p><p>We sought to gain clearer insight into the metabolic properties of these co-clustered fastidious organisms by re-clustering their PM submatrix (<xref ref-type="fig" rid="fig5">Figure 5 A</xref>). By comparing the PM values in this fastidious cluster to those in the average oral microbiome organisms, it is clear that the fastidious organisms had reduced PM for a large number of metabolites including cell-wall components, lipids, amino acids, and other essential factors. When ranking metabolites by their difference in average PM between all oral microbiome organisms and the fastidious cluster a number of amino acids and vitamins stand out as being the most depleted in the fastidious cluster. The top metabolites where: pyridoxal phosphate, valine, putrescine, isoleucine, bactoprenyl diphosphate, thiamin diphosphate, 5-methyltetrahydrofolate, lysine, deoxyguanosine triphosphate, tryptophan, and guanosine-triphosphate. These metabolites may be particularly relevant with regards to exchange between fastidious organisms and their oral microbiome community partners. Amino acids, in particular, have been hypothesized to be involved in metabolic exchange between microbial organisms in communities (<xref ref-type="bibr" rid="bib93">Ponomarova and Patil, 2015</xref>; <xref ref-type="bibr" rid="bib75">Mee et al., 2014</xref>; <xref ref-type="bibr" rid="bib76">Mee and Wang, 2012</xref>; <xref ref-type="bibr" rid="bib120">Zelezniak et al., 2015</xref>). Amino acids with reduced PM in the fastidious cluster tend to have high biosynthetic cost (cost calculated in <xref ref-type="bibr" rid="bib1">Akashi and Gojobori, 2002</xref>.), as indicated by Spearman correlation analysis (ρ = 0.4595, p-value=0.0415). An exception to this trend, potentially interesting for follow up studies, is the case of the branched chain amino acids valine, and isoleucine, which are the two amino acids with most reduced PM in fastidious organisms, but are not among the costliest. Notably, branched chain amino acid supplementation has been shown to alter the metabolic structure of the gut microbiome of mice (<xref ref-type="bibr" rid="bib117">Yang et al., 2016</xref>).</p><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.39733.018</object-id><label>Figure 5.</label><caption><title>Fastidious/uncultivated and TM7/host producibility sub-matrices.</title><p>Sub-matrices of the larger PM matrix were re-clustered to highlight variations within specific groups of fastidious and uncultivated organisms. (<bold>A</bold>) The fastidious/uncultivated organisms that were identified as the most unique cluster in the larger matrix from <xref ref-type="fig" rid="fig4">Figure 4</xref> were re-clustered hierarchically. The average producibility metric (PM) value across all oral microbiome organisms analyzed in this study is shown in the far left column. Differences between the fastidious <italic>Mycoplasma</italic> genus organisms and the previously uncultivated TM7 organisms are highlighted with roman numerals. (<bold>B</bold>) The PM values for the previously uncultivated TM7 organisms and their growth-supporting hosts bacteria were extracted and re-clustered hierarchically. Differences between the TM7 and their bacterial hosts are highlighted with roman numerals.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig5-v2.tif"/></fig><p>We next sought to gain more specific insight into a specific class of recently-cultivated fastidious organisms, <italic>Saccharibacteria</italic> (TM7). To gain specific insight into the biosynthetic capabilities of these TM7 relative to other fastidious microorganisms, we further focused our analysis on identifying discrepancies between <italic>Mycoplasma</italic> and TM7. Our analysis included eight <italic>Mycoplasma</italic> genomes and three TM7 genomes. <italic>Mycoplasma</italic> are a relatively well characterized genus of intracellular parasites with reduced metabolic capabilities, and TM7 are a recently co-cultivated phylum of the candidate phyla radiation that display reduced metabolic capabilities and a parasitic lifestyle. There are several cell-wall components for which TM7 has relatively high PM values and Mycoplasma has PM values of zero (<xref ref-type="fig" rid="fig5">Figure 5 I</xref>). These include nine different teichoic acids, bactoprenyl diphosphate, and peptidoglycan. This highlights extensive cell-wall/peptidoglycan metabolism in TM7 organisms and the known lack of a cell-wall in <italic>Mycoplasma</italic> (<xref ref-type="bibr" rid="bib96">Razin, 1978</xref>). Furthermore, a set of three nucleotides: dGTP, GTP, and TTP, have high PM values for TM7 and PM values of zero for <italic>Mycoplasma</italic> organisms (<xref ref-type="fig" rid="fig5">Figure 5 II</xref>). This pattern of nucleotide biosynthesis deficiency in <italic>Mycoplasma</italic> is consistent with the observation that some strains have been shown to be dependent on supplementation of thymidine and guanosine but not adenine or cytosine nucleobases for growth (<xref ref-type="bibr" rid="bib78">Mitchell and Finch, 1977</xref>). Finally, the cofactors acyl carrier protein (ACP) and flavin adenine dinucleotide (FAD) had high PM values in <italic>Mycoplasma</italic> and PM values of zero in TM7 organisms (<xref ref-type="fig" rid="fig5">Figure 5 III</xref>). The lack of these cofactors in TM7 seems surprising, but is indeed matched by a complete lack of any metabolic reactions annotated to utilize FAD and ACP as cofactors in the draft reconstruction of the TM7 metabolic networks.</p><p>In addition to investigating the metabolic deficiencies of fastidious organisms, the PM landscape gave us the opportunity to compare these gaps with possible complementary capabilities in organisms known to support their growth. The three TM7 strains that we analyzed were recently co-cultivated with host bacteria from the human oral microbiome. TM7x was shown to be a parasitic epibiont of <italic>Actinomyces odontolyticus</italic> XH001 (<xref ref-type="bibr" rid="bib74">McLean et al., 2016</xref>). TM7 AC001 and PM004 were recently both co-cultivated successfully with either of the host strains <italic>Pseudopropionibacterium propionicum</italic> F0230a or F0700 (<xref ref-type="bibr" rid="bib27">Collins et al., 2019c</xref>). We further investigated these newly discovered relationships to gain insight into possible metabolic exchange (<xref ref-type="fig" rid="fig5">Figure 5 B</xref>). Interestingly, TM7 organisms had higher PM values than their host strains for several cell-wall components: three glucose-substituted teichoic acids, and glucose-substituted and unsubstituted glycerol teichoic acid (<xref ref-type="fig" rid="fig5">Figure 5 IV</xref>), suggesting that TM7 is capable of producing several cell-wall components that its host cannot. Conversely, as expected, a large number of metabolites had increased PM values in the host strains compared to the TM7 strains. These metabolites are hypothesized to be easily synthesized by the host and not TM7 and are thus interesting candidates for growth supporting exchange. Fourteen different metabolites had average PM values in the hosts greater than 0.60 higher than in the TM7 organisms (<xref ref-type="fig" rid="fig5">Figure 5 V</xref>). The ranked list includes: isoleucine, valine, acyl carrier protein, 5-methyltetrahydrofolate, pyridoxal phosphate, flavin adenine dinucleotide, thiamin diphopsphate, putrescine, tryptophan, Fe<sup>2+</sup>, heme, Fe<sup>3+</sup>, lysine, and menaquinone-8. Interestingly, the branched chain amino acids isoleucine and valine are again at the top of the list. The correlation of amino acid biosynthesis cost (<xref ref-type="bibr" rid="bib1">Akashi and Gojobori, 2002</xref>) with the difference in PM values between host and TM7 is even higher than what we observed across all fastidious organisms (Spearman correlation ρ = 0.6011, p-value=0.0051) indicating that PM values are further decreased in TM7 for costly amino acids.</p><p>Our results provide context and putative mechanistic details related to observed gene expression and metabolic changes in the co-cultivation of TM7x with the host <italic>Actinomyces odontolyticus</italic> XH001 (<xref ref-type="bibr" rid="bib74">McLean et al., 2016</xref>). Transcriptomic data for TM7x and <italic>A. odontolyticus</italic> XH001 showed that a number of genes associated with N-acetyl-D-glucosamine were up regulated in <italic>A. odontolyticus</italic> in this interaction (<xref ref-type="bibr" rid="bib48">He et al., 2015</xref>). Our results show that, although TM7 does have extensive cell wall metabolism, <italic>A. odontolyticus</italic> has higher PM for N-acetyl-D-glucosamine substituted components (<xref ref-type="fig" rid="fig5">Figure 5 VI</xref>). This suggests that the host is responsible for the biosynthesis of these cell-wall components, which may be overexpressed during co-cultivation. Metabolomics experiments from this co-cultivation have identified the cyclic peptide cyclo(L-Pro-L-Val) as a potential signaling molecule in this relationship. Our PM analysis suggests that this molecule would be synthesized by the host as it has increased PM values for both of the amino acids included (<xref ref-type="fig" rid="fig5">Figure 5 VII</xref>). In fact, valine has one of the highest discrepancies in PM for host and TM7. Finally, another potentially exchanged amino acid of interest is arginine. All three TM7 draft metabolic network reconstructions that we analyzed were annotated to possess either all or all but one of the reactions in the arginine deiminase pathway (TM7 PM004 is missing the arginine iminohydrolase reaction) (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref> and Supplementary Cytoscape (<xref ref-type="bibr" rid="bib102">Shannon et al., 2003</xref>) files 1–3). This catabolic pathway can be used to degrade arginine to regenerate ATP, and has been implicated in syntrophic microbial interactions (<xref ref-type="bibr" rid="bib91">Plugge and Stams, 2001</xref>; <xref ref-type="bibr" rid="bib99">Schink, 2006</xref>). In our PM analysis arginine had consistently higher PM in host than TM7 (<xref ref-type="fig" rid="fig5">Figure 5 VIII</xref>). Thus, arginine exchange and metabolism via the arginine deiminase pathway could contribute to the dependence of TM7 on its hosts (<xref ref-type="fig" rid="fig6">Figure 6</xref>).</p><fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.39733.019</object-id><label>Figure 6.</label><caption><title>Hypothesized metabolic exchange between TM7 and their bacterial hosts.</title><p>(<bold>A</bold>) We summarize here hypotheses generated for the exchange of metabolites between TM7 and their growth-supporting hosts based on differences in biomass PM values. We also highlight any insight that our PM was capable of providing into experimental transcriptomic and metabolomic data from the co-cultivation of TM7x and <italic>Actinomyces odontolyticus</italic> that was previously collected and analyzed in a separate study (<xref ref-type="bibr" rid="bib48">He et al., 2015</xref>). (<bold>B</bold>) The cell-wall components containing glucose-substituted teichoic acids were among the only metabolites with PM higher in TM7 than in hosts. N-acetyl-D-glucosamine-substituted teichoic acids had increased PM in the host relative to TM7, and previous gene expression data from TM7x and <italic>A. odontolyticus</italic> shows several genes related to N-acetyl-D-glucosamine that are overexpressed in <italic>A. odontolyticus</italic> during co-cultivation (<xref ref-type="bibr" rid="bib48">He et al., 2015</xref>). (<bold>C</bold>) Several vitamins/cofactors/other essential factors had decreased PM in TM7 compared to the hosts. The cofactors acyl carrier protein and flavin adenine dinucleotide had decreased PM in TM7, and were also not found to be utilized in the TM7 draft metabolic network reconstructions. (<bold>D</bold>) Several amino acids had decreased PM in TM7 compared to the hosts. Valine and proline were both decreased in TM7 relative to the host, and previous metabolomics data from TM7x and <italic>A. odontolyticus</italic> identified the cyclic dipeptide cyclo(L-Pro-L-Val) as a potential signaling molecule (<xref ref-type="bibr" rid="bib48">He et al., 2015</xref>). Arginine had decreased PM in TM7 relative to the host and could potentially be exchanged and catabolized by TM7 via the arginine deiminase pathway.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.39733.020</object-id><label>Figure 6—figure supplement 1.</label><caption><title>TM7 metabolic network visualization.</title><p>The metabolic networks for the TM7 strains analyzed in this work with producibility metric (PM) values calculated for all intracellular metabolites are all available as supplementary cytoscape files that can be viewed and interactively analyzed (<xref ref-type="supplementary-material" rid="supp1">Supplementary files 1</xref>–<xref ref-type="supplementary-material" rid="supp3">3</xref>). Networks are represented as bipartite networks with reactions as squares and metabolites as circles. Black borders are used to indicate irreversible reactions, reversible reactions have no border. Intracellular metbaolite color indicates calculated PM (blue = low, red = high). The entire TM7x network (<bold>A</bold>) and a subnetwork depicting the arginine deiminase pathway (<bold>B</bold>) are shown here.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-fig6-figsupp1-v2.tif"/></fig></fig-group></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Our method provides an estimate of the putative biosynthetic capabilities of a metabolic network from genomic information. We first implemented this method in <italic>E. coli</italic>, to demonstrate its application and capacity to address multiple questions, even in presence of uncertainty that would prevent the use of other stoichiometric methods. Next, we reconstructed metabolic networks for 456 different organisms from the human oral microbiome, and generated an atlas of predicted biosynthetic capabilities across these organisms. We highlighted trends in the biosynthetic capabilities of these microbes related to taxonomy, and showed that these predicted biosynthetic capabilities can partially explain co-occurrence data. We further focused on describing putative biosynthetic deficiencies of a cluster of fastidious/uncultivated organisms and predicted exchanged metabolites between three recently co-cultivated <italic>Saccharibacteria</italic> (TM7) strains and their growth supporting partner microbes. Overall, our method provides preliminary insight into the metabolic capabilities of a large number of human oral microbiome organisms and helps further the understanding of the structure of this complex microbial ecosystem.</p><p>Our method differs from other approaches in several key ways that we have demonstrated throughout our analysis. First, it is different from a pathway-based analysis where the percent completion of biosynthetic pathways is analyzed. Our method is based on the entire metabolic network and captures the multitude of different routes through which a metabolite could be synthesized. An additional advantage is that our method does not rely on previously defined biosynthetic pathway annotations and instead seeks to use the entire metabolic network structure to define biosynthetic capabilities. While prior knowledge of pathways can be quite useful in many contexts, specific biosynthetic routes can cross the boundaries of annotated pathways, making pathway completeness uninformative. A prior notable example of this effect is the discovery of an alternative pathway to bypass a TCA cycle gene impairment (<xref ref-type="bibr" rid="bib42">Frezza et al., 2011</xref>). This pathway connects in an unexpected way two distinct pathways, generating a new crucially important and experimentally validated type of connectivity that would be missed from regular pathway-based analysis. Another such example, in our current data, is the case of the arginine deiminase pathway and the urea cycle, which contain several overlapping metabolites and reactions. In fact, we have noticed that KEGG mappings of TM7x metabolism often highlight the urea cycle as a result of TM7x containing the complete arginine deiminase pathway. Our method differs substantially also from standard flux balance analysis, even if it is based on stoichiometry and Linear Programming. Specifically, our method has improved tolerance for missing reactions compared to flux balance analysis (<xref ref-type="fig" rid="fig3">Figure 3</xref>), and thus does not rely on gap-filled metabolic networks. Therefore, it is capable of providing preliminary insight into ‘draft’ genome-derived metabolic networks that can be used to study diverse microbes and microbial communities, and could potentially help guide the gap-filling process and predict putative biomass components. Our method also differs from alternative topology-based methods (<xref ref-type="bibr" rid="bib15">Borenstein et al., 2008</xref>; <xref ref-type="bibr" rid="bib21">Carr and Borenstein, 2012</xref>; <xref ref-type="bibr" rid="bib59">Kreimer et al., 2012</xref>; <xref ref-type="bibr" rid="bib63">Levy et al., 2015</xref>) as it represents metabolism as a bipartite graph constrained by stoichiometry (enabling enforcement of mass balance constraints), rather than projecting the network onto an adjacency matrix between metabolites, which is not constrained by stoichiometry (i.e. two metabolites can be connected in an adjacency matrix despite a missing reactant or cofactor for the reaction that connects them).</p><p>It is important to highlight the limitations of our approach. In particular, many of the issues that limit the accuracy of metabolic network analyses in general affect our method as well. The primary limitation is enzyme annotation. Aside from missing or incorrect annotations, subtle processes such as enzyme promiscuity and spontaneous reactions may have unquantified effects on metabolic network function. Reaction direction/reversibility is also difficult to predict as it requires detailed knowledge of reaction thermodynamics and metabolite concentrations. In particular, inaccurate or missing information about reaction direction/reversibility could lead to uncertainty about whether a high PM from our method should be interpreted as reflecting biosynthetic or degradative capabilities (or both). Throughout our analysis we have utilized default reversibility constraints provided by the KBase build metabolic models app (<xref ref-type="bibr" rid="bib50">Henry et al., 2010</xref>; <xref ref-type="bibr" rid="bib4">Arkin et al., 2018</xref>; <xref ref-type="bibr" rid="bib86">Overbeek et al., 2014</xref>), but more stringent constraints on directionality could possibly improve our results. Transport reactions are also notoriously difficult to annotate accurately, and the current implementation of our method addresses this limitation by naïvely adding intracellular metabolites as input metabolites. However, any future efforts to use extracellular metabolites as inputs would rely on accurate transport reaction annotations. In general, all metabolic network analysis methods face similar limitations. Even as newly developed experimental methods gradually improve metabolic reaction annotation (<xref ref-type="bibr" rid="bib94">Price et al., 2018a</xref>; <xref ref-type="bibr" rid="bib109">Vaccaro et al., 2016</xref>; <xref ref-type="bibr" rid="bib95">Price et al., 2018b</xref>; <xref ref-type="bibr" rid="bib101">Sévin et al., 2017</xref>), it is likely that we will have to continue dealing with incomplete knowledge. Thus, approaches like the one presented here are valuable for providing initial predictions of metabolic capabilities with minimal arbitrary assumptions, and for pinpointing specific areas of a metabolic model that are in need of refinement. One additional limitation of our method, in comparison to alternative methods, is that it requires a longer run time than alternative methods, such as FBA (<xref ref-type="bibr" rid="bib82">Orth et al., 2010a</xref>) or NetSeed (<xref ref-type="bibr" rid="bib15">Borenstein et al., 2008</xref>; <xref ref-type="bibr" rid="bib21">Carr and Borenstein, 2012</xref>). Future efforts towards simplifying the calculations to improve the algorithm’s speed would be beneficial. For example, utilizing heuristics or belief propagation could possibly improve the efficiency and run time of our algorithm (<xref ref-type="bibr" rid="bib118">Yedidia et al., 2003</xref>).</p><p>Despite these limitations, by translating genotype into phenotype with minimal assumptions, our approach has the potential to serve as a baseline estimate of metabolic mechanisms in different microbial communities. Moving forward, our method could be easily applied to other human-associated or environmentally relevant microbial communities, providing valuable putative insight into inter-microbial metabolic dependencies. For example, in this analysis we have analyzed three previously uncultivated <italic>Saccharibacteria</italic> (TM7) phylum organisms that were recently successfully co-cultivated with growth supporting bacterial host organisms. These TM7 species are the first successfully cultured organisms from the candidate phyla radiation, a large branch of the tree of life consisting mainly of uncultivated organisms (<xref ref-type="bibr" rid="bib55">Kantor et al., 2013</xref>; <xref ref-type="bibr" rid="bib18">Brown et al., 2015</xref>; <xref ref-type="bibr" rid="bib51">Hug et al., 2016</xref>), and therefore are of general interest beyond their role in human oral health. Further analysis of the candidate phyla radiation through our method could provide preliminary phenotypic insight into this unusual, but large, group of bacteria. Additionally, our method could be applied to other classes of uncultivated bacteria, many of which will be gradually added to the collection of genomes reconstructed from metagenomic sequencing of communities.</p><p>Another promising application of our approach is evaluating draft models during the metabolic network reconstruction process. In particular, in building new draft stoichiometric models, the producibility metric, which displays nuanced variability across taxa, could be used as an initial estimate of the biomass composition, to be compared to the reference biomass compositions currently used in most reconstructions (<xref ref-type="bibr" rid="bib62">Lakshmanan et al., 2019</xref>). More generally, our approach fits into an emerging class of metabolic reconstruction and analysis methods that address uncertainty by statistically sampling ensembles (of environments, as done here; fluxes, as studied extensively [<xref ref-type="bibr" rid="bib98">Schellenberger and Palsson, 2009</xref>]; or network reconstructions, as recently implemented [<xref ref-type="bibr" rid="bib12">Biggs and Papin, 2017</xref>; <xref ref-type="bibr" rid="bib66">Machado et al., 2018</xref>]). We envisage that the metabolic insight gained from the application of these methods will continue to help bridge the gap between top down studies and a mechanistic understanding of microbial community metabolism and dynamics.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Method implementation</title><p>The framework for implementing our method was developed as several different modular functions that interact in a nested manner to run our analysis. The functions are written in MATLAB and interface with the COBRA toolbox (<xref ref-type="bibr" rid="bib97">Schellenberger et al., 2011</xref>; <xref ref-type="bibr" rid="bib49">Heirendt et al., 2019</xref>). The code is built around the COBRA toolbox commands <italic>changeObjective</italic> and <italic>optimizeCbModel</italic>. Thus, running our code requires installation of the COBRA toolbox. Additionally, the nonlinear fitting function utilizes the MATLAB function <italic>lsqnonlin</italic> for nonlinear least squared fitting. Additional functions were developed to implement our probabilistic framework and run our analysis method. We describe here each modular function, providing details on the computations performed. The full code for implementing our method, with examples for running the code, is available online at <ext-link ext-link-type="uri" xlink:href="https://github.com/segrelab/biosynthetic_network_robustness">https://github.com/segrelab/biosynthetic_network_robustness</ext-link> (<xref ref-type="bibr" rid="bib10">Bernstein, 2019</xref>).</p></sec><sec id="s4-2"><title>Algorithm functions</title><p><italic>feas</italic> – This function determines if the production of a given target metabolite set is feasible given the metabolic network model with specified constraints. Flux balance analysis was used to determine the feasibility of production (<xref ref-type="bibr" rid="bib82">Orth et al., 2010a</xref>). Flux balance analysis was chosen over the alternative network expansion algorithm due to its treatment of cofactor metabolites (<xref ref-type="bibr" rid="bib61">Kruse and Ebenhöh, 2008</xref>). In network expansion, cofactors must be added to the network to ‘bootstrap’ metabolism, whereas in flux balance analysis any reaction utilizing a cofactor can proceed given that the cofactor can be recycled by a different reaction, which is a less restrictive constraint on the metabolic network flux. Furthermore, our implementation allows for inequality or equality mass balance constraints. Traditional flux balance imposes an equality mass balance which is often referred to as a steady state constraint. This constraint restricts the rate of change of all metabolite concentrations to be equal to 0. We provide the option of implementing inequality mass balance, which constrains the rate of change of metabolite concentrations to be greater than or equal to 0. In practice, inequality mass balance is implemented by adding unbounded exporting exchange reactions and calculating steady state solutions. We have implemented inequality mass balance for all of our calculations due to the fact that we are analyzing local properties of the metabolic network (the production of a single metabolite) and do not want the network to be constrained by the global requirement to achieve steady state. During the production of a particular metabolite, the metabolic network is thus free to produce byproducts that are used elsewhere or secreted. To determine production feasibility, the export of a particular target metabolite is set to the objective function and maximized. If the maximal flux is greater than a hard-coded threshold (&gt;0.001), then the target metabolite is considered to be feasibly produced. This function uses the COBRA commands <italic>changeObjective</italic> and <italic>optimizeCbModel</italic> to set and maximize the appropriate objective function. Mathematically, flux balance analysis is implemented as a linear programming problem with the following definition:<disp-formula id="equ1"><mml:math id="m1"><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mo>:</mml:mo> <mml:mi/><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>v</mml:mi></mml:math></disp-formula><disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mi mathvariant="bold-italic">o</mml:mi></mml:mrow><mml:mo>:</mml:mo><mml:mi>S</mml:mi><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="italic">e</mml:mi><mml:mi mathvariant="italic">q</mml:mi><mml:mi mathvariant="italic">u</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">l</mml:mi><mml:mi mathvariant="italic">i</mml:mi><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">y</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext><mml:mi mathvariant="italic">m</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">s</mml:mi><mml:mi mathvariant="italic">s</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext><mml:mi mathvariant="italic">b</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">l</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">n</mml:mi><mml:mi mathvariant="italic">c</mml:mi><mml:mi mathvariant="italic">e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mi>v</mml:mi><mml:mtext> </mml:mtext><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="italic">i</mml:mi><mml:mi mathvariant="italic">n</mml:mi><mml:mi mathvariant="italic">e</mml:mi><mml:mi mathvariant="italic">q</mml:mi><mml:mi mathvariant="italic">u</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">l</mml:mi><mml:mi mathvariant="italic">i</mml:mi><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">y</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext><mml:mi mathvariant="italic">m</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">s</mml:mi><mml:mi mathvariant="italic">s</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext><mml:mi mathvariant="italic">b</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">l</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">n</mml:mi><mml:mi mathvariant="italic">c</mml:mi><mml:mi mathvariant="italic">e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mi mathvariant="bold-italic">o</mml:mi></mml:mrow><mml:mo>:</mml:mo><mml:mi>l</mml:mi><mml:mi>b</mml:mi><mml:mo>≤</mml:mo><mml:mi>v</mml:mi><mml:mo>≤</mml:mo><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Where: <inline-formula><mml:math id="inf6"><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the transpose of a column vector indicating which reactions are to be maximized. In this case, this specifies the exporting exchange reactions corresponding to the target metabolites. <inline-formula><mml:math id="inf7"><mml:mi>v</mml:mi></mml:math></inline-formula> is a column vector of metabolic reaction fluxes. <inline-formula><mml:math id="inf8"><mml:mi>S</mml:mi></mml:math></inline-formula> is the stoichiometric matrix describing the reactions present in the metabolic network (a metabolites by reactions size matrix). Each element in the matrix is the stoichiometry of a particular metabolite associated with a particular reaction. Negative values indicate that a metabolite is a reactant of that reaction being consumed, while positive values indicate that a metabolite is a product of that reaction being produced. <inline-formula><mml:math id="inf9"><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf10"><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:math></inline-formula> are the lower and upper bounds of all reactions, which define reaction reversibility or are set to -1000 and 1000 respectively when unbounded. Additional information on flux balance analysis can be found in this publication describing its implementation in detail (<xref ref-type="bibr" rid="bib82">Orth et al., 2010a</xref>).</p><p><italic>rand_add</italic> – This function is designed to give a random sample of input metabolites to be added based on the Bernoulli parameter for each input metabolite. This function uses the MATLAB <italic>rand</italic> function to choose a random number between 0 and 1 for each input metabolite. If this number is less than the Bernoulli parameter for that input metabolite, then the metabolite is added.</p><p><italic>prob</italic> – This function utilizes <italic>rand_add</italic> and <italic>feas</italic> to determine the probability of producing the target metabolite given the input metabolite Bernoulli parameters, the metabolic network structure, and the specified constraints. A chosen number of random samples of input metabolites are generated by repeatedly running the <italic>rand_add</italic> function. The probability of producing the target metabolite is determined as the number of feasible trials divided by the total number of samples. The default number of samples used for the bulk of the analysis in this work was 50.</p><p><italic>calc_PM_fit_nonlin</italic> <bold>–</bold> This function calculates the producibility metric (PM) for a specified metabolic network model and metabolite using an efficient nonlinear fitting technique. The nonlinear fitting algorithm estimates the PM by randomly sampling points on the producibility curve that fall near PM. The algorithm starts by sampling a point in the middle of the producibility curve (<italic>P<sub>in</sub></italic> = 0.5) and then using the MATLAB function <italic>lsqnonlin</italic> to fit a sigmoidal curve to the sampled points of the producibility curve. The fit sigmoidal curve is then used to estimate a value for the PM. Next, a new sample point is obtained which is offset from the estimated PM value with some noise introduced with the specified noise parameter. In this way the algorithm converges on the PM value and samples points around PM, thus increasing the accuracy of its estimate with each iteration. The estimate converges when a specified n estimates of the PM value are all within a specified threshold. The default parameters associated with this function, used for the bulk of our analysis, were: noise = 0.3, n = 7, thresh = 0.01. The parameters chosen were selected by hand to provide reasonable performance.</p><p><italic>prep_mod</italic> <bold>–</bold> This function is used to prepare the metabolic network model for analysis with our method. The input for this function is a COBRA model, which is saved as a MATLAB structure variable. This code has been developed and optimized to work with KBase generated metabolic networks and is not guaranteed to work with networks from other sources that have different naming conventions. The first modification to the networks is to find and turn off all exchange and maintenance reactions to standardize the network models. Second, the extracellular and intracellular metabolites are identified based on naming conventions and output from the function. Third, exchange reactions are added for each metabolite (producing 1 unit of that metabolite), and a vector indicating the mapping from metabolites to these exchange reactions is output from the function. This vector is used by our method to control the presence and absence of input metabolites in the network model as well as to adjust the inequality mass balance constraints. The final output is a new network model which has been standardized for our method and in which the presence and absence of metabolites can be easily manipulated.</p><p><italic>find_PM_mods_mets</italic> <bold>–</bold> This function is designed to facilitate the parallelization of the PM calculation. The function takes as inputs a directory of metabolic network models, a directory to store results, a list of target metabolite names, the index of the current network model and metabolite being analyzed and all of the specifications necessary for running <italic>calc_PM_fit_nonlin</italic>. The metabolite and model being analyzed can be changed dynamically to allow for parallelization. In addition to these inputs, this function has several inputs that allow for standard modifications to the PM calculation procedure. It allows for certain metabolites to be fixed on or off. It allows for several choices of metabolites to be added during the PM calculation process, including adding all intracellular or extracellular metabolites and including the target metabolite or not. It also allows for specification of the inequality mass balance constraint as either all metabolites set to inequality mass balance or all metabolites set to equality mass balance. Furthermore, it has a parameter for the number of runs to calculate the PM to obtain statistics regarding the variability of <italic>calc_PM_fit_nonlin</italic>. For the analysis done in this work: calculation of PM for single metabolites was done by adding all intracellular metabolites (excluding targets), the mass balance constraint was set to use inequality constraints for all metabolites, the number of runs was set to 10.</p></sec><sec id="s4-3"><title>Parallelization</title><p>We used the Boston University shared computing cluster to run our analysis for a large number of metabolic networks and metabolites. The calculation of the PM for each individual network model and metabolite can be run in parallel, vastly increasing the number of possible computations. The average runtime for computing the PM for an individual network and metabolite for 10 repeated runs was ~9 min and the maximum run time was ~45 min, given the default parameters used in this study: a = 0, s = 1, samp = 50, noise = 0.3, n = 7, thresh = 0.01, runs = 10. We note that these parameters were chosen by hand to provide adequate performance for our algorithm, and future implementations could possibly alter these parameters to provide improved run-time and/or accuracy.</p></sec><sec id="s4-4"><title>Using the <italic>E. coli</italic> core metabolic network to demonstrate features of metabolite producibility</title><p>Our analysis method was initially demonstrated on the <italic>E. coli</italic> core metabolic network. We used the network provided by the BiGG database (<xref ref-type="bibr" rid="bib56">King et al., 2016</xref>). We calculated the PM value for each intracellular metabolite. The input metabolites for our PM calculations were assigned as all intracellular metabolites in the <italic>E. coli</italic> core metabolic network. This was the most naïve assumption we could use for assigning input metabolites, and was consistently used throughout the majority of our analyses. Additionally, using intracellular metabolites as input metabolites avoids errors that could arise from poorly annotated transporters in draft metabolic network reconstructions. Calculations were performed using the Boston University shared computing cluster to parallelize runs across networks and metabolites and improve computation time. The results of our simulation were visualized using the Cytoscape network visualization software (<xref ref-type="bibr" rid="bib102">Shannon et al., 2003</xref>). The entire <italic>E. coli</italic> core metabolic network is shown, excluding the biomass reaction for clarity.</p></sec><sec id="s4-5"><title>Producibility of metabolites differs from pathway completeness and captures minimal precursor set structure</title><p>We analyzed the PM for the histidine biosynthetic pathway with auxotrophic metabolic networks generated by knocking out different reactions along the pathway in the <italic>E. coli</italic> iJO1366 metabolic network. The PM was calculated for all essential biomass components using default parameters. The PM for all biomass components, excluding histidine, was unchanged and the PM for histidine was reported. The PM for histidine was seen to match the theoretical values based on our combinatorial theory. The theoretical values were calculated using the formula in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2 C</xref>, where <italic>n</italic> corresponds to the number of main intermediate metabolites that remain connected to the end product (L-histidine). For our analysis of the histidine pathway across all 456 oral microbiome metabolic networks, the histidine pathway sum was the total number of reactions in the histidine pathway and the pathway length was the total number of reactions starting at histidine and counting until the first missing reaction. Both values were compared to the PM values of each organism for histidine by Spearman’s rank correlation.</p></sec><sec id="s4-6"><title>Producibility analysis shows improved tolerance to missing reactions compared to flux balance analysis</title><p>We demonstrate the performance of our method on a network with missing reactions on perturbed <italic>E. coli</italic> iJO1366 metabolic network by randomly removing reactions and observing the results of flux balance analysis (FBA) and our producibility metric (PM). The iJO1366 metabolic network consists of 2583 reactions, and was perturbed by removing <italic>n</italic> random reactions (<italic>n</italic> = 4, 16, 64, 256, 1024). The biomass reactions (full and core) and the maintenance reaction were not candidates to be randomly removed. For each value of <italic>n</italic>, 50 different randomly perturbed metabolic networks were generated (a total of 250 metabolic networks). For each of these networks, the core biomass reaction flux was optimized using FBA in a complete medium and a minimal glucose medium and the biomass flux was recorded. Next, the PM for all core biomass metabolites, excluding those with consistent PM of 0 (ex. metal ions), were calculated using our method. The accuracy of each method was calculated using a quantitative difference measure and a biomass production measure. For FBA the quantitative difference measure was calculated as the absolute value of the difference between the original biomass flux and the perturbed biomass flux. For the PM the quantitative difference measure was calculated as the sum of the absolute value of the differences between the PM value of each metabolite in the original model and the perturbed models. Note that for both FBA and the PM this measure is equivalent to the L1 norm of the difference between the original network metric and the perturbed network metric. The accuracy was measured as one minus the normalized difference measure. Means and standard errors across the 50 different randomly perturbed metabolic networks were calculated and reported. The biomass production measure was calculated in FBA as the fraction of perturbed metabolic networks that could produce biomass flux greater than 1% of the original optimal biomass flux. The biomass production measure was calculated for the PM as the fraction of perturbed metabolic networks that had PM for all biomass components analyzed above a specified threshold. Thresholds of 0.1 and 0.6 were analyzed and reported.</p></sec><sec id="s4-7"><title>Metabolite producibility points to putative metabolic mechanisms for <italic>E. coli</italic> auxotroph co-cultures</title><p>We analyzed experimental data from <italic>E. coli</italic> auxotrophs using our PM metric. Experimental data were taken from the supplementary growth data of <xref ref-type="bibr" rid="bib116">Wintermute and Silver (2010)</xref>. The growth data used were the mean of the day 4 replicates 1 and 2. <italic>E. coli</italic> auxotrophs were modeled using the iJO1366 metabolic network. All reactions related to a gene, including those involving isoenzymes, were knocked out from the model by setting the upper and lower bound of the reaction to zero. Isoenzyme related reactions were included based on prior evidence that this improves performance of metabolic modeling of auxotrophs (<xref ref-type="bibr" rid="bib52">Jacobs et al., 2017</xref>). The PM was calculated for all biomass components for each auxotroph metabolic network using default parameters consistent with other PM calculations in this study. The PM distance between auxotrophs was calculated as the L1 norm of the difference between two auxotrophs PM vectors. Additional details on PM distance can be found in methods section <italic>Metabolic similarity correlates with microbial co-occurrence in the human oral microbiome</italic>. The correlation between PM distance and experimentally measured growth matrices was assessed using a Mantel permutation test with 10,000 permutations, and calculating the correlation of the upper triangle of the matrices. Additional details on the Mantel permutation test can be found in the methods section <italic>Metabolic similarity correlates with microbial co-occurrence in the human oral microbiome</italic>.</p></sec><sec id="s4-8"><title>Reconstruction of human oral microbiome metabolic networks</title><p>A set of 456 draft metabolic networks were reconstructed for oral microbiome strains. Strains were chosen to match the sequences chosen for dynamic annotation on HOMD which cover at least one strain for each sequenced species and repeated strains for sequences of particular interest for the human oral microbiome. Several strains were additionally selected due to our interest in fastidious and uncultivated organisms. These included eight uncultivated or recently co-cultivated strains. When considering the taxa TM7 and <italic>Tannerella</italic> sp. oral taxon 286, we chose to include the most recent genome sequences from co-cultivation experiments, although there are several additional single-cell and metagenome assembled sequences available for <italic>Tannerella</italic> sp. oral taxon 286 and TM7 (<xref ref-type="bibr" rid="bib55">Kantor et al., 2013</xref>; <xref ref-type="bibr" rid="bib70">Marcy et al., 2007</xref>; <xref ref-type="bibr" rid="bib8">Beall et al., 2014</xref>; <xref ref-type="bibr" rid="bib2">Albertsen et al., 2013</xref>; <xref ref-type="bibr" rid="bib92">Podar et al., 2007</xref>). The host strains <italic>Actinomyces odontolyticus</italic> XH001, <italic>Pseudopropionibacterium propionicum</italic> F0700, and <italic>Pseudopropionibacterium propionicum</italic> F0230a were included due to their support of TM7 organisms. All genomes were either found in the KBase central data repository or manually annotated with RAST and uploaded to KBase (<xref ref-type="bibr" rid="bib4">Arkin et al., 2018</xref>; <xref ref-type="bibr" rid="bib86">Overbeek et al., 2014</xref>; <xref ref-type="bibr" rid="bib5">Aziz et al., 2008</xref>; <xref ref-type="bibr" rid="bib16">Brettin et al., 2015</xref>). Strains that were dynamically annotated on HOMD but could not be found on KBase, were not of interest due to uncultivability, and already had a representative strain from their matching species were not included in our set of strains. Several naming discrepancies existed between KBase and HOMD, which are highlighted in the KBase download notes column of <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>. All metabolic networks were reconstructed using a KBase narrative containing all of the genomes and metabolic networks from this work, which is available to be copied, viewed, edited, or shared at <ext-link ext-link-type="uri" xlink:href="https://narrative.kbase.us/narrative/ws.27853.obj.935">https://narrative.kbase.us/narrative/ws.27853.obj.935</ext-link>. Metabolic networks were reconstructed for each strain with automatic assignment of Gram-stain, and without gap-filling. Metabolic network reconstructions were then downloaded from KBase as SBML files and converted to COBRA. mat files using the COBRA command <italic>readCbModel</italic>. Metadata related to all organisms and metabolic networks are available in <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>.</p></sec><sec id="s4-9"><title>Large-scale patterns in biosynthetic capabilities identified across the human oral microbiome</title><p>We investigated the large-scale biosynthetic properties of the human oral microbiome by analyzing reconstructed metabolic networks for 456 different oral microbiome strains. For each metabolic network we calculated the PM value for 88 individual biomass components (40,128 total PM calculations). The biomass components were chosen to be the union of the set of default KBase Gram-positive and Gram-negative biomass compositions (see <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref> for details). The metabolites sulfate and phosphate were not included, while the metabolite H<sub>2</sub>O was included as a positive control. The calculations were parallelized across metabolic networks and metabolites using the Boston University shared computing cluster to improve computation time. The PM values were stored as a matrix of organisms by metabolites PM values. This matrix was analyzed using hierarchical clustering based on average differences between groups. The matrix was clustered and visualized using the R package <italic>pheatmap</italic>.</p><p>For the comparison of average PM values and genome size, genome size was taken from KBase and added to <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>. We used regression modeling to identify the broad relationship between genome size, taxonomy, and the average PM value. We fit PM values to linear and quadratic models of log genome size:<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo>:</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">c</mml:mi><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">c</mml:mi><mml:mn>2</mml:mn><mml:mo>∗</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">z</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Q</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mo>:</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">c</mml:mi><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">c</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>∗</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">z</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">c</mml:mi><mml:mn>3</mml:mn><mml:mo>∗</mml:mo><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">z</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Nominal taxonomic parameters were added to these models to determine if they could improve the models prediction of PM values. Gram-stain, and taxonomic labels from phylum to genus were used as nominal taxonomic parameters. For each taxonomic level, each label was added as an additional nominal parameter, for example: adding the predictor of phylum meant adding 12 independent variables, one for each different phylum. Gram-stain was assigned based on KBase default assignments. Taxonomic labels were assigned based on human oral microbiome database taxonomy annotations. Regression models were developed using the MATLAB command <italic>fitlm</italic>. The AIC and BIC were calculated to assess model improvement upon subsequent addition of taxonomic parameters using the MATLAB command <italic>aicbic</italic>.</p></sec><sec id="s4-10"><title>Taxonomic trends capture biosynthetic patterns across human oral microbiome organisms</title><p>We investigated specific trends in metabolite PM values related to taxonomy by analyzing the clustered matrix of PM values. Additionally, a regression model was used to provide quantitative insight. The base regression model was a quadratic model using the log of genome size as the predictor of the specific PM value for a certain metabolite across all organisms:<disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>∗</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="italic">g</mml:mi><mml:mi mathvariant="italic">e</mml:mi><mml:mi mathvariant="italic">n</mml:mi><mml:mi mathvariant="italic">o</mml:mi><mml:mi mathvariant="italic">m</mml:mi><mml:mi mathvariant="italic">e</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext><mml:mi mathvariant="italic">s</mml:mi><mml:mi mathvariant="italic">i</mml:mi><mml:mi mathvariant="italic">z</mml:mi><mml:mi mathvariant="italic">e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mn>3</mml:mn><mml:mo>∗</mml:mo><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="italic">g</mml:mi><mml:mi mathvariant="italic">e</mml:mi><mml:mi mathvariant="italic">n</mml:mi><mml:mi mathvariant="italic">o</mml:mi><mml:mi mathvariant="italic">m</mml:mi><mml:mi mathvariant="italic">e</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext><mml:mi mathvariant="italic">s</mml:mi><mml:mi mathvariant="italic">i</mml:mi><mml:mi mathvariant="italic">z</mml:mi><mml:mi mathvariant="italic">e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Nominal taxonomic parameters were then added one at a time. Taxonomic parameters of Gram-stain (+ or -), phylum (belonging to 1 of 12 phyla or not) and class (belonging to 1 of 22 classes or not) were used. We calculated the log likelihood ratio by taking difference between the log likelihood of the base quadratic model of genome size and the model including a specific taxonomic parameter. We identified highly significant relationships using an alpha value of 10<sup>−6</sup> and Bonferroni correction for multiple hypothesis testing.</p></sec><sec id="s4-11"><title>Organic acid production predicted for human oral microbiome organisms</title><p>Organic acid production was assessed by calculating the PM for nine different organic acids for each human oral microbiome organism. The organic acids analyzed were: acetate, formate, L-lactate, succinate, propionate, D-lactate, butyrate, isobutyrate, and isovalerate. The organic acids were chosen by searching through the literature for those that were found to be relevant for oral health (<xref ref-type="bibr" rid="bib53">Jorth et al., 2014</xref>; <xref ref-type="bibr" rid="bib108">Takahashi, 2015</xref>). While this is certainly not an exhaustive list of organic acids, it demonstrates the applicability of our method to non-biomass metabolites. The PM was calculated using default parameters consistent with other calculations in this study. The organic acids chosen where included in <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>, and the PM results were included in <xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref>.</p></sec><sec id="s4-12"><title>Metabolite producibility in a protein vs. carbohydrate-enriched environment</title><p>The production of metabolites in variable environments was implemented in our method by re-calculating the PM for all metabolites in a protein-enriched and carbohydrate-enriched environment for two organisms: a saccharolytic organism (<italic>Streptococcus mutans</italic> UA 159) and a proteolytic organism (<italic>Porphyromonas gingivalis</italic> W83). These organisms were chosen because they are known to be associated with oral diseases involving either saccharolytic or proteolytic activity, namely dental carries and periodontitis (<xref ref-type="bibr" rid="bib112">Wade, 2013</xref>; <xref ref-type="bibr" rid="bib108">Takahashi, 2015</xref>). The protein-rich environment was simulated by fixing all 20 amino acids to always be present (<italic>P<sub>in</sub></italic> = 1), by adding them to the <italic>fixon</italic> parameter, and then adding all other metabolites randomly. As in the other PM calculations, the target metabolite is never added or fixed to be on. The carbohydrate-enriched environment was simulated in a similar manner by fixing D-glucose to always be present.</p></sec><sec id="s4-13"><title>Metabolic similarity correlates with microbial co-occurrence in the human oral microbiome</title><p>Co-occurrence data were collected from supplementary Dataset_S1 of <xref ref-type="bibr" rid="bib43">Friedman and Alm (2012)</xref>. Seven different oral sites were analyzed and co-occurrence calculated with SparCC and Pearson’s correlation were analyzed. Various pairwise metabolic metrics where compared to the patterns of microbial co-occurrence, and significant correlations were found using a Mantel permutation test with 10,000 permutations. These pairwise metabolic metrics were likewise compared to each other using a Mantel permutation test with 1000 permutations. Additional details on metrics used and Mantel test are described below. To compare the pairwise metabolic metrics with microbial co-occurrence, we collapsed all interaction metrics to the genus level by averaging scores across species in the same genus such that we could match predictions from our method with co-occurrence based on 16S rRNA sequencing, which was mapped at best to the genus level.</p><p>Calculation of various metrics for correlation analysis:</p><p><italic>PM distance</italic> – Calculated as the L1 norm of the difference between the PM vectors of any two organisms. The L1 norm is calculated as the sum of the absolute values of the differences of all of the elements of the vector.<disp-formula id="equ7"><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">P</mml:mi><mml:mi mathvariant="italic">M</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext><mml:mi mathvariant="italic">d</mml:mi><mml:mi mathvariant="italic">i</mml:mi><mml:mi mathvariant="italic">s</mml:mi><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">n</mml:mi><mml:mi mathvariant="italic">c</mml:mi><mml:mi mathvariant="italic">e</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><italic>PM complementarity</italic> – Calculated as the complementarity between two organisms, quantifying the amount by which one organism can supplement the PM of another organism. For organism A supplementing B, the metric is calculated by summing over i = 1 to N metabolites.<disp-formula id="equ8"><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="italic">P</mml:mi><mml:mi mathvariant="italic">M</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext><mml:mi mathvariant="italic">c</mml:mi><mml:mi mathvariant="italic">o</mml:mi><mml:mi mathvariant="italic">m</mml:mi><mml:mi mathvariant="italic">p</mml:mi><mml:mi mathvariant="italic">l</mml:mi><mml:mi mathvariant="italic">e</mml:mi><mml:mi mathvariant="italic">m</mml:mi><mml:mi mathvariant="italic">e</mml:mi><mml:mi mathvariant="italic">n</mml:mi><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">r</mml:mi><mml:mi mathvariant="italic">i</mml:mi><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">y</mml:mi></mml:mrow><mml:msub><mml:mtext> </mml:mtext><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><italic>Seed distance</italic> <bold>–</bold> Calculated as the L1 norm of the difference between the seed vectors of any two organisms. The seed vectors were calculated using the NetSeed method (<xref ref-type="bibr" rid="bib15">Borenstein et al., 2008</xref>; <xref ref-type="bibr" rid="bib21">Carr and Borenstein, 2012</xref>). The code used to calculate the seeds was taken from <ext-link ext-link-type="uri" xlink:href="http://elbo.gs.washington.edu/software_netcooperate.html">http://elbo.gs.washington.edu/software_netcooperate.html</ext-link>. The <italic>minComponentSize</italic> parameter was set to 0 and the <italic>onlyGiant</italic> component parameter was set to false.</p><p><italic>Seed competition</italic> <bold>–</bold> Calculated following the formula used in the NetCmpt method (<xref ref-type="bibr" rid="bib59">Kreimer et al., 2012</xref>; <xref ref-type="bibr" rid="bib64">Levy and Borenstein, 2013</xref>). The competition from A to B is the fraction of seeds of organism A that are also seeds of organism B. The threshold for seed vs. non-seed was a seed score of greater than 0.</p><p><italic>Seed complementarity</italic> – Calculated following the formula used in the NetCooperate method (<xref ref-type="bibr" rid="bib63">Levy et al., 2015</xref>; <xref ref-type="bibr" rid="bib64">Levy and Borenstein, 2013</xref>). The complementarity from A to B is the fraction of seeds of organism A that are in the metabolic network of organism B but not seeds of organism B. This metric was calculated using code from <ext-link ext-link-type="uri" xlink:href="http://elbo.gs.washington.edu/software_netcooperate.html">http://elbo.gs.washington.edu/software_netcooperate.html</ext-link>.</p><p><italic>Reaction distance</italic> – Calculated as the L1 norm of the difference between the reaction vectors of any two organisms. Reaction vectors were vectors of 0’s and 1’s indicating which metabolic reactions where present in the draft metabolic network of each organism.</p><p><italic>Reaction Jaccard</italic> – Calculated as the Jaccard distance between the reaction vectors of any two organisms. The Jaccard distance is calculated as one minus the intersect of the vectors divided by the union of the vectors. In other words, it is one minus the fraction of shared metabolic reactions.</p><p><italic>Mantel test</italic> – A Mantel test was used to assess correlation between matrices as done in <xref ref-type="bibr" rid="bib64">Levy and Borenstein (2013)</xref>. The Spearman’s rank correlation was calculated for all elements of the two matrices (excluding the diagonal). Then the first matrix was permuted 10,000 times, and the number of times the correlation was stronger than the original correlation was recorded. The p-value was calculated using the formula below, where <italic>n</italic> is the number of times the permuted correlation was stronger (absolute value of the correlation coefficient ρ was larger) than the original and <italic>N</italic> is the number of permutations.<disp-formula id="equ9"><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="italic">M</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">n</mml:mi><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">e</mml:mi><mml:mi mathvariant="italic">l</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext><mml:mi mathvariant="italic">P</mml:mi><mml:mtext mathvariant="italic"> </mml:mtext><mml:mi mathvariant="italic">v</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">l</mml:mi><mml:mi mathvariant="italic">u</mml:mi><mml:mi mathvariant="italic">e</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Partial Mantel tests were calculated in a similar manner, but using partial correlations between the first and second matrix while controlling for a third matrix. For the partial correlation permutations, only the first matrix is permuted and the partial correlation is recalculated.</p></sec><sec id="s4-14"><title>Biosynthetic properties predicted in a cluster of fastidious human oral microbiome organisms</title><p>A subset of fastidious organisms identified from the larger clustered matrix of all oral microbiome organisms PM values were re-clustered based on average distances and analyzed further. Additionally, three previously uncultivated TM7 organisms (TM7x, AC001, and PM004) and several host strains for the uncultivated TM7 (<italic>Actinomyces odontolyticus</italic> XH001, <italic>Pseudopropionibacterium propionicum</italic> F0700, and <italic>Pseudopropionibacterium propionicum</italic> F0230a) were re-clustered and analyzed. Metabolites were ranked and analyzed based on the difference between the average PM value of separate groups. Three different rankings were used throughout this analysis: (1) average fastidious cluster organisms PM subtracted from average oral microbiome organisms PM, (2) average <italic>Mycoplasma</italic> PM subtracted from average TM7 PM (3), average TM7 host PM subtracted from TM7 PM. Correlations between amino acid biosynthetic cost and difference in PM were calculated using Spearman’s rank correlation between the amino acid cost (<xref ref-type="bibr" rid="bib1">Akashi and Gojobori, 2002</xref>) and the difference in average PM between average and fastidious organisms, or between hosts and TM7, using the MATLAB command <italic>corr</italic>.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We would like to acknowledge our collaborators at the Forsyth institute for providing valuable knowledge on the human oral microbiome and uncultivated microorganisms. In particular, we would like to acknowledge Andrew J Collins and Pallavi P Murugkar for providing genome information on their TM7 strains AC001 and PM004 in coculture with <italic>Pseudopropionibacterium propionicum</italic> ahead of their work being accepted for publication. We would also like to acknowledge all of the members of the Segrè lab and Daniel Sher of Haifa University for helpful discussions and comments on this work. Research reported in this publication was supported by The National Institute of Dental and Craniofacial Research of the National Institutes of Health under award numbers R37DE016937, R01DE024468, by National Institutes of Health grants R01GM121950 and Sub_P30DK036836_P and F, by the Defense Advanced Research Projects Agency (Purchase Request No. HR0011515303, Contract No. HR0011-15-C-0091), the US Department of Energy (DE-SC0012627), the Boston University Interdisciplinary Biomedical Research Office, and by the Boston University training program in quantitative biology and physiology under Ruth L Kirschstein National Research Service Award T32GM008764 from the National Institute of General Medical Sciences. The content is solely the responsibility of the authors and does not necessarily represent the official views of the granting agencies.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing—original draft</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Funding acquisition, Investigation, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Supervision, Funding acquisition, Investigation, Writing—original draft, Project administration</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><object-id pub-id-type="doi">10.7554/eLife.39733.021</object-id><label>Supplementary file 1.</label><caption><title>Visualization of TM7 metabolic networks and producibility metric: TM7x HMT952.</title><p>Cytoscape files are provided for visualizing the metabolic networks of the TM7 organisms analyzed in this work. The producibility metric (PM) for all intracellular metbolites is shown for each network. Networks are represented as bipartite networks with reactions as squares and metabolties as circles. Black borders are used to indicate irreversible reactions, reversible reactions have no border. Intracellular metabolite color indicates calculated PM (blue = low, red = high).</p></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-39733-supp1-v2.cys"/></supplementary-material><supplementary-material id="supp2"><object-id pub-id-type="doi">10.7554/eLife.39733.022</object-id><label>Supplementary file 2.</label><caption><title>Visualization of TM7 metabolic networks and producibility metric: AC001 HMT488.</title><p>Cytoscape files are provided for visualizing the metabolic networks of the TM7 organisms analyzed in this work. The producibility metric (PM) for all intracellular metbolites is shown for each network. Networks are represented as bipartite networks with reactions as squares and metabolties as circles. Black borders are used to indicate irreversible reactions, reversible reactions have no border. Intracellular metabolite color indicates calculated PM (blue = low, red = high).</p></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-39733-supp2-v2.cys"/></supplementary-material><supplementary-material id="supp3"><object-id pub-id-type="doi">10.7554/eLife.39733.023</object-id><label>Supplementary file 3.</label><caption><title>Visualization of TM7 metabolic networks and producibility metric: PM004 HMT955.</title><p>Cytoscape files are provided for visualizing the metabolic networks of the TM7 organisms analyzed in this work. The producibility metric (PM) for all intracellular metbolites is shown for each network. Networks are represented as bipartite networks with reactions as squares and metabolties as circles. Black borders are used to indicate irreversible reactions, reversible reactions have no border. Intracellular metabolite color indicates calculated PM (blue = low, red = high).</p></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-39733-supp3-v2.cys"/></supplementary-material><supplementary-material id="supp4"><object-id pub-id-type="doi">10.7554/eLife.39733.024</object-id><label>Supplementary file 4.</label><caption><title>Oral microbiome organisms’ metadata.</title><p>Metadata related to the oral microbiome organisms analyzed in this work is provided.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-39733-supp4-v2.xlsx"/></supplementary-material><supplementary-material id="supp5"><object-id pub-id-type="doi">10.7554/eLife.39733.025</object-id><label>Supplementary file 5.</label><caption><title>Metabolites’ metadata.</title><p>Metadata related to the metabolites analyzed in this work is provided.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-39733-supp5-v2.xlsx"/></supplementary-material><supplementary-material id="supp6"><object-id pub-id-type="doi">10.7554/eLife.39733.026</object-id><label>Supplementary file 6.</label><caption><title>Producibility metric matrix.</title><p>The producibility metric (PM) for each organism (shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>) is provided.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-39733-supp6-v2.xlsx"/></supplementary-material><supplementary-material id="supp7"><object-id pub-id-type="doi">10.7554/eLife.39733.027</object-id><label>Supplementary file 7.</label><caption><title>Correlation of inter-organism metabolic metrics with co-occurrence.</title><p>Correlation data from the analysis presented in Results section ‘<italic>Metabolic similarity correlates with microbial co-occurrence in the human oral microbiome</italic>’ is provided. Correlations between inter-organism metabolic metrics and microbial co-occurrences from <xref ref-type="bibr" rid="bib43">Friedman and Alm (2012)</xref> were calculated using a Mantel test with 10,000 permutations.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-39733-supp7-v2.xlsx"/></supplementary-material><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.39733.028</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-39733-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All scripts and metabolic network data used for generating the manuscript results are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/segrelab/biosynthetic_network_robustness">https://github.com/segrelab/biosynthetic_network_robustness</ext-link>) (f82f1e0; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/biosynthetic_network_robustness">https://github.com/elifesciences-publications/biosynthetic_network_robustness</ext-link>). All genomes used to derive the metabolic networks are available from the Human Oral Microbiome Database (<ext-link ext-link-type="uri" xlink:href="http://www.homd.org/">http://www.homd.org/</ext-link>), except for three strains whose genomes are available on NCBI GenBank, with the following accession numbers: Saccharibacteria (TM7) bacterium HMT-488 strain AC001: NCBI CP040003, Saccharibacteria (TM7) bacterium HMT-955 strain PM004: NCBI CP040008, Pseudopropionibacterium propionicum HMT-439 strain F0700: NCBI CP040007. The data shown in the figures are also available in the form of supplementary tables included in the article.</p><p>The following datasets were generated:</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akashi</surname> <given-names>H</given-names></name><name><surname>Gojobori</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Metabolic efficiency and amino acid composition in the proteomes of <italic>Escherichia coli</italic> and <italic>Bacillus subtilis</italic></article-title><source>PNAS</source><volume>99</volume><fpage>3695</fpage><lpage>3700</lpage><pub-id pub-id-type="doi">10.1073/pnas.062526999</pub-id><pub-id pub-id-type="pmid">11904428</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albertsen</surname> <given-names>M</given-names></name><name><surname>Hugenholtz</surname> <given-names>P</given-names></name><name><surname>Skarshewski</surname> <given-names>A</given-names></name><name><surname>Nielsen</surname> <given-names>KL</given-names></name><name><surname>Tyson</surname> <given-names>GW</given-names></name><name><surname>Nielsen</surname> <given-names>PH</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genome sequences of rare, uncultured bacteria obtained by differential coverage binning of multiple metagenomes</article-title><source>Nature Biotechnology</source><volume>31</volume><fpage>533</fpage><lpage>538</lpage><pub-id pub-id-type="doi">10.1038/nbt.2579</pub-id><pub-id pub-id-type="pmid">23707974</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andrade</surname> <given-names>R</given-names></name><name><surname>Wannagat</surname> <given-names>M</given-names></name><name><surname>Klein</surname> <given-names>CC</given-names></name><name><surname>Acuña</surname> <given-names>V</given-names></name><name><surname>Marchetti-Spaccamela</surname> <given-names>A</given-names></name><name><surname>Milreu</surname> <given-names>PV</given-names></name><name><surname>Stougie</surname> <given-names>L</given-names></name><name><surname>Sagot</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Enumeration of minimal stoichiometric precursor sets in metabolic networks</article-title><source>Algorithms for Molecular Biology</source><volume>11</volume><fpage>25</fpage><pub-id pub-id-type="doi">10.1186/s13015-016-0087-3</pub-id><pub-id pub-id-type="pmid">27679654</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arkin</surname> <given-names>AP</given-names></name><name><surname>Cottingham</surname> <given-names>RW</given-names></name><name><surname>Henry</surname> <given-names>CS</given-names></name><name><surname>Harris</surname> <given-names>NL</given-names></name><name><surname>Stevens</surname> <given-names>RL</given-names></name><name><surname>Maslov</surname> <given-names>S</given-names></name><name><surname>Dehal</surname> <given-names>P</given-names></name><name><surname>Ware</surname> <given-names>D</given-names></name><name><surname>Perez</surname> <given-names>F</given-names></name><name><surname>Canon</surname> <given-names>S</given-names></name><name><surname>Sneddon</surname> <given-names>MW</given-names></name><name><surname>Henderson</surname> <given-names>ML</given-names></name><name><surname>Riehl</surname> <given-names>WJ</given-names></name><name><surname>Murphy-Olson</surname> <given-names>D</given-names></name><name><surname>Chan</surname> <given-names>SY</given-names></name><name><surname>Kamimura</surname> <given-names>RT</given-names></name><name><surname>Kumari</surname> <given-names>S</given-names></name><name><surname>Drake</surname> <given-names>MM</given-names></name><name><surname>Brettin</surname> <given-names>TS</given-names></name><name><surname>Glass</surname> <given-names>EM</given-names></name><name><surname>Chivian</surname> <given-names>D</given-names></name><name><surname>Gunter</surname> <given-names>D</given-names></name><name><surname>Weston</surname> <given-names>DJ</given-names></name><name><surname>Allen</surname> <given-names>BH</given-names></name><name><surname>Baumohl</surname> <given-names>J</given-names></name><name><surname>Best</surname> <given-names>AA</given-names></name><name><surname>Bowen</surname> <given-names>B</given-names></name><name><surname>Brenner</surname> <given-names>SE</given-names></name><name><surname>Bun</surname> <given-names>CC</given-names></name><name><surname>Chandonia</surname> <given-names>JM</given-names></name><name><surname>Chia</surname> <given-names>JM</given-names></name><name><surname>Colasanti</surname> <given-names>R</given-names></name><name><surname>Conrad</surname> <given-names>N</given-names></name><name><surname>Davis</surname> <given-names>JJ</given-names></name><name><surname>Davison</surname> <given-names>BH</given-names></name><name><surname>DeJongh</surname> <given-names>M</given-names></name><name><surname>Devoid</surname> <given-names>S</given-names></name><name><surname>Dietrich</surname> <given-names>E</given-names></name><name><surname>Dubchak</surname> <given-names>I</given-names></name><name><surname>Edirisinghe</surname> <given-names>JN</given-names></name><name><surname>Fang</surname> <given-names>G</given-names></name><name><surname>Faria</surname> <given-names>JP</given-names></name><name><surname>Frybarger</surname> <given-names>PM</given-names></name><name><surname>Gerlach</surname> <given-names>W</given-names></name><name><surname>Gerstein</surname> <given-names>M</given-names></name><name><surname>Greiner</surname> <given-names>A</given-names></name><name><surname>Gurtowski</surname> <given-names>J</given-names></name><name><surname>Haun</surname> <given-names>HL</given-names></name><name><surname>He</surname> <given-names>F</given-names></name><name><surname>Jain</surname> <given-names>R</given-names></name><name><surname>Joachimiak</surname> <given-names>MP</given-names></name><name><surname>Keegan</surname> <given-names>KP</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name><name><surname>Kumar</surname> <given-names>V</given-names></name><name><surname>Land</surname> <given-names>ML</given-names></name><name><surname>Meyer</surname> <given-names>F</given-names></name><name><surname>Mills</surname> <given-names>M</given-names></name><name><surname>Novichkov</surname> <given-names>PS</given-names></name><name><surname>Oh</surname> <given-names>T</given-names></name><name><surname>Olsen</surname> <given-names>GJ</given-names></name><name><surname>Olson</surname> <given-names>R</given-names></name><name><surname>Parrello</surname> <given-names>B</given-names></name><name><surname>Pasternak</surname> <given-names>S</given-names></name><name><surname>Pearson</surname> <given-names>E</given-names></name><name><surname>Poon</surname> <given-names>SS</given-names></name><name><surname>Price</surname> <given-names>GA</given-names></name><name><surname>Ramakrishnan</surname> <given-names>S</given-names></name><name><surname>Ranjan</surname> <given-names>P</given-names></name><name><surname>Ronald</surname> <given-names>PC</given-names></name><name><surname>Schatz</surname> <given-names>MC</given-names></name><name><surname>Seaver</surname> <given-names>SMD</given-names></name><name><surname>Shukla</surname> <given-names>M</given-names></name><name><surname>Sutormin</surname> <given-names>RA</given-names></name><name><surname>Syed</surname> <given-names>MH</given-names></name><name><surname>Thomason</surname> <given-names>J</given-names></name><name><surname>Tintle</surname> <given-names>NL</given-names></name><name><surname>Wang</surname> <given-names>D</given-names></name><name><surname>Xia</surname> <given-names>F</given-names></name><name><surname>Yoo</surname> <given-names>H</given-names></name><name><surname>Yoo</surname> <given-names>S</given-names></name><name><surname>Yu</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>KBase: the united states department of energy systems biology knowledgebase</article-title><source>Nature Biotechnology</source><volume>36</volume><fpage>566</fpage><lpage>569</lpage><pub-id pub-id-type="doi">10.1038/nbt.4163</pub-id><pub-id pub-id-type="pmid">29979655</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aziz</surname> <given-names>RK</given-names></name><name><surname>Bartels</surname> <given-names>D</given-names></name><name><surname>Best</surname> <given-names>AA</given-names></name><name><surname>DeJongh</surname> <given-names>M</given-names></name><name><surname>Disz</surname> <given-names>T</given-names></name><name><surname>Edwards</surname> <given-names>RA</given-names></name><name><surname>Formsma</surname> <given-names>K</given-names></name><name><surname>Gerdes</surname> <given-names>S</given-names></name><name><surname>Glass</surname> <given-names>EM</given-names></name><name><surname>Kubal</surname> <given-names>M</given-names></name><name><surname>Meyer</surname> <given-names>F</given-names></name><name><surname>Olsen</surname> <given-names>GJ</given-names></name><name><surname>Olson</surname> <given-names>R</given-names></name><name><surname>Osterman</surname> <given-names>AL</given-names></name><name><surname>Overbeek</surname> <given-names>RA</given-names></name><name><surname>McNeil</surname> <given-names>LK</given-names></name><name><surname>Paarmann</surname> <given-names>D</given-names></name><name><surname>Paczian</surname> <given-names>T</given-names></name><name><surname>Parrello</surname> <given-names>B</given-names></name><name><surname>Pusch</surname> <given-names>GD</given-names></name><name><surname>Reich</surname> <given-names>C</given-names></name><name><surname>Stevens</surname> <given-names>R</given-names></name><name><surname>Vassieva</surname> <given-names>O</given-names></name><name><surname>Vonstein</surname> <given-names>V</given-names></name><name><surname>Wilke</surname> <given-names>A</given-names></name><name><surname>Zagnitko</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The RAST server: rapid annotations using subsystems technology</article-title><source>BMC Genomics</source><volume>9</volume><fpage>75</fpage><pub-id pub-id-type="doi">10.1186/1471-2164-9-75</pub-id><pub-id pub-id-type="pmid">18261238</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Barabási</surname> <given-names>A-L</given-names></name></person-group><chapter-title>Network Robustness</chapter-title><year iso-8601-date="2015">2015</year><source>Network Science</source><publisher-loc>Cambridge</publisher-loc><publisher-name>University Press</publisher-name></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Basler</surname> <given-names>G</given-names></name><name><surname>Nikoloski</surname> <given-names>Z</given-names></name><name><surname>Ebenhöh</surname> <given-names>O</given-names></name><name><surname>Handorf</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Biosynthetic potentials from species-specific metabolic networks</article-title><source>Genome Informatics. International Conference on Genome Informatics</source><volume>20</volume><fpage>135</fpage><lpage>148</lpage><pub-id pub-id-type="pmid">19425129</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beall</surname> <given-names>CJ</given-names></name><name><surname>Campbell</surname> <given-names>AG</given-names></name><name><surname>Dayeh</surname> <given-names>DM</given-names></name><name><surname>Griffen</surname> <given-names>AL</given-names></name><name><surname>Podar</surname> <given-names>M</given-names></name><name><surname>Leys</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Single cell genomics of uncultured, health-associated tannerella BU063 (Oral taxon 286) and comparison to the closely related pathogen tannerella forsythia</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e89398</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0089398</pub-id><pub-id pub-id-type="pmid">24551246</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bedree</surname> <given-names>JK</given-names></name><name><surname>Bor</surname> <given-names>B</given-names></name><name><surname>Cen</surname> <given-names>L</given-names></name><name><surname>Edlund</surname> <given-names>A</given-names></name><name><surname>Lux</surname> <given-names>R</given-names></name><name><surname>McLean</surname> <given-names>JS</given-names></name><name><surname>Shi</surname> <given-names>W</given-names></name><name><surname>He</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Quorum sensing modulates the Epibiotic-Parasitic relationship between <italic>Actinomyces odontolyticus</italic> and Its Saccharibacteria epibiont, a <italic>Nanosynbacter lyticus</italic> Strain, TM7x</article-title><source>Frontiers in Microbiology</source><volume>9</volume><elocation-id>2049</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2018.02049</pub-id><pub-id pub-id-type="pmid">30319555</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Bernstein</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>biosynthetic_network_robustness</data-title><source>Github</source><version designator="f82f1e0">f82f1e0</version><ext-link ext-link-type="uri" xlink:href="https://github.com/segrelab/biosynthetic_network_robustness">https://github.com/segrelab/biosynthetic_network_robustness</ext-link></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biggs</surname> <given-names>MB</given-names></name><name><surname>Medlock</surname> <given-names>GL</given-names></name><name><surname>Kolling</surname> <given-names>GL</given-names></name><name><surname>Papin</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Metabolic network modeling of microbial communities</article-title><source>Wiley Interdisciplinary Reviews. Systems Biology and Medicine</source><volume>7</volume><fpage>317</fpage><lpage>334</lpage><pub-id pub-id-type="doi">10.1002/wsbm.1308</pub-id><pub-id pub-id-type="pmid">26109480</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biggs</surname> <given-names>MB</given-names></name><name><surname>Papin</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Managing uncertainty in metabolic network structure and improving predictions using EnsembleFBA</article-title><source>PLOS Computational Biology</source><volume>13</volume><fpage>e1005413</fpage><lpage>e1005425</lpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005413</pub-id><pub-id pub-id-type="pmid">28263984</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bor</surname> <given-names>B</given-names></name><name><surname>Poweleit</surname> <given-names>N</given-names></name><name><surname>Bois</surname> <given-names>JS</given-names></name><name><surname>Cen</surname> <given-names>L</given-names></name><name><surname>Bedree</surname> <given-names>JK</given-names></name><name><surname>Zhou</surname> <given-names>ZH</given-names></name><name><surname>Gunsalus</surname> <given-names>RP</given-names></name><name><surname>Lux</surname> <given-names>R</given-names></name><name><surname>McLean</surname> <given-names>JS</given-names></name><name><surname>He</surname> <given-names>X</given-names></name><name><surname>Shi</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Phenotypic and physiological characterization of the epibiotic interaction between TM7x and its basibiont actinomyces</article-title><source>Microbial Ecology</source><volume>71</volume><fpage>243</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1007/s00248-015-0711-7</pub-id><pub-id pub-id-type="pmid">26597961</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bor</surname> <given-names>B</given-names></name><name><surname>McLean</surname> <given-names>JS</given-names></name><name><surname>Foster</surname> <given-names>KR</given-names></name><name><surname>Cen</surname> <given-names>L</given-names></name><name><surname>To</surname> <given-names>TT</given-names></name><name><surname>Serrato-Guillen</surname> <given-names>A</given-names></name><name><surname>Dewhirst</surname> <given-names>FE</given-names></name><name><surname>Shi</surname> <given-names>W</given-names></name><name><surname>He</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Rapid evolution of decreased host susceptibility drives a stable relationship between ultrasmall parasite TM7x and its bacterial host</article-title><source>PNAS</source><volume>115</volume><fpage>12277</fpage><lpage>12282</lpage><pub-id pub-id-type="doi">10.1073/pnas.1810625115</pub-id><pub-id pub-id-type="pmid">30442671</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borenstein</surname> <given-names>E</given-names></name><name><surname>Kupiec</surname> <given-names>M</given-names></name><name><surname>Feldman</surname> <given-names>MW</given-names></name><name><surname>Ruppin</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Large-scale reconstruction and phylogenetic analysis of metabolic environments</article-title><source>PNAS</source><volume>105</volume><fpage>14482</fpage><lpage>14487</lpage><pub-id pub-id-type="doi">10.1073/pnas.0806162105</pub-id><pub-id pub-id-type="pmid">18787117</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brettin</surname> <given-names>T</given-names></name><name><surname>Davis</surname> <given-names>JJ</given-names></name><name><surname>Disz</surname> <given-names>T</given-names></name><name><surname>Edwards</surname> <given-names>RA</given-names></name><name><surname>Gerdes</surname> <given-names>S</given-names></name><name><surname>Olsen</surname> <given-names>GJ</given-names></name><name><surname>Olson</surname> <given-names>R</given-names></name><name><surname>Overbeek</surname> <given-names>R</given-names></name><name><surname>Parrello</surname> <given-names>B</given-names></name><name><surname>Pusch</surname> <given-names>GD</given-names></name><name><surname>Shukla</surname> <given-names>M</given-names></name><name><surname>Thomason</surname> <given-names>JA</given-names></name><name><surname>Stevens</surname> <given-names>R</given-names></name><name><surname>Vonstein</surname> <given-names>V</given-names></name><name><surname>Wattam</surname> <given-names>AR</given-names></name><name><surname>Xia</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>RASTtk: a modular and extensible implementation of the RAST algorithm for building custom annotation pipelines and annotating batches of genomes</article-title><source>Scientific Reports</source><volume>5</volume><fpage>8365</fpage><pub-id pub-id-type="doi">10.1038/srep08365</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brinig</surname> <given-names>MM</given-names></name><name><surname>Lepp</surname> <given-names>PW</given-names></name><name><surname>Ouverney</surname> <given-names>CC</given-names></name><name><surname>Armitage</surname> <given-names>GC</given-names></name><name><surname>Relman</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Prevalence of bacteria of division TM7 in human subgingival plaque and their association with disease</article-title><source>Applied and Environmental Microbiology</source><volume>69</volume><fpage>1687</fpage><lpage>1694</lpage><pub-id pub-id-type="doi">10.1128/AEM.69.3.1687-1694.2003</pub-id><pub-id pub-id-type="pmid">12620860</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname> <given-names>CT</given-names></name><name><surname>Hug</surname> <given-names>LA</given-names></name><name><surname>Thomas</surname> <given-names>BC</given-names></name><name><surname>Sharon</surname> <given-names>I</given-names></name><name><surname>Castelle</surname> <given-names>CJ</given-names></name><name><surname>Singh</surname> <given-names>A</given-names></name><name><surname>Wilkins</surname> <given-names>MJ</given-names></name><name><surname>Wrighton</surname> <given-names>KC</given-names></name><name><surname>Williams</surname> <given-names>KH</given-names></name><name><surname>Banfield</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Unusual biology across a group comprising more than 15% of domain bacteria</article-title><source>Nature</source><volume>523</volume><fpage>208</fpage><lpage>211</lpage><pub-id pub-id-type="doi">10.1038/nature14486</pub-id><pub-id pub-id-type="pmid">26083755</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Campbell</surname> <given-names>JH</given-names></name><name><surname>O'Donoghue</surname> <given-names>P</given-names></name><name><surname>Campbell</surname> <given-names>AG</given-names></name><name><surname>Schwientek</surname> <given-names>P</given-names></name><name><surname>Sczyrba</surname> <given-names>A</given-names></name><name><surname>Woyke</surname> <given-names>T</given-names></name><name><surname>Söll</surname> <given-names>D</given-names></name><name><surname>Podar</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013a</year><article-title>UGA is an additional glycine codon in uncultured SR1 bacteria from the human microbiota</article-title><source>PNAS</source><volume>110</volume><fpage>5540</fpage><lpage>5545</lpage><pub-id pub-id-type="doi">10.1073/pnas.1303090110</pub-id><pub-id pub-id-type="pmid">23509275</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Campbell</surname> <given-names>AG</given-names></name><name><surname>Campbell</surname> <given-names>JH</given-names></name><name><surname>Schwientek</surname> <given-names>P</given-names></name><name><surname>Woyke</surname> <given-names>T</given-names></name><name><surname>Sczyrba</surname> <given-names>A</given-names></name><name><surname>Allman</surname> <given-names>S</given-names></name><name><surname>Beall</surname> <given-names>CJ</given-names></name><name><surname>Griffen</surname> <given-names>A</given-names></name><name><surname>Leys</surname> <given-names>E</given-names></name><name><surname>Podar</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013b</year><article-title>Multiple single-cell genomes provide insight into functions of uncultured deltaproteobacteria in the human oral cavity</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e59361</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0059361</pub-id><pub-id pub-id-type="pmid">23555659</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carr</surname> <given-names>R</given-names></name><name><surname>Borenstein</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>NetSeed: a network-based reverse-ecology tool for calculating the metabolic interface of an organism with its environment</article-title><source>Bioinformatics</source><volume>28</volume><fpage>734</fpage><lpage>735</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr721</pub-id><pub-id pub-id-type="pmid">22219204</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>T</given-names></name><name><surname>Yu</surname> <given-names>WH</given-names></name><name><surname>Izard</surname> <given-names>J</given-names></name><name><surname>Baranova</surname> <given-names>OV</given-names></name><name><surname>Lakshmanan</surname> <given-names>A</given-names></name><name><surname>Dewhirst</surname> <given-names>FE</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The human oral microbiome database: a web accessible resource for investigating oral microbe taxonomic and genomic information</article-title><source>Database</source><volume>2010</volume><fpage>baq013</fpage><pub-id pub-id-type="doi">10.1093/database/baq013</pub-id><pub-id pub-id-type="pmid">20624719</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choby</surname> <given-names>JE</given-names></name><name><surname>Skaar</surname> <given-names>EP</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Heme synthesis and acquisition in bacterial pathogens</article-title><source>Journal of Molecular Biology</source><volume>428</volume><fpage>3408</fpage><lpage>3428</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2016.03.018</pub-id><pub-id pub-id-type="pmid">27019298</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Clarke</surname> <given-names>B</given-names></name><name><surname>Fokoue</surname> <given-names>E</given-names></name><name><surname>Helen Zhang</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2009">2009</year><source>Principles and Theory for Data Mining and Machine Learning</source><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name><pub-id pub-id-type="doi">10.1007/978-0-387-98135-2</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="data"><person-group person-group-type="author"><name><surname>Collins</surname> <given-names>AJ</given-names></name><name><surname>Murugkar</surname> <given-names>P</given-names></name><name><surname>Chen</surname> <given-names>T</given-names></name><name><surname>Dewhirst</surname> <given-names>FE</given-names></name></person-group><year iso-8601-date="2019">2019a</year><data-title>TM7 phylum sp. oral taxon 488 strain AC001 chromosome, complete genome</data-title><source>GenBank</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/CP040003">CP040003</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="data"><person-group person-group-type="author"><name><surname>Collins</surname> <given-names>AJ</given-names></name><name><surname>Murugkar</surname> <given-names>P</given-names></name><name><surname>Chen</surname> <given-names>T</given-names></name><name><surname>Dewhirst</surname> <given-names>FE</given-names></name></person-group><year iso-8601-date="2019">2019b</year><data-title>TM7 phylum sp. oral taxon 955 strain PM004 chromosome, complete genome</data-title><source>GenBank</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/CP040008">CP040008</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="data"><person-group person-group-type="author"><name><surname>Collins</surname> <given-names>AJ</given-names></name><name><surname>Murugkar</surname> <given-names>P</given-names></name><name><surname>Chen</surname> <given-names>T</given-names></name><name><surname>Dewhirst</surname> <given-names>FE</given-names></name></person-group><year iso-8601-date="2019">2019c</year><data-title>Pseudopropionibacterium propionicum strain F0700 chromosome, complete genome</data-title><source>GenBank</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/CP040007">CP040007</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cook</surname> <given-names>DJ</given-names></name><name><surname>Nielsen</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Genome-scale metabolic models applied to human health and disease</article-title><source>Wiley Interdisciplinary Reviews: Systems Biology and Medicine</source><volume>9</volume><elocation-id>e1393</elocation-id><pub-id pub-id-type="doi">10.1002/wsbm.1393</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>D'Souza</surname> <given-names>G</given-names></name><name><surname>Shitut</surname> <given-names>S</given-names></name><name><surname>Preussger</surname> <given-names>D</given-names></name><name><surname>Yousif</surname> <given-names>G</given-names></name><name><surname>Waschina</surname> <given-names>S</given-names></name><name><surname>Kost</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Ecology and evolution of metabolic cross-feeding interactions in bacteria</article-title><source>Natural Product Reports</source><volume>35</volume><fpage>455</fpage><lpage>488</lpage><pub-id pub-id-type="doi">10.1039/C8NP00009C</pub-id><pub-id pub-id-type="pmid">29799048</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davis</surname> <given-names>JJ</given-names></name><name><surname>Xia</surname> <given-names>F</given-names></name><name><surname>Overbeek</surname> <given-names>RA</given-names></name><name><surname>Olsen</surname> <given-names>GJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genomes of the class erysipelotrichia clarify the firmicute origin of the class mollicutes</article-title><source>International Journal of Systematic and Evolutionary Microbiology</source><volume>63</volume><fpage>2727</fpage><lpage>2741</lpage><pub-id pub-id-type="doi">10.1099/ijs.0.048983-0</pub-id><pub-id pub-id-type="pmid">23606477</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dewhirst</surname> <given-names>FE</given-names></name><name><surname>Chen</surname> <given-names>T</given-names></name><name><surname>Izard</surname> <given-names>J</given-names></name><name><surname>Paster</surname> <given-names>BJ</given-names></name><name><surname>Tanner</surname> <given-names>AC</given-names></name><name><surname>Yu</surname> <given-names>WH</given-names></name><name><surname>Lakshmanan</surname> <given-names>A</given-names></name><name><surname>Wade</surname> <given-names>WG</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The human oral microbiome</article-title><source>Journal of Bacteriology</source><volume>192</volume><fpage>5002</fpage><lpage>5017</lpage><pub-id pub-id-type="doi">10.1128/JB.00542-10</pub-id><pub-id pub-id-type="pmid">20656903</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ebenhöh</surname> <given-names>O</given-names></name><name><surname>Handorf</surname> <given-names>T</given-names></name><name><surname>Heinrich</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Structural analysis of expanding metabolic networks</article-title><source>Genome informatics</source><volume>15</volume><fpage>35</fpage><lpage>45</lpage><pub-id pub-id-type="pmid">15712108</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Embree</surname> <given-names>M</given-names></name><name><surname>Liu</surname> <given-names>JK</given-names></name><name><surname>Al-Bassam</surname> <given-names>MM</given-names></name><name><surname>Zengler</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Networks of energetic and metabolic interactions define dynamics in microbial communities</article-title><source>PNAS</source><volume>112</volume><fpage>15450</fpage><lpage>15455</lpage><pub-id pub-id-type="doi">10.1073/pnas.1506034112</pub-id><pub-id pub-id-type="pmid">26621749</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Epand</surname> <given-names>RF</given-names></name><name><surname>Savage</surname> <given-names>PB</given-names></name><name><surname>Epand</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Bacterial lipid composition and the antimicrobial efficacy of cationic steroid compounds (Ceragenins)</article-title><source>Biochimica Et Biophysica Acta (BBA) - Biomembranes</source><volume>1768</volume><fpage>2500</fpage><lpage>2509</lpage><pub-id pub-id-type="doi">10.1016/j.bbamem.2007.05.023</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Epand</surname> <given-names>RM</given-names></name><name><surname>Epand</surname> <given-names>RF</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Lipid domains in bacterial membranes and the action of antimicrobial agents</article-title><source>Biochimica Et Biophysica Acta (BBA) - Biomembranes</source><volume>1788</volume><fpage>289</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1016/j.bbamem.2008.08.023</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Epstein</surname> <given-names>SS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The phenomenon of microbial uncultivability</article-title><source>Current Opinion in Microbiology</source><volume>16</volume><fpage>636</fpage><lpage>642</lpage><pub-id pub-id-type="doi">10.1016/j.mib.2013.08.003</pub-id><pub-id pub-id-type="pmid">24011825</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feist</surname> <given-names>AM</given-names></name><name><surname>Herrgård</surname> <given-names>MJ</given-names></name><name><surname>Thiele</surname> <given-names>I</given-names></name><name><surname>Reed</surname> <given-names>JL</given-names></name><name><surname>Palsson</surname> <given-names>BØ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Reconstruction of biochemical networks in microorganisms</article-title><source>Nature Reviews Microbiology</source><volume>7</volume><fpage>129</fpage><lpage>143</lpage><pub-id pub-id-type="doi">10.1038/nrmicro1949</pub-id><pub-id pub-id-type="pmid">19116616</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fraser</surname> <given-names>CM</given-names></name><name><surname>Gocayne</surname> <given-names>JD</given-names></name><name><surname>White</surname> <given-names>O</given-names></name><name><surname>Adams</surname> <given-names>MD</given-names></name><name><surname>Clayton</surname> <given-names>RA</given-names></name><name><surname>Fleischmann</surname> <given-names>RD</given-names></name><name><surname>Bult</surname> <given-names>CJ</given-names></name><name><surname>Kerlavage</surname> <given-names>AR</given-names></name><name><surname>Sutton</surname> <given-names>G</given-names></name><name><surname>Kelley</surname> <given-names>JM</given-names></name><name><surname>Fritchman</surname> <given-names>RD</given-names></name><name><surname>Weidman</surname> <given-names>JF</given-names></name><name><surname>Small</surname> <given-names>KV</given-names></name><name><surname>Sandusky</surname> <given-names>M</given-names></name><name><surname>Fuhrmann</surname> <given-names>J</given-names></name><name><surname>Nguyen</surname> <given-names>D</given-names></name><name><surname>Utterback</surname> <given-names>TR</given-names></name><name><surname>Saudek</surname> <given-names>DM</given-names></name><name><surname>Phillips</surname> <given-names>CA</given-names></name><name><surname>Merrick</surname> <given-names>JM</given-names></name><name><surname>Tomb</surname> <given-names>JF</given-names></name><name><surname>Dougherty</surname> <given-names>BA</given-names></name><name><surname>Bott</surname> <given-names>KF</given-names></name><name><surname>Hu</surname> <given-names>PC</given-names></name><name><surname>Lucier</surname> <given-names>TS</given-names></name><name><surname>Peterson</surname> <given-names>SN</given-names></name><name><surname>Smith</surname> <given-names>HO</given-names></name><name><surname>Hutchison</surname> <given-names>CA</given-names></name><name><surname>Venter</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>The minimal gene complement of mycoplasma genitalium</article-title><source>Science</source><volume>270</volume><fpage>397</fpage><lpage>404</lpage><pub-id pub-id-type="doi">10.1126/science.270.5235.397</pub-id><pub-id pub-id-type="pmid">7569993</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fraser</surname> <given-names>CM</given-names></name><name><surname>Norris</surname> <given-names>SJ</given-names></name><name><surname>Weinstock</surname> <given-names>GM</given-names></name><name><surname>White</surname> <given-names>O</given-names></name><name><surname>Sutton</surname> <given-names>GG</given-names></name><name><surname>Dodson</surname> <given-names>R</given-names></name><name><surname>Gwinn</surname> <given-names>M</given-names></name><name><surname>Hickey</surname> <given-names>EK</given-names></name><name><surname>Clayton</surname> <given-names>R</given-names></name><name><surname>Ketchum</surname> <given-names>KA</given-names></name><name><surname>Sodergren</surname> <given-names>E</given-names></name><name><surname>Hardham</surname> <given-names>JM</given-names></name><name><surname>McLeod</surname> <given-names>MP</given-names></name><name><surname>Salzberg</surname> <given-names>S</given-names></name><name><surname>Peterson</surname> <given-names>J</given-names></name><name><surname>Khalak</surname> <given-names>H</given-names></name><name><surname>Richardson</surname> <given-names>D</given-names></name><name><surname>Howell</surname> <given-names>JK</given-names></name><name><surname>Chidambaram</surname> <given-names>M</given-names></name><name><surname>Utterback</surname> <given-names>T</given-names></name><name><surname>McDonald</surname> <given-names>L</given-names></name><name><surname>Artiach</surname> <given-names>P</given-names></name><name><surname>Bowman</surname> <given-names>C</given-names></name><name><surname>Cotton</surname> <given-names>MD</given-names></name><name><surname>Fujii</surname> <given-names>C</given-names></name><name><surname>Garland</surname> <given-names>S</given-names></name><name><surname>Hatch</surname> <given-names>B</given-names></name><name><surname>Horst</surname> <given-names>K</given-names></name><name><surname>Roberts</surname> <given-names>K</given-names></name><name><surname>Sandusky</surname> <given-names>M</given-names></name><name><surname>Weidman</surname> <given-names>J</given-names></name><name><surname>Smith</surname> <given-names>HO</given-names></name><name><surname>Venter</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Complete genome sequence of treponema pallidum, the syphilis spirochete</article-title><source>Science</source><volume>281</volume><fpage>375</fpage><lpage>388</lpage><pub-id pub-id-type="doi">10.1126/science.281.5375.375</pub-id><pub-id pub-id-type="pmid">9665876</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freilich</surname> <given-names>S</given-names></name><name><surname>Kreimer</surname> <given-names>A</given-names></name><name><surname>Borenstein</surname> <given-names>E</given-names></name><name><surname>Yosef</surname> <given-names>N</given-names></name><name><surname>Sharan</surname> <given-names>R</given-names></name><name><surname>Gophna</surname> <given-names>U</given-names></name><name><surname>Ruppin</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Metabolic-network-driven analysis of bacterial ecological strategies</article-title><source>Genome Biology</source><volume>10</volume><fpage>61</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1186/gb-2009-10-6-r61</pub-id><pub-id pub-id-type="pmid">19500338</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freilich</surname> <given-names>S</given-names></name><name><surname>Zarecki</surname> <given-names>R</given-names></name><name><surname>Eilam</surname> <given-names>O</given-names></name><name><surname>Segal</surname> <given-names>ES</given-names></name><name><surname>Henry</surname> <given-names>CS</given-names></name><name><surname>Kupiec</surname> <given-names>M</given-names></name><name><surname>Gophna</surname> <given-names>U</given-names></name><name><surname>Sharan</surname> <given-names>R</given-names></name><name><surname>Ruppin</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Competitive and cooperative metabolic interactions in bacterial communities</article-title><source>Nature Communications</source><volume>2</volume><fpage>589</fpage><pub-id pub-id-type="doi">10.1038/ncomms1597</pub-id><pub-id pub-id-type="pmid">22158444</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frezza</surname> <given-names>C</given-names></name><name><surname>Zheng</surname> <given-names>L</given-names></name><name><surname>Folger</surname> <given-names>O</given-names></name><name><surname>Rajagopalan</surname> <given-names>KN</given-names></name><name><surname>MacKenzie</surname> <given-names>ED</given-names></name><name><surname>Jerby</surname> <given-names>L</given-names></name><name><surname>Micaroni</surname> <given-names>M</given-names></name><name><surname>Chaneton</surname> <given-names>B</given-names></name><name><surname>Adam</surname> <given-names>J</given-names></name><name><surname>Hedley</surname> <given-names>A</given-names></name><name><surname>Kalna</surname> <given-names>G</given-names></name><name><surname>Tomlinson</surname> <given-names>IP</given-names></name><name><surname>Pollard</surname> <given-names>PJ</given-names></name><name><surname>Watson</surname> <given-names>DG</given-names></name><name><surname>Deberardinis</surname> <given-names>RJ</given-names></name><name><surname>Shlomi</surname> <given-names>T</given-names></name><name><surname>Ruppin</surname> <given-names>E</given-names></name><name><surname>Gottlieb</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Haem oxygenase is synthetically lethal with the tumour suppressor fumarate hydratase</article-title><source>Nature</source><volume>477</volume><fpage>225</fpage><lpage>228</lpage><pub-id pub-id-type="doi">10.1038/nature10363</pub-id><pub-id pub-id-type="pmid">21849978</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedman</surname> <given-names>J</given-names></name><name><surname>Alm</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Inferring correlation networks from genomic survey data</article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002687</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002687</pub-id><pub-id pub-id-type="pmid">23028285</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldford</surname> <given-names>JE</given-names></name><name><surname>Lu</surname> <given-names>N</given-names></name><name><surname>Bajic</surname> <given-names>D</given-names></name><name><surname>Estrela</surname> <given-names>S</given-names></name><name><surname>Tikhonov</surname> <given-names>M</given-names></name><name><surname>Sanchez-Gorostiaga</surname> <given-names>A</given-names></name><name><surname>Segrè</surname> <given-names>D</given-names></name><name><surname>Mehta</surname> <given-names>P</given-names></name><name><surname>Sanchez</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Emergent simplicity in microbial community assembly</article-title><source>Science</source><volume>6401</volume><fpage>469</fpage><lpage>474</lpage><pub-id pub-id-type="doi">10.1126/science.aat1168</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamana</surname> <given-names>K</given-names></name><name><surname>Itoh</surname> <given-names>T</given-names></name><name><surname>Sakamoto</surname> <given-names>M</given-names></name><name><surname>Hayashi</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Covalently linked polyamines in the cell wall peptidoglycan of the anaerobes belonging to the order selenomonadales</article-title><source>The Journal of General and Applied Microbiology</source><volume>58</volume><fpage>339</fpage><lpage>347</lpage><pub-id pub-id-type="doi">10.2323/jgam.58.339</pub-id><pub-id pub-id-type="pmid">22990495</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Handorf</surname> <given-names>T</given-names></name><name><surname>Christian</surname> <given-names>N</given-names></name><name><surname>Ebenhöh</surname> <given-names>O</given-names></name><name><surname>Kahn</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>An environmental perspective on metabolism</article-title><source>Journal of Theoretical Biology</source><volume>252</volume><fpage>530</fpage><lpage>537</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2007.10.036</pub-id><pub-id pub-id-type="pmid">18086477</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harcombe</surname> <given-names>WR</given-names></name><name><surname>Riehl</surname> <given-names>WJ</given-names></name><name><surname>Dukovski</surname> <given-names>I</given-names></name><name><surname>Granger</surname> <given-names>BR</given-names></name><name><surname>Betts</surname> <given-names>A</given-names></name><name><surname>Lang</surname> <given-names>AH</given-names></name><name><surname>Bonilla</surname> <given-names>G</given-names></name><name><surname>Kar</surname> <given-names>A</given-names></name><name><surname>Leiby</surname> <given-names>N</given-names></name><name><surname>Mehta</surname> <given-names>P</given-names></name><name><surname>Marx</surname> <given-names>CJ</given-names></name><name><surname>Segrè</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Metabolic resource allocation in individual microbes determines ecosystem interactions and spatial dynamics</article-title><source>Cell Reports</source><volume>7</volume><fpage>1104</fpage><lpage>1115</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2014.03.070</pub-id><pub-id pub-id-type="pmid">24794435</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname> <given-names>X</given-names></name><name><surname>McLean</surname> <given-names>JS</given-names></name><name><surname>Edlund</surname> <given-names>A</given-names></name><name><surname>Yooseph</surname> <given-names>S</given-names></name><name><surname>Hall</surname> <given-names>AP</given-names></name><name><surname>Liu</surname> <given-names>SY</given-names></name><name><surname>Dorrestein</surname> <given-names>PC</given-names></name><name><surname>Esquenazi</surname> <given-names>E</given-names></name><name><surname>Hunter</surname> <given-names>RC</given-names></name><name><surname>Cheng</surname> <given-names>G</given-names></name><name><surname>Nelson</surname> <given-names>KE</given-names></name><name><surname>Lux</surname> <given-names>R</given-names></name><name><surname>Shi</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Cultivation of a human-associated TM7 phylotype reveals a reduced genome and epibiotic parasitic lifestyle</article-title><source>PNAS</source><volume>112</volume><fpage>244</fpage><lpage>249</lpage><pub-id pub-id-type="doi">10.1073/pnas.1419038112</pub-id><pub-id pub-id-type="pmid">25535390</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heirendt</surname> <given-names>L</given-names></name><name><surname>Arreckx</surname> <given-names>S</given-names></name><name><surname>Pfau</surname> <given-names>T</given-names></name><name><surname>Mendoza</surname> <given-names>SN</given-names></name><name><surname>Richelle</surname> <given-names>A</given-names></name><name><surname>Heinken</surname> <given-names>A</given-names></name><name><surname>Haraldsdóttir</surname> <given-names>HS</given-names></name><name><surname>Wachowiak</surname> <given-names>J</given-names></name><name><surname>Keating</surname> <given-names>SM</given-names></name><name><surname>Vlasov</surname> <given-names>V</given-names></name><name><surname>Magnusdóttir</surname> <given-names>S</given-names></name><name><surname>Ng</surname> <given-names>CY</given-names></name><name><surname>Preciat</surname> <given-names>G</given-names></name><name><surname>Žagare</surname> <given-names>A</given-names></name><name><surname>Chan</surname> <given-names>SHJ</given-names></name><name><surname>Aurich</surname> <given-names>MK</given-names></name><name><surname>Clancy</surname> <given-names>CM</given-names></name><name><surname>Modamio</surname> <given-names>J</given-names></name><name><surname>Sauls</surname> <given-names>JT</given-names></name><name><surname>Noronha</surname> <given-names>A</given-names></name><name><surname>Bordbar</surname> <given-names>A</given-names></name><name><surname>Cousins</surname> <given-names>B</given-names></name><name><surname>El Assal</surname> <given-names>DC</given-names></name><name><surname>Valcarcel</surname> <given-names>LV</given-names></name><name><surname>Apaolaza</surname> <given-names>I</given-names></name><name><surname>Ghaderi</surname> <given-names>S</given-names></name><name><surname>Ahookhosh</surname> <given-names>M</given-names></name><name><surname>Ben Guebila</surname> <given-names>M</given-names></name><name><surname>Kostromins</surname> <given-names>A</given-names></name><name><surname>Sompairac</surname> <given-names>N</given-names></name><name><surname>Le</surname> <given-names>HM</given-names></name><name><surname>Ma</surname> <given-names>D</given-names></name><name><surname>Sun</surname> <given-names>Y</given-names></name><name><surname>Wang</surname> <given-names>L</given-names></name><name><surname>Yurkovich</surname> <given-names>JT</given-names></name><name><surname>Oliveira</surname> <given-names>MAP</given-names></name><name><surname>Vuong</surname> <given-names>PT</given-names></name><name><surname>El Assal</surname> <given-names>LP</given-names></name><name><surname>Kuperstein</surname> <given-names>I</given-names></name><name><surname>Zinovyev</surname> <given-names>A</given-names></name><name><surname>Hinton</surname> <given-names>HS</given-names></name><name><surname>Bryant</surname> <given-names>WA</given-names></name><name><surname>Aragón Artacho</surname> <given-names>FJ</given-names></name><name><surname>Planes</surname> <given-names>FJ</given-names></name><name><surname>Stalidzans</surname> <given-names>E</given-names></name><name><surname>Maass</surname> <given-names>A</given-names></name><name><surname>Vempala</surname> <given-names>S</given-names></name><name><surname>Hucka</surname> <given-names>M</given-names></name><name><surname>Saunders</surname> <given-names>MA</given-names></name><name><surname>Maranas</surname> <given-names>CD</given-names></name><name><surname>Lewis</surname> <given-names>NE</given-names></name><name><surname>Sauter</surname> <given-names>T</given-names></name><name><surname>Palsson</surname> <given-names>BØ</given-names></name><name><surname>Thiele</surname> <given-names>I</given-names></name><name><surname>Fleming</surname> <given-names>RMT</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Creation and analysis of biochemical constraint-based models using the COBRA toolbox v.3.0</article-title><source>Nature Protocols</source><volume>14</volume><fpage>639</fpage><lpage>702</lpage><pub-id pub-id-type="doi">10.1038/s41596-018-0098-2</pub-id><pub-id pub-id-type="pmid">30787451</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henry</surname> <given-names>CS</given-names></name><name><surname>DeJongh</surname> <given-names>M</given-names></name><name><surname>Best</surname> <given-names>AA</given-names></name><name><surname>Frybarger</surname> <given-names>PM</given-names></name><name><surname>Linsay</surname> <given-names>B</given-names></name><name><surname>Stevens</surname> <given-names>RL</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>High-throughput generation, optimization and analysis of genome-scale metabolic models</article-title><source>Nature Biotechnology</source><volume>28</volume><fpage>977</fpage><lpage>982</lpage><pub-id pub-id-type="doi">10.1038/nbt.1672</pub-id><pub-id pub-id-type="pmid">20802497</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hug</surname> <given-names>LA</given-names></name><name><surname>Baker</surname> <given-names>BJ</given-names></name><name><surname>Anantharaman</surname> <given-names>K</given-names></name><name><surname>Brown</surname> <given-names>CT</given-names></name><name><surname>Probst</surname> <given-names>AJ</given-names></name><name><surname>Castelle</surname> <given-names>CJ</given-names></name><name><surname>Butterfield</surname> <given-names>CN</given-names></name><name><surname>Hernsdorf</surname> <given-names>AW</given-names></name><name><surname>Amano</surname> <given-names>Y</given-names></name><name><surname>Ise</surname> <given-names>K</given-names></name><name><surname>Suzuki</surname> <given-names>Y</given-names></name><name><surname>Dudek</surname> <given-names>N</given-names></name><name><surname>Relman</surname> <given-names>DA</given-names></name><name><surname>Finstad</surname> <given-names>KM</given-names></name><name><surname>Amundson</surname> <given-names>R</given-names></name><name><surname>Thomas</surname> <given-names>BC</given-names></name><name><surname>Banfield</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A new view of the tree of life</article-title><source>Nature Microbiology</source><volume>1</volume><fpage>16048</fpage><pub-id pub-id-type="doi">10.1038/nmicrobiol.2016.48</pub-id><pub-id pub-id-type="pmid">27572647</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacobs</surname> <given-names>C</given-names></name><name><surname>Lambourne</surname> <given-names>L</given-names></name><name><surname>Xia</surname> <given-names>Y</given-names></name><name><surname>Segrè</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Upon accounting for the impact of isoenzyme loss, gene deletion costs anticorrelate with their evolutionary rates</article-title><source>PLOS ONE</source><volume>12</volume><elocation-id>e0170164</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0170164</pub-id><pub-id pub-id-type="pmid">28107392</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jorth</surname> <given-names>P</given-names></name><name><surname>Turner</surname> <given-names>KH</given-names></name><name><surname>Gumus</surname> <given-names>P</given-names></name><name><surname>Nizam</surname> <given-names>N</given-names></name><name><surname>Buduneli</surname> <given-names>N</given-names></name><name><surname>Whiteley</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Metatranscriptomics of the human oral microbiome during health and disease</article-title><source>mBio</source><volume>5</volume><elocation-id>e01012-14</elocation-id><pub-id pub-id-type="doi">10.1128/mBio.01012-14</pub-id><pub-id pub-id-type="pmid">24692635</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kamio</surname> <given-names>Y</given-names></name><name><surname>Takahashi</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>Isolation and characterization of outer and inner membranes of selenomonas ruminantium: lipid compositions</article-title><source>Journal of Bacteriology</source><volume>141</volume><fpage>888</fpage><lpage>898</lpage><pub-id pub-id-type="pmid">7364719</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kantor</surname> <given-names>RS</given-names></name><name><surname>Wrighton</surname> <given-names>KC</given-names></name><name><surname>Handley</surname> <given-names>KM</given-names></name><name><surname>Sharon</surname> <given-names>I</given-names></name><name><surname>Hug</surname> <given-names>LA</given-names></name><name><surname>Castelle</surname> <given-names>CJ</given-names></name><name><surname>Thomas</surname> <given-names>BC</given-names></name><name><surname>Banfield</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Small genomes and sparse metabolisms of Sediment-Associated bacteria from four candidate phyla</article-title><source>mBio</source><volume>4</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1128/mBio.00708-13</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>King</surname> <given-names>ZA</given-names></name><name><surname>Lu</surname> <given-names>J</given-names></name><name><surname>Dräger</surname> <given-names>A</given-names></name><name><surname>Miller</surname> <given-names>P</given-names></name><name><surname>Federowicz</surname> <given-names>S</given-names></name><name><surname>Lerman</surname> <given-names>JA</given-names></name><name><surname>Ebrahim</surname> <given-names>A</given-names></name><name><surname>Palsson</surname> <given-names>BO</given-names></name><name><surname>Lewis</surname> <given-names>NE</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>BiGG models: a platform for integrating, standardizing and sharing genome-scale models</article-title><source>Nucleic Acids Research</source><volume>44</volume><fpage>D515</fpage><lpage>D522</lpage><pub-id pub-id-type="doi">10.1093/nar/gkv1049</pub-id><pub-id pub-id-type="pmid">26476456</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klitgord</surname> <given-names>N</given-names></name><name><surname>Segrè</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Environments that induce synthetic microbial ecosystems</article-title><source>PLOS Computational Biology</source><volume>6</volume><elocation-id>e1001002</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1001002</pub-id><pub-id pub-id-type="pmid">21124952</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolenbrander</surname> <given-names>PE</given-names></name><name><surname>Palmer</surname> <given-names>RJ</given-names></name><name><surname>Periasamy</surname> <given-names>S</given-names></name><name><surname>Jakubovics</surname> <given-names>NS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Oral multispecies biofilm development and the key role of cell-cell distance</article-title><source>Nature Reviews Microbiology</source><volume>8</volume><fpage>471</fpage><lpage>480</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2381</pub-id><pub-id pub-id-type="pmid">20514044</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kreimer</surname> <given-names>A</given-names></name><name><surname>Doron-Faigenboim</surname> <given-names>A</given-names></name><name><surname>Borenstein</surname> <given-names>E</given-names></name><name><surname>Freilich</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>NetCmpt: a network-based tool for calculating the metabolic competition between bacterial species</article-title><source>Bioinformatics</source><volume>28</volume><fpage>2195</fpage><lpage>2197</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts323</pub-id><pub-id pub-id-type="pmid">22668793</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krishnan</surname> <given-names>K</given-names></name><name><surname>Chen</surname> <given-names>T</given-names></name><name><surname>Paster</surname> <given-names>BJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A practical guide to the oral microbiome and its relation to health and disease</article-title><source>Oral Diseases</source><volume>23</volume><fpage>276</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1111/odi.12509</pub-id><pub-id pub-id-type="pmid">27219464</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kruse</surname> <given-names>K</given-names></name><name><surname>Ebenhöh</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Comparing flux balance analysis to network expansion: producibility, sustainability and the scope of compounds</article-title><source>Genome Informatics. International Conference on Genome Informatics</source><volume>20</volume><fpage>91</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1142/9781848163003_0008</pub-id><pub-id pub-id-type="pmid">19425125</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Lakshmanan</surname> <given-names>M</given-names></name><name><surname>Long</surname> <given-names>S</given-names></name><name><surname>Ang</surname> <given-names>KS</given-names></name><name><surname>Lewis</surname> <given-names>N</given-names></name><name><surname>Lee</surname> <given-names>D-Y</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>On the impact of biomass composition in constraint-based flux analysis</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/652040</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname> <given-names>R</given-names></name><name><surname>Carr</surname> <given-names>R</given-names></name><name><surname>Kreimer</surname> <given-names>A</given-names></name><name><surname>Freilich</surname> <given-names>S</given-names></name><name><surname>Borenstein</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>NetCooperate: a network-based tool for inferring host-microbe and microbe-microbe cooperation</article-title><source>BMC Bioinformatics</source><volume>16</volume><fpage>164</fpage><pub-id pub-id-type="doi">10.1186/s12859-015-0588-y</pub-id><pub-id pub-id-type="pmid">25980407</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname> <given-names>R</given-names></name><name><surname>Borenstein</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Metabolic modeling of species interaction in the human microbiome elucidates community-level assembly rules</article-title><source>PNAS</source><volume>110</volume><fpage>12804</fpage><lpage>12809</lpage><pub-id pub-id-type="doi">10.1073/pnas.1300926110</pub-id><pub-id pub-id-type="pmid">23858463</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewis</surname> <given-names>NE</given-names></name><name><surname>Nagarajan</surname> <given-names>H</given-names></name><name><surname>Palsson</surname> <given-names>BO</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Constraining the metabolic genotype-phenotype relationship using a phylogeny of in silico methods</article-title><source>Nature Reviews Microbiology</source><volume>10</volume><fpage>291</fpage><lpage>305</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2737</pub-id><pub-id pub-id-type="pmid">22367118</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Machado</surname> <given-names>D</given-names></name><name><surname>Andrejev</surname> <given-names>S</given-names></name><name><surname>Tramontano</surname> <given-names>M</given-names></name><name><surname>Patil</surname> <given-names>KR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Fast automated reconstruction of genome-scale metabolic models for microbial species and communities</article-title><source>Nucleic Acids Research</source><volume>46</volume><fpage>7542</fpage><lpage>7553</lpage><pub-id pub-id-type="doi">10.1093/nar/gky537</pub-id><pub-id pub-id-type="pmid">30192979</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Magnúsdóttir</surname> <given-names>S</given-names></name><name><surname>Heinken</surname> <given-names>A</given-names></name><name><surname>Kutt</surname> <given-names>L</given-names></name><name><surname>Ravcheev</surname> <given-names>DA</given-names></name><name><surname>Bauer</surname> <given-names>E</given-names></name><name><surname>Noronha</surname> <given-names>A</given-names></name><name><surname>Greenhalgh</surname> <given-names>K</given-names></name><name><surname>Jäger</surname> <given-names>C</given-names></name><name><surname>Baginska</surname> <given-names>J</given-names></name><name><surname>Wilmes</surname> <given-names>P</given-names></name><name><surname>Fleming</surname> <given-names>RM</given-names></name><name><surname>Thiele</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Generation of genome-scale metabolic reconstructions for 773 members of the human gut microbiota</article-title><source>Nature Biotechnology</source><volume>35</volume><fpage>81</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1038/nbt.3703</pub-id><pub-id pub-id-type="pmid">27893703</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Magnúsdóttir</surname> <given-names>S</given-names></name><name><surname>Thiele</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Modeling metabolism of the human gut microbiome</article-title><source>Current Opinion in Biotechnology</source><volume>51</volume><fpage>90</fpage><lpage>96</lpage><pub-id pub-id-type="doi">10.1016/j.copbio.2017.12.005</pub-id><pub-id pub-id-type="pmid">29258014</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahadevan</surname> <given-names>R</given-names></name><name><surname>Edwards</surname> <given-names>JS</given-names></name><name><surname>Doyle</surname> <given-names>FJ</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Dynamic flux balance analysis of diauxic growth in Escherichia coli</article-title><source>Biophysical Journal</source><volume>83</volume><fpage>1331</fpage><lpage>1340</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(02)73903-9</pub-id><pub-id pub-id-type="pmid">12202358</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marcy</surname> <given-names>Y</given-names></name><name><surname>Ouverney</surname> <given-names>C</given-names></name><name><surname>Bik</surname> <given-names>EM</given-names></name><name><surname>Lösekann</surname> <given-names>T</given-names></name><name><surname>Ivanova</surname> <given-names>N</given-names></name><name><surname>Martin</surname> <given-names>HG</given-names></name><name><surname>Szeto</surname> <given-names>E</given-names></name><name><surname>Platt</surname> <given-names>D</given-names></name><name><surname>Hugenholtz</surname> <given-names>P</given-names></name><name><surname>Relman</surname> <given-names>DA</given-names></name><name><surname>Quake</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Dissecting biological &quot;dark matter&quot; with single-cell genetic analysis of rare and uncultivated TM7 microbes from the human mouth</article-title><source>PNAS</source><volume>104</volume><fpage>11889</fpage><lpage>11894</lpage><pub-id pub-id-type="doi">10.1073/pnas.0704662104</pub-id><pub-id pub-id-type="pmid">17620602</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mark Welch</surname> <given-names>JL</given-names></name><name><surname>Rossetti</surname> <given-names>BJ</given-names></name><name><surname>Rieken</surname> <given-names>CW</given-names></name><name><surname>Dewhirst</surname> <given-names>FE</given-names></name><name><surname>Borisy</surname> <given-names>GG</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Biogeography of a human oral microbiome at the micron scale</article-title><source>PNAS</source><volume>113</volume><fpage>E791</fpage><lpage>E800</lpage><pub-id pub-id-type="doi">10.1073/pnas.1522149113</pub-id><pub-id pub-id-type="pmid">26811460</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matthäus</surname> <given-names>F</given-names></name><name><surname>Salazar</surname> <given-names>C</given-names></name><name><surname>Ebenhöh</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Biosynthetic potentials of metabolites and their hierarchical organization</article-title><source>PLOS Computational Biology</source><volume>4</volume><fpage>e1000049</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000049</pub-id><pub-id pub-id-type="pmid">18392147</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mazumdar</surname> <given-names>V</given-names></name><name><surname>Amar</surname> <given-names>S</given-names></name><name><surname>Segrè</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Metabolic proximity in the order of colonization of a microbial community</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e77617</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0077617</pub-id><pub-id pub-id-type="pmid">24204896</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLean</surname> <given-names>JS</given-names></name><name><surname>Liu</surname> <given-names>Q</given-names></name><name><surname>Bor</surname> <given-names>B</given-names></name><name><surname>Bedree</surname> <given-names>JK</given-names></name><name><surname>Cen</surname> <given-names>L</given-names></name><name><surname>Watling</surname> <given-names>M</given-names></name><name><surname>To</surname> <given-names>TT</given-names></name><name><surname>Bumgarner</surname> <given-names>RE</given-names></name><name><surname>He</surname> <given-names>X</given-names></name><name><surname>Shi</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Draft genome sequence of Actinomyces odontolyticus subsp. actinosynbacter strain XH001, the basibiont of an oral TM7 epibiont</article-title><source>Genome Announcements</source><volume>4</volume><elocation-id>e01685-15</elocation-id><pub-id pub-id-type="doi">10.1128/genomeA.01685-15</pub-id><pub-id pub-id-type="pmid">26847892</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mee</surname> <given-names>MT</given-names></name><name><surname>Collins</surname> <given-names>JJ</given-names></name><name><surname>Church</surname> <given-names>GM</given-names></name><name><surname>Wang</surname> <given-names>HH</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Syntrophic exchange in synthetic microbial communities</article-title><source>PNAS</source><volume>111</volume><fpage>E2149</fpage><lpage>E2156</lpage><pub-id pub-id-type="doi">10.1073/pnas.1405641111</pub-id><pub-id pub-id-type="pmid">24778240</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mee</surname> <given-names>MT</given-names></name><name><surname>Wang</surname> <given-names>HH</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Engineering ecosystems and synthetic ecologies</article-title><source>Molecular BioSystems</source><volume>8</volume><fpage>2470</fpage><pub-id pub-id-type="doi">10.1039/c2mb25133g</pub-id><pub-id pub-id-type="pmid">22722235</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meseguer</surname> <given-names>M</given-names></name><name><surname>Álvarez</surname> <given-names>A</given-names></name><name><surname>Rejas</surname> <given-names>M</given-names></name><name><surname>Sánchez</surname> <given-names>C</given-names></name><name><surname>Perezdiaz</surname> <given-names>J</given-names></name><name><surname>Baquero</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Mycoplasma pneumoniae: a reduced-genome intracellular bacterial pathogen</article-title><source>Infection, Genetics and Evolution</source><volume>3</volume><fpage>47</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.1016/S1567-1348(02)00151-X</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitchell</surname> <given-names>A</given-names></name><name><surname>Finch</surname> <given-names>LR</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Pathways of nucleotide biosynthesis in mycoplasma mycoides subsp. mycoides</article-title><source>Journal of Bacteriology</source><volume>130</volume><fpage>1047</fpage><lpage>1054</lpage><pub-id pub-id-type="pmid">324972</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oberhardt</surname> <given-names>MA</given-names></name><name><surname>Palsson</surname> <given-names>Bernhard Ø</given-names></name><name><surname>Papin</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Applications of genome-scale metabolic reconstructions</article-title><source>Molecular Systems Biology</source><volume>5</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1038/msb.2009.77</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olczak</surname> <given-names>T</given-names></name><name><surname>Simpson</surname> <given-names>W</given-names></name><name><surname>Liu</surname> <given-names>X</given-names></name><name><surname>Genco</surname> <given-names>CA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Iron and heme utilization in <italic>porphyromonas gingivalis</italic></article-title><source>FEMS Microbiology Reviews</source><volume>29</volume><fpage>119</fpage><lpage>144</lpage><pub-id pub-id-type="doi">10.1016/j.femsre.2004.09.001</pub-id><pub-id pub-id-type="pmid">15652979</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Opatovsky</surname> <given-names>I</given-names></name><name><surname>Santos-Garcia</surname> <given-names>D</given-names></name><name><surname>Ruan</surname> <given-names>Z</given-names></name><name><surname>Lahav</surname> <given-names>T</given-names></name><name><surname>Ofaim</surname> <given-names>S</given-names></name><name><surname>Mouton</surname> <given-names>L</given-names></name><name><surname>Barbe</surname> <given-names>V</given-names></name><name><surname>Jiang</surname> <given-names>J</given-names></name><name><surname>Zchori-Fein</surname> <given-names>E</given-names></name><name><surname>Freilich</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Modeling trophic dependencies and exchanges among insects' bacterial symbionts in a host-simulated environment</article-title><source>BMC Genomics</source><volume>19</volume><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1186/s12864-018-4786-7</pub-id><pub-id pub-id-type="pmid">29801436</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orth</surname> <given-names>JD</given-names></name><name><surname>Thiele</surname> <given-names>I</given-names></name><name><surname>Palsson</surname> <given-names>BØ</given-names></name></person-group><year iso-8601-date="2010">2010a</year><article-title>What is flux balance analysis?</article-title><source>Nature Biotechnology</source><volume>28</volume><fpage>245</fpage><lpage>248</lpage><pub-id pub-id-type="doi">10.1038/nbt.1614</pub-id><pub-id pub-id-type="pmid">20212490</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orth</surname> <given-names>JD</given-names></name><name><surname>Fleming</surname> <given-names>RM</given-names></name><name><surname>Palsson</surname> <given-names>BØ</given-names></name></person-group><year iso-8601-date="2010">2010b</year><article-title>Reconstruction and use of microbial metabolic networks: the core Escherichia coli metabolic model as an educational guide</article-title><source>EcoSal Plus</source><volume>4</volume><pub-id pub-id-type="doi">10.1128/ecosalplus.10.2.1</pub-id><pub-id pub-id-type="pmid">26443778</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orth</surname> <given-names>JD</given-names></name><name><surname>Conrad</surname> <given-names>TM</given-names></name><name><surname>Na</surname> <given-names>J</given-names></name><name><surname>Lerman</surname> <given-names>JA</given-names></name><name><surname>Nam</surname> <given-names>H</given-names></name><name><surname>Feist</surname> <given-names>AM</given-names></name><name><surname>Palsson</surname> <given-names>BØ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A comprehensive genome-scale reconstruction of Escherichia coli metabolism--2011</article-title><source>Molecular Systems Biology</source><volume>7</volume><fpage>535</fpage><pub-id pub-id-type="doi">10.1038/msb.2011.65</pub-id><pub-id pub-id-type="pmid">21988831</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ouverney</surname> <given-names>CC</given-names></name><name><surname>Armitage</surname> <given-names>GC</given-names></name><name><surname>Relman</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Single-cell enumeration of an uncultivated TM7 subgroup in the human subgingival crevice</article-title><source>Applied and Environmental Microbiology</source><volume>69</volume><fpage>6294</fpage><lpage>6298</lpage><pub-id pub-id-type="doi">10.1128/AEM.69.10.6294-6298.2003</pub-id><pub-id pub-id-type="pmid">14532094</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Overbeek</surname> <given-names>R</given-names></name><name><surname>Olson</surname> <given-names>R</given-names></name><name><surname>Pusch</surname> <given-names>GD</given-names></name><name><surname>Olsen</surname> <given-names>GJ</given-names></name><name><surname>Davis</surname> <given-names>JJ</given-names></name><name><surname>Disz</surname> <given-names>T</given-names></name><name><surname>Edwards</surname> <given-names>RA</given-names></name><name><surname>Gerdes</surname> <given-names>S</given-names></name><name><surname>Parrello</surname> <given-names>B</given-names></name><name><surname>Shukla</surname> <given-names>M</given-names></name><name><surname>Vonstein</surname> <given-names>V</given-names></name><name><surname>Wattam</surname> <given-names>AR</given-names></name><name><surname>Xia</surname> <given-names>F</given-names></name><name><surname>Stevens</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The SEED and the rapid annotation of microbial genomes using subsystems technology (RAST)</article-title><source>Nucleic Acids Research</source><volume>42</volume><fpage>D206</fpage><lpage>D214</lpage><pub-id pub-id-type="doi">10.1093/nar/gkt1226</pub-id><pub-id pub-id-type="pmid">24293654</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pacheco</surname> <given-names>AR</given-names></name><name><surname>Moel</surname> <given-names>M</given-names></name><name><surname>Segrè</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Costless metabolic secretions as drivers of interspecies interactions in microbial ecosystems</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>103</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-07946-9</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pande</surname> <given-names>S</given-names></name><name><surname>Shitut</surname> <given-names>S</given-names></name><name><surname>Freund</surname> <given-names>L</given-names></name><name><surname>Westermann</surname> <given-names>M</given-names></name><name><surname>Bertels</surname> <given-names>F</given-names></name><name><surname>Colesie</surname> <given-names>C</given-names></name><name><surname>Bischofs</surname> <given-names>IB</given-names></name><name><surname>Kost</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Metabolic cross-feeding via intercellular nanotubes among bacteria</article-title><source>Nature Communications</source><volume>6</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1038/ncomms7238</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pande</surname> <given-names>S</given-names></name><name><surname>Kost</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Bacterial unculturability and the formation of intercellular metabolic networks</article-title><source>Trends in Microbiology</source><volume>25</volume><fpage>349</fpage><lpage>361</lpage><pub-id pub-id-type="doi">10.1016/j.tim.2017.02.015</pub-id><pub-id pub-id-type="pmid">28389039</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phelan</surname> <given-names>VV</given-names></name><name><surname>Liu</surname> <given-names>W-T</given-names></name><name><surname>Pogliano</surname> <given-names>K</given-names></name><name><surname>Dorrestein</surname> <given-names>PC</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Microbial metabolic exchange—the chemotype-to-phenotype link</article-title><source>Nature Chemical Biology</source><volume>8</volume><fpage>26</fpage><lpage>35</lpage><pub-id pub-id-type="doi">10.1038/nchembio.739</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plugge</surname> <given-names>CM</given-names></name><name><surname>Stams</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Arginine catabolism by <italic>thermanaerovibrio acidaminovorans</italic></article-title><source>FEMS Microbiology Letters</source><volume>195</volume><fpage>259</fpage><lpage>262</lpage><pub-id pub-id-type="doi">10.1111/j.1574-6968.2001.tb10530.x</pub-id><pub-id pub-id-type="pmid">11179661</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Podar</surname> <given-names>M</given-names></name><name><surname>Abulencia</surname> <given-names>CB</given-names></name><name><surname>Walcher</surname> <given-names>M</given-names></name><name><surname>Hutchison</surname> <given-names>D</given-names></name><name><surname>Zengler</surname> <given-names>K</given-names></name><name><surname>Garcia</surname> <given-names>JA</given-names></name><name><surname>Holland</surname> <given-names>T</given-names></name><name><surname>Cotton</surname> <given-names>D</given-names></name><name><surname>Hauser</surname> <given-names>L</given-names></name><name><surname>Keller</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Targeted access to the genomes of low-abundance organisms in complex microbial communities</article-title><source>Applied and Environmental Microbiology</source><volume>73</volume><fpage>3205</fpage><lpage>3214</lpage><pub-id pub-id-type="doi">10.1128/AEM.02985-06</pub-id><pub-id pub-id-type="pmid">17369337</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ponomarova</surname> <given-names>O</given-names></name><name><surname>Patil</surname> <given-names>KR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Metabolic interactions in microbial communities: untangling the gordian knot</article-title><source>Current Opinion in Microbiology</source><volume>27</volume><fpage>37</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1016/j.mib.2015.06.014</pub-id><pub-id pub-id-type="pmid">26207681</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname> <given-names>MN</given-names></name><name><surname>Wetmore</surname> <given-names>KM</given-names></name><name><surname>Waters</surname> <given-names>RJ</given-names></name><name><surname>Callaghan</surname> <given-names>M</given-names></name><name><surname>Ray</surname> <given-names>J</given-names></name><name><surname>Liu</surname> <given-names>H</given-names></name><name><surname>Kuehl</surname> <given-names>JV</given-names></name><name><surname>Melnyk</surname> <given-names>RA</given-names></name><name><surname>Lamson</surname> <given-names>JS</given-names></name><name><surname>Suh</surname> <given-names>Y</given-names></name><name><surname>Carlson</surname> <given-names>HK</given-names></name><name><surname>Esquivel</surname> <given-names>Z</given-names></name><name><surname>Sadeeshkumar</surname> <given-names>H</given-names></name><name><surname>Chakraborty</surname> <given-names>R</given-names></name><name><surname>Zane</surname> <given-names>GM</given-names></name><name><surname>Rubin</surname> <given-names>BE</given-names></name><name><surname>Wall</surname> <given-names>JD</given-names></name><name><surname>Visel</surname> <given-names>A</given-names></name><name><surname>Bristow</surname> <given-names>J</given-names></name><name><surname>Blow</surname> <given-names>MJ</given-names></name><name><surname>Arkin</surname> <given-names>AP</given-names></name><name><surname>Deutschbauer</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2018">2018a</year><article-title>Mutant phenotypes for thousands of bacterial genes of unknown function</article-title><source>Nature</source><volume>557</volume><fpage>503</fpage><lpage>509</lpage><pub-id pub-id-type="doi">10.1038/s41586-018-0124-0</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname> <given-names>MN</given-names></name><name><surname>Zane</surname> <given-names>GM</given-names></name><name><surname>Kuehl</surname> <given-names>JV</given-names></name><name><surname>Melnyk</surname> <given-names>RA</given-names></name><name><surname>Wall</surname> <given-names>JD</given-names></name><name><surname>Deutschbauer</surname> <given-names>AM</given-names></name><name><surname>Arkin</surname> <given-names>AP</given-names></name></person-group><year iso-8601-date="2018">2018b</year><article-title>Filling gaps in bacterial amino acid biosynthesis pathways with high-throughput genetics</article-title><source>PLOS Genetics</source><volume>14</volume><elocation-id>e1007147</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1007147</pub-id><pub-id pub-id-type="pmid">29324779</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Razin</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>The mycoplasmas</article-title><source>Microbiological Reviews</source><volume>42</volume><fpage>414</fpage><lpage>470</lpage><pub-id pub-id-type="pmid">353482</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schellenberger</surname> <given-names>J</given-names></name><name><surname>Que</surname> <given-names>R</given-names></name><name><surname>Fleming</surname> <given-names>RM</given-names></name><name><surname>Thiele</surname> <given-names>I</given-names></name><name><surname>Orth</surname> <given-names>JD</given-names></name><name><surname>Feist</surname> <given-names>AM</given-names></name><name><surname>Zielinski</surname> <given-names>DC</given-names></name><name><surname>Bordbar</surname> <given-names>A</given-names></name><name><surname>Lewis</surname> <given-names>NE</given-names></name><name><surname>Rahmanian</surname> <given-names>S</given-names></name><name><surname>Kang</surname> <given-names>J</given-names></name><name><surname>Hyduke</surname> <given-names>DR</given-names></name><name><surname>Palsson</surname> <given-names>BØ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Quantitative prediction of cellular metabolism with constraint-based models: the COBRA toolbox v2.0</article-title><source>Nature Protocols</source><volume>6</volume><fpage>1290</fpage><lpage>1307</lpage><pub-id pub-id-type="doi">10.1038/nprot.2011.308</pub-id><pub-id pub-id-type="pmid">21886097</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schellenberger</surname> <given-names>J</given-names></name><name><surname>Palsson</surname> <given-names>BØ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Use of randomized sampling for analysis of metabolic networks</article-title><source>Journal of Biological Chemistry</source><volume>284</volume><fpage>5457</fpage><lpage>5461</lpage><pub-id pub-id-type="doi">10.1074/jbc.R800048200</pub-id><pub-id pub-id-type="pmid">18940807</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schink</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2006">2006</year><chapter-title>Syntrophism among prokaryotes</chapter-title><person-group person-group-type="editor"><name><surname>Dworkin</surname> <given-names>M</given-names></name><name><surname>Falkow</surname> <given-names>S</given-names></name><name><surname>Rosenberg</surname> <given-names>E</given-names></name><name><surname>Schleifer</surname> <given-names>K-H</given-names></name></person-group><source>The Prokaryotes</source><volume>2</volume><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name><fpage>309</fpage><lpage>335</lpage><pub-id pub-id-type="doi">10.1007/0-387-30742-7_11</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schuster</surname> <given-names>S</given-names></name><name><surname>Fell</surname> <given-names>DA</given-names></name><name><surname>Dandekar</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>A general definition of metabolic pathways useful for systematic organization and analysis of complex metabolic networks</article-title><source>Nature Biotechnology</source><volume>18</volume><fpage>326</fpage><lpage>332</lpage><pub-id pub-id-type="doi">10.1038/73786</pub-id><pub-id pub-id-type="pmid">10700151</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sévin</surname> <given-names>DC</given-names></name><name><surname>Fuhrer</surname> <given-names>T</given-names></name><name><surname>Zamboni</surname> <given-names>N</given-names></name><name><surname>Sauer</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Nontargeted in vitro metabolomics for high-throughput identification of novel enzymes in Escherichia coli</article-title><source>Nature Methods</source><volume>14</volume><fpage>187</fpage><lpage>194</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4103</pub-id><pub-id pub-id-type="pmid">27941785</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shannon</surname> <given-names>P</given-names></name><name><surname>Markiel</surname> <given-names>A</given-names></name><name><surname>Ozier</surname> <given-names>O</given-names></name><name><surname>Baliga</surname> <given-names>NS</given-names></name><name><surname>Wang</surname> <given-names>JT</given-names></name><name><surname>Ramage</surname> <given-names>D</given-names></name><name><surname>Amin</surname> <given-names>N</given-names></name><name><surname>Schwikowski</surname> <given-names>B</given-names></name><name><surname>Ideker</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Cytoscape: a software environment for integrated models of biomolecular interaction networks</article-title><source>Genome Research</source><volume>13</volume><fpage>2498</fpage><lpage>2504</lpage><pub-id pub-id-type="doi">10.1101/gr.1239303</pub-id><pub-id pub-id-type="pmid">14597658</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siqueira Jr</surname> <given-names>JF</given-names></name><name><surname>Rôças</surname> <given-names>IN</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>As-yet-uncultivated oral bacteria: breadth and association with oral and extra-oral diseases</article-title><source>Journal of Oral Microbiology</source><volume>5</volume><elocation-id>21077</elocation-id><pub-id pub-id-type="doi">10.3402/jom.v5i0.21077</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smart</surname> <given-names>AG</given-names></name><name><surname>Amaral</surname> <given-names>LA</given-names></name><name><surname>Ottino</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Cascading failure and robustness in metabolic networks</article-title><source>PNAS</source><volume>105</volume><fpage>13223</fpage><lpage>13228</lpage><pub-id pub-id-type="doi">10.1073/pnas.0803571105</pub-id><pub-id pub-id-type="pmid">18765805</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Staley</surname> <given-names>JT</given-names></name><name><surname>Konopka</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Measurement of in situ activities of nonphotosynthetic microorganisms in aquatic and terrestrial habitats</article-title><source>Annual Review of Microbiology</source><volume>39</volume><fpage>321</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1146/annurev.mi.39.100185.001541</pub-id><pub-id pub-id-type="pmid">3904603</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stewart</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Growing unculturable bacteria</article-title><source>Journal of Bacteriology</source><volume>194</volume><fpage>4151</fpage><lpage>4160</lpage><pub-id pub-id-type="doi">10.1128/JB.00345-12</pub-id><pub-id pub-id-type="pmid">22661685</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stolyar</surname> <given-names>S</given-names></name><name><surname>Van Dien</surname> <given-names>S</given-names></name><name><surname>Hillesland</surname> <given-names>KL</given-names></name><name><surname>Pinel</surname> <given-names>N</given-names></name><name><surname>Lie</surname> <given-names>TJ</given-names></name><name><surname>Leigh</surname> <given-names>JA</given-names></name><name><surname>Stahl</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Metabolic modeling of a mutualistic microbial community</article-title><source>Molecular Systems Biology</source><volume>3</volume><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1038/msb4100131</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takahashi</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Oral microbiome metabolism: from &quot;Who Are They?&quot; to &quot;What Are They Doing?&quot;</article-title><source>Journal of Dental Research</source><volume>94</volume><fpage>1628</fpage><lpage>1637</lpage><pub-id pub-id-type="doi">10.1177/0022034515606045</pub-id><pub-id pub-id-type="pmid">26377570</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vaccaro</surname> <given-names>BJ</given-names></name><name><surname>Thorgersen</surname> <given-names>MP</given-names></name><name><surname>Lancaster</surname> <given-names>WA</given-names></name><name><surname>Price</surname> <given-names>MN</given-names></name><name><surname>Wetmore</surname> <given-names>KM</given-names></name><name><surname>Poole</surname> <given-names>FL</given-names></name><name><surname>Deutschbauer</surname> <given-names>A</given-names></name><name><surname>Arkin</surname> <given-names>AP</given-names></name><name><surname>Adams</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Determining roles of accessory genes in denitrification by mutant fitness analyses</article-title><source>Applied and Environmental Microbiology</source><volume>82</volume><fpage>51</fpage><lpage>61</lpage><pub-id pub-id-type="doi">10.1128/AEM.02602-15</pub-id><pub-id pub-id-type="pmid">26452555</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vartoukian</surname> <given-names>SR</given-names></name><name><surname>Moazzez</surname> <given-names>RV</given-names></name><name><surname>Paster</surname> <given-names>BJ</given-names></name><name><surname>Dewhirst</surname> <given-names>FE</given-names></name><name><surname>Wade</surname> <given-names>WG</given-names></name></person-group><year iso-8601-date="2016">2016a</year><article-title>First cultivation of Health-Associated <italic>Tannerella</italic> sp. HOT-286 (BU063)</article-title><source>Journal of Dental Research</source><volume>95</volume><fpage>1308</fpage><lpage>1313</lpage><pub-id pub-id-type="doi">10.1177/0022034516651078</pub-id><pub-id pub-id-type="pmid">27193146</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vartoukian</surname> <given-names>SR</given-names></name><name><surname>Adamowska</surname> <given-names>A</given-names></name><name><surname>Lawlor</surname> <given-names>M</given-names></name><name><surname>Moazzez</surname> <given-names>R</given-names></name><name><surname>Dewhirst</surname> <given-names>FE</given-names></name><name><surname>Wade</surname> <given-names>WG</given-names></name></person-group><year iso-8601-date="2016">2016b</year><article-title>In vitro cultivation of 'Unculturable' Oral Bacteria, Facilitated by Community Culture and Media Supplementation with Siderophores</article-title><source>PLOS ONE</source><volume>11</volume><elocation-id>e0146926</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0146926</pub-id><pub-id pub-id-type="pmid">26764907</pub-id></element-citation></ref><ref id="bib112"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wade</surname> <given-names>WG</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The oral microbiome in health and disease</article-title><source>Pharmacological Research</source><volume>69</volume><fpage>137</fpage><lpage>143</lpage><pub-id pub-id-type="doi">10.1016/j.phrs.2012.11.006</pub-id><pub-id pub-id-type="pmid">23201354</pub-id></element-citation></ref><ref id="bib113"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watrous</surname> <given-names>JD</given-names></name><name><surname>Phelan</surname> <given-names>VV</given-names></name><name><surname>Hsu</surname> <given-names>CC</given-names></name><name><surname>Moree</surname> <given-names>WJ</given-names></name><name><surname>Duggan</surname> <given-names>BM</given-names></name><name><surname>Alexandrov</surname> <given-names>T</given-names></name><name><surname>Dorrestein</surname> <given-names>PC</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Microbial metabolic exchange in 3D</article-title><source>The ISME Journal</source><volume>7</volume><fpage>770</fpage><lpage>780</lpage><pub-id pub-id-type="doi">10.1038/ismej.2012.155</pub-id><pub-id pub-id-type="pmid">23283018</pub-id></element-citation></ref><ref id="bib114"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weidenmaier</surname> <given-names>C</given-names></name><name><surname>Peschel</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Teichoic acids and related cell-wall glycopolymers in Gram-positive physiology and host interactions</article-title><source>Nature Reviews Microbiology</source><volume>6</volume><fpage>276</fpage><lpage>287</lpage><pub-id pub-id-type="doi">10.1038/nrmicro1861</pub-id><pub-id pub-id-type="pmid">18327271</pub-id></element-citation></ref><ref id="bib115"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Widder</surname> <given-names>S</given-names></name><name><surname>Allen</surname> <given-names>RJ</given-names></name><name><surname>Pfeiffer</surname> <given-names>T</given-names></name><name><surname>Curtis</surname> <given-names>TP</given-names></name><name><surname>Wiuf</surname> <given-names>C</given-names></name><name><surname>Sloan</surname> <given-names>WT</given-names></name><name><surname>Cordero</surname> <given-names>OX</given-names></name><name><surname>Brown</surname> <given-names>SP</given-names></name><name><surname>Momeni</surname> <given-names>B</given-names></name><name><surname>Shou</surname> <given-names>W</given-names></name><name><surname>Kettle</surname> <given-names>H</given-names></name><name><surname>Flint</surname> <given-names>HJ</given-names></name><name><surname>Haas</surname> <given-names>AF</given-names></name><name><surname>Laroche</surname> <given-names>B</given-names></name><name><surname>Kreft</surname> <given-names>JU</given-names></name><name><surname>Rainey</surname> <given-names>PB</given-names></name><name><surname>Freilich</surname> <given-names>S</given-names></name><name><surname>Schuster</surname> <given-names>S</given-names></name><name><surname>Milferstedt</surname> <given-names>K</given-names></name><name><surname>van der Meer</surname> <given-names>JR</given-names></name><name><surname>Groβkopf</surname> <given-names>T</given-names></name><name><surname>Huisman</surname> <given-names>J</given-names></name><name><surname>Free</surname> <given-names>A</given-names></name><name><surname>Picioreanu</surname> <given-names>C</given-names></name><name><surname>Quince</surname> <given-names>C</given-names></name><name><surname>Klapper</surname> <given-names>I</given-names></name><name><surname>Labarthe</surname> <given-names>S</given-names></name><name><surname>Smets</surname> <given-names>BF</given-names></name><name><surname>Wang</surname> <given-names>H</given-names></name><name><surname>Soyer</surname> <given-names>OS</given-names></name><collab>Isaac Newton Institute Fellows</collab></person-group><year iso-8601-date="2016">2016</year><article-title>Challenges in microbial ecology: building predictive understanding of community function and dynamics</article-title><source>The ISME Journal</source><volume>10</volume><fpage>2557</fpage><lpage>2568</lpage><pub-id pub-id-type="doi">10.1038/ismej.2016.45</pub-id><pub-id pub-id-type="pmid">27022995</pub-id></element-citation></ref><ref id="bib116"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wintermute</surname> <given-names>EH</given-names></name><name><surname>Silver</surname> <given-names>PA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Emergent cooperation in microbial metabolism</article-title><source>Molecular Systems Biology</source><volume>6</volume><elocation-id>407</elocation-id><pub-id pub-id-type="doi">10.1038/msb.2010.66</pub-id><pub-id pub-id-type="pmid">20823845</pub-id></element-citation></ref><ref id="bib117"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>Z</given-names></name><name><surname>Huang</surname> <given-names>S</given-names></name><name><surname>Zou</surname> <given-names>D</given-names></name><name><surname>Dong</surname> <given-names>D</given-names></name><name><surname>He</surname> <given-names>X</given-names></name><name><surname>Liu</surname> <given-names>N</given-names></name><name><surname>Liu</surname> <given-names>W</given-names></name><name><surname>Huang</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Metabolic shifts and structural changes in the gut microbiota upon branched-chain amino acid supplementation in middle-aged mice</article-title><source>Amino Acids</source><volume>48</volume><fpage>2731</fpage><lpage>2745</lpage><pub-id pub-id-type="doi">10.1007/s00726-016-2308-y</pub-id><pub-id pub-id-type="pmid">27539648</pub-id></element-citation></ref><ref id="bib118"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Yedidia</surname> <given-names>JS</given-names></name><name><surname>Freeman</surname> <given-names>WT</given-names></name><name><surname>Weiss</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2003">2003</year><chapter-title>Understanding belief propagation and its generalizations</chapter-title><person-group person-group-type="editor"><name><surname>Lakemeyer</surname> <given-names>G</given-names></name><name><surname>Nebel</surname> <given-names>B</given-names></name></person-group><source>Exploring Artificial Intelligence in the New Millennium </source><publisher-loc>San Francisco, CA, United States</publisher-loc><publisher-name>Morgan Kaufmann Publishers Inc</publisher-name><fpage>239</fpage><lpage>269</lpage></element-citation></ref><ref id="bib119"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zarecki</surname> <given-names>R</given-names></name><name><surname>Oberhardt</surname> <given-names>MA</given-names></name><name><surname>Reshef</surname> <given-names>L</given-names></name><name><surname>Gophna</surname> <given-names>U</given-names></name><name><surname>Ruppin</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A novel nutritional predictor links microbial fastidiousness with lowered ubiquity, growth rate, and cooperativeness</article-title><source>PLOS Computational Biology</source><volume>10</volume><fpage>e1003726</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003726</pub-id><pub-id pub-id-type="pmid">25033033</pub-id></element-citation></ref><ref id="bib120"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zelezniak</surname> <given-names>A</given-names></name><name><surname>Andrejev</surname> <given-names>S</given-names></name><name><surname>Ponomarova</surname> <given-names>O</given-names></name><name><surname>Mende</surname> <given-names>DR</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name><name><surname>Patil</surname> <given-names>KR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Metabolic dependencies drive species co-occurrence in diverse microbial communities</article-title><source>PNAS</source><volume>112</volume><fpage>6449</fpage><lpage>6454</lpage><pub-id pub-id-type="doi">10.1073/pnas.1421834112</pub-id><pub-id pub-id-type="pmid">25941371</pub-id></element-citation></ref><ref id="bib121"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zengler</surname> <given-names>K</given-names></name><name><surname>Zaramela</surname> <given-names>LS</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The social network of microorganisms - how auxotrophies shape complex communities</article-title><source>Nature Reviews Microbiology</source><volume>16</volume><fpage>383</fpage><lpage>390</lpage><pub-id pub-id-type="doi">10.1038/s41579-018-0004-5</pub-id><pub-id pub-id-type="pmid">29599459</pub-id></element-citation></ref><ref id="bib122"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zomorrodi</surname> <given-names>AR</given-names></name><name><surname>Segrè</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Synthetic ecology of microbes: mathematical models and applications</article-title><source>Journal of Molecular Biology</source><volume>428</volume><fpage>837</fpage><lpage>861</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2015.10.019</pub-id><pub-id pub-id-type="pmid">26522937</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.39733.030</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Shou</surname><given-names>Wenying</given-names></name><role>Reviewing Editor</role><aff><institution>Fred Hutchinson Cancer Research Center</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Shou</surname><given-names>Wenying</given-names> </name><role>Reviewer</role><aff><institution>Fred Hutchinson Cancer Research Center</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Quince</surname><given-names>Christopher</given-names> </name><role>Reviewer</role><aff><institution>University of Warwick</institution><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>[Editors’ note: the authors were asked to provide a plan for revisions before the editors issued a final decision. What follows is the editors’ letter requesting such plan.]</p><p>Thank you for sending your article entitled &quot;Quantifying biosynthetic network robustness across the human oral microbiome&quot; for peer review at <italic>eLife</italic>. Your article is being evaluated by three peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation is being overseen by a Reviewing Editor and Naama Barkai as the Senior Editor.</p><p>Given the list of essential revisions, including new experiments, the editors and reviewers invite you to respond with an action plan and timetable for the completion of the additional work. We plan to share your responses with the reviewers and then issue a binding recommendation.</p><p>The most important issue you will need to address is the biological relevance of the proposed method. You can either show that the method is in agreement with previously published data (where a lot of direct evidence exist) in a manner that is better/more insightful than previous methods; or provide new experimental data to substantiate your claims.</p><p><italic>Reviewer #1:</italic> </p><p>&quot;Quantifying biosynthetic network robustness across the human oral microbiome&quot; from Segre lab was motivated by a desire to overcome the gap-filling limitation of standard flux balance analysis and the need to make assumptions on environments in metabolic network topology analysis. They quantified &quot;biosynthetic network robustness&quot;, essentially how the probability of a product being made (<italic>P<sub>out</sub></italic>) scales with the probability of the presence of input metabolites (<italic>P<sub>in</sub></italic>). This robustness can be summarized as PM – the higher PM, the more likely a metabolite can be synthesized. If one is worried about parameter overfitting (and one should worry about such problems in genome scale models), this seems like a good thing to try. Applying the metric PM to <italic>E. coli</italic> central metabolism, they found that PM is not correlated with connectivity. Some metabolites have high connectivity but low PM, and some low connectivity and high PM. They then quantified PM of 88 biomass metabolites for 456 oral microbes, and found that fastidious (difficult to culture) microbes have low PM values for several metabolites, consistent with them being fastidious. Genome size and taxonomy both contained information about PM. They found that cell wall metabolites have variable PM. They also found that a number of amino acids have high PM in <italic>Proteobacteria</italic> and low PM in <italic>Bacteroidetes</italic>. They also analyzed metabolic complementarity of several TM7 strains (fastidious microbes) and their symbiotic bacteria strains. The paper is of bioinformatics nature, and is in general clearly written.</p><p>1) What is the difference between PM and% completion of biosynthetic pathway?</p><p>2) It's also not entirely clear to what extent their method improves upon the state of the art. In their Introduction, they say that two downsides that limit FBA (but not their method) are assumptions on environmental conditions and reconciling with stoichiometry-based constraints. I don't really understand their second limitation, but they sidestep the first limitation by assuming a constant <italic>P<sub>in</sub></italic> among all inputs. This seems similar to assuming constant concentration among all inputs for FBA, which is never shown.</p><p><italic>Reviewer #2:</italic> </p><p>The manuscript by Bernstein et al. presents a computational method to estimate metabolites that are likely to be exchanged in a microbial community. The essence of the novelty of the method, especially in comparison with the previous methods, is that it provides a probabilistic view accounting for multiple possible variations in substrate uptake combinations (e.g. different combinations of C/N sources etc.). The method is illustrated with the analysis of oral microbial community and the results suggest potential metabolic dependencies in the community. I find the method to be elegant but yet only of theoretical interest.</p><p>1) The method assumes a uniform distribution of possible substrate uptake combinations – which is not necessarily biologically observed. There are hierarchies – e.g. preference of glucose over other C-sources in most organisms.</p><p>2) The finding that metabolic dependencies may exist in oral microbiome is not that surprising per se given that a large body of literature (including papers also from the Segre lab) already suggest that metabolic dependencies are likely widespread in microbial communities. Thus, it is not clear whether only the proposed method would be able to identify these.</p><p>3) Lack of experimental validation makes it difficult to assess whether the identified exchanges are happening in the system. At the least, a detailed analysis of systems with known metabolite exchanges (and how the proposed method there differs from the previous ones) should be provided.</p><p>In summary, I do find the proposed method elegant and appealing but miss substantiation of the biological relevance.</p><p><italic>Reviewer #3:</italic> </p><p>This manuscript introduces a new robustness metric that attempts to quantify the probability that an organism can produce a given metabolite directly from the genome. This probability is calculated as an average over possible environments defined by the presence or absence of the other metabolites in the network with production determined through the application of an FBA model. I found the metric itself intuitively appealing and easy to understand. In addition, the manuscript was clear and well written. The application to the oral microbiome and the novel CPR organisms in particular was also well motivated and interesting.</p><p>Given the rate of generation of microbial genomes it would be very useful to have a better method to even approximately predict metabolic products of organisms. However, what the study lacks in my opinion, is quantitative evidence that the metric actually does translate into a prediction that the organism produces a given metabolite. They provide some anecdotal examples where it appears to work but without a more thorough analysis of what the metric means then it will only be useful in a qualitative sense i.e. a higher PM indicating that one organism is more likely to produce a metabolite than another. Metabolic modelling is admittedly not my field, but datasets capable of testing the metric, must exist. A possible example might be this collection of <italic>E. coli</italic> strains and phenotypes defined in terms of growth conditions (Galardini et al., 2017, <italic>eLife</italic>). If such datasets are not available then I feel the authors need to be more circumspect in their conclusions and concede that the metric may say something about the production of metabolites but without any certainty about how a given PM value translates into an actual probability of production.</p><p>Other than the above caveat, I thought this was a good study but it was sparse on the practical details of the methodology. The GitHub repository consists of a selection of Matlab scripts without a clear description of how to apply them. What would be really useful is a complete walkthrough of the methodology from genome to PM values including for example ggkbase commands used to build the models. This is necessary if this work is to be properly reproducible. One final comment was that some evaluation of the impact of sample number on the calculated PM values would be a worthwhile addition. The authors mention that 50 samples of input metabolite combinations were used but no analysis of the impact of this choice on the PM values was given.</p><p>[Editors’ note: formal revisions were requested, following approval of the authors’ plan of action.]</p><p>Thank you for submitting a revision plan for your article entitled &quot;Quantifying biosynthetic network robustness across the human oral microbiome&quot;. The editors and reviewers have considered your plan and invite you to proceed with your revisions. Please also consider the following comments when preparing your revised manuscript.</p><p>The Reviewing Editor stated:</p><p>&quot;I think that I know how authors can fix their problems from a theoretical aspect. They can start with a complete model as the &quot;ground truth&quot; model, but hide or mis-annotate various% links to mimic our incomplete knowledge of the system, and compare their method with existing methods. This way, they will always have a &quot;ground truth&quot; curve for any metric of interest to biologists. Of course, the task of assigning missing links will need to be repeated many times and in double-blind fashion to gain statistical power. I suspect that different methods might show tradeoff. For example, in their Figure 1, it is not clear whether the extra info provided by PM is useful to a biologist if all mutants are auxotrophic. Any tradeoff between methods is also valuable to know. Authors can also use this ground truth model to illustrate problems of gap filling etc.&quot;</p><p>Another reviewer said:</p><p>&quot;I agree this is a very comprehensive plan and they do seem to have taken our comments to heart and developed a proposal to address them. I was pleased with their suggestions regarding an alternate dataset of <italic>E. coli</italic> phenotypes to test their metric and the improved GitHub repository. &quot;</p><p>The last reviewer said:</p><p>&quot;I agree that the proposal is comprehensive and I like the Reviewing Editor's simulation idea. This also reminds me that the authors' should comment on the ensembleFBA approach which does address the main criticisms of the gap-filling. Furthermore, I think that a clear focus on oral microbiome would benefit the study much more rather than claiming general validity that is very difficult to substantiate based on their proposed plan – after all, <italic>E. coli</italic> is one organism and by no means representative of natural diversity and community complexity. <italic>E. coli</italic> auxotroph complementation experiments are also unique in some sense as I haven't seen many other studies showing similar data in other organisms. So, overall, I think recommending to focus on oral microbiome and reducing the general claims would put the paper on more solid foundation I believe.&quot;</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.39733.031</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: what follows is the authors’ plan to address the revisions.]</p><p>Thank you very much for evaluating our manuscript, and for your valuable and constructive comments. In the summary letter, the reviewers and reviewing editor have asked us to further investigate and clarify the novelty and biological relevance of our method, especially in relation to previously developed approaches. In particular, they have asked us to “either show that the method is in agreement with previously published data (where a lot of direct evidence exist) in a manner that is better/more insightful than previous methods; or provide new experimental data to substantiate [our] claims”.</p><p>We agree that a better description of the biological relevance of our method and additional analyses directly addressing how our method can provide novel insight relative to existing approaches will greatly strengthen our results and clarify the importance of our work. We propose several new analyses that will address the reviewers’ concerns. Based on revisiting the literature, and implementing some preliminary analyses (shown below), we believe that sufficient published data is available to clarify the biological relevance and distinct capabilities of our method.</p><p>The current document outlines our plan for addressing the reviewers’ comments, and is structured as follows:</p><p>In Part 1, we present an overview of how we will address each of the major issues raised across all reviewers. In Part 2, we have specifically addressed all reviewer’s comments in more detail. In Part 3, we have included preliminary and prospective figures that will be added to our manuscript to address the reviewer’s comments.</p><p>We obviously cannot guarantee that all comparisons with available data will confirm the validity of our approach. However, some preliminary analyses we have performed so far, displayed below in the form of tentative figures, support and clarify the relevance of our method. Would any of the prospective analyses we have suggested yield uninformative or negative results, we would still be committed to including them in a revised manuscript as an opportunity to highlight the limitations of our approach, and possible directions for future improvement.</p><p>Part 1 – Summary of how we address major issues</p><p>A) It is not clear how our method is different from and better/more insightful than previous methods (reviewer #1 comment 1, reviewer #1 comment 2, reviewer #2 comment 2).</p><p>We appreciate this criticism and see it as an opportunity to clarify the novelty of our method and point out where it may be better/more insightful than other similar methods. We will address this criticism by describing how our method differs from several different methods:</p><p>How our method differs from pathway completeness: We will first analyze the relationship between pathway completeness (the fraction of genes or reactions from a given pathway found in a metabolic network) and our Producibility Metric (PM) in depth for a single pathway. Figure 1 displays a preliminary analysis, showing how our metric provides a much more informative outcome than pathway completeness for the analysis of mutations in the <italic>E. coli</italic> L-histidine biosynthesis pathway. In particular, the PM provides information on the structure of the pathway and on how the proximity of the knockout to the final product affects its producibility. Thus, a high PM value would indicate that the target metabolite can be produced from multiple distinct sets of precursors. This analysis will be presented as a supplemental analysis in the Materials and methods section of our manuscript.</p><p>To show the validity of this argument beyond a simple linear pathway and perform a more comprehensive analysis, we will also compare the relationship between pathway completeness and our PM for additional metabolites with known biosynthetic pathways and interesting distributions of PM across our set of oral microbiome organisms. This analysis will be presented in the results section of our manuscript. See also response to reviewer #1 comment 1 for additional details on these analyses.</p><p>How our method differs from flux balance analysis (FBA): We will clarify how our method differs from classical FBA, in three major ways. First, in our approach we assess the producibility of individual biomass components, rather than optimizing the overall biomass production flux. This allows us to analyze incomplete networks that would be simply infeasible with FBA optimization of the biomass production flux. Second, we define environmental availability of precursors in a probabilistic way, and thus compute metabolite producibility based on random sampling. Third, we provide a novel measure of robustness (the Producibility Metric) that cannot be computed with standard FBA, which describes how well an organism can produce a metabolite across a statistical ensemble of possible environments.</p><p>In the revised manuscript, in addition to describing in detail these differences and their implications, we will add a new figure supplement to our method section (see proposed Figure 2 below as <xref ref-type="fig" rid="respfig2">Author response image 2</xref>) showing how indeed our metric provides robust predictions of biomass producibility for metabolic networks whose gaps would prevent obtaining any useful information from regular FBA (which would give simply “infeasible” as an outcome). Additionally, to clarify the connection between our probabilistic definition of environments and the constraint-based definition of FBA, we will further compare our analysis with FBA for <italic>E. coli</italic> grown on minimal glucose and rich media (see also point B below). In the discussion of a revised manuscript we would also better explain that having to perform gap-filling in order to use FBA for any microbiome study is becoming an increasingly important and debated issue. While previous work has shown the utility of gapfilled models for predicting inter-species interactions (Zelezniak et al.,2015; Freilich et al., 2011), more recent papers have raised concerns about existing gap-filling pipelines (Karp et al., 2018, BMC Systems Biology). In general, we feel that exploring alternative strategies that can estimate metabolic properties of microbes and communities without gap-filling is going to be a crucial component of future genome-scale microbial modeling efforts.</p><p>How our method differs from NetCooperate: We will compare our method in more detail to what we believe to be the most closely related method, in terms of scope and motivation, namely the NetCooperate reverse ecology method. Similar to our method, this approach can be used to analyze metabolic interactions in microbial communities using draft metabolic networks and to provide large scale insight into microbial communities (Levy and Borenstein, 2013; Levy etal., 2015). To perform a comparison with this method, we will use our method to compute a complementarity score (which quantifies the potential for metabolic exchange between two organisms) and compare this metric to an analogous metric derived from NetCooperate. We will compare the two approaches for all pairs of oral microbiome organisms in our collection. A tentative new figure (proposed Figure 3 below as <xref ref-type="fig" rid="respfig3">Author response image 3</xref>) shows preliminary results from such an analysis. This figure will be highlighted in a supplementary results section of our revised manuscript. One can see that the two metrics are significantly correlated. Interestingly, however, our metric provides a better capacity to discriminate interactions that involve fastidious/uncultivated organisms. In finalizing this analysis, we will further check whether the capacity of our method to resolve uncultivated organisms is related to the more specific predictions of exchanged metabolites that our method provides relative to NetCooperate, likely due fact that we use stoichiometric constraints for our calculations, as opposed to network adjacency. To clarify why our analysis of the full stoichiometric network is expected to yield more specific prediction than those obtained by analyzing a metabolite adjacency network we propose to add a new portion of text, possibly aided by a figure supplement in the Materials and methods section. More details on this are provided in the response to reviewer #1 comment 2.</p><p>B) The assumption of a constant <italic>P<sub>in</sub></italic> throughout our analysis seems limiting (reviewer #1 comment 2, reviewer #2 comment 1).</p><p>We wish to start by acknowledging that, while in our manuscript we described in detail the mathematical definitions of <italic>P<sub>in</sub></italic> (the probability that an environmental metabolite is available) and of PM (the Producibility Metric), we could have done a better job at providing a biological intuition for our definitions. We will update our manuscript to include an improved description of PM, <italic>P<sub>in</sub></italic>, and their relationship to FBA, which we outline tentatively in what follows.</p><p>One way of briefly re-stating the interpretation of the Producibility Metric (PM) for a given metabolite is that it is an estimate of the fraction of distinct environmental compounds that one would have to add in the medium in order to expect, on average, a high chance (above 0.5) of being able to produce a given metabolite. We should clarify that the computation of PM is effectively the outcome of thousands of FBA calculations in which the production of a target metabolite is estimated under many sets of input metabolites randomly sampled as <italic>P<sub>in</sub></italic> slides between 0 and 1. In this sense, in our current calculations, <italic>P<sub>in</sub></italic> is uniform (i.e. assumed to be the same across all metabolites), but not constant (it changes between 0 and 1). Note also that while the PM of a given metabolite is the outcome of many FBA calculations, it is a number that could not easily be related to any individual FBA calculation. In summary, PM quantifies the overall propensity for an organism (with an incomplete metabolic network, and no knowledge about its typical environment) to be able to produce a given metabolite. Therefore, our method is particularly useful for assessing the biosynthetic capabilities of a large number of organisms without having to make any arbitrary assumption beyond the metabolic information present in the organisms’ genomes.</p><p>That being said, nothing in our algorithm prevents one from making alternative choices for the values of <italic>P<sub>in</sub></italic>, which can be different for different metabolites. In fact, our algorithm was designed in a modular fashion such that it could accommodate such alternative implementations. An extreme, but illustrative, scenario is the one of <italic>P<sub>in</sub></italic> = either 0 or 1 for all metabolites. We will show that this scenario would effectively be equivalent to estimating the producibility of biomass components with standard FBA, under a specific environmental condition, in which the available metabolites are the ones with <italic>P<sub>in</sub></italic> = 1. We will further show how these extreme choices of <italic>P<sub>in</sub></italic> differ from using intermediate <italic>P<sub>in</sub></italic> values and PM by showing how the results of metabolite producibility in a minimal and rich medium are related to the PM. This analysis is described in further detail in response to reviewer #1 comment 2.</p><p>In order to address the specific suggestion to use non-uniform <italic>P<sub>in</sub></italic> values to probe nutrient preferences across different organisms, we will test the ability of our approach to distinguish between saccharolytic vs. proteolytic organisms in the human oral microbiome. These two classes of organisms have very different metabolic strategies and important implications in oral health (Takahashi, 2015). For this analysis, we will use variable <italic>P<sub>in</sub></italic> values to define a sugar rich and an amino acid rich environment. Then we will calculate the producibility metric for different biomass components for a set of saccharolytic and proteolytic organisms from our collection of oral microbiome organisms and assess our ability to distinguish their environmental preferences. This analysis will be added to the results section of our manuscript in a new section addressing variable <italic>P<sub>in</sub></italic> values. For additional details see prospective Figure 4 legend below.</p><p>C) There is a lack of experimental validation about producible metabolites and exchange among microbial organisms (reviewer #2 comment 3, reviewer #3 comment 1).</p><p>In general, experiments that directly confirm the exchange of a specific metabolites between two microbes are quite challenging, let alone experiments that could uncover the entire possible network of metabolic exchanges in a microbial community. However, a few published examples contain enough information to enable a direct comparison between computational and empirical outcomes. We propose to analyze different sources of existing data in order to validate the predictions of our algorithm. Whenever possible, during these analyses, we will also include analysis based on the methods mentioned in part A such that we can compare the performance of our method relative to these alternative methods. The specific sets of case studies we plan to focus on are described below:</p><p>We will analyze organic acid exchange in the oral microbiome: We will test our method’s ability to predict the exchange of organic acids between oral microbes in two known examples. To do this we will extend our method to predict the producibility of metabolites beyond biomass components such as organic acids. The specific interactions we will focus on are the exchange of lactic acid, produced by <italic>Streptococcus</italic> and consumed by <italic>Veillonella</italic> species (Chalmers et al., 2008); and the exchange of succinate from <italic>T. denticola</italic> to <italic>P. gingivalis</italic> and isobutyric acid from <italic>P. gingivalis</italic> to <italic>T. denticola</italic> (Grenier, 1992, Infect. Immun.).Additionally, following the analysis of these specific experimentally validated systems, we will extend our analysis to all of our oral microbiome organisms to generate hypotheses regarding exchange of organic acids between previously undiscovered pairs of organisms. This analysis will be presented in the manuscript as a supplemental result that expands on our current matrix of biomass producibility. See the response to reviewer #2 comment 3 for further details.</p><p>We will analyze the exchange of amino acids in <italic>E. coli</italic> auxotrophs: As a slightly more complex example of a microbial community with metabolic exchange we propose to analyze a dataset on putative exchange among amino acid auxotrophs (Mee et al., 2014). We will calculate the producibility metric for all amino acids across pairs and triplets of <italic>E. coli</italic> auxotrophs that are known to support each other through syntrophic exchange of amino acids. We will determine if indeed the production of the necessary amino acids to support partner growth is predicted by our method. This analysis will be added to the manuscript method section as an additional validation. See prospective Figure 5 legend and the response to reviewer #2 comment 3 for further details.</p><p>While the above analyses are focused on specific interactions for which molecular mechanistic details can be addressed with our methods, it will be also interesting to assess the performance of our method on microbial co-occurrence data from the human oral microbiome. It is important to note that co-occurrences are not necessarily indicative of metabolic interactions, but they are often related to metabolic trends, as shown before (Levy and Borenstein, 2013). We will utilize two different sources of microbial cooccurrence data for this analysis. The first will be high-throughput sequencing data from the human microbiome project, which contains co-occurrence data for microbes associated with several different human oral microbiome sites (Huttenhower et al., 2012, Nature). The second source we will aim at utilizing is a set of CLASI-FISH experiments of dental plaque where physical interactions between different taxa have been imaged through fluorescence microscopy (Welch et al., 2016). This analysis will be added to the results section of our manuscript. See response to reviewer #2 comment 3 and prospective Figure 6 legend for further details.</p><p>An additional analysis that we will pursue, as inspired by reviewer #3 comment 1, is the assessment of our methods performance on predicting high-throughput phenotype data. As pointed out by the reviewer, analyzing high-throughput phenotype data could allow us to more quantitatively benchmark the ability of our method to predict specific metabolic auxotrophies (or inabilities to produce certain metabolites). We have identified a promising dataset that contains a large number of <italic>E. coli</italic> knockout mutants tested on different environments containing variable nutrients (Tohsato et al., 2010, J. Bioinform. Comput. Biol.). We have contacted the authors of this paper in the hope that they will share the raw data of their study with us, in which case we would pursue an analysis wherein we analyze this data to provide a more-high throughput and quantitative clarification of our PM calculations. This point is further elaborated in our specific response to reviewer #3 comment 1.</p><p>Part 2 – Point by point response to reviewers</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>[…]</p><p>1) What is the difference between PM and% completion of biosynthetic pathway?</p></disp-quote><p>This is an important question that we propose to address through two different analyses. The first is a detailed analysis of a known (linear) biosynthetic pathway, biosynthesis of the amino acid L-histidine in <italic>E. coli</italic>. In a preliminary analysis (see proposed Figure 1 in <xref ref-type="fig" rid="respfig1">Author response image 1</xref> below) we analyzed this biosynthetic pathway by “knocking-out” different metabolic reactions and calculating our Producibility Metric (PM). One can see that the PM distinguishes between the effects of removing different reactions along the pathway based on their proximity to the target metabolite, L-histidine. Thus the PM metric is able to capture the impact of the specific location of the knockout and the topology of the metabolic pathway, thus carrying information about the chance that additionally available metabolites could recover the function of the broken pathway. In contrast, in several other possible approaches (including pathway completeness, as well as flux balance analysis, or network expansion) we expect the outcome of such a knock-out analysis to yield the same final output irrespective of the gene location, and thus provide a different and less informative prediction. For the full revision, we will show this analysis in more detail, and compare its outcome with the other methods mentioned above.</p><p>The second analysis that we propose goes beyond a simple linear pathway, and constitutes a more general assessment of the relationship between PM and biosynthetic pathway% completeness. For this analysis we will utilize our large set of oral microbiome organisms. For several metabolites with well described biosynthetic pathways, such as amino acids, we will determine the% completion across these strains and make a direct comparison with the PM value. We do expect to see some correlation between the% completion of a pathway and the PM value. However, as demonstrated with the above analysis, we do not expect them to be redundant.</p><p>We would also like to emphasize that we believe it is an advantage of our method that it does not rely on previously defined biosynthetic pathway annotations and instead seeks to use the entire metabolic network structure to define biosynthetic capabilities. While this prior knowledge can be quite useful in many contexts, specific biosynthetic routes can cross the boundaries of annotated pathways, making pathway completeness uninformative. A prior notable example of this effect is the discovery of an alternative pathway to bypass a TCA cycle gene impairment (Frezza et al.,2011). This pathway connects in an unexpected way two distinct pathways, generating a new crucially important and experimentally validated type of connectivity that would be missed from regular pathway-based analysis. Another such example, in our current data, is the case of the arginine deiminase pathway and the urea cycle, which contain several overlapping metabolites and reactions. In fact, we have noticed that KEGG mappings of TM7x metabolism often highlight the urea cycle as a result of TM7x containing the complete arginine deiminase pathway. In the revised manuscript we will describe this advantage of the Producibility Metric relative to pathway completeness, and point to the specific examples mentioned.</p><disp-quote content-type="editor-comment"><p>2) It's also not entirely clear to what extent their method improves upon the state of the art. In their Introduction, they say that two downsides that limit FBA (but not their method) are assumptions on environmental conditions and reconciling with stoichiometry-based constraints. I don't really understand their second limitation, but they sidestep the first limitation by assuming a constant P<sub>in</sub> among all inputs. This seems similar to assuming constant concentration among all inputs for FBA, which is never shown.</p></disp-quote><p>We agree with the reviewer that the current description of how our method differs from FBA is not articulated clearly enough, and can be significantly improved. We have described in detail how we plan to address this issue in Part 1 Point B above, and will add further details to our manuscript to describe our method, and in particular the PM, <italic>P<sub>in</sub></italic> and how they are related to FBA.</p><p>The first of the two “downsides” mentioned in the reviewer’s comment is related to a specific choice on how our approach can be employed for obtaining biological insight about an organism in the absence of specific information about the molecular composition of its environment. In a given FBA calculation, one necessarily needs to decide on a specific set of initial conditions, in the form of upper bounds to the fluxes associated with import of extracellular metabolites. Our method is instead statistical in nature, and computes the producibility of different metabolites as a function of the probability of availability of any given environmental metabolite (<italic>P<sub>in</sub></italic>). Indeed, in the current version of the manuscript, we focused on a uniform <italic>P<sub>in</sub></italic> across all metabolites, essentially mimicking a uniformly distributed ensemble of environments. However, in general, each metabolite <italic>j</italic> can have a different value <italic>P<sub>in</sub><sup>(j)</sup></italic>. An extreme case is the one of all <italic>P<sub>in</sub></italic> = 1, which would be comparable to running FBA with all environmental metabolites available. In a revised version of the manuscript, we propose to show some specific examples to clarify how our method chooses statistical ensembles of input metabolites based on <italic>P<sub>in</sub></italic> and how this choice differs from, but is related to, setting constant inputs for FBA. We will calculate the set of producible metabolites in the <italic>E. coli</italic> core model by using FBA under two different conditions, one where we include all input metabolites, as in a rich medium, and one where we include only input metabolites expected to be found in a glucose minimal medium. We note that these two scenarios correspond respectively to: (a) Rich Medium – setting <italic>P<sub>in</sub></italic> values equal to 1 for all metabolites; (b) Minimal Glucose Medium – setting <italic>P<sub>in</sub></italic> values equal to 1 for all metabolites found in glucose minimal medium and 0 for all others. We will then compare the metabolites that are producible in those two scenarios to the PM values obtained from varying <italic>P<sub>in</sub></italic> between 0 and 1. We expect that metabolites that are producible in the minimal medium will have higher PM values than those that are producible only in the rich medium.</p><p>The second “downside” of other methods relative to our approach is related to the fact that our methods use of a full stoichiometric matrix to constrain results, as opposed to other approaches that are based on an adjacency matrix of metabolites. We realize that our explanation was not very clear, and we will make sure to clearly articulate this point in a revised version, which will include a figure supplement in which stoichiometry and adjacency are clearly compared to each other. In particular, in response to reviewer requests we will compare the predictions of our method with those of the NetCooperate method which utilizes an adjacency matrix (Levy et al.,2015; Levy and Borenstein, 2013). We will describe how our results differ from this method in terms of sensitivity and specificity. More specifically, we expect our method to be more specific in its predictions of exchanged metabolites and ability to discriminate different types of interactions than the NetCooperate method. Some results supporting this point are shown in preliminary Figure 3 (<xref ref-type="fig" rid="respfig3">Author response image 3</xref>) below.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>[…]</p><p>1) The method assumes a uniform distribution of possible substrate uptake combinations – which is not necessarily biologically observed. There are hierarchies – e.g. preference of glucose over other C-sources in most organisms.</p></disp-quote><p>This is a very interesting point. We first would like to clarify that the assumption of uniform <italic>P<sub>in</sub></italic> for our analysis was chosen specifically in order to assess environmental robustness across a uniformly sampled ensemble (see also Part 1, Point B above). Our method, however, can easily be implemented using variable <italic>P<sub>in</sub></italic> values that represent any assumed prior distribution on input metabolites. We propose an analysis that will utilize variable <italic>P<sub>in</sub></italic> values in order to further demonstrate the utility of our method for a specific biological example where variable assumptions about the environments may be of interest. We will analyze saccharolytic vs. proteolytic organisms from our set of oral microbiome organisms, which have key differing metabolic capabilities and implications in oral health and disease (Takahashi, 2015). Using variable <italic>P<sub>in</sub></italic> values, we will define a sugar rich and an amino acid rich environment, and we will calculate the PM of all biomass components for both saccharolytic and proteolytic organisms in both. The sugar-rich environment will have sugars with fixed <italic>P<sub>in</sub></italic> = 1 (i.e. they are always included in the environment) and the amino acid rich environment will have <italic>P<sub>in</sub></italic> = 1 for amino acids. By fixing <italic>P<sub>in</sub></italic> for these metabolites the PM will then become a measure of how many metabolites, beyond those that are fixed on, need to be added to the environment to produce a given target metabolite. These results will allow us to determine whether our method can capture the environmental preference and metabolic processes of these two classes of organisms from the human oral microbiome. This analysis is further described in prospective Figure 4, which has yet to be generated.</p><disp-quote content-type="editor-comment"><p>2) The finding that metabolic dependencies may exist in oral microbiome is not that surprising per se given that a large body of literature (including papers also from the Segre lab) already suggest that metabolic dependencies are likely widespread in microbial communities. Thus, it is not clear whether only the proposed method would be able to identify these.</p></disp-quote><p>Indeed, as expressed by the reviewer, a lot of literature exists about computational and empirical reports of inter-species dependencies in microbial communities. However, we believe that the reviewer will agree that what has been done uncovers with limited fidelity a minuscule fraction of the interactions likely present in nature. The challenge that remains is in characterizing and describing the mechanisms of these dependencies/interactions. We will add a statement emphasizing this point. Beyond this clarification, we will be happy to address more specifically the reviewer’s concern, i.e. show that our method can provide insight that is substantially different from the type of insight provided by other methods. We will compare our method to results obtained from three different alternative methods: (1) Pathway completeness, (2) Flux balance analysis, and (3) NetCooperate. These comparisons are, in part, addressed in the responses to other reviewer comments, and are described in detail in Part 1 point A, which outlines this major issue. We also note that, to our knowledge, ours is the first large-scale metabolic analysis of this type in the human oral microbiome. In this sense it provides valuable new insight into this microbial community and can further serve as a blueprint for analyzing other complex microbial communities.</p><disp-quote content-type="editor-comment"><p>3) Lack of experimental validation makes it difficult to assess whether the identified exchanges are happening in the system. At the least, a detailed analysis of systems with known metabolite exchanges (and how the proposed method there differs from the previous ones) should be provided.</p></disp-quote><p>This is a good point and we will attempt to address it as best we can. Unfortunately, there are limited systems where microbial metabolic dependencies and interactions have been unraveled experimentally. One example where there is some experimental knowledge that we will analyze is the exchange of organic acids in the oral microbiome. One such example is the exchange of lactic acid produced by <italic>Streptococcus</italic> and consumed by <italic>Veillonella</italic> species (Chalmers et al., 2008, J. Bact.). Another example is the exchange of succinate from <italic>T. denticola</italic> to <italic>P. gingivalis</italic> and isobutyric acid from <italic>P. gingivalis</italic> to <italic>T. denticola</italic> (Grenier, 1992, Infect. immun.). To analyze these examples, we will extend our method to not only calculate PM values for essential biomass components but also to include possible secreted metabolites such as organic acids. We will then utilize our method to calculate the PM for these different organisms and identify metabolic complements. Through this analysis we will confirm whether or not our method is able to capture these well-known microbial interactions. Furthermore, we will extend this analysis to calculate the PM of a set of possibly exchanged organic acids for all oral microbiome organisms in our catalog in order to gain broad insight into organic acid producibility and potentially predict new metabolic exchanges.</p><p>Another analysis we propose to perform is the study of a slightly more complicated microbial ecosystem, consisting of <italic>E. coli</italic> amino acid auxotrophs (Mee et al., 2014). In this work all pairs of <italic>E. coli</italic> single amino acid auxotrophs and all triplets of double auxotrophs where grown in co-culture to identify pairs and triplets that enabled syntrophic growth. We will re-analyze these <italic>E. coli</italic> auxotrophs and calculate their PM for all amino acids to determine if our method can predict the increased ability of growth-supporting auxotrophs to produce the amino acids that their syntrophic partners are lacking. We anticipate that certain amino acid auxotrophs, on top of being unable to produce a single specific amino acid, will have decreased robustness in their production of other amino acids that have similar biosynthetic pathways. This will lead to decreased syntrophic growth between auxotrophs that cannot robustly synthesize each other’s essential amino acids, and can be predicted by our PM calculations. For example, upon first inspection of the data from Mee et al. in Figure 1C we can see this pattern with regards to the L-methionine and L-cysteine auxotrophs (L-methionine and L-cysteine are the two sulfur containing amino acids and have similar biosynthetic pathways). While the L-methionine auxotroph has improved syntrophic growth with a number of other auxotrophs it has notably little syntrophic growth with the L-cysteine auxotroph. A further analysis of this data and comparison to our PM calculations will be presented in prospective Figure 5 (see legend below), to be included in the methods section of our manuscript as an additional validation of our method.</p><p>We will also analyze the performance of our metric in describing microbial co-occurrence patterns across the human oral microbiome. Although co-occurrence does not necessarily imply interactions, and mechanisms of interaction are not known for these cases, previous methods have been shown to be capable of identifying metabolic trends associated with microbial co-occurrence (Levy and Borenstein, 2013). We will use our method to analyze two different type of co-occurrence data and attempt to similarly identify metabolic trends. The first set of co-occurrence data is from sequencing data from the human microbiome project (Huttenhower et al., 2012, Nature). The human microbiome project included 9 different oral sites from which we will collect microbial co-occurrence data that can be compared to the oral microbiome strains that we have analyzed. The second form of co-occurrence data is from physical associations which have been observed through fluorescence microscopy (Welch et al., 2016). In this work the authors identified structure in supragingival plaque microbial communities from the oral microbiome. These structured communities suggest interactions that can similarly be compared with our PM metric to identify metabolic trends associated with microbial co-occurrence. The results of this analysis will be presented in prospective Figure 6 and included in a supplementary results section of our revised manuscript.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>[…]</p><p>Given the rate of generation of microbial genomes it would be very useful to have a better method to even approximately predict metabolic products of organisms. However, what the study lacks in my opinion, is quantitative evidence that the metric actually does translate into a prediction that the organism produces a given metabolite. They provide some anecdotal examples where it appears to work but without a more thorough analysis of what the metric means then it will only be useful in a qualitative sense i.e. a higher PM indicating that one organism is more likely to produce a metabolite than another. Metabolic modelling is admittedly not my field, but datasets capable of testing the metric, must exist. A possible example might be this collection of E coli strains and phenotypes defined in terms of growth conditions (Galardini et al., 2017, eLife). If such datasets are not available, then I feel the authors need to be more circumspect in their conclusions and concede that the metric may say something about the production of metabolites but without any certainty about how a given PM value translates into an actual probability of production.</p></disp-quote><p>We appreciate the reviewer’s comment, which made us realize that a number of subtle but important aspects of our analysis were not clearly explained in the manuscript. First of all, we recognize that we can do a better job at providing an intuition for the meaning of the PM metric, including a clarification that it is not meant to quantitatively capture rates of reactions (fluxes) (as done by FBA) but rather the fraction of environmental metabolites that an organism is expected to need in order to produce with high probability a given metabolite. Additional details of the intuition behind our definition are provided in Part 1, point B. We will further emphasize, in our revised manuscript, the nature of PM as a measure of robustness rather than a probability of production.</p><p>The most important concern expressed by the reviewer, however, seems to be the insufficient comparison with experimental data, which can lead one to legitimately wonder how accurate and valuable our predictions are. Irrespective of the outcome of the additional analyses we propose to perform for validating our predictions (see Part 1, point C above, and more details below), we will certainly take to heart the reviewer’s suggestion to more explicitly describe the possible limitations of our inferences. At the same time, this will also give us an opportunity to emphasize that, relative to existing methods, our approach provides a very unbiased estimate of the metabolic capabilities of a given organisms given its genome, avoiding some of the issues of gap-filling algorithms used for flux balance models.</p><p>In considering the reviewer’s recommendation of additional comparisons with experimental data, we have identified a few datasets whose analysis would enable a more substantial validation of our approach. These include a number of specific interactions between oral microbes, mediated by the exchange of organic acids, and a fairly rich dataset on amino acid exchange between <italic>E. coli</italic> auxotrophs. Both datasets are described in some more detail in response to reviewer #2 comment 3.</p><p>We also appreciate the reviewer’s suggestion of a high-throughput dataset that could be used to additionally assess our method, and we thank the reviewer for suggesting the interesting paper included. Unfortunately, the majority of the conditions tested in this paper are undefined or non-metabolic (mainly consisting of antibiotics or other stressors), and it is therefore not the best dataset for evaluating our method. In the spirit of the reviewer’s comments, we would like to suggest a similar high-throughput analysis using data from a different <italic>E. coli</italic> mutant phenotyping study that we identified (Tohsato et al., 2010, J. Bioinform. Comput. Biol.). This dataset includes phenotype data from 300 <italic>E. coli</italic> K12 mutants from the Keio collection grown on 1920 different conditions using Biolog Phenotypic Microarrays. Many of these conditions are metabolic in nature consisting of minimal media supplemented with different carbon, nitrogen, phosphorus, or sulfur sources. We have contacted the authors of this paper in the hope that they will share the raw data of their study with us, in which case we would pursue an analysis wherein we analyze this data to provide a more-high throughput clarification of PM and how exactly it relates to environmental robustness. In particular, we anticipate that <italic>E. coli</italic> knockouts with high PM for all essential biomass components will survive on a large number of variable nutrient environments, whereas knockouts with low PM for all essential biomass components will survive on a very small number of variable nutrient environments. Furthermore, analysis of the specific knockout/environment pairs could give us insight into the ability of our method to predict specific auxotrophies and metabolic requirements.</p><disp-quote content-type="editor-comment"><p>Other than the above caveat, I thought this was a good study but it was sparse on the practical details of the methodology. The GitHub repository consists of a selection of Matlab scripts without a clear description of how to apply them. What would be really useful is a complete walkthrough of the methodology from genome to PM values including for example ggkbase commands used to build the models. This is necessary if this work is to be properly reproducible. One final comment was that some evaluation of the impact of sample number on the calculated PM values would be a worthwhile addition. The authors mention that 50 samples of input metabolite combinations were used but no analysis of the impact of this choice on the PM values was given.</p></disp-quote><p>This is a good point and we appreciate the reviewer’s effort to help us make our method more reproducible. We will add to the GitHub repository example scripts that walk the readers through how to implement our algorithm and obtain our results. In addition to these example scripts, we will add a supplementary methods section that contains a procedural walk through on how to go from a genome to metabolic predictions using KBase (http://kbase.us) to reconstruct a model and our method to analyze it. Regarding the parameter choice for the algorithm, we note that those numbers were chosen by hand to improve algorithm performance. We will further describe the process of choosing these parameters and the impact on PM calculations including means and standard deviations of results.</p><p>PART 3 – Preliminary and prospective figures</p><fig id="respfig1"><label>Author response image 1.</label><caption><title>Proposed Figure 1.</title><p>Analysis of our Producibility Metric (PM) for individual gene deletions in the L-histidine biosynthetic pathway in <italic>E. coli</italic>. Note that the PM varies for all gene deletions tested, while other metrics such as pathway completeness, FBA, or network expansion would yield the same results for all knockouts. For pathway completeness the results would be 8 of 9 reactions present, and for FBA/network expansion Lhistidine would not be producible from an externally supplied metabolite fed into the top of the pathway. (<bold>A</bold>) The linear pathway was analyzed by knocking out individual reactions (squares) at different distances from L-histidine (red circle). (<bold>B</bold>) The PM was calculated for L-histidine and all other biomass components in the <italic>E. coli</italic> metabolic network, and it can be seen that the distance of the knock-out from L-histidine significantly affects its PM other biomass components are not affected. (<bold>C</bold>) The resulting PM from different knockouts (blue circles) was compared to the theoretical value for the PM of a metabolite with 1 to 9 individual precursors using our combinatorial theory (x’s) and was found to match. This result indicates that the additional co-factors utilized in this pathway (gray circles) have minimal impact on the final PM of Lhistidine.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-resp-fig1-v2.tif"/></fig><p>These results will be further elaborated and included in a new figure in a supplementary methods section of our revised manuscript.</p><fig id="respfig2"><label>Author response image 2.</label><caption><title>Proposed Figure 2.</title><p>Comparison of the performance of our method relative to FBA in predicting metabolic properties of an organism (<italic>E. coli</italic>) as an increasing number of random gaps in the metabolic network are introduced..</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39733-resp-fig2-v2.tif"/></fig><p>The ability of the <italic>E. coli</italic> iJO1366 metabolic network to produce biomass under different conditions and constraints was analyzed for networks impacted by an increasing number of random perturbations that remove reactions in the network. Reactions were removed sequentially from the metabolic network. The resulting biosynthetic capabilities (on a rich medium) are plotted for the average of 10 different random runs, with error bars indicating standard error across runs. Flux balance analysis (FBA) calculations of the biomass flux become infeasible fairly quickly, whereas our metabolite producibility metric extends far beyond the FBA infeasibility region</p><p>An updated version of this figure will be included in a supplementary methods section of our revised manuscript.</p><fig id="respfig3"><label>Author response image 3.</label><caption><title>Proposed Figure 3.</title><p>Comparison of metabolic complementarity computed as an Advantage Metric based on our producibility metric (PM) vs. the NetCooperate complementarity score.</p></caption><graphic mime-subtype="png" mimetype="image" xlink:href="elife-39733-resp-fig3-v2"/></fig><p>Complementarity metrics were calculated to summarize the potential for any one organism to provide metabolic products to another. The “advantage metric” was calculated using our PM metric that describes the metabolic advantage one organism can provide to another. This metric was plotted against an analogous complementarity metric calculated using NetCooperate for all directed pairs of 456 oral microbiome organisms. Log-scale histograms display the distribution of complementarities for each method. The histograms show that the advantage metric has a bi-modality that distinguishes between interactions involving fastidious/uncultivated organisms from those that do not, while the NetCooperate complementarity does not display a similar distribution.</p><p>The formula for the advantage metric is described below for organism A to B. The metric is calculated by summing over i = 1 to N metabolites.</p><p>A→B=maxPMiA,PMiB-PMiB∑i=1NPMiA</p><p>A subsequent version of this figure will be added to a supplementary results section of our revised manuscript as Figure 4—figure supplement 7.</p><p>Proposed Figure 4. To be generated. Analysis of variable <italic>P<sub>in</sub></italic> values for saccharolytic and proteolytic oral microbiome organisms.</p><p>This figure will display the ability of our method to utilize variable <italic>P<sub>in</sub></italic> values to provide biological insight into a set of organisms that may prefer a specific environment. An analysis of the PM values calculated for a set of saccharolytic and another set of proteolytic oral microbiome organisms in either a sugar or amino acid rich environment that has been altered by changing <italic>P<sub>in</sub></italic> values will be presented.</p><p>This figure will be added to a supplementary results section of our revised manuscript.</p><p>Proposed Figure 5. To be generated. Analysis of <italic>E. coli</italic> amino acid auxotrophs.</p><p>This figure will display the ability of our method to predict metabolic interactions in a system with known metabolic dependencies. PM calculations for <italic>E. coli</italic> amino acid auxotrophs will be compared to data showing syntrophic growth among pairs and triplets of auxotrophs.</p><p>This figure will be added to a supplementary methods section of our revised manuscript as additional validation.</p><p>Proposed Figure 6. To be generated. Analysis of co-occurrence in the oral microbiome.</p><p>This figure will display the ability of our method to identify metabolic trends in microbial co-occurrence networks. Co-occurrence networks will be taken from two distinct sources. The first data source will be cooccurrence from sequencing data from the human microbiome project. The second will be physical associations from fluorescence microscopy data. We will further display how our metric, describing metabolic properties, can be used to describe metabolic trends in these co-occurrence networks.</p><p>This figure will be added to a supplementary results section of our revised manuscript.</p><p>[Editors' note: the authors’ plan for revisions was approved and the authors made a formal revised submission.]</p><p>Section 1 (Response to final recommendations)</p><disp-quote content-type="editor-comment"><p>The Reviewing Editor stated:</p><p>&quot;I think that I know how authors can fix their problems from a theoretical aspect. They can start with a complete model as the &quot;ground truth&quot; model, but hide or mis-annotate various% links to mimic our incomplete knowledge of the system, and compare their method with existing methods. This way, they will always have a &quot;ground truth&quot; curve for any metric of interest to biologists. Of course, the task of assigning missing links will need to be repeated many times and in double-blind fashion to gain statistical power. I suspect that different methods might show tradeoff. For example, in their Figure 1, it is not clear whether the extra info provided by PM is useful to a biologist if all mutants are auxotrophic. Any tradeoff between methods is also valuable to know. Authors can also use this ground truth model to illustrate problems of gap filling etc.&quot;</p></disp-quote><p>We thank the Reviewing Editor for this suggestion, which we addressed by analyzing a well curated metabolic network (“ground truth”) that has been degraded to different degrees (“miss-annotated”). This new analysis is presented in the main text, in a new section of the Results titled “Producibility analysis shows improved tolerance to missing reactions compared to flux balance analysis”. This section is accompanied by a newly added main figure (Figure 3). For this analysis, we used the well-curated <italic>E. coli</italic> iJO1366 metabolic network as our ground truth model, which we perturbed to different degrees by randomly removing reactions. This was repeated 50 times for 5 different levels of random reaction removal generating 250 different degraded metabolic networks. We analyzed these networks with FBA and with our producibility metric. This allowed us to show that the producibility metric is more tolerant of removed reactions in its predictions than FBA. Thus, this analysis illustrates that the producibility metric provides useful information on growth capabilities for draft metabolic networks that would need to be gap-filled in order to be analyzed with FBA.</p><disp-quote content-type="editor-comment"><p>Another reviewer said:</p><p>&quot;I agree this is a very comprehensive plan and they do seem to have taken our comments to heart and developed a proposal to address them. I was pleased with their suggestions regarding an alternate dataset of E. coli phenotypes to test their metric and the improved GitHub repository.&quot;</p></disp-quote><p>As described in Section 2, in response to reviewer #3’s comments 1 and 2, we have addressed in detail the comments made in the original review letter, expanding on our initial plan for a revision. This includes a number of new analyses including several that relate our method to experimental phenotypic data, both in <italic>E. coli</italic> (Results section “Metabolite producibility points to putative metabolic mechanisms for <italic>E. coli</italic> auxotroph co-cultures”) and in the human oral microbiome (Results section “Organic acid production predicted for human oral microbiome organisms”, and Results section “Metabolic similarity correlates with microbial co-occurrence in the human oral microbiome”). Additionally, we have improved the GitHub repository by adding a detailed example of how to run our code.</p><p><italic>The last reviewer said:</italic></p><disp-quote content-type="editor-comment"><p>&quot;I agree that the proposal is comprehensive and I like the Reviewing Editor's simulation idea. This also reminds me that the authors' should comment on the ensembleFBA approach which does address the main criticisms of the gap-filling. Furthermore, I think that a clear focus on oral microbiome would benefit the study much more rather than claiming general validity that is very difficult to substantiate based on their proposed plan – after all, E. coli is one organism and by no means representative of natural diversity and community complexity. E. coli auxotroph complementation experiments are also unique in some sense as I haven't seen many other studies showing similar data in other organisms. So, overall, I think recommending to focus on oral microbiome and reducing the general claims would put the paper on more solid foundation I believe.&quot;</p></disp-quote><p>We appreciated this comment and recommendation from the reviewer. We gladly included reference to the ensembleFBA approach (Biggs et al., 2015), as well as to the newly published CarveMe method that is also capable of ensemble model reconstruction (Machado et al., 2018). We agree that these approaches constitute promising methods for addressing the gap-filling problem, and we are happy to mention them in the Introduction of the paper.</p><p>Regarding the more general comment on remaining focused on the oral microbiome and reducing our general claims, we greatly appreciate this advice. In balancing other reviewers’ comments with this suggestion, we have implemented some illustrative examples in <italic>E. coli</italic>, including an analysis of <italic>E. coli</italic> auxotroph co-cultures and the Reviewing Editor's simulation idea in <italic>E. coli</italic>; however, we have focused most other new analyses on oral microbiome organisms. New analyses focused on the oral microbiome include: (i) observing the relationship between the completeness of the histidine biosynthetic pathway and our metric (Results section “Producibility of metabolites differs from pathway completeness and captures minimal precursor set structure”), (ii) investigating organic acid production (Results section “Organic acid production predicted for human oral microbiome organisms”), (iii) implementing our method in an environment specific manner with the analysis of a saccharolytic and a proteolytic organism (Results section “Metabolite producibility in a protein vs. carbohydrate enriched environment”), and (iv) associating our metric with co-occurrence from 16S rRNA sequencing data from the human oral microbiome (Results section “Metabolic similarity correlates with microbial co-occurrence in the human oral microbiome”). In all of these analyses we have sought to relate our findings with phenotypes that are relevant for the human oral microbiome whenever possible, trying to candidly illustrate what works well and what doesn’t. Additionally, we feel that the revised manuscript provides a better explanation for why and how our approach is particularly useful for addressing microbial community questions in cases where the specific metabolic composition of the environment is highly uncertain, such as in the study of natural human-associated microbiomes. This clarifies our motivation for focusing on the human oral microbiome in this study and provides insight into which scenarios our method is best suited for in the future.</p><p>Section 2 (Response to initial reviewer comments)</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>[…]</p><p>1) What is the difference between PM and% completion of biosynthetic pathway?</p></disp-quote><p>This is an important question, which we have addressed through new analyses added to the Results section “Producibility of metabolites differs from pathway completeness and captures minimal precursor set structure” and Figure 2—figure supplement 2. We have additionally introduced a new paragraph in the Discussion addressing the difference between our method and alternative methods including biosynthetic pathway-based analysis. The specific changes are described in detail below:</p><p>The first analysis we performed was focused on looking in detail at the biosynthetic pathway for the amino acid histidine in <italic>E. coli</italic>. We focused on this pathway because it is overall linear, and thus more easily interpretable. We used the well curated <italic>E. coli</italic> iJO1366 metabolic network and we examined this biosynthetic pathway by “knocking-out” different metabolic reactions along the pathway and calculating our Producibility Metric (PM). We observed that the PM was able to capture the impact of the specific location of the knockout and the topology of the metabolic pathway. In contrast, looking at the% completion of the biosynthetic pathway would not provide this information.</p><p>A second analysis extended this concept to all 456 oral microbiome metabolic networks. Specifically, we calculated both the% completion of the histidine biosynthetic pathway (total number of reactions present) and the length (distance from histidine before a reaction is missing). We found that both of these metrics are correlated with the PM for histidine. However, the length of the intact portion of the biosynthetic pathway is more strongly correlated with the PM than with the% completion, corroborating, across a large set of metabolically diverse organisms, the result obtained for <italic>E. coli</italic>.</p><p>A deeper, and theoretically motivated portion was additionally introduced in the end of this newly added Results section, to further clarify how the PM differs from% completion of a biosynthetic pathway. We found that the PM for histidine of different knock-outs matched closely with our theoretical predictions based on combinatorics. In this new section, we point out that the combinatorial equations establish an intimate connection between the PM and the minimal precursor set structure of a particular target metabolite, and thus captures a complex measure of the multiplicity of biosynthetic routes through which the target metabolite can be produced. This theoretical analysis points out a profound meaning of the PM, which could be further explored in future work.</p><p>Finally, we added a section to the Discussion, to emphasize that our method has another important advantage over% completion: it does not rely on previously defined biosynthetic pathway annotations. While this prior knowledge can be quite useful in many contexts, specific biosynthetic routes can cross the boundaries of annotated pathways, making pathway completeness uninformative. We have highlighted a few scenarios from the literature and in our own analysis where this is the case, and where less biased network based approaches have an advantage.</p><disp-quote content-type="editor-comment"><p>2) It's also not entirely clear to what extent their method improves upon the state of the art. In their Introduction, they say that two downsides that limit FBA (but not their method) are assumptions on environmental conditions and reconciling with stoichiometry-based constraints. I don't really understand their second limitation, but they sidestep the first limitation by assuming a constant P<sub>in</sub> among all inputs. This seems similar to assuming constant concentration among all inputs for FBA, which is never shown.</p></disp-quote><p>We agree with the reviewer’s comment that our original version of the manuscript did not clearly articulate how our method improves upon the state of the art. In the revised manuscript we have made changes to the Introduction and Discussion that clarify the novelty of our method, and we have added a number of analyses to the Results section where our method is directly compared with alternative methods.</p><p>The main novelty of our method, i.e. the statistical nature of the percolation approach, is now reflected in a modified Title and Abstract, and better explained in a revised, more straightforward version of Figure 1 (the original Figure 1 is still available as Figure 1—figure supplement 1). Furthermore, we updated Figure 2B to more clearly demonstrate the features of the PM; specifically, that it is independent from node degree and that recycled co-factors have minimal impact on PM. To better explain in general terms how our method improves upon the state of the art, we significantly altered the text of our Introduction. In this revised Introduction, we revisit the first limitation mentioned by the reviewer, by clarifying the rationale of assumptions on environmental conditions, i.e. the ability of our method to provide predictions in scenarios where the chemical environment of the microbes is unknown. We also note that our choice of constant <italic>P<sub>in</sub></italic> was chosen as the most naïve choice by which we could statistically sample the environment. This approach is different than providing all nutrients with uniform uptake rate in regular FBA, because it samples an ensemble of environments, rather than assuming a single uniformly rich one. Additionally, for reviewer #2 comment 1, we have implemented an analysis where we use non-uniform <italic>P<sub>in</sub></italic> to demonstrate the capacity of our method to incorporate environmental assumptions (Results section “Metabolite producibility in a protein vs. carbohydrate enriched environment”). Regarding the second limitation mentioned by the reviewer, about stoichiometry-based constraints, we discuss this in more detail in a modified portion of the Discussion, where we highlight the difference between networks defined by reaction stoichiometry vs. connectivity.</p><p>The reviewer’s concern about improving upon the state of the art was further addressed in detail by adding to the Results section several new analyses in which we compare our method with alternative ones. In addition to the comparison of our method with percent pathway completion, discussed in detail in the previous comment, we implemented the following new comparative analyses:</p><p>i) As described also in Summary Comment 1, a comparison with FBA, including an analysis of how FBA and the PM cope with a gradually increasing number of perturbations of a genome-scale metabolic network (mimicking the situation of non-gap-filled draft reconstructions), was addressed in the new section “Producibility analysis shows improved tolerance to missing reactions compared to flux balance analysis” of the Results and Figure 3.</p><p>ii) We also compared our method to several different metabolic network analysis methods in the context of microbial co-occurrence data in the new Results section “Metabolic similarity correlates with microbial co-occurrence in the human oral microbiome” and the newly added Figure 4—figure supplement 6. We showed that an inter-organism distance based on our PM score explains co-occurrences better than scores based on alternative methods we tested (as shown in the newly added Supplementary file 4). We further show that our approach more precisely separates fastidious/uncultivated microbes than an alternative approach in Figure 4—figure supplement 7. Further comments on how our method differs from and improves upon other potential approaches, as well as an extended discussion of limitations, have been added to two paragraphs in the Discussion.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>[…]</p><p>1) The method assumes a uniform distribution of possible substrate uptake combinations – which is not necessarily biologically observed. There are hierarchies – e.g. preference of glucose over other C-sources in most organisms.</p></disp-quote><p>We thank the reviewer for raising this point, which gave us the opportunity to better clarify two important aspects of our analysis. First, the assumption of uniform <italic>P<sub>in</sub></italic> for our analysis was chosen specifically in order to assess biosynthetic capabilities across a uniformly sampled ensemble of environments, i.e. under the assumption of minimal knowledge about the chemical composition of the growth medium. We have emphasized this point in the revised Abstract, mentioned it in the Introduction, and clarified it in the revised “Analysis Method” section and the newly added Figure 1.</p><p>Second, while in the previous version of our manuscript we indeed only focused on the case of a uniform <italic>P<sub>in</sub></italic>, we were glad to clarify and exemplify in the revised manuscript the feasibility of arbitrarily chosen, metabolite specific set of <italic>P<sub>in</sub></italic> values, which encode assumptions about the environmental composition. In particular, to demonstrate this capability, we have recalculated the producibility metric (PM) for one saccharolytic and one proteolytic organism in a protein enriched environment and carbohydrate enriched environment. While we found only modest increases in the PM in both of the enriched environments, we did find that the producibility metric was further increased for the proteolytic organism in the protein enriched environment than it was for the saccharolytic organism. This analysis demonstrates how we can tailor our method to use variable <italic>P<sub>in</sub></italic> values to ask interesting questions about an organism’s environmental dependencies. The analysis is presented as newly added Results section “Metabolite producibility in a protein vs. carbohydrate enriched environment” and Figure 4—figure supplement 5.</p><disp-quote content-type="editor-comment"><p>2) The finding that metabolic dependencies may exist in oral microbiome is not that surprising per se given that a large body of literature (incl. papers also from the Segre lab) already suggest that metabolic dependencies are likely widespread in microbial communities. Thus, it is not clear whether only the proposed method would be able to identify these.</p></disp-quote><p>Indeed, as expressed by the reviewer, the novelty of our work is not so much in pointing out the general possibility of inter-species metabolic exchanges, but rather in (i) the capacity of our method to produce predictions in a way that is specific to the underlying genome and molecular products, but at the same time robust to uncertainty in environmental composition and to missing gene annotations; and (ii) the production of a detailed atlas of biosynthetic capabilities and complementarities for a specific ecosystem of high interest for multiple health-related studies, namely the human oral microbiome. To our knowledge, ours is the first large-scale metabolic analysis of this type in the human oral microbiome. In this sense, it provides valuable new insight into this microbial community and can further serve as a blueprint for analyzing other complex microbial communities.</p><p>In the revised manuscript, however, in line with the reviewer’s comment, we made sure to better present our results in the context of previous analyses. In particular, in addition to more clearly stating the objectives of our work in the Introduction, we reference and describe in more detail prior literature on computational and empirical analyses of inter-species dependencies in microbial communities. Beyond this clarification, we have also added a number of analyses that compare our method to different alternative methods including: pathway completeness (Results section “Producibility of metabolites differs from pathway completeness and captures minimal precursor set structure”, Figure 2—figure supplement 2), flux balance analysis (Results section “Producibility analysis shows improved tolerance to missing reactions compared to flux balance analysis”, Figure 3), and alternative metabolic network analysis methods, such as NetCooperate used in a similar analysis (Levy and Borenstein, 2013), through an analysis of microbial co-occurrence data from the human oral microbiome (Results section “Metabolic similarity correlates with microbial co-occurrence in the human oral microbiome”, Supplementary file 4, Figure 4—figure supplement 6, Figure 4—figure supplement 7).</p><disp-quote content-type="editor-comment"><p>3) Lack of experimental validation makes it difficult to assess whether the identified exchanges are happening in the system. At the least, a detailed analysis of systems with known metabolite exchanges (and how the proposed method there differs from the previous ones) should be provided.</p></disp-quote><p>This is an excellent point. We are grateful to the reviewer for the suggestion, which prompted us to perform a number of analyses to assess the capacity of our method to relate to experimental measurements, and to compare our approach with previously published ones. We believe that this process ended up strengthening our manuscript significantly.</p><p>First, we examined an experimental dataset on microbial co-culture growth. This new analysis is described in a new section of the Results titled “Metabolite producibility points to putative metabolic mechanisms for E. coli auxotroph co-cultures”, Figure 3—figure supplement 1. For this new analysis, we used <italic>E. coli</italic> auxotroph co-culture data from Wintermute and Silver (2010). This dataset has the advantage of using genetically well-defined <italic>E. coli</italic> strains with specific known auxotrophies, such that corresponding genome scale models can be appropriately constructed, and metabolic exchanges can be inferred with reasonable confidence. We analyzed this system in detail to provide insight into the predictive capacity of our method. The comparison of model predictions with experimental data led to a number of observations, reported in the manuscript, and summarized briefly as follows: (i) we found that for several auxotrophs in the tryptophan pathway, the PM value for tryptophan was correlated with the auxotrophs’ ability to be supplemented by other auxotrophs; (ii) we observed that metabolically similar organisms (as measured by their PM difference across all biomass components) tend not to supplement each other’s growth; (iii) in the new section we also point out some exceptions to the trends mentioned above, including increased synergistic growth for at least one set of auxotrophs with knockouts in the same biosynthetic pathway, which highlights the complexity of this experimental data and the limitations of our method.</p><p>In a second newly added analysis, we utilized our metric, as well as previously published metrics, to describe microbial co-occurrence patterns across the human oral microbiome. The results of these analyses are presented in a new Results section titled “Metabolic similarity correlates with microbial co-occurrence in the human oral microbiome”, accompanied by a newly added Supplementary file 4. Although co-occurrence does not necessarily imply interactions, and mechanisms of interaction are generally unknown, previous methods have been shown to be capable of identifying metabolic trends associated with microbial co-occurrence in the human microbiome (Levy and Borenstein, 2013) We used our method to analyze co-occurrence from metagenomics data from 7 different oral sites in the human microbiome project. Co-occurrence data calculated using both the SparCC method and Pearson’s correlation were taken from Friedman and Alm (2012). We compared our method with a number of different metabolic network analysis methods, including NetSeed, NetCooperate, and NetCmpt used in Levy and Borenstein, as well as simple metrics based on metabolic reaction distance and Jaccard’s distance. We found that our metabolic network metric, based on the difference in PM between two organisms for all biomass components, was the most consistently anticorrelated with co-occurrence data (irrespective of co-occurrence estimate method), showing that similar organisms tend to co-occur. This result corroborates the habitat filtering hypothesis previously proposed by Levy and Borenstein. We also found that our method, and other methods, correlated more consistently with co-occurrence inferred from the SparCC method than those inferred from Pearson’s correlation, which further corroborates the claims of Friedman and Alm that Pearson’s correlations can fail to capture true co-occurrence in compositional data. Additionally, we found that our PM based metric maintained correlation with co-occurrence when controlling for other metrics through partial correlations while the inverse was not always true. This analysis highlights our metric’s ability to capture metabolic similarities between organisms, that correlate with co-occurrence, beyond what is captured by existing metabolic network analysis methods.</p><disp-quote content-type="editor-comment"><p>Finally, we extended our calculation of PM to include organic acid production. This analysis is presented in a new Results section titled “Organic acid production predicted for human oral microbiome organisms”, Figure 4—figure supplement 4. Through this analysis, we used our approach to determine whether it could predict organic acid production in human oral microbiome organisms. In particular, we were able to identify trends in organic acid production by different genera of oral microbiome organisms. We found that the <italic>Fusobacteria</italic> genera had increased PM for butyrate, a result with important implications in oral health, and which is supported by independent transcriptomic data from the literature (Jorth et al., 2014). Additionally, we found that some species of the <italic>Porphyromonas</italic> and <italic>Prevotella</italic> genera, which have been implicated in periodontal disease due to production of organic acids (Takahashi, 2015), had increased PM for butyrate as well. These results, while not directly proving exchange of a given metabolite across a specific organism pair, provide valuable information about putative secretions that could mediate these interactions.</p><p>Reviewer #3:</p><p>[…]</p><p>Given the rate of generation of microbial genomes it would be very useful to have a better method to even approximately predict metabolic products of organisms. However, what the study lacks in my opinion, is quantitative evidence that the metric actually does translate into a prediction that the organism produces a given metabolite. They provide some anecdotal examples where it appears to work but without a more thorough analysis of what the metric means then it will only be useful in a qualitative sense i.e. a higher PM indicating that one organism is more likely to produce a metabolite than another. Metabolic modelling is admittedly not my field, but datasets capable of testing the metric, must exist. A possible example might be this collection of E. coli strains and phenotypes defined in terms of growth conditions (Galardini et al., 2017, eLife). If such datasets are not available then I feel the authors need to be more circumspect in their conclusions and concede that the metric may say something about the production of metabolites but without any certainty about how a given PM value translates into an actual probability of production.</p></disp-quote><p>We appreciate the reviewer’s comment, which raises a very good point. The most important concern expressed by the reviewer seems to be the insufficient comparison with experimental data, which can lead one to legitimately wonder how accurate and valuable our predictions are. Throughout our response to all reviewer comments, we have taken to heart this concern, by implementing a number of new analyses that compare our predictions with different kinds of experimental data, as well as with previously published approaches. In presenting these new analyses, we have shown the strengths of our approach, but we have also explicitly described the possible limitations of our inferences. We believe that these additional analyses will provide the readers with a clearer perspective of the type of microbial ecology questions for which our method can provide valuable insight.</p><p>The first analysis we performed to illustrate the value of our method was a comparison with the simpler approach of quantifying the percent completion of a pathway as a measure of biosynthetic capability. This analysis was also described in further detail for reviewer #1 comment 1, and is presented in the Results section “Producibility of metabolites differs from pathway completeness and captures minimal precursor set structure”, Figure 2—figure supplement 2. For this analysis, we analyzed the histidine biosynthetic pathway in <italic>E. coli</italic> in detail, calculating both the Producibility Metric (PM) and the% completion of the biosynthetic pathway for different knockouts along the linear pathway. Through this analysis we were able to illustrate the difference between the PM and a simpler pathway based analysis, giving additional insight into the meaning of the PM.</p><p>Next, we compared our method with flux balance analysis (FBA) for a genome-scale metabolic network with varying degrees of perturbations generated by randomly removing reactions from the network. This analysis is described in further detail in the Reviewing Editor’s summary comment and is presented in the Results section “Producibility analysis shows improved tolerance to missing reactions compared to flux balance analysis” and newly added main text Figure 3. Through this analysis we demonstrated that the PM is more robust to missing reactions than traditional FBA and can therefore provide additional insight into draft metabolic networks with gaps. Again, this analysis provided additional context to the meaning of the PM and its applicability for analyzing metabolic networks.</p><p>Next, we introduced several new analyses that compare our PM predictions to experimental data. These analyses provide insight into how the PM can be used to analyze and interpret biological data. The first of these was an analysis of <italic>E. coli</italic> auxotroph co-cultures presented in Results section “Metabolite producibility points to putative metabolic mechanisms for <italic>E. coli</italic> auxotroph co-cultures”, Figure 3—figure supplement 1. In this section, we use the PM to analyze co-culture synergistic growth data of different <italic>E. coli</italic> auxotrophs from Wintermute and Silver (2010). The comparison of PM predictions with experimental data led to a number of observations, reported in the manuscript, and summarized briefly as follows: (i) we found that for several auxotrophs in the tryptophan pathway, the PM value for tryptophan was correlated with the auxotrophs’ ability to be supplemented by other auxotrophs; (ii) we observed that metabolically similar organisms (as measured by their PM difference across all biomass components) tend not to supplement each other’s growth; (iii) in the new section we also point out some exceptions to the trends mentioned above, including increased synergistic growth for at least one set of auxotrophs with knockouts in the same biosynthetic pathway, which highlights the complexity of this experimental data and the limitations of our method.</p><p>We next extended our analysis of the human oral microbiome to predict organic acid production. This analysis is presented in Results section “Organic acid production predicted for human oral microbiome organisms”, Figure 4—figure supplement 4. We were able to identify trends in organic acid production by different genera of oral microbiome organisms. We found that the <italic>Fusobacteria</italic> genera had increased PM for butyrate, a result with important implications in oral health, and which is supported by independent transcriptomic data (Jorth et al., 2014). Additionally, we found that some species of the <italic>Porphyromonas</italic> and <italic>Prevotella</italic> genera, which have been implicated in periodontal disease due to production of organic acids (Takahashi, 2015), had increased PM for butyrate as well.</p><p>Finally, we added a large analysis of microbial co-occurrence data from metagenomic sequencing data. This analysis is presented in the new Results section “Metabolic similarity correlates with microbial co-occurrence in the human oral microbiome”, Supplementary file 4. In this analysis, we analyzed co-occurrence data from Friedman and Alm (2012) and calculated the correlation of co-occurrence with various inter-organism metabolic metrics calculated using our PM and alternative methods. We showed that an inter-organism distance based on our PM score explains co-occurrences better than scores based on any alternative method that we tested. Furthermore, there was a strong negative correlation between PM based inter-organism distance and co-occurrence indicating that organisms with similar biosynthetic capabilities tend to co-occur. Our finding corroborates and strengthens previous similar analyses of co-occurrence data from the human microbiome (Levy and Borenstein, 2013), and demonstrates the ability of our method to provide insight into large-scale top down data such as microbial co-occurrence from metagenomic sequencing.</p><p>We also appreciate the reviewer’s suggestion of a paper (and corresponding high-throughput dataset) that could be in principle used to additionally assess our method. Unfortunately, the majority of the conditions tested in this paper are undefined or non-metabolic (mainly consisting of antibiotics or other stressors), and it is therefore not the best dataset for evaluating our method. The alternative option we had considered, using a different dataset of similar type (from Tohsato et al., 2010, J. Bioinform. Comput. Biol.), ended up not being fruitful either, as we were unable to obtain this dataset. While this would have been a nice addition, we hope that the large number of new analyses we ended up performing to address this and other concerns will be deemed satisfactory.</p><disp-quote content-type="editor-comment"><p>Other than the above caveat, I thought this was a good study but it was sparse on the practical details of the methodology. The GitHub repository consists of a selection of Matlab scripts without a clear description of how to apply them. What would be really useful is a complete walkthrough of the methodology from genome to PM values including for example ggkbase commands used to build the models. This is necessary if this work is to be properly reproducible. One final comment was that some evaluation of the impact of sample number on the calculated PM values would be a worthwhile addition. The authors mention that 50 samples of input metabolite combinations were used but no analysis of the impact of this choice on the PM values was given.</p></disp-quote><p>This is a good point and we appreciate the reviewer’s effort to help us make our method more reproducible. We have added an example script to the GitHub page that can be run to calculate the producibility metric (PM) for a small subset of metabolic networks and metabolites. We also include code that could be used to calculate the PM for the 88 biomass metabolites and 456 oral microbiome metabolic networks analyzed throughout the paper. However, we note that this would take a long time and is best performed in parallel on a shared computing cluster, as described in the Materials and methods section.</p><p>Regarding the parameter choices, we note that these parameters were chosen by hand to provide adequate performance for our algorithm, which we have further emphasized in the Materials and methods section of our manuscript.</p></body></sub-article></article>