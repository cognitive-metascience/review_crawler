<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">46814</article-id><article-id pub-id-type="doi">10.7554/eLife.46814</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>A quantitative model of conserved macroscopic dynamics predicts future motor commands</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-135282"><name><surname>Brennan</surname><given-names>Connor</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5329-7720</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-21248"><name><surname>Proekt</surname><given-names>Alexander</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9272-5337</contrib-id><email>proekt@gmail.com</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Departmentof Neuroscience</institution><institution>University of Pennsylvania</institution><addr-line><named-content content-type="city">Philadelphia</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Anesthesiology and Critical Care</institution><institution>University of Pennsylvania</institution><addr-line><named-content content-type="city">Philadelphia</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Senior Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>11</day><month>07</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e46814</elocation-id><history><date date-type="received" iso-8601-date="2019-03-13"><day>13</day><month>03</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2019-05-22"><day>22</day><month>05</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Brennan and Proekt</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Brennan and Proekt</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-46814-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.46814.001</object-id><p>In simple organisms such as <italic>Caenorhabditis elegans</italic>, whole brain imaging has been performed. Here, we use such recordings to model the nervous system. Our model uses neuronal activity to predict expected time of future motor commands up to 30 s prior to the event. These motor commands control locomotion. Predictions are valid for individuals not used in model construction. The model predicts dwell time statistics, sequences of motor commands and individual neuron activation. To develop this model, we extracted loops spanned by neuronal activity in phase space using novel methodology. The model uses only two variables: the identity of the loop and the phase along it. Current values of these macroscopic variables predict future neuronal activity. Remarkably, our model based on macroscopic variables succeeds despite consistent inter-individual differences in neuronal activation. Thus, our analytical framework reconciles consistent individual differences in neuronal activation with macroscopic dynamics that operate universally across individuals.</p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.46814.002</object-id><title>eLife digest</title><p>How can we go about trying to understand an object as complex as the brain? The traditional approach is to begin by studying its component parts, cells called neurons. Once we understand how individual neurons work, we can use computers to simulate the activity of networks of neurons. The result is a computer model of the brain. By comparing this model to data from real brains, we can try to make the model as similar to a real brain as possible.</p><p>But whose brain should we try to reproduce? The roundworm <italic>C. elegans</italic>, for example, has just 302 neurons in total. Advances in brain imaging mean it is now possible to identify each of these neurons and compare its activity across worms. But doing so reveals that the activity of any given neuron varies greatly between individuals. This is true even among genetically identical worms performing the same behavior.</p><p>Researchers trying to model the roundworm brain have attempted to model the average activity of each neuron across many worms. They hoped they could use these averages to predict the behavior of other worms from their neuronal activity. But this approach did not to work. Even in roundworms, the coordinated activity of many neurons is required to generate even simple behaviors. Averaging the activity of neurons across worms thus scrambles the information that encodes each behavior.</p><p>Brennan and Proekt have now overcome this problem by developing a more abstract model that treats the nervous system as a whole. The model takes into account changes in the activity of neurons, and in the worms’ behavior, over time. A model of this type built using one set of worms can predict the behavior of another set of worms. This approach may work because in evolution natural selection acts at the level of behaviors, and not at the level of individual neurons. The activity of individual neurons can thus vary between animals, even when those neurons encode the same behavior. This means it may also be possible to model the human brain without knowing the activity of each of its billions of neurons.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>dynamical systems</kwd><kwd>systems modeling</kwd><kwd>calcium imaging</kwd><kwd>individual differences</kwd><kwd>neuronal dynamics</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>C. elegans</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>1R01GM124023</award-id><principal-award-recipient><name><surname>Proekt</surname><given-names>Alexander</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Calcium imaging is used to construct a model of <italic>Caenorhabditis elegans</italic> nervous system dynamics capable of predicting future behavioral switches on a trial by trial basis and across individual animals.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Advances in neuronal imaging (<xref ref-type="bibr" rid="bib32">Kato et al., 2015</xref>; <xref ref-type="bibr" rid="bib2">Ahrens et al., 2013</xref>; <xref ref-type="bibr" rid="bib7">Berényi et al., 2014</xref>; <xref ref-type="bibr" rid="bib30">Jorgenson et al., 2015</xref>; <xref ref-type="bibr" rid="bib82">Venkatachalam et al., 2016</xref>; <xref ref-type="bibr" rid="bib51">Nguyen et al., 2016</xref>; <xref ref-type="bibr" rid="bib65">Schrödel et al., 2013</xref>) are now making it possible to simultaneously record activity in a large number of neurons simultaneously during execution of behaviors. Most analytic techniques used to simplify such complex datasets involve dimensionality reduction (<xref ref-type="bibr" rid="bib32">Kato et al., 2015</xref>), clustering (<xref ref-type="bibr" rid="bib82">Venkatachalam et al., 2016</xref>), correlations between activity of neuronal populations and behavior (<xref ref-type="bibr" rid="bib18">Georgopoulos et al., 1986</xref>) or features of the sensory stimuli (<xref ref-type="bibr" rid="bib42">Luo et al., 2014</xref>), and connectivity among neurons (<xref ref-type="bibr" rid="bib81">Varshney et al., 2011</xref>). Although having sufficiently detailed experimental observations is absolutely essential, even when analyzed using these sophisticated statistical techniques, detailed information about activation of individual neurons does not always automatically lead to greater understanding of the laws that give rise to the temporal evolution of neuronal activity or the relationship between neuronal activity and the ‘computations’ performed by the brain (<xref ref-type="bibr" rid="bib17">Frégnac, 2017</xref>; <xref ref-type="bibr" rid="bib29">Jonas and Kording, 2017</xref>).</p><p>Most modeling approaches aimed at understanding how the observed neuronal activity unfolds in time proceed in a bottom-up fashion. In simple nervous systems, such as the stomatogastric nervous system (<xref ref-type="bibr" rid="bib24">Hartline, 1979</xref>), feeding central pattern generator in <italic>Aplysia</italic> (<xref ref-type="bibr" rid="bib73">Susswein et al., 2002</xref>), and locomotor circuitry in nematode <italic>Caenorhabditis elegans</italic> (<xref ref-type="bibr" rid="bib34">Kunert et al., 2014</xref>) realistic models built on biophysics of individual neurons and properties of their connections can be constructed. Attempts have been made to model more complex neural networks such as a cortical column at the level of biophysical properties of individual neurons (<xref ref-type="bibr" rid="bib44">Markram, 2006</xref>; <xref ref-type="bibr" rid="bib45">Markram et al., 2015</xref>). Although these modeling approaches can prove successful in some settings, the bottom-up approach is limited in several fundamental ways. Even in the simplest nervous systems biophysically realistic models can rarely be sufficiently constrained by the available experimental measurements (<xref ref-type="bibr" rid="bib66">Selverston, 1980</xref>). Biophysical properties of individual neurons and their connections change dynamically as a function of neuromodulation and neuronal activity (<xref ref-type="bibr" rid="bib3">Bargmann and Marder, 2013</xref>; <xref ref-type="bibr" rid="bib43">Marder, 2012</xref>). Because of many nonlinear interactions among the components of even simple neuronal networks, detailed models are not necessarily conceptually revealing (<xref ref-type="bibr" rid="bib66">Selverston, 1980</xref>) and are computationally costly (<xref ref-type="bibr" rid="bib27">Izhikevich, 2003</xref>; <xref ref-type="bibr" rid="bib44">Markram, 2006</xref>). Finally, bottom-up approaches typically assume that the microscopic parameters measured in a typical experiment such as neuronal connectivity or biophysics of individual neurons and synapses must be tuned to specific values in order to assure proper functioning of the brain. Variations around these values are typically seen as noise. Thus, microscopic parameters are routinely averaged across iterations of the same experiment and across individuals. Yet, biophysically realistic simulations of even simple neuronal networks in crustaceans (<xref ref-type="bibr" rid="bib56">Prinz et al., 2004</xref>) show that the relationship between the microscopic parameters and global behavior of the network is highly degenerate. Many disparate microscopic configurations lead to almost indistinguishable macroscopic behavior. Because of non-linearities, however, averaging microscopic parameters disrupts the global behavior of the system (<xref ref-type="bibr" rid="bib20">Golowasch et al., 2002</xref>). Therefore, in order to adequately constrain a realistic model of a neuronal network, many microscopic parameters need to be simultaneously measured in the same animal (<xref ref-type="bibr" rid="bib20">Golowasch et al., 2002</xref>). Yet, such a detailed model is not guaranteed to be generalizable across individuals. Thus, while on the one hand there is a desire to create sufficiently realistic models, it is likely that ultimately these bottom-up approaches need to be combined with more abstract phenomenological models of neuronal dynamics. Here, we describe a general methodology capable of extracting neuronal dynamics from neuronal imaging in nematode <italic>C. elegans</italic> (<xref ref-type="bibr" rid="bib8">Brennan and Proekt, 2017</xref>). To demonstrate the power of this approach we show that our model is capable of predicting future motor commands on a cycle-by-cycle basis and is valid across multiple individual <italic>C. elegans</italic> despite consistent inter-individual differences in neuronal activation.</p><p>Locomotion of <italic>C. elegans</italic> is one of the very few biological systems where experimental measurements of brain activity and behavior can be performed with sufficient granularity for developing and testing a quantitative model of brain dynamics at a behaviorally relevant scale. All 302 neurons (<xref ref-type="bibr" rid="bib85">White et al., 1986</xref>) in <italic>C. elegans</italic> and all their connections are known (<xref ref-type="bibr" rid="bib28">Izquierdo and Beer, 2013</xref>; <xref ref-type="bibr" rid="bib3">Bargmann and Marder, 2013</xref>; <xref ref-type="bibr" rid="bib81">Varshney et al., 2011</xref>). Simultaneous recordings of the majority of the neurons in the brain (head ganglia) of <italic>C. elegans</italic> have been performed in vivo using calcium imaging (<xref ref-type="bibr" rid="bib32">Kato et al., 2015</xref>; <xref ref-type="bibr" rid="bib51">Nguyen et al., 2016</xref>; <xref ref-type="bibr" rid="bib55">Prevedel et al., 2014</xref>; <xref ref-type="bibr" rid="bib78">Tian et al., 2009</xref>) (<xref ref-type="fig" rid="fig1">Figure 1A</xref>, Materials and methods). The graded activity of most <italic>C. elegans</italic> neurons (see <xref ref-type="bibr" rid="bib41">Liu et al., 2018</xref>, however) make them better suited for calcium imaging compared to vertebrate nervous systems in which the utility of calcium imaging is limited by the slow speed of calcium indicators relative to the temporal precision of spike trains (<xref ref-type="bibr" rid="bib57">Rad et al., 2017</xref>). Biomechanics of locomotion of <italic>C. elegans</italic> are well-described by just a few movement modes (<xref ref-type="bibr" rid="bib70">Stephens et al., 2008</xref>) suggesting that the dynamics of the nervous system that controls locomotion are likely to be simple enough to be inferred from relatively short recordings of neuronal activity. Locomotor behaviors fall into well-characterized individual distinct stereotyped behavioral subtypes (<xref ref-type="bibr" rid="bib32">Kato et al., 2015</xref>; <xref ref-type="bibr" rid="bib37">Li et al., 2014</xref>; <xref ref-type="bibr" rid="bib42">Luo et al., 2014</xref>; <xref ref-type="bibr" rid="bib35">Larsch et al., 2013</xref>) (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). The final fundamental advantage of <italic>C. elegans</italic> as a model organism is that neurons can be individually identified in different genetically identical animals (<xref ref-type="bibr" rid="bib32">Kato et al., 2015</xref>). Thus, <italic>C. elegans</italic> is an ideal model system for the proof of principle that a model of neuronal dynamics can be constructed on the basis of imaging of neuronal activity.</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.46814.003</object-id><label>Figure 1.</label><caption><title>Neuronal activity is consistently different in different individuals.</title><p>(<bold>A</bold>) Calcium signals (<inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) recorded in one animal for ∼15 min by <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref>. Each row represents a single neuron. The top 15 rows (above the red line) correspond to neurons unambiguously identified in all animals (shared neurons). (<bold>B</bold>) Trace of the AVA neuron colored by behavioral state as defined by <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref>. (<bold>C</bold>) Neuronal activity of representative neurons plotted as a function of behavioral phase (Materials and methods) in a single behavior grouped by animal. Colored solid lines show mean activity for each animal. Shaded regions show 95% confidence intervals. Mean and confidence intervals are computed across multiple cycles of the same behavior in each animal. The dashed black line shows the mean across all cycles of the behavior in all animals. The cross-animal mean for ALA and RIML (Dorsal turn) is a good approximation of activity in each animal individually. In contrast, the cross-animal mean of RIML (Backward locomotion) does not represent any individual. Thus, activity of RIML is consistently different among individuals during backward locomotion. (<bold>D</bold>) Probabilities that neuronal activity from different individuals was drawn from the same distribution (Materials and methods) computed for each neuron in each locomotor behavior. Activity of most neurons differs consistently among individuals in at least one locomotor behavior. (<bold>E</bold>) Attempts to decode the onset of backwards locomotion are successful within each animal individually using either all neurons or the 15 shared neurons. This confirms that neuronal activation is stereotyped in each animal. Yet decoding fails across animals. Probability of decoding onset of backwards locomotion in one animal on the basis of neuronal activity averaged across other four animals is indistinguishable from chance. Thus, averaging neuronal activity across individuals disrupts behaviorally relevant information. Box plots show distribution of decoding rates bootstrapped across animals and bi-partitions of the data into training and validation datasets (Materials and methods).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46814.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Projection of calcium imaging data onto Temporal PCs.</title><p>Time derivative of neuronal activity in each animal is projected onto it’s corresponding first two principal components similar to <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref>. The only preprocessing applied to the data was a Gaussian smoothing with sigma of one time step. Colors correspond to the fictive behaviors assigned by <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref>. Note that the projection of each individual reveals clear loops in the dynamics of the nervous system. Kato et al. refer to this projection as Temporal PCA. Note that activity from each animal is projected onto its own coordinate system. Also see <xref ref-type="video" rid="fig1video1">Figure 1—video 1</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-fig1-figsupp1-v1.tif"/></fig><media id="fig1video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-46814-fig1-video1.mp4"><object-id pub-id-type="doi">10.7554/eLife.46814.005</object-id><label>Figure 1—video 1.</label><caption><title>Projection of calcium imaging data onto shared TPCAs.</title><p>The shared set of 15 neurons recorded in each animal is used to construct shared Temporal PCs using the same method as in <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref>. The video shows the data from all animals projected onto the first 3 components of the shared Temporal PCA. To produce these PCs the data from <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> (without z-scoring) was concatenated together and subjected to PCA. This results in 15000 observations, which, accounting for a mean autocorrelation in the data of 150 time steps yields approximately 100 independent observations. Colors correspond to the fictive behaviors assigned by <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref>. The structure apparent in the individual animal Temporal PCA projections has been lost (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p></caption></media></fig-group></sec><sec id="s2" sec-type="results"><title>Results</title><p>Approximately 100 neurons in the head ganglia were recorded simultaneously in each of five animals (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) immobilized in a microfluidic chamber (<xref ref-type="bibr" rid="bib32">Kato et al., 2015</xref>). Our model is built upon this data set. Using imaging of a limited subset of neurons in freely moving <italic>C. elegans</italic>, <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> verify that activation of some individual neurons is closely associated with parameters of locomotion. Thus, neuronal activity in the immobilized animal has been interpreted as motor commands that signal locomotor behaviors. <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> used activation of individual neurons to assign a fictive locomotor behavior to each point in the observed time series of neuronal activation in the immobilized animals. Throughout this work, we used the behavioral states assigned by Kato et al.</p><p>Our objective here is to quantitatively model the sequences of such motor commands. Kato et al. used principal component analysis (PCA) to reveal stereotyped loops in the neuronal activity (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). This methodology allows for analysis of the relationship between neuronal population activity and behavior in each individual <italic>C. elegans</italic> (<xref ref-type="bibr" rid="bib32">Kato et al., 2015</xref>). In contrast, we attempt to develop an analytical method that allows for the quantification and prediction of motor commands across multiple individuals. The first step in making this transition is to find a common set of neurons experimentally identified in all animals. Even in the simple nervous system of <italic>C. elegans</italic> not every neuron can be reliably and uniquely identified. Indeed, only 15 neurons were consistently and unequivocally identified in each individual <italic>C. elegans</italic> (top 15 rows in <xref ref-type="fig" rid="fig1">Figure 1A</xref>). Unfortunately, methods successfully applied by <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> to ∼100 neurons in each individual fail to reveal meaningful structure when applied to the common 15 neuron subset across individuals (<xref ref-type="video" rid="fig1video1">Figure 1—video 1</xref>).</p><p>There are two putative classes of reasons for this failure. First, it is likely that relevant information is lost when the number of neurons is reduced. Information loss is bound to be more significant in complex organisms whose nervous systems contain orders of magnitude more neurons than <italic>C. elegans</italic>. This information loss could be potentially mitigated by developing novel experimental approaches. However, we will show that uniquely identified neurons in <italic>C. elegans</italic> exhibit consistent statistical differences in their patterns of activation across animals. This observation necessitates the development of new analytical techniques capable of extracting global neuronal dynamics on the basis of variable activation of a limited subset of neurons. In what follows we will first demonstrate that our technique allows for the efficient and accurate simulation of <italic>C. elegans</italic> neuronal activity. We will then show that simulations of neuronal dynamics can also be used to predict behavioral switches up to 30 s before they occur in a different experimental cohort of animals. Finally, we will demonstrate that these predictions are possible because global dynamics of the <italic>C. elegans</italic> nervous system are conserved despite consistent differences in activation of individual neurons.</p><sec id="s2-1"><title>Variable activation of identified neurons in <italic>C. elegans</italic></title><p>One plausible explanation of variability in neuronal activity is that a particular neuron is irrelevant for a specific behavior and therefore its activity is not adequately constrained. An example of this type of variability is ALA – a neuron involved in quiescence regulation and mechanosensation (<xref ref-type="bibr" rid="bib80">Van Buskirk and Sternberg, 2007</xref>; <xref ref-type="bibr" rid="bib62">Sanders et al., 2013</xref>; <xref ref-type="bibr" rid="bib25">Hill et al., 2014</xref>; <xref ref-type="bibr" rid="bib49">Nelson et al., 2014</xref>). Since experiments analyzed herein were performed in immobilized worms and no quiescence was observed, as expected, ALA activation is quite variable from one cycle of reversal to the other in each individual animal. Note, however, that there are no statistically significant differences between ALA activity during reversals across different individuals (<italic>p-value ≈ 0.9</italic>, Materials and methods) (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). As a result, neuronal activity averaged across animals at each phase of behavior is representative of neuronal activity observed in each animal individually. In contrast variability of activation of RIML – a command neuron known to activate AVA which, in turn, elicits backwards locomotion (<xref ref-type="bibr" rid="bib22">Guo et al., 2009</xref>) – is paradigmatically distinct. During backwards locomotion, RIML activation differs significantly between animals (p<italic>-</italic>value &lt; 0.001, Materials and methods). These differences are not simply random noise superimposed onto a common activation template. As a result, averaging RIML activity across animals during backward locomotion yields a pattern of activity that does not resemble that observed in any one of the individual <italic>C. elegans</italic>. Yet, during a different behavior – dorsal turn – RIML activation is consistent across individuals (p-value <italic>≈ </italic>0.1), Materials and methods. This makes it unlikely that the observed differences in RIML activation during backwards locomotion are an artifact of neuron misidentification.</p><p>Consistent differences in activity of individual identified neurons between genetically identical animals performing the same behavior are not unique to RIML. To show this, we quantify inter-individual differences in activity of each neuron during each locomotor behavior (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). The p-values in <xref ref-type="fig" rid="fig1">Figure 1D</xref> reflect the probabilities that activation of a particular neuron is consistent among individuals. For most neurons involved in locomotion activity differs from animal to animal during execution of at least one type of locomotor behavior. Many neurons can be consistently activated in one locomotor behavior but be highly inconsistent among individuals in another type of locomotion. Only three neurons were consistent in all behaviors. One of these neurons (ALA) is not known to play a direct role in locomotion beyond quiescence (<xref ref-type="bibr" rid="bib80">Van Buskirk and Sternberg, 2007</xref>; <xref ref-type="bibr" rid="bib62">Sanders et al., 2013</xref>; <xref ref-type="bibr" rid="bib25">Hill et al., 2014</xref>; <xref ref-type="bibr" rid="bib49">Nelson et al., 2014</xref>) not observed in this dataset. Consistent with this observation, ALA did not exhibit any appreciable activation during any locomotor behavior. AVB and RID were the only locomotion-associated (<xref ref-type="bibr" rid="bib85">White et al., 1986</xref>; <xref ref-type="bibr" rid="bib39">Lim et al., 2016</xref>) neurons whose activity failed to exhibit statistically significant differences among individual animals in any locomotor behavior. These inter-individual differences in neuronal activation is the primary reason why principal component analysis performed on neuronal activity in each individual successfully reveals cycles in neuronal dynamics (<xref ref-type="bibr" rid="bib32">Kato et al., 2015</xref>) but attempts at projecting data from all individuals onto a common set of principal components fails to reveal any meaningful structure (<xref ref-type="video" rid="fig1video1">Figure 1—video 1</xref>).</p><p>To further illustrate the consistent differences in neuronal activation among individuals, we attempted to decode the behavioral state on the basis of neuronal activity. Half of all instances of backing behavior were used to compute the average activity of each neuron at the onset of backing behavior. Mutual information between this snapshot of neuronal activity and behavioral state (Materials and methods) was then used as the basis for decoding the other half of backing behaviors either within each animal or across animals. Using this strategy, we reliably decoded the onset of backwards locomotion based on ∼100 neurons recorded in each animal individually (p-value &lt; 0.001 relative to shuffle control, Materials and methods). The ability to decode did not degrade appreciably when just 15 neurons identified in each animal were used (p-value ≈ 0.5 within animal - all neurons vs. within animal - 15 neurons, Materials and methods). This limited subset of neurons (∼1/20th of the entire nervous system), therefore, still contains most of the essential information about initiation of backwards locomotion and confirms that neuronal activation is consistent in each animal. This is not surprising as the 15-neuron subset contains most of the known command neurons that control the direction of locomotion.</p><p>Yet, activity from one animal cannot be used to reliably decode the onset of backing behavior in another animal. When activity from four animals was used to decode the 5th (leave one out) the correct decoding rate was indistinguishable from chance (p-value ≈ 0.3, Materials and methods) (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). Thus, mutual information between neuronal activity and behavioral state is degraded when neuronal activity is averaged among genetically identical individuals during locomotion in a simple environment. This inter-individual variability is the fundamental reason why simple averaging of activation of individual neurons fails to yield a meaningful model of neuronal dynamics. Although there are potentially many different classifiers that could be built to decode the behavioral state on the basis of neuronal activity, a classifier based on mutual information is a parsimonious strategy that succeeds in decoding behavior in each individual. Thus, it is unlikely that our ability to decode the behavioral state on the basis of neuronal activity will be dramatically improved by a different classification strategy.</p><p>Consistent differences in activation of individual neurons do not necessarily imply that global dynamics of the brain are distinct in different individual <italic>C. elegans</italic>. It is possible that distinct activity combinations observed in different individuals give rise to an equivalent behavioral strategy implemented at the level of global brain dynamics. An example of this state dependence of neuronal activity is known in the olfactory system of <italic>C. elegans</italic> (<xref ref-type="bibr" rid="bib21">Gordus et al., 2015</xref>). This degeneracy of neuronal activation complicates analysis of individual microscopic components taken in isolation or averaged across individuals.</p></sec><sec id="s2-2"><title>Underlying neuronal dynamics give rise to neuronal activity</title><p>There is a fundamental distinction between neuronal activity and neuronal dynamics (<xref ref-type="bibr" rid="bib12">Churchland et al., 2012</xref>; <xref ref-type="bibr" rid="bib61">Salinas and Sejnowski, 2001</xref>). Neuronal dynamics are the laws of motion that govern the temporal evolution (flux) of neuronal activity in the space spanned by the relevant variables (phase space). Thus, rather than focusing on individual neurons, the dynamical systems description is focused on identifying the salient variables that make up the phase space and on the laws of motion that act to move the state of the system along a trajectory in phase space. The observed neuronal activity is governed by the biophysics of individual neurons and synapses (<xref ref-type="bibr" rid="bib68">Seung, 1996</xref>; <xref ref-type="bibr" rid="bib4">Beer, 1995</xref>; <xref ref-type="bibr" rid="bib47">Miller and Selverston, 1982</xref>) as well as activity of other neurons not reliably identified in all experiments. These biophysical processes influence neuronal activity and are in turn influenced by it. Yet, these processes cannot be directly inferred from the observed activation of neurons.</p><p>In the appendix, we illustrate a novel method – Asymmetric Diffusion Map Modeling – that allows for the extraction of neuronal dynamics from high-dimensional, noisy and non-linear neuronal activity time series recordings. The final output of this method is a two dimensional approximation of the neuronal dynamics which describes the time evolution of the system as a flux along distinct loops in phase space.</p><p>One fundamental advantage of having an approximation of neuronal dynamics is that neuronal activity in <italic>C. elegans</italic> can be efficiently simulated (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). The validity of the simulated dynamics can then be explicitly tested by comparing these newly simulated traces of neuronal activity to those experimentally observed in <italic>C. elegans</italic>. This simulation is first performed in the phase space. As the system evolves in phase space it traces out neuronal activation (<xref ref-type="fig" rid="fig2">Figure 2A</xref>) (Materials and methods and Appendix). Note, that the simulated neuronal activity does not merely recapitulate experimental observations but rather yields <italic>new</italic> neuronal activity traces. These simulated activity traces are in good qualitative agreement with experimental observations. Both the observed and the simulated traces exhibit abrupt coordinated transitions between levels of activity of multiple neurons. Further note that the correlations in activation across neurons are preserved. Finally, note that the activity of the simulated AVA neuron (<xref ref-type="fig" rid="fig2">Figure 2B</xref>) exhibits bouts of activations interspersed with prolonged periods of inactivity corresponding to backward and forward locomotion respectively. These bouts are in good qualitative agreement with the experimental observations. The first instance of backward locomotion in a bout is distinct from subsequent instances. It is associated with stronger activation of the AVA neuron (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Remarkably, transient activation is also a salient feature of the simulated AVA during the first instance of backing behavior in a bout (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Because there is an element of stochasticity in the neuronal dynamics, the total number of instances and durations of locomotor behaviors are variable both in the experimentally observed and simulated neurons. To quantitatively compare the simulated and observed neuronal activation, we computed the spectra of each of the 15 neurons identified across all individuals to the spectra of simulated neurons (Materials and methods). With the exception of the very low frequencies (&lt;0.05 Hz) most strongly affected by the finite dataset effects, the spectra of all simulated neurons are statistically indistinguishable from experimentally observed neuronal activity (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.46814.006</object-id><label>Figure 2.</label><caption><title>Simulations of the dynamics faithfully reproduce neuronal activity and behavioral statistics.</title><p>(<bold>A</bold>) Experimentally observed (top) and simulated (bottom) activity of 15 shared neurons plotted as in <xref ref-type="fig" rid="fig1">Figure 1A</xref>. (<bold>B</bold>) Trace of the simulated AVA neuron colored according to the inferred behavioral state. In contrast to <xref ref-type="fig" rid="fig1">Figure 1</xref>, color here expresses neuronal activity as <italic>z-score</italic> computed for each neuron individually. Behavioral states are assigned based on experimentally observed distribution of behaviors for each point in phase space (blue <inline-formula><mml:math id="inf2"><mml:mo mathvariant="normal">→</mml:mo></mml:math></inline-formula> forward locomotion; green <inline-formula><mml:math id="inf3"><mml:mo mathvariant="normal">→</mml:mo></mml:math></inline-formula> backward locomotion) (Materials and methods). Both A and B are plotted on the same time-axes. Because of under-sampling, transitions between forward and backward locomotions are left unassigned (gray). (<bold>C</bold>) Dwell time distributions for forward locomotion, backward locomotion and backing bouts (blue <inline-formula><mml:math id="inf4"><mml:mo mathvariant="normal">→</mml:mo></mml:math></inline-formula> experimentally observed; orange <inline-formula><mml:math id="inf5"><mml:mo mathvariant="normal">→</mml:mo></mml:math></inline-formula> simulated). Backing bouts were defined as repeated episodes of backing behavior separated by short forward locomotion states lasting at most 30 frames ( 10 s) (e.g. black line in B). Although the manifold is constructed on the basis of transition probabilities between states separated by &lt;1 s., the manifold successfully predicts statistics of behaviors over 100 s.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46814.007</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Neuronal activity trace spectral residues.</title><p>Each line gives the difference in fractional power of the spectrum of the observed neuron and it’s simulated partner. The simulated and observed spectra are in good agreement for all frequencies above 0.05 Hz (where finite data artifacts are most prevalent).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46814.008</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Auto correlations and auto mutual information inform expected delay time scales.</title><p>The auto correlation (<bold>A</bold>) and auto mutual information (<bold>B</bold>) for the experimentally observed neuronal activation in the (<xref ref-type="bibr" rid="bib32">Kato et al., 2015</xref>) dataset (blue boxes), along with the auto correlation and auto mutual information of their derivatives (red boxes) is plotted for time lags up to 100 s. In the article, we used autocorrelations to estimate an appropriate choice of <inline-formula><mml:math id="inf6"><mml:mi>τ</mml:mi></mml:math></inline-formula>. We selected a delay time based on the minimum (across neurons) auto correlation time constant (10 frames, 4 s). Choice of <inline-formula><mml:math id="inf7"><mml:mi>τ</mml:mi></mml:math></inline-formula> is not trivial for a multivariate system. However, the results do not strongly depend on this choice so long as the total delay time is ∼ 50 frames (∼ 18 s) <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-fig2-figsupp2-v1.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46814.009</object-id><label>Figure 2—figure supplement 3.</label><caption><title>Effect of delay embedding parameters on model accuracy.</title><p>The delay embedding parameters (number of delays and delay length) are varied to test for robustness. Dots represent a unique pair of parameters. For each pair the method is rerun on all 15 neurons from all five animals in the <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> dataset and the accuracy of this new model’s simulated motor command dwell time distributions are compared to the observed distributions. Color represents the relative information compared to the original model. Relative information of 1 means that the model constructed using a particular set of delay lengths and number of delays performed as well as the parameter values used in the manuscript (red diamond) (Materials and methods). Note that as long as the total delay length is about 50 time steps the model tends to perform well (about 60% of the original model’s performance).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-fig2-figsupp3-v1.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46814.010</object-id><label>Figure 2—figure supplement 4.</label><caption><title>Model can be constructed on the basis of a single neuron.</title><p>The method is applied to data from a single neuron and used to build the dwell times of motor commands as in <xref ref-type="fig" rid="fig3">Figure 3</xref>. Relative information of 1 means that the model constructed on a single neuron performed the same as the model based on all 15 neurons (Materials and methods). Note that AVAL, AVER and RIML approximate performance obtained when all 15 neurons are used.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-fig2-figsupp4-v1.tif"/></fig></fig-group><p>To determine whether the model of neuronal dynamics reproduces behavioral statistics, we assigned each time point in a simulation a behavioral state. This was accomplished by sampling the empirically derived distribution of behaviors at each point in phase space. The experimentally observed and de novo simulated distributions of dwell times in different behavioral states are in excellent agreement (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Note that the simulations reproduce not just the time scale of individual behaviors (forward and backward locomotion) but also sequences of behaviors that we refer to as backing bouts. This is remarkable because the model of the dynamics was constructed by estimating probability of transition between two states on the time scale of one time step dictated by data acquisition and GCAMP kinetics (∼ 1/3 of a second). Yet, the simulation reproduces the dynamics on the time scale longer than 100 s. Note that PCA previously applied to neuronal activity (<xref ref-type="bibr" rid="bib32">Kato et al., 2015</xref>) does not directly yield a quantitative model that can be used to simulate <italic>new</italic> neuronal activity. Thus, inter-individual variability aside, PCA in and of itself does not yield any quantitative predictions concerning neuronal dynamics.</p></sec><sec id="s2-3"><title>Simulations of neuronal dynamics predict behavioral switches</title><p>Based on the observations of abrupt stereotyped transitions in activity of many neurons (e.g. <xref ref-type="fig" rid="fig1">Figure 1A</xref>) and dwell times of locomotor behaviors, it has been argued that switching between different modes of locomotion in <italic>C. elegans</italic> is stochastic (<xref ref-type="bibr" rid="bib58">Roberts et al., 2016</xref>; <xref ref-type="bibr" rid="bib69">Srivastava et al., 2009</xref>). If so, then timing of behavioral transitions on each individual cycle of behavior should be unpredictable and the entirety of information concerning behavioral switching should be contained in the dwell time distributions.</p><p>Thus, the most compelling test of the neuronal dynamics model is the ability to predict future abrupt changes in neuronal activation that signal switches in locomotor behavior solely on the basis of initial position in phase space. To test this prediction, we make use of a new dataset of calcium imaging in <italic>C. elegans</italic> from <xref ref-type="bibr" rid="bib52">Nichols et al. (2017)</xref> (Materials and methods). We restricted our analysis to the prelethargus N2 animals (n = 11) that were subjected to similar experimental conditions and imaging to those from <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> dataset. Critically, no data from the Nichols et al. dataset was used for the construction of the model. Animals in the dataset (<xref ref-type="bibr" rid="bib52">Nichols et al., 2017</xref>) shared between 8 and 13 neurons with the neurons recorded by <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> on the basis of which the neuronal dynamics model was constructed (Materials and methods).</p><p>Simulations started from several initial positions (phase bins) associated with backwards locomotion were used to estimate the expected distribution of times to the start of forward locomotion (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, orange) for each phase bin. To compare these predictions to the experimental observations, we identify all points in the validation dataset from Nichols et al. that pass through the same phase bins and note the experimentally observed time until the start of forward locomotion signaled by abrupt change in AVA activity (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, blue). For most phase bins, the expected time of simulated behavioral switch was indistinguishable from experimentally observed switch in motor command. In contrast, the predictions made by the null model based solely on behavioral dwell time distributions deviate significantly from the timing of observed transitions.</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.46814.011</object-id><label>Figure 3.</label><caption><title>Position in the phase space determines the expected time of future behavioral transitions.</title><p>We explore the region of phase space where most instances of motor commands for backward locomotion are terminated and give rise to commands for forward locomotion. (<bold>A</bold>) The distribution of times to start of forward locomotion (orange line → mean, orange shading → 95% confidence intervals) is simulated as a function of starting phase. Observed distribution of times to start of forward locomotion in 11 new animals from Nichols et al. (blue line → mean, blue shading → 95% confidence intervals) are calculated for each phase bin in the same region. For each phase bin we also computed the average time since onset of backward locomotion. We then used this average time and the dwell time distribution of backward locomotion to calculate the expected time of termination of backward locomotion (purple line → mean, purple shading → 95% confidence intervals) (Materials and methods). This null hypothesis is grossly inaccurate. (<bold>B</bold>) Times to start of forward locomotion for both the simulation (orange line → mean, orange shading → 95% confidence intervals, filled circles), and the null model built on dwell times (purple line → mean, purple shading → 95% confidence intervals, empty triangles) are plotted against the time to start of forward locomotion command of the newly observed Nichols et al. animals. Individual points show the average time to start of forward locomotion for each individual phase bin (point color). The simulation (orange) is a good predictor of the newly observed data. In contrast, the null model based on dwell times (purple) consistently underestimates the time until initiation of forward locomotion (p &lt; 0.0001).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46814.012</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Predictions of expected time to switch of behavior are still valid without AVA.</title><p>AVAL and AVAR were removed from the five animals in the Kato et al dataset and the Nichols et al dataset used for model validation. The prediction of the expected time to motor command transition was performed as described in the article. The removal of AVA does not dramatically effect the results of the model. Times to start of forward locomotion command for both the simulation (orange line → mean, orange shading → 95% confidence intervals, filled circles), and the null model built on dwell times (purple line → mean, purple shading → 95% confidence intervals, empty triangles) are plotted against the time to start of forward locomotion command of the newly observed Nichols et al. animals. Individual points show the average time to start of forward locomotion for each individual phase bin (point color). Note that the relative information as defined in <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref> and <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref> is 0.91 for the model without AVA (Materials and methods). This means that losing information from AVA only reduces the model’s performance by ∼10%.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-fig3-figsupp1-v1.tif"/></fig></fig-group><p>To quantify the success of the predictions, we compute the correlation between simulated time to initiation of forward locomotion and that observed by Nichols et al. for each phase bin (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). Consistent with observations in (<xref ref-type="fig" rid="fig3">Figure 3A</xref>) simulation-based predictions (filled circles) were strongly correlated with observed timing of behavioral transitions (correlation coefficient 0.74) (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). In contrast, predictions based solely on the dwell time distributions were less well correlated (p &lt; 0.0001) with experimental observations. Further, note that the dispersion around the best fit line is smaller for the simulation-based than for dwell-time based predictions. Thus, dynamics-based predictions are more precise and accurate than those based on behavioral statistics alone. Because definition of behavioral states relies heavily on observed activity of the AVA neuron, we sought to determine whether including AVA critically affects the results. We removed AVA from the <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> dataset used for model construction and the <xref ref-type="bibr" rid="bib52">Nichols et al. (2017)</xref> dataset used for model validation. Even in the absence of the AVA, manifold predictions correlated strongly with the observed time of behavioral transitions (Slope 0.9; <inline-formula><mml:math id="inf8"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> 0.8) and outperformed predictions based solely on dwell time distribution <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>. Therefore, our modeling approach reveals a strong contribution of deterministic dynamics to abrupt changes in locomotor direction in <italic>C. elegans</italic>. These predictions do not depend strongly on activity of AVA–the command neuron for backward locomotion. It should be noted, however, that by construction the Asymmetrical Diffusion Map Method is a stochastic model. Thus, in addition to the deterministic cyclic fluxes, stochastic forces also contribute to the observed neuronal activity. Remarkably, the method reveals that the transition probability between neuronal activity patterns is a function of the macroscopic variables such as phase of the cyclic flux.</p><p>Knowing the initial conditions is sufficient to predict the expected time of transitions between different modes of locomotion 30 s before they are experimentally observed (<xref ref-type="fig" rid="fig3">Figure 3</xref>). Remarkably, these predictions are valid across individuals observed years apart. Therefore, neuronal dynamics model can be applied universally across individuals despite significant inter-individual differences in neuronal activation and undersampling of neuronal activity. Although it is likely that the simulation-based predictions could be improved with addition of more neurons, the fact that the animals in the validation dataset shared as few as eight neurons with the original data suggests that using our methodology one can uncover macroscopic dynamics even when only a small subset of the nervous system can be recorded and unequivocally identified.</p><p>In principle, our methodology (Materials and methods and Appendix) could be used to uncover system dynamics from activity of any single component of a tightly coupled system (<xref ref-type="bibr" rid="bib23">Harnack et al., 2017</xref>). Thus, we attempted to reconstruct dynamics of <italic>C. elegans</italic> nervous system on the basis of activity of a single neuron. We used a single neuron from the <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> for model construction. The quality of predictions was assessed using dwell time statistics (Materials and methods) <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>. The quality of predictions varied substantially between neurons. Models built on some neurons involved in backwards locomotion (e.g. AVAL, AVAR, AVER, and RIML) yielded predictions comparable to those obtained for a set of 15 neurons. In contrast, neurons that play limited role in locomotion such as the ALA were not predictive. Interestingly, although RIML is known to play a role in backward locomotion, its activity varied significantly among individual animals (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) during backwards locomotion. Nevertheless, models based solely on RIML were ∼75% as informative as models built upon the entire 15 neuron set. Thus, at least in the simple nervous system of <italic>C. elegans</italic> a predictive model can be constructed on the basis of a single experimentally observed neuron as long as activation of this neuron is tightly coupled to the network that mediates the observed behaviors.</p></sec><sec id="s2-4"><title>Macroscopic dynamics are conserved among animals</title><p>The ability to simulate neuronal activity, behavioral dwell-time statistics, and even predict timing of individual behavioral transitions implies that trajectories traced by the state of the brain as it evolves in phase space are remarkably conserved among individuals. If the dynamics that give rise to neuronal activity were purely deterministic, then such trajectories would never cross (<xref ref-type="bibr" rid="bib72">Sugihara et al., 2012</xref>; <xref ref-type="bibr" rid="bib71">Strogatz, 2014</xref>). However, any experimental system is bound to have noise due to both measurement error and stochastic processes that affect the trajectories traversed in phase space. Noise inevitably causes trajectories to tangle. Nevertheless, in the limit of low noise (Materials and methods), trajectories will form bundles in phase space. A collection of such trajectory bundles is referred to as the manifold.</p><p>To determine whether the manifolds are conserved among individuals, we applied the manifold reconstruction method (Materials and methods and Appendix) to neuronal activity of <italic>C. elegans</italic>. The manifold in <xref ref-type="fig" rid="fig4">Figure 4A</xref> was constructed on the basis of all 107 neurons recorded in one animal. This illustrates that our methodology is able to reconstruct the global dynamics in the limit of relatively large fraction (∼ 1/3) of all neurons (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) and can be applied to time series consisting of at least 100 neurons. In the <italic>C. elegans</italic> nervous system, the phase space (Materials and methods) is too high dimensional to be shown graphically in its entirety. Nevertheless, trajectories spanned by a broad class of noisy dynamical systems (<xref ref-type="bibr" rid="bib84">Wang et al., 2008</xref>) will form loops – a low-dimensional object in the high-dimensional phase space. Thus, a position of the system can be approximated just by two parameters: the identity of the loop <inline-formula><mml:math id="inf9"><mml:mi>α</mml:mi></mml:math></inline-formula> and the phase along it <inline-formula><mml:math id="inf10"><mml:mi>θ</mml:mi></mml:math></inline-formula>. Identifying these variables from neuronal activity (Materials and methods) allows us to project neuronal activity averaged with respect to <inline-formula><mml:math id="inf11"><mml:mi>θ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf12"><mml:mi>α</mml:mi></mml:math></inline-formula> onto the first three principal components. This coordinate system which we refer to as DPCA plays no role in simulating neuronal dynamics and is used purely for visualization purposes (<xref ref-type="video" rid="fig4video1">Figure 4—video 1</xref>). The width of the manifold represents the density of points or, equivalently, decreases in phase velocity <inline-formula><mml:math id="inf13"><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>. The direction of phase velocity is shown by arrows. For instance, in the region associated with forward locomotion (blue) phase velocity is relatively small. Thus, transit through this region of phase space is dominated by stochastic processes. In contrast, reversal behaviors (red and purple) are associated with high <inline-formula><mml:math id="inf14"><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>. Therefore, duration of reversals has a characteristic time scale dominated by phase velocity. The sequence of behaviors is dictated by the arrangement of different locomotor behaviors along the phase of the manifold. The distribution of locomotor behaviors as a function of position in the manifold is shown by color. The final color of the manifold is a blend of the colors for each behavior according to their prevalence. Note that although behavioral assignments were not used in the construction of the manifold (Materials and methods), most regions of the manifold are associated with just one type of locomotor command. In other words, different locomotor commands are localized to different regions in the phase space. While the two trajectory loops are well separated, the system is quite deterministic. When the two loops pass near each other, conversely, the future state of the system is dominated by stochastic processes.</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.46814.013</object-id><label>Figure 4.</label><caption><title>Manifolds are invariant across animals.</title><p>(<bold>A</bold>) Manifold constructed for a single animal using all 107 neurons in the recording. Manifold is color coded according to locomotor behavior assigned to each snapshot of neuronal activity by Kato et al. The prevalence of each behavior in each phase bin <inline-formula><mml:math id="inf15"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> is encoded in the opacity of the color for each behavior (colors corresponding to each behavior are shown at bottom of the figure). Black arrows represent the direction of flux <inline-formula><mml:math id="inf16"><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo mathvariant="normal">/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> around the manifold. DPCA1-3 are the first three principle components of the neuronal activity averaged with respect to <inline-formula><mml:math id="inf17"><mml:mi>θ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf18"><mml:mi>α</mml:mi></mml:math></inline-formula>. (<bold>B</bold>) Manifold constructed using the data from all animals using the 15 shared neurons as common basis. Coloring, projection and arrows are the same as in (A). (<bold>C</bold>) The data from one animal (lines) is projected onto the manifold constructed from four other animals (surface). The trajectories of the left out animal are well-approximated by the manifold built entirely on the basis of other animals. Behavioral states of the left out animal align well with the distribution of motor commands along the phase of the manifold. This allows us to decode the motor command reliably on the basis of position in manifold space (<inline-formula><mml:math id="inf19"><mml:mi>θ</mml:mi></mml:math></inline-formula>,<inline-formula><mml:math id="inf20"><mml:mi>α</mml:mi></mml:math></inline-formula>) across animals. The same manifold and data is shown in two different projections in order to emphasize the similarities between manifold and data.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46814.014</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Projection of calcium imaging data onto DPCAs.</title><p>Each animal is projected onto its corresponding first 2 DPCA components after delay embedding using our method from the article. Colors correspond to the fictive behaviors assigned by <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref>. Note that the projection of each individual reveals the same two loops that are present in the combined manifold found in the article (<xref ref-type="fig" rid="fig4">Figure 4</xref>). The loops are illustrated by the transparent black ovals. Thus, our methodology can be used to uncover loops in neuronal dynamics using ∼100 neurons in each animal. Also see (<xref ref-type="video" rid="fig4video1">Figure 4—video 1</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-fig4-figsupp1-v1.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46814.015</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Asymmetric diffusion matrix.</title><p>Asymmetric diffusion matrix constructed for a single animal using diffusion kernel as in <xref ref-type="disp-formula" rid="equ13">Equation 13</xref> and normalized such that each row sums to 1 (i.e. a Markov matrix). This matrix was then exponentiated four times to simulate diffusion after ∼1 s. This square matrix has dimensions of the number of time points by the number of time points. Element (<inline-formula><mml:math id="inf21"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf22"><mml:mi>j</mml:mi></mml:math></inline-formula>) corresponds to the probability that a system found in state <inline-formula><mml:math id="inf23"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> at time 0 will be in state <inline-formula><mml:math id="inf24"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> after 1 s where <inline-formula><mml:math id="inf25"><mml:mi mathvariant="bold">𝐃</mml:mi></mml:math></inline-formula> corresponds to delay embedded neuronal activity. The matrix has two prominent features: patches and diagonal bands. The former correspond to regions in state space where transition probabilities are approximately symmetric and stochastic processes dominate. The latter corresponds to regions where transitions are asymmetric and deterministic flux plays a dominant role.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-fig4-figsupp2-v1.tif"/></fig><media id="fig4video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-46814-fig4-video1.mp4"><object-id pub-id-type="doi">10.7554/eLife.46814.016</object-id><label>Figure 4—video 1.</label><caption><title>Projection of calcium imaging data onto shared DPCAs.</title><p>The shared set of 15 neurons recorded in each animal is used to construct a shared DCPA after delay embedding using our method. The video shows the data from all animals projected onto the first 3 components of the shared DPCA. Colors correspond to the fictive behaviors assigned by <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref>. The manifold discovered in the main text (<xref ref-type="fig" rid="fig4">Figure 4</xref>) is super-imposed on this projection of the data. Note that the assigned behavior of the manifold and the points near a given region of the manifold are in good agreement. Individual behavioral states are segregated to different regions along the manifold. Further, the overall structure of the time series is well described by the same two loops that are found in each individual DPCA projection (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> in contrast to <xref ref-type="video" rid="fig1video1">Figure 1—video 1</xref>).</p></caption></media></fig-group><p>Several lines of evidence converge on the fact that, unlike activity of individual neurons, the phase space (<inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula>) is universal across animals. The manifold in <xref ref-type="fig" rid="fig4">Figure 4B</xref> was constructed on the basis of activity from all five animals using only 15 neurons identified in each animal. In contrast to averaging neuronal activity by applying PCA (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>) reconstruction of neuronal dynamics is possible even when only 15 neurons (∼5%) are consistently identified in each individual. This is especially remarkable given the inter-individual differences in activation of the common neuronal subset. The structure of the manifold constructed on the basis of 15 neurons across individuals is nearly identical to the manifold constructed on the basis of 107 neurons in a single animal (<xref ref-type="fig" rid="fig4">Figure 4A</xref>).</p><p>Position in phase space (<inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula>) preserves behavioral information across animals. As a result, the assigned behavioral state can be correctly decoded 83% of the time solely on the basis of position along the manifold in <xref ref-type="fig" rid="fig4">Figure 4B</xref>. This is the median successful decoding probability computed across across all locations in the manifold binned into 426 bins (total of 15405 predictions in all five animals, <inline-formula><mml:math id="inf28"><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> 19.8, p-value <inline-formula><mml:math id="inf29"><mml:mrow><mml:mn>5.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). Note that because of limited temporal precision with which behavioral states can be experimentally assigned, some uncertainty about the behavioral state is expected especially around the times of behavioral transitions. To further strengthen the argument for universality of the global dynamics, we constructed a manifold based on the data from four out of the five animals in the <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> dataset. We then used the manifold to project the neuronal activity from the fifth animal <italic>not used</italic> for manifold construction onto the manifold space (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Behavioral states of the left out animal align well with the distribution of behavioral states along the manifold. Correct behavioral state assignment in the excluded animal can be decoded 81% of time (median correct decoding probability across all 426 manifold bins and all five animals left out in turn). The difference in the median correct prediction probability based on the all worm manifold and the leave one out manifold (<xref ref-type="fig" rid="fig4">Figure 4C</xref>) is not statistically significant (<inline-formula><mml:math id="inf30"><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> 3.8, p-value 0.44). The probability of obtaining this quality of decoding by chance is <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0014</mml:mn></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf32"><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> 17.7).</p><p>Thus, averaging neuronal activity with respect to its position in phase space, rather than across individual neurons, preserves most of the behavioral information and can be universally applied across individuals even when only ∼5% of neurons are uniquely identified. This conserved shape of the manifold in the phase space is what allows the predictions of timing of switching of motor commands across different animals. Yet, the salient variables that span the phase space are not directly apparent from recordings of individual neurons even when most locomotor control circuitry is recorded in a simple environment.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Here, we developed a method for extracting salient dynamical features from complex, multivariate, nonlinear, and noisy time series. We apply this method to neuronal imaging in <italic>C. elegans</italic> to demonstrate its success in simulating activity of the nervous system and predicting switches between different motor commands. The manifold in <italic>C. elegans</italic> nervous system is composed of two loops. While the system is in either one of the loops, its fate is largely predictable. Yet, in the neighborhood where the loops merge, the behavior cannot be clearly predicted and stochastic forces play a stronger role. This leads us to hypothesize that the region where the two loops merge is a decision point where the nervous system is most susceptible to noise and/or sensory inputs (<xref ref-type="bibr" rid="bib21">Gordus et al., 2015</xref>). The manifold shape is conserved among individuals and initial position in the manifold space is sufficient to predict future switches in motor commands. This suggests that the macroscopic variables such as loop identity and phase along it express behaviorally relevant information.</p><p>Intriguingly, we find that even in genetically identical organisms consistent differences in neuronal activity associated with motor commands are the norm. This striking observation is not without precedent. Hodgkin-Huxley models of conductances measured in individual AB neurons in crustacean stomatogastric ganglion exhibit bursting akin to the biological neuron. However, averaging conductance measurements across AB neurons in different individuals yields models that fail to burst (<xref ref-type="bibr" rid="bib20">Golowasch et al., 2002</xref>). Virtually indistinguishable network activity patterns can arise from distinct biophysical mechanisms (<xref ref-type="bibr" rid="bib56">Prinz et al., 2004</xref>; <xref ref-type="bibr" rid="bib10">Chiel et al., 1999</xref>; <xref ref-type="bibr" rid="bib5">Beer et al., 1999</xref>). This suggests that differences between individual AB neurons (<xref ref-type="bibr" rid="bib19">Goldman et al., 2001</xref>; <xref ref-type="bibr" rid="bib56">Prinz et al., 2004</xref>) or individual <italic>C. elegans</italic> are not simply random deviations from a common template that can be averaged away at the microscopic level. This nontrivial inter-subject variability is the fundamental difficulty impeding the construction of biophysically-realistic models of even simple nervous systems. In order to sufficiently constrain such models many parameters have to be simultaneously measured in each individual. This is not currently possible even in the simplest neuronal networks. Even more troubling is the observation that such detailed models may not be generalizable between highly similar individuals. Therefore, a more abstract phenomenological approach to modeling neuronal dynamics will be helpful for understanding circuit-level function.</p><p>We hypothesize that the nontrivial degeneracy between microscopic biophysical processes and circuit-level dynamics arises because evolutionary selection operates at the macroscopic level of organismal behavior (<xref ref-type="bibr" rid="bib36">Lässig and Valleriani, 2008</xref>) embodied by the global dynamics of the brain. Thus, there is no explicit selective pressure for each individual to produce identical neuronal activation during behavior. Nor is there an explicit pressure for an AB neuron to express a particular number of each of the ion channels on its surface. All that is required is that the overall system gives rise to an adaptive behavioral strategy (<xref ref-type="bibr" rid="bib6">Beer, 2000</xref>). Although undoubtedly there are important constraints imposed by the biomechanics of the animal, the connectome, and other variables, any microscopic solution that gives rise to the appropriate macroscopic dynamics yields the same behavioral strategy. This is equivalent to David Marr’s (<xref ref-type="bibr" rid="bib46">Marr, 1982</xref>; <xref ref-type="bibr" rid="bib17">Frégnac, 2017</xref>) proposal that the biophysical details of neuronal circuits are constrained by the computation implemented by the circuit as a whole, rather than the traditional bottom-up approach (<xref ref-type="bibr" rid="bib44">Markram, 2006</xref>; <xref ref-type="bibr" rid="bib45">Markram et al., 2015</xref>) which assumes the opposite. Thus, one should not necessarily expect a detailed model of the nervous system to be equally valid for different, seemingly identical, individuals.</p><p>Our methodology can be used to construct a model of macroscopic dynamics despite consistent differences in neuronal activation in different individuals. To appreciate the full computational significance of macroscopic dynamics, future work can apply similar methodology to determine how these dynamics are altered by interaction with the environment (<xref ref-type="bibr" rid="bib13">Clark, 1998</xref>; <xref ref-type="bibr" rid="bib6">Beer, 2000</xref>; <xref ref-type="bibr" rid="bib40">Linderman et al., 2019</xref>). The model in this work was constructed on the basis of immobilized animals. Although <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> established some essential similarities between activation of neurons in the immobilized and freely moving <italic>C. elegans</italic>, there are also important differences (<xref ref-type="bibr" rid="bib51">Nguyen et al., 2016</xref>; <xref ref-type="bibr" rid="bib82">Venkatachalam et al., 2016</xref>; <xref ref-type="bibr" rid="bib64">Scholz et al., 2018</xref>). One important difference is that repeated bouts of backing behavior are not observed in the freely moving animal. Yet, neurons associated with backing behavior (e.g. RIM, AVA, AVE, AIB) were consistently activated during backing in freely moving animals and during fictive locomotion in the immobilized worms. The manifold of <italic>C. elegans</italic> dynamics consists of two loops dominated by forward and backward locomotion. The decrease frequency of backward behavior in the freely moving <italic>C. elegans</italic>, therefore, may correspond to the decreased probability of entering the backward locomotion loop rather than a fundamental differences in the shape of the manifold. Decoupling the motor commands from the behavioral output can prolong the duration of backing behaviors as evidenced by prolonged depolarization of RIM in the immobilized state. This could correspond to the decrease in the phase velocity along the corresponding loop of the manifold. <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> show that silencing the AVA – a command neuron for backward locomotion – eliminates backing behaviors in the freely moving animal. Silencing of the AVA slightly attenuated the activation of RIM and AVE but did not affect the phase relationship between activation of RIM and AVE and other neurons. Thus, although it is possible to uncouple the dynamics of the motor command circuitry from the actual execution of behavior, the macroscopic dynamics remain qualitatively similar. Yet, in general, it is very likely that the manifold shape and properties will depend strongly on the interactions with the environment. Thus, behavioral significance of neuronal dynamics could only be clearly established by reconstructing the neuronal dynamics in animals engaged in their natural behaviors. Nevertheless, our methodology for extracting neuronal dynamics should still apply.</p><p>The principal innovation of our methodology is to find loops in non-linear, multivariate and noisy neuronal activity. Oscillations in neuronal activity are well known in nervous systems from leach swimming (<xref ref-type="bibr" rid="bib33">Kristan and Calabrese, 1976</xref>), to stomatogastric ganglia of crustaceans (<xref ref-type="bibr" rid="bib67">Selverston and Moulins, 1985</xref>), to locomotion in primates (<xref ref-type="bibr" rid="bib12">Churchland et al., 2012</xref>) and others. Although oscillations in neuronal activity are expected during rhythmic behaviors, behaviors that are not themselves obviously rhythmic – such as preparation for movement (<xref ref-type="bibr" rid="bib11">Churchland et al., 2010</xref>) or reaching (<xref ref-type="bibr" rid="bib12">Churchland et al., 2012</xref>) – are also associated with rotations in phase space. Thus, we expect that our methodology will be broadly useful for characterizing dynamics in diverse nervous systems.</p><p>Several issues need to be considered before applying this methodology to other organisms. The graded potentials of <italic>C. elegans</italic> neurons can be thought of as similar to fluctuations in the firing rate of vertebrate neurons. Yet, it is not always clear whether timing of individual action potentials conveys meaningful information (<xref ref-type="bibr" rid="bib77">Theunissen and Miller, 1995</xref>). In principle, the methodology could be adapted to utilize spike train distances (<xref ref-type="bibr" rid="bib83">Victor and Purpura, 1997</xref>). However, as the number of dimensions of neuronal activity grows, the notions of local neighborhoods become complicated (<xref ref-type="bibr" rid="bib1">Aggarwal et al., 2001</xref>) and may require modifications to the distance measures. Furthermore, the choice of distance measure and the size of the local neighborhood can effect the coarseness with which neuronal trajectories are combined into the same bundle or split between different bundles of the manifold. Our ability to build a single model that captures the dynamics in different individuals relies on the ability to identify the same neuron in different <italic>C. elegans</italic>. Neuron identification is challenging even in simple systems such as <italic>C elegans</italic> and is generally impossible for complex nervous systems of vertebrates. The fact that the model can be built on a small subset of neurons suggests a possibility that models constructed for different individuals can nevertheless be combined in the manifold space rather than in the space spanned by neuronal activity. In order to accomplish this, future work will need to develop a methodology to robustly compare diffusion maps constructed on the basis of neuronal activity without relying on neuronal identification.</p><p>In <italic>C. elegans</italic>, we are able to successfully build a manifold on the basis of ∼100 neurons. The effective dimensionality of the data, however, is much smaller. Indeed, we are able to construct a manifold on only 15 neurons and still faithfully simulate the dynamics. Furthermore, the animals in the validation dataset shared as few as eight neurons with the manifold. Nevertheless, the predictions based on the manifold were highly accurate. Because nonlinear dynamical systems are best thought of as wholes rather than a collection of individual components (<xref ref-type="bibr" rid="bib23">Harnack et al., 2017</xref>), the phase space of the nervous system can theoretically be extracted from any individual neuron (<xref ref-type="bibr" rid="bib74">Takens, 1981</xref>). Consistent with this notion, we showed that recording of a single neuron can be used to construct a meaningful model. The reconstruction is only possible, however, when the components of the system are tightly coupled. Only some neurons yielded meaningful predictions in <italic>C elegans</italic>. Thus, recordings from more complex nervous systems may have to first be separated into weakly coupled component parts before the dynamics can be adequately modeled. There is clearly still much work to be done before dynamics of arbitrarily complex and noisy neuronal circuits can be reliably modeled. Nonetheless, our success in modeling the global dynamics of <italic>C. elegans</italic> in a simple environment illustrates the potential power of our method and promises a fruitful new approach to analysis of complex nervous systems.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Non-parametric modeling of global dynamics</title><p>Here, we developed a novel method for the extraction of the global dynamics which give rise to observed neuronal activity. We call this method Asymmetric Diffusion Map Modeling. This section will strive to give an overview of the method and a basic intuition as to why it works. A full treatment of the mathematics of the method can be found below. First we will define several distinct representations of the data which the method utilizes. Then, we will discuss how and why the data is transformed from one representation to the next. Activity space contains experimental observations of neuronal activity. A vector in this space represents the instantaneous activation of all individual neurons at a single time point. Each component of this vector represents the instantaneous activity of a single identified neuron. The ultimate goal of the method is to efficiently model the temporal sequences of neuronal activation. To do this, we first need to extract relevant variables sufficient to fully describe the dynamics which give rise to neuronal activity. This collection of variables is known as the phase space. In phase space each dimension represents a unique relevant variable. In contrast to neuronal activity, these variables may not necessarily be directly observed. We will approximate the time evolution of the system in phase space by constructing a transition probability matrix. Each element <inline-formula><mml:math id="inf33"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of this matrix corresponds to the probability that a system observed at location <inline-formula><mml:math id="inf34"><mml:mi>i</mml:mi></mml:math></inline-formula> in phase space will transition to location <inline-formula><mml:math id="inf35"><mml:mi>j</mml:mi></mml:math></inline-formula> after one time step (see below, <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). This <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> representation, where <inline-formula><mml:math id="inf37"><mml:mi>n</mml:mi></mml:math></inline-formula> is the number of observations, gives an approximation of the velocity of the system at each observed point in phase space. Finally, we will simplify this table of velocities to extract manifold space – allowing for a minimal representation of the dynamics. Temporal evolution of the system in the manifold space can then be readily simulated to yield quantitative predictions about future neuronal activity.</p></sec><sec id="s4-2"><title>From activity space to phase space</title><p>The global dynamics of a nervous system depends on biophysical processes beyond neuronal firing. It is experimentally intractable to record all such processes including time and voltage dependent currents, neurotransmitter and neuromodulator release, hormonal signaling, plasticity, etc. However, the key variables that make up phase space can be extracted from the observations using methods known as delay embedding (<xref ref-type="bibr" rid="bib74">Takens, 1981</xref>; <xref ref-type="bibr" rid="bib53">Packard et al., 1980</xref>). The main idea behind delay embedding is that one can use the experimental observations (neuronal activation and its time-derivative) to extract independent measurements that together form the phase space. To extract independent measurements from a single time series (e.g. neuronal activity), the delay time <inline-formula><mml:math id="inf38"><mml:mi>τ</mml:mi></mml:math></inline-formula> is chosen such that correlation between two points in the activity space separated by <inline-formula><mml:math id="inf39"><mml:mi>τ</mml:mi></mml:math></inline-formula> is negligible. These delayed versions of the time series correspond to different dimensions of the reconstructed phase space. According to Takens’ theorem (<xref ref-type="bibr" rid="bib74">Takens, 1981</xref>), this reconstructed space preserves essential features of the dynamics which are required for model construction. When phase space is well approximated, points that are close to each other have similar velocities. Consequentially, if two trajectories in the time series data are close in phase space they will continue to evolve in time along similar trajectories – giving rise to recurrent coherent trajectories in the dynamics. The process of delay embedding dramatically inflates the dimensionality of the data making it unusable for complex time series such as activation of many neurons. Thus, the final critical step of the method will reduce the dimensionality of the system.</p></sec><sec id="s4-3"><title>From phase space to transition probability matrix</title><p> The goal of this step will be to enumerate the phase space dynamics into a discrete transition probability matrix <inline-formula><mml:math id="inf40"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula>. The <inline-formula><mml:math id="inf41"><mml:msup><mml:mi>i</mml:mi><mml:mi>𝑡ℎ</mml:mi></mml:msup></mml:math></inline-formula> row of this matrix tabulates the probability that a system starting out in state <inline-formula><mml:math id="inf42"><mml:mi>i</mml:mi></mml:math></inline-formula> will transition in any other state <inline-formula><mml:math id="inf43"><mml:mi>j</mml:mi></mml:math></inline-formula> after one time step. In this case, the state of the system is described by delay embeddings of observed neuronal activity. To assign transition probabilities, we use diffusion mapping (<xref ref-type="bibr" rid="bib48">Nadler et al., 2006</xref>; <xref ref-type="bibr" rid="bib14">Coifman and Lafon, 2006</xref>; <xref ref-type="bibr" rid="bib38">Lian et al., 2015</xref>) – a non-linear dimensionality reduction technique. Similar to local linear embedding (<xref ref-type="bibr" rid="bib59">Roweis and Saul, 2000</xref>) or isomap (<xref ref-type="bibr" rid="bib76">Tenenbaum et al., 2000</xref>), diffusion maps seek to preserve local relationships between nearby points. Points that are close together in phase space will be assigned high transition probabilities. However, points that are far away (<xref ref-type="disp-formula" rid="equ13">Equation 13</xref>) in phase space are not directly connected (i.e. transition probability is zero). After appropriate normalization which ensures that the sum of all probabilities in a row adds up to 1, this diffusion map can be used to simulate the time evolution of the system. To simulate evolution after <inline-formula><mml:math id="inf44"><mml:mi>N</mml:mi></mml:math></inline-formula> time steps <inline-formula><mml:math id="inf45"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> is exponentiated <inline-formula><mml:math id="inf46"><mml:mi>N</mml:mi></mml:math></inline-formula> times. In standard diffusion maps the transition probabilities between points are assumed to be symmetric (i.e. transition probability <inline-formula><mml:math id="inf47"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>→</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>). Yet, this approach does not take into account the fact that neuronal activity is ordered in time. We therefore modify the transition probability calculation to include temporal information. To take temporal information into account, we compute transition probability between the state of the system <inline-formula><mml:math id="inf48"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> at time <inline-formula><mml:math id="inf49"><mml:mi>t</mml:mi></mml:math></inline-formula> and points in the neighborhood of the next experimentally observed state <inline-formula><mml:math id="inf50"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. These transition probabilities are computed as a Gaussian centered at <inline-formula><mml:math id="inf51"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>,<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msubsup><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf52"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> is a point in the local neighborhood of <inline-formula><mml:math id="inf53"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf54"><mml:mrow><mml:mo>∥</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mo>∥</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is the Euclidean distance. <inline-formula><mml:math id="inf55"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is a normalization term that sets the size of the local neighborhood (see below for details). The result is that time evolution of neuronal activity given by asymmetrical <inline-formula><mml:math id="inf56"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> preserves the temporal order of neuronal activity.</p></sec><sec id="s4-4"><title>From transition probability matrix to manifold space</title><p> Although <inline-formula><mml:math id="inf57"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> can be used to simulate neuronal activity, it is not in itself a particularly useful model. <inline-formula><mml:math id="inf58"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> does not directly inform dominant features of neuronal dynamics and simulations of <inline-formula><mml:math id="inf59"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> can only generate reordered versions of the experimentally observed time series. This limitation is due to the fact that <inline-formula><mml:math id="inf60"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> is only defined in terms of the observed states of the system. However, spectral analysis of <inline-formula><mml:math id="inf61"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> can be used to extract salient features of neuronal dynamics (fluxes). Because <inline-formula><mml:math id="inf62"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> is not symmetrical, it can give rise to rotational dynamics. To identify the most salient rotational fluxes, we perform spectral analysis of <inline-formula><mml:math id="inf63"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> (see below). As a result, each point in <inline-formula><mml:math id="inf64"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> is assigned a phase along the rotational flux. To identify the most dynamically salient fluxes, we find the complex eigenvalues of <inline-formula><mml:math id="inf65"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> with the largest modulus. A pair of complex conjugate eigenvectors associated with this eigenvalue relate states of the nervous system <inline-formula><mml:math id="inf66"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> to the phase of the rotational flux. This allows us to bin points with similar phase. Because in <italic>C. elegans</italic> there are multiple rotational fluxes, it is not a priori clear which rotational flux is associated with a given phase. This can be resolved using clustering analysis of <inline-formula><mml:math id="inf67"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> (see below). As a result of eigendecomposition and clustering, each point in <inline-formula><mml:math id="inf68"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> is assigned to a single bin defined by the identity of the flux and the phase along it. We refer to the transition probability matrix simplified in this fashion as the manifold. Simulations of the manifold are sufficient to predict behavioral statistics, sequences of behaviors, timing of individual behavioral transitions, and neuronal activation. Furthermore, simulations in manifold space yield novel neuronal activity patterns not directly observed in the experiment.</p></sec><sec id="s4-5"><title>Origins of cyclic fluxes in neuronal dynamics</title><p>In this section, we will present a theoretical argument (see also) (<xref ref-type="bibr" rid="bib84">Wang et al., 2008</xref>) which suggests that cyclic fluxes are likely to be a common feature of neuronal dynamics. This argument motivates the manifold reconstruction method (see below).</p><p>Neuronal systems are inherently noisy. Thus, the most sensible approach is to model the dynamics of the nervous system using both deterministic dynamics and stochastic processes (<xref ref-type="bibr" rid="bib86">Yan et al., 2013</xref>),<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐅</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf69"><mml:mrow><mml:mi mathvariant="bold">𝐅</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the driving force which quantifies the deterministic aspect of neuronal dynamics, <inline-formula><mml:math id="inf70"><mml:mi mathvariant="bold">𝐗</mml:mi></mml:math></inline-formula> is the position in state space, and <inline-formula><mml:math id="inf71"><mml:mi>ϵ</mml:mi></mml:math></inline-formula> is noise. Because of noise, it is not possible to precisely model the trajectory of any single point starting out at some location in <inline-formula><mml:math id="inf72"><mml:mi mathvariant="bold">𝐗</mml:mi></mml:math></inline-formula>. It is possible, however, to model the temporal evolution of a cloud of points – or more precisely a probability distribution of points – <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib54">Pathria, 1996</xref>). We begin with the law of probability conservation,<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>∇</mml:mo><mml:mo>⁡</mml:mo><mml:mi mathvariant="bold">𝐉</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which states that the change in probability <inline-formula><mml:math id="inf74"><mml:mi>P</mml:mi></mml:math></inline-formula> is due to the local flux, <inline-formula><mml:math id="inf75"><mml:mrow><mml:mi mathvariant="bold">𝐉</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, in that region. In systems with homogeneous (constant in space) noise, the flux is defined by:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐉</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐅</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf76"><mml:mrow><mml:mi mathvariant="bold">𝐅</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the driving force. We now assume that the system is at steady state during the time course of the experiment. Mathematically, this corresponds to the assumption that probability distribution is constant. Thus,<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mrow><mml:mi mathvariant="bold">J</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>From a neuroscience standpoint, this statement corresponds to the assumption that the nervous system is not changing (e.g. learning) during the experiment. This is a reasonable assumption for the datasets in this manuscript which last ∼15 min per recording. Over long-term recordings, this assumption can be invoked in a piecewise fashion over shorter time intervals.</p><p>One well-known solution to <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> is a purely stochastic case where the deterministic flux of the system vanishes at all <inline-formula><mml:math id="inf77"><mml:mi mathvariant="bold">𝐗</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf78"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐉</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. In this case, the only meaningful measure of neuronal activity is the probability of different activity patterns. This assumption is invoked in stochastic models of neuronal activity such as maximum entropy models (<xref ref-type="bibr" rid="bib79">Tkačik et al., 2013</xref>; <xref ref-type="bibr" rid="bib75">Tang et al., 2008</xref>), Hopfield networks (<xref ref-type="bibr" rid="bib26">Hopfield, 1982</xref>), and others.</p><p>Yet, another class of solutions exist when the flux does not vanish at steady state (<xref ref-type="bibr" rid="bib86">Yan et al., 2013</xref>). The key insight is that in order to keep the distribution of states <inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> constant, the flux must be purely cyclic,<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐉</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:mo>×</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf80"><mml:mi>A</mml:mi></mml:math></inline-formula> is an arbitrary vector field. Such fluxes are divergence free, and will always form complete loops. Intuitively, this means that a system that evolves around a cyclical orbit will at once have a deterministic flux <inline-formula><mml:math id="inf81"><mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and satisfy the steady state assumption. For such systems, the driving force is<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐅</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>∇</mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold">𝐉</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf82"><mml:mrow><mml:mi mathvariant="bold">𝐉</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the flux at steady state. Note that <xref ref-type="disp-formula" rid="equ7">Equation 7</xref> is a form of the Fokker-Planck equation. The driving force is made of two distinct terms. The first term corresponds to diffusion, while the second corresponds to a deterministic cyclic flux. The purpose of the manifold reconstruction method is to discover this deterministic cyclic flux in neuronal recordings.</p></sec><sec id="s4-6"><title>Extracting cyclic flux from data</title><p>The ultimate goal of the manifold extraction method is to express neuronal dynamics as a linear stochastic dynamical system. This requires the construction of a transition probability matrix <inline-formula><mml:math id="inf83"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> based on empirical observations of neuronal activity where each element <inline-formula><mml:math id="inf84"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is given by,<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐌</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∥</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf85"><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∥</mml:mo></mml:mrow></mml:math></inline-formula> is the number of times the system transitions from state <inline-formula><mml:math id="inf86"><mml:mi>i</mml:mi></mml:math></inline-formula> to state <inline-formula><mml:math id="inf87"><mml:mi>j</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf88"><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∥</mml:mo></mml:mrow></mml:math></inline-formula> is the total number of times the system is found in state <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> can be used to simulate the time evolution of the system for a single time step by<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐌𝐗</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>or for some arbitrary time <inline-formula><mml:math id="inf90"><mml:mi>t</mml:mi></mml:math></inline-formula><disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold">𝐌</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf91"><mml:msub><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math></inline-formula> is the initial state of the system. Alternatively this equation can be rewritten in terms of the eigenmodes of <inline-formula><mml:math id="inf92"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula>,<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf93"><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are the eigenvalues, <inline-formula><mml:math id="inf94"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are the eigenvectors and <inline-formula><mml:math id="inf95"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the projection of the initial state of the system onto the <inline-formula><mml:math id="inf96"><mml:mi>i</mml:mi></mml:math></inline-formula>-th eigenvector. Under a broad range of conditions, the largest eigenvalue of <inline-formula><mml:math id="inf97"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf98"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. This corresponds to an assertion that such systems come to a single steady state. The associated eigenvector corresponds to the steady state distribution of the system. If <inline-formula><mml:math id="inf99"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> is symmetrical, that is <inline-formula><mml:math id="inf100"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐌</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐌</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, then all eigenvalues of <inline-formula><mml:math id="inf101"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> are real, and the resulting system is purely stochastic. Asymmetry can give rise to complex eigenmodes. Then <xref ref-type="disp-formula" rid="equ11">Equation 11</xref> becomes an equation of a decaying wave in the plane spanned by a pair of complex conjugate eigenvectors. These decaying spirals correspond to the cyclic fluxes of <xref ref-type="disp-formula" rid="equ7">Equation 7</xref>. In the long time limit, all eigenmodes with complex eigenvalues whose modulus is much less than one damp out. Complex modes with eigenvalues near one heavily shape the dynamics of the system even in the long time limit. These eigenmodes are used to identify the cyclic fluxes of neuronal activity.</p><p>In order to construct <inline-formula><mml:math id="inf102"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula>, two steps are required: definition of the state of the system and definition of distances between two points in the state space. The distances between points in state space are used to define transition probabilities. We extract state space from the data using delay embedding (see below), and then use diffusion mapping to define distances between points in the delay embedded coordinates.</p></sec><sec id="s4-7"><title>Delay embedding to uncover true phase space</title><p>There are several algorithms for finding a good delay embedding parameters and number of delays (<xref ref-type="bibr" rid="bib53">Packard et al., 1980</xref>; <xref ref-type="bibr" rid="bib63">Sauer et al., 1991</xref>; <xref ref-type="bibr" rid="bib9">Buzug and Pfister, 1992</xref>). The key point is that maximally independent measurements are chosen. Here, we used autocorrelation as a measure of interdependence to estimate delay <inline-formula><mml:math id="inf103"><mml:mi>τ</mml:mi></mml:math></inline-formula> such that autocorrelation becomes ∼0. For <italic>C. elegans</italic> manifolds, we used <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> frames (∼4 s.). We explored a range of number of delays. The number of delays used to generate the figures is five but the results are fairly robust to changes in this parameter. <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> notice that derivatives of neuronal activity in <italic>C. elegans</italic> are useful for analysis of neuronal dynamics. Building upon their result here, we used the adjoint space formed by the raw neuronal activity and its derivative (akin to position and velocity). At every time <inline-formula><mml:math id="inf105"><mml:mi>t</mml:mi></mml:math></inline-formula>, the position of the system in the raw neuronal activity space <inline-formula><mml:math id="inf106"><mml:msub><mml:mi mathvariant="bold">𝐀</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> can be mapped to the delay embedded space <inline-formula><mml:math id="inf107"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> using the following formula:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mi mathvariant="bold">t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>…</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mi mathvariant="bold">t</mml:mi><mml:mo mathvariant="bold">−</mml:mo><mml:mn mathvariant="bold">5</mml:mn><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mi mathvariant="bold">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>…</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mi mathvariant="bold">t</mml:mi><mml:mo mathvariant="bold">−</mml:mo><mml:mn mathvariant="bold">5</mml:mn><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mrow><mml:mi mathvariant="bold">t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf108"><mml:msub><mml:mi mathvariant="bold">𝐀</mml:mi><mml:mi mathvariant="bold">𝐭</mml:mi></mml:msub></mml:math></inline-formula> is a snapshot of neuronal activity, <inline-formula><mml:math id="inf109"><mml:msubsup><mml:mi mathvariant="bold">𝐀</mml:mi><mml:mi mathvariant="bold">𝐭</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math></inline-formula> is a snapshot of the derivative of neuronal activity, <inline-formula><mml:math id="inf110"><mml:mrow><mml:mo>⟨</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⟩</mml:mo></mml:mrow></mml:math></inline-formula> denotes concatenation of vectors, and <inline-formula><mml:math id="inf111"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi mathvariant="bold">𝐭</mml:mi></mml:msub></mml:math></inline-formula> is the position of the system in the delay embedded coordinates at time <inline-formula><mml:math id="inf112"><mml:mi>t</mml:mi></mml:math></inline-formula>.</p></sec><sec id="s4-8"><title>Diffusion mapping</title><p>As discussed in the manuscript, delay embedded neuronal activity of even simple nervous system of <italic>C. elegans</italic> is too high dimensional to be useful for characterizing system dynamics. For instance for the common 15 neuron dataset <inline-formula><mml:math id="inf113"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is a 180-dimensional vector. Yet, as has been shown by <xref ref-type="bibr" rid="bib14">Coifman and Lafon (2006)</xref>, there is a fundamental connection between the eigenvectors of the Markov chain (<xref ref-type="disp-formula" rid="equ11">Equation 11</xref>) and dimensionality reduction. This connection is the motivation for a class of methods known as diffusion mapping. The basic idea behind diffusion map is to cast distances between two nearby points in state space as transition probabilities (<xref ref-type="bibr" rid="bib48">Nadler et al., 2006</xref>; <xref ref-type="bibr" rid="bib14">Coifman and Lafon, 2006</xref>). Diffusion maps have two fundamental advantages: they are nonlinear and preserve local structures. The former is critical here because neuronal dynamics can be safely assumed to be nonlinear. The latter is important because large distances in complex high-dimensional and nonlinear datasets are meaningless (<xref ref-type="bibr" rid="bib1">Aggarwal et al., 2001</xref>). This local geometry assumption is common to a number of nonlinear dimensionality reduction techniques such as isomap, locally linear embedding, and kernel PCA. Traditional applications of diffusion maps have been in dimensionality reduction. For these purposes, the diffusion map is assumed to be symmetric. Here, we modify the formalism slightly to account for the possibility of cyclic fluxes and therefore allow for the possibility of asymmetry in the transition probabilities <inline-formula><mml:math id="inf114"><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>j</mml:mi><mml:mo>→</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>This asymmetry arises naturally if the diffusion map is constructed such that experimentally observed order of neuronal activation is preserved. We accomplish this simply by centering the kernel of a diffusion map <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> on the next empirically observed data point as follows:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msubsup><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf117"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is the position of the system in the delay embedded coordinates at time <inline-formula><mml:math id="inf118"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf119"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is the next empirically observed state of the system, <inline-formula><mml:math id="inf120"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> is a point in the local neighborhood of <inline-formula><mml:math id="inf121"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf122"><mml:mrow><mml:mo>∥</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mo>∥</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is the Euclidean distance. <inline-formula><mml:math id="inf123"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is a normalization term that sets the size of the local neighborhood. The key mathematical insight is that after appropriate normalization, diffusion maps converge to the Fokker-Planck (<xref ref-type="bibr" rid="bib48">Nadler et al., 2006</xref>) operator. Under these conditions, <xref ref-type="disp-formula" rid="equ9">Equation 9</xref> is an approximation of <xref ref-type="disp-formula" rid="equ7">Equation 7</xref> and thus diffusion maps constitutes a natural way to cast distances between points along a trajectory generated by a stochastic dynamical system. To see this, note that if the local neighborhood is decreased such that it only contains a single point <inline-formula><mml:math id="inf124"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ13">Equation 13</xref> will exactly reproduce the observed neuronal activity in the correct temporal order. In other words the matrix <inline-formula><mml:math id="inf125"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> constructed by applying <xref ref-type="disp-formula" rid="equ13">Equation 13</xref> to all pairs of states will have 1’s for all <inline-formula><mml:math id="inf126"><mml:msub><mml:mi mathvariant="bold">𝐌</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> and zeros elsewhere.</p><p>This matrix, however, is not particularly useful for simulating neuronal dynamics because it will only exactly recapitulate experimental observations. To overcome this limitation, normalization term, <inline-formula><mml:math id="inf127"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>, sets the amount of noise around the experimentally observed neuronal trajectories and allows the simulation to deviate from the actual experimental measurements. Although it is likely that several choices of <inline-formula><mml:math id="inf128"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> will work, here we chose<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf129"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the standard deviation of the data in a 12 time-step temporal window centered at time <inline-formula><mml:math id="inf130"><mml:mi>t</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf131"><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⟩</mml:mo></mml:mrow><mml:mi mathvariant="bold">𝐗𝐘</mml:mi></mml:msub></mml:math></inline-formula> is the mean value of the kernel (<xref ref-type="disp-formula" rid="equ13">Equation 13</xref>) over all data points in the neighborhood of <inline-formula><mml:math id="inf132"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>.</p><p>For <italic>C. elegans,</italic> we compute <inline-formula><mml:math id="inf133"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for the 12 nearest neighbors to each point <inline-formula><mml:math id="inf134"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. The method is robust to the exact number of nearest neighbors used.</p><p><xref ref-type="disp-formula" rid="equ13">Equation 13</xref> was then evaluated for all observed states of <italic>C. elegans</italic> neuronal activity. This results in an <inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> (where <inline-formula><mml:math id="inf136"><mml:mi>n</mml:mi></mml:math></inline-formula> is the number of delay embedded snapshots of neuronal activity) matrix. This matrix is normalized such that the sum along each row is equal to 1. This normalization converts the distance matrix to a right stochastic (Markov) matrix <inline-formula><mml:math id="inf137"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula>. The complex eigenvalue with the largest modulus of <inline-formula><mml:math id="inf138"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> defines the dominant cyclic flux. The projection of the associated pair of complex conjugate eigenvectors onto elements of <inline-formula><mml:math id="inf139"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> define the phase along the cyclic flux <inline-formula><mml:math id="inf140"><mml:mi>θ</mml:mi></mml:math></inline-formula> associated with each delay embedded neuronal activity state.</p></sec><sec id="s4-9"><title>Trajectory clustering</title><p>If there are multiple cyclic fluxes as in <italic>C. elegans</italic> CNS, then in addition to the phase one needs to also know the identify of the flux. To identify fluxes we preform clustering on the data. Any standard clustering algorithm will suffice, and this section will only detail one of many possible choices (<xref ref-type="bibr" rid="bib60">Rubinov and Sporns, 2010</xref>) that can be used. We did not explore the effects of the choice of clustering and suspect that, as is the case with many clustering applications, the best choice will depend on the specifics of the dataset. We use a maximum modularity algorithm (<xref ref-type="bibr" rid="bib50">Newman, 2006</xref>) on the transition probability matrix constructed according to <xref ref-type="disp-formula" rid="equ13">Equation 13</xref>. By construction, the transition probability matrix is sparse (only transitions in local neighborhoods are allowed). Therefore, in its raw form the system given by this matrix will not explore the manifold sufficiently as it will be trapped in each individual isolated neighborhood. To overcome this problem, the matrix is exponentiated N times until a minimum fraction of elements of each row are non-zero (25% in the <italic>C. elegans</italic> data). Conceptually, this corresponds to finding the evolution of the system after <inline-formula><mml:math id="inf141"><mml:mi>N</mml:mi></mml:math></inline-formula> time steps and is closely related to the ‘diffusion distance’ (<xref ref-type="bibr" rid="bib14">Coifman and Lafon, 2006</xref>). Specific choice of <inline-formula><mml:math id="inf142"><mml:mi>N</mml:mi></mml:math></inline-formula> does not have a strong influence on the results, so long as the resultant matrix is not too sparse. Note that the exponentiation of <inline-formula><mml:math id="inf143"><mml:mi mathvariant="bold">𝐌</mml:mi></mml:math></inline-formula> does not change its eigenvalues.</p><p>Two major features are found in the transition probability matrix (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>): patches and diagonals. Square patches identify locations where the system exhibits Brownian motion near a point attractor. In these patches, the matrix is approximately symmetric and therefore stochastic processes dominate. Diagonal traces identify coherent trajectories where deterministic fluxes are dominant.</p><p>The square patches are already suitable for clustering. If two elements of the matrix belong to the same point attractor, they will be found in the same square patch. The situation is slightly more complex for coherent trajectories identified by diagonal bands. To determine whether two elements of state space belong to the same coherent trajectory, we compute the maximum correlation of each row (distances from each element of state space) and time lagged copies all the other rows <inline-formula><mml:math id="inf144"><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Where <inline-formula><mml:math id="inf145"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the <inline-formula><mml:math id="inf146"><mml:mi>i</mml:mi></mml:math></inline-formula>th row, shift moves all elements in the row <inline-formula><mml:math id="inf147"><mml:mi>t</mml:mi></mml:math></inline-formula> steps to the right and the maximum is taken over all <inline-formula><mml:math id="inf148"><mml:mi>t</mml:mi></mml:math></inline-formula>. This newly formed matrix has the same dimensions as the original transition probability matrix. We apply standard maximum modularity clustering using the <inline-formula><mml:math id="inf149"><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">_</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> function from the Brain Connectivity Toolbox to this matrix (<xref ref-type="bibr" rid="bib60">Rubinov and Sporns, 2010</xref>). Clustering assigns flux ID <inline-formula><mml:math id="inf150"><mml:mi>α</mml:mi></mml:math></inline-formula> to each point <inline-formula><mml:math id="inf151"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> in the delay embedded neuronal activity space. Together with the phase <inline-formula><mml:math id="inf152"><mml:mi>θ</mml:mi></mml:math></inline-formula>, assigned by eigenmode decomposition, <inline-formula><mml:math id="inf153"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> span the phase space of neuronal dynamics.</p></sec><sec id="s4-10"><title>Manifold reconstruction</title><p>The phase space spanned by <inline-formula><mml:math id="inf154"><mml:mi>θ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf155"><mml:mi>α</mml:mi></mml:math></inline-formula>, rather than raw neuronal activity provide a proper basis with respect to which neuronal activity can be averaged. These averages are shown as manifolds in <xref ref-type="fig" rid="fig4">Figure 4</xref>. For each <inline-formula><mml:math id="inf156"><mml:mi>α</mml:mi></mml:math></inline-formula>, we sort the delay embedded neuronal activity according to its phase <inline-formula><mml:math id="inf157"><mml:mi>θ</mml:mi></mml:math></inline-formula>. We then convolve this activity with a sliding Gaussian window over <inline-formula><mml:math id="inf158"><mml:mi>θ</mml:mi></mml:math></inline-formula>. The width of the Gaussian smooths neuronal activity but does not play any appreciable role in setting the dynamics over a broad range of values. To visualize these <inline-formula><mml:math id="inf159"><mml:mi>θ</mml:mi></mml:math></inline-formula>-averaged trajectories in <xref ref-type="fig" rid="fig4">Figure 4</xref>, we project them onto the first three principal components.</p><p>Because phase identity <inline-formula><mml:math id="inf160"><mml:mi>α</mml:mi></mml:math></inline-formula> is discrete, <inline-formula><mml:math id="inf161"><mml:mi>θ</mml:mi></mml:math></inline-formula>-averaged trajectories form disjoint bundles. For the purposes of visualization (<xref ref-type="fig" rid="fig4">Figure 4</xref>) these bundles are joined together by interpolating a spline (over both position and direction) from the end of one bundle to the beginning of the next bundle. This interpolation is performed solely for visualization and plays no role in quantitative analyses – which are all done in the manifold space <inline-formula><mml:math id="inf162"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-11"><title>Two neuron toy system</title><p>We make use of a network of two neurons (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>) whose simplified biophysics are modeled by <xref ref-type="bibr" rid="bib16">Ermentrout (1998)</xref>; <xref ref-type="bibr" rid="bib4">Beer (1995)</xref><disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mn>8</mml:mn><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>6</mml:mn><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>0.34</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mrow><mml:mrow><mml:mn>6</mml:mn><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mn>16</mml:mn><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>2.5</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where the noise term, <inline-formula><mml:math id="inf163"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>, is drawn independently from a Gaussian distribution <inline-formula><mml:math id="inf164"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> at each time step. A schematic of the system, along with an illustration of the asymptotic behavior of the dynamics are given in <xref ref-type="fig" rid="app1fig1s1">Appendix 1—figure 1—figure supplement 1</xref>. <xref ref-type="fig" rid="app1fig1s1">Appendix 1—figure 1—figure supplement 1D</xref> shows an example trace used in the construction of the manifold in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>.</p></sec><sec id="s4-12"><title>Calcium imaging</title><p>Here, we analyze Ca2<sup>+</sup> imaging data published by <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> and <xref ref-type="bibr" rid="bib52">Nichols et al. (2017)</xref>. The deviation of fluorescence from baseline (<inline-formula><mml:math id="inf165"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:math></inline-formula>) is considered as a proxy for neuronal activity. The manifold was constructed on the data from <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref>. The validation of the predictions concerning timing of behavioral switching was performed using the dataset from <xref ref-type="bibr" rid="bib52">Nichols et al. (2017)</xref>. The dataset were obtained as MATLAB files and were preprocessed by the Zimmer Lab to account for the effects of bleaching.</p><p><italic>C. elegans</italic> were immobilized in a microfluidic device (<xref ref-type="bibr" rid="bib65">Schrödel et al., 2013</xref>) under environmentally constant conditions. The 107 to 131 neurons detected in each worm in the <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> span all head ganglia, all head motor neurons and most of the sensory neurons and interneurons along with most of the anterior ventral cord motor neurons (<xref ref-type="bibr" rid="bib85">White et al., 1986</xref>). Of the identified neurons for each worm there is a subset of 15 neurons (AIBL, AIBR, ALA, AVAL, AVAR, AVBL, AVER, RID, RIML, RIMR, RMED, RMEL, RMER, VB01, VB02) which were unambiguously identified in each worm. This set of neurons is used to build the manifold.</p><p>We adopt the same behavior states defined by <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref>. The four primary behavioral states are forward locomotion, turns (FALL), reversals (RISE) and backwards locomotion (<xref ref-type="fig" rid="fig1">Figure 1</xref>). FALL and RISE were further split into two distinct motor command states by performing k-means clustering on the RISE and FALL phase timing vectors separately. More details of the experiment can be found in <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref>. All analyses were implemented in MATLAB. In addition to the processing steps by <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> which account for bleaching of the GCaMP proteins, we smooth the (<inline-formula><mml:math id="inf166"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:math></inline-formula>) time series for each neuron with a Gaussian filter (<inline-formula><mml:math id="inf167"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) and convert the filtered time series to z-scores. Note that the amount of smoothing applied is orders of magnitude less than the autocorrelations found in the data (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). Because the experimental data are dominated by forward and backward locomotion, we focus our predictions on just these two behaviors. We do not attempt to predict dorsal or ventral turns or the two types of reversals (1 and 2) defined by Kato et al. because these behaviors occupy a small fraction of the observed time series.</p></sec><sec id="s4-13"><title>Analysis of neuronal activity trajectories</title><p>To compare neuronal activity in different instances of the same type of locomotor behavior, we convert from raw time to ‘behavioral phase’ <inline-formula><mml:math id="inf168"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula> as follows <inline-formula><mml:math id="inf169"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf170"><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the raw time, <inline-formula><mml:math id="inf171"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf172"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the beginning and end times of the behavior respectively. This time warping normalizes <inline-formula><mml:math id="inf173"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula> such that it ranges from 0 to 1 (beginning and end) of each individual instance of behavior. In order to average neuronal activity across different instances of the same behavior, we sample <inline-formula><mml:math id="inf174"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula> in equally spaced 100 intervals. Prior to averaging neuronal activity, constant shift in the <inline-formula><mml:math id="inf175"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:math></inline-formula> signal was subtracted (i.e. the mean of neuronal activity across <inline-formula><mml:math id="inf176"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula> for each individual instance of behavior is zero). Thus, differences in neuronal activity between two different individuals reflect differences in the temporal pattern of activation rather than shifts in the overall level of activity. Neuronal activity normalized in this fashion and averaged across instances of a particular locomotor behavior in each animal is plotted as a function of <inline-formula><mml:math id="inf177"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p><p>Lack of overlap between 95% confidence intervals around the mean neuronal activity observed in different animals in <xref ref-type="fig" rid="fig1">Figure 1</xref> signifies statistically significant differences between neuronal activity in different individual <italic>C. elegans</italic>. To quantify these differences for each neuron and each type of locomotion, we constructed an <inline-formula><mml:math id="inf178"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> matrix <inline-formula><mml:math id="inf179"><mml:mi>T</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf180"><mml:mi>n</mml:mi></mml:math></inline-formula> is the number of instances of behavior (observed in all 5 <italic>C. elegans</italic>) and <inline-formula><mml:math id="inf181"><mml:mi>m</mml:mi></mml:math></inline-formula> is the number of <inline-formula><mml:math id="inf182"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula> bins. Because neuronal activity is smooth, activation in nearby phases is highly correlated. To remove these correlations, <inline-formula><mml:math id="inf183"><mml:mi>T</mml:mi></mml:math></inline-formula> was subjected to principal component analysis (PCA) and projected onto the first principal component (PC1). This results in <inline-formula><mml:math id="inf184"><mml:mi>n</mml:mi></mml:math></inline-formula> scalars (one for each neuronal activity trajectory). This quantity reflects the similarity between projections onto the first principal component (mean neuronal activity trajectory across all animals shown by dashed line in <xref ref-type="fig" rid="fig1">Figure 1</xref>) and each individual cycle of behavior. We subjected this PC1 projection to a one-way ANOVA (with animal ID as the categorical variable). p-values for ANOVA obtained for each combination of locomotor behavior and neuron ID are shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. For statements concerning statistical significance in the text we used (<inline-formula><mml:math id="inf185"><mml:mi>α</mml:mi></mml:math></inline-formula>=0.05) after a Bonferroni correction for multiple comparisons.</p></sec><sec id="s4-14"><title>Decoding behavior on the basis of neuronal activity</title><p>A subset of neuronal activity was chosen as the training set while the remaining neuronal activity were used as a validation set. A template was constructed by averaging activity of each neuron at the onset of each backing behavior in the training set. This template was convolved with neuronal activity in the validation set to yield similarity score between the template and neuronal activity at each time point in the validation dataset. For the decoding in <xref ref-type="fig" rid="fig1">Figure 1</xref>, we chose a threshold of this score such that the overlap between distribution of scores associated with true events (initiation of backing behavior) and distribution of scores of false events (all other behaviors) is minimized (see below). To minimize the effect of noise and compensate for the low probability of true positives, we only considered local maxima of the score. To compensate for the inherent imprecision of assigning behavioral states we considered all peaks found within 10 frames (<inline-formula><mml:math id="inf186"><mml:mrow><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula>) of the initiation of backing behavior as true events.</p><p>The probability of correctly identifying a behavioral event given a specific threshold <inline-formula><mml:math id="inf187"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∣</mml:mo><mml:mi>X</mml:mi><mml:mo>≥</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∥</mml:mo><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∥</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf188"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> are true events, <inline-formula><mml:math id="inf189"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are the scores of true events, <inline-formula><mml:math id="inf190"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are scores of false events, and <inline-formula><mml:math id="inf191"><mml:mrow><mml:mo>∥</mml:mo><mml:mo>⋅</mml:mo><mml:mo>∥</mml:mo></mml:mrow></mml:math></inline-formula> denotes the number of elements in the set. Optimal threshold <inline-formula><mml:math id="inf192"><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is found as argmax of <xref ref-type="disp-formula" rid="equ18">Equation 18</xref> with respect to <inline-formula><mml:math id="inf193"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in each training dataset individually and used to compute correct decoding probability in <xref ref-type="fig" rid="fig1">Figure 1</xref>. For single animal predictions, 1/2 of the backing behaviors in each animal was used as the training dataset while the remaining 1/2 of backing behaviors in the same animal was used as validation. For the cross animal predictions, we used 1/2 of the backing behaviors in four animals to construct a training set and used the 1/2 of the events in the left out animal as the validation dataset. For the shuffled control, we used random time points as true events in the training dataset. To obtain errors around decoding probability in <xref ref-type="fig" rid="fig1">Figure 1</xref>, we bootstrapped this procedure for multiple partitions of the data into training and validation datasets. Box plot in <xref ref-type="fig" rid="fig1">Figure 1</xref> shows the distribution of the decoding probability across all bootstraps.</p></sec><sec id="s4-15"><title>Manifold behavioral statistics</title><p>Manifold space was divided into Gaussian bins each centered at a particular phase <inline-formula><mml:math id="inf194"><mml:mi>θ</mml:mi></mml:math></inline-formula> where <inline-formula><mml:math id="inf195"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>. Total of 426 bins were used for the entire data set. The likelihood that a given point <inline-formula><mml:math id="inf196"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> belongs to each <inline-formula><mml:math id="inf197"><mml:mi>θ</mml:mi></mml:math></inline-formula> bin was computed and <inline-formula><mml:math id="inf198"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> was assigned to the most likely bin. Each point <inline-formula><mml:math id="inf199"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> was assigned a behavioral state by <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref>. Thus, for each <inline-formula><mml:math id="inf200"><mml:mi>θ</mml:mi></mml:math></inline-formula> bin, we attain a distribution of assigned behaviors. This distribution is encoded in color of the manifold (<xref ref-type="fig" rid="fig4">Figure 4</xref>). If <inline-formula><mml:math id="inf201"><mml:mi>θ</mml:mi></mml:math></inline-formula> did not reflect behaviorally relevant information, then the distribution of behavioral states in <inline-formula><mml:math id="inf202"><mml:mi>θ</mml:mi></mml:math></inline-formula> will be the same as in the dataset as a whole. This constitutes the null hypothesis against which manifold-based decoding of behavioral state were tested.</p><p>Similar approach was taken for the ‘leave one out’ manifold prediction. Manifold was constructed as above on the basis of data from four animals from Kato et al. Distribution of behavioral states for each <inline-formula><mml:math id="inf203"><mml:mi>θ</mml:mi></mml:math></inline-formula>-bin was estimated on the basis of only these four animals. Then data from the fifth animal left out of manifold construction was delay embedded as above. Each snapshot of delay embedded activity of the fifth worm was assigned to the nearest <inline-formula><mml:math id="inf204"><mml:mi>θ</mml:mi></mml:math></inline-formula>-bin. In an attempt to decode the behavioral state of the fifth worm, in each <inline-formula><mml:math id="inf205"><mml:mi>θ</mml:mi></mml:math></inline-formula>-bin we compare the behavioral state of the left out animal to the most likely behavioral state in the <inline-formula><mml:math id="inf206"><mml:mi>θ</mml:mi></mml:math></inline-formula>-bin comprised of data from the remaining four animals. The null hypothesis relative to which quality of decoding was compared is that the prevalence of each behavioral state in a given <inline-formula><mml:math id="inf207"><mml:mi>θ</mml:mi></mml:math></inline-formula>-bin is the same as the prevalence of the behavioral state in the whole dataset. This procedure was repeated by leaving out the data from each one of the five worms in the Kato et al. dataset in turn. The distributions of behavioral states from left out animals and the other four animals used to construct the manifold was compared using <inline-formula><mml:math id="inf208"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>χ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow/></mml:mrow></mml:mstyle></mml:math></inline-formula> averaged over all <inline-formula><mml:math id="inf209"><mml:mi>θ</mml:mi></mml:math></inline-formula>-bins and all five left out animals is reported in the manuscript.</p></sec><sec id="s4-16"><title>Manifold behavioral dynamics</title><p>As a result of the manifold construction method (see above), each point in the observed neuronal time series <inline-formula><mml:math id="inf210"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is assigned to a single bin in the manifold space <inline-formula><mml:math id="inf211"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Thus, rather than describing the time series in terms of activation of neurons, we have a 2-D description of the state of the system at each point in time. This allows us to directly estimate transition probability between two states <inline-formula><mml:math id="inf212"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by <xref ref-type="disp-formula" rid="equ8">Equation 8</xref>. The time evolution of the system can now be readily simulated using <xref ref-type="disp-formula" rid="equ9">Equation 9</xref>. This simulation gives rise to a new time series. To map from manifold space back to neuronal activity or behavior, each point in <inline-formula><mml:math id="inf213"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is assigned to a (delay embedded) neuronal activity by reversing the relationship in <xref ref-type="disp-formula" rid="equ12">Equation 12</xref>. Recall that each point in manifold space <inline-formula><mml:math id="inf214"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> corresponds to a cloud of points in the delay embedded space. Here, for the purposes of simulation of neuronal activity we parsimoniously assigned each point in <inline-formula><mml:math id="inf215"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the mean of the delay embedded neuronal activity that was assigned to this bin. Alternatively, a random sample from this distribution of points can be chosen. Behavioral state that is associated with this <italic>newly</italic> simulated neuronal activity snapshot was assigned by sampling the distribution of behavioral states in each phase bin.</p></sec><sec id="s4-17"><title>Dwell time statistics</title><p>Simulated dwell time statistics are calculated by assigning to each time point in the simulation a behavior based on the most prevalent behavior in that time point’s corresponding phase bin. This behavioral time sequence is then smoothed by a median filter with a size of 11 time steps (∼3.5 s.). Turns and reverses are transients and constitute a small fraction of the dataset and are thus highly under sampled. Thus, we restrict our analysis to only forward and backwards locomotion. Backing bouts are periods in which the animal sustains backing locomotion with minimal forward locomotion. These events are defined as periods in which the forward locomotion state fails to last for more than 30 frames (∼10 s). Dwell time distributions are shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>.</p><p>Experimentally observed and simulated dwell time histograms are smoothed using the ksdensity function in MATLAB. <inline-formula><mml:math id="inf216"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> values are calculated from these smoothed histograms.</p></sec><sec id="s4-18"><title>Time to transition analysis</title><p>Each data point <inline-formula><mml:math id="inf217"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi mathvariant="bold">𝐭</mml:mi></mml:msub></mml:math></inline-formula> is characterized by two independent quantities: time since the onset of the behavior <inline-formula><mml:math id="inf218"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and position in manifold space <inline-formula><mml:math id="inf219"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The null hypothesis is the expected time to behavioral transition is based solely the dwell time distribution. This corresponds to finding the survival function given by the right tail of the dwell time distribution from <inline-formula><mml:math id="inf220"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to infinity,<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf221"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability of the transition occurring at time <inline-formula><mml:math id="inf222"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is calculated by averaging the time since the onset of the behavior over all points in a given phase bin <inline-formula><mml:math id="inf223"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. To find the corresponding manifold-based prediction the distribution of times until behavioral switch is explicitly found in the simulated neuronal activity data. We identify all points belonging to a particular phase bin and determine the distribution of times until the behavior is terminated.</p><p>In order to apply the same analysis to the data presented in <xref ref-type="bibr" rid="bib52">Nichols et al. (2017)</xref>, we restricted our analysis to the prelethargus N2 animals (n = 11). These are most genetically similar to the five animals used in the construction of our manifold. First, we selected the subset of neurons that were uniquely identified in each animal from the <xref ref-type="bibr" rid="bib52">Nichols et al. (2017)</xref> dataset and the 15 neurons on the basis of which the manifold was constructed using the Kato et al. data. The number of common neurons varied between 8 and 13. Neuronal activity from Nichols et al. was delay embedded as above yielding a set of <inline-formula><mml:math id="inf224"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>s. Each <inline-formula><mml:math id="inf225"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> from the validation dataset was assigned to the closest phase bin as in the ‘leave one out’ validation. The only exception here is that the distance to the closest phase bin was computed by omitting the neurons that were missing from the animal in the validation dataset. The distribution of times to behavioral transition in the validation dataset was empirically estimated by observing the switching times of all points in the validation dataset assigned to a given phase bin <inline-formula><mml:math id="inf226"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p><p>The <xref ref-type="bibr" rid="bib52">Nichols et al. (2017)</xref> animals use a different behavioral assignment paradigm than those in <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref> and so we normalized the behavioral assignments by assigning forward locomotion to any point in which the z-score of AVAL was below a given threshold and backward locomotion to any point in which the z-score of AVAL was above that threshold. This method does not preserve finer details such as the timing of turns and reversals, and so our predictions do not attempt to address those behaviors.</p></sec><sec id="s4-19"><title>Relative information calculation</title><p>Starting from the motor command dwell time distributions as shown in <xref ref-type="fig" rid="fig2">Figure 2C</xref> we calculate the Kullback–Leibler divergence between the experimentally observed distribution and the simulated distribution. Because the exact binning heavily effects information theoretic quantities such as KL divergence, we scan over a range of bin counts between 40 and 200 and choose the minimum KL divergence in this range. Finally, to normalize these quantities for easy comparison we calculate the ratio between the original total information and the modified model (different numbers of neurons or different parameters) by:<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℬ</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf227"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the KL divergence, <inline-formula><mml:math id="inf228"><mml:mi class="ltx_font_mathcaligraphic">ℬ</mml:mi></mml:math></inline-formula> is the set of three motor command distributions in <xref ref-type="fig" rid="fig2">Figure 2C</xref> (forward locomotion, backwards locomotion and backwards bouts) and <inline-formula><mml:math id="inf229"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf230"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the observed and simulated dwell time distributions respectively.</p></sec><sec id="s4-20"><title>Predictions without AVA</title><p>For the robustness tests in <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref> and <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, the models are built with data from AVA excluded. For the calculation of motor command dwell time distributions, the behaviors are assigned using the same behavioral assignment given by <xref ref-type="bibr" rid="bib32">Kato et al. (2015)</xref>. For the predictions of behavioral switches presented in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, the mapping from neuronal activity space to manifold space does not make use of the data from AVA. However, we can include AVA in the mapping from manifold space back to neuronal activity space to recover the expected activity of AVA even though AVA was not explicitly used at any point in the model construction.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Sarah Friedensen, Adeeti Aggarwal, Guillermo Cecchi, Marcelo Magnasco, Drew Hudson, Tom Joseph, Manuel Zimmer, and Max Kelz for critically reading the manuscript. We also thank Manuel Zimmer and his lab for sharing their recordings of neuronal activity.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Methodology, Writing—original draft</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.46814.017</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-46814-transrepform-v1.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Analysis code is available on github (URL: <ext-link ext-link-type="uri" xlink:href="https://github.com/sharsnik2/AsymmetricDiffusionMapping">https://github.com/sharsnik2/AsymmetricDiffusionMapping</ext-link>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/AsymmetricDiffusionMapping">https://github.com/elifesciences-publications/AsymmetricDiffusionMapping</ext-link>). All data used to construct the model was obtained from Manuel Zimmer's lab. The calcium imaging data used for modeling were described in Kato et al, Cell, 2015 and Nichols et al, Science 2017 and have been made available at <ext-link ext-link-type="uri" xlink:href="https://osf.io/2395t/">https://osf.io/2395t/</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://osf.io/kbf38/">https://osf.io/kbf38/</ext-link> respectively. From Kato et al. we used all datasets in the WT_NoStim.mat file (TS20141221b_THK178_lite-1_punc-31_NLS3_6eggs_1mMTet_basal_1080s, TS20140926d_lite-1_punc-31_NLS3_RIV_2eggs_1mMTet_basal_1080s, TS20140905c_lite-1_punc-31_NLS3_AVHJ_0eggs_1mMTet_basal_1080s, TS20140715f_lite-1_punc-31_NLS3_3eggs_56um_1mMTet_basal_1080s, TS20140715e_lite-1_punc-31_NLS3_2eggs_56um_1mMTet_basal_1080s). From Nichols et al. used all datasets in the n2_prelet.mat file (AN20150508a_ZIM504_46um_1mMTF_O2_s_21_PreLet_1530_, AN20150508b_ZIM504_46um_1mMTF_O2_s_21_PreLet_1530_, AN20150508j_ZIM504_46um_1mMTF_O2_s_21_PreLet_1910_, AN20150902b_ZIM945_1mMTF_O2_21_s_47um_1550_PreLet_, AN20150902d_ZIM945_1mMTF_O2_21_s_47um_1550_PreLet_, AN20150902e_ZIM945_1mMTF_O2_21_s_47um_1810_PreLet_, AN20150902h_ZIM945_1mMTF_O2_21_s_47um_1940_PreLet_, AN20150902i_ZIM945_1mMTF_O2_21_s_47um_1940_PreLet_, AN20160128c_ZIM1048_ilN2ce_NGM1mMTF_2010_PreLet_, AN20160128e_ZIM1048_ilN2ce_NGM1mMTF_2010_PreLet_, AN20160128f_ZIM1048_ilN2ce_NGM1mMTF_2115_PreLet_).</p><p>The following previously published datasets were used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Saul</surname><given-names>Kato</given-names></name><name><surname>Harris</surname><given-names>S. Kaplan</given-names></name><name><surname>Tina</surname><given-names>Schrödel</given-names></name><name><surname>Susanne</surname><given-names>Skora</given-names></name><name><surname>Theodore</surname><given-names>H. Lindsay</given-names></name><name><surname>Eviatar</surname><given-names>Yemini</given-names></name><name><surname>Shawn</surname><given-names>Lockery</given-names></name><name><surname>Manuel</surname><given-names>Zimmer</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>Whole brain imaging data from Kato et al</data-title><source>Open Science Framework</source><pub-id assigning-authority="Open Science Framework" pub-id-type="accession" xlink:href="https://osf.io/2395t/">2395t</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Annika</surname><given-names>LA Nichols</given-names></name><name><surname>Tomáš</surname><given-names>Eichler</given-names></name><name><surname>Richard</surname><given-names>Latham</given-names></name><name><surname>Manuel</surname><given-names>Zimmer</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Whole brain imaging data from Nichols et al.</data-title><source>Open Science Framework</source><pub-id assigning-authority="Open Science Framework" pub-id-type="accession" xlink:href="https://osf.io/kbf38/">kbf38</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Aggarwal</surname> <given-names>CC</given-names></name><name><surname>Hinneburg</surname> <given-names>A</given-names></name><name><surname>Keim</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>On the surprising behavior of distance metrics in high dimensional spaces</article-title><conf-name>ICDT: International Conference on Database Theory</conf-name><fpage>420</fpage><lpage>434</lpage><pub-id pub-id-type="doi">10.1007/3-540-44503-x_27</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahrens</surname> <given-names>MB</given-names></name><name><surname>Orger</surname> <given-names>MB</given-names></name><name><surname>Robson</surname> <given-names>DN</given-names></name><name><surname>Li</surname> <given-names>JM</given-names></name><name><surname>Keller</surname> <given-names>PJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Whole-brain functional imaging at cellular resolution using light-sheet microscopy</article-title><source>Nature Methods</source><volume>10</volume><fpage>413</fpage><lpage>420</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2434</pub-id><pub-id pub-id-type="pmid">23524393</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bargmann</surname> <given-names>CI</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>From the connectome to brain function</article-title><source>Nature Methods</source><volume>10</volume><fpage>483</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2451</pub-id><pub-id pub-id-type="pmid">23866325</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beer</surname> <given-names>RD</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>A dynamical systems perspective on agent-environment interaction</article-title><source>Artificial Intelligence</source><volume>72</volume><fpage>173</fpage><lpage>215</lpage><pub-id pub-id-type="doi">10.1016/0004-3702(94)00005-L</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beer</surname> <given-names>RD</given-names></name><name><surname>Chiel</surname> <given-names>HJ</given-names></name><name><surname>Gallagher</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Evolution and analysis of model CPGs for walking: ii. general principles and individual variability</article-title><source>Journal of Computational Neuroscience</source><volume>7</volume><fpage>119</fpage><lpage>147</lpage><pub-id pub-id-type="pmid">10515251</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beer</surname> <given-names>RD</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Dynamical approaches to cognitive science</article-title><source>Trends in Cognitive Sciences</source><volume>4</volume><fpage>91</fpage><lpage>99</lpage><pub-id pub-id-type="doi">10.1016/S1364-6613(99)01440-0</pub-id><pub-id pub-id-type="pmid">10689343</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berényi</surname> <given-names>A</given-names></name><name><surname>Somogyvári</surname> <given-names>Z</given-names></name><name><surname>Nagy</surname> <given-names>AJ</given-names></name><name><surname>Roux</surname> <given-names>L</given-names></name><name><surname>Long</surname> <given-names>JD</given-names></name><name><surname>Fujisawa</surname> <given-names>S</given-names></name><name><surname>Stark</surname> <given-names>E</given-names></name><name><surname>Leonardo</surname> <given-names>A</given-names></name><name><surname>Harris</surname> <given-names>TD</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Large-scale, high-density (up to 512 channels) recording of local circuits in behaving animals</article-title><source>Journal of Neurophysiology</source><volume>111</volume><fpage>1132</fpage><lpage>1149</lpage><pub-id pub-id-type="doi">10.1152/jn.00785.2013</pub-id><pub-id pub-id-type="pmid">24353300</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Brennan</surname> <given-names>C</given-names></name><name><surname>Proekt</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Universality of macroscopic neuronal dynamics in <italic>Caenorhabditis elegans</italic></article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1711.08533">https://arxiv.org/abs/1711.08533</ext-link></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzug</surname> <given-names>T</given-names></name><name><surname>Pfister</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Comparison of algorithms calculating optimal embedding parameters for delay time coordinates</article-title><source>Physica D: Nonlinear Phenomena</source><volume>58</volume><fpage>127</fpage><lpage>137</lpage><pub-id pub-id-type="doi">10.1016/0167-2789(92)90104-U</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiel</surname> <given-names>HJ</given-names></name><name><surname>Beer</surname> <given-names>RD</given-names></name><name><surname>Gallagher</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Evolution and analysis of model CPGs for walking: I. dynamical modules</article-title><source>Journal of Computational Neuroscience</source><volume>7</volume><fpage>99</fpage><lpage>118</lpage><pub-id pub-id-type="pmid">10515250</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Churchland</surname> <given-names>MM</given-names></name><name><surname>Cunningham</surname> <given-names>JP</given-names></name><name><surname>Kaufman</surname> <given-names>MT</given-names></name><name><surname>Ryu</surname> <given-names>SI</given-names></name><name><surname>Shenoy</surname> <given-names>KV</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Cortical preparatory activity: representation of movement or first cog in a dynamical machine?</article-title><source>Neuron</source><volume>68</volume><fpage>387</fpage><lpage>400</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.09.015</pub-id><pub-id pub-id-type="pmid">21040842</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Churchland</surname> <given-names>MM</given-names></name><name><surname>Cunningham</surname> <given-names>JP</given-names></name><name><surname>Kaufman</surname> <given-names>MT</given-names></name><name><surname>Foster</surname> <given-names>JD</given-names></name><name><surname>Nuyujukian</surname> <given-names>P</given-names></name><name><surname>Ryu</surname> <given-names>SI</given-names></name><name><surname>Shenoy</surname> <given-names>KV</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Neural population dynamics during reaching</article-title><source>Nature</source><volume>487</volume><fpage>51</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1038/nature11129</pub-id><pub-id pub-id-type="pmid">22722855</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Clark</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1998">1998</year><source>Being There: Putting Brain, Body, and World Together Again</source><publisher-name>MIT press</publisher-name></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coifman</surname> <given-names>RR</given-names></name><name><surname>Lafon</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Diffusion maps</article-title><source>Applied and Computational Harmonic Analysis</source><volume>21</volume><fpage>5</fpage><lpage>30</lpage><pub-id pub-id-type="doi">10.1016/j.acha.2006.04.006</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eckmann</surname> <given-names>J-P</given-names></name><name><surname>Kamphorst</surname> <given-names>SO</given-names></name><name><surname>Ruelle</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Recurrence plots of dynamical systems</article-title><source>Europhysics Letters</source><volume>4</volume><fpage>973</fpage><lpage>977</lpage><pub-id pub-id-type="doi">10.1209/0295-5075/4/9/004</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ermentrout</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Neural networks as spatio-temporal pattern-forming systems</article-title><source>Reports on Progress in Physics</source><volume>61</volume><fpage>353</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1088/0034-4885/61/4/002</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frégnac</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Big data and the industrialization of neuroscience: a safe roadmap for understanding the brain?</article-title><source>Science</source><volume>358</volume><fpage>470</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1126/science.aan8866</pub-id><pub-id pub-id-type="pmid">29074766</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Georgopoulos</surname> <given-names>A</given-names></name><name><surname>Schwartz</surname> <given-names>A</given-names></name><name><surname>Kettner</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Neuronal population coding of movement direction</article-title><source>Science</source><volume>233</volume><fpage>1416</fpage><lpage>1419</lpage><pub-id pub-id-type="doi">10.1126/science.3749885</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldman</surname> <given-names>MS</given-names></name><name><surname>Golowasch</surname> <given-names>J</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Global structure, robustness, and modulation of neuronal models</article-title><source>The Journal of Neuroscience</source><volume>21</volume><fpage>5229</fpage><lpage>5238</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.21-14-05229.2001</pub-id><pub-id pub-id-type="pmid">11438598</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golowasch</surname> <given-names>J</given-names></name><name><surname>Goldman</surname> <given-names>MS</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Failure of averaging in the construction of a conductance-based neuron model</article-title><source>Journal of Neurophysiology</source><volume>87</volume><fpage>1129</fpage><lpage>1131</lpage><pub-id pub-id-type="doi">10.1152/jn.00412.2001</pub-id><pub-id pub-id-type="pmid">11826077</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gordus</surname> <given-names>A</given-names></name><name><surname>Pokala</surname> <given-names>N</given-names></name><name><surname>Levy</surname> <given-names>S</given-names></name><name><surname>Flavell</surname> <given-names>SW</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Feedback from network states generates variability in a probabilistic olfactory circuit</article-title><source>Cell</source><volume>161</volume><fpage>215</fpage><lpage>227</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.02.018</pub-id><pub-id pub-id-type="pmid">25772698</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname> <given-names>ZV</given-names></name><name><surname>Hart</surname> <given-names>AC</given-names></name><name><surname>Ramanathan</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Optical interrogation of neural circuits in <italic>Caenorhabditis elegans</italic></article-title><source>Nature Methods</source><volume>6</volume><fpage>891</fpage><lpage>896</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1397</pub-id><pub-id pub-id-type="pmid">19898486</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harnack</surname> <given-names>D</given-names></name><name><surname>Laminski</surname> <given-names>E</given-names></name><name><surname>Schünemann</surname> <given-names>M</given-names></name><name><surname>Pawelzik</surname> <given-names>KR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Topological causality in dynamical systems</article-title><source>Physical Review Letters</source><volume>119</volume><elocation-id>098301</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.119.098301</pub-id><pub-id pub-id-type="pmid">28949567</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartline</surname> <given-names>DK</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Pattern generation in the lobster (Panulirus) stomatogastric ganglion</article-title><source>Biological Cybernetics</source><volume>33</volume><fpage>223</fpage><lpage>236</lpage><pub-id pub-id-type="doi">10.1007/BF00337411</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hill</surname> <given-names>AJ</given-names></name><name><surname>Mansfield</surname> <given-names>R</given-names></name><name><surname>Lopez</surname> <given-names>JM</given-names></name><name><surname>Raizen</surname> <given-names>DM</given-names></name><name><surname>Van Buskirk</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Cellular stress induces a protective sleep-like state in <italic>C. elegans</italic></article-title><source>Current Biology</source><volume>24</volume><fpage>2399</fpage><lpage>2405</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2014.08.040</pub-id><pub-id pub-id-type="pmid">25264259</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hopfield</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Neural networks and physical systems with emergent collective computational abilities</article-title><source>PNAS</source><volume>79</volume><fpage>2554</fpage><lpage>2558</lpage><pub-id pub-id-type="doi">10.1073/pnas.79.8.2554</pub-id><pub-id pub-id-type="pmid">6953413</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izhikevich</surname> <given-names>EM</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Simple model of spiking neurons</article-title><source>IEEE Transactions on Neural Networks</source><volume>14</volume><fpage>1569</fpage><lpage>1572</lpage><pub-id pub-id-type="doi">10.1109/TNN.2003.820440</pub-id><pub-id pub-id-type="pmid">18244602</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izquierdo</surname> <given-names>EJ</given-names></name><name><surname>Beer</surname> <given-names>RD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Connecting a connectome to behavior: an ensemble of neuroanatomical models of <italic>C. elegans</italic> klinotaxis</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1002890</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002890</pub-id><pub-id pub-id-type="pmid">23408877</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jonas</surname> <given-names>E</given-names></name><name><surname>Kording</surname> <given-names>KP</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Could a neuroscientist understand a microprocessor?</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005268</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005268</pub-id><pub-id pub-id-type="pmid">28081141</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jorgenson</surname> <given-names>LA</given-names></name><name><surname>Newsome</surname> <given-names>WT</given-names></name><name><surname>Anderson</surname> <given-names>DJ</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name><name><surname>Brown</surname> <given-names>EN</given-names></name><name><surname>Deisseroth</surname> <given-names>K</given-names></name><name><surname>Donoghue</surname> <given-names>JP</given-names></name><name><surname>Hudson</surname> <given-names>KL</given-names></name><name><surname>Ling</surname> <given-names>GSF</given-names></name><name><surname>MacLeish</surname> <given-names>PR</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name><name><surname>Normann</surname> <given-names>RA</given-names></name><name><surname>Sanes</surname> <given-names>JR</given-names></name><name><surname>Schnitzer</surname> <given-names>MJ</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name><name><surname>Tank</surname> <given-names>DW</given-names></name><name><surname>Tsien</surname> <given-names>RY</given-names></name><name><surname>Ugurbil</surname> <given-names>K</given-names></name><name><surname>Wingfield</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The BRAIN initiative: developing technology to catalyse neuroscience discovery</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>370</volume><elocation-id>20140164</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2014.0164</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kantz</surname> <given-names>H</given-names></name><name><surname>Schreiber</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2004">2004</year><source>Nonlinear Time Series Analysis</source><volume>7</volume><publisher-name>Cambridge university press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9780511755798</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kato</surname> <given-names>S</given-names></name><name><surname>Kaplan</surname> <given-names>HS</given-names></name><name><surname>Schrödel</surname> <given-names>T</given-names></name><name><surname>Skora</surname> <given-names>S</given-names></name><name><surname>Lindsay</surname> <given-names>TH</given-names></name><name><surname>Yemini</surname> <given-names>E</given-names></name><name><surname>Lockery</surname> <given-names>S</given-names></name><name><surname>Zimmer</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Global brain dynamics embed the motor command sequence of <italic>Caenorhabditis elegans</italic></article-title><source>Cell</source><volume>163</volume><fpage>656</fpage><lpage>669</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.09.034</pub-id><pub-id pub-id-type="pmid">26478179</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kristan</surname> <given-names>WB</given-names></name><name><surname>Calabrese</surname> <given-names>RL</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>Rhythmic swimming activity in neurones of the isolated nerve cord of the leech</article-title><source>The Journal of Experimental Biology</source><volume>65</volume><fpage>643</fpage><lpage>668</lpage><pub-id pub-id-type="pmid">1018167</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kunert</surname> <given-names>J</given-names></name><name><surname>Shlizerman</surname> <given-names>E</given-names></name><name><surname>Kutz</surname> <given-names>JN</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Low-dimensional functionality of complex network dynamics: neurosensory integration in the <italic>Caenorhabditis elegans</italic> connectome</article-title><source>Physical Review</source><volume>89</volume><elocation-id>52805</elocation-id><pub-id pub-id-type="doi">10.1103/physreve.89.052805</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larsch</surname> <given-names>J</given-names></name><name><surname>Ventimiglia</surname> <given-names>D</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name><name><surname>Albrecht</surname> <given-names>DR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>High-throughput imaging of neuronal activity in <italic>Caenorhabditis elegans</italic></article-title><source>PNAS</source><volume>110</volume><fpage>E4266</fpage><lpage>E4273</lpage><pub-id pub-id-type="doi">10.1073/pnas.1318325110</pub-id><pub-id pub-id-type="pmid">24145415</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lässig</surname> <given-names>M</given-names></name><name><surname>Valleriani</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><source>Biological Evolution and Statistical Physics</source><volume>585</volume><publisher-name>Springer</publisher-name><pub-id pub-id-type="doi">10.1007/3-540-45692-9</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>Z</given-names></name><name><surname>Liu</surname> <given-names>J</given-names></name><name><surname>Zheng</surname> <given-names>M</given-names></name><name><surname>Xu</surname> <given-names>XZ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Encoding of both analog- and digital-like behavioral outputs by one <italic>C. elegans</italic> interneuron</article-title><source>Cell</source><volume>159</volume><fpage>751</fpage><lpage>765</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2014.09.056</pub-id><pub-id pub-id-type="pmid">25417153</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lian</surname> <given-names>W</given-names></name><name><surname>Talmon</surname> <given-names>R</given-names></name><name><surname>Zaveri</surname> <given-names>H</given-names></name><name><surname>Carin</surname> <given-names>L</given-names></name><name><surname>Coifman</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Multivariate time-series analysis and diffusion maps</article-title><source>Signal Processing</source><volume>116</volume><fpage>13</fpage><lpage>28</lpage><pub-id pub-id-type="doi">10.1016/j.sigpro.2015.04.003</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lim</surname> <given-names>MA</given-names></name><name><surname>Chitturi</surname> <given-names>J</given-names></name><name><surname>Laskova</surname> <given-names>V</given-names></name><name><surname>Meng</surname> <given-names>J</given-names></name><name><surname>Findeis</surname> <given-names>D</given-names></name><name><surname>Wiekenberg</surname> <given-names>A</given-names></name><name><surname>Mulcahy</surname> <given-names>B</given-names></name><name><surname>Luo</surname> <given-names>L</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Lu</surname> <given-names>Y</given-names></name><name><surname>Hung</surname> <given-names>W</given-names></name><name><surname>Qu</surname> <given-names>Y</given-names></name><name><surname>Ho</surname> <given-names>CY</given-names></name><name><surname>Holmyard</surname> <given-names>D</given-names></name><name><surname>Ji</surname> <given-names>N</given-names></name><name><surname>McWhirter</surname> <given-names>R</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name><name><surname>Miller</surname> <given-names>DM</given-names></name><name><surname>Schnabel</surname> <given-names>R</given-names></name><name><surname>Calarco</surname> <given-names>JA</given-names></name><name><surname>Zhen</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Neuroendocrine modulation sustains the <italic>C. elegans</italic> forward motor state</article-title><source>eLife</source><volume>5</volume><elocation-id>e19887</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.19887</pub-id><pub-id pub-id-type="pmid">27855782</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Linderman</surname> <given-names>SW</given-names></name><name><surname>Nichols</surname> <given-names>AL</given-names></name><name><surname>Blei</surname> <given-names>DM</given-names></name><name><surname>Zimmer</surname> <given-names>M</given-names></name><name><surname>Paninski</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Hierarchical recurrent state space models reveal discrete and continuous dynamics of neural activity in <italic>C. elegans</italic></article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/621540</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>Q</given-names></name><name><surname>Kidd</surname> <given-names>PB</given-names></name><name><surname>Dobosiewicz</surname> <given-names>M</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title><italic>C. elegans</italic> AWA Olfactory Neurons Fire Calcium-Mediated All-or-None Action Potentials</article-title><source>Cell</source><volume>175</volume><fpage>57</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.08.018</pub-id><pub-id pub-id-type="pmid">30220455</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname> <given-names>L</given-names></name><name><surname>Wen</surname> <given-names>Q</given-names></name><name><surname>Ren</surname> <given-names>J</given-names></name><name><surname>Hendricks</surname> <given-names>M</given-names></name><name><surname>Gershow</surname> <given-names>M</given-names></name><name><surname>Qin</surname> <given-names>Y</given-names></name><name><surname>Greenwood</surname> <given-names>J</given-names></name><name><surname>Soucy</surname> <given-names>ER</given-names></name><name><surname>Klein</surname> <given-names>M</given-names></name><name><surname>Smith-Parker</surname> <given-names>HK</given-names></name><name><surname>Calvo</surname> <given-names>AC</given-names></name><name><surname>Colón-Ramos</surname> <given-names>DA</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Dynamic encoding of perception, memory, and movement in a <italic>C. elegans</italic> chemotaxis circuit</article-title><source>Neuron</source><volume>82</volume><fpage>1115</fpage><lpage>1128</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.05.010</pub-id><pub-id pub-id-type="pmid">24908490</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Neuromodulation of neuronal circuits: back to the future</article-title><source>Neuron</source><volume>76</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.09.010</pub-id><pub-id pub-id-type="pmid">23040802</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markram</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The blue brain project</article-title><source>Nature Reviews Neuroscience</source><volume>7</volume><fpage>153</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1038/nrn1848</pub-id><pub-id pub-id-type="pmid">16429124</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markram</surname> <given-names>H</given-names></name><name><surname>Muller</surname> <given-names>E</given-names></name><name><surname>Ramaswamy</surname> <given-names>S</given-names></name><name><surname>Reimann</surname> <given-names>MW</given-names></name><name><surname>Abdellah</surname> <given-names>M</given-names></name><name><surname>Sanchez</surname> <given-names>CA</given-names></name><name><surname>Ailamaki</surname> <given-names>A</given-names></name><name><surname>Alonso-Nanclares</surname> <given-names>L</given-names></name><name><surname>Antille</surname> <given-names>N</given-names></name><name><surname>Arsever</surname> <given-names>S</given-names></name><name><surname>Kahou</surname> <given-names>GA</given-names></name><name><surname>Berger</surname> <given-names>TK</given-names></name><name><surname>Bilgili</surname> <given-names>A</given-names></name><name><surname>Buncic</surname> <given-names>N</given-names></name><name><surname>Chalimourda</surname> <given-names>A</given-names></name><name><surname>Chindemi</surname> <given-names>G</given-names></name><name><surname>Courcol</surname> <given-names>JD</given-names></name><name><surname>Delalondre</surname> <given-names>F</given-names></name><name><surname>Delattre</surname> <given-names>V</given-names></name><name><surname>Druckmann</surname> <given-names>S</given-names></name><name><surname>Dumusc</surname> <given-names>R</given-names></name><name><surname>Dynes</surname> <given-names>J</given-names></name><name><surname>Eilemann</surname> <given-names>S</given-names></name><name><surname>Gal</surname> <given-names>E</given-names></name><name><surname>Gevaert</surname> <given-names>ME</given-names></name><name><surname>Ghobril</surname> <given-names>JP</given-names></name><name><surname>Gidon</surname> <given-names>A</given-names></name><name><surname>Graham</surname> <given-names>JW</given-names></name><name><surname>Gupta</surname> <given-names>A</given-names></name><name><surname>Haenel</surname> <given-names>V</given-names></name><name><surname>Hay</surname> <given-names>E</given-names></name><name><surname>Heinis</surname> <given-names>T</given-names></name><name><surname>Hernando</surname> <given-names>JB</given-names></name><name><surname>Hines</surname> <given-names>M</given-names></name><name><surname>Kanari</surname> <given-names>L</given-names></name><name><surname>Keller</surname> <given-names>D</given-names></name><name><surname>Kenyon</surname> <given-names>J</given-names></name><name><surname>Khazen</surname> <given-names>G</given-names></name><name><surname>Kim</surname> <given-names>Y</given-names></name><name><surname>King</surname> <given-names>JG</given-names></name><name><surname>Kisvarday</surname> <given-names>Z</given-names></name><name><surname>Kumbhar</surname> <given-names>P</given-names></name><name><surname>Lasserre</surname> <given-names>S</given-names></name><name><surname>Le Bé</surname> <given-names>JV</given-names></name><name><surname>Magalhães</surname> <given-names>BR</given-names></name><name><surname>Merchán-Pérez</surname> <given-names>A</given-names></name><name><surname>Meystre</surname> <given-names>J</given-names></name><name><surname>Morrice</surname> <given-names>BR</given-names></name><name><surname>Muller</surname> <given-names>J</given-names></name><name><surname>Muñoz-Céspedes</surname> <given-names>A</given-names></name><name><surname>Muralidhar</surname> <given-names>S</given-names></name><name><surname>Muthurasa</surname> <given-names>K</given-names></name><name><surname>Nachbaur</surname> <given-names>D</given-names></name><name><surname>Newton</surname> <given-names>TH</given-names></name><name><surname>Nolte</surname> <given-names>M</given-names></name><name><surname>Ovcharenko</surname> <given-names>A</given-names></name><name><surname>Palacios</surname> <given-names>J</given-names></name><name><surname>Pastor</surname> <given-names>L</given-names></name><name><surname>Perin</surname> <given-names>R</given-names></name><name><surname>Ranjan</surname> <given-names>R</given-names></name><name><surname>Riachi</surname> <given-names>I</given-names></name><name><surname>Rodríguez</surname> <given-names>JR</given-names></name><name><surname>Riquelme</surname> <given-names>JL</given-names></name><name><surname>Rössert</surname> <given-names>C</given-names></name><name><surname>Sfyrakis</surname> <given-names>K</given-names></name><name><surname>Shi</surname> <given-names>Y</given-names></name><name><surname>Shillcock</surname> <given-names>JC</given-names></name><name><surname>Silberberg</surname> <given-names>G</given-names></name><name><surname>Silva</surname> <given-names>R</given-names></name><name><surname>Tauheed</surname> <given-names>F</given-names></name><name><surname>Telefont</surname> <given-names>M</given-names></name><name><surname>Toledo-Rodriguez</surname> <given-names>M</given-names></name><name><surname>Tränkler</surname> <given-names>T</given-names></name><name><surname>Van Geit</surname> <given-names>W</given-names></name><name><surname>Díaz</surname> <given-names>JV</given-names></name><name><surname>Walker</surname> <given-names>R</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Zaninetta</surname> <given-names>SM</given-names></name><name><surname>DeFelipe</surname> <given-names>J</given-names></name><name><surname>Hill</surname> <given-names>SL</given-names></name><name><surname>Segev</surname> <given-names>I</given-names></name><name><surname>Schürmann</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Reconstruction and simulation of neocortical microcircuitry</article-title><source>Cell</source><volume>163</volume><fpage>456</fpage><lpage>492</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.09.029</pub-id><pub-id pub-id-type="pmid">26451489</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Marr</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1982">1982</year><source>Vision: A Computational Investigation Into the Human Representation and Processing of Visual Information</source><publisher-loc>Cambridge, Massachusetts</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname> <given-names>JP</given-names></name><name><surname>Selverston</surname> <given-names>AI</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Mechanisms underlying pattern generation in lobster stomatogastric ganglion as determined by selective inactivation of identified neurons. IV. network properties of pyloric system</article-title><source>Journal of Neurophysiology</source><volume>48</volume><fpage>1416</fpage><lpage>1432</lpage><pub-id pub-id-type="doi">10.1152/jn.1982.48.6.1416</pub-id><pub-id pub-id-type="pmid">7153799</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nadler</surname> <given-names>B</given-names></name><name><surname>Lafon</surname> <given-names>S</given-names></name><name><surname>Coifman</surname> <given-names>RR</given-names></name><name><surname>Kevrekidis</surname> <given-names>IG</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Diffusion maps, spectral clustering and reaction coordinates of dynamical systems</article-title><source>Applied and Computational Harmonic Analysis</source><volume>21</volume><fpage>113</fpage><lpage>127</lpage><pub-id pub-id-type="doi">10.1016/j.acha.2005.07.004</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nelson</surname> <given-names>MD</given-names></name><name><surname>Lee</surname> <given-names>KH</given-names></name><name><surname>Churgin</surname> <given-names>MA</given-names></name><name><surname>Hill</surname> <given-names>AJ</given-names></name><name><surname>Van Buskirk</surname> <given-names>C</given-names></name><name><surname>Fang-Yen</surname> <given-names>C</given-names></name><name><surname>Raizen</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>FMRFamide-like FLP-13 neuropeptides promote quiescence following heat stress in <italic>Caenorhabditis elegans</italic></article-title><source>Current Biology</source><volume>24</volume><fpage>2406</fpage><lpage>2410</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2014.08.037</pub-id><pub-id pub-id-type="pmid">25264253</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newman</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Modularity and community structure in networks</article-title><source>PNAS</source><volume>103</volume><fpage>8577</fpage><lpage>8582</lpage><pub-id pub-id-type="doi">10.1073/pnas.0601602103</pub-id><pub-id pub-id-type="pmid">16723398</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname> <given-names>JP</given-names></name><name><surname>Shipley</surname> <given-names>FB</given-names></name><name><surname>Linder</surname> <given-names>AN</given-names></name><name><surname>Plummer</surname> <given-names>GS</given-names></name><name><surname>Liu</surname> <given-names>M</given-names></name><name><surname>Setru</surname> <given-names>SU</given-names></name><name><surname>Shaevitz</surname> <given-names>JW</given-names></name><name><surname>Leifer</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Whole-brain calcium imaging with cellular resolution in freely behaving <italic>Caenorhabditis elegans</italic></article-title><source>PNAS</source><volume>113</volume><fpage>E1074</fpage><lpage>E1081</lpage><pub-id pub-id-type="doi">10.1073/pnas.1507110112</pub-id><pub-id pub-id-type="pmid">26712014</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nichols</surname> <given-names>ALA</given-names></name><name><surname>Eichler</surname> <given-names>T</given-names></name><name><surname>Latham</surname> <given-names>R</given-names></name><name><surname>Zimmer</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A global brain state underlies <italic>C. elegans</italic> sleep behavior</article-title><source>Science</source><volume>356</volume><elocation-id>eaam6851</elocation-id><pub-id pub-id-type="doi">10.1126/science.aam6851</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Packard</surname> <given-names>NH</given-names></name><name><surname>Crutchfield</surname> <given-names>JP</given-names></name><name><surname>Farmer</surname> <given-names>JD</given-names></name><name><surname>Shaw</surname> <given-names>RS</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>Geometry from a time series</article-title><source>Physical Review Letters</source><volume>45</volume><fpage>712</fpage><lpage>716</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.45.712</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pathria</surname> <given-names>RK</given-names></name></person-group><year iso-8601-date="1996">1996</year><source>Statistical Mechanics</source><publisher-name>Butterworth-Heinemann</publisher-name></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prevedel</surname> <given-names>R</given-names></name><name><surname>Yoon</surname> <given-names>YG</given-names></name><name><surname>Hoffmann</surname> <given-names>M</given-names></name><name><surname>Pak</surname> <given-names>N</given-names></name><name><surname>Wetzstein</surname> <given-names>G</given-names></name><name><surname>Kato</surname> <given-names>S</given-names></name><name><surname>Schrödel</surname> <given-names>T</given-names></name><name><surname>Raskar</surname> <given-names>R</given-names></name><name><surname>Zimmer</surname> <given-names>M</given-names></name><name><surname>Boyden</surname> <given-names>ES</given-names></name><name><surname>Vaziri</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Simultaneous whole-animal 3D imaging of neuronal activity using light-field microscopy</article-title><source>Nature Methods</source><volume>11</volume><fpage>727</fpage><lpage>730</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2964</pub-id><pub-id pub-id-type="pmid">24836920</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prinz</surname> <given-names>AA</given-names></name><name><surname>Bucher</surname> <given-names>D</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Similar network activity from disparate circuit parameters</article-title><source>Nature Neuroscience</source><volume>7</volume><fpage>1345</fpage><lpage>1352</lpage><pub-id pub-id-type="doi">10.1038/nn1352</pub-id><pub-id pub-id-type="pmid">15558066</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rad</surname> <given-names>MS</given-names></name><name><surname>Choi</surname> <given-names>Y</given-names></name><name><surname>Cohen</surname> <given-names>LB</given-names></name><name><surname>Baker</surname> <given-names>BJ</given-names></name><name><surname>Zhong</surname> <given-names>S</given-names></name><name><surname>Storace</surname> <given-names>DA</given-names></name><name><surname>Braubach</surname> <given-names>OR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Voltage and calcium imaging of brain activity</article-title><source>Biophysical Journal</source><volume>113</volume><fpage>P2160</fpage><lpage>P2167</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2017.09.040</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roberts</surname> <given-names>WM</given-names></name><name><surname>Augustine</surname> <given-names>SB</given-names></name><name><surname>Lawton</surname> <given-names>KJ</given-names></name><name><surname>Lindsay</surname> <given-names>TH</given-names></name><name><surname>Thiele</surname> <given-names>TR</given-names></name><name><surname>Izquierdo</surname> <given-names>EJ</given-names></name><name><surname>Faumont</surname> <given-names>S</given-names></name><name><surname>Lindsay</surname> <given-names>RA</given-names></name><name><surname>Britton</surname> <given-names>MC</given-names></name><name><surname>Pokala</surname> <given-names>N</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name><name><surname>Lockery</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A stochastic neuronal model predicts random search behaviors at multiple spatial scales in <italic>C. elegans</italic></article-title><source>eLife</source><volume>5</volume><elocation-id>e12572</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.12572</pub-id><pub-id pub-id-type="pmid">26824391</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roweis</surname> <given-names>ST</given-names></name><name><surname>Saul</surname> <given-names>LK</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Nonlinear dimensionality reduction by locally linear embedding</article-title><source>Science</source><volume>290</volume><fpage>2323</fpage><lpage>2326</lpage><pub-id pub-id-type="doi">10.1126/science.290.5500.2323</pub-id><pub-id pub-id-type="pmid">11125150</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubinov</surname> <given-names>M</given-names></name><name><surname>Sporns</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Complex network measures of brain connectivity: uses and interpretations</article-title><source>NeuroImage</source><volume>52</volume><fpage>1059</fpage><lpage>1069</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2009.10.003</pub-id><pub-id pub-id-type="pmid">19819337</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salinas</surname> <given-names>E</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Correlated neuronal activity and the flow of neural information</article-title><source>Nature Reviews Neuroscience</source><volume>2</volume><fpage>539</fpage><lpage>550</lpage><pub-id pub-id-type="doi">10.1038/35086012</pub-id><pub-id pub-id-type="pmid">11483997</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanders</surname> <given-names>J</given-names></name><name><surname>Nagy</surname> <given-names>S</given-names></name><name><surname>Fetterman</surname> <given-names>G</given-names></name><name><surname>Wright</surname> <given-names>C</given-names></name><name><surname>Treinin</surname> <given-names>M</given-names></name><name><surname>Biron</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The <italic>Caenorhabditis elegans</italic> Interneuron ALA is (also) a high-threshold mechanosensor</article-title><source>BMC Neuroscience</source><volume>14</volume><elocation-id>156</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2202-14-156</pub-id><pub-id pub-id-type="pmid">24341457</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sauer</surname> <given-names>T</given-names></name><name><surname>Yorke</surname> <given-names>JA</given-names></name><name><surname>Casdagli</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Embedology</article-title><source>Journal of Statistical Physics</source><volume>65</volume><fpage>579</fpage><lpage>616</lpage><pub-id pub-id-type="doi">10.1007/BF01053745</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Scholz</surname> <given-names>M</given-names></name><name><surname>Linder</surname> <given-names>AN</given-names></name><name><surname>Randi</surname> <given-names>F</given-names></name><name><surname>Sharma</surname> <given-names>AK</given-names></name><name><surname>Yu</surname> <given-names>X</given-names></name><name><surname>Shaevitz</surname> <given-names>JW</given-names></name><name><surname>Leifer</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Predicting natural behavior from whole-brain neural dynamics</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/445643</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schrödel</surname> <given-names>T</given-names></name><name><surname>Prevedel</surname> <given-names>R</given-names></name><name><surname>Aumayr</surname> <given-names>K</given-names></name><name><surname>Zimmer</surname> <given-names>M</given-names></name><name><surname>Vaziri</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Brain-wide 3D imaging of neuronal activity in <italic>Caenorhabditis elegans</italic> with sculpted light</article-title><source>Nature Methods</source><volume>10</volume><fpage>1013</fpage><lpage>1020</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2637</pub-id><pub-id pub-id-type="pmid">24013820</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Selverston</surname> <given-names>AI</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>Are central pattern generators understandable?</article-title><source>Behavioral and Brain Sciences</source><volume>3</volume><fpage>535</fpage><lpage>540</lpage><pub-id pub-id-type="doi">10.1017/S0140525X00006580</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Selverston</surname> <given-names>AI</given-names></name><name><surname>Moulins</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Oscillatory neural networks</article-title><source>Annual Review of Physiology</source><volume>47</volume><fpage>29</fpage><lpage>48</lpage><pub-id pub-id-type="doi">10.1146/annurev.ph.47.030185.000333</pub-id><pub-id pub-id-type="pmid">2986532</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seung</surname> <given-names>HS</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>How the brain keeps the eyes still</article-title><source>PNAS</source><volume>93</volume><fpage>13339</fpage><lpage>13344</lpage><pub-id pub-id-type="doi">10.1073/pnas.93.23.13339</pub-id><pub-id pub-id-type="pmid">8917592</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srivastava</surname> <given-names>N</given-names></name><name><surname>Clark</surname> <given-names>DA</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Temporal analysis of stochastic turning behavior of swimming <italic>C. elegans</italic></article-title><source>Journal of Neurophysiology</source><volume>102</volume><fpage>1172</fpage><lpage>1179</lpage><pub-id pub-id-type="doi">10.1152/jn.90952.2008</pub-id><pub-id pub-id-type="pmid">19535479</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname> <given-names>GJ</given-names></name><name><surname>Johnson-Kerner</surname> <given-names>B</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>Ryu</surname> <given-names>WS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Dimensionality and dynamics in the behavior of <italic>C. elegans</italic></article-title><source>PLOS Computational Biology</source><volume>4</volume><elocation-id>e1000028</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000028</pub-id><pub-id pub-id-type="pmid">18389066</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Strogatz</surname> <given-names>SH</given-names></name></person-group><year iso-8601-date="2014">2014</year><source>Nonlinear Dynamics and Chaos: With Applications to Physics, Biology, Chemistry, and Engineering</source><publisher-name>Westview Press</publisher-name></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sugihara</surname> <given-names>G</given-names></name><name><surname>May</surname> <given-names>R</given-names></name><name><surname>Ye</surname> <given-names>H</given-names></name><name><surname>Hsieh</surname> <given-names>CH</given-names></name><name><surname>Deyle</surname> <given-names>E</given-names></name><name><surname>Fogarty</surname> <given-names>M</given-names></name><name><surname>Munch</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Detecting causality in complex ecosystems</article-title><source>Science</source><volume>338</volume><fpage>496</fpage><lpage>500</lpage><pub-id pub-id-type="doi">10.1126/science.1227079</pub-id><pub-id pub-id-type="pmid">22997134</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Susswein</surname> <given-names>AJ</given-names></name><name><surname>Hurwitz</surname> <given-names>I</given-names></name><name><surname>Thorne</surname> <given-names>R</given-names></name><name><surname>Byrne</surname> <given-names>JH</given-names></name><name><surname>Baxter</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Mechanisms underlying fictive feeding in <italic>Aplysia</italic>: coupling between a large neuron with plateau potentials activity and a spiking neuron</article-title><source>Journal of Neurophysiology</source><volume>87</volume><fpage>2307</fpage><lpage>2323</lpage><pub-id pub-id-type="doi">10.1152/jn.2002.87.5.2307</pub-id><pub-id pub-id-type="pmid">11976370</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Takens</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="1981">1981</year><chapter-title>Detecting strange attractors in turbulence</chapter-title><person-group person-group-type="editor"><name><surname>Rand</surname> <given-names>D</given-names></name><name><surname>Young</surname> <given-names>L. -S</given-names></name></person-group><source>Dynamical Systems and Turbulence, Warwick 1980</source><volume>898</volume><publisher-loc>Heidelberg</publisher-loc><publisher-name>Springer, Berlin</publisher-name><fpage>366</fpage><lpage>381</lpage><pub-id pub-id-type="doi">10.1007/BFb0091924</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname> <given-names>A</given-names></name><name><surname>Jackson</surname> <given-names>D</given-names></name><name><surname>Hobbs</surname> <given-names>J</given-names></name><name><surname>Chen</surname> <given-names>W</given-names></name><name><surname>Smith</surname> <given-names>JL</given-names></name><name><surname>Patel</surname> <given-names>H</given-names></name><name><surname>Prieto</surname> <given-names>A</given-names></name><name><surname>Petrusca</surname> <given-names>D</given-names></name><name><surname>Grivich</surname> <given-names>MI</given-names></name><name><surname>Sher</surname> <given-names>A</given-names></name><name><surname>Hottowy</surname> <given-names>P</given-names></name><name><surname>Dabrowski</surname> <given-names>W</given-names></name><name><surname>Litke</surname> <given-names>AM</given-names></name><name><surname>Beggs</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A maximum entropy model applied to spatial and temporal correlations from cortical networks in vitro</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>505</fpage><lpage>518</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3359-07.2008</pub-id><pub-id pub-id-type="pmid">18184793</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tenenbaum</surname> <given-names>JB</given-names></name><name><surname>de Silva</surname> <given-names>V</given-names></name><name><surname>Langford</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>A global geometric framework for nonlinear dimensionality reduction</article-title><source>Science</source><volume>290</volume><fpage>2319</fpage><lpage>2323</lpage><pub-id pub-id-type="doi">10.1126/science.290.5500.2319</pub-id><pub-id pub-id-type="pmid">11125149</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Theunissen</surname> <given-names>F</given-names></name><name><surname>Miller</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Temporal encoding in nervous systems: a rigorous definition</article-title><source>Journal of Computational Neuroscience</source><volume>2</volume><fpage>149</fpage><lpage>162</lpage><pub-id pub-id-type="doi">10.1007/BF00961885</pub-id><pub-id pub-id-type="pmid">8521284</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname> <given-names>L</given-names></name><name><surname>Hires</surname> <given-names>SA</given-names></name><name><surname>Mao</surname> <given-names>T</given-names></name><name><surname>Huber</surname> <given-names>D</given-names></name><name><surname>Chiappe</surname> <given-names>ME</given-names></name><name><surname>Chalasani</surname> <given-names>SH</given-names></name><name><surname>Petreanu</surname> <given-names>L</given-names></name><name><surname>Akerboom</surname> <given-names>J</given-names></name><name><surname>McKinney</surname> <given-names>SA</given-names></name><name><surname>Schreiter</surname> <given-names>ER</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name><name><surname>Svoboda</surname> <given-names>K</given-names></name><name><surname>Looger</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Imaging neural activity in worms, flies and mice with improved GCaMP calcium indicators</article-title><source>Nature Methods</source><volume>6</volume><fpage>875</fpage><lpage>881</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1398</pub-id><pub-id pub-id-type="pmid">19898485</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tkačik</surname> <given-names>G</given-names></name><name><surname>Marre</surname> <given-names>O</given-names></name><name><surname>Mora</surname> <given-names>T</given-names></name><name><surname>Amodei</surname> <given-names>D</given-names></name><name><surname>Berry II</surname> <given-names>MJ</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The simplest maximum entropy model for collective behavior in a neural network</article-title><source>Journal of Statistical Mechanics: Theory and Experiment</source><volume>2013</volume><elocation-id>P03011</elocation-id><pub-id pub-id-type="doi">10.1088/1742-5468/2013/03/P03011</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Buskirk</surname> <given-names>C</given-names></name><name><surname>Sternberg</surname> <given-names>PW</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Epidermal growth factor signaling induces behavioral quiescence in <italic>Caenorhabditis elegans</italic></article-title><source>Nature Neuroscience</source><volume>10</volume><fpage>1300</fpage><lpage>1307</lpage><pub-id pub-id-type="doi">10.1038/nn1981</pub-id><pub-id pub-id-type="pmid">17891142</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varshney</surname> <given-names>LR</given-names></name><name><surname>Chen</surname> <given-names>BL</given-names></name><name><surname>Paniagua</surname> <given-names>E</given-names></name><name><surname>Hall</surname> <given-names>DH</given-names></name><name><surname>Chklovskii</surname> <given-names>DB</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Structural properties of the <italic>Caenorhabditis elegans</italic> neuronal network</article-title><source>PLOS Computational Biology</source><volume>7</volume><elocation-id>e1001066</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1001066</pub-id><pub-id pub-id-type="pmid">21304930</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Venkatachalam</surname> <given-names>V</given-names></name><name><surname>Ji</surname> <given-names>N</given-names></name><name><surname>Wang</surname> <given-names>X</given-names></name><name><surname>Clark</surname> <given-names>C</given-names></name><name><surname>Mitchell</surname> <given-names>JK</given-names></name><name><surname>Klein</surname> <given-names>M</given-names></name><name><surname>Tabone</surname> <given-names>CJ</given-names></name><name><surname>Florman</surname> <given-names>J</given-names></name><name><surname>Ji</surname> <given-names>H</given-names></name><name><surname>Greenwood</surname> <given-names>J</given-names></name><name><surname>Chisholm</surname> <given-names>AD</given-names></name><name><surname>Srinivasan</surname> <given-names>J</given-names></name><name><surname>Alkema</surname> <given-names>M</given-names></name><name><surname>Zhen</surname> <given-names>M</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Pan-neuronal imaging in roaming <italic>Caenorhabditis elegans</italic></article-title><source>PNAS</source><volume>113</volume><fpage>E1082</fpage><lpage>E1088</lpage><pub-id pub-id-type="doi">10.1073/pnas.1507109113</pub-id><pub-id pub-id-type="pmid">26711989</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Victor</surname> <given-names>JD</given-names></name><name><surname>Purpura</surname> <given-names>KP</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Metric-space analysis of spike trains: theory, algorithms and application</article-title><source>Network: Computation in Neural Systems</source><volume>8</volume><fpage>127</fpage><lpage>164</lpage><pub-id pub-id-type="doi">10.1088/0954-898X_8_2_003</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Xu</surname> <given-names>L</given-names></name><name><surname>Wang</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Potential landscape and flux framework of nonequilibrium networks: Robustness, dissipation, and coherence of biochemical oscillations</article-title><source>PNAS</source><volume>105</volume><fpage>12271</fpage><lpage>12276</lpage><pub-id pub-id-type="doi">10.1073/pnas.0800579105</pub-id><pub-id pub-id-type="pmid">18719111</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname> <given-names>JG</given-names></name><name><surname>Southgate</surname> <given-names>E</given-names></name><name><surname>Thomson</surname> <given-names>JN</given-names></name><name><surname>Brenner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>The structure of the nervous system of the nematode <italic>Caenorhabditis elegans</italic></article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>314</volume><fpage>1</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1098/rstb.1986.0056</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname> <given-names>H</given-names></name><name><surname>Zhao</surname> <given-names>L</given-names></name><name><surname>Hu</surname> <given-names>L</given-names></name><name><surname>Wang</surname> <given-names>X</given-names></name><name><surname>Wang</surname> <given-names>E</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Nonequilibrium landscape theory of neural networks</article-title><source>PNAS</source><volume>110</volume><fpage>E4185</fpage><lpage>E4194</lpage><pub-id pub-id-type="doi">10.1073/pnas.1310692110</pub-id><pub-id pub-id-type="pmid">24145451</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s8" sec-type="appendix"><title>Extraction of the manifold from neuronal activity</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.46814.018</object-id><p>We illustrate how neuronal dynamics can be extracted from neuronal activity using a simple system that consists of two reciprocally connected neurons <inline-formula><mml:math id="inf231"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf232"><mml:mi>B</mml:mi></mml:math></inline-formula> shown in <xref ref-type="fig" rid="app1fig1s1">Appendix 1—figure 1—figure supplement 1</xref>. The dynamics of the system exhibit two distinct oscillatory cycles <xref ref-type="fig" rid="app1fig1s1">Appendix 1—figure 1—figure supplement 1</xref> (<xref ref-type="bibr" rid="bib16">Ermentrout, 1998</xref>; <xref ref-type="bibr" rid="bib6">Beer, 2000</xref>) The first step in model construction is to find the essential variables that span the space where the dynamics unfold. For the model system, both <inline-formula><mml:math id="inf233"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf234"><mml:mi>B</mml:mi></mml:math></inline-formula> are required. However, even in the simple nervous system of <italic>C. elegans</italic> we cannot be certain that all of the relevant variables are observed (indeed only <inline-formula><mml:math id="inf235"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>20</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> of all neurons were reliably identified) or how they relate to experimental observations such as calcium signals measured using GCAMP. To mimic these conditions, we assume that only <inline-formula><mml:math id="inf236"><mml:mi>A</mml:mi></mml:math></inline-formula> is experimentally observed. Fortunately, the information contained in <inline-formula><mml:math id="inf237"><mml:mi>A</mml:mi></mml:math></inline-formula> can be used to reconstruct all of the relevant variables of the system using a class of methods called delay embedding (<xref ref-type="bibr" rid="bib74">Takens, 1981</xref>; <xref ref-type="bibr" rid="bib53">Packard et al., 1980</xref>; <xref ref-type="bibr" rid="bib31">Kantz and Schreiber, 2004</xref>). To illustrate the geometrical intuition behind this method, note that when delayed values of <inline-formula><mml:math id="inf238"><mml:mi>A</mml:mi></mml:math></inline-formula> are plotted against each other (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1B</xref>), the trajectory traced by the system faithfully reconstructs two distinct cycles similar to those observed in the original system (<xref ref-type="fig" rid="app1fig1s1">Appendix 1—figure 1—figure supplement 1</xref>).</p><fig-group><fig id="app1fig1" position="anchor"><object-id pub-id-type="doi">10.7554/eLife.46814.019</object-id><label>Appendix 1—figure 1.</label><caption><title>Extraction of manifold from incomplete neuronal activity data.</title><p>(<bold>A</bold>) Observation of a single neuron A) from a two neuron system which produces two distinct modes of oscillation. Activity of <inline-formula><mml:math id="inf239"><mml:mi>A</mml:mi></mml:math></inline-formula> at two time points separated by <inline-formula><mml:math id="inf240"><mml:mi>τ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf241"><mml:mrow><mml:mi>A</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf242"><mml:mrow><mml:mi>A</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo mathvariant="normal">-</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (blue dots), is used as x and y coordinates of a single point in the reconstructed phase plane (blue arrows) obtained by delay embedding. (<bold>B</bold>) When the activity time series in A is projected onto the plane spanned by <inline-formula><mml:math id="inf243"><mml:mrow><mml:mi>A</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf244"><mml:mrow><mml:mi>A</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo mathvariant="normal">-</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the reconstructed system trajectory reveals two distinct oscillatory cycles present in the complete system. (<bold>C</bold>) Schematic of asymmetric diffusion map construction. The arrow indicates the direction of preferred flux. Transition probabilities from the state of the system at time <inline-formula><mml:math id="inf245"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf246"><mml:msub><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, are computed using a local Gaussian kernel (red <inline-formula><mml:math id="inf247"><mml:mo mathvariant="normal">→</mml:mo></mml:math></inline-formula> high probability; blue <inline-formula><mml:math id="inf248"><mml:mo mathvariant="normal">→</mml:mo></mml:math></inline-formula> low probability). Because this kernel is centered on the next experimentally observed state <inline-formula><mml:math id="inf249"><mml:msub><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo mathvariant="normal">+</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, transition to <inline-formula><mml:math id="inf250"><mml:msub><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo mathvariant="normal">+</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is most likely. However, transitions to parallel trajectories (red shows high probability of transition) are also possible. (<bold>D</bold>) Asymmetrical diffusion map <inline-formula><mml:math id="inf251"><mml:mi>M</mml:mi></mml:math></inline-formula> computed for all pairs of states. <inline-formula><mml:math id="inf252"><mml:mi>M</mml:mi></mml:math></inline-formula> is sparse because for each point, transition probability is nonzero just for <inline-formula><mml:math id="inf253"><mml:mrow><mml:mi>k</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">12</mml:mn></mml:mrow></mml:math></inline-formula> nearest neighbors. Exponentiation of <inline-formula><mml:math id="inf254"><mml:mi>M</mml:mi></mml:math></inline-formula>, which shows the evolution of the system after <inline-formula><mml:math id="inf255"><mml:mi>N</mml:mi></mml:math></inline-formula> time steps, highlights the asymmetry. The red dashed line shows the main diagonal illustrating that the parallel bands are off center. Eigen-decomposition of the matrix reveals a linear sum of decay equations. <inline-formula><mml:math id="inf256"><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the <inline-formula><mml:math id="inf257"><mml:mi>i</mml:mi></mml:math></inline-formula>-th eigenvalue and <inline-formula><mml:math id="inf258"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the <inline-formula><mml:math id="inf259"><mml:mi>i</mml:mi></mml:math></inline-formula>-th eigenvector. <inline-formula><mml:math id="inf260"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> represent the initial conditions of the system. (<bold>E</bold>) Manifold constructed for the two neuron system using only neuron A. Manifold construction method (Materials and methods) uses <inline-formula><mml:math id="inf261"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> with the slowest decay time-constant to assign each point in delay embedded space (<bold>B</bold>) a phase <inline-formula><mml:math id="inf262"><mml:mi>θ</mml:mi></mml:math></inline-formula> (color of the manifold). <inline-formula><mml:math id="inf263"><mml:mi>θ</mml:mi></mml:math></inline-formula> identifies position of the system along the cyclic flux. Neuronal activity within a phase bin <inline-formula><mml:math id="inf264"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> is averaged such that the center of mass of all points within a bin <inline-formula><mml:math id="inf265"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> yields the coordinate of this bin in the delay embedded space. This is used to construct a one-to-one map between a cloud of points in the delay embedded neuronal activity and a phase bin in the manifold space (number of points in each <inline-formula><mml:math id="inf266"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> is shown by thickness). Thus, as the system evolves along <inline-formula><mml:math id="inf267"><mml:mi>θ</mml:mi></mml:math></inline-formula> in the direction given by <inline-formula><mml:math id="inf268"><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo mathvariant="normal">/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> (black arrows) it traces a trajectory in the delay embedded neuronal activity. Flux separation, accomplished using cluster analysis, assures that similar phases of different fluxes are not mistakenly grouped together (Materials and methods). (<bold>F</bold>) Simulations of the manifold in the phase space (<inline-formula><mml:math id="inf269"><mml:mi>θ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf270"><mml:mi>α</mml:mi></mml:math></inline-formula>) recapitulate neuronal activation. To show this we compare the simulated distribution of time intervals between consecutive minima of A (return times) and those produced by the full system including both neurons (minima shown by black Xs in <bold>A</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-app1-fig1-v1.tif"/></fig><fig id="app1fig1s1" position="anchor" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46814.020</object-id><label>Appendix 1—figure 1—figure supplement 1.</label><caption><title>State space and flux in dynamical systems with noise.</title><p>(<bold>A</bold>) Network diagram of the two neuron toy system explored in the paper. ‘Excitatory’ neuron <inline-formula><mml:math id="inf271"><mml:mi>A</mml:mi></mml:math></inline-formula> synapses (red triangle) onto ‘inhibitory’ neuron <inline-formula><mml:math id="inf272"><mml:mi>B</mml:mi></mml:math></inline-formula> which synapses (blue triangle) back onto neuron <inline-formula><mml:math id="inf273"><mml:mi>A</mml:mi></mml:math></inline-formula>. (<bold>B</bold>) Simulation of the two neuron system with noise. Red and blue traces show activity of neuron <inline-formula><mml:math id="inf274"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf275"><mml:mi>B</mml:mi></mml:math></inline-formula> respectively. (<bold>C</bold>) Black arrows represent the flux <inline-formula><mml:math id="inf276"><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mo mathvariant="normal">/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo mathvariant="normal">,</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mo mathvariant="normal">/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for positions in the state space (<inline-formula><mml:math id="inf277"><mml:mi>A</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf278"><mml:mi>B</mml:mi></mml:math></inline-formula>). Lines represent trajectories spanned by the state of the system as it evolves in time without noise. Trajectories either converge onto the outer loop (purple) or onto the inner loop (green) over time. These two loops are the cyclic fluxes of the system. (<bold>D</bold>) Adding noise to the system causes the trajectories to tangle and stochastically switch between the inner and outer cyclic fluxes. Nonetheless, the probability density of points is predominantly concentrated around the two cyclic fluxes and evolves in the same direction as in the system without noise.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46814-app1-fig1-figsupp1-v1.tif"/></fig></fig-group><p>Ultimately, we are interested in reconstructing the laws of motion that drive temporal evolution of neuronal activity. Although identification of the phase space is essential, it alone is not sufficient. Even in <italic>C. elegans</italic> the phase space is too high dimensional to estimate equations of motion directly from experimental data. To simplify the dynamics, we use the fact that in the limit of low noise, trajectories of the system will be dominated by motion near the loops. Therefore, although the phase space itself may be high-dimensional, most trajectories traced by the system in this space are low dimensional objects well-approximated by rotation around the loops referred to as cyclic fluxes. We introduce a novel method – Asymmetric Diffusion Map Modeling (See Materials and methods) – to extract these fluxes and create a parsimonious description of the dynamics. Diffusion maps express distances between points <inline-formula><mml:math id="inf279"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf280"><mml:mi>j</mml:mi></mml:math></inline-formula> in a local neighborhood of the phase space as the probability that a system found in state <inline-formula><mml:math id="inf281"><mml:mi>i</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf282"><mml:mi>t</mml:mi></mml:math></inline-formula> will be observed at state <inline-formula><mml:math id="inf283"><mml:mi>j</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf284"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib48">Nadler et al., 2006</xref>; <xref ref-type="bibr" rid="bib14">Coifman and Lafon, 2006</xref>; <xref ref-type="bibr" rid="bib38">Lian et al., 2015</xref>). This local neighborhood is defined by a Gaussian kernel centered at <inline-formula><mml:math id="inf285"><mml:mi>i</mml:mi></mml:math></inline-formula>. Accordingly, diffusion maps are symmetric and cannot capture the temporal sequence in which the data are observed. To adapt diffusion mapping for the purposes of modeling system dynamics, we center Gaussian kernels on the next experimentally observed point <inline-formula><mml:math id="inf286"><mml:msub><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mrow><mml:mi mathvariant="bold">𝐭</mml:mi><mml:mo>+</mml:mo><mml:mn>𝟏</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> instead of <inline-formula><mml:math id="inf287"><mml:msub><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mi mathvariant="bold">𝐭</mml:mi></mml:msub></mml:math></inline-formula> (Materials and methods) (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1C</xref>, red cloud shows the Gaussian kernel). Thus, although the system is most likely to transition to its next experimentally observed state, the Gaussian kernel ensures that the system may also diffuse within the neighborhood of <inline-formula><mml:math id="inf288"><mml:msub><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mrow><mml:mi mathvariant="bold">𝐭</mml:mi><mml:mo>+</mml:mo><mml:mn>𝟏</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. As a result the diffusion map is asymmetric and can express the ordered sequence of experimental observations. Diagonal bands in this transition probability matrix occur when the trajectory has parallel segments separated in time (<xref ref-type="bibr" rid="bib15">Eckmann et al., 1987</xref>) (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1D</xref>). This confirms the intuition that in the limit of low noise, the trajectories of the system are recurrent.</p><p>Expressing distances between points in phase space as transition probabilities offers a fundamental advantage – the dynamics given by the transition probability matrix can be simplified using spectral analysis. Spectral analysis decomposes the dynamics given by the original transition probability matrix into a sum of simple decay equations known as the eigenmodes <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1D</xref>. Because of the asymmetry in the diffusion matrix (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1D</xref>), these eigenmodes given by the eigenvalue <inline-formula><mml:math id="inf289"><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and the associated eigenvector <inline-formula><mml:math id="inf290"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> can be complex and thus reflect rotational motion. If the mode decays quickly, it does not contribute to the observed dynamics appreciably. Thus, dynamics of the system as a whole can be approximated by the complex eigenmodes with the slowest decay time-constant (Materials and methods). These slow decaying eigenmodes are an approximation of the cyclic motion around the loops in the phase space.</p><p>The position of each state of the system <inline-formula><mml:math id="inf291"><mml:msub><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mi mathvariant="bold">𝐭</mml:mi></mml:msub></mml:math></inline-formula> along the cyclic flux is given by the phase <inline-formula><mml:math id="inf292"><mml:mi>θ</mml:mi></mml:math></inline-formula> of the associated complex eigenvector with the slowest decay time-constant (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1E</xref>). In addition to <inline-formula><mml:math id="inf293"><mml:mi>θ</mml:mi></mml:math></inline-formula>, the only other relevant variable is the identity of the flux, <inline-formula><mml:math id="inf294"><mml:mi>α</mml:mi></mml:math></inline-formula>. Identify of the flux is established by clustering the diffusion map (Materials and methods). Because only two variables are sufficient to span the phase space, we can efficiently estimate equations of motion <inline-formula><mml:math id="inf295"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℳ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from short and noisy experimental measurements.</p><p><inline-formula><mml:math id="inf296"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℳ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> approximates the dynamics of the nervous system <inline-formula><mml:math id="inf297"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in the true phase space <inline-formula><mml:math id="inf298"><mml:mi mathvariant="bold">𝐗</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf299"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf300"><mml:mi>B</mml:mi></mml:math></inline-formula> in this case). Yet, unlike the high dimensional and nonlinear dynamics given by <inline-formula><mml:math id="inf301"><mml:mi>f</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf302"><mml:mi class="ltx_font_mathcaligraphic">ℳ</mml:mi></mml:math></inline-formula> is two dimensional and linear. The nonlinearity of <inline-formula><mml:math id="inf303"><mml:mi>f</mml:mi></mml:math></inline-formula> is encoded in the mapping from <inline-formula><mml:math id="inf304"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to delayed coordinates <inline-formula><mml:math id="inf305"><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow></mml:math></inline-formula> (Materials and methods). This mapping is illustrated in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1B and E</xref>. Mapping from <inline-formula><mml:math id="inf306"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> back to neuronal activity can be used to validate dynamics given by <inline-formula><mml:math id="inf307"><mml:mi class="ltx_font_mathcaligraphic">ℳ</mml:mi></mml:math></inline-formula>. In <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1F</xref>, we used <inline-formula><mml:math id="inf308"><mml:mi class="ltx_font_mathcaligraphic">ℳ</mml:mi></mml:math></inline-formula> of the two neuron system to predict the distribution of times between local minima of A (marked by the back Xs in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1A</xref>). These correspond to the returns of the system to the same <inline-formula><mml:math id="inf309"><mml:mi>θ</mml:mi></mml:math></inline-formula> along one of the two fluxes.</p><p>The methodology illustrated for the two neuron system was applied to reconstruct the dynamics in <italic>C. elegans</italic>. Parameters used in the <italic>C. elegans</italic> model construction are shown in <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref>. We chose the delay embedding time <inline-formula><mml:math id="inf310"><mml:mi>τ</mml:mi></mml:math></inline-formula> based on the autocorrelations of neuronal activity and its derivative <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A</xref>. Equivalently, this choice can be made on the basis of mutual information between delayed values of neuronal activity <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B</xref>. The specific choice of <inline-formula><mml:math id="inf311"><mml:mi>τ</mml:mi></mml:math></inline-formula> and number of embeddings does not strongly affect the results so long as the total delay time is ∼50 frames and the number of embeddings is sufficiently large <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>.</p><table-wrap id="app1table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.46814.021</object-id><label>Appendix 1—table 1.</label><caption><title>Parameters used in model construction of <italic>C. elegans</italic> dynamics.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter name</th><th>Parameter value</th><th>Parameter description</th></tr></thead><tbody><tr><td>Number of neighbors</td><td>12</td><td>number of nearest trajectories in a local neighborhood</td></tr><tr><td>Minimum time frame</td><td>50</td><td>minimum time separation for nearest trajectories</td></tr><tr><td>Number of delays</td><td>5</td><td>Number of times the neuronal activity was embedded</td></tr><tr><td>Delay length</td><td>10</td><td><inline-formula><mml:math id="inf312"><mml:mi>τ</mml:mi></mml:math></inline-formula> in units of number of frames</td></tr></tbody></table></table-wrap></boxed-text></sec></app></app-group></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.46814.027</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Ryu</surname><given-names>William S</given-names></name><role>Reviewer</role><aff><institution>University of Toronto</institution><country>Canada</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Cropper</surname><given-names>Elizabeth</given-names> </name><role>Reviewer</role><aff><institution>Icahn School of Medicine at Mount Sinai</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;A model of conserved global neuronal dynamics predicts future behaviors in <italic>Caenorhabditis elegans</italic>&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by Ronald Calabrese as the Senior Editor, a Reviewing Editor, and three reviewers. The following individuals involved in review of your submission have agreed to reveal their identity: William S Ryu (Reviewer #1); Elizabeth Cropper (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This paper reports a &quot;coarse&quot; grain model that takes whole &quot;brain,&quot; single-neuron calcium data from <italic>C. elegans</italic> and provides behaviorally relevant results using a manifold detection method based on diffusion mapping. The paper is technical enough to be of interest to specialists, but written in a way that is accessible and potentially interesting to a general audience. The Materials and methods sections is particularly clearly presented.</p><p>Essential revisions:</p><p>While there was considerable enthusiasm for the approach, there were several concerns that must be addressed before publication. The expert reviews are appended and will be of critical importance in the revision. The most important concerns are:</p><p>1) The data is from constrained animals and this impacts the interpretation of the results. Reviewers #1 (comment 1) and #3 (comment 1) share this concern and have specific prescriptions.</p><p>2) Not enough detail is provided about the model itself. Reviewers #1 (comment 2) and #3 (comment 2) share this concern and have specific prescriptions.</p><p>3) The time scale of the delay embedding is a concern and should be addressed as called for in comment 5 of reviewer #3.</p><p>4) There was a concern that predicting behavior based on the data that was used to define behavior is circular. To justify the conclusions the authors should show that the conclusions continue to hold when using the data without AVA (comment 3, reviewer #3).</p><p>5) There was a concern about neuronal identification in the data. This concern is difficult to address since the authors rely on published data and are not themselves doing the neuronal identification. The authors should combine a discussion of the robustness of their analysis with respect to neuronal mis-identification (especially considering that neuron identification for large scale recordings is still a major technical challenge for many labs) with a general robustness analysis for the previous point, where they would remove AVA and systematically explore how removal/identity shuffles would affect the resulting manifold and prediction. If this discussion and analysis is provided, the authors need not address reviewer #3, comment 4 further.</p><p>Title</p><p>The authors should consider revising the Title to reflect reviewer concern about whether the model is predictive.</p><p><italic>Reviewer #1:</italic> </p><p>This is a very nice paper describing a &quot;coarse&quot; grain model that takes whole &quot;brain,&quot; single-neuron data and provides behaviorally relevant results. The paper is technical enough to be of interest to specialists, but written in a way that is accessible and potentially interesting to a general audience. The Materials and methods section is particularly clearly presented. I think the work clears the bar for <italic>eLife</italic>.</p><p>1) Since the data are from constrained worms, it is not clear to the reader how these behavioral states were measured. A naive reader would assume behavior labeled as &quot;forward locomotion,&quot; &quot;reverse,&quot; etc. would come from observations of moving worms independently and not from interpreting the global brain signals themselves. Anyway, this can be made clear up front without asking the reader to go through Kato et al. For example, for Figure 2A, the authors explicitly write that they used the AVA signals to define the start of forward locomotion. What about the rest of the defined behaviors?</p><p>2) Not enough detail is given about the model in order for the reader to appreciate the jump from Figure 1 to Figure 2. The authors reference Figure 1—figure supplement 1 early in the Results sections but I would think something like Figure 4 would be necessary for the reader to be able to assess Figure 2. There should be enough technical detail given in the text so that the model is understandable.</p><p>3) Maybe this is a minor point (or an argument of semantics), but does the model really predict behavior of <italic>C. elegans</italic> up to 30 seconds in the future? Or does it predict the probability of a stochastic transition at some time T and so the event has some expected time, <italic>t,</italic> and manifests itself observably at <italic>t</italic> on average. The Title of the paper reads as if the signals deterministically predict future behavior.</p><p>4) A natural question is raised when discussing the number of neurons needed to see similar global brain dynamics. From 100 neurons to 15 neurons to 8 neurons. How far can one go for this specific dataset?</p><p>Discussion section. &quot;<italic>C. elegans</italic> do not fire action potentials.&quot; Not strictly true. For example, see: Liu et el., 2018</p><p><italic>Reviewer #2:</italic> </p><p>This report takes advantage of the powerful tools that have been developed that make it possible to relate neural activity to behavior in <italic>C. elegans</italic>. Namely, imaging techniques with single neuron precision can record activity in intact worms as they freely switch between different forms of locomotion. It is therefore possible to do more than simply correlate an activity pattern with a behavior. The temporal evolution of behavior can be characterized. There are not many systems where this can be accomplished, and this is a very exciting area of research. A potential 'drawback' of experiments like this that generate so much data is that data can be difficult to analyze and interpret. Studies such as this that develop tools for this purpose are therefore clearly needed.</p><p>These authors use imaging data to construct a model of neuronal dynamics. Their approach is novel, and differs from traditional approaches in that it does not proceed in a 'bottom-up' fashion (it was not built by characterizing all of the biophysical properties and synaptic connections of the neurons in the network). There are a number of drawbacks to the bottom-up approach, as the authors point out. For example, an assumption usually inherent in this type of work is that a particular network output is encoded by one set of circuit parameters. Work in other systems has indicated that this is not necessarily the case, and the authors demonstrate that activity in identified neurons in <italic>C. elegans</italic> is variable during the behaviors studied.</p><p>The tools that the authors develop extract information from a subset of the neurons that mediate behavior. There are hundreds of neurons in <italic>C. elegans</italic> but the authors were only able to consistently identify fifteen. This speaks to the potential utility of this method since it is generally not possible to record from all of the neurons in a network of interest. This is, however, not simply a 'methods' paper. The authors use their techniques to simulate neuronal activity and interestingly demonstrate that these simulations can be used to predict behavioral switches before they occur in a different cohort of animals (i.e., not the animals used to develop the model). Finally, the authors construct manifolds using specific data sets (e.g., activity of the fifteen identified neurons recorded from in four out of the five animals of the study) and demonstrate that left out data are well approximated by these manifolds. Taken together, this research comes to a fundamentally important conclusion – that global dynamics in the functioning of the nervous system are conserved despite the fact that there are differences in the activity of individual neurons.</p><p><italic>Reviewer #3:</italic> </p><p>The authors of &quot;A model of conserved global neuronal dynamics predicts future behaviors in <italic>Caenorhabditis elegans</italic>&quot; re-analyze existing wholebrain calcium data from <italic>C. elegans</italic> using a manifold detection method based on diffusion mapping. Based upon the current manuscript I have a few concerns that if addressed would significantly improve the clarity of the manuscript.</p><p>1) My main concern is the interpretation of the results as predicting behavior: From the Title and the main text it is unclear to the reader that the animals in question are actually immobilized (according to Kato et al. these animals are in microfluidics and sometimes even treated with a paralytic). Kato et al. show that animals where AVA is silenced do not perform any reversals, but the global brain dynamics are still observed. This indicates a loose connection between these manifold dynamics and behavior at best. Kato et al. also reported that prolonged activation phases of neurons such as RIM only occur in immobilized animals, not in freely moving ones, indicating that immobilization changes neural dynamics. Based upon these caveats in their data, I urge the authors to carefully re-word their interpretation of their results as 'behavioral coding', and be more careful about this wording throughout, but particularly in the Discussion and the Title.</p><p>2) Reading the paper, it is unclear if the authors main goal is to present a method or to describe new findings. If the main goal is to present a generalizable method, the authors should be much more explicit about the steps of the data analysis process. In the current manuscript, the model is not described in the main text at all (subsection “ng neuronal dynamics give rise to neuronal activity” introduces the model without describing any of its properties). In either case, I strongly urge the authors to either present a cartoon or an example data set that underwent all of their processing, embedding and dimensionality reduction, etc. If I read this manuscript as a methods paper, I would like to see how parameter choices (in particular delays, smoothing parameters, numbers of dimensions chosen after reduction) affect the outcome. This could be done on purely synthetic data even.</p><p>3) As far as I can tell from the methods, the 'behavior' is deducted from the activity of the motor command interneuron AVA. AVAL and AVAR also appear among the 15 neurons that are common between datasets. It seems that AVAR and AVAL were not removed from the data used to create the manifold. Predicting behavior based on the data that was used to define behavior seems circular. It would strengthen the conclusions if they were still true from the data without AVA.</p><p>4) Neuronal identity: The analysis by Brennan and Proekt relies on unambiguous identification of the neuronal identity. The conclusions about variability in activity between neurons (Discussion section), and the fact that PCA does not create reliable manifolds could possibly indicate that a subset of the neurons were mis-identified. On a subset of only 15 common neurons, even one misidentified neuron could possibly have a large impact. From the periodic, low dimensional example dataset shown in Figure 1, and the somewhat consistent PCA weights shown in Figure S2 of Kato et al. this conclusion is surprising and could be better supported to motivate the more complex strategy presented in the paper.</p><p>Relatedly, one of the first findings presented in Figure 1 is that there are consistent statistical differences in the activity of the same neuron across animals. Based upon single neuron Calcium imaging, it is not surprising that neurons are showing diverse activity in 'behaviors' they do not control. Comparing these data with previous studies on variability in neural activation (Gordus et al., 2015 for example) could provide context for these observations.</p><p>5) Timescales: Delay embedding is highly sensitive to the chosen timescales of the delay(s). The authors used a delay of ~4 seconds. However, the highly periodic nature of the neural activities (see e.g. Figure 1A, cyclic activity in most neurons) means that the auto-correlations will also have periodicity and signals will have non-zero auto-correlation over significantly longer times. The authors could show the auto-correlations explicitly and show how the delay embedding changes with significantly longer delay times or using a different method such as mutual information to calculate the delay. I suspect the signals have auto-correlation times much longer than 30 seconds.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.46814.028</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>While there was considerable enthusiasm for the approach, there were several concerns that must be addressed before publication. The expert reviews are appended and will be of critical importance in the revision. The most important concerns are:</p><p>1) The data is from constrained animals and this impacts the interpretation of the results. Reviewers #1 (comment 1) and #3 (comment 1) share this concern and have specific prescriptions.</p></disp-quote><p>This is a very important point. We have included more details concerning specifically the fact that the models of neuronal dynamics were constructed on the basis of neuronal activity observed in immobilized worms. Thus, the best interpretation of observed neuronal activity is that it expresses sequences of motor commands that occur in the absence of actual execution of behaviors. We have changed the Abstract, Title, and the Discussion section to reflect this. For the construction of the model we adapted the behavioral state definitions used by Kato et al. We focused our predictions on backwards and forward locomotion because they are by far the most prevalent in the observed time series. In principle, our methodology can be used on the other behaviors as well, but these predictions will be noisier due to paucity of observations.</p><p>There are likely to be important differences between neuronal dynamics observed in the immobilized and freely moving animals. We now dedicate a section in the discussion specifically to this issue. Differences in neuronal dynamics in freely moving and immobilized worms can be of two fundamentally distinct types: quantitative and qualitative. It is true that freely moving worms do not exhibit as much backward locomotion as those immobilized in the microfluidic chamber. Also, backward locomotion episodes are briefer in freely moving animals. These constitute quantitative differences. All that would be required to adapt our manifold constructed on the basis of immobilized worms to freely moving ones is to change the probability of switching between different loops in the manifold and the phase velocity of progression along the loop. In this case, the overall shape of the manifold would not change. It is also possible that execution of motor behaviors and sensory feedback may change the shape of the manifold appreciably. This would constitute a qualitative change. Neuronal suppression experiments by Kato et al. suggest that this may not be the case in <italic>C. elegans</italic> locomotion as they observe that even when backward locomotion was eliminated by suppressing activity of the AVA, other neurons involved in backward locomotion were activated in a similar fashion. Yet, to definitively determine whether the shape of the manifold is significantly altered by sensory experience and execution of behaviors, one would need to reconstruct neuronal dynamics in freely moving animals. Our methodology will be useful for accomplishing this important goal in the future.</p><p>In simple systems it is known that many behaviors are controlled by central pattern generators. Motor programs observed in isolated nervous systems are essentially similar in terms of phasing of activation of individual neurons to those observed during natural execution of behaviors. Interactions with the environment may change the speed or the finer details of the motor programs observed in the isolated brain. Our model of neuronal dynamics in immobilized worms can be thought of in similar terms. The dynamics express an action sequence of different locomotor behaviors observed in the nervous system isolated from the environment. This action system is structured by neuronal dynamics which we reconstruct on the basis of neuronal activity.</p><disp-quote content-type="editor-comment"><p>2) Not enough detail is provided about the model itself. Reviewers #1 (comment 2) and #3 (comment 2) share this concern and have specific prescriptions.</p></disp-quote><p>We have included a new section and included it into the Appendix. This newly added section and figures describe the basic ideas behind the methodology. To illustrate how the method works, following the suggestion of reviewer 3, we simulated a network of two interconnected neurons and reconstructed the dynamics using our methodology based on one of them (Appendix 1—figure 1 and its corresponding Appendix 1—figure 1—figure supplement 1). Much like the nervous system of <italic>C. elegans</italic> the dynamics of this simple system are nonlinear and noisy. The reconstruction of the model system includes all of the essential elements of the modeling approach including delay embedding, construction of the asymmetrical diffusion map, spectral analysis, and clustering. We then illustrate how predictions of the model can be verified by comparing the statistics of the reconstructed system to those observed in simulations of the complete neuronal network. We have also included a table that summarizes all the parameters used to model <italic>C. elegans</italic> dynamics (see also our response concerning the choice of embedding parameters).</p><disp-quote content-type="editor-comment"><p>3) The time scale of the delay embedding is a concern and should be addressed as called for in comment 5 of reviewer #3.</p></disp-quote><p>The delay embedding time was chosen empirically based on the scale of autocorrelation of activation of individual neurons now shown in a newly added supplementary figure (Figure 2—figure supplement 2). The choice of the embedding parameters (delay time and number of embeddings) can, as expected, affect the quality of the reconstruction. To address this concern, we varied embedding parameters and included the results of this analysis in a newly generated figure (Figure 2—figure supplement 3). To determine the quality of the reconstruction we compared the dwell time statistics of models constructed using different values of delay times and number of embeddings to those observed experimentally by Kato et al. These results show that several parameter choices yield good predictions and established some parameter choices that do not. We now discuss this in the Materials and methods section.</p><p>Other measures such as mutual information can also be used to determine delay embedding parameters. We also included delay mutual information in a supplementary figure as suggested by the reviewer. Because of paucity of data, we used autocorrelations in this manuscript as the basis for choosing delay embedding parameters. In other systems mutual information may prove to be more useful. In general, the issue of choosing appropriate embedding parameters in multivariate and noisy time series is not well resolved. Nevertheless, because our method is able to reduce the dimensionality of the embedded time series, several choices of the number of embeddings yield good predictions so long as the number of dimensions is sufficiently high, and the delayed values of the data set are approximately independent.</p><disp-quote content-type="editor-comment"><p>4) There was a concern that predicting behavior based on the data that was used to define behavior is circular. To justify the conclusions the authors should show that the conclusions continue to hold when using the data without AVA (comment 3, reviewer #3).</p></disp-quote><p>We have eliminated AVA from both the Kato et al. dataset used for model generation and from the Nichols et al. validation dataset. In a newly added supplementary figure (Figure 3—figure supplement 1), we show that even in the absence of the AVA our model can predict the expected switching time between motor commands for forward and backward locomotion. These predictions are nearly as accurate as those obtained on the full neuronal subset. Predictions given by the model in the absence of the AVA are significantly more accurate than those given by the model that relies solely on dwell time statistics.</p><p>As pointed out by reviewer 1, the diffusion map is a stochastic model as it is based upon a Markov matrix. Thus, the predictions are best described in terms of the expected time to motor command switch. We now make this point explicitly in the manuscript. The important finding is that this expected time to switch of the motor command is a function of phase along the manifold rather than specifics of activation of individual neurons.</p><disp-quote content-type="editor-comment"><p>5) There was a concern about neuronal identification in the data. This concern is difficult to address since the authors rely on published data and are not themselves doing the neuronal identification. The authors should combine a discussion of the robustness of their analysis with respect to neuronal mis-identification (especially considering that neuron identification for large scale recordings is still a major technical challenge for many labs) with a general robustness analysis for the previous point, where they would remove AVA and systematically explore how removal/identity shuffles would affect the resulting manifold and prediction. If this discussion and analysis is provided, the authors need not address reviewer #3, comment 4 further.</p></disp-quote><p>Our model is based upon previously acquired data and we cannot offer any additional information concerning neuronal identification beyond that presented by Kato et al. and Nichols et al. It is possible that some neurons were misidentified. Thus, we only focused on the 15 neurons that were identified with highest confidence in the Kato et al. dataset. The data in Figure 1 argue that neuronal misidentification is not likely a strong contributor to the variability of neuronal activation. For instance, activation of RIML (highlighted for the purposes of illustration in Figure 1) is inconsistent in some forms of locomotion but is consistent among worms in another type of locomotion. This is the case in most neurons identified by Kato et al. To further address the issue of neuron identification and also a question raised by reviewer 1 concerning the minimal number of neurons required for the reconstruction, we built models of dynamics on the basis of activity of a single neuron. The results of this analysis is included in a newly created supplementary figure (Figure 2—figure supplement 4). These results indicate that some single neurons yield predictions comparable to those observed for the entire 15 neuron set. Remarkably one of the neurons that is sufficient for good quality prediction (~ 75% as informative as the entire set of 15 neurons) is RIML. Recall that RIML exhibited variable activation during backward locomotion (Figure 1). Nevertheless, predictions based solely on RIML are some of the more informative among models based on single neurons.</p><p>Regarding the variability of neuronal activation in behaviors that they do not control, we specifically discuss the ALA neuron in the manuscript. Note that activation of ALA is variable from one cycle of behavior to the other. This is reflected in broad confidence intervals around the mean activity of the ALA. Note, however, that there are no consistent differences between ALA activity observed in different animals. The consistent differences between individuals are of fundamentally different nature than cycle to cycle variability. In each individual, the neuronal activity is reproducible from cycle to cycle. Yet, there are consistent differences between worms. These differences are such that averaging neuronal activity across worms does not yield a representative trace of neuronal activity. This kind of variability is the focus of our manuscript. Gordus et al. focus on how taking into account variable activation of other neurons in the circuit constraints activation of the AIB neuron. This is in spirit similar to our argument that while there are individual differences in neuronal activation, the macroscopic parameter such as phase along the cyclic flux nevertheless expresses dynamics that are consistent among individuals. Thank you for pointing out this study to us. We now cite it explicitly in the manuscript.</p><disp-quote content-type="editor-comment"><p>Title</p><p>The authors should consider revising the Title to reflect reviewer concern about whether the model is predictive.</p></disp-quote><p>The new Title is: A quantitative model of conserved macroscopic dynamics predicts future motor commands.</p></body></sub-article></article>