<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">48994</article-id><article-id pub-id-type="doi">10.7554/eLife.48994</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Stem Cells and Regenerative Medicine</subject></subj-group></article-categories><title-group><article-title>Self-assembling manifolds in single-cell RNA sequencing data</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-146178"><name><surname>Tarashansky</surname><given-names>Alexander J</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-144204"><name><surname>Xue</surname><given-names>Yuan</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-105965"><name><surname>Li</surname><given-names>Pengyang</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-3886"><name><surname>Quake</surname><given-names>Stephen R</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1613-0809</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-105963"><name><surname>Wang</surname><given-names>Bo</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8880-1432</contrib-id><email>wangbo@stanford.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Bioengineering</institution><institution>Stanford University</institution><addr-line><named-content content-type="city">Stanford</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Applied Physics</institution><institution>Stanford University</institution><addr-line><named-content content-type="city">Stanford</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Chan Zuckerberg Biohub</institution><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Department of Developmental Biology</institution><institution>Stanford University School of Medicine</institution><addr-line><named-content content-type="city">Stanford</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Shalek</surname><given-names>Alex K</given-names></name><role>Reviewing Editor</role><aff><institution>Broad Institute of MIT and Harvard</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Barkai</surname><given-names>Naama</given-names></name><role>Senior Editor</role><aff><institution>Weizmann Institute of Science</institution><country>Israel</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>16</day><month>09</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e48994</elocation-id><history><date date-type="received" iso-8601-date="2019-06-03"><day>03</day><month>06</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2019-09-16"><day>16</day><month>09</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Tarashansky et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Tarashansky et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-48994-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.48994.001</object-id><p>Single-cell RNA sequencing has spurred the development of computational methods that enable researchers to classify cell types, delineate developmental trajectories, and measure molecular responses to external perturbations. Many of these technologies rely on their ability to detect genes whose cell-to-cell variations arise from the biological processes of interest rather than transcriptional or technical noise. However, for datasets in which the biologically relevant differences between cells are subtle, identifying these genes is challenging. We present the self-assembling manifold (SAM) algorithm, an iterative soft feature selection strategy to quantify gene relevance and improve dimensionality reduction. We demonstrate its advantages over other state-of-the-art methods with experimental validation in identifying novel stem cell populations of <italic>Schistosoma mansoni</italic>, a prevalent parasite that infects hundreds of millions of people. Extending our analysis to a total of 56 datasets, we show that SAM is generalizable and consistently outperforms other methods in a variety of biological and quantitative benchmarks.</p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.48994.002</object-id><title>eLife digest</title><p>New technologies have enabled scientists to closely examine the activity of individual cells. One increasingly popular technique to do this is called single-cell RNA-sequencing and it relies on the fact that although all cells in an organism carry the same DNA, different cell types use different genes. This technique is powerful but can struggle to identify meaningful distinctions between cell types, especially when the differences are subtle.</p><p>In single-cell RNA-sequencing, the messenger RNA (mRNA) copied from each gene is collected and counted, and usually the more a gene is copied the more active it is. Differences in gene activity (also called gene expression) between two cells often imply that they are different types of cells. However, since only an infinitesimal amount of mRNAs can be collected from a single cell, the counting is often inaccurate. In addition, the transient changes in gene expression can make cells of the same type have different gene expressions. These factors make it challenging to determine what genes are informative for distinguishing between cell types.</p><p>To address this problem, Tarashansky et al. have developed a computational approach called Self-Assembling Manifold (or SAM for short) to identify differences in gene expression that can lead to a better classification of cell types. First, SAM groups the cells randomly and looks for genes with different expression patterns between the groups. By looking at differences between groups instead of differences between individual cells, SAM is ‘averaging out’ individual differences within groups. SAM then uses the resulting information to re-classify the cells and start the process over again, taking the new groups and finding differences between them. SAM repeats these steps until the classification stops changing and becomes stable. SAM does not require any existing knowledge about cell types or gene expression, meaning it is unbiased and widely applicable. To test the usefulness of the algorithm, Tarashansky et al. used SAM to identify new cell types in the medically important parasitic worm <italic>Schistosoma mansoni</italic>, which infects hundreds of millions of people worldwide every year.</p><p>SAM can tell cell types apart better than existing approaches, and it can find meaningful differences in systems with a lot of meaningless variability as demonstrated by evaluating SAM’s performance on 55 other datasets. The potential applications of this approach are many, including the creation of detailed cell atlases recording the different types of cells throughout entire organisms.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>single-cell analysis</kwd><kwd>manifold reconstruction</kwd><kwd>feature selection</kwd><kwd>stem cells</kwd><kwd>schistosome</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000861</institution-id><institution>Burroughs Wellcome Fund</institution></institution-wrap></funding-source><award-id>CASI program</award-id><principal-award-recipient><name><surname>Wang</surname><given-names>Bo</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000997</institution-id><institution>Arnold and Mabel Beckman Foundation</institution></institution-wrap></funding-source><award-id>Young Investigator Award</award-id><principal-award-recipient><name><surname>Wang</surname><given-names>Bo</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>An iterative self-assembling algorithm identifies the intrinsic structures in single-cell transcriptomic data and helps to discover new cell populations that are undetectable by existing methods.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Single-cell RNA sequencing (scRNAseq) datasets typically contain tens of thousands of genes, although many of them may not be informative for differentiating between cell types or states. Feature selection is thus commonly used to select a subset of genes prior to downstream analyses, such as manifold reconstruction and cell clustering (<xref ref-type="bibr" rid="bib7">Crow et al., 2018</xref>; <xref ref-type="bibr" rid="bib27">Satija et al., 2015</xref>; <xref ref-type="bibr" rid="bib37">Vallejos et al., 2015</xref>). However, current approaches have two major limitations.</p><p>First, feature selection methods filter genes based on arbitrarily or empirically chosen thresholds, small changes in which may result in different gene sets (<xref ref-type="bibr" rid="bib38">Vallejos et al., 2017</xref>). In addition, the selection of features typically operates under the assumption that genes with highly variable expression between individual cells capture biologically meaningful variation. Because single-cell transcriptomes are inevitably contaminated by a combination of random transcriptional and technical noise (<xref ref-type="bibr" rid="bib11">Grün et al., 2014</xref>), the variation in biologically relevant genes may be hard to distinguish from the background noise, especially when the differences between cell populations are subtle. Resolving these differences, or ‘signals’, is essential to study a variety of biological problems, including identifying cell subtypes (<xref ref-type="bibr" rid="bib22">Olsson et al., 2016</xref>; <xref ref-type="bibr" rid="bib36">Treutlein et al., 2014</xref>; <xref ref-type="bibr" rid="bib20">Lönnberg et al., 2017</xref>; <xref ref-type="bibr" rid="bib10">Fincher et al., 2018</xref>; <xref ref-type="bibr" rid="bib2">Baron et al., 2016</xref>; <xref ref-type="bibr" rid="bib28">Schwalie et al., 2018</xref>) and quantifying the effects of molecular perturbations to otherwise homogeneous populations of cells (<xref ref-type="bibr" rid="bib17">Lane et al., 2017</xref>). In such datasets, only a small fraction of the genes, and therefore only a small fraction of the total variation, may contain the signals relevant for distinguishing cell types or cell states. Choosing these features without a priori knowledge remains an unmet computational challenge.</p><p>The second limitation is that existing methods have been almost exclusively benchmarked on well-annotated, gold standard datasets with clearly distinguishable cell types (<xref ref-type="bibr" rid="bib40">Wang et al., 2017</xref>; <xref ref-type="bibr" rid="bib16">Kiselev et al., 2017</xref>; <xref ref-type="bibr" rid="bib9">Duò et al., 2019</xref>; <xref ref-type="bibr" rid="bib1">Bahlo et al., 2018</xref>). These datasets are not informative for distinguishing the performance between methods, because the differences between cell types are relatively straightforward to detect. However, evaluating the performance of feature selection and/or dimensionality reduction methods on datasets with more subtle signals is difficult as their ground truth labels are typically ambiguous or nonexistent.</p><p>To overcome the shortcomings of current feature selection approaches, here, we introduce the Self-Assembling Manifold (SAM) method, an unsupervised, ‘soft feature selection’ algorithm that iteratively rescales gene expressions to refine a nearest neighbor graph of cells until the graph converges to a stable solution. At each iteration, SAM assigns more weight to genes that are spatially variable across the constructed graph, and this weighted gene expression is then used to improve the next nearest neighbor assignment. SAM presents two advantages: it rescales all genes according to their weights, solving the problem of thresholding, and it prioritizes genes that are variable across the intrinsic manifold of the data rather than selecting genes that are variable across individual cells.</p><p>In order to better distinguish the performance between methods, we define a network sensitivity measure to identify datasets with subtle signals. With limited annotations in most high-sensitivity datasets, we introduce unsupervised graph-based metrics to quantify the degree of structure within the reconstructed manifolds for comparison between methods. In addition, we perform benchmarking using known ground truth labels on simulated datasets spanning a wide range of sensitivities by introducing increasing levels of noise to well-annotated datasets. These analyses reveal that SAM consistently improves feature selection and cell clustering.</p><p>To demonstrate the utility of SAM in practice, we provide an in-depth analysis of two datasets that are challenging to analyze using existing methods: stem cells in a human parasitic worm, <italic>Schistosoma</italic>, and activated macrophages (<xref ref-type="bibr" rid="bib17">Lane et al., 2017</xref>). We show that SAM can capture novel biology undetectable by other methods and validate these results with experimental evidence.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>The SAM algorithm</title><p>The SAM algorithm begins with a random <italic>k</italic>-nearest neighbor (kNN) graph and averages the expression of each cell with its <italic>k</italic> nearest neighbors: <inline-formula><mml:math id="inf1"><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mfrac><mml:mi>N</mml:mi><mml:mi>E</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf2"><mml:mi>N</mml:mi></mml:math></inline-formula> is the directed adjacency matrix and <inline-formula><mml:math id="inf3"><mml:mi>E</mml:mi></mml:math></inline-formula> is the gene expression matrix (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). For each gene <italic>i</italic>, SAM computes a spatial dispersion factor of the averaged expressions <inline-formula><mml:math id="inf4"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, which measures variation across neighborhoods of cells rather than individual cells (Materials and methods). These dispersions are used to calculate the gene weights, which then rescale the expression matrix: <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:msqrt><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a diagonal matrix with gene weights along the diagonal. Using the rescaled expressions <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, we compute a pairwise cell distance matrix and update the assignment of each cell’s <italic>k</italic>-nearest neighbors accordingly. This cycle continues until the gene weights converge.</p><p>To demonstrate the implementation and utility of SAM, below we analyze a challenging dataset comprised of a few hundred relatively homogeneous stem cells isolated from <italic>Schistosoma mansoni</italic> (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), a widespread human pathogen (<xref ref-type="bibr" rid="bib14">Hoffmann et al., 2014</xref>). Using a protocol we have established previously (<xref ref-type="bibr" rid="bib41">Wang et al., 2018</xref>), these cells were collected by sorting dividing cells from juvenile parasites harvested from their mouse hosts at 2.5 weeks post infection. At this stage, the parasites use an abundant stem cell population (~15–20% of the total number of cells) for rapid organogenesis and growth (<xref ref-type="bibr" rid="bib39">Wang et al., 2013</xref>; <xref ref-type="bibr" rid="bib41">Wang et al., 2018</xref>). Testing several existing methods (<xref ref-type="bibr" rid="bib40">Wang et al., 2017</xref>; <xref ref-type="bibr" rid="bib16">Kiselev et al., 2017</xref>; <xref ref-type="bibr" rid="bib27">Satija et al., 2015</xref>), we found that they were not able to identify distinct cell populations in this dataset. In contrast, SAM finds a stable solution independent of initial conditions (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). A graph structure with clearly separated cell populations self-assembles through the iterative process (<xref ref-type="fig" rid="fig1">Figure 1c</xref>). In parallel, the gene weights converge onto the final weight vector. Eventually, only a small fraction of genes (~1%) are strongly weighted and useful for separating cell clusters, reflecting the inherent difficulty of analyzing this dataset.</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.48994.003</object-id><label>Figure 1.</label><caption><title>The SAM algorithm.</title><p>(<bold>a</bold>) SAM starts with a randomly initialized kNN adjacency matrix and iterates to refine the adjacency matrix and gene weight vector until convergence. (<bold>b</bold>) Root mean square error (RMSE) of the gene weights (top) and the fraction of different edges of the nearest-neighbor adjacency matrices (bottom) between adjacent iterations (blue) and between independent runs at the same iteration (orange) to show that SAM converges to the same solution regardless of initial conditions. The differences between the gene weights and nearest-neighbor graphs from independent runs are relatively small, indicating that SAM converges to the same solution through similar paths. (<bold>c</bold>) Graph structures and gene weights of the schistosome stem cell data converging to the final output over the course of 10 iterations (<italic>i</italic> denotes iteration number). Top: nodes are cells and edges connect neighbors. Nodes are color-coded according to the final clusters. Bottom: weights are sorted according to the final gene rankings. (<bold>d</bold>) Network properties iteratively improve for the graphs reconstructed from the original data (red) but not on the randomly shuffled data (blue). The network properties converge to the same values when initializing SAM with the Seurat-reconstructed graph instead of a random graph (yellow). Dashed lines: metrics measured from the Seurat-reconstructed graphs.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48994-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.48994.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Quality control of library preparation and sequencing of the schistosome stem cells.</title><p>(<bold>a</bold>) Histograms of <italic>h2a</italic> qPCR measurements in 2.5- (left) and 3.5- (right) week post infection samples. (<bold>b</bold>) Scatter plot of gene count (&gt;2 TPM) vs. mapped read count of individual sequenced cells. Cells with low gene count or <italic>h2a</italic> expression are discarded and filtered from analysis (red) and the remaining cells are analyzed (blue). The number of final cells kept for analysis is specified on the top left corner of each plot.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48994-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.48994.005</object-id><label>Figure 1—figure supplement 2.</label><caption><title>A user interface for interactively exploring single-cell data using SAM.</title><p>An interactive Jupyter notebook interface provided by the SAM package facilitates convenient visualization of single cell data (upper left) and changing of SAM parameters using various control panels (upper right, and bottom). This interface allows clustering, subclustering, visualizing of gene expression, and many other applications.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48994-fig1-figsupp2-v2.tif"/></fig></fig-group><p><xref ref-type="fig" rid="fig1">Figure 1d</xref> shows that SAM iteratively improves a series of graph characteristics, including the network-average clustering coefficient (NACC), modularity, and Euclidean norm of the spatial dispersions (Materials and methods). The NACC and modularity quantify the degree of structure within the graphs – graphs with high NACC and modularity have regions of high density separated by regions of low density. The dispersion quantifies the spatial organization of gene expression – the higher the spatial dispersion the less uniformly distributed the gene expressions are along the graph. The final graph metrics are independent of initial conditions, which can start from a random graph or the output of an existing manifold reconstruction algorithm (e.g. Seurat, <xref ref-type="bibr" rid="bib27">Satija et al., 2015</xref>). Importantly, we verified that SAM does not artificially boost these metrics in data that lack inherent structure: when applying SAM to a randomly shuffled expression matrix, none of these metrics increased from the random initial conditions.</p></sec><sec id="s2-2"><title>SAM identifies novel subpopulations within schistosome stem cells</title><p>Visualizing the converged graph in two dimensions using Uniform Manifold Approximation and Projection (<xref ref-type="bibr" rid="bib4">Becht et al., 2019</xref>), we find that cells can be separated into three main populations, with Louvain clustering (<xref ref-type="bibr" rid="bib5">Blondel et al., 2008</xref>) further splitting one of these clusters into two subpopulations (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). In contrast, other commonly used dimensionality reduction methods, such as principal component analysis (PCA), Seurat (<xref ref-type="bibr" rid="bib27">Satija et al., 2015</xref>), and SIMLR (<xref ref-type="bibr" rid="bib40">Wang et al., 2017</xref>), failed to distinguish these cell populations (see Materials and methods for the selection of algorithms for comparison). Clustering the Seurat graph using Louvain clustering still results in a low-modularity partition and poor correspondence to the SAM cluster assignments.</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.48994.006</object-id><label>Figure 2.</label><caption><title>SAM identifies novel subpopulations within schistosome stem cells.</title><p>(<bold>a</bold>) UMAP projections of the manifolds reconstructed by SAM, PCA, and Seurat. SIMLR outputs its own 2D projection based on its constructed similarity matrix using a modified version of t-SNE. The schistosome cells are color-coded by the stem cell subpopulations μ, δ’, ε<sub>ɑ</sub>, and ε<sub>β</sub> determined by Louvain clustering. (<bold>b</bold>) UMAP projections with gene expressions of subpopulation-specific markers (<italic>eledh</italic>, <italic>nanos-2, cabp</italic>, <italic>astf</italic>, <italic>bhlh</italic>,) and a ubiquitous stem cell marker, <italic>ago2-1</italic>, overlaid. Insets: magnified views of the expressing populations. (<bold>c</bold>) FISH of <italic>cabp</italic> and EdU labeling of dividing stem cells in juvenile parasites at 2.5 weeks post-infection show that μ-cells (<italic>cabp</italic><sup>+</sup>EdU<sup>+</sup>, arrowheads) are close to the parasite surface and beneath a layer of post-mitotic <italic>cabp</italic><sup>+</sup> cells. Dashed outline: parasite surface. Right: magnified views of the boxed region. (<bold>d</bold>) FISH of <italic>cabp</italic> and a set of canonical muscle markers, <italic>troponin</italic>, <italic>myosin</italic>, <italic>tropomyosin</italic>, and <italic>collagen</italic>, shows colocalization in post-mitotic <italic>cabp</italic><sup>+</sup> cells. Images in (<bold>c–d</bold>) are single confocal slices. (<bold>e</bold>) FISH of <italic>astf</italic> and <italic>bhlh</italic> shows their orthogonal expression in adjacent EdU<sup>+</sup> cells (arrowheads). Bottom: magnified views of the boxed region. Image is a maximum intensity projection of a confocal stack with a thickness of 12 µm. (<bold>f</bold>) UMAP projection of stem cells isolated from juveniles at 2.5 and 3.5 weeks post-infection. Cell subpopulation assignments based on marker gene expressions are specified. Right: a magnified view to show the mapping of ε<sub>ɑ</sub>- and ε<sub>β</sub>-cells. (<bold>g</bold>) Standardized dispersions as calculated by Seurat plotted vs. the SAM gene weights. (<bold>h</bold>) SC3 AUROC scores plotted vs. the SAM gene weights. Error bars indicate the standard deviation of SC3 AUROC scores between trials using different chosen numbers of clusters. In (<bold>g</bold>) and (<bold>h</bold>), the top 20 genes specific to each subpopulation are colored according to the color scheme used in (<bold>a</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48994-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.48994.007</object-id><label>Figure 2—figure supplement 1.</label><caption><title>μ-cells express ubiquitous stem cell marker and population specific genes.</title><p>UMAP projections with gene expressions of (<bold>a</bold>) stem cell markers and (<bold>b</bold>) μ-cell-specific genes overlaid.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48994-fig2-figsupp1-v2.tif"/></fig></fig-group><p><xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> lists genes with high SAM weights, which includes most markers previously implicated to be enriched in subsets of schistosome stem cells (<xref ref-type="bibr" rid="bib39">Wang et al., 2013</xref>; <xref ref-type="bibr" rid="bib41">Wang et al., 2018</xref>). <xref ref-type="fig" rid="fig2">Figure 2b</xref> shows that the three populations include previously characterized δ′-cells, which specifically express an RNA binding protein <italic>nanos-2</italic> (Smp_051920), and ε-cells, which are marked by the expression of <italic>eledh</italic> (<italic>eled</italic>, Smp_041540) (<xref ref-type="bibr" rid="bib41">Wang et al., 2018</xref>). More importantly, SAM reveals a novel stem cell population, μ, comprising ~30% of all sequenced cells (μ denotes muscle progenitors as discussed below). While μ-cells express ubiquitous stem cells markers (e.g. <italic>ago2-1</italic>, Smp_179320; <italic>cyclin B</italic>, Smp_082490) and cell cycle regulators (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1a</xref>) (<xref ref-type="bibr" rid="bib6">Collins et al., 2013</xref>; <xref ref-type="bibr" rid="bib39">Wang et al., 2013</xref>; <xref ref-type="bibr" rid="bib41">Wang et al., 2018</xref>), they are also strongly enriched for a large set of genes, with a calcium binding protein (<italic>cabp</italic>, Smp_005350), an actin protein (Smp_161920), an annexin homolog (Smp_074140), a helix-loop-helix transcription factor (<italic>dhand</italic>, Smp_062490), and a phosphatase (<italic>dusp10</italic>, Smp_034500) as the most specific markers of this population in comparison to other stem cells (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1b</xref>).</p><p>Fluorescent in-situ hybridization (FISH) in conjunction with EdU labeling of dividing cells reveals that μ-cells (<italic>cabp</italic><sup>+</sup>EdU<sup>+</sup>) are distributed near the parasite surface right beneath a layer of post-mitotic differentiated cells that also express <italic>cabp</italic> (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). Close to the parasite surface, there are two major cell types intertwined in space: the skin-like tegumental cells and the body wall muscle cells. However, μ-cells express none of the recently identified markers in tegumental progenitors (<xref ref-type="bibr" rid="bib43">Wendt et al., 2018</xref>), suggesting that they may be associated with the muscle lineage. To test this idea, we performed double FISH experiments and observed in post-mitotic <italic>cabp<sup>+</sup></italic> cells the coexpression of a set of canonical muscle markers (<xref ref-type="bibr" rid="bib44">Witchley et al., 2013</xref>), including tropomyosin (Smp_031770), myosin (Smp_045220), troponin (Smp_018250), and collagen (Smp_170340) (<xref ref-type="fig" rid="fig2">Figure 2d</xref>). These results suggest that <italic>cabp</italic> may mark the parasite body wall muscles and μ-cells are likely muscle progenitors, although functional validation is required to support this observation. Why the juvenile parasites maintain such an active pool of muscle progenitors will be an important question for future studies.</p><p>In addition, SAM identifies two subpopulations among ε-cells: ε<sub>ɑ</sub>-cells that are highly enriched for an aschaete-scute transcription factor (<italic>astf</italic>, Smp_142120), and ε<sub>β</sub>-cells that abundantly express another basic helix-loop-helix protein (<italic>bhlh</italic>, Smp_087310) (<xref ref-type="fig" rid="fig2">Figure 2b</xref>, right panels). FISH experiments confirm these cells to be in close spatial proximity but with no coexpression of <italic>astf</italic> and <italic>bhlh</italic> (<xref ref-type="fig" rid="fig2">Figure 2e</xref>). Moreover, we observed with FISH that there are fewer <italic>astf<sup>+</sup></italic> cells in larger, more matured juveniles, suggesting ε<sub>ɑ</sub>-cells are a dynamic population during development. To verify this observation, we sequenced another ~370 stem cell from juveniles at a later developmental time point (3.5 weeks post infection). After correcting for batch effects in the combined 2.5- and 3.5- week datasets using the mutual nearest neighbors (MNN) algorithm (<xref ref-type="bibr" rid="bib13">Haghverdi et al., 2018</xref>), we find that δ′-, μ-, and ε<sub>β</sub>-cells remain relatively constant throughout both time points, whereas ε<sub>ɑ</sub>-cells comprise a significantly smaller fraction of the stem cells at 3.5 weeks (7%) compared to 21% at 2.5 weeks (<xref ref-type="fig" rid="fig2">Figure 2f</xref>). Taken together, these analyses demonstrate that SAM can identify experimentally validated stem cell populations that are previously too subtle to separate using other methods but are closely associated with the schistosome development.</p><p>The critical difference between SAM and other methods lies in how they select genes for manifold reconstruction. SAM prioritizes genes with variable expressions across neighborhoods of cells rather than individual cells as in other methods (e.g. Seurat). <xref ref-type="fig" rid="fig2">Figure 2g</xref> shows that genes with high standardized dispersion across individual cells often have low SAM weights, indicating that these highly variable genes (HVGs) are irrelevant to the topological relationships between cells. Other methods (e.g. SC3, <xref ref-type="bibr" rid="bib16">Kiselev et al., 2017</xref>) identify marker genes based on differential gene expression between cell clusters, but this approach suffers when cell cluster assignment is poor, especially when discrete cell groups are difficult to separate or absent. Indeed, SC3 failed in the default mode as it incorrectly predicted there to be only one cluster in the schistosome dataset. After we manually increased the number of clusters, SC3 could recover a few of the marker genes associated with only one (μ-cells, blue symbols in <xref ref-type="fig" rid="fig2">Figure 2h</xref>) of the populations detected by SAM. Furthermore, changing the number of clusters resulted in different solutions and large variability in SC3 scores for its top ranked genes.</p></sec><sec id="s2-3"><title>SAM outperforms other state-of-the-art methods in extensive quantitative benchmarking</title><p>Below, we assess the general applicability of SAM by benchmarking its performance against state-of-the-art scRNAseq analysis methods on a large collection of datasets. We focus on three methods, that is, Seurat, SIMLR, and SC3, as they are mostly unsupervised, have been broadly used, and were shown to outperform other methods through extensive benchmarking (<xref ref-type="bibr" rid="bib16">Kiselev et al., 2017</xref>; <xref ref-type="bibr" rid="bib40">Wang et al., 2017</xref>; <xref ref-type="bibr" rid="bib9">Duò et al., 2019</xref>; <xref ref-type="bibr" rid="bib1">Bahlo et al., 2018</xref>; <xref ref-type="bibr" rid="bib34">Tian et al., 2019</xref>). The criteria to select algorithms for comparison are explained in Materials and methods. We first benchmark against nine datasets (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>) that have high-confidence annotations to evaluate the accuracy of SAM in assigning cell clusters. Seven of these datasets are of pancreatic islet cells, as their subpopulations have been extensively characterized with known marker genes (<xref ref-type="bibr" rid="bib2">Baron et al., 2016</xref>). For five out of the nine datasets, SAM has the highest Adjusted Rand Index (ARI, a measure of clustering accuracy) (<xref ref-type="bibr" rid="bib15">Hubert and Arabie, 1985</xref>) with respect to the provided annotations (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). On the remaining four Baron datasets, SAM and Seurat perform equally well with near perfect clustering accuracy, whereas SC3 and SIMLR tend to overestimate and underestimate the number of clusters, respectively. <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref> lists the clustering scores for each method and for each annotated cell type in the benchmarking datasets (Materials and methods). SC3 and SIMLR struggle to cleanly cluster cell types that constitute large fractions of the data, such as the alpha and beta cells in the pancreatic datasets. While Seurat performs well on the Baron datasets, it fails to identify alpha cells in the Wang and Muraro datasets when run with default parameters, although its performance is improved after optimizing parameters to maximize its clustering accuracy (Materials and methods). We note that this parameter optimization is impossible to perform on an experimental dataset with no available ground truth labels. Nevertheless, even with optimal parameters, Seurat has accuracy lower than or equal to that of SAM on all datasets.</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.48994.008</object-id><label>Figure 3.</label><caption><title>SAM improves clustering accuracy and runtime performance.</title><p>(<bold>a</bold>) Accuracy of cluster assignment quantified by adjusted rand index (ARI) on nine annotated datasets (left). Right: differences between the number of clusters found by each method (<bold>N</bold>) and the number of annotated clusters (N<sub>TRUE</sub>). Smaller differences indicate more accurate clustering. Seurat* denotes Seurat analysis using parameters that maximize ARI. (<bold>b</bold>) RMSE of gene weights output by SAM averaged across ten replicate runs with random initial conditions for 56 datasets (blue) and simulated datasets with no intrinsic structure (green, Materials and methods). (<bold>c</bold>) Runtime of SAM, SC3, SIMLR, and Seurat as a function of the number of cells in each dataset. SC3 and SIMLR were not run on datasets with &gt;3000 cells as the run time exceeds 20 min.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48994-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.48994.009</object-id><label>Figure 3—figure supplement 1.</label><caption><title>SAM converges to a stable solution independent of random initial conditions and is robust to the number of nearest neighbors and choice of distance metric.</title><p>(<bold>a</bold>) RMSE of gene weights between adjacent iterations within a run, averaged across ten replicate runs for all datasets. (<bold>b–c</bold>) Average ARI scores for the nine annotated benchmarking datasets when varying (<bold>b</bold>) the number of nearest neighbors, <italic>k</italic>, from 10 to 30 or (<bold>c</bold>) the choice of distance metric (Euclidean or Pearson correlation). Error bars indicate standard deviations of ARI scores across the different values of <italic>k</italic> and distance metrics. The errors for data with no error bars are too small to be seen.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48994-fig3-figsupp1-v2.tif"/></fig></fig-group><p>SAM converges to the same set of gene weights for all datasets analyzed (<xref ref-type="fig" rid="fig3">Figure 3b</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1a</xref>) and its performance is robust to the choice of parameters and random initial conditions (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1b–c</xref>). In contrast, applying SAM to randomly generated datasets (Materials and methods), the resulting gene weights are highly dissimilar across random initial conditions (<xref ref-type="fig" rid="fig3">Figure 3b</xref>), indicating that SAM does not converge to a stable solution on datasets with no intrinsic structure. Finally, the scalability of SAM is similar to that of Seurat, capable of analyzing hundreds of thousands of cells in minutes (<xref ref-type="fig" rid="fig3">Figure 3c</xref>), whereas SIMLR and SC3 are orders of magnitudes slower and thus excluded from further benchmarking which requires the analysis of many more datasets.</p><p>Because the nine benchmarking datasets are all comprised of clearly distinguishable cell types, they may not represent the performance of methods on other datasets that contain cell populations that are only subtly different. To identify such datasets, we introduce a network sensitivity metric that quantifies the changes in the cell-to-cell distances when randomly selecting a subset of features from the gene expression matrices (Materials and methods). High network sensitivity indicates that changes to the selected features strongly alters the resulting topological network. Networks that are robust to the selected features correspond to datasets that have many redundant signals or genes corroborating the network structure. In the datasets we compiled (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>), all broadly used benchmarking datasets have lower sensitivities whereas the schistosome dataset, which we have shown to be challenging to analyze, has the highest sensitivity (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). The fraction of genes with large SAM weights (&gt;0.5) is negatively correlated with the network sensitivity, suggesting that the biologically relevant variation in datasets with high sensitivity is captured by relatively fewer genes (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). Analyzing all 56 datasets, we found that SAM improves the clustering, modularity, and spatial organization of gene expression across the graph in comparison to Seurat as the datasets become increasingly sensitive (<xref ref-type="fig" rid="fig4">Figure 4c</xref>).</p><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.48994.010</object-id><label>Figure 4.</label><caption><title>SAM improves the analysis of datasets with varying network sensitivities.</title><p>(<bold>a</bold>) Network sensitivity of all 56 datasets ranked in descending order. Blue: the nine benchmarking datasets used in <xref ref-type="fig" rid="fig3">Figure 3a</xref>. Sensitivity measures the robustness of a dataset to changes in which features are selected (Materials and methods). (<bold>b</bold>) The network sensitivity plotted against the fraction of genes with SAM weight greater than 0.5 (in log scale) with Spearman correlation coefficient specified in the upper-right corner. (<bold>c</bold>) Fold improvement of SAM over Seurat for NACC, modularity, and spatial dispersion with respect to sensitivity for all 56 datasets. These ratios are linearly correlated with network sensitivity with Pearson correlations (r<sup>2</sup>) specified in the upper-left corner of each plot.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48994-fig4-v2.tif"/></fig><p>Evaluating the clustering accuracy for the highly sensitive datasets, however, is challenging, because many of them have incomplete or nonexistent cell type annotations. Therefore, we use the nine well-annotated benchmarking datasets to simulate data across a wide spectrum of sensitivities. For this, we corrupt the data by randomly permuting gradually increasing fractions of the gene expressions. As illustrated by the Darmanis dataset (<xref ref-type="bibr" rid="bib8">Darmanis et al., 2015</xref>), <xref ref-type="fig" rid="fig5">Figure 5a</xref> shows that the sensitivity increases along with the corruption. Below ~50% corruption, SAM’s ARI scores only marginally decrease as the corruption (and thereby sensitivity) increases, whereas Seurat’s performance rapidly deteriorates, even when run with optimal parameters. A similar contrast was observed between SAM and Seurat with the NACC, modularity, and spatial dispersion. Importantly, passing the genes with high SAM weights into Seurat rescued its performance across all metrics, indicating that SAM is able to consistently capture the genes relevant to the underlying structure of the data even with increasing levels of noise and illustrating the robustness of its feature selection strategy compared to the HVG filtering approach used by Seurat. These observations generalize to all nine benchmarking datasets, quantified by the area under the curves (AUC) of the metrics with respect to corruption (<xref ref-type="fig" rid="fig5">Figure 5b</xref>).</p><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.48994.011</object-id><label>Figure 5.</label><caption><title>Robust feature selection improves cell clustering and manifold reconstruction.</title><p>(<bold>a</bold>) Network sensitivity, ARI, NACC, modularity, and spatial dispersion with respect to corruption of the Darmanis dataset, in which we randomly permute fractions of the data ranging from 0 to 100% of the total number of elements (Materials and methods). Performance is compared between SAM (blue), Seurat (red), Seurat with optimal parameters (black), and Seurat rescued with the top-ranked SAM genes (indigo). Error bars indicate the standard deviations across 10 replicate runs. The errors for points with no bars are too small to be seen. (<bold>b</bold>) Comparison of the area under curve (AUC) of the metrics in (<bold>a</bold>) with respect to data corruption for all nine datasets. Error bars indicate the standard deviations across 10 replicate runs. The errors for data with no error bars are too small to be seen.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48994-fig5-v2.tif"/></fig></sec><sec id="s2-4"><title>SAM clusters macrophages by their activation dynamics with proper temporal ordering</title><p>We next highlight another dataset to show that SAM can recover biologically meaningful information that other methods fail to capture. We chose this example, which contains ~600 macrophages treated with lipopolysaccharide (LPS) when individually trapped in microfluidic channels (<xref ref-type="bibr" rid="bib17">Lane et al., 2017</xref>), because it has high network sensitivity (<xref ref-type="fig" rid="fig4">Figure 4a</xref>) and has accompanying single cell functional data of macrophage activation dynamics that may help to validate the results of our analysis. Applied to this dataset, SAM initially identifies two clusters (<xref ref-type="fig" rid="fig6">Figure 6a</xref>, top). Performing gene set enrichment analysis (GSEA, <xref ref-type="bibr" rid="bib31">Subramanian et al., 2005</xref>), we find that genes with high SAM weights are dominated by cell cycle-related processes, with one of the clusters heavily enriched for cell cycle genes (e.g. Top2a, Mki67, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1a</xref>). After removing the cell cycle effects (Materials and methods), SAM identifies two different clusters in which cells are properly ordered by the time since LPS induction, with the highly weighted genes being primarily involved in immune signaling (<xref ref-type="fig" rid="fig6">Figure 6a</xref>, bottom). These observations demonstrate that, in conjunction with GSEA, the quantitative gene weights output by SAM can be used to infer the biological pathways that drive the clustering of cells.</p><fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.48994.012</object-id><label>Figure 6.</label><caption><title>SAM captures the cellular activation dynamics in a stimulated macrophage dataset.</title><p>(<bold>a</bold>) GSEA analysis (left) and UMAP projections (right) of the activated macrophages before (top) and after (bottom) removing cell cycle effects. Teal: significantly enriched gene sets determined by the significance threshold of 0.25 for the False Discovery Rate (FDR, dashed lines). Bottom: the two clusters are denoted as MT and M with colors representing the time since LPS induction. Arrows: evolution of time. (<bold>b</bold>) TNFα is enriched in the MT cluster. (<bold>c</bold>) Diagram of NF-κB activation in response to LPS stimulation via the Myd88 and TRIF signaling pathways. (<bold>d</bold>) Log<sub>2</sub> fold changes of the average expressions of selected inflammatory genes in the MT cluster vs. the M cluster. All genes are significantly differentially expressed between the two clusters according to the Welch’s two-sample t-test (<inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>). (<bold>e</bold>) Representative traces for transient (left) and prolonged (right) NF-κB activation (Materials and methods). (<bold>f</bold>) Cells with prolonged NF-κB response (denoted as P) are primarily in the MT population. (<bold>g</bold>) Seurat and SIMLR projections show that they fail to order the cells by time since LPS induction and do not identify cell clusters representing the different modes of NF-κB activation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48994-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.48994.013</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Cluster-specific marker genes before and after removing cell cycle effects.</title><p>UMAP projections with marker genes specific to the dividing cells (<bold>a</bold>) and the MT cluster (<bold>b</bold>) overlaid.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48994-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.48994.014</object-id><label>Figure 6—figure supplement 2.</label><caption><title>SAM groups cells based on NF-κB activation dynamics while other methods cannot.</title><p>(<bold>a</bold>) UMAP projection of the macrophage cells after the removal of cell cycle effects. Cells with prolonged NF-κB dynamics are highlighted in red. (<bold>b</bold>) UMAP and t-SNE projections for Seurat and SIMLR, respectively, after the removal of cell cycle effects. Cells with prolonged NF-κB dynamics are highlighted in red. (<bold>c</bold>) UMAP projections for Seurat and SIMLR with three MT-specific marker gene expressions overlaid.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48994-fig6-figsupp2-v2.tif"/></fig></fig-group><p>One of the two clusters is enriched for TNFα expression (<xref ref-type="fig" rid="fig6">Figure 6b</xref>). It is known that LPS activates two independent pathways, one through the innate immune signal transduction adaptor (Myd88) and the other through the TIR-domain-containing adapter-inducing interferon-β (TRIF) (<xref ref-type="bibr" rid="bib18">Lee et al., 2009</xref>). While the Myd88 pathway directly activates NF-κB, the TRIF pathway first induces the secretion of TNFα, which subsequently binds to its receptor, TNFR, to prolong the activation of NF-κB (<xref ref-type="fig" rid="fig6">Figure 6c</xref>). <xref ref-type="fig" rid="fig6">Figure 6d</xref> and <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1b</xref> show examples of genes that are highly enriched with TNFα, a number of which are inflammatory factors known to accumulate due to prolonged NF-κB activation (<xref ref-type="bibr" rid="bib17">Lane et al., 2017</xref>). These results suggest that SAM grouped the cells based on their activated signaling pathways: one cluster is activated through both Myd88 and TRIF pathways (MT), while the other is only activated through Myd88 (M).</p><p>To further verify that the separation between the MT and M clusters truly reflects the dichotomy in cellular response to LPS induction, we noted that this dataset combines scRNAseq with live-cell imaging of NF-κB activity in single cells. This allows us to directly test if the MT and M clusters correspond to different signaling dynamics (Materials and methods). We found that most of the cells with prolonged NF-κB response (i.e. cells showing broad peaks of NF-κB activation in time) are in fact in the MT cluster (<xref ref-type="fig" rid="fig6">Figure 6e–f</xref>, and <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2a</xref>), consistent with the expectation that TNFα signaling prolongs NF-κB activation. Although our interpretation of the data matches that provided in the original study, we were able to analyze the dataset with almost no a priori knowledge. In contrast, the original study required extensive manual curation, analyzed only a subset of the dataset, and could not group cells by their NF-κB activation dynamics based on the gene expression data alone. Similarly, Seurat and SIMLR were unable to order the cells by the time since LPS induction or group cells based on their activation dynamics after removing the cell cycle effects (<xref ref-type="fig" rid="fig6">Figure 6g</xref>, and <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2b–c</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Here, we introduced a scRNAseq analysis method, SAM, which uses an unsupervised, robust, and iterative strategy for feature selection and manifold reconstruction. As demonstrated by our analysis of the schistosome stem cells and activated macrophages, SAM can capture biology that is undetectable by other methods. While SAM has consistently higher clustering accuracy than other state-of-the-art methods on datasets containing clearly distinct cell types, its advantages are especially apparent on datasets in which cell states or types are only distinguishable through subtle differences in gene expression.</p><p>The strength of SAM lies in the integration of three algorithmic components: spatial dispersion to measure feature relevance, soft feature selection, and the iterative scheme. By averaging the gene expression of a cell with that of its neighbors, the spatial dispersion quantifies the variation across neighborhoods of cells rather than individual cells. Genes with high spatial dispersion are more likely to be biologically relevant as they are capable of separating cells into distinct topological locations. Soft feature selection includes all genes and weights their contribution to the manifold reconstruction by their spatial dispersions. This mitigates the shortcoming of existing approaches in which the selection of features is a binary decision: genes are either included or not depending on arbitrarily chosen thresholds.</p><p>The conceptual challenge here is that calculating the gene weights requires the manifold, but reconstructing the manifold requires the gene weights for feature selection. SAM thus uses an iterative strategy to converge onto both the gene weights and the corresponding graph topology from a random initial graph. Each successive iteration refines the gene weights and network structure until the algorithm converges. Empirically, for all datasets analyzed we have shown that SAM converges onto a stable solution and is robust to the random initial conditions. Practically, it is possible to initialize SAM using the graph output of another method such as Seurat (<xref ref-type="fig" rid="fig1">Figure 1d</xref>), but using random initial conditions avoids potential biases in the analysis and enables the evaluation of the stability of SAM.</p><p>To demonstrate the strengths of SAM in practice, we analyzed the schistosome stem cells and identified novel stem cell populations that were validated by FISH experiments (<xref ref-type="fig" rid="fig2">Figure 2</xref>). In the analysis of activated macrophages, we showed that SAM can simultaneously order cells by the time since LPS induction and group cells according to their respective activated signaling pathways. We have validated this result using the live-cell imaging data presented in the original study (<xref ref-type="fig" rid="fig6">Figure 6</xref>).</p><p>We expect that the application of SAM is not limited to feature selection, cell clustering, and manifold reconstruction; it can be readily integrated with existing analytical pipelines as its gene weights and reconstructed manifolds can be used in downstream analyses. For example, we have shown how the genes ranked by their SAM weights can be used as input to GSEA to determine the biological processes enriched among the highly weighted genes (<xref ref-type="fig" rid="fig6">Figure 6</xref>), thus directly testing if the weights reflect the biological relevance of genes. Additionally, the manifold reconstructed by SAM can be used as input to pseudotemporal ordering algorithms (<xref ref-type="bibr" rid="bib29">Setty et al., 2016</xref>; <xref ref-type="bibr" rid="bib35">Trapnell et al., 2014</xref>).</p><p>Beyond the two example case studies, we have rigorously evaluated SAM on a total of 56 datasets. While previous studies benchmarked on datasets with clearly defined cell populations, we defined a network sensitivity measure to rank the datasets based on the inherent difficulty of their analysis (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Using these datasets, we showed that SAM consistently outperforms other methods in terms of both cell clustering accuracy measured by ground truth annotations, and manifold reconstruction measured by quantitative graph characteristics. These improvements can be attributed to the robust selection of features relevant for cell clustering and manifold reconstruction even in the presence of significant amounts of random noise, as shown in the corruption tests (<xref ref-type="fig" rid="fig5">Figure 5</xref>). Overall, the network sensitivity and quantitative benchmarking metrics should help in characterizing the performance of future scRNAseq analysis methods across a wider variety of datasets.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th>Reagent type <break/>(species) or <break/>resource</th><th>Designation</th><th>Source or reference</th><th>Identifiers</th><th>Additional <break/>information</th></tr></thead><tbody><tr><td>Commercial assay or kit</td><td>SsoAdvanced Universal SYBR Green Supermix</td><td>Biorad</td><td>1725270</td><td>qPCR</td></tr><tr><td>Commercial assay or kit</td><td>Quant-iT PicoGreen dsDNA Assay Kit</td><td>Thermo-Fisher</td><td>P7589</td><td>cDNA quantification</td></tr><tr><td>Peptide, recombinant protein</td><td>RNase Inhibitor</td><td>Takara Bio</td><td>2313B</td><td>RT mix</td></tr><tr><td>Chemical compound, drug</td><td>dNTP Set 100 mM solutions</td><td>Thermo-Fisher</td><td>R0181</td><td>RT mix and cDNA pre-amplification</td></tr><tr><td>Sequence-based reagents</td><td>100 µM oligo-dT</td><td>IDT</td><td/><td>AAGCAGTGGTATCAACGCAGAGTACT(30)VN</td></tr><tr><td>Sequence-based reagents</td><td>100 µM TSO</td><td>Exiqon</td><td/><td>AAGCAGTGGTATCAACGCAGAGTACATrGrG+G</td></tr><tr><td>Commercial assay or kit</td><td>ERCC RNA Spike-In Mix</td><td>Thermo-Fisher</td><td>4456740</td><td>RT mix</td></tr><tr><td>Chemical compound, drug</td><td>10% Triton X-100</td><td>Thermo-Fisher</td><td>28314</td><td>RT mix</td></tr><tr><td>Peptide,recombinant protein</td><td>SMARTscribe reverse transcriptase</td><td>Takara Bio</td><td>639538</td><td>RT mix</td></tr><tr><td>Chemical compound, drug</td><td>100 mM DTT</td><td>Promega</td><td>P1171</td><td>RT mix</td></tr><tr><td>Chemical compound, drug</td><td>5 M Betaine</td><td>Thermo-Fisher</td><td>B0300-1VL</td><td>RT mix</td></tr><tr><td>Commercial assay or kit</td><td>Kapa Hotstart Ready Mix</td><td>Roche</td><td>KK2602</td><td>cDNA pre-amplification</td></tr><tr><td>Sequence-based reagents</td><td>100 μM IS_PCR primer</td><td>IDT</td><td/><td>AAGCAGTGGTATCAACGCAGAGT</td></tr><tr><td>Peptide, recombinant protein</td><td>lambda exonuclease</td><td>NEB</td><td>M0262S</td><td>Depletion of primer dimers</td></tr><tr><td>Commercial assay or kit</td><td>Ampure purification beads</td><td>NEB</td><td>M0262S</td><td>DNA purification</td></tr><tr><td>Commercial assay or kit</td><td>TG Nextera XT DNA Sample Preparation Kit</td><td>Illumina</td><td>FC-131–1096</td><td>Library preparation</td></tr><tr><td>Commercial assay or kit</td><td>TG Nextera XT Index Kit v2 Set A (96 Indices, 384 Samples)</td><td>Illumina</td><td>TG-131–2001</td><td>Library preparation</td></tr><tr><td>Strain, strain background (<italic>S. mansoni)</italic></td><td>NMRI</td><td>BEI Resources</td><td>NR-21963</td><td/></tr><tr><td>Antibody</td><td>Anti-Digoxigenin-POD, Fab fragments from sheep</td><td>Roche</td><td>11207733910</td><td>(1:1,000); FISH <break/>experiments</td></tr><tr><td>Antibody</td><td>Anti-Fluorescein-POD, Fab fragments from sheep</td><td>Roche</td><td>11426346910</td><td>(1:1,500); FISH experiments</td></tr><tr><td>Peptide, recombinant DNA reagents</td><td>Plasmid-pJC53.2</td><td>Addgene</td><td>26536</td><td>Cloning vector</td></tr><tr><td>Chemical compound, drug</td><td>Cy5-azide</td><td>Click Chemistry Tools</td><td>AZ118</td><td>EdU detection</td></tr><tr><td>Chemical compound, drug</td><td>5-ethynyl-2-deoxyuridine (EdU)</td><td>Invitrogen</td><td>A10044</td><td/></tr><tr><td>Chemical compound, drug</td><td>Vybrant DyeCycle Violet (DCV)</td><td>Invitrogen</td><td>V35003</td><td>FACS</td></tr><tr><td>Chemical compound, drug</td><td>TOTO-3</td><td>Invitrogen</td><td>T3604</td><td>FACS</td></tr></tbody></table></table-wrap><sec id="s4-1"><title>Code and data availability</title><p>The SAM source code and tutorials can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/atarashansky/self-assembling-manifold">https://github.com/atarashansky/self-assembling-manifold </ext-link>(<xref ref-type="bibr" rid="bib32">Tarashansky, 2019</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/self-assembling-manifold">https://github.com/elifesciences-publications/self-assembling-manifold</ext-link>). We have included a number of tutorials describing in detail the various functions, parameters, attributes, and data structures of the SAM package, and provided the documentation (docstrings) for all functions available to users. In addition, we have developed an interactive user interface that facilitates the convenient exploration of single-cell data and SAM parameters (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). A Jupyter notebook tutorial explaining how to use the interface is provided as well. The schistosome stem cell scRNAseq data generated in this study were obtained in two sequencing batches and are available through the Gene Expression Omnibus (GEO) under accession number GSE116920.</p></sec><sec id="s4-2"><title>Data processing</title><p><xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref> summarizes all datasets used in this study as well as the methods used to convert raw sequence read counts to gene expression, such as TPM (transcripts per million), CPM (counts per million), RPKM (reads per kilobase per million), or FPKM (fragments per kilobase per million). Datasets with asterisks next to their accession numbers are sourced from the <italic>conquer</italic> database (<xref ref-type="bibr" rid="bib30">Soneson and Robinson, 2018</xref>). The nine benchmarking datasets used with high-confidence annotation labels are marked by crosses. Gene expression is measured in log space with a pseudocount of 1 (e.g. log<sub>2</sub>(TPM+1)). Genes expressed (log<sub>2</sub>(TPM+1)&gt;1) in fewer than 1% or more than 99% of cells are excluded from downstream analysis as these genes lack statistical power. To reduce the influence of technical noise near the molecular detection limit, we set gene expression to zero when log<sub>2</sub>(TPM+1)&lt;1. We denote the resulting expression matrix as <inline-formula><mml:math id="inf9"><mml:mi>E</mml:mi></mml:math></inline-formula>.</p><p>In the SAM algorithm (see below), we either standardize the gene expression matrix <inline-formula><mml:math id="inf10"><mml:mi>E</mml:mi></mml:math></inline-formula> to have zero mean and unit variance per gene (which corrects for differences in distributions between genes) or normalize the expressions such that each cell has unit Euclidean (L2) norm (which prevents cells with large variances in gene expressions from dominating downstream analyses) prior to dimensionality reduction. In the below section, we denote the standardized or normalized expression matrix as <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Empirically, we have found that standardization performs well with large, sparse datasets that are expected to contain many subpopulations, whereas L2-normalization is more suitable for smaller datasets with fewer subpopulations. This is likely due to the fact that standardization amplifies the relative expression of genes specific to small populations in large datasets, thereby making them easier to identify. In contrast, standardization decreases the relative expression of genes specific to populations comprising larger fractions of the data, as is typically the case in smaller datasets, thereby making distinct populations more difficult to identify. <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref> documents the preprocessing step used for each dataset.</p></sec><sec id="s4-3"><title>The SAM algorithm</title><p>After first generating a random kNN adjacency matrix, the SAM algorithm goes through three steps that are repeated until convergence.</p><sec id="s4-3-1"><title>Calculate the gene weights</title><p>First, the expression of each cell is averaged with its k-nearest neighbors:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mfrac><mml:mi>N</mml:mi><mml:mi>E</mml:mi></mml:math></disp-formula>where <inline-formula><mml:math id="inf12"><mml:mi>N</mml:mi></mml:math></inline-formula> is the directed adjacency matrix for the kNN graph, and <inline-formula><mml:math id="inf13"><mml:mi>E</mml:mi></mml:math></inline-formula> is the <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> log-transformed gene expression matrix with rows as cells and columns as genes. Here, we do not use <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as it may contain negative values, for which dispersion is ill-defined. For each gene <italic>i</italic>, SAM computes the Fano factor from the averaged expressions <inline-formula><mml:math id="inf16"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></disp-formula>where <inline-formula><mml:math id="inf17"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> is the mean and <inline-formula><mml:math id="inf18"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> is the variance. We use the Fano factor to measure the gene expression variance relative to the mean in order to account for the fact that genes with high mean expressions tend to have higher variability. Computing the Fano factors based on the kNN-averaged expressions links gene dispersion to the cellular topological structure: genes that have highly variable expressions among individual cells but are homogeneously distributed across the topological representation should have small dispersions. <inline-formula><mml:math id="inf19"><mml:mi>k</mml:mi></mml:math></inline-formula>, set by default to 20, determines the topological length scale over which variations in gene expression are quantified. <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1b</xref> shows that the downstream analysis is robust to the specific choice of <inline-formula><mml:math id="inf20"><mml:mi>k</mml:mi></mml:math></inline-formula>. Additionally, the choice of <inline-formula><mml:math id="inf21"><mml:mi>k</mml:mi></mml:math></inline-formula> does not significantly affect runtime complexity or scalability.</p><p>To compute the gene weights, we normalize the Fano factors to be between 0 and 1. First, we saturate the Fano factors to ensure that genes with large spatial dispersions do not skew the distribution of weights: <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf23"><mml:mi>z</mml:mi></mml:math></inline-formula> is the mean of the largest <inline-formula><mml:math id="inf24"><mml:mi>N</mml:mi></mml:math></inline-formula> dispersions (<inline-formula><mml:math id="inf25"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:math></inline-formula> by default). We then calculate the gene weights as:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula></p></sec><sec id="s4-3-2"><title>Rescale the expression matrix</title><p>SAM multiplies the gene weights into the preprocessed expression matrix:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:msqrt><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the standardized or normalized expression matrix and <inline-formula><mml:math id="inf27"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a diagonal matrix with <inline-formula><mml:math id="inf28"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> along the diagonal. This matrix multiplication linearly rescales the gene expression variances and gene-gene covariances by their respective weights, attenuating the influence of genes with low dispersions across neighborhoods.</p></sec><sec id="s4-3-3"><title>Updating the kNN graph</title><p>To compute pairwise cell-cell distances, we perform PCA on the rescaled expression matrix <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The variance-scaling operation in <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> improves the robustness of PCA to variations in genes that are uniformly distributed along the current graph (i.e. genes with low weights). Furthermore, this weighting strategy eliminates the typical requirement of selecting a subset of HVGs to feed into PCA, which often relies on arbitrary thresholds and heuristics. To perform PCA, we first mean center <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to form <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mi>e</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <italic>e</italic> is a column vector of ones with dimension <italic>n</italic>. We then compute the Singular Value Decomposition (SVD) of <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:mi>S</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula>with the principal components defined as<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:mi>S</mml:mi></mml:math></disp-formula></p><p>The eigenvalues corresponding to the eigendecomposition of the gene-gene covariance matrix are defined in terms of the singular values as<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:math></disp-formula>where <italic>S</italic> is a diagonal matrix with singular values along the diagonal. Using the PC matrix <inline-formula><mml:math id="inf33"><mml:mi>P</mml:mi></mml:math></inline-formula>, SAM computes a pairwise cell-cell distance matrix. While typical dimension reduction approaches include a subset of the PCs, which is often subjective or requires computationally intensive maximum-likelihood approaches, we include all PCs and scale their variances by their corresponding eigenvalues:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:msqrt><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>As a result, PCs with small eigenvalues are weighted less in the calculation of the distance between cells <italic>i</italic> and <italic>j</italic>, <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the Pearson correlation or Euclidean distance between rows <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in the PC matrix. Pearson correlation distance is used by default, although <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1c</xref> shows that SAM is robust to the choice of distance metric. Using the distances to define the <italic>k</italic>-nearest neighbors for each cell, SAM updates the kNN matrix and repeats steps 1-3. The algorithm continues until convergence, defined as when the RMSE between gene weights in adjacent iterations converges:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf38"><mml:mi>m</mml:mi></mml:math></inline-formula> is the number of genes and <inline-formula><mml:math id="inf39"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the weight for gene <inline-formula><mml:math id="inf40"><mml:mi>j</mml:mi></mml:math></inline-formula> at iteration <inline-formula><mml:math id="inf41"><mml:mi>i</mml:mi></mml:math></inline-formula>.</p></sec></sec><sec id="s4-4"><title>Visualization</title><p>To visualize the topological structure identified by SAM, we feed the final weighted PCA matrix, <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, into UMAP (<xref ref-type="bibr" rid="bib4">Becht et al., 2019</xref>) using Pearson correlation as the distance metric by default. To directly visualize the final kNN adjacency matrix (<xref ref-type="fig" rid="fig1">Figure 1c</xref>), we used the Fruchterman-Reingold force-directed layout algorithm and drawing tools implemented in the Python package <italic>graph-tool</italic> (<xref ref-type="bibr" rid="bib23">Peixoto, 2017</xref>).</p></sec><sec id="s4-5"><title>Choosing the benchmarking methods</title><p>We used three main criteria for choosing the benchmarking scRNAseq analysis methods: they should be widely used, have done extensive benchmarking against other methods, and be mostly unsupervised. We found on Web of Science that among the highest cited scRNAseq analysis tools in 2017–2018 are Seurat, SC3, SIMLR, Reference Component Analysis (<xref ref-type="bibr" rid="bib19">Li et al., 2017</xref>), Monocle (<xref ref-type="bibr" rid="bib35">Trapnell et al., 2014</xref>; <xref ref-type="bibr" rid="bib26">Qiu et al., 2017</xref>), zero-inflated factor analysis (ZIFA, <xref ref-type="bibr" rid="bib25">Pierson and Yau, 2015</xref>), and Wishbone (<xref ref-type="bibr" rid="bib29">Setty et al., 2016</xref>), of which we chose Seurat, SC3, and SIMLR.</p><p>SC3 is a consensus clustering algorithm that has done rigorous benchmarking against other methods such as SINCERA (<xref ref-type="bibr" rid="bib12">Guo et al., 2015</xref>), SNN-Cliq (<xref ref-type="bibr" rid="bib46">Xu and Su, 2015</xref>) and pcaReduce (<xref ref-type="bibr" rid="bib47">Žurauskienė and Yau, 2016</xref>) on 12 datasets with ground truth annotation labels. SIMLR, a dimensionality reduction and clustering algorithm, evaluated its clustering performance on four annotated datasets against eight other dimensionality reduction methods, including PCA, Factor Analysis (FA), t-SNE, multidimensional scaling (MDS), and ZIFA. Both methods have demonstrated the highest clustering accuracy across most of the tested datasets. Additionally, as both methods have built-in functions to estimate the number of clusters present within the data, they are largely unsupervised. We also selected Seurat as one of the benchmarking methods, because it is arguably the most widely used tool for dimensionality reduction and clustering of scRNAseq data and has performed well in rigorous benchmarking studies against various methods including SC3, SIMLR, RCA, and pcaReduce (<xref ref-type="bibr" rid="bib9">Duò et al., 2019</xref>; <xref ref-type="bibr" rid="bib1">Bahlo et al., 2018</xref>).</p><p>We did not select Reference Component Analysis as it is primarily designed for cases in which an atlas of bulk, cell-type specific, reference transcriptomes is present. Additionally, we did not benchmark against Monocle and Wishbone, because they are pseudotime analysis methods and are meant for datasets with continuous branching processes such as cell differentiation. However, it is important to note that SAM can be used for dimensionality reduction upstream of pseudotime algorithms for such datasets. Finally, we did not benchmark against ZIFA as it has already been shown to have lower clustering accuracy than SIMLR.</p><p>In addition to measuring clustering accuracy, we also introduce the NACC, modularity, and spatial dispersion metrics to quantify both the degree of structure and spatial organization of gene expression within a nearest-neighbor graph. These metrics can only be applied to dimensionality reduction methods that construct a graph representation of the dataset. Consequently, we cannot use these metrics to evaluate SC3.</p><p>Although it does technically produce a graph representation of the data, SIMLR should be considered as a hybrid between a clustering and dimensionality reduction method. Because its similarity graph is assumed to have a block structure where the number of blocks is equal to the prespecified number of clusters, the resulting nearest-neighbor graph will, by construction, tend to have a higher degree of structure and therefore artificially inflated NACC and modularity.</p><p>Furthermore, the poor scalability of SC3 and SIMLR makes them difficult to run for many trials across a large number of datasets. Although SIMLR, in particular, does provide an alternative algorithm that can scale to run on much larger datasets, this alternative version has not been extensively benchmarked. Even so, despite the improved speed of this large-scale implementation, estimating the number of clusters using its built-in function remains a significant computational and memory bottleneck. For example, when applied to datasets with ~10,000 cells, neither implementations of SIMLR could estimate the number of clusters within 2 hr. As a result, we cannot run SIMLR in an unsupervised manner on datasets significantly larger than ~3000 cells.</p><p>As there are few practical alternatives for manifold reconstruction that have been extensively benchmarked and widely used, we primarily compare SAM to Seurat in tests involving the unsupervised, graph-based metrics to highlight the key, advantageous characteristics of SAM as a manifold reconstruction and feature selection algorithm when applied to datasets with varying sensitivities (<xref ref-type="fig" rid="fig4">Figure 4a–c</xref>).</p></sec><sec id="s4-6"><title>Benchmarking</title><p>To generate the convergence curves in <xref ref-type="fig" rid="fig1">Figure 1b</xref>, we computed the root mean square error (RMSE) of the gene weights averaged across all pairwise comparisons of ten replicates starting from randomly generated initial graphs. In <xref ref-type="fig" rid="fig3">Figure 3b</xref>, we extend this analysis to all datasets analyzed and report the final error. We use randomly generated datasets of varying sizes (ranging from 200 to 5000 cells) as a negative control to show that SAM does not converge onto the same solution across initial conditions when the data has no intrinsic structure. These datasets were randomly generated by sampling gene expressions from a Poisson distribution with mean drawn from a gamma distribution. To generate the convergence curves in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1a</xref>, we computed the RMSEs, which are ensemble-averaged across ten replicate runs, between the gene weights in adjacent iterations. We compute the adjacency error between kNN adjacency matrices <inline-formula><mml:math id="inf43"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf44"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1b</xref>) as<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mi/><mml:mo>-</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>e</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula>where <inline-formula><mml:math id="inf45"><mml:mi>e</mml:mi></mml:math></inline-formula> is a column vector of ones. This simply measures the fraction of total edges that are different between the two graphs.</p><p>To compute the standardized dispersion factors in <xref ref-type="fig" rid="fig2">Figure 2g</xref>, we used Seurat’s methodology implemented in Scanpy (<xref ref-type="bibr" rid="bib45">Wolf et al., 2018</xref>), which groups the genes into 20 bins based on their mean expression values and computes the z-score of each gene’s Fano factor with respect to the mean and standard deviation of all Fano factors in its corresponding bin. To generate the AUROC scores in <xref ref-type="fig" rid="fig2">Figure 2h</xref>, which quantify the likelihood of genes being cluster-specific markers, we ran SC3 on the schistosome data with the number of clusters ranging from 2 to 12. We used the AUROC scores corresponding to four clusters for the points on the scatter plot and the standard deviations of the scores across all tested numbers of clusters for the error bars.</p><p>We evaluated each analysis method on nine gold standard datasets (<xref ref-type="fig" rid="fig3">Figure 3a</xref>) using ARI, which measures the accuracy between two cluster assignments <inline-formula><mml:math id="inf46"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf47"><mml:mi>Y</mml:mi></mml:math></inline-formula> while accounting for randomness in the clustering:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mi>n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mi>n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></disp-formula>where <italic>n</italic> is the number of cells, and <inline-formula><mml:math id="inf48"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf49"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf50"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are elements from a contingency table that summarizes the overlap between the assignments <inline-formula><mml:math id="inf51"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf52"><mml:mi>Y</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib15">Hubert and Arabie, 1985</xref>). <inline-formula><mml:math id="inf53"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes the number of cells assigned to <inline-formula><mml:math id="inf54"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> that are also assigned to <inline-formula><mml:math id="inf55"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, while <inline-formula><mml:math id="inf56"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf57"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the sums of the <italic>i</italic>th row <italic>j</italic>th column of the contingency table, respectively. To calculate the clustering accuracy for each ground truth annotation label in <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>, we decomposed the ARI into a vector of <inline-formula><mml:math id="inf58"><mml:mi>j</mml:mi></mml:math></inline-formula> elements if <inline-formula><mml:math id="inf59"><mml:mi>Y</mml:mi></mml:math></inline-formula> is the ground truth (<inline-formula><mml:math id="inf60"><mml:mi>i</mml:mi></mml:math></inline-formula> otherwise) by not summing up the <inline-formula><mml:math id="inf61"><mml:mi>j</mml:mi></mml:math></inline-formula> terms in the numerator, leaving it in vector form. Because the magnitudes of the cluster-specific scores depend on the number of cells in each cluster, a reference score was computed for each cluster using both <inline-formula><mml:math id="inf62"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf63"><mml:mi>Y</mml:mi></mml:math></inline-formula> as the true labels.</p><p>Seurat was implemented using the Scanpy package in Python (<xref ref-type="bibr" rid="bib45">Wolf et al., 2018</xref>). For Seurat, we used both default and optimized parameters. In its default implementation, we selected the top 3000 variable genes according to their standardized dispersions and chose the number of PCs (bounded between 6 and 50) which explain 30% of the variance for dimensionality reduction. From these PCs, we calculated a cell-cell correlation distance matrix. To keep the comparison between SAM and Seurat graphs consistent, this distance matrix was converted into a kNN adjacency matrix with the value of <italic>k</italic> used by SAM. We also ran a parameter sweep to optimize Seurat’s performance for each benchmarking dataset separately by changing the number of highly variable genes and principal components to maximize the clustering accuracy.</p><p>To assign cluster labels for SAM and Seurat, we applied HDBSCAN (<xref ref-type="bibr" rid="bib21">McInnes et al., 2017</xref>), an unsupervised, density-based clustering algorithm to their respective PCA outputs. As HDBSCAN does not cluster any cell it deems an outlier, we assign the remaining outlier cells to clusters using kNN classification. For each outlier cell, we identify its 20 nearest neighbors among the clustered cells. Outliers are assigned to the same cluster as that of the majority of its neighbors. This minor extension to HDBSCAN is available as the built-in function <italic>hdbknn_clustering</italic> in SAM. SC3 was run using default parameters. The SIMLR package was implemented in R and run with the normalization parameter set to ‘True’, which mean-centers gene expressions after normalizing them to be between 0 and 1. Both SC3 and SIMLR provide their own functions to estimate the number of clusters and cluster assignments.</p><p>To compare the quality of graphs generated by different methods, we use the NACC, modularity, and spatial dispersion. The NACC is the average of the local clustering coefficient for each node of a graph and quantifies the degree of structure in the graph (<xref ref-type="bibr" rid="bib42">Watts and Strogatz, 1998</xref>). The local clustering coefficient is defined as<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math></disp-formula>where <inline-formula><mml:math id="inf64"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the number of edges between the <inline-formula><mml:math id="inf65"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> neighbors of node <italic>i</italic> and measures the degree of connectedness in a particular node’s local neighborhood. We calculate the NACC using the implementation in <italic>graph-tool</italic> (<xref ref-type="bibr" rid="bib23">Peixoto, 2017</xref>).</p><p>The modularity <inline-formula><mml:math id="inf66"><mml:mi>Q</mml:mi></mml:math></inline-formula> of a graph is defined as<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>where <italic>A<sub>ij</sub></italic> is one if there is an edge from cell <italic>i</italic> to cell <italic>j</italic>, <inline-formula><mml:math id="inf67"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the degree of cell <italic>i</italic>, <inline-formula><mml:math id="inf68"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the degree of cell <italic>j</italic>, <italic>m</italic> is the total number of edges, and <inline-formula><mml:math id="inf69"><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is 1 if cells <italic>i</italic> and <italic>j</italic> are in the same cluster or 0 otherwise. High modularity indicates that clusters have on average more edges within clusters than between clusters. To find the optimal modularity for a particular graph, we used Louvain clustering, which searches for a partition with maximum modularity.</p><p>To quantify the spatial organization of gene expression along the graph, we calculate the Euclidean norm of the largest 100 spatial dispersions. Spatial dispersion is defined as before in the SAM algorithm: <inline-formula><mml:math id="inf70"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula>, where <inline-formula><mml:math id="inf71"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the Fano factor of the kNN-averaged expressions and <inline-formula><mml:math id="inf72"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mfrac><mml:mi>N</mml:mi><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. <inline-formula><mml:math id="inf73"><mml:mi>N</mml:mi></mml:math></inline-formula> is the directed adjacency matrix output by SAM or Seurat and <inline-formula><mml:math id="inf74"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a column vector of expression values for gene <italic>i</italic>.</p><p>To measure the inherent sensitivity of each dataset, we randomly perturbed the gene expression matrices of each dataset by randomly sampling 2000 genes and applied PCA to the subsampled data. A correlation distance matrix was calculated from the top 15 PCs and perturbations were repeated 20 times to generate distance matrix replicates. Sensitivity is then defined as the average error across all pairwise comparisons between replicates. The error between two distance matrices <italic>j</italic> and <italic>k,</italic> <inline-formula><mml:math id="inf75"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, is defined as the average correlation distance between corresponding pairs of rows in the distance matrices <inline-formula><mml:math id="inf76"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf77"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>:<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>D</mml:mi><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf78"><mml:mi>D</mml:mi><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></inline-formula> is the Pearson correlation distance between the distances from cell <italic>i</italic> in distance matrices <italic>j</italic> and <italic>k</italic>.</p><p>We simulated datasets with increasing sensitivity by introducing increasing degrees of corruption in each of the nine annotated datasets. To corrupt a dataset, we randomly permuted a fraction <italic>f</italic> of the elements in the expression matrix. The proportion of elements permuted corresponds to the degree of corruption, ranging from 0 to all elements. For each annotated dataset, we simulated 10 replicates per value of <italic>f</italic>. SAM and Seurat were run on each corrupted dataset, clustering was performed using the <italic>hdbknn_clustering</italic> function in SAM, and the ARI, NACC, modularity, and spatial dispersion metrics were recorded. The Area Under the Curve (AUC) was calculated for each metric with respect to <italic>f</italic> using the trapezoidal rule. Finally, to rescue the performance of Seurat, we used as input to Seurat the top 3000 genes with the highest SAM weights.</p></sec><sec id="s4-7"><title>Gene set enrichment analysis (GSEA)</title><p>GSEA (<xref ref-type="bibr" rid="bib31">Subramanian et al., 2005</xref>) is typically run on a gene expression matrix with user-defined cluster assignments to quantify the differential expression for each gene. By default, differential expression is quantified using a signal-to-noise metric and the resulting scores are used to rank the genes in descending order. However, GSEA can also run in an alternative mode in which the user provides a predefined list of gene rankings. Therefore, we used the genes ranked by their SAM weights as input to GSEA to determine the biological processes enriched among the highly weighted genes. As shown in <xref ref-type="fig" rid="fig6">Figure 6a</xref>, we can directly test if SAM captures the relevant biological processes. GSEA provides a number of statistical measures to assess the significance of enriched gene sets, of which we use the False Discovery Rate (FDR). The FDR quantifies the likelihood that a highly enriched gene set represents a false positive. The significance threshold typically used with FDR is 25%, which implies that the results are likely to be valid 75% of the time.</p></sec><sec id="s4-8"><title>Removal of cell cycle effects</title><p>To remove cell cycle effects from the macrophage dataset, we adopted a simpler version of the strategy used in <italic>ccRemover</italic> (<xref ref-type="bibr" rid="bib3">Barron and Li, 2016</xref>), in which we subtract from the data PCs that are significantly associated with known cell cycle genes. Letting <inline-formula><mml:math id="inf79"><mml:mi>P</mml:mi></mml:math></inline-formula> represent the PCs and <inline-formula><mml:math id="inf80"><mml:mi>L</mml:mi></mml:math></inline-formula> be the gene loadings, we quantify the association between the set of cell cycle genes <italic>G</italic> and PC <italic>j</italic> as<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>PC <italic>j</italic> is selected if its association <inline-formula><mml:math id="inf81"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is at least two standard deviations above the mean of the associations for all PCs. In the particular case of the macrophage data, we identified the set of PCs <inline-formula><mml:math id="inf82"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></inline-formula> as being significantly associated with the cell cycle genes. We next reconstruct the data using these PCs, which thus captures the cell-cycle effects, and subtract the reconstructed data from the expression matrix <italic>E</italic>:<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:mi>W</mml:mi></mml:msqrt></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>When reconstructing the data, we scale the gene loadings by the SAM weights <italic>W</italic> so that only the highly weighted SAM genes (which are initially dominated by cell cycle genes) contribute to the cell cycle removal, as there may be other genes involved in other biological processes that could also be correlated with the PCs in <italic>S</italic>. To run SAM on the data with cell cycle effects removed, we use <inline-formula><mml:math id="inf83"><mml:mi>E</mml:mi></mml:math></inline-formula> as opposed to <inline-formula><mml:math id="inf84"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for the calculation of spatial dispersions, because the latter may contain negative values, for which dispersion is ill-defined. This method is made available as a part of the SAM package in the functions <italic>calculate_regression_PCs</italic> and <italic>regress_genes</italic>.</p></sec><sec id="s4-9"><title>Clustering the NF-κB activity time series</title><p>The original study combined imaging and transcriptomics to link NF-κB nuclear translocation dynamics to changes in gene expression within single cells. Macrophages stimulated with LPS were individually trapped in microfluidic chambers and imaged for various lengths of time (75–300 min) prior to scRNAseq library preparation. NF-κB was tagged with a fluorescent protein, and its activation was measured as the nuclear-localized fluorescence intensity. Based on the imaging data, the authors identified three main classes of NF-κB dynamics, the first with a transient initial response, the second with a prolonged initial response, and the third with a recurrent response. Because the recurrent response is found only in the 300 min time point (the latest time point in the study) and comprises only ~8% of these cells, we primarily focused on clustering cells based on their initial dynamics. To do this, we used the <italic>tslearn</italic> (<xref ref-type="bibr" rid="bib33">Tavenard, 2017</xref>) python package to group cells based on their NF-κB activity time series. Because these time series are quite noisy, we were conservative in labeling cells as having a prolonged initial response in an effort to avoid false positives. As a result, these cells comprise only ~30% of the dataset.</p><p>For the cells sampled at 75 and 150 min after LPS stimulation, we used the time series <italic>k</italic>-means algorithm with the <italic>softdtw</italic> distance metric to cluster them into three groups, which resulted in representative time series with transient, intermediate, and prolonged responses. Merging the cells with transient and intermediate responses into one cluster (which we simply labeled as transient response), we obtained the 75 and 150 min representative time series shown in <xref ref-type="fig" rid="fig6">Figure 6e</xref>. Because the cells sampled at 300 min displayed much more variability in their NF-κB time series, we clustered them into six groups, labeling the cluster whose representative time series had the broadest initial peak as the prolonged response cluster (blue in <xref ref-type="fig" rid="fig6">Figure 6e</xref>, right). The remaining groups were labeled as the transient response cluster (blue in <xref ref-type="fig" rid="fig6">Figure 6e</xref>, left).</p></sec><sec id="s4-10"><title>Correcting batch effects in the schistosome datasets</title><p>We used the Mutual Nearest Neighbors algorithm (<xref ref-type="bibr" rid="bib13">Haghverdi et al., 2018</xref>) with default values to generate an expression matrix <inline-formula><mml:math id="inf85"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in which the batch effects between the 2.5-week and 3.5-week datasets were corrected for. To run SAM on the batch-corrected data, we use <inline-formula><mml:math id="inf86"><mml:mi>E</mml:mi></mml:math></inline-formula> for the calculation of spatial dispersions as opposed to <inline-formula><mml:math id="inf87"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p></sec><sec id="s4-11"><title>scRNAseq of schistosome stem cells</title><p>Schistosome stem cells were isolated from juvenile parasites retrieved from infected mice at 2.5 and 3.5 weeks post infection. We followed the protocol as previously described (<xref ref-type="bibr" rid="bib41">Wang et al., 2018</xref>). Briefly, we retrieved juvenile parasites from schistosome-infected mice (Swiss Webster NR-21963) by hepatic portal vein perfusion. Parasites were cultured at 37°C/5% CO<sub>2</sub> in Basch Medium 169 supplemented with 1X Antibiotic-Antimycotic for 24–48 hr to allow complete digestions of host blood cell in parasite intestines. In adherence to the Animal Welfare Act and the Public Health Service Policy on Humane Care and Use of Laboratory Animals, all experiments with and care of mice were performed in accordance with protocols approved by the Institutional Animal Care and Use Committees (IACUC) of Stanford University (protocol approval number 30366).</p><p>Before dissociation, parasites were permeabilized in PBS containing 0.1% Triton X-100% and 0.1% NP-40 for 30 s and washed thoroughly to remove the surfactants. The permeabilized parasites were dissociated in 0.25% trypsin for 20 min. Cell suspensions were passed through a 100 μm nylon mesh (Falcon Cell Strainer) and centrifuged at 150 g for 5 min. Cell pellets were gently resuspended, passed through a 30 μm nylon mesh, and stained with Vybrant DyeCycle Violet (DCV; 5 µM, Invitrogen), and TOTO-3 (0.2 µM, Invitrogen) for 30–45 min. As the stem cells comprise the only proliferative population in schistosomes, we flow-sorted cells at G<sub>2</sub>/M phase of the cell cycle on a SONY SH800 cell sorter. Dead cells were excluded based on TOTO-3 fluorescence. Single stem cells were gated using forward scattering (FSC), side scattering (SSC), and DCV to isolate cells with doubled DNA content compared to the rest of the population (<xref ref-type="bibr" rid="bib41">Wang et al., 2018</xref>). Cells that passed these gates were sorted into 384-well lysis plates containing Triton X-100, ERCC standards, oligo-dT, dNTP, and RNase inhibitor.</p><p>cDNA was reverse transcribed and amplified on 384-well plate following the Smart-Seq2 protocol (<xref ref-type="bibr" rid="bib24">Picelli et al., 2013</xref>). For quality control, we quantified the histone <italic>h2a</italic> (Smp_086860) levels using qPCR (the primers are listed in <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>), as <italic>h2a</italic> is a ubiquitously expressed in all schistosomes stem cell (<xref ref-type="bibr" rid="bib6">Collins et al., 2013</xref>; <xref ref-type="bibr" rid="bib39">Wang et al., 2013</xref>; <xref ref-type="bibr" rid="bib41">Wang et al., 2018</xref>). We picked wells that generated C<sub>T</sub> values within 2.5 C<sub>T</sub> around the most probable values (~45% of total wells, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). cDNA was then diluted to 0.4 ng/µL for library preparation. Tagmentation and barcoding of wells were prepared using Nextera XT DNA library preparation kit. Library fragments concentration and purity were quantified by Agilent bioanalyzer and qPCR. Sequencing was performed on a NextSeq 500 using V2 150 cycles high-output kit at ~1 million reads depth per cell. Raw sequencing reads were demultiplexed and converted to fastq files using bcl2fastq. Paired-end reads were mapped to <italic>S. mansoni</italic> genome version WBPS9 (WormBase Parasite) using STAR. In 2.5 week dataset, 338 cells with more than 1700 transcripts expressed at &gt;2 TPM were used for downstream analysis. In the 3.5 weeks dataset, 338 cells with more than 1350 transcripts expressed at &gt;2 TPM were used for downstream analysis (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p></sec><sec id="s4-12"><title>In situ hybridization and EdU labeling</title><p>RNA FISH experiments were performed as detailed in previous publications (<xref ref-type="bibr" rid="bib6">Collins et al., 2013</xref>; <xref ref-type="bibr" rid="bib39">Wang et al., 2013</xref>; <xref ref-type="bibr" rid="bib41">Wang et al., 2018</xref>). Clones used for riboprobe synthesis were generated as described previously, with oligonucleotide primers listed in <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>. Juvenile parasites were cultured with 10 µM EdU overnight, killed in 6 M MgCl<sub>2</sub> for 30 s, and then fixed in 4% formaldehyde with 0.2% Triton X-100% and 1% NP-40. Fixed parasites were sequentially dehydrated in methanol, treated in 3% H<sub>2</sub>O<sub>2</sub> for 30 min, and rehydrated. Parasites were permeabilized by 10 μg/mL proteinase K for 15 min and post fixed with 4% formaldehyde. The hybridization was performed at 52°C with riboprobes labeled with either digoxigenin-12-UTP (Roche) or fluorescein-12-UTP (Roche). For detection, samples were blocked with 5% horse serum and 0.5% of Roche Western Blocking Reagent, and then incubated with anti-digoxigenin-peroxidase (1:1000; Roche) or anti-fluorescein peroxidase (1:1500; Roche) overnight at 4°C for tyramide signal amplification (TSA). For double FISH, the first peroxidase was quenched for 30 min in 0.1% sodium azide solution before the detection of the second gene. After FISH, EdU detection was performed by click reaction with 25 μM Cy5-azide conjugates (Click Chemistry Tools). Samples were mounted in <italic>scale</italic> solution (30% glycerol, 0.1% Triton X-100, 4 M urea in PBS supplemented with 2 mg/mL sodium ascorbate) and imaged on a Zeiss LSM 800 confocal microscope.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p><italic>S. mansoni</italic> (strain: NMRI) was provided by the NIAID Schistosomiasis Resource Center for distribution through BEI Resources, NIH-NIAID Contract HHSN272201000005I. We thank F Zanini, N Neff, J Okamoto, and D Nanes-Sarfati for experimental help, K Lane, M Covert, J Qin, F Horns, G Stanley, J Rink, and M Chen for conceptual input and stimulating discussions. BW is supported by the Burroughs Wellcome Fund through the CASI program and a Beckman Young Investigator Award.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Resources, Data curation, Formal analysis, Validation, Investigation, Visualization, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Validation, Investigation, Visualization</p></fn><fn fn-type="con" id="con4"><p>Resources, Supervision, Funding acquisition, Writing—review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Supervision, Funding acquisition, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other" id="fn1"><p>Animal experimentation: In adherence to the Animal Welfare Act and the Public Health Service Policy on Humane Care and Use of Laboratory Animals, all experiments with and care of mice were performed in accordance with protocols approved by the Institutional Animal Care and Use Committees (IACUC) of Stanford University (protocol approval number 30366).</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><object-id pub-id-type="doi">10.7554/eLife.48994.015</object-id><label>Supplementary file 1.</label><caption><title>Ranked gene list with high SAM weights in the schistosome stem cell data.</title><p>Gene IDs and annotations are given in the <italic>S. mansoni</italic> genome version 9 (WormBase, WS268). Genes are assigned to the cluster corresponding to the marker gene, <italic>nanos-2</italic>, <italic>cabp</italic>, <italic>astf</italic>, or <italic>bhlh</italic>, with which they have the highest correlation. Genes found in our prior work (<xref ref-type="bibr" rid="bib41">Wang et al., 2018</xref>) to be enriched in subsets of stem cells are specified.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-48994-supp1-v2.xlsx"/></supplementary-material><supplementary-material id="supp2"><object-id pub-id-type="doi">10.7554/eLife.48994.016</object-id><label>Supplementary file 2.</label><caption><title>Datasets used in this study.</title><p>Accession numbers, library size normalization methods, data preprocessing methods, sensitivity scores, and corresponding references are provided for each dataset. Accession numbers with asterisks indicate datasets that are sourced from the <italic>conquer</italic> database (<xref ref-type="bibr" rid="bib30">Soneson and Robinson, 2018</xref>). Accession numbers with crosses indicate the nine well-annotated datasets that were used for benchmarking.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-48994-supp2-v2.xlsx"/></supplementary-material><supplementary-material id="supp3"><object-id pub-id-type="doi">10.7554/eLife.48994.017</object-id><label>Supplementary file 3.</label><caption><title>ARI clustering accuracy of individual annotated cell types.</title><p>The ARI scores of SAM, Seurat, SC3, and SIMLR applied to the nine benchmarking datasets are provided for each annotated ground truth cluster.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-48994-supp3-v2.xlsx"/></supplementary-material><supplementary-material id="supp4"><object-id pub-id-type="doi">10.7554/eLife.48994.018</object-id><label>Supplementary file 4.</label><caption><title>Cloning primer sequences used for generating riboprobes for the FISH experiments and primer sequences for qPCR analysis.</title><p>Functional annotations of the genes were given in the <italic>S. mansoni</italic> genome version 9 (WormBase, WS268).</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-48994-supp4-v2.xlsx"/></supplementary-material><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.48994.019</object-id><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-48994-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>The schistosome stem cell scRNAseq data generated in this study is available through the Gene Expression Omnibus (GEO) under accession number GSE116920.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Xue</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Single-cell RNA sequencing of proliferative stem cell population from juvenile Schistosoma mansoni</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE116920">GSE116920</pub-id></element-citation></p><p>The following previously published datasets were used:</p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>F</given-names></name><name><surname>Qiao</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><data-title>Single-cell RNA-Seq profiling of human preimplantation embryos and embryonic stem cells</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE36552">GSE36552</pub-id></element-citation></p><p><element-citation id="dataset3" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Goolam</surname><given-names>M</given-names></name><name><surname>Scialdone</surname><given-names>A</given-names></name><name><surname>Graham</surname><given-names>SJL</given-names></name><name><surname>Macaulay</surname><given-names>IC</given-names></name><name><surname>Jedrusik</surname><given-names>A</given-names></name><name><surname>Hupalowska</surname><given-names>A</given-names></name><name><surname>Voet</surname><given-names>T</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name><name><surname>Zernicka-Goetz</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Heterogeneity in Oct4 and Sox2 targets biases cell fate in 4-cell mouse embryos</data-title><source>ArrayExpress</source><pub-id assigning-authority="EBI" pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-3321/">E-MTAB-3321</pub-id></element-citation></p><p><element-citation id="dataset4" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Tasic</surname><given-names>B</given-names></name><name><surname>Menon</surname><given-names>V</given-names></name><name><surname>Nguyen</surname><given-names>TN</given-names></name><name><surname>Kim</surname><given-names>TK</given-names></name><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>Gray</surname><given-names>LT</given-names></name><name><surname>Hawrylycz</surname><given-names>M</given-names></name><name><surname>Koch</surname><given-names>C</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE71585">GSE71585-GPL17021</pub-id></element-citation></p><p><element-citation id="dataset5" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>F</given-names></name><name><surname>Guo</surname><given-names>H</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Tang</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>The transcriptome and DNA methylome landscapes of human primordial germ cells</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE63818">GSE63818</pub-id></element-citation></p><p><element-citation id="dataset6" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>JK</given-names></name><name><surname>Kolodziejczyk</surname><given-names>AA</given-names></name><name><surname>Ilicic</surname><given-names>T</given-names></name><name><surname>Illicic</surname><given-names>T</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>Single cell RNA-sequencing of pluripotent states unlocks modular transcriptional variation</data-title><source>ArrayExpress</source><pub-id assigning-authority="EBI" pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-2600/">E-MTAB-2600</pub-id></element-citation></p><p><element-citation id="dataset7" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Wollny</surname><given-names>D</given-names></name><name><surname>Zhao</surname><given-names>S</given-names></name><name><surname>Martin-Villalba</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Single-cell analysis uncovers clonal acinar cell heterogeneity in the adult pancreas</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE80032">GSE80032</pub-id></element-citation></p><p><element-citation id="dataset8" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Loh</surname><given-names>KM</given-names></name><name><surname>Chen</surname><given-names>A</given-names></name><name><surname>Koh</surname><given-names>PW</given-names></name><name><surname>Deng</surname><given-names>TZ</given-names></name><name><surname>Sinha</surname><given-names>R</given-names></name><collab>TsaiJM</collab><name><surname>Barkal</surname><given-names>AA</given-names></name><name><surname>Shen</surname><given-names>KY</given-names></name><name><surname>Jain</surname><given-names>R</given-names></name><name><surname>Morganti</surname><given-names>RM</given-names></name><name><surname>Shyh-Chang</surname><given-names>N</given-names></name><name><surname>Fernhoff</surname><given-names>NB</given-names></name><collab>GeorgeBM</collab><name><surname>Wernig</surname><given-names>G</given-names></name><name><surname>Salomon</surname><given-names>REA</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name><name><surname>Vogel</surname><given-names>H</given-names></name><name><surname>Epstein</surname><given-names>JA</given-names></name><name><surname>Kundaje</surname><given-names>A</given-names></name><name><surname>Talbot</surname><given-names>WS</given-names></name><collab>BeachyPA</collab><name><surname>Ang</surname><given-names>LT</given-names></name><name><surname>Weissman</surname><given-names>IL</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Mapping the pairwise choices leading from pluripotency to human bone, heart, and other mesoderm cell types</data-title><source>NCBI</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/sra?term=SRP073808">SRP073808</pub-id></element-citation></p><p><element-citation id="dataset9" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Deng</surname><given-names>Q</given-names></name><name><surname>Ramsköld</surname><given-names>D</given-names></name><name><surname>Reinius</surname><given-names>B</given-names></name><name><surname>Sandberg</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><data-title>Single-cell RNA-seq reveals dynamic, random monoallelic gene expression in mammalian cells</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE45719">GSE45719</pub-id></element-citation></p><p><element-citation id="dataset10" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Anoop</surname><given-names>P</given-names></name><name><surname>Itay</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2014">2014</year><data-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE57872">GSE57872</pub-id></element-citation></p><p><element-citation id="dataset11" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Rizvi</surname><given-names>AH</given-names></name><name><surname>Camara</surname><given-names>PG</given-names></name><name><surname>Kandror</surname><given-names>EK</given-names></name><name><surname>Roberts</surname><given-names>TJ</given-names></name><name><surname>Schieren</surname><given-names>I</given-names></name><name><surname>Maniatis</surname><given-names>T</given-names></name><name><surname>Rabadan</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Single-cell topological RNA-seq analysis reveals insights into cellular differentiation and development</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE94883">GSE94883</pub-id></element-citation></p><p><element-citation id="dataset12" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>Q</given-names></name><name><surname>Langenau</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Dissecting hematopoietic and renal cell heterogeneity in adult zebrafish at single-cell resolution using RNA sequencing</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE100911">GSE100911</pub-id></element-citation></p><p><element-citation id="dataset13" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Engel</surname><given-names>I</given-names></name><name><surname>Seumois</surname><given-names>G</given-names></name><name><surname>Chavez</surname><given-names>L</given-names></name><name><surname>Chawla</surname><given-names>A</given-names></name><name><surname>White</surname><given-names>B</given-names></name><name><surname>Mock</surname><given-names>D</given-names></name><name><surname>Vijayanand</surname><given-names>P</given-names></name><name><surname>Kronenberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Innate-like functions of natural killer T cell subsets result from highly divergent gene programs</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE74596">GSE74596</pub-id></element-citation></p><p><element-citation id="dataset14" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Edsgard</surname><given-names>D</given-names></name><name><surname>Lanner</surname><given-names>F</given-names></name><name><surname>Sandberg</surname><given-names>R</given-names></name><name><surname>Petropoulos</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Single-cell RNA-seq reveals lineage and X chromosome dynamics in human preimplantation embryos</data-title><source>ArrayExpress</source><pub-id assigning-authority="EBI" pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-3929/">E-MTAB-3929</pub-id></element-citation></p><p><element-citation id="dataset15" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Burns</surname><given-names>JC</given-names></name><name><surname>Kelly</surname><given-names>MC</given-names></name><name><surname>Hoa</surname><given-names>M</given-names></name><name><surname>Morell</surname><given-names>RJ</given-names></name><name><surname>Kelley</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>Single-cell RNA-Seq resolves cellular complexity in sensory organs from the neonatal inner ear</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE71982">GSE71982</pub-id></element-citation></p><p><element-citation id="dataset16" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Namani</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>XJ</given-names></name><name><surname>Tang</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Measuring signaling and RNA-Seq in the same cell links gene expression to dynamic patterns of NF-κB activation</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE94393">GSE94383</pub-id></element-citation></p><p><element-citation id="dataset17" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Biase</surname><given-names>FH</given-names></name><name><surname>Cao</surname><given-names>X</given-names></name><name><surname>Zhong</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><data-title>Cell fate inclination within 2-cell and 4-cell mouse embryos revealed by single-cell RNA sequencing</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE57249">GSE57249</pub-id></element-citation></p><p><element-citation id="dataset18" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Cacchiarelli</surname><given-names>D</given-names></name><name><surname>Grimbsby</surname><given-names>J</given-names></name><name><surname>Pokharel</surname><given-names>P</given-names></name><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Morse</surname><given-names>M</given-names></name><name><surname>Mikkelsen</surname><given-names>T</given-names></name><name><surname>Rinn</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><data-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE52529">GSE52529-GPL16791</pub-id></element-citation></p><p><element-citation id="dataset19" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Pollen</surname><given-names>AA</given-names></name><name><surname>Nowakowski</surname><given-names>TJ</given-names></name><name><surname>Shuga</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Leyrat</surname><given-names>AA</given-names></name><name><surname>Lui</surname><given-names>JH</given-names></name><name><surname>Li</surname><given-names>N</given-names></name><name><surname>Szpankowski</surname><given-names>L</given-names></name><name><surname>Fowler</surname><given-names>B</given-names></name><name><surname>Chen</surname><given-names>P</given-names></name><name><surname>Ramalingam</surname><given-names>N</given-names></name><name><surname>Sun</surname><given-names>G</given-names></name><name><surname>Thu</surname><given-names>M</given-names></name><name><surname>Norris</surname><given-names>M</given-names></name><name><surname>Lebofsky</surname><given-names>R</given-names></name><name><surname>Toppani</surname><given-names>D</given-names></name><name><surname>Kemp</surname><given-names>DW</given-names></name><collab>WongM</collab><name><surname>Clerkson</surname><given-names>B</given-names></name><name><surname>Jones</surname><given-names>BN</given-names></name><name><surname>Wu</surname><given-names>S</given-names></name><name><surname>Knutsson</surname><given-names>L</given-names></name><name><surname>Alvarado</surname><given-names>B</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Weaver</surname><given-names>LS</given-names></name><collab>MayAP</collab><name><surname>Jones</surname><given-names>RC</given-names></name><name><surname>Unger</surname><given-names>MA</given-names></name><name><surname>Kriegstein</surname><given-names>AR</given-names></name><name><surname>West</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2014">2014</year><data-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</data-title><source>NCBI SRA</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/sra?term=SRP041736">SRP041736</pub-id></element-citation></p><p><element-citation id="dataset21" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Buettner</surname><given-names>F</given-names></name><name><surname>Natarajan</surname><given-names>KN</given-names></name><name><surname>Casale</surname><given-names>FP</given-names></name><collab>ProserpioV</collab><name><surname>Scialdone</surname><given-names>A</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name><name><surname>Stegle</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</data-title><source>ArrayExpress</source><pub-id assigning-authority="EBI" pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-2805/">E-MTAB-2805</pub-id></element-citation></p><p><element-citation id="dataset22" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Satija</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><data-title>Single-cell RNA-seq reveals dynamic paracrine control of cellular variation</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE48968">GSE48968-GPL13112</pub-id></element-citation></p><p><element-citation id="dataset23" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Ning</surname><given-names>L</given-names></name><name><surname>Li-Fang</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>Oscope identifies oscillatory genes in unsynchronized single-cell RNAseq experiments</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE64016">GSE64016</pub-id></element-citation></p><p><element-citation id="dataset24" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Meyer</surname><given-names>SE</given-names></name><name><surname>Qin</surname><given-names>T</given-names></name><name><surname>Muench</surname><given-names>DE</given-names></name><name><surname>Masuda</surname><given-names>K</given-names></name><name><surname>Venkatasubramanian</surname><given-names>M</given-names></name><name><surname>Orr</surname><given-names>E</given-names></name><name><surname>Paietta</surname><given-names>E</given-names></name><name><surname>Tallman</surname><given-names>MS</given-names></name><name><surname>Fernandez</surname><given-names>H</given-names></name><name><surname>Melnick</surname><given-names>A</given-names></name><name><surname>Beau</surname><given-names>MM</given-names></name><name><surname>Kogan</surname><given-names>S</given-names></name><name><surname>Salomonis</surname><given-names>N</given-names></name><name><surname>Figueroa</surname><given-names>ME</given-names></name><name><surname>Grimes</surname><given-names>HL</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>DNMT3A haploinsufficiency transforms FLT3ITD myeloproliferative disease into a rapid, spontaneous, and fully penetrant acute myeloid leukemia</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE77847">GSE77847</pub-id></element-citation></p><p><element-citation id="dataset25" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Treutlein</surname><given-names>B</given-names></name><name><surname>Quake</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2014">2014</year><data-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE52583">GSE52583-GPL13112</pub-id></element-citation></p><p><element-citation id="dataset26" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Olsson</surname><given-names>A</given-names></name><name><surname>Venkatasubramanian</surname><given-names>M</given-names></name><name><surname>Chaudhri</surname><given-names>VK</given-names></name><name><surname>Aronow</surname><given-names>BJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Single-cell analysis of mixed-lineage states leading to a binary cell fate choice</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE70245">GSE70245</pub-id></element-citation></p><p><element-citation id="dataset27" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Shin</surname><given-names>J</given-names></name><name><surname>Song</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>Single-cell RNA-seq with waterfall reveals molecular cascades underlying adult neurogenesis</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE71485">GSE71485</pub-id></element-citation></p><p><element-citation id="dataset28" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Schwalie</surname><given-names>PC</given-names></name><name><surname>Dong</surname><given-names>H</given-names></name><name><surname>Zachara</surname><given-names>M</given-names></name><name><surname>Russeil</surname><given-names>J</given-names></name><name><surname>Alpern</surname><given-names>D</given-names></name><name><surname>Akchiche</surname><given-names>N</given-names></name><name><surname>Caprara</surname><given-names>C</given-names></name><name><surname>Sun</surname><given-names>W</given-names></name><name><surname>Schlaudraff</surname><given-names>KU</given-names></name><name><surname>Soldati</surname><given-names>G</given-names></name><name><surname>Wolfrum</surname><given-names>C</given-names></name><name><surname>Deplancke</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>A stromal cell population that inhibits adipogenesis in mammalian fat depots</data-title><source>ArrayExpress</source><pub-id assigning-authority="EBI" pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6677/">E-MTAB-6677</pub-id></element-citation></p><p><element-citation id="dataset29" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Darmanis</surname><given-names>S</given-names></name><name><surname>Quake</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Single-Cell RNA-Seq analysis of infiltrating neoplastic cells at the migrating front of human glioblastoma</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE84465">GSE84465</pub-id></element-citation></p><p><element-citation id="dataset30" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Scialdone</surname><given-names>A</given-names></name><name><surname>Tanaka</surname><given-names>Y</given-names></name><name><surname>Jawaid</surname><given-names>W</given-names></name><name><surname>Moignard</surname><given-names>V</given-names></name><name><surname>Wilson</surname><given-names>NK</given-names></name><name><surname>Macaulay</surname><given-names>IC</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name><name><surname>Göttgens</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Resolving early mesoderm diversification through single-cell expression profiling</data-title><source>ArrayExpress</source><pub-id assigning-authority="EBI" pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-4079">E-MTAB-4079</pub-id></element-citation></p><p><element-citation id="dataset31" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Enge</surname><given-names>M</given-names></name><name><surname>Arda</surname><given-names>HE</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Single-cell analysis of human pancreas reveals transcriptional signatures of aging and somatic mutation patterns</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE81547">GSE81547</pub-id></element-citation></p><p><element-citation id="dataset32" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Stévant</surname><given-names>I</given-names></name><name><surname>Neirjinck</surname><given-names>Y</given-names></name><name><surname>Borel</surname><given-names>C</given-names></name><name><surname>Escoffier</surname><given-names>J</given-names></name><name><surname>Smith</surname><given-names>LB</given-names></name><name><surname>Antonarakis</surname><given-names>SE</given-names></name><name><surname>Dermitzakis</surname><given-names>ET</given-names></name><name><surname>Nef</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Deciphering cell lineage specification during male sex determination with single-cell RNA sequencing</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE97519">GSE97519</pub-id></element-citation></p><p><element-citation id="dataset33" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Phillips</surname><given-names>MJ</given-names></name><name><surname>Jiang</surname><given-names>P</given-names></name><name><surname>Howden</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>A novel approach to single cell RNA-sequence analysis facilitates in silico gene reporting of human pluripotent stem cell-derived retinal cell types</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE98556">GSE98556</pub-id></element-citation></p><p><element-citation id="dataset34" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Vanlandewijck</surname><given-names>M</given-names></name><name><surname>He</surname><given-names>L</given-names></name><name><surname>Mäe</surname><given-names>MA</given-names></name><name><surname>Andrae</surname><given-names>J</given-names></name><name><surname>Betsholtz</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>A molecular atlas of cell types and zonation in the brain vasculature</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE99235">GSE99235</pub-id></element-citation></p><p><element-citation id="dataset35" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Furlan</surname><given-names>A</given-names></name><name><surname>Dyachuk</surname><given-names>V</given-names></name><name><surname>Kastriti</surname><given-names>ME</given-names></name><name><surname>Calvo-Enrique</surname><given-names>L</given-names></name><name><surname>Abdo</surname><given-names>H</given-names></name><name><surname>Hadjab-Lallemend</surname><given-names>S</given-names></name><name><surname>Chontorotzea</surname><given-names>T</given-names></name><name><surname>Akkuratova</surname><given-names>N</given-names></name><name><surname>Usoskin</surname><given-names>D</given-names></name><name><surname>Kamenev</surname><given-names>D</given-names></name><name><surname>Petersen</surname><given-names>J</given-names></name><name><surname>Sunadome</surname><given-names>K</given-names></name><name><surname>Memic</surname><given-names>F</given-names></name><name><surname>Marklund</surname><given-names>U</given-names></name><name><surname>Fried</surname><given-names>K</given-names></name><name><surname>Topilko</surname><given-names>P</given-names></name><name><surname>Lallemend</surname><given-names>F</given-names></name><name><surname>Kharchenko</surname><given-names>P</given-names></name><name><surname>Ernfors</surname><given-names>P</given-names></name><name><surname>Adameyko</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Multipotent peripheral glial cells generate neuroendocrine cells of the adrenal medulla</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE99933">GSE99933</pub-id></element-citation></p><p><element-citation id="dataset36" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Ghahramani</surname><given-names>A</given-names></name><name><surname>Watt</surname><given-names>F</given-names></name><name><surname>Luscombe</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Epidermal Wnt signalling regulates transcriptome heterogeneity and proliferative fate in neighbouring cells</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE99989">GSE99989</pub-id></element-citation></p><p><element-citation id="dataset37" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Lescroart</surname><given-names>F</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Gargouri</surname><given-names>S</given-names></name><name><surname>Moignard</surname><given-names>V</given-names></name><name><surname>Dubois</surname><given-names>C</given-names></name><name><surname>Paulissen</surname><given-names>C</given-names></name><name><surname>Göttgens</surname><given-names>B</given-names></name><name><surname>Blanpain</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Defining the earliest step of cardiovascular lineage segregation by single-cell RNA-seq</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE100471">GSE100471</pub-id></element-citation></p><p><element-citation id="dataset38" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Mohammed</surname><given-names>H</given-names></name><name><surname>Hernando-Herraez</surname><given-names>I</given-names></name><name><surname>Reik</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Single-cell landscape of transcriptional heterogeneity and cell fate decisions during mouse early gastrulation</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE100597">GSE100597</pub-id></element-citation></p><p><element-citation id="dataset39" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Mathys</surname><given-names>H</given-names></name><name><surname>Gao</surname><given-names>F</given-names></name><name><surname>Tsai</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Temporal tracking of microglia activation in neurodegeneration at single-cell resolution</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE103334">GSE103334</pub-id></element-citation></p><p><element-citation id="dataset40" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Chevée</surname><given-names>M</given-names></name><name><surname>Robertson</surname><given-names>JD</given-names></name><name><surname>Cannon</surname><given-names>GH</given-names></name><name><surname>Brown</surname><given-names>SP</given-names></name><name><surname>Goff</surname><given-names>LA</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Variation in activity state, axonal projection, and position define the transcriptional identity of individual neocortical projection neurons</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE107632">GSE107632</pub-id></element-citation></p><p><element-citation id="dataset41" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Hook</surname><given-names>PW</given-names></name><name><surname>MyClymont</surname><given-names>SA</given-names></name><name><surname>Cannon</surname><given-names>GH</given-names></name><name><surname>Law</surname><given-names>WD</given-names></name><name><surname>Morton</surname><given-names>AJ</given-names></name><name><surname>Goff</surname><given-names>LA</given-names></name><name><surname>McCallion</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Single-Cell RNA-Seq of mouse dopaminergic neurons informs candidate gene selection for sporadic parkinson disease</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE108020">GSE108020</pub-id></element-citation></p><p><element-citation id="dataset42" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Mi</surname><given-names>D</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Early emergence of cortical interneuron diversity in the mouse embryo</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE109796">GSE109796</pub-id></element-citation></p><p><element-citation id="dataset43" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Zanini</surname><given-names>F</given-names></name><name><surname>Pu</surname><given-names>S</given-names></name><name><surname>Bekerman</surname><given-names>E</given-names></name><name><surname>Einav</surname><given-names>S</given-names></name><name><surname>Quake</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Single-cell transcriptional dynamics of flavivirus infection</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE110496">GSE110496</pub-id></element-citation></p><p><element-citation id="dataset44" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Venteicher</surname><given-names>A</given-names></name><name><surname>Suva</surname><given-names>M</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Single-cell RNA-seq supports a developmental hierarchy in human oligodendroglioma</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE70630">GSE70630</pub-id></element-citation></p><p><element-citation id="dataset45" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Amit</surname><given-names>I</given-names></name><name><surname>Tanay</surname><given-names>A</given-names></name><name><surname>Paul</surname><given-names>F</given-names></name><name><surname>Arkin</surname><given-names>Y</given-names></name><name><surname>Giladi</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>Transcriptional heterogeneity and lineage commitment in myeloid progenitors</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE72857">GSE72857</pub-id></element-citation></p><p><element-citation id="dataset46" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Smyth</surname><given-names>GK</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Pal</surname><given-names>B</given-names></name><name><surname>Visvader</surname><given-names>JE</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Construction of developmental lineage relationships in the mouse mammary gland by single-cell RNA profiling</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE95430">GSE95430</pub-id></element-citation></p><p><element-citation id="dataset47" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Häring</surname><given-names>M</given-names></name><name><surname>Zeisel</surname><given-names>A</given-names></name><name><surname>Linnarsson</surname><given-names>S</given-names></name><name><surname>Ernfors</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Neuronal atlas of the dorsal horn defines its architecture and links sensory input to transcriptional cell types</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE103840">GSE103840</pub-id></element-citation></p><p><element-citation id="dataset48" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Darmanis</surname><given-names>S</given-names></name><name><surname>Enge</surname><given-names>M</given-names></name><name><surname>Quake</surname><given-names>SR</given-names></name><name><surname>Sloan</surname><given-names>SA</given-names></name><name><surname>Barres</surname><given-names>BA</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Caneda</surname><given-names>C</given-names></name><name><surname>Hayden</surname><given-names>Gephart MG</given-names></name><name><surname>Shuer</surname><given-names>LM</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>A survey of human brain transcriptome diversity at the single cell level</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE67835">GSE67835</pub-id></element-citation></p><p><element-citation id="dataset49" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>YJ</given-names></name><name><surname>Schug</surname><given-names>J</given-names></name><name><surname>Golson</surname><given-names>ML</given-names></name><name><surname>Won</surname><given-names>K</given-names></name><name><surname>Liu</surname><given-names>C</given-names></name><name><surname>Naji</surname><given-names>A</given-names></name><name><surname>Avrahami</surname><given-names>D</given-names></name><name><surname>Kaestner</surname><given-names>KH</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Single-cell transcriptomics of the human endocrine pancreas</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE83139">GSE83139</pub-id></element-citation></p><p><element-citation id="dataset50" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Veres</surname><given-names>A</given-names></name><name><surname>Baron</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE84133">GSE84133</pub-id></element-citation></p><p><element-citation id="dataset51" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Fincher</surname><given-names>CT</given-names></name><name><surname>Wurtzel</surname><given-names>O</given-names></name><name><surname>de</surname><given-names>Hoog T</given-names></name><name><surname>Kravarik</surname><given-names>KM</given-names></name><name><surname>Reddien</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Cell type transcriptome atlas for the planarian Schmidtea mediterranea</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE111764">GSE111764</pub-id></element-citation></p><p><element-citation id="dataset52" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Segerstolpe</surname><given-names>Å</given-names></name><name><surname>Palasantza</surname><given-names>A</given-names></name><name><surname>Eliasson</surname><given-names>P</given-names></name><name><surname>Andersson</surname><given-names>EM</given-names></name><name><surname>Andréasson</surname><given-names>AC</given-names></name><name><surname>Sun</surname><given-names>X</given-names></name><name><surname>Picelli</surname><given-names>S</given-names></name><name><surname>Sabirsh</surname><given-names>A</given-names></name><name><surname>Clausen</surname><given-names>M</given-names></name><collab>BjursellMK</collab><name><surname>Smith</surname><given-names>DM</given-names></name><name><surname>Kasper</surname><given-names>M</given-names></name><name><surname>Ämmälä</surname><given-names>C</given-names></name><name><surname>Sandberg</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</data-title><source>ArrayExpress</source><pub-id assigning-authority="EBI" pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-5061">E-MTAB-5061</pub-id></element-citation></p><p><element-citation id="dataset53" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Muraro</surname><given-names>MJ</given-names></name><name><surname>Dharmadhikari</surname><given-names>G</given-names></name><name><surname>de</surname><given-names>Koning E</given-names></name><name><surname>van</surname><given-names>Oudenaarden A</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>A Single-cell transcriptome atlas of the human pancreas</data-title><source>NCBI Gene Expression Omnibus</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE85241">GSE85241</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bahlo</surname> <given-names>M</given-names></name><name><surname>Tian</surname> <given-names>L</given-names></name><name><surname>Lönnstedt</surname> <given-names>I</given-names></name><name><surname>Ng</surname> <given-names>M</given-names></name><name><surname>Hicks</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Comparison of clustering tools in R for medium-sized 10x genomics single-cell RNA-sequencing</article-title><source>F1000Research</source><volume>7</volume><fpage>1</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.12688/f1000research.15809.2</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baron</surname> <given-names>M</given-names></name><name><surname>Veres</surname> <given-names>A</given-names></name><name><surname>Wolock</surname> <given-names>SL</given-names></name><name><surname>Faust</surname> <given-names>AL</given-names></name><name><surname>Gaujoux</surname> <given-names>R</given-names></name><name><surname>Vetere</surname> <given-names>A</given-names></name><name><surname>Ryu</surname> <given-names>JH</given-names></name><name><surname>Wagner</surname> <given-names>BK</given-names></name><name><surname>Shen-Orr</surname> <given-names>SS</given-names></name><name><surname>Klein</surname> <given-names>AM</given-names></name><name><surname>Melton</surname> <given-names>DA</given-names></name><name><surname>Yanai</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A Single-Cell transcriptomic map of the human and mouse pancreas reveals inter- and Intra-cell population structure</article-title><source>Cell Systems</source><volume>3</volume><fpage>346</fpage><lpage>360</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id><pub-id pub-id-type="pmid">27667365</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barron</surname> <given-names>M</given-names></name><name><surname>Li</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Identifying and removing the cell-cycle effect from single-cell RNA-Sequencing data</article-title><source>Scientific Reports</source><volume>6</volume><elocation-id>33892</elocation-id><pub-id pub-id-type="doi">10.1038/srep33892</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becht</surname> <given-names>E</given-names></name><name><surname>McInnes</surname> <given-names>L</given-names></name><name><surname>Healy</surname> <given-names>J</given-names></name><name><surname>Dutertre</surname> <given-names>C-A</given-names></name><name><surname>Kwok</surname> <given-names>IWH</given-names></name><name><surname>Ng</surname> <given-names>LG</given-names></name><name><surname>Ginhoux</surname> <given-names>F</given-names></name><name><surname>Newell</surname> <given-names>EW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title><source>Nature Biotechnology</source><volume>37</volume><fpage>38</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blondel</surname> <given-names>VD</given-names></name><name><surname>Guillaume</surname> <given-names>J-L</given-names></name><name><surname>Lambiotte</surname> <given-names>R</given-names></name><name><surname>Lefebvre</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Fast unfolding of communities in large networks</article-title><source>Journal of Statistical Mechanics: Theory and Experiment</source><volume>2008</volume><fpage>P10008</fpage><pub-id pub-id-type="doi">10.1088/1742-5468/2008/10/P10008</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collins</surname> <given-names>JJ</given-names></name><name><surname>Wang</surname> <given-names>B</given-names></name><name><surname>Lambrus</surname> <given-names>BG</given-names></name><name><surname>Tharp</surname> <given-names>ME</given-names></name><name><surname>Iyer</surname> <given-names>H</given-names></name><name><surname>Newmark</surname> <given-names>PA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Adult somatic stem cells in the human parasite <italic>Schistosoma mansoni</italic></article-title><source>Nature</source><volume>494</volume><fpage>476</fpage><lpage>479</lpage><pub-id pub-id-type="doi">10.1038/nature11924</pub-id><pub-id pub-id-type="pmid">23426263</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crow</surname> <given-names>M</given-names></name><name><surname>Paul</surname> <given-names>A</given-names></name><name><surname>Ballouz</surname> <given-names>S</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Gillis</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Characterizing the replicability of cell types defined by single cell RNA-sequencing data using MetaNeighbor</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>884</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-03282-0</pub-id><pub-id pub-id-type="pmid">29491377</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Darmanis</surname> <given-names>S</given-names></name><name><surname>Sloan</surname> <given-names>SA</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Enge</surname> <given-names>M</given-names></name><name><surname>Caneda</surname> <given-names>C</given-names></name><name><surname>Shuer</surname> <given-names>LM</given-names></name><name><surname>Hayden Gephart</surname> <given-names>MG</given-names></name><name><surname>Barres</surname> <given-names>BA</given-names></name><name><surname>Quake</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A survey of human brain transcriptome diversity at the single cell level</article-title><source>PNAS</source><volume>112</volume><fpage>7285</fpage><lpage>7290</lpage><pub-id pub-id-type="doi">10.1073/pnas.1507125112</pub-id><pub-id pub-id-type="pmid">26060301</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duò</surname> <given-names>A</given-names></name><name><surname>Robinson</surname> <given-names>MD</given-names></name><name><surname>Soneson</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A systematic performance evaluation of clustering methods for single-cell RNA-seq data</article-title><source>F1000Research</source><volume>7</volume><fpage>1</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.12688/f1000research.15666.2</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fincher</surname> <given-names>CT</given-names></name><name><surname>Wurtzel</surname> <given-names>O</given-names></name><name><surname>de Hoog</surname> <given-names>T</given-names></name><name><surname>Kravarik</surname> <given-names>KM</given-names></name><name><surname>Reddien</surname> <given-names>PW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Cell type transcriptome atlas for the planarian <italic>Schmidtea mediterranea</italic></article-title><source>Science</source><volume>360</volume><elocation-id>eaaq1736</elocation-id><pub-id pub-id-type="doi">10.1126/science.aaq1736</pub-id><pub-id pub-id-type="pmid">29674431</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grün</surname> <given-names>D</given-names></name><name><surname>Kester</surname> <given-names>L</given-names></name><name><surname>van Oudenaarden</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Validation of noise models for single-cell transcriptomics</article-title><source>Nature Methods</source><volume>11</volume><fpage>637</fpage><lpage>640</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2930</pub-id><pub-id pub-id-type="pmid">24747814</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname> <given-names>M</given-names></name><name><surname>Wang</surname> <given-names>H</given-names></name><name><surname>Potter</surname> <given-names>SS</given-names></name><name><surname>Whitsett</surname> <given-names>JA</given-names></name><name><surname>Xu</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>SINCERA: a pipeline for Single-Cell RNA-Seq profiling analysis</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004575</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004575</pub-id><pub-id pub-id-type="pmid">26600239</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haghverdi</surname> <given-names>L</given-names></name><name><surname>Lun</surname> <given-names>ATL</given-names></name><name><surname>Morgan</surname> <given-names>MD</given-names></name><name><surname>Marioni</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title><source>Nature Biotechnology</source><volume>36</volume><fpage>421</fpage><lpage>427</lpage><pub-id pub-id-type="doi">10.1038/nbt.4091</pub-id><pub-id pub-id-type="pmid">29608177</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoffmann</surname> <given-names>KF</given-names></name><name><surname>Brindley</surname> <given-names>PJ</given-names></name><name><surname>Berriman</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Halting harmful helminths</article-title><source>Nature</source><volume>168</volume><fpage>168</fpage><lpage>169</lpage><pub-id pub-id-type="doi">10.1126/science.1261139</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hubert</surname> <given-names>L</given-names></name><name><surname>Arabie</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Comparing partitions</article-title><source>Journal of Classification</source><volume>2</volume><fpage>193</fpage><lpage>218</lpage><pub-id pub-id-type="doi">10.1007/BF01908075</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiselev</surname> <given-names>VY</given-names></name><name><surname>Kirschner</surname> <given-names>K</given-names></name><name><surname>Schaub</surname> <given-names>MT</given-names></name><name><surname>Andrews</surname> <given-names>T</given-names></name><name><surname>Yiu</surname> <given-names>A</given-names></name><name><surname>Chandra</surname> <given-names>T</given-names></name><name><surname>Natarajan</surname> <given-names>KN</given-names></name><name><surname>Reik</surname> <given-names>W</given-names></name><name><surname>Barahona</surname> <given-names>M</given-names></name><name><surname>Green</surname> <given-names>AR</given-names></name><name><surname>Hemberg</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title><source>Nature Methods</source><volume>14</volume><fpage>483</fpage><lpage>486</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id><pub-id pub-id-type="pmid">28346451</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lane</surname> <given-names>K</given-names></name><name><surname>Van Valen</surname> <given-names>D</given-names></name><name><surname>DeFelice</surname> <given-names>MM</given-names></name><name><surname>Macklin</surname> <given-names>DN</given-names></name><name><surname>Kudo</surname> <given-names>T</given-names></name><name><surname>Jaimovich</surname> <given-names>A</given-names></name><name><surname>Carr</surname> <given-names>A</given-names></name><name><surname>Meyer</surname> <given-names>T</given-names></name><name><surname>Pe'er</surname> <given-names>D</given-names></name><name><surname>Boutet</surname> <given-names>SC</given-names></name><name><surname>Covert</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Measuring signaling and RNA-Seq in the same cell links gene expression to dynamic patterns of NF-κB activation</article-title><source>Cell Systems</source><volume>4</volume><fpage>458</fpage><lpage>469</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2017.03.010</pub-id><pub-id pub-id-type="pmid">28396000</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>TK</given-names></name><name><surname>Denny</surname> <given-names>EM</given-names></name><name><surname>Sanghvi</surname> <given-names>JC</given-names></name><name><surname>Gaston</surname> <given-names>JE</given-names></name><name><surname>Maynard</surname> <given-names>ND</given-names></name><name><surname>Hughey</surname> <given-names>JJ</given-names></name><name><surname>Covert</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A noisy paracrine signal determines the cellular NF- κB response to lipopolysaccharide</article-title><source>Science Signaling</source><volume>2</volume><elocation-id>ra65</elocation-id><pub-id pub-id-type="doi">10.1126/scisignal.2000599</pub-id><pub-id pub-id-type="pmid">19843957</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>H</given-names></name><name><surname>Courtois</surname> <given-names>ET</given-names></name><name><surname>Sengupta</surname> <given-names>D</given-names></name><name><surname>Tan</surname> <given-names>Y</given-names></name><name><surname>Chen</surname> <given-names>KH</given-names></name><name><surname>Goh</surname> <given-names>JJL</given-names></name><name><surname>Kong</surname> <given-names>SL</given-names></name><name><surname>Chua</surname> <given-names>C</given-names></name><name><surname>Hon</surname> <given-names>LK</given-names></name><name><surname>Tan</surname> <given-names>WS</given-names></name><name><surname>Wong</surname> <given-names>M</given-names></name><name><surname>Choi</surname> <given-names>PJ</given-names></name><name><surname>Wee</surname> <given-names>LJK</given-names></name><name><surname>Hillmer</surname> <given-names>AM</given-names></name><name><surname>Tan</surname> <given-names>IB</given-names></name><name><surname>Robson</surname> <given-names>P</given-names></name><name><surname>Prabhakar</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Reference component analysis of single-cell transcriptomes elucidates cellular heterogeneity in human colorectal tumors</article-title><source>Nature Genetics</source><volume>49</volume><fpage>708</fpage><lpage>718</lpage><pub-id pub-id-type="doi">10.1038/ng.3818</pub-id><pub-id pub-id-type="pmid">28319088</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lönnberg</surname> <given-names>T</given-names></name><name><surname>Svensson</surname> <given-names>V</given-names></name><name><surname>James</surname> <given-names>KR</given-names></name><name><surname>Fernandez-Ruiz</surname> <given-names>D</given-names></name><name><surname>Sebina</surname> <given-names>I</given-names></name><name><surname>Montandon</surname> <given-names>R</given-names></name><name><surname>Soon</surname> <given-names>MS</given-names></name><name><surname>Fogg</surname> <given-names>LG</given-names></name><name><surname>Nair</surname> <given-names>AS</given-names></name><name><surname>Liligeto</surname> <given-names>U</given-names></name><name><surname>Stubbington</surname> <given-names>MJ</given-names></name><name><surname>Ly</surname> <given-names>LH</given-names></name><name><surname>Bagger</surname> <given-names>FO</given-names></name><name><surname>Zwiessele</surname> <given-names>M</given-names></name><name><surname>Lawrence</surname> <given-names>ND</given-names></name><name><surname>Souza-Fonseca-Guimaraes</surname> <given-names>F</given-names></name><name><surname>Bunn</surname> <given-names>PT</given-names></name><name><surname>Engwerda</surname> <given-names>CR</given-names></name><name><surname>Heath</surname> <given-names>WR</given-names></name><name><surname>Billker</surname> <given-names>O</given-names></name><name><surname>Stegle</surname> <given-names>O</given-names></name><name><surname>Haque</surname> <given-names>A</given-names></name><name><surname>Teichmann</surname> <given-names>SA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Single-cell RNA-seq and computational analysis using temporal mixture modelling resolves Th1/Tfh fate bifurcation in malaria</article-title><source>Science Immunology</source><volume>2</volume><elocation-id>eaal2192</elocation-id><pub-id pub-id-type="doi">10.1126/sciimmunol.aal2192</pub-id><pub-id pub-id-type="pmid">28345074</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McInnes</surname> <given-names>L</given-names></name><name><surname>Healy</surname> <given-names>J</given-names></name><name><surname>Astels</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Hdbscan: hierarchical density based clustering</article-title><source>The Journal of Open Source Software</source><volume>2</volume><elocation-id>205</elocation-id><pub-id pub-id-type="doi">10.21105/joss.00205</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olsson</surname> <given-names>A</given-names></name><name><surname>Venkatasubramanian</surname> <given-names>M</given-names></name><name><surname>Chaudhri</surname> <given-names>VK</given-names></name><name><surname>Aronow</surname> <given-names>BJ</given-names></name><name><surname>Salomonis</surname> <given-names>N</given-names></name><name><surname>Singh</surname> <given-names>H</given-names></name><name><surname>Grimes</surname> <given-names>HL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Single-cell analysis of mixed-lineage states leading to a binary cell fate choice</article-title><source>Nature</source><volume>537</volume><fpage>698</fpage><lpage>702</lpage><pub-id pub-id-type="doi">10.1038/nature19348</pub-id><pub-id pub-id-type="pmid">27580035</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Peixoto</surname> <given-names>TP</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>The graph-tool python library</data-title></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Picelli</surname> <given-names>S</given-names></name><name><surname>Björklund</surname> <given-names>ÅK</given-names></name><name><surname>Faridani</surname> <given-names>OR</given-names></name><name><surname>Sagasser</surname> <given-names>S</given-names></name><name><surname>Winberg</surname> <given-names>G</given-names></name><name><surname>Sandberg</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title><source>Nature Methods</source><volume>10</volume><fpage>1096</fpage><lpage>1098</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2639</pub-id><pub-id pub-id-type="pmid">24056875</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierson</surname> <given-names>E</given-names></name><name><surname>Yau</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>ZIFA: dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title><source>Genome Biology</source><volume>16</volume><elocation-id>241</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-015-0805-z</pub-id><pub-id pub-id-type="pmid">26527291</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname> <given-names>X</given-names></name><name><surname>Mao</surname> <given-names>Q</given-names></name><name><surname>Tang</surname> <given-names>Y</given-names></name><name><surname>Wang</surname> <given-names>L</given-names></name><name><surname>Chawla</surname> <given-names>R</given-names></name><name><surname>Pliner</surname> <given-names>HA</given-names></name><name><surname>Trapnell</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title><source>Nature Methods</source><volume>14</volume><fpage>979</fpage><lpage>982</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4402</pub-id><pub-id pub-id-type="pmid">28825705</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Satija</surname> <given-names>R</given-names></name><name><surname>Farrell</surname> <given-names>JA</given-names></name><name><surname>Gennert</surname> <given-names>D</given-names></name><name><surname>Schier</surname> <given-names>AF</given-names></name><name><surname>Regev</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Spatial reconstruction of single-cell gene expression data</article-title><source>Nature Biotechnology</source><volume>33</volume><fpage>495</fpage><lpage>502</lpage><pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwalie</surname> <given-names>PC</given-names></name><name><surname>Dong</surname> <given-names>H</given-names></name><name><surname>Zachara</surname> <given-names>M</given-names></name><name><surname>Russeil</surname> <given-names>J</given-names></name><name><surname>Alpern</surname> <given-names>D</given-names></name><name><surname>Akchiche</surname> <given-names>N</given-names></name><name><surname>Caprara</surname> <given-names>C</given-names></name><name><surname>Sun</surname> <given-names>W</given-names></name><name><surname>Schlaudraff</surname> <given-names>KU</given-names></name><name><surname>Soldati</surname> <given-names>G</given-names></name><name><surname>Wolfrum</surname> <given-names>C</given-names></name><name><surname>Deplancke</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A stromal cell population that inhibits adipogenesis in mammalian fat depots</article-title><source>Nature</source><volume>559</volume><fpage>103</fpage><lpage>108</lpage><pub-id pub-id-type="doi">10.1038/s41586-018-0226-8</pub-id><pub-id pub-id-type="pmid">29925944</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Setty</surname> <given-names>M</given-names></name><name><surname>Tadmor</surname> <given-names>MD</given-names></name><name><surname>Reich-Zeliger</surname> <given-names>S</given-names></name><name><surname>Angel</surname> <given-names>O</given-names></name><name><surname>Salame</surname> <given-names>TM</given-names></name><name><surname>Kathail</surname> <given-names>P</given-names></name><name><surname>Choi</surname> <given-names>K</given-names></name><name><surname>Bendall</surname> <given-names>S</given-names></name><name><surname>Friedman</surname> <given-names>N</given-names></name><name><surname>Pe'er</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Wishbone identifies bifurcating developmental trajectories from single-cell data</article-title><source>Nature Biotechnology</source><volume>34</volume><fpage>637</fpage><lpage>645</lpage><pub-id pub-id-type="doi">10.1038/nbt.3569</pub-id><pub-id pub-id-type="pmid">27136076</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soneson</surname> <given-names>C</given-names></name><name><surname>Robinson</surname> <given-names>MD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title><source>Nature Methods</source><volume>15</volume><fpage>255</fpage><lpage>261</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4612</pub-id><pub-id pub-id-type="pmid">29481549</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Subramanian</surname> <given-names>A</given-names></name><name><surname>Tamayo</surname> <given-names>P</given-names></name><name><surname>Mootha</surname> <given-names>VK</given-names></name><name><surname>Mukherjee</surname> <given-names>S</given-names></name><name><surname>Ebert</surname> <given-names>BL</given-names></name><name><surname>Gillette</surname> <given-names>MA</given-names></name><name><surname>Paulovich</surname> <given-names>A</given-names></name><name><surname>Pomeroy</surname> <given-names>SL</given-names></name><name><surname>Golub</surname> <given-names>TR</given-names></name><name><surname>Lander</surname> <given-names>ES</given-names></name><name><surname>Mesirov</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title><source>PNAS</source><volume>102</volume><fpage>15545</fpage><lpage>15550</lpage><pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id><pub-id pub-id-type="pmid">16199517</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Tarashansky</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><source>The Self-Assembling-Manifold (SAM) Algorithm</source><version designator="1cfe50c">1cfe50c</version><publisher-name>Github</publisher-name><ext-link ext-link-type="uri" xlink:href="https://github.com/atarashansky/self-assembling-manifold">https://github.com/atarashansky/self-assembling-manifold</ext-link></element-citation></ref><ref id="bib33"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Tavenard</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><source>Tslearn: A Machine Learning Toolkit Dedicated to Time-Series Data</source></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname> <given-names>L</given-names></name><name><surname>Dong</surname> <given-names>X</given-names></name><name><surname>Freytag</surname> <given-names>S</given-names></name><name><surname>Lê Cao</surname> <given-names>KA</given-names></name><name><surname>Su</surname> <given-names>S</given-names></name><name><surname>JalalAbadi</surname> <given-names>A</given-names></name><name><surname>Amann-Zalcenstein</surname> <given-names>D</given-names></name><name><surname>Weber</surname> <given-names>TS</given-names></name><name><surname>Seidi</surname> <given-names>A</given-names></name><name><surname>Jabbari</surname> <given-names>JS</given-names></name><name><surname>Naik</surname> <given-names>SH</given-names></name><name><surname>Ritchie</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Benchmarking single cell RNA-sequencing analysis pipelines using mixture control experiments</article-title><source>Nature Methods</source><volume>16</volume><fpage>479</fpage><lpage>487</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0425-8</pub-id><pub-id pub-id-type="pmid">31133762</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname> <given-names>C</given-names></name><name><surname>Cacchiarelli</surname> <given-names>D</given-names></name><name><surname>Grimsby</surname> <given-names>J</given-names></name><name><surname>Pokharel</surname> <given-names>P</given-names></name><name><surname>Li</surname> <given-names>S</given-names></name><name><surname>Morse</surname> <given-names>M</given-names></name><name><surname>Lennon</surname> <given-names>NJ</given-names></name><name><surname>Livak</surname> <given-names>KJ</given-names></name><name><surname>Mikkelsen</surname> <given-names>TS</given-names></name><name><surname>Rinn</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title><source>Nature Biotechnology</source><volume>32</volume><fpage>381</fpage><lpage>386</lpage><pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id><pub-id pub-id-type="pmid">24658644</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Treutlein</surname> <given-names>B</given-names></name><name><surname>Brownfield</surname> <given-names>DG</given-names></name><name><surname>Wu</surname> <given-names>AR</given-names></name><name><surname>Neff</surname> <given-names>NF</given-names></name><name><surname>Mantalas</surname> <given-names>GL</given-names></name><name><surname>Espinoza</surname> <given-names>FH</given-names></name><name><surname>Desai</surname> <given-names>TJ</given-names></name><name><surname>Krasnow</surname> <given-names>MA</given-names></name><name><surname>Quake</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title><source>Nature</source><volume>509</volume><fpage>371</fpage><lpage>375</lpage><pub-id pub-id-type="doi">10.1038/nature13173</pub-id><pub-id pub-id-type="pmid">24739965</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallejos</surname> <given-names>CA</given-names></name><name><surname>Marioni</surname> <given-names>JC</given-names></name><name><surname>Richardson</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>BASiCS: bayesian analysis of Single-Cell sequencing data</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004333</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004333</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallejos</surname> <given-names>CA</given-names></name><name><surname>Risso</surname> <given-names>D</given-names></name><name><surname>Scialdone</surname> <given-names>A</given-names></name><name><surname>Dudoit</surname> <given-names>S</given-names></name><name><surname>Marioni</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Normalizing single-cell RNA sequencing data: challenges and opportunities</article-title><source>Nature Methods</source><volume>14</volume><fpage>565</fpage><lpage>571</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4292</pub-id><pub-id pub-id-type="pmid">28504683</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>B</given-names></name><name><surname>Collins</surname> <given-names>JJ</given-names></name><name><surname>Newmark</surname> <given-names>PA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Functional genomic characterization of neoblast-like stem cells in larval <italic>Schistosoma mansoni</italic></article-title><source>eLife</source><volume>2</volume><elocation-id>e00768</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00768</pub-id><pub-id pub-id-type="pmid">23908765</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>B</given-names></name><name><surname>Zhu</surname> <given-names>J</given-names></name><name><surname>Pierson</surname> <given-names>E</given-names></name><name><surname>Ramazzotti</surname> <given-names>D</given-names></name><name><surname>Batzoglou</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Visualization and analysis of single-cell RNA-seq data by kernel-based similarity learning</article-title><source>Nature Methods</source><volume>14</volume><fpage>414</fpage><lpage>416</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4207</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>B</given-names></name><name><surname>Lee</surname> <given-names>J</given-names></name><name><surname>Li</surname> <given-names>P</given-names></name><name><surname>Saberi</surname> <given-names>A</given-names></name><name><surname>Yang</surname> <given-names>H</given-names></name><name><surname>Liu</surname> <given-names>C</given-names></name><name><surname>Zhao</surname> <given-names>M</given-names></name><name><surname>Newmark</surname> <given-names>PA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Stem cell heterogeneity drives the parasitic life cycle of <italic>Schistosoma mansoni</italic></article-title><source>eLife</source><volume>7</volume><elocation-id>e35449</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.35449</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watts</surname> <given-names>DJ</given-names></name><name><surname>Strogatz</surname> <given-names>SH</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Collective dynamics of 'small-world' networks</article-title><source>Nature</source><volume>393</volume><fpage>440</fpage><lpage>442</lpage><pub-id pub-id-type="doi">10.1038/30918</pub-id><pub-id pub-id-type="pmid">9623998</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wendt</surname> <given-names>GR</given-names></name><name><surname>Collins</surname> <given-names>JN</given-names></name><name><surname>Pei</surname> <given-names>J</given-names></name><name><surname>Pearson</surname> <given-names>MS</given-names></name><name><surname>Bennett</surname> <given-names>HM</given-names></name><name><surname>Loukas</surname> <given-names>A</given-names></name><name><surname>Berriman</surname> <given-names>M</given-names></name><name><surname>Grishin</surname> <given-names>NV</given-names></name><name><surname>Collins</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Flatworm-specific transcriptional regulators promote the specification of tegumental progenitors in <italic>Schistosoma mansoni</italic></article-title><source>eLife</source><volume>7</volume><elocation-id>e33221</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.33221</pub-id><pub-id pub-id-type="pmid">29557781</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Witchley</surname> <given-names>JN</given-names></name><name><surname>Mayer</surname> <given-names>M</given-names></name><name><surname>Wagner</surname> <given-names>DE</given-names></name><name><surname>Owen</surname> <given-names>JH</given-names></name><name><surname>Reddien</surname> <given-names>PW</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Muscle cells provide instructions for planarian regeneration</article-title><source>Cell Reports</source><volume>4</volume><fpage>633</fpage><lpage>641</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2013.07.022</pub-id><pub-id pub-id-type="pmid">23954785</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname> <given-names>FA</given-names></name><name><surname>Angerer</surname> <given-names>P</given-names></name><name><surname>Theis</surname> <given-names>FJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title><source>Genome Biology</source><volume>19</volume><fpage>1</fpage><lpage>5</lpage><pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id><pub-id pub-id-type="pmid">29409532</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname> <given-names>C</given-names></name><name><surname>Su</surname> <given-names>Z</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Identification of cell types from single-cell transcriptomes using a novel clustering method</article-title><source>Bioinformatics</source><volume>31</volume><fpage>1974</fpage><lpage>1980</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv088</pub-id><pub-id pub-id-type="pmid">25805722</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Žurauskienė</surname> <given-names>J</given-names></name><name><surname>Yau</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>pcaReduce: hierarchical clustering of single cell transcriptional profiles</article-title><source>BMC Bioinformatics</source><volume>17</volume><fpage>140</fpage><pub-id pub-id-type="doi">10.1186/s12859-016-0984-y</pub-id><pub-id pub-id-type="pmid">27005807</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.48994.125</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Shalek</surname><given-names>Alex K</given-names></name><role>Reviewing Editor</role><aff><institution>Broad Institute of MIT and Harvard</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Yanai</surname><given-names>Itai</given-names> </name><role>Reviewer</role><aff><institution/><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Self-assembling manifolds in single-cell RNA sequencing data&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by Alex K. Shalek as the Reviewing Editor and Naama Barkai as the Senior Editor. The following individual involved in the review of your submission has agreed to reveal their identity: Itai Yanai (Reviewer #1).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Tarashansky et al. detail a computational algorithm called SAM (Self-Assembling Manifold) that helps to identify meaningful clusters within single-cell RNA-Seq data. SAM iteratively re-weights gene expression by importance (as determined by variation across neighborhoods rather than individual cells) until convergence; the resulting nearest neighbor graph is then used for clustering, and gene weights can be used to indicate biological significance. The authors benchmark SAM using previously published data as well as a self-generated Schistosoma dataset that had proven difficult to cluster using existing methods. Overall, the manuscript is well written and the algorithm has the potential to be impactful.</p><p>Essential revisions:</p><p>• The authors should provide better documentation on SAM to make the scripts more understandable to a general audience and aid in its application to new datasets. Specific guidelines on the selection of variable parameters (e.g., SAM weight cutoffs; illustrated through the presented examples) are particularly important, as is examination of the extent to which SAM is confounded by integrating data across batches and methods. More example applications should be included in the documentation, as well as in-depth function descriptions.</p><p>• A more comprehensive analysis of the parameter space for some of the existing methods (e.g., Seurat) should be performed to properly benchmark SAM. Utilizing data for which ground truth is known could be particularly illuminating. The authors should also discuss under what conditions SAM performs well to help guide its implementation.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.48994.126</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>• The authors should provide better documentation on SAM to make the scripts more understandable to a general audience and aid in its application to new datasets. Specific guidelines on the selection of variable parameters (e.g., SAM weight cutoffs; illustrated through the presented examples) are particularly important, as is examination of the extent to which SAM is confounded by integrating data across batches and methods. More example applications should be included in the documentation, as well as in-depth function descriptions.</p></disp-quote><p>We have included numerous tutorials to the Github repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/atarashansky/self-assembling-manifold/tree/master/tutorial">https://github.com/atarashansky/self-assembling-manifold/tree/master/tutorial</ext-link>) describing in detail the various functions, parameters, attributes, data structures, and applications of the SAM package. Additionally, we have included documentation (docstrings) for all functions available to the users in the SAM package.</p><p>SAM is generally robust to the choice of parameters. All datasets in this study were analyzed using default parameters. Nevertheless, in the Materials and methods section we now explain that data preprocessing methods may affect SAM analysis. Briefly, we have found that standardization performs well with large, sparse datasets that are expected to contain many expected subpopulations, whereas L2-normalization is more suitable for smaller datasets with fewer subpopulations. We have also added an in-depth Jupyter notebook tutorial to the Github illustrating how the analysis might change when varying the parameters, which include data preprocessing method, number of nearest neighbors in the graph, distance metric, and gene weight normalization, although we have never needed to change these parameters in practice. Additionally, we have developed an interactive user interface that facilitates the convenient exploration of single cell data and SAM parameters (Figure 1—figure supplement 2). A Jupyter notebook tutorial explaining how to use the interface is provided as well.</p><p>Like almost all single-cell manifold reconstruction methods, SAM is susceptible to batch and cell cycle effects. However, we have shown examples (Figure 2f and Figure 6) that use existing batch correction method and gene set enrichment analysis in conjunction with SAM to correct for these effects. Additionally, we now provide detailed Jupyter notebooks recapitulating our analyses of the schistosome stem cell data, which contain two different batches, and activated macrophage data, which is severely biased by cell cycle effects, to the tutorial section of the Github repository.</p><disp-quote content-type="editor-comment"><p>• A more comprehensive analysis of the parameter space for some of the existing methods (e.g., Seurat) should be performed to properly benchmark SAM. Utilizing data for which ground truth is known could be particularly illuminating. The authors should also discuss under what conditions SAM performs well to help guide its implementation.</p></disp-quote><p>We ran a parameter sweep on the Seurat parameters including the number of Highly Variable Genes (HVGs) and the number of principal components to include in the analysis on each of the nine benchmarking datasets. For each dataset, we selected the parameters with the highest clustering accuracy measured by ARI and added these results to Figure 3a. Even with this extensive parameter sweeping, which is impossible to perform on an experimental dataset with no available ground truth labels, for five out of nine benchmarking datasets, SAM still has the highest clustering accuracy. On the remaining four datasets, both Seurat and SAM have near-perfect clustering accuracy. Furthermore, in the corruption test, Seurat run with optimized parameters is no more robust than Seurat run with default parameters (Figure 5).</p><p>With extensive benchmarking (Figure 3-5) on nine gold standard benchmarking datasets, another 47 experimental datasets, and numerous simulated datasets, there is sufficient evidence to support that SAM performs generally well applied to both ‘simple’ and ‘challenging’ datasets.</p></body></sub-article></article>