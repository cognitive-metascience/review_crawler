<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">24656</article-id><article-id pub-id-type="doi">10.7554/eLife.24656</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Multi-neuron intracellular recording in vivo via interacting autopatching robots</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-77821"><name><surname>Kodandaramaiah</surname><given-names>Suhasa B</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7767-2644</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund9"/><xref ref-type="other" rid="fund10"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa1">§</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-34323"><name><surname>Flores</surname><given-names>Francisco J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8974-9717</contrib-id><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-86681"><name><surname>Holst</surname><given-names>Gregory L</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-86686"><name><surname>Singer</surname><given-names>Annabelle C</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa2">#</xref></contrib><contrib contrib-type="author" id="author-51418"><name><surname>Han</surname><given-names>Xue</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3896-4609</contrib-id><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-6386"><name><surname>Brown</surname><given-names>Emery N</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="other" rid="fund7"/><xref ref-type="other" rid="fund8"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-7848"><name><surname>Boyden</surname><given-names>Edward S</given-names></name><email>esb@media.mit.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-63834"><name><surname>Forest</surname><given-names>Craig R</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5343-1769</contrib-id><email>cforest@gatech.edu</email><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Media Lab</institution><institution>Massachusetts Institute of Technology</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">McGovern Institute for Brain Research</institution><institution>Massachusetts Institute of Technology</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Department of Biological Engineering</institution><institution>Massachusetts Institute of Technology</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">G.W. Woodruff School of Mechanical Engineering</institution><institution>Georgia Institute of Technology</institution><addr-line><named-content content-type="city">Atlanta</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Department of Anesthesia, Critical Care and Pain Medicine</institution><institution>Massachusetts General Hospital</institution><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff><aff id="aff6"><label>6</label><institution content-type="dept">Picower Institute for Memory and Learning</institution><institution>Massachusetts Institute of Technology</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff7"><label>7</label><institution content-type="dept">Department of Biomedical Engineering</institution><institution>Boston University</institution><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff><aff id="aff8"><label>8</label><institution content-type="dept">Institute for Medical Engineering and Science</institution><institution>Massachusetts Institute of Technology</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-14601"><name><surname>King</surname><given-names>Andrew J</given-names></name><role>Reviewing Editor</role><aff id="aff9"><institution>University of Oxford</institution><country>United Kingdom</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>§</label><p>Department of Mechanical Engineering, University of Minnesota-Twin Cities, Minneapolis, United States</p></fn><fn fn-type="present-address" id="pa2"><label>#</label><p>Coulter Department of Biomedical Engineering, Georgia Institute of Technology and Emory University, Atlanta, United States</p></fn><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="con" id="equal-contrib2"><label>‡</label><p>These authors also contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>03</day><month>01</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>7</volume><elocation-id>e24656</elocation-id><history><date date-type="received" iso-8601-date="2016-12-24"><day>24</day><month>12</month><year>2016</year></date><date date-type="accepted" iso-8601-date="2017-12-19"><day>19</day><month>12</month><year>2017</year></date></history><permissions><copyright-statement>© 2018, Kodandaramaiah et al</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>Kodandaramaiah et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-24656-v3.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.24656.001</object-id><p>The activities of groups of neurons in a circuit or brain region are important for neuronal computations that contribute to behaviors and disease states. Traditional extracellular recordings have been powerful and scalable, but much less is known about the intracellular processes that lead to spiking activity. We present a robotic system, the multipatcher, capable of automatically obtaining blind whole-cell patch clamp recordings from multiple neurons simultaneously. The multipatcher significantly extends automated patch clamping, or 'autopatching’, to guide four interacting electrodes in a coordinated fashion, avoiding mechanical coupling in the brain. We demonstrate its performance in the cortex of anesthetized and awake mice. A multipatcher with four electrodes took an average of 10 min to obtain dual or triple recordings in 29% of trials in anesthetized mice, and in 18% of the trials in awake mice, thus illustrating practical yield and throughput to obtain multiple, simultaneous whole-cell recordings in vivo.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>Automation</kwd><kwd>patch clamping</kwd><kwd>In vivo</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100003194</institution-id><institution>New York Stem Cell Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Boyden</surname><given-names>Edward S</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Holst</surname><given-names>Gregory L</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Boyden</surname><given-names>Edward S</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01 EY023173</award-id><principal-award-recipient><name><surname>Forest</surname><given-names>Craig R</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01-GM104948</award-id><principal-award-recipient><name><surname>Brown</surname><given-names>Emery N</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>P01-GM118620</award-id><principal-award-recipient><name><surname>Brown</surname><given-names>Emery N</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100005294</institution-id><institution>Massachusetts General Hospital</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Brown</surname><given-names>Emery N</given-names></name></principal-award-recipient></award-group><award-group id="fund8"><funding-source><institution-wrap><institution>Picower Institue for Learning and Memory</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Brown</surname><given-names>Emery N</given-names></name></principal-award-recipient></award-group><award-group id="fund9"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>1R21NS103098-01</award-id><principal-award-recipient><name><surname>Kodandaramaiah</surname><given-names>Suhasa B</given-names></name></principal-award-recipient></award-group><award-group id="fund10"><funding-source><institution-wrap><institution>McGovern Institute Neurotechnology Fund</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Kodandaramaiah</surname><given-names>Suhasa B</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A robot capable of automatically obtaining blind whole cell patch clamp recordings from multiple neurons simultaneously guides four interacting electrodes in a coordinated fashion, avoiding mechanical coupling in the brain.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Mammalian brains consist of neurons organized into densely interconnected circuits. Traditionally circuit-level characterization of neuronal activities has been carried out using extracellular recording probes (<xref ref-type="bibr" rid="bib2">Buzsáki, 2004</xref>) or using genetically encoded calcium indicators (<xref ref-type="bibr" rid="bib4">Chen et al., 2013</xref>). While these methods reveal supra-threshold spiking activities of individual neurons in a circuit, they cannot examine synaptic and subthreshold events in neurons, important for understanding the processes within and between cells that lead to spiking. While a few studies have performed simultaneous multi-neuron intracellular recordings in vivo (<xref ref-type="bibr" rid="bib28">van Welie et al., 2016</xref>; <xref ref-type="bibr" rid="bib12">Jouhanneau et al., 2015</xref>; <xref ref-type="bibr" rid="bib23">Poulet and Petersen, 2008</xref>), the difficulty of the technique limits its use.</p><p>Recently we developed a robot, called the 'autopatcher', that performs fully-automated whole-cell patch clamping of single neurons in the living mouse brain (<xref ref-type="bibr" rid="bib13">Kodandaramaiah et al., 2012</xref>; <xref ref-type="bibr" rid="bib14">Kodandaramaiah et al., 2016</xref>). The autopatcher uses pipette impedance measurements to hunt for neurons, followed by gigasealing and break-in using electronically controlled pressure regulators. We explored several straightforward attempts to scale up this approach to achieve multi-neuron recordings, but they exhibited very low yield. From these pilot studies, we hypothesized that robots engaged in stationary activities, such as the delicate task of gigasealing, would be disrupted by robots engaged in motion, such as during the task of neuron hunting. Therefore, an optimal combination of hardware and software should optimize the interaction between stationary and active tasks across pipettes.</p><p>We thus devised interactions between multiple autonomous patch robots, such that when one was attempting a stationary task, the others would wait before moving. Using this approach, we controlled a four electrode multipatcher robot and used it to perform multi-neuron recordings in the somatosensory and visual cortices of anesthetized mice, and the somatosensory cortex of the awake mouse. Under anesthetized conditions, the multipatcher robot obtained dual or triple whole-cell recordings in 29% of trials, and at least one whole-cell recording in 90% of trials. An individual robot had the same whole-cell yield when used in our multipatcher robot as it did when working alone (31%). In awake mice the multipatcher obtained dual or triple whole-cell recordings in 18% of the trials. The robot took 10.5 <inline-formula><mml:math id="inf1"><mml:mo>±</mml:mo></mml:math></inline-formula>2.6 min to complete each trial (summary statistics given as mean <inline-formula><mml:math id="inf2"><mml:mo>±</mml:mo></mml:math></inline-formula> S.D. throughout the paper, unless otherwise noted), with recordings lasting 14.0 <inline-formula><mml:math id="inf3"><mml:mo>±</mml:mo></mml:math></inline-formula>10.0 min in the awake head-fixed mouse. Thus, the multipatcher is a practical solution for performing intracellular recordings from multiple neurons in the intact brain.</p><sec id="s1-1"><title>Multipatcher hardware</title><p>The multipatcher robot was built by extending some of the hardware components of our previously described autopatcher robot (<xref ref-type="bibr" rid="bib13">Kodandaramaiah et al., 2012</xref>). It consists of an array of four robotic arms for manipulating the patch recording pipettes, patch amplifiers, a signal control box, a computer with an interface board, and a pressure control box (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s2">2</xref>, and <xref ref-type="supplementary-material" rid="supp1">Supplementary files 1</xref>, <xref ref-type="supplementary-material" rid="supp2">2</xref> and <xref ref-type="supplementary-material" rid="supp3">3</xref>). The pipette arms' actuators and motors allowed programmatic control of the pipettes' positions during robot operation. The four arms were arranged in a radial array (<xref ref-type="fig" rid="fig2">Figure 2c</xref>) to enable tips of patch pipettes to be positioned and manipulated within 50 <inline-formula><mml:math id="inf4"><mml:mi>μ</mml:mi></mml:math></inline-formula>m of each other inside the brain. The internal pressures of the patch pipettes were independently controlled using the pressure control box (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.24656.002</object-id><label>Figure 1.</label><caption><title>Multipatching robot: hardware architecture.</title><p>(<bold>a</bold>) Schematic of multipatching robot used for obtaining whole-cell patch recordings from multiple neurons simultaneously in vivo. The system consists of four robotic arms arranged radially and associated signal and pressure control hardware. The pipette, pipette holder and the amplifier headstage are mounted to the robotic arms (see also <xref ref-type="fig" rid="fig2">Figure 2</xref>). Each headstage is connected to a patch amplifier, which routes signals to a computer via two computer interface boards. A computer interface board, located within the main signal control box, also serves to control the pressure regulation device that can apply pressures ranging from −350 to 1000 mBar independently to each patch pipette (see also <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s2">2</xref>).</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24656-fig1-v3"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.24656.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Schematic of the pressure control box.</title><p>The pressure control box was designed to independently apply four possible pressures to each of the four pipettes. The pressure control box received compressed air at approximately 2.75 bar and vacuum pressure at approximately −1.5 bar. It regulated these input pressures to the required pressures using a series of manual and electronically controlled pressure regulators that fed into a pneumatic valve bank. this pneumatic valve bank switched the pipettes between pressure states during the multipatcher operation.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24656-fig1-figsupp1-v3"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.24656.004</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Schematic of the signal control box.</title><p>Within the signal control box, an interface board was connected to the computer executing the multipatcher algorithm via a Universal Serial Bus (USB) datalink. Analog output channels on the interface board were used to send command voltage signals to the amplifiers. Analog input channels were used to read measurements taken from the patch amplifiers. BNC relays were controlled using digital Transistor-Transistor-Logic (TTL) signals to switch the command signal being sent to the patch amplifier between the analog outputs on the computer interface board and the analog outputs on the digitizer. TTL signals, and one analog voltage signal from the interface board were also sent to the pressure control box.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24656-fig1-figsupp2-v3"/></fig></fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.24656.005</object-id><label>Figure 2.</label><caption><title>Computer aided design (CAD) rendering and photographs of the multipatcher.</title><p>(<bold>a</bold>) CAD rendering illustrating details of a single robotic arm that allows 3-axis manual motorized and programmatic control of the pipette's axial position. The pipette is mounted on a pipette holder, which is in turn mounted on a bearing driven by a programmable linear motor. (<bold>b</bold>) Corresponding photograph showing a single robotic arm. Scale bar indicates 50 mm. (<bold>c</bold>) Top view rendering of the array of robotic arms illustrating relative arrangement. (<bold>d</bold>) Side view photograph of the array of robotic arms, with inset showing the arrangement of the pipette tips relative to the head plate affixed to the mouse, the head plate fixation base, and animal warming pad used in anesthetized experiments. Scale bars indicate 25 mm.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24656-fig2-v3"/></fig><sec id="s1-1-1"><title>Robotic arms</title><p>The primary components of a robotic arm include the following: patch pipette, pipette holder, pipette holder extension, and amplifier headstage. The headstage is mounted onto on a programmable linear motor using a custom dovetail adapter plate (PT1-Z8 motor with TDC001 controller, Thorlabs) allowing controlled actuation of the pipette during robot operation (<xref ref-type="fig" rid="fig2">Figure 2a and b</xref>). This programmable linear motor was mounted at an angle of 60<inline-formula><mml:math id="inf5"><mml:msup><mml:mi/><mml:mo>∘</mml:mo></mml:msup></mml:math></inline-formula> (relative to the horizontal plane, <xref ref-type="fig" rid="fig2">Figure 2a</xref>) using a swivel mount adapter (FG-285210, Sutter Instruments) on a manually controlled three-axis manipulator (MPC285, Sutter Instruments) to position the pipette outside the brain. Four such robotic arms were arranged with rotational symmetry (<xref ref-type="fig" rid="fig2">Figure 2c and d</xref>). This arrangement, combined with the ability to precisely open arrays of craniotomies (<xref ref-type="bibr" rid="bib21">Pak et al., 2015</xref>) allowed the tips of patch pipettes to be positioned and manipulated very close to each other (<xref ref-type="fig" rid="fig2">Figure 2d</xref>, inset), as close as 50 <inline-formula><mml:math id="inf6"><mml:mi>μ</mml:mi></mml:math></inline-formula>m between tips when positioned on the brain’s surface.</p></sec><sec id="s1-1-2"><title>Signal control box</title><p>Signals from the amplifier headstages are sent to two dual-channel patch amplifiers (Multiclamp 700B, Molecular Devices). Amplified signals were digitized in two computer interface boards: a computer interface board present inside the signal control box, and an external computer interface board, or digitizer (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). The computer interface board inside the signal control box (cDAQ-9174 chassis with modules NI 9215 for analog inputs, NI 9264 for analog outputs and NI 9375 for digital outputs, National Instruments) was utilized for multipatcher operation and the digitizer (Digidata 1440B, Molecular Devices) was dedicated to data-acquisition after whole-cell patch clamp recordings were obtained. Command signals to each patch amplifier were sent from analog output channels on either the cDAQ-9174 (during the multipatcher operation) or from the digitizer (during whole-cell recording). BNC signaling relays (CX230, Tohtsu) route the command signals from the computer interface board and digitizer to the patch amplifiers. Amplified signals from each patch amplifier were sent simultaneously to the analog input channels in both the computer interface board and the digitizer. During multipatcher operation, real time pipette resistance was computed by acquiring the signals from the patch amplifier for use in the multipatching algorithm.</p></sec><sec id="s1-1-3"><title>Pressure control box</title><p>The pressures applied to the pipettes during the multipatcher operation—high positive pressure, low positive pressure, low suction pressure, and high suction pressure—were controlled using the pressure control box schematized in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>. The pressurized air and vacuum inputs are down regulated and switched to control the pressure applied to the pipettes. This enables independent control of the pressures on each pipette. The output of these electronic pressure regulators (VSO-EV series pressure regulators and OEM-PS1 series vacuum regulators, Parker) is controlled by 0–5 V analog voltage signals using potentiometers on the front panel of the pressure control box. These regulators were used to supply the regulated pressure states to the valve bank. Within the 12-valve bank, a set of 3 three-way solenoid valves (LHDA0533215H-A, Lee Company) were dedicated to each pipette. Each valve was switched using transistor-transistor logic (TTL) signals from the digitizer board, connected to the gates of power MOSFETS. This allows the pressure control box to deliver four pressure states independently to each pipette at various stages (i.e., regional pipette localization, neuron hunting, gigasealing, break-in) of multipatcher operation. In addition to the four pressure states enabled by the pressure control box, one additional state, atmospheric pressure, is controlled by a three-way valve located adjacent to the pipette holder for fast switching. The pressure control is instantiated for each pipette independently.</p></sec></sec><sec id="s1-2"><title>Multipatcher algorithm</title><p>We derived the algorithm for multipatching by iteratively modifying our previously described autopatching algorithm (<xref ref-type="bibr" rid="bib13">Kodandaramaiah et al., 2012</xref>). We iterated through several strategies for hardware and algorithmic control to maximize scaling, yield, and throughput. However, several steps are common to all the strategies (<xref ref-type="fig" rid="fig3">Figure 3a</xref>): First, the experimenter installs freshly pulled patch pipettes filled with intracellular pipette solution into all robotic arms, coarsely aligns the pipettes over a single craniotomy, and initiates the computer program used to control the multipatcher robot (time point i, <xref ref-type="fig" rid="fig3">Figure 3a</xref>). The multipatcher robot then performs an initial assessment of the pipettes' resistances to ensure their resistances are in the acceptable range (3–9 M<inline-formula><mml:math id="inf7"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula>) (<xref ref-type="bibr" rid="bib14">Kodandaramaiah et al., 2016</xref>). For pipettes that are found to be satisfactory, their positions above the brain surface are noted and all further positions during robot operation are referenced from these initial starting points. The pipettes are then lowered to the desired depths at a speed of <inline-formula><mml:math id="inf8"><mml:mo>∼</mml:mo></mml:math></inline-formula>200 <inline-formula><mml:math id="inf9"><mml:mi>μ</mml:mi></mml:math></inline-formula>m/s while applying high positive pressure. Pipettes in different robot arms can be lowered to different depths, thereby allowing simultaneous recordings, for example, from different layers of the cortex, or even different regions of the brain (time ii, <xref ref-type="fig" rid="fig3">Figure 3a</xref>). Once lowered to depth, the pressures in the pipettes are decreased to low positive pressure (20–25 mBar) and the pipette resistances are compared to their resistances recorded outside the brain. If resistance increases greater than 0.35 M<inline-formula><mml:math id="inf10"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> are detected in any of the pipettes, their tips are deemed blocked or fouled and those pipettes are depressurized to atmospheric pressure and their actuator arms deactivated (time iii, <xref ref-type="fig" rid="fig3">Figure 3a</xref>). This is analogous to the ”regional pipette localization’ step in the original autopatcher algorithm (<xref ref-type="bibr" rid="bib13">Kodandaramaiah et al., 2012</xref>).</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.24656.006</object-id><label>Figure 3.</label><caption><title>Development of the multipatcher algorithm.</title><p>(<bold>a</bold>) The initial steps of the multipatcher algorithm: (i) The experimenter manually positioned the pipettes in contact with the cortical surface. (ii) The robot automatically lowered all pipettes to the desired target region in the brain. (iii) Clogged pipettes were detected and deactivated (grayed out pipette). The pipettes that were still active continued seeking for neurons. The black box in iii denotes the region zoomed in in the next figure panels. (<bold>b</bold>) Schematic of the first development iteration: (iv) active pipettes continued hunting for neurons. (v) whenever a pipette encountered a neuron (red box) the corresponding motor was deactivated, while the rest continued seeking for neurons. (vi) in this example, all active pipettes have made contact with neurons (red boxes). (vii) gigasealing was attempted simultaneously in all pipettes, by releasing positive pressure, applying suction pressure and applying hyperpolarizing voltages synchronously. (viii) Breaking-in was then attempted synchronously in all cells with successful gigaseals. (<bold>c</bold>) Schematic of the second development iteration: (iv) active pipettes continued hunting for neurons, moving at steps of 2 <inline-formula><mml:math id="inf11"><mml:mi>μ</mml:mi></mml:math></inline-formula>m. (v) each time a pipette encountered a neuron, it was retracted back by 30 <inline-formula><mml:math id="inf12"><mml:mi>μ</mml:mi></mml:math></inline-formula>m (black arrow), and held in that position. (vi) once all pipettes had performed this step, all pipettes were simultaneously lowered down to the positions where they had previously encountered neurons (black arrows). (vii) synchronous gigasealing was attempted. (viii) synchronous break-in was attempted in all gigasealed neurons. (<bold>d</bold>) Third and final development iteration: (iv) The multipatcher moved the pipettes simultaneously at 2 <inline-formula><mml:math id="inf13"><mml:mi>μ</mml:mi></mml:math></inline-formula>m steps (black arrows). (v) when a pipette detected a neuron, all pipettes were halted. (vi) gigasealing was attempted on the single pipette that had detected a neuron. (vii) After the gigasealing procedure was completed, whether successful or not, the remaining pipettes resumed neuron hunting. Steps iv to vi were repeated until gigasealing had been attempted on all active pipettes. (vii) pipettes with resistance greater than 1 G<inline-formula><mml:math id="inf14"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> were selected by the algorithm to continue to break-in stage. (viii) Break-in was performed simultaneously on all gigasealed neurons.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24656-fig3-v3"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.24656.007</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Schematics of valve bank’s configurations across the different iterations of the algorithm.</title><p>(<bold>a</bold>) Configuration of valve bank used for applying pressure states to the pipettes within the algorithm iterations shown in <xref ref-type="fig" rid="fig3">Figure 3a and b</xref>. With all pressure state switching events synchronized in all pipettes, a single valve bank was used to supply pressure in parallel to each pipettes. (<bold>b</bold>) The final algorithm (<xref ref-type="fig" rid="fig3">Figure 3c</xref>) required a valve bank dedicated to each pipette to account for asynchronous switching of the pressures states.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24656-fig3-figsupp1-v3"/></fig></fig-group><p>After regional pipette localization, the first algorithm development strategy was the simplest to implement from a hardware design standpoint: a pressure control box with a single pneumatic valve bank to control pressure state-switching in all the pipettes (<xref ref-type="fig" rid="fig3">Figure 3b</xref> and <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). This required an algorithm that accommodated synchronized pressure state switching events in all pipettes. Hence, we first implemented a simple extension of the autopatcher algorithm (<xref ref-type="bibr" rid="bib13">Kodandaramaiah et al., 2012</xref>), as shown in <xref ref-type="fig" rid="fig3">Figure 3b</xref>. After regional pipette localization (time iii, <xref ref-type="fig" rid="fig3">Figure 3a</xref>), active pipettes proceeded to neuron hunting. Once a neuron was detected, the corresponding motor was deactivated and the rest of the pipettes continued neuron hunting, until all pipettes encountered neurons. Pressure in all pipettes was simultaneously released and gigasealing was attempted in a manner identical to the autopatcher. In 19 trials (n = 3 mice) where three or more active pipettes performed the neuron hunting and gigasealing tasks, the multipatcher established successful gigaseals 22% of the time (15/68 pipettes, 19 trials; 8/76 pipettes were deactivated at the end of regional pipette localization stage due to tip blockage). The pipettes reaching neurons last, and thereby attempting to establish gigaseal immediately, successfully formed gigaseals 36.8% of the time (7/19 pipettes). In the rest of attempts, successful gigaseals were formed 16.3% of the time (8/49 pipettes). Thus waiting significantly lowered gigaseal yield relative to both not waiting and previously reported gigaseal yields (<xref ref-type="bibr" rid="bib28">van Welie et al., 2016</xref>).</p><p>We analyzed the resistance measurements for these ”waiting’ pipettes and found that in some of them, while waiting for other pipettes, their resistance had fallen to the pipette resistance measured before contact with a neuron (20% of the time, 10/49 trials). This indicates that tissue displacements, caused perhaps by either motion of other pipettes in the brain or the force of the ejected intracellular pipette solution, was large enough to dislodge neurons. Further, only 20.5%, 8 out of the remaining 39 pipettes, established successful gigaseals, even when elevated resistance readings, indicating proximity to a neuron, were observed. We hypothesized that the constant exposure to the intracellular pipette solution while waiting possibly had a deleterious effect on the neurons, resulting in lower rates of gigasealing.</p><p>Other issues encountered during this strategy were that the movement of pipette actuator arms during neuron hunting resulted in electrical noise, and when coincident with the resistance measurements in other channels, resulted in spurious readings. Thus, the resistance measurements in all channels needed to be synchronized when pipettes were performing neuron hunting. Also, this approach did not take into consideration brain tissue displacement caused by the motion of multiple pipettes in brain. Since encountering a neuron during blind in vivo patch clamping is a random process, multiple autopatchers running independently encounter neurons at different times. This could cause a problem, for example during gigasealing (<xref ref-type="bibr" rid="bib6">DeWeese, 2007</xref>), when it is critical to prevent any relative motion between the pipette tip and the cell. This highlights the need for a robotic arm interaction strategy: some steps should be synchronous to prioritize throughput, while other steps should be independent to prioritize yield.</p><p>We therefore implemented a second algorithm, shown in 3 c. This algorithm proceeded along the same lines as the previous one, until a neuron was encountered at one of the channels, at which time, the pipette was retracted by 30 <inline-formula><mml:math id="inf15"><mml:mi>μ</mml:mi></mml:math></inline-formula>m and stopped. We chose a value of 30 <inline-formula><mml:math id="inf16"><mml:mi>μ</mml:mi></mml:math></inline-formula>m because that was the minimum distance the pipettes needed to be retracted before the resistance measurement decreased to the average baseline value (n = 15 trials). This process was repeated for all the active pipettes, such that at the end of neuron hunting the relative positions of all the pipettes and the corresponding neurons they encountered were the same. As a final neuron-hunting step, all pipettes were moved forward by the same distance (30 <inline-formula><mml:math id="inf17"><mml:mi>μ</mml:mi></mml:math></inline-formula>m), and gigasealing attempted synchronously. This algorithm yielded a success rate for gigasealing of <inline-formula><mml:math id="inf18"><mml:mo>∼</mml:mo></mml:math></inline-formula>20% (12/59 pipettes in 17 trials, with nine pipettes deactivated at the end of regional pipette localization stage due to tip blockage). Again, this was much less than what we would expect when using the autopatcher robot. We analyzed the resistance measurement traces for this algorithm and found that after the final neuron hunting step, when all pipettes advanced forward by 30 <inline-formula><mml:math id="inf19"><mml:mi>μ</mml:mi></mml:math></inline-formula>m, resistances went back to the elevated values indicated by contact with neurons in only 45.7% (27/59 pipettes), likely due to tissue displacement.</p><p>The two development iterations described above had synchronous pressure state switching events in all pipettes. This allowed a single pneumatic valve bank (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1a</xref>) to perform the pressure state switching and simultaneously supply the pressure states to all pipettes in parallel. In the third iteration, we decided to perform the gigasealing operation immediately upon detection of a neuron in any one of the pipettes. As it has been observed previously, once either the gigasealed cell attached or whole-cell stage has been achieved, the configuration is remarkably stable against motion artifacts. This has been used previously to record in the whole-cell state from head-fixed rodents (<xref ref-type="bibr" rid="bib23">Poulet and Petersen, 2008</xref>; <xref ref-type="bibr" rid="bib13">Kodandaramaiah et al., 2012</xref>; <xref ref-type="bibr" rid="bib14">Kodandaramaiah et al., 2016</xref>; <xref ref-type="bibr" rid="bib3">Chabrol et al., 2015</xref>; <xref ref-type="bibr" rid="bib18">Margrie et al., 2002</xref>; <xref ref-type="bibr" rid="bib19">Margrie et al., 2003</xref>) and freely moving animals (<xref ref-type="bibr" rid="bib8">Epsztein et al., 2010</xref>; <xref ref-type="bibr" rid="bib16">Lee et al., 2009</xref>; <xref ref-type="bibr" rid="bib17">Lee et al., 2014</xref>). Several groups have also shown that it is possible to carry out loose cell attached recordings for tens of minutes to hours (<xref ref-type="bibr" rid="bib5">DeWeese et al., 2003</xref>; <xref ref-type="bibr" rid="bib27">Tang et al., 2014</xref>). Based on these observations, once a pipette encountered a neuron, the program paused neuron hunting in all channels and attempted gigasealing in the channel that encountered a neuron (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><p>To implement this third strategy, we re-designed the pressure control box to incorporate a separate pneumatic valve bank for each pipette (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1b</xref>), which allowed independent pressure state switching in each individual pipette. The third and final iteration of the algorithm then proceeded as follows: after regional pipette localization and deactivation of clogged pipettes (<xref ref-type="fig" rid="fig3">Figure 3a</xref>), the multipatcher robot moves the remaining pipettes in small incremental steps (2 <inline-formula><mml:math id="inf20"><mml:mi>μ</mml:mi></mml:math></inline-formula>m); after each step, square wave voltage pulses (e.g., 10 mV at 10 Hz, with offset voltage set at 0 mV) are applied to the pipettes to compute their resistances (time point iv in <xref ref-type="fig" rid="fig3">Figure 3d</xref>). This two-step process of pipette advancement followed by resistance measurement is repeated while looking for monotonic increases of pipette resistance above 0.25 M<inline-formula><mml:math id="inf21"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> over three actuation steps taken in one or more patch pipettes that indicate suitable contact with a neuron for patch clamping (time v in <xref ref-type="fig" rid="fig3">Figure 3d</xref>), analogous to the ‘neuron hunting’ stage in the autopatcher operation (<xref ref-type="bibr" rid="bib13">Kodandaramaiah et al., 2012</xref>). After detecting contact with a neuron, the robot halts the movement of all pipettes, and attempts to establish a gigaseal in the pipette that has encountered a neuron (time vi in <xref ref-type="fig" rid="fig3">Figure 3d</xref>), analogous to the ”gigasealing’ stage in the autopatcher (<xref ref-type="bibr" rid="bib13">Kodandaramaiah et al., 2012</xref>) by applying low suction pressure and a hyperpolarizing voltage. After a gigasealing attempt, lasting 60 secs or less, the pipette's linear motor is deactivated, and the remaining pipettes resume neuron hunting. This alternating neuron hunting and gigasealing cycle is repeated until all pipettes have encountered neurons and attempted to establish gigaseals (time vii in <xref ref-type="fig" rid="fig3">Figure 3d</xref>). At this point, pipettes that have successfully formed gigaseals are selected and, at the operator's command, the robot applies pulses of suction until it successfully breaks into the gigasealed cells (time viii in <xref ref-type="fig" rid="fig3">Figure 3d</xref>). Using this algorithm, we were able to get successful gigasealed cell attached states in 58% of the active pipettes (77 out of 133 pipettes in 41 trials, 41 pipettes were deactivated at the end of the initial localization step due to blockage or clogging). This was the highest yield we obtained from all three iterations, and exceeded the gigasealing success rate that we obtained with our autopatcher algorithm (<xref ref-type="bibr" rid="bib13">Kodandaramaiah et al., 2012</xref>). The details of the software implementation and operation of this algorithm can be found in <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref> and Source Code Files 1–4.</p></sec><sec id="s1-3"><title>Time course of multipatcher operation</title><p>A series of pressure state switching and resistance measurements in four pipettes during a single, typical multipatcher trial in which multiple whole-cell recordings are shown in <xref ref-type="fig" rid="fig4">Figure 4a and b</xref>. Pressure and resistance measurements from each pipette are coded with green, blue, red, and purple colors. Key events during the trial are denoted by lowercase roman numerals, with the colored bars at the top of <xref ref-type="fig" rid="fig4">Figure 4b</xref> (<xref ref-type="supplementary-material" rid="fig4sdata1">Figure 4—source data 1</xref>) indicating when the robot arms are active, or moving. Grey shaded areas indicate when all robot arms are stopped and a pipette is attempting gigasealing with its contacted neuron. The detection of a neuron in pipette 1 is shown at time i. Between times i and ii, all pipettes paused actuation and gigasealing was attempted with pipette 1 (green). This 60 s gigasealing attempt, started at time i, was conducted as follows: (1) measure resistance at low positive pressure for 10 s to ensure positive confirmation of contact with a neuron, (2) switch to atmospheric pressure for 5 s to allow the cell membrane to begin sealing, (3) apply low suction pressure for 10 s to form gigaseal, (4) return pressure to atmospheric and apply hyperpolarizing voltage of −35 mV, (5) reduce voltage linearly to −70 mV over 30 s, and (6) wait 5 s. The motor of pipette 1 was deactivated for the rest of the trial. At time ii, the remaining pipettes resumed neuron hunting. At time iii the robot detected contact with a neuron using pipette 2. The same gigasealing steps described above for pipette 1 were used for pipette 2 between times iii and iv, resulting in unsuccessful gigaseal formation, as indicated by a minimal resistance increase. The experimenter terminated the gigasealing attempt prematurely, manually, after 35 s, rather than having the robot continue automatically after 60 s as before. Between times v and vi, and again between times vii and viii, the robot successfully gigasealed pipettes 3 and 4. At time ix, the gigasealed neurons attached to the patch electrodes in pipettes 1, 3 and 4 were broken into to establish whole-cell patch recordings. The time for execution of gigasealing tasks for multipatching was fixed at 60 s, whereas in the previous autopatcher, break-in was initiated at the discretion of the operator. The gigasealing times recorded for autopatching were the times taken for gigaseals to fully stabilize and asymptote, upon which break-in was initiated by the operator. In the multipatcher algorithm, however, we used a fixed time for gigasealing with the cell being clamped at −70 mV holding potential at the end of the 60 s gigasealing routine. Thus, even as the program resumed neuron hunting with pipettes that were yet to encounter neurons, the seal resistance continued to increase and asymptote due to the hyperpolarizing holding potential that was applied. This did not however apply to the pipette that attempted gigasealing last for which the usual conditions used for autopatching were applied.</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.24656.008</object-id><label>Figure 4.</label><caption><title>The multipatcher robot in operation.</title><p>(<bold>a</bold>) Time series of the pressures in each of the four valves during the multipatcher operation. The valve pressure settings, each corresponding to a pipette, are color coded blue, green, red and purple. The roman numerals and gray areas denote different steps of the algorithm operation, as shown in <xref ref-type="fig" rid="fig3">Figure 3d</xref>. (<bold>b</bold>) Time series of resistance measurements in a representative multipatching trial. Colors and roman numerals are coded as in (<bold>a</bold>). The horizontal bars on top indicate the epochs of the algorithm when motors are active and moving, and the grayed out sections indicate epochs when gigasealing was attempted in a pipette. The vertical gray bars indicate epochs in which all pipettes remained stationary. Key events are flagged by roman numerals. Between i and ii gigasealing was attempted in the pipette color-coded green; between iii and iv, gigasealing was attempted in the pipette color coded blue. In this gigasealing attempt, the experimenter utilized a manual override option to prematurely terminate the gigasealing process after observing less than 100 M<inline-formula><mml:math id="inf22"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> increase in pipette resistance after 35 s, typically indicative of an unsuccessful gigasealing attempt. Gigasealing was attempted similarly with pipettes color coded red and magenta between time points v to vi and vii to viii respectively. Break-in was attempted in all pipettes that had successfully obtained gigaseals at step ix and obtained whole-cell configurations in all three pipettes.</p><p><supplementary-material id="fig4sdata1"><object-id pub-id-type="doi">10.7554/eLife.24656.010</object-id><label>Figure 4—source data 1.</label><caption><title>Time series of resistance measurements.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-24656-fig4-data1-v3.csv"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24656-fig4-v3"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.24656.009</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Pipette tracks in the somatosensory cortex after a complete experiment.</title><p>Confocal image of somatosensory cortex showing the tracks left by two pipettes painted with DiI. The measurement scale show that the pipettes are at about 250 <inline-formula><mml:math id="inf23"><mml:mi>μ</mml:mi></mml:math></inline-formula>m from each other.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24656-fig4-figsupp1-v3"/></fig></fig-group></sec><sec id="s1-4"><title>Performance in anesthetized rodents</title><p>We first assessed the performance of the multipatcher robot in anesthetized, head-fixed mice. Representative voltage traces of two and three neurons patched simultaneously in the somatosensory cortex of an anesthetized mouse are shown respectively in <xref ref-type="fig" rid="fig5">Figure 5a</xref>, right (<xref ref-type="supplementary-material" rid="fig5sdata1">Figure 5—source data 1</xref>) and <xref ref-type="fig" rid="fig5">Figure 5b</xref>, right <xref ref-type="supplementary-material" rid="fig5sdata2">Figure 5—source data 2</xref>). Overall in anesthetized animals, for recordings obtained in visual cortex and somatosensory cortex, the multipatcher robot controlling four patch pipettes was able to establish successful whole-cell recordings from multiple neurons in 30.7% (13/41 trials, eight mice) of trials. We were not able to obtain successful recordings from all four pipettes that simultaneously met the quality criteria: resting membrane potential below −50 mV, less than 200 pA of negative current injected to hold the cell at −65 mV in voltage clamp mode, less than 100 M<inline-formula><mml:math id="inf24"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> of initial series resistance, and recording time duration of at least 5 min. Recordings were considered to be successful dual- and triple-patches only if all the neurons met the quality and time criteria (<xref ref-type="fig" rid="fig5">Figure 5c and d</xref>, and <xref ref-type="supplementary-material" rid="fig5sdata5">Figure 5—source data 5</xref>–<xref ref-type="supplementary-material" rid="fig5sdata7">7</xref>). Nineteen percent of the pipette tips were blocked or fouled in the initial descent to depth (31/164 pipettes in 41 trials, eight mice), comparable to that obtained previously (<xref ref-type="bibr" rid="bib13">Kodandaramaiah et al., 2012</xref>). Of the pipettes that executed neuron hunting, 57% (77/133 pipettes in 41 trials, eight mice) established successful gigaseals, of which 67.5% (52/77 pipettes in 41 trials, eight mice) yielded successful whole-cell recordings of necessary quality. Overall, each pipette had a 31.7% (52/164 pipettes) chance of establishing a whole-cell recording. We hypothesize that the high percentage of gigaseals obtained can be attributed to improvements made in our surgical procedures, for example using an autodrilling robot (<xref ref-type="bibr" rid="bib21">Pak et al., 2015</xref>) to perform craniotomies.</p><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.24656.011</object-id><label>Figure 5.</label><caption><title>The multipatcher robot in operation.</title><p>(<bold>a</bold>) Representative voltage traces for two neurons patched simultaneously in the somatosensory cortex of awake (left) and anesthetized (right) head restrained mouse. (<bold>b</bold>) Representative voltage traces from three neurons patched simultaneously in the somatosensory cortex of an awake (left) and anesthetized (right) head-fixed mouse. (<bold>c</bold>) Initial series resistances of neurons recorded at various depths in the cortex plotted against the depths from the pia at which the recordings were obtained. (<bold>d</bold>) Holding currents required to hold various whole-cell patched neurons at −65 mV in voltage clamp mode plotted against the depth from the pia at which recordings were obtained.</p><p><supplementary-material id="fig5sdata1"><object-id pub-id-type="doi">10.7554/eLife.24656.012</object-id><label>Figure 5—source data 1.</label><caption><title>Raw traces of a double patch in S1 of an anesthetized mouse.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-24656-fig5-data1-v3.csv"/></supplementary-material></p><p><supplementary-material id="fig5sdata2"><object-id pub-id-type="doi">10.7554/eLife.24656.013</object-id><label>Figure 5—source data 2.</label><caption><title>Raw traces of a triple patch in S1 of an anesthetized mouse.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-24656-fig5-data2-v3.csv"/></supplementary-material></p><p><supplementary-material id="fig5sdata3"><object-id pub-id-type="doi">10.7554/eLife.24656.014</object-id><label>Figure 5—source data 3.</label><caption><title>Raw traces of a double patch in S1 of an awake mouse.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-24656-fig5-data3-v3.csv"/></supplementary-material></p><p><supplementary-material id="fig5sdata4"><object-id pub-id-type="doi">10.7554/eLife.24656.015</object-id><label>Figure 5—source data 4.</label><caption><title>Raw traces of a triple patch in S1 of an awake mouse.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-24656-fig5-data4-v3.csv"/></supplementary-material></p><p><supplementary-material id="fig5sdata5"><object-id pub-id-type="doi">10.7554/eLife.24656.016</object-id><label>Figure 5—source data 5.</label><caption><title>Depth, Series resistance, and holding current during whole-cell recordings in anesthetized S1.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-24656-fig5-data5-v3.csv"/></supplementary-material></p><p><supplementary-material id="fig5sdata6"><object-id pub-id-type="doi">10.7554/eLife.24656.017</object-id><label>Figure 5—source data 6.</label><caption><title>Depth, Series resistance, and holding current during whole-cell recordings in anesthetized V1.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-24656-fig5-data6-v3.csv"/></supplementary-material></p><p><supplementary-material id="fig5sdata7"><object-id pub-id-type="doi">10.7554/eLife.24656.018</object-id><label>Figure 5—source data 7.</label><caption><title>Depth, Series resistance, and holding current during whole-cell recordings in awake S1.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-24656-fig5-data7-v3.csv"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24656-fig5-v3"/></fig><p>We did observe a decrease in break-in success rate as compared to our previous study (<xref ref-type="bibr" rid="bib13">Kodandaramaiah et al., 2012</xref>). Of the 77 neurons that were gigasealed, we established successful whole-cell recordings in 52 neurons, achieving a break-in success rate of 67.5%. Multiple reasons could cause this reduction in break-in. Since the algorithm waited until all pipettes had attempted gigasealing, pipettes that encountered neurons first often had to wait a few minutes before break-in was attempted. A small fraction (6.4%, 5/77 gigasealed neurons in 41 trials, eight mice) lost gigaseal attachment to the neurons while waiting. It is also possible that, of the ones that remained gigasealed, the increased duration of holding at this stage made break-in more difficult, although we did not systematically explore this. Another potential explanation for the decrease in break-in success rate is the design of the pressure controller box. In it, the volume of air in the tubing between the control box and the patch pipettes may be significant since we had to use longer tubing to route pressure to all the pipette actuators. On average, the series resistance of recorded neurons was 31.54 <inline-formula><mml:math id="inf25"><mml:mo>±</mml:mo></mml:math></inline-formula>16.53 M<inline-formula><mml:math id="inf26"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> (n = 52 neurons, eight mice), while holding currents required to clamp the cell in voltage clamp mode at −65 mV were −21 <inline-formula><mml:math id="inf27"><mml:mo>±</mml:mo></mml:math></inline-formula>54.08 pA (n = 52 neurons, eight mice) (<xref ref-type="fig" rid="fig6">Figure 6C and D</xref> and <xref ref-type="supplementary-material" rid="fig5sdata5">Figure 5—source data 5</xref>–<xref ref-type="supplementary-material" rid="fig5sdata7">7</xref>). The average membrane capacitances and membrane resistances were 66.13 <inline-formula><mml:math id="inf28"><mml:mo>±</mml:mo></mml:math></inline-formula> 34.8 pF and 99.3 <inline-formula><mml:math id="inf29"><mml:mo>±</mml:mo></mml:math></inline-formula>44.41 M<inline-formula><mml:math id="inf30"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> (n = 52 neurons, eight mice) respectively (<xref ref-type="fig" rid="fig6">Figure 6A and B</xref> and <xref ref-type="supplementary-material" rid="fig5sdata5">Figure 5—source data 5</xref>–<xref ref-type="supplementary-material" rid="fig5sdata7">7</xref>). In the interest of time, we assessed the time duration of stable recordings in only a subset of trials, and found that recordings obtained were of similar duration (52.62 <inline-formula><mml:math id="inf31"><mml:mo>±</mml:mo></mml:math></inline-formula>9.87 min, n = 18 neurons in 18 trials) to those obtained with the single autopatcher (<xref ref-type="bibr" rid="bib13">Kodandaramaiah et al., 2012</xref>).</p><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.24656.019</object-id><label>Figure 6.</label><caption><title>Parameters of cells recorded using the multipatcher robot.</title><p>(<bold>a</bold>) i-iii are histograms of cell membrane capacitance, cell membrane resistance and series resistance, respectively, from neurons recorded in the visual cortex under anesthesia (n = 27 neurons), (<bold>b</bold>) i-iii are histograms of cell membrane capacitance, cell membrane resistance and series resistance, respectively, from neurons recorded in the somatosensory cortex under anesthesia (n = 25 neurons, four mice), (<bold>c</bold>) i-iii are histograms of cell membrane capacitance, cell membrane resistance and initial series resistance, respectively, from neurons recorded in the somatosensory cortex in awake mice (n = 67 neurons). (<bold>d</bold>) Histograms of recording time duration per neuron in awake animals (n = 38 neurons).</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-24656-fig6-v3"/></fig><sec id="s1-4-1"><title>Performance in awake animals</title><p>Once validated in anesthetized animals, we attempted to use the multipatcher robot in awake head restrained mice. We optimized our surgical preparation and head restraint protocol to minimize motion of the brain. Representative voltage traces from two and three neurons patched simultaneously in the somatosensory cortex of awake, head-restrained mice are shown respectively in <xref ref-type="fig" rid="fig5">Figure 5a</xref>, left (<xref ref-type="supplementary-material" rid="fig5sdata3">Figure 5—source data 3</xref>) and <xref ref-type="fig" rid="fig5">Figure 5b</xref> left (<xref ref-type="supplementary-material" rid="fig5sdata4">Figure 5—source data 4</xref>). We attempted a total of 97 multipatching trials (with 97 × 4 = 388 pipettes) in 32 awake, head restrained mice, which yielded 70 successful whole-cell recordings that matched the quality criterion (<xref ref-type="fig" rid="fig5">Figure 5c and d</xref>, and <xref ref-type="supplementary-material" rid="fig5sdata5">Figure 5—source data 5</xref>–<xref ref-type="supplementary-material" rid="fig5sdata7">7</xref>). Thus, if each pipette was considered individually, it had an 17.3% chance of obtaining a whole-cell patch recording (67/388 pipettes). In 44.3% (43/97) of the trials, no usable whole-cell patch recordings were obtained, perhaps due to additional motion of the brain as compared to anesthetized mice. At least one whole-cell patch clamp recording was obtained in 55.7% (54/97) of trials, with 17.5% (17/97) of the trials resulting in dual or triple whole-cell patch clamp recordings.</p><p>The mean series resistance of recorded neurons was 33.78 <inline-formula><mml:math id="inf32"><mml:mo>±</mml:mo></mml:math></inline-formula>14.41 M<inline-formula><mml:math id="inf33"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> (n = 67 neurons, 32 mice), while the holding current required to keep the cell in voltage clamp mode at −65 mV was 9.81 <inline-formula><mml:math id="inf34"><mml:mo>±</mml:mo></mml:math></inline-formula>78.94 pA (n = 67 neurons, 32 mice, <xref ref-type="fig" rid="fig6">Figure 6c and d</xref> and <xref ref-type="supplementary-material" rid="fig5sdata5">Figure 5—source data 5</xref>–<xref ref-type="supplementary-material" rid="fig5sdata7">7</xref>). The average membrane capacitance and membrane resistance was 88.18 <inline-formula><mml:math id="inf35"><mml:mo>±</mml:mo></mml:math></inline-formula> 49.20 pF (n = 67 neurons, 32 mice) and 109.75 <inline-formula><mml:math id="inf36"><mml:mo>±</mml:mo></mml:math></inline-formula>68.97 M<inline-formula><mml:math id="inf37"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> (n = 67 neurons, 32 mice) respectively (<xref ref-type="fig" rid="fig6">Figure 6c</xref> and <xref ref-type="supplementary-material" rid="fig5sdata5">Figure 5—source data 5</xref>–<xref ref-type="supplementary-material" rid="fig5sdata7">7</xref>). Approximately half (48.6%) of recordings obtained in awake head-fixed animals (34/70 neurons, 32 mice), such as those shown in <xref ref-type="fig" rid="fig5">Figure 5a and b</xref>, were obtained in experiments involving injection of anesthetics for a separate study (data unpublished). In these experiments, ketamine or dexmedetomidine were injected via a cannula implanted in the peritoneal cavity. The injection was typically done after recording in baseline awake state for 4 min, and resulted in a significant increase in motor activity, with 41.2% of the recorded neurons lost as result of this (14/34 neurons, 32 mice). We obtained a motion index from video recordings using a published methodology (<xref ref-type="bibr" rid="bib9">Gao et al., 2014</xref>) and standardized its values across mice using z-scores. The median of the standardized motion index observed during baseline was significantly lower than the median value observed after the injection of the drug (<inline-formula><mml:math id="inf38"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>=−0.39, <inline-formula><mml:math id="inf39"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>25</mml:mn><mml:mo>-</mml:mo><mml:mn>75</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> = [−0.66–0.12]; <inline-formula><mml:math id="inf40"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 0.36, <inline-formula><mml:math id="inf41"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>25</mml:mn><mml:mo>-</mml:mo><mml:mn>75</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> = [−0.23 0.81]; p-value=0.0003, Wilcoxon Signed-Rank test; <inline-formula><mml:math id="inf42"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> denotes the median, and <inline-formula><mml:math id="inf43"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>25</mml:mn><mml:mo>-</mml:mo><mml:mn>75</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> denotes the 25th and 75th percentile values). This analysis provides strong evidence that the period immediately following anesthetic injection does not represent typical motor activity, and therefore we excluded these part of the recording from our calculations of recording duration. After this correction, the remainder of the recordings lasted 13.98 <inline-formula><mml:math id="inf44"><mml:mo>±</mml:mo></mml:math></inline-formula>10.03 min (n = 36 neurons, <xref ref-type="fig" rid="fig6">Figure 6d</xref>).</p></sec><sec id="s1-4-2"><title>Throughput and scaling</title><p>In a subset of anesthetized trials, we measured the time to manually fill, install and position pipettes for multipatching. In four pipettes the average time taken for filling and installing was 12.5 <inline-formula><mml:math id="inf45"><mml:mo>±</mml:mo></mml:math></inline-formula>1.4 min (n = 18 trials), and the time for completion of multipatcher trials culminating in successful whole-cell recordings of one of more neurons was 10.5 <inline-formula><mml:math id="inf46"><mml:mo>±</mml:mo></mml:math></inline-formula>2.6 min (n = 18 trials). Thus, a single pipette requires 3.2 <inline-formula><mml:math id="inf47"><mml:mo>±</mml:mo></mml:math></inline-formula>0.3 min for installation and 2.6 <inline-formula><mml:math id="inf48"><mml:mo>±</mml:mo></mml:math></inline-formula>0.6 min for whole-cell patch clamping as compared to the autopatcher (2.0 <inline-formula><mml:math id="inf49"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.4 for pipette installation and 5 <inline-formula><mml:math id="inf50"><mml:mo>±</mml:mo></mml:math></inline-formula>2 min for operation). The increased time for pipette installation is due to the increased complexity of tasks involved in positioning with close confinement. However, this is partially offset by the synchronized stages of multipatcher operation, with some additional contribution enabled by limiting gigasealing to 60 s.</p><p>In the limit, scaling with this algorithm necessitates that operation time is 70 s/pipette (60 secs for gigasealing and 10 s for assessment). Using these methodologies, we estimate practical limitations to pipette installation are 10–12 pipettes due to hardware constraints, and the time for installation increases non-linearly. Reducing this rate would need a redesign of the actuation modules to enable quick replacement of pipettes for high-throughput operation. Further increases in the throughput may be obtained by using robot systems for automated pipette (<xref ref-type="bibr" rid="bib20">Pak et al., 2011</xref>) and pipette inspection (<xref ref-type="bibr" rid="bib24">Stockslager et al., 2016</xref>), and incorporating pipette cleaning protocols (<xref ref-type="bibr" rid="bib15">Kolb et al., 2016</xref>) between trials to eliminate the pipette changeover time. While the algorithms were formulated and tested using a multipatcher robot controlling four patch pipettes, they can in principle be applied to control many more patch pipettes with further miniaturization. More pipettes would ensure higher a success rate of obtaining multiple patch recordings.</p></sec></sec></sec><sec id="s2" sec-type="discussion"><title>Discussion</title><p>Whole-cell patch clamping is considered a gold standard electrophysiology tool that enables the measurement of both suprathreshold spiking and subthreshold membrane potential fluctuations in single neurons. The ability to whole-cell patch multiple neurons in brain slices has revealed key insights into the mechanisms of synaptic transmission and plasticity (<xref ref-type="bibr" rid="bib22">Perin et al., 2011</xref>). Such circuit level interrogations have been difficult to perform in vivo, particularly in awake animals. Here we demonstrate the ability to use arrays of robotically-guided patch clamping pipettes to simultaneously obtain whole-cell patch clamp recordings in vivo in anesthetized and awake mice. The algorithm used for controlling this robot builds on our previously developed autopatcher algorithm (<xref ref-type="bibr" rid="bib13">Kodandaramaiah et al., 2012</xref>) to control the position and pressure in individual patch pipettes, while taking into consideration the mechanical interactions of pipettes with the brain tissue while seeking neurons in close proximity to each other.</p><p>The automation of multi-neuron recording in vivo opens up the possibility of further parallelizing the multipatcher for high density mapping of the intracellular activity of ensembles of neurons in intact tissue, which will be hard to accomplish by humans performing such tasks manually. The advent of low-cost, silicon patch-chip amplifiers (<xref ref-type="bibr" rid="bib11">Harrison et al., 2015</xref>) will enable scaling up the pipette count at a fraction of the cost compared to that of traditional analog amplifiers. Combined with surgical robotics advances that allow precisely defined access to brain (<xref ref-type="bibr" rid="bib21">Pak et al., 2015</xref>), high density robotically guided patch clamping arrays that simultaneously target and record from neurons distributed locally in microcircuits or in multiple brain regions could be developed. Imaging could be used for closed-loop control of multiple pipettes, as has already been done for single patch pipettes (<xref ref-type="bibr" rid="bib26">Suk et al., 2017</xref>; <xref ref-type="bibr" rid="bib1">Annecchino et al., 2017</xref>). Three or four fold increases in the number of simultaneously controlled pipettes could be achieved by using miniaturized micromanipulators, and increasing the number of pneumatic valve banks in the multipatcher control box—–both of which are possible using existing off-the-shelf hardware. The macroscopic scale of currently used patch clamping pipettes will limit further increases in number of pipettes targeting the microcircuit. Thus, novel electrode materials, or microfabrication techniques that realize device architectures amenable for in vivo application will have to be developed. The time taken to assemble and position these pipette arrays precisely at the brain surface will also increase with the number of electrodes. Developing protocols to clean pipette tips for reuse (<xref ref-type="bibr" rid="bib15">Kolb et al., 2016</xref>), improving the yield of regional pipette localization (<xref ref-type="bibr" rid="bib25">Stoy et al., 2017</xref>), or incorporating hardware to robotically exchange pipettes between trials in dense pipette arrays, will be particularly useful to overcome this limitations. However, the users that are less experienced in patch-clamp techniques should always keep in mind that key skills for performing surgery, high quality durectomy, pulling pipettes, making internal solution, controlling pressure lines, etc., still remain a challenge, and time and practice are required to master these skills (<xref ref-type="bibr" rid="bib14">Kodandaramaiah et al., 2016</xref>).</p></sec><sec id="s3" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><object-id pub-id-type="doi">10.7554/eLife.24656.020</object-id><label>Key resources table</label><caption><title>Detail of the key resources needed to build and operate the multipatcher robot (See also <xref ref-type="supplementary-material" rid="supp3">Supplementary files 3</xref> and <xref ref-type="supplementary-material" rid="supp4">4</xref>).</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Reagent type (species) or resource</th><th>Designation</th><th>Source or reference</th><th>Identifiers</th><th>Additional information</th></tr></thead><tbody><tr><td>software, algorithm</td><td><xref ref-type="supplementary-material" rid="scode1">Source code 1</xref></td><td>this paper</td><td/><td>Multipatcher control software in LabView Library file format</td></tr><tr><td>software, algorithm</td><td><xref ref-type="supplementary-material" rid="scode2">Source code 2</xref></td><td>this paper</td><td/><td>Header (.h) file for interfacing with the amplifier.</td></tr><tr><td>software, algorithm</td><td><xref ref-type="supplementary-material" rid="scode3">Source code 3</xref></td><td>this paper</td><td/><td>Direct link library (.dll) file for interfacing with the amplifier.</td></tr><tr><td>software, algorithm</td><td><xref ref-type="supplementary-material" rid="scode4">Source code 4</xref></td><td>this paper</td><td/><td>Library (.lib) file for interfacing with the amplifier.</td></tr><tr><td>other</td><td><xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref></td><td>this paper</td><td/><td>Bill of materials to build the multipatcher hardware.</td></tr><tr><td>other</td><td><xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref></td><td>this paper</td><td/><td>Hardware blueprints.</td></tr></tbody></table></table-wrap><sec id="s3-1"><title>Surgical procedures</title><p>We conducted all animal work in accordance to federal, state, and local regulations, and following NIH and AAALAC guidelines and standards. The corresponding protocol (#0113-008-16) was approved by the Institutional Committee on Animal Care at the Massachusetts Institute of Technology. Adult male C57BL/6 mice, <inline-formula><mml:math id="inf51"><mml:mo>∼</mml:mo></mml:math></inline-formula>8 weeks old, were purchased from Taconic. During the period before the experiment, the mice were housed in standard cages in the vivarium for at least one week after procurement from the vendor. Food and water were provided <italic>ad libitum</italic> under a 12 hr light-dark cycles. On the day of the experiment, mice were anesthetized using 1–2% isoflurane in pure oxygen and administered buprenorphine (0.1 mg/kg) and meloxicam (1–2 mg/kg) subcutaneously for analgesia. The scalp was shaved and sterilized by scrubbing alternately with betadine solution and 70% ethanol for three times. The eyes were covered with ophthalmic ointment (Puralube, Dechra) and fixed in a stereotaxic apparatus (Kopf Instruments). After making an incision to expose the skull, fascia was removed with a microcurette. Three self-tapping screws (F000CE094, Morris Precision Screws and Parts) were then implanted on the skull, taking care not to thread them into the skull by more than 150 <inline-formula><mml:math id="inf52"><mml:mi>μ</mml:mi></mml:math></inline-formula>m, to ensure that the tip of the screws did not touch the brain surface. A few drops of medical grade cyanoacrylate tissue adhesive (Vetbond, 3M) were applied at the anchor points, suture lines and to attach the skin to the skull as described previously (<xref ref-type="bibr" rid="bib7">Domnisoru et al., 2013</xref>). Then we affixed a custom head plate, made of either stainless steel or delrin, using dental acrylic (C and B Metabond, Parkell).</p><p>For animals that underwent anesthetized recordings, the head plate implantation was followed by four craniotomies made in a 2 × 2 grid using an end-mill (∅=200 <inline-formula><mml:math id="inf53"><mml:mi>μ</mml:mi></mml:math></inline-formula>m) and an autodrilling robot (<xref ref-type="bibr" rid="bib21">Pak et al., 2015</xref>). To minimize the chance of pipettes colliding during the multipatcher operation, the spacing between the craniotomies was calculated using the relative orientations and distances between the independent robotic arms, and projecting their paths into the brain from the surface, such that they were <inline-formula><mml:math id="inf54"><mml:mo>∼</mml:mo></mml:math></inline-formula>250 <inline-formula><mml:math id="inf55"><mml:mi>μ</mml:mi></mml:math></inline-formula>m apart at the start of the neuron hunting stage. The small diameter of the craniotomies also allowed for minimization of brain motion. <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> illustrates the tracks left by pipettes lowered to 400 micrometers depth from he surface using two opposing arms of the multi patcher. To target layer 4 of the somatosensory cortex, the craniotomies were made at the following coordinates (in mm from bregma): 1 AP, −2.8 ML; 1 AP, −3.2 ML; 1.5 AP, −2.8 ML; 1.5 AP, −3.2 ML. To target layer 4 of the visual cortex, the coordinates were: (in mm from bregma): 2.75 AP, −2.8 ML; 2.75 AP, −3.2 ML; 3.25 AP, −2.8 ML and 3.25 AP, −3.2 ML. Craniotomies were followed by counter boring the drilled holes using a dental burr (∅=500 <inline-formula><mml:math id="inf56"><mml:mi>μ</mml:mi></mml:math></inline-formula>m) to allow easy visualization of the brain surface.</p><p>For animals that underwent awake recordings, a thin film of dental acrylic was applied to cover any exposed skull tissue after the head plate fixation, and were then transferred to a warm cage lit by an infrared heating lamp, and kept there until they were fully ambulatory. The health of the mice was carefully monitored, and buprenorphine and meloxicam were administered for analgesia up to 3 days after surgery. They were allowed to fully recover from the surgery for up to one week in the vivarium before we started the behavioral acclimation to the custom restraint setup. On the day of the awake recordings, the mice were anesthetized again using 1–2% isoflurane, fixed in the stereotaxic instrument, and the thin dental cement layer was carefully removed using a dental burr to re-expose the skull. We inspected the exposed skull surface for signs of inflammation—fluid secretions at the suture lines as well as softened or damp skull tissue. This signs were observed in 10.9% of experiments (5/46 mice) and no recordings were attempted in these subjects. Of those mice that did not show any inflammation, an array of craniotomies was then opened using a similar procedure as described for anesthetized recording sessions above. The skull was then covered with a silicone sealant (Qwik Sil, World Precision Instruments), and animals were head-fixed in the custom restraint setup and allowed to fully recover from anesthesia before attempting recordings, which were performed 45–60 min after the opening of the craniotomy.</p></sec><sec id="s3-2"><title>Behavioral acclimation</title><p>For awake recordings, the animals were affixed in a custom head and body restraint setup, similar to that described by (<xref ref-type="bibr" rid="bib10">Guo et al., 2014</xref>). The mice were allowed to recover for 7 days after surgical implantation of head plates prior to habituation to the restraint setup. Acclimation was carried out for six consecutive days, with training sessions lasting 30, 30, 45, 45, 60 and 60 min on each day. During these training sessions, mice were given undiluted condensed milk at regular intervals as positive reinforcement</p></sec><sec id="s3-3"><title>Electrophysiology</title><p>The patch pipettes used in the multipatcher robot were pulled from borosilicate glass capillaries (Outer Diameter: 1.2 mm, Inner Diameter: 0.69 mm, Model G120F-4, Warner Instruments) using a standard, filament-based, flaming-brown pipette puller (Model P97, Sutter Instruments) and had resistances between 5–9 M<inline-formula><mml:math id="inf57"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula>. Pipettes were stored in a closed container and were used within a few hours of fabrication. They were filled with intracellular pipette solution consisting of (in mM): 125 potassium gluconate (with more added to titrate the final solution to <inline-formula><mml:math id="inf58"><mml:mo>∼</mml:mo></mml:math></inline-formula>290 mOsm and a pH of 7.2), 0.1 CaCl<inline-formula><mml:math id="inf59"><mml:msub><mml:mi/><mml:mtext>2</mml:mtext></mml:msub></mml:math></inline-formula>, 0.6 MgCl<inline-formula><mml:math id="inf60"><mml:msub><mml:mi/><mml:mtext>2</mml:mtext></mml:msub></mml:math></inline-formula>, 1 EGTA, 10 HEPES, 4 Mg ATP, 0.4 Na GTP, 8 NaCl. The surface of the brain was kept moist during the multipatching experiment by covering with sterile artificial cerebrospinal fluid (ACSF) consisting of: 135 mM NaCl, 2.5 mM KCl, 10 mM HEPES, 2 mM CaCl<inline-formula><mml:math id="inf61"><mml:msub><mml:mi/><mml:mtext>2</mml:mtext></mml:msub></mml:math></inline-formula> and 1 mM MgCl<inline-formula><mml:math id="inf62"><mml:msub><mml:mi/><mml:mtext>2</mml:mtext></mml:msub></mml:math></inline-formula> with pH titrated to 7.3 by addition of NaOH, and osmolarity titrated to <inline-formula><mml:math id="inf63"><mml:mo>∼</mml:mo></mml:math></inline-formula>300 mOsm by adding NaCl (up to 150 mM final concentration).</p></sec><sec id="s3-4"><title>Multipatcher robot operation</title><p>At the beginning of each multipatcher experiment, patch pipettes were filled with intracellular pipette solution using a thin polyimide/quartz back-filling needle (Microfil, World Precision Instruments) and installed in each of the pipette actuators. The solution was filtered using a 0.2 <inline-formula><mml:math id="inf64"><mml:mi>μ</mml:mi></mml:math></inline-formula>m filter (#28145–475, VWR) to minimize internal clogging of the pipettes. We then adjusted the pressure states required during multipatcher operation in the pressure control box, setting the high positive pressure to 800 mBar, the low positive pressure to 25 mBar, the low negative pressure to −15 mBar, and the high negative pressure to −300 mBar. The pipettes were then manually lowered to roughly the center of a corresponding craniotomy in the mouse skull using the three-axis stage. They were gently lowered to make contact with the brain surface (indicated with slight dimpling when visualized in the stereomicroscope) and retracted back until the tips were just above (15–20 <inline-formula><mml:math id="inf65"><mml:mi>μ</mml:mi></mml:math></inline-formula>m) the brain surface. Measurements of depths traversed by each of the patch pipettes were referenced from these starting points outside the brain. The multipatcher then performed the steps detailed in the multipatcher algorithm section. The algorithm was coded and run in Labview 2011 (National Instruments, <xref ref-type="supplementary-material" rid="scode1">Source code 1</xref>–<xref ref-type="supplementary-material" rid="scode4">4</xref> and <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>).</p><p>The amplifiers were set to voltage clamp mode and square wave command signals were applied simultaneously to all pipettes (10 mV, 10 Hz, via analog outputs on the cDAQ-9174). Amplified signals were sampled at 15 kHz and filtered using a moving average filter (half width, six samples, with triangular envelope). For each pipette, resistance values are computed on line by dividing applied voltage by the peak-to-peak amplitude of the measured current through the pipette. Each resistance value used in the algorithm was the average of five consecutive resistance measurements. During gigasealing and break-in stages (<xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig4">4</xref> and <xref ref-type="supplementary-material" rid="fig4sdata1">Figure 4—source data 1</xref>), DC offsets ranging from 0 to −70 mV are applied to the square wave to enhance the formation of gigaseals, as is common practice. To enable accurate measurement of peak-to-peak amplitude during gigasealing, an additional exponential filter (decay rate = 0.001 s) was digitally applied to eliminate stray currents resulting from uncompensated pipette capacitance. After multipatcher operation, whole-cell patched neurons were recorded using Clampex software (Molecular Devices). Signals were acquired at standard rates (e.g., 30–50 KHz), and low-pass filtered (Bessel filter, 10 kHz cutoff). All data was analyzed using Clampfit software (Molecular Devices) and MATLAB (Mathworks).</p></sec><sec id="s3-5"><title>Additional precautions for recording in awake mice</title><p>We had to take several steps to optimize the surgical and experimental preparation in the awake experiments. In order to minimize brain motion, the animals were placed within a plastic restrainer that prevented movement of the hindhead and subsequent movement of the spinal cord that could be transmitted to the brain via the cerebrospinal fluid. However, this setup allowed unrestrained movement of the forepaws. We also closely inspected the skull surface, at 40x magnification, on the day of the recording for any signs of inflammation, for motion of the skull with respect to the head plate, and for motion of the brain relative to the skull or head plate. In 6.5% of experiments (3/46 mice), we observed relative motion between the head plate and skull when animal exhibited motor activity, possibly due to fatigue experienced by the dental cement used for implantation during repeated acclimation sessions. We did not attempt any awake recording sessions in these animals. In 10.9% of the subjects (5/46 mice), we observed discernible (10–100 <inline-formula><mml:math id="inf66"><mml:mi>μ</mml:mi></mml:math></inline-formula>m) motion of the brain—assessed by observing the relative distance between the brain and edge of the skull at the craniotomy. We did not attempt any automated recordings in these mice. If motion of the skull or brain was not observed through the stereoscope, we would then start the multipatching trial.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Resources, Software, Methodology</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Resources, Data curation, Formal analysis, Validation</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Supervision, Funding acquisition, Writing—review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Supervision, Funding acquisition, Writing—review and editing</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Animal experimentation: We conducted all animal work in accordance to federal, state, and local regulations, and following NIH and AAALAC guidelines and standards. The corresponding protocol (#0113-008-16) was approved by the Institutional Committee on Animal Care at the Massachusetts Institute of Technology.</p></fn></fn-group></sec><sec id="s4" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="scode1"><object-id pub-id-type="doi">10.7554/eLife.24656.021</object-id><label>Source code 1.</label><caption><title>Multipatcher software files.</title><p>The <xref ref-type="supplementary-material" rid="scode1">Source codes 1</xref>–<xref ref-type="supplementary-material" rid="scode4">4</xref> include the main multipatcher software library file to be executed in LabView (<xref ref-type="supplementary-material" rid="scode1">Source code 1</xref>), and the accessory files for interfacing with the Multiclamp 700B patch amplifier: a header file (<xref ref-type="supplementary-material" rid="scode2">Source code 2</xref>), a direct link library (<xref ref-type="supplementary-material" rid="scode3">Source code 3</xref>), and a library file (<xref ref-type="supplementary-material" rid="scode4">Source code 4</xref>).</p></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-24656-code1-v3.llb"/></supplementary-material><supplementary-material id="scode2"><object-id pub-id-type="doi">10.7554/eLife.24656.022</object-id><label>Source code 2.</label><caption><title>Multiclamp Commander Header file.</title></caption><media mime-subtype="x-h" mimetype="text" xlink:href="elife-24656-code2-v3.h"/></supplementary-material><supplementary-material id="scode3"><object-id pub-id-type="doi">10.7554/eLife.24656.023</object-id><label>Source code 3.</label><caption><title>Multiclamp Commander direct link library.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-24656-code3-v3.dll"/></supplementary-material><supplementary-material id="scode4"><object-id pub-id-type="doi">10.7554/eLife.24656.024</object-id><label>Source code 4.</label><caption><title>Multiclamp Commander library file.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-24656-code4-v3.lib"/></supplementary-material><supplementary-material id="supp1"><object-id pub-id-type="doi">10.7554/eLife.24656.025</object-id><label>Supplementary file 1.</label><caption><title>Bill of materials for multipatcher hardware.</title><p>The <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> contains the bill of materials needed to assemble the multipatcher hardware.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-24656-supp1-v3.xlsx"/></supplementary-material><supplementary-material id="supp2"><object-id pub-id-type="doi">10.7554/eLife.24656.026</object-id><label>Supplementary file 2.</label><caption><title>Blueprints for multipatcher hardware.</title><p>The <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref> contains all the CAD files needed to produce the PCB’s and custom-made parts of the multipatcher hardware.</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-24656-supp2-v3.zip"/></supplementary-material><supplementary-material id="supp3"><object-id pub-id-type="doi">10.7554/eLife.24656.027</object-id><label>Supplementary file 3.</label><caption><title>Multipatcher assembly manual.</title><p>The <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref> describes all the materials and procedures to assemble the signal and pressure control hardware necessary to operate the multipatcher.</p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-24656-supp3-v3.docx"/></supplementary-material><supplementary-material id="supp4"><object-id pub-id-type="doi">10.7554/eLife.24656.028</object-id><label>Supplementary file 4.</label><caption><title>Multipatcher software manual.</title><p>The <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref> describes the installation and use of the multipatcher control software under the LabView system-design platform.</p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-24656-supp4-v3.docx"/></supplementary-material><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.24656.029</object-id><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-24656-transrepform-v3.docx"/></supplementary-material></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Annecchino</surname> <given-names>LA</given-names></name><name><surname>Morris</surname> <given-names>AR</given-names></name><name><surname>Copeland</surname> <given-names>CS</given-names></name><name><surname>Agabi</surname> <given-names>OE</given-names></name><name><surname>Chadderton</surname> <given-names>P</given-names></name><name><surname>Schultz</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Robotic automation of in vivo two-photon targeted whole-cell patch-clamp electrophysiology</article-title><source>Neuron</source><volume>95</volume><fpage>1048</fpage><lpage>1055</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.08.018</pub-id><pub-id pub-id-type="pmid">28858615</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Large-scale recording of neuronal ensembles</article-title><source>Nature Neuroscience</source><volume>7</volume><fpage>446</fpage><lpage>451</lpage><pub-id pub-id-type="doi">10.1038/nn1233</pub-id><pub-id pub-id-type="pmid">15114356</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chabrol</surname> <given-names>FP</given-names></name><name><surname>Arenz</surname> <given-names>A</given-names></name><name><surname>Wiechert</surname> <given-names>MT</given-names></name><name><surname>Margrie</surname> <given-names>TW</given-names></name><name><surname>DiGregorio</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Synaptic diversity enables temporal coding of coincident multisensory inputs in single neurons</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>718</fpage><lpage>727</lpage><pub-id pub-id-type="doi">10.1038/nn.3974</pub-id><pub-id pub-id-type="pmid">25821914</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>TW</given-names></name><name><surname>Wardill</surname> <given-names>TJ</given-names></name><name><surname>Sun</surname> <given-names>Y</given-names></name><name><surname>Pulver</surname> <given-names>SR</given-names></name><name><surname>Renninger</surname> <given-names>SL</given-names></name><name><surname>Baohan</surname> <given-names>A</given-names></name><name><surname>Schreiter</surname> <given-names>ER</given-names></name><name><surname>Kerr</surname> <given-names>RA</given-names></name><name><surname>Orger</surname> <given-names>MB</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name><name><surname>Looger</surname> <given-names>LL</given-names></name><name><surname>Svoboda</surname> <given-names>K</given-names></name><name><surname>Kim</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Ultrasensitive fluorescent proteins for imaging neuronal activity</article-title><source>Nature</source><volume>499</volume><fpage>295</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1038/nature12354</pub-id><pub-id pub-id-type="pmid">23868258</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DeWeese</surname> <given-names>MR</given-names></name><name><surname>Wehr</surname> <given-names>M</given-names></name><name><surname>Zador</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Binary spiking in auditory cortex</article-title><source>Journal of Neuroscience</source><volume>23</volume><fpage>7940</fpage><lpage>7949</lpage><pub-id pub-id-type="pmid">12944525</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DeWeese</surname> <given-names>MR</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Whole-cell recording in vivo</article-title><source>Current Protocols in Neuroscience</source><volume>Chapter 6</volume><elocation-id>Unit 6.22</elocation-id><pub-id pub-id-type="doi">10.1002/0471142301.ns0622s38</pub-id><pub-id pub-id-type="pmid">18428661</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Domnisoru</surname> <given-names>C</given-names></name><name><surname>Kinkhabwala</surname> <given-names>AA</given-names></name><name><surname>Tank</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Membrane potential dynamics of grid cells</article-title><source>Nature</source><volume>495</volume><fpage>199</fpage><lpage>204</lpage><pub-id pub-id-type="doi">10.1038/nature11973</pub-id><pub-id pub-id-type="pmid">23395984</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Epsztein</surname> <given-names>J</given-names></name><name><surname>Lee</surname> <given-names>AK</given-names></name><name><surname>Chorev</surname> <given-names>E</given-names></name><name><surname>Brecht</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Impact of spikelets on hippocampal CA1 pyramidal cell activity during spatial exploration</article-title><source>Science</source><volume>327</volume><fpage>474</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1126/science.1182773</pub-id><pub-id pub-id-type="pmid">20093475</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname> <given-names>V</given-names></name><name><surname>Vitaterna</surname> <given-names>MH</given-names></name><name><surname>Turek</surname> <given-names>FW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Validation of video motion-detection scoring of forced swim test in mice</article-title><source>Journal of Neuroscience Methods</source><volume>235</volume><fpage>59</fpage><lpage>64</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2014.06.002</pub-id><pub-id pub-id-type="pmid">24992574</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname> <given-names>ZV</given-names></name><name><surname>Hires</surname> <given-names>SA</given-names></name><name><surname>Li</surname> <given-names>N</given-names></name><name><surname>O'Connor</surname> <given-names>DH</given-names></name><name><surname>Komiyama</surname> <given-names>T</given-names></name><name><surname>Ophir</surname> <given-names>E</given-names></name><name><surname>Huber</surname> <given-names>D</given-names></name><name><surname>Bonardi</surname> <given-names>C</given-names></name><name><surname>Morandell</surname> <given-names>K</given-names></name><name><surname>Gutnisky</surname> <given-names>D</given-names></name><name><surname>Peron</surname> <given-names>S</given-names></name><name><surname>Xu</surname> <given-names>NL</given-names></name><name><surname>Cox</surname> <given-names>J</given-names></name><name><surname>Svoboda</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Procedures for behavioral experiments in head-fixed mice</article-title><source>PLoS One</source><volume>9</volume><elocation-id>e88678</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0088678</pub-id><pub-id pub-id-type="pmid">24520413</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrison</surname> <given-names>RR</given-names></name><name><surname>Kolb</surname> <given-names>I</given-names></name><name><surname>Kodandaramaiah</surname> <given-names>SB</given-names></name><name><surname>Chubykin</surname> <given-names>AA</given-names></name><name><surname>Yang</surname> <given-names>A</given-names></name><name><surname>Bear</surname> <given-names>MF</given-names></name><name><surname>Boyden</surname> <given-names>ES</given-names></name><name><surname>Forest</surname> <given-names>CR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Microchip amplifier for in vitro, in vivo, and automated whole cell patch-clamp recording</article-title><source>Journal of Neurophysiology</source><volume>113</volume><fpage>1275</fpage><lpage>1282</lpage><pub-id pub-id-type="doi">10.1152/jn.00629.2014</pub-id><pub-id pub-id-type="pmid">25429119</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jouhanneau</surname> <given-names>JS</given-names></name><name><surname>Kremkow</surname> <given-names>J</given-names></name><name><surname>Dorrn</surname> <given-names>AL</given-names></name><name><surname>Poulet</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>In vivo monosynaptic excitatory transmission between layer 2 cortical pyramidal neurons</article-title><source>Cell Reports</source><volume>13</volume><fpage>2098</fpage><lpage>2106</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2015.11.011</pub-id><pub-id pub-id-type="pmid">26670044</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kodandaramaiah</surname> <given-names>SB</given-names></name><name><surname>Franzesi</surname> <given-names>GT</given-names></name><name><surname>Chow</surname> <given-names>BY</given-names></name><name><surname>Boyden</surname> <given-names>ES</given-names></name><name><surname>Forest</surname> <given-names>CR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Automated whole-cell patch-clamp electrophysiology of neurons in vivo</article-title><source>Nature Methods</source><volume>9</volume><fpage>585</fpage><lpage>587</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1993</pub-id><pub-id pub-id-type="pmid">22561988</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kodandaramaiah</surname> <given-names>SB</given-names></name><name><surname>Holst</surname> <given-names>GL</given-names></name><name><surname>Wickersham</surname> <given-names>IR</given-names></name><name><surname>Singer</surname> <given-names>AC</given-names></name><name><surname>Franzesi</surname> <given-names>GT</given-names></name><name><surname>McKinnon</surname> <given-names>ML</given-names></name><name><surname>Forest</surname> <given-names>CR</given-names></name><name><surname>Boyden</surname> <given-names>ES</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Assembly and operation of the autopatcher for automated intracellular neural recording in vivo</article-title><source>Nature Protocols</source><volume>11</volume><fpage>634</fpage><lpage>654</lpage><pub-id pub-id-type="doi">10.1038/nprot.2016.007</pub-id><pub-id pub-id-type="pmid">26938115</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolb</surname> <given-names>I</given-names></name><name><surname>Stoy</surname> <given-names>WA</given-names></name><name><surname>Rousseau</surname> <given-names>EB</given-names></name><name><surname>Moody</surname> <given-names>OA</given-names></name><name><surname>Jenkins</surname> <given-names>A</given-names></name><name><surname>Forest</surname> <given-names>CR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Cleaning patch-clamp pipettes for immediate reuse</article-title><source>Scientific Reports</source><volume>6</volume><elocation-id>35001</elocation-id><pub-id pub-id-type="doi">10.1038/srep35001</pub-id><pub-id pub-id-type="pmid">27725751</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>AK</given-names></name><name><surname>Epsztein</surname> <given-names>J</given-names></name><name><surname>Brecht</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Head-anchored whole-cell recordings in freely moving rats</article-title><source>Nature Protocols</source><volume>4</volume><fpage>385</fpage><lpage>392</lpage><pub-id pub-id-type="doi">10.1038/nprot.2009.5</pub-id><pub-id pub-id-type="pmid">19247288</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>AK</given-names></name><name><surname>Epsztein</surname> <given-names>J</given-names></name><name><surname>Brecht</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Whole-cell patch-clamp recordings in freely moving animals</article-title><source>Methods in Molecular Biology</source><volume>1183</volume><fpage>263</fpage><lpage>276</lpage><pub-id pub-id-type="doi">10.1007/978-1-4939-1096-0_17</pub-id><pub-id pub-id-type="pmid">25023315</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Margrie</surname> <given-names>TW</given-names></name><name><surname>Brecht</surname> <given-names>M</given-names></name><name><surname>Sakmann</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>In vivo, low-resistance, whole-cell recordings from neurons in the anaesthetized and awake mammalian brain</article-title><source>Pflügers Archiv European Journal of Physiology</source><volume>444</volume><fpage>491</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1007/s00424-002-0831-z</pub-id><pub-id pub-id-type="pmid">12136268</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Margrie</surname> <given-names>TW</given-names></name><name><surname>Meyer</surname> <given-names>AH</given-names></name><name><surname>Caputi</surname> <given-names>A</given-names></name><name><surname>Monyer</surname> <given-names>H</given-names></name><name><surname>Hasan</surname> <given-names>MT</given-names></name><name><surname>Schaefer</surname> <given-names>AT</given-names></name><name><surname>Denk</surname> <given-names>W</given-names></name><name><surname>Brecht</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Targeted whole-cell recordings in the mammalian brain in vivo</article-title><source>Neuron</source><volume>39</volume><fpage>911</fpage><lpage>918</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2003.08.012</pub-id><pub-id pub-id-type="pmid">12971892</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pak</surname> <given-names>N</given-names></name><name><surname>Dergance</surname> <given-names>MJ</given-names></name><name><surname>Emerick</surname> <given-names>MT</given-names></name><name><surname>Gagnon</surname> <given-names>EB</given-names></name><name><surname>Forest</surname> <given-names>CR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>An instrument for controlled, automated production of micrometer scale fused silica pipettes</article-title><source>Journal of Mechanical Design</source><volume>133</volume><elocation-id>061006</elocation-id><pub-id pub-id-type="doi">10.1115/1.4004194</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pak</surname> <given-names>N</given-names></name><name><surname>Siegle</surname> <given-names>JH</given-names></name><name><surname>Kinney</surname> <given-names>JP</given-names></name><name><surname>Denman</surname> <given-names>DJ</given-names></name><name><surname>Blanche</surname> <given-names>TJ</given-names></name><name><surname>Boyden</surname> <given-names>ES</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Closed-loop, ultraprecise, automated craniotomies</article-title><source>Journal of Neurophysiology</source><volume>113</volume><fpage>3943</fpage><lpage>3953</lpage><pub-id pub-id-type="doi">10.1152/jn.01055.2014</pub-id><pub-id pub-id-type="pmid">25855700</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perin</surname> <given-names>R</given-names></name><name><surname>Berger</surname> <given-names>TK</given-names></name><name><surname>Markram</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A synaptic organizing principle for cortical neuronal groups</article-title><source>PNAS</source><volume>108</volume><fpage>5419</fpage><lpage>5424</lpage><pub-id pub-id-type="doi">10.1073/pnas.1016051108</pub-id><pub-id pub-id-type="pmid">21383177</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poulet</surname> <given-names>JF</given-names></name><name><surname>Petersen</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Internal brain state regulates membrane potential synchrony in barrel cortex of behaving mice</article-title><source>Nature</source><volume>454</volume><fpage>881</fpage><lpage>885</lpage><pub-id pub-id-type="doi">10.1038/nature07150</pub-id><pub-id pub-id-type="pmid">18633351</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stockslager</surname> <given-names>MA</given-names></name><name><surname>Capocasale</surname> <given-names>CM</given-names></name><name><surname>Holst</surname> <given-names>GL</given-names></name><name><surname>Simon</surname> <given-names>MD</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>McGruder</surname> <given-names>DJ</given-names></name><name><surname>Rousseau</surname> <given-names>EB</given-names></name><name><surname>Stoy</surname> <given-names>WA</given-names></name><name><surname>Sulchek</surname> <given-names>T</given-names></name><name><surname>Forest</surname> <given-names>CR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Optical method for automated measurement of glass micropipette tip geometry</article-title><source>Precision Engineering</source><volume>46</volume><fpage>88</fpage><lpage>95</lpage><pub-id pub-id-type="doi">10.1016/j.precisioneng.2016.04.003</pub-id><pub-id pub-id-type="pmid">27672230</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stoy</surname> <given-names>WA</given-names></name><name><surname>Kolb</surname> <given-names>I</given-names></name><name><surname>Holst</surname> <given-names>GL</given-names></name><name><surname>Liew</surname> <given-names>Y</given-names></name><name><surname>Pala</surname> <given-names>A</given-names></name><name><surname>Yang</surname> <given-names>B</given-names></name><name><surname>Boyden</surname> <given-names>ES</given-names></name><name><surname>Stanley</surname> <given-names>GB</given-names></name><name><surname>Forest</surname> <given-names>CR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Robotic navigation to subcortical neural tissue for intracellular electrophysiology in vivo</article-title><source>Journal of Neurophysiology</source><volume>118</volume><fpage>1141</fpage><lpage>1150</lpage><pub-id pub-id-type="doi">10.1152/jn.00117.2017</pub-id><pub-id pub-id-type="pmid">28592685</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suk</surname> <given-names>HJ</given-names></name><name><surname>van Welie</surname> <given-names>I</given-names></name><name><surname>Kodandaramaiah</surname> <given-names>SB</given-names></name><name><surname>Allen</surname> <given-names>B</given-names></name><name><surname>Forest</surname> <given-names>CR</given-names></name><name><surname>Boyden</surname> <given-names>ES</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Closed-loop real-time imaging enables fully automated cell-targeted patch-clamp neural recording in vivo</article-title><source>Neuron</source><volume>95</volume><fpage>1037</fpage><lpage>1047</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.08.011</pub-id><pub-id pub-id-type="pmid">28858614</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname> <given-names>Q</given-names></name><name><surname>Brecht</surname> <given-names>M</given-names></name><name><surname>Burgalossi</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Juxtacellular recording and morphological identification of single neurons in freely moving rats</article-title><source>Nature Protocols</source><volume>9</volume><fpage>2369</fpage><lpage>2381</lpage><pub-id pub-id-type="doi">10.1038/nprot.2014.161</pub-id><pub-id pub-id-type="pmid">25211514</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Welie</surname> <given-names>I</given-names></name><name><surname>Roth</surname> <given-names>A</given-names></name><name><surname>Ho</surname> <given-names>SS</given-names></name><name><surname>Komai</surname> <given-names>S</given-names></name><name><surname>Häusser</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Conditional spike transmission mediated by electrical coupling ensures millisecond precision-correlated activity among interneurons in vivo</article-title><source>Neuron</source><volume>90</volume><fpage>810</fpage><lpage>823</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.04.013</pub-id><pub-id pub-id-type="pmid">27161527</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.24656.031</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>King</surname><given-names>Andrew J</given-names></name><role>Reviewing Editor</role><aff id="aff10"><institution>University of Oxford</institution><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Multi-neuron intracellular recording in vivo via interacting autopatching robots&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by Andrew King as the Senior and Reviewing Editor. The following individuals involved in the review of your submission have agreed to reveal their identity: Randy M Bruno (Reviewer #2); Andreas T Schaefer (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This study describes an automated technique for obtaining multiple simultaneous whole-cell recordings in anesthetized and awake, head-fixed mice. Specifically, the authors developed an algorithm for linking 4 autopatching devices in to attempt to obtain simultaneous whole-cell recordings from nearby neurons. They were able to obtain 2 or 3 simultaneously patched neurons 31% of the time in anesthetized animals, and 19% of the time in awake, head-fixed animals. The reviewers agreed that automating whole-cell recording is valuable for improving experimental throughput since this is a labor-intensive procedure, and that this extension of the authors' previous work on automation of patching to several pipettes could have a considerable impact.</p><p>Essential revisions:</p><p>Although the reviewers considered this paper to be potentially suitable for the extended format of a Technical Report in <italic>eLife</italic>, they agreed that too little information is provided to allow others to assess or reconstruct the 4 channel autopatching system. More details are needed on how to put together this system as well as on the quality of the recordings obtained with it, including a comparison with manual approaches. The paper addresses how to patch additional neurons while minimally disturbing neurons that have already been patched, but does not deal adequately with the issue of how to position pipettes without them running into each other. Furthermore, delicate and/or time-consuming steps are still manually performed or not fully automated. Consequently, while the reviewers thought that this system had considerable potential, they were not yet convinced about the advance it offered over manual patching.</p><p>1) The paper needs to provide enough information for people to as easily as possible replicate the construction of the autopatcher system; this includes providing a parts list, software code, drawings, circuits, PCB layouts and setup instructions (perhaps in the form of an appendix).</p><p>2) One aspect that remains completely unclear is the alignment of pipettes. With four and potentially in the future more pipettes, there is not only a risk of not knowing exactly where they go but for them to crash into each other. The pipettes are placed on the brain surface manually with apparent freedom of placement in 2-D, and the authors do not mention how the relative positions of the pipettes are tracked during autopatching. Do they have a way to calibrate the relative positions of the tips in 3D as they move towards each other? How are collisions of pipettes prevented? Can this be automated? This is important, otherwise how can experimenters know where to place the pipettes on the brain surface so they don't collide during the automated advance of the pipettes during patching? If alignment procedure is left to chance the user would presumably be limited to targeting cells several 100 μm apart from each other, thus precluding the study of local to medium size circuits. Do the authors have numbers for the actual inter-pipette tip distances for their successful multi-neuron patching attempts to assess how closely they can regularly record multiple neurons?</p><p>3) The authors say it took 10.5 min per attempt, but this presumably excludes the manual exchange of pipettes and manual positioning of the pipettes on the brain surface. On lines 162-163 the authors appear to indicate that it would take (3.2 + 2.6)*4 = approx. 23 min between successive 4-pipette patching attempts, assuming no recording time. Also, the manual exchange of pipettes and placement of each of the 4 pipettes on the brain surface using the four 3-axis manual manipulators would seem to be a step that is labor-intensive and requires experimenter care (in the case of brain surface placement), especially because the experimenter would have to ensure that the pipettes don't hit each other during automated patching. Although there is certainly a savings of effort from automating the lowering of the pipettes to search depth, hunting for neurons, sealing, and breaking in, it looks like the experimenter would need to be actively performing operations approximately half of the time, and be present most or all of the time. For multi-pipette patching, the exchange of pipettes and safe placement of all pipettes on the brain surface is significantly more involved than the single-pipette case, and so the relative gain from automating only the patching itself is smaller for multi-pipette compared to single-pipette patching. This is especially true since there does not appear to be an automated anti-pipette-collision procedure.</p><p>4) There needs to be an investigation into selection bias – one key advantage of whole-cell patching is low selection bias (i.e. not by firing rate unlike classical unit recordings). However, the thresholds they set e.g. for quality of seal, the pressure when moving pipettes down (and even possibly the shape of the pipette) create a bias in their own right. While this is usually under the user's control, the autopatcher will allow the user to &quot;conveniently forget&quot; about these issues. Thus, this needs to be discussed prominently and augmented by some data on e.g. how different thresholds result in different ratios of interneurons to pyramidal cells.</p><p>5) Generally, for evaluating the quality of the recordings there is too little data on stability, R_access as f(t) and very few raw example traces. Showing data as in the original Nature Methods paper but for 3-neuron recordings would give further confidence that superior stability can be achieved. What is the rate of loss of gigaseals that have already been obtained while other pipettes are hunting for neurons and/or attempting a gigaseal?</p><p>6) The novelty of the work, beyond the previous manuscripts, lies in obtaining doublets/triplets, but these multi-neuron recordings are poorly described. For example (Introduction, last paragraph) awake recordings are reported to last ~14 minutes on average – is this with regard to individual cells, doublets or triplets? Presumably, this statement is about individual cells, but that is less important here. The awake section of the Results tells us only that 18 out of 97 trials yielded a doublet or triplet. Please tell the reader how many of each, and how many minutes of usable data could be collected from doublets on average and, separately, from triplets on average. Ranges of time would be nice, too. The preceding anesthetized section should also be clear about the frequency and duration of doubles and triplets. These paired recordings need to be held for at least a few minutes for anyone to obtain sufficient data for the simplest experiments. The authors should also show an example of a 3-neuron recording, as they did for 2-neuron traces in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p><p>7) The authors should compare and contrast the essential steps and success rate of their multi-neuron patching algorithm with previous manual methods. In particular, Jouhanneau et al., 2015 (cited by the authors) reported that they obtained many examples of 2-4 simultaneously patched nearby neurons in anesthetized animals using two-photon guided targeting. It would be helpful to the field if the numbers of attempts and mice used to obtain the respective datasets could be compared (perhaps via a personal communication from Poulet).</p><p>8) In the development section, for the first algorithm they tried, it's not clear why the authors thought it would be possible to attempt to form a gigaseal by releasing suction after a delay (after other pipettes were also in a position to attempt a gigaseal). In the second algorithm they tried, again it is not clear why the authors assumed that pulling back 30 μm before attempting a gigaseal, waiting, then moving by 30 μm again would work. This is probably a strategy that would not work well in standard single pipette patching. After trying fully independent autopatchers (which makes sense to try first), it would seem to have made the most sense to just try the third (and final) algorithm, since it appears to be the same as that used in Jouhanneau et al. The one algorithmic variation that the authors did not report trying, and which could potentially be successful, would be to break in after each gigaseal is formed, instead of simultaneously after all gigaseals were formed.</p><p>9) It is important for less experienced users to emphasize that key skills for performing surgery, high quality durectomy, pulling pipettes, making internal solution, controlling pressure lines etc. remain an obstacle – otherwise users will be heavily disappointed if the autopatcher does not permit plug-and-play physiology with the same ease as e.g. photometry.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.24656.032</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>Although the reviewers considered this paper to be potentially suitable for the extended format of a Technical Report in eLife, they agreed that too little information is provided to allow others to assess or reconstruct the 4 channel autopatching system. More details are needed on how to put together this system as well as on the quality of the recordings obtained with it, including a comparison with manual approaches. The paper addresses how to patch additional neurons while minimally disturbing neurons that have already been patched, but does not deal adequately with the issue of how to position pipettes without them running into each other. Furthermore, delicate and/or time-consuming steps are still manually performed or not fully automated. Consequently, while the reviewers thought that this system had considerable potential, they were not yet convinced about the advance it offered over manual patching.</p></disp-quote><p>We would like to thank the reviewers for the constructive feedback on the manuscript. We have significantly revised the manuscript, and hope these address the reviewer and editorial concerns adequately.</p><disp-quote content-type="editor-comment"><p>1) The paper needs to provide enough information for people to as easily as possible replicate the construction of the autopatcher system; this includes providing a parts list, software code, drawings, circuits, PCB layouts and setup instructions (perhaps in the form of an appendix).</p></disp-quote><p>We thank the reviewer for the suggestion, and have now included an appendix describing the construction of the multipatcher system, a user manual for the software code, a parts list and associated CAD files.</p><disp-quote content-type="editor-comment"><p>2) One aspect that remains completely unclear is the alignment of pipettes. With four and potentially in the future more pipettes, there is not only a risk of not knowing exactly where they go but for them to crash into each other. The pipettes are placed on the brain surface manually with apparent freedom of placement in 2-D, and the authors do not mention how the relative positions of the pipettes are tracked during autopatching. Do they have a way to calibrate the relative positions of the tips in 3D as they move towards each other? How are collisions of pipettes prevented? Can this be automated? This is important, otherwise how can experimenters know where to place the pipettes on the brain surface so they don't collide during the automated advance of the pipettes during patching? If alignment procedure is left to chance the user would presumably be limited to targeting cells several 100 μm apart from each other, thus precluding the study of local to medium size circuits. Do the authors have numbers for the actual inter-pipette tip distances for their successful multi-neuron patching attempts to assess how closely they can regularly record multiple neurons?</p><p>The reviewer raises an interesting point. We have included a section on the alignment of pipettes. In short, to precisely position the pipette relative to each other inside the brain, we utilized the auto-craniotomy robot (Pak et al. 2015) to perform precisely spaced arrays of craniotomies. We have included this information in the Materials and methods section (subsection “Surgical Procedures”, second paragraph), added a Figure supplement to <xref ref-type="fig" rid="fig4">Figure 4</xref> (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p><p>3) The authors say it took 10.5 min per attempt, but this presumably excludes the manual exchange of pipettes and manual positioning of the pipettes on the brain surface. On lines 162-163 the authors appear to indicate that it would take (3.2 + 2.6)*4 = approx. 23 min between successive 4-pipette patching attempts, assuming no recording time. Also, the manual exchange of pipettes and placement of each of the 4 pipettes on the brain surface using the four 3-axis manual manipulators would seem to be a step that is labor-intensive and requires experimenter care (in the case of brain surface placement), especially because the experimenter would have to ensure that the pipettes don't hit each other during automated patching. Although there is certainly a savings of effort from automating the lowering of the pipettes to search depth, hunting for neurons, sealing, and breaking in, it looks like the experimenter would need to be actively performing operations approximately half of the time, and be present most or all of the time. For multi-pipette patching, the exchange of pipettes and safe placement of all pipettes on the brain surface is significantly more involved than the single-pipette case, and so the relative gain from automating only the patching itself is smaller for multi-pipette compared to single-pipette patching. This is especially true since there does not appear to be an automated anti-pipette-collision procedure.</p></disp-quote><p>This is indeed a good observation by the reviewer. Our rate limiting step is the exchange and safe positioning of pipettes. While we focused our efforts in this work on automating the procedure for multipatching, we point to recent work done by our groups (Kolb et al. Nat Sci Rep 2016) where we developed pipette cleaning methods that can be used to along with additional programmatically control to realize fully autonomous autopatchers. In this study, we showed that up to 12 trials could be conducted per hour without any human intervention. It is our aim to equip future versions of the multipatcher with such capabilities for fully autonomous operation. Thus, one initial step registering the position of craniotomies and the pipette tips will be sufficient to run the multipatcher robot for long durations of time, eliminating the key bottle neck identified by the reviewer.</p><disp-quote content-type="editor-comment"><p>4) There needs to be an investigation into selection bias – one key advantage of whole-cell patching is low selection bias (i.e. not by firing rate unlike classical unit recordings). However, the thresholds they set e.g. for quality of seal, the pressure when moving pipettes down (and even possibly the shape of the pipette) create a bias in their own right. While this is usually under the user's control, the autopatcher will allow the user to &quot;conveniently forget&quot; about these issues. Thus, this needs to be discussed prominently and augmented by some data on e.g. how different thresholds result in different ratios of interneurons to pyramidal cells.</p></disp-quote><p>We understand the reviewer’s concern about selection bias. In this study we did not perform an analysis of selection bias because we did perform a detailed analysis in our original Autopatcher paper (Kodandaramaiah et al., 2012 Nat. Methods), and each pipette in the Multipatcher is by itself executing the original Autopatcher algorithm, with all parameters conserved. However, based on our and other studies (e.g.: Rancz et al., 2011 Nat Neurosci), we expected to see about 2/3 of all the neurons recorded to be regular spiking neurons.</p><disp-quote content-type="editor-comment"><p>5) Generally, for evaluating the quality of the recordings there is too little data on stability, R_access as f(t) and very few raw example traces. Showing data as in the original Nature Methods paper but for 3-neuron recordings would give further confidence that superior stability can be achieved. What is the rate of loss of gigaseals that have already been obtained while other pipettes are hunting for neurons and/or attempting a gigaseal?</p></disp-quote><p>We thank the reviewer for the suggestion. We do report the rate of loss of gigaseals when other pipettes are hunting in the last paragraph of the subsection “Multipatcher Algorithm”. We have also added an example raw trace of triple whole-cell patch clamp recording in both anesthetized and awake mice in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p><disp-quote content-type="editor-comment"><p>6) The novelty of the work, beyond the previous manuscripts, lies in obtaining doublets/triplets, but these multi-neuron recordings are poorly described. For example (Introduction, last paragraph) awake recordings are reported to last ~14 minutes on average – is this with regard to individual cells, doublets or triplets? Presumably, this statement is about individual cells, but that is less important here. The awake section of the Results tells us only that 18 out of 97 trials yielded a doublet or triplet. Please tell the reader how many of each, and how many minutes of usable data could be collected from doublets on average and, separately, from triplets on average. Ranges of time would be nice, too. The preceding anesthetized section should also be clear about the frequency and duration of doubles and triplets. These paired recordings need to be held for at least a few minutes for anyone to obtain sufficient data for the simplest experiments. The authors should also show an example of a 3-neuron recording, as they did for 2-neuron traces in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p></disp-quote><p>We have now included representative triple patch recordings obtained in anesthetized and awake head-fixed conditions in <xref ref-type="fig" rid="fig5">Figure 5</xref> of the revised manuscript. Regarding the times, as described in the manuscript, successful recordings were those that met the quality criterion for &gt;5 minutes. This includes useable recordings, as well as the time it took to transition to the recording software, measure the cell parameters. Recordings were considered to be successful duals and triples only if all the neurons met the quality and time criterion. We have included this information in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>7) The authors should compare and contrast the essential steps and success rate of their multi-neuron patching algorithm with previous manual methods. In particular, Jouhanneau et al., 2015 (cited by the authors) reported that they obtained many examples of 2-4 simultaneously patched nearby neurons in anesthetized animals using two-photon guided targeting. It would be helpful to the field if the numbers of attempts and mice used to obtain the respective datasets could be compared (perhaps via a personal communication from Poulet).</p></disp-quote><p>We agree with the reviewer that the field of patch clamping would benefit from a comparison of yields of manual, image guided, and automated procedures. To investigate the yields that manual multi-patch clampers expect, we reached out to the authors of the Jouhanneau et al. 2015 paper but they did not respond.</p><disp-quote content-type="editor-comment"><p>In our experience, very few articles report detailed step-by-step yields that would enable the aforementioned. We note that two photon targeted patch clamping (TPTP), the technique employed by Jouhanneau et al. 2015, typically has higher reported success rates than blind in vivo patch clamping. Jouhanneau et al. 2015 neither report success rates for individual patch clamp trials, nor do they report a combinatorial reduction in whole-cell yield. They use the shadow patching technique pioneered by Kitamura et al. in 2008. In this paper, Kitamura et al. note a success rate of single patch attempts as 67-70%. Because this technique is an image guided technique, we take this to be the upper bound of yield for patch clamping techniques. Thus, we believe that a 31% yield for any given pipette is reasonable for an automated, blind patch clamping technique.</p><p>8) In the development section, for the first algorithm they tried, it's not clear why the authors thought it would be possible to attempt to form a gigaseal by releasing suction after a delay (after other pipettes were also in a position to attempt a gigaseal). In the second algorithm they tried, again it is not clear why the authors assumed that pulling back 30 μm before attempting a gigaseal, waiting, then moving by 30 μm again would work. This is probably a strategy that would not work well in standard single pipette patching. After trying fully independent autopatchers (which makes sense to try first), it would seem to have made the most sense to just try the third (and final) algorithm, since it appears to be the same as that used in Jouhanneau et al. The one algorithmic variation that the authors did not report trying, and which could potentially be successful, would be to break in after each gigaseal is formed, instead of simultaneously after all gigaseals were formed.</p></disp-quote><p>The reviewer raises a good point. We did not attempt the break-in immediately after gigasealing, as (i) we wanted to revert at the earliest to searching for neurons in the remaining channels and (ii) once whole cell is established, the cell starts getting dialyzed and the access resistances start degrading. Thus, the recording obtained from different pipettes in the same sessions would have been qualitatively different. We did observe that this lead to decreased success rate of breaking in, which is discussed in the manuscript (subsection “Performance in Anesthetized Rodents”, last paragraph).</p><disp-quote content-type="editor-comment"><p>9) It is important for less experienced users to emphasize that key skills for performing surgery, high quality durectomy, pulling pipettes, making internal solution, controlling pressure lines etc. remain an obstacle – otherwise users will be heavily disappointed if the autopatcher does not permit plug-and-play physiology with the same ease as e.g. photometry.</p><p>We do agree with the reviewer’s comment. We have edited our Discussion section (last paragraph) to emphasize this point, and added a citation to our previous protocols paper (Kodandaramaiah et al. Nat Protocols 2016) that discusses these nuances in detail.</p></disp-quote></body></sub-article></article>