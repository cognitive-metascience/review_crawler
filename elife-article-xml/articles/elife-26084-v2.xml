<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">26084</article-id><article-id pub-id-type="doi">10.7554/eLife.26084</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Learning multiple variable-speed sequences in striatum via cortical tutoring</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-81662"><name><surname>Murray</surname><given-names>James M</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3706-4895</contrib-id><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-84009"><name><surname>Escola</surname><given-names>G Sean</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0645-1964</contrib-id><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><institution content-type="dept">Center for Theoretical Neuroscience</institution>, <institution>Columbia University</institution>, <addr-line><named-content content-type="city">New York</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Frank</surname><given-names>Michael J</given-names></name><role>Reviewing editor</role><aff><institution>Brown University</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>jm4347@columbia.edu</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>08</day><month>05</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e26084</elocation-id><history><date date-type="received"><day>16</day><month>02</month><year>2017</year></date><date date-type="accepted"><day>07</day><month>05</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Murray et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Murray et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-26084-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.26084.001</object-id><p>Sparse, sequential patterns of neural activity have been observed in numerous brain areas during timekeeping and motor sequence tasks. Inspired by such observations, we construct a model of the striatum, an all-inhibitory circuit where sequential activity patterns are prominent, addressing the following key challenges: (i) obtaining control over temporal rescaling of the sequence speed, with the ability to generalize to new speeds; (ii) facilitating flexible expression of distinct sequences via selective activation, concatenation, and recycling of specific subsequences; and (iii) enabling the biologically plausible learning of sequences, consistent with the decoupling of learning and execution suggested by lesion studies showing that cortical circuits are necessary for learning, but that subcortical circuits are sufficient to drive learned behaviors. The same mechanisms that we describe can also be applied to circuits with both excitatory and inhibitory populations, and hence may underlie general features of sequential neural activity pattern generation in the brain.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26084.001">http://dx.doi.org/10.7554/eLife.26084.001</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>basal ganglia</kwd><kwd>circuit models</kwd><kwd>motor sequences</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>NIH DP5 OD019897</award-id><principal-award-recipient><name><surname>Escola</surname><given-names>G Sean</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007027</institution-id><institution>Leon Levy Foundation</institution></institution-wrap></funding-source><award-id>Fellowship</award-id><principal-award-recipient><name><surname>Escola</surname><given-names>G Sean</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Inspired by the sparse, sequential neural activity patterns observed in striatum, a new circuit model implements variable-speed activity, the encoding of multiple sequences, and a tutor/student relationship between cortex and striatum.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Understanding the mechanisms by which neural circuits learn and generate the complex, dynamic patterns of activity that underlie behavior and cognition remains a fundamental goal of neuroscience. Of particular interest are sparse sequential activity patterns that are time-locked to behavior and have been observed experimentally in multiple brain areas including cortex (<xref ref-type="bibr" rid="bib55">Luczak et al., 2007</xref>; <xref ref-type="bibr" rid="bib42">Jin et al., 2009</xref>; <xref ref-type="bibr" rid="bib38">Harvey et al., 2012</xref>), basal ganglia (<xref ref-type="bibr" rid="bib42">Jin et al., 2009</xref>; <xref ref-type="bibr" rid="bib79">Rueda-Orozco and Robbe, 2015</xref>; <xref ref-type="bibr" rid="bib61">Mello et al., 2015</xref>; <xref ref-type="bibr" rid="bib14">Dhawale et al., 2015</xref>; <xref ref-type="bibr" rid="bib32">Gouvêa et al., 2015</xref>; <xref ref-type="bibr" rid="bib3">Bakhurin et al., 2017</xref>), hippocampus (<xref ref-type="bibr" rid="bib65">Nádasdy et al., 1999</xref>; <xref ref-type="bibr" rid="bib69">Pastalkova et al., 2008</xref>; <xref ref-type="bibr" rid="bib56">MacDonald et al., 2013</xref>; <xref ref-type="bibr" rid="bib17">Eichenbaum, 2014</xref>), and songbird area HVC (<xref ref-type="bibr" rid="bib36">Hahnloser et al., 2002</xref>; <xref ref-type="bibr" rid="bib51">Kozhevnikov and Fee, 2007</xref>). These experiments reveal key features of the relationship to behavior that must be recapitulated in any circuit-level model of sequential neural activity. First, these sequences have been shown to temporally rescale (i.e., contract and dilate) as behavior speeds up and slows down (<xref ref-type="bibr" rid="bib61">Mello et al., 2015</xref>; <xref ref-type="bibr" rid="bib32">Gouvêa et al., 2015</xref>), while human psychophysics experiments have shown that after learning a behavior (e.g., an arm reach trajectory) at one speed of execution, it can be reliably expressed at other speeds without additional learning (<xref ref-type="bibr" rid="bib30">Goodbody and Wolpert, 1998</xref>; <xref ref-type="bibr" rid="bib45">Joiner et al., 2011</xref>; <xref ref-type="bibr" rid="bib82">Shmuelof et al., 2012</xref>). Thus the neural circuits underlying such behaviors must be able to extrapolate from the sequential activity generated at a particular speed during learning to temporally rescaled patterns. Second, the same neural circuits exhibit the capacity to flexibly generate different sequential activity patterns for different behaviors (<xref ref-type="bibr" rid="bib69">Pastalkova et al., 2008</xref>; <xref ref-type="bibr" rid="bib38">Harvey et al., 2012</xref>; <xref ref-type="bibr" rid="bib56">MacDonald et al., 2013</xref>). Third, the process of learning imposes additional constraints on models of sequence generating circuits beyond the need for biologically plausible learning rules. As discussed in greater detail below, lesion and inactivation experiments have been shown to prevent learning without impairing the expression of learned behaviors (<xref ref-type="bibr" rid="bib63">Miyachi et al., 1997</xref>; <xref ref-type="bibr" rid="bib48">Kawai et al., 2015</xref>) suggesting that the neural circuitry of learning and execution can be decoupled.</p><p>These results indicate a need for a comprehensive model to study the generation of sparse, sequential neural activity. Such a model should facilitate temporal rescaling and extrapolation to new speeds, flexibly change in order to meet changing contexts or behavioral goals, and decouple learning from performance. Several mechanisms have been proposed for generating sparse sequences, for example continuous attractor models (<xref ref-type="bibr" rid="bib77">Rokni and Sompolinsky, 2012</xref>), reservoir computing networks (<xref ref-type="bibr" rid="bib74">Rajan et al., 2016</xref>), and feedforward excitatory architectures including synfire chains (<xref ref-type="bibr" rid="bib1">Abeles, 1991</xref>; <xref ref-type="bibr" rid="bib29">Goldman, 2009</xref>; <xref ref-type="bibr" rid="bib21">Fiete et al., 2010</xref>; <xref ref-type="bibr" rid="bib92">Veliz-Cuba et al., 2015</xref>). Each of these models suffers limitations, however. For example: attractor models require finely tuned synaptic connectivity and single-neuron tuning properties; trained recurrent neural networks lack biologically plausible learning rules and connectivity constraints; and synfire chains have limited ability to temporally rescale their dynamics. In this work we propose a model which allows for (i) arbitrary speeding up and slowing down of the activity pattern without relearning of the synaptic weights, (ii) the flexible expression of multiple sequential patterns, and (iii) an arbitrary sequence to be learned from a time-dependent external input and reproduced once that external input is removed.</p><p>Although the basic mechanisms that we propose may be realized in any brain area where sequences have been observed, for a specific example and to compare to experimental results, we focus on neural activity in striatum, where sparse activity sequences have been observed in recurrently connected populations of inhibitory medium spiny neurons (MSNs) in rodents during locomotion (<xref ref-type="bibr" rid="bib79">Rueda-Orozco and Robbe, 2015</xref>) and lever-press delay tasks (<xref ref-type="bibr" rid="bib61">Mello et al., 2015</xref>; <xref ref-type="bibr" rid="bib14">Dhawale et al., 2015</xref>; <xref ref-type="bibr" rid="bib32">Gouvêa et al., 2015</xref>). The striatum collects inputs from many areas of cortex and thalamus, plays an important part in controlling learned movements using its projections via the output structures of basal ganglia to motor thalamus and brainstem (<xref ref-type="bibr" rid="bib67">Parent, 1990</xref>; <xref ref-type="bibr" rid="bib35">Grillner and Robertson, 2015</xref>), and has a central role in reinforcement learning (<xref ref-type="bibr" rid="bib33">Graybiel, 2005</xref>). MSNs, which constitute over 90% of the neurons in striatum (<xref ref-type="bibr" rid="bib26">Gerfen and Surmeier, 2011</xref>), exhibit stereotyped sequential firing patterns during learned motor sequences and learned behaviors in which timing plays an important role, with sparse firing sequences providing a seemingly ideal representation for encoding time and providing a rich temporal basis that can be read out by downstream circuits to determine behavior (<xref ref-type="bibr" rid="bib42">Jin et al., 2009</xref>; <xref ref-type="bibr" rid="bib61">Mello et al., 2015</xref>; <xref ref-type="bibr" rid="bib79">Rueda-Orozco and Robbe, 2015</xref>; <xref ref-type="bibr" rid="bib14">Dhawale et al., 2015</xref>; <xref ref-type="bibr" rid="bib32">Gouvêa et al., 2015</xref>; <xref ref-type="bibr" rid="bib3">Bakhurin et al., 2017</xref>). Such neural activity has been shown in rodents to strongly correlate with time judgement in a fixed-interval lever-press task (<xref ref-type="bibr" rid="bib32">Gouvêa et al., 2015</xref>), and with kinematic parameters such as the animal’s position and speed in a task in which the animal was trained to remain on a treadmill for a particular length of time (<xref ref-type="bibr" rid="bib79">Rueda-Orozco and Robbe, 2015</xref>). In addition, pharmacological attenuation of neural activity in sensorimotor striatum has been shown to impair such behavior (<xref ref-type="bibr" rid="bib63">Miyachi et al., 1997</xref>; <xref ref-type="bibr" rid="bib61">Mello et al., 2015</xref>; <xref ref-type="bibr" rid="bib79">Rueda-Orozco and Robbe, 2015</xref>), suggesting that sequential firing patterns in striatum are likely to play a causal role in an animal’s ability to perform timekeeping and learned motor sequences. While motor cortex is also known to play a major role in both the learning and directing of motor behaviors such as limb movements in both primates (<xref ref-type="bibr" rid="bib22">Fritsch and Hitzig, 1870</xref>; <xref ref-type="bibr" rid="bib24">Georgopoulos et al., 1982</xref>, <xref ref-type="bibr" rid="bib25">1986</xref>; <xref ref-type="bibr" rid="bib64">Moran and Schwartz, 1999</xref>; <xref ref-type="bibr" rid="bib46">Kakei et al., 1999</xref>) and rodents (<xref ref-type="bibr" rid="bib98">Wise and Donoghue, 1986</xref>; <xref ref-type="bibr" rid="bib50">Kleim et al., 1998</xref>; <xref ref-type="bibr" rid="bib95">Whishaw, 2000</xref>; <xref ref-type="bibr" rid="bib37">Harrison et al., 2012</xref>), cortical lesion studies have long pointed to the ability of subcortical structures to direct a large repertoire of movements, particularly ‘innate’ movements and learned movements that don’t require dexterous hand motion (<xref ref-type="bibr" rid="bib53">Lawrence and Kuypers, 1968</xref>; <xref ref-type="bibr" rid="bib85">Sorenson and Ellison, 1970</xref>; <xref ref-type="bibr" rid="bib7">Bjursten et al., 1976</xref>; <xref ref-type="bibr" rid="bib68">Passingham et al., 1983</xref>).</p><p>Importantly, sequences of neural activity in the striatum exhibit the ability to temporally rescale their dynamics, dilating or contracting the sequence duration by up to a factor of five in proportion to the time-delay interval for obtaining a reward (<xref ref-type="bibr" rid="bib61">Mello et al., 2015</xref>). A successful model should therefore have the ability to dynamically rescale its activity, ideally with the ability to generalize to new speeds after training at a particular speed, and without requiring relearning of the synaptic weights each time there is switching to a slower or faster trial.</p><p>As in other brain areas, neural representations within striatum are specific to the behavior being performed and to the context in which it is executed (<xref ref-type="bibr" rid="bib43">Jin and Costa, 2010</xref>; <xref ref-type="bibr" rid="bib88">Tecuapetla et al., 2014</xref>). In constructing a model of sequential activity patterns, it is therefore important that neurons be able to participate in multiple sequences in a flexible, context-dependent manner. This might involve the selective activation, concatenation, and recycling of particular subsequences, as well as the capability of a circuit to switch between different operational modes, e.g. input-driven versus autonomously driven. All of these will be important features of the model that we construct below.</p><p>Addressing the roles of cortical and striatal circuits in the learning and performance of motor skills, one set of recent studies has shown that rats are unable to learn precisely timed lever-press sequences when motor cortex is lesioned, but are able to successfully perform the sequence if the lesion occurs after the learning has already taken place (<xref ref-type="bibr" rid="bib48">Kawai et al., 2015</xref>; <xref ref-type="bibr" rid="bib66">Otchy et al., 2015</xref>). It was therefore suggested that motor cortex may act as a ‘tutor’ to subcortical brain circuits during learning, and that these lower brain circuits eventually internalize the activity pattern, allowing them to drive behavior without receiving further instruction from the tutor once the behavior has been learned (<xref ref-type="bibr" rid="bib48">Kawai et al., 2015</xref>). We therefore develop a model of such a tutor-to-student circuit, in which a cortical tutor teaches a particular activity sequence to striatum, which eventually becomes able to perform the sequence autonomously.</p><p>In this paper, we propose a model for how striatum could be structured in order to produce sequential activity patterns that can rescale to faster and slower speeds, flexibly select and combine particular subsequences specific to particular behaviors, and decouple learning from performance in a way consistent with the lesion experiments discussed above. A key element is the presence of synaptic depression at the inhibitory synapses between MSNs, which has been shown to exist experimentally (<xref ref-type="bibr" rid="bib87">Tecuapetla et al., 2007</xref>) and which competes with the effect of feedforward excitatory input to determine the rate of switching of activity from one neuron cluster to the next. By adjusting the relative levels of these parameters, it is possible to dilate or contract the time dependence of neural activity sequences by an order of magnitude or more. Furthermore, we show that our striatal model can encode multiple sequences that can be expressed individually or pieced together into longer sequences as selected by the external input. Next, learning is addressed by introducing an anti-Hebbian plasticity rule at the synapses between MSNs, and we show how this enables the circuit to obtain the desired structure and internalize the dynamical activity pattern, so that temporally patterned input from cortex eventually becomes unnecessary as the behavior is learned. Finally, we show that the same mechanisms can be applied to circuits with both excitatory and inhibitory units, and hence may provide an explanation for the sequential firing patterns that have been observed in other brain areas including hippocampus (<xref ref-type="bibr" rid="bib65">Nádasdy et al., 1999</xref>; <xref ref-type="bibr" rid="bib69">Pastalkova et al., 2008</xref>; <xref ref-type="bibr" rid="bib56">MacDonald et al., 2013</xref>; <xref ref-type="bibr" rid="bib17">Eichenbaum, 2014</xref>) and cortex (<xref ref-type="bibr" rid="bib55">Luczak et al., 2007</xref>; <xref ref-type="bibr" rid="bib42">Jin et al., 2009</xref>; <xref ref-type="bibr" rid="bib38">Harvey et al., 2012</xref>).</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Synaptic depression enables temporally controllable sparse activity sequences in striatum</title><p>Experimentally observed population activity patterns in striatum during learned behaviors are sparse and sequential, and these are the main features that we want our model network to exhibit in a robust manner. In order to achieve sparse activity, we make use of the well-known fact that recurrent inhibition can lead to a winner-take-all steady state in which a single unit or group of units (where a unit consists of a cluster of MSNs) becomes active and inhibits the other units in the network from becoming active. Indeed, recurrent inhibition is a hallmark feature of MSNs in striatum, and such a picture has previously been suggested to apply to striatum (<xref ref-type="bibr" rid="bib96">Wickens et al., 1991</xref>; <xref ref-type="bibr" rid="bib6">Beiser and Houk, 1998</xref>; <xref ref-type="bibr" rid="bib23">Fukai, 1999</xref>). Although individual inhibitory synapses between MSNs are relatively sparse and weak on the scale of the currents needed to drive spiking in these neurons (<xref ref-type="bibr" rid="bib40">Jaeger et al., 1994</xref>; <xref ref-type="bibr" rid="bib89">Tepper et al., 2004</xref>), active populations of many MSNs firing together may more effectively mediate suppression between populations, in particular if these populations are also receiving sufficient background excitation from cortex and/or thalamus to keep them near the firing threshold (<xref ref-type="bibr" rid="bib72">Ponzi and Wickens, 2010</xref>, <xref ref-type="bibr" rid="bib73">2013</xref>; <xref ref-type="bibr" rid="bib2">Angulo-Garcia et al., 2016</xref>), possibly in a metastable depolarized ‘up state’ (<xref ref-type="bibr" rid="bib97">Wilson, 1993</xref>).</p><p>In addition to sparse activity, our model also requires a mechanism by which the activity can be made to switch from one unit to another, otherwise the network would lock into a single winner-take-all state. While other mathematically similar approaches are possible (see Appendix 1 for further discussion), in this paper we propose that this mechanism is short-term plasticity in the form of depressive adaptation at synapses between MSNs. Such synaptic depression has in fact been observed experimentally (<xref ref-type="bibr" rid="bib87">Tecuapetla et al., 2007</xref>). The effect of synaptic depression is to weaken the amount of inhibition from an active unit onto inactive units over time. If all units also receive constant external excitatory input, then eventually the inhibition may weaken sufficiently that the net input to one of the inactive units becomes positive, at which point the activity switches to this unit, and it begins to inhibit the other units. This competition between synaptic depression and the level of external input is the basic mechanism that determines the dynamics of activity switching. In particular, adjusting the level of external input can change the duration of time that it takes for activity to switch from one unit to the next, thus providing a mechanism for controlling the speed of an activity sequence in a robust manner without requiring any change in intrinsic properties of the neurons or temporally precise input to the network.</p><p>The dynamics of <inline-formula><mml:math id="inf1"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which we think of as describing the activity level of a cluster of MSNs, and the associated synaptic depression factors <inline-formula><mml:math id="inf2"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in our network model are described by the following equations:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>τ</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The first equation describes the activity of unit <inline-formula><mml:math id="inf3"><mml:mi>i</mml:mi></mml:math></inline-formula> as being determined by a nonlinear function acting on recurrent and external inputs. The recurrent synapses are inhibitory, with weights <inline-formula><mml:math id="inf4"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and the external input is excitatory, with <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. For concreteness, we take the nonlinear function to be the sigmoidal function <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is a gain parameter. The second equation in (1) describes the dynamics of synaptic depression, where the dynamic variable <inline-formula><mml:math id="inf8"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> represents the depression of all outgoing synapses from unit <inline-formula><mml:math id="inf9"><mml:mi>j</mml:mi></mml:math></inline-formula> with characteristic timescale <inline-formula><mml:math id="inf10"><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>, which we take to be much greater than the membrane time constant <inline-formula><mml:math id="inf11"><mml:mi>τ</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib87">Tecuapetla et al., 2007</xref>). The first term on the right-hand side of the equation drives <inline-formula><mml:math id="inf12"><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> to attain a resting state value of 1 if the presynaptic unit <inline-formula><mml:math id="inf13"><mml:mi>j</mml:mi></mml:math></inline-formula> is inactive, so that the synapse is fully potentiated. If the presynaptic unit becomes active, with <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, then the second term drives <inline-formula><mml:math id="inf15"><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> toward <inline-formula><mml:math id="inf16"><mml:mi>β</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>β</mml:mi><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, so that the synaptic weight depotentiates to a finite minimum value when the presynaptic unit is active (<xref ref-type="bibr" rid="bib87">Tecuapetla et al., 2007</xref>).</p><p>As described above and discussed in detail in Appendix 1, the model defined by (1) exhibits activity switching between units due to competition between the two terms in the argument of the nonlinear function <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The second term is a positive external input, which tends to make <inline-formula><mml:math id="inf19"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> active. The first term is a negative input from other units in the network, and becomes weaker over time as other units remain active due to decreasing synaptic weight <inline-formula><mml:math id="inf20"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. When the first term eventually becomes smaller than the second, the net input becomes positive, causing <inline-formula><mml:math id="inf21"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> to become active and begin to inhibit other units.</p><p>In <xref ref-type="fig" rid="fig1">Figure 1a–b</xref>, we show a striatal model that is fully connected by inhibitory synapses, where all off-diagonal elements have the same inhibitory weight (−1) except for those connecting unit <inline-formula><mml:math id="inf22"><mml:mi>j</mml:mi></mml:math></inline-formula> to unit <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, which are depotentiated by an amount <inline-formula><mml:math id="inf24"><mml:mi>η</mml:mi></mml:math></inline-formula>. This means that if unit <inline-formula><mml:math id="inf25"><mml:mi>j</mml:mi></mml:math></inline-formula> is currently active, then unit <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> will become active next since it experiences the least amount of inhibition. <xref ref-type="fig" rid="fig1">Figure 1c–d</xref> show that the expected sequence of activity (which is repeating due to the fact that we also depotentiate the weight between the last and first units) is indeed obtained in such a network, and that the magnitude of the constant external input can be used to control the rate of switching. The period of the activity sequence slows down tremendously as <inline-formula><mml:math id="inf27"><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup></mml:math></inline-formula> approaches the synaptic depression parameter <inline-formula><mml:math id="inf28"><mml:mi>β</mml:mi></mml:math></inline-formula>. This slowing down allows for the temporal dynamics to be smoothly and reliably controlled, providing a potential mechanism consistent with recent experiments showing dramatic dilation of the time-dependence in population recordings of striatal neurons (<xref ref-type="bibr" rid="bib61">Mello et al., 2015</xref>), without requiring new learning of the synaptic weights from one trial to the next. While an infinite range of dynamical scaling can be obtained in the idealized limit of <inline-formula><mml:math id="inf29"><mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>, <xref ref-type="fig" rid="fig1">Figure 1d</xref> shows that attaining both very long and short switch times <inline-formula><mml:math id="inf31"><mml:mi>T</mml:mi></mml:math></inline-formula> is possible even away from this idealized limit. Finally, <xref ref-type="fig" rid="fig1">Figure 1e</xref> shows that a substantial dynamical range of sequence speeds can be obtained even if control over the precise value of the input <inline-formula><mml:math id="inf32"><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup></mml:math></inline-formula> is limited, as may be the case due to noise in the system, preventing extremely slow and extremely fast sequence speeds.<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.26084.002</object-id><label>Figure 1.</label><caption><title>Rescalable sparse sequential activity in the striatum.</title><p>(<bold>a</bold>) Schematic diagram of a 10-unit striatal network. Units receive constant external excitatory input and mutually inhibit each other. The burgundy synapses correspond to a depotentiated path through the network that enables sequential activity. (<bold>b</bold>) The synaptic weight matrix for the network shown in ‘a’, with subdiagonal weights depotentiated by <inline-formula><mml:math id="inf33"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>c</bold>) The magnitude of the constant input <inline-formula><mml:math id="inf34"><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup></mml:math></inline-formula> to the network can be used to control the rate at which the activity switches from one population to the next. The units in the network are active in sequential order, with the speed of the sequence increasing as the excitatory input to the network is increased. Parameters for the synaptic depression are <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo>⁢</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, the gain parameter is <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>, synapses connecting sequentially active units are depotentiated by <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>, and the effective input is <inline-formula><mml:math id="inf39"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>in</mml:mi></mml:msup><mml:mo>≡</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. (<bold>d</bold>) The switch time as a function of the level input to the network. Points are determined by numerically solving <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>; curve is the theoretical result (equation shown in figure; see Appendix 1 for details). If the input is limited to the range <inline-formula><mml:math id="inf40"><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>in</mml:mi></mml:msup><mml:mo>≤</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (e.g. because reliable functioning in the presence of noise would require the input to stay away from the boundaries within which switching occurs), then <inline-formula><mml:math id="inf41"><mml:msub><mml:mi>T</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf42"><mml:msub><mml:mi>T</mml:mi><mml:mi>min</mml:mi></mml:msub></mml:math></inline-formula> are the maximum and minimum possible switching periods that can be obtained. (<bold>e</bold>) The temporal scaling factor is shown as a function of <inline-formula><mml:math id="inf43"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> for different values of the synaptic depression parameter <inline-formula><mml:math id="inf44"><mml:mi>β</mml:mi></mml:math></inline-formula>. The red dot corresponds to the ratio of the red dots in ‘d’.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26084.002">http://dx.doi.org/10.7554/eLife.26084.002</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-26084-fig1-v2"/></fig></p></sec><sec id="s2-2"><title>Targeted external input selects which of several sequences striatum expresses</title><p>We can extend the model described so far to multiple—and even overlapping—behaviors by positing that the external input from cortex and/or thalamus targets the particular subset of MSNs needed to express a particular behavior. If multiple sequences are encoded in the weights between different populations of MSNs, then the external input can be thought of as a ‘spotlight’ that activates the behavior that is most appropriate in a particular context, with the details of that behavior encoded within the striatum itself, as shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. These subpopulations may even be partially overlapping, with the overlapping portions encoding redundant parts of the corresponding behaviors. In this way, a wide variety of motor behaviors could be encoded without requiring a completely distinct sequence for every possible behavior. This model dissociates the computations of the selection and expression of motor sequence behaviors. The inputs to striatum select a sequence (possibly composed of several subsequences) by targeting a certain subpopulation of MSNs, and then the striatum converts this selection into a dynamical pattern of neural activity that expresses the behavior in time.<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.26084.003</object-id><label>Figure 2.</label><caption><title>Targeted external input expresses one of several sequences.</title><p>(<bold>a</bold>) Schematic illustration of partially overlapping striatal activity sequences selectively activated by external input. The arrows do not represent synaptic connections, but rather the sequence of activity within an assembly. Overlapping parts of the striatal activity sequences encode redundancies in portions of the corresponding behaviors (in this case, the middle portion of a paw movement trajectory). (<bold>b</bold>) Left panels show network activities in which only the shaded units receive external input. Right panels show the weights, with only the outlined weights being relevant for the network dynamics for each behavior.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26084.003">http://dx.doi.org/10.7554/eLife.26084.003</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-26084-fig2-v2"/></fig></p><p>In addition to having multiple activity patterns being driven by different sets of tonically active inputs, the network is capable of operating in two distinct modes, as shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>. In the first mode, the dynamics of neural activity is determined by the recurrent connectivity, as in the preceding examples, with external excitatory input providing a tonic ‘go’ signal to drive the network. In the second mode, on the other hand, the external input is strongly time-dependent and unique for each unit. Such input effectively overrides the pattern stored in the recurrent connectivity and enslaves the network dynamics to top-down input. In addition to providing an alternative route to controlling the network dynamics, such time-dependent external input can also play a role in facilitating learning, as we discuss below.<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.26084.004</object-id><label>Figure 3.</label><caption><title>Driving the network from <xref ref-type="fig" rid="fig1">Figure 1</xref> with two different types of input leads to distinct operational modes.</title><p>If input to the network (<italic>top</italic>) is tonic, the recurrent weights cause the network to produce a particular activity sequence (<italic>bottom</italic>), as in <xref ref-type="fig" rid="fig1">Figure 1</xref>, with the magnitude of the input controlling the speed of the sequence. Alternatively, if the input is strongly time-dependent, then the network dynamics are enslaved to the input pattern. In this case each unit receives a unique pulsed input, with the input to unit four highlighted for illustration.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26084.004">http://dx.doi.org/10.7554/eLife.26084.004</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-26084-fig3-v2"/></fig></p></sec><sec id="s2-3"><title>Anti-Hebbian plasticity enables sequence learning</title><p>A striatal network with initially random connectivity can learn to produce sparse sequential activity patterns when driven by time-dependent cortical input. We again consider a network described by (1), but now with distinct time-dependent external inputs <inline-formula><mml:math id="inf45"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>in</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to each unit <inline-formula><mml:math id="inf46"><mml:mi>i</mml:mi></mml:math></inline-formula>, and dynamic synaptic weights described by<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf47"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> is the activity of unit <inline-formula><mml:math id="inf48"><mml:mi>j</mml:mi></mml:math></inline-formula>, low-pass filtered over a time scale <inline-formula><mml:math id="inf49"><mml:msub><mml:mi>τ</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf50"><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf51"><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> control the rates of learning. Roughly, <inline-formula><mml:math id="inf52"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> will be nonzero if unit <inline-formula><mml:math id="inf53"><mml:mi>j</mml:mi></mml:math></inline-formula> has been recently active over the time window from <inline-formula><mml:math id="inf54"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf55"><mml:mi>t</mml:mi></mml:math></inline-formula>. The first term in (2) thus causes <inline-formula><mml:math id="inf56"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> if postsynaptic unit <inline-formula><mml:math id="inf57"><mml:mi>i</mml:mi></mml:math></inline-formula> is active together with or immediately following presynaptic unit <inline-formula><mml:math id="inf58"><mml:mi>j</mml:mi></mml:math></inline-formula>. Otherwise, if <inline-formula><mml:math id="inf59"><mml:mi>j</mml:mi></mml:math></inline-formula> is active but <inline-formula><mml:math id="inf60"><mml:mi>i</mml:mi></mml:math></inline-formula> is not active, the second term causes <inline-formula><mml:math id="inf61"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. (It is important that <inline-formula><mml:math id="inf62"><mml:msub><mml:mi>τ</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> should not exceed the typical time for which a unit remains active, or else there will be synaptic depotentiation not only between sequentially active units, but also between units separated by two or more steps in the sequence.) <xref ref-type="disp-formula" rid="equ2">Equation (2)</xref> thus describes an anti-Hebbian learning rule, according to which synapses connecting units that fire together or in sequence are depotentiated, while others are potentiated.</p><p><xref ref-type="fig" rid="fig4">Figure 4</xref> shows that sequences can develop in the network when it is subjected to several cycles of time-varying external input. <xref ref-type="fig" rid="fig4">Figure 4a</xref> shows that a network initially having no special features in its connectivity matrix can acquire such structure through anti-Hebbian plasticity by subjecting it to a repeated sequence of pulse-like inputs, which induce a regular pattern of sequential activity. It also shows that tonic input to the network leads to sparse activity sequences both before and after training, with short, random sequences occurring before training and long, specific sequences occurring after training. We have found that successful sequence learning can occur for a range of input sequence speeds when the pulse width is <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi/><mml:mo>≳</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, but that some units in the sequence will be skipped if the input varies on time scales <inline-formula><mml:math id="inf64"><mml:mrow><mml:mi/><mml:mo>≪</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (data not shown). In <xref ref-type="fig" rid="fig4">Figure 4b</xref>, the regular input to each unit is replaced by a superposition of sinusoids with random amplitudes and phase shifts. (We presume that in the brain cortical input to the striatum is structured in a meaningful way rather than random, determined by a reinforcement learning process that we are not modeling explicitly. Our use of random input here, however, illustrates that robust sequences emerge naturally in striatum even in the case where the input is not highly structured.) This input leads to a particular activity sequence in the network, with only one unit being active at a given time due to the inhibitory competition between units. Meanwhile, synaptic weights between sequentially active units are depotentiated by anti-Hebbian learning, eventually leading to a weight matrix (labeled '<inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>500</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>' in <xref ref-type="fig" rid="fig4">Figure 4b</xref>) in which each unit that is active at some time during the sequence is described by a column with a single depotentiated entry, which corresponds to the next unit to become active in the sequence. <xref ref-type="fig" rid="fig4">Figure 4c</xref> illustrates that it is also possible to train a network that has previously learned one sequence to produce a new unrelated sequence. The evolution of the synaptic weights during the learning and relearning phases is illustrated in <xref ref-type="fig" rid="fig4">Figure 4d</xref>, where the number of training cycles required for learning the sequence is determined by the learning rates <inline-formula><mml:math id="inf66"><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf67"><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> in (2).<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.26084.005</object-id><label>Figure 4.</label><caption><title>Repeated external input can tutor striatum to produce sparse activity sequences.</title><p>(<bold>a</bold>) A regular sequence of pulse-like inputs (only 10 inputs are shown for clarity; <inline-formula><mml:math id="inf68"><mml:mrow><mml:mn>25</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> = 1 cycle) (<italic>left</italic>) leads to a sequential activity pattern (<italic>center</italic>) and, via anti-Hebbian plasticity, converts a random connectivity matrix (at <inline-formula><mml:math id="inf69"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) to a structured matrix after 20 cycles (at <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>500</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>) (<italic>right</italic>). The input during the first half of the first cycle and the last half of the last cycle has been replaced by constant input to all units, which leads to a short random sequence before training and to a long specific sequence following training, with the sequence speed determined by the level of tonic input. (<bold>b</bold>) Starting with random connectivity between units (at <inline-formula><mml:math id="inf71"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), each unit is driven with a distinct time-varying input consisting of a random superposition of sine waves (two cycles of which are shown for 10 inputs) which produces a repeating activity sequence. Anti-Hebbian learning results in a structured matrix after 20 cycles (at <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>500</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>). (<bold>c</bold>) 20 cycles with a new input elicits a different activity pattern and overwrites the prior connectivity to a new structured matrix (at <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1000</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>). (<bold>d</bold>) The evolution of the synaptic weights during the learning in ‘b’ and ‘c’. The blue, green, and red lines show the average weights of synapses involved in the first pattern, the second pattern, and neither pattern, respectively. (The weights shown in blue are not all repotentiated in the second training period due to the fact that some of these synapses are from units that are not active in the second sequence. For these weights <inline-formula><mml:math id="inf74"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>, and thus they do not learn.) (<bold>e</bold>) The average time for switching from one unit to the next as a function of the constant external input after learning. (<bold>f</bold>) The switch times are robust to random perturbations of the weights. Starting with the final weights in ‘c’, each weight is perturbed by <inline-formula><mml:math id="inf75"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf76"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic"/><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is a normal random variable, and <inline-formula><mml:math id="inf77"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math></inline-formula>, 0.05, or 0.10. The perturbed switch times (slightly offset for visibility) are averaged over active units and realizations of the perturbation. Learning-related parameters are <inline-formula><mml:math id="inf78"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf79"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.05</mml:mn><mml:mo>/</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf80"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.02</mml:mn><mml:mo>/</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26084.005">http://dx.doi.org/10.7554/eLife.26084.005</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-26084-fig4-v2"/></fig></p><p>After the network has been trained in this way, it is able to reproduce the same pattern of activity even after the time-dependent input is replaced by a constant excitatory input to all units. This is similar to the network model studied in above, although now with the active units appearing in random order. <xref ref-type="fig" rid="fig4">Figure 4e</xref> shows that, as in the earlier network model, the level of external input can be used to control the speed of the activity sequence, with the dynamical range spanning more than an order of magnitude. Finally, <xref ref-type="fig" rid="fig4">Figure 4f</xref> shows that, again replacing the time-varying input with constant external input to all units, the activity pattern and sequence speed in this trained network are robust with respect to random perturbations of the weights <inline-formula><mml:math id="inf81"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. For comparison, we show in <xref ref-type="fig" rid="fig8">Appendix 2—figure 1</xref> that performance is severely degraded by comparable perturbations in a reservoir computing system.</p><p>Previous models have shown that neural activity sequences can emerge from initially unstructured networks of excitatory neurons via spike-timing-dependent plasticity (STDP) (<xref ref-type="bibr" rid="bib21">Fiete et al., 2010</xref>; <xref ref-type="bibr" rid="bib92">Veliz-Cuba et al., 2015</xref>; <xref ref-type="bibr" rid="bib75">Ravid Tannenbaum and Burak, 2016</xref>). Compared with these earlier works, our model has the advantage of being able to dynamically adjust the speed of the activity sequence, as shown in <xref ref-type="fig" rid="fig4">Figure 4e</xref> (<italic>cf</italic>. however Refs. [<xref ref-type="bibr" rid="bib92">Veliz-Cuba et al., 2015</xref>; <xref ref-type="bibr" rid="bib70">Pehlevan et al., 2015</xref>; <xref ref-type="bibr" rid="bib90">Tristan et al., 2014</xref>], where some temporal rescaling in activity patterns has been obtained using distinct mechanisms). In addition, our model does not require the assumption of heterosynaptic competition limiting the summed synaptic weights into and out of each unit, as in Ref. (<xref ref-type="bibr" rid="bib21">Fiete et al., 2010</xref>).</p><p>Taken together, the above results show, within the context of a highly simplified network model, that time-varying input can lead to robust activity sequences, but that this input is no longer necessary once the circuit has internalized the sequence. Further, the speed of the dynamics can be adjusted using the overall level of external input to the network. Taken as a model of striatum, it therefore provides a possible explanation of the motor cortex lesion studies of Ref. (<xref ref-type="bibr" rid="bib48">Kawai et al., 2015</xref>), as well as the variable-delay lever press experiments of Ref. (<xref ref-type="bibr" rid="bib61">Mello et al., 2015</xref>).</p></sec><sec id="s2-4"><title>A sparsely connected spiking model supports learning and execution of time-flexible sequences</title><p><xref ref-type="fig" rid="fig5">Figure 5</xref> shows that, as in the continuous version of the model, temporally patterned input and recurrent plasticity can be used to train a recurrent inhibitory network having no initial structure in the recurrent weights to perform a particular firing sequence, with only one cluster of neurons active at any one time. Recent experimental work has indeed identified clusters of neurons in striatum that appear to function as transiently active cell assemblies (<xref ref-type="bibr" rid="bib4">Barbera et al., 2016</xref>). Because we interpret the units studied in the continuous case above as clusters of neurons rather than individual neurons, full connectivity between units can be easily obtained even if connectivity between neurons is sparse, since some neurons in one cluster will always have synapses to some neurons in any other cluster if the clusters are sufficiently large. In <xref ref-type="fig" rid="fig5">Figure 5</xref>, the connection probability between all pairs of neurons is <inline-formula><mml:math id="inf82"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, showing that sparse connectivity between neurons is sufficient to enable one population to effectively inhibit another, as in the continuous model. Although we have adopted a simplified scheme in which each spiking neuron participates in only one cell assembly of concurrently active neurons, making the mapping from the neurons in the spiking model onto the units in the continuous model straightforward, the approach could be extended using the standard theory of attractor networks to allow for each spiking neuron to participate in multiple assemblies (see Ref. [<xref ref-type="bibr" rid="bib11">Curti et al., 2004</xref>], as well as Ch. 17 of Ref. [<xref ref-type="bibr" rid="bib27">Gerstner et al., 2014</xref>]). In addition, while the highly structured input used to train the network may at first appear highly artificial, we point out that similar sparse sequential activity patterns have been observed in motor cortex, which is a main input to striatum, in rodents performing a learned lever-press task (<xref ref-type="bibr" rid="bib71">Peters et al., 2014</xref>; <xref ref-type="bibr" rid="bib14">Dhawale et al., 2015</xref>).<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.26084.006</object-id><label>Figure 5.</label><caption><title>Spiking model of striatum.</title><p>(<bold>a</bold>) Input currents to each of 8 distinct clusters of 100 neurons each (offset for clarity). This input pattern causes sequential activation of the clusters and is repeated noisily several times while the recurrent weights are learned. (<bold>b</bold>) Schematic anti-Hebbian spike-timing-dependent plasticity (STDP) rule for recurrent inhibitory synapses, showing that synapses are depotentiated when pre- and post-synaptic spikes are coincident or sequential, and potentiated if they are not. (This STDP curve applies whenever there is a presynaptic spike; there is no weight change in the absence of a presynaptic spike; see Materials and methods for specific mathematical details.) (<bold>c</bold>) Average recurrent inhibitory weights between clusters in a spiking network after learning with STDP. (<bold>d</bold>) After the weights have been learned, driving the network with tonic inputs of varying amplitudes leads to a rescaling of the period of the activity pattern. (<bold>e</bold>) Two examples of the time-rescaled activity patterns in the trained network with different values of tonic input current.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26084.006">http://dx.doi.org/10.7554/eLife.26084.006</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-26084-fig5-v2"/></fig></p><p>The STDP rule according to which recurrent inhibitory synapses are modified is shown in <xref ref-type="fig" rid="fig5">Figure 5b</xref>. The rule is anti-Hebbian, with postsynaptic spikes occurring at approximately the same time as or slightly after a presynaptic spike leading to weakening of the synapse, while presynaptic spikes occurring in isolation lead to a slight potentiation of the synapse. <xref ref-type="fig" rid="fig5">Figure 5c</xref> shows that this rule leads, after several repetitions of the input sequence, to a connectivity structure similar to that obtained in the continuous model, with decreased inhibition of a population onto itself and onto the next population in the sequence. Finally, as shown in <xref ref-type="fig" rid="fig5">Figure 5d,e</xref>, once the weights have been learned, constant input is sufficient to induce the desired firing pattern in the network, with the magnitude of this input controlling the rate at which the pattern progresses. Thus, as for the continuous network studied in above, the spiking network is able to learn a firing pattern from an external source, and later autonomously generate the same pattern over a wide range of speeds. Further details of the spiking model are presented in Materials and methods.</p></sec><sec id="s2-5"><title>Sparse sequential firing in an excitatory network with shared inhibition</title><p>Although, motivated by experimental results involving the basal ganglia, we have developed a model of recurrently connected inhibitory units, the same basic mechanisms for sequence learning can be applied to obtain sparse sequential firing patterns with flexible time encoding in a network of excitatory units with shared inhibition, a common motif used to obtain sparse coding of both static and dynamic neural activity patterns in models of cortical circuits. Such a network can be made to produce variable-speed sequential patterns just as in the circuit with direct lateral inhibition studied above. In this model, illustrated in <xref ref-type="fig" rid="fig6">Figure 6a</xref>, switching from from one excitatory unit to the next is again controlled by competition between the level of background input and synaptic depression at excitatory synapses, with the relative values of these quantities determining the rate at which activity jumps from one unit to the next. It is described by the following equations:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>τ</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.26084.007</object-id><label>Figure 6.</label><caption><title>A network of excitatory units with shared inhibition exhibits variable-speed sequences.</title><p>(<bold>a</bold>) A network of <inline-formula><mml:math id="inf83"><mml:mi>N</mml:mi></mml:math></inline-formula> excitatory units are connected by self-excitation, feedforward excitation, and shared inhibition. (<bold>b</bold>) Just as in the recurrent inhibitory network, this network exhibits sparse sequential firing when the excitatory synapses are made depressing, with the speed of the sequence controlled by the level of external input. Parameters are <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0.2</mml:mn><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26084.007">http://dx.doi.org/10.7554/eLife.26084.007</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-26084-fig6-v2"/></fig></p><p>where <inline-formula><mml:math id="inf85"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the activity of an excitatory unit, <inline-formula><mml:math id="inf86"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the activity of a shared inhibitory unit, and we assume <inline-formula><mml:math id="inf87"><mml:mrow><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mi>EI</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mi>IE</mml:mi></mml:msup></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. In the case where the timescale characterizing inhibition is much faster than that characterizing excitation (<inline-formula><mml:math id="inf88"><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) and the nonlinearity of the transfer function for the inhibitory units can be ignored (<inline-formula><mml:math id="inf89"><mml:mrow><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>), (3) becomes the following:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where we have defined <inline-formula><mml:math id="inf90"><mml:mrow><mml:msup><mml:mi>J</mml:mi><mml:mi>I</mml:mi></mml:msup><mml:mo>≡</mml:mo><mml:mrow><mml:msup><mml:mi>J</mml:mi><mml:mi>EI</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mi>IE</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. In the case where <inline-formula><mml:math id="inf91"><mml:mrow><mml:msup><mml:mi>J</mml:mi><mml:mi>I</mml:mi></mml:msup><mml:mo>≥</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and if excitatory synapses are made to be depressing by letting <inline-formula><mml:math id="inf92"><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> on the right hand sides of the above equations, then this is precisely the model that was introduced in (1).</p><p><xref ref-type="fig" rid="fig6">Figure 6b</xref> shows that the behavior of such a circuit with shared inhibition exhibits sparse sequential firing patterns virtually identical to those in the recurrent inhibitory network, even in the case where the above assumptions requiring inhibition to be fast and linear are relaxed by letting <inline-formula><mml:math id="inf93"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf94"><mml:mrow><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>tanh</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the Heaviside step function. However, the dynamic range of temporal scaling factors that can be obtained in this case is somewhat more limited than in the model with direct lateral inhibition, with an approximately four-fold speed increase obtained in <xref ref-type="fig" rid="fig6">Figure 6b</xref>, compared with over an order of magnitude obtained in <xref ref-type="fig" rid="fig1">Figure 1</xref>. This is due at least in part to the finite timescale <inline-formula><mml:math id="inf96"><mml:msub><mml:mi>τ</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:math></inline-formula> of the shared inhibitory population, which limits the speed at which activity switching can occur. This suggests that a purely inhibitory network, such as the the one realized in striatum, may provide an advantage over an excitatory network with shared inhibition if involved in variable-speed tasks requiring a large dynamical range.</p><p>Although we shall not explore the effects of synaptic plasticity for this model in detail, the mapping of the network with shared inhibition onto the model previously studied, as shown in <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref>, means that sequence learning can also take place within this model. This requires that recurrent connections between excitatory synapses should follow a Hebbian plasticity rule, according to which synapse <inline-formula><mml:math id="inf97"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is potentiated if unit <inline-formula><mml:math id="inf98"><mml:mi>i</mml:mi></mml:math></inline-formula> fires immediately after unit <inline-formula><mml:math id="inf99"><mml:mi>j</mml:mi></mml:math></inline-formula>.</p><p>While models of sequence generation in networks containing both excitatory and inhibitory recurrent connections have been constructed previously, they generally have had limited or no control over sequence speed (<xref ref-type="bibr" rid="bib21">Fiete et al., 2010</xref>; <xref ref-type="bibr" rid="bib54">Litwin-Kumar and Doiron, 2014</xref>; <xref ref-type="bibr" rid="bib70">Pehlevan et al., 2015</xref>; <xref ref-type="bibr" rid="bib91">Tully et al., 2016</xref>). The ability to generate variable-speed sequential activity patterns may be relevant for various frontal and motor cortical areas, which can be described by the circuit architecture shown in <xref ref-type="fig" rid="fig6">Figure 6a</xref>, and which can exhibit sparse sequences similar to those in striatum during time-dependent decision making and motor-control tasks (<xref ref-type="bibr" rid="bib38">Harvey et al., 2012</xref>; <xref ref-type="bibr" rid="bib71">Peters et al., 2014</xref>; <xref ref-type="bibr" rid="bib14">Dhawale et al., 2015</xref>). Given that these same cortical areas act as inputs to striatum, this mechanism for producing sparse sequences in circuits with shared inhibition may enable cortical networks to provide a pulse-like ‘tutoring’ input to striatum, as in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We have presented a model in which a network of recurrently connected inhibitory units internalize stereotyped sequential activity patterns based on temporally patterned input. Moreover, the same activity pattern can be reproduced after learning even after removing the temporally patterned input, and the speed of the activity pattern can be adjusted simply by varying the overall level of excitatory input, without requiring additional learning. As a model of striatum, we suggest that it may provide an explanation for recent experiments showing that (i) sparse sequences of neural activity in striatum dilate and contract in proportion to the delay interval in timekeeping tasks (<xref ref-type="bibr" rid="bib61">Mello et al., 2015</xref>), and (ii) motor cortex is necessary to learn new behaviors but not to perform already-learned behaviors (which are presumably directed at least in part by subcortical brain circuits such as the striatum) (<xref ref-type="bibr" rid="bib48">Kawai et al., 2015</xref>).</p><p>In unlesioned animals, the ability to progress between two modes of control—one in which the dynamical neural activity in the basal ganglia is enslaved to top-down input from cortex, and another in which subcortical brain circuits generate dynamics autonomously—may form the basis of a cognitive strategy enabling performance of behaviors more reliably and with less cognitive effort as performance at a particular task becomes increasingly expert. As illustrated in <xref ref-type="fig" rid="fig3">Figure 3</xref>, the network can rapidly switch between these modes even after learning of a particular pattern has taken place, perhaps somewhat similar to the switching between the ‘practice’ and ‘performance’ modes of male songbirds in the absence or presence of a female, respectively (<xref ref-type="bibr" rid="bib47">Kao et al., 2005</xref>). It is also well known that important differences exist in rodents, monkeys, and humans between goal-directed and habitual behaviors (for reviews, see Refs. [<xref ref-type="bibr" rid="bib99">Yin and Knowlton, 2006</xref>; <xref ref-type="bibr" rid="bib34">Graybiel, 2008</xref>; <xref ref-type="bibr" rid="bib15">Dolan and Dayan, 2013</xref>; <xref ref-type="bibr" rid="bib41">Jahanshahi et al., 2015</xref>]), and exploring the relation between these behavioral modes and the cortically and non-cortically driven modes described above is an important direction for future study. The question of where learned motor sequence memories are ultimately stored in the brain has been a subject of debate, with some studies favoring cortex—perhaps aided by ‘tutoring’ input from basal ganglia—as the ultimate storage site (<xref ref-type="bibr" rid="bib13">Desmurget and Turner, 2010</xref>; <xref ref-type="bibr" rid="bib39">Hélie et al., 2015</xref>), and others favoring subcortical structures such as sensorimotor striatum (<xref ref-type="bibr" rid="bib63">Miyachi et al., 1997</xref>; <xref ref-type="bibr" rid="bib48">Kawai et al., 2015</xref>). While our theory proposes a prominent role for striatum in storing motor sequence memories, it is also consistent with the possibility that motor sequence memories are effectively stored in <italic>both</italic> cortex and basal ganglia, so that inactivating either area in isolation will not necessarily abolish the learned behavior.</p><p>Assuming that the function of cortical input is to select from a set of possible learned behaviors as illustrated in <xref ref-type="fig" rid="fig2">Figure 2</xref>, we can ask what might be the potential role of corticostriatal plasticity, which many studies have shown is important for reward-based learning of motor behaviors in rodents, making these synapses a likely site for reinforcement learning (<xref ref-type="bibr" rid="bib76">Reynolds et al., 2001</xref>; <xref ref-type="bibr" rid="bib5">Barnes et al., 2005</xref>; <xref ref-type="bibr" rid="bib100">Yin et al., 2009</xref>). If a behavior leads to a greater-than-expected reward, then a (possibly dopamine-mediated) feedback signal can cause the recently active corticostriatal synapses to be strengthened, making that behavior more likely to be performed in that particular context in the future, lowering the threshold for activation and possibly speeding up the activity sequence underlying a desired behavior, making the basal ganglia circuit important for controlling the ‘vigor’ associated with movements (<xref ref-type="bibr" rid="bib101">Yttri and Dudman, 2016</xref>; <xref ref-type="bibr" rid="bib16">Dudman and Krakauer, 2016</xref>). Although the model that we have developed focuses on plasticity within striatum rather than corticostriatal plasticity, it is worth emphasizing that it is consistent with both types of plasticity being present, with corticostriatal plasticity likely involved with action selection and degree of vigor, whereas MSN-to-MSN plasticity may be more important for encoding kinematic details of a given behavior. The scenario just outlined can be viewed as a generalization of recent models of reinforcement learning in mammals (<xref ref-type="bibr" rid="bib20">Fee, 2012</xref>) to behaviors with temporally rich structure. Again using the spotlight analogy, it is also easy to see how multiple behaviors can be concatenated if the cortical and/or thalamic inputs activating the appropriate neuron assemblies are active together or in sequence. This provides a natural mechanism by which ‘chunking’ of simple behaviors into more complex behaviors might take place in the striatum (<xref ref-type="bibr" rid="bib43">Jin and Costa, 2010</xref>, <xref ref-type="bibr" rid="bib44">2015</xref>).</p><p>Regarding the dynamical rescaling of neural firing patterns, several previous theoretical frameworks have been proposed for interval timing, including pacemaker-accumulators (<xref ref-type="bibr" rid="bib28">Gibbon, 1977</xref>), in which a constant pacemaker signal is integrated until a threshold is reached; superposed neural oscillators (<xref ref-type="bibr" rid="bib60">Meck et al., 2008</xref>), in which oscillations at different frequencies lead to constructive interference at regular intervals; and sequence-based models (<xref ref-type="bibr" rid="bib49">Killeen and Fetterman, 1988</xref>; <xref ref-type="bibr" rid="bib62">Miller and Wang, 2006</xref>; <xref ref-type="bibr" rid="bib18">Escola et al., 2009</xref>), in which a network passes through a sequence of states over time. The last of these is most similar to the model that we present, though with the important difference that it involves stochastic rather than deterministic switching of activity from one unit to the next and hence has much greater trial-to-trial variability. In addition to these models, some previous theoretical works have attempted to use external input to control the speed of a ‘moving bump’ of neural activity within the framework of continuous attractors (<xref ref-type="bibr" rid="bib9">Burak and Fiete, 2009</xref>; <xref ref-type="bibr" rid="bib77">Rokni and Sompolinsky, 2012</xref>). However, in both of these previous studies, obtaining a moving activity bump requires external input that couples to different types of neurons in different ways. This is not required by the model presented here, for which the activity bump still propagates even if the input to all units is identical.</p><p>It is also useful to contrast our model with other possible approaches within the framework of reservoir computing, starting with a random recurrent neural network (RNN) and training it to produce a sparse sequential pattern of activity either in the recurrent units themselves (<xref ref-type="bibr" rid="bib74">Rajan et al., 2016</xref>) or in a group of readout units. Such training can be accomplished for example using recursive least squares learning (<xref ref-type="bibr" rid="bib86">Sussillo and Abbott, 2009</xref>; <xref ref-type="bibr" rid="bib52">Laje and Buonomano, 2013</xref>; <xref ref-type="bibr" rid="bib12">DePasquale et al., 2016</xref>; <xref ref-type="bibr" rid="bib31">Goudar and Buonomano, 2017</xref>) or various backpropagation-based algorithms (<xref ref-type="bibr" rid="bib59">Martens and Sutskever, 2011</xref>). However, as we show in <xref ref-type="fig" rid="fig8">Appendix 2—figure 1</xref>, such a trained RNN generically tends to be much more sensitive to perturbations in the recurrent weights. In addition, the successful training of such an RNN requires many examples spanning the entire range of time scaling that one wishes to produce, whereas the network that we present can learn a sequence at one particular speed and then generalize to faster or slower speeds simply by changing one global parameter, making this network more flexible as well as more robust. This is reminiscent of the ability of human subjects learning a motor skill to successfully generalize to faster and slower speeds after training at a single fixed speed (<xref ref-type="bibr" rid="bib82">Shmuelof et al., 2012</xref>).</p><p>We conclude by summarizing the experimental predictions suggested by our model. Central to the model is the anti-Hebbian plasticity rule that enables the inhibitory network to learn sequential patterns. Experimental results on medium spiny neurons in vitro have shown that recurrent synapses do in fact potentiate when presynaptic spiking is induced without postsynaptic spiking (<xref ref-type="bibr" rid="bib78">Rueda-Orozco et al., 2009</xref>), as one would expect from the second term in (2). To our knowledge, however, the question of whether paired pre- and postsynaptic spiking would lead to depotentiation, as described by the first term in the equation, has not yet been addressed experimentally. Both Hebbian and anti-Hebbian forms of STDP at inhibitory synapses have been found in other brain areas, as reviewed in Ref. (<xref ref-type="bibr" rid="bib93">Vogels et al., 2013</xref>). Because recurrently driven sequential activity of the sort that we describe requires depotentiation of inhibitory synapses between neurons both within the same cluster and from one cluster to the next sequentially active cluster, any activity-dependent learning rule must be qualitatively similar to the anti-Hebbian STDP curve shown in <xref ref-type="fig" rid="fig5">Figure 5b</xref>. The absence of such a learning rule would render it unlikely that learned recurrent connections within striatum play a major role in shaping learned sequences of neural activity, hence making this an important test of the theory.</p><p>Our model also predicts that the overall level of external excitatory input to the network should affect the speed of the animal’s time judgement and/or behavior. By providing differing levels of input to a population of striatal MSNs optogenetically, it could be tested whether the speed of the neural activity sequence among these cells is affected. An alternative, and perhaps less technically challenging, approach would be to measure the overall activity level in the network, which should increase as the speed of the sequence increases. This effect should persist as long as saturation effects in activity levels do not become prominent (which does occur in the continuous model we present, but not in our spiking model). Changing the strength of recurrent inhibition should have a similar effect to changing the input level, although this would have to be done selectively to synapses between MSNs without disrupting feedforward inhibition from interneurons within striatum. Alternatively, dopamine may be able to cause a change of the sequence speed by modifying the synaptic depression parameter (<inline-formula><mml:math id="inf100"><mml:mi>β</mml:mi></mml:math></inline-formula> in our model), and there is evidence from in vitro experiments that this indeed occurs (<xref ref-type="bibr" rid="bib87">Tecuapetla et al., 2007</xref>). Thus changes in tonic dopamine levels should be able to effect temporal rescaling by modulating the input gain and/or recurrent synaptic depression, and indeed there has already been some evidence that such dopamine modulation occurs (<xref ref-type="bibr" rid="bib84">Soares et al., 2016</xref>). However, it is as yet unknown whether direct- and indirect-pathway MSNs, which project to different targets within the basal ganglia (<xref ref-type="bibr" rid="bib26">Gerfen and Surmeier, 2011</xref>), play distinct roles with regard to interval timing. Including both types of MSN in the model will be a natural extension for future work and will allow for more direct comparison with existing models of basal ganglia function (<xref ref-type="bibr" rid="bib57">Maia and Frank, 2011</xref>; <xref ref-type="bibr" rid="bib80">Schroll and Hamker, 2013</xref>).</p><p>Our theory also predicts that the neural activity pattern in striatum should be the same in trained animals before and after cortical lesions and that this neural activity should play a role in driving the animal’s behavior. Investigating the neural activity in striatum and its role in generating behavior in lesioned animals would thus provide an important test of the theory. Observing the activity in cortex itself may also be useful. The theory suggests that time-dependent variability in cortical input is likely to decrease as an animal becomes more expert at performing a task, or as it switches between behavioral modes. This could be studied via population recordings from striatum-projecting neurons in motor cortex.</p><p>Finally, while the lesion experiments of Ref. (<xref ref-type="bibr" rid="bib48">Kawai et al., 2015</xref>) suggest that the instructive tutoring input to striatum likely originates in motor cortex, the source of the non-instructive input driving behavior and controlling speed after learning is unknown. It would be interesting for future experiments to explore whether the non-instructive input originates primarily from other cortical areas, or alternatively from thalamus, thereby endowing this structure with a functionally distinct role from cortex in driving behavior.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>The following model describes a network of exponential integrate-and-fire neurons with synaptic depression used in <xref ref-type="fig" rid="fig5">Figure 5</xref>:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>C</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mi>u</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mi>Q</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where the membrane potential <inline-formula><mml:math id="inf101"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is defined for each neuron <inline-formula><mml:math id="inf102"><mml:mi>i</mml:mi></mml:math></inline-formula>, and the dynamical synaptic depression variable <inline-formula><mml:math id="inf103"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which can be interpreted as the fraction of available neurotransmitter at a synapse, is defined for each synapse, with <inline-formula><mml:math id="inf104"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> meaning that the value of <inline-formula><mml:math id="inf105"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> just before the presynaptic spike should be used. When the membrane potential of neuron <inline-formula><mml:math id="inf106"><mml:mi>i</mml:mi></mml:math></inline-formula> diverges, that is, <inline-formula><mml:math id="inf107"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>, a spike is emitted from neuron <inline-formula><mml:math id="inf108"><mml:mi>i</mml:mi></mml:math></inline-formula>, and the potential is reset to the resting potential <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>. Each time a presynaptic neuron <inline-formula><mml:math id="inf110"><mml:mi>j</mml:mi></mml:math></inline-formula> fires a spike at time <inline-formula><mml:math id="inf111"><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, the depression variable is updated as <inline-formula><mml:math id="inf112"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf113"><mml:mi>u</mml:mi></mml:math></inline-formula> is the fraction of neurotransmitter that is used up during each spike (<inline-formula><mml:math id="inf114"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>u</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). The amount of electric charge that enters the postsynaptic cell during a presynaptic spike from neuron <inline-formula><mml:math id="inf115"><mml:mi>j</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf117"><mml:mi>Q</mml:mi></mml:math></inline-formula> has units of charge, and <inline-formula><mml:math id="inf118"><mml:mi>u</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf119"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf120"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are dimensionless. In terms of the original model described in the main text, each cluster of neurons corresponds to one of the units from the continuous model. As before, the competition between external input current and synaptic depression is used to obtain control over the temporal dynamics. The external inputs used in <xref ref-type="fig" rid="fig5">Figure 5</xref> are given by<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>sin</mml:mi><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msup><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>π</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf121"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula> nA, <inline-formula><mml:math id="inf122"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> nA, <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>800</mml:mn></mml:mrow></mml:math></inline-formula> ms, and <inline-formula><mml:math id="inf124"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> gives the phase shift of the input to each population <inline-formula><mml:math id="inf125"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. Noise, which was normally distributed and drawn independently for each cycle of the input, was added to <inline-formula><mml:math id="inf126"><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf127"><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf128"><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, as well as by adding to (6) higher-frequency terms <inline-formula><mml:math id="inf129"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mn>8</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mn>12</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with random amplitudes and phase shifts. The other parameters used in <xref ref-type="fig" rid="fig5">Figure 5</xref> are <inline-formula><mml:math id="inf131"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula> pF, <inline-formula><mml:math id="inf132"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula> nS, <inline-formula><mml:math id="inf133"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>70</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV, <inline-formula><mml:math id="inf134"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV, <inline-formula><mml:math id="inf135"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> mV, <inline-formula><mml:math id="inf136"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula> ms, <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf138"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>pre</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> ms, <inline-formula><mml:math id="inf139"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>post</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> ms, <inline-formula><mml:math id="inf140"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula> pC, <inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf142"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0.002</mml:mn></mml:mrow></mml:math></inline-formula>.</p></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>The authors would like to thank L Abbott, S Kato, B Ölveczky, and J Seeley for helpful discussions and comments on the manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>JMM, Conceptualization, Formal analysis, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>GSE, Conceptualization, Formal analysis, Writing—original draft, Writing—review and editing</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Abeles</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1991">1991</year><source>Corticonics: Neural Circuits of the Cerebral Cortex</source><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9780511574566</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angulo-Garcia</surname><given-names>D</given-names></name><name><surname>Berke</surname><given-names>JD</given-names></name><name><surname>Torcini</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Cell assembly dynamics of sparsely-connected inhibitory networks: a simple model for the collective activity of striatal projection neurons</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1004778</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004778</pub-id><pub-id pub-id-type="pmid">26915024</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bakhurin</surname><given-names>KI</given-names></name><name><surname>Goudar</surname><given-names>V</given-names></name><name><surname>Shobe</surname><given-names>JL</given-names></name><name><surname>Claar</surname><given-names>LD</given-names></name><name><surname>Buonomano</surname><given-names>DV</given-names></name><name><surname>Masmanidis</surname><given-names>SC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Differential encoding of time by prefrontal and striatal network dynamics</article-title><source>The Journal of Neuroscience</source><volume>37</volume><fpage>854</fpage><lpage>870</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1789-16.2017</pub-id><pub-id pub-id-type="pmid">28123021</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barbera</surname><given-names>G</given-names></name><name><surname>Liang</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Gerfen</surname><given-names>CR</given-names></name><name><surname>Culurciello</surname><given-names>E</given-names></name><name><surname>Chen</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Lin</surname><given-names>DT</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Spatially compact neural clusters in the dorsal striatum encode locomotion relevant information</article-title><source>Neuron</source><volume>92</volume><fpage>202</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.08.037</pub-id><pub-id pub-id-type="pmid">27667003</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barnes</surname><given-names>TD</given-names></name><name><surname>Kubota</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>D</given-names></name><name><surname>Jin</surname><given-names>DZ</given-names></name><name><surname>Graybiel</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Activity of striatal neurons reflects dynamic encoding and recoding of procedural memories</article-title><source>Nature</source><volume>437</volume><fpage>1158</fpage><lpage>1161</lpage><pub-id pub-id-type="doi">10.1038/nature04053</pub-id><pub-id pub-id-type="pmid">16237445</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beiser</surname><given-names>DG</given-names></name><name><surname>Houk</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Model of cortical-basal ganglionic processing: encoding the serial order of sensory events</article-title><source>Journal of Neurophysiology</source><volume>79</volume><fpage>3168</fpage><lpage>3188</lpage><pub-id pub-id-type="pmid">9636117</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bjursten</surname><given-names>LM</given-names></name><name><surname>Norrsell</surname><given-names>K</given-names></name><name><surname>Norrsell</surname><given-names>U</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>Behavioural repertory of cats without cerebral cortex from infancy</article-title><source>Experimental Brain Research</source><volume>25</volume><fpage>115</fpage><lpage>130</lpage><pub-id pub-id-type="doi">10.1007/BF00234897</pub-id><pub-id pub-id-type="pmid">1278272</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>TG</given-names></name></person-group><year iso-8601-date="1914">1914</year><article-title>On the nature of the fundamental activity of the nervous centres; together with an analysis of the conditioning of rhythmic activity in progression, and a theory of the evolution of function in the nervous system</article-title><source>The Journal of Physiology</source><volume>48</volume><fpage>18</fpage><lpage>46</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1914.sp001646</pub-id><pub-id pub-id-type="pmid">16993247</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burak</surname><given-names>Y</given-names></name><name><surname>Fiete</surname><given-names>IR</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Accurate path integration in continuous attractor network models of grid cells</article-title><source>PLoS Computational Biology</source><volume>5</volume><elocation-id>e1000291</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000291</pub-id><pub-id pub-id-type="pmid">19229307</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Churchland</surname><given-names>MM</given-names></name><name><surname>Santhanam</surname><given-names>G</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Preparatory activity in premotor and motor cortex reflects the speed of the upcoming reach</article-title><source>Journal of Neurophysiology</source><volume>96</volume><fpage>3130</fpage><lpage>3146</lpage><pub-id pub-id-type="doi">10.1152/jn.00307.2006</pub-id><pub-id pub-id-type="pmid">16855111</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Curti</surname><given-names>E</given-names></name><name><surname>Mongillo</surname><given-names>G</given-names></name><name><surname>La Camera</surname><given-names>G</given-names></name><name><surname>Amit</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Mean field and capacity in realistic networks of spiking neurons storing sparsely coded random memories</article-title><source>Neural Computation</source><volume>16</volume><fpage>2597</fpage><lpage>2637</lpage><pub-id pub-id-type="doi">10.1162/0899766042321805</pub-id><pub-id pub-id-type="pmid">15516275</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>DePasquale</surname><given-names>B</given-names></name><name><surname>Cueva</surname><given-names>C</given-names></name><name><surname>Memmesheimer L</surname><given-names>R</given-names></name><name><surname>Escola</surname><given-names>GS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Full-rank regularized learning in recurrently connected firing rate networks</article-title><conf-name><italic>Cosyne Abstracts</italic></conf-name><publisher-loc>Salt Lake City, United States</publisher-loc></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Desmurget</surname><given-names>M</given-names></name><name><surname>Turner</surname><given-names>RS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Motor sequences and the basal ganglia: kinematics, not habits</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>7685</fpage><lpage>7690</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0163-10.2010</pub-id><pub-id pub-id-type="pmid">20519543</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Dhawale</surname><given-names>AK</given-names></name><name><surname>Poddar</surname><given-names>R</given-names></name><name><surname>Kopelowitz</surname><given-names>E</given-names></name><name><surname>Normand</surname><given-names>V</given-names></name><name><surname>Wolff</surname><given-names>S</given-names></name><name><surname>Olveczky</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Automated long-term recording and analysis of neural activity in behaving animals</article-title><source>biorxiv</source><ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2015/11/30/033266">033266</ext-link></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dolan</surname><given-names>RJ</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Goals and habits in the brain</article-title><source>Neuron</source><volume>80</volume><fpage>312</fpage><lpage>325</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.09.007</pub-id><pub-id pub-id-type="pmid">24139036</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dudman</surname><given-names>JT</given-names></name><name><surname>Krakauer</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The basal ganglia: from motor commands to the control of vigor</article-title><source>Current Opinion in Neurobiology</source><volume>37</volume><fpage>158</fpage><lpage>166</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.02.005</pub-id><pub-id pub-id-type="pmid">27012960</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eichenbaum</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Time cells in the Hippocampus: a new dimension for mapping memories</article-title><source>Nature Reviews Neuroscience</source><volume>15</volume><fpage>732</fpage><lpage>744</lpage><pub-id pub-id-type="doi">10.1038/nrn3827</pub-id><pub-id pub-id-type="pmid">25269553</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Escola</surname><given-names>S</given-names></name><name><surname>Eisele</surname><given-names>M</given-names></name><name><surname>Miller</surname><given-names>K</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Maximally reliable Markov chains under energy constraints</article-title><source>Neural Computation</source><volume>21</volume><fpage>1863</fpage><lpage>1912</lpage><pub-id pub-id-type="doi">10.1162/neco.2009.08-08-843</pub-id><pub-id pub-id-type="pmid">19292647</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evarts</surname><given-names>EV</given-names></name></person-group><year iso-8601-date="1968">1968</year><article-title>Relation of pyramidal tract activity to force exerted during voluntary movement</article-title><source>Journal of Neurophysiology</source><volume>31</volume><fpage>14</fpage><lpage>27</lpage><pub-id pub-id-type="pmid">4966614</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fee</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Oculomotor learning revisited: a model of reinforcement learning in the basal ganglia incorporating an efference copy of motor actions</article-title><source>Frontiers in Neural Circuits</source><volume>6</volume><elocation-id>38</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2012.00038</pub-id><pub-id pub-id-type="pmid">22754501</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fiete</surname><given-names>IR</given-names></name><name><surname>Senn</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>CZ</given-names></name><name><surname>Hahnloser</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Spike-time-dependent plasticity and heterosynaptic competition organize networks to produce long scale-free sequences of neural activity</article-title><source>Neuron</source><volume>65</volume><fpage>563</fpage><lpage>576</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.02.003</pub-id><pub-id pub-id-type="pmid">20188660</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fritsch</surname><given-names>G</given-names></name><name><surname>Hitzig</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1870">1870</year><chapter-title>Ueber die elektrishe erregarkeit des grosshims</chapter-title><source>The Cerebral Cortex</source><volume>Vol. 101</volume><publisher-loc>Springfield</publisher-loc><publisher-name>Thomas</publisher-name><fpage>73</fpage><lpage>96</lpage></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fukai</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Sequence generation in arbitrary temporal patterns from theta-nested gamma oscillations: a model of the basal ganglia-thalamo-cortical loops</article-title><source>Neural Networks</source><volume>12</volume><fpage>975</fpage><lpage>987</lpage><pub-id pub-id-type="doi">10.1016/S0893-6080(99)00057-X</pub-id><pub-id pub-id-type="pmid">12662640</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Georgopoulos</surname><given-names>AP</given-names></name><name><surname>Kalaska</surname><given-names>JF</given-names></name><name><surname>Caminiti</surname><given-names>R</given-names></name><name><surname>Massey</surname><given-names>JT</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>On the relations between the direction of two-dimensional arm movements and cell discharge in primate motor cortex</article-title><source>Journal of Neuroscience</source><volume>2</volume><fpage>1527</fpage><lpage>1537</lpage><pub-id pub-id-type="pmid">7143039</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Georgopoulos</surname><given-names>AP</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name><name><surname>Kettner</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Neuronal population coding of movement direction</article-title><source>Science</source><volume>233</volume><fpage>1416</fpage><lpage>1419</lpage><pub-id pub-id-type="doi">10.1126/science.3749885</pub-id><pub-id pub-id-type="pmid">3749885</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerfen</surname><given-names>CR</given-names></name><name><surname>Surmeier</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Modulation of striatal projection systems by dopamine</article-title><source>Annual Review of Neuroscience</source><volume>34</volume><elocation-id>441</elocation-id><lpage>466</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-061010-113641</pub-id><pub-id pub-id-type="pmid">21469956</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gerstner</surname><given-names>W</given-names></name><name><surname>Kistler</surname><given-names>WM</given-names></name><name><surname>Naud</surname><given-names>R</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><source>Neuronal Dynamics: From Single Neurons to Networks and Models of Cognition</source><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9781107447615</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gibbon</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Scalar expectancy theory and Weber's law in animal timing</article-title><source>Psychological Review</source><volume>84</volume><elocation-id>279</elocation-id><lpage>325</lpage><pub-id pub-id-type="doi">10.1037/0033-295X.84.3.279</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldman</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Memory without feedback in a neural network</article-title><source>Neuron</source><volume>61</volume><fpage>621</fpage><lpage>634</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.12.012</pub-id><pub-id pub-id-type="pmid">19249281</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodbody</surname><given-names>SJ</given-names></name><name><surname>Wolpert</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Temporal and amplitude generalization in motor learning</article-title><source>Journal of Neurophysiology</source><volume>79</volume><fpage>1825</fpage><lpage>1838</lpage><pub-id pub-id-type="pmid">9535951</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Goudar</surname><given-names>V</given-names></name><name><surname>Buonomano</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Encoding sensory and motor patterns as time-invariant trajectories in recurrent neural networks</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1701.00838">1701.00838</ext-link></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gouvêa</surname><given-names>TS</given-names></name><name><surname>Monteiro</surname><given-names>T</given-names></name><name><surname>Motiwala</surname><given-names>A</given-names></name><name><surname>Soares</surname><given-names>S</given-names></name><name><surname>Machens</surname><given-names>C</given-names></name><name><surname>Paton</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Striatal dynamics explain duration judgments</article-title><source>eLife</source><volume>4</volume><elocation-id>e11386</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.11386</pub-id><pub-id pub-id-type="pmid">26641377</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graybiel</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The basal ganglia: learning new tricks and loving it</article-title><source>Current Opinion in Neurobiology</source><volume>15</volume><fpage>638</fpage><lpage>644</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2005.10.006</pub-id><pub-id pub-id-type="pmid">16271465</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graybiel</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Habits, rituals, and the evaluative brain</article-title><source>Annual Review of Neuroscience</source><volume>31</volume><fpage>359</fpage><lpage>387</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.29.051605.112851</pub-id><pub-id pub-id-type="pmid">18558860</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grillner</surname><given-names>S</given-names></name><name><surname>Robertson</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The basal ganglia downstream control of brainstem motor centres--an evolutionarily conserved strategy</article-title><source>Current Opinion in Neurobiology</source><volume>33</volume><fpage>47</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2015.01.019</pub-id><pub-id pub-id-type="pmid">25682058</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hahnloser</surname><given-names>RH</given-names></name><name><surname>Kozhevnikov</surname><given-names>AA</given-names></name><name><surname>Fee</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>An ultra-sparse code underlies the generation of neural sequences in a songbird</article-title><source>Nature</source><volume>419</volume><fpage>65</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1038/nature00974</pub-id><pub-id pub-id-type="pmid">12214232</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrison</surname><given-names>TC</given-names></name><name><surname>Ayling</surname><given-names>OG</given-names></name><name><surname>Murphy</surname><given-names>TH</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Distinct cortical circuit mechanisms for complex forelimb movement and motor map topography</article-title><source>Neuron</source><volume>74</volume><fpage>397</fpage><lpage>409</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.02.028</pub-id><pub-id pub-id-type="pmid">22542191</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harvey</surname><given-names>CD</given-names></name><name><surname>Coen</surname><given-names>P</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Choice-specific sequences in parietal cortex during a virtual-navigation decision task</article-title><source>Nature</source><volume>484</volume><fpage>62</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1038/nature10918</pub-id><pub-id pub-id-type="pmid">22419153</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hélie</surname><given-names>S</given-names></name><name><surname>Ell</surname><given-names>SW</given-names></name><name><surname>Ashby</surname><given-names>FG</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Learning robust cortico-cortical associations with the basal ganglia: an integrative review</article-title><source>Cortex</source><volume>64</volume><fpage>123</fpage><lpage>135</lpage><pub-id pub-id-type="doi">10.1016/j.cortex.2014.10.011</pub-id><pub-id pub-id-type="pmid">25461713</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaeger</surname><given-names>D</given-names></name><name><surname>Kita</surname><given-names>H</given-names></name><name><surname>Wilson</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Surround inhibition among projection neurons is weak or nonexistent in the rat neostriatum</article-title><source>Journal of Neurophysiology</source><volume>72</volume><fpage>2555</fpage><lpage>2558</lpage><pub-id pub-id-type="pmid">7884483</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jahanshahi</surname><given-names>M</given-names></name><name><surname>Obeso</surname><given-names>I</given-names></name><name><surname>Rothwell</surname><given-names>JC</given-names></name><name><surname>Obeso</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A fronto-striato-subthalamic-pallidal network for goal-directed and habitual inhibition</article-title><source>Nature Reviews Neuroscience</source><volume>16</volume><fpage>719</fpage><lpage>732</lpage><pub-id pub-id-type="doi">10.1038/nrn4038</pub-id><pub-id pub-id-type="pmid">26530468</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>DZ</given-names></name><name><surname>Fujii</surname><given-names>N</given-names></name><name><surname>Graybiel</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Neural representation of time in cortico-basal ganglia circuits</article-title><source>PNAS</source><volume>106</volume><fpage>19156</fpage><lpage>19161</lpage><pub-id pub-id-type="doi">10.1073/pnas.0909881106</pub-id><pub-id pub-id-type="pmid">19850874</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>X</given-names></name><name><surname>Costa</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Start/stop signals emerge in nigrostriatal circuits during sequence learning</article-title><source>Nature</source><volume>466</volume><fpage>457</fpage><lpage>462</lpage><pub-id pub-id-type="doi">10.1038/nature09263</pub-id><pub-id pub-id-type="pmid">20651684</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>X</given-names></name><name><surname>Costa</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Shaping action sequences in basal ganglia circuits</article-title><source>Current Opinion in Neurobiology</source><volume>33</volume><fpage>188</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2015.06.011</pub-id><pub-id pub-id-type="pmid">26189204</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joiner</surname><given-names>WM</given-names></name><name><surname>Ajayi</surname><given-names>O</given-names></name><name><surname>Sing</surname><given-names>GC</given-names></name><name><surname>Smith</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Linear hypergeneralization of learned dynamics across movement speeds reveals anisotropic, gain-encoding primitives for motor adaptation</article-title><source>Journal of Neurophysiology</source><volume>105</volume><fpage>45</fpage><lpage>59</lpage><pub-id pub-id-type="doi">10.1152/jn.00884.2009</pub-id><pub-id pub-id-type="pmid">20881197</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kakei</surname><given-names>S</given-names></name><name><surname>Hoffman</surname><given-names>DS</given-names></name><name><surname>Strick</surname><given-names>PL</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Muscle and movement representations in the primary motor cortex</article-title><source>Science</source><volume>285</volume><fpage>2136</fpage><lpage>2139</lpage><pub-id pub-id-type="doi">10.1126/science.285.5436.2136</pub-id><pub-id pub-id-type="pmid">10497133</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kao</surname><given-names>MH</given-names></name><name><surname>Doupe</surname><given-names>AJ</given-names></name><name><surname>Brainard</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Contributions of an avian basal ganglia-forebrain circuit to real-time modulation of song</article-title><source>Nature</source><volume>433</volume><fpage>638</fpage><lpage>643</lpage><pub-id pub-id-type="doi">10.1038/nature03127</pub-id><pub-id pub-id-type="pmid">15703748</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawai</surname><given-names>R</given-names></name><name><surname>Markman</surname><given-names>T</given-names></name><name><surname>Poddar</surname><given-names>R</given-names></name><name><surname>Ko</surname><given-names>R</given-names></name><name><surname>Fantana</surname><given-names>AL</given-names></name><name><surname>Dhawale</surname><given-names>AK</given-names></name><name><surname>Kampff</surname><given-names>AR</given-names></name><name><surname>Ölveczky</surname><given-names>BP</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Motor cortex is required for learning but not for executing a motor skill</article-title><source>Neuron</source><volume>86</volume><fpage>800</fpage><lpage>812</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.03.024</pub-id><pub-id pub-id-type="pmid">25892304</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Killeen</surname><given-names>PR</given-names></name><name><surname>Fetterman</surname><given-names>JG</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>A behavioral theory of timing</article-title><source>Psychological Review</source><volume>95</volume><elocation-id>274</elocation-id><lpage>295</lpage><pub-id pub-id-type="doi">10.1037/0033-295X.95.2.274</pub-id><pub-id pub-id-type="pmid">3375401</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kleim</surname><given-names>JA</given-names></name><name><surname>Barbay</surname><given-names>S</given-names></name><name><surname>Nudo</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Functional reorganization of the rat motor cortex following motor skill learning</article-title><source>Journal of Neurophysiology</source><volume>80</volume><fpage>3321</fpage><lpage>3325</lpage><pub-id pub-id-type="pmid">9862925</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kozhevnikov</surname><given-names>AA</given-names></name><name><surname>Fee</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Singing-related activity of identified HVC neurons in the zebra finch</article-title><source>Journal of Neurophysiology</source><volume>97</volume><fpage>4271</fpage><lpage>4283</lpage><pub-id pub-id-type="doi">10.1152/jn.00952.2006</pub-id><pub-id pub-id-type="pmid">17182906</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laje</surname><given-names>R</given-names></name><name><surname>Buonomano</surname><given-names>DV</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Robust timing and motor patterns by taming Chaos in recurrent neural networks</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>925</fpage><lpage>933</lpage><pub-id pub-id-type="doi">10.1038/nn.3405</pub-id><pub-id pub-id-type="pmid">23708144</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>DG</given-names></name><name><surname>Kuypers</surname><given-names>HG</given-names></name></person-group><year iso-8601-date="1968">1968</year><article-title>The functional organization of the motor system in the monkey. I. the effects of bilateral pyramidal lesions</article-title><source>Brain : A Journal of Neurology</source><volume>91</volume><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1093/brain/91.1.1</pub-id><pub-id pub-id-type="pmid">4966862</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Litwin-Kumar</surname><given-names>A</given-names></name><name><surname>Doiron</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Formation and maintenance of neuronal assemblies through synaptic plasticity</article-title><source>Nature Communications</source><volume>5</volume><elocation-id>5319</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms6319</pub-id><pub-id pub-id-type="pmid">25395015</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luczak</surname><given-names>A</given-names></name><name><surname>Barthó</surname><given-names>P</given-names></name><name><surname>Marguet</surname><given-names>SL</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Sequential structure of neocortical spontaneous activity in vivo</article-title><source>PNAS</source><volume>104</volume><fpage>347</fpage><lpage>352</lpage><pub-id pub-id-type="doi">10.1073/pnas.0605643104</pub-id><pub-id pub-id-type="pmid">17185420</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacDonald</surname><given-names>CJ</given-names></name><name><surname>Carrow</surname><given-names>S</given-names></name><name><surname>Place</surname><given-names>R</given-names></name><name><surname>Eichenbaum</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Distinct hippocampal time cell sequences represent odor memories in immobilized rats</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>14607</fpage><lpage>14616</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1537-13.2013</pub-id><pub-id pub-id-type="pmid">24005311</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maia</surname><given-names>TV</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>From reinforcement learning models to psychiatric and neurological disorders</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>154</fpage><lpage>162</lpage><pub-id pub-id-type="doi">10.1038/nn.2723</pub-id><pub-id pub-id-type="pmid">21270784</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Bucher</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Central pattern generators and the control of rhythmic movements</article-title><source>Current Biology</source><volume>11</volume><fpage>R986</fpage><lpage>R996</lpage><pub-id pub-id-type="doi">10.1016/S0960-9822(01)00581-4</pub-id><pub-id pub-id-type="pmid">11728329</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Martens</surname><given-names>J</given-names></name><name><surname>Sutskever</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2011">2011</year><chapter-title>Learning recurrent neural networks with hessian-free optimization</chapter-title><source>Proceedings of the 28th International Conference on Machine Learning (ICML-11)</source><fpage>1033</fpage><lpage>1040</lpage></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meck</surname><given-names>WH</given-names></name><name><surname>Penney</surname><given-names>TB</given-names></name><name><surname>Pouthas</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Cortico-striatal representation of time in animals and humans</article-title><source>Current Opinion in Neurobiology</source><volume>18</volume><fpage>145</fpage><lpage>152</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2008.08.002</pub-id><pub-id pub-id-type="pmid">18708142</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mello</surname><given-names>GB</given-names></name><name><surname>Soares</surname><given-names>S</given-names></name><name><surname>Paton</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A scalable population code for time in the striatum</article-title><source>Current Biology</source><volume>25</volume><fpage>1113</fpage><lpage>1122</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2015.02.036</pub-id><pub-id pub-id-type="pmid">25913405</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>P</given-names></name><name><surname>Wang</surname><given-names>XJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Stability of discrete memory states to stochastic fluctuations in neuronal systems</article-title><source>Chaos: An Interdisciplinary Journal of Nonlinear Science</source><volume>16</volume><elocation-id>026109</elocation-id><pub-id pub-id-type="doi">10.1063/1.2208923</pub-id><pub-id pub-id-type="pmid">16822041</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miyachi</surname><given-names>S</given-names></name><name><surname>Hikosaka</surname><given-names>O</given-names></name><name><surname>Miyashita</surname><given-names>K</given-names></name><name><surname>Kárádi</surname><given-names>Z</given-names></name><name><surname>Rand</surname><given-names>MK</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Differential roles of monkey striatum in learning of sequential hand movement</article-title><source>Experimental Brain Research</source><volume>115</volume><fpage>1</fpage><lpage>5</lpage><pub-id pub-id-type="doi">10.1007/PL00005669</pub-id><pub-id pub-id-type="pmid">9224828</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moran</surname><given-names>DW</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Motor cortical representation of speed and direction during reaching</article-title><source>Journal of Neurophysiology</source><volume>82</volume><fpage>2676</fpage><lpage>2692</lpage><pub-id pub-id-type="pmid">10561437</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nádasdy</surname><given-names>Z</given-names></name><name><surname>Hirase</surname><given-names>H</given-names></name><name><surname>Czurkó</surname><given-names>A</given-names></name><name><surname>Csicsvari</surname><given-names>J</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Replay and time compression of recurring spike sequences in the Hippocampus</article-title><source>Journal of Neuroscience</source><volume>19</volume><fpage>9497</fpage><lpage>9507</lpage><pub-id pub-id-type="pmid">10531452</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otchy</surname><given-names>TM</given-names></name><name><surname>Wolff</surname><given-names>SB</given-names></name><name><surname>Rhee</surname><given-names>JY</given-names></name><name><surname>Pehlevan</surname><given-names>C</given-names></name><name><surname>Kawai</surname><given-names>R</given-names></name><name><surname>Kempf</surname><given-names>A</given-names></name><name><surname>Gobes</surname><given-names>SM</given-names></name><name><surname>Ölveczky</surname><given-names>BP</given-names></name><name><surname>Kempf</surname><given-names>SMG</given-names></name><name><surname>P</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Acute off-target effects of neural circuit manipulations</article-title><source>Nature</source><volume>528</volume><fpage>358</fpage><lpage>363</lpage><pub-id pub-id-type="doi">10.1038/nature16442</pub-id><pub-id pub-id-type="pmid">26649821</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parent</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Extrinsic connections of the basal ganglia</article-title><source>Trends in Neurosciences</source><volume>13</volume><fpage>254</fpage><lpage>258</lpage><pub-id pub-id-type="doi">10.1016/0166-2236(90)90105-J</pub-id><pub-id pub-id-type="pmid">1695399</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Passingham</surname><given-names>RE</given-names></name><name><surname>Perry</surname><given-names>VH</given-names></name><name><surname>Wilkinson</surname><given-names>F</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>The long-term effects of removal of sensorimotor cortex in infant and adult rhesus monkeys</article-title><source>Brain</source><volume>106 (Pt 3)</volume><fpage>675</fpage><lpage>705</lpage><pub-id pub-id-type="doi">10.1093/brain/106.3.675</pub-id><pub-id pub-id-type="pmid">6640276</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pastalkova</surname><given-names>E</given-names></name><name><surname>Itskov</surname><given-names>V</given-names></name><name><surname>Amarasingham</surname><given-names>A</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name><name><surname>György</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Internally generated cell assembly sequences in the rat Hippocampus</article-title><source>Science</source><volume>321</volume><fpage>1322</fpage><lpage>1327</lpage><pub-id pub-id-type="doi">10.1126/science.1159775</pub-id><pub-id pub-id-type="pmid">18772431</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Pehlevan</surname><given-names>C</given-names></name><name><surname>Ali</surname><given-names>F</given-names></name><name><surname>Olveczky</surname><given-names>BP</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Flexibility in motor timing constrains the topology and dynamics of pattern generator circuits</article-title><source>biorxiv</source><ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2015/12/02/033472">033472</ext-link></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peters</surname><given-names>AJ</given-names></name><name><surname>Chen</surname><given-names>SX</given-names></name><name><surname>Komiyama</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Emergence of reproducible spatiotemporal activity during motor learning</article-title><source>Nature</source><volume>510</volume><fpage>263</fpage><lpage>267</lpage><pub-id pub-id-type="doi">10.1038/nature13235</pub-id><pub-id pub-id-type="pmid">24805237</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ponzi</surname><given-names>A</given-names></name><name><surname>Wickens</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Sequentially switching cell assemblies in random inhibitory networks of spiking neurons in the striatum</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>5894</fpage><lpage>5911</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5540-09.2010</pub-id><pub-id pub-id-type="pmid">20427650</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ponzi</surname><given-names>A</given-names></name><name><surname>Wickens</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Optimal balance of the striatal medium spiny neuron network</article-title><source>PLoS Computational Biology</source><volume>9</volume><elocation-id>e1002954</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002954</pub-id><pub-id pub-id-type="pmid">23592954</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rajan</surname><given-names>K</given-names></name><name><surname>Harvey</surname><given-names>CD</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Recurrent network models of sequence generation and memory</article-title><source>Neuron</source><volume>90</volume><fpage>128</fpage><lpage>142</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.02.009</pub-id><pub-id pub-id-type="pmid">26971945</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ravid Tannenbaum</surname><given-names>N</given-names></name><name><surname>Burak</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Shaping neural circuits by high order synaptic interactions</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1005056</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005056</pub-id><pub-id pub-id-type="pmid">27517461</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>JN</given-names></name><name><surname>Hyland</surname><given-names>BI</given-names></name><name><surname>Wickens</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>A cellular mechanism of reward-related learning</article-title><source>Nature</source><volume>413</volume><fpage>67</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1038/35092560</pub-id><pub-id pub-id-type="pmid">11544526</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rokni</surname><given-names>U</given-names></name><name><surname>Sompolinsky</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>How the brain generates movement</article-title><source>Neural Computation</source><volume>24</volume><fpage>289</fpage><lpage>331</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00223</pub-id><pub-id pub-id-type="pmid">22023199</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rueda-Orozco</surname><given-names>PE</given-names></name><name><surname>Mendoza</surname><given-names>E</given-names></name><name><surname>Hernandez</surname><given-names>R</given-names></name><name><surname>Aceves</surname><given-names>JJ</given-names></name><name><surname>Ibanez-Sandoval</surname><given-names>O</given-names></name><name><surname>Galarraga</surname><given-names>E</given-names></name><name><surname>Bargas</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Diversity in long-term synaptic plasticity at inhibitory synapses of striatal spiny neurons</article-title><source>Learning &amp; Memory</source><volume>16</volume><fpage>474</fpage><lpage>478</lpage><pub-id pub-id-type="doi">10.1101/lm.1439909</pub-id><pub-id pub-id-type="pmid">19633136</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rueda-Orozco</surname><given-names>PE</given-names></name><name><surname>Robbe</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The striatum multiplexes contextual and kinematic information to constrain motor habits execution</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>453</fpage><lpage>460</lpage><pub-id pub-id-type="doi">10.1038/nn.3924</pub-id><pub-id pub-id-type="pmid">25622144</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schroll</surname><given-names>H</given-names></name><name><surname>Hamker</surname><given-names>FH</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Computational models of basal-ganglia pathway functions: focus on functional neuroanatomy</article-title><source>Frontiers in Systems Neuroscience</source><volume>7</volume><elocation-id>122</elocation-id><pub-id pub-id-type="doi">10.3389/fnsys.2013.00122</pub-id><pub-id pub-id-type="pmid">24416002</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seely</surname><given-names>J</given-names></name><name><surname>Chow</surname><given-names>CC</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Role of mutual inhibition in binocular rivalry</article-title><source>Journal of Neurophysiology</source><volume>106</volume><fpage>2136</fpage><lpage>2150</lpage><pub-id pub-id-type="doi">10.1152/jn.00228.2011</pub-id><pub-id pub-id-type="pmid">21775721</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shmuelof</surname><given-names>L</given-names></name><name><surname>Krakauer</surname><given-names>JW</given-names></name><name><surname>Mazzoni</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>How is a motor skill learned? Change and invariance at the levels of task success and trajectory control</article-title><source>Journal of Neurophysiology</source><volume>108</volume><fpage>578</fpage><lpage>594</lpage><pub-id pub-id-type="doi">10.1152/jn.00856.2011</pub-id><pub-id pub-id-type="pmid">22514286</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skinner</surname><given-names>FK</given-names></name><name><surname>Kopell</surname><given-names>N</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Mechanisms for oscillation and frequency control in reciprocally inhibitory model neural networks</article-title><source>Journal of Computational Neuroscience</source><volume>1</volume><fpage>69</fpage><lpage>87</lpage><pub-id pub-id-type="doi">10.1007/BF00962719</pub-id><pub-id pub-id-type="pmid">8792226</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soares</surname><given-names>S</given-names></name><name><surname>Atallah</surname><given-names>BV</given-names></name><name><surname>Paton</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Midbrain dopamine neurons control judgment of time</article-title><source>Science</source><volume>354</volume><fpage>1273</fpage><lpage>1277</lpage><pub-id pub-id-type="doi">10.1126/science.aah5234</pub-id><pub-id pub-id-type="pmid">27940870</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sorenson</surname><given-names>CA</given-names></name><name><surname>Ellison</surname><given-names>GD</given-names></name></person-group><year iso-8601-date="1970">1970</year><article-title>Striatal organization of feeding behavior in the decorticate rat</article-title><source>Experimental Neurology</source><volume>29</volume><fpage>162</fpage><lpage>174</lpage><pub-id pub-id-type="doi">10.1016/0014-4886(70)90047-6</pub-id><pub-id pub-id-type="pmid">5478361</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sussillo</surname><given-names>D</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Generating coherent patterns of activity from chaotic neural networks</article-title><source>Neuron</source><volume>63</volume><fpage>544</fpage><lpage>557</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.07.018</pub-id><pub-id pub-id-type="pmid">19709635</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tecuapetla</surname><given-names>F</given-names></name><name><surname>Carrillo-Reid</surname><given-names>L</given-names></name><name><surname>Bargas</surname><given-names>J</given-names></name><name><surname>Galarraga</surname><given-names>E</given-names></name><name><surname>Elvira</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Dopaminergic modulation of short-term synaptic plasticity at striatal inhibitory synapses</article-title><source>PNAS</source><volume>104</volume><fpage>10258</fpage><lpage>10263</lpage><pub-id pub-id-type="doi">10.1073/pnas.0703813104</pub-id><pub-id pub-id-type="pmid">17545307</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tecuapetla</surname><given-names>F</given-names></name><name><surname>Matias</surname><given-names>S</given-names></name><name><surname>Dugue</surname><given-names>GP</given-names></name><name><surname>Mainen</surname><given-names>ZF</given-names></name><name><surname>Costa</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Balanced activity in basal ganglia projection pathways is critical for contraversive movements</article-title><source>Nature Communications</source><volume>5</volume><elocation-id>4315</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms5315</pub-id><pub-id pub-id-type="pmid">25002180</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tepper</surname><given-names>JM</given-names></name><name><surname>Koós</surname><given-names>T</given-names></name><name><surname>Wilson</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>GABAergic microcircuits in the neostriatum</article-title><source>Trends in Neurosciences</source><volume>27</volume><fpage>662</fpage><lpage>669</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2004.08.007</pub-id><pub-id pub-id-type="pmid">15474166</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tristan</surname><given-names>I</given-names></name><name><surname>Rulkov</surname><given-names>NF</given-names></name><name><surname>Huerta</surname><given-names>R</given-names></name><name><surname>Rabinovich</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Timing control by redundant inhibitory neuronal circuits</article-title><source>Chaos: An Interdisciplinary Journal of Nonlinear Science</source><volume>24</volume><elocation-id>013124</elocation-id><pub-id pub-id-type="doi">10.1063/1.4866580</pub-id><pub-id pub-id-type="pmid">24697386</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tully</surname><given-names>PJ</given-names></name><name><surname>Lindén</surname><given-names>H</given-names></name><name><surname>Hennig</surname><given-names>MH</given-names></name><name><surname>Lansner</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Spike-Based Bayesian-Hebbian Learning of temporal sequences</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1004954</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004954</pub-id><pub-id pub-id-type="pmid">27213810</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Veliz-Cuba</surname><given-names>A</given-names></name><name><surname>Shouval</surname><given-names>HZ</given-names></name><name><surname>Josić</surname><given-names>K</given-names></name><name><surname>Kilpatrick</surname><given-names>ZP</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Networks that learn the precise timing of event sequences</article-title><source>Journal of Computational Neuroscience</source><volume>39</volume><fpage>235</fpage><lpage>254</lpage><pub-id pub-id-type="doi">10.1007/s10827-015-0574-4</pub-id><pub-id pub-id-type="pmid">26334992</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vogels</surname><given-names>TP</given-names></name><name><surname>Froemke</surname><given-names>RC</given-names></name><name><surname>Doyon</surname><given-names>N</given-names></name><name><surname>Gilson</surname><given-names>M</given-names></name><name><surname>Haas</surname><given-names>JS</given-names></name><name><surname>Liu</surname><given-names>R</given-names></name><name><surname>Maffei</surname><given-names>A</given-names></name><name><surname>Miller</surname><given-names>P</given-names></name><name><surname>Wierenga</surname><given-names>CJ</given-names></name><name><surname>Woodin</surname><given-names>MA</given-names></name><name><surname>Zenke</surname><given-names>F</given-names></name><name><surname>Sprekeler</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Inhibitory synaptic plasticity: spike timing-dependence and putative network function</article-title><source>Frontiers in Neural Circuits</source><volume>7</volume><elocation-id>119</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2013.00119</pub-id><pub-id pub-id-type="pmid">23882186</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X-J</given-names></name><name><surname>Rinzel</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Alternating and synchronous rhythms in reciprocally inhibitory Model Neurons</article-title><source>Neural Computation</source><volume>4</volume><fpage>84</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1162/neco.1992.4.1.84</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whishaw</surname><given-names>IQ</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Loss of the innate cortical engram for action patterns used in skilled reaching and the development of behavioral compensation following motor cortex lesions in the rat</article-title><source>Neuropharmacology</source><volume>39</volume><fpage>788</fpage><lpage>805</lpage><pub-id pub-id-type="doi">10.1016/S0028-3908(99)00259-2</pub-id><pub-id pub-id-type="pmid">10699445</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wickens</surname><given-names>JR</given-names></name><name><surname>Alexander</surname><given-names>ME</given-names></name><name><surname>Miller</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Two dynamic modes of striatal function under dopaminergic-cholinergic control: simulation and analysis of a model</article-title><source>Synapse</source><volume>8</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1002/syn.890080102</pub-id><pub-id pub-id-type="pmid">1871678</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>The generation of natural firing patterns in neostriatal neurons</article-title><source>Progress in Brain Research</source><volume>99</volume><fpage>277</fpage><lpage>297</lpage><pub-id pub-id-type="doi">10.1016/S0079-6123(08)61352-7</pub-id><pub-id pub-id-type="pmid">8108553</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wise</surname><given-names>SP</given-names></name><name><surname>Donoghue</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="1986">1986</year><chapter-title>Motor cortex of rodents</chapter-title><source>Sensory-Motor Areas and Aspects of Cortical Connectivity</source><fpage>243</fpage><lpage>270</lpage><pub-id pub-id-type="doi">10.1007/978-1-4613-2149-1_7</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yin</surname><given-names>HH</given-names></name><name><surname>Knowlton</surname><given-names>BJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The role of the basal ganglia in habit formation</article-title><source>Nature Reviews Neuroscience</source><volume>7</volume><fpage>464</fpage><lpage>476</lpage><pub-id pub-id-type="doi">10.1038/nrn1919</pub-id><pub-id pub-id-type="pmid">16715055</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yin</surname><given-names>HH</given-names></name><name><surname>Mulcare</surname><given-names>SP</given-names></name><name><surname>Hilário</surname><given-names>MR</given-names></name><name><surname>Clouse</surname><given-names>E</given-names></name><name><surname>Holloway</surname><given-names>T</given-names></name><name><surname>Davis</surname><given-names>MI</given-names></name><name><surname>Hansson</surname><given-names>AC</given-names></name><name><surname>Lovinger</surname><given-names>DM</given-names></name><name><surname>Costa</surname><given-names>RM</given-names></name><name><surname>Emily</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Dynamic reorganization of striatal circuits during the acquisition and consolidation of a skill</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>333</fpage><lpage>341</lpage><pub-id pub-id-type="doi">10.1038/nn.2261</pub-id><pub-id pub-id-type="pmid">19198605</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yttri</surname><given-names>EA</given-names></name><name><surname>Dudman</surname><given-names>JT</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Opponent and bidirectional control of movement velocity in the basal ganglia</article-title><source>Nature</source><volume>533</volume><fpage>402</fpage><lpage>406</lpage><pub-id pub-id-type="doi">10.1038/nature17639</pub-id><pub-id pub-id-type="pmid">27135927</pub-id></element-citation></ref></ref-list><app-group><app id="app1"><title>Appendix 1</title><boxed-text><sec id="s11" sec-type="appendix"><title>Dynamics of model with synaptic depression</title><p>Intuition for the behavior of the model defined by (1) can be obtained by studying the case in which there are only two units, with activities <inline-formula><mml:math id="inf143"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf144"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, identical constant inputs <inline-formula><mml:math id="inf145"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mn>1</mml:mn><mml:mi>in</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mn>2</mml:mn><mml:mi>in</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, and symmetric inhibitory connectivity <inline-formula><mml:math id="inf146"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. The behavior of this model is illustrated in <xref ref-type="fig" rid="fig7">Appendix 1—figure 1</xref>. This model can be understood by considering the fixed-point solutions for given fixed values of the synaptic depression variables <inline-formula><mml:math id="inf147"><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>. In this case one can plot curves along which the time derivatives <inline-formula><mml:math id="inf148"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf149"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> vanish, as shown in <xref ref-type="fig" rid="fig7">Appendix 1—figure 1</xref>. The intersection of these curves describes a stable fixed point, which may occur at either <inline-formula><mml:math id="inf150"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf151"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, depending on which of <inline-formula><mml:math id="inf152"><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> or <inline-formula><mml:math id="inf153"><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> is larger. With this picture in mind we can now consider the effects of dynamical <inline-formula><mml:math id="inf154"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Suppose that at a given moment <inline-formula><mml:math id="inf155"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and hence <inline-formula><mml:math id="inf156"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. According to the second equation in (1), <inline-formula><mml:math id="inf157"><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> will begin increasing toward one due to the inactivation of <inline-formula><mml:math id="inf158"><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, while <inline-formula><mml:math id="inf159"><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> will begin decreasing toward <inline-formula><mml:math id="inf160"><mml:mi>β</mml:mi></mml:math></inline-formula> due to the activation of <inline-formula><mml:math id="inf161"><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>. As this happens, the net input to the second unit becomes positive, and the stable fixed point switches to <inline-formula><mml:math id="inf162"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> when <inline-formula><mml:math id="inf163"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> (assuming <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>β</mml:mi><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), and the synaptic depression variables begin adjusting to this new activity. The result will thus be repetitive switching between the two units being active, with the period of this switching determined by <inline-formula><mml:math id="inf165"><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf166"><mml:mi>β</mml:mi></mml:math></inline-formula>, and (importantly) <inline-formula><mml:math id="inf167"><mml:msub><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msub></mml:math></inline-formula>. Versions of this two-unit model for switching, often termed a ‘half-center oscillator,’ have been previously studied in the context of binocular rivalry (<xref ref-type="bibr" rid="bib81">Seely and Chow, 2011</xref>) and have long been used as a ‘central pattern generator’ in models of rhythmic behaviors (<xref ref-type="bibr" rid="bib8">Brown, 1914</xref>; <xref ref-type="bibr" rid="bib94">Wang and Rinzel, 1992</xref>; <xref ref-type="bibr" rid="bib83">Skinner et al., 1994</xref>; <xref ref-type="bibr" rid="bib58">Marder and Bucher, 2001</xref>).</p><p>The above analysis holds exactly in the limit <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>τ</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf169"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and in this limit it is straightforward to solve for the time that it takes for the activity to switch from one unit to the next:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf170"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:msqrt><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the largest value that <inline-formula><mml:math id="inf171"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> attains in each cycle and satisfies <inline-formula><mml:math id="inf172"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. In a network with a large number of units, <inline-formula><mml:math id="inf173"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> since each unit has sufficient time to recover fully while other units in the network are active, and in this case (7) leads to the equation appearing in <xref ref-type="fig" rid="fig1">Figure 1d</xref> in the main text. <xref ref-type="disp-formula" rid="equ7">Equation (7)</xref> shows that the switching period <inline-formula><mml:math id="inf174"><mml:mi>T</mml:mi></mml:math></inline-formula> diverges logarithmically as <inline-formula><mml:math id="inf175"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> from above, and can be made arbitrarily small as <inline-formula><mml:math id="inf176"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> from below. Thus, in addition to allowing for neural activity to switch between populations, the competition between external input and synaptic depression also provides a mechanism for complete control of the speed of the network dynamics.<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.26084.008</object-id><label>Appendix 1—figure 1.</label><caption><title>A simple circuit with two units exhibits activity switching.</title><p>(<bold>a</bold>) A simple two-unit network with activities <inline-formula><mml:math id="inf177"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf178"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, symmetric inhibitory connectivity, and constant input <inline-formula><mml:math id="inf179"><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup></mml:math></inline-formula>. (<bold>b</bold>) Curves along which, for given fixed values of <inline-formula><mml:math id="inf180"><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, the time derivatives <inline-formula><mml:math id="inf181"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, with the intersection of these curves describing a stable fixed point. Depending on the relative values of <inline-formula><mml:math id="inf182"><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf183"><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, the fixed point occurs at either <inline-formula><mml:math id="inf184"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (top) or <inline-formula><mml:math id="inf185"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (bottom). (<bold>c</bold>) When <inline-formula><mml:math id="inf186"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are included as dynamical variables, the synaptic depression leads to periodic switching between the two stable solutions.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26084.008">http://dx.doi.org/10.7554/eLife.26084.008</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-26084-app1-fig1-v2"/></fig></p><p>Although we control temporal scaling throughout this paper by adjusting the external input level <inline-formula><mml:math id="inf187"><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup></mml:math></inline-formula>, we note that essentially equivalent effects can be obtained within our model by instead adjusting the synaptic depression parameter <inline-formula><mml:math id="inf188"><mml:mi>β</mml:mi></mml:math></inline-formula> rather than the external input <inline-formula><mml:math id="inf189"><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup></mml:math></inline-formula>. While this might seem like an intrinsic neuron property that would be difficult to control externally, there is evidence from in vitro experiments that the degree of synaptic depression in MSNs in striatum is dependent upon the level of dopamine input to the neuron (<xref ref-type="bibr" rid="bib87">Tecuapetla et al., 2007</xref>). What’s more, changing dopamine levels in this circuit has been shown to reliably speed up or slow down an animal’s time judgement (<xref ref-type="bibr" rid="bib84">Soares et al., 2016</xref>), as one would expect from our model if the level of dopamine does in fact affect synaptic depression.</p><p>A possible objection to the above analysis is that <inline-formula><mml:math id="inf190"><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup></mml:math></inline-formula> cannot be tuned arbitrarily close to <inline-formula><mml:math id="inf191"><mml:mi>β</mml:mi></mml:math></inline-formula> in the presence of noise, thus limiting the dynamical range of scaling parameters that can be obtained. In order to take this into account, we suppose that <inline-formula><mml:math id="inf192"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>in</mml:mi></mml:msup><mml:mo>≡</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> can only be tuned reliably to within precision <inline-formula><mml:math id="inf193"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>. In this case, the maximum possible switching period that can be reliably obtained will no longer grow to infinity as <inline-formula><mml:math id="inf194"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>in</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula>, but rather will attain only a finite value as <inline-formula><mml:math id="inf195"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>in</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Similarly, the minimum attainable switching period cannot be arbitrarily small, but instead will reach a minimum value when <inline-formula><mml:math id="inf196"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>in</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Using (7), and taking <inline-formula><mml:math id="inf197"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the dynamical range of temporal scaling is therefore given by<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><xref ref-type="fig" rid="fig1">Figure 1c</xref> shows that a large dynamical range can be obtained as a function of the noise parameter <inline-formula><mml:math id="inf198"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> even for biologically plausible noise values of <inline-formula><mml:math id="inf199"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>≳</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>. Thus, an inhibitory network with synaptic depression and appropriately chosen synaptic weights is capable of performing an activity sequence over a wide dynamical range, even without requiring a biologically unrealistic degree of precision in the input to the network. Finally, we note that similar results to those shown in this section and in the main text can be obtained instead in a model which features depressive adaptation current rather than depressive synapses.<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>τ</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where the depressive adaptation current <inline-formula><mml:math id="inf200"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, a low-pass filtered version of the activity <inline-formula><mml:math id="inf201"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, increases monotonically after unit <inline-formula><mml:math id="inf202"><mml:mi>i</mml:mi></mml:math></inline-formula> becomes active, and <inline-formula><mml:math id="inf203"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is a constant describing the magnitude of the adaptation current. In this model, an active unit will tend to lower its own activity level over time due to the dynamical adaptation current <inline-formula><mml:math id="inf204"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. If this depression is sufficiently strong, then the unit may become inactive after some time, at which point another unit in the network will become active. As in the synaptic depression model studied in the main text, the switch time for successively active units can be dynamically adjusted by varying the level of external input <inline-formula><mml:math id="inf205"><mml:msup><mml:mi>x</mml:mi><mml:mi>in</mml:mi></mml:msup></mml:math></inline-formula>. Although this adaptation current model exhibits dynamics extremely similar to those of the synaptic depression model, we focus on the latter due to the fact that depressing synapses have been shown to be realized by neurons in the striatum (<xref ref-type="bibr" rid="bib87">Tecuapetla et al., 2007</xref>).</p></sec></boxed-text></app><app id="app2"><title>Appendix 2</title><boxed-text><sec id="s12" sec-type="appendix"><title>Time-interval scaling task in a trained random recurrent network</title><p>Traditionally, the motor cortex is viewed as the primary driver of voluntary motor output (<xref ref-type="bibr" rid="bib22">Fritsch and Hitzig, 1870</xref>; <xref ref-type="bibr" rid="bib19">Evarts, 1968</xref>; <xref ref-type="bibr" rid="bib25">Georgopoulos et al., 1986</xref>; <xref ref-type="bibr" rid="bib64">Moran and Schwartz, 1999</xref>; <xref ref-type="bibr" rid="bib46">Kakei et al., 1999</xref>; <xref ref-type="bibr" rid="bib10">Churchland et al., 2006</xref>; <xref ref-type="bibr" rid="bib37">Harrison et al., 2012</xref>). Thus, as a point of comparison, we built a firing rate model of motor cortex with linear readout units representing striatal MSNs as schematized in <xref ref-type="fig" rid="fig8">Appendix 2—figure 1a</xref>. The cortical units in the model receive two inputs: one cueing the start of each trial and another cueing the target timing for the striatal pulse sequence on that trial. Of note, in contrast to the model presented in the main text, in this model striatum does not have any recurrent structure. The equations governing the model are as follows:<disp-formula id="equ10"><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>τ</mml:mi><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mrow><mml:mtext>cu</mml:mtext></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext mathvariant="bold">c</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>tanh</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext mathvariant="bold">s</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mrow><mml:mtext>sc</mml:mtext></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.26084.009</object-id><label>Appendix 2—figure 1.</label><caption><title>A trained recurrent network exhibits sequences that are less robust and less able to generalize.</title><p>(<bold>a</bold>) Schematic of the model. The cortical units receive trial-specific inputs and project to striatum. Striatal units are not recurrently connected. The corticocortical and corticostriatal weights <inline-formula><mml:math id="inf206"><mml:msup><mml:mi>W</mml:mi><mml:mtext>cc</mml:mtext></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf207"><mml:msup><mml:mi>W</mml:mi><mml:mtext>sc</mml:mtext></mml:msup></mml:math></inline-formula> are set as per the text. (<bold>b</bold>) Model simulation. <italic>Upper</italic>: Inputs to model. Red trace marks initiation of trials; blue trace indicates the target time for the trial. <italic>Middle</italic>: Sample cortical units. <italic>Lower</italic>: Striatal units. (<bold>c</bold>) Means and standard deviations of best-match times as a function of target times with random weight perturbations of 2 or 5%. Open symbols denote target times for which the nRMSE exceeded 0.3 on greater than 25% of trials. (<bold>d</bold>) Best-match times for a model trained on time intervals ranging from 0.4 s to 1.2 s, and then tested from 0.1 s to 1.5 s. The colors indicate the means of the nRMSEs of the trials at each target time.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.26084.009">http://dx.doi.org/10.7554/eLife.26084.009</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-26084-app2-fig1-v2"/></fig></p><p>where <inline-formula><mml:math id="inf208"><mml:mi>τ</mml:mi></mml:math></inline-formula> is the neuronal time constant, <inline-formula><mml:math id="inf209"><mml:mrow><mml:mi/><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the input at time <inline-formula><mml:math id="inf210"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf211"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext mathvariant="bold">c</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf212"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext mathvariant="bold">s</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are the firing rates of the cortical and striatal units respectively, and <inline-formula><mml:math id="inf213"><mml:msup><mml:mi>W</mml:mi><mml:mtext>cu</mml:mtext></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf214"><mml:msup><mml:mi>W</mml:mi><mml:mtext>cc</mml:mtext></mml:msup></mml:math></inline-formula>, and <inline-formula><mml:math id="inf215"><mml:msup><mml:mi>W</mml:mi><mml:mtext>sc</mml:mtext></mml:msup></mml:math></inline-formula> are the input weights, recurrent corticocortical weights, and output corticostriatal weights respectively. We use a modified version of the FORCE algorithm (<xref ref-type="bibr" rid="bib86">Sussillo and Abbott, 2009</xref>; <xref ref-type="bibr" rid="bib12">DePasquale et al., 2016</xref>) to train <inline-formula><mml:math id="inf216"><mml:msup><mml:mi>W</mml:mi><mml:mtext>cc</mml:mtext></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf217"><mml:msup><mml:mi>W</mml:mi><mml:mtext>sc</mml:mtext></mml:msup></mml:math></inline-formula> such that the duration of the pulse sequence of the striatal units matches the target time on each trial. <xref ref-type="fig" rid="fig8">Appendix 2—figure 1b</xref> shows the activity of the model after training, on two trials with different target durations.</p><p>Compared with the model presented in the main text, we find that our cortically driven model is (i) less robust to perturbations in the weights, and (ii) unable to extrapolate to perform the same sequence more quickly or slowly than it has learned in training. We measure the performance of the model in two ways. First, for each trial, we consider as templates all time-scalings of the pulse sequence in the range used to train the model (i.e., activity patterns such as those in the bottom panel of <xref ref-type="fig" rid="fig8">Appendix 2—figure 1b</xref>) and find the template with the best match to the produced striatal activity for that trial. The quality of the match is measured by the normalized root mean squared error: <inline-formula><mml:math id="inf218"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf219"><mml:mrow><mml:msub><mml:mi/><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf220"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi/><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the produced striatal activity and the template pulse sequence respectively. The best-match time is considered to be the response time of the model. Second, the value of the nRMSE indicates whether the response on that trial looked anything like a ‘correct’ striatal pulse sequence. By visual inspection, we set an nRMSE of 0.3 as the threshold above which a trial is not considered to be a meaningful pulse sequence.</p><p>In <xref ref-type="fig" rid="fig8">Appendix 2—figure 1c</xref> we show the mean and standard deviation of the best-match times for several target times after the addition of corticocortical synaptic weight noise. Notably, at 5% noise, the mean best-match times deviate far from the target times (compare to <xref ref-type="fig" rid="fig4">Figure 4f</xref>) and greater than 25% of the trials at every target time have nRMSEs exceeding 0.3.</p><p>We show the extrapolation performance of the model in <xref ref-type="fig" rid="fig8">Appendix 2—figure 1d</xref>. For target times shorter than the minimum target time used during training, the striatal responses deviate to longer times and the quality of the responses (as measured by the nRMSE) degrade. For target times longer than the maximum used during training, the responses quickly become meaningless with values of the nRMSE of about 1.</p></sec></boxed-text></app></app-group></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.26084.010</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Frank</surname><given-names>Michael J</given-names></name><role>Reviewing editor</role><aff><institution>Brown University</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Learning multiple variable-speed sequences in striatum via cortical tutoring&quot; for consideration by <italic>eLife</italic>. Your article has been favorably evaluated by Richard Ivry (Senior Editor) and two reviewers, one of whom, Michael Frank, is a member of our Board of Reviewing Editors. The following individual involved in review of your submission has agreed to reveal their identity: Mark D Humphries (Reviewer #1).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>The authors propose a model for how the striatum can generate sequences of neuron activity, of variable duration, from non-sequential input, and how they can emerge from tutoring from cortex, and can progress at varying speeds. Their mechanism rests on some form of adaptation – here picked to be synaptic depression at MSN-MSN synapses, given this has existing experimental evidence. With adaptation as the mechanism, dilation of temporal sequences can occur solely through changing the level of input drive. Learning such sequences is proposed to occur via anti-Hebbian plasticity at MSN-MSN synapses. Finally, the authors show that their results generalise to a sparse, spiking network model. Thus, the model makes sense of biophysical data (synaptic depression), shows how it can explain experimental data on population dynamics, and makes clear, testable experimental predictions.</p><p>Essential revisions:</p><p>Both reviewers were quite enthusiastic about your contribution, but just wanted to see you address the following points.</p><p>1) We would like to know a bit more about the dependencies of the model's behaviour on its parameters, particularly for learning. These can take the form of further text, or small simulations – we will defer to your preference here. Specifically, the tutoring (<xref ref-type="fig" rid="fig4">Figure 4</xref>) requires that the input sequence is periodically repeated; presumably the time-scale of the <italic>period</italic> of the sequence has to be &gt;&gt; <italic>τ<sub>y</sub></italic>? What is the lower-limit here? In other words, how does the time-scale of interaction between neurons set by <italic>τ<sub>y</sub></italic> dictate the fastest period of the tutoring sequence? Presumably this is also a function of <italic>x</italic><sup>in</sup>, just as for the switch time in the constant input case to the static network (<xref ref-type="fig" rid="fig1">Figure 1D</xref>).</p><p>2) Currently learning in the model is mediated by anti-Hebbian plasticity. The authors state in the Discussion that it still seems to be an open question as to whether this form of plasticity is appropriate for MSNs. Are there other learning rules that might also work for the model? Have the authors tried other learning rules? It might be nice to see more work or at least a discussion of potential alternative learning rules should the prediction of anti-Hebbian plasticity prove to be not well supported experimentally. This is not a criticism but rather something that is likely of interest to readers.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.26084.011</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Essential revisions:</italic></p><p><italic>Both reviewers were quite enthusiastic about your contribution, but just wanted to see you address the following points.</italic></p><p><italic>1) We would like to know a bit more about the dependencies of the model's behaviour on its parameters, particularly for learning. These can take the form of further text, or small simulations – we will defer to your preference here. Specifically, the tutoring (<xref ref-type="fig" rid="fig4">Figure 4</xref>) requires that the input sequence is periodically repeated; presumably the time-scale of the period of the sequence has to be &gt;&gt; τ<sub>y</sub>? What is the lower-limit here? In other words, how does the time-scale of interaction between neurons set by τ<sub>y</sub> dictate the fastest period of the tutoring sequence? Presumably this is also a function of x<sup>in</sup>, just as for the switch time in the constant input case to the static network (<xref ref-type="fig" rid="fig1">Figure 1D</xref>).</italic></p><p>The reviewers are certainly correct that there is a limit to how fast the tutoring input can become before learning can no longer take place. This can be understood most easily for regular, pulsatile inputs as in <xref ref-type="fig" rid="fig4">Figure 4A</xref>, where the relevant parameter is T_in/<italic>τ<sub>y</sub></italic>, where T_in is the duration of each input pulse (making NT_in the total period of the input). In the figure we have taken T_in/<italic>τ<sub>y</sub></italic> = 1.25, so that each unit is active for a time ~<italic>τ<sub>y</sub></italic> during training. If the speed of the input is increased so that T_in&lt;&lt;<italic>τ<sub>y</sub></italic>, then sequence learning can still take place, but some of the units will be skipped, e.g. with only every other unit in the sequence becoming active. In practice, we find that this happens around T_in ~ τ<sub>y</sub>/2, though the precise value depends on other parameters such as the input amplitude. In order to make this point clear, we have added the following note to the text in the manuscript where <xref ref-type="fig" rid="fig4">Figure 4</xref> is discussed: “We note that sequence learning can occur for a range of input sequence speeds, but that some units in the sequence will be skipped if the input varies on time scales &lt;&lt; <italic>τ<sub>y</sub></italic>.”</p><p>Regarding the other parameters in the model, our general approach has been to develop the simplest possible model that exhibits the effects we are interested while still following known biological constraints. The advantage of this approach is that much of the circuit’s behavior can be understood directly from analyzing the equations describing it, thus eliminating the need to test the effects of varying the circuit’s parameters in simulations. In general, we have endeavored to use what we judged to be reasonable values, to include some discussion about which values are permissible and why, and to check that the system’s qualitative behavior doesn’t depend on fine tuning. Below we summarize the most important of these choices, point out where we have already discussed them in the manuscript, and in some cases point out the modifications we have made to the text in order to further clarify the roles of these parameters:</p><p><italic>τ<sub>y</sub>/τ</italic>: The ratio of the synaptic depression time constant to the membrane potential time constant must satisfy <italic>τ<sub>y</sub>/τ</italic> &gt;&gt; 1, and we have added a mention of this requirement below Equation (Abeles, 1991) in the main text. As we make clear from the theoretical arguments in Appendix A, the particular value of the ratio has very little effect on the dynamics of the model as long as this condition is satisfied. Because the membrane time constant of actual neurons is typically ~10ms while characteristic time scales for synaptic adaptation are &gt;100ms, we are confident that the assumption used in our model is reasonable.</p><p>β: The allowable range of the synaptic depression parameter is 0 &lt; β &lt; 1. Smaller values of β are slightly preferable to larger ones since they increase the dynamic range of allowable inputs (see <xref ref-type="fig" rid="fig1">Figure 1D</xref>). As we have shown in the simplified model in Appendix A, however, the value of β does not have a very significant effect on the network dynamics, hence we have fixed it to the experimentally plausible value of β=0.2 (see Tecuapetla et al., 2007) and have not varied it further in our simulations.</p><p><italic>α</italic><sub>1</sub>, <italic>α</italic><sub>2</sub> and <italic>τ<sub>w</sub></italic>: The time scale of the eligibility trace for learning, <italic>τ<sub>w</sub></italic>, should not exceed T, the typical time for which a unit remains active, or else there will be synaptic depotentiation not only between sequentially active units, but also between units separated by two or more steps in the sequence. The learning rates for synaptic depotentiation and potentiation, <italic>α</italic><sub>1</sub> and <italic>α</italic><sub>2</sub>, set the characteristic time scale for learning, as shown in <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Changing the magnitude of these parameters will affect the minimum number of training cycles required for the system to learn a sequence pattern, and changing the ratio between them will affect the asymptotic values of the depotentiated synaptic weights, but such changes will not otherwise change the results qualitatively in any way. We have added text to the first and second paragraphs of the section on learning that clarifies the roles of and constraints on these three learning-related parameters.</p><p><italic>2) Currently learning in the model is mediated by anti-Hebbian plasticity. The authors state in the Discussion that it still seems to be an open question as to whether this form of plasticity is appropriate for MSNs. Are there other learning rules that might also work for the model? Have the authors tried other learning rules? It might be nice to see more work or at least a discussion of potential alternative learning rules should the prediction of anti-Hebbian plasticity prove to be not well supported experimentally. This is not a criticism but rather something that is likely of interest to readers.</italic></p><p>The reviewers’ question about the anti-Hebbian learning rule in our theory is an important one. In order to obtain activity sequences in a recurrent inhibitory circuit in the manner that we describe, the following conditions should be met: (i) synapses connecting neurons within a cluster should be depotentiated, so that they are able to fire together; (ii) synapses connecting neurons in sequentially active clusters (i.e. from cluster j to cluster j+1) should be depotentiated, so that they will activate in the correct order once the structured input is taken away; (iii) all other synapses should be potentiated, so that the clusters generally mutually inhibit one another. In order for these conditions to be met, the spike-timing-dependent plasticity rule must qualitatively resemble the one shown in <xref ref-type="fig" rid="fig5">Figure 5(B</xref>).</p><p>This can be made precise by noting that, averaged over the activity history of the network, changes in synaptic weights are given by dW<sub>ij</sub> = \int F(t) C_ij(t) dt, where F(t) is the STDP curve, C_ij(t) is the time-dependent cross-correlation function of the activities of neurons i and j, and \int represents integration over time (see Tannenbaum and Burak, PLoS Comp. Bio. 2016). If the network activity is enslaved to the input during training, then C_ij(t) is effectively just the matrix of input correlations, and the three conditions above mean that F(t) should be positive at t=0 and for small positive t, and negative otherwise, as shown in <xref ref-type="fig" rid="fig5">Figure 5(B</xref>) (note that we’ve actually plotted the negative of this function).</p><p>Based on this, we conclude that an anti-Hebbian learning rule between MSNs in striatum is actually a strong requirement/prediction of our model. While the presence of such a learning rule would not unambiguously prove that recurrent connectivity in striatum plays a major role in driving sequences, the absence of such a learning rule would be very strong evidence against this hypothesis. In order to underscore this point, we have added the following text to the 7th paragraph of the Discussion section: “Because recurrently driven sequential activity of the sort that we describe requires depotentiation of inhibitory synapses between neurons both within the same cluster and from one cluster to the next sequentially active cluster, any activity-dependent learning rule must be qualitatively similar to the anti-Hebbian STDP curve shown in <xref ref-type="fig" rid="fig5">Figure 5(B</xref>). The absence of such a learning rule would render it unlikely that learned recurrent connections within striatum play a major role in shaping learned sequences of neural activity, hence making this an important test of the theory.”</p></body></sub-article></article>