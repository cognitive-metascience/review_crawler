<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">05856</article-id><article-id pub-id-type="doi">10.7554/eLife.05856</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Expression noise facilitates the evolution of gene regulation</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-23969"><name><surname>Wolf</surname><given-names>Luise</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-23970"><name><surname>Silander</surname><given-names>Olin K</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="pa2">‡</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-22473"><name><surname>van Nimwegen</surname><given-names>Erik</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor2">*</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Biozentrum</institution>, <institution>University of Basel</institution>, <addr-line><named-content content-type="city">Basel</named-content></addr-line>, <country>Switzerland</country></aff><aff id="aff2"><label>2</label><institution>Swiss Institute of Bioinformatics</institution>, <addr-line><named-content content-type="city">Basel</named-content></addr-line>, <country>Switzerland</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-9239"><name><surname>Golding</surname><given-names>Ido</given-names></name><role>Reviewing editor</role><aff><institution>Baylor College of Medicine</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><label>*</label>For correspondence: <email>olinsilander@gmail.com</email> (OKS);</corresp><corresp id="cor2"><email>erik.vannimwegen@unibas.ch</email> (EN)</corresp><fn fn-type="present-address" id="pa1"><label>†</label><p>Roche Pharma Research and Early Development, Roche Innovation Center Basel, F. Hoffmann-La Roche Ltd, Basel, Switzerland</p></fn><fn fn-type="present-address" id="pa2"><label>‡</label><p>Institute of Natural and Mathematical Sciences, Auckland Campus, Massey University, Auckland, New Zealand</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>17</day><month>06</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e05856</elocation-id><history><date date-type="received"><day>12</day><month>01</month><year>2015</year></date><date date-type="accepted"><day>14</day><month>05</month><year>2015</year></date></history><permissions><copyright-statement>© 2015, Wolf et al</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Wolf et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-05856-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.05856.001</object-id><p>Although it is often tacitly assumed that gene regulatory interactions are finely tuned, how accurate gene regulation could evolve from a state without regulation is unclear. Moreover, gene expression noise would seem to impede the evolution of accurate gene regulation, and previous investigations have provided circumstantial evidence that natural selection has acted to lower noise levels. By evolving synthetic <italic>Escherichia coli</italic> promoters de novo, we here show that, contrary to expectations, promoters exhibit low noise by default. Instead, selection must have acted to increase the noise levels of highly regulated <italic>E. coli</italic> promoters. We present a general theory of the interplay between gene expression noise and gene regulation that explains these observations. The theory shows that propagation of expression noise from regulators to their targets is not an unwanted side-effect of regulation, but rather acts as a rudimentary form of regulation that facilitates the evolution of more accurate regulation.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.001">http://dx.doi.org/10.7554/eLife.05856.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.05856.002</object-id><title>eLife digest</title><p>Genes are stretches of DNA that contain the instructions needed to make proteins and other molecules. By changing how much protein is produced from each gene (i.e., its expression), many organisms—including humans—can produce a wide variety of cell types with very different behaviors. Similarly, single-celled organisms, such as bacteria, can adapt to survive and grow in different environments by changing gene expression levels. It is thus thought that gene expression must be precisely controlled.</p><p>However, the molecular processes involved in gene expression are subject to random fluctuations, and so gene expression is inherently ‘noisy’. This means that even groups of identical cells in identical environments will show variation in their gene expression patterns. Furthermore, different genes show different levels of noise. The DNA sequence of a part of each gene, called the promoter, has a big effect on these noise levels. Consequently, gene expression noise is a genetically encoded trait, and can therefore be shaped by natural selection. But it remains largely unclear how natural selection has affected gene expression noise.</p><p>Now, Wolf et al. have carefully measured the gene expression noise of hundreds of synthetic promoters that were evolved in the laboratory from random DNA sequences, and a similar number of natural promoters in a bacterium called <italic>E. coli</italic>. These experiments revealed that, contrary to expectation, most lab-evolved promoters had low levels of noise. On the other hand, many natural promoters had high levels of noise. Wolf et al. also found that noisy promoters tend to be highly regulated by transcription factors: the proteins that control gene expression by binding to promoter regions. Together, these results imply that unregulated promoters start by having low noise as a default state. Selection pressures must then have caused some <italic>E. coli</italic> promoters to become regulated by transcription factors and raise their noise levels. But, what might these selection pressures have been?</p><p>Many genes need to be expressed at different levels in different conditions, and it is generally accepted that regulation by transcription factors evolves to ‘satisfy’ these requirements. However, transcription factors are themselves noisy, and this noise necessarily propagates to their target genes. Wolf et al. have now developed a general theory showing that this noise-propagation can often benefit an organism. This explains why natural selection can favor an increase in noise levels for regulated genes. Importantly, by showing that the main role of a transcription factor can be to increase the noise of its targets, it suddenly becomes very easy to see how new gene regulatory interactions can evolve from scratch. The next steps in understanding of how gene expression noise evolves will involve manipulating the expression noise of a gene, and measuring how selection acts on such changes.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.002">http://dx.doi.org/10.7554/eLife.05856.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author keywords</title><kwd>gene regulation</kwd><kwd>gene expression noise</kwd><kwd>evolution</kwd><kwd>synthetic biology</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>E. coli</italic></kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001711</institution-id><institution>Schweizerische Nationalfonds zur Förderung der Wissenschaftlichen Forschung</institution></institution-wrap></funding-source><award-id>PZ00P3_126617</award-id><principal-award-recipient><name><surname>Silander</surname><given-names>Olin K</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001711</institution-id><institution>Schweizerische Nationalfonds zur Förderung der Wissenschaftlichen Forschung</institution></institution-wrap></funding-source><award-id>51RT-0_145680</award-id><principal-award-recipient><name><surname>van Nimwegen</surname><given-names>Erik</given-names></name></principal-award-recipient></award-group><funding-statement>The funder had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.3</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>In-lab evolution of synthetic promoters has revealed a novel general mechanism for de novo evolution of gene regulation, and highlights the crucial role of expression noise in this process.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Many studies over the last decade have established that, even within homogeneous environments, gene expression varies across genetically identical cells due to thermodynamic fluctuations in the molecular events underlying gene expression and the small numbers of molecules involved (<xref ref-type="bibr" rid="bib13">Elowitz et al., 2002</xref>; <xref ref-type="bibr" rid="bib27">Rao et al., 2002</xref>). This phenomenon is commonly referred to as ‘expression noise’ (<xref ref-type="bibr" rid="bib8">Blake et al., 2003</xref>; <xref ref-type="bibr" rid="bib28">Raser and O'Shea, 2005</xref>). Much progress has been gained in understanding the molecular mechanisms underlying noise in gene expression, and noise in transcription in particular (see, for example, <xref ref-type="bibr" rid="bib30">Sanchez and Golding, 2013</xref>). In the simplest scenario, basic thermodynamic fluctuations and Brownian motion of the molecular players would cause transcription initiation at a given promoter to occur with a constant probability per unit time, and the corresponding mRNAs to decay with a constant probability per unit time, leading to a Poissonian steady-state distribution in the number of transcripts. Although such Poissonian fluctuations are observed for some genes, most genes exhibit much larger fluctuations in their mRNA copy number. It is generally believed that such increased variability originates in promoters stochastically switching between different states that are associated with different transcription initiation rates. In the simplest scenario, promoters stochastically switch between an ‘on’ and ‘off’ state, producing ‘bursts’ of transcript while in the on state, and this would lead to increased noise as has been well understood theoretically (<xref ref-type="bibr" rid="bib18">Kepler and Elston, 2001</xref>; <xref ref-type="bibr" rid="bib25">Paulsson, 2005</xref>; <xref ref-type="bibr" rid="bib31">Shahrezaei and Swain, 2008</xref>). However, events such as the stochastic binding and unbinding of transcription factors (TFs), or modifications of the local chromatin state, would generally cause most promoters to switch between a much larger number of different states. Moreover, the extent of promoter state switching would be expected to depend on the specific promoter architecture. Indeed, several studies have shown that different promoters show different amounts of gene expression noise, and that these differences are, at least to some extent, encoded in the promoter sequence (<xref ref-type="bibr" rid="bib24">Newman et al., 2006</xref>; <xref ref-type="bibr" rid="bib16">Hornung et al., 2012</xref>; <xref ref-type="bibr" rid="bib33">Silander et al., 2012</xref>; <xref ref-type="bibr" rid="bib11">Carey et al., 2013</xref>; <xref ref-type="bibr" rid="bib17">Jones, et al., 2014</xref>).</p><p>Importantly, transcriptional noise is thus likely an evolvable trait that is subject to natural selection, but it is currently largely unclear how noise levels have been shaped by natural selection (<xref ref-type="bibr" rid="bib26">Raj and van Oudenaarden, 2008</xref>). On the one hand, it can be argued that in each condition there is an optimal expression level for each protein, such that variations away from this optimal level are detrimental to an organism's fitness, implying that selection will act to minimize noise. Indeed, by investigating the association between expression noise and various statistics that can be considered proxies of organismal fitness, several studies have provided evidence that selection generally acts to minimize noise (<xref ref-type="bibr" rid="bib24">Newman et al., 2006</xref>; <xref ref-type="bibr" rid="bib4">Barkai and Shilo, 2007</xref>; <xref ref-type="bibr" rid="bib22">Lehner, 2010</xref>; <xref ref-type="bibr" rid="bib21">Lehner, 2008</xref>; <xref ref-type="bibr" rid="bib33">Silander et al., 2012</xref>). In this interpretation, genes with lowest noise have been most strongly selected against noise, whereas high noise genes have experienced much weaker selection against noise. On the other hand, gene expression noise generates phenotypic diversity between organisms with identical genotypes, and there are well-established theoretical models showing that such phenotypic diversity can be selected for in fluctuating environments (<xref ref-type="bibr" rid="bib9">Bull, 1987</xref>; <xref ref-type="bibr" rid="bib20">Kussell and Leibler, 2005</xref>). In support of such theoretical models, a number of studies provided examples in which there is a positive association between expression noise and growth (<xref ref-type="bibr" rid="bib7">Blake et al., 2006</xref>; <xref ref-type="bibr" rid="bib6">Bishop et al., 2007</xref>; <xref ref-type="bibr" rid="bib1">Ackermann et al., 2008</xref>; <xref ref-type="bibr" rid="bib41">Zhang et al., 2009</xref>). It is thus possible that some of the genes with elevated noise may have been selected for phenotypic diversity.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>In order to assess how natural selection has acted on the transcriptional noise of promoters, it is critical to determine what default noise levels would be exhibited by promoters that have <italic>not</italic> been selected for their noise properties. To address this, we evolved a large set of synthetic <italic>Escherichia coli</italic> promoters de novo in the laboratory using an experimental protocol in which promoter sequences were selected on the basis of the mean expression level they conferred, while experiencing virtually no selection on their noise properties (<xref ref-type="fig" rid="fig1">Figure 1</xref>). We synthesized a pool of random DNA sequences, 100–150 base pairs in length, and cloned these upstream of a sequence containing a strong ribosomal binding site and the open reading frame of green fluorescent protein (GFP). Beginning with a library of more than 1 million random promoter clones, we used fluorescence activated cell sorting (FACS) to select cells expressing specific levels of GFP (<xref ref-type="fig" rid="fig1">Figure 1A–C</xref>). After sorting, we used PCR mutagenesis to input more genetic variation into the library of promoters and repeated the sorting. After the initial FACS sort, this strategy of mutagenesis followed by FACS was repeated four times. The result was a genetically diverse collection of functional promoters that conferred expression close to a pre-specified target level. We selected a subset of 479 synthetic promoters from the third and fifth rounds of FACS selection, choosing equal numbers of promoters from each of six replicate lineages we evolved (<xref ref-type="fig" rid="fig1">Figure 1</xref>; ‘Materials and methods’). We then used flow cytometry, as described previously (<xref ref-type="bibr" rid="bib33">Silander et al., 2012</xref>), to measure the distribution of fluorescence levels per cell for each synthetic promoter, as well as for all native <italic>E. coli</italic> promoters (<xref ref-type="bibr" rid="bib40">Zaslaver et al., 2006</xref>). We used quantitative Western blotting to confirm that the mean fluorescence levels were directly proportional to GFP molecule numbers (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> and <xref ref-type="app" rid="app1">Appendix 1</xref>), which allowed us to express fluorescence levels in units of numbers of GFP molecules.<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.003</object-id><label>Figure 1.</label><caption><title>Experimental evolution of functional promoters de novo.</title><p>(<bold>A</bold>) We created an initial library of approximately 10<sup>6</sup> unique synthetic promoters by cloning random nucleotide sequences, of approximately 100–150 base pairs (bp) in length, upstream of a strong ribosomal binding site followed by an open reading frame for GFP, as used to quantify the expression of native <italic>E. coli</italic> promoters (<xref ref-type="bibr" rid="bib40">Zaslaver et al., 2006</xref>), and transformed this library into a population of cells (‘Materials and methods’). We evolved populations of synthetic promoters by performing five rounds of selection and mutation on this library. In each round we used fluorescence activated cell sorting (FACS) to select 2 × 10<sup>5</sup> cells that lie within a gate comprising the 5% of the population closest in fluorescence to a given target level. Next, plasmids were isolated from the selected cells and PCR mutagenesis was used to introduce new genetic variation into the promoters. We then re-cloned the mutated promoters into fresh plasmids and transformed them into a fresh population of cells. We performed this evolutionary scheme on three replicate populations in which we selected for a target expression level equal to the median expression level (50th percentile) of all native <italic>E. coli</italic> promoters and three replicate populations in which we selected for a target expression level at the 97.5th percentile of all native promoters (referred to here as medium and high expression levels, respectively). (<bold>B</bold>) Changes in the fluorescence distribution for one evolutionary run selecting for medium target expression (top) and one evolutionary run selecting for high target expression (bottom). The curves show the population's expression distributions before selection, with the numbers above each curve indicating the selection round. The colored bars at the top indicate the FACS gates that were used to select cells from the populations at each corresponding round. (<bold>C</bold>) Examples of fluorescence distributions for individual clones obtained after five rounds of evolution. Microscopy pictures of two individual clonal promoter populations are shown as insets. (<bold>D</bold>) For each native <italic>E. coli</italic> promoter (blue) and synthetic promoter (red), the mean (x-axis) and variance (y-axis) of log-fluorescence intensities across cells were measured using flow cytometry. Fluorescence values are expressed in units of number of GFP molecules. The green curve shows the theoretically predicted minimal variance as a function of mean expression (<xref ref-type="app" rid="app1">Appendix 1</xref>). The insets show the log-fluorescence distributions for two example promoters (corresponding to the larger dark blue and light blue dots). (<bold>E</bold>) Cumulative distributions of excess noise levels of native (blue) and synthetic (red) promoters.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.003">http://dx.doi.org/10.7554/eLife.05856.003</ext-link></p></caption><graphic xlink:href="elife-05856-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.05856.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Genetic diversity of 378 sequenced promoters, which were extracted from randomly selected clones from the populations that were obtained after three and five rounds of selection.</title><p>Sequences were clustered using single-linkage based on 100%, 95%, or 90% sequence identity (left, middle, and right panels) and the bar plots show the corresponding histograms of cluster sizes. The results indicate that the promoters in the populations at the third and fifth rounds are highly diverse, deriving from many different initial random sequences in the initial library.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.004">http://dx.doi.org/10.7554/eLife.05856.004</ext-link></p></caption><graphic xlink:href="elife-05856-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.05856.005</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Mean log-fluorescence intensities as measured by FACS (horizontal axis) against estimated log GFP molecules per cell (vertical axis) as estimated from quantitative Westerns (see <xref ref-type="app" rid="app1">Appendix 1</xref>) for eight selected promoters.</title><p>Error bars were estimated from three replicates for the FACS measurements and six replicates for the GFP levels. The straight line shows the fit <italic>y</italic> = <italic>x</italic> + 1.06, which is equivalent to: GFP molecules per cell = 2.88* mean FACS intensity.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.005">http://dx.doi.org/10.7554/eLife.05856.005</ext-link></p></caption><graphic xlink:href="elife-05856-fig1-figsupp2-v1.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.05856.006</object-id><label>Figure 1—figure supplement 3.</label><caption><title>Relationship between log-protein levels as measured by GFP intensity in FACS (vertical axis) and log-mRNA levels (horizontal axis).</title><p>The mRNA levels are estimated relative to the mRNA level of reference gene IhfB. Error bars show ±1 standard deviation of the posterior probability distribution on mRNA levels (<xref ref-type="app" rid="app1">Appendix 1</xref>). Black data points correspond to native promoters and red data points to synthetic promoter. The straight line shows a linear fit with slope 1, that is, the best fit to a model where the protein level <italic>p</italic> is directly proportional to the mRNA level <italic>m</italic>, log(<italic>p</italic>) = <italic>c</italic> + log(<italic>m</italic>), with <italic>c</italic> = 7.06 (<xref ref-type="app" rid="app1">Appendix 1</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.006">http://dx.doi.org/10.7554/eLife.05856.006</ext-link></p></caption><graphic xlink:href="elife-05856-fig1-figsupp3-v1.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.05856.007</object-id><label>Figure 1—figure supplement 4.</label><caption><title>Comparison of three biological replicate FACS measurements of means and excess noise of log-fluorescence for evolved <italic>E. coli</italic> promoters.</title><p>The top three panels compare mean log-fluorescences across three replicates and the bottom three panels compare excess noise in log-fluorescences across three replicates. The Pearson squared correlation coefficients between pairs of replicate measurements are indicated at the top of each panel.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.007">http://dx.doi.org/10.7554/eLife.05856.007</ext-link></p></caption><graphic xlink:href="elife-05856-fig1-figsupp4-v1.tif"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.05856.008</object-id><label>Figure 1—figure supplement 5.</label><caption><title>Relative noise levels (variance of the log-expression distribution) of five pairs of native promoters that have very similar mean expression levels.</title><p>Each dot corresponds to one of the pairs of promoters and shows the ratio of the noise level of the highest noise promoter to that of the lower noise promoter as measured by FACS (horizontal axis) and by microscope (vertical axis). The blue line shows the line <italic>y</italic> = <italic>x</italic>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.008">http://dx.doi.org/10.7554/eLife.05856.008</ext-link></p></caption><graphic xlink:href="elife-05856-fig1-figsupp5-v1.tif"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.05856.009</object-id><label>Figure 1—figure supplement 6.</label><caption><title>Mean log-fluorescence (horizontal axis) and excess noise levels (vertical axis), that is, the difference between variance of log-fluorescence levels and the minimal variance at the corresponding mean, for all native (blue dots) and synthetic (red dots) promoters.</title><p>Both axes are in units of number of GFP molecules. Note that, in contrast to raw variances in log-fluorescence that show a clear dependence on mean log-fluorescence, the excess noise levels show no dependence on mean.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.009">http://dx.doi.org/10.7554/eLife.05856.009</ext-link></p></caption><graphic xlink:href="elife-05856-fig1-figsupp6-v1.tif"/></fig><fig id="fig1s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.05856.010</object-id><label>Figure 1—figure supplement 7.</label><caption><title>Cumulative distributions of excess noise levels for the native (blue) and synthetic promoters (red).</title><p>The left panel shows the cumulative distribution of excess noise for promoters whose mean log-expression was less than log(18,000) (corresponding to the medium expressing synthetic promoters), and the right panel for promoters with mean log-expression more than log(18,000) (corresponding to the high expressing synthetic promoters). High noise promoters are clearly enriched among native promoters for both medium and high expressing promoters.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.010">http://dx.doi.org/10.7554/eLife.05856.010</ext-link></p></caption><graphic xlink:href="elife-05856-fig1-figsupp7-v1.tif"/></fig></fig-group></p><p>Observing that the fluorescence distributions across cells were well approximated by log-normal distributions (<xref ref-type="fig" rid="fig1">Figure 1C</xref>), we characterized each promoter's distribution by the mean and variance of log-fluorescence, defining the latter as the promoter's noise level (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). This definition of noise is equivalent to the square of the coefficient of variation whenever fluctuations are small relative to the mean (<xref ref-type="app" rid="app1">Appendix 1</xref>), which applies to most promoters, that is, the variance is less than 0.25 for 75% of all promoters (<xref ref-type="fig" rid="fig1">Figure 1D</xref>).</p><p>Although our reporter constructs measure protein levels, that is, GFP, the differences in the noise levels of the reporters are likely dominated by differences in transcriptional noise of the promoters. First, the only differences between the different constructs are the promoter sequence inserts. Consequently, the mRNAs of the different reporters are almost identical, varying only by the short sequence segment between the transcription start site and the constant part of the construct. Second, the reporters were constructed specifically to measure transcription, and feature a constant 5′ UTR part upstream of the start codon of the GFP gene, including a strong ribosomal binding site (<xref ref-type="bibr" rid="bib40">Zaslaver et al., 2006</xref>). Using qPCR we confirmed that protein levels were determined primarily by mRNA levels (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref> and <xref ref-type="app" rid="app1">Appendix 1</xref>). Because protein decay and dilution rates are identical for all reporters, this implies translation rates vary little across the reporters. Although we have not explicitly measured mRNA decay rates of the reporters, we presume that, because the mRNAs are nearly identical, and because translation rates vary little across the reporters, mRNA decay rates likely vary also only moderately across the reporters. Finally, we note that noise levels were reproducible across biological replicates (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>), and noise levels estimated using microscopy were consistent with those measured by flow cytometry (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>).</p><p>Importantly, although the differences in noise levels are likely due to differences in transcriptional noise, fluctuations in translation and dilution rates will also contribute to total noise levels that we observe. Indeed, as expected (<xref ref-type="bibr" rid="bib3">Bar-Even et al., 2006</xref>; <xref ref-type="bibr" rid="bib24">Newman et al., 2006</xref>), we observed a systematic relationship between the mean and variance of expression levels of each promoter (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). In particular, we observed a strict lower bound on variance as a function of mean expression. This lower bound is well described (<xref ref-type="fig" rid="fig1">Figure 1D</xref>, green curve) by a simple model that incorporates background fluorescence, an intrinsic noise component which is proportional to the number of proteins produced per mRNA, and an extrinsic noise component which likely reflects overall fluctuations in transcription, translation, and dilution rates, that all reporters are subject to (<xref ref-type="bibr" rid="bib37">Taniguchi et al., 2010)</xref> (<xref ref-type="app" rid="app1">Appendix 1</xref>). We defined the <italic>excess noise</italic> of a promoter as its variance above and beyond this lower bound, allowing us to compare the noise levels of promoters with different means (<xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>).</p><p>We found, surprisingly, that most of the synthetic promoters exhibited noise levels close to the minimal level exhibited by the native promoters (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). Additionally, a substantial fraction of native promoters exhibited excess noise levels significantly greater than the synthetic promoters (<xref ref-type="fig" rid="fig1">Figure 1E</xref> and <xref ref-type="fig" rid="fig1s6 fig1s7">Figure 1—figure supplements 6, 7</xref>). For example, only 26.1% of the synthetic promoters exhibited excess noise above 0.05, compared to 41.6% of the native <italic>E. coli</italic> promoters (p &lt; 7.7 × 10<sup>−10</sup>, hypergeometric test). Given that the synthetic promoters were evolved from random sequence fragments and had not been selected on their noise properties (<xref ref-type="app" rid="app2">Appendix 2</xref>), we concluded that functional <italic>E. coli</italic> promoters should exhibit low excess noise levels by default. Importantly, this implies that the native promoters with elevated excess noise must have experienced selective pressures that caused them to increase their noise.</p><p>To understand how selection might have acted to increase noise, we first investigated whether excess noise was associated with other characteristics of the promoters. Previous studies in <italic>Saccharomyces cerevisiae</italic> have shown that promoters with high noise tend to also show high expression plasticity, that is, large changes in mean expression level across environments (<xref ref-type="bibr" rid="bib24">Newman et al., 2006</xref>). Although we did not clearly observe this association in data from our previous study (<xref ref-type="bibr" rid="bib33">Silander et al., 2012</xref>), a recent re-analysis of this data did uncover a significant association between expression plasticity and noise (<xref ref-type="bibr" rid="bib34">Singh, 2013</xref>), which we confirmed using our present data (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). In addition, we found that there is an equally strong relationship between excess noise and the number of regulators known to target the promoter (<xref ref-type="bibr" rid="bib29">Salgado et al., 2013</xref>) (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). In particular, whereas the excess noise levels of promoters without known regulatory inputs are very similar to those of our synthetic promoters, promoters with one or more regulatory inputs have clearly elevated noise levels (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). The general association between elevated noise and gene regulation has recently been observed in eukaryotes as well (<xref ref-type="bibr" rid="bib32">Sharon et al., 2014</xref>), and mutations that lower gene expression noise typically target TF binding sites (<xref ref-type="bibr" rid="bib16">Hornung et al., 2012</xref>).<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.011</object-id><label>Figure 2.</label><caption><title>Promoters with elevated noise exhibit high expression plasticity and large numbers of regulatory inputs.</title><p>(<bold>A</bold>) Native promoters were sorted by their excess noise <italic>x</italic> and, as a function of a cut-off on <italic>x</italic> (horizontal axis), we calculated the mean and standard error (vertical axis) of the variation in mRNA levels across different experimental conditions (data from <ext-link ext-link-type="uri" xlink:href="http://genexpdb.ou.edu/">http://genexpdb.ou.edu/</ext-link>) of all promoters with excess noise larger than <italic>x</italic>. (<bold>B</bold>) Promoters were sorted by excess noise <italic>x</italic> as in panel <bold>A</bold>, and mean and standard error of the number of known regulatory inputs (vertical axis, data from RegulonDB [<xref ref-type="bibr" rid="bib29">Salgado et al., 2013</xref>]) for promoters with excess noise larger than <italic>x</italic> is shown. (<bold>C</bold>) Cumulative distributions of excess noise levels of synthetic promoters (red) and native promoters without known regulatory inputs (black), with one known regulatory input (green), and with two or more known regulatory inputs (purple).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.011">http://dx.doi.org/10.7554/eLife.05856.011</ext-link></p></caption><graphic xlink:href="elife-05856-fig2-v1.tif"/></fig></p><p>Our results imply that native promoters with high noise must have experienced selection pressures that caused their noise levels to increase, and that there is a general association between high noise and gene regulation. We next aimed to develop a theoretical understanding of these two observations. Perhaps the simplest interpretation of the observation that natural selection must have increased the noise levels of some promoters is that these promoters were directly selected for increased noise. Several theoretical treatments have shown that phenotypic variability may be selectively beneficial when environments change in ways that cannot be accurately sensed or are too rapid for organisms to respond (<xref ref-type="bibr" rid="bib9">Bull, 1987</xref>; <xref ref-type="bibr" rid="bib15">Haccou and Iwasa, 1995</xref>; <xref ref-type="bibr" rid="bib20">Kussell and Leibler, 2005</xref>), with the phenotypic variability acting as a ‘bet hedging’ strategy. Thus, it is conceivable that selection has directly selected for increased noise as a bet hedging strategy for a subset of promoters, and more recent theoretical work shows that increasing gene expression noise may indeed increase population growth rates in some scenarios (<xref ref-type="bibr" rid="bib36">Tanase-Nicola and ten Wolde, 2008</xref>). However, this interpretation does not explain the association between noise and regulation. On the contrary, one would naively expect that bet hedging strategies function as an alternative to gene regulation, that is, when implementing sensing and regulation would be either too difficult or too costly to evolve (<xref ref-type="bibr" rid="bib20">Kussell and Leibler, 2005</xref>).</p><p>Regarding the general association between gene regulation and expression noise, using an analogy with the fluctuation-dissipation theorem from physics, it has been suggested that expression noise may be an unwanted but unavoidable side-effect of regulation (<xref ref-type="bibr" rid="bib23">Lehner and Kaneko, 2011</xref>). Indeed, any regulator will have some noise in its expression or activity, and this noise will be propagated to its target genes. Consequently, this ‘noise-propagation’ effect will cause an increase in expression noise of the targets (<xref ref-type="bibr" rid="bib38">Thattai and van Oudenaarden, 2001</xref>). Although noise-propagation is a plausible explanation for the general association between noise and regulation, its effects are detrimental to the accuracy of expression regulation, and one might thus expect natural selection to have acted to minimize its effects, for example, by minimizing the expression fluctuations in regulators. It would thus appear difficult to reconcile our observation that high noise promoters must have experienced selection to increase their noise levels with the assumption that selection has acted to minimize noise-propagation. Instead, our observations would be better explained by a scenario in which noise-propagation is positively selected for.</p><p>To clarify these observations, we developed a general theoretical model for quantifying how selection acts on gene regulatory interactions. In particular, the model calculates the effect on fitness of evolving a new regulatory interaction between a given gene and a given regulator, as a function of properties of the regulator, and the way selection acts on the gene's expression levels. As explained in ‘Materials and methods’ and <xref ref-type="app" rid="app3">Appendix 3</xref>, we derive that, under relatively mild assumptions, the fitness effects of a new regulatory interaction can be calculated analytically, and depend on only a few effective parameters. To explain this general model, we illustrate it using a simple scenario (<xref ref-type="fig" rid="fig3">Figure 3</xref>).<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.012</object-id><label>Figure 3.</label><caption><title>A model of the evolution of gene expression regulation in a variable environment.</title><p>(<bold>A</bold>) Expression distribution of an unregulated promoter (blue curve) and selected expression ranges in three different environments, that is, the red, gold, and green dashed curves show fitness as a function of expression level in these environments. Although our model applies more generally, for simplicity we here visualize selection as truncation selection (i.e., a rectangular fitness function). The fitness of the promoter in the gold environment is proportional to the shaded area. (<bold>B</bold>) Contour plot of the log-fitness change resulting from optimally coupling the promoter to a transcription factor (TF) with signal-to-noise ratio <italic>S</italic> and correlation <italic>R</italic>. Contours run from 7.5 at the top right to 0.5 at the bottom right. The three colored dots correspond to the TFs illustrated in panels <bold>C</bold>–<bold>H</bold>. The red curve shows optimal <italic>S</italic> as a function of <italic>R</italic>. (<bold>C</bold>–<bold>E</bold>) Each panel shows the expression distributions of an example TF across the three environments (red, gold, and green curves). The corresponding values of correlation <italic>R</italic> and signal-to-noise <italic>S</italic> are indicated in each panel. (<bold>F</bold>–<bold>H</bold>) Each panel shows the expression distributions across the three environments for a promoter that is optimally coupled to the TF indicated in the inset. The shaded areas correspond to the fitness in each environment. The total noise levels of the regulated promoters are also indicated in each panel. The unregulated promoter has total noise <italic>σ</italic><sub>tot</sub> = 0.1.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.012">http://dx.doi.org/10.7554/eLife.05856.012</ext-link></p></caption><graphic xlink:href="elife-05856-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.05856.013</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Phase diagram of the total noise <italic>σ</italic><sub>tot</sub> of a promoter with expression mismatch <italic>Y</italic> (horizontal axis) that is coupled (at optimal coupling strength) to a regulator whose regulatory activities have correlation <italic>R</italic> with the desired expression levels (vertical axis) and whose signal-to-noise ratio <italic>S</italic> has also been optimized.</title><p>The colors indicate the value of <italic>σ</italic><sub>tot</sub>, running from <italic>σ</italic><sub>tot</sub> equal to the noise <italic>σ</italic> of the unregulated promoter (red) to <italic>σ</italic><sub>tot</sub> = 6<italic>σ</italic> (blue). A phase boundary (thick black curve) separates solutions in a ‘basal noise regime’ at the top left, where the total noise equals the minimal noise <italic>σ</italic><sup>2</sup>, and solutions in an ‘environment-driven noise regime’ at the bottom right, where the total noise matches the variance in desired levels that is not tracked by the regulation, that is, <inline-formula><mml:math id="inf118"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>tot</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. The contours show optimal signal-to-noise ratios <italic>S</italic><sub>*</sub> as a function of <italic>Y</italic> and <italic>R</italic>. Note that <italic>S</italic><sub>*</sub> diverges at the phase boundary.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.013">http://dx.doi.org/10.7554/eLife.05856.013</ext-link></p></caption><graphic xlink:href="elife-05856-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.05856.014</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Inferred noise-propagation strengths of individual <italic>E. coli</italic> transcription factors (TFs).</title><p>For all promoters <italic>p</italic>, the excess noise level <italic>E</italic><sub><italic>p</italic></sub> was modeled as a linear function <inline-formula><mml:math id="inf119"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>r</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mtext>noise</mml:mtext></mml:mrow></mml:math></inline-formula>, where <italic>R</italic><sub><italic>pr</italic></sub> = 1 when the regulator <italic>r</italic> is known to target promoter <italic>p</italic> and <italic>R</italic><sub><italic>pr</italic></sub> = 0 otherwise (data from RegulonDB [<xref ref-type="bibr" rid="bib29">Salgado et al., 2013</xref>]), and <italic>V</italic><sub><italic>r</italic></sub> is the noise-propagation strength of regulator <italic>r</italic>. The noise-propagation strengths <italic>V</italic><sub><italic>r</italic></sub> are inferred by minimizing the squared deviation between the predicted and observed excess noise levels using a Gaussian prior and cross-validation to avoid over-fitting (<xref ref-type="bibr" rid="bib2">Balwierz et al., 2014</xref>). Each bar shows the inferred value of <italic>V</italic><sub><italic>r</italic></sub> for the TF indicated at the bottom of the bar, together with its error bar <italic>σ</italic>(<italic>V</italic><sub><italic>r</italic></sub>). All TFs are shown for which <italic>V</italic><sub><italic>r</italic></sub> &gt; <italic>σ</italic>(<italic>V</italic><sub><italic>r</italic></sub>) and are sorted from left to right by their significance <italic>V</italic><sub><italic>r</italic></sub>/<italic>σ</italic>(<italic>V</italic><sub><italic>r</italic></sub>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.014">http://dx.doi.org/10.7554/eLife.05856.014</ext-link></p></caption><graphic xlink:href="elife-05856-fig3-figsupp2-v1.tif"/></fig></fig-group></p><p>We focus on a single gene and assume that the gene starts out unregulated, with an expression distribution characterized by a certain mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup> (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, blue curve). In its natural habitat, the population experiences a number of different environments <italic>e</italic> that may require the gene to express at different levels and we assume that the fitnes of an individual cell, that is, its growth or survival rate, is a function of its gene expression state. Indeed, recent work has confirmed that expression fluctuations in single cells can affect their instantaneous growth rates (<xref ref-type="bibr" rid="bib19">Kiviet et al., 2014</xref>). In the simple scenario of <xref ref-type="fig" rid="fig3">Figure 3</xref>, we assume there is an optimal level <italic>μ</italic><sub><italic>e</italic></sub> in each environment, and that cells with expression levels within a certain range <italic>τ</italic> around this optimum are selected. As an example, <xref ref-type="fig" rid="fig3">Figure 3A</xref> assumes there are three environments (red, gold, and green), with the green environment requiring up-regulation of the expression and the red environment requiring down-regulation of the expression. The fitness in each environment corresponds to the fraction of cells with expression levels within the selected range, that is, the unregulated promoter has reasonably high fitness in the gold environment but very low fitness in the green and red environments. Since the overall fitness is the product of the fitness in each environment, a poor overlap between the expression distribution and selected range in any one environment leads to low overall fitness. In our model, the mismatch between the actual and desired expression levels is quantified by the ‘expression mismatch’ <italic>Y</italic>, where <italic>Y</italic><sup>2</sup> = var(<italic>μ</italic><sub><italic>e</italic></sub>)/(<italic>σ</italic><sup>2</sup> + <italic>τ</italic><sup>2</sup>) is the variance in the desired expression levels <italic>μ</italic><sub><italic>e</italic></sub> across environments relative to the sum of the variances of the fitness function <italic>τ</italic><sup>2</sup> and the expression distribution <italic>σ</italic><sup>2</sup> (<italic>Y</italic> ≈ 4 for the example in <xref ref-type="fig" rid="fig3">Figure 3A</xref>).</p><p>We now consider evolving a regulatory interaction between the promoter and a given regulator. We assume that, in each environment <italic>e</italic>, the regulator's expression, or more generally its activity, will have some average level <italic>r</italic><sub><italic>e</italic></sub>. Coupling the promoter to the regulator will have two effects. First, the mean expression of the gene in each environment will become correlated with the mean activity of the regulator. Our model assumes a linear interaction, that is, in each environment <italic>e</italic> the gene's mean expression becomes <italic>μ</italic>(<italic>e</italic>) = <italic>μ</italic> + <italic>cr</italic><sub><italic>e</italic></sub>, where <italic>c</italic> is the coupling constant between regulator and promoter. This is the typical way in which we think about gene regulation and we will call this effect on the gene's mean expression the ‘condition-response’ effect. Second, in each environment <italic>e</italic> the regulator's activity will also have some variance <inline-formula><mml:math id="inf1"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and this noise will be propagated to the target gene. Because of this noise-propagation effect, the target's noise level will increase by <inline-formula><mml:math id="inf2"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, becoming <inline-formula><mml:math id="inf3"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. We define the renormalized coupling constant <italic>X</italic> as the noise increase relative to the sum of the original noise levels and the variance of the fitness function, that is, <inline-formula><mml:math id="inf4"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Our analysis shows that, besides the expression mismatch <italic>Y</italic> and coupling constant <italic>X</italic>, the fitness increase that results from coupling to a given regulator depends only on two effective parameters characterizing the regulator: First, the Pearson correlation coefficient <italic>R</italic> between the desired expression levels <italic>μ</italic><sub><italic>e</italic></sub> and the regulator's average activities <italic>r</italic><sub><italic>e</italic></sub> and, second, the signal-to-noise ratio of the regulator <italic>S</italic>, with <inline-formula><mml:math id="inf5"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> defined as the ratio of the variance in the mean activities of the regulator across the environments and the noise level of the regulator in each environment. In terms of these parameters, the increase in log-fitness resulting from evolving a regulatory interaction becomes<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mi>d</mml:mi><mml:mtext> log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>X</mml:mi><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mi>Y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Notably, this equation applies independent of how the desired levels <italic>μ</italic><sub><italic>e</italic></sub> and regulator levels <italic>r</italic><sub><italic>e</italic></sub> vary across the environments and only depends on the assumption that the fitness function and expression distributions can be approximated by Gaussians.</p><p>To illustrate the predictions of this theory, the contour plot of <xref ref-type="fig" rid="fig3">Figure 3B</xref> shows the log-fitness changes that can be obtained by optimally coupling the promoter to a regulator with a given correlation <italic>R</italic> and signal-to-noise <italic>S</italic>. We chose the range in <italic>S</italic> values such that <italic>d</italic> log[<italic>f</italic>] is positive over the parameter region shown, that is, <italic>d</italic> log[<italic>f</italic>] ≈ 0 in the lower right corner of <xref ref-type="fig" rid="fig3">Figure 3B</xref>. As intuitively expected, the highest fitness is obtained when coupling to an accurate regulator with high signal-to-noise <italic>S</italic>, whose activities correlate precisely with the desired expression levels (cyan dot in <xref ref-type="fig" rid="fig3">Figure 3B</xref>). An example of such a TF is shown in <xref ref-type="fig" rid="fig3">Figure 3C</xref>. The resulting expression distributions of the promoter coupled to this TF accurately track the desired levels, with only moderately increased noise in the promoter's expression (<xref ref-type="fig" rid="fig3">Figure 3F</xref>). In this parameter regime, the improvement in fitness is entirely due to the condition-response effect, and the increased noise of the target can indeed be considered a detrimental side-effect of the regulation.</p><p>However, regulators that track the desired expression levels of the promoter with such high accuracy, that is, <italic>R</italic> = 0.95, may often not be available. Interestingly, coupling to a noisy regulator whose activity is entirely uncorrelated with the desired expression levels (blue dot in <xref ref-type="fig" rid="fig3">Figure 3B</xref> and <xref ref-type="fig" rid="fig3">Figure 3E,H</xref>) also substantially increases fitness. In this regime, the increased fitness results exclusively from the noise-propagation mechanism, and by coupling to the regulator the promoter effectively implements a bet hedging strategy.</p><p>Surprisingly, coupling to the uncorrelated noisy regulator (blue dot in <xref ref-type="fig" rid="fig3">Figure 3B</xref> and <xref ref-type="fig" rid="fig3">Figure 3E,H</xref>) outperforms coupling to a moderately correlated regulator (magenta dot in <xref ref-type="fig" rid="fig3">Figure 3B</xref> and <xref ref-type="fig" rid="fig3">Figure 3D,G</xref>). To understand how coupling to a regulator with moderate correlation <italic>R</italic> = 0.64 can be outperformed by coupling to a regulator with no correlation <italic>R</italic> = 0, we calculated the optimal signal-to-noise <italic>S</italic> as a function of its correlation <italic>R</italic> (red curve in <xref ref-type="fig" rid="fig3">Figure 3B</xref>). This shows that the magenta regulator has too large an <italic>S</italic> for its correlation, that is, increasing the noise of this TF would result in an increase of the promoter's noise, and this would in turn lead to an increase in fitness in the green and gold conditions (see <xref ref-type="fig" rid="fig3">Figure 3G</xref>). This illustrates that regulators may generally be under selection to become noisy themselves. To the left of the red curve in <xref ref-type="fig" rid="fig3">Figure 3B</xref>, noise-propagation is too large and the increased noise of the targets can be considered a detrimental side-effect of regulation. In contrast, to the right of the red curve, noise-propagation is too small, that is, increasing the noise of the regulator would improve fitness.</p><p>Most interestingly, the red curve corresponds to a continuum of regulatory strategies in which the condition-response and noise-propagation effects are optimally acting in concert, going from being dominated by noise-propagation in the lower left, to being dominated by the condition-response in the top right. Importantly, this clarifies how accurate regulation can evolve smoothly from a state without regulation. Highly accurate regulation with high <italic>R</italic> and <italic>S</italic> can be reached by starting from coupling to a noisy regulator with low <italic>R</italic> and <italic>S</italic>, whose benefits come entirely from the noise-propagation, and then increasing both <italic>R</italic> and <italic>S</italic> in incremental steps along this continuum of regulatory strategies.</p><p>We now discuss how this theoretical model helps us interpret our experimental observations. First, our model predicts that the selective pressure for a promoter to evolve regulatory interactions is determined by the expression mismatch <italic>Y</italic>. When <italic>Y</italic> &lt; 1, even a constitutively expressed promoter has a good overlap with the fitness function across all conditions, and there will be no selective pressure to evolve regulation. Our synthetic promoters, which were selected for expressing at a constant level, correspond to this situation, and our results show that such promoters have low noise by default. Thus, we interpret the observation that native promoters without known regulatory inputs have noise levels similar to those of our synthetic promoters (<xref ref-type="fig" rid="fig2">Figure 2B</xref>) as indicating that constitutive promoters have low noise by default.</p><p>In the interpretation of our model, the promoters with elevated noise were those in which selection required their expression levels to vary significantly across environments, that is, for which <italic>Y</italic> ≫ 1. How much expression noise a given promoter is likely to evolve depends on its value of its expression mismatch <italic>Y</italic>, and the values of the correlations <italic>R</italic> and signal-to-noise <italic>S</italic> of the regulators that are available in the genome. Since the precise environmental conditions that <italic>E. coli</italic> experiences in the wild, and how these determine optimal expression levels of its genes, are largely unknown, it is not possible to make quantitative predictions of the expected noise levels of specific promoters using our model. However, our model can be used to understand the general qualitative trends observed in <xref ref-type="fig" rid="fig2">Figure 2</xref>.</p><p>First, our model explains why there is a general correlation between expression noise and expression plasticity. Since regulators affect the expression of their targets in a linear manner, coupling a promoter to a combination of different regulators is equivalent to coupling the promoter to a single ‘effective regulator’ whose expression distribution is a linear combination of the expression distributions of the individual regulators. Assuming that coupling to such a linear combination of regulators can attain a correlation <italic>R</italic> with the desired expression levels of the gene, our model predicts that noise-propagation will be selected whenever <inline-formula><mml:math id="inf6"><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&gt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>; that is, whenever the expression mismatch <italic>Y</italic> is large enough, noise-propagation will be beneficial. If we additionally assume that selection has tuned the signal-to-noise of the regulators to optimize the amount of noise-propagation, then the final noise level of the promoter is predicted to equal <inline-formula><mml:math id="inf7"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>tot</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> and <xref ref-type="app" rid="app3">Appendix 3</xref>). This expression can be interpreted as saying that, of the original mismatch <italic>Y</italic><sup>2</sup>, a fraction <italic>R</italic><sup>2</sup><italic>Y</italic><sup>2</sup> is accounted for by the condition-response, whereas the remaining fraction (1 − <italic>R</italic><sup>2</sup>)<italic>Y</italic><sup>2</sup> is accounted for by the noise-propagation. This implies that both the expression plasticity, which is given by the variance in the promoter's mean across conditions (i.e., <italic>R</italic><sup>2</sup><italic>Y</italic><sup>2</sup>), and the noise level (i.e., (1 − <italic>R</italic><sup>2</sup>)<italic>Y</italic><sup>2</sup>) are proportional to the original expression mismatch <italic>Y</italic><sup>2</sup>. Our model thus predicts that the expression plasticity and noise level should be correlated.</p><p>Our model also predicts a general positive correlation between expression noise and the number of regulatory inputs. Starting from a high expression mismatch <italic>Y</italic>, each new regulatory interaction will reduce the mismatch from <italic>Y</italic> to <italic>Y</italic>′ &lt; <italic>Y</italic> by a combination of the condition-response effect reducing the average deviations from the desired levels, and the noise-propagation increasing the overlap by virtue of increasing the expression noise. Whenever <italic>Y</italic>′ is still larger than 1, the promoter will be under selective pressure to evolve further regulatory interactions. In this way, the higher the initial mismatch <italic>Y</italic>, the larger the expected number of regulatory interactions that will be necessary to reduce the mismatch below 1; that is, our model generally predicts that the number of regulatory interactions, the expression plasticity, and the final noise all correlate with the original mismatch <italic>Y</italic>.</p><p>Finally, since in our model elevated noise levels are due to noise-propagation per definition, it trivially predicts that, the larger the number of regulatory inputs, the larger the final noise levels tends to be. More specifically, our model predicts that, in a given condition, the noise level of a promoter is determined by the noise levels of the TFs that regulate it. To test this prediction, we used a very simple linear model that assumes that the excess noise level of a gene is equal to the sum of the noise levels of the TFs that regulate it (‘Materials and methods’). Although this simple model is very crude, that is, assuming noise-propagation to be of equal size for all targets of a given TF, and assuming that fluctuations in TF activities are all independent, it was nevertheless able to explain a substantial fraction of the variance in excess noise levels across promoters (17%). The top five TFs most significantly associated with elevated noise levels of their targets were CRP, H-NS, ArcA, ilvY, and GadX (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). Of these, GadX and H-NS were also identified, using a simpler method, in the data of our previous study (<xref ref-type="bibr" rid="bib33">Silander et al., 2012</xref>). The appearance of H-NS is interesting since it is a histone-like nucleoid-associated protein that acts as a silencer (<xref ref-type="bibr" rid="bib12">Dorman, 2004</xref>), that is, somewhat analogous to the role of nucleosomes in eukaryotes, and in eukaryotes nucleosome positioning at promoters has been shown to be a major determinant of transcriptional noise (<xref ref-type="bibr" rid="bib7">Blake et al., 2006</xref>; <xref ref-type="bibr" rid="bib39">Tirosh and Barkai, 2008</xref>; <xref ref-type="bibr" rid="bib10">Cairns, 2009</xref>). The TFs ArcA and GadX are involved with responses to low oxygen and acid stress, respectively, and it is plausible that these TFs may be partially activated in the conditions in which our experiments are performed. Our cells are grown in M9 minimal media with glucose in micro-titer plates, and measurements are taken late in the exponential phase. It is well-known that in micro-titer plates oxygen limitation can become a major stress late in the exponential phase, and this may result in the activation of fermentation reactions which in turn cause acid stress. The appearance of CRP is consistent with our observation in <xref ref-type="bibr" rid="bib33">Silander et al. (2012)</xref> that promoters of genes involved in carbon metabolism are over-represented among high noise promoters. In summary, modeling of excess noise levels in terms of known regulatory interactions shows that, in accordance with our model, a substantial amount of the variation in noise levels can be explained by noise-propagation from noisy regulators, and the regulators we identify as most significantly propagating noise are consistent with existing biological knowledge regarding our growth conditions.</p></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Because genotype-phenotype relationships for complex phenotypic traits are poorly understood, it is often difficult to assess how observable variation in a particular trait has been affected by natural selection. Here we have shown that, by comparing naturally observed variation in a particular trait with variation observed in synthetic systems that were evolved under well-controlled selective conditions, definite inferences can be made about the selection pressures that have acted on the natural systems. In particular, by evolving synthetic <italic>E. coli</italic> promoters de novo using a procedure in which promoters are strongly selected on their mean expression and not on their expression noise, we have shown that native promoters must have experienced selective pressures that increased their noise levels, and that promoters with elevated noise are highly regulated by TFs.</p><p>To account for this, we have developed a theoretical model that provides a simple mechanistic framework for understanding how selection acts on regulatory interactions. The key ingredient of the model is that it recognizes that a regulatory interaction affects the target's expression in two separate ways: the condition-response effect through which the mean expression of the target becomes a function of the mean activity of the regulator, and the noise-propagation effect through which the noise of the target is increased in proportion to the noise of the regulator. Our model elucidates that not only the condition-response effect but also the noise-propagation effect is often a <italic>functional</italic> consequence of the regulatory interaction; that is, instead of being just an unavoidable side-effect of regulation, noise-propagation is often beneficial and can be considered to act as a rudimentary form of regulation. Our framework vastly expands the evolutionary conditions under which novel regulatory interactions can evolve. Instead of assuming that regulators and their targets must evolve in a tightly coordinated fashion, noise-propagation alone may provide a sufficient benefit for a new regulatory interaction to evolve. This regulation can then be smoothly mutated along a continuum in which noise-propagation and condition-response are acting in concert, slowly lowering noise, and increasing the accuracy of the condition-response, eventually leading to highly accurate regulation. In this way our model provides a plausible scenario for how accurate regulatory interactions can evolve de novo from a state without regulation. Finally, our model shows that unless regulation is very precise, regulatory interactions that act to increase noise are beneficial. Thus, elevated levels of expression noise can be expected whenever the accuracy of regulation is limited.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title><italic>Ab initio</italic> promoter library construction from random sequences</title><p>We obtained chemically synthesized nucleotide sequences of random nucleotides 200 bp in length (Purimex, Germany). Each sequence had defined 5′ and 3′ ends to allow PCR amplification. Within these constant regions, restriction sites for BamHI and XhoI were present. The intervening sequence was made up of 157 bp of random nucleotides (5′-CCTTTCGTCTTCACCTCGAG-(N157)-GGGATCCTCTGGATGTAAGAAGG-3′). However, as coupling of base pairs during oligonucleotide synthesis is not always successful and strand breaks can frequently occur in long oligonucleotides, many oligonucleotides were shorter than 200 bp in length. We used PCR to generate double-stranded DNA from the single-stranded oligonucleotides using forward and reverse primers matching the defined 5′ and 3′ ends. We gel-purified the double-stranded PCR product and double-digested it using BamHI and XhoI. After column purification, sequences were ligated into a version of the low-copy plasmid pUA66, which contains a gfpmut2 open reading frame downstream of a strong ribosomal binding site (<xref ref-type="bibr" rid="bib40">Zaslaver et al., 2006</xref>). The vector was modified to remove a weak <italic>σ</italic>70 binding site present 24 bp upstream of the GFP open reading frame (two point mutations, A → G and T → G, were introduced, changing the putative <italic>σ</italic>70 binding site from TAGATT to TGGATG, with the consensus <italic>σ</italic>70 binding site being TATAAT). The ligation was performed using T4 DNA ligase (NEB) at 16°C for 24 hr. The ligation product was then column purified and electroporated into <italic>E. coli</italic> DH10B cells. This protocol resulted in extremely high transformation yields (approximately 10<sup>6</sup> individual clones per transformation).</p></sec><sec id="s4-2"><title>Selection on expression level using flow cytometry</title><p>Cultures of transformed cells were regenerated for 1 hr in 1 ml SOC medium (Super Optimal Broth supplemented with 20 mM glucose) and afterwards 1 ml SOC containing 50 μg/ml kanamycin was added for overnight growth, ensuring that only cells containing the plasmid could grow. These cultures were then diluted 500-fold (approximately 5 × 10<sup>6</sup> cells in total) into M9 minimal media supplemented with 0.2% glucose and grown for 2.5 hr with shaking at 200 rpm. The distribution of GFP fluorescence levels was measured for each culture using FACS in a FACSAria IIIu (BD Biosciences), with excitation at 488 nm and a 513/17 nm bandpass filter used for emission.</p><p>We used this distribution of fluorescence values to designate a selection gate. The position of the gate was determined by measuring the mean fluorescence of two reference promoters (<xref ref-type="bibr" rid="bib40">Zaslaver et al., 2006</xref>): <italic>gyrB</italic> which exhibits a mean expression level that is at the 50th percentile all <italic>E. coli</italic> promoters; and <italic>rpmB</italic>, which exhibits a mean expression level that is at the 97.5th percentile of all <italic>E. coli</italic> promoters (<xref ref-type="bibr" rid="bib33">Silander et al., 2012</xref>). For each of these reference genes, the mean fluorescence level was measured and a selection gate was constructed, centered on this mean expression level, such that 5% of all clones in the population fell within the gate. For each round of selection, we sorted 200,000 cells contained within this gate. Sorted cells were then transferred to 4 ml Luria Broth (LB) media (containing 50 μg/ml kanamycin) and grown overnight. These cultures were stored supplemented with 7.5% glycerol at −80°C for subsequent analysis.</p><p>For each expression level (i.e., reference gene) we evolved three replicate populations. We refer to these as the medium expressers (those promoters selected based on the <italic>gyrB</italic> reference gate) and high expressers (those promoters selected based on the <italic>rpmB</italic> reference gate).</p></sec><sec id="s4-3"><title>PCR mutagenesis</title><p>Following FACS-based selection on fluorescence, we introduced novel genetic variation into the populations using PCR mutagenesis. We first re-grew the cells overnight and used this culture to prepare plasmid DNA. We amplified the promoter sequences from these plasmids using the GeneMorph II Random Mutagenesis Kit (Stratagene) with the primers referred to previously that matched the defined regions of the promoters. We used 0.01 ng of DNA as starting material and 35 cycles for amplification. This resulted in a mutation rate of around 0.01 per bp (such that we expect that, in 200 bp, 95% of the promoters will contain between zero and four mutations). These PCR products were then digested with XhoI and BamHI, ligated back into the vector, and again transformed into DH10B cells. After an initial round of selection on the initial library, this entire process (PCR mutagenesis, transformation, and selection) was repeated four times in total. At this point, the plasmid libraries of synthetic promoters were isolated and transformed into <italic>E. coli</italic> K12 MG1655 for comparison with a library of native <italic>E. coli</italic> promoters (see below).</p></sec><sec id="s4-4"><title>Quantification of fluorescence</title><p>To quantify fluorescence on a single-cell level, we used flow cytometry with a FACSCanto II (BD Biosciences), with excitation at 488 nm and a 513/17 nm band-pass filter used for emission. We collected data for at least 50,000 events. We then gated this data as outlined in <xref ref-type="bibr" rid="bib33">Silander et al. (2012)</xref>, identifying approximately 5000 cells most similar in forward scatter (FSC) and side scatter (SSC). We then calculated the mean and variance in log-fluorescence using these cells, using a Bayesian procedure that accounts for outliers (<xref ref-type="app" rid="app1">Appendix 1</xref>). We randomly selected 479 promoters from the evolved set (72 medium expressers and 72 high expressers after three rounds of selection; 168 medium expressers and 167 high expressers after five rounds of selection) and quantified mean and variance in fluorescence. We used the same measurement procedures to calculate mean and variance for all promoters contained in a library of <italic>E. coli</italic> promoters also placed upstream of the gfpmut2 open reading frame on the pUA66 plasmid (<xref ref-type="bibr" rid="bib40">Zaslaver et al., 2006</xref>). We refer to the promoters from this library as native <italic>E. coli</italic> promoters. For 288 promoters, we quantified fluorescence in three independent cultures and found that both mean and variance in expression were reproducible across replicate biological experiments (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). Additionally, we sequenced 378 sequences from our set of 479 promoter sequences, which showed that even after five rounds of selection, the promoters were quite diverse (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). To confirm the sensitivity and accuracy of the FACS measurements, we selected 10 promoters and used fluorescence microscopy to measure their mean and variance in fluorescence. The cells were grown in the same conditions described above, placed on 1% agarose pad, and images were obtained using a CoolSNAP HQ CCD camera (Photometrics) connected to a DeltaVision Core microscope (Applied Precision) with a UPlanSApo 100×/1.40 oil objective (Olympus). Image-processing was done in soft-WoRx v3.3.6 (Applied Precision) and fluorescence values were extracted based on DIC image-mediated cell detection in MicrobeTracker Suite (<xref ref-type="bibr" rid="bib35">Sliusarenko et al., 2011</xref>). For each cell, we calculated fluorescence per cell volume by summing all pixel values and dividing by the volume of the cell as estimated by MicrobeTracker. Cells undergo substantial phenotypic changes when they are put on agar, including changes in the distribution of cell sizes. Consequently, it is problematic to compare absolute variance measurements directly between FACS and microscope. We therefore compared the relative noise levels of different promoters. The 10 selected native promoters consist of five pairs with almost identical mean expression values (as measured by FACS) but with noise levels that vary by different amounts. For each of the five pairs we calculated the ratio of the noise levels of the higher and the lower noise promoter as measured by both FACS and the microscope. As shown in <xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>, with the exception of one pair of promoters that showed almost equal noise levels in FACS but a 50% difference in noise in the microscope, all other pairs showed good correlation of the relative noise levels in FACS and in the microscope, confirming that relative noise levels are similar in FACS and microscope measurements.</p></sec><sec id="s4-5"><title>Quantitative Western analysis</title><p>To determine the correspondence between fluorescence intensities and absolute GFP numbers per cell, eight individual promoter clones were grown in three biological replicates using the same media conditions as in the experimental evolution. The cells were then re-suspended in SDS sample buffer, heated for 5 min at 95°C, and proteins were resolved by 12% SDS-PAGE. Quantification was done by loading a standard curve consisting of 10, 25, 50, 75, and 100 ng of GFP (#632373; Clonetech). Proteins were transferred to a Hybond ECL membrane (GE Healthcare, Life Sciences), which was then blocked in TNT (20 mM Tris pH 7.5, 150 mM NaCl, 0.05% Tween 20) with 1% BSA and 1% milk powder. Detection was performed with the ECL system after incubation with rabbit anti-GFP and polyclonal pig anti-rabbit. Western intensities for each sample were extracted using ImageJ (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). The number of cells loaded was estimated by calculating the relationship between OD600 and CFU counts. Details of the data analysis procedures are given in <xref ref-type="app" rid="app1">Appendix 1</xref>.</p></sec><sec id="s4-6"><title>Correlating protein and RNA levels per cell by quantitative PCR</title><p>Native and evolved single-promoter populations were grown in three biological replicates by diluting overnight LB cultures 500-fold into M9 media supplemented with glucose. These cultures were grown for 2.5 hr, stabilized with an equal volume of RNA Later (Sigma–Aldrich) and RNA was extracted using the Total RNA Purification 96-Well Kit (Norgen Biotek Corp) with on-column DNAse I digestion. Reverse transcription was done using random hexamers and qPCR with TaqMan probes and performed by Eurofins Medigenomix GmbH (Germany). Three technical replicates were performed. The efficiency of the primers and probes used were validated in a dilution series. Relative RNA levels per cell were obtained by normalizing to the reference gene <italic>ihfB</italic> using a Bayesian procedure for integrating data from the replicates and accounting for failed measurements (<xref ref-type="app" rid="app1">Appendix 1</xref>). The primers and probes used were: GFP forward primer: 5′-CCTGTCCTTTTACCAGACAA-3′; GFP reverse primer: 5′-GTGGTCTCTCTTTTCGTTGGGAT-3′; GFP probe: 5′-TACCTGTCCACACAATCTGCCCTTTCG-3′, ihfB forward primer: 5′-GTTTCGGCAGTTTCTCTTTG-3′, ihfB reverse primer: 5′-ATCGCCAGTCTTCGGATTA-3′, ihfB probe: 5′-ACTACCGCGCACCACGTACCGGA-3′).</p></sec><sec id="s4-7"><title>Minimal variance as a function of mean expression and excess noise</title><p>In a simple model of gene expression in which there are constant rates of transcription, translation, mRNA decay, and protein decay, the probability distribution for the number of proteins per cell is a negative binomial with variance proportional to the mean <inline-formula><mml:math id="inf8"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>: <inline-formula><mml:math id="inf9"><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where the constant <italic>b</italic> is the ratio between the mRNA translation rate and the mRNA decay rate, which is often referred to as ‘burst size’ (<xref ref-type="bibr" rid="bib31">Shahrezaei and Swain, 2008</xref>). However, in general there are also cell-to-cell fluctuations in the transcription, translation, and decay rates, which are proportional to these rates themselves. These fluctuations lead to an additional term in the variance var(<italic>n</italic>) which is proportional to the square of the mean: <inline-formula><mml:math id="inf10"><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, where <italic>β</italic> is a renormalized burst size and <inline-formula><mml:math id="inf11"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is the relative variance of the product of transcription, translation, and decay rates across cells (<xref ref-type="app" rid="app1">Appendix 1</xref>).</p><p>The total fluorescence in a cell (measured in units equivalent to number of GFP proteins) <italic>n</italic><sub>meas</sub> can then generally be written as: <inline-formula><mml:math id="inf12"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:msqrt><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, where <italic>n</italic><sub>bg</sub> is background fluorescence and <italic>ϵ</italic> is a fluctuating quantity with mean zero and variance one. Assuming that the fluctuations are small relative to the mean, we then find for the variance of the logarithm of <italic>n</italic><sub>meas</sub>:<disp-formula id="equ102"><mml:math id="m102"><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We fit this functional form to the minimum variance var(log[<italic>n</italic><sub>meas</sub>]) as a function of the mean, with <inline-formula><mml:math id="inf13"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>025</mml:mn></mml:mrow></mml:math></inline-formula> and <italic>β</italic> = 450. We defined the excess variance as the difference between the measured variance and this fitted minimal variance. A more detailed derivation is given in <xref ref-type="app" rid="app1">Appendix 1</xref>.</p></sec><sec id="s4-8"><title>The FACS selection function</title><p>By comparing the distributions of the population's expression levels before and after rounds of selection (without intervening mutation of the promoters), we found that the probability that a cell with expression level <italic>x</italic> is selected by the FACS is well-approximated by <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with <italic>μ</italic><sub>*</sub> the desired expression level and <italic>τ</italic> the width of the selection window. For the last three rounds of selection for medium expression, the selection gates in the FACS were relatively constant, and we estimated <italic>τ</italic> ≈ 0.03 and <italic>μ</italic><sub>*</sub> fluctuated slightly around an average value of <italic>μ</italic><sub>*</sub> ≈ 8.1 for these selection rounds.</p><p>With this selection function, a promoter genotype that exhibits a distribution of expression values with mean <italic>μ</italic> and standard deviation <italic>σ</italic> has a fitness (fraction of cells selected in the FACS) of<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This estimated fitness function indicated that the fitness of promoter genotypes strongly depends on their mean <italic>μ</italic> and is almost independent of their excess noise (<xref ref-type="fig" rid="fig13">Appendix 2—figure 3</xref> and <xref ref-type="fig" rid="fig14">Appendix 2—figure 4</xref>). In addition, applying additional rounds of selection of varying strengths to the population of evolved promoters did not systematically alter their distribution of excess noise levels. Details of the analysis of the FACS selection are given in <xref ref-type="app" rid="app2">Appendix 2</xref>.</p></sec><sec id="s4-9"><title>Model for the evolution of gene regulation in a fluctuating environment</title><p>Although the model we present can be extended to include the evolution of gene regulation for multiple genes, for simplicity we focused on the evolution of a single gene and its promoter. We assume that the population experiences a sequence of different environments and that, in each environment, the fitness of each organism is a function of its gene expression level. We characterized the fitness function in each environment by two parameters: the desired level <italic>μ</italic><sub><italic>e</italic></sub> that maximizes the fitness and a parameter <italic>τ</italic> that quantifies how quickly fitness falls away from this optimum. For simplicity and analytical tractability, we assumed a Gaussian form: <inline-formula><mml:math id="inf15"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Similarly, although it is straightforward to allow the variance <italic>τ</italic><sup>2</sup> to vary across conditions, the results are more transparent when we assume <italic>τ</italic><sup>2</sup> is the same in all environments. Note that this fitness function has the same form as the FACS selection function. Consequently, the fitness <inline-formula><mml:math id="inf16"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of a promoter with mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup> is given by <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> as well, with <italic>μ</italic><sub><italic>e</italic></sub> replacing <italic>μ</italic><sub>*</sub>.</p><p>The total number of offspring that a promoter will leave behind after experiencing all environments is given by the product of its fitness in each of the environments. Equivalently, the log-fitness of a promoter is proportional to its average log-fitness across all environments. For an unregulated promoter with fixed mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup> in expression, we then find for the log-fitness:<disp-formula id="equ103"><mml:math id="m103"><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf17"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the average of the desired expression levels across environments and var(<italic>μ</italic><sub><italic>e</italic></sub>) is the variance in the desired expression levels across environments. If we do not consider gene regulation but simply optimize the promoter's mean expression and noise level, then we find optimal log-fitness occurs when <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <italic>σ</italic><sup>2</sup> = 0 (when var(<italic>μ</italic><sub><italic>e</italic></sub>) &lt; <italic>τ</italic><sup>2</sup>) or <italic>σ</italic><sup>2</sup> = var(<italic>μ</italic><sub><italic>e</italic></sub>) − <italic>τ</italic><sup>2</sup> otherwise. That is, when the desired expression level varies more than the width of the selection window, fitness is optimized by increasing noise so as to ensure the distribution overlaps the desired levels across all conditions. This result is equivalent to previous results on the evolution of phenotypic diversity in fluctuating environments (<xref ref-type="bibr" rid="bib9">Bull, 1987</xref>).</p><p>To increase fitness, a promoter can evolve to become regulated by one of the regulators existing in the genome. Instead of having a constant mean expression <italic>μ</italic>, the promoter's mean expression will then become a function of the environment <italic>e</italic>: <italic>μ</italic>(<italic>e</italic>) = <italic>μ</italic> + <italic>cr</italic><sub><italic>e</italic></sub>, where <italic>r</italic><sub><italic>e</italic></sub> is the mean expression (or more generally regulatory activity) of the regulator in environment <italic>e</italic>, and <italic>c</italic> is the coupling strength. Note that, for simplicity, we thus assume a linear coupling between the means of regulator and target. Since any gene will have some variability in its expression, we assumed that the actual expression/activity of the regulator in each environment <italic>e</italic> is Gaussian distributed with a variance <inline-formula><mml:math id="inf19"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. As for the width of the fitness function <italic>τ</italic>, it would again be straightforward to allow <inline-formula><mml:math id="inf20"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> to vary across conditions (as it likely does in reality). However, the results are analytically more transparent and bring out the main features of the model better if we assume the regulator's noise <inline-formula><mml:math id="inf21"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is the same in all conditions.</p><p>When coupled to the regulator, the promoter's total expression variance will become <inline-formula><mml:math id="inf22"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>tot</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and the log-fitness of the promoter becomes:<disp-formula id="equ104"><mml:math id="m104"><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Assuming that the basal expression level <italic>μ</italic> is optimized to maximize log-fitness, that is, <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, this log-fitness can be rewritten as:<disp-formula id="equ105"><mml:math id="m105"><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>cons</mml:mtext><mml:mo>.</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>X</mml:mi><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mi>Y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mo>X</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>X</italic> measures the coupling strength <inline-formula><mml:math id="inf24"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <italic>Y</italic> is the expression mismatch that measures how much the desired expression level varies across environments <inline-formula><mml:math id="inf25"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <italic>S</italic> is the signal-to-noise of the regulator <inline-formula><mml:math id="inf26"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <italic>R</italic> is the Pearson correlation between the desired expression levels <italic>μ</italic><sub><italic>e</italic></sub> and the activity levels <italic>r</italic><sub><italic>e</italic></sub> of the regulator. The change in log-fitness between the situation before and after adding of the regulatory interaction is obtained by subtracting log[<italic>f</italic> (0, <italic>Y</italic>, <italic>S</italic>, <italic>R</italic>)] from log[<italic>f</italic> (<italic>X</italic>, <italic>Y</italic>, <italic>S</italic>, <italic>R</italic>)], yielding<disp-formula id="equ106"><mml:math id="m106"><mml:mrow><mml:mi>d</mml:mi><mml:mtext> log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>X</mml:mi><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mi>Y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Note that this basic argument can be iterated. After the promoter has been coupled to a regulator, the residual deviations between the desired and actual expression levels are given by <inline-formula><mml:math id="inf27"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and the new noise level of the promoter is given by <inline-formula><mml:math id="inf28"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. If we define a new expression mismatch <inline-formula><mml:math id="inf29"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, then we can calculate the log-fitness changes associated with adding another regulatory interaction using exactly the same expressions as above, replacing <italic>Y</italic> by <inline-formula><mml:math id="inf30"><mml:mrow><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>.</p><p>In addition, because the coupling between the activity of the regulator and the expression of the promoter is linear, coupling the promoter to an arbitrary linear combination of different regulators can be modeled as coupling the promoter to a single ‘effective’ regulator; that is, if a promoter is coupling to different regulators <italic>r</italic><sup><italic>i</italic></sup> with coupling constants <italic>c</italic><sub><italic>i</italic></sub>, then in environment <italic>e</italic> we have <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, which is equivalent to coupling with constant <italic>c</italic> to a regulator with mean <inline-formula><mml:math id="inf32"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>/</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula>. If <inline-formula><mml:math id="inf33"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is the noise level of regulator <italic>i</italic> and <italic>R</italic><sub><italic>ij</italic></sub> is the Pearson correlation in the fluctuations of regulators <italic>i</italic> and <italic>j</italic>, then this composite regulator has a total variance <inline-formula><mml:math id="inf34"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>As can be easily seen from <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> in the main text, if the best linear combination of regulators provides a correlation <italic>R</italic> with the promoter's desired levels, the optimal value <italic>S</italic><sub>*</sub> of the signal-to-noise of this composite regulator is given by <italic>S</italic><sub>*</sub> = <italic>RY</italic>/<italic>X</italic>. Substituting this back into <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, we find for the optimal coupling strength <inline-formula><mml:math id="inf35"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mtext>*</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This function is plotted in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, together with the values of <italic>S</italic><sub>*</sub> as a function of <italic>Y</italic> and <italic>R</italic>. Note that (1 − <italic>R</italic><sup>2</sup>)<italic>Y</italic><sup>2</sup> is the part of the expression mismatch that is not accounted for by the condition-response effect of the regulators. Whenever this remaining expression mismatch is less than 1, noise-propagation is a detrimental side-effect of regulation and regulators will be selected to be as accurate as possible. However, when (1 − <italic>R</italic><sup>2</sup>)<italic>Y</italic><sup>2</sup> &gt; 1, noise-propagation will be selected for, and the increase in the total noise is equal to the amount of expression mismatch not accounted for by the condition-response.</p><p>Additional details on the derivation of our model and analysis of the behavior of the fitness function as a function of its parameters are given in <xref ref-type="app" rid="app3">Appendix 3</xref>.</p></sec><sec id="s4-10"><title>Analysis of excess noise against gene expression variation and regulatory inputs</title><p>We re-annotated the promoter fragments of <xref ref-type="bibr" rid="bib40">Zaslaver et al., 2006</xref> by mapping the published primer pairs to the <italic>E. coli</italic> K12 MG1655 genome. Of the 1816 promoter fragments, 1718 could be unambiguously associated with a gene that was immediately downstream, and the 1718 promoter fragments were associated with 1137 different downstream genes (for some genes there were multiple or repeated upstream promoter fragments). We used the operon annotations of RegulonDB (<xref ref-type="bibr" rid="bib29">Salgado et al., 2013</xref>) to extract, for each promoter, the set of additional downstream genes that are part of the same operon as the first downstream gene. We obtained known regulatory interactions between TFs and genes from RegulonDB and counted, for each <italic>E. coli</italic> gene, the number of TFs known to regulate the gene. We defined the number of regulatory inputs of a promoter to equal the average of the number of inputs for all genes in the operon downstream of the promoter. We sorted promoters by their excess noise and, as a function of a cut-off on excess noise level, calculated the mean and standard error of the number of regulatory inputs for all promoters with excess noise level above the cut-off. We obtained genome-wide gene expression measurements from the Gene Expression Database (<ext-link ext-link-type="uri" xlink:href="http://genexpdb.ou.edu/">http://genexpdb.ou.edu/</ext-link>). For each <italic>E. coli</italic> gene, we obtained 240 log fold-change values <italic>x</italic> corresponding to the logarithm of the expression ratio of the gene in a perturbed and a reference condition. We defined the variance in expression of a gene as the average of <italic>x</italic><sup>2</sup> across the 240 experiments. We again sorted promoters by their excess noise and, as a function of a cut-off on excess noise level, calculated the mean and standard error of gene expression variances for all promoters with excess noise above the cut-off.</p></sec><sec id="s4-11"><title>Fitting excess noise levels in terms of regulatory interactions</title><p>Using the RegulonDB database (<xref ref-type="bibr" rid="bib29">Salgado et al., 2013</xref>), we constructed a binary matrix <bold>R</bold> of regulatory interactions, where the components <italic>R</italic><sub><italic>pr</italic></sub> = 1 when regulator <italic>r</italic> is known to target promoter <italic>p</italic>, and <italic>R</italic><sub><italic>pr</italic></sub> = 0 otherwise. Following previous work from our group in which we modeled gene expression patterns in mammals in terms of regulatory sites (<xref ref-type="bibr" rid="bib14">FANTOM Consortium et al., 2009</xref>; <xref ref-type="bibr" rid="bib2">Balwierz et al., 2014</xref>), we use a simple linear model to relate the excess noise <italic>E</italic><sub><italic>p</italic></sub> of each promoter <italic>p</italic> to the (unknown) noise-propagation strengths <italic>V</italic><sub><italic>r</italic></sub> of each regulator <italic>r</italic>:<disp-formula id="equ107"><mml:math id="m107"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>r</mml:mi></mml:munder><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mtext>noise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We assume the noise is Gaussian distributed with unknown variance, and we use a Gaussian prior <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msubsup><mml:mi>V</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> on the noise-propagation strengths <italic>V</italic><sub><italic>r</italic></sub> to avoid over-fitting. The hyper-parameter <italic>λ</italic> is chosen using a cross-validation, fitting the <italic>V</italic><sub><italic>r</italic></sub> on a random fraction of 80% of the promoters, and maximizing the quality of the predictions on the remaining 20% of the promoters. The quality of fit is quantified by the fraction of the variance in noise levels <italic>E</italic><sub><italic>p</italic></sub> that is explained by the fit. For our dataset, 17.1% of the variance of the overall dataset was explained by the fit.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank D Blank for performing the Western blots, D Bumann for discussions, B Claudi and J Zankl for assistance with flow cytometry, and S Abel and I de Jong for assistance with microscopy.</p><p>OKS and EvN designed the study. Experiments were designed by OKS and LW and performed by LW. LW, OKS, and EvN analyzed the data, and EvN developed the theoretical model. LW, OKS, and EvN wrote the paper.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>LW, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>OKS, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>EN, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ackermann</surname><given-names>M</given-names></name><name><surname>Stecher</surname><given-names>B</given-names></name><name><surname>Freed</surname><given-names>NE</given-names></name><name><surname>Songhet</surname><given-names>P</given-names></name><name><surname>Hardt</surname><given-names>WD</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year>2008</year><article-title>Self-destructive cooperation mediated by phenotypic noise</article-title><source>Nature</source><volume>454</volume><fpage>987</fpage><lpage>990</lpage><pub-id pub-id-type="doi">10.1038/nature07067</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balwierz</surname><given-names>PJ</given-names></name><name><surname>Pachkov</surname><given-names>M</given-names></name><name><surname>Arnold</surname><given-names>P</given-names></name><name><surname>Gruber</surname><given-names>AJ</given-names></name><name><surname>Zavolan</surname><given-names>M</given-names></name><name><surname>van Nimwegen</surname><given-names>E</given-names></name></person-group><year>2014</year><article-title>ISMARA: automated modeling of genomic signals as a democracy of regulatory motifs</article-title><source>Genome Research</source><volume>24</volume><fpage>869</fpage><lpage>884</lpage><pub-id pub-id-type="doi">10.1101/gr.169508.113</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bar-Even</surname><given-names>A</given-names></name><name><surname>Paulsson</surname><given-names>J</given-names></name><name><surname>Maheshri</surname><given-names>N</given-names></name><name><surname>Carmi</surname><given-names>M</given-names></name><name><surname>O'Shea</surname><given-names>E</given-names></name><name><surname>Pilpel</surname><given-names>Y</given-names></name><name><surname>Barkai</surname><given-names>N</given-names></name></person-group><year>2006</year><article-title>Noise in protein expression scales with natural protein abundance</article-title><source>Nature Genetics</source><volume>38</volume><fpage>636</fpage><lpage>643</lpage><pub-id pub-id-type="doi">10.1038/ng1807</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barkai</surname><given-names>N</given-names></name><name><surname>Shilo</surname><given-names>BZ</given-names></name></person-group><year>2007</year><article-title>Variability and robustness in biomolecular systems</article-title><source>Molecular Cell</source><volume>28</volume><fpage>755</fpage><lpage>760</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2007.11.013</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernstein</surname><given-names>JA</given-names></name><name><surname>Khodursky</surname><given-names>AB</given-names></name><name><surname>Lin</surname><given-names>PH</given-names></name><name><surname>Lin-Chao</surname><given-names>S</given-names></name><name><surname>Cohen</surname><given-names>SN</given-names></name></person-group><year>2002</year><article-title>Global analysis of mRNA decay and abundance in <italic>Escherichia coli</italic> at single-gene resolution using two-color fluorescent DNA microarrays</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>99</volume><fpage>9697</fpage><lpage>9702</lpage><pub-id pub-id-type="doi">10.1073/pnas.112318199</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bishop</surname><given-names>AL</given-names></name><name><surname>Rab</surname><given-names>FA</given-names></name><name><surname>Sumner</surname><given-names>ER</given-names></name><name><surname>Avery</surname><given-names>SV</given-names></name></person-group><year>2007</year><article-title>Phenotypic heterogeneity can enhance rare-cell survival in ‘stress-sensitive’ yeast populations</article-title><source>Molecular Microbiology</source><volume>63</volume><fpage>507</fpage><lpage>520</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2958.2006.05504.x</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blake</surname><given-names>WJ</given-names></name><name><surname>Balázsi</surname><given-names>G</given-names></name><name><surname>Kohanski</surname><given-names>MA</given-names></name><name><surname>Isaacs</surname><given-names>FJ</given-names></name><name><surname>Murphy</surname><given-names>KF</given-names></name><name><surname>Kuang</surname><given-names>Y</given-names></name><name><surname>Cantor</surname><given-names>CR</given-names></name><name><surname>Walt</surname><given-names>DR</given-names></name><name><surname>Collins</surname><given-names>JJ</given-names></name></person-group><year>2006</year><article-title>Phenotypic consequences of promoter-mediated transcriptional noise</article-title><source>Molecular Cell</source><volume>24</volume><fpage>853</fpage><lpage>865</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2006.11.003</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blake</surname><given-names>WJ</given-names></name><name><surname>Kaern</surname><given-names>M</given-names></name><name><surname>Cantor</surname><given-names>CR</given-names></name><name><surname>Collins</surname><given-names>JJ</given-names></name></person-group><year>2003</year><article-title>Noise in eukaryotic gene expression</article-title><source>Nature</source><volume>422</volume><fpage>633</fpage><lpage>637</lpage><pub-id pub-id-type="doi">10.1038/nature01546</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bull</surname><given-names>JJ</given-names></name></person-group><year>1987</year><article-title>Evolution of phenotypic variance</article-title><source>Evolution; International Journal of Organic Evolution</source><volume>41</volume><fpage>303</fpage><lpage>315</lpage><pub-id pub-id-type="doi">10.2307/2409140</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cairns</surname><given-names>BR</given-names></name></person-group><year>2009</year><article-title>The logic of chromatin architecture and remodelling at promoters</article-title><source>Nature</source><volume>461</volume><fpage>193</fpage><lpage>198</lpage><pub-id pub-id-type="doi">10.1038/nature08450</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carey</surname><given-names>LB</given-names></name><name><surname>van Dijk</surname><given-names>D</given-names></name><name><surname>Sloot</surname><given-names>PM</given-names></name><name><surname>Kaandorp</surname><given-names>JA</given-names></name><name><surname>Segal</surname><given-names>E</given-names></name></person-group><year>2013</year><article-title>Promoter sequence determines the relationship between expression level and noise</article-title><source>PLOS Biology</source><volume>11</volume><fpage>e1001528</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.1001528</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dorman</surname><given-names>CJ</given-names></name></person-group><year>2004</year><article-title>H-NS: a universal regulator for a dynamic genome</article-title><source>Nature Reviews. Microbiology</source><volume>2</volume><fpage>391</fpage><lpage>400</lpage><pub-id pub-id-type="doi">10.1038/nrmicro883</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elowitz</surname><given-names>MB</given-names></name><name><surname>Levine</surname><given-names>AJ</given-names></name><name><surname>Siggia</surname><given-names>ED</given-names></name><name><surname>Swain</surname><given-names>PS</given-names></name></person-group><year>2002</year><article-title>Stochastic gene expression in a single cell</article-title><source>Science</source><volume>297</volume><fpage>1183</fpage><lpage>1186</lpage><pub-id pub-id-type="doi">10.1126/science.1070919</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>FANTOM Consortium</collab><name><surname>Suzuki</surname><given-names>H</given-names></name><name><surname>Forrest</surname><given-names>AR</given-names></name><name><surname>van Nimwegen</surname><given-names>E</given-names></name><name><surname>Daub</surname><given-names>CO</given-names></name><name><surname>Balwierz</surname><given-names>PJ</given-names></name><name><surname>Irvine</surname><given-names>KM</given-names></name><name><surname>Lassmann</surname><given-names>T</given-names></name><name><surname>Ravasi</surname><given-names>T</given-names></name><name><surname>Hasegawa</surname><given-names>Y</given-names></name><name><surname>de Hoon</surname><given-names>MJ</given-names></name><name><surname>Katayama</surname><given-names>S</given-names></name><name><surname>Schroder</surname><given-names>K</given-names></name><name><surname>Carninci</surname><given-names>P</given-names></name><name><surname>Tomaru</surname><given-names>Y</given-names></name><name><surname>Kanamori-Katayama</surname><given-names>M</given-names></name><name><surname>Kubosaki</surname><given-names>A</given-names></name><name><surname>Akalin</surname><given-names>A</given-names></name><name><surname>Ando</surname><given-names>Y</given-names></name><name><surname>Arner</surname><given-names>E</given-names></name><name><surname>Asada</surname><given-names>M</given-names></name><name><surname>Asahara</surname><given-names>H</given-names></name><name><surname>Bailey</surname><given-names>T</given-names></name><name><surname>Bajic</surname><given-names>VB</given-names></name><name><surname>Bauer</surname><given-names>D</given-names></name><name><surname>Beckhouse</surname><given-names>AG</given-names></name><name><surname>Bertin</surname><given-names>N</given-names></name><name><surname>Björkegren</surname><given-names>J</given-names></name><name><surname>Brombacher</surname><given-names>F</given-names></name><name><surname>Bulger</surname><given-names>E</given-names></name><name><surname>Chalk</surname><given-names>AM</given-names></name><name><surname>Chiba</surname><given-names>J</given-names></name><name><surname>Cloonan</surname><given-names>N</given-names></name><name><surname>Dawe</surname><given-names>A</given-names></name><name><surname>Dostie</surname><given-names>J</given-names></name><name><surname>Engström</surname><given-names>PG</given-names></name><name><surname>Essack</surname><given-names>M</given-names></name><name><surname>Faulkner</surname><given-names>GJ</given-names></name><name><surname>Fink</surname><given-names>JL</given-names></name><name><surname>Fredman</surname><given-names>D</given-names></name><name><surname>Fujimori</surname><given-names>K</given-names></name><name><surname>Furuno</surname><given-names>M</given-names></name><name><surname>Gojobori</surname><given-names>T</given-names></name><name><surname>Gough</surname><given-names>J</given-names></name><name><surname>Grimmond</surname><given-names>SM</given-names></name><name><surname>Gustafsson</surname><given-names>M</given-names></name><name><surname>Hashimoto</surname><given-names>M</given-names></name><name><surname>Hashimoto</surname><given-names>T</given-names></name><name><surname>Hatakeyama</surname><given-names>M</given-names></name><name><surname>Heinzel</surname><given-names>S</given-names></name><name><surname>Hide</surname><given-names>W</given-names></name><name><surname>Hofmann</surname><given-names>O</given-names></name><name><surname>Hörnquist</surname><given-names>M</given-names></name><name><surname>Huminiecki</surname><given-names>L</given-names></name><name><surname>Ikeo</surname><given-names>K</given-names></name><name><surname>Imamoto</surname><given-names>N</given-names></name><name><surname>Inoue</surname><given-names>S</given-names></name><name><surname>Inoue</surname><given-names>Y</given-names></name><name><surname>Ishihara</surname><given-names>R</given-names></name><name><surname>Iwayanagi</surname><given-names>T</given-names></name><name><surname>Jacobsen</surname><given-names>A</given-names></name><name><surname>Kaur</surname><given-names>M</given-names></name><name><surname>Kawaji</surname><given-names>H</given-names></name><name><surname>Kerr</surname><given-names>MC</given-names></name><name><surname>Kimura</surname><given-names>R</given-names></name><name><surname>Kimura</surname><given-names>S</given-names></name><name><surname>Kimura</surname><given-names>Y</given-names></name><name><surname>Kitano</surname><given-names>H</given-names></name><name><surname>Koga</surname><given-names>H</given-names></name><name><surname>Kojima</surname><given-names>T</given-names></name><name><surname>Kondo</surname><given-names>S</given-names></name><name><surname>Konno</surname><given-names>T</given-names></name><name><surname>Krogh</surname><given-names>A</given-names></name><name><surname>Kruger</surname><given-names>A</given-names></name><name><surname>Kumar</surname><given-names>A</given-names></name><name><surname>Lenhard</surname><given-names>B</given-names></name><name><surname>Lennartsson</surname><given-names>A</given-names></name><name><surname>Lindow</surname><given-names>M</given-names></name><name><surname>Lizio</surname><given-names>M</given-names></name><name><surname>Macpherson</surname><given-names>C</given-names></name><name><surname>Maeda</surname><given-names>N</given-names></name><name><surname>Maher</surname><given-names>CA</given-names></name><name><surname>Maqungo</surname><given-names>M</given-names></name><name><surname>Mar</surname><given-names>J</given-names></name><name><surname>Matigian</surname><given-names>NA</given-names></name><name><surname>Matsuda</surname><given-names>H</given-names></name><name><surname>Mattick</surname><given-names>JS</given-names></name><name><surname>Meier</surname><given-names>S</given-names></name><name><surname>Miyamoto</surname><given-names>S</given-names></name><name><surname>Miyamoto-Sato</surname><given-names>E</given-names></name><name><surname>Nakabayashi</surname><given-names>K</given-names></name><name><surname>Nakachi</surname><given-names>Y</given-names></name><name><surname>Nakano</surname><given-names>M</given-names></name><name><surname>Nygaard</surname><given-names>S</given-names></name><name><surname>Okayama</surname><given-names>T</given-names></name><name><surname>Okazaki</surname><given-names>Y</given-names></name><name><surname>Okuda-Yabukami</surname><given-names>H</given-names></name><name><surname>Orlando</surname><given-names>V</given-names></name><name><surname>Otomo</surname><given-names>J</given-names></name><name><surname>Pachkov</surname><given-names>M</given-names></name><name><surname>Petrovsky</surname><given-names>N</given-names></name><name><surname>Plessy</surname><given-names>C</given-names></name><name><surname>Quackenbush</surname><given-names>J</given-names></name><name><surname>Radovanovic</surname><given-names>A</given-names></name><name><surname>Rehli</surname><given-names>M</given-names></name><name><surname>Saito</surname><given-names>R</given-names></name><name><surname>Sandelin</surname><given-names>A</given-names></name><name><surname>Schmeier</surname><given-names>S</given-names></name><name><surname>Schönbach</surname><given-names>C</given-names></name><name><surname>Schwartz</surname><given-names>AS</given-names></name><name><surname>Semple</surname><given-names>CA</given-names></name><name><surname>Sera</surname><given-names>M</given-names></name><name><surname>Severin</surname><given-names>J</given-names></name><name><surname>Shirahige</surname><given-names>K</given-names></name><name><surname>Simons</surname><given-names>C</given-names></name><name><surname>St Laurent</surname><given-names>G</given-names></name><name><surname>Suzuki</surname><given-names>M</given-names></name><name><surname>Suzuki</surname><given-names>T</given-names></name><name><surname>Sweet</surname><given-names>MJ</given-names></name><name><surname>Taft</surname><given-names>RJ</given-names></name><name><surname>Takeda</surname><given-names>S</given-names></name><name><surname>Takenaka</surname><given-names>Y</given-names></name><name><surname>Tan</surname><given-names>K</given-names></name><name><surname>Taylor</surname><given-names>MS</given-names></name><name><surname>Teasdale</surname><given-names>RD</given-names></name><name><surname>Tegnér</surname><given-names>J</given-names></name><name><surname>Teichmann</surname><given-names>S</given-names></name><name><surname>Valen</surname><given-names>E</given-names></name><name><surname>Wahlestedt</surname><given-names>C</given-names></name><name><surname>Waki</surname><given-names>K</given-names></name><name><surname>Waterhouse</surname><given-names>A</given-names></name><name><surname>Wells</surname><given-names>CA</given-names></name><name><surname>Winther</surname><given-names>O</given-names></name><name><surname>Wu</surname><given-names>L</given-names></name><name><surname>Yamaguchi</surname><given-names>K</given-names></name><name><surname>Yanagawa</surname><given-names>H</given-names></name><name><surname>Yasuda</surname><given-names>J</given-names></name><name><surname>Zavolan</surname><given-names>M</given-names></name><name><surname>Hume</surname><given-names>DA</given-names></name><collab>Riken Omics Science Center</collab><name><surname>Arakawa</surname><given-names>T</given-names></name><name><surname>Fukuda</surname><given-names>S</given-names></name><name><surname>Imamura</surname><given-names>K</given-names></name><name><surname>Kai</surname><given-names>C</given-names></name><name><surname>Kaiho</surname><given-names>A</given-names></name><name><surname>Kawashima</surname><given-names>T</given-names></name><name><surname>Kawazu</surname><given-names>C</given-names></name><name><surname>Kitazume</surname><given-names>Y</given-names></name><name><surname>Kojima</surname><given-names>M</given-names></name><name><surname>Miura</surname><given-names>H</given-names></name><name><surname>Murakami</surname><given-names>K</given-names></name><name><surname>Murata</surname><given-names>M</given-names></name><name><surname>Ninomiya</surname><given-names>N</given-names></name><name><surname>Nishiyori</surname><given-names>H</given-names></name><name><surname>Noma</surname><given-names>S</given-names></name><name><surname>Ogawa</surname><given-names>C</given-names></name><name><surname>Sano</surname><given-names>T</given-names></name><name><surname>Simon</surname><given-names>C</given-names></name><name><surname>Tagami</surname><given-names>M</given-names></name><name><surname>Takahashi</surname><given-names>Y</given-names></name><name><surname>Kawai</surname><given-names>J</given-names></name><name><surname>Hayashizaki</surname><given-names>Y</given-names></name></person-group><year>2009</year><article-title>The transcriptional network that controls growth arrest and differentiation in a human myeloid leukemia cell line</article-title><source>Nature Genetics</source><volume>41</volume><fpage>553</fpage><lpage>562</lpage><pub-id pub-id-type="doi">10.1038/ng.375</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haccou</surname><given-names>P</given-names></name><name><surname>Iwasa</surname><given-names>Y</given-names></name></person-group><year>1995</year><article-title>Optimal mixed strategies in stochastic environments</article-title><source>Theoretical Population Biology</source><volume>47</volume><fpage>212</fpage><lpage>243</lpage><pub-id pub-id-type="doi">10.1006/tpbi.1995.1009</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hornung</surname><given-names>G</given-names></name><name><surname>Bar-Ziv</surname><given-names>R</given-names></name><name><surname>Rosin</surname><given-names>D</given-names></name><name><surname>Tokuriki</surname><given-names>N</given-names></name><name><surname>Tawfik</surname><given-names>DS</given-names></name><name><surname>Oren</surname><given-names>M</given-names></name><name><surname>Barkai</surname><given-names>N</given-names></name></person-group><year>2012</year><article-title>Noise-mean relationship in mutated promoters</article-title><source>Genome Research</source><volume>22</volume><fpage>2409</fpage><lpage>2417</lpage><pub-id pub-id-type="doi">10.1101/gr.139378.112</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>DL</given-names></name><name><surname>Brewster</surname><given-names>RC</given-names></name><name><surname>Phillips</surname><given-names>R</given-names></name></person-group><year>2014</year><article-title>Promoter architecture dictates cell-to-cell variability in gene expression</article-title><source>Science</source><volume>346</volume><fpage>1533</fpage><lpage>1536</lpage><pub-id pub-id-type="doi">10.1126/science.1255301</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kepler</surname><given-names>TB</given-names></name><name><surname>Elston</surname><given-names>TC</given-names></name></person-group><year>2001</year><article-title>Stochasticity in transcriptional regulation: origins, consequences, and mathematical representations</article-title><source>Biophysical Journal</source><volume>81</volume><fpage>3116</fpage><lpage>3136</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(01)75949-8</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiviet</surname><given-names>DJ</given-names></name><name><surname>Nghe</surname><given-names>P</given-names></name><name><surname>Walker</surname><given-names>N</given-names></name><name><surname>Boulineau</surname><given-names>S</given-names></name><name><surname>Sunderlikova</surname><given-names>V</given-names></name><name><surname>Tans</surname><given-names>SJ</given-names></name></person-group><year>2014</year><article-title>Stochasticity of metabolism and growth at the single-cell level</article-title><source>Nature</source><volume>514</volume><fpage>376</fpage><lpage>379</lpage><pub-id pub-id-type="doi">10.1038/nature13582</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kussell</surname><given-names>E</given-names></name><name><surname>Leibler</surname><given-names>S</given-names></name></person-group><year>2005</year><article-title>Phenotypic diversity, population growth, and information in fluctuating environments</article-title><source>Science</source><volume>309</volume><fpage>2075</fpage><lpage>2078</lpage><pub-id pub-id-type="doi">10.1126/science.1114383</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lehner</surname><given-names>B</given-names></name></person-group><year>2008</year><article-title>Selection to minimise noise in living systems and its implications for the evolution of gene expression</article-title><source>Molecular Systems Biology</source><volume>4</volume><fpage>170</fpage><pub-id pub-id-type="doi">10.1038/msb.2008.11</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lehner</surname><given-names>B</given-names></name></person-group><year>2010</year><article-title>Conflict between noise and plasticity in yeast</article-title><source>PLOS Genetics</source><volume>6</volume><fpage>e1001185</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1001185</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lehner</surname><given-names>B</given-names></name><name><surname>Kaneko</surname><given-names>K</given-names></name></person-group><year>2011</year><article-title>Fluctuation and response in biology</article-title><source>Cellular and Molecular Life Sciences</source><volume>68</volume><fpage>1005</fpage><lpage>1010</lpage><pub-id pub-id-type="doi">10.1007/s00018-010-0589-y</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newman</surname><given-names>JR</given-names></name><name><surname>Ghaemmaghami</surname><given-names>S</given-names></name><name><surname>Ihmels</surname><given-names>J</given-names></name><name><surname>Breslow</surname><given-names>DK</given-names></name><name><surname>Noble</surname><given-names>M</given-names></name><name><surname>DeRisi</surname><given-names>JL</given-names></name><name><surname>Weissman</surname><given-names>JS</given-names></name></person-group><year>2006</year><article-title>Single-cell proteomic analysis of <italic>S. cerevisiae</italic> reveals the architecture of biological noise</article-title><source>Nature</source><volume>441</volume><fpage>840</fpage><lpage>846</lpage><pub-id pub-id-type="doi">10.1038/nature04785</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paulsson</surname><given-names>J</given-names></name></person-group><year>2005</year><article-title>Models of stochastic gene expression</article-title><source>Physics of Life Reviews</source><volume>2</volume><fpage>157</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1016/j.plrev.2005.03.003</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raj</surname><given-names>A</given-names></name><name><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group><year>2008</year><article-title>Nature, nurture, or chance: stochastic gene expression and its consequences</article-title><source>Cell</source><volume>135</volume><fpage>216</fpage><lpage>226</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2008.09.050</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rao</surname><given-names>CV</given-names></name><name><surname>Wolf</surname><given-names>DM</given-names></name><name><surname>Arkin</surname><given-names>AP</given-names></name></person-group><year>2002</year><article-title>Control, exploitation and tolerance of intracellular noise</article-title><source>Nature</source><volume>420</volume><fpage>231</fpage><lpage>237</lpage><pub-id pub-id-type="doi">10.1038/nature01258</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raser</surname><given-names>JM</given-names></name><name><surname>O'Shea</surname><given-names>EK</given-names></name></person-group><year>2005</year><article-title>Noise in gene expression: origins, consequences, and control</article-title><source>Science</source><volume>309</volume><fpage>2010</fpage><lpage>2013</lpage><pub-id pub-id-type="doi">10.1126/science.1105891</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salgado</surname><given-names>H</given-names></name><name><surname>Peralta-Gil</surname><given-names>M</given-names></name><name><surname>Gama-Castro</surname><given-names>S</given-names></name><name><surname>Santos-Zavaleta</surname><given-names>A</given-names></name><name><surname>Muñiz-Rascado</surname><given-names>L</given-names></name><name><surname>García-Sotelo</surname><given-names>JS</given-names></name><name><surname>Weiss</surname><given-names>V</given-names></name><name><surname>Solano-Lira</surname><given-names>H</given-names></name><name><surname>Martínez-Flores</surname><given-names>I</given-names></name><name><surname>Medina-Rivera</surname><given-names>A</given-names></name><name><surname>Salgado-Osorio</surname><given-names>G</given-names></name><name><surname>Alquicira-Hernández</surname><given-names>S</given-names></name><name><surname>Alquicira-Hernández</surname><given-names>K</given-names></name><name><surname>López-Fuentes</surname><given-names>A</given-names></name><name><surname>Porrón-Sotelo</surname><given-names>L</given-names></name><name><surname>Huerta</surname><given-names>AM</given-names></name><name><surname>Bonavides-Martínez</surname><given-names>C</given-names></name><name><surname>Balderas-Martínez</surname><given-names>YI</given-names></name><name><surname>Pannier</surname><given-names>L</given-names></name><name><surname>Olvera</surname><given-names>M</given-names></name><name><surname>Labastida</surname><given-names>A</given-names></name><name><surname>Jiménez-Jacinto</surname><given-names>V</given-names></name><name><surname>Vega-Alvarado</surname><given-names>L</given-names></name><name><surname>Del Moral-Chávez</surname><given-names>V</given-names></name><name><surname>Hernández-Alvarez</surname><given-names>A</given-names></name><name><surname>Morett</surname><given-names>E</given-names></name><name><surname>Collado-Vides</surname><given-names>J</given-names></name></person-group><year>2013</year><article-title>RegulonDB v8.0: omics data sets, evolutionary conservation, regulatory phrases, cross-validated gold standards and more</article-title><source>Nucleic Acids Research</source><volume>41</volume><fpage>D203</fpage><lpage>D213</lpage><pub-id pub-id-type="doi">10.1093/nar/gks1201</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanchez</surname><given-names>A</given-names></name><name><surname>Golding</surname><given-names>I</given-names></name></person-group><year>2013</year><article-title>Genetic determinants and cellular constraints in noisy gene expression</article-title><source>Science</source><volume>342</volume><fpage>1188</fpage><lpage>1193</lpage><pub-id pub-id-type="doi">10.1126/science.1242975</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shahrezaei</surname><given-names>V</given-names></name><name><surname>Swain</surname><given-names>PS</given-names></name></person-group><year>2008</year><article-title>Analytical distributions for stochastic gene expression</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>105</volume><fpage>17256</fpage><lpage>17261</lpage><pub-id pub-id-type="doi">10.1073/pnas.0803850105</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharon</surname><given-names>E</given-names></name><name><surname>van Dijk</surname><given-names>D</given-names></name><name><surname>Kalma</surname><given-names>Y</given-names></name><name><surname>Keren</surname><given-names>L</given-names></name><name><surname>Manor</surname><given-names>O</given-names></name><name><surname>Yakhini</surname><given-names>Z</given-names></name><name><surname>Segal</surname><given-names>E</given-names></name></person-group><year>2014</year><article-title>Probing the effect of promoters on noise in gene expression using thousands of designed sequences</article-title><source>Genome Research</source><volume>24</volume><fpage>1698</fpage><lpage>1706</lpage><pub-id pub-id-type="doi">10.1101/gr.168773.113</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silander</surname><given-names>OK</given-names></name><name><surname>Nikolic</surname><given-names>N</given-names></name><name><surname>Zaslaver</surname><given-names>A</given-names></name><name><surname>Bren</surname><given-names>A</given-names></name><name><surname>Kikoin</surname><given-names>I</given-names></name><name><surname>Alon</surname><given-names>U</given-names></name><name><surname>Ackermann</surname><given-names>M</given-names></name></person-group><year>2012</year><article-title>A genome-wide analysis of promoter-mediated phenotypic noise in <italic>Escherichia coli</italic></article-title><source>PLOS Genetics</source><volume>8</volume><fpage>e1002443</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1002443</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>GP</given-names></name></person-group><year>2013</year><article-title>Coupling between noise and plasticity in <italic>E. coli</italic></article-title><source>G3</source><volume>3</volume><fpage>2115</fpage><lpage>2120</lpage><pub-id pub-id-type="doi">10.1534/g3.113.008540</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sliusarenko</surname><given-names>O</given-names></name><name><surname>Heinritz</surname><given-names>J</given-names></name><name><surname>Emonet</surname><given-names>T</given-names></name><name><surname>Jacobs-Wagner</surname><given-names>C</given-names></name></person-group><year>2011</year><article-title>High-throughput, subpixel precision analysis of bacterial morphogenesis and intracellular spatio-temporal dynamics</article-title><source>Molecular Microbiology</source><volume>80</volume><fpage>612</fpage><lpage>627</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2958.2011.07579.x</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanase-Nicola</surname><given-names>S</given-names></name><name><surname>ten Wolde</surname><given-names>PR</given-names></name></person-group><year>2008</year><article-title>Regulatory control and the costs and benefits of biochemical noise</article-title><source>PLOS Computational Biology</source><volume>4</volume><fpage>e1000125</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000125</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taniguchi</surname><given-names>Y</given-names></name><name><surname>Choi</surname><given-names>PJ</given-names></name><name><surname>Li</surname><given-names>GW</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Babu</surname><given-names>M</given-names></name><name><surname>Hearn</surname><given-names>J</given-names></name><name><surname>Emili</surname><given-names>A</given-names></name><name><surname>Xie</surname><given-names>XS</given-names></name></person-group><year>2010</year><article-title>Quantifying <italic>E. coli</italic> proteome and transcriptome with single-molecule sensitivity in single cells</article-title><source>Science</source><volume>329</volume><fpage>533</fpage><lpage>538</lpage><pub-id pub-id-type="doi">10.1126/science.1188308</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thattai</surname><given-names>M</given-names></name><name><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group><year>2001</year><article-title>Intrinsic noise in gene regulatory networks</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>98</volume><fpage>8614</fpage><lpage>8619</lpage><pub-id pub-id-type="doi">10.1073/pnas.151588598</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Barkai</surname><given-names>N</given-names></name></person-group><year>2008</year><article-title>Two strategies for gene regulation by promoter nucleosomes</article-title><source>Genome Research</source><volume>18</volume><fpage>1084</fpage><lpage>1091</lpage><pub-id pub-id-type="doi">10.1101/gr.076059.108</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaslaver</surname><given-names>A</given-names></name><name><surname>Bren</surname><given-names>A</given-names></name><name><surname>Ronen</surname><given-names>M</given-names></name><name><surname>Itzkovitz</surname><given-names>S</given-names></name><name><surname>Kikoin</surname><given-names>I</given-names></name><name><surname>Shavit</surname><given-names>S</given-names></name><name><surname>Liebermeister</surname><given-names>W</given-names></name><name><surname>Surette</surname><given-names>MG</given-names></name><name><surname>Alon</surname><given-names>U</given-names></name></person-group><year>2006</year><article-title>A comprehensive library of fluorescent transcriptional reporters for <italic>Escherichia coli</italic></article-title><source>Nature Methods</source><volume>3</volume><fpage>623</fpage><lpage>628</lpage><pub-id pub-id-type="doi">10.1038/nmeth895</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Qian</surname><given-names>W</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name></person-group><year>2009</year><article-title>Positive selection for elevated gene expression noise in yeast</article-title><source>Molecular Systems Biology</source><volume>5</volume><fpage>299</fpage><pub-id pub-id-type="doi">10.1038/msb.2009.58</pub-id></element-citation></ref></ref-list><app-group><app id="app1"><title>Appendix 1</title><boxed-text><sec id="s6" sec-type="appendix"><title>Supplementary methods</title><sec id="s6-1"><title>Estimating the mean and variance of log-fluorescence levels from FACS data</title><p>Visual inspection of the distributions of fluorescence intensities for individual cells containing the same promoter construct shows that almost all of these distributions can be well approximated by a log-normal distribution. We thus chose to characterize the distribution of expression levels of each promoter by the mean and variance of log-fluorescence intensities across cells. Visual inspection of the distributions also indicated that, for almost all promoters, there are a small number of measurements with aberrantly high or low values that are likely due to some measurement artefact, and we designed a Bayesian procedure for automatically discounting these aberrant measurements.</p><p>For each clone we typically have around <italic>N</italic> = 5000 independent FACS intensities measured. We denote by <italic>x</italic> the log-intensity (using natural logs) of an individual cell. We first calculate the mean and variance without taking outliers into account, that is<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>x</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mi>x</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>x</italic><sub><italic>i</italic></sub> is the log-intensity of cell <italic>i</italic>. We call these the ‘original’ mean and variance.</p><p>Next we take outliers into account. We assume that, of all <italic>N</italic> measurements, only a fraction <italic>ρ</italic> are ‘correct’ measurements, and the other (1 − <italic>ρ</italic>) are ‘outliers’, meaning that these are erroneous measurements. We assume that these ‘outliers’ derive from a uniform distribution that spans the range of measurements <italic>R</italic> = (<italic>x</italic><sub>max</sub> − <italic>x</italic><sub>min</sub>). Finally, we assume that the distribution of ‘correct’ measurements is approximately Gaussian with (unknown) mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup>. Under these assumptions, the probability of a measurement of log-intensity <italic>x</italic> is given by<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>ρ</mml:mi><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:mi>σ</mml:mi></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The probability of the entire dataset for a clone is then simply given by<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We then maximize this probability with respect to <italic>μ</italic>, <italic>σ</italic><sup>2</sup>, and <italic>ρ</italic>. This can be easily done using Expectation-Maximization. The resulting mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup> are corrected for outliers.</p></sec><sec id="s6-2"><title>Inferring the relation between FACS intensity and GFP molecules per cell</title><p>To infer the relationship between FACS intensity per cell and GFP molecules per cell we used quantitative Westerns. For each of eight strains of known FACS intensities, we extracted the protein contents from a fixed number of cells and quantified total GFP intensity. In the same experiment the GFP intensities were measured for known amounts of GFP ranging from 10 to 100 ng. We performed three replicate experiments. In each replicate we measured the GFP intensity of the eight strains, as well as ‘reference’ intensities of bands loaded with 10, 25, 50, 75, and 100 ng of GFP. We measured intensities from these gels using both 10 s and 20 s exposure times, giving a total of six replicate measurements of the reference amounts and the eight strains.</p><p><xref ref-type="fig" rid="fig4">Appendix 1—figure 1</xref> shows the measured GFP intensities <italic>I</italic> as a function of the amount of GFP <italic>w</italic> (weight in grams) for the reference bands in each of the six replicate experiments. Note that there are five points, corresponding to weights of 10, 25, 50, 75, and 100 ng in each curve.<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.015</object-id><label>Appendix 1—figure 1.</label><caption><title>Measured intensities of the GFP reference bands as a function of the amount of GFP (in grams) loaded on each band.</title><p>Each curve corresponds to one replicate (shown in a separate color), and each curve has five data points.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.015">http://dx.doi.org/10.7554/eLife.05856.015</ext-link></p></caption><graphic xlink:href="elife-05856-app1-fig1-v1.tif"/></fig></p><p>The curves show that the measured intensities are saturating as the amount of GFP increases. Second, the intensity scale varies significantly from replicate to replicate. The simplest linear relationship between <italic>I</italic> and <italic>w</italic> that includes saturation is of the form<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mfrac><mml:mi>w</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and inspection of the curves shows that each of them can be reasonably well fitted to this functional form. To infer the amount of GFP corresponding for a particular strain in a particular replicate, we need to infer <italic>w</italic> as a function of the measured value <italic>I</italic>. We thus invert the relationship and find the general form<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfrac><mml:mi>I</mml:mi><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In other words, our functional form assumes that, for a suitably chosen value <italic>I</italic><sub>max</sub>, the weight <italic>w</italic> becomes directly proportional to the transformed variable <italic>I</italic>/(<italic>I</italic><sub>max</sub> − <italic>I</italic>). As an example, <xref ref-type="fig" rid="fig5">Appendix 1—figure 2</xref> shows that, for the first replicate, when plotting <italic>w</italic> as a function of <italic>I</italic>/(15631 − <italic>I</italic>), that is, with a value of <italic>I</italic><sub>max</sub> = 15,631, we obtain an approximately linear relationship. Similar approximately linear relationships are observed for the other replicates as well.<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.016</object-id><label>Appendix 1—figure 2.</label><caption><title>For the first replicate, we inferred a saturation value <italic>I</italic><sub>max</sub> = 15,631.</title><p>Plotting <italic>w</italic> as a function of <italic>I</italic>/(<italic>I</italic><sub>max</sub> − <italic>I</italic>) we obtain an approximately linear relationship that also approximately goes through the origin (0, 0) (as it should).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.016">http://dx.doi.org/10.7554/eLife.05856.016</ext-link></p></caption><graphic xlink:href="elife-05856-app1-fig2-v1.tif"/></fig></p><p>To fit <italic>w</italic> as a function of <italic>I</italic> for each replicate, we assume that the difference between <italic>w</italic> and <italic>I</italic>/(<italic>I</italic><sub>max</sub> − <italic>I</italic>) is Gaussian distributed with unknown variance <italic>σ</italic><sup>2</sup>, that is, for each data point <italic>i</italic> in a replicate, the weight <italic>w</italic><sub><italic>i</italic></sub> and its intensity <italic>I</italic><sub><italic>i</italic></sub> are related through<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with <italic>ϵ</italic><sub><italic>i</italic></sub> the noise, which is Gaussian distributed with unknown variance <italic>σ</italic><sup>2</sup>, that is,<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>|</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:mi>σ</mml:mi></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using this, the probability of the observed data in a titration curve, given parameters <italic>I</italic><sub>max</sub>, <italic>w</italic><sub>0</sub>, and <italic>σ</italic>, is:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>n</italic> = 5 is the number of points in a titration curve, and we have ignored factors of <inline-formula><mml:math id="inf37"><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> for convenience.</p><p>Imagine that we augment our dataset ({<italic>w</italic>}, {<italic>I</italic>}) with a single data point (<italic>w</italic><sub><italic>s</italic></sub>, <italic>I</italic><sub><italic>s</italic></sub>), where <italic>I</italic><sub><italic>s</italic></sub> is the measured intensity of strain <italic>s</italic> and <italic>w</italic><sub><italic>s</italic></sub> is a hypothesized amount of GFP for this strain. The probability of this entire dataset is given by<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Formally, we now need to specify a prior <italic>P</italic>(<italic>I</italic><sub>max</sub>, <italic>w</italic><sub>0</sub>, <italic>σ</italic>) and integrate over these unknown parameters. We will use a uniform prior over <italic>I</italic><sub>max</sub> and <italic>w</italic><sub>0</sub> and a scale prior 1/<italic>σ</italic> for <italic>σ</italic>, that is, formally we want to calculate<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mi>d</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>σ</mml:mi></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Note, if we additionally integrate over <italic>w</italic><sub><italic>s</italic></sub> we obtain<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mi>d</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and dividing by this we obtain the posterior distribution of <italic>w</italic><sub><italic>s</italic></sub>:<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To perform the integrals in <xref ref-type="disp-formula" rid="equ13">Equation 13</xref>, we first simplify the notation by denoting the new data point (<italic>w</italic><sub><italic>s</italic></sub>, <italic>I</italic><sub><italic>s</italic></sub>) as (<italic>w</italic><sub><italic>n</italic> + 1</sub>, <italic>I</italic><sub><italic>n</italic> + 1</sub>), that is, as if it was the (<italic>n</italic> + 1) st data point. The integrand now takes the form<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To further simplify the notation we write <italic>y</italic><sub><italic>i</italic></sub> = <italic>I</italic><sub><italic>i</italic></sub>/(<italic>I</italic><sub>max</sub> − <italic>I</italic><sub><italic>i</italic></sub>), keeping in mind that the values of <italic>y</italic> depend on <italic>I</italic><sub>max</sub>. Further, for any quantity <italic>x</italic> that takes on values <italic>x</italic><sub><italic>i</italic></sub> over the five titration points and the added point, we write averages like<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and so on. The integrand can then be rewritten as<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Performing the integral over <italic>w</italic><sub>0</sub> we obtain<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:msqrt><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where we have again ignored prefactors that cancel in the final posterior for <italic>w</italic><sub><italic>s</italic></sub>, that is, <xref ref-type="disp-formula" rid="equ15">Equation 15</xref>. We next integrate over <italic>σ</italic>. Performing this integral we obtain<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Notice that the key expression in parentheses is simply one minus the squared correlation coefficient between the variables <italic>w</italic> and <italic>y</italic>, that is,<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In other words, the values of <italic>w</italic><sub><italic>s</italic></sub> and <italic>I</italic><sub>max</sub> that maximize the probability are those such that the linear correlation between the resulting values of <italic>y</italic> and the <italic>w</italic> values is maximal.</p><p>We next need to perform the integral over <italic>I</italic><sub>max</sub>. Since this integral cannot be performed analytically, we performed the integrals over <italic>I</italic><sub>max</sub> numerically, separately for each strain <italic>s</italic> and each of the six replicates. Finally, for each replicate <italic>r</italic> and strain <italic>s</italic>, we determined the values <italic>w</italic><sub><italic>rs</italic></sub> that have maximal posterior probability. These are our estimated GFP amounts (in grams) for each strain and replicate (<xref ref-type="fig" rid="fig6">Appendix 1—figure 3</xref>).<fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.017</object-id><label>Appendix 1—figure 3.</label><caption><title>Inferred GFP amounts (in grams, vertical axis) for the eight strains (strain numbers shown along the horizontal axis) using the reference data from each replicate.</title><p>Each color corresponds to a replicate. The vertical axis is shown on a logarithmic scale.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.017">http://dx.doi.org/10.7554/eLife.05856.017</ext-link></p></caption><graphic xlink:href="elife-05856-app1-fig3-v1.tif"/></fig></p><p>Although the inference clearly separates the high expressed from the low expressed clones, curves from the different replicates seem to be separated by constant shifts from each other. Since the vertical axis is shown on a logarithmic scale, this means that the curves differ by common multiplicative factors. This difference in scale is almost certainly due to an experimental artefact and we will thus normalize for it.</p><p>Let <italic>w</italic><sub><italic>s</italic></sub>(<italic>i</italic>) be the inferred amount of strain <italic>s</italic> in replicate <italic>i</italic>. To account for the variability in overall scale, we normalize the inferred log-weights in each replicate by calculating the average log-weight in the replicate, that is,<disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>8</mml:mn></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>8</mml:mn></mml:munderover><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and a total average scale of the replicates<disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>6</mml:mn></mml:munderover><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and then transforming the estimated shifts as follows:<disp-formula id="equ24"><label>(24)</label><mml:math id="m24"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In addition, dividing the weight <inline-formula><mml:math id="inf38"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by the known weight of a single GFP molecule (4.48210<sup>−20</sup> g), we get an estimate of the number of GFP molecules in the bands for each strain. Finally, we used OD measurements to estimate the number of cells loaded on each band, and divided by these to obtain an estimate of the number of GFP molecules per cell for each of the strains across each of the replicates. <xref ref-type="fig" rid="fig7">Appendix 1—figure 4</xref> shows the inferred GFP molecules per cell for each strain after normalization, which indeed show much less variation across the replicates.<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.018</object-id><label>Appendix 1—figure 4.</label><caption><title>Normalized inferred GFP amounts (molecules per cell, vertical axis) for the eight strains (strain numbers shown along the horizontal axis) using the reference data from each replicate.</title><p>Each color corresponds to a replicate. The vertical axis is shown on a logarithmic scale.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.018">http://dx.doi.org/10.7554/eLife.05856.018</ext-link></p></caption><graphic xlink:href="elife-05856-app1-fig4-v1.tif"/></fig></p><p>Finally, we compared the inferred GFP amounts for each strain with the FACS intensities measured for that strain. Observing that the variation in both estimated FACS intensities and GFP molecules per cell increases with the mean, it is most natural to compare GFP and FACS levels on a logarithmic scale. Let <italic>f</italic><sub><italic>s</italic></sub> denote the true log-FACS intensity and <italic>g</italic><sub><italic>s</italic></sub> denote the true log-GFP molecules per cell. Assuming that GFP molecules per cell and (background-corrected) FACS intensity are directly proportional to each other, the log-levels are related through<disp-formula id="equ25"><label>(25)</label><mml:math id="m25"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with <italic>c</italic> a constant. For each strain <italic>s</italic>, we calculated the mean log-FACS intensity <inline-formula><mml:math id="inf39"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and its variance var(<italic>f</italic><sub><italic>s</italic></sub>) across replicate FACS, as well as the mean log-GFP molecules per cell <inline-formula><mml:math id="inf40"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and its variance var(<italic>g</italic><sub><italic>s</italic></sub>) across the quantitative Westerns as described above. Assuming Gaussian deviations between the true and observed levels, the probability of the data given <italic>c</italic> is given by<disp-formula id="equ26"><label>(26)</label><mml:math id="m26"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mi>s</mml:mi></mml:munder><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We thus find for the optimal value of <italic>c</italic>:<disp-formula id="equ27"><label>(27)</label><mml:math id="m27"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>s</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>s</mml:mi></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> shows the estimated log-FACS and log-GFP levels including their error bars, together with the optimal fit <italic>c</italic><sub>*</sub> = 1.06.</p><p>Consequently, if <italic>F</italic> is the FACS intensity of a strain (non-log), then the estimated number of GFP molecules per cell <italic>G</italic> is equal to <italic>G</italic> = <italic>e</italic><sup>1.06</sup> <italic>F</italic> = 2.88<italic>F</italic>. Note that, with these estimates, the highest expressed strain, with an average FACS intensity of 37,500, would have about 108,000 molecules of GFP per cell. The lowest expressed strain (with FACS intensity 143) would have 415 molecules per cell. From now on, we will multiply all FACS intensities by 2.88 so that a FACS intensity of <italic>I</italic> automatically corresponds to the fluorescence of <italic>I</italic> GFP molecules, that is, we express FACS fluorescence intensities in units of GFP molecules per cell.</p></sec><sec id="s6-3"><title>Comparing mRNA and protein levels</title><p>For 94 clones, we quantified mRNA levels using qPCR. The qPCR procedure uses a standard reference curve which allows it to infer the absolute number of molecules of the mRNA of interest in the input sample. Each input sample is created by extracting RNA from a certain number of cells (which we can estimate approximately), and reverse transcribing this RNA into cDNA. Unfortunately, both the total amount of cells used, as well as the efficiency of the reverse transcription, can fluctuate significantly outside of our control, and this will make the total number of molecules detected fluctuate as well. To control for this, we always quantify the absolute number of molecules of two types of mRNAs in parallel for each sample: the mRNAs of the gene of interest and the mRNAs of a reference gene which we are confident is constantly expressed. The reference gene we used was <italic>ihfB</italic>.</p><p>For each promoter of interest <italic>p</italic>, we obtained measured mRNA molecule numbers together with mRNA molecule numbers for the reference gene in three separate biological replicates and in three technical replicates for each biological replicate, that is, nine pairs of measurements in total. We denote the log-quantity of the mRNA of promoter <italic>p</italic> in biological replicate <italic>r</italic> and technical replicate <italic>i</italic> as <italic>x</italic><sub><italic>pri</italic></sub>, and the log-quantity of the reference gene in the same replicate as <italic>y</italic><sub><italic>pri</italic></sub> (note that this depends on the promoter <italic>p</italic> because these quantities come from a common sample). To estimate a single log-ratio <italic>x</italic><sub><italic>p</italic></sub> − <italic>y</italic><sub><italic>p</italic></sub> between the expression of the gene of interest and the reference gene, we will proceed as follows. First, we will integrate the data from the technical replicates to obtain biological replicate expression <italic>x</italic><sub><italic>pr</italic></sub> and <italic>y</italic><sub><italic>pr</italic></sub>. We then combine the differences <italic>d</italic><sub><italic>pr</italic></sub> = <italic>x</italic><sub><italic>pr</italic></sub> − <italic>y</italic><sub><italic>pr</italic></sub> across the biological replicates to obtain the final <italic>d</italic><sub><italic>p</italic></sub> = <italic>x</italic><sub><italic>p</italic></sub> − <italic>y</italic><sub><italic>p</italic></sub>.</p><p>The statistical model that we use assumes that the difference between the value <italic>x</italic><sub><italic>pri</italic></sub> measured in technical replicate <italic>i</italic> and the true expression <italic>x</italic><sub><italic>pr</italic></sub> is Gaussian distributed with mean zero and an unknown variance <inline-formula><mml:math id="inf41"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. Note that we assume that this ‘noise’ is the same for all promoters <italic>p</italic>, but may fluctuate between biological replicates. We similarly assume the difference between <italic>y</italic><sub><italic>pri</italic></sub> and <italic>y</italic><sub><italic>pr</italic></sub> is Gaussian distributed with variance <inline-formula><mml:math id="inf42"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. We noted that there is a small fraction of measurements that deviate by large amounts from the measurements in other replicates. We assume that there is a small fraction of measurements that failed in some way, giving erroneous measurement values. To take this into account we will use a mixture model that assumes a small fraction of the measurements come from a uniform distribution that spans the observed range of the data.</p><p>Let <italic>R</italic><sub><italic>r</italic></sub> = max<sub><italic>p</italic>, <italic>i</italic></sub>(<italic>x</italic><sub><italic>pri</italic></sub>) − min<sub><italic>p</italic>, <italic>i</italic></sub>(<italic>x</italic><sub><italic>pri</italic></sub>) denote the range of observed values in biological replicate <italic>r</italic>, and let <italic>ρ</italic><sub><italic>r</italic></sub> denote the fraction of measurements in replicate <italic>r</italic> that are meaningful, that is, not erroneous. The probability of a single measurement <italic>x</italic><sub><italic>pri</italic></sub> given <italic>x</italic><sub><italic>pr</italic></sub>, the variance <inline-formula><mml:math id="inf43"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and fraction <italic>ρ</italic><sub><italic>r</italic></sub> is given by<disp-formula id="equ28"><label>(28)</label><mml:math id="m28"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mi>σ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The probability of all technical replicates for all promoters is then simply given by the product over all promoters <italic>p</italic> and technical replicates <italic>i</italic>:<disp-formula id="equ29"><label>(29)</label><mml:math id="m29"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We next maximize this likelihood with respect to the fraction <italic>ρ</italic><sub><italic>r</italic></sub>, the variance <inline-formula><mml:math id="inf44"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, and the expression levels <italic>x</italic><sub><italic>pr</italic></sub> for all promoters <italic>p</italic>. This optimization can be done using a straightforward Expectation-Maximization scheme.</p><sec id="s6-3-1"><title>Expectation-Maximization</title><p>Given a current estimate of <italic>x</italic><sub><italic>pr</italic></sub> of the variance <inline-formula><mml:math id="inf45"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and the fraction <italic>ρ</italic><sub><italic>r</italic></sub>, the posterior probability that the technical replicate with value <italic>x</italic><sub><italic>pri</italic></sub> was a meaningful measurement is given by<disp-formula id="equ30"><label>(30)</label><mml:math id="m30"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mi>σ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mi>σ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using these posteriors, the updated value <inline-formula><mml:math id="inf46"><mml:mrow><mml:mi>x</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is given by the mean of the technical replicate measurements, weighted by their posteriors<disp-formula id="equ31"><label>(31)</label><mml:math id="m31"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Given current values of <italic>ρ</italic><sub><italic>r</italic></sub> and <inline-formula><mml:math id="inf47"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, we use these equations to iteratively update all <italic>x</italic><sub><italic>pr</italic></sub> until they converge. We then update the values of <italic>ρ</italic><sub><italic>r</italic></sub> and <inline-formula><mml:math id="inf48"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> using the following equation<disp-formula id="equ32"><label>(32)</label><mml:math id="m32"><mml:mrow><mml:msub><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>that is, the updated <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>ρ</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the average of the current posteriors over all promoters and technical replicates. The update equation for the variance is given by<disp-formula id="equ33"><label>(33)</label><mml:math id="m33"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>After each update of <inline-formula><mml:math id="inf50"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and <italic>ρ</italic><sub><italic>r</italic></sub>, all <italic>x</italic><sub><italic>pr</italic></sub> are updated until convergence again, and this is iterated until the <inline-formula><mml:math id="inf51"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and <italic>ρ</italic><sub><italic>r</italic></sub> converge. Exactly analogous Expectation-Maximization equations are used to optimize the values <inline-formula><mml:math id="inf52"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf53"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and all <italic>y</italic><sub><italic>pr</italic></sub> of the reference gene measurements.</p><p><xref ref-type="table" rid="tbl1">Appendix 1—Table 1</xref> shows the fitted fractions and variances for each of the replicates.<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.019</object-id><label>Appendix 1—Table 1.</label><caption><p>Fitted variances and fractions of meaningful measurements for the genes of interest (<italic>σ</italic><sup>2</sup>, <italic>ρ</italic>) as well as for the reference gene measurements (<inline-formula><mml:math id="inf54"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf55"><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>) for each of the three biological replicates</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.019">http://dx.doi.org/10.7554/eLife.05856.019</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Replicate</th><th><italic>σ</italic><sup>2</sup></th><th><italic>ρ</italic></th><th><inline-formula><mml:math id="inf56"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula></th><th><inline-formula><mml:math id="inf57"><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula></th></tr></thead><tbody><tr><td>1</td><td>0.0252</td><td>1.0</td><td>0.0116</td><td>0.934</td></tr><tr><td>2</td><td>0.0113</td><td>0.981</td><td>0.0118</td><td>0.988</td></tr><tr><td>3</td><td>0.0329</td><td>0.956</td><td>0.0072</td><td>0.955</td></tr></tbody></table></table-wrap></p><p>We see that, for the majority of replicates, the noise level lies around 0.01 (meaning a measurement error bar of about 0.1 on log-expression), but it is two and threefold higher for measurements of the genes of interest in two replicates. The fraction of correct measurements ranges from about 93% to almost 100% across the replicates.</p><p>When the variances and fractions have been optimized, we obtain the final technical replicate-averaged quantities <italic>x</italic><sub><italic>pr</italic></sub> and <italic>y</italic><sub><italic>pr</italic></sub> and we determine final variances <inline-formula><mml:math id="inf58"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf59"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> for each of these averages. These final variances are calculated as follows. For each promoter <italic>p</italic> and each biological replicate <italic>r</italic>, we determine the effective number of correct measurements as<disp-formula id="equ34"><label>(34)</label><mml:math id="m34"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and the final variance is then given by<disp-formula id="equ35"><label>(35)</label><mml:math id="m35"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Analogously, for the reference gene measurements we have<disp-formula id="equ36"><label>(36)</label><mml:math id="m36"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and the final variance<disp-formula id="equ37"><label>(37)</label><mml:math id="m37"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s6-3-2"><title>Combining the biological replicates</title><p>For each promoter <italic>p</italic>, we want to estimate the log-expression ratio <italic>x</italic><sub><italic>p</italic></sub> − <italic>y</italic><sub><italic>p</italic></sub> by combining the estimated values <italic>x</italic><sub><italic>pr</italic></sub> and <italic>y</italic><sub><italic>pr</italic></sub> from each of the replicates, taking into account that these values have different variances for different replicates. For a protein <italic>p</italic> and replicate <italic>r</italic>, the estimated log-expression difference <italic>d</italic><sub><italic>pr</italic></sub> is<disp-formula id="equ38"><label>(38)</label><mml:math id="m38"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The variance <inline-formula><mml:math id="inf60"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> associated with that estimated difference is<disp-formula id="equ39"><label>(39)</label><mml:math id="m39"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Inspection of the variation in <italic>d</italic><sub><italic>pr</italic></sub> across biological replicates, relative to their uncertainties <italic>τ</italic><sub><italic>pr</italic></sub>, makes it clear that, in addition to the uncertainty in each of the estimates <italic>d</italic><sub><italic>pr</italic></sub>, there is substantial variation in <italic>d</italic><sub><italic>pr</italic></sub> across the biological replicates, which is quite different for different promoters; that is, for some promoters the biological replicates give very consistent <italic>d</italic><sub><italic>pr</italic></sub>, lying within the error bars <italic>τ</italic><sub><italic>pr</italic></sub>, whereas for other promoters the variation in <italic>d</italic><sub><italic>pr</italic></sub> is much larger than the error bars <italic>τ</italic><sub><italic>pr</italic></sub>, indicating that there must be additional variance across replicates.</p><p>We will assume that the true value <inline-formula><mml:math id="inf61"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is given by the mean <italic>d</italic><sub><italic>p</italic></sub> for the promoter plus a biological replicate variation <italic>δ</italic><sub><italic>pr</italic></sub><disp-formula id="equ40"><label>(40)</label><mml:math id="m40"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and we will assume that the deviation <italic>δ</italic><sub><italic>pr</italic></sub> is Gaussian distributed with mean zero and unknown variance <inline-formula><mml:math id="inf62"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. The probability of the estimate <italic>d</italic><sub><italic>pr</italic></sub> given its variance <inline-formula><mml:math id="inf63"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, the true value <italic>d</italic><sub><italic>p</italic></sub>, and the biological replicate variance <inline-formula><mml:math id="inf64"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is given by<disp-formula id="equ41"><label>(41)</label><mml:math id="m41"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The probability of the data combining all biological replicates for the promoter is simply<disp-formula id="equ42"><label>(42)</label><mml:math id="m42"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For each promoter <italic>p</italic>, we now maximize this probability with respect to both <inline-formula><mml:math id="inf65"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and <italic>d</italic><sub><italic>p</italic></sub>. Given a fixed value of <inline-formula><mml:math id="inf66"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, the optimal value of <italic>d</italic><sub><italic>p</italic></sub> is given by the weighted sum<disp-formula id="equ43"><label>(43)</label><mml:math id="m43"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>r</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>r</mml:mi></mml:msub><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Substituting this optimal <italic>d</italic><sub><italic>p</italic></sub> into the probability (<xref ref-type="disp-formula" rid="equ42">Equation 42</xref>), the expression becomes a function of the variance <inline-formula><mml:math id="inf67"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> only, and we numerically determine the optimal value of <inline-formula><mml:math id="inf68"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> for each <italic>p</italic>. In this way we obtain a final estimate <italic>d</italic><sub><italic>p</italic></sub> for each promoter. The variance <inline-formula><mml:math id="inf69"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> associated with this final estimate is given by<disp-formula id="equ44"><label>(44)</label><mml:math id="m44"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>r</mml:mi></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref> shows the relationship between protein levels (estimated by FACS) and estimated mRNA levels for the 94 strains for which we measured mRNA levels using qPCR. We see there is a very good correlation between protein and mRNA levels (Pearson correlation <italic>r</italic><sup>2</sup> ≈ 0.82). Note that, for a given promoter, the average protein level <italic>p</italic> is related to the average mRNA level <italic>m</italic> by the ratio of the translation rate <italic>λ</italic> and protein decay rate <italic>μ</italic>, that is,<disp-formula id="equ45"><label>(45)</label><mml:math id="m45"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mi>μ</mml:mi></mml:mfrac><mml:mi>m</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Since GFP is very stable compared to the duplication rate of our cells, for our system the protein decay rate <italic>μ</italic> is approximately equal to the growth rate of the cells, and thus constant across the promoters. Consequently, the fact that 82% of the variation in protein levels is explained by variations in mRNA levels suggests that the translation rate <italic>λ</italic> shows relatively small variations across the strains. Below we use this data to more rigorously estimate variation in translation rates across the strains.</p></sec><sec id="s6-3-3"><title>Estimating relative translation rates</title><p>As before, we denote by <italic>d</italic><sub><italic>p</italic></sub> the relative (to <italic>ihfB</italic>) log-mRNA level of promoter <italic>p</italic>, and we will denote by <italic>y</italic><sub><italic>p</italic></sub> the log-protein number per cell (as measured by FACS) for promoter <italic>p</italic>. Denoting by <italic>m</italic> the absolute number of mRNAs per cell for the reference gene <italic>ihfB</italic>, by <italic>λ</italic> the average translation rate, and by <italic>μ</italic> the protein decay rate (as a consequence of cell growth), <italic>y</italic><sub><italic>p</italic></sub> and <italic>d</italic><sub><italic>p</italic></sub> are related through<disp-formula id="equ46"><label>(46)</label><mml:math id="m46"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>λ</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mi>μ</mml:mi></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mi>m</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where we have written the translation rate <italic>λ</italic><sub><italic>p</italic></sub> of promoter <italic>p</italic> in terms of the average translation rate <italic>λ</italic>, and a promoter specific deviation <italic>δ</italic><sub><italic>p</italic></sub>, that is, <inline-formula><mml:math id="inf70"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Defining <italic>e</italic><sup><italic>c</italic></sup> = <italic>λm</italic>/<italic>μ</italic> we have<disp-formula id="equ47"><label>(47)</label><mml:math id="m47"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using that our estimate of <italic>d</italic><sub><italic>p</italic></sub> is Gaussian distributed with standard deviation <italic>σ</italic><sub><italic>p</italic></sub> and assuming that <italic>δ</italic><sub><italic>p</italic></sub> is Gaussian distributed with mean 0 and standard deviation <italic>τ</italic>, the probability of our data given the <italic>σ</italic><sub><italic>p</italic></sub>, <italic>c</italic>, and <italic>τ</italic> is<disp-formula id="equ48"><label>(48)</label><mml:math id="m48"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mi>p</mml:mi></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To estimate the variance <italic>τ</italic><sup>2</sup> we integrate over all <italic>δ</italic><sub><italic>p</italic></sub> and <italic>c</italic> (using a uniform prior). To simplify the notation of the result we write <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>and Δ<sub><italic>p</italic></sub> = <italic>y</italic><sub><italic>p</italic></sub> − <italic>d</italic><sub><italic>p</italic></sub>. We then have<disp-formula id="equ49"><label>(49)</label><mml:math id="m49"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mi>p</mml:mi></mml:msub><mml:msqrt><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>p</mml:mi></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msubsup><mml:mtext>Δ</mml:mtext><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mtext>Δ</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We numerically determine the value of <italic>τ</italic> that maximizes this likelihood and find <italic>τ</italic><sub>*</sub> = 0.47. Using this maximum likelihood value of <italic>τ</italic>, the maximum likelihood value of <italic>c</italic> is given by<disp-formula id="equ50"><label>(50)</label><mml:math id="m50"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mtext>Δ</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>7</mml:mn><mml:mo>.</mml:mo><mml:mn>06</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The fit <italic>y</italic> = <italic>c</italic> + <italic>d</italic> is shown as the black line in <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>.</p><p>Finally, using <italic>τ</italic><sub>*</sub> and <italic>c</italic><sub>*</sub>, we determine the most likely values of the <italic>δ</italic><sub><italic>p</italic></sub>. We find<disp-formula id="equ51"><label>(51)</label><mml:math id="m51"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mtext>Δ</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>*</mml:mtext><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>with a standard deviation of<disp-formula id="equ52"><label>(52)</label><mml:math id="m52"><mml:mrow><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>*</mml:mtext><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="fig" rid="fig8">Appendix 1—figure 5</xref> shows the estimated values of <italic>δ</italic><sub><italic>p</italic></sub>, together with their error bars <italic>σ</italic>(<italic>δ</italic><sub><italic>p</italic></sub>), as a function of the log-protein level <italic>y</italic><sub><italic>p</italic></sub>. We see that, for the large majority of promoters, the estimated translation rate is within 2–3-fold of the average translation rate (i.e., <inline-formula><mml:math id="inf72"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), confirming that there is relatively little variation in translation rates. For the most extreme example, the translation rate is approximately <italic>e</italic><sup>1.9</sup> = 6.6 fold lower than the average translation rate.<fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.020</object-id><label>Appendix 1—figure 5.</label><caption><title>Estimated relative log-translation rates <italic>δ</italic><sub><italic>p</italic></sub> and their error bars <italic>σ</italic>(<italic>δ</italic><sub><italic>p</italic></sub>) (vertical axis) as a function of the log-mRNA level relative to <italic>ihfB</italic>, <italic>d</italic><sub><italic>P</italic></sub>, for each promoter <italic>p</italic>.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.020">http://dx.doi.org/10.7554/eLife.05856.020</ext-link></p></caption><graphic xlink:href="elife-05856-app1-fig5-v1.tif"/></fig></p><p>The figure also shows that there is no correlation between the relative translation rate <italic>δ</italic><sub><italic>p</italic></sub> and the log-mRNA level <italic>d</italic><sub><italic>p</italic></sub>. We also find no correlation of <italic>δ</italic><sub><italic>p</italic></sub> with either log-protein level <italic>y</italic><sub><italic>p</italic></sub> or the variance of the log-protein level (data not shown). Thus, in summary, these results show that translation rates vary relatively little across the constructs and do not systematically scale with either protein or mRNA levels.</p></sec></sec><sec id="s6-4"><title>Minimal expression noise as a function of mean expression</title><p>To model the noise distribution of our promoters we start with the simple case in which there are constant rates of transcription, translation, mRNA decay, and protein decay. Let <italic>λ</italic><sub><italic>m</italic></sub> be the rate of transcription per unit time, <italic>μ</italic><sub><italic>m</italic></sub> the rate of mRNA decay (per mRNA per unit time), <italic>λ</italic><sub><italic>p</italic></sub> the rate of translation (per mRNA per unit time), and <italic>μ</italic><sub><italic>p</italic></sub> the rate of protein decay (per protein per unit time). Note that in our case all proteins decay at the same rate and, because the decay rate of GFP is relatively small compared to the dilution rate as a consequence of cell growth, the rate <italic>μ</italic><sub><italic>p</italic></sub> is effectively given by the growth rate of the cells.</p><p>In <xref ref-type="bibr" rid="bib31">Shahrezaei and Swain (2008)</xref> an analytical expression was derived for the distribution <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> under the assumption that the rate of protein decay is small compared with the rate of mRNA decay. In <italic>E. coli</italic> the typical mRNA decay rate is of the order of 5 min (<xref ref-type="bibr" rid="bib5">Bernstein et al., 2002</xref>). In the minimal media with glucose in which our cells are grown, the doubling time is more than 30 min, so that the protein decay is indeed smaller than the mRNA decay rate by a factor of approximately 6. Since this is not a very large factor, one may worry that, for stable mRNAs, the approximation breaks down. Fortunately, in <xref ref-type="bibr" rid="bib31">Shahrezaei and Swain (2008)</xref> it was also shown (by simulation) that, as long as the mRNA decay rate is at least as large as the protein decay rate, then the approximation is still quite accurate. We will thus assume that we can use this approximation.</p><p>Under this approximation the stationary distribution of the number of proteins per cell depends only on the following two ratios:<disp-formula id="equ53"><label>(53)</label><mml:math id="m53"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ54"><label>(54)</label><mml:math id="m54"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The ratio <italic>a</italic> gives the expected number of transcripts that are produced during the life-time of a single protein, which in our case effectively means the doubling time of the cells, that is, <italic>a</italic> is the expected number of transcription events per cell cycle. The ratio <italic>b</italic> gives the expected number of proteins that are produced from a single mRNA during its life-time. This is sometimes referred to as the ‘burst size’, that is, typically one assumes <italic>b</italic> &gt; 1 and, given that mRNA decay is faster than protein decay, the proteins are produced ‘fast’ from a single mRNA compared with the life-time of a typical protein, that is, in a burst.</p><p>The limit distribution <inline-formula><mml:math id="inf74"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is given by a negative binomial<disp-formula id="equ55"><label>(55)</label><mml:math id="m55"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Γ</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>Γ</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>Γ</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>b</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>a</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This distribution has a mean<disp-formula id="equ56"><label>(56)</label><mml:math id="m56"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and variance<disp-formula id="equ57"><label>(57)</label><mml:math id="m57"><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We extend this simple model by assuming the ratios <italic>a</italic> and <italic>b</italic> fluctuate themselves (most likely on a somewhat slower time scale). Although we will not attempt to specify the molecular origins of these fluctuations in <italic>a</italic> and <italic>b</italic>, they likely include fluctuations in the concentrations of polymerases, ribosomes, and TFs that regulate the promoter in question. Such fluctuations would contribute to the extrinsic noise of the promoters, since they would equally affect two copies of the same promoter in the same cell. However, they may also include fluctuations in the state of the promoter itself, and such fluctuations would contribute to the intrinsic noise.</p><p>We will assume that the fluctuations in these ratios of rates are multiplicative, that is, proportional to the means <inline-formula><mml:math id="inf75"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>a</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf76"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>b</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ58"><label>(58)</label><mml:math id="m58"><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>a</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ59"><label>(59)</label><mml:math id="m59"><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>b</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We then find for the total variance of <italic>n</italic><disp-formula id="equ60"><label>(60)</label><mml:math id="m60"><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mi>b</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To simplify the notation, we introduce the variable<disp-formula id="equ61"><label>(61)</label><mml:math id="m61"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and the renormalized burst size<disp-formula id="equ62"><label>(62)</label><mml:math id="m62"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mi>b</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>With these definitions we have<disp-formula id="equ63"><label>(63)</label><mml:math id="m63"><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which brings out most clearly that there is a term proportional to <inline-formula><mml:math id="inf77"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> that results from fluctuations in <italic>a</italic> and <italic>b</italic>, and a term proportional to <inline-formula><mml:math id="inf78"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that results from Poisson fluctuations in mRNA and protein production, and is proportional to the burst size.</p><p>We now want to relate this expression to variations in log-fluorescence intensities as measured using FACS. Here it is important to note that the log-fluorescence intensity per cell is the result of a combination of fluorescence coming from GFP proteins and background fluorescence of the cell.</p><sec id="s6-4-1"><title>Background fluorescence</title><p>To estimate background fluorescence, we performed three replicate measurements of populations of cells without any plasmid and three replicate measurements of populations of cells containing an empty plasmid (not containing a GFP gene). <xref ref-type="fig" rid="fig9">Appendix 1—figure 6</xref> shows the reverse cumulative distributions of observed intensities in these control populations (colored lines).<fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.021</object-id><label>Appendix 1—figure 6.</label><caption><title>Reverse cumulative distributions of the FACS intensities per cell (multiplied by 2.88 so as to correspond to the equivalent of GFP proteins per cell) for MG1655 cells without a plasmid (red, blue and green curves) and MG1655 cells with an empty plasmid (orange, pink and cyan curves).</title><p>The black line shows a Gaussian distribution with matching mean and variance.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.021">http://dx.doi.org/10.7554/eLife.05856.021</ext-link></p></caption><graphic xlink:href="elife-05856-app1-fig6-v1.tif"/></fig></p><p>The curves show that each replicate shows a highly similar distribution of fluorescence levels, and pooling the data from all replicates we find a mean background fluorescence of <italic>n</italic><sub>bg</sub> = 582.3 with a standard deviation of <italic>σ</italic><sub>bg</sub> = 302.9. As shown by the black curve in <xref ref-type="fig" rid="fig9">Appendix 1—figure 6</xref>, the distribution of background fluorescences is reasonably approximated by a Gaussian with the same mean and standard deviation.</p></sec><sec id="s6-4-2"><title>Relating measured variations to the theoretical expression</title><p>Let <italic>n</italic><sub>meas</sub> denote the measured FACS intensity of a cell. We will write this measured intensity as the sum of an average background fluorescence <italic>n</italic><sub>bg</sub>, the average number of proteins <inline-formula><mml:math id="inf79"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and a fluctuation of size <inline-formula><mml:math id="inf80"><mml:mrow><mml:mi>ϵ</mml:mi><mml:msqrt><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ64"><label>(64)</label><mml:math id="m64"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:msqrt><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>Here <italic>ϵ</italic> is a quantity that fluctuates from cell to cell, which has mean zero <inline-formula><mml:math id="inf81"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and variance one, that is, <inline-formula><mml:math id="inf82"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>We will assume that the fluctuations <inline-formula><mml:math id="inf83"><mml:mrow><mml:mi>ϵ</mml:mi><mml:msqrt><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> are small relative to the mean <inline-formula><mml:math id="inf84"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mi>n</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We can then write for the logarithm of the measured FACS intensity<disp-formula id="equ65"><label>(65)</label><mml:math id="m65"><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:mfrac><mml:mrow><mml:msqrt><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and find for the variance in log-scale of the measured FACS intensities<disp-formula id="equ66"><label>(66)</label><mml:math id="m66"><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>If we substitute the expression (<xref ref-type="disp-formula" rid="equ63">Equation 63</xref>) for the numerator, we obtain<disp-formula id="equ67"><label>(67)</label><mml:math id="m67"><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>meas</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The left panel of <xref ref-type="fig" rid="fig10">Appendix 1—figure 7</xref> shows the mean and variances of the log-FACS intensities of all native promoters. This scatter shows that, as a function of the mean FACS intensity, there is a sharp lower bound on the observed variances. The red curve shows that this lower bound can be well-fitted by a function of the form (<xref ref-type="disp-formula" rid="equ67">Equation 67</xref>), where we used parameters <inline-formula><mml:math id="inf85"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>025</mml:mn></mml:mrow></mml:math></inline-formula> and <italic>β</italic> = 450. Note that the value of <inline-formula><mml:math id="inf86"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> determines the variance in the limit of large means whereas <italic>β</italic> controls the curvature at lower means. We fitted these two parameters by hand. Their interpretation is that, <inline-formula><mml:math id="inf87"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> corresponds to the minimal amount of cell-to-cell variation in the product <italic>ab</italic> that is possible for any promoter architecture. The variable <italic>β</italic> = 450 roughly corresponds to the burst size.<fig id="fig10" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.022</object-id><label>Appendix 1—figure 7.</label><caption><title>Dependence between mean and variance of log FACS intensities.</title><p>Left panel: Means and variances of log-FACS intensities of all native promoters (blue dots) together with a fitted lower bound on the variance as given by <xref ref-type="disp-formula" rid="equ67">Equation 67</xref> using <inline-formula><mml:math id="inf88"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mo>025</mml:mo></mml:mrow></mml:math></inline-formula> and <italic>β</italic> = 450 (red curve). Right panel: Excess noise (obtained by subtracting the fitted lower bound from the variance) as a function of mean log-FACS intensity for all native promoters (blue dots). The red line shows the <italic>x</italic>-axis.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.022">http://dx.doi.org/10.7554/eLife.05856.022</ext-link></p></caption><graphic xlink:href="elife-05856-app1-fig7-v1.tif"/></fig></p><p>Note that the log-fluorescence on the horizontal axis corresponds to the sum of fluorescence resulting from GFP molecules and the background fluorescence. The estimated background level <italic>n</italic><sub>bg</sub> = 582.3 corresponds to a log-fluorescence of 6.37. The region on the horizontal axis between 6.37 and 7 ≈ log(2 × 582.3) thus corresponds to cells where the fluorescence due to GFP molecules is less than the background fluorescence. In this regime the noise distribution results from a combination of fluctuations in background fluorescence and in protein numbers (which may be correlated because part of these fluctuations may result from fluctuations in cell size) and our noise model (<xref ref-type="disp-formula" rid="equ67">Equation 67</xref>) breaks down. In the following we will focus on those promoters with fluorescence due to GFP at least as large as the background fluorescence, that is, with mean log-fluorescence larger than 7.</p><p>To obtain a deviation of each promoter's variance from the minimal variance that is possible at its expression level, we define the excess noise <italic>η</italic> as the difference between a promoter's variance and its fitted minimal variance <inline-formula><mml:math id="inf89"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as given by <xref ref-type="disp-formula" rid="equ67">Equation 67</xref> with <italic>β</italic> = 450 and <inline-formula><mml:math id="inf90"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>025</mml:mn></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ68"><label>(68)</label><mml:math id="m68"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The right panel of <xref ref-type="fig" rid="fig10">Appendix 1—figure 7</xref> shows the excess noise levels of all native promoters as a function of their means. The figure shows that, with this correction, there is no longer any systematic dependence between mean expression levels and noise. Therefore, we can use excess noise as a measure of transcriptional noise that allows us to compare noise levels of promoters with different mean expression levels.</p></sec></sec></sec></boxed-text></app><app id="app2"><title>Appendix 2</title><boxed-text><sec id="s7" sec-type="appendix"><title>FACS selection</title><p>As explained in the ‘Materials and methods’, for both the medium and high expression evolutionary runs, the desired expression level <italic>μ</italic><sub>*</sub> is taken from the expression level of a reference promoter from the library of <italic>E. coli</italic> promoters. At each selection round we measure the expression <italic>μ</italic><sub>*</sub> of the reference promoter, and set the center of the FACS selection window to <italic>μ</italic><sub>*</sub>. We then set the width of the selection window such that 5% of the cells have expression levels within the selection window.</p><p>Although, in principle, the FACS selection should work such that a cell with expression level anywhere within the selection window has 100% probability to be selected, and 0% probability to be selected if the cell's expression is anywhere outside the selection window, it is unrealistic to assume that the boundaries of the selection window are so precisely defined in practice. As illustrated below, comparison of the population's expression levels before and after selection shows that the probability for a cell with log-fluorescence <italic>x</italic> to be selected can be well-approximated by<disp-formula id="equ69"><label>(69)</label><mml:math id="m69"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>μ</italic><sub>*</sub> is the desired expression level and <italic>τ</italic> corresponds to the width of the selection window.</p><p>Note that, for a promoter with mean expression <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup>, the fraction <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of its cells that have expression level <italic>x</italic> is given by<disp-formula id="equ70"><label>(70)</label><mml:math id="m70"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:mi>σ</mml:mi></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Consequently, the ‘fitness’ of this promoter, that is, the fraction of its cells that are selected in the FACS, is given by<disp-formula id="equ71"><label>(71)</label><mml:math id="m71"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To infer the values of <italic>μ</italic><sub>*</sub> and <italic>τ</italic> that apply to our evolutionary runs, we performed a number of experiments in which we:<list list-type="order"><list-item><p>Took a population from one of the rounds of our evolutionary runs.</p></list-item><list-item><p>Measured its distribution of log-fluorescence levels.</p></list-item><list-item><p>Set the selection window [<italic>μ</italic><sub>*</sub> − <italic>δ</italic>, <italic>μ</italic><sub>*</sub> + <italic>δ</italic>] such that a percentage <italic>p</italic> of the population has log-fluorescence levels within this selection window.</p></list-item><list-item><p>Performed selection and re-measured the log-fluorescence levels of the selected population.</p></list-item></list></p><p>As shown in <xref ref-type="fig" rid="fig1">Figure 1B</xref> of the main paper, in the evolutionary runs in which we are selecting for high expression, the selection window is changing at every round of the evolutionary run. In contrast, in the evolutionary runs selecting for medium expression, the selection window is essentially constant from round three through round five. We thus decided to focus on inferring the precise fitness function that acted during these three rounds of selection.</p><p>We took the evolved populations from the third and fifth rounds of the evolutionary runs selecting for medium expression and performed another round of selection on them, selecting 5% of the population closest to the desired log-fluorescence <italic>μ</italic><sub>*</sub>. In addition, we also performed a round of less stringent selection on these populations, selecting 25% closest to the desired level, and a round of more stringent selection, selecting only the 1% of the population closest to the desired level. Besides measuring the log-fluorescence levels of the population both before and after the round of selection, we also selected dozens of clones from the populations before and after the selection and measured the entire distribution of log-fluorescence levels for these clones. <xref ref-type="fig" rid="fig11">Appendix 2—figure 1</xref> shows the means and variances of the log-fluorescence distributions of these clones.<fig id="fig11" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.023</object-id><label>Appendix 2—figure 1.</label><caption><title>Means and variances of the log-fluorescence levels of clones from the third and fifth rounds of the evolutionary runs in which we selected for medium expression (black dots), and clones obtained after performing another round of selection on these populations, selecting either 1% (red), 5% (yellow), or 25% (green) of the population closest to the desired log-fluorescence <italic>μ</italic><sub>*</sub>.</title><p>The blue curve shows a fit of the typical variance <italic>σ</italic><sup>2</sup> as a function of the mean <italic>μ</italic>: <italic>σ</italic><sup>2</sup>(<italic>μ</italic>) = 0.02 + 384<italic>e</italic><sup>−<italic>μ</italic></sup> − 156,915<italic>e</italic><sup>−2<italic>μ</italic></sup>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.023">http://dx.doi.org/10.7554/eLife.05856.023</ext-link></p></caption><graphic xlink:href="elife-05856-app2-fig1-v1.tif"/></fig></p><p>Intuitively, one might think that the relative fitness <italic>f</italic>(<italic>x</italic>) of each log-fluorescence level <italic>x</italic> could be easily estimated by simply measuring the ratio of the fraction of the population <italic>p</italic>′(<italic>x</italic>) with log-fluorescence level <italic>x</italic> after selection and the fraction <italic>p</italic>(<italic>x</italic>) with log-fluorescence <italic>x</italic> before selection. However, the single cells that were selected in the FACS each grow into an entire population of cells before the ‘after selection’ population is measured again. Thus, a selected cell containing a promoter with a given mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup> will contribute an entire population of cells with this distribution, even though the individual cell may itself have had a log-fluorescence that was in one of the tails of this distribution. Thus, in general the distribution of log-fluorescence levels in the population after selection may be much wider than the actual selection window itself.</p><p>Before selection, the population consisted of a mixture containing (unknown) fractions <italic>ρ</italic>(<italic>μ</italic>, <italic>σ</italic>) of cells containing promoters with mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup>. This gives rise to an overall distribution <italic>p</italic>(<italic>x</italic>) of expression levels given by<disp-formula id="equ72"><label>(72)</label><mml:math id="m72"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mi>d</mml:mi><mml:mi>μ</mml:mi><mml:mi>d</mml:mi><mml:mi>σ</mml:mi><mml:mfrac><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:mi>σ</mml:mi></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Unfortunately we cannot uniquely infer <italic>ρ</italic>(<italic>μ</italic>, <italic>σ</italic>) from knowing only the distribution <italic>p</italic>(<italic>x</italic>). However, as shown in <xref ref-type="fig" rid="fig11">Appendix 2—figure 1</xref>, for the clones in these populations, the large majority of promoters have variances <italic>σ</italic><sup>2</sup> lying in a narrow band as a function of <italic>μ</italic>. We thus chose to make the approximation that <italic>all</italic> promoters in the population have variances <italic>σ</italic><sup>2</sup> that are uniquely determined by their mean expression <italic>μ</italic>, and we used the fit <italic>σ</italic><sup>2</sup>(<italic>μ</italic>) shown as the blue curve in <xref ref-type="fig" rid="fig11">Appendix 2—figure 1</xref>. This simplifies the problem from inferring a two-dimensional distribution <italic>ρ</italic>(<italic>μ</italic>, <italic>σ</italic>) to inferring a one-dimensional distribution <italic>ρ</italic>(<italic>μ</italic>), that is,<disp-formula id="equ73"><label>(73)</label><mml:math id="m73"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mi>d</mml:mi><mml:mi>μ</mml:mi><mml:mfrac><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:mi>σ</mml:mi></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Applying selection with target log-fluorescence <italic>μ</italic><sub>*</sub> and width <italic>τ</italic> to this distribution, we obtain a new distribution<disp-formula id="equ74"><label>(74)</label><mml:math id="m74"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>C</italic> is a normalization constant that ensures <inline-formula><mml:math id="inf92"><mml:mrow><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mi>d</mml:mi><mml:mi>μ</mml:mi><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The population distribution of log-fluorescence levels after selection is then<disp-formula id="equ75"><label>(75)</label><mml:math id="m75"><mml:mrow><mml:mi>p</mml:mi><mml:mo>′</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mi>d</mml:mi><mml:mi>μ</mml:mi><mml:mfrac><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:mi>σ</mml:mi></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To infer the parameters of the fitness function for each selection that we performed, we fit the distribution <italic>ρ</italic>(<italic>μ</italic>) and parameters <italic>μ</italic><sub>*</sub> and <italic>τ</italic> that lead to an optimal fit to the observed distributions <italic>p</italic>(<italic>x</italic>) and <italic>p</italic>′(<italic>x</italic>). <xref ref-type="fig" rid="fig12">Appendix 2—figure 2</xref> shows the inferred and observed distributions, as well as the inferred fitness function, for each of the six selection experiments that we performed.<fig id="fig12" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.024</object-id><label>Appendix 2—figure 2.</label><caption><title>Inference of the fitness function from the observed log-fluorescence distribution before and after a round of selection.</title><p>Each panel corresponds to one selection experiment with the title indicating on which population an extra round of selection was performed, that is, a population either from the third or fifth round of the evolutionary run for medium expression, and what fraction of the population was selected. The thin blue line indicates the observed log-fluorescence distribution <italic>p</italic>(<italic>x</italic>) before selection, and the thin orange line the observed distribution <italic>p</italic>′(<italic>x</italic>) after selection. The thick lines show the corresponding fitted distributions. The inferred selection window <inline-formula><mml:math id="inf93"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, that is, <xref ref-type="disp-formula" rid="equ69">Equation 69</xref>, is indicated in black, and its parameters <italic>μ</italic><sub>*</sub> and <italic>τ</italic> are indicated in each panel as well.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.024">http://dx.doi.org/10.7554/eLife.05856.024</ext-link></p></caption><graphic xlink:href="elife-05856-app2-fig2-v1.tif"/></fig></p><p>The figure shows that the distributions <italic>p</italic>(<italic>x</italic>) and <italic>p</italic>′(<italic>x</italic>) can be well fit by this model, illustrating that the form of the selection window (<xref ref-type="disp-formula" rid="equ69">Equation 69</xref>) can well describe the effects of selection in the FACS machine. Moreover, we see that the distributions <italic>p</italic>(<italic>x</italic>) and <italic>p</italic>′(<italic>x</italic>) are typically significantly wider than the selection window <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Moreover, the fitted values of <italic>τ</italic> are almost perfectly proportional to the fraction of the population that was selected, with a value of <italic>τ</italic> ≈ 0.03 corresponding to the selection of 5% of the population that was used during the evolutionary runs. The fits also show that, although we in each experiment determine <italic>μ</italic><sub>*</sub> from the expression of the same reference promoter, there is some variability in <italic>μ</italic><sub>*</sub> from one experiment to the next. From these six experiments, we find that on average <inline-formula><mml:math id="inf95"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>8</mml:mn><mml:mo>.</mml:mo><mml:mn>115</mml:mn></mml:mrow></mml:math></inline-formula> and <italic>σ</italic>(<italic>μ</italic><sub>*</sub>) = 0.133.</p><p>Thus, in each selection round the fitness of a promoter with mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup> is given by <xref ref-type="disp-formula" rid="equ71">Equation 71</xref>, where <italic>τ</italic> = 0.03 and <italic>μ</italic><sub>*</sub> fluctuates around <inline-formula><mml:math id="inf96"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>8</mml:mn><mml:mo>.</mml:mo><mml:mn>115</mml:mn></mml:mrow></mml:math></inline-formula>. The effective fitness experienced by this promoter is thus given by the <italic>geometric</italic> average of <xref ref-type="disp-formula" rid="equ71">Equation 71</xref> with fluctuating values of <italic>μ</italic><sub>*</sub> and this is given by<disp-formula id="equ76"><label>(76)</label><mml:math id="m76"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="fig" rid="fig13">Appendix 2—figure 3</xref> shows a contour plot of this fitness function with the inferred parameters of <inline-formula><mml:math id="inf97"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <italic>σ</italic>(<italic>μ</italic><sub>*</sub>) and <italic>τ</italic> as a function of the mean fitness <italic>μ</italic>, and the excess noise level <italic>η</italic> = <italic>σ</italic><sup>2</sup> − <italic>σ</italic><sub>min</sub><sup>2</sup>(<italic>μ</italic>), where <inline-formula><mml:math id="inf98"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the minimal variance as a function of mean expression level <italic>μ</italic> (<xref ref-type="disp-formula" rid="equ67">Equation 67</xref>). Note that, for these measurements, the plasmids were transformed into a different strain than those used to compare with the native <italic>E. coli</italic> promoters. We noticed that the minimal noise level <inline-formula><mml:math id="inf99"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as a function of mean <italic>μ</italic> is slightly different. Although the background fluorescence and burst size parameter <italic>β</italic> = 450 are the same, the parameter <inline-formula><mml:math id="inf100"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is smaller, that is, <inline-formula><mml:math id="inf101"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>006</mml:mn></mml:mrow></mml:math></inline-formula> instead of <inline-formula><mml:math id="inf102"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.</mml:mn><mml:mo>.</mml:mo><mml:mn>025</mml:mn></mml:mrow></mml:math></inline-formula>.<fig id="fig13" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.025</object-id><label>Appendix 2—figure 3.</label><caption><title>Contour plot of the inferred fitness function (76) as a function of mean expression <italic>μ</italic> (horizontal axis) and excess noise (vertical axis), that acts on the population from rounds 3 through 5 of the evolutionary runs for medium expression.</title><p>The contours correspond to fitness values (fraction of cells selected) of 0.01, 0.02, 0.03, through 0.08. Left panel: In addition to the fitness function (contours), the panel shows the means and excess noise levels of a selection of clones from the third round of the evolutionary run (blue dots) and clones that resulted from subjecting this population to another round of selection, selecting either for the 1% (red dots), 5% (yellow dots), or 25% (green dots) of cells with expression closest to the desired expression level. Right panel: As in the left panel, but with the dots corresponding to clones from the fifth round of the evolutionary run and clones resulting from additional rounds of selection on this population (colors as in the left panel).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.025">http://dx.doi.org/10.7554/eLife.05856.025</ext-link></p></caption><graphic xlink:href="elife-05856-app2-fig3-v1.tif"/></fig></p><p><xref ref-type="fig" rid="fig13">Appendix 2—figure 3</xref> clearly shows that fitness drops far more dramatically as a function of mean <italic>μ</italic> than as a function of excess noise <italic>η</italic>, that is, except for right at the optimal mean <italic>μ</italic><sub>*</sub>, the contours are running almost vertically in the plot. Second, we do not observe promoters with high excess noise, even though their fitness would easily allow it. For example, a promoter with mean expression near the optimum 8.11 but excess noise as high as 0.25 (i.e., significantly higher than observed for any of the clones) would have higher fitness than any promoter with mean less than <italic>μ</italic> = 7.76 or larger than <italic>μ</italic> = 8.47 (independent of their noise), and we do observe many promoters with means that deviate this far from the optimum. The fact that we do not observe high excess noise promoters, even though they would not be selected against, strongly suggests that such high noise promoters are uncommon a priori, that is, among all random sequences that drive expression at a medium level, the large majority have low excess noise levels and high noise promoters are rare. Moreover, note also that, for promoters that are not near the optimum, the optimal excess noise level is typically <italic>larger</italic> than those of the observed clones, for example, the optimal excess noise for a promoter with mean <italic>μ</italic> = 7.5 is <italic>η</italic> = 0.22. These observations all indicate that promoters have not experienced significant selection on their noise levels.</p><p>To further support this conclusion, <xref ref-type="fig" rid="fig14">Appendix 2—figure 4</xref> shows the inferred fitness values for the observed clones both as a function of their mean expression (left panel) and as a function of their excess noise (right panel). The figure shows that, whereas the fitness of a clone can be accurately predicted from its mean <italic>μ</italic>, fitness is almost entirely uncorrelated to a promoter's excess noise <italic>η</italic>.<fig id="fig14" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.026</object-id><label>Appendix 2—figure 4.</label><caption><title>Fitness of the observed clones, as given by <xref ref-type="disp-formula" rid="equ76">Equation 76</xref>, as a function of their mean expression <italic>μ</italic> (left panel) and their excess noise <italic>η</italic> (right panel).</title><p>As in <xref ref-type="fig" rid="fig13">Appendix 2—figure 3</xref>, the blue dots correspond to clones from the third and fifth round of the evolutionary run, the red dots result from another round of stringent selection (top 1%), the yellow dots from another round of standard selection (top 5%), and the green dots from a round of weaker selection (top 25%).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.026">http://dx.doi.org/10.7554/eLife.05856.026</ext-link></p></caption><graphic xlink:href="elife-05856-app2-fig4-v1.tif"/></fig></p><p>Finally, if there was significant selection on noise levels, then we expect noise levels to systematically shift under selection. <xref ref-type="fig" rid="fig15">Appendix 2—figure 5</xref> shows cumulative distributions of excess noise levels for clones obtained from different populations of cells.<fig id="fig15" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.027</object-id><label>Appendix 2—figure 5.</label><caption><title>Cumulative distribution functions of excess noise levels for the promoters extracted from different populations.</title><p>Left panel: Excess noise levels of promoters from the third (black) and fifth (brown) round of the evolutionary run. Middle panel: Excess noise levels of promoters from the third round of the evolutionary run (blue), and from clones that resulted from another round of either stringent (red), normal (yellow), or weak (green) selection. Right panel: As in the middle panel but now for clones from the fifth round and clones resulting from another round of selection on this population.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.027">http://dx.doi.org/10.7554/eLife.05856.027</ext-link></p></caption><graphic xlink:href="elife-05856-app2-fig5-v1.tif"/></fig></p><p>The figure shows that, surprisingly, the excess noise levels seem to increase from the third to the fifth round in the evolutionary run. However, given the limited number of clones involved, the change in excess noise levels is only marginally significant (<italic>p</italic> = 0.004 in a t-test). Similarly, the effect of selection on excess noise levels seems to be opposite on the populations of round 3 and round 5 (center and right panels in <xref ref-type="fig" rid="fig15">Appendix 2—figure 5</xref>). We suspect that there are some systematic experimental fluctuations that make measured excess noise levels vary across days, and that the observed distributions of excess noise levels are more a reflection of experimental variability than of true shifts in the distribution. Importantly, excess noise levels larger than 0.1, which are observed for a substantial fraction of native promoters, are very rare for all these populations.</p><p>In summary, our in-depth analysis of the FACS fitness function and the effects of selection show that the noise properties of the synthetic promoters have not been significantly shaped by selection. Already the synthetic promoters at the third round of selection are tightly concentrated in a low noise band, even though selection does not select against noise, and promoters with mean away from the optimum would benefit from having higher noise. Two additional rounds of mutation and selection on the promoters from the third round do not substantially change the distribution of noise levels, confirming that there are no substantial fitness differences among promoters with different noise. Similarly, performing additional rounds of selection (be it very stringent, normal, or lenient) also does not substantially change the observed noise levels of the selected promoters. Thus, our results show that promoters selected from a large collection of random sequences naturally display low noise levels. Importantly, this implies that the native promoters with substantially higher noise levels must have experienced some selective pressures that caused them to increase their noise.</p></sec></boxed-text></app><app id="app3"><title>Appendix 3</title><boxed-text><sec id="s8" sec-type="appendix"><title>A simple model for the evolution of gene regulation and expression noise</title><p>Given a particular environment, the fitness, for example, growth rate or survival probability of a cell, depends on the expression level of its genes. Note that the fact that gene regulatory mechanisms have evolved already demonstrates that different environments require different gene expression patterns, that is, expressing a gene at the ‘wrong’ level for a given environment has negative effects on fitness/growth rate. Although our model can be developed for an arbitrary number of genes, for simplicity we will focus on a single gene. We assume that, in each given environment, there is an optimal expression level <italic>μ</italic><sub>*</sub>. Given that, as we have seen, expression levels are roughly log-normally distributed, we will express expression levels in log-space, that is, the logarithm of the number of proteins per cell. We define the fitness at the optimal expression level <italic>μ</italic><sub>*</sub> as <italic>f</italic><sub><italic>o</italic></sub>. Fitness will fall as the expression level <italic>x</italic> moves away from this optimum. In this simple conceptual model, we will assume that, like in our FACS selection, the fitness <italic>f</italic>(<italic>x</italic>) falls approximately Gaussian away from the optimum, that is,<disp-formula id="equ77"><label>(77)</label><mml:math id="m77"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mi>τ</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>τ</italic> is again a parameter that determines how fast the fitness falls when the expression <italic>x</italic> moves away from the optimum <italic>μ</italic><sub>*</sub>.</p><p>To justify the Gaussian form of the fitness function, assume that expression levels are maintained for some characteristic time <italic>t</italic>. Over this time, cells that grow at rate <italic>ρ</italic> will expand by a factor of <italic>f</italic> = <italic>e</italic><sup><italic>ρt</italic></sup>. The growth rate <italic>ρ</italic> is optimal at <italic>x</italic> = <italic>μ</italic><sub>*</sub>, and to second order in the difference between <italic>x</italic> and <italic>μ</italic><sub>*</sub>, we can write<disp-formula id="equ78"><label>(78)</label><mml:math id="m78"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Defining <italic>f</italic><sub><italic>o</italic></sub> = <italic>e</italic><sup><italic>ρt</italic></sup> and <inline-formula><mml:math id="inf103"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, we obtain the fitness function defined above. Note that, in this interpretation, the width of the selection function is inversely proportional to the time for which fitness fluctuations are maintained.</p><p>In complete analogy with the FACS selection case, the fitness <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of a promoter with mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup> in an environment with optimal expression level <italic>μ</italic><sub>*</sub> and width <italic>τ</italic> is given by the integral of the product of the fitness function (<xref ref-type="disp-formula" rid="equ77">Equation 77</xref>) and the Gaussian distribution of expression levels, giving<disp-formula id="equ79"><label>(79)</label><mml:math id="m79"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>*</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Note that this functional form is a good approximation to the fitness function as long as expression levels are roughly log-normally distributed and as long as the integral of expression levels and fitness function can be approximated using the standard Laplace approximation, that is, expanding the logarithm of fitness to second order around its maximum.</p><p>We now extend this simple situation in two respects. First, instead of assuming that the optimal level <italic>μ</italic><sub>*</sub> is fixed, we imagine that the population of cells has gone through several different ‘environments’ where, in each environment <italic>e</italic>, there was an optimal expression level <italic>μ</italic><sub><italic>e</italic></sub>. Although we could develop our theory assuming the width <italic>τ</italic> varies across environments, the analytical results are much more transparent if we assume <italic>τ</italic> is the same in each environment, and we will make this assumption for clarity of presentation.</p><p>Let us first consider what this situation implies for the fitness of a promoter expressing at constant mean level <italic>μ</italic> with variance <italic>σ</italic><sup>2</sup>. The number of offspring that a strain with mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup> produces (or leaves behind) after experiencing environment <italic>e</italic> is proportional to <inline-formula><mml:math id="inf105"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Consequently, the final number of offspring produced after experiencing all environments is given by the product <inline-formula><mml:math id="inf106"><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>e</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We define the overall log-fitness log[<italic>f</italic>(<italic>μ</italic>,<italic>σ</italic>)] as the average of the log-fitness across all environments:<disp-formula id="equ80"><label>(80)</label><mml:math id="m80"><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the subscript <italic>e</italic> indicates that we are averaging over all environments <italic>e</italic> (which we drop for convenience from here on). Using <xref ref-type="disp-formula" rid="equ79">Equation 79</xref>, we obtain<disp-formula id="equ81"><label>(81)</label><mml:math id="m81"><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf107"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the average and var(<italic>μ</italic><sub><italic>e</italic></sub>) is the variance in desired expression levels across the environments. It is immediately clear from <xref ref-type="disp-formula" rid="equ81">Equation 81</xref> that, as a function of the mean expression <italic>μ</italic>, optimal fitness is obtained when <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Substituting this optimal mean level, we find that the optimal variance is given by<disp-formula id="equ82"><label>(82)</label><mml:math id="m82"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>when var(<italic>μ</italic><sub><italic>e</italic></sub>) ≥ <italic>τ</italic><sup>2</sup>, and <italic>σ</italic> = 0 otherwise; that is, when the variance in desired expression levels is larger than the width of the selection window <italic>τ</italic>, then the fitness of a constantly expressed promoter can be increased by raising the noise level <italic>σ</italic> of the promoter until the sum <italic>σ</italic><sup>2</sup> + <italic>τ</italic><sup>2</sup> equals the variation in desired levels var(<italic>μ</italic><sub><italic>e</italic></sub>). This result is equivalent to results on selection for phenotypic variance obtained previously (for example, <xref ref-type="bibr" rid="bib9">Bull, 1987</xref>; <xref ref-type="bibr" rid="bib15">Haccou and Iwasa, 1995</xref>). However, in these previous models that more abstractly considered ‘phenotypic traits’, it was assumed that both the mean and variance of the phenotypic trait were not only directly encoded by the genotype but could also be independently altered through mutations, without explicitly considering how mean and variance would be encoded in the genotype. In our case, where the ‘trait’ under study is the transcription rate of a promoter, it is a priori quite clear how mutations may alter mean levels, for example, through changes in the affinity of the sigma-factor binding site, but much less clear how the variance is encoded in the genotype. Moreover, rather than simply increasing its noise, we would naturally expect that promoters would evolve gene regulation in order to deal with different required expression levels across different environments.</p><sec id="s8-1"><title>Including gene regulation</title><p>We now further extend the model by considering that there are various transcriptional regulators in the cell whose activities may vary across the different environments <italic>e</italic>. By evolving binding sites for a TF, the promoter becomes regulated by it and, consequently, the mean expression <italic>μ</italic> becomes a function <italic>μ</italic>(<italic>e</italic>) of the environment <italic>e</italic>.</p><p>For simplicity we first consider the case of a single regulator whose mean activity (i.e., concentration of the DNA-binding version of the regulator) <italic>r</italic><sub><italic>e</italic></sub> is a function of the environment <italic>e</italic>. Since the transcriptional regulator's expression will itself also be subject to gene expression noise, the activity of the regulator varies from cell to cell. We will assume that, in each environment, the activity of the regulator varies from cell to cell in a roughly Gaussian manner with variance <inline-formula><mml:math id="inf109"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, that is, the probability to find a cell in environment <italic>e</italic> with regulator level <italic>r</italic> is<disp-formula id="equ83"><label>(83)</label><mml:math id="m83"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mi>σ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We characterize the regulation of the promoter by the regulator through a single coupling constant <italic>c</italic> such that, in cells with regulator level <italic>r</italic>, the distribution of expression levels is a Gaussian with mean <italic>μ</italic> + <italic>cr</italic> and variance <italic>σ</italic><sup>2</sup>, that is,<disp-formula id="equ84"><label>(84)</label><mml:math id="m84"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:mi>σ</mml:mi></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Thus we assume the expression level of the target is a linear function of the activity of the regulator. Integrating over the distribution of regulator levels <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the final distribution of expression levels is given by a Gaussian with mean <italic>μ</italic>(<italic>e</italic>) = <italic>μ</italic> + <italic>cr</italic><sub><italic>e</italic></sub> and variance <inline-formula><mml:math id="inf111"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, that is,<disp-formula id="equ85"><label>(85)</label><mml:math id="m85"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In environment <italic>e</italic>, with desired level <italic>μ</italic><sub><italic>e</italic></sub>, the fitness of a promoter with coupling <italic>c</italic> is then given by<disp-formula id="equ86"><label>(86)</label><mml:math id="m86"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Finally, the log-fitness, averaged over all environments <italic>e</italic>, is given by<disp-formula id="equ87"><label>(87)</label><mml:math id="m87"><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>It is again easy to see that, with respect to the mean expression <italic>μ</italic>, fitness is optimized when <inline-formula><mml:math id="inf112"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In the following we will assume that the mean expression <italic>μ</italic> matches this optimal value.</p><p>We can rewrite the expression for the average log-fitness in a simpler form by introducing the following set of effective parameters. First, the variable<disp-formula id="equ88"><label>(88)</label><mml:math id="m88"><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>measures the variance in desired expression levels <italic>μ</italic><sub><italic>e</italic></sub> relative to the sum of the variances associated with the width of selection <italic>τ</italic><sup>2</sup> and the noise of the unregulated promoter <italic>σ</italic><sup>2</sup>. The variable <italic>Y</italic> quantifies the ‘expression mismatch’ between the promoter’s average expression <italic>μ</italic> and the (varying) desired expression levels <italic>μ</italic><sub><italic>e</italic></sub>. Notably, in the absence of coupling to a regulator, the log-fitness is −<italic>Y</italic><sup>2</sup>/2 + log[<italic>τ</italic><sup>2</sup>/(<italic>σ</italic><sup>2</sup> + <italic>τ</italic><sup>2</sup>)]/2, that is, the higher <italic>Y</italic><sup>2</sup>, the lower the fitness of the unregulated promoter.</p><p>The second effective parameter<disp-formula id="equ89"><label>(89)</label><mml:math id="m89"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>measures the strength of the regulator coupling constant <italic>c</italic>. More precisely, it quantifies the contribution <inline-formula><mml:math id="inf113"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> to the promoter's variance in gene expression, again relative to (<italic>σ</italic><sup>2</sup> + <italic>τ</italic><sup>2</sup>), that is, it measures the strength of the noise propagation. We will refer to <italic>X</italic> as the coupling constant. Third, the parameter<disp-formula id="equ90"><label>(90)</label><mml:math id="m90"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>measures the ‘signal-to-noise’ ratio of the regulator, that is, the variance var(<italic>r</italic><sub><italic>e</italic></sub>) of its mean level across conditions relative to its variance <inline-formula><mml:math id="inf114"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> within each condition. A regulator with large <italic>S</italic> varies a lot in activity across environments and has relatively little noise in each, whereas a regulator with small <italic>S</italic> varies little across environments relative to its noise level. Finally, we have the correlation <italic>R</italic> between the desired expression levels <italic>μ</italic><sub><italic>e</italic></sub> and the regulator's activities <italic>r</italic><sub><italic>e</italic></sub>, that is,<disp-formula id="equ91"><label>(91)</label><mml:math id="m91"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In terms of these parameters, we have for the average log-fitness<disp-formula id="equ92"><label>(92)</label><mml:math id="m92"><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>X</mml:mi><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mi>Y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The last term is a constant that does not depend on our effective parameters and we will ignore it from now on.</p><p>We intuitively expect that the promoter's fitness would benefit most from coupling to a regulator that is perfectly correlated with the environment's requirements, that is, at <italic>R</italic> = 1. Indeed, we find that the derivative log[<italic>f</italic>(<italic>X</italic>)] with respect to <italic>R</italic> is given by<disp-formula id="equ93"><label>(93)</label><mml:math id="m93"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which is positive as long as the desired levels vary (<italic>Y</italic> &gt; 0), the regulator has some variation across environments (<italic>S</italic> &gt; 0), and there is positive coupling (<italic>X</italic> &gt; 0). Thus, in general, if we keep all other variables fixed, an increase in the regulator's correlation <italic>R</italic> is always beneficial.</p><p>We now consider the case in which a regulator with a given correlation <italic>R</italic> and signal-to-noise rate <italic>S</italic> is given, and we want to determine the optimal coupling <italic>X</italic><sub>*</sub> that maximizes log[<italic>f</italic>(<italic>X</italic>, <italic>Y</italic>, <italic>S</italic>, <italic>R</italic>)]. The derivative of log[<italic>f</italic>(<italic>X</italic>, <italic>Y</italic>, <italic>S</italic>, <italic>R</italic>)] with respect to <italic>X</italic> is given by<disp-formula id="equ94"><label>(94)</label><mml:math id="m94"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>X</mml:mi><mml:msup><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>At <italic>X</italic> = 0, this derivative equals <italic>SR</italic>. Thus, whenever <italic>R</italic> &gt; 0, the derivative is positive at <italic>X</italic> = 0. Because, as can be easily seen from <xref ref-type="disp-formula" rid="equ94">Equation 94</xref>, the derivative is guaranteed to be negative for large <italic>X</italic>, this implies that, whenever <italic>R</italic> &gt; 0, there is an optimal coupling <italic>X</italic><sub>*</sub> that is positive, that is, <italic>X</italic><sub>*</sub> &gt; 0. Thus, whenever <italic>R</italic> &gt; 0, the promoter is guaranteed to increase its fitness by evolving a non-zero coupling to the regulator.</p><p>The optimal coupling <italic>X</italic><sub>*</sub> is given by the positive solution of the third order polynomial in the numerator of <xref ref-type="disp-formula" rid="equ94">Equation 94</xref>. In general we find that, when <italic>Y</italic> is small, the optimal coupling is given by<disp-formula id="equ95"><label>(95)</label><mml:math id="m95"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mi>Y</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and that, when <italic>Y</italic> is very large, <italic>X</italic><sub>*</sub> obeys<disp-formula id="equ96"><label>(96)</label><mml:math id="m96"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>∞</mml:mi></mml:msub><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>Y</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>That is, both for very small and very large <italic>Y</italic>, the optimal coupling <italic>X</italic><sub>*</sub> is directly proportional to <italic>Y</italic>, with proportionality constants <italic>α</italic><sub>0</sub> and <italic>α</italic><sub>∞</sub>, respectively. Moreover, <italic>α</italic><sub>∞</sub> ≥ <italic>α</italic><sub>0</sub>. The behavior of <italic>X</italic><sub>*</sub> as a function of <italic>Y</italic> for different values of <italic>R</italic> and <italic>S</italic> is illustrated in <xref ref-type="fig" rid="fig16">Appendix 3—figure 1</xref>.<fig id="fig16" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.028</object-id><label>Appendix 3—figure 1.</label><caption><title>The ratio <italic>X</italic><sub>*</sub>/<italic>Y</italic> between optimal coupling <italic>X</italic><sub>*</sub> and expression mismatch <italic>Y</italic> as a function of <italic>Y</italic>, for different values of the regulator's signal-to-noise ratio <italic>S</italic> and the correlation between regulator and environment <italic>R</italic>.</title><p>Each panel corresponds to a different signal-to-noise ratio <italic>S</italic>, from a high signal regulator in the top left to a noisy regulator at the bottom right. In each panel, the different colored lines correspond to different correlations <italic>R</italic>, that is, <italic>R</italic> = 0.01 (blue), <italic>R</italic> = 0.1 (green), <italic>R</italic> = 0.5 (orange), and <italic>R</italic> = 0.99 (red).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.028">http://dx.doi.org/10.7554/eLife.05856.028</ext-link></p></caption><graphic xlink:href="elife-05856-app3-fig1-v1.tif"/></fig></p><p>The figure shows that, as <italic>Y</italic> increases, the ratio <italic>X</italic><sub>*</sub>/<italic>Y</italic> switches from the lower <italic>α</italic><sub>0</sub> to the higher <italic>α</italic><sub>∞</sub>. Whenever both the correlation <italic>R</italic> and the signal-to-noise <italic>S</italic> are high (orange and red curves in the top two panels), there is only a small difference between <italic>α</italic><sub>0</sub> and <italic>α</italic><sub>∞</sub>, that is, <italic>X</italic><sub>*</sub> increases roughly linearly with <italic>Y</italic> when there is a well-correlated regulator with high signal-to-noise.</p><p>In contrast, when the correlation <italic>R</italic> is low or the regulator is noisy, there is a large difference between <italic>α</italic><sub>∞</sub> and <italic>α</italic><sub>0</sub>. Moreover, the optimal coupling shows a sharp transition from low values to much higher values at a ‘critical’ value of <italic>Y</italic>. This critical value of <italic>Y</italic> occurs at <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> when <italic>R</italic> is low (blue and green curves), and slightly earlier when <italic>R</italic> increases (orange and red curves). When the regulator is very noisy (bottom right panel of <xref ref-type="fig" rid="fig16">Appendix 3—figure 1</xref>) the behavior of <italic>X</italic><sub>*</sub> becomes almost independent of the correlation <italic>R</italic>, showing a sharp transition from almost no coupling to strong coupling when <italic>Y</italic> ≈ 1. This behavior even extends to the case where there is no correlation whatsoever between the regulator and the environment, that is, <italic>R</italic> = 0.</p></sec><sec id="s8-2"><title>Coupling to an uncorrelated regulator</title><p>When <italic>R</italic> = 0 the optimal coupling is given by<disp-formula id="equ97"><label>(97)</label><mml:math id="m97"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mtext>*</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>That is, at the critical value <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> the coupling goes from zero to a positive value. For large <italic>Y</italic>, the optimal coupling is simply <italic>Y</italic>. The behavior of optimal coupling <italic>X</italic><sub>*</sub> as a function of <italic>Y</italic> is shown in <xref ref-type="fig" rid="fig17">Appendix 3—figure 2</xref>.<fig id="fig17" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.029</object-id><label>Appendix 3—figure 2.</label><caption><title>Optimal coupling <italic>X</italic><sub>*</sub> to an uncorrelated regulator (<italic>R</italic> = 0) as a function of the expression mismatch <italic>Y</italic> for different values of the signal-to-noise ratio <italic>S</italic>, that is, <italic>S</italic> = 0 (black), <italic>S</italic> = 1 (green), <italic>S</italic> = 2 (blue), and <italic>S</italic> = 3 (red).</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.029">http://dx.doi.org/10.7554/eLife.05856.029</ext-link></p></caption><graphic xlink:href="elife-05856-app3-fig2-v1.tif"/></fig></p></sec><sec id="s8-3"><title>Log-fitness at optimal coupling <italic>X</italic><sub>*</sub></title><p>We next consider the case in which the promoter has a certain expression mismatch <italic>Y</italic>, and we calculate the log-fitness that it can obtain by optimally coupling to a regulator that has a certain signal-to-noise <italic>S</italic> and correlation <italic>R</italic>. <xref ref-type="fig" rid="fig18">Appendix 3—figure 3</xref> shows the resulting log-fitness values as a function of <italic>S</italic> and <italic>R</italic> for four different values of the expression mismatch <italic>Y</italic>: <italic>Y</italic> = 1 in the top left panel, <italic>Y</italic> = 2 in the top right panel, <italic>Y</italic> = 4 in the bottom left panel, and <italic>Y</italic> = 8 in the bottom right panel.<fig id="fig18" position="float"><object-id pub-id-type="doi">10.7554/eLife.05856.030</object-id><label>Appendix 3—figure 3.</label><caption><title>Log-fitness as a function of the signal-to-noise ratio <italic>S</italic> (horizontal axis) and correlation <italic>R</italic> of the regulator (vertical axis) for a promoter that is optimally coupled (<italic>X</italic> = <italic>X</italic><sub>*</sub>) to the regulator.</title><p>The different panels correspond to log-fitnesses that are obtained for different values of the expression mismatch <italic>Y</italic> (indicated in the title of each panel). The contours run from −0.04 to −0.5 in the top left panel, from −0.3 to −1.9 in the top right panel, from −1 to −12 in the bottom left panel, and from −2 to −30 in the bottom right panel. The red curves show optimal signal-to-noise <italic>S</italic> as a function of the correlation <italic>R</italic>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05856.030">http://dx.doi.org/10.7554/eLife.05856.030</ext-link></p></caption><graphic xlink:href="elife-05856-app3-fig3-v1.tif"/></fig></p><p>When the expression mismatch is small, that is, <italic>Y</italic> = 1 corresponding to a variance var(<italic>μ</italic><sub><italic>e</italic></sub>) that matches <italic>σ</italic><sup>2</sup> + <italic>τ</italic><sup>2</sup>, then fitness generally increases with increasing <italic>R</italic> and <italic>S</italic>. However, the absolute value of the fitness increase is small, that is, for small <italic>Y</italic>, promoters already have reasonably high fitness without regulation. As the value of <italic>Y</italic> increases, the log-fitness values start varying more dramatically as a function of <italic>R</italic> and <italic>S</italic>. Independent of the value of <italic>Y</italic>, the optimal fitness is always obtained for very high <italic>R</italic> and high <italic>S</italic>. In this regime the regulators are very accurate (high <italic>S</italic>) and correlate very well with the desired expression levels of the promoters (high <italic>R</italic>). In this regime the noise-propagation is very small and the condition-response effect of the regulator is high, that is, as expected, the most optimal solution is a very accurate regulation in which all benefits of the regulation stem from the condition-response effect. However, when <italic>Y</italic> is large, an almost equally high fitness can be obtained by coupling to a ‘noisy’ regulator with low <italic>S</italic> and <italic>R</italic> = 0 in the bottom left of the plots. In this regime the condition-response effect is small and noise-propagation is large, and the benefits of the regulatory interaction stem solely from the noise-propagation, that is, by coupling to the noisy regulator a bet hedging strategy is implemented. Notably, when <italic>Y</italic> is large, only regulators with very high correlation <italic>R</italic> and large signal-to-noise <italic>S</italic> can outcompete coupling to an entirely noisy regulator with <italic>R</italic> = 0 and small <italic>S</italic>; that is, to outcompete noise-propagation, the condition-response effect has to be highly accurate. In other words, unless a regulator is available that very precisely regulates the promoter to attain its desired expression levels, best fitness can often be obtained through noise-propagation.</p><p>Note also that, whenever <italic>Y</italic> is larger than 1 and the correlation <italic>R</italic> is not very high, fitness generally decreases rapidly with the signal-to-noise of the regulator; that is, when a regulator has only moderate correlation with the desired expression levels of its target, low signal-to-noise is preferred. This suggests that regulators that are regulating targets whose desired expression levels correlate only moderately with the regulator's activity may be under selection for <italic>lowering</italic> their signal-to-noise ratios.</p><p>To illustrate the selection on the signal-to-noise level of the regulator, the red curves in <xref ref-type="fig" rid="fig18">Appendix 3—figure 3</xref> show the optimal signal-to-noise <italic>S</italic><sub>*</sub> as a function of the correlation <italic>R</italic>. To the left of these lines the signal-to-noise is too low, that is, the regulator is too noisy, and fitness can be increased making the regulator more accurate. In this regime the noise-propagation is a detrimental side-effect of the regulatory interaction. For each value of <italic>Y</italic> there is a critical value of <italic>R</italic> where the optimal signal-to-noise <italic>S</italic><sub>*</sub> diverges. Above this critical value of <italic>R</italic> the noise-propagation is always detrimental. However, unless <italic>Y</italic> is close to 1, this critical value of <italic>R</italic> is generally very high.</p><p>To the right of the red curves in <xref ref-type="fig" rid="fig18">Appendix 3—figure 3</xref> the accuracy of the regulator is too high for its correlation <italic>R</italic>, and fitness could be improved by increasing the noise of the regulator. In this regime the noise-propagation is not large enough. Interestingly, the red curve thus corresponds to a continuum of regulatory strategies where the condition-response and noise-propagation are optimally acting in concert. This suggests a plausible scenario for evolving accurate regulation de novo from a state without regulation. Initially, a promoter can couple to a noisy regulator whose activities do not correlate at all with the desired expression levels of the promoters. Due to the noise-propagation, this coupling may already be beneficial. Once the regulatory interaction exists, the coupling strength, the activity profile of the regulator, and its noise level can be slowly mutated so as to increase both the correlation <italic>R</italic> and signal-to-noise <italic>S</italic> along the red curve, leading finally to accurate regulation where the condition-response effect dominates.</p><p>These considerations also suggest different possible scenarios for the joint evolution of multiple promoters and their regulators. On the one hand, when a regulator is coupled to a single promoter or a set of promoters whose desired expression levels are perfectly correlated across environments, it can increase overall fitness by increasing the correlation <italic>R</italic> between the regulator's activities and the desired expression levels of its targets. In this way, regulation may evolve to become more precise over time. On the other hand, promoters may often have an incentive to couple to regulators that only moderately correlate with their desired levels. Once a regulator is coupled to multiple promoters that have different desired expression levels, there is no way that the regulator can adapt its activities to correlate highly with the desired levels of all its targets, and such regulators will experience selection to become more noisy.</p></sec><sec id="s8-4"><title>Final noise levels under optimal coupling and signal-to-noise</title><p>We next consider what final noise levels <inline-formula><mml:math id="inf117"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>tot</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> result when a promoter, with a certain expression mismatch <italic>Y</italic>, couples optimally to a regulator which has a certain correlation <italic>R</italic>, and whose signal-to-noise level has been optimized as well.</p><p>To this end we need to determine the jointly optimal coupling <italic>X</italic><sub>*</sub> and signal-to-noise <italic>S</italic><sub>*</sub> given a certain expression mismatch <italic>Y</italic> and correlation <italic>R</italic>. From <xref ref-type="disp-formula" rid="equ92">Equation 92</xref> it is easy to see that fitness is maximized with respect to the signal-to-noise level <italic>S</italic> when<disp-formula id="equ98"><label>(98)</label><mml:math id="m98"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mtext>*</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>Y</mml:mi></mml:mrow><mml:mi>X</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>If we substitute this value back into <xref ref-type="disp-formula" rid="equ92">Equation 92</xref>, we find that the optimal coupling <italic>X</italic><sub>*</sub> is now given by<disp-formula id="equ99"><label>(99)</label><mml:math id="m99"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mtext>*</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Note that <italic>Y</italic><sup>2</sup> is the variation in desired expression levels and <italic>R</italic><sup>2</sup><italic>Y</italic><sup>2</sup> is the amount of this variation that the condition-response effect manages to ‘track’ when the promoter is coupled to the regulator. Thus, (1 − <italic>R</italic><sup>2</sup>)<italic>Y</italic><sup>2</sup> is precisely the remaining variance in desired expression levels that the condition-response is unable to track. To bring this out more clearly, we substitute back our original parameters. We then find that when (1 − <italic>R</italic><sup>2</sup>)<italic>Y</italic><sup>2</sup> &lt; 1:<disp-formula id="equ100"><label>(100)</label><mml:math id="m100"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>tot</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and when (1 − <italic>R</italic><sup>2</sup>)<italic>Y</italic><sup>2</sup> &gt; 1:<disp-formula id="equ101"><label>(101)</label><mml:math id="m101"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>tot</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This brings out most clearly that, when the regulation is imprecise ((1 − <italic>R</italic><sup>2</sup>)<italic>Y</italic><sup>2</sup> &gt; 1), the final noise level that is evolved matches the fraction of the variance in desired expression levels var(<italic>μ</italic><sub><italic>e</italic></sub>) that is not tracked by the condition-response. In other words, the evolved transcriptional noise level of a promoter precisely reflects to what extent the promoter's regulation is not able to track the expression levels desired by the environment.</p><p><xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> shows the total noise level <italic>σ</italic><sub>tot</sub> as a function of <italic>Y</italic> and <italic>R</italic> when the promoter is optimally coupled to a regulator with optimal signal-to-noise. The figure illustrates that there are two regimes of solutions (‘phases’) separated by a phase boundary (thick black curve) that occurs at (1 − <italic>R</italic><sup>2</sup>)<italic>Y</italic><sup>2</sup> = 1. On one side of this boundary, in the top left of the figure, the final noise level <italic>σ</italic><sub>tot</sub> is essentially not different from the original noise level <italic>σ</italic>. This occurs either when <italic>Y</italic> &lt; 1, that is, when no regulation is necessary, or when very accurate regulation is available. Note that, similarly to what we saw in the last section, very high correlations <italic>R</italic> are necessary to realize this regime at larger values of <italic>Y</italic>. We call this the ‘basal noise regime’.</p><p>The largest part of the parameter space occurs on the other side of the phase boundary, which we call the ‘environment-driven noise regime’. Here the final noise level <italic>σ</italic><sub>tot</sub> becomes independent of the original noise <italic>σ</italic>, but is instead determined by the fraction of variation in desired expression levels var(<italic>μ</italic><sub><italic>e</italic></sub>) that is not tracked by the condition-response, that is, by (1 − <italic>R</italic><sup>2</sup>) var(<italic>μ</italic><sub><italic>e</italic></sub>). The figure also indicates the optimal values of <italic>S</italic><sub>*</sub> as a function of <italic>Y</italic> and <italic>R</italic>. The optimal signal-to-noise <italic>S</italic><sub>*</sub> diverges at the phase boundary, that is, in the basal noise regime, regulators are preferred with signal-to-noise that is as high as possible. In contrast, for the majority of the parameter space in the environment-driven noise regime, signal-to-noise levels of 1 or less are preferred, that is, unless regulation is very precise, noisy regulators are typically preferred over precise regulators.</p><p>The figure also demonstrates that, unless <italic>R</italic> is close to 1, the final noise increases with the variance in desired expression levels var(<italic>μ</italic><sub><italic>e</italic></sub>). Thus, unless there is a systematic correlation between the expression mismatch <italic>Y</italic> of a promoter and the correlation of the regulator with highest available correlation, noise levels are expected to increase with the ‘plasticity’ var(<italic>μ</italic><sub><italic>e</italic></sub>) that the environment requires of the promoters.</p><p>Similarly, the larger <italic>Y</italic>, the larger the remaining variance Y′<sup>2</sup> = (1 − <italic>R</italic><sup>2</sup>)<italic>Y</italic><sup>2</sup> tends to be after coupling to the regulator with the highest available correlation <italic>R</italic>. Whenever this remaining expression mismatch is <italic>Y</italic>′ large, the promoter will have an incentive to couple to further regulators, that is, the theory also generally predicts that promoters with high var(<italic>μ</italic><sub><italic>e</italic></sub>) tend to couple to more regulators.</p><p>Finally, we note that this theoretical model can easily be extended to the case of multiple promoters and regulators. In particular, because in our model the promoter's expression is a linear function of the regulatory inputs, the theory extends easily to promoters coupling to multiple regulators with different coupling constants. However, the regulatory network structure that will evolve in this general case will depend crucially on the correlation structure of the desired expression levels across all the promoters. Moreover, there might be many environmental changes that affect the optimal expression levels but that cannot be sensed by any of the regulators, and this will constrain the extent to which regulators can optimize their activities to match the desired levels of their targets. We intend to pursue such analyses in future work.</p></sec></sec></boxed-text></app></app-group></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.05856.031</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Golding</surname><given-names>Ido</given-names></name><role>Reviewing editor</role><aff><institution>Baylor College of Medicine</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see <ext-link ext-link-type="uri" xlink:href="http://elifesciences.org/review-process">review process</ext-link>). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers.</p></boxed-text><p>Thank you for sending your work entitled “Expression noise facilitates the evolution of gene regulation” for consideration at <italic>eLife</italic>. Your article has been favorably evaluated by Aviv Regev (Senior editor), a guest Reviewing editor, and two reviewers.</p><p>The Reviewing editor and the reviewers discussed their comments before we reached this decision, and the Reviewing editor has assembled the following comments to help you prepare a revised submission:</p><p>We all thought that the subject matter of the work was very timely, and the findings interesting. There were, however, a number of significant flaws that need to be addressed before publication is considered.</p><p>1) After more than a decade of intensive research, there has been significant progress towards a biophysical, molecular understanding of the mechanisms leading to transcription noise. See e.g. the review by Sanchez and Golding (Science 2013), and more recent work in <italic>E. coli</italic> from the Xie (Cell 2014) and Phillips (Science 2014) labs. In its current form, the authors' work appears largely disconnected from our current mechanistic understanding of transcription noise: How does this understanding motivate the work? How does it affect the interpretation of the experimental results? How does it motivate the theoretical model and its interpretation?</p><p>2) A possibly related flaw is the rather weak connection between the experiments and theoretical model. First, the model itself should be described in some more detail in the main text. But more crucially: How does the model help interpret the experiments? Can any kind of quantitative comparison be made between the two sets of results?</p><p>3) More care must be taken when defining and discussing “transcription noise”. In the current work, neither transcription kinetics (e.g. using MS2-GFP) nor mRNA statistics (using single-molecule FISH) are directly measured, but instead a protein (GFP) reporter is used. Thus, interpreting the measured variability as “transcription noise” involves important caveats (see e.g. Paulsson, Nature 2004; Pedraza and Paulsson, Science 2008). These need to be explicitly discussed.</p><p>4) In multiple places, the authors make very strong statements, which require additional evidence to support them or otherwise need to be reworded. Examples:</p><p>“Many studies have used <italic>circumstantial evidence</italic> to suggest that selection generally acts to minimize noise […] there is <italic>empirical evidence</italic> that selection has acted to increase expression noise in some cases” (Introduction). What makes the former studies merely “circumstantial” while the latter rise to the level of “empirical”?</p><p>“Whenever fluctuations are small relative to the mean, which applies to most promoters” (Results). No reference is given to support this statement.</p><p>“We concluded that constitutively expressed <italic>E. coli</italic> promoters exhibit low excess noise levels by default” (Results). How was this conclusion reached? In particular, what is a “constitutive promoter” (or “unregulated promoter”, as mentioned later in the same section of the manuscript)? All known promoters in <italic>E. coli</italic> are regulated by multiple parameters: growth rate, nutritional state, temperature, etc. So how can a specific promoter be “constitutive”/“unregulated”?</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.05856.032</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>1) After more than a decade of intensive research, there has been significant progress towards a biophysical, molecular understanding of the mechanisms leading to transcription noise. See e.g. the review by Sanchez and Golding (Science 2013), and more recent work in</italic> E. coli <italic>from the Xie (Cell 2014) and Phillips (Science 2014) labs. In its current form, the authors' work appears largely disconnected from our current mechanistic understanding of transcription noise: How does this understanding motivate the work? How does it affect the interpretation of the experimental results? How does it motivate the theoretical model and its interpretation</italic>?</p><p>We agree with the reviewers that, for the sake of succinctness, we left out a discussion of the current understanding of mechanisms causing expression noise. To better put our work into context, we have now included such a discussion in the Introduction and cited some of the works the reviewers mention.</p><p>As the reviewers point out, there is by now a large literature on the molecular mechanisms involved in gene expression noise, and since we obviously cannot give a comprehensive overview of this literature, we focused on the points that are most relevant for our work. Briefly, from a mechanistic perspective, it is well accepted that, because a given promoter is only present in one or a few copies within a single cell, and because all molecules in the cell are subject to Brownian motion and thermal fluctuations, the sequence of transcription initiation events from a given promoter is inherently stochastic. In the simplest scenario both transcription initiation and mRNA decay occur at a constant probability per unit time, leading to a Poissonian distribution of transcript numbers, with variance equal to mean. However, many promoters have been shown to exhibit variance in expression that is larger than their mean, which is generally quantified using the Fano factor (ratio of variance to mean). Moreover, this Fano factor has been shown to vary significantly across different promoters. Mechanistically, this additional noise is generally understood to arise from promoters stochastically switching between different ‘states'. In the simplest models, there is only an ‘on’ and an ‘off’ state, with promoters producing bursts of transcripts in the ‘on’ state only (indeed some authors simply identify the Fano factor with ‘burst size’). However, Fano factors larger than one result whenever promoters switch stochastically between different states that have different transcription rates associated with them. Such general state changes are likely associated with events such as the binding and unbinding of different transcription factors, local changes to the state of the chromatin, and so on. Moreover, since the concentrations of TFs may vary from cell to cell, the rates of switching between different states may vary from cell to cell as well. Thus, these mechanistic considerations suggest that the level of transcriptional noise may, at least to some extent, be encoded in the sequence of the promoter. Indeed, several recent works have established this to be the case. Consequently, transcriptional noise is thus subject to evolution through natural selection, and the main question that we set out to investigate in this work is how selection has shaped noise properties of promoters.</p><p>In summary, the current understanding of the mechanisms underlying transcriptional noise are very much in line with our interpretation of the results presented in the paper: different promoter sequences may lead to different levels of transcriptional noise because they contain different sets of binding sites for regulatory proteins. Indeed as we were performing this work, several works appeared that provide further support that regulatory sites in promoters are important contributors to transcription noise (e.g. <xref ref-type="bibr" rid="bib16">Hornung et al., 2012</xref>; <xref ref-type="bibr" rid="bib17">Jones et al., 2014</xref>; <xref ref-type="bibr" rid="bib32">Sharon et al., 2014</xref>), which we now also cite in the text.</p><p><italic>2) A possibly related flaw is the rather weak connection between the experiments and theoretical model. First, the model itself should be described in some more detail in the main text. But more crucially: How does the model help interpret the experiments? Can any kind of quantitative comparison be made between the two sets of results</italic>?</p><p>We agree with the reviewers that the presentation of the theoretical model was rather terse and we have in the revision substantially expanded on the details of the theoretical model in the main text, including also the main analytical result illustrated in <xref ref-type="fig" rid="fig4">Figure 4</xref>. We also expanded the description of the model in the Materials and methods section.</p><p>Most importantly, we have altered the presentation to better explain how precisely our model helps interpret the results of our experiments. The general structure of our presentation is to first summarize the main experimental observations that we want to explain: Natural selection must have acted to increase the noise levels of a substantial fraction of <italic>E. coli</italic> promoters, and the promoters with elevated noise are generally characterized by being highly regulated, i.e. having known regulatory sites and showing higher expression plasticity across conditions. We note that this general association between high transcriptional noise and gene regulation has now been observed in several studies.</p><p>After this, we review the explanations that have been proposed to account for selection for noise, on the one hand, and for the general association between noise and regulation, on the other hand. We review theoretical work arguing that increased phenotypic variability can act as a beneficial ‘bet hedging’ strategy, but point out that this interpretation fails to explain the association between noise and regulation. On the other hand, a plausible argument has been made that increased noise may be an unavoidable side-effect of regulation, i.e. due to unavoidable noise-propagation, but this is generally thought to be a detrimental effect, and does not explain our observation that selection acted to increase noise levels rather than to minimize them.</p><p>We then go on to present our general model, and explain how it clarifies these apparently contradicting observations. In particular, the model clarifies that the effects of coupling a promoter to a regulator can be usefully decomposed into a condition-response effect, whereby the mean levels of the promoter become dependent on the mean levels of the regulator, and a noise-propagation effect, whereby the noise of the promoter is increased due to noise in the regulator. The key insights that our model provides is that both of these effects can be beneficial, and that there is a continuum of possible regulatory strategies in which these two effects act in concert, varying from strategies in which all benefits come from the noise-propagation effect, to strategies where all benefits derive from the condition-response effect. In this way, our model clarifies that apparently complementary explanations such as ‘noise as a side-effect of regulation’ versus ‘noise selected as a bet hedging strategy’, are really just different parameter regimes within one unified theoretical frame work.</p><p>Finally, we return to our experimental observations, and discuss how the model helps explain them. First, we note that it would be very difficult to make quantitative predictions about what precise levels of noise would be expected for which promoters in which conditions, because this would depend on the details of how gene expression fluctuations affect fitness in different environments in the wild, which are almost impossible to know at this point. However, the model does explain the general trends observed in our <xref ref-type="fig" rid="fig2">Figure 2</xref>. In particular, we now discuss in some detail why our model predicts that positive correlations should be expected both between noise and the number of regulatory inputs, as well as between noise and expression plasticity.</p><p>Finally, a key assumption of our model is that elevated noise levels are, at least to some extent, the result of noise-propagation, i.e. the noise level of a promoter is determined by the noise levels of the regulators that regulate it. In the revision we now present a simple computational model that models the noise of a promoter as a linear function of the noise levels of the regulators that are known to target the promoter. We show that this model, although very crude, can explain a substantial fraction of the variation in observed noise levels. This simple model also identifies which TFs are most strongly contributing to noise levels, and we briefly discuss that the ‘noisy TFs’ that we identify are consistent with the biology of the growth conditions in which our experiments were done.</p><p><italic>3) More care must be taken when defining and discussing</italic> “<italic>transcription noise”. In the current work, neither transcription kinetics (e.g. using MS2-GFP) nor mRNA statistics (using single-molecule FISH) are directly measured, but instead a protein (GFP) reporter is used. Thus, interpreting the measured variability as</italic> “<italic>transcription noise” involves important caveats (see e.g. Paulsson, Nature 2004; Pedraza and Paulsson, Science 2008). These need to be explicitly discussed</italic>.</p><p>We agree with the reviewers that we did not discuss this point in sufficient detail and have expanded the discussion of this issue in the revision. In particular, the discussion that we added in the revision covers the following points. First, we note that the reporter constructs we use were designed with the aim of measuring transcriptional noise, i.e. attempts were made to miminize the variation in the translation rates, the mRNA life-time distributions of the constructs, and the protein decay rates. Regarding the latter, since the GFP protein is long-lived, the protein decay is dominated by dilution, which, since all constructs show virtually identical growth rates, are virtually identical for all constructs.</p><p>Regarding variation in translation and mRNA decay, we note that the only difference be-tween the constructs is the promoter sequence fused upstream of GFP. As a result, the mRNAs transcribed from different constructs vary only in the few nucleotides between the TSS and the insertion site. In addition, downstream of the insertion site, is a fixed 5' UTR with a strong ribosomal binding site, intended to ensure similar translation rates of all constructs. To confirm that translation rates vary little across the constructs we performed qPCR experiments that show a high correlation between protein and mRNA levels. Since dilution/decay rates of proteins are constant, this implies that translation rates indeed vary little across the constructs, as we detail in <xref ref-type="app" rid="app1">Appendix 1</xref>. Although we did not directly measure the variation in mRNA decay rates across the constructs, the fact that the mRNAs only vary in the initial few nucleotides downstream of TSS, and the fact that these variations do not appear to significantly affect translation rates, suggest that the variations in mRNA decay rates are likely also modest.</p><p>Together these observations suggest that the observed large differences in GFP number fluctuations result mostly from transcriptional noise. This is not to say that other fluctuations do not contribute to the noise, indeed all constructs are subject to noise in translation, to fluctuations in growth rates, to fluctuations in the copy number of the plasmid, and so on. However, these all contribute the same amount of noise for each construct. Indeed, we observe a fixed minimal amount of extrinsic noise that is exhibited by all our constructs. However, the differences in the noise levels across constructs are most likely due to differences in transcriptional noise, for the reasons given above. The fact that there is a very significant association between noise level and the occurrence of binding sites for particular TFs further supports this interpretation.</p><p><italic>4) In multiple places, the authors make very strong statements, which require additional evidence to support them or otherwise need to be reworded. Examples</italic>:</p><p>“<italic>Many studies have used</italic> circumstantial evidence <italic>to suggest that selection generally acts to minimize noise […] there is</italic> empirical evidence <italic>that selection has acted to increase expression noise in some cases” (Introduction). What makes the former studies merely</italic> “<italic>circumstantial” while the latter rise to the level of</italic> “<italic>empirical</italic>”<italic>?</italic></p><p>We agree this was not clear and have added clarification as to what precisely these studies show, i.e. showing association between noise and proxies for organismal fitness (which we called ‘circumstantial’), versus showing a causal relationship between noise and growth (which we called ‘empirical’).</p><p>“<italic>Whenever fluctuations are small relative to the mean, which applies to most promoters” (Results). No reference is given to support this statement</italic>.</p><p>We have now clarified this. Our own results show that, for the large majority of promoters, the fluctuations are small relative to the mean (which manifests itself as the variance in log-scale being clearly less than 1, i.e. as shown in <xref ref-type="fig" rid="fig1">Figure 1D</xref>).</p><p>“<italic>We concluded that constitutively expressed</italic> E. coli <italic>promoters exhibit low excess noise levels by default” (Results). How was this conclusion reached? In particular, what is a</italic> “<italic>constitutive promoter” (or</italic> “<italic>unregulated promoter”, as mentioned later in the same section of the manuscript)? All known promoters in</italic> E. coli <italic>are regulated by multiple parameters: growth rate, nutritional state, temperature, etc. So how can a specific promoter be</italic> “<italic>constitutive”/</italic>“<italic>unregulated</italic>”<italic>?</italic></p><p>Although the term ‘constitutive promoter’ is commonly used in the field, we agree with the reviewers that it is often not clearly defined what precisely is meant with the term, and we are here also guilty of being vague about the term. We now realize our statement in fact confounded two separate issues that we have now tried to separate more clearly in the revision. First, and most importantly, our experiments show that promoters which were only selected to show a particular (constant) expression level in one given condition, without selecting on their noise properties, and starting from completely random sequence, naturally exhibit low noise. This is what we mean when we say that promoters have low noise ‘by default’. Second, our analysis of the noise levels of the native promoters shows that native promoters that have no known regulatory sites beyond the sigma-factor binding site of the polymerase, also tend to show low noise levels. This is what we call ‘constitutive’ promoters, i.e. not regulated by specific TFs. In the revision these points have been clarified.</p></body></sub-article></article>