<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">16231</article-id><article-id pub-id-type="doi">10.7554/eLife.16231</article-id><article-categories><subj-group subj-group-type="heading"><subject>Cell Biology</subject></subj-group><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Stacking the odds for Golgi cisternal maturation</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-54226"><name><surname>Mani</surname><given-names>Somya</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-12053"><name><surname>Thattai</surname><given-names>Mukund</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2558-6517</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Simons Centre for the Study of Living Machines, National Centre for Biological Sciences</institution>, <institution>Tata Institute of Fundamental Research</institution>, <addr-line><named-content content-type="city">Bangalore</named-content></addr-line>, <country>India</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Glick</surname><given-names>Benjamin S</given-names></name><role>Reviewing editor</role><aff id="aff2"><institution>The University of Chicago</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>thattai@ncbs.res.in</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>19</day><month>08</month><year>2016</year></pub-date><pub-date pub-type="collection"><year>2016</year></pub-date><volume>5</volume><elocation-id>e16231</elocation-id><history><date date-type="received"><day>20</day><month>03</month><year>2016</year></date><date date-type="accepted"><day>18</day><month>08</month><year>2016</year></date></history><permissions><copyright-statement>© 2016, Mani et al</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Mani et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-16231-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.16231.001</object-id><p>What is the minimal set of cell-biological ingredients needed to generate a Golgi apparatus? The compositions of eukaryotic organelles arise through a process of molecular exchange via vesicle traffic. Here we statistically sample tens of thousands of homeostatic vesicle traffic networks generated by realistic molecular rules governing vesicle budding and fusion. Remarkably, the plurality of these networks contain chains of compartments that undergo creation, compositional maturation, and dissipation, coupled by molecular recycling along retrograde vesicles. This motif precisely matches the cisternal maturation model of the Golgi, which was developed to explain many observed aspects of the eukaryotic secretory pathway. In our analysis cisternal maturation is a robust consequence of vesicle traffic homeostasis, independent of the underlying details of molecular interactions or spatial stacking. This architecture may have been exapted rather than selected for its role in the secretion of large cargo.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16231.001">http://dx.doi.org/10.7554/eLife.16231.001</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>Golgi apparatus</kwd><kwd>cisternal maturation</kwd><kwd>vesicle traffic</kwd><kwd>Boolean models</kwd><kwd>statistical cell biology</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution>Wellcome Trust-DBT India Alliance</institution></institution-wrap></funding-source><award-id>Intermediate Fellowship 500103/Z/09/Z</award-id><principal-award-recipient><name><surname>Thattai</surname><given-names>Mukund</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A screen of tens of thousands of vesicle traffic networks in silico shows that Golgi-like cisternal maturation is a natural outcome of vesicle traffic homeostasis.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The cisternal maturation model is a hypothesis about how the Golgi apparatus works (<xref ref-type="bibr" rid="bib11">Emr et al., 2009</xref>; <xref ref-type="bibr" rid="bib23">Luini, 2011</xref>; <xref ref-type="bibr" rid="bib15">Glick and Luini, 2011</xref>). It posits that secretory cargo travel in cisternal compartments that slowly mature from the <italic>cis</italic>-Golgi to the <italic>trans</italic>-Golgi composition. This is driven by three processes. (1) New <italic>cis</italic>-cisternae are created by the homotypic fusion of ER-derived COPII vesicles at the ER-Golgi intermediate compartment (ERGIC) (<xref ref-type="bibr" rid="bib33">Nakano and Luini, 2010</xref>). (2) Old <italic>trans</italic>-cisternae dissipate by the vesiculation of the trans-Golgi network (TGN) into Golgi-to-surface carriers (<xref ref-type="bibr" rid="bib2">Bard and Malhotra, 2006</xref>; <xref ref-type="bibr" rid="bib8">De Matteis and Luini, 2008</xref>). (3) Golgi-resident proteins are recycled along retrograde vesicles, including COPI vesicles, moving from older to younger cisternae (<xref ref-type="bibr" rid="bib34">Papanikou et al., 2015</xref>). Similar processes govern the maturation of endosomes in the endocytic pathway (<xref ref-type="bibr" rid="bib37">Rink et al., 2005</xref>; <xref ref-type="bibr" rid="bib35">Poteryaev et al., 2010</xref>; <xref ref-type="bibr" rid="bib17">Huotari and Helenius, 2011</xref>).</p><p>Cisternal maturation allows cells to process and secrete large cargo (<xref ref-type="bibr" rid="bib33">Nakano and Luini, 2010</xref>). However, large secretory cargo would be impossible without a fully developed cisternal maturation mechanism in the first place. Exaptation can resolve this evolutionary Catch-22 paradox: if a complex trait arose in stages through neutral or non-adaptive processes, it could later be co-opted for new cellular functions (<xref ref-type="bibr" rid="bib25">Lynch, 2007a</xref>). Such a mechanism explains the origins of complex eukaryotic features such as splicing, transcriptional feedback loops, and multi-subunit protein complexes (<xref ref-type="bibr" rid="bib24">Lynch and Conery, 2003</xref>; <xref ref-type="bibr" rid="bib26">Lynch, 2007b</xref>; <xref ref-type="bibr" rid="bib12">Fernández and Lynch, 2011</xref>). Here we extend this idea beyond genomes, transcriptomes and proteomes, to eukaryotic membrane organization: we demonstrate that cisternal maturation is a near-inevitable consequence of the basic processes of vesicle traffic and cellular homeostasis, prior to any selection for function. The architecture of the Golgi could therefore have arisen non-adaptively, enabling the subsequent development of large-cargo secretion. Our results refute the Catch-22 and provide a strong evolutionary foundation for the cisternal maturation model, reinforcing the wealth of cell-biological evidence in its favor across multiple cellular contexts (<xref ref-type="bibr" rid="bib4">Bonfanti et al., 1998</xref>; <xref ref-type="bibr" rid="bib22">Losev et al., 2006</xref>; <xref ref-type="bibr" rid="bib28">Matsuura-Tokita et al., 2006</xref>).</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>From molecular rules to vesicle traffic</title><p>We set out to understand how molecular specificity and molecular exchange combined to determine the structure of a vesicle traffic network. Endomembrane vesicles and compartments are dynamically generated and maintained through specific molecular interactions (<xref ref-type="bibr" rid="bib32">Munro, 2004</xref>). Coats and adaptors drive vesicle cargo loading and budding (<xref ref-type="bibr" rid="bib5">Bonifacino and Lippincott-Schwartz, 2003</xref>; <xref ref-type="bibr" rid="bib38">Robinson, 2004</xref>; <xref ref-type="bibr" rid="bib41">Traub, 2009</xref>). Tethers and SNAREs regulate vesicle transport and fusion (<xref ref-type="bibr" rid="bib46">Yu and Hughson, 2010</xref>; <xref ref-type="bibr" rid="bib19">Jahn and Scheller, 2006</xref>; <xref ref-type="bibr" rid="bib44">Wickner and Schekman, 2008</xref>). GTPases of the Arf and Rab families coordinate these events via regulatory cascades (<xref ref-type="bibr" rid="bib7">D'Souza-Schorey and Chavrier, 2006</xref>; <xref ref-type="bibr" rid="bib39">Stenmark, 2009</xref>). Vesicle exchange necessarily causes changes to source and target compartments, whose compositions are determined as an outcome of molecular gain and loss. This feedback underpins the complexity of vesicle traffic networks.</p><p>Previous mathematical analyses of vesicle traffic have used stochastic frameworks or continuous differential equations, and included such details as compartment size, location and chemical composition (<xref ref-type="bibr" rid="bib16">Heinrich and Rapoport, 2005</xref>; <xref ref-type="bibr" rid="bib3">Binder et al., 2009</xref>; <xref ref-type="bibr" rid="bib10">Dmitrieff and Sens, 2011</xref>; <xref ref-type="bibr" rid="bib9">Dmitrieff et al., 2013</xref>; <xref ref-type="bibr" rid="bib36">Ramadas and Thattai, 2013</xref>). These approaches require a large number of quantitative kinetic parameters to analyze even simple systems with a few molecules and compartments, and are not suited to explore cell-wide vesicle traffic networks. Here we are primarily interested in cell-wide homeostatic network topologies. We have previously shown (<xref ref-type="bibr" rid="bib36">Ramadas and Thattai, 2013</xref>) that topological features of a vesicle traffic network – the number of compartments and their connectivity – are robustly determined by qualitative molecular specificity rather than quantitative kinetics. We therefore formalize the properties of vesicle traffic using a Boolean framework (<xref ref-type="bibr" rid="bib27">Mani and Thattai, 2016</xref>): we approximate molecular specificities and compartment compositions by a series of 1 s and 0 s (Materials and methods: The Boolean vesicle traffic model). We assume the cytoplasm is well mixed, and do not consider spatial organization; we are agnostic to the relative amounts of molecules on each vesicle, the size of vesicles and compartments, and the quantitative kinetic flux of vesicles between compartments. Boolean models have been successfully applied to transcriptional and signaling networks (<xref ref-type="bibr" rid="bib20">Kauffman et al., 2003</xref>; <xref ref-type="bibr" rid="bib21">Li et al., 2004</xref>; <xref ref-type="bibr" rid="bib6">Chaves et al., 2005</xref>); but have not previously been used to study vesicle traffic. Our Boolean approach allows us to efficiently sample a large space of cell-biological rules, and produces results that are qualitatively similar to more detailed microscopic vesicle traffic models (<xref ref-type="fig" rid="fig1">Figure 1G,H</xref>; <xref ref-type="box" rid="B1">Box 1</xref>).<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.16231.002</object-id><label>Figure 1.</label><caption><title>Boolean dynamics of compartments and vesicles: examples of maturation chains.</title><p>(<bold>A</bold>,<bold>B</bold>,<bold>C</bold>) A system with <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> molecular labels <italic>X</italic> and <italic>Y</italic>. (<bold>D</bold>,<bold>E</bold>,<bold>F</bold>) A system with <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> molecular labels <italic>X, Y</italic> and <italic>Z</italic>. (<bold>A</bold>,<bold>D</bold>) Left: the <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>C</mml:mi><mml:mo>×</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> budding matrix <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi><mml:mo>:</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 means compartment type <italic>i</italic> (row) buds out vesicle type <italic>j</italic> (column). Vesicle compositions are subsets of source compartment compositions, so only some entries of <inline-formula><mml:math id="inf5"><mml:mi>G</mml:mi></mml:math></inline-formula> can be non-zero (gray shading). Right: the <inline-formula><mml:math id="inf6"><mml:mrow><mml:mi>C</mml:mi><mml:mo>×</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> fusion matrix <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:mo>:</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 means vesicle type <italic>j</italic> (column) can fuse with compartment type <italic>i</italic> (row). Any entry of <inline-formula><mml:math id="inf8"><mml:mi>F</mml:mi></mml:math></inline-formula> can be non-zero (gray shading). (<bold>B</bold>,<bold>E</bold>) At each timepoint compartments (gray circles) accept (through fusion) or give away (through budding) vesicles (white circles). Gray rectangles show the state of the cell at successive timepoints, moving from top to bottom. Compartments can undergo maturation (blue arrows) or vesiculate by giving up all their cargo (thick black arrows); orphan vesicles can undergo homotypic fusion to generate new compartments (brown arrows). From the first to the second timepoint, individual compartments change composition but the full set of compartments is constant: the system has reached homeostasis. (<bold>C</bold>,<bold>F</bold>) Another representation of the homeostatic networks from <xref ref-type="fig" rid="fig1">Figure 1B,E</xref>, mapping out a cell in compositional space. Circles represent compartments (gray) or vesicles (white); each distinct circle represents a distinct compositional type. Thin black arrows show vesicles moving between compartments at one timepoint. Brown arrows followed by blue arrows show the creation and maturation of compartments, flowing from one timepoint to the next. (<bold>G</bold>,<bold>H</bold>) Results of a stochastic simulation of vesicle traffic for a system with two molecular labels <italic>X</italic> and <italic>Y</italic> (Box, <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). The cell contains many vesicles and compartments, and reaches an equilibrium in which the vesicle pools and the number of compartments of each compositional type are approximately constant. Parameters: <inline-formula><mml:math id="inf9"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> = {250 units, 5000 units}; {<italic>A, B, C, D</italic>} = {1000 units min<sup>−1</sup>, 10 min<sup>−1</sup>, 5 min<sup>−1</sup>, 1 min<sup>−1</sup>}; time-averaged vesicle pools <inline-formula><mml:math id="inf10"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.457</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf11"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>Y</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>10.6</mml:mn></mml:mrow></mml:math></inline-formula>. Timescales are chosen to qualitatively match real maturation dynamics (<xref ref-type="bibr" rid="bib22">Losev et al., 2006</xref>). (<bold>G</bold>) The heatmap shows the equilibrium distribution of compartment compositions. Individual compartments change composition over time: the curve shows the deterministic limit-cycle solution to <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>, with different phases corresponding to creation (brown), maturation (blue), and vesiculation (black). Extrema of this curve correspond to the Boolean compartment compositions in <xref ref-type="fig" rid="fig1">Figure 1C</xref>. (<bold>H</bold>) Compositions of individual compartments over time for the full stochastic simulation (<italic>X</italic> in dark gray, <italic>Y</italic> in light gray). Compositions cycle periodically; each cycle is independent of the previous one, since new compartments are nucleated by fresh homotypic fusion events. The final cycle shows the deterministic limit-cycle solution to <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> for comparison. The inset expands the first minute, with <italic>X</italic> and <italic>Y</italic> levels scaled against their maximum values so creation, maturation and vesiculation can be clearly observed. <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> shows how non-vesicular transport can be included in this framework.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16231.002">http://dx.doi.org/10.7554/eLife.16231.002</ext-link></p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-16231-fig1-v2"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16231.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Combining vesicular and non-vesicular transport.</title><p>Example of a system with <inline-formula><mml:math id="inf12"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula> molecular label types. The Rab GTPase (R) shuttles between the cytoplasm and the membrane. The GDF (D: GDI displacement factor) recruits the Rab GTPase to the correct membrane. The GEF (E: GDP/GTP exchange factor) converts the Rab to its active GTP-bound form. The GAP (A: GTPase activating protein) coverts the Rab to its inactive GDP-bound form, which moves to the cytoplasm. We show two sets of Rabs and their regulators, in red and green. In addition, we track membrane lipids that move along vesicles (M) in blue. Left: the budding and fusion matrices <inline-formula><mml:math id="inf13"><mml:mi>F</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf14"><mml:mi>G</mml:mi></mml:math></inline-formula>. There are <inline-formula><mml:math id="inf15"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mn>9</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mn>511</mml:mn></mml:mrow></mml:math></inline-formula> possible types of compartments and vesicles, we only show a subset of them here. Rabs, GEFs and GAPs moving through the cytoplasm are represented just as vesicles are, but with a single label and lacking membranes. Right: homeostatic vesicle traffic systems corresponding to the budding and fusion rules. Compartments are shown as large gray circles, vesicles are explicitly shown as small white circles, non-vesicular transport pathways are shown as arrows between compartments. (<bold>A</bold>) Rab-mediated vesicle exchange between two distinct compartments. (<bold>B</bold>) A Rab GTPase cascade. The active form of one Rab recruits its own GAP, but recruits the other Rab’s GEF. This causes a single compartment to oscillate between the two Rab varieties, shown as a maturation cycle (blue arrows). This is similar to the Rab5/Rab7 switch during endosomal maturation (<xref ref-type="bibr" rid="bib37">Rink et al., 2005</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16231.003">http://dx.doi.org/10.7554/eLife.16231.003</ext-link></p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-16231-fig1-figsupp1-v2"/></fig></fig-group></p><boxed-text id="B1"><object-id pub-id-type="doi">10.7554/eLife.16231.004</object-id><label>Box 1.</label><caption><title>Stochastic, continuous, and Boolean models of cisternal maturation.</title><p>It is interesting to see how our Boolean model is related to more microscopic vesicle traffic models (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Consider a system with two types of molecules <italic>X</italic> and <italic>Y</italic>, transported on distinct types of vesicles. We assume a well-mixed cytoplasm containing many compartments and vesicles. Each vesicle contains a fixed amount of each molecule, providing a measurement unit; anything larger than a vesicle is a compartment. We assume <italic>X</italic> vesicles can fuse to one another and, much less efficiently, to compartments; <italic>Y</italic> vesicles can fuse only to compartments; and compartments cannot fuse to one another. Let <inline-formula><mml:math id="inf16"><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the number of compartments with <italic>x</italic> units of <italic>X</italic> and <italic>y</italic> units of <italic>Y</italic>. The number of free vesicles of each type is: <inline-formula><mml:math id="inf17"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>≡</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf18"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo>≡</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The total amount of each molecule remains constant, given by <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The allowed reactions are:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mspace width="thinmathspace"/></mml:mrow><mml:mi>X</mml:mi><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo>:</mml:mo><mml:mspace width="thinmathspace"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo stretchy="false">↓</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mo stretchy="false">↑</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>A</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/></mml:mrow><mml:mi>X</mml:mi><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="thinmathspace"/></mml:mrow><mml:mi>Y</mml:mi><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mo>:</mml:mo><mml:mspace width="thinmathspace"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">↑</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mo stretchy="false">↓</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mo stretchy="false">↑</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/></mml:mrow><mml:mi>B</mml:mi><mml:mi>x</mml:mi><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">↑</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mo stretchy="false">↓</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mo stretchy="false">↑</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>D</mml:mi><mml:mi>y</mml:mi><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/></mml:mrow><mml:mi>X</mml:mi><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/></mml:mrow><mml:mi>Y</mml:mi><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mo>:</mml:mo><mml:mspace width="thinmathspace"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo stretchy="false">↓</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mo stretchy="false">↓</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mo stretchy="false">↑</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>A</mml:mi><mml:mfrac><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mtext> </mml:mtext><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo stretchy="false">↓</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mo stretchy="false">↓</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mo stretchy="false">↑</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>C</mml:mi><mml:mi>x</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, up/down arrows indicate increases/decreases in number, and rates correspond to reaction probabilities per unit time. Each term arises as follows: <italic>X</italic> or <italic>Y</italic> vesicles bud in proportion to the amount of <italic>X</italic> or <italic>Y</italic> on each compartment (<inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> terms). <italic>X</italic> promotes fusion of vesicles to compartments, cooperatively for <italic>X</italic> vesicles (<inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>A</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> term) and linearly for <italic>Y</italic> vesicles (<inline-formula><mml:math id="inf24"><mml:mrow><mml:mi>C</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> term). The rate of fusion of <italic>X</italic> vesicles decreases sharply as the size of the compartment increases (<inline-formula><mml:math id="inf25"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> term); when a compartment is identical to an <italic>X</italic> vesicle this reduces to the homotypic fusion rate constant <italic>A</italic>. The parameters have the following dimensions: <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf27"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf28"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>Y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are pure numbers of compartments and vesicles in the cell; <italic>x</italic> and <italic>y</italic> are measured in units corresponding to the amount of <italic>X</italic> or <italic>Y</italic> on a single transport vesicle; <italic>A</italic> has dimensions of molecular units per unit time; <italic>B, C</italic>, and <italic>D</italic> have dimensions of inverse time. The value <inline-formula><mml:math id="inf29"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the approximate time a compartment takes to fully vesiculate.</p><p>We simulate this stochastic system using Gillespie’s algorithm (<xref ref-type="bibr" rid="bib13">Gillespie, 2007</xref>). From arbitrary initial conditions the system reaches a homeostatic state in which the free vesicle pools and the number of compartments of any given composition are nearly constant (<xref ref-type="fig" rid="fig1">Figure 1G</xref>). However, individual compartment compositions vary over time. In the mean-field limit each compartment approximately obeys a continuous deterministic version of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, where <inline-formula><mml:math id="inf30"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf31"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>Y</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> are time-averaged values:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>A</mml:mi><mml:mover><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mfrac><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>C</mml:mi><mml:mover><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>By linear stability analysis, under the following parametric condition this system has no stable fixed point:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mi>B</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>C</mml:mi><mml:mover><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mover><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Roughly, <italic>X</italic> vesicles must bud rapidly and <italic>Y</italic> vesicles must fuse rapidly. Compartment compositions then approach a limit-cycle trajectory (<xref ref-type="fig" rid="fig1">Figure 1G,H</xref>): nucleated by homotypic fusion of <italic>X</italic> vesicles (brown); maturing by budding <italic>X</italic> vesicles and fusing with <italic>Y</italic> vesicles (blue); and finally vesiculating into <italic>Y</italic> vesicles (black). These dynamics are similar to live-cell observations of cisternal maturation (<xref ref-type="bibr" rid="bib22">Losev et al., 2006</xref>). <xref ref-type="fig" rid="fig1">Figure 1A</xref> shows the budding and fusion matrices corresponding to the Boolean version of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. The resulting Boolean homeostatic state (<xref ref-type="fig" rid="fig1">Figure 1B,C</xref>) displays the same qualitative features as the stochastic and continuous models (<xref ref-type="fig" rid="fig1">Figure 1G,H</xref>). These examples all describe the maturation chain, at different levels of abstraction.</p></caption><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16231.004">http://dx.doi.org/10.7554/eLife.16231.004</ext-link></p></boxed-text><p>We consider a cell to be a collection of compositionally distinct membrane-bound compartments exchanging vesicles. Suppose there are <italic>N</italic> types of membrane-associated, transmembrane or lumenal molecules that determine the properties of compartments and vesicles. We refer to these as active molecular labels: they influence budding and fusion, and can be used to define the identity of compartments. The Boolean composition of a compartment or vesicle is given by a binary vector of length <italic>N</italic>: each element of the vector is 1 or 0 depending on whether that molecular label is present in high or low amounts. The state of a cell at any timepoint is specified by giving the list of compartments of various compositions it contains. A stream of vesicles bud out of source compartments and fuse into target compartments, as specified by budding and fusion matrices (<xref ref-type="fig" rid="fig1">Figure 1A,D</xref>). Over a timescale of minutes this flux depletes the source compartment and enriches the target compartment in the molecular labels carried by the vesicles. Compartment compositions are updated from one timepoint to the next by mass balance, applied to each molecular label (blue arrows, <xref ref-type="fig" rid="fig1">Figure 1B,E</xref>): if it’s coming but not going, you eventually gain it; if it’s going but not coming, you eventually lose it. Apart from homotypic vesicle fusion (brown arrows, <xref ref-type="fig" rid="fig1">Figure 1B,E</xref>) which we discuss below, this is the sum total of our model.</p><p>Though we refer to vesicle transport throughout the text, our Boolean framework can also accommodate non-vesicular pathways. Some types of molecular labels can exchange between compartments only via transport vesicles. These include most lipids, and transmembrane proteins such as receptors and SNAREs. Others can travel from one compartment to another via the cytoplasm, either directly or on non-vesicle carriers. These include some types of lipids via carrier proteins, as well as the Arf- and Rab-family GTPases which switch between soluble and membrane-associated forms (<xref ref-type="bibr" rid="bib39">Stenmark, 2009</xref>). If we explicitly assign a label to membrane lipids, any pathway carrying a single non-membrane molecular label can optionally be interpreted as direct cytoplasmic transport. Such an approach can be used, for example, to model Rab conversion during endosomal maturation (<xref ref-type="bibr" rid="bib37">Rink et al., 2005</xref>) (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p></sec><sec id="s2-2"><title>Orphan vesicles and homotypic fusion</title><p>We assume a clear hierarchy of membrane-bound structures: compartments are large, transport vesicles are small. The behavior of vesicles and compartments depends on their compositions, but can also depend on their size, for example through the influence of curvature or membrane tension. Suppose the fusion matrix specifies that vesicles of composition <italic>A</italic> fuse to compartments of composition <italic>B</italic>. This does not automatically imply that two vesicles of compositions <italic>A</italic> and <italic>B</italic>, or two compartments of compositions <italic>A</italic> and <italic>B</italic>, must fuse to one another. Here we explicitly assume that compartments cannot fuse heterotypically to one another, and that transport vesicles cannot fuse heterotypically to one another. However, compartments (<xref ref-type="bibr" rid="bib39">Stenmark, 2009</xref>) and transport vesicles (<xref ref-type="bibr" rid="bib33">Nakano and Luini, 2010</xref>) are known to fuse homotypically in certain situations. Homotypic compartment fusion, if it does occur, has no influence on our Boolean dynamics; in contrast, homotypic vesicle fusion has a key role to play. The dynamics often generate orphan vesicles that find no target compartment. Left unchecked these would leak out of the system, preventing homeostasis. Here we focus on homeostatic states in which a small specific subset of orphan vesicles can undergo homotypic fusion and nucleate new compartments, as seen in real cells (<xref ref-type="bibr" rid="bib33">Nakano and Luini, 2010</xref>). Such vesicles would have to fuse much more efficiently to one another than to compartments of the same composition, perhaps mediated by size-dependent effects (brown arrows, <xref ref-type="fig" rid="fig1">Figure 1</xref>; <xref ref-type="box" rid="B1">Box 1</xref>).</p><p>The following algorithm efficiently generates all homeostatic states with these properties (<xref ref-type="fig" rid="fig1">Figure 1B,E</xref>; Materials and methods: The Boolean vesicle traffic model). Starting from some initial condition, we run Boolean updates. If at any point we encounter a homeostatic state with no orphans, we stop. If we encounter a state with orphan vesicles, we check what happens if specifically those vesicles could homotypically fuse to nucleate compartments. If this produces a homeostatic state, we stop. If not, we use the resulting state as our initial condition. We nullify assumptions about homotypic vesicle fusion, and repeat the process. In practice we find that a small dose of homotypic fusion is often sufficient to achieve homeostasis: over 80% of our homeostatic networks require two or fewer types of homotypically fusing vesicles.</p></sec><sec id="s2-3"><title>Statistical cell biology and non-adaptive evolution</title><p>In the most basic maturation chain, a compartment created by homotypic vesicle fusion matures into one or more successive compositional types, coupled with retrograde transport of cargo (brown creation arrow followed by blue maturation arrows, <xref ref-type="fig" rid="fig1">Figure 1C,F</xref>; <xref ref-type="box" rid="B1">Box 1</xref>). Multiple maturation chains could exist as an interlinked part of a larger vesicle traffic network (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). If we precisely set the elements of the budding and fusion matrices by hand, we can ensure that vesicles of the right composition bud and fuse between the right compartments so as to generate maturation chains (as with the examples in <xref ref-type="fig" rid="fig1">Figure 1</xref>). But what if the elements of these matrices are set at random? What is the likelihood that complex structures such as maturation chains would then arise?<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.16231.005</object-id><label>Figure 2.</label><caption><title>Homeostatic vesicle traffic networks.</title><p>These data relate to the 14,809 homeostatic networks for <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> molecular label types. (<bold>A</bold>–<bold>C</bold>) Examples of homeostatic networks (compartment and vesicle compositions are omitted for clarity) for budding and fusion rules generated using different parameter values <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (Materials and methods: Sampling homeostatic vesicle traffic networks). (<bold>A</bold>) {7, 1, 0.35, 0.35}, gray square icon. This is a transport-balanced network with no homotypic fusion or maturation. (<bold>B</bold>) {7, 4, 0.025, 0.75}, brown square icon. This is a network with high homotypic fusion but no maturation, and is broken into many disconnected subsets. (<bold>C</bold>) {7, 2, 0.1, 0.7}, blue square icon. This network has low homotypic fusion and high maturation, similar to a real eukaryotic cell. (<bold>D</bold>) Schematic vesicle traffic system of a eukaryotic cell. ER: endoplasmic reticulum. ERG: ER-Golgi intermediate compartment. CG: <italic>cis</italic>-Golgi. MG: medial-Golgi. TG: <italic>trans</italic>-Golgi. TGN: <italic>trans</italic>-Golgi network. PM: plasma membrane. EE: early endosome. LE: late endosome. LY: lysosome. RE: recycling endosome. (<bold>E</bold>) For each network in our dataset with ten or more compartments, we show the fraction of compartments undergoing maturation (outgoing blue arrow) vs. the fraction of compartments created by homotypic vesicle fusion (incoming brown arrow). The gray curve shows a moving average of the data. The colored squares show the position of the three networks in <xref ref-type="fig" rid="fig2">Figure 2A–C</xref>. Maturation is most likely at low-to-moderate rates of homotypic fusion. (<bold>F</bold>) The number of stable compartments vs. the total number of compartments for all the connected subsets in our dataset. The ER and plasma membrane are examples of stable compartments in real cells. (<bold>G</bold>) The number of maturation chains vs. the total number of compartments for all the networks in our dataset. (<bold>H</bold>) Chain lengths for all 841 networks in our dataset with precisely two maturation chains. In (<bold>E</bold>–<bold>H</bold>) we plot values with a random additive noise so the density of points can be observed. The blue square icon shows the properties of the cell-like network from <xref ref-type="fig" rid="fig2">Figure 2C</xref>. <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplements 1</xref>,<xref ref-type="fig" rid="fig2s2">2</xref> explore further properties of these homeostatic networks.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16231.005">http://dx.doi.org/10.7554/eLife.16231.005</ext-link></p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-16231-fig2-v2"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16231.006</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Statistical sampling of networks.</title><p>(<bold>A</bold>,<bold>B</bold>) For systems with <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> molecular label types, we show the histogram of (<bold>A</bold>) the number of compartments and (<bold>B</bold>) and the number maturation chains. There is almost no variation when going from <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> label types. (<bold>C</bold>,<bold>D</bold>,<bold>E</bold>) Properties of systems for <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> label types and <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> adaptor/coatomer types; <italic>A</italic> sets the limit on the number of distinct vesicles a compartment can generate. We generate random budding and fusion matrices using two parameters (Materials and methods: Sampling homeostatic vesicle traffic networks): <italic>g</italic> is the loading propensity of molecular labels onto vesicles; <italic>f</italic> is the fusion propensity between vesicles and compartments. For each combination of parameters we generate ten sets of matrices <italic>G</italic> and <italic>F</italic>. For each instance of <italic>G</italic> and <italic>F</italic> we run the vesicle traffic dynamics starting from a random initial condition. We store all homeostatic states resulting from this procedure, and track the average value of any property across them. (<bold>C</bold>) Probability of reaching a homeostatic steady state from a random initial condition. (<bold>D</bold>) Number of compartments. (<bold>E</bold>) Fraction of compartments involved in a maturation process. Left column: the relevant quantity as a heat map for fixed <italic>g</italic> and <italic>f</italic>, but any <italic>A</italic>. Middle and right columns: the relevant quantity for each value of <italic>A</italic>, as a function of fixed <italic>f</italic> (middle) or fixed <italic>g</italic> (right). The adaptor/coatomer number <italic>A</italic> weakly influences the number of compartments, but strongly influences the fraction of compartments undergoing maturation. The gray, brown and blue square icons show the parameters used to generate of the networks from <xref ref-type="fig" rid="fig2">Figure 2A–C</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16231.006">http://dx.doi.org/10.7554/eLife.16231.006</ext-link></p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-16231-fig2-figsupp1-v2"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16231.007</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Properties of homeostatic networks.</title><p>These data relate to the 14,809 homeostatic networks for <inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> molecular label types. (<bold>A</bold>) The homeostatic networks generated by our sampling procedure can break into subsets of compartments connected within themselves but mutually disconnected from one another. (In graph theory these would be called 'connected components'; we use the term 'subsets' to avoid confusion with molecular components.) The diagonal shows the trivial networks where each compartment is disconnected from all the others, so the number of subsets is equal to the number of compartments. The horizontal line above the x-axis shows the completely connected networks consisting of a single subset. (<bold>B</bold>,<bold>C</bold>) The number of vesicles vs. the number of compartments for (<bold>B</bold>) all networks, and (<bold>C</bold>) connected network subsets. (<bold>D</bold>) Histogram showing the number of molecule types on compartments (top) and vesicles (bottom). (<bold>E</bold>) Any group of compartments for which some molecule type flows in but not out corresponds to a sink, and implies the need for compensatory synthesis at long timescales. Here we show the number of molecules with sinks vs. the total number of compartments, for all connected subsets in our dataset. The gray curve shows a moving average. (<bold>F</bold>,<bold>G</bold>) The fusion (<bold>F</bold>) and budding (<bold>G</bold>) matrices used to generate the cell-like network from <xref ref-type="fig" rid="fig2">Figure 2C</xref>. Non-zero entries are shown as black pixels. (<bold>H</bold>) The flow of molecules in the cell-like network from <xref ref-type="fig" rid="fig2">Figure 2C</xref>. The path taken by each of the <inline-formula><mml:math id="inf40"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> molecular label types are separately highlighted. The network is homeostatic with respect to composition but not quantity. Some molecules move in cycles while others (the first and the third in this example) have sinks and therefore require compensatory synthesis.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16231.007">http://dx.doi.org/10.7554/eLife.16231.007</ext-link></p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-16231-fig2-figsupp2-v2"/></fig></fig-group></p><p>This question is relevant because existing genetic variation constrains the directions in which natural selection can operate. It is therefore important to identify structures that arise in vesicle traffic systems prior to any selection for function. Inspired by statistical physics, we do a form of statistical cell biology: we make as few assumptions as possible, and thus sample a diverse ensemble of vesicle traffic systems. Just as polling a representative subset of likely voters provides information on election outcomes, statistically sampling a representative subset of budding and fusion rules reveals properties intrinsic to vesicle traffic. This represents a neutral null hypothesis: if a structure of interest occurs frequently in this sample without any fine tuning, it is consistent with a non-adaptive evolutionary origin.</p></sec><sec id="s2-4"><title>Sampling homeostatic vesicle traffic networks</title><p>To systematically explore diverse behaviors, we sorted vesicle traffic systems according to the number of molecular labels, the number of adaptor/coatomer types, and how permissive vesicles were in selecting cargo and fusion targets (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>; Materials and methods: Sampling homeostatic vesicle traffic networks). These parameters capture genetically-encoded properties such as the number, and the degree of interaction specificity, of cargo, adaptors, Arf and Rab GTPases, and SNAREs.</p><p>For each set of parameter values, we generated random instances of budding and fusion matrices (placed 1 s and 0 s at random positions). Given a budding and a fusion matrix, an arbitrary collection of compartments is almost certainly unstable: compartment compositions will update through molecular exchange, until finally the system settles into an unvarying homeostatic state (<xref ref-type="fig" rid="fig1">Figure 1B,E</xref>; <xref ref-type="fig" rid="fig2">Figure 2A–C</xref>). Different initial conditions lead to different homeostatic states. Each such state will typically contain only a small subset of all possible compartment compositions, and therefore depend only on a small number of elements of the full budding and fusion matrices. A homeostatic state represents a very special collection of compartments: either individual compartments in this set equalize gain and loss via vesicles – the balanced vesicular transport condition – or else different compartment types must interconvert between one another – the compartmental maturation condition.</p><p>Within a homeostatic state, compartments could segregate into subsets connected within themselves but disconnected from one another (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A</xref>). Most trivially, each compartment could be completely disconnected from all the others. In total we collected 63,897 homeostatic networks (35,838 non-trivial) for <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> molecular label types. We found that network properties depended only weakly on <inline-formula><mml:math id="inf42"><mml:mi>N</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A,B</xref>) so we focus the rest of the discussion on the 14,809 homeostatic networks (8614 non-trivial) obtained for <inline-formula><mml:math id="inf43"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> label types. For this number of molecular labels, there are <inline-formula><mml:math id="inf44"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mn>7</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mn>127</mml:mn></mml:mrow></mml:math></inline-formula> possible compartment or vesicle compositions, so the budding and fusion matrices contain thousands of elements (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2F,G</xref>).</p><p>Among the networks generated by this procedure, 90% had 8 or fewer compartments and 11 or fewer vesicle types (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B,C</xref>). The compartments showed a bimodal distribution of compositional complexity, with an excess of compartments having very many or very few molecular labels (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2D</xref>, top). In contrast, vesicles tended to be compositionally simple (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2D</xref>, bottom). Molecular loss was offset by molecular gain at each stable compartment on fast timescales. However, compartment groups sometimes collectively received molecules that remained trapped within the group. Such molecular sinks create a need for compensatory synthesis elsewhere on slower timescales. We found that larger networks required synthesis of more types of molecular components (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2E,H</xref>).</p></sec><sec id="s2-5"><title>Cell-like networks and vesicle traffic motifs</title><p>A significant fraction of our homeostatic networks bore a striking resemblance to real eukaryotic vesicle traffic networks (<xref ref-type="fig" rid="fig2">Figure 2</xref>). In particular, they contained maturation chains. In terms of the number of compartments, number of chains, and chain lengths, the real eukaryotic traffic network (<xref ref-type="fig" rid="fig2">Figure 2D</xref>) appeared to be a typical example of a homeostatic network generated by our procedure (<xref ref-type="fig" rid="fig2">Figure 2C,E–H</xref>). Cell-like networks containing maturation chains were most likely to occur at low-to-moderate rates of homotypic vesicle fusion (<xref ref-type="fig" rid="fig2">Figure 2E</xref>): at very low rates all networks were of the transport balance type (<xref ref-type="fig" rid="fig2">Figure 2A</xref>); at very high rates they broke into many disconnected vesiculating subsets (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Nearly half the non-trivial homeostatic networks (4024/8614) contained a maturation chain of length one or more.</p><p>Unexpectedly, we found that the lengths of maturation chains were geometrically distributed (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Such distributions typically arise for processes in which each step is random and independent, for example counting the number of heads before hitting the first tail in a series of coin flips. This suggests that vesicle traffic networks might usefully be described by the random graph generation approaches that have provided insights into the structure of metabolic, neural, and ecological networks (<xref ref-type="bibr" rid="bib1">Albert and Barabási, 2002</xref>) (Materials and methods: Randomly shuffled vesicle traffic networks).<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.16231.008</object-id><label>Figure 3.</label><caption><title>Frequent vesicle traffic motifs.</title><p>These data relate to the 14,809 homeostatic networks for <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> molecular label types. (<bold>A</bold>,<bold>B</bold>) Insets indicate the number of homeostatic networks that contain at least one copy of the motif. Histograms show the number of repeated copies of each motif per network, in actual (gray bars) or randomized (white bars) networks (Materials and methods: Vesicle traffic motifs; Materials and methods: Randomly shuffled vesicle traffic networks). (<bold>A</bold>) The three most frequent connected three-compartment motifs. (<bold>B</bold>) The maturation chain. (<bold>C</bold>) Histogram of maturation chain lengths. We consider any compartment with an incoming brown arrow as the start of a chain, and define length as the number of subsequent blue arrows. Inset: the same data in a log-linear plot. Both the real (grey dots) and randomized (white dots) networks show a geometric distribution of chain lengths. <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> shows the frequency of the top 100 most common motifs.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16231.008">http://dx.doi.org/10.7554/eLife.16231.008</ext-link></p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-16231-fig3-v2"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16231.009</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Vesicle traffic motif statistics.</title><p>The number of networks in which each connected 3-compartment motif occurs vs. the motif index (Materials and methods: Vesicle traffic motifs). Motifs are sorted along the x-axis, from most to least frequent. The insets show the top 10 most frequent motifs (first two rows). We also show the 15th most common motif: the maturation cycle.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16231.009">http://dx.doi.org/10.7554/eLife.16231.009</ext-link></p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-16231-fig3-figsupp1-v2"/></fig></fig-group></p><p>We wondered whether the networks lacking maturation chains were characterized by other distinct features. To quantify this, we did an unbiased search for highly represented network motifs (<xref ref-type="bibr" rid="bib29">Milo et al., 2002</xref>) (<xref ref-type="fig" rid="fig3">Figure 3</xref>; <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>; Materials and methods: Vesicle traffic motifs). There are 43,700 ways in which three compartments can be connected to one another to form a motif. Strikingly, the three most frequent three-compartment motifs (<xref ref-type="fig" rid="fig3">Figure 3A</xref>) were all sub-graphs of the maturation chain, and eight of the ten most frequent motifs themselves contained maturation chains (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). In contrast, the 4590 non-trivial networks with no maturation chains showed no clear pattern: they were characterized by about 50 different motifs, no single one of which was found in more than 500 networks (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). The 15th most common three-compartment motif, occurring in 344 networks, is the maturation cycle (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). This corresponds to a compartment whose composition oscillates periodically. Cycles of various periods occurred in about a quarter (2407/8614) of all homeostatic networks. Out of 3173 non-trivial networks with no homotypic fusion, over a third contained cycles of maturing compartments (1053/3173).</p></sec><sec id="s2-6"><title>Retrograde vesicles emerge spontaneously, driving cisternal maturation</title><p>What is the fate of a compartment that is created by homotypic vesicle fusion (<xref ref-type="fig" rid="fig4">Figure 4A</xref>)? It can proceed through steps of maturation, and finally end up as either a compartment of fixed composition, or one whose composition oscillates over time. Most maturation chains (72%) terminated at fixed compartments; terminal oscillating compartments were uncommon (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). The majority (61%) of such fixed terminal compartments gave up all their cargo as vesicles at the next timepoint, and thus dissipated. When we examined the flow of molecules and vesicles within maturation chains (<xref ref-type="fig" rid="fig4">Figure 4C</xref>), we found a striking and unexpected feature: younger compartments were disproportionately likely to receive retrograde vesicles directly from their older successors, over eight times more often than expected by chance (<xref ref-type="fig" rid="fig4">Figure 4C</xref>, right panel). Individual molecules treadmilled in place within a chain, hopping to younger compartments via retrograde vesicles, driving their conversion to the older composition. The first compartment of a maturation chain tended to be compositionally simpler than its successors (at least in terms of the active labels considered here) due to the treadmilling molecules present on the latter.<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.16231.010</object-id><label>Figure 4.</label><caption><title>Anatomy of a cisternal maturation chain.</title><p>(<bold>A</bold>) A compartment created at the first timepoint (source, thick brown arrow) matures at each successive timepoint (inlet, thick blue arrows). This process can terminate at a compartment with fixed composition, or one with an oscillating composition (cycle of thick blue arrows). Vesicles move molecules between compartments. We classify vesicles as anterograde (thin light brown arrows), retrograde (thin dark brown arrows) and other (thin black arrows). Some vesicles are inbound or outbound from other parts of the network. (<bold>B</bold>) Properties of the terminal compartment of a maturation chain. There are 10,172 homotypically fusing sources in our dataset that have at least one maturation step, of which just 2899 terminate in a cycle. The remaining 7273 sources terminate at 4588 fixed compartments (the reduction in number is because maturation chains can converge). Finally, 2820 of these 4588 compartments dissipate at the next timestep, giving up all their cargo as vesicles. (<bold>C</bold>) Fraction of compartment pairs A,B with a B-to-A vesicle. Each dot in each panel represents values for a single network; we show data only for networks that have ten or more maturation edges. The x-axis is the vesicle fraction <inline-formula><mml:math id="inf46"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for all compartment pairs A,B in the network. The y-axis is the vesicle fraction <inline-formula><mml:math id="inf47"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for the subset of compartment pairs A,B in the network where A sends a vesicle to B (left), B matures to A (middle), or A matures to B (right). For the left and middle panels, the chance of finding a B to A vesicle for the corresponding subset of pairs is the same as the chance between all pairs in a network. For the right panel, the chance of finding a B to A vesicle when A matures to B (median 0.75) is eight fold more than the chance across all pairs (median 0.09). For example, suppose a network with 10 compartments has <inline-formula><mml:math id="inf48"><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mn>9</mml:mn><mml:mo>=</mml:mo><mml:mn>90</mml:mn></mml:mrow></mml:math></inline-formula> compartment pairs A,B. Suppose for 8 of these pairs we know that A matures to B. Now we count vesicles. We find that 8/90 = 0.09 of all pairs and 6/8 = 0.75 of the maturing pairs have a vesicle going from B to A. This corresponds to a network with an x-value of 0.09 and a y-value of 0.75: there are many more retrograde vesicles between maturing compartments than expected by chance. That is, a younger compartment in a maturation chain almost certainly receives a retrograde vesicle from its immediate older successor. <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> explores the optimal spatial distribution of compartments in a maturation chain.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16231.010">http://dx.doi.org/10.7554/eLife.16231.010</ext-link></p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-16231-fig4-v2"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16231.011</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Spatial optimization of networks.</title><p>We optimize the spatial locations of compartments such that all parts of a cell are close to at least one compartment, while the distance travelled by vesicles between compartments is minimized (Materials and methods: Spatial optimization). (<bold>A</bold>,<bold>B</bold>) The cell-like network from <xref ref-type="fig" rid="fig2">Figure 2C</xref>. Maturation chains line up spatially, so each compartment is adjacent to the compartment type it matures to. This is reminiscent of Golgi stacks in real cells. Left panels: the network showing vesicle arrows alone, which are the inputs used for optimization. Right panels: the network showing creation and maturation arrows, with maturation chains clearly forming stacks. (<bold>A</bold>) The optimized network. (<bold>B</bold>) The network with compartment identities randomly shuffled, shown for comparison. (<bold>C</bold>) Effect of optimization across all networks with ten or more compartments. For each network, we plot the mean pairwise distance between compartments connected by blue maturation arrows, scaled by the nearest neighbor distance. The x-axis shows the distances for randomly shuffled networks, the y-axis shows the optimized distances. Though the optimization protocol only considers vesicle arrows and is ignorant of maturation arrows, the distance between compartments in a maturation chain is dramatically reduced. 42% of optimized networks have a mean distance of less than 1.5, while no random networks do.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16231.011">http://dx.doi.org/10.7554/eLife.16231.011</ext-link></p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-16231-fig4-figsupp1-v2"/></fig></fig-group></p><p>Distilling these observations, here is our central result: across 8614 non-trivial homeostatic networks, we find 3111 maturation chains which precisely match all three diagnostic features of the cisternal maturation model (<xref ref-type="fig" rid="fig1">Figures 1</xref>,<xref ref-type="fig" rid="fig4">4</xref>). (1) The first compartment is created by homotypic vesicle fusion and then matures via one or more steps. (2) The terminal compartment dissipates by vesiculation. (3) Younger compartments receive retrograde vesicles directly from their older successors.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We have answered the question posed at the outset: even when elements of the budding and fusion matrices are set at random, the stringent requirements of homeostasis drive cells toward highly structured compartment compositions, among which cisternal maturation chains frequently occur. The basic, well-established dynamics of vesicle traffic – in which the specificity of vesicle formation and fusion is locally regulated through molecular interactions – are sufficient to generate a Golgi-like structure without fine tuning. We emphasize that our results pertain to cell-wide vesicle traffic rather than narrowly to the Golgi apparatus, and have implications for maturation dynamics observed in other secretory and endocytic systems (<xref ref-type="bibr" rid="bib27">Mani and Thattai, 2016</xref>). Almost all networks with maturation chains also contained stable compartments with balanced vesicular transport: these structures co-exist, they not mutually exclusive. Classic models of membrane traffic focus on the generation of stable compartments out of the dynamic process of vesicle exchange (<xref ref-type="bibr" rid="bib16">Heinrich and Rapoport, 2005</xref>). The few that consider maturation introduce it by hand, and study subsequent features of protein transport (<xref ref-type="bibr" rid="bib14">Glick et al., 1997</xref>; <xref ref-type="bibr" rid="bib43">Weiss and Nilsson, 2000</xref>; <xref ref-type="bibr" rid="bib9">Dmitrieff et al., 2013</xref>; <xref ref-type="bibr" rid="bib18">Ispolatov and Müsch, 2013</xref>). In contrast, maturation is not built into our framework, it emerges spontaneously. When a basic model is sufficient to generate cisternal maturation, the burden of proof is on complex models to justify additional ingredients.</p><p>Our strongest result is the emergence of retrograde vesicles between maturing cisternae in the absence of a spatial coordinate. All earlier mathematical analyses explicitly or implicitly assumed that maturation was driven by retrograde vesicles moving between spatially neighboring compartments (<xref ref-type="bibr" rid="bib14">Glick et al., 1997</xref>; <xref ref-type="bibr" rid="bib43">Weiss and Nilsson, 2000</xref>; <xref ref-type="bibr" rid="bib9">Dmitrieff et al., 2013</xref>; <xref ref-type="bibr" rid="bib18">Ispolatov and Müsch, 2013</xref>). However, un-stacked Golgi are widespread (<xref ref-type="bibr" rid="bib31">Mowbrey and Dacks, 2009</xref>); and do have retrograde vesicles (<xref ref-type="bibr" rid="bib34">Papanikou et al., 2015</xref>). This is consistent with our results: it shows that spatial organization is not a pre-requisite for maturation, and supports the idea of a well-mixed cytoplasm.</p><p>A eukaryotic cell is an object distributed in both chemical and physical space (<xref ref-type="bibr" rid="bib30">Misteli, 2001</xref>). The connectivity of a vesicle traffic network is primarily determined by molecular chemical specificity, while the locations of compartments are determined by complex and largely unknown biophysical mechanisms (<xref ref-type="bibr" rid="bib45">Yadav and Linstedt, 2011</xref>). The spatial organization of a cell clearly impacts all aspects of its activity, including vesicle traffic. To add a physical dimension to our analysis, we explored the hypothesis that a cell is like an efficient city-wide logistics system: one in which no part of a city is too far from a warehouse, and warehouses with more traffic between them are placed closer to one another (<xref ref-type="bibr" rid="bib40">Taniguchi et al., 1999</xref>). For each network in our dataset, we ran an optimization algorithm to distribute compartments uniformly across a cell while minimizing the distance travelled by vesicles between compartments (Materials and methods: Spatial optimization). Remarkably, maturation chains in such optimized networks immediately organized into spatially contiguous stacks: each compartment was adjacent in space to the type of compartment it matures to in time (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). This was mainly due to the excess of retrograde vesicles within maturation chains, though most vesicles still traveled long distances. The stacked morphology of the Golgi apparatus in many eukaryotes is thus consistent with the expectations of efficient traffic. Experiments with repositioned organelles might be used to test these ideas further (<xref ref-type="bibr" rid="bib42">van Bergeijk et al., 2015</xref>). However, hypotheses about function and efficiency are much more difficult to prove than those about molecular mechanism. Our main result is based only on the latter: as vesicle traffic networks evolve, cisternal maturation is easily discoverable by mutation, prior to any selection. For the Golgi apparatus, form might have preceded function.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>The Boolean vesicle traffic model</title><p>We assume <italic>N</italic> types of active molecular labels, and <italic>A</italic> types of cytoplasmic adaptor/coatomer complexes. Compartments (<italic>C</italic>) and vesicles (<italic>V</italic>) are both collections of molecular labels, represented by binary row vectors of length <italic>N</italic>. Each element of such a vector is 1 or 0, indicating whether a certain label type is present in high or low amounts, loosely referred to as presence or absence. For example, for <italic>N</italic> = 3 the row vector [101] indicates that only the first and third label types are present on the corresponding compartment or vesicle. There are <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf50"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> possible non-zero types of compartments and vesicles, respectively. Vesicles with a single non-zero label may optionally be interpreted as membrane-associated molecules capable of cytoplasmic non-vesicular transport (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Since our model is deterministic, a set of compartments of the same composition present at the same time will all have the same dynamics. It is therefore sufficient to keep track of whether some compartment of a given composition is present or absent. Each of the <inline-formula><mml:math id="inf51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∼</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> possible compartments could be present or absent at any timepoint, so the cell itself could be in one of <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∼</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> possible states.</p><p>Let <inline-formula><mml:math id="inf53"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> index the possible compartment composition vectors, and <inline-formula><mml:math id="inf54"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> index the possible vesicle composition vectors. We use a convention in which vectors are sorted according to the standard binary ordering. Thus the row vector <inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf56"><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> has entries corresponding to the digits of the binary number <inline-formula><mml:math id="inf57"><mml:mi>i</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf58"><mml:mi>j</mml:mi></mml:math></inline-formula>. For example, for <italic>N</italic> = 3 the compartment composition corresponding to the index <italic>i</italic> = 5 is the row vector <inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>101</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. If <inline-formula><mml:math id="inf60"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> runs over the label types, <inline-formula><mml:math id="inf61"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf62"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> represents the <italic>n</italic>th component of the compartment or vesicle row vector.</p><p>The dynamics are entirely specified by two matrices (<xref ref-type="fig" rid="fig1">Figure 1A,D</xref>): the <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi>C</mml:mi><mml:mo>×</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> budding matrix <italic>G</italic>, and the <inline-formula><mml:math id="inf64"><mml:mrow><mml:mi>C</mml:mi><mml:mo>×</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> fusion matrix <italic>F</italic>. If a budding element <inline-formula><mml:math id="inf65"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, compartment type <italic>i</italic> generates vesicle type <italic>j</italic>. Since any vesicle vector must be a subset of the source compartment vector, the set of allowed non-zero elements of <italic>G</italic> has the form of a Sierpinski triangle. Each row of <italic>G</italic> can have at most <italic>A</italic> non-zero elements, since this is the number of distinct adaptor/coatomer complexes. If a fusion element <inline-formula><mml:math id="inf66"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, vesicle type <italic>j</italic> fuses into compartment type <italic>i</italic>, as long as the latter is present at that timepoint. Any element of <italic>F</italic> can be non-zero. Under these row-column conventions the product <inline-formula><mml:math id="inf67"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mi>F</mml:mi><mml:mo>'</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (mnemonic buddinG x Fusion’) represents the compartment-to-compartment matrix whose entries give the number of distinct vesicle types coupling any source compartment (<inline-formula><mml:math id="inf68"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) with any target compartment (<inline-formula><mml:math id="inf69"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>).</p><p>At any timepoint <italic>t</italic>, let the sorted set of distinct compartments be <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>≡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mo>…</mml:mo><mml:mo>≤</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The budding matrix <italic>G</italic> then specifies the sorted set of distinct vesicles being generated at that timepoint <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>≡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>j</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>j</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>j</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>j</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mo>…</mml:mo><mml:mo>≤</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. That is, <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>J</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>j</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">∃</mml:mi><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo>.</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. For any compartment of interest <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> we can use <italic>G</italic> to find the vesicles <inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>J</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>⊂</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> budding out of it, and use <italic>F</italic> to find the vesicles <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>J</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>⊂</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> fusing into it: <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Note that <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>∪</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>J</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> but <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>⊃</mml:mo><mml:msub><mml:mrow><mml:mo>∪</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>J</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> since some orphan vesicles might not have targets at that timepoint.</p><p>Compartments change composition discretely and synchronously, using a binary version of mass balance (<xref ref-type="fig" rid="fig1">Figure 1B,E</xref>). Consider the <italic>k</italic>th entry in the sorted list of compartments present at timepoint <italic>t</italic>: it has index <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. The shorthands<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">→</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>O</mml:mi><mml:mi>R</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>J</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">→</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">←</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>O</mml:mi><mml:mi>R</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>J</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">←</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>represent the bitwise OR of the vesicle row vectors in these sets, effectively collapsing them into a single outgoing and a single incoming vesicle row vector for the <italic>k</italic>th compartment. The composition of this compartment updates according to the following Boolean expression:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">←</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>∨</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mi mathvariant="normal">¬</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">→</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>∧</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where the leftmost relationship defines the index <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> as the binary number whose digits are given by the row vector <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>. Put simply, a compartment will gain a molecular label type if it is fusing in and not budding out, and will lose a molecular label type if it is budding out and not fusing in. For all other cases compartment composition does not change.</p><p>If at any timepoint some orphan vesicle type does not fuse to any of the available compartments, this cannot represent a homeostatic state. We then check what happens if each orphan type is separately allowed to undergo homotypic fusion to create a compartment (brown arrows, <xref ref-type="fig" rid="fig1">Figure 1B,E</xref>). In this way we generate a new set of compartments<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mtext> </mml:mtext><mml:mi>j</mml:mi><mml:mtext> </mml:mtext><mml:mo>∉</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mo>∪</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">←</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:munder><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mo>∪</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:munder></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where any duplicates are removed and the indices are sorted. Any compartment which vesiculates by losing all its molecules updates to the zero compartment <inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mn>000</mml:mn><mml:mo>…</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and is not included in this set. The number of distinct compartments could increase through creation. It could decrease if any compartment loses all its molecules, or if two compartments at timepoint <italic>t</italic> update to the same composition at timepoint <italic>t</italic>+1. If the new updated state is identical to the previous one, this indicates we have found a homeostatic state, and we stop the updates. Otherwise, we nullify assumptions about homotypic vesicle fusion, and repeat the updates. Homeostatic states generated in this way contain compartments identical in composition to each orphan vesicle. Since orphans do not fuse to any existing compartment according to the fusion matrix, they necessarily cannot fuse heterotypically to one another.</p></sec><sec id="s4-2"><title>Sampling homeostatic vesicle traffic networks</title><p>We sample a large number of budding and fusion matrices and examine the traffic networks that result. We generate these matrices using four parameters (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>): <italic>N</italic> is the number of distinct molecular label types; <italic>A</italic> is the number of adaptor/coatomer complexes. The continuous parameter <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> sets the propensity of molecular cargo loading (higher values of <italic>g</italic> mean vesicles have more 1 s). The continuous parameter <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> sets the propensity of fusion (higher values of <italic>f</italic> mean the fusion matrix has more 1 s). All these parameters are ultimately genetically determined: <italic>N</italic> and <italic>A</italic> represent the number of protein types involved, while <italic>g</italic> and <italic>f</italic> summarize their interaction properties. For example, <italic>g</italic> depends on cargo-adaptor specificity, and <italic>f</italic> depends on SNARE-SNARE specificity. Our search is unbiased in the sense that we sample uniformly over these parameters.</p><p>We generate <italic>G</italic> and <italic>F</italic> as follows. Let <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> be a Bernoulli random variable, so <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">℘</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">℘</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. For every possible compartment <italic>i</italic> we define <italic>A</italic> vesicle row vectors of length <italic>N</italic>, one for each possible adaptor/coatomer: <inline-formula><mml:math id="inf91"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∙</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>X</mml:mi><mml:mo>~</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf93"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula>. That is, each vesicle typically loads a fraction <italic>g</italic> of the cargo types on source compartments. The budding matrix is then given by <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">⇔</mml:mo><mml:mi mathvariant="normal">∃</mml:mi><mml:mi>a</mml:mi><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Each row of <italic>G</italic> can have anywhere from 0 to <italic>A</italic> non-zero entries, since not all vesicles budding from each compartment are distinct, and the zero vesicle <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>000</mml:mn><mml:mo>…</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> is ignored. The fusion matrix is given by <inline-formula><mml:math id="inf96"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf97"><mml:mrow><mml:mi>X</mml:mi><mml:mo>~</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. That is, each vesicle typically fuses to a fraction <italic>f</italic> of all compartment types. Once <italic>G</italic> and <italic>F</italic> are constructed, they remain constant throughout the dynamics.</p><p>We scan parameter values <inline-formula><mml:math id="inf98"><mml:mrow><mml:mo> </mml:mo><mml:mi>N</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf99"><mml:mrow><mml:mi>A</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf100"><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0.05</mml:mn><mml:mo>,</mml:mo><mml:mn>0.10</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>0.90</mml:mn><mml:mo>,</mml:mo><mml:mn>0.95</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, and additionally <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0.025</mml:mn><mml:mo>,</mml:mo><mml:mn>0.075</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, giving 8360 distinct combinations (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). For each parameter combination we sample ten <italic>F, G</italic> rules as described above. For each rule we start with a random initial condition <inline-formula><mml:math id="inf102"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mn>1</mml:mn><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> generated by uniformly sampling between 1 and <inline-formula><mml:math id="inf103"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> initial compartments, each of which can uniformly take any of the <inline-formula><mml:math id="inf104"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> possible Boolean indices. We use the prescription described in <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> to update the system in discrete timesteps starting from the initial condition. Since this is a deterministic dynamical system over a discrete state space, once sufficient time has elapsed all trajectories will converge onto one or more periodic orbits: a set of states which form a cycle under updates. Each rule will in general have many periodic orbits as attractors, and different initial conditions can converge to different orbits. For each initial condition, we run the system for 1024 timesteps or until it reaches a periodic orbit. A period-1 orbit, which updates to itself, is particularly relevant: it is a homeostatic state (<xref ref-type="fig" rid="fig1">Figure 1B,E</xref>). We store all such homeostatic vesicle traffic networks for further analysis. A trivial state is one in which no compartment connects to any other. In our simulations for <inline-formula><mml:math id="inf105"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula>, 98% of initial conditions reached an orbit within 1024 steps, of which 72% were homeostatic states. In total we found 17,458, 16,248, 15,382, and 14,809 homeostatic states (of which 9456, 8990, 8778, and 8614 were non-trivial) for <inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula>, respectively.</p></sec><sec id="s4-3"><title>Vesicle traffic motifs</title><p>In a homeostatic steady state, the full set of compartments remains constant, though individual compartments can interconvert between one another. We can represent each steady state as a graph (<xref ref-type="fig" rid="fig1">Figure 1C,F</xref>), where nodes <inline-formula><mml:math id="inf107"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> are compartments, and there are three types of edges: vesicle edges, creation edges, and maturation edges. Vesicle edges (black) go from source to target compartments: <inline-formula><mml:math id="inf108"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> wherever <inline-formula><mml:math id="inf109"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mi>F</mml:mi><mml:mo>'</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Creation edges (brown) connect source compartments to newly created compartments generated by homotypic fusion of orphan vesicles (<xref ref-type="disp-formula" rid="equ6">Equation 6</xref>): <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> for each vesicle such that <inline-formula><mml:math id="inf111"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>J</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf112"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi><mml:mtext> </mml:mtext><mml:mo>∉</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mo>∪</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>J</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">←</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Maturation edges (blue) connect compartment compositions at two successive timepoints (<xref ref-type="disp-formula" rid="equ5">Equation 5</xref>): <inline-formula><mml:math id="inf113"><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>→</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, unless the compartment is in transport balance such that <inline-formula><mml:math id="inf114"><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. A compartment is considered to be involved in a maturation step if it has an outgoing maturation edge. Considering only creation and maturation edges, there are 43,700 distinct connected three-compartment motifs. A maturation chain starts at a compartment with an incoming creation edge, and proceeds via maturation edges, stopping at a compartment with no outgoing maturation edge. If a compartment encountered earlier in the chain is repeated, this indicates a cycle so the chain is terminated before the repeat, and the cycle is stored for further analysis (<xref ref-type="fig" rid="fig4">Figure 4A,B</xref>).</p></sec><sec id="s4-4"><title>Randomly shuffled vesicle traffic networks</title><p>One way to generate a random graph is to preserve the number and properties of individual nodes, but otherwise connect them at random (<xref ref-type="bibr" rid="bib1">Albert and Barabási, 2002</xref>). For each homeostatic network in our dataset, we break the network into individual compartments, then reconnect them as follows. We remove all vesicle edges. We then randomly swap remaining edge targets, allowing only swaps between maturation edges or between creation edges. We reject the swap if: a self edge is lost; a self edge is created; or multiple edges of the same type arise between the same source and target nodes. This procedure preserves all individual node properties: self edges, and the separate indegrees and outdegrees of creation and maturation edges. We generate 1000 randomly shuffled networks for each original network. We find that these shuffled networks have precisely the same distribution of motif frequencies and maturation chain lengths as the original networks (<xref ref-type="fig" rid="fig3">Figure 3A,BC</xref>). This supports the idea that a random graph generation approach might capture relevant features of vesicle traffic networks.</p></sec><sec id="s4-5"><title>Spatial optimization</title><p>We want to distribute the compartments of a vesicle traffic network in such a way that all parts of a cell are close to at least one compartment, while the distance travelled by vesicles between compartments is minimized (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Let <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> give the vector position of each compartment <italic>i</italic>, so pairwise distances between compartments are <inline-formula><mml:math id="inf116"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Define an energy function:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf117"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if a vesicle goes from compartment <italic>i</italic> to compartment <italic>j</italic>, and <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> sets a baseline value. By varying compartment positions to minimize this function, we achieve the desired optimal configuration. Intuitively: compartments act as repelling charges and spread out as uniformly as possible, while vesicle fluxes act as attractive springs and try to be as short as possible. Starting from random initial conditions, we numerically determined the optimal minimum energy compartment positions in two dimensions.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>MT was supported in part by a Wellcome Trust-DBT India Alliance Intermediate Fellowship (500103/Z/09/Z). We thank Joel Dacks, Anjali Jaiman, Ramya Purkanti, and Madan Rao for useful discussions.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>SM, Acquisition of data, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con2"><p>MT, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albert</surname><given-names>R</given-names></name><name><surname>Barabási</surname><given-names>A-L</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Statistical mechanics of complex networks</article-title><source>Reviews of Modern Physics</source><volume>74</volume><fpage>47</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1103/RevModPhys.74.47</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bard</surname><given-names>F</given-names></name><name><surname>Malhotra</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The formation of TGN-to-plasma-membrane transport carriers</article-title><source>Annual Review of Cell and Developmental Biology</source><volume>22</volume><fpage>439</fpage><lpage>455</lpage><pub-id pub-id-type="doi">10.1146/annurev.cellbio.21.012704.133126</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Binder</surname><given-names>B</given-names></name><name><surname>Goede</surname><given-names>A</given-names></name><name><surname>Berndt</surname><given-names>N</given-names></name><name><surname>Holzhütter</surname><given-names>HG</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A conceptual mathematical model of the dynamic self-organisation of distinct cellular organelles</article-title><source>PLoS ONE</source><volume>4</volume><elocation-id>e8295</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0008295</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonfanti</surname><given-names>L</given-names></name><name><surname>Mironov</surname><given-names>AA</given-names></name><name><surname>Martínez-Menárguez</surname><given-names>JA</given-names></name><name><surname>Martella</surname><given-names>O</given-names></name><name><surname>Fusella</surname><given-names>A</given-names></name><name><surname>Baldassarre</surname><given-names>M</given-names></name><name><surname>Buccione</surname><given-names>R</given-names></name><name><surname>Geuze</surname><given-names>HJ</given-names></name><name><surname>Mironov</surname><given-names>AA</given-names></name><name><surname>Luini</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Procollagen traverses the Golgi stack without leaving the lumen of cisternae: evidence for cisternal maturation</article-title><source>Cell</source><volume>95</volume><fpage>993</fpage><lpage>1003</lpage><pub-id pub-id-type="doi">10.1016/s0092-8674(00)81723-7</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonifacino</surname><given-names>JS</given-names></name><name><surname>Lippincott-Schwartz</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Coat proteins: shaping membrane transport</article-title><source>Nature Reviews Molecular Cell Biology</source><volume>4</volume><fpage>409</fpage><lpage>414</lpage><pub-id pub-id-type="doi">10.1038/nrm1099</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chaves</surname><given-names>M</given-names></name><name><surname>Albert</surname><given-names>R</given-names></name><name><surname>Sontag</surname><given-names>ED</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Robustness and fragility of Boolean models for genetic regulatory networks</article-title><source>Journal of Theoretical Biology</source><volume>235</volume><fpage>431</fpage><lpage>449</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2005.01.023</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>D'Souza-Schorey</surname><given-names>C</given-names></name><name><surname>Chavrier</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>ARF proteins: roles in membrane traffic and beyond</article-title><source>Nature Reviews Molecular Cell Biology</source><volume>7</volume><fpage>347</fpage><lpage>358</lpage><pub-id pub-id-type="doi">10.1038/nrm1910</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Matteis</surname><given-names>MA</given-names></name><name><surname>Luini</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Exiting the Golgi complex</article-title><source>Nature Reviews Molecular Cell Biology</source><volume>9</volume><fpage>273</fpage><lpage>284</lpage><pub-id pub-id-type="doi">10.1038/nrm2378</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dmitrieff</surname><given-names>S</given-names></name><name><surname>Rao</surname><given-names>M</given-names></name><name><surname>Sens</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Quantitative analysis of intra-Golgi transport shows intercisternal exchange for all cargo</article-title><source>Proceedings of the National Academy of Sciences</source><volume>110</volume><fpage>15692</fpage><lpage>15697</lpage><pub-id pub-id-type="doi">10.1073/pnas.1303358110</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dmitrieff</surname><given-names>S</given-names></name><name><surname>Sens</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Cooperative protein transport in cellular organelles</article-title><source>Physical Review E</source><volume>83</volume><elocation-id>041923</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.83.041923</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emr</surname><given-names>S</given-names></name><name><surname>Glick</surname><given-names>BS</given-names></name><name><surname>Linstedt</surname><given-names>AD</given-names></name><name><surname>Lippincott-Schwartz</surname><given-names>J</given-names></name><name><surname>Luini</surname><given-names>A</given-names></name><name><surname>Malhotra</surname><given-names>V</given-names></name><name><surname>Marsh</surname><given-names>BJ</given-names></name><name><surname>Nakano</surname><given-names>A</given-names></name><name><surname>Pfeffer</surname><given-names>SR</given-names></name><name><surname>Rabouille</surname><given-names>C</given-names></name><name><surname>Rothman</surname><given-names>JE</given-names></name><name><surname>Warren</surname><given-names>G</given-names></name><name><surname>Wieland</surname><given-names>FT</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Journeys through the Golgi--taking stock in a new era</article-title><source>The Journal of Cell Biology</source><volume>187</volume><fpage>449</fpage><lpage>453</lpage><pub-id pub-id-type="doi">10.1083/jcb.200909011</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fernández</surname><given-names>A</given-names></name><name><surname>Lynch</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Non-adaptive origins of interactome complexity</article-title><source>Nature</source><volume>474</volume><fpage>502</fpage><lpage>505</lpage><pub-id pub-id-type="doi">10.1038/nature09992</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname><given-names>DT</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Stochastic simulation of chemical kinetics</article-title><source>Annual Review of Physical Chemistry</source><volume>58</volume><fpage>35</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.1146/annurev.physchem.58.032806.104637</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glick</surname><given-names>BS</given-names></name><name><surname>Elston</surname><given-names>T</given-names></name><name><surname>Oster</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>A cisternal maturation mechanism can explain the asymmetry of the Golgi stack</article-title><source>FEBS Letters</source><volume>414</volume><fpage>177</fpage><lpage>181</lpage><pub-id pub-id-type="doi">10.1016/s0014-5793(97)00984-8</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glick</surname><given-names>BS</given-names></name><name><surname>Luini</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Models for Golgi traffic: a critical assessment</article-title><source>Cold Spring Harbor Perspectives in Biology</source><volume>3</volume><elocation-id>a005215</elocation-id><pub-id pub-id-type="doi">10.1101/cshperspect.a005215</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinrich</surname><given-names>R</given-names></name><name><surname>Rapoport</surname><given-names>TA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Generation of nonidentical compartments in vesicular transport systems</article-title><source>The Journal of Cell Biology</source><volume>168</volume><fpage>271</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1083/jcb.200409087</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huotari</surname><given-names>J</given-names></name><name><surname>Helenius</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Endosome maturation</article-title><source>The EMBO Journal</source><volume>30</volume><fpage>3481</fpage><lpage>3500</lpage><pub-id pub-id-type="doi">10.1038/emboj.2011.286</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ispolatov</surname><given-names>I</given-names></name><name><surname>Müsch</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A model for the self-organization of vesicular flux and protein distributions in the Golgi apparatus</article-title><source>PLoS Computational Biology</source><volume>9</volume><elocation-id>e1003125</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003125</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jahn</surname><given-names>R</given-names></name><name><surname>Scheller</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>SNAREs--engines for membrane fusion</article-title><source>Nature Reviews Molecular Cell Biology</source><volume>7</volume><fpage>631</fpage><lpage>643</lpage><pub-id pub-id-type="doi">10.1038/nrm2002</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kauffman</surname><given-names>S</given-names></name><name><surname>Peterson</surname><given-names>C</given-names></name><name><surname>Samuelsson</surname><given-names>B</given-names></name><name><surname>Troein</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Random Boolean network models and the yeast transcriptional network</article-title><source>Proceedings of the National Academy of Sciences</source><volume>100</volume><fpage>14796</fpage><lpage>14799</lpage><pub-id pub-id-type="doi">10.1073/pnas.2036429100</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>F</given-names></name><name><surname>Long</surname><given-names>T</given-names></name><name><surname>Lu</surname><given-names>Y</given-names></name><name><surname>Ouyang</surname><given-names>Q</given-names></name><name><surname>Tang</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The yeast cell-cycle network is robustly designed</article-title><source>Proceedings of the National Academy of Sciences</source><volume>101</volume><fpage>4781</fpage><lpage>4786</lpage><pub-id pub-id-type="doi">10.1073/pnas.0305937101</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Losev</surname><given-names>E</given-names></name><name><surname>Reinke</surname><given-names>CA</given-names></name><name><surname>Jellen</surname><given-names>J</given-names></name><name><surname>Strongin</surname><given-names>DE</given-names></name><name><surname>Bevis</surname><given-names>BJ</given-names></name><name><surname>Glick</surname><given-names>BS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Golgi maturation visualized in living yeast</article-title><source>Nature</source><volume>441</volume><fpage>1002</fpage><lpage>1006</lpage><pub-id pub-id-type="doi">10.1038/nature04717</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luini</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A brief history of the cisternal progression-maturation model</article-title><source>Cellular Logistics</source><volume>1</volume><fpage>6</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.4161/cl.1.1.14693</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lynch</surname><given-names>M</given-names></name><name><surname>Conery</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The origins of genome complexity</article-title><source>Science</source><volume>302</volume><fpage>1401</fpage><lpage>1404</lpage><pub-id pub-id-type="doi">10.1126/science.1089370</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lynch</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The frailty of adaptive hypotheses for the origins of organismal complexity</article-title><source>Proceedings of the National Academy of Sciences</source><volume>104</volume><fpage>8597</fpage><lpage>8604</lpage><pub-id pub-id-type="doi">10.1073/pnas.0702207104</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lynch</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The evolution of genetic networks by non-adaptive processes</article-title><source>Nature Reviews Genetics</source><volume>8</volume><fpage>803</fpage><lpage>813</lpage><pub-id pub-id-type="doi">10.1038/nrg2192</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mani</surname><given-names>S</given-names></name><name><surname>Thattai</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Wine glasses and hourglasses: Non-adaptive complexity of vesicle traffic in microbial eukaryotes</article-title><source>Molecular and Biochemical Parasitology</source><elocation-id>S0166-6851(16)30023-8</elocation-id><pub-id pub-id-type="doi">10.1016/j.molbiopara.2016.03.006</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsuura-Tokita</surname><given-names>K</given-names></name><name><surname>Takeuchi</surname><given-names>M</given-names></name><name><surname>Ichihara</surname><given-names>A</given-names></name><name><surname>Mikuriya</surname><given-names>K</given-names></name><name><surname>Nakano</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Live imaging of yeast Golgi cisternal maturation</article-title><source>Nature</source><volume>441</volume><fpage>1007</fpage><lpage>1010</lpage><pub-id pub-id-type="doi">10.1038/nature04737</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milo</surname><given-names>R</given-names></name><name><surname>Shen-Orr</surname><given-names>S</given-names></name><name><surname>Itzkovitz</surname><given-names>S</given-names></name><name><surname>Kashtan</surname><given-names>N</given-names></name><name><surname>Chklovskii</surname><given-names>D</given-names></name><name><surname>Alon</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Network motifs: simple building blocks of complex networks</article-title><source>Science</source><volume>298</volume><fpage>824</fpage><lpage>827</lpage><pub-id pub-id-type="doi">10.1126/science.298.5594.824</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Misteli</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>The concept of self-organization in cellular architecture</article-title><source>The Journal of Cell Biology</source><volume>155</volume><fpage>181</fpage><lpage>186</lpage><pub-id pub-id-type="doi">10.1083/jcb.200108110</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mowbrey</surname><given-names>K</given-names></name><name><surname>Dacks</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Evolution and diversity of the Golgi body</article-title><source>FEBS Letters</source><volume>583</volume><fpage>3738</fpage><lpage>3745</lpage><pub-id pub-id-type="doi">10.1016/j.febslet.2009.10.025</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Munro</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Organelle identity and the organization of membrane traffic</article-title><source>Nature Cell Biology</source><volume>6</volume><fpage>469</fpage><lpage>472</lpage><pub-id pub-id-type="doi">10.1038/ncb0604-469</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakano</surname><given-names>A</given-names></name><name><surname>Luini</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Passage through the Golgi</article-title><source>Current Opinion in Cell Biology</source><volume>22</volume><fpage>471</fpage><lpage>478</lpage><pub-id pub-id-type="doi">10.1016/j.ceb.2010.05.003</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papanikou</surname><given-names>E</given-names></name><name><surname>Day</surname><given-names>KJ</given-names></name><name><surname>Austin</surname><given-names>J</given-names></name><name><surname>Glick</surname><given-names>BS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>COPI selectively drives maturation of the early Golgi</article-title><source>eLife</source><volume>4</volume><elocation-id>e13232</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.13232</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poteryaev</surname><given-names>D</given-names></name><name><surname>Datta</surname><given-names>S</given-names></name><name><surname>Ackema</surname><given-names>K</given-names></name><name><surname>Zerial</surname><given-names>M</given-names></name><name><surname>Spang</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Identification of the switch in early-to-late endosome transition</article-title><source>Cell</source><volume>141</volume><fpage>497</fpage><lpage>508</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2010.03.011</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramadas</surname><given-names>R</given-names></name><name><surname>Thattai</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>New organelles by gene duplication in a biophysical model of eukaryote endomembrane evolution</article-title><source>Biophysical Journal</source><volume>104</volume><fpage>2553</fpage><lpage>2563</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2013.03.066</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rink</surname><given-names>J</given-names></name><name><surname>Ghigo</surname><given-names>E</given-names></name><name><surname>Kalaidzidis</surname><given-names>Y</given-names></name><name><surname>Zerial</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Rab conversion as a mechanism of progression from early to late endosomes</article-title><source>Cell</source><volume>122</volume><fpage>735</fpage><lpage>749</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2005.06.043</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Adaptable adaptors for coated vesicles</article-title><source>Trends in Cell Biology</source><volume>14</volume><fpage>167</fpage><lpage>174</lpage><pub-id pub-id-type="doi">10.1016/j.tcb.2004.02.002</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stenmark</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Rab GTPases as coordinators of vesicle traffic</article-title><source>Nature Reviews Molecular Cell Biology</source><volume>10</volume><fpage>513</fpage><lpage>525</lpage><pub-id pub-id-type="doi">10.1038/nrm2728</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taniguchi</surname><given-names>E</given-names></name><name><surname>Noritake</surname><given-names>M</given-names></name><name><surname>Yamada</surname><given-names>T</given-names></name><name><surname>Izumitani</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Optimal size and location planning of public logistics terminals</article-title><source>Transportation Research Part E: Logistics and Transportation Review</source><volume>35</volume><fpage>207</fpage><lpage>222</lpage><pub-id pub-id-type="doi">10.1016/S1366-5545(99)00009-5</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traub</surname><given-names>LM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Tickets to ride: selecting cargo for clathrin-regulated internalization</article-title><source>Nature Reviews Molecular Cell Biology</source><volume>10</volume><fpage>583</fpage><lpage>596</lpage><pub-id pub-id-type="doi">10.1038/nrm2751</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Bergeijk</surname><given-names>P</given-names></name><name><surname>Adrian</surname><given-names>M</given-names></name><name><surname>Hoogenraad</surname><given-names>CC</given-names></name><name><surname>Kapitein</surname><given-names>LC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Optogenetic control of organelle transport and positioning</article-title><source>Nature</source><volume>518</volume><fpage>111</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1038/nature14128</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weiss</surname><given-names>M</given-names></name><name><surname>Nilsson</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Protein sorting in the Golgi apparatus: a consequence of maturation and triggered sorting</article-title><source>FEBS Letters</source><volume>486</volume><fpage>2</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1016/S0014-5793(00)02155-4</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wickner</surname><given-names>W</given-names></name><name><surname>Schekman</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Membrane fusion</article-title><source>Nature Structural &amp; Molecular Biology</source><volume>15</volume><fpage>658</fpage><lpage>664</lpage><pub-id pub-id-type="doi">10.1038/nsmb.1451</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yadav</surname><given-names>S</given-names></name><name><surname>Linstedt</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Golgi positioning</article-title><source>Cold Spring Harbor Perspectives in Biology</source><volume>3</volume><elocation-id>a005322</elocation-id><pub-id pub-id-type="doi">10.1101/cshperspect.a005322</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>IM</given-names></name><name><surname>Hughson</surname><given-names>FM</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Tethering factors as organizers of intracellular vesicular traffic</article-title><source>Annual Review of Cell and Developmental Biology</source><volume>26</volume><fpage>137</fpage><lpage>156</lpage><pub-id pub-id-type="doi">10.1146/annurev.cellbio.042308.113327</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.16231.012</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Glick</surname><given-names>Benjamin S</given-names></name><role>Reviewing editor</role><aff id="aff3"><institution>The University of Chicago</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Stacking the odds for Golgi cisternal maturation&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom, Benjamin Glick, also guest edited the paper, and the evaluation has been overseen by Randy Schekman as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Alberto Luini (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This paper explores the dynamic organization of the Golgi by a theoretical modeling of Boolean networks. The simplicity of the approach enables the authors to perform an unbiased survey of a large number of possible vesicle trafficking scenarios. A surprising and striking result is that many of the networks display the properties of compartmental maturation. Thus, the evolution of Golgi maturation can be viewed as a natural outcome of the intrinsic properties of vesicle trafficking systems. According to this view, the transport of large secretory cargo molecules was probably an adaptation that took advantage of an existing process.</p><p>Essential revisions:</p><p>The reviewers and reviewing editor had an interesting discussion about your paper. Multiple concerns were raised, and initially it seemed likely that the decision would be to decline the submission. In the end, we agreed that the story is interesting enough to merit a request for resubmission after major revisions. There is no guarantee that the revised version will pass muster, so you will need to decide whether the effort is worthwhile.</p><p>There is general agreement that the idea of approaching this problem with Boolean networks is creative and novel, and that the results are an important step forward if the approach is sound. But the following issues need to be addressed.</p><p>1) Your model assumes that compartment identity is determined by transmembrane and luminal components, which are necessarily exchanged by means of transport vesicles. But in reality, components recruited from the cytosol, such as GTPases and adaptors/coats and phosphoinositide modifying enzymes, play an important and perhaps central role in defining compartment identity. In some cases, Rab cascades are thought to regulate compartmental maturation. While your model necessarily is necessarily a simplified representation of reality, overlooking this fundamental property of the endomembrane system seems hard to justify.</p><p>2) The focus of your analysis is on the subset of networks that include maturation chains. But the majority of the networks do not show maturation. The neglect of those other outcomes is surprising. For example, how often is the traditional vesicle shuttle model replicated? What can be learned from analyzing the full set of networks?</p><p>3) The assumption that vesicles unable to find a target undergo homotypic fusion is troubling. This process may reflect the actual behavior of some vesicle types in cells, but why is homotypic fusion the default assumption? Does this feature predispose the model to generate maturing networks? Why wouldn't orphan vesicles fuse heterotypically, like other vesicles do?</p><p>4) The treatment of spatiotemporal aspects of membrane traffic raised two issues:</p><p>The description of virtual stacking (<xref ref-type="fig" rid="fig4">Figure 4</xref>) is not at all compelling. What is the justification for modeling vesicle fluxes as attractive springs while modeling compartments as repelling charges? That representation does not seem to correspond to any realistic picture of membrane traffic. This part of the story weakens the paper, and should probably be omitted unless it can be revised in a way that makes sense.</p><p>One of the reviewers was quite troubled by the lack of spatiotemporal parameters in your model (transport coefficients, distances, compartment sizes, etc). The other two reviewers were of the opinion that the cytoplasm is well mixed, so it is reasonable to assume that vesicles will reach any potential destination. But to convince the skeptical reviewer and other readers, you should explain why spatiotemporal parameters can be ignored for the purposes of your simulation. In particular, the markers used in your simulation reach a steady-state homeostatic distribution, but is it automatically true that all of the other components, such as lipids, will also undergo balanced flows in a given network? Does your model require the unrealistic assumption that every compartment generates the same number and size of vesicles per unit time? Is it obvious that movement between compartment is fast relative to formation and fusion of vesicles, so that spatial aspects can be neglected?</p><p>5) In general, the descriptions and discussion need to be expanded significantly to address the questions that will be raised by cell biologists. Perhaps it would be useful to rewrite the paper with input from a cell/membrane biologist. Here are examples of issues that should be addressed:</p><p>The introduction is too generic. It does not even mention the Boolean modeling approach, and does not describe either the power and limitations of this approach or the reasons for choosing it to address this particular topic.</p><p>The difference between actual and randomized networks in <xref ref-type="fig" rid="fig2">Figure 2A–C</xref> is confusing, and the significance of <xref ref-type="fig" rid="fig2">Figure 2D,E</xref> is hard to understand. Similarly, in <xref ref-type="fig" rid="fig3">Figure 3</xref>, what is the difference between special pairs and random pairs? The parameters and assumptions should be clearly described in terms that will make sense to cell biologists.</p><p>The phenomenon of compartments becoming richer in compositional complexity over time has not been described experimentally, and doesn't seem to make biological sense. Can you comment on this discrepancy?</p><p>Regarding the maturation chains, one reviewer wrote: &quot;However, these striking observations are not clearly interpretable. The authors should provide much more detail on the characteristics of these chains, on the dynamics of their development, and on the number of the chains that possess these particularly complex features. They should also describe the networks that do not contain maturation chains, which actually represent the majority of the outcomes. They should discuss which parameters lead to realistic maturation chains, and which preclude maturation. What is interesting to me is not the fact that they observe maturation as this outcome is expected, but the fact that the maturation networks are so complex and so similar to the real ones, and so frequent. Again they should thoroughly describe the maturation chains, the alternative outcomes and the conditions where they obtain. Without this description we cannot judge the value of the simulations.&quot;</p><p>Do the authors wish to argue that their simulations reflect a potentially simpler situation early in evolution, and are therefore not constrained to incorporate features of currently existing trafficking systems? If so, they should make this point explicitly.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Stacking the odds for Golgi cisternal maturation&quot; for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by Randy Schekman (Senior editor) and three reviewers, one of whom is a member of our Board of Reviewing Editors.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</p><p>Once again the reviewers had an extended discussion of your manuscript. As before, one of the reviewers remains deeply concerned about the lack of spatiotemporal parameters in the simulations, while the other two reviewers feel that your approach makes sense and yields intriguing insights. After judging these arguments, I am prepared to accept your manuscript if you can address the following remaining issues either by revising the paper or by explaining why a revision is not warranted.</p><p>1) Even though the basic patterns of compartmental formation and communication can be described by the Boolean network approach, spatiotemporal parameters are clearly important in real cells to ensure that the membrane traffic machinery is efficient enough to support life. This point should be given further emphasis.</p><p>More generally, you should discuss the limitations of the described approach. Does the model make testable, falsifiable predictions? I suspect that this one can be addressed by the presentation. For example, if you predicted that maturation chains could have evolved without specific selection for the transport of large cargo, then the modeling matches this prediction. But are other aspects of membrane traffic not captured by your simple model?</p><p>2) The authors should discuss how to arrive at the Boolean network approach from a set of (partial) differential equations (similar to Heinrich/Rapoport's model or starting from overdamped Fokker-Planck equations). In particular: Which rates and transport coefficients are considered large or limiting w.r.t others, i.e. which quasi-equilibria are used for setting up the model from more fundamental approaches?</p><p>3) The biological meanings of the propensity parameters for budding and fusion are still unclear. Please provide an explanation. For example, does propensity to fuse reflect the spatial proximity of vesicle donor and acceptor compartments?</p><p>4) The assumption that orphan vesicles fuse homotypically continues to be troubling. You may not have fully understood the concern raised during the initial submission, so let's try again.</p><p>Vesicles are normally expected to fuse heterotypically. If a vesicle fails to find a target compartment, why should it then fuse homotypically? Why couldn't a vesicle of one type fuse heterotypically with a vesicle of another type? A priori, such heterotypic vesicle fusion may be more likely than homotypic vesicle fusion given that vesicles normally undergo heterotypic fusion with a target compartment.</p><p>The concern is that if homotypic vesicle fusion is programmed into the model as the default fallback option, then the model may be biased toward compartment formation and subsequent maturation.</p><p>5) Designating a GTPase that cycles through the cytoplasm as being formally equivalent to a vesicle is confusing. If your formalism treats a vesicle and a reversibly associating peripheral membrane protein as being equivalent, you should consider a term other than &quot;vesicle&quot;. Maybe &quot;carrier&quot; would be more generic, and &quot;membrane traffic&quot; could be used rather than &quot;vesicle traffic&quot;?</p><p>6) At least some lipids can actually move via nonvesicular as well as vesicular pathways. The discussion of lipids may now be overly complex. The bottom line is that some components can only exchange between compartments via membrane vesicles (e.g., transmembrane proteins), some components could exchange either in vesicles or through the cytoplasm (e.g., certain lipids), and some components probably exchange only through the cytoplasm (e.g., certain GTPases).</p><p>7) Relevant to #7 above: does the model take into account the fact that the various components traveling from one particular compartment to another could travel at different times and at different rates? Maybe this point is implicit in the model, but it's hard to tell.</p><p>8) I didn't understand the discussion in the Results section about large global structures and shuffling the edges of a network. Is this issue important? If so, it should be explained better. If not, it should be omitted.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Stacking the odds for Golgi cisternal maturation&quot; for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by Randy Schekman (Senior editor) and a Reviewing editor.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</p><p>This manuscript has been extensively revised and extended, and is now a substantial contribution that will stimulate thinking in the field. I see no benefit in putting it through another round of review because the key concerns have been addressed. But I will ask the authors to address a few very minor comments about the new &quot;Orphan vesicles and homotypic fusion&quot; section.</p><p>1) In cells, many compartments fuse homotypically. For clarity, you should state the assumption that compartments cannot fuse heterotypically with one another.</p><p>2) The first paragraph in this section is now perhaps more complex than necessary, and is a bit confusing as a result. For example, I have trouble figuring out what this sentence means: &quot;This is rare: in almost all instances we explored, at least some fusion products of orphans were themselves orphans; in the majority of instances even the initial orphans could not fuse with one-another.&quot;</p><p>3) &quot;one another&quot; is two words.</p><p>Please make these changes and submit a final version.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.16231.013</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p> <italic>1) Your model assumes that compartment identity is determined by transmembrane and luminal components, which are necessarily exchanged by means of transport vesicles. But in reality, components recruited from the cytosol, such as GTPases and adaptors/coats and phosphoinositide modifying enzymes, play an important and perhaps central role in defining compartment identity. In some cases, Rab cascades are thought to regulate compartmental maturation. While your model necessarily is necessarily a simplified representation of reality, overlooking this fundamental property of the endomembrane system seems hard to justify.</italic> </p><p>Our Boolean framework in fact does incorporate cytoplasmic molecules such as Rab GTPases. For brevity we did not focus on this aspect in the original submission, and apologize for giving the impression that we have ignored these key components. To explicitly keep track of such players we can interpret any “vesicles” with only a single nonzero molecular component as a single molecule type moving directly through the cytoplasm. We must then add an explicit label to track the flow of membrane lipids on true vesicles. This is of course optional and a matter of interpretation, since in any case we have only considered a subset of all possible molecules in a vesicle traffic system. It would be interesting to ask what proportion of the molecules of a traffic network are transmembrane type (SNARE-like) and what proportion are membrane-associated (Rab-like). This type of analysis can be done within our framework, and would indeed be interesting to do, but takes us beyond the subject of this submission.</p><p><xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> discusses an example explicitly including Rab GTPases and their regulators. The text has also been modified to emphasize these non-vesicular transport pathways:</p><p>Third paragraph of Results section: “N types of membrane-associated, transmembrane or lumenal molecules”</p><p>Sixth paragraph of Results section: “Among active labels the Arf- and Rab-family GTPases […] explicitly assigning a label to membrane lipids.”</p><p>Sixth paragraph of Results section: “Though GTPases diversified early in eukaryote evolution […] we do not explicitly distinguish between the Rab- centric and SNARE-centric views.”</p><p>First paragraph of Methods section: “Vesicles with a single non-zero label may optionally be interpreted as membrane- associated molecules capable of cytoplasmic non-vesicular transport (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).”</p><p> <italic>2) The focus of your analysis is on the subset of networks that include maturation chains. But the majority of the networks do not show maturation. The neglect of those other outcomes is surprising. For example, how often is the traditional vesicle shuttle model replicated? What can be learned from analyzing the full set of networks?</italic> </p><p>We had analyzed the full set of networks in the original submission, but had only emphasized the key point that cisternal maturation is the single most common type of motif. In this revision we provide much more extensive discussion of the properties of all networks beyond cisternal maturation, and also carry out new analysis. Note that we now discuss all types of networks, including the traditional transport balanced version, as shown in <xref ref-type="fig" rid="fig2">Figures 2B,F</xref>. Apart from this we provide several additions.</p><p>First, we explain our sampling procedure more carefully (“Sampling homeostatic vesicle traffic networks”). To generate diverse networks, we actually sample by sweeping over parameters corresponding to the number of molecular labels, the number of adaptor/coatomer types, and how permissive vesicles were in selecting cargo and fusion targets. For each parameter combination we get different types of networks, as discussed in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>. We can explore how various network properties depend on one another, as we do in <xref ref-type="fig" rid="fig2">Figure 2F–I</xref>, and <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A–E</xref>.</p><p>Second, we explicitly separate out the “trivial” networks. In about half our sampled data, the networks end up in a state where each compartment is completely disconnected from all the others. In real cells this would probably correspond to a completely inactive, perhaps dead, cell. Out of 14,809 homeostatic networks, only 8,614 are non-trivial. It is only among the latter that we should look for any structure at all.</p><p>Third, we emphasize that our search for network motifs is completely unbiased. In the original submission we had only discussed the three most frequent motifs (present <xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><p>We now also discuss all 43,700 potential motifs, and the occurrence of the 100 most frequent motifs (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). The main lesson here is the following: there is indeed a great diversity in the structures that we find among our tens of thousands of networks. But half the non-trivial networks (4,024/8,614) contain a maturation chain. The other half contain hundreds of diverse motifs, each occurring infrequently; no single motif is prominent. To emphasize this, in the abstract we now describe the maturation chain as occurring in “the plurality” of traffic networks (borrowing from the political term in which the single largest party wins the vote).</p><p>Finally, we emphasize the following: we are not claiming that all vesicle traffic networks contain maturation chains. We did not put this into our framework by hand, and so we naturally see a lot of diversity. However, the maturation chain does occur in about half of all non-trivial networks. This makes it easily “discoverable” by neutral evolutionary search. In the discussion we make the point that even structures that seem likely in complex systems typically require fine-tuning of parameters, whereas cisternal maturation spontaneously arises in half the non-trivial networks.</p><p><xref ref-type="fig" rid="fig2">Figure 2B,C,F</xref> discuss the properties of different types of networks in our dataset, and show the parameter ranges where cisternal maturation is likely to occur. <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> shows the top 10 network motifs. The text has been modified as follows, discussing the properties of all our networks in more detail:</p><p>Abstract: “the plurality of networks contain chains of compartments…</p><p>Results section, subsection “Sampling homeostatic vesicle traffic networks”: To systematically explore diverse behaviors […] sampled uniformly over these parameters.”</p><p>Results section, subsection “Sampling homeostatic vesicle traffic networks”: “90% had 8 or fewer compartments […]”</p><p>Results section, subsection “Cell-like networks and vesicle traffic motifs”: “Cell-like networks are most likely to contain maturation chains at low-to-moderate […]”</p><p>Results section, subsection “Cell-like networks and vesicle traffic motifs”: “Nearly half the non-trivial homeostatic networks (4,024/8,614) contained a maturation chain of length one or more. We wondered whether the other half were characterized by other distinct features […]”</p><p><xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> figure legend: “The 15th most common three-compartment motif, occurring in 344 networks, is the maturation cycle (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). This corresponds to a compartment whose composition oscillates periodically. Cycles of various periods occur in about a quarter (2,407/8,614) of all homeostatic networks.”</p><p>Results section, subsection “Cell-like networks and vesicle traffic motifs”: “We next checked if our networks contained any large global structures, beyond the scale of local motifs […]”</p><p>First paragraph of Discussion section: “For comparison consider a biological system described by ten parameters” “[…] most types of structures are rare and require fine-tuning of parameters.”</p><p> <italic>3) The assumption that vesicles unable to find a target undergo homotypic fusion is troubling. This process may reflect the actual behavior of some vesicle types in cells, but why is homotypic fusion the default assumption? Does this feature predispose the model to generate maturing networks? Why wouldn't orphan vesicles fuse heterotypically, like other vesicles do?</italic> </p><p>We apologize for not discussing this point in detail in the original submission. The key restrictive assumption we have made is that heterotypic vesicle fusion does not occur. Our Boolean framework can accommodate heterotypic fusion, and it would be interesting to explore the role of such processes further. But it takes us beyond the topic of the present submission. Regarding homotypic fusion, it is also reasonable to ask why we assume all orphan vesicles can homotypically fuse. This is in fact not a restrictive assumption as long as we are only interested in the homeostatic states, as explained in the revised text. We could, if we wish, assume that only certain pre-defined vesicle subsets can undergo homotypic fusion. Once we run to homeostasis, only such orphan vesicles would be present in the final state. If we now explore over all possible vesicle subsets, we get precisely the same set of homeostatic states. Note that the transient period before we approach homeostasis would indeed be affected by this assumption that all orphan vesicles can fuse. We can use the Boolean framework plus additional ingredients involving homotypic or heterotypic fusion to study in detail how a traffic system recovers homeostasis after a perturbation, and this is an interesting future question to ask.</p><p>The text has been modified to discuss these issues:</p><p>Fourth paragraph of Results section: “Alternatively assuming only a certain subset of vesicles can undergo homotypic fusion (and exploring over all possible subsets) does not change our results: since no state with accumulating un-fused orphan vesicles can be homeostatic, all orphan vesicles in any homeostatic states we find must fall into this subset. Our approach can be extended to allow heterotypic fusion, or to allow vesicles to simultaneously nucleate new compartments and fuse to existing ones. Additional rules are needed to specify when such processes occur, and we do not consider them here.”</p><p> <italic>4) The treatment of spatiotemporal aspects of membrane traffic raised two issues:</italic> </p><p> <italic>The description of virtual stacking (<xref ref-type="fig" rid="fig4">Figure 4</xref>) is not at all compelling. What is the justification for modeling vesicle fluxes as attractive springs while modeling compartments as repelling charges? That representation does not seem to correspond to any realistic picture of membrane traffic. This part of the story weakens the paper, and should probably be omitted unless it can be revised in a way that makes sense.</italic> </p><p>We apologize; the brief description of this issue in the original text was confusing. We have modified this section in the revision after getting feedback from colleagues about clarity.</p><p>We have first started the discussion by motivating the background on compartment spatial localization. We have removed the confusing term “virtual stacking” and have explained the motivation of this analysis. It is a speculative analysis which is why we left it to the Discussion section. Briefly: Spatial locations of compartments are caused by many layers of biophysical mechanisms. We were speculating about the potential function of the precise locations. In particular, we explored whether any of the results from the theory of logistic networks (warehouses locations connected by trucks) might apply to cellular vesicle traffic networks. In the efficient logistics context, the goal is to spread out the warehouses as evenly as possible while minimizing the distances travelled by trucks. If we imagine compartments to be warehouses and vesicles to be trucks, what would the optimal spatial organization of compartments look like? There is a simple algorithm which produces this optimal configuration, as described in “Methods: Spatial Optimization”. It involves minimizing a certain “energy function” which measures how uniformly compartments/warehouses are distributed and how far vesicles/trucks must travel. The intuition behind why this energy function works is that it resembles a system of repelling charges and attracting springs, but that is merely for the sake explanation, the optimization procedure is the main point. In our original analysis the text misleadingly seemed to read that the “springs” and “charges” were the actual physical causes of the locations, this is not the case. Of course it is complex biophysical regulation which actually places compartments at precise locations.</p><p>Whether these locations in fact do optimize efficient traffic is still an open question. All we have shown is that Golgi stacks are consistent with this hypothesis, but this observation certainly does not prove this hypothesis.</p><p><xref ref-type="fig" rid="fig4">Figure 4</xref> of the main text in the original has been moved to <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> of the revision. We have expanded the text where this issue is discussed:</p><p>Third paragraph of Discussion section: “the spatial locations of compartments are determined by complex and largely unknown biophysical mechanisms [Yadav &amp; Linstedt, 2011].”</p><p>Third paragraph of Discussion section: “We explored the hypothesis that a cell is like an efficient city-wide logistics system, in which no part of a city is too far from a warehouse, and warehouses with more traffic between them are placed closer to one another […]”</p><p>Third paragraph of Discussion section: “Measurements with repositioned organelles might be used to test these ideas further [van Bergeijk et al., 2015].”</p><p>Methods section, subsection: “Spatial organization”: “We want to distribute the compartments of a vesicle traffic network in such a way that all parts of a cell are close to at least one compartment, while the distance travelled by vesicles between compartments is minimized […]”</p><p> <italic>One of the reviewers was quite troubled by the lack of spatiotemporal parameters in your model (transport coefficients, distances, compartment sizes, etc). The other two reviewers were of the opinion that the cytoplasm is well mixed, so it is reasonable to assume that vesicles will reach any potential destination. But to convince the skeptical reviewer and other readers, you should explain why spatiotemporal parameters can be ignored for the purposes of your simulation.</italic></p><p>These are important questions, and we will provide a detailed answer here. We also discuss these issues more briefly in the revised text. Most, if not all, previous models of vesicle traffic have attempted to do justice to details such as spatial location, compartment size, reaction kinetics, and so on. In fact we have used such approaches ourselves. Our paper [Ramadas &amp; Thattai, 2013] builds on the classic model of Heinrich and Rapoport, using differential equations and dynamical systems approaches to understand how the number of compartments and their connectivity might be encoded in microscopic molecular parameters.</p><p>We tried for a long time unsuccessfully to extend these models to arbitrary network topologies: given the number of parameters, it is technically unfeasible to explore parameter space in an unbiased manner. However, we noticed from our earlier results that the topologies of the networks arising from such complex models were very robustly determined by broad aspects of molecular specificity.</p><p>Once the topology was set, the quantitative behavior including rates of cargo flow were determined by more detailed kinetic parameters. This is why we developed the Boolean approach described here. If topology is what one is interested in, the Boolean model provides the same set of topologies are more detailed kinetic models.</p><p>Once a topology is obtained form the Boolean approach, the kinetic parameters can be included afterwards. We are currently working on precisely this aspect in an independent project: we are developing a broad mathematical method to put back kinetic parameters onto a given network topology. This turns out to be useful not just because of the Boolean prescription described here, but because cell biological experiments often help us determine network topology (which vesicles flow between which compartments) but not often the kinetics. We will be happy to share with you the results of our project when it is ready. However, it goes beyond the topic of the present submission.</p><p>We have modified the introductory text to discuss these issues:</p><p>Second paragraph of Results section: “We have shown [Ramadas &amp; Thattai, 2013] that the topological features of a vesicle traffic network – the number of compartments and their connectivity – are robustly determined by molecular specificity alone, while quantitative features such as the rate of flow of cargo depend on additional kinetic parameters. Here we are primarily interested in homeostatic network topologies. We therefore formalize the properties of vesicle traffic systems using a Boolean framework […]”</p><p>Second paragraph of Results section: “We also assume the cytoplasm is well mixed, and do not consider spatial location.”</p><p>Second paragraph of Discussion section: “This shows that spatial organization is not a pre-requisite for maturation, and supports the idea of a well-mixed cytoplasm.”</p><p><italic>In particular, the markers used in your simulation reach a steady-state homeostatic distribution, but is it automatically true that all of the other components, such as lipids, will also undergo balanced flows in a given network?</italic> </p><p>The lipids themselves can be considered as one of the labels in the system. Therefore, if the network is homeostatic, it is balanced in all its markers. However, there is a subtle point that we now provide new analysis to discuss. For each compartment individually, all flows must balance in a homeostatic network. However, is possible that for larger groups of compartments, molecules might flow in but not out (e.g. if two compartments exchange a molecule with one another, but also that molecule is received from a third compartment).</p><p>This means that the network is balanced at fast timescales, but on slower timescales this type of molecule will have to be synthesized elsewhere in the system. We now show how often this type of slow synthesis is required, across all the networks in our system. See <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2E,F</xref>.</p><p>New text has been added:</p><p>Fifth paragraph of Results section: “We can distinguish true vesicles from non-vesicular transport by explicitly assigning a label to membrane lipids […]”</p><p>Results section, subsection “Sampling homeostatic vesicle traffic networks”: “In homeostatic networks, molecular loss must be offset by molecular gain at each compartment, and on fast timescales these processes balance out. However, certain compartment groups could receive particular molecules, yet not give them away. When flows are interpreted in terms of continuous fluxes, such molecular sinks imply the need for compensatory synthesis elsewhere on slower timescales. In general, larger networks tended to require synthesis of more types of molecular components (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2E,F</xref>).”</p><p><italic>Does your model require the unrealistic assumption that every compartment generates the same number and size of vesicles per unit time?</italic> </p><p>We do not make this unrealistic assumption. Our model specifies the types of cargo carried by the vesicles generated by each compartment. It is agnostic about the relative amounts of this cargo, about the size of the vesicles, and about the rates of vesicle production. In particular (see our remarks above), once a network topology is provided from our Boolean model, we can then go into detail to examine the molecular flows (e.g. see the new <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2F</xref>). Each molecule moves in cycles, and the rate of flux of each cycle can be set as an independent kinetic parameter. We have discussed this in the text, as described above.</p><p>New text has been added:</p><p>Second paragraph of Results section: “Our approach is agnostic to the relative amounts of molecules on each vesicle, the size of vesicles and compartments, and the flux of vesicles between compartments. We also assume the cytoplasm is well mixed, and do not consider spatial location. Once a homeostatic traffic topology is discovered using this Boolean approach, we can add back more detailed kinetic parameters and examine quantitative molecular flows.”</p><p><italic>Is it obvious that movement between compartment is fast relative to formation and fusion of vesicles, so that spatial aspects can be neglected?</italic> </p><p>This is an important point. It is not at all obvious that the spatial configuration of a cell should be neglected. Indeed, it is extremely likely that local concentration effects ensure that vesicles are more likely to find targets closer to the source compartment. We know the cytoplasm does undergo mixing events, partly driven by a dynamic cytoskeleton. However, to our knowledge there is only partial experimental support for the idea of a truly well-mixed cytoplasm.</p><p>Our response to this critique is as follows: we are particularly exploring here how far molecular specificities alone can determine the properties of a vesicle traffic system. If these basic ingredients alone are sufficient to generate complex structures, then it is not necessary to invoke spatial organization as an additional input ingredient.</p><p>No model is ever complete, the set of ingredients missing in any given model is infinite.</p><p>The key question is, do the set of ingredients that are included provide any insight. We hope that our results here cross this bar: that the surprising emergence of cisternal maturation in the absence of spatial organization at least opens up the possibility that maturation is primarily determined by molecular interactions. The recent observation by Glick and colleagues of retrograde vesicle flow in un-stacked Golgi provides some support for this idea.</p><p><xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2E,F</xref> discuss these issues. The text has been expanded in several places to indicate that our Boolean model provides a topological “chassis” on top of which kinetic parameters can be included.</p><p>Second paragraph of Results section: “Previous mathematical models of vesicle traffic … add back more detailed kinetic parameters and examine quantitative molecular flows.”</p><p>Second paragraph of Results section: “We also assume the cytoplasm is well mixed, and do not consider spatial location.”</p><p>Results section, subsection: “Sampling homeostatic vesicle traffic networks”: “In homeostatic networks, molecular loss must be offset by molecular gain at each compartment, and on fast timescales these processes balance out … In general, larger networks tended to require synthesis of more types of molecular components (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2E,F</xref>).”</p><p>Third paragraph of Discussion section: “The connectivity of a vesicle traffic network is primarily determined by molecular specificity, while the spatial locations of compartments are determined by complex and largely unknown biophysical mechanisms [Yadav &amp; Linstedt, 2011].”</p><p>Second paragraph of Discussion: “This shows that spatial organization is not a pre-requisite for maturation, and supports the idea of a well-mixed cytoplasm.”</p><p> <italic>5) In general, the descriptions and discussion need to be expanded significantly to address the questions that will be raised by cell biologists. Perhaps it would be useful to rewrite the paper with input from a cell/membrane biologist. Here are examples of issues that should be addressed:</italic> </p><p>We thank the reviewers for this suggestion, which we have taken to heart. We have circulated the daft among our colleagues in cell biology and have incorporated their suggestions on readability and accessibility. One of the main points we heard was that the model seemed too abstract. To remedy this we have added new text describing how to interpret the molecular labels. We have also added additional clarifying material throughout the text.</p><p>New text has been added:</p><p>Fifth paragraph of Results section: “This Boolean description appears abstract, but the biology is embodied in the interpretation of the molecular labels. …”</p><p> <italic>The introduction is too generic. It does not even mention the Boolean modeling approach, and does not describe either the power and limitations of this approach or the reasons for choosing it to address this particular topic.</italic> </p><p>We apologize for the brevity of the discussion in our original submission. This was primarily due to the space constraints of the <italic>eLife</italic> “Short Reports” format.</p><p>We have now added an entire paragraph providing background on vesicle traffic models and motivating the use of the Boolean approach. We also direct the reader to our companion manuscript [Mani &amp; Thattai, 2016] which provides an accessible non-mathematical introduction to our Boolean approach.</p><p>New text has been added:</p><p>Second paragraph of Results section: “Previous mathematical analyses of vesicle traffic have considered such details as compartment size, location and chemical composition, and used ordinary or partial differential equations to study vesicle and compartment dynamics […]”</p><p> <italic>The difference between actual and randomized networks in <xref ref-type="fig" rid="fig2">Figure 2A–C</xref> is confusing, and the significance of <xref ref-type="fig" rid="fig2">Figure 2D,E</xref> is hard to understand. Similarly, in <xref ref-type="fig" rid="fig3">Figure 3</xref>, what is the difference between special pairs and random pairs? The parameters and assumptions should be clearly described in terms that will make sense to cell biologists.</italic> </p><p>We agree this point was confusing in the original submission, and apologize for this. We have significantly expanded our discussion here. To be clear, our analysis proceeded in 3 steps. (1) We explicitly looked for cases of compartmental maturation. (2) We next looked at 3-compartment motifs in an unbiased manner, as discussed above. (3) We finally looked for structures larger than 3-compartment motifs. For step (3), the key to finding larger structures is to shuffle a network while keeping local properties fixed. If this shuffling does not change e.g. the frequency of occurrence of various 3-compartment motifs, then we can be confident that there are no larger repeated structures present. Indeed, this is what we see.</p><p>The text has been expanded to discuss this point:</p><p>Results section, subsection: “Cell-like networks and vesicle traffic motifs”: “We next checked if our networks contained any large global structures, beyond the scale of local motifs. If such structures are present, they should be disrupted when we shuffle the edges of a network while keeping local incoming and outgoing edges of individual compartments fixed.”</p><p> <italic>The phenomenon of compartments becoming richer in compositional complexity over time has not been described experimentally, and doesn't seem to make biological sense. Can you comment on this discrepancy?</italic> </p><p>This is an observation we have made from our data, it is not an ingredient we put into the model. The caveat is that we are only modeling a network with a small number of molecular components, and in particular we have focused on the active labels, not passive cargo. In terms of the active labels, imagine there are various Golgi-resident markers constantly treadmilling within the Golgi itself.</p><p>What we find is that the very first compartment has fewer active labels than the very last compartment, and this difference causes a gradient within the maturation chain. In a real cell much of the content of the Golgi will be secretory cargo destined for one-way outward flow. These one-way secretions are not considered in our homeostatic framework. Once such passive secretory cargo are introduced, it is less likely that the clear pattern we have observed will remain. In any event, given these various caveats we have opted to remove this particular figure from our revision, and mentioned this result in the text, with the caveat:</p><p>Results section, subsection: “Cell-like networks and vesicle traffic motifs”: “The first compartment of a maturation chain tended to be compositionally simpler than its successors (at least in terms of the active labels considered here) due to the treadmilling molecules present on the latter.”</p><p> <italic>Regarding the maturation chains, one reviewer wrote: &quot;However, these striking observations are not clearly interpretable. The authors should provide much more detail on the characteristics of these chains, on the dynamics of their development, and on the number of the chains that possess these particularly complex features. They should also describe the networks that do not contain maturation chains, which actually represent the majority of the outcomes. They should discuss which parameters lead to realistic maturation chains, and which preclude maturation..… What is interesting to me is not the fact that they observe maturation as this outcome is expected, but the fact that the maturation networks are so complex and so similar to the real ones, and so frequent. Again they should thoroughly describe the maturation chains, the alternative outcomes and the conditions where they obtain. Without this description we cannot judge the value of the simulations.&quot;</italic> </p><p>We agree with the reviewer that there is much more to explore in this diverse dataset. Indeed, we hope the approach we have put forward here is used to uncover further reproducible aspects of these networks. In many ways it is the variability and not the common features that might be important: e.g. during cell differentiation, or during pathogenic re-wiring of a host network. However, all these issues take us beyond the present topic. We will pursue them further.</p><p>As described above, in our revision we have devoted a great deal of the text to discussing the properties of all 14,809 homeostatic networks in our dataset, not just the ones with maturation chains. In particular, 6,195 are trivial (all compartments are disconnected from one another). Of the remaining 8,614, about half contain maturation chains. We have now provided a lot of information on the half that do not contain maturation chains, in terms of the top 10 motifs (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>) as well as other general features (<xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). We have shown which parameter ranges produce maturation chains (<xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). We have also closed the Results section with a clear statement of our central finding, about the precise number of chains that display all the diagnostic features of cisternal maturation.</p><p><xref ref-type="fig" rid="fig2">Figure 2</xref> and its supplements discuss these issues in detail. New text has been added:</p><p>Results section, subsection: “Cell-like networks and vesicle traffic motifs “: “This diverse sample of networks represents a neutral null hypothesis, which can be contrasted with hypotheses about the selection of various vesicle traffic structures. If some structure of interest frequently occurs in our sample, it suggests such a structure might arise non-adaptively.”</p><p>Results section, subsection: “Retrograde vesicles emerge spontaneously, driving cisternal maturation”: “Distilling these observations, here is our central result: across 8,614 non-trivial homeostatic networks, we find 3,111 maturation chains which precisely match all three diagnostic features of the cisternal maturation model (<xref ref-type="fig" rid="fig4">Figure 4</xref>).”</p><p> <italic>Do the authors wish to argue that their simulations reflect a potentially simpler situation early in evolution, and are therefore not constrained to incorporate features of currently existing trafficking systems? If so, they should make this point explicitly.</italic> </p><p>This is an interesting point, we thank the reviewer for suggesting it. We have now included a discussion early eukaryote evolution in the introduction:</p><p>Fifth paragraph of Results section: “Though GTPases diversified early in eukaryote evolution [Elias et al., 2012], it is plausible that the primordial vesicle traffic system relied on a more basic toolkit of lipidbased compartment identity and SNARE-mediated fusion specificity [Dey et al., 2016].”</p><p><italic>[Editors' note: further revisions were requested prior to acceptance, as described below.]</italic></p><p> <italic>1) Even though the basic patterns of compartmental formation and communication can be described by the Boolean network approach, spatiotemporal parameters are clearly important in real cells to ensure that the membrane traffic machinery is efficient enough to support life. This point should be given further emphasis.</italic> </p><p> <italic>More generally, you should discuss the limitations of the described approach. Does the model make testable, falsifiable predictions? I suspect that this one can be addressed by the presentation. For example, if you predicted that maturation chains could have evolved without specific selection for the transport of large cargo, then the modeling matches this prediction. But are other aspects of membrane traffic not captured by your simple model?</italic> </p><p>We have significantly revised the manuscript to emphasize spatiotemporal considerations. The stochastic model (Box) unpacks various mechanistic assumptions in detail, e.g. the cooperative recruitment of vesicles, or the effect of compartment size on vesicle fusion. We have also shown quantitative parametric conditions under which we expect maturation to arise. The detailed stochastic dynamics compare very favorably with the live-cell dynamics of compartmental maturation observed by Losev et al. (Nature, 2006). Throughout the text we have updated the presentation to explain the motivation behind our Boolean framework, and highlighted connections with detailed mechanistic or molecular issues.</p><p> <italic>2) The authors should discuss how to arrive at the Boolean network approach from a set of (partial) differential equations (similar to Heinrich/Rapoport's model or starting from overdamped Fokker-Planck equations). In particular: Which rates and transport coefficients are considered large or limiting w.r.t others, i.e. which quasi-equilibria are used for setting up the model from more fundamental approaches?</italic> </p><p>We appreciate this question, which many other readers will very likely also have. We have therefore addressed it in full. We have presented (Box) a full microscopic model based on fundamental stochastic processes of vesicle budding and fusion, simulated using Gillespie’s exact stochastic simulation algorithm. The mean-field limit of this simulation produces a set of approximate ordinary differential equations. We have presented the parametric conditions under which this set of equations produces a limit-cycle oscillation, of which the Boolean dynamics are a discrete approximation. This discussion provides readers intuition about the meaning of our abstract vesicle traffic graphs, about the mechanistic underpinnings of our approach, about the timescales involved, etc.</p><p> <italic>3) The biological meanings of the propensity parameters for budding and fusion are still unclear. Please provide an explanation. For example, does propensity to fuse reflect the spatial proximity of vesicle donor and acceptor compartments?</italic> </p><p>We have clarified the discussion of our propensity parameters. These reflect chemical rather than spatial properties. In brief: we imagine that different species might encode different numbers of e.g. adaptors, Arfs, Rabs, and SNARES. Moreoever, these proteins will also have different chemical interaction specificities. A priori we don’t know whether adaptors tend to select only a small proportion or a large proportion of available cargo. Similarly, we don’t know whether SNARE-SNARE pairings are rather promiscuous, or very specific. The propensities <italic>g</italic> and <italic>f</italic> are varied so we can sample systems of varying degrees of cargo-adaptor specificity and SNARE-SNARE specificity.</p><p>Results section, subsection: “Sampling homeostatic vesicle traffic networks”: “These parameters capture genetically-encoded properties such as the number, and the degree of interaction specificity, of cargo, adaptors, Arf and Rab GTPases, and SNAREs.”</p><p>Discussion section, subsection: “Sampling homeostatic vesicle traffic networks”: “All these parameters are ultimately genetically determined: N and A represent the number of protein types involved, while g and f summarize their interaction properties. For example, g depends on cargo-adaptor specificity, and f depends on SNARE-SNARE specificity.”</p><p> <italic>4) The assumption that orphan vesicles fuse homotypically continues to be troubling. You may not have fully understood the concern raised during the initial submission, so let's try again.</italic> </p><p> <italic>Vesicles are normally expected to fuse heterotypically. If a vesicle fails to find a target compartment, why should it then fuse homotypically? Why couldn't a vesicle of one type fuse heterotypically with a vesicle of another type? A priori, such heterotypic vesicle fusion may be more likely than homotypic vesicle fusion given that vesicles normally undergo heterotypic fusion with a target compartment.</italic> </p><p> <italic>The concern is that if homotypic vesicle fusion is programmed into the model as the default fallback option, then the model may be biased toward compartment formation and subsequent maturation.</italic> </p><p>We have performed new simulations including the possibility of heterotypic fusion of vesicles governed by the same fusion matrix that governs vesicle-compartment fusion. We find that in the majority of instances this does not significantly deplete the set of orphan vesicles, if at all. Moreover, the fusion matrix itself cannot be the mechanism by which small vesicles fuse to form large compartments de novo, in a homeostatic state. The reason is, the desired compartment would already be present, and therefore the vesicle would already fuse to the compartment and not appear as an orphan. We now discuss at multiple places our treatment of homotypic fusion, to clarify our assumptions. We examined the legitimate concern about biasing the model toward having maturation chains. In fact, the bulk of our homeostatic states have very little homotypic fusion. Over a thousand states have no homotypic fusion and still have maturation cycles. We hope this addresses the concern.</p><p>Fifth paragraph of Results section: New section: “Orphan vesicles and homotypic fusion.”</p><p>Fifth paragraph of Results section: “We explored allowing orphan vesicles to fuse heterotypically according to the same specificity rules that governed vesicle-compartment fusion.”</p><p>Seventh paragraph of Results section: “In practice we find that a small dose of homotypic fusion is often sufficient to achieve homeostasis: over 80% of our homeostatic networks require two or fewer types of homotypically fusing vesicles.”</p><p>Results section, subsection: “Cell-like networks and vesicle traffic motifs”: “Out of 3,173 non-trivial networks with no homotypic fusion, over a third contained cycles of maturing compartments (1,053/3,173).”</p><p> <italic>5) Designating a GTPase that cycles through the cytoplasm as being formally equivalent to a vesicle is confusing. If your formalism treats a vesicle and a reversibly associating peripheral membrane protein as being equivalent, you should consider a term other than &quot;vesicle&quot;. Maybe &quot;carrier&quot; would be more generic, and &quot;membrane traffic&quot; could be used rather than &quot;vesicle traffic&quot;?</italic> </p><p>We apologize, we have clarified the text to avoid any confusion. We now refer to “vesicles”, or to “non-vesicular carriers”. When there is any scope for ambiguity, we refer to “transport vesicles”. We also clarify the many scales of membrane-bound structures in our model.</p><p>Fourth paragraph of Results section: “By explicitly assigning a label to membrane lipids, the Boolean framework can accommodate both vesicular and non-vesicular pathways.”</p><p>Results section, subsection: “Orphan vesicles and homotypic fusion”: “We assume a hierarchy of membrane-bound structures: compartments are large; transport vesicles are small; vesicles can fuse to compartments but compartments cannot fuse with one-another.”</p><p> <italic>6) At least some lipids can actually move via nonvesicular as well as vesicular pathways. The discussion of lipids may now be overly complex. The bottom line is that some components can only exchange between compartments via membrane vesicles (e.g., transmembrane proteins), some components could exchange either in vesicles or through the cytoplasm (e.g., certain lipids), and some components probably exchange only through the cytoplasm (e.g., certain GTPases).</italic> </p><p>We have simplified the text as suggested. We have removed the comments about early eukaryotic evolution since they are peripheral to the main discussion.</p><p> <italic>7) Relevant to #7 above: does the model take into account the fact that the various components traveling from one particular compartment to another could travel at different times and at different rates? Maybe this point is implicit in the model, but it's hard to tell.</italic> </p><p>We hope the extensive new discussion of stochastic and differential equation models, and the connection of such models with our Boolean framework, clarifies this point.</p><p> <italic>8) I didn't understand the discussion in the Results section about large global structures and shuffling the edges of a network. Is this issue important? If so, it should be explained better. If not, it should be omitted.</italic></p><p>We have omitted the discussion about shuffling edges from the main text. We have replaced it with a brief comment that might be relevant to a subset of readers, and directed them to a new reference [Albert &amp; Barabasi, 2002] for further details.</p><p>Results section, subsection “Cell-like networks and vesicle traffic motifs”: “This suggests that vesicle traffic networks might usefully be described by the random graph generation approaches that have provided insights into the structure of metabolic, neural, and ecological networks [Albert &amp; Barabási, 2002] (Methods: Randomly shuffled vesicle traffic networks).”</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p> <italic>1) In cells, many compartments fuse homotypically. For clarity, you should state the assumption that compartments cannot fuse heterotypically with one another.</italic> </p><p>We have stated our explicit assumption that compartments cannot fuse heterotypically.</p><p> <italic>2) The first paragraph in this section is now perhaps more complex than necessary, and is a bit confusing as a result. For example, I have trouble figuring out what this sentence means: &quot;This is rare: in almost all instances we explored, at least some fusion products of orphans were themselves orphans; in the majority of instances even the initial orphans could not fuse with one-another.&quot;</italic> </p><p>We have simplified the first paragraph of the section “Orphan vesicles and homotypic fusion” as suggested.</p><p> <italic>3) &quot;one another&quot; is two words.</italic> </p><p>We have fixed all incorrect instances of the phrase “one another”.</p></body></sub-article></article>