<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">34171</article-id><article-id pub-id-type="doi">10.7554/eLife.34171</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Recurrent network model for learning goal-directed sequences through reverse replay</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-47614"><name><surname>Haga</surname><given-names>Tatsuya</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3145-709X</contrib-id><email>tatsuya.haga@riken.jp</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-13091"><name><surname>Fukai</surname><given-names>Tomoki</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6977-5638</contrib-id><email>tfukai@riken.jp</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>RIKEN Center for Brain Science</institution><addr-line><named-content content-type="city">Wako</named-content></addr-line><country>Japan</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bhalla</surname><given-names>Upinder Singh</given-names></name><role>Reviewing Editor</role><aff><institution>National Centre for Biological Sciences, Tata Institute of Fundamental Research</institution><country>India</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Frank</surname><given-names>Michael J</given-names></name><role>Senior Editor</role><aff><institution>Brown University</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>03</day><month>07</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>7</volume><elocation-id>e34171</elocation-id><history><date date-type="received" iso-8601-date="2017-12-07"><day>07</day><month>12</month><year>2017</year></date><date date-type="accepted" iso-8601-date="2018-07-02"><day>02</day><month>07</month><year>2018</year></date></history><permissions><copyright-statement>© 2018, Haga et al</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>Haga et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-34171-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.34171.001</object-id><p>Reverse replay of hippocampal place cells occurs frequently at rewarded locations, suggesting its contribution to goal-directed path learning. Symmetric spike-timing dependent plasticity (STDP) in CA3 likely potentiates recurrent synapses for both forward (start to goal) and reverse (goal to start) replays during sequential activation of place cells. However, how reverse replay selectively strengthens forward synaptic pathway is unclear. Here, we show computationally that firing sequences bias synaptic transmissions to the opposite direction of propagation under symmetric STDP in the co-presence of short-term synaptic depression or afterdepolarization. We demonstrate that significant biases are created in biologically realistic simulation settings, and this bias enables reverse replay to enhance goal-directed spatial memory on a W-maze. Further, we show that essentially the same mechanism works in a two-dimensional open field. Our model for the first time provides the mechanistic account for the way reverse replay contributes to hippocampal sequence learning for reward-seeking spatial navigation.</p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.34171.002</object-id><title>eLife digest</title><p>To find their way around, animals – including humans – rely on an area of the brain called the hippocampus. Studies in rodents have shown that certain neurons in the hippocampus called place cells become active when an animal passes through specific locations. At each position, a different set of place cells fires. A journey from A to B will thus be accompanied by a sequential activation of place cells corresponding to a particular point.</p><p>Rats can learn new routes to a given place. Every time they take a specific way, the connections between the activated place cells become stronger. After learning, the hippocampus replays the sequence of place cell activation both in the order the rat has experienced and backwards. This is known as reverse replay, which occurs more often when the animals find rewards at their destination. This suggests that reverse replay may help animals learn the routes to locations where food is available.</p><p>To test this idea, Haga and Fukai built a computer model that simulates the hippocampal activity seen in a rat running through a maze. In contrast to previous models, which featured only forward replay, the new simulation also included reverse replay. The results confirmed that reverse replay helps the rodents to learn routes to rewarded locations. It also enables the hippocampus to combine multiple past experiences, which may teach animals that a combination of previous paths will lead to a reward, even if they have never tried the combined route before.</p><p>The hippocampus has a central role in many different types of memory. The findings by Haga and Fukai may therefore provide a framework for studying the mechanisms of memory and decision-making. The results could even offer insight into the mechanisms of logical thinking. After all, the ability to combine multiple known paths into a new route bears some similarity to joining up thought processes such as ‘If Sophie oversleeps, she will miss the bus’ with ‘If Sophie misses the bus, she will be late for school’ to reason that ‘If Sophie oversleeps, she will be late for school’. Future studies should test whether reverse replay helps with this process of deduction.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>hippocampus</kwd><kwd>reverse replay</kwd><kwd>sequence learning</kwd><kwd>short-term plasticity</kwd><kwd>spike-timing-dependent plasticity</kwd><kwd>goal-directed learning</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001700</institution-id><institution>Ministry of Education, Culture, Sports, Science, and Technology</institution></institution-wrap></funding-source><award-id>15H04265</award-id><principal-award-recipient><name><surname>Fukai</surname><given-names>Tomoki</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003382</institution-id><institution>Core Research for Evolutional Science and Technology</institution></institution-wrap></funding-source><award-id>JPMJCR13W1</award-id><principal-award-recipient><name><surname>Fukai</surname><given-names>Tomoki</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001700</institution-id><institution>Ministry of Education, Culture, Sports, Science, and Technology</institution></institution-wrap></funding-source><award-id>16H01289</award-id><principal-award-recipient><name><surname>Fukai</surname><given-names>Tomoki</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001700</institution-id><institution>Ministry of Education, Culture, Sports, Science, and Technology</institution></institution-wrap></funding-source><award-id>17H06036</award-id><principal-award-recipient><name><surname>Fukai</surname><given-names>Tomoki</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The combination of short-term and long-term plasticity enables hippocampus to learn goal-directed paths through replay in a reversed order.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The hippocampus plays an important role in episodic memory and spatial processing in the brain (<xref ref-type="bibr" rid="bib51">O'Keefe and Dostrovsky, 1971</xref>; <xref ref-type="bibr" rid="bib63">Scoville and Milner, 1957</xref>). Because an episode is a sequence of events, sequential neural activity has been extensively studied as the basis of hippocampal memory processing. In the rodent hippocampus, firing sequences of place cells are replayed during awake immobility and sleep (<xref ref-type="bibr" rid="bib8">Carr et al., 2011</xref>; <xref ref-type="bibr" rid="bib56">Pfeiffer, 2018</xref>) and these reactivations are crucial for performance in spatial memory tasks (<xref ref-type="bibr" rid="bib25">Girardeau et al., 2009</xref>; <xref ref-type="bibr" rid="bib33">Jadhav et al., 2012</xref>; <xref ref-type="bibr" rid="bib64">Singer et al., 2013</xref>). Replay can be either in the same firing order as experienced (forward replay) or in the reversed order (reverse replay). Forward replay is observed during sleep after exploration (<xref ref-type="bibr" rid="bib41">Lee and Wilson, 2002</xref>; <xref ref-type="bibr" rid="bib76">Wikenheiser and Redish, 2013</xref>) or in immobile states before rats start to travel towards reward (<xref ref-type="bibr" rid="bib15">Diba and Buzsáki, 2007</xref>; <xref ref-type="bibr" rid="bib55">Pfeiffer and Foster, 2013</xref>), hence forward replay is thought to engage in the consolidation and retrieval of spatial memory. In contrast, reverse replay presumably contributes to the optimization of goal-directed paths because rewarded spatial paths are replayed around the timing of reward delivery (<xref ref-type="bibr" rid="bib15">Diba and Buzsáki, 2007</xref>; <xref ref-type="bibr" rid="bib21">Foster and Wilson, 2006</xref>), and the occurrence frequency is modulated by the presence and the amount of reward (<xref ref-type="bibr" rid="bib1">Ambrose et al., 2016</xref>; <xref ref-type="bibr" rid="bib65">Singer and Frank, 2009</xref>).</p><p>Because sequences are essentially time asymmetric, sequence learning often hypothesizes asymmetric spike-timing-dependent plasticity (STDP) found in CA1 (<xref ref-type="bibr" rid="bib2">Bi and Poo , 2001</xref>) which induce long-term potentiation (LTP) for pre-to-post firing order and long-term depression (LTD) for post-to-pre firing order. This type of STDP enables a recurrent network to reactivate sequential firing in the same order with the experience. However, in the hippocampal area CA3, it was recently reported that the default form of STDP is time symmetric at recurrent synapses (<xref ref-type="bibr" rid="bib45">Mishra et al., 2016</xref>). Because CA3 is the most likely source of hippocampal firing sequences (<xref ref-type="bibr" rid="bib44">Middleton and McHugh, 2016</xref>; <xref ref-type="bibr" rid="bib50">Nakashiba et al., 2009</xref>), this finding raises the question whether and how STDP underlies sequence learning in hippocampus. A symmetric time window implies that a firing sequence equally strengthens both forward synaptic pathways leading to the rewarded location and reverse pathways leaving away from the rewarded location in CA3 recurrent network. However, reward-based optimization requires selective reinforcement of forward pathways as it will strengthen prospective place-cell sequences in subsequent trials and forward replay events in the consolidation phase. Such bias toward forward sequences in post-experience sleep (<xref ref-type="bibr" rid="bib76">Wikenheiser and Redish, 2013</xref>) and goal-directed behavior (<xref ref-type="bibr" rid="bib37">Johnson and Redish, 2007</xref>; <xref ref-type="bibr" rid="bib55">Pfeiffer and Foster, 2013</xref>; <xref ref-type="bibr" rid="bib77">Wikenheiser and Redish, 2015</xref>) is actually observed in hippocampus. How this directionality arises in replay events and how reverse replay enables the learning of goal-directed navigation remain unclear.</p><p>In this paper, we first show how goal-directed path learning is naturally realized through reverse replay in a one-dimensional chain model. To this end, we hypothesize that the contribution of presynaptic spiking for STDP is attenuated in CA3 by short-term depression, as was revealed in the rat visual cortex (<xref ref-type="bibr" rid="bib23">Froemke et al., 2006</xref>). Under this condition, symmetric STDP and a rate-based Hebbian plasticity rule bias recurrent synaptic weights toward the opposite direction to the propagation of a firing sequence, implying that the combined rule virtually acts like anti-Hebbian STDP. We also show that accumulation of afterdepolarization (<xref ref-type="bibr" rid="bib45">Mishra et al., 2016</xref>) in postsynaptic neurons results in the same effect. By simulating the model with various spiking patterns, we confirm this effect for a broad range of spiking patterns and parameters of plasticity rules, including those observed in experiments. Based on this mechanism, we built a two-dimensional recurrent network model of place cells with the combination of reverse replay, Hebbian plasticity with short-term plasticity, and reward-induced enhancement of replay frequency (<xref ref-type="bibr" rid="bib1">Ambrose et al., 2016</xref>; <xref ref-type="bibr" rid="bib65">Singer and Frank, 2009</xref>). We first demonstrate that the network model can learn forward pathways leading to reward on a W-shaped track. Further, we extend the role of reverse replay to unbiased sequence propagations from reward sites on a two-dimensional open field, which enable learning of goal-directed behavior in the open field. Unlike the previous models for hippocampal sequence learning (<xref ref-type="bibr" rid="bib4">Blum and Abbott, 1996</xref>; <xref ref-type="bibr" rid="bib24">Gerstner and Abbott, 1997</xref>; <xref ref-type="bibr" rid="bib34">Jahnke et al., 2015</xref>; <xref ref-type="bibr" rid="bib35">Jensen and Lisman, 1996</xref>; <xref ref-type="bibr" rid="bib62">Sato and Yamaguchi, 2003</xref>; <xref ref-type="bibr" rid="bib70">Tsodyks and Sejnowski, 1995</xref>) in which recurrent networks learn and strengthen forward sequences through forward movements, our model proposes goal-directed path learning through reverse sequences.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Hebbian plasticity with short-term depression potentiates reverse synaptic transmissions</title><p>We first simulated a sequential firing pattern that propagates through a one-dimensional recurrent neural network, and evaluated weight changes by rate-based Hebbian plasticity rules. The network consists of 500 rate neurons, which were connected with distance-dependent excitatory synaptic weights modulated by short-term synaptic plasticity (STP) (<xref ref-type="bibr" rid="bib59">Romani and Tsodyks, 2015</xref>; <xref ref-type="bibr" rid="bib75">Wang et al., 2015</xref>). In addition, the network had global inhibitory feedback to all neurons. A first external input to a neuron at one end (#0) elicited traveling waves of neural activity propagating to the opposite end (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Here, we regard these activity patterns as a model of hippocampal firing sequences (<xref ref-type="bibr" rid="bib59">Romani and Tsodyks, 2015</xref>; <xref ref-type="bibr" rid="bib75">Wang et al., 2015</xref>). A second external input to a neuron at the center of the network triggered firing sequences propagating to both directions (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) because synaptic weights were symmetric (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Here, we implemented a standard Hebbian plasticity rule, which potentiated excitatory synaptic weights by the product of postsynaptic and presynaptic neural activities. During the propagation of the first unidirectional sequence, this rule potentiated synaptic weights symmetrically without creating any bias in the synaptic weights (<xref ref-type="fig" rid="fig1">Figure 1B</xref>).</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.34171.003</object-id><label>Figure 1.</label><caption><title>Potentiation of reverse propagation in 1-D recurrent network of rate neurons.</title><p>(<bold>A, C</bold>) Weight modifications were induced by a firing sequence in a 1-D recurrent network (at time 0 s), and the effects of these changes on sequence propagation were examined at time 3 s. Recurrent synaptic weights were modified by the standard Hebbian plasticity rule (<bold>A</bold>) or the revised Hebbian plasticity rule, where the latter was modulated by STP. (<bold>B, D</bold>) Weights of outgoing synapses from neuron #250 to other neurons are shown at time 0 s (black) and 3 s (red) of the simulations in (<bold>A</bold>) and (<bold>C</bold>), respectively (top). Lower panels show the weight changes (blue). (<bold>E</bold>) Neural activity, presynaptic outputs (top) and the amount of neurotransmitters at presynaptic terminals (bottom) are shown at 300 ms of the simulation in (<bold>C</bold>). (<bold>F</bold>) Activity packet traveling on the 1-D recurrent network and the resultant weight changes by the revised Hebbian plasticity rule are schematically illustrated. (<bold>G</bold>) Distributions of synaptic weights are schematically shown before and after a sequence propagation.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig1-v2"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34171.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Potentiation of reverse propagation in 1-D recurrent network with accumulation of afterdepolarization (ADP).</title><p>In this simulation, we show that ADP can generate direction-selective synaptic potentiation similar to those for STP. Here, Hebbian plasticity is modulated by ADP, but not by STP (Experimental Procedure). (<bold>A</bold>) Weight modifications were induced by a firing sequence in a 1-D recurrent network (at time 0 s), and the effects of these changes on sequence propagation were examined at time 3 s. Recurrent synaptic weights were modified by the revised Hebbian plasticity rule in which the contribution of postsynaptic activities were determined by ADP accumulated through time. (<bold>B</bold>) Weights of outgoing synapses from neuron #250 to other neurons are shown at time 0 s (black) and 3 s (red) of the simulations in (<bold>A</bold>) (top). Lower panels show the weight changes (blue). (<bold>C</bold>) Neural activity and accumulated effects of ADP are shown at 300 ms of the simulation in (<bold>A</bold>).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig1-figsupp1-v2"/></fig></fig-group><p>However, when synaptic weights were changed by a modified Hebbian plasticity rule (see Materials and methods), in which the long-term plasticity is also regulated by STP at presynaptic terminals (<xref ref-type="bibr" rid="bib23">Froemke et al., 2006</xref>), the second firing sequence only propagated to the reverse direction of the first one (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). This selective propagation occurred because the first firing sequence potentiated synaptic weights asymmetrically in the forward and reverse directions, thus creating a bias in the spatial distribution of synaptic weights (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). This means that firing sequences strengthen the reverse synaptic transmissions more strongly than the forward ones in this model, and reverse sequences are more likely to be generated after forward sequences.</p><p>Why does this model generate such a bias to the reverse direction? To explain this, we show the packet of neural activity during the first firing sequence (at <inline-formula><mml:math id="inf1"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>300</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>) in <xref ref-type="fig" rid="fig1">Figure 1E</xref>, top. We also plotted neurotransmitter release from the presynaptic terminal of each neuron (presynaptic outputs), which is determined by the product of presynaptic neural activity and the amount of available neurotransmitters in the combined Hebbian rule (<xref ref-type="fig" rid="fig1">Figure 1E</xref>, bottom). Because neurotransmitters are exhausted in the tail of the activity packet, presynaptic outputs are effective only at the head of the activity packet. Due to this spatial asymmetricity of presynaptic outputs, connections from the head to the tail are strongly potentiated but those from the tail to the head are not (<xref ref-type="fig" rid="fig1">Figure 1F</xref>). This results in the biased potentiation of reverse synaptic transmissions in this model (<xref ref-type="fig" rid="fig1">Figure 1G</xref>). In other words, the packet of presynaptic outputs becomes somewhat ‘prospective’ (namely, slightly skewed toward the direction of activity propagation), so the weight changes based on the coincidences between presynaptic outputs and postsynaptic activities result in the selective potentiation of connections from the ‘future’ to the ‘past’ in the firing sequence. This mechanism was not known previously and enables forward sequences to potentiate the synaptic transmissions responsible for reverse replay, and vice versa.</p><p>In the above simulations, STP contributed crucially to the asymmetric potentiation of synaptic connections between neurons. Meanwhile, similar asymmetricity, and hence the potentiation of reverse synaptic transmission, can also emerge when the effect of postsynaptic activity on Hebbian plasticity accumulates through time (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Because STDP in CA3 depends on the afterdepolarization (ADP) in dendrites (<xref ref-type="bibr" rid="bib45">Mishra et al., 2016</xref>), this phenomenon will occur if the effect of ADPs accumulates over multiples postsynaptic spikes as afterhyperpolarization modulates STDP in the visual cortex (<xref ref-type="bibr" rid="bib23">Froemke et al., 2006</xref>). Because we can obtain essentially the same results for STP-dependent and ADP-dependent plasticity rules, we only consider the effect of STP in the rest of this paper.</p></sec><sec id="s2-2"><title>Potentiation of reverse synaptic transmissions by STDP</title><p>The potentiation of reverse synaptic transmissions also occurs robustly in spiking neurons with STDP. To show this, we constructed a one-dimensional recurrent network of Izhikevich neurons (<xref ref-type="bibr" rid="bib32">Izhikevich, 2003b</xref>, <xref ref-type="bibr" rid="bib31">2004</xref>) connected via conductance-based AMPA and NMDA synaptic currents (see Materials and methods). We chose Izhikevich model because its frequency adaptation induces instability and enhances the generation of moving activity bumps. However, we note that the learning mechanism itself does not depend on a specific model of spiking neurons. Initial synaptic weights, STP, and global inhibitory feedback were similar to those used in the rate neuron model. We tested two types of STDP: asymmetric STDP in which pre-to-post firing leads to potentiation and post-to-pre firing leads to depression, and symmetric STDP in which both firing orders result in potentiation if two spikes are temporally close or depression if two spikes are temporally distant. Experimental evidence suggests that recurrent synapses in hippocampal CA3 undergo symmetric STDP (<xref ref-type="bibr" rid="bib45">Mishra et al., 2016</xref>).</p><p>Among these STDP types, only symmetric STDP showed a similar effect to the rate-based Hebbian rule. Under symmetric STDP without modulation by STP, synaptic transmissions were potentiated in both directions (<xref ref-type="fig" rid="fig2">Figure 2A and B</xref>). However, symmetric STDP modulated by STP biased the weight changes to the reverse direction (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), and accordingly the second firing sequence selectively traveled towards the opposite direction to the first sequence (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). This effect did not depend significantly on synaptic time constants, and we could obtain the same effect when we turned off NMDA current and shortened time constants for AMPA and inhibition (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A,B</xref>). In contrast, under asymmetric STDP without modulation by STP, firing sequences strengthened the forward sequence propagation (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>) and the related synaptic connections (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1D</xref>), as expected. Introducing modulation by STP did not change the qualitative results (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1E,F</xref>). These results indicate that a greater potentiation of reverse synaptic transmissions in CA3 occurs under the modified symmetric STDP.</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.34171.005</object-id><label>Figure 2.</label><caption><title>Potentiation of reverse propagation in 1-D recurrent network of spiking neurons.</title><p>(<bold>A, C</bold>) Simulations similar to those shown in <xref ref-type="fig" rid="fig1">Figure 1</xref> were performed in a 1-D spiking neural network. Recurrent synaptic weights were changed by symmetric STDP. In (<bold>A</bold>) the plasticity rules were not modulated by STP whereas in (<bold>C</bold>) the rules were modulated. (<bold>B, D</bold>) The weights of outgoing synapses from neuron #250 (top) are shown at time 0 s (black) and 3 s (red) of the simulation settings shown in (<bold>A</bold>) and (<bold>C</bold>), respectively. Lower panels display the weight changes (blue).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig2-v2"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34171.006</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Simulation of 1-D spiking neural network in various conditions.</title><p>(<bold>A,C,E</bold>) Simulations similar to those shown in <xref ref-type="fig" rid="fig1">Figure 1</xref> were performed in a 1-D spiking neural network. Recurrent synaptic weights were changed by symmetric STDP (<bold>A</bold>) or asymmetric STDP (<bold>C,E</bold>). In (<bold>C</bold>), the plasticity rules were not modulated by STP whereas in (<bold>A</bold>) and (<bold>E</bold>) the rules were modulated. In (<bold>A</bold>), we turned off NMDA current, and time constants of AMPA and inhibition were half of other simulations. (<bold>B,D,F</bold>) The weights of outgoing synapses from neuron #250 (top) are shown at time 0 s (black) and 3 s (red) of the simulation settings shown in (<bold>A</bold>), (<bold>C</bold>), and (<bold>E</bold>), respectively. Lower panels display the weight changes (blue).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig2-figsupp1-v2"/></fig></fig-group></sec><sec id="s2-3"><title>Evaluation of parameter dependence in Poisson spike trains</title><p>We further confirmed the bias effect of the modified symmetric STDP in broader conditions than in the above network simulation. To this end, we generated sequential firing patterns along the one-dimensional network by sampling from a Poisson process, while manually controlling the number of propagating spikes per neuron, the mean inter-spike interval (ISI) of Poisson input spike trains, and time lags in spike propagation (i.e. time difference between the first spikes of neighboring neurons) (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). The amount of neurotransmitter release by each presynaptic spike was calculated by the STP rule (see Materials and methods), and the magnitude of long-term synaptic changes was calculated by a Gaussian-shaped symmetric STDP (<xref ref-type="fig" rid="fig3">Figure 3B</xref>) (<xref ref-type="bibr" rid="bib45">Mishra et al., 2016</xref>). The net effect of synaptic plasticity was given as the product of the two quantities, as in the previous simulations. The parameter values of short-term and long-term plasticity were adopted from experimental results (<xref ref-type="fig" rid="fig3">Figure 3B,C</xref>) (<xref ref-type="bibr" rid="bib27">Guzman et al., 2016</xref>; <xref ref-type="bibr" rid="bib45">Mishra et al., 2016</xref>). We calculated the long-term weight changes in synapses sent from the central neuron in the network, and defined a weight bias as the difference in synaptic weights between forward and reverse directions (in which positive values mean bias to the reverse direction). We then obtained the mean bias and the fraction of positive biases (P(bias &gt;0)) over 100 different realizations of spike trains generated with the same parameter values. For each number of spikes per neuron (2, 3, 4 and 5 spikes), we ran 1000 simulations using different mean ISIs and time lags randomly sampled from the interval [5, 50 ms].</p><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.34171.007</object-id><label>Figure 3.</label><caption><title>Reversely biased weight changes for symmetric STDP against variations in firing patterns.</title><p>(<bold>A</bold>) Two examples show firing sequences having different ISIs and propagation speeds. (<bold>B</bold>) Gaussian-shaped symmetric STDP was used in the simulations (c.f., <xref ref-type="fig" rid="fig1">Figure 1</xref> in <xref ref-type="bibr" rid="bib45">Mishra et al., 2016</xref>). (<bold>C</bold>) Changes in the amplitude ratio of EPSC during a 20 Hz stimulation are shown (c.f., Supplementary Figure 5 in <xref ref-type="bibr" rid="bib27">Guzman et al., 2016</xref>). See the text for the parameter setting. (<bold>D</bold>) The mean (top) and fraction (bottom) of biases towards reverse direction are plotted for various parameter settings. A more positive bias indicates stronger weight changes in the reverse direction. Black dots correspond to parameter settings giving statistically significant positive or negative biases (p&lt;0.01 in Wilcoxon signed rank test for the mean bias or binomial test for P(bias &gt;0)), whereas grey dots are not significant. Red lines are linear fits to the data and blue lines indicate zero-bias (mean bias = 0 and P(bias &gt;0)=0.5). See also <xref ref-type="table" rid="table1">Table 1</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig3-v2"/></fig><p>Significant biases toward the reverse direction were observed in broad simulation conditions (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). The biases were statistically significant (p&lt;0.01 in Wilcoxon signed rank test for mean bias or binomial test for P(bias &gt;0)) already in a part of conditions with two spikes per neuron, and the effect became prominent as the number of spikes increased. In general, the magnitude of synaptic changes is larger for a faster spike propagation (<xref ref-type="fig" rid="fig3">Figure 3D</xref>, <xref ref-type="table" rid="table1">Table 1</xref>), which is reasonable because the potentiation of symmetric STDP becomes stronger as presynaptic firing and postsynaptic firing get closer in time. On the other hand, P(bias &gt;0) was greater for a smaller mean ISI, and it did not depend on the propagation speed (<xref ref-type="fig" rid="fig3">Figure 3D</xref>, <xref ref-type="table" rid="table1">Table 1</xref>). Especially, all simulations showed statistically significant biases to the reverse direction regardless of the propagation speed when the number of spikes per neuron is 4 or five and the mean ISI &lt;20 ms. This implies that the bias toward the reverse direction is the most prominent when the neural network propagates a sequence of bursts with intraburst ISIs less than 20 ms. Such bursting is actually observed in CA3 in vivo (<xref ref-type="bibr" rid="bib47">Mizuseki et al., 2012</xref>) and simulations of a CA3 recurrent network model suggest that bursting plays a crucial role in propagation of firing sequences (<xref ref-type="bibr" rid="bib54">Omura et al., 2015</xref>).</p><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.34171.008</object-id><label>Table 1.</label><caption><title>Correlations between parameters and biases to reverse direction.</title><p>Correlations (r) between the values of parameters (mean ISI and propagation speed of spike trains, parameters of short-term plasticity) and biases in recurrent synaptic weights toward the reverse direction are listed for <xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig4">4</xref> together with the p-values.</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top"/><th valign="top">r</th><th valign="top">P</th></tr></thead><tbody><tr><td valign="top">2 spikes, ISI – Mean bias</td><td valign="top">0.386</td><td valign="top"><p><inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">2 spikes, Speed – Mean bias</td><td valign="top">−0.252</td><td valign="top"><p><inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">2 spikes, ISI – P(bias &gt; 0)</td><td valign="top">−0.279</td><td valign="top"><p><inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">2 spikes, Speed– P(bias &gt; 0)</td><td valign="top">0.156</td><td valign="top"><p><inline-formula><mml:math id="inf5"><mml:mn>7.08</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></p></td></tr><tr><td valign="top">3 spikes, ISI – Mean bias</td><td valign="top">0.315</td><td valign="top"><p><inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">3 spikes, Speed – Mean bias</td><td valign="top">−0.503</td><td valign="top"><p><inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">3 spikes, ISI – P(bias &gt; 0)</td><td valign="top">−0.539</td><td valign="top"><p><inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">3 spikes, Speed– P(bias &gt; 0)</td><td valign="top">0.108</td><td valign="top">0.00066</td></tr><tr><td valign="top">4 spikes, ISI – Mean bias</td><td valign="top">0.125</td><td valign="top"><p><inline-formula><mml:math id="inf9"><mml:mn>7.14</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></p></td></tr><tr><td valign="top">4 spikes, Speed – Mean bias</td><td valign="top">−0.616</td><td valign="top"><p><inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">4 spikes, ISI – P(bias &gt; 0)</td><td valign="top">−0.728</td><td valign="top"><p><inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">4 spikes, Speed– P(bias &gt; 0)</td><td valign="top">0.104</td><td valign="top">0.00104</td></tr><tr><td valign="top">5 spikes, <inline-formula><mml:math id="inf12"><mml:mi>U</mml:mi></mml:math></inline-formula>– Mean bias</td><td valign="top">0.914</td><td valign="top"><p><inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">5 spikes, <inline-formula><mml:math id="inf14"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> – Mean bias</td><td valign="top">0.236</td><td valign="top"><p><inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">5 spikes, <inline-formula><mml:math id="inf16"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> – Mean bias</td><td valign="top">−0.0455</td><td valign="top">0.151</td></tr><tr><td valign="top">5 spikes, <inline-formula><mml:math id="inf17"><mml:mi>U</mml:mi></mml:math></inline-formula> – P(bias&gt;0)</td><td valign="top">0.869</td><td valign="top"><p><inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">5 spikes, <inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>– P(bias&gt;0)</td><td valign="top">0.264</td><td valign="top"><p><inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">5 spikes, <inline-formula><mml:math id="inf21"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> – P(bias&gt;0)</td><td valign="top">−0.0416</td><td valign="top">0.188</td></tr></tbody></table><table frame="hsides" rules="groups"><tbody><tr><td valign="top">5 spikes, ISI – Mean bias</td><td valign="top">−0.0896</td><td valign="top">0.00459</td></tr><tr><td valign="top">5 spikes, Speed – Mean bias</td><td valign="top">−0.658</td><td valign="top"><p><inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">5 spikes, ISI – P(bias &gt; 0)</td><td valign="top">−0.817</td><td valign="top"><p><inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">5 spikes, Speed– P(bias &gt; 0)</td><td valign="top">0.0280</td><td valign="top">0.376</td></tr></tbody></table></table-wrap><p>Parameters that regulate STP also influence the bias toward the reverse direction. Actually, these parameters largely change in the hippocampus depending on experimental settings (<xref ref-type="bibr" rid="bib27">Guzman et al., 2016</xref>). Therefore, we also performed simulations with randomly sampled values of the initial release probability of neurotransmitters (<inline-formula><mml:math id="inf24"><mml:mi>U</mml:mi></mml:math></inline-formula>) and the time constants of short-term depression and facilitation (<inline-formula><mml:math id="inf25"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf26"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). Here, the number of spikes per neuron was fixed to five, and the ISI and time lag were independently sampled from the interval [5, 20 ms] in every trial. As shown in <xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="table" rid="table1">Table 1</xref>, both mean bias and P(bias&gt;0) clearly depend on the initial release probability. Prominent bias was observed for <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>U</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, and it gradually disappeared as <inline-formula><mml:math id="inf28"><mml:mi>U</mml:mi></mml:math></inline-formula> was decreased. The bias was weakly correlated with <inline-formula><mml:math id="inf29"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, but there was almost no correlation between the bias and <inline-formula><mml:math id="inf30"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="table" rid="table1">Table 1</xref>). In sum, the bias toward the reverse direction occurred robustly for a sufficiently high intraburst firing frequency and a sufficiently high release probability of neurotransmitters.</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.34171.009</object-id><label>Figure 4.</label><caption><title>Reversely biased weight changes against variations in short-term plasticity.</title><p>The mean and fraction of positive biases toward reverse direction are shown in various parameter settings of short-term plasticity, where a more positive bias indicates stronger weight changes in the reverse direction. Black dots correspond to parameter settings giving statistically significant positive or negative biases (p&lt;0.01 in Wilcoxon signed rank test for the mean bias or binomial test for P(bias &gt;0)), whereas grey dots are not significant. Red lines are linear fits to the data and blue lines indicate zero-bias (mean bias = 0 and P(bias &gt;0)=0.5). See also <xref ref-type="table" rid="table1">Table 1</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig4-v2"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34171.010</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Evaluation of biases toward reverse direction for asymmetric STDP.</title><p>The mean and fraction of positive biases toward reverse direction are shown in various parameter settings of short-term plasticity, where a more positive bias indicates stronger weight changes in the reverse direction. Black dots correspond to parameter settings giving statistically significant positive or negative biases (p&lt;0.01 in Wilcoxon signed rank test for the mean bias or binomial test for P(bias &gt;0)), whereas grey dots are not significant. Red lines are linear fits to the data and blue lines indicate zero-bias (mean bias = 0 and P(bias &gt;0)=0.5).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig4-figsupp1-v2"/></fig></fig-group><p>In contrast to symmetric STDP, asymmetric STDP was not effective in potentiating reversed synaptic transmissions even if it was modulated by STP. In our simulations with parameters taken from experiments in CA1 (<xref ref-type="bibr" rid="bib2">Bi and Poo , 2001</xref>), such a potentiation effect was never observed for asymmetric STDP with all-to-all spike coupling for any parameter value of STP and the number of spikes per neuron (5 or 15 spikes) (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). However, asymmetric STDP with nearest-neighbor spike coupling (<xref ref-type="bibr" rid="bib30">Izhikevich and Desai, 2003a</xref>), in which only the nearest postsynaptic spikes before and after a presynaptic spike were taken into account, generated statistically significant biases toward the reverse direction in some parameter region (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). In this case, large biases required large values of <inline-formula><mml:math id="inf31"><mml:mi>U</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf32"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and a large number of spikes per neuron (15 spikes). Thus, the condition that asymmetric STDP generates the biases to the reverse direction is severely limited, although we cannot exclude this possibility.</p></sec><sec id="s2-4"><title>Bias effects induced by spike trains during run</title><p>We also tested whether the realistic activity pattern of place cells during run can induce the directional bias. When a rat passes through place fields of CA3 place cells, they typically shows bell-shape activity patterns duration of which is about 1 s and mean peak firing rate is about 13 Hz (<xref ref-type="bibr" rid="bib46">Mizuseki and Buzsáki, 2013</xref>; <xref ref-type="bibr" rid="bib47">Mizuseki et al., 2012</xref>). Firing of place cells is phase-locked to theta oscillation and the firing phase gradually advances as a rat moves through place fields (theta-phase precession). Furthermore, firing sequences of place cells scan the path from behind to ahead of the rat in every theta cycle, which is a phenomenon called theta sequence (<xref ref-type="bibr" rid="bib17">Dragoi and Buzsáki, 2006</xref>; <xref ref-type="bibr" rid="bib22">Foster and Wilson, 2007</xref>; <xref ref-type="bibr" rid="bib29">Huxter et al., 2008</xref>; <xref ref-type="bibr" rid="bib52">O'Keefe and Recce, 1993</xref>; <xref ref-type="bibr" rid="bib75">Wang et al., 2015</xref>; <xref ref-type="bibr" rid="bib77">Wikenheiser and Redish, 2015</xref>). Some models of hippocampal sequence learning hypothesized that these compressed sequential activity patterns enhance memory formation through STDP (<xref ref-type="bibr" rid="bib35">Jensen and Lisman, 1996</xref>, <xref ref-type="bibr" rid="bib36">2005</xref>; <xref ref-type="bibr" rid="bib62">Sato and Yamaguchi, 2003</xref>).</p><p>Here, we simulated weight biases induced by Poisson spike trains that mimic place-cell activities when a rat is running through 81 equidistantly-spaced place fields. We modified both mean peak firing rates and magnitude of theta phase-locking (phase selectivity), as shown in <xref ref-type="fig" rid="fig5">Figure 5A</xref> (see Materials and methods). We found that weight biases primarily depended on coarse-grained firing rates, but phase selectivity had no significant effect in our model (<xref ref-type="fig" rid="fig5">Figure 5B</xref>, <xref ref-type="table" rid="table2">Table 2</xref>). Noticeable effects of phase selectivity on weight biases emerged for a narrow STDP time window of 10 ms (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>, <xref ref-type="table" rid="table2">Table 2</xref>), suggesting that experimentally observed broad time window of STDP (70 ms) masks small differences in firing phases. As for the mean peak firing rate, 13 Hz was not high enough to induce statistically significant bias in these simulations. However, in two scenarios, weight biases can become strong during movement in our model. First, the summation of synaptic inputs from ten place cells with identical (or overlapped) place fields amplified weight biases, and the bias became significant at 13 Hz in this case (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, <xref ref-type="table" rid="table2">Table 2</xref>). Second, firing rates of place cells obey a log-normal distribution and a small fraction of place cells exhibits extremely high firing rates (&gt;30 Hz) (<xref ref-type="bibr" rid="bib46">Mizuseki and Buzsáki, 2013</xref>). These cells created large weight changes and significant directional biases (<xref ref-type="fig" rid="fig5">Figure 5B and C</xref>). We note that the bias effects of replay sequences can be also enhanced in the above scenarios. Taken together, the bias effect in our model is weaker during run than in replay events because mean firing rate is lower and theta phase-locking is not effective for learning with broad symmetric STDP. However, non-negligible bias effects may arise in some biologically plausible situations.</p><fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.34171.011</object-id><label>Figure 5.</label><caption><title>Bias effects induced by place-cell activity during run.</title><p>Simulations similar to those in <xref ref-type="fig" rid="fig3">Figure 3</xref> were performed with spike trains mimicking theta sequences of place-cell firing during run. (<bold>A</bold>) Examples of spike trains in simulations of place-cell activity during run. We had two tuning parameters: mean peak firing rate and phase selectivity. The latter controls theta-phase locking of spikes. (<bold>B</bold>) The mean and fraction of positive biases to the reverse direction calculated from a single central neuron are shown in various parameter settings. A more positive bias indicates stronger weight changes in the reverse direction. Black dots correspond to the parameter settings yielding statistically significant positive or negative biases (p&lt;0.01 in Wilcoxon signed rank test for the mean bias or binomial test for P(bias &gt;0)), whereas grey dots are not significant. Red lines are linear fits to the data and blue lines indicate zero-bias (mean bias = 0 and P(bias &gt;0)=0.5). (<bold>C</bold>) Same as B, but biases were summed over 10 neurons at the center. In B and C, the width of the STDP time window was 70 ms. See also <xref ref-type="table" rid="table2">Table 2</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig5-v2"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34171.012</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Bias effects during run induced by narrowed symmetric STDP.</title><p>Here, the STDP time window was narrowed to <inline-formula><mml:math id="inf33"><mml:mi>τ</mml:mi></mml:math></inline-formula>=10 ms. The mean and fraction of positive biases toward the reverse direction were calculated from a single central neuron in various parameter settings. A more positive bias indicates stronger weight changes in the reverse direction. Black dots correspond to parameter settings giving statistically significant positive or negative biases (p&lt;0.01 in Wilcoxon signed rank test for the mean bias or binomial test for P(bias&gt;0)), whereas grey dots are not significant. Red lines are linear fits to the data and blue lines indicate zero-bias (mean bias=0 and P(bias&gt;0)=0.5). See also <xref ref-type="table" rid="table2">Table 2</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig5-figsupp1-v2"/></fig></fig-group><table-wrap id="table2" position="float"><object-id pub-id-type="doi">10.7554/eLife.34171.013</object-id><label>Table 2.</label><caption><title>Correlations between parameters and biases during run.</title><p>Correlations (r) between the values of parameters (mean peak firing rat and phase selectivity) and biases in recurrent synaptic weights toward the reverse direction are listed for <xref ref-type="fig" rid="fig5">Figure 5</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref> together with the p-values.</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">Single-cell, Broad STDP</th><th valign="top">r</th><th valign="top">P</th></tr></thead><tbody><tr><td valign="top">Peak firing rate – Mean bias</td><td valign="top">0.958</td><td valign="top"><p><inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">Phase selectivity – Mean bias</td><td valign="top">−0.0506</td><td valign="top">0.11</td></tr><tr><td valign="top">Peak firing rate – P(bias &gt; 0)</td><td valign="top">0.911</td><td valign="top"><p><inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">Phase selecitivity – P(bias &gt; 0)</td><td valign="top">−0.0478</td><td valign="top">0.131</td></tr><tr><td valign="top">10 cells, Broad STDP</td><td valign="top">r</td><td valign="top">P</td></tr></tbody></table><table frame="hsides" rules="groups"><tbody><tr><td valign="top">Peak firing rate – Mean bias</td><td valign="top">0.979</td><td valign="top"><p><inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">Phase selectivity – Mean bias</td><td valign="top">−0.0337</td><td valign="top">0.287</td></tr><tr><td valign="top">Peak firing rate – P(bias &gt; 0)</td><td valign="top">0.926</td><td valign="top"><p><inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">Phase selectivity – P(bias &gt; 0)</td><td valign="top">−0.0241</td><td valign="top">0.447</td></tr><tr><td valign="top">Single-cell, Narrow STDP</td><td valign="top">r</td><td valign="top">P</td></tr></tbody></table><table frame="hsides" rules="groups"><tbody><tr><td valign="top">Peak firing rate – Mean bias</td><td valign="top">0.909</td><td valign="top"><p><inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">Phase selectivity – Mean bias</td><td valign="top">0.189</td><td valign="top"><p><inline-formula><mml:math id="inf39"><mml:mn>1.85</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></p></td></tr><tr><td valign="top">Peak firing rate – P(bias &gt; 0)</td><td valign="top">0.939</td><td valign="top"><p><inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top">Phase selectivity – P(bias &gt; 0)</td><td valign="top">0.0982</td><td valign="top">0.00186</td></tr></tbody></table></table-wrap></sec><sec id="s2-5"><title>Learning strongly biased forward synaptic pathways through reverse replay</title><p>By the mechanism described above, our network model can potentiate forward synaptic pathway through reverse replay. However, whether reverse replay creates strong bias to the forward direction depends crucially on two parameters, that is, the slow time constant of long-term plasticity and the strength of short-term depression. Here, we demonstrate this by simulating the one-dimensional recurrent network model similar to <xref ref-type="fig" rid="fig1">Figure 1</xref> in three different conditions. In all the cases (<xref ref-type="fig" rid="fig6">Figure 6A,B,C</xref>), we repeatedly triggered firing sequences at the beginning of each simulation trial (0 s &lt; time &lt; 5 s), which are regarded as ‘forward’ sequences corresponding to repeated sequential experiences. After this (time &gt;10 s), we repeatedly stimulated central neurons in the network to induce firing sequences, which selectively traveled along the reverse synaptic pathway strengthened by the forward sequences, as was demonstrated in <xref ref-type="fig" rid="fig1">Figure 1</xref> of the manuscript. These sequences overwrote the weight bias induced by forward sequences and eventually reversed it into the forward direction on neuron #100 (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). In the end, the bias converges to some value for which reverse replay could not propagate a long distance. On the other hand, neuron #400 was not recruited in reverse replay and hence the reversal of weight bias did not occur (<xref ref-type="fig" rid="fig6">Figure 6E</xref>).</p><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.34171.014</object-id><label>Figure 6.</label><caption><title>Learning a forward synaptic pathway through reverse replay.</title><p>We induced forward firing sequences in the 1-D recurrent network from 0 s to 5 s, and then stimulated neurons at the center from 10 s to 30 s. We simulated three conditions in which parameters for long-term and short-term plasticity were different (see the main text). (<bold>A, B, C</bold>) Simulated neural activities in conditions 1, 2 and 3, respectively. We used a long time constant for long-term plasticity and strong short-term depression in the condition 1. Compared with the condition 1, the time constant was shortened in the condition 2 and short-term depression was also weakened in the condition 3. (<bold>D, E</bold>) Changes in the directional biases of synaptic weights on neurons #100 and #400, respectively. Red, blue and green lines correspond to the conditions 1, 2 and 3, respectively. A more positive bias indicates stronger weights in the reverse direction of the initial forward sequences.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig6-v2"/></fig><p>In the condition 1 (<xref ref-type="fig" rid="fig6">Figure 6A</xref>), modifications of synaptic weights were relatively slow (time constant was 5000 ms) and the depression effect of STP was the same as in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Due to the slow modifications of synaptic weights, a large number of reverse replay was generated before the bias was overwritten. Therefore, accumulated weight bias to the forward direction became the largest in the final state (<xref ref-type="fig" rid="fig6">Figure 6D</xref>, red). In the condition 2 (<xref ref-type="fig" rid="fig6">Figure 6B</xref>), the time constant for weight changes was shorter (500 ms) and accordingly each reverse replay rapidly changed the weight bias. Consequently, reverse replay stopped earlier and the weight bias became smaller than the condition 1 (<xref ref-type="fig" rid="fig6">Figure 6D</xref>, blue). However, the bias still converges to the forward direction because firing sequences can propagate even when synaptic weights were weakly biased to the opposite direction. In the condition 3 (<xref ref-type="fig" rid="fig6">Figure 6C</xref>), we weakened STP in addition to the short time constant for weight changes (see Materials and methods). Because short-term depression enhances the generation of firing sequences (<xref ref-type="bibr" rid="bib59">Romani and Tsodyks, 2015</xref>), this manipulation further reduced the number of reverse replay and consequently the final value of weight bias (<xref ref-type="fig" rid="fig6">Figure 6D</xref>, green).</p><p>These results demonstrate that enhanced firing propagation by STP and relatively slow long-term plasticity are necessary to create strongly biased forward synaptic pathways through reverse replay. Strong short-term depression may be replaced by other mechanisms such as dendritic spikes, which also enhance the propagation of firing sequences (<xref ref-type="bibr" rid="bib34">Jahnke et al., 2015</xref>). However, this possibility was not pursued in the present study.</p></sec><sec id="s2-6"><title>Goal-directed path learning through reverse replay</title><p>We now demonstrate how reverse replay events starting from a rewarded position enables the learning of goal-directed paths. We consider the case where an animal is exploring on a W-maze (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). During navigation, the animal gets a reward at the one end of the arm (position D2), but not at the opposite end (position D1) and other locations. In each trial, the animal starts at the center arm (position A) and runs into one of the two side arms at position B. In the present simulations, the animal visits both ends alternately: it reaches to D1 in <inline-formula><mml:math id="inf41"><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>-th trials and D2 in <inline-formula><mml:math id="inf42"><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>-th trials, where <italic>n</italic> is an integer. After reaching either of the ends (i.e. D1 or D2), the animal stops there for 7 s.</p><fig-group><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.34171.015</object-id><label>Figure 7.</label><caption><title>Goal-directed path learning with reverse replay on a W-maze.</title><p>(<bold>A</bold>) An animal alternately repeats traverses from starting position A to two goal positions D1 and D2 on a track. (<bold>B</bold>) Schematic illustration of a 2-D recurrent network of place cells. The conjunction of receptive fields of all place cells covers the entire track. Adjacent place cells were interconnected via excitatory synapses. (<bold>C</bold>) A color code specifies the three portions of the W-maze in the following linearized plots. (<bold>D, E</bold>) Linearized plots of the animal’s position (top) and simulated neural activities of place cells on the track (bottom). Black arrows indicate the end points of goal-directed sequences from A to D2 through B, a red arrow indicates the starting points of reverse replay from D2 to A through B, and blue arrows indicate the end point and starting point of replays through unexperienced paths D1 to D2 (trial 5) and D2 to D1 (trial 6), respectively. (<bold>F, G, H</bold>) The number of firing sequences triggered from A (<bold>F</bold>), from D2 (<bold>G</bold>) and from D1 (<bold>H</bold>) in each of 10 independent simulation sets (gray points). Black points show the means taken over the simulation sets.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig7-v2"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34171.016</object-id><label>Figure 7—figure supplement 1.</label><caption><title>Simulated place-cell activity without theta oscillation on W-maze.</title><p>Typical neural activities on the W-maze when we turned off theta oscillation. Firing sequences propagated long distances to both forward and reverse directions even during run.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig7-figsupp1-v2"/></fig><media id="fig7video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-34171-fig1-v2.mp4"><object-id pub-id-type="doi">10.7554/eLife.34171.017</object-id><label>Figure 7-Video 1.</label><caption><title>Simulation of goal-directed path learning with reverse replay in a 2-D recurrent neural network.</title><p>Movie of neural activities in the simulations shown in <xref ref-type="fig" rid="fig7">Figure 7</xref>. The pseudo-color map corresponds to the firing rates (Hz) of place cells arranged on a 2-D square lattice. Firing rates above 200 Hz was truncated to 200 Hz. White circle shows the current position of the animal.</p></caption></media></fig-group><p>We constructed the 50 × 50 two-dimensional (2-D) place-cell network associated to the 2-D space that the animal explored (<xref ref-type="fig" rid="fig7">Figure 7B</xref>), using the rate neuron model. Each place cell had a place field in the corresponding position on the 2-D space and received global inhibitory feedback proportional to the overall network activity. Neighboring place cells were reciprocally connected with excitatory synapses, which were modulated by short-term and long-term plasticity rules as in <xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="fig" rid="fig6">Figure 6</xref>. During the delivery of reward, we mimicked dopaminergic modulations by enhancing the inputs to CA3 and increasing the frequency of triggering firing sequences (<xref ref-type="bibr" rid="bib1">Ambrose et al., 2016</xref>; <xref ref-type="bibr" rid="bib65">Singer and Frank, 2009</xref>). Under this condition, a larger number of reverse replay was generated in the rewarded position. Thus, larger potentiation of synaptic pathways toward reward is expected in our model.</p><p>After a few traversals on the W-maze, the network generated reverse replay at D1 and D2 (<xref ref-type="fig" rid="fig7">Figure 7D and E</xref>, red arrows) and forward replay at A (<xref ref-type="fig" rid="fig7">Figure 7D and E</xref>, black arrows) during immobility, and theta oscillation induced theta sequences along the animal’s path (see <xref ref-type="video" rid="fig7video1">Figure 7—video 1</xref>). Notably, in trial five and later trials, forward replay selectively traveled towards the rewarded position D2. Furthermore, firing sequences that started from the non-rewarded position D1 propagated to the rewarded position D2 but not to the start A (<xref ref-type="fig" rid="fig7">Figure 7D and E</xref>, blue arrows). We note that the animal never traveled directly from D2 to D1 in our simulation. Thus, the network model could combine multiple spatial paths to form a synaptic pathway that has not been traversed by the animal. All these properties of firing sequences look convenient for the goal-directed learning of spatial map.</p><p>We statistically confirmed the above-mentioned biases in firing sequences. We performed independent simulations of 10 model rats, in which five rats visited the two arms in the above-mentioned order, and the other five rats visited the arms in the reversed sequential order. In each simulation, we counted the number of firing sequences propagating along different synaptic pathways. Propagation of firing sequences triggered at the start A was significantly biased to the rewarded position D2 (<xref ref-type="fig" rid="fig7">Figure 7F</xref>, Wilcoxon’s signed rank test, p=<inline-formula><mml:math id="inf43"><mml:mn>5.86</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>). While firing sequences from D2 tended to be reverse replay which propagates to A (<xref ref-type="fig" rid="fig7">Figure 7G</xref>, Wilcoxon’s signed rank test, p=<inline-formula><mml:math id="inf44"><mml:mn>5.86</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>), the majority of firing sequences from D1 propagated prospectively to D2 and hence were goal-directed sequences (<xref ref-type="fig" rid="fig7">Figure 7H</xref>, Wilcoxon’s signed rank test, p=<inline-formula><mml:math id="inf45"><mml:mn>5.57</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>).</p><p>To visualize how the recurrent network was optimized for the goal-directed exploratory behavior, we defined ‘connection vectors’ from recurrent synaptic weights. For each place cell, we calculated the weighted sum of eight unit vectors each directed towards one of the eight neighboring neurons, using the corresponding synaptic weights (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). These connection vectors represent the average direction of neural activity transmitted from each neuron, and the 2-D vector field shows the flow of neural activities in the 2-D recurrent network and hence in the 2-D maze. We note that these vectors bias the flow, but actual firing sequences can sometimes travel in different directions from the vector flow. Initially, synaptic connections were random and the connection vector field was not spatially organized (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>). However, after the exploration, the vector field was organized so as to route neural activities to those neurons encoding the rewarded position on the track (<xref ref-type="fig" rid="fig8">Figure 8B</xref>). A similar route map was also obtained when we reversed the sequential order of visits to the two arms (<xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2</xref>) but was abolished when we removed reward (<xref ref-type="fig" rid="fig8s3">Figure 8—figure supplement 3</xref>) or the effect of STP on Hebbian plasticity (<xref ref-type="fig" rid="fig8s4">Figure 8—figure supplement 4</xref>). As demonstrated previously, direct synaptic pathways from D1 to D2 were also created. The emergence of direct paths relies on two mechanisms in this model. First, as seen in <xref ref-type="fig" rid="fig8s3">Figure 8—figure supplement 3</xref>, connections are biased from goal to start when there is no reward at the goal because theta sequences enhance synaptic pathways opposite to the direction of animal's movement. In non-rewarded travels, these directional biases are not overwritten by reverse replay. Thus, the relative preference of a synaptic pathway in hippocampal sequential firing decreases for exploration that does not result in reward. Second, some of reverse replay sequences from D2 propagates into D1 instead of the stem arm (<xref ref-type="fig" rid="fig7">Figure 7E and G</xref> and <xref ref-type="video" rid="fig7video1">Figure 7—video 1</xref>), and such joint replay enhances biases towards goal through unexperienced spatial paths. Thus, our model creates a map not only for the spatial paths experienced by the animal, but also for their possible combinations if they guide the animal directly to the rewarded position from a point in the space. In this sense, our model optimizes the cognitive map of the spatial environment.</p><fig-group><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.34171.018</object-id><label>Figure 8.</label><caption><title>Recurrent connections organized on the W-maze for activity propagation toward reward.</title><p>(<bold>A</bold>) Calculation of connection vectors at each position on the W-maze is schematically illustrated. Vector length in the left figure corresponds to synaptic weights. (<bold>B</bold>) The connection vectors formed through reverse replay point the directions leading to the rewarded goal along the track. Note that these vectors are meaningful only inside of the maze because the outside positions were not visited by the animal and the corresponding vectors merely represent the untrained initial states.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig8-v2"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34171.019</object-id><label>Figure 8—figure supplement 1.</label><caption><title>The connection vector field before exploration on the W-maze.</title><p>Connection vectors were calculated from the initial synaptic weights. Connection vectors pointed random directions.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig8-figsupp1-v2"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34171.020</object-id><label>Figure 8—figure supplement 2.</label><caption><title>The connection vector field after exploration in a different order.</title><p>The connection vector field after learning was calculated for a simulation setting in which the two arms were alternately visited in an order different from that of the simulation setting in <xref ref-type="fig" rid="fig7">Figure 7</xref>. Essentially the same results were obtained.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig8-figsupp2-v2"/></fig><fig id="fig8s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34171.021</object-id><label>Figure 8—figure supplement 3.</label><caption><title>The connection vector field after learning without reward.</title><p>The connection vector field after learning was calculated for a simulation setting in which no reward (no dopamine signal) was given. The vector field shows flows from the goal positions to the start position.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig8-figsupp3-v2"/></fig><fig id="fig8s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34171.022</object-id><label>Figure 8—figure supplement 4.</label><caption><title>The connection vector field after learning without modulation by short-term plasticity.</title><p>The connection vector field after learning was calculated for a simulation setting in which long-term plasticity was not modulated by short-term plasticity (STP). No consistent flows were formed.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig8-figsupp4-v2"/></fig></fig-group><p>We also examined the role of theta oscillation in our network model. When we turned off theta oscillation, the network model generated replay-like long-lasting firing sequences not only during immobility, but also during run (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>). These sequences propagated randomly in both forward and reverse directions. In our model, theta oscillation offers periodic hyperpolarization of the membrane potentials that terminates firing sequences in a short period and localizes place-cell activity. Although the absence of theta oscillation does not impair place-cell sequences during run if we weaken recurrent connection weights (e.g. the model in <xref ref-type="bibr" rid="bib75">Wang et al., 2015</xref>), such model does not show replay events. At least in our model, theta oscillation during run is useful to realize the robust generation of local place-cell activity during run and replay events simultaneously. We further explore the role of theta sequences in the next section.</p></sec><sec id="s2-7"><title>Unbiased sequence propagation enhances goal-directed behavior in a 2-D space</title><p>So far, we have shown the role of reverse replay for goal-directed learning in a 1-D environment. However, whether a similar mechanism works in a 2-D environment remains unclear. Previous models produce reverse replay of recent paths by transient upregulation of the excitability of recently activated neurons (<xref ref-type="bibr" rid="bib21">Foster and Wilson, 2006</xref>; <xref ref-type="bibr" rid="bib48">Molter et al., 2006</xref>), which may also work in a 2-D space. Such an effect has been experimentally observed, but the bias to recent paths disappears rapidly (<xref ref-type="bibr" rid="bib11">Csicsvari et al., 2007</xref>). In an open arena, prospective place-cell sequences tend to propagate from the current position to reward sites, but sequence propagation from the goal position was not biased to recent paths (<xref ref-type="bibr" rid="bib56">Pfeiffer, 2018</xref>; <xref ref-type="bibr" rid="bib55">Pfeiffer and Foster, 2013</xref>). These observations suggest that firing sequences during immobility in a 2-D space propagate isotropically from trigger points, rather than reverse replay of recent paths.</p><p>Our model predicts that such firing sequences triggered at reward sites are beneficial for goal-directed path learning in a 2-D space. To show this, we simulated the same 2-D neural network model as in the previous section, increasing initial connection weights. Because we connected only neighboring neurons, these strong neuronal wiring reflected the topological structure of 2-D square space. We intermittently stimulated the central place cells to trigger firing sequences, which homogenously propagated through the 2-D neural network (<xref ref-type="fig" rid="fig9">Figure 9A</xref>). Because sequence propagation potentiates synaptic pathways in the opposite direction, these divergent firing sequences created the connection vector field converging to the center (<xref ref-type="fig" rid="fig9">Figure 9B</xref>). This result generalizes the role of 1-D reverse replay to higher dimensional spaces: isotropic sequence propagation from reward sites achieves goal-directed sequence learning in a 2-D (or even 3-D) open field.</p><fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.34171.023</object-id><label>Figure 9.</label><caption><title>Divergent firing sequences create convergent weight biases to the triggering point.</title><p>(<bold>A</bold>) Trajectories of divergent firing sequences triggered at the center (blue circle) in a 2-D neural network. We plotted positions of the gravity center of instantaneous neural activities during sequence propagation. (<bold>B</bold>) A convergent connection vector field was formed after the simulation in (<bold>A</bold>).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig9-v2"/></fig><p>We further demonstrate how this learning mechanism works for goal-directed navigation in an open arena in a task similar to Morris water maze task (<xref ref-type="bibr" rid="bib20">Foster et al., 2000</xref>; <xref ref-type="bibr" rid="bib49">Morris et al., 1986</xref>; <xref ref-type="bibr" rid="bib71">Vorhees and Williams, 2006</xref>) and a 2-D foraging task (<xref ref-type="bibr" rid="bib55">Pfeiffer and Foster, 2013</xref>). In the simulations, an animal started from random positions in a 2-D square space to search for a reward placed at one of the four candidate reward sites (<xref ref-type="fig" rid="fig10">Figure 10A</xref>). In each trial, the animal stayed at the starting position for 3 s, ran around the 2-D space at a constant speed until it found the reward, and stayed at the reward site for 15 s. We triggered replay sequences every 1 s during immobility and theta oscillation induced theta sequences during run. At each time, we calculated a vector from the animal’s current position to the gravity center of the neural activity (corresponding to the current position expressed by the neural network), which we call the activity vector (<xref ref-type="fig" rid="fig10">Figure 10B</xref>). We used this vector to rotate the angle of the velocity vector of the animal’s movement. The velocity vector was also updated during immobility to determine the direction of the animal’s movement at the next start. Consequently, goal-directed replay sequences or theta sequences bias the animal’s movement toward the goal. Such a relationship between the animal’s movement and hippocampal firing sequences has been suggested in several experiments (<xref ref-type="bibr" rid="bib29">Huxter et al., 2008</xref>; <xref ref-type="bibr" rid="bib55">Pfeiffer and Foster, 2013</xref>; <xref ref-type="bibr" rid="bib77">Wikenheiser and Redish, 2015</xref>). One simulation set consisted of 20 trials, and the position of reward was changed every five trials. Therefore, memory of the previous trials could guide the animal to the reward in trials 2–5, 7–10, 12–15, and 17–20 (REPEAT trials), but not in trials 6, 11, 16 (SWITCH trials). We performed 10 independent simulation sets, and 10 control simulation sets in which learning was disabled and the animal’s behavior was similar to a random search.</p><fig id="fig10" position="float"><object-id pub-id-type="doi">10.7554/eLife.34171.024</object-id><label>Figure 10.</label><caption><title>Learning goal-directed behavior in a 2-D space.</title><p>In all figures, gray color shows data from individual trials or simulation sets, and black color shows means over simulations. (<bold>A</bold>) The square two-dimensional space in the simulation. (<bold>B</bold>) Computational scheme for the animal’s motion. We modulated the fixed-length velocity vector with the activity vector from the animal’s current position to the center of mass of neural activity in the network. (<bold>C</bold>) Latency to reach the goal (N = 10 simulations sets). (<bold>D</bold>) Comparison of latency in SWITCH trials (trial 6, 11, 16), REPEAT trials (trial 2–5, 7–10, 12–15, 16–20), and control simulations in which we turned off learning (N = 160 trials for REPEAT, N = 30 trials for SWITCH, N = 200 trials for CONTROL). (<bold>E</bold>) Example trajectories of the animal. Blue and red circle shows start and goal positions, respectively. (<bold>F</bold>) Comparison of the percent time spent in the quadrant containing the previous reward site between SWITCH trials with and without learning (N = 30 trials for both). (<bold>G, H</bold>) Comparison of mean angular displacements between the activity vector and reference vectors at start, during run, and goal (N = 10 simulation sets). Reference vectors were directed to reward (start and run), or directed to the recent paths (goal). We subtracted the mean angular displacements calculated from control simulations in each behavioral state.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34171-fig10-v2"/></fig><p>The model quickly learned efficient goal-directed navigation after every SWITCH trial (<xref ref-type="fig" rid="fig10">Figure 10C</xref>). Animals took relatively short paths from start to goal in REPEAT trials (<xref ref-type="fig" rid="fig10">Figure 10E</xref>), and accordingly exploration time was significantly shorter in REPEAT trials than in other trials (<xref ref-type="fig" rid="fig10">Figure 10D</xref>, Wilcoxon’s rank sum test, p&lt;<inline-formula><mml:math id="inf46"><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> for both REPEAT-SWITCH and REPEAT-CONTROL). In contrast, exploration time in SWITCH trials was longer than that in control simulations (<xref ref-type="fig" rid="fig10">Figure 10D</xref>, Wilcoxon’s rank sum test, p=<inline-formula><mml:math id="inf47"><mml:mn>3.43</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>) because animals typically explored around the previous reward site in SWITCH trials (<xref ref-type="fig" rid="fig10">Figure 10E</xref>). The exploration time around the previous reward site in SWITCH trials was significantly longer in simulations with learning than in control simulations (Wilcoxon’s rank sum test, p=<inline-formula><mml:math id="inf48"><mml:mn>3.21</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>), which is consistent with rodents’ behavior in Morris water maze task (<xref ref-type="bibr" rid="bib71">Vorhees and Williams, 2006</xref>).</p><p>To analyze biases in sequence propagation, we calculated the angle between the instantaneous activity vector and a reference vector. The reference vector was a vector from the animal’s current position to a goal (reward) before and during exploration, or a vector from the animal’s current position to the recent path (the animal’s average position within 3 s before reaching the goal) at a goal. Bias to the goal or recent paths is strong if the angle is small. However, because of the small size of the network and the 2-D space, the angles were not exactly uniform even in control simulations. To remove this effect, we calculated a mean angular displacement in each behavioral state (start, run and goal) in control simulations and subtracted these baseline values. In REPEAT trials, the bias to reward before and during exploration was stronger than the bias to recent path at the goal (<xref ref-type="fig" rid="fig10">Figure 10F</xref>, paired sample t-test, p=<inline-formula><mml:math id="inf49"><mml:mn>2.98</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> for Start-Goal, p=<inline-formula><mml:math id="inf50"><mml:mn>5.02</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> for Run-Goal). The bias at the goal was almost zero, that is, the same level as a random search. These results suggest that the bias from start to goal was stronger than that from goal to recent paths (reverse replay) in REPEAT trials, which is consistent with experimental observation (<xref ref-type="bibr" rid="bib56">Pfeiffer, 2018</xref>; <xref ref-type="bibr" rid="bib55">Pfeiffer and Foster, 2013</xref>). Furthermore, the bias during exploration suggests that weight biases also affected propagation of theta sequences. In contrast, in SWITCH trials, the bias to recent paths at the goal was significantly stronger than the bias to the goal in other periods (<xref ref-type="fig" rid="fig10">Figure 10G</xref>, paired sample t-test, p=<inline-formula><mml:math id="inf51"><mml:mn>5.9</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> for Start-Goal in SWITCH, p=<inline-formula><mml:math id="inf52"><mml:mn>4.83</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> for Run-Goal in SWITCH). This bias to recent paths in SWITCH trials can be explained by the fact that the animal typically reached reward after visiting the previous reward site which strongly attracted firing sequences (<xref ref-type="fig" rid="fig10">Figure 10E and F</xref>). Notably, this bias gives an efficient way to update connection weights for the new reward site because the connection vector fields converging to the two goals differ only in the space between the goals and updating weight biases is unnecessary outside this space. Thus, our model predicts that the bias of sequence propagation from a novel goal position to previously learned goals appears when the animal should update previous memories to a new memory. Taken together, these results suggest that divergent sequences create weight biases for convergent sequence propagation to goals in our model and this learning mechanism can be a basis for efficient goal-directed navigation in the 2-D space.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this paper, we showed that the modified Hebbian plasticity rule modulated by STP biases synaptic weights toward the reverse direction of the firing sequences that traveled through a recurrent network. We demonstrated this counterintuitive phenomenon in network models of rate neurons and those of spiking neurons obeying symmetric STDP. We further clarified for various Poisson-like sequential firing patterns that the phenomenon favors spike bursts and a high presynaptic release probability. We also showed that the selective potentiation of reverse directions is unlikely to occur for the conventional asymmetric STDP.</p><sec id="s3-1"><title>Reverse replay and STP-modulated symmetric STDP for goal-directed learning</title><p>Our results have several implications for spatial memory processing by the hippocampus. Suppose that the animal is rewarded at a spatial position after exploring a particular path. Reverse replay propagating backward from the rewarded location will strengthen the neuronal wiring in CA3 that preferentially propagates forward firing sequences to this location along the path. Because the frequency of reverse replay increases at rewarded positions (<xref ref-type="bibr" rid="bib1">Ambrose et al., 2016</xref>; <xref ref-type="bibr" rid="bib65">Singer and Frank, 2009</xref>), reward delivery induces the preferential potentiation of forward synaptic pathways, which in turn results in an enhanced occurrence of forward replay in the consolidation phase. Thus, our model predicts that reverse replay is crucial for the reinforcement of reward-seeking behavior in the animal and gives, for the first time, the mechanistic account for the way reverse replay enables the hippocampal prospective coding of reward-seeking navigation. Furthermore, if the occurrence of reverse replay is modulated not only by reward but also by other salient events for the animal, this model is immediately generalized to memorization of important paths to be replayed afterwards. An interesting example would be learning of spatial paths associated with fear memory (<xref ref-type="bibr" rid="bib78">Wu et al., 2017</xref>). Our computational results are qualitatively consistent with the experimentally observed properties of forward and reverse replay events (<xref ref-type="bibr" rid="bib1">Ambrose et al., 2016</xref>; <xref ref-type="bibr" rid="bib8">Carr et al., 2011</xref>; <xref ref-type="bibr" rid="bib15">Diba and Buzsáki, 2007</xref>; <xref ref-type="bibr" rid="bib21">Foster and Wilson, 2006</xref>; <xref ref-type="bibr" rid="bib56">Pfeiffer, 2018</xref>; <xref ref-type="bibr" rid="bib55">Pfeiffer and Foster, 2013</xref>; <xref ref-type="bibr" rid="bib65">Singer and Frank, 2009</xref>) and matches the recent finding of symmetric STDP time windows in CA3 (<xref ref-type="bibr" rid="bib45">Mishra et al., 2016</xref>).</p><p>Importantly, our model reinforces unexperienced spatial paths by connecting the multiple paths that were previously encoded by separate experiences. In the simulations on the W-maze, the network model not only learned actually traversed paths from the start (A) to the goal (D2), but also remembered paths from other locations (C1 and D1) to the goal despite that the animal had not experienced these paths. This reinforcement occurs because reverse replay sequences starting from the visited arm occasionally propagate or bifurcate into an unvisited arm at the branching point. The hippocampus can generate replay along joint paths (<xref ref-type="bibr" rid="bib79">Wu and Foster, 2014</xref>) even when the animal has no direct experience (<xref ref-type="bibr" rid="bib26">Gupta et al., 2010</xref>). Therefore, the above mechanism is biologically possible.</p></sec><sec id="s3-2"><title>Testable predictions of the model</title><p>In 1-D tracks, reverse replay is observed immediately after the first lap (<xref ref-type="bibr" rid="bib21">Foster and Wilson, 2006</xref>; <xref ref-type="bibr" rid="bib79">Wu and Foster, 2014</xref>). Our model shows that such a replay creates a bias to the forward direction (i.e. toward the reward) even in the very early stage of learning. Consistently, a weak bias to forward replay was observed in the first exposure to a long 1-D track (<xref ref-type="bibr" rid="bib12">Davidson et al., 2009</xref>). Our model predicts that the bias to the goal-directed sequences will be suppressed (or enhanced) if we selectively block (or enhance) reverse replay at the goal. Such experiments are possible by using the techniques of real-time decoding feedback (<xref ref-type="bibr" rid="bib9">Ciliberti and Kloosterman, 2017</xref>; <xref ref-type="bibr" rid="bib66">Sodkomkham et al., 2016</xref>).</p><p>The most critical assumption in our model is the rapid modulation of STDP coherent to the presynaptic neurotransmitter release of STP. Such a modulation was actually reported in the visual cortex (<xref ref-type="bibr" rid="bib23">Froemke et al., 2006</xref>). Although short-term depression also exists in CA3 (<xref ref-type="bibr" rid="bib27">Guzman et al., 2016</xref>), STDP is modulated in a slightly different fashion in the hippocampus: the strong modulation arises from the second presynaptic spike rather than the first one (<xref ref-type="bibr" rid="bib74">Wang et al., 2005</xref>). However, the experiment was performed in a dissociated culture in which hippocampal sub-regions were not distinguished. Moreover, the modulation of STDP was not tested for more than two presynaptic spikes, and whether a third presynaptic spike further facilitates or rather depresses STDP remains unknown. Therefore, the contributions of STP to STDP should be further validated in CA3. The proposed role of short-term depression in biasing replay events may also be examined by pharmacological blockade or enhancement of STP in the hippocampus (<xref ref-type="bibr" rid="bib23">Froemke et al., 2006</xref>). In addition, we showed that the dendritic ADP accumulated over multiple spikes causes a similar phenomenon (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). This can be directly tested in CA3 by modifying the protocol described previously (<xref ref-type="bibr" rid="bib45">Mishra et al., 2016</xref>). Moreover, a bias to the reverse direction can be further strengthened if some neuromodulator expands the time window of symmetric STDP selectively toward the anti-causal temporal domain (<inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>). Our model also predicts this type of metaplasticity in CA3</p><p>Neuromodulations, especially reward-triggered facilitation of replay events (<xref ref-type="bibr" rid="bib1">Ambrose et al., 2016</xref>; <xref ref-type="bibr" rid="bib65">Singer and Frank, 2009</xref>), play important roles for the proposed mechanism of goal-directed learning with reverse replay. CA3 primarily receives dopaminergic input from the locus coeruleus (LC) which signals novelty and facilitate learning in the hippocampus (<xref ref-type="bibr" rid="bib69">Takeuchi et al., 2016</xref>; <xref ref-type="bibr" rid="bib72">Wagatsuma et al., 2018</xref>; <xref ref-type="bibr" rid="bib73">Walling et al., 2012</xref>). Therefore, sequence learning in CA3 is also affected by novelty and salience of events (<xref ref-type="bibr" rid="bib43">Lisman and Grace, 2005</xref>; <xref ref-type="bibr" rid="bib42">Lisman et al., 2011</xref>). Consequently, any place in which the animal experiences behaviorally important events can be a potential goal for the hippocampal path learning, and valence of the goal is encoded in downstream areas (<xref ref-type="bibr" rid="bib14">de Lavilléon et al., 2015</xref>; <xref ref-type="bibr" rid="bib57">Redondo et al., 2014</xref>). This may explain sequence learning for fear memory (<xref ref-type="bibr" rid="bib78">Wu et al., 2017</xref>) and vicarious trial and error in hippocampus, that is, evaluation of potential paths before decision making (<xref ref-type="bibr" rid="bib37">Johnson and Redish, 2007</xref>; <xref ref-type="bibr" rid="bib64">Singer et al., 2013</xref>). In this case, reverse replay in CA3 contributes to selective forward replay of paths informative for decision making.</p><p>In our model, modulation of triggering replay events (or sharp wave ripples) crucially affects the learning with reverse replay. Therefore, other hippocampal sub-regions may also participate in goal-directed path learning. The area CA2 encodes the current position during immobility (<xref ref-type="bibr" rid="bib39">Kay et al., 2016</xref>) and can trigger sharp wave ripples (<xref ref-type="bibr" rid="bib53">Oliva et al., 2016</xref>). Thus, dopaminergic enhancement in CA2 may increase replay events from the current position as in our simulation settings. Dentate gyrus intensively encodes reward sites and triggers sharp wave ripples in CA3 in working memory task (<xref ref-type="bibr" rid="bib61">Sasaki et al., 2018</xref>). It is interesting to examine whether these ripples accompany replay sequences, which remains unclear at present. If this is indeed the case, our results suggest that CA2 and dentate gyrus also play active roles in the goal selection of hippocampal path learning.</p><p>Our model also predicts that the release probability of neurotransmitter strongly affects the magnitude and probability of bias toward the reverse direction (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Therefore, modulation of neurotransmitter release in CA3 can regulate the behavioral impact of hippocampal firing sequences. For example, acetylcholine suppresses neurotransmitter release at recurrent synapses (<xref ref-type="bibr" rid="bib28">Hasselmo, 2006</xref>), which may abolish the directional biases created during movement (see <xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig8s3">Figure 8—figure supplement 3</xref>). Presynaptic long-term plasticity (<xref ref-type="bibr" rid="bib10">Costa et al., 2015</xref>) may also affect the directional biases at longer timescales.</p></sec><sec id="s3-3"><title>Role of theta sequences in hippocampal goal-directed learning</title><p>In our simulation, the strength of theta phase-locking of place cell activity did not have significant effects on learning (<xref ref-type="fig" rid="fig5">Figure 5</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). This result poses a question against the long-standing hypothesis that theta sequences are essential for sequence learning (<xref ref-type="bibr" rid="bib35">Jensen and Lisman, 1996</xref>; <xref ref-type="bibr" rid="bib36">2005</xref>; <xref ref-type="bibr" rid="bib62">Sato and Yamaguchi, 2003</xref>). However, it is possible that theta phase-locking is effective in learning CA3-to-CA1 connections at which STDP is asymmetric and more sensitive to time differences between presynaptic and postsynaptic activities than at CA3 recurrent synapses (<xref ref-type="bibr" rid="bib2">Bi and Poo , 2001</xref>). Furthermore, our simulations in the 2-D space showed that theta sequences can act as readout of weight biases to reward, and hence are useful for planning future trajectories during exploration. This role of theta sequences is consistent with experimental findings (<xref ref-type="bibr" rid="bib29">Huxter et al., 2008</xref>; <xref ref-type="bibr" rid="bib77">Wikenheiser and Redish, 2015</xref>). Short-term facilitation also had only limited effects on the proposed learning mechanism (<xref ref-type="fig" rid="fig4">Figure 4</xref>); however, it contributed to the generation of theta sequences (<xref ref-type="bibr" rid="bib75">Wang et al., 2015</xref>). Therefore, in our model, short-term facilitation also enhances the readout of spatial information during run.</p></sec><sec id="s3-4"><title>Relationships to the previous models</title><p>By extending the role of reverse replay in 1-D space, we showed that divergent sequences that isotropically propagate from reward sites helps goal-directed sequence learning and hence efficient navigation in 2-D space. Similar foraging tasks can be solved by temporal difference (TD) learning model (<xref ref-type="bibr" rid="bib13">Dayan, 1993</xref>; <xref ref-type="bibr" rid="bib68">Sutton, 1988</xref>) and the relevance of TD learning to hippocampal information processing has been proposed (<xref ref-type="bibr" rid="bib20">Foster et al., 2000</xref>; <xref ref-type="bibr" rid="bib67">Stachenfeld et al., 2017</xref>). Thus, how our learning mechanism is related to TD learning should be mathematically investigated in the future.</p><p>A conceptual model has been proposed for goal-directed sequence learning with symmetric STDP based on the gradient field of connection strength (<xref ref-type="bibr" rid="bib56">Pfeiffer, 2018</xref>). The conceptual model concluded that goal-directed sequence learning would not occur if sequences homogenously propagate through the entire space. However, our model shows that this is not the case for STP-modulated symmetric STDP and proposes a network mechanism to implement the conceptual model based on reverse replay.</p></sec><sec id="s3-5"><title>Some limitations of the present model</title><p>While the present model could demonstrate goal-directed path learning, the model has yet to be improved to learn context-dependent switching of behavior such as navigation on an alternating T-maze. In our simulation, animals learn only reward delivered at the same location. However, in alternating T-maze tasks, the animal has to remember recent experiences to change its choices based on the stored memory. Furthermore, the experiment in <xref ref-type="bibr" rid="bib55">Pfeiffer and Foster (2013)</xref> also contains working-memory-based switching between predictable and unpredictable reward searches. Thus, the consistency between our simulations and experiments is still limited. A straightforward extension of our model is to maintain multiple charts representing the alternating paths (<xref ref-type="bibr" rid="bib60">Samsonovich and McNaughton, 1997</xref>) and switch them according to the stored short-term memory or certain context information. Each chart will be selectively reinforced by reverse replay along one of the alternating paths. This switching of CA3 activity may be supported by the dentate gyrus (<xref ref-type="bibr" rid="bib61">Sasaki et al., 2018</xref>). How to protect the previous memories from overwriting with novel reward experiences is another important issue that is left unsolved by the present model. If the animal can memorize all four candidate reward sites simultaneously, the animal can efficiently search reward even when the reward position is changed in every trial. One solution for this issue is triggering remote replay (<xref ref-type="bibr" rid="bib26">Gupta et al., 2010</xref>; <xref ref-type="bibr" rid="bib38">Karlsson and Frank, 2009</xref>) at the previous reward sites. Thus, we predict that bias of starting points of remote replay affects persistence of multiple memories.</p><p>While 2-D hippocampal place cells are omnidirectional, the majority of 1-D place cells are unidirectional (<xref ref-type="bibr" rid="bib7">Buzsáki, 2005</xref>). We did not take into account this property of 1-D place cells in this study. Because we only simulated unidirectional movements in the W-maze, the network may describe an ensemble of place cells for one direction and another neuron ensemble is necessary for the opposite direction. In this case, place cells for the path B→D1 and those for the opposite path D1→B are different. Thus, the directional bias learned in our network may not implicate direct paths from D1 to D2 for the animal. To learn unexperienced paths, continuous replay events of multiple unidirectional place-cell ensembles is necessary, which has been experimentally observed (<xref ref-type="bibr" rid="bib12">Davidson et al., 2009</xref>; <xref ref-type="bibr" rid="bib26">Gupta et al., 2010</xref>; <xref ref-type="bibr" rid="bib79">Wu and Foster, 2014</xref>). Neural network models also demonstrated that Hebbian plasticity can connect multiple unidirectional place cells at the junction points (<xref ref-type="bibr" rid="bib5">Brunel and Trullier, 1998</xref>; <xref ref-type="bibr" rid="bib7">Buzsáki, 2005</xref>; <xref ref-type="bibr" rid="bib40">Káli and Dayan, 2000</xref>). Relating to this, replay of long paths and complex spatial structures is often accompanied by concatenated sharp wave ripples (<xref ref-type="bibr" rid="bib12">Davidson et al., 2009</xref>). Interestingly, each sharp wave ripple corresponds to a segment in the spatial structure (<xref ref-type="bibr" rid="bib79">Wu and Foster, 2014</xref>). The effect of this segmentation to our learning mechanism is not obvious. Elucidating the underlying mechanism will reveal how the hippocampal circuit segment and concatenate sequential experiences.</p></sec><sec id="s3-6"><title>Possible implications of our results in other cognitive tasks</title><p>Reverse replay has not been found in the neocortical circuits. For instance, firing sequences in the rodent prefrontal cortex are reactivated only in the forward directions (<xref ref-type="bibr" rid="bib18">Euston et al., 2007</xref>). To the best of our knowledge, neocortical synapses obey asymmetric STDP (<xref ref-type="bibr" rid="bib23">Froemke et al., 2006</xref>). This seems to be consistent with the selective occurrence of forward sequences because, as suggested by our model, the sensory-evoked forward firing sequences should only strengthen forward synaptic pathways under asymmetric STDP. However, if dopamine turns asymmetric STDP into symmetric STDP, which is actually the case in hippocampal area CA1 (<xref ref-type="bibr" rid="bib6">Brzosko et al., 2015</xref>; <xref ref-type="bibr" rid="bib80">Zhang et al., 2009</xref>), forward firing sequences will reinforce the propagation of reverse sequences. Whether reverse sequences exist in the neocortex and, if not, what functional roles replay events play in the neocortical circuits are still open questions.</p><p>Whether the present neural mechanism to combine experienced paths into a novel path accounts for cognitive functions other than memory is an intriguing question. For instance, does this mechanism explain the transitivity rule of inference by neural networks? The transitive rule is one of the fundamental rules in logical thinking and says, ‘if A implies B and B implies C, then A implies C.’ This flow of logic has some similarity to that of joint forward-replay sequences, which says, ‘if visiting A leads to visiting B and visiting B leads to visiting C, then visiting A leads to visiting C.’ Logic thinking is more complex and should be more rigorous than spatial navigation, and little is known about its neural mechanisms. The proposed neural mechanism of path learning may give a cue for exploring the neural substrate for logic operations by the brain.</p><p>In sum, our model proposes a biologically plausible mechanism for goal-directed path learning through reverse sequences. In the dynamic programming-based path finding methods such as Dijkstra’s algorithm for finding the shortest path (<xref ref-type="bibr" rid="bib16">Dijkstra, 1959</xref>) and Viterbi algorithm for finding the most likely state sequences in a hidden Markov model (<xref ref-type="bibr" rid="bib3">Bishop, 2010</xref>), a globally optimal path is determined by backtrack from the goal to the start after an exhaustive local search of forward paths. Our model enables similar path finding mechanism through reverse replay. Such a mechanism has been suggested in machine learning literature (<xref ref-type="bibr" rid="bib19">Foster and Knierim, 2012</xref>), but whether and how neural dynamics achieves it remained unknown. In addition, our model predicts the roles of neuromodulators that modify plasticity rules and activity levels in sequence learning. These predictions are testable by physiological experiments.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>One-dimensional recurrent network model with rate neurons (<xref ref-type="fig" rid="fig1">Figure 1</xref>)</title><p>We simulated the network of 500 neurons. Firing rate of neuron <inline-formula><mml:math id="inf54"><mml:mi>i</mml:mi></mml:math></inline-formula> was determined as<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The function <inline-formula><mml:math id="inf55"><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> was threshold linear function<disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf56"><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0025</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf57"><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>. Excitatory synaptic current <inline-formula><mml:math id="inf58"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and Inhibitory feedback <inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> followed<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>I</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msup><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi>I</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msup><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf60"><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>10</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf61"><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. Variables for short-term synaptic plasticity <inline-formula><mml:math id="inf62"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf63"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> obeyed the following equations (<xref ref-type="bibr" rid="bib75">Wang et al., 2015</xref>):<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>F</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>U</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Parameters were <inline-formula><mml:math id="inf64"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>500</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>200</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf65"><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:math></inline-formula>. External input <inline-formula><mml:math id="inf66"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> was usually zero and changed to <inline-formula><mml:math id="inf67"><mml:mn>5</mml:mn></mml:math></inline-formula> for 10 ms when the cell was stimulated. We stimulated neurons <inline-formula><mml:math id="inf68"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mn>10</mml:mn></mml:math></inline-formula> at the beginning of simulations, and neurons <inline-formula><mml:math id="inf69"><mml:mn>245</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mn>255</mml:mn></mml:math></inline-formula> at 3 s after the beginning.</p><p>We determined initial values of excitatory weights <inline-formula><mml:math id="inf70"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">∣</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">∣</mml:mo></mml:mrow><mml:mi>d</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf71"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>27</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf72"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:math></inline-formula>. We set self-connections <inline-formula><mml:math id="inf73"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to zero throughout the simulations.</p><p>The weights were modified according to the rate-based Hebbian synaptic plasticity as<disp-formula id="equ8"><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ9"><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf74"><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf75"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1000</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>. When we simulated Hebbian synaptic plasticity without the modulation by short-term plasticity, we removed <inline-formula><mml:math id="inf76"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> from this equation and changed the value of <inline-formula><mml:math id="inf77"><mml:mi>η</mml:mi></mml:math></inline-formula> to 4.</p><p>In the simulation with accumulation of ADP (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), we calculated smoothed postsynaptic activity <inline-formula><mml:math id="inf78"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> by solving<disp-formula id="equ10"><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf79"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>80</mml:mn><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>, and changed Hebbian plasticity (9) to<disp-formula id="equ11"><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The value of <inline-formula><mml:math id="inf80"><mml:mi>η</mml:mi></mml:math></inline-formula> was also changed to 4.</p></sec><sec id="s4-2"><title>One-dimensional recurrent network model with spiking neurons (<xref ref-type="fig" rid="fig2">Figure 2</xref>)</title><p>We used Izhikevich model (<xref ref-type="bibr" rid="bib32">Izhikevich, 2003b</xref>) for the simulation of spiking neurons:<disp-formula id="equ12"><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.04</mml:mn><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>140</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ13"><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>If the membrane voltage <inline-formula><mml:math id="inf81"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>30</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:math></inline-formula>, the neuron emits a spike and the two variables were reset as <inline-formula><mml:math id="inf82"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mi>c</mml:mi> <mml:mi mathvariant="normal"/></mml:math></inline-formula>and <inline-formula><mml:math id="inf83"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:math></inline-formula>. Parameter values were <inline-formula><mml:math id="inf84"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>65</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi> <mml:mi mathvariant="normal"/><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:math></inline-formula>. Excitatory synaptic current was<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup><mml:mfenced separators="|"><mml:mrow><mml:mn>0</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup><mml:mfenced separators="|"><mml:mrow><mml:mn>0</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math></disp-formula>and the synaptic conductance followed<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>g</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>g</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf85"><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the timing of the <inline-formula><mml:math id="inf86"><mml:mi>k</mml:mi></mml:math></inline-formula>-th spike of neuron <inline-formula><mml:math id="inf87"><mml:mi>j</mml:mi></mml:math></inline-formula> and parameter values were <inline-formula><mml:math id="inf88"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>150</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi> <mml:mi mathvariant="normal"/><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>. The voltage dependence of NMDA current (<xref ref-type="bibr" rid="bib31">Izhikevich et al., 2004</xref>) was<disp-formula id="equ17"><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mo>+</mml:mo><mml:mn>80</mml:mn></mml:mrow><mml:mn>60</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mo>+</mml:mo><mml:mn>80</mml:mn></mml:mrow><mml:mn>60</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Inhibitory feedback <inline-formula><mml:math id="inf89"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> was calculated as<disp-formula id="equ18"><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi>I</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msup><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf90"><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn> <mml:mi/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi> <mml:mi/><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>10</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>. Short-term synaptic plasticity obeyed the following dynamics:<disp-formula id="equ19"><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ20"><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>F</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>U</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Parameter values were <inline-formula><mml:math id="inf91"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>500</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>200</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi> <mml:mi mathvariant="normal"/><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:math></inline-formula>. External input <inline-formula><mml:math id="inf92"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> was the same as that in the rate neuron model.</p><p>We determined initial values of synaptic weights <inline-formula><mml:math id="inf93"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> as<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">∣</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">∣</mml:mo></mml:mrow><mml:mi>d</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf94"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was 0.3 and <inline-formula><mml:math id="inf95"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:math></inline-formula>. We set self-connections <inline-formula><mml:math id="inf96"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> to zero throughout the simulations. The weights of NMDA current <inline-formula><mml:math id="inf97"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> were determined as <inline-formula><mml:math id="inf98"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and fixed at these values throughout the simulations.</p><p>The weights of AMPA current were modified by STDP as<disp-formula id="equ22"><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ23"><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mover><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We simulated two different STDP types by changing the function <inline-formula><mml:math id="inf99"><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> as follows.</p><p>Asymmetric STDP:<disp-formula id="equ24"><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Symmetric STDP:<disp-formula id="equ25"><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">∣</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">∣</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">∣</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">∣</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Parameter values were <inline-formula><mml:math id="inf100"><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1000</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf101"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi> <mml:mi mathvariant="normal"/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>40</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula> for all STDP types. We took into account contributions of all spike pairs were in the simulations. When we simulated STDP without the modulation by short-term plasticity, we removed <inline-formula><mml:math id="inf102"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> from the above equation and changed the value of <inline-formula><mml:math id="inf103"><mml:mi>η</mml:mi></mml:math></inline-formula> to 0.01.</p><p>In the simulation with short time constants (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>), we changed the values of parameters as <inline-formula><mml:math id="inf104"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>5</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.35</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf105"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>.</p></sec><sec id="s4-3"><title>Evaluation of weight changes with Poisson spike trains (<xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig4">4</xref>)</title><p>In each simulation, we sampled spike trains of 21 neurons (neuron #1 - #21) 100 times for given values of the number of spikes per neuron <inline-formula><mml:math id="inf106"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, mean inter-spike interval (ISI) <inline-formula><mml:math id="inf107"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and firing propagation speed <inline-formula><mml:math id="inf108"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. We set first spikes of neuron #<inline-formula><mml:math id="inf109"><mml:mi>n</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf110"><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Following a first spike, Poisson spike train for each neuron was simulated by sampling ISI (<inline-formula><mml:math id="inf111"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>) from the following exponential distribution:<disp-formula id="equ26"><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>.</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We induced an absolute refractory period by resampling ISI if it was shorter than 1 ms. After we generated spike trains, we simulated neurotransmitter release by solving <xref ref-type="disp-formula" rid="equ19 equ20">Equations (19) and (20)</xref> for each neuron. In <xref ref-type="fig" rid="fig3">Figure 3</xref>, parameter values of short-term plasticity were <inline-formula><mml:math id="inf112"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>150</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>40</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi> <mml:mi mathvariant="normal"/><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mn>0.37</mml:mn></mml:math></inline-formula>. In <xref ref-type="fig" rid="fig4">Figure 4</xref>, we sampled the values of <inline-formula><mml:math id="inf113"><mml:mi>U</mml:mi><mml:mo>,</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf114"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> from [0.1, 0.6], [50, 500 ms] and [10ms, 300 ms], respectively.</p><p>We calculated changes in the weight from the neuron in the center (<inline-formula><mml:math id="inf115"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>11</mml:mn></mml:math></inline-formula>) to the neuron <inline-formula><mml:math id="inf116"><mml:mi>i</mml:mi></mml:math></inline-formula> as<disp-formula id="equ27"><mml:math id="m27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi mathvariant="normal">f</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In all-to-all STDP, we calculated the above summation over all spike pairs. In nearest-neighbor STDP (<xref ref-type="bibr" rid="bib30">Izhikevich and Desai, 2003a</xref>), we considered only pairs of a presynaptic spike and the nearest postsynaptic spikes before and after the presynaptic spike. For symmetric STDP, <inline-formula><mml:math id="inf117"><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> was Gaussian (<xref ref-type="bibr" rid="bib45">Mishra et al., 2016</xref>)<disp-formula id="equ28"><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>τ</mml:mi></mml:mfrac><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf118"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf119"><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>70</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>. For asymmtric STDP, <inline-formula><mml:math id="inf120"><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> was the same as the <xref ref-type="disp-formula" rid="equ24">Equation (24)</xref> except that parameter values were changed as <inline-formula><mml:math id="inf121"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.777</mml:mn><mml:mo>,</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.273</mml:mn><mml:mo>,</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>16.8</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi> <mml:mi mathvariant="normal"/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>33.7</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib2">Bi and Poo , 2001</xref>). We calculated weight biases for each spike train as <inline-formula><mml:math id="inf122"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-4"><title>Evaluation of weight changes with theta-modulated Poisson spike trains during run (<xref ref-type="fig" rid="fig5">Figure 5</xref>)</title><p>In each simulation, we sampled one-second-long spike trains of 81 neurons (neuron #1 - #81) 100 times. Calculation of firing probabilities and sampling of spikes were performed every 1 ms time bin. We assumed a constant speed of the rat, and expressed the animal’s current position with current time <inline-formula><mml:math id="inf123"><mml:mi>t</mml:mi></mml:math></inline-formula> [s]. We defined theta phase at time <inline-formula><mml:math id="inf124"><mml:mi>t</mml:mi></mml:math></inline-formula> as <inline-formula><mml:math id="inf125"><mml:mi>θ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">π</mml:mi><mml:mo>×</mml:mo><mml:mn>8</mml:mn><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf126"><mml:mi>c</mml:mi></mml:math></inline-formula> is a random offset. Place field of each neuron was given by normalized Gaussian function<disp-formula id="equ29"><mml:math id="m29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:msqrt><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The place-field center of neuron <inline-formula><mml:math id="inf127"><mml:mi>i</mml:mi></mml:math></inline-formula> was <inline-formula><mml:math id="inf128"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>80</mml:mn></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula> which spanned from -0.5 to 1.5, and <inline-formula><mml:math id="inf129"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:math></inline-formula>. We simulated theta phase-locking with von-Mises distribution function (<xref ref-type="bibr" rid="bib3">Bishop, 2010</xref>), which is periodic version of Gaussian function<disp-formula id="equ30"><mml:math id="m30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf130"><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is the zeroth-order Bessel modified function of the first kind. The mean firing phase of neuron <inline-formula><mml:math id="inf131"><mml:mi>i</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf132"><mml:mi>t</mml:mi></mml:math></inline-formula> changed through time as <inline-formula><mml:math id="inf133"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">π</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>. Using these functions, we determined the firing rate of neuron <inline-formula><mml:math id="inf134"><mml:mi>i</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf135"><mml:mi>t</mml:mi></mml:math></inline-formula> as <inline-formula><mml:math id="inf136"><mml:mi>α</mml:mi><mml:mi>P</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> [kHz]. In this setting, <inline-formula><mml:math id="inf137"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf138"><mml:mi>β</mml:mi></mml:math></inline-formula> were the tuning parameters that control the peak firing rates and phase selectivity, respectively. The range of sampling was <inline-formula><mml:math id="inf139"><mml:mn>0.01</mml:mn><mml:mo>≤</mml:mo><mml:mi>α</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.15</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf140"><mml:mn>0.1</mml:mn><mml:mo>≤</mml:mo><mml:mi>β</mml:mi><mml:mo>≤</mml:mo><mml:mn>10</mml:mn></mml:math></inline-formula>, and the peak firing rates were calculated by smoothing spike trains of the central neuron (#41) with Gaussian kernel of the standard deviation 50 ms. Changes and biases of weights from the central neuron (<italic>j</italic>=41) were calculated in the same way with the previous section. In the evaluation of the biases summed over 10 overlapping place cells, we sampled 10 spike trains for the central neuron (#41), and summed weight biases calculated from these samples.</p></sec><sec id="s4-5"><title>Simulation of learning forward synaptic pathways through reverse replay (<xref ref-type="fig" rid="fig6">Figure 6</xref>)</title><p>We used the same network model as in Figure 1 and additionally implemented normalization of synaptic weights for homeostasis. We calculated the sum of incoming weights on each neuron (<inline-formula><mml:math id="inf141"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>) at each time step and normalized the weights as <inline-formula><mml:math id="inf142"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, where <inline-formula><mml:math id="inf143"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> denotes initial synaptic weights. We changed the time constant of long-term plasticity (<inline-formula><mml:math id="inf144"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) to 5000 ms in the condition 1, and 500 ms in the conditions 2 and 3. In the condition 3, we also changed the values of parameters for short-term plasticity and initial synaptic weights as <inline-formula><mml:math id="inf145"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>200</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf146"><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf147"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:math></inline-formula>. Neurons were stimulated every 1 s. Weight biases were calculated as <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for two neurons <inline-formula><mml:math id="inf149"><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo> <mml:mi/><mml:mn>400</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>.</p></sec><sec id="s4-6"><title>Simulations of goal-directed sequence learning on a W-maze (<xref ref-type="fig" rid="fig7">Figures 7</xref> and <xref ref-type="fig" rid="fig8">8</xref>)</title><p>We simulated an animal moving on a two-dimensional space spanned by <inline-formula><mml:math id="inf150"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf151"><mml:mi>y</mml:mi> <mml:mi mathvariant="normal"/><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>y</mml:mi><mml:mo>≤</mml:mo><mml:mn>50</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>. Coordinates of the six corners (A, B, C1, C2, D1, D2) of W-maze were <inline-formula><mml:math id="inf152"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>25</mml:mn><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:mn>15</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="inf153"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>25,35</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="inf154"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi mathvariant="normal"/><mml:mo>(</mml:mo><mml:mn>45</mml:mn><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:mn>35</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>45</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mn>15</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf156"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mn>35</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf157"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi mathvariant="normal"/><mml:mo>(</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:mn>15</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>. In each set of trials with time length <inline-formula><mml:math id="inf158"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>15</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>, we determined the position of the animal <inline-formula><mml:math id="inf159"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> at time <inline-formula><mml:math id="inf160"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>t</mml:mi> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi> <mml:mi mathvariant="normal"/><mml:mi>T</mml:mi></mml:math></inline-formula> as<disp-formula id="equ31"><mml:math id="m31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>4</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>6</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>6</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>8</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>8</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We set <inline-formula><mml:math id="inf161"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in the (2<italic>n</italic>+1)-th trials and <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in the (2<italic>n</italic>)-th trials.</p><p>The neural network consisted of 2500 place cells that were arranged on a 50 x 50 two-dimensional square lattice. The place field centers of neurons in the <inline-formula><mml:math id="inf165"><mml:mi>i</mml:mi></mml:math></inline-formula>-th column (x-axis) and the <inline-formula><mml:math id="inf166"><mml:mi>j</mml:mi></mml:math></inline-formula>-th row (y-axis) were denoted as <inline-formula><mml:math id="inf167"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>. Each place cell received excitatory connections from eight surrounding neurons. The connection weight from a neuron at <inline-formula><mml:math id="inf168"><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> to a neuron at <inline-formula><mml:math id="inf169"><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> were denoted as <inline-formula><mml:math id="inf170"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, where the possible combinations of <inline-formula><mml:math id="inf171"><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> were given as <inline-formula><mml:math id="inf172"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1,1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo> <mml:mi/><mml:mfenced separators="|"><mml:mrow><mml:mn>1,0</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo> <mml:mi/><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>0,1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1,1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1,0</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula>. Initial connection weights were uniformly random and normalized such that the sum of eight connections obeys <inline-formula><mml:math id="inf173"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>.</p><p>We simulated activities of place cells <inline-formula><mml:math id="inf174"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as<disp-formula id="equ32"><mml:math id="m32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ33"><mml:math id="m33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>I</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msubsup><mml:mi>τ</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Time constant <inline-formula><mml:math id="inf175"><mml:mi>τ</mml:mi></mml:math></inline-formula> was <inline-formula><mml:math id="inf176"><mml:mn>10</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>. The function <inline-formula><mml:math id="inf177"><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> was a threshold linear function<disp-formula id="equ34"><mml:math id="m34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf178"><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf179"><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.002</mml:mn></mml:math></inline-formula>. Inhibitory feedback <inline-formula><mml:math id="inf180"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> followed<disp-formula id="equ35"><mml:math id="m35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi>I</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf181"><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>10</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf182"><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.0005</mml:mn></mml:math></inline-formula>. Variables for short-term synaptic plasticity <inline-formula><mml:math id="inf183"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf184"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> obeyed<disp-formula id="equ36"><mml:math id="m36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ37"><mml:math id="m37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>F</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>U</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>with parameter values <inline-formula><mml:math id="inf185"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>300</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>200</mml:mn> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf186"><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:math></inline-formula>. We induced theta oscillation by<disp-formula id="equ38"><mml:math id="m38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>sin</mml:mi><mml:mo>(</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf187"><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>0.005</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf188"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1000</mml:mn></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:mfrac> <mml:mi/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>. <inline-formula><mml:math id="inf189"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> was independent Gaussian noise with the standard deviation 0.0005 kHz. We determined place-dependent inputs for each neuron <inline-formula><mml:math id="inf190"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> from the place field center of each neuron <inline-formula><mml:math id="inf191"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the current position of the animal <inline-formula><mml:math id="inf192"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>:<disp-formula id="equ39"><mml:math id="m39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf193"><mml:mi>d</mml:mi> <mml:mi/></mml:math></inline-formula>= 2. The parameter <inline-formula><mml:math id="inf194"><mml:mi>C</mml:mi></mml:math></inline-formula> was set as 0.005 kHz when the animal was moving and 0.001 kHz when the animal was stopping at D2 (the position of reward). When the animal was stopping at other positions, <inline-formula><mml:math id="inf195"><mml:mi>C</mml:mi></mml:math></inline-formula> was set at zero but occasionally changed to 0.001 kHz for a short interval of 200 ms. The occurrence of this brief activation followed Poisson process at 0.1 Hz, but it always occurred one second after the onset of each trial to trigger prospective firing sequences.</p><p>We implemented the Hebbian synaptic plasticity as<disp-formula id="equ40"><mml:math id="m40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ41"><mml:math id="m41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mover><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf196"><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf197"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>30</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>. If the sum of synaptic weights on each neuron (<inline-formula><mml:math id="inf198"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>) was greater than unity, we renormalized synaptic weights by dividing them by the sum. When we simulated Hebbian synaptic plasticity without modulations by short-term plasticity, <inline-formula><mml:math id="inf199"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was removed from the above equation and the <inline-formula><mml:math id="inf200"><mml:mi>η</mml:mi></mml:math></inline-formula> value was changed to 0.1.</p><p>We calculated 'connection vector' of each neuron <inline-formula><mml:math id="inf201"><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> by the following weighted sum of unit vectors <inline-formula><mml:math id="inf202"><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math></inline-formula>:<disp-formula id="equ42"><mml:math id="m42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s4-7"><title>Simulations of goal-directed sequence learning in a 2-D space (<xref ref-type="fig" rid="fig9">Figures 9</xref> and <xref ref-type="fig" rid="fig10">10</xref>)</title><p>We used a similar two-dimensional space and a similar 50 x 50 neural network model to those used in the simulation of the W-maze. We made some minor changes: (1) We normalized initial connection weights as <inline-formula><mml:math id="inf203"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. (2) In order to create finite-length firing sequences, we added an external inhibitory input <inline-formula><mml:math id="inf204"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> to the <xref ref-type="disp-formula" rid="equ33">Equation (33)</xref>. When the animal was immobile, we kept excitatory input <inline-formula><mml:math id="inf205"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> nonzero (<italic>C</italic>=0.001 kHz), and triggered sequences by disinhibiting the network (<inline-formula><mml:math id="inf206"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>) every 1 s and terminated sequences (<inline-formula><mml:math id="inf207"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math></inline-formula>) at 800 ms after each trigger.</p><p>In the simulation of divergent sequences (<xref ref-type="fig" rid="fig9">Figure 9</xref>), parameters of Hebbian plasticity were changed as <inline-formula><mml:math id="inf208"><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf209"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>. We triggered firing sequences at the point <inline-formula><mml:math id="inf210"><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo> <mml:mi/><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>25</mml:mn><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:mn>25</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> for 30 s.</p><p>In the simulation of foraging task (<xref ref-type="fig" rid="fig10">Figure 10</xref>), parameters of Hebbian plasticity were changed as <inline-formula><mml:math id="inf211"><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf212"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula>. Four candidate reward sites were positioned at <inline-formula><mml:math id="inf213"><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo> <mml:mi/><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>15</mml:mn><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:mn>15</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>15</mml:mn><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:mn>35</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>35</mml:mn><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:mn>15</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>35</mml:mn><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:mn>35</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>. The reward position was randomly determined in each simulation. The animal could explore the space defined by <inline-formula><mml:math id="inf214"><mml:mn>5</mml:mn><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:mn>45</mml:mn><mml:mo>,</mml:mo> <mml:mi mathvariant="normal"/><mml:mn>5</mml:mn><mml:mo>≤</mml:mo><mml:mi>y</mml:mi><mml:mo>≤</mml:mo><mml:mn>45</mml:mn></mml:math></inline-formula>. We randomly determined a starting position in this area such that the initial distance to the reward position was longer than 10, and the animal began to explore after 3-s-long immobility. When the animal reached within distance 3 from the reward, the animal was set immobile for 15 s, and then reset to the starting position of the next trial. We terminate a trial when the animal did not reach reward within 300 s, and regarded the exploration time of these trials as 300 s. We excluded these trials from the analysis of angular displacements.</p><p>We calculated the activity vector in the 2-D coordinate system as<disp-formula id="equ43"><mml:math id="m43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>when <inline-formula><mml:math id="inf215"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. We changed the animal’s position <inline-formula><mml:math id="inf216"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> through the velocity vector <inline-formula><mml:math id="inf217"><mml:mi mathvariant="bold">v</mml:mi></mml:math></inline-formula> as<disp-formula id="equ44"><label>(44)</label><mml:math id="m44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>and rotated the velocity vector towards the direction of the activity vector:<disp-formula id="equ45"><mml:math id="m45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mtext mathvariant="bold"> </mml:mtext></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf218"><mml:mi mathvariant="bold">v</mml:mi></mml:math></inline-formula> was normalized to unity at each time and <inline-formula><mml:math id="inf219"><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a two-dimensional independent normal Gaussian noise. The speed <inline-formula><mml:math id="inf220"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was 0.01 or 0 during exploration and immobility, respectively. Other values of parameters were <inline-formula><mml:math id="inf221"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf222"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:math></inline-formula> throughout the simulation. We calculated angular displacements from cosine similarity between <inline-formula><mml:math id="inf223"><mml:mi mathvariant="bold">a</mml:mi></mml:math></inline-formula> and the reference vector <inline-formula><mml:math id="inf224"><mml:mi mathvariant="bold">ρ</mml:mi></mml:math></inline-formula> every 20 ms. Before and during exploration, <inline-formula><mml:math id="inf225"><mml:mi mathvariant="bold">ρ</mml:mi></mml:math></inline-formula> was a vector from <inline-formula><mml:math id="inf226"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to the reward position. At the reward position, <inline-formula><mml:math id="inf227"><mml:mi mathvariant="bold">ρ</mml:mi></mml:math></inline-formula> was a vector from the current <inline-formula><mml:math id="inf228"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to the mean of <inline-formula><mml:math id="inf229"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> within 3 seconds before reaching the reward position. We excluded the periods in which the maximum firing rate in the network was below 0.01 kHz or the length of <inline-formula><mml:math id="inf230"><mml:mi mathvariant="bold">a</mml:mi></mml:math></inline-formula> was below 1. Due to the small size of the network and the 2-D space, angular displacements were not uniform even in the control simulations. To compensate this background biases, we calculated the mean angular displacements of the control simulations and subtracted those baseline values from the mean angular displacements obtained in each condition.</p><p>We applied paired sample t-test after checking normality of the data by Shapiro Wilk test (p&gt;0.05).</p></sec><sec id="s4-8"><title>Code availability</title><p>Simulations and visualization were written in C++ and Python 3. The codes are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/TatsuyaHaga/reversereplaymodel_codes">https://github.com/TatsuyaHaga/reversereplaymodel_codes</ext-link> (<xref ref-type="bibr" rid="bib58">Haga, 2018</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/reversereplaymodel_codes">https://github.com/elifesciences-publications/reversereplaymodel_codes</ext-link>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We are grateful to Masami Tatsuno, Kaoru Inokuchi, Takeshi Yagi, and members in Fukai lab for fruitful discussion.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Validation, Investigation, Visualization, Writing—original draft</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Funding acquisition, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.34171.025</object-id><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-34171-transrepform-v2.docx"/></supplementary-material><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Our study is based on computer simulations, and we are sharing codes in Github.</p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ambrose</surname> <given-names>RE</given-names></name><name><surname>Pfeiffer</surname> <given-names>BE</given-names></name><name><surname>Foster</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Reverse replay of hippocampal place cells is uniquely modulated by changing reward</article-title><source>Neuron</source><volume>91</volume><fpage>1124</fpage><lpage>1136</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.07.047</pub-id><pub-id pub-id-type="pmid">27568518</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bi</surname> <given-names>G</given-names></name><name><surname>Poo</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Synaptic modification by correlated activity: Hebb's postulate revisited</article-title><source>Annual Review of Neuroscience</source><volume>24</volume><fpage>139</fpage><lpage>166</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.24.1.139</pub-id><pub-id pub-id-type="pmid">11283308</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bishop</surname> <given-names>CM</given-names></name></person-group><year iso-8601-date="2010">2010</year><source>Pattern Recognition and Machine Learning</source><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blum</surname> <given-names>KI</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>A model of spatial map formation in the hippocampus of the rat</article-title><source>Neural Computation</source><volume>8</volume><fpage>85</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1162/neco.1996.8.1.85</pub-id><pub-id pub-id-type="pmid">8564805</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunel</surname> <given-names>N</given-names></name><name><surname>Trullier</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Plasticity of directional place fields in a model of rodent CA3</article-title><source>Hippocampus</source><volume>8</volume><fpage>651</fpage><lpage>665</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1998)8:6&lt;651::AID-HIPO8&gt;3.0.CO;2-L</pub-id><pub-id pub-id-type="pmid">9882023</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brzosko</surname> <given-names>Z</given-names></name><name><surname>Schultz</surname> <given-names>W</given-names></name><name><surname>Paulsen</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Retroactive modulation of spike timing-dependent plasticity by dopamine</article-title><source>eLife</source><volume>4</volume><elocation-id>e09685</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.09685</pub-id><pub-id pub-id-type="pmid">26516682</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Theta rhythm of navigation: link between path integration and landmark navigation, episodic and semantic memory</article-title><source>Hippocampus</source><volume>15</volume><fpage>827</fpage><lpage>840</lpage><pub-id pub-id-type="doi">10.1002/hipo.20113</pub-id><pub-id pub-id-type="pmid">16149082</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carr</surname> <given-names>MF</given-names></name><name><surname>Jadhav</surname> <given-names>SP</given-names></name><name><surname>Frank</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Hippocampal replay in the awake state: a potential substrate for memory consolidation and retrieval</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>147</fpage><lpage>153</lpage><pub-id pub-id-type="doi">10.1038/nn.2732</pub-id><pub-id pub-id-type="pmid">21270783</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ciliberti</surname> <given-names>D</given-names></name><name><surname>Kloosterman</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Falcon: a highly flexible open-source software for closed-loop neuroscience</article-title><source>Journal of Neural Engineering</source><volume>14</volume><elocation-id>045004</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2552/aa7526</pub-id><pub-id pub-id-type="pmid">28548044</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Costa</surname> <given-names>RP</given-names></name><name><surname>Froemke</surname> <given-names>RC</given-names></name><name><surname>Sjöström</surname> <given-names>PJ</given-names></name><name><surname>van Rossum</surname> <given-names>MC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Unified pre- and postsynaptic long-term plasticity enables reliable and flexible learning</article-title><source>eLife</source><volume>4</volume><elocation-id>e09457</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.09457</pub-id><pub-id pub-id-type="pmid">26308579</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Csicsvari</surname> <given-names>J</given-names></name><name><surname>O'Neill</surname> <given-names>J</given-names></name><name><surname>Allen</surname> <given-names>K</given-names></name><name><surname>Senior</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Place-selective firing contributes to the reverse-order reactivation of CA1 pyramidal cells during sharp waves in open-field exploration</article-title><source>European Journal of Neuroscience</source><volume>26</volume><fpage>704</fpage><lpage>716</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.2007.05684.x</pub-id><pub-id pub-id-type="pmid">17651429</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davidson</surname> <given-names>TJ</given-names></name><name><surname>Kloosterman</surname> <given-names>F</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Hippocampal replay of extended experience</article-title><source>Neuron</source><volume>63</volume><fpage>497</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.07.027</pub-id><pub-id pub-id-type="pmid">19709631</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dayan</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Improving generalization for temporal difference learning: the successor representation</article-title><source>Neural Computation</source><volume>5</volume><fpage>613</fpage><lpage>624</lpage><pub-id pub-id-type="doi">10.1162/neco.1993.5.4.613</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Lavilléon</surname> <given-names>G</given-names></name><name><surname>Lacroix</surname> <given-names>MM</given-names></name><name><surname>Rondi-Reig</surname> <given-names>L</given-names></name><name><surname>Benchenane</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Explicit memory creation during sleep demonstrates a causal role of place cells in navigation</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>493</fpage><lpage>495</lpage><pub-id pub-id-type="doi">10.1038/nn.3970</pub-id><pub-id pub-id-type="pmid">25751533</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diba</surname> <given-names>K</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Forward and reverse hippocampal place-cell sequences during ripples</article-title><source>Nature Neuroscience</source><volume>10</volume><fpage>1241</fpage><lpage>1242</lpage><pub-id pub-id-type="doi">10.1038/nn1961</pub-id><pub-id pub-id-type="pmid">17828259</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dijkstra</surname> <given-names>EW</given-names></name></person-group><year iso-8601-date="1959">1959</year><article-title>A note on two problems in connexion with graphs</article-title><source>Numerische Mathematik</source><volume>1</volume><fpage>269</fpage><lpage>271</lpage><pub-id pub-id-type="doi">10.1007/BF01386390</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragoi</surname> <given-names>G</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Temporal encoding of place sequences by hippocampal cell assemblies</article-title><source>Neuron</source><volume>50</volume><fpage>145</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2006.02.023</pub-id><pub-id pub-id-type="pmid">16600862</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Euston</surname> <given-names>DR</given-names></name><name><surname>Tatsuno</surname> <given-names>M</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Fast-forward playback of recent memory sequences in prefrontal cortex during sleep</article-title><source>Science</source><volume>318</volume><fpage>1147</fpage><lpage>1150</lpage><pub-id pub-id-type="doi">10.1126/science.1148979</pub-id><pub-id pub-id-type="pmid">18006749</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname> <given-names>DJ</given-names></name><name><surname>Knierim</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Sequence learning and the role of the hippocampus in rodent navigation</article-title><source>Current Opinion in Neurobiology</source><volume>22</volume><fpage>294</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.12.005</pub-id><pub-id pub-id-type="pmid">22226994</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname> <given-names>DJ</given-names></name><name><surname>Morris</surname> <given-names>RG</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>A model of hippocampally dependent navigation, using the temporal difference learning rule</article-title><source>Hippocampus</source><volume>10</volume><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(2000)10:1&lt;1::AID-HIPO1&gt;3.0.CO;2-1</pub-id><pub-id pub-id-type="pmid">10706212</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname> <given-names>DJ</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Reverse replay of behavioural sequences in hippocampal place cells during the awake state</article-title><source>Nature</source><volume>440</volume><fpage>680</fpage><lpage>683</lpage><pub-id pub-id-type="doi">10.1038/nature04587</pub-id><pub-id pub-id-type="pmid">16474382</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname> <given-names>DJ</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Hippocampal theta sequences</article-title><source>Hippocampus</source><volume>17</volume><fpage>1093</fpage><lpage>1099</lpage><pub-id pub-id-type="doi">10.1002/hipo.20345</pub-id><pub-id pub-id-type="pmid">17663452</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Froemke</surname> <given-names>RC</given-names></name><name><surname>Tsay</surname> <given-names>IA</given-names></name><name><surname>Raad</surname> <given-names>M</given-names></name><name><surname>Long</surname> <given-names>JD</given-names></name><name><surname>Dan</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Contribution of individual spikes in burst-induced long-term synaptic modification</article-title><source>Journal of Neurophysiology</source><volume>95</volume><fpage>1620</fpage><lpage>1629</lpage><pub-id pub-id-type="doi">10.1152/jn.00910.2005</pub-id><pub-id pub-id-type="pmid">16319206</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerstner</surname> <given-names>W</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Learning navigational maps through potentiation and modulation of hippocampal place cells</article-title><source>Journal of Computational Neuroscience</source><volume>4</volume><fpage>79</fpage><lpage>94</lpage><pub-id pub-id-type="doi">10.1023/A:1008820728122</pub-id><pub-id pub-id-type="pmid">9046453</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Girardeau</surname> <given-names>G</given-names></name><name><surname>Benchenane</surname> <given-names>K</given-names></name><name><surname>Wiener</surname> <given-names>SI</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name><name><surname>Zugaro</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Selective suppression of hippocampal ripples impairs spatial memory</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>1222</fpage><lpage>1223</lpage><pub-id pub-id-type="doi">10.1038/nn.2384</pub-id><pub-id pub-id-type="pmid">19749750</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname> <given-names>AS</given-names></name><name><surname>van der Meer</surname> <given-names>MA</given-names></name><name><surname>Touretzky</surname> <given-names>DS</given-names></name><name><surname>Redish</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Hippocampal replay is not a simple function of experience</article-title><source>Neuron</source><volume>65</volume><fpage>695</fpage><lpage>705</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.01.034</pub-id><pub-id pub-id-type="pmid">20223204</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guzman</surname> <given-names>SJ</given-names></name><name><surname>Schlögl</surname> <given-names>A</given-names></name><name><surname>Frotscher</surname> <given-names>M</given-names></name><name><surname>Jonas</surname> <given-names>P</given-names></name><name><surname>Eichenbaum</surname> <given-names>H</given-names></name><name><surname>Kesner</surname> <given-names>RP</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Morris</surname> <given-names>RGM</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name><name><surname>Rolls</surname> <given-names>ET</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Synaptic mechanisms of pattern completion in the hippocampal CA3 network</article-title><source>Science</source><volume>353</volume><fpage>1117</fpage><lpage>1123</lpage><pub-id pub-id-type="doi">10.1126/science.aaf1836</pub-id><pub-id pub-id-type="pmid">27609885</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hasselmo</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The role of acetylcholine in learning and memory</article-title><source>Current Opinion in Neurobiology</source><volume>16</volume><fpage>710</fpage><lpage>715</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2006.09.002</pub-id><pub-id pub-id-type="pmid">17011181</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huxter</surname> <given-names>JR</given-names></name><name><surname>Senior</surname> <given-names>TJ</given-names></name><name><surname>Allen</surname> <given-names>K</given-names></name><name><surname>Csicsvari</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Theta phase-specific codes for two-dimensional position, trajectory and heading in the hippocampus</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>587</fpage><lpage>594</lpage><pub-id pub-id-type="doi">10.1038/nn.2106</pub-id><pub-id pub-id-type="pmid">18425124</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izhikevich</surname> <given-names>EM</given-names></name><name><surname>Desai</surname> <given-names>NS</given-names></name></person-group><year iso-8601-date="2003">2003a</year><article-title>Relating STDP to BCM</article-title><source>Neural Computation</source><volume>15</volume><fpage>1511</fpage><lpage>1523</lpage><pub-id pub-id-type="doi">10.1162/089976603321891783</pub-id><pub-id pub-id-type="pmid">12816564</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izhikevich</surname> <given-names>EM</given-names></name><name><surname>Gally</surname> <given-names>JA</given-names></name><name><surname>Edelman</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Spike-timing dynamics of neuronal groups</article-title><source>Cerebral Cortex</source><volume>14</volume><fpage>933</fpage><lpage>944</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhh053</pub-id><pub-id pub-id-type="pmid">15142958</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izhikevich</surname> <given-names>EM</given-names></name></person-group><year iso-8601-date="2003">2003b</year><article-title>Simple model of spiking neurons</article-title><source>IEEE Transactions on Neural Networks</source><volume>14</volume><fpage>1569</fpage><lpage>1572</lpage><pub-id pub-id-type="doi">10.1109/TNN.2003.820440</pub-id><pub-id pub-id-type="pmid">18244602</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jadhav</surname> <given-names>SP</given-names></name><name><surname>Kemere</surname> <given-names>C</given-names></name><name><surname>German</surname> <given-names>PW</given-names></name><name><surname>Frank</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Awake hippocampal sharp-wave ripples support spatial memory</article-title><source>Science</source><volume>336</volume><fpage>1454</fpage><lpage>1458</lpage><pub-id pub-id-type="doi">10.1126/science.1217230</pub-id><pub-id pub-id-type="pmid">22555434</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jahnke</surname> <given-names>S</given-names></name><name><surname>Timme</surname> <given-names>M</given-names></name><name><surname>Memmesheimer</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A unified dynamic model for learning, replay, and Sharp-Wave/Ripples</article-title><source>Journal of Neuroscience</source><volume>35</volume><fpage>16236</fpage><lpage>16258</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3977-14.2015</pub-id><pub-id pub-id-type="pmid">26658873</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname> <given-names>O</given-names></name><name><surname>Lisman</surname> <given-names>JE</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Hippocampal CA3 region predicts memory sequences: accounting for the phase precession of place cells</article-title><source>Learning &amp; Memory</source><volume>3</volume><fpage>279</fpage><lpage>287</lpage><pub-id pub-id-type="doi">10.1101/lm.3.2-3.279</pub-id><pub-id pub-id-type="pmid">10456097</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname> <given-names>O</given-names></name><name><surname>Lisman</surname> <given-names>JE</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Hippocampal sequence-encoding driven by a cortical multi-item working memory buffer</article-title><source>Trends in Neurosciences</source><volume>28</volume><fpage>67</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2004.12.001</pub-id><pub-id pub-id-type="pmid">15667928</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname> <given-names>A</given-names></name><name><surname>Redish</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>12176</fpage><lpage>12189</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3761-07.2007</pub-id><pub-id pub-id-type="pmid">17989284</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karlsson</surname> <given-names>MP</given-names></name><name><surname>Frank</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Awake replay of remote experiences in the hippocampus</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>913</fpage><lpage>918</lpage><pub-id pub-id-type="doi">10.1038/nn.2344</pub-id><pub-id pub-id-type="pmid">19525943</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kay</surname> <given-names>K</given-names></name><name><surname>Sosa</surname> <given-names>M</given-names></name><name><surname>Chung</surname> <given-names>JE</given-names></name><name><surname>Karlsson</surname> <given-names>MP</given-names></name><name><surname>Larkin</surname> <given-names>MC</given-names></name><name><surname>Frank</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A hippocampal network for spatial coding during immobility and sleep</article-title><source>Nature</source><volume>531</volume><fpage>185</fpage><lpage>190</lpage><pub-id pub-id-type="doi">10.1038/nature17144</pub-id><pub-id pub-id-type="pmid">26934224</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Káli</surname> <given-names>S</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The involvement of recurrent connections in area CA3 in establishing the properties of place fields: a model</article-title><source>The Journal of Neuroscience</source><volume>20</volume><fpage>7463</fpage><lpage>7477</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.20-19-07463.2000</pub-id><pub-id pub-id-type="pmid">11007906</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>AK</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Memory of sequential experience in the hippocampus during slow wave sleep</article-title><source>Neuron</source><volume>36</volume><fpage>1183</fpage><lpage>1194</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(02)01096-6</pub-id><pub-id pub-id-type="pmid">12495631</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lisman</surname> <given-names>J</given-names></name><name><surname>Grace</surname> <given-names>AA</given-names></name><name><surname>Duzel</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A neoHebbian framework for episodic memory; role of dopamine-dependent late LTP</article-title><source>Trends in Neurosciences</source><volume>34</volume><fpage>536</fpage><lpage>547</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2011.07.006</pub-id><pub-id pub-id-type="pmid">21851992</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lisman</surname> <given-names>JE</given-names></name><name><surname>Grace</surname> <given-names>AA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The hippocampal-VTA loop: controlling the entry of information into long-term memory</article-title><source>Neuron</source><volume>46</volume><fpage>703</fpage><lpage>713</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.05.002</pub-id><pub-id pub-id-type="pmid">15924857</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Middleton</surname> <given-names>SJ</given-names></name><name><surname>McHugh</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Silencing CA3 disrupts temporal coding in the CA1 ensemble</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>945</fpage><lpage>951</lpage><pub-id pub-id-type="doi">10.1038/nn.4311</pub-id><pub-id pub-id-type="pmid">27239937</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mishra</surname> <given-names>RK</given-names></name><name><surname>Kim</surname> <given-names>S</given-names></name><name><surname>Guzman</surname> <given-names>SJ</given-names></name><name><surname>Jonas</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Symmetric spike timing-dependent plasticity at CA3-CA3 synapses optimizes storage and recall in autoassociative networks</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>11552</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms11552</pub-id><pub-id pub-id-type="pmid">27174042</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mizuseki</surname> <given-names>K</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Preconfigured, skewed distribution of firing rates in the hippocampus and entorhinal cortex</article-title><source>Cell Reports</source><volume>4</volume><fpage>1010</fpage><lpage>1021</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2013.07.039</pub-id><pub-id pub-id-type="pmid">23994479</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mizuseki</surname> <given-names>K</given-names></name><name><surname>Royer</surname> <given-names>S</given-names></name><name><surname>Diba</surname> <given-names>K</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Activity dynamics and behavioral correlates of CA3 and CA1 hippocampal pyramidal neurons</article-title><source>Hippocampus</source><volume>22</volume><fpage>1659</fpage><lpage>1680</lpage><pub-id pub-id-type="doi">10.1002/hipo.22002</pub-id><pub-id pub-id-type="pmid">22367959</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Molter</surname> <given-names>C</given-names></name><name><surname>Sato</surname> <given-names>N</given-names></name><name><surname>Salihoglu</surname> <given-names>U</given-names></name><name><surname>Yamaguchi</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2006">2006</year><chapter-title>How reward can induce reverse replay of behavioral sequences in the hippocampus</chapter-title><source>International Conference on Neural Information Processing</source><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1007/11893028_1</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname> <given-names>RG</given-names></name><name><surname>Anderson</surname> <given-names>E</given-names></name><name><surname>Lynch</surname> <given-names>GS</given-names></name><name><surname>Baudry</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Selective impairment of learning and blockade of long-term potentiation by an N-methyl-D-aspartate receptor antagonist, AP5</article-title><source>Nature</source><volume>319</volume><fpage>774</fpage><lpage>776</lpage><pub-id pub-id-type="doi">10.1038/319774a0</pub-id><pub-id pub-id-type="pmid">2869411</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakashiba</surname> <given-names>T</given-names></name><name><surname>Buhl</surname> <given-names>DL</given-names></name><name><surname>McHugh</surname> <given-names>TJ</given-names></name><name><surname>Tonegawa</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Hippocampal CA3 output is crucial for ripple-associated reactivation and consolidation of memory</article-title><source>Neuron</source><volume>62</volume><fpage>781</fpage><lpage>787</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.05.013</pub-id><pub-id pub-id-type="pmid">19555647</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Dostrovsky</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>The hippocampus as a spatial map. Preliminary evidence from unit activity in the freely-moving rat</article-title><source>Brain Research</source><volume>34</volume><fpage>171</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(71)90358-1</pub-id><pub-id pub-id-type="pmid">5124915</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Recce</surname> <given-names>ML</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Phase relationship between hippocampal place units and the EEG theta rhythm</article-title><source>Hippocampus</source><volume>3</volume><fpage>317</fpage><lpage>330</lpage><pub-id pub-id-type="doi">10.1002/hipo.450030307</pub-id><pub-id pub-id-type="pmid">8353611</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliva</surname> <given-names>A</given-names></name><name><surname>Fernández-Ruiz</surname> <given-names>A</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name><name><surname>Berényi</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Role of hippocampal CA2 region in triggering Sharp-Wave ripples</article-title><source>Neuron</source><volume>91</volume><fpage>1342</fpage><lpage>1355</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.08.008</pub-id><pub-id pub-id-type="pmid">27593179</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Omura</surname> <given-names>Y</given-names></name><name><surname>Carvalho</surname> <given-names>MM</given-names></name><name><surname>Inokuchi</surname> <given-names>K</given-names></name><name><surname>Fukai</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A lognormal recurrent network model for burst generation during hippocampal sharp waves</article-title><source>Journal of Neuroscience</source><volume>35</volume><fpage>14585</fpage><lpage>14601</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4944-14.2015</pub-id><pub-id pub-id-type="pmid">26511248</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname> <given-names>BE</given-names></name><name><surname>Foster</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Hippocampal place-cell sequences depict future paths to remembered goals</article-title><source>Nature</source><volume>497</volume><fpage>74</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1038/nature12112</pub-id><pub-id pub-id-type="pmid">23594744</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname> <given-names>BE</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The content of hippocampal ‘replay’</article-title><source>Hippocampus</source><volume>91</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1002/hipo.22824</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Redondo</surname> <given-names>RL</given-names></name><name><surname>Kim</surname> <given-names>J</given-names></name><name><surname>Arons</surname> <given-names>AL</given-names></name><name><surname>Ramirez</surname> <given-names>S</given-names></name><name><surname>Liu</surname> <given-names>X</given-names></name><name><surname>Tonegawa</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Bidirectional switch of the valence associated with a hippocampal contextual memory engram</article-title><source>Nature</source><volume>513</volume><fpage>426</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1038/nature13725</pub-id><pub-id pub-id-type="pmid">25162525</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Haga</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>reversereplaymodel_codes</data-title><source>Github</source><version designator="503d545">503d545</version><ext-link ext-link-type="uri" xlink:href="https://github.com/TatsuyaHaga/reversereplaymodel_codes">https://github.com/TatsuyaHaga/reversereplaymodel_codes</ext-link></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Romani</surname> <given-names>S</given-names></name><name><surname>Tsodyks</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Short-term plasticity based network model of place cells dynamics</article-title><source>Hippocampus</source><volume>25</volume><fpage>94</fpage><lpage>105</lpage><pub-id pub-id-type="doi">10.1002/hipo.22355</pub-id><pub-id pub-id-type="pmid">25155013</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Samsonovich</surname> <given-names>A</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Path integration and cognitive mapping in a continuous attractor neural network model</article-title><source>The Journal of Neuroscience</source><volume>17</volume><fpage>5900</fpage><lpage>5920</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.17-15-05900.1997</pub-id><pub-id pub-id-type="pmid">9221787</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sasaki</surname> <given-names>T</given-names></name><name><surname>Piatti</surname> <given-names>VC</given-names></name><name><surname>Hwaun</surname> <given-names>E</given-names></name><name><surname>Ahmadi</surname> <given-names>S</given-names></name><name><surname>Lisman</surname> <given-names>JE</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dentate network activity is necessary for spatial working memory by supporting CA3 sharp-wave ripple generation and prospective firing of CA3 neurons</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>258</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1038/s41593-017-0061-5</pub-id><pub-id pub-id-type="pmid">29335604</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sato</surname> <given-names>N</given-names></name><name><surname>Yamaguchi</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Memory encoding by theta phase precession in the hippocampal network</article-title><source>Neural Computation</source><volume>15</volume><fpage>2379</fpage><lpage>2397</lpage><pub-id pub-id-type="doi">10.1162/089976603322362400</pub-id><pub-id pub-id-type="pmid">14511526</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scoville</surname> <given-names>WB</given-names></name><name><surname>Milner</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1957">1957</year><article-title>Loss of recent memory after bilateral hippocampal lesions</article-title><source>Journal of Neurology, Neurosurgery &amp; Psychiatry</source><volume>20</volume><fpage>11</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1136/jnnp.20.1.11</pub-id><pub-id pub-id-type="pmid">13406589</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singer</surname> <given-names>AC</given-names></name><name><surname>Carr</surname> <given-names>MF</given-names></name><name><surname>Karlsson</surname> <given-names>MP</given-names></name><name><surname>Frank</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Hippocampal SWR activity predicts correct decisions during the initial learning of an alternation task</article-title><source>Neuron</source><volume>77</volume><fpage>1163</fpage><lpage>1173</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.01.027</pub-id><pub-id pub-id-type="pmid">23522050</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singer</surname> <given-names>AC</given-names></name><name><surname>Frank</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Rewarded outcomes enhance reactivation of experience in the hippocampus</article-title><source>Neuron</source><volume>64</volume><fpage>910</fpage><lpage>921</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.11.016</pub-id><pub-id pub-id-type="pmid">20064396</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sodkomkham</surname> <given-names>D</given-names></name><name><surname>Ciliberti</surname> <given-names>D</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name><name><surname>Fukui</surname> <given-names>K-ichi</given-names></name><name><surname>Moriyama</surname> <given-names>K</given-names></name><name><surname>Numao</surname> <given-names>M</given-names></name><name><surname>Kloosterman</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Kernel density compression for real-time Bayesian encoding/decoding of unsorted hippocampal spikes</article-title><source>Knowledge-Based Systems</source><volume>94</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1016/j.knosys.2015.09.013</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stachenfeld</surname> <given-names>KL</given-names></name><name><surname>Botvinick</surname> <given-names>MM</given-names></name><name><surname>Gershman</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The hippocampus as a predictive map</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>1643</fpage><lpage>1653</lpage><pub-id pub-id-type="doi">10.1038/nn.4650</pub-id><pub-id pub-id-type="pmid">28967910</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sutton</surname> <given-names>RS</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Learning to predict by the methods of temporal differences</article-title><source>Machine Learning</source><volume>3</volume><fpage>9</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1007/BF00115009</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takeuchi</surname> <given-names>T</given-names></name><name><surname>Duszkiewicz</surname> <given-names>AJ</given-names></name><name><surname>Sonneborn</surname> <given-names>A</given-names></name><name><surname>Spooner</surname> <given-names>PA</given-names></name><name><surname>Yamasaki</surname> <given-names>M</given-names></name><name><surname>Watanabe</surname> <given-names>M</given-names></name><name><surname>Smith</surname> <given-names>CC</given-names></name><name><surname>Fernández</surname> <given-names>G</given-names></name><name><surname>Deisseroth</surname> <given-names>K</given-names></name><name><surname>Greene</surname> <given-names>RW</given-names></name><name><surname>Morris</surname> <given-names>RG</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Locus coeruleus and dopaminergic consolidation of everyday memory</article-title><source>Nature</source><volume>537</volume><fpage>357</fpage><lpage>362</lpage><pub-id pub-id-type="doi">10.1038/nature19325</pub-id><pub-id pub-id-type="pmid">27602521</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsodyks</surname> <given-names>M</given-names></name><name><surname>Sejnowski</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Associative memory and hippocampal place cells</article-title><source>International Journal of Neural Systems</source><volume>6</volume><fpage>81</fpage><lpage>86</lpage></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vorhees</surname> <given-names>CV</given-names></name><name><surname>Williams</surname> <given-names>MT</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Morris water maze: procedures for assessing spatial and related forms of learning and memory</article-title><source>Nature Protocols</source><volume>1</volume><fpage>848</fpage><lpage>858</lpage><pub-id pub-id-type="doi">10.1038/nprot.2006.116</pub-id><pub-id pub-id-type="pmid">17406317</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagatsuma</surname> <given-names>A</given-names></name><name><surname>Okuyama</surname> <given-names>T</given-names></name><name><surname>Sun</surname> <given-names>C</given-names></name><name><surname>Smith</surname> <given-names>LM</given-names></name><name><surname>Abe</surname> <given-names>K</given-names></name><name><surname>Tonegawa</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Locus coeruleus input to hippocampal CA3 drives single-trial learning of a novel context</article-title><source>PNAS</source><volume>115</volume><fpage>E310</fpage><lpage>E316</lpage><pub-id pub-id-type="doi">10.1073/pnas.1714082115</pub-id><pub-id pub-id-type="pmid">29279390</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walling</surname> <given-names>SG</given-names></name><name><surname>Brown</surname> <given-names>RA</given-names></name><name><surname>Miyasaka</surname> <given-names>N</given-names></name><name><surname>Yoshihara</surname> <given-names>Y</given-names></name><name><surname>Harley</surname> <given-names>CW</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Selective wheat germ agglutinin (WGA) uptake in the hippocampus from the locus coeruleus of dopamine-β-hydroxylase-WGA transgenic mice</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>6</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.3389/fnbeh.2012.00023</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>HX</given-names></name><name><surname>Gerkin</surname> <given-names>RC</given-names></name><name><surname>Nauen</surname> <given-names>DW</given-names></name><name><surname>Bi</surname> <given-names>GQ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Coactivation and timing-dependent integration of synaptic potentiation and depression</article-title><source>Nature Neuroscience</source><volume>8</volume><fpage>187</fpage><lpage>193</lpage><pub-id pub-id-type="doi">10.1038/nn1387</pub-id><pub-id pub-id-type="pmid">15657596</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Romani</surname> <given-names>S</given-names></name><name><surname>Lustig</surname> <given-names>B</given-names></name><name><surname>Leonardo</surname> <given-names>A</given-names></name><name><surname>Pastalkova</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Theta sequences are essential for internally generated hippocampal firing fields</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>282</fpage><lpage>288</lpage><pub-id pub-id-type="doi">10.1038/nn.3904</pub-id><pub-id pub-id-type="pmid">25531571</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wikenheiser</surname> <given-names>AM</given-names></name><name><surname>Redish</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The balance of forward and backward hippocampal sequences shifts across behavioral states</article-title><source>Hippocampus</source><volume>23</volume><fpage>22</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1002/hipo.22049</pub-id><pub-id pub-id-type="pmid">22736562</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wikenheiser</surname> <given-names>AM</given-names></name><name><surname>Redish</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Hippocampal theta sequences reflect current goals</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>289</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1038/nn.3909</pub-id><pub-id pub-id-type="pmid">25559082</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname> <given-names>CT</given-names></name><name><surname>Haggerty</surname> <given-names>D</given-names></name><name><surname>Kemere</surname> <given-names>C</given-names></name><name><surname>Ji</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Hippocampal awake replay in fear memory retrieval</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>571</fpage><lpage>580</lpage><pub-id pub-id-type="doi">10.1038/nn.4507</pub-id><pub-id pub-id-type="pmid">28218916</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname> <given-names>X</given-names></name><name><surname>Foster</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Hippocampal replay captures the unique topological structure of a novel environment</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>6459</fpage><lpage>6469</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3414-13.2014</pub-id><pub-id pub-id-type="pmid">24806672</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>JC</given-names></name><name><surname>Lau</surname> <given-names>PM</given-names></name><name><surname>Bi</surname> <given-names>GQ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Gain in sensitivity and loss in temporal contrast of STDP by dopaminergic modulation at hippocampal synapses</article-title><source>PNAS</source><volume>106</volume><fpage>13028</fpage><lpage>13033</lpage><pub-id pub-id-type="doi">10.1073/pnas.0900546106</pub-id><pub-id pub-id-type="pmid">19620735</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.34171.027</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Bhalla</surname><given-names>Upinder Singh</given-names></name><role>Reviewing Editor</role><aff><institution>National Centre for Biological Sciences, Tata Institute of Fundamental Research</institution><country>India</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for sending your article entitled &quot;Recurrent network model for learning goal-directed sequences through reverse replay&quot; for peer review at <italic>eLife</italic>. Your article is being evaluated by three peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation is being overseen by Michael Frank as the Senior Editor.</p><p>The reviewers felt that the topic of the paper, to obtain reverse replay through modified STDP rules, was interesting and led to some potentially significant predictions of network behavior. However, there were numerous concerns with the study, particularly relating to clarification of figures and results, and consistency with the literature.</p><p>Given the list of essential revisions, which could conceivably involve extensive new work, the editors and reviewers invite you to respond within the next two weeks with an action plan and timetable for the completion of the additional work. We plan to share your responses with the reviewers and then issue a binding recommendation.</p><p>1). The authors must clear up several points of confusion in data presentation. a) Figure 6 is confusing in many respects and can be interpreted in differentways from the authors. b) The section on theta modulation and sequences is unclear and must beclarified.</p><p>2) The authors must address concerns about apparent inconsistency with the experimental literature. These include the time-course of excitatory input, the presence of forward replays in many studies, the conjunctive coding of space and direction of motion by place cells on linear tracks, and whether replay should correlate with previous experience or future navigation. There are also concerns about whether the learning rules are appropriate for hippocampus, and whether the firing patterns in the model look like in-vivo place cell patterns.</p><p>3) The authors should make some more testable predictions, for example, the effect of NMDA knockdown on reverse replay.</p><p>These concerns and other suggestions from the reviewers are attached to help the authors.</p><p>Reviewer #1:</p><p>In this study, the authors show that one can obtain reverse replay in 1 and 2-D networks. This relies on symmetric STDP in combination with various forms of STP or postsynaptic after depolarization. The authors also map their learning rules to a T-maze context using a 2-D network and state that the network learns to do goal-directed path learning through reverse sequences. They examine how network connections organize following such learning. In principle this study is interesting as an implementation of a plasticity-driven approach to the emergence of forward and reverse replay, and provides a way to link it to goal planning.</p><p>The initial logic of the paper builds up nicely from Figure 1 through 5. One can see how to obtain reverse replay, there is evidence that this is reasonably robust, and one can see conditions where the replay will erase itself due to plasticity.</p><p>Figure 6 is a key figure, applying the learning rule to a 2-D network upon which the authors place a T maze. This is a key figure and unfortunately is very confusing.</p><p>1) The authors talk about early and late trials. I am going to assume that only trial 9 and 10 are late trials, but the authors must clarify this point.</p><p>2) There is a listing of positions A, B, C1, C2, D1, D2 in Panel A mapping to positions 0, 1, 2, 3, 4, 5 in panels C and D. It is strange to have to jump around with the naming within a single figure.</p><p>3) Worse, the mapping is different in odd trials and even trails because position 3 from panel C can either be mapped to D1 (panel A) or to B (panel A). Similarly, position B of panel A could be either position 1 or position 3 of Panels C and D. This makes no sense.</p><p>4) The authors make several statements about the reverse replay sequencesthat are hard to identify in the figure. They should individually highlightspecific reverse sequences that they want to talk about.</p><p>5) I do not see any case in the later trials where sequences travel to D2 except possibly in the first couple of spontaneous responses in trial 9 and one spontaneous trial in 10. Each of these occurs before the training run. Instead almost all the cases, e.g., in Trial 10, start from D2 and go to B. This is a perfectly reasonable reverse replay but is not presented as such in the text.</p><p>6) I do not see any case where backward sequences start from D1 and go to D2, unless the authors are conflating position 3 with D1, rather than B. If so then it is the 3 cases (2 in Trial 9 and 1 in Trial 10, which occur before the training run) which fit the bill. If so, those 3 cases look like forward sequences to me.</p><p>7) The text says that some of the reverse replay sequences from D1 propagate into D2 instead of the stem arm. I do not see any instances of this, except again if the authors have confused the identity of position 3.</p><p>8) The supplementary video looks interesting but lacks annotation to give clarity. Its value is considerably diminished as a result. Nevertheless, my impression on watching it is that my interpretation of Figure 6 is correct, and that the authors have confused position B and position D1.</p><p>9) The key paragraph three in subsection “Goal-directed path learning through reverse replay<bold>”</bold> is very anecdotal. For every statement of a certain kind of replay, the authors need to first, point to examples, and second, give statistics for how often such replays occur in a series of randomized runs.</p><p>It may well be that I am quite misunderstanding this figure, in which case the authors should explain it more clearly. Otherwise I think the figure and movie do not support the text.</p><p>Reviewer #2:</p><p>The manuscript &quot;Recurrent network model for learning goal-directed sequences through reverse replay&quot; proposes an intriguing mechanism for reverse replay of the sequential activation of place cells: combining spike-timing dependent plasticity with synaptic depression, the proposal envisions a wave packet of activity traveling through the network of neurons, such that neurons at the tail end of the packet still fire, but due to synaptic depression, no longer synaptically impinge on the neurons at the front of the packet. As a consequence, Hebbian plasticity strengthens front to back connections, hence enabling reverse replay upon reactivation. In a 2D model, the authors present a nice application of how such a network can produce sequences of place cell activations towards a goal on a path that the animal has never experienced.</p><p>The most critical assumption is not, in my opinion, the &quot;rapid modulation of STDP&quot; by synaptic depression, but rather the persistence of neural activity behind the immediate wave-front. Because of profound synaptic depletion, the fact is that there is no reverberant activity that would support the packet and cause neurons to continue to be active.</p><p>The trick appears to lie in a time constant of <italic>τ<sup>exc</sup></italic>=10 ms with which the excitatory input is convolved (Equation 3) Or, in the spiking network, an NMDA time constant of 150 ms (Equation 16), wherein the peak conductance for NMDA is slaved to the AMPA conductance.</p><p>The value of 10 ms for the time constant is, at the very least, debatable. Going back to classic papers (Koch, Rapp, Segev, 1996) or Treves (1993), the real excitatory synaptic time constant (as opposed to the membrane time constant of 10-20 ms) is extraordinarily short and on the order of 2 ms. With that kind of time constant, though, I believe the entire mechanism might collapse.</p><p>The second critique I would levy is that the model inhabits an intermediate realm: it is neither minimalist, nor veridically detailed.</p><p>In particular:</p><p>i) Equation 5-6 cover both facilitation and depression. As far as I can tell, facilitation is not at all necessary for the mechanism. Why is facilitation then included?</p><p>ii) Equation 12-13 describe the Izhikevich, 2003 model with the parameter set for the regular spiking cell (though the fact that it is the parameter set for RS is not explicitly mentioned). The only possible advantage of the Izhikevich model over an integrate-and-fire model might lie in the adaptation of the firing. But is this important in the model?</p><p>iii) Going from 1D to 2D in subsection “Goal-directed path learning through reverse replay<bold>”</bold>, the idea of theta modulation and theta sequences is sprung upon the reader, but it never became clear to me whether Equation 36 (for the theta-modulated current input) is really necessary or not.</p><p>The third critique reflects the color scheme. Throughout, inactivity is represented by black, which makes the figures hard to read in a printout or even on the screen. Please choose another color scheme that results in a white (or light-colored) background. Figure 6 is confusing, as it mixes letters on the W-shaped track (which, for some reason, is called a T-shaped track), but then the panels use numeric labels; the mapping is only explained in the last sentence of the caption. On some panels of Supplementary Figure 2, the tick-labels on the y-axes cannot be read.</p><p>Reviewer #3:</p><p>The paper describes a modified version of spike-timing dependent long-term plasticity (STDP) modulated by short-term synaptic plasticity (STP). The main advantage of this modulation is to be able to obtain an effectively asymmetric STDP rule starting from a symmetric one (symmetric STDP has been recently observed in hippocampus). The authors show for instance how an imposed sequential activation of neurons can modify synapses in a network, so that a network can spontaneously &quot;replay&quot; the sequence in the opposite order, as observed in place cells.</p><p>I think that the results nicely characterize the properties of the hypothesized plasticity rule and show a potential application in neural networks.</p><p>I have two major concerns:</p><p>1) The connection with dynamics of hippocampal place cell activity strongly focuses on reverse replays, but there might be other aspects to consider more carefully:</p><p>i) Forward replays: The modeling presented in the first part of the paper, where a reverse replay is elicited by the stimulation of place cell coding for the middle of the track, should be probably compared to the results of Davidson et al., 2009. In that paper, the rodents frequently stop away from the two ends of the track; this more closely resembles the scenario depicted in the manuscript. The results of the paper indicated that forward replays were as (or more) likely to occur compared to backward replays (similar to Diba and Buzsaki, 2007), and the propagation speed of forward and backward replays was comparable. How can one reconcile the results reported in the manuscript with these observations?</p><p>ii) Directionality of firing in linear tracks: It is generally observed that place cells code conjunctively for spatial location and direction of motion in 1D. This aspect of place field firing has not been discussed and it's not entirely clear to me how to interpret the authors’ results in light of this experimental observation.</p><p>iii) Replays in 2D: Pfeiffer and Foster, 2013 reported replays that generally did not correlate with the previous experience of the animal, rather there was a correlation with the immediate future navigational behavior of the rodent. In those experiments, the goal location was moved from session to session, and those sequences were observed within the first few trials. In a follow-up commentary (Pfeiffer, 2017), it is argued that &quot;reverse replay does not facilitate learning in a familiar environment&quot;. It would be useful to see those results and claims more carefully discussed in the manuscript.</p><p>iv) Theta sequences: During running, fast sequential activity (forward direction) of place cells within individual cycles of the theta oscillation are observed. I guess that before replays, these sequences could help in building up the asymmetric connections that later generates reverse replays. But what happens to theta sequences after the synapses are modified? Would they be less likely to occur? In general, I found the few references to theta sequences in the manuscript to be confusing.</p><p>2) The plasticity rule is loosely based on previous work in visual cortical synapses (Froemke et al., 2006). As such there is no evidence that this rule quantitatively captures the dynamics of synapses in neo-cortex or hippocampus. It would be helpful to test the plasticity rules with firing patterns more closely resembling the activity of in vivo place cells (e.g., fields of ~1s durations, peak firing ~10Hz, phase precessing) and realistic learning rates.</p><p>[Editors' note: the authors’ plan for revisions was approved and the authors made a formal revised submission.]</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.34171.028</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>The reviewers felt that the topic of the paper, to obtain reverse replay through modified STDP rules, was interesting and led to some potentially significant predictions of network behavior. However, there were numerous concerns with the study, particularly relating to clarification of figures and results, and consistency with the literature.</p><p>1) The authors must clear up several points of confusion in data presentation.a) Figure 6 is confusing in many respects and can be interpreted in differentways from the authors.</p></disp-quote><p>Following the reviewers’ suggestions, we have clarified the definitions of types of firing sequences and added quantitative evaluations in Figure 7 (Figure 6 in the previous manuscript). In short, reverse replay refer to sequences propagating backward along the spatial paths that the animal has traveled and joint replay is sequences through unexperienced paths combining two (or more) of experienced paths. Forward replay represents sequences that start from the starting point (A) and propagate along once-traveled paths in the forward direction. We specifically call sequences from A to D2 (reward site) as “goal-directed sequence”. We have confirmed our conclusion by statistics from simulations of 10 model rats (5 rats visited the arms in the reversed visiting order) (Figure 7F-H). These points are explained in paragraph four of subsection “Goal-directed path learning through reverse replay” in the revised manuscript.</p><p>We have clarified the relationship between the linearized plots and the three arms of the Y-maze by showing how we linearized the track in Figure 7C (we took a visualization method from Wu and Foster, 2014). We have also added explanations on the structure of the track, the number of trials, the schedule of rat’s movements, reward ON/OFF, and important activity patterns to the movie. In figures including heatmap (ex. Figures 1, 2 and 7), we have changed a color code in which white indicates zero.</p><disp-quote content-type="editor-comment"><p>b) The section on theta modulation and sequences is unclear and must beclarified.</p></disp-quote><p>We have added references for phase precession and theta sequence (e.g. O’Keefe and Recce, 1993; Dragoi and Buzsaki, 2006; Foster and Wilson, 2007), and have performed additional simulations to discuss the effect of phase precession and theta sequence in our model (Figure 5). We have evaluated the weight biases generated by spike trains mimicking place-cell activity with phase precession. The simulation results suggest that a bias to the reverse direction is reliably induced when the peak firing rate &gt;20 Hz (Figure 5B). However, since this value is higher than the average peak firing rate of place cells, we have additionally shown two biologically plausible cases in which significant biases can appear. First, the summation of the bias effects induced by multiple presynaptic place cells with overlapping place fields can result in a significant overall bias in realistic settings of the mean firing rate (Figure 5C). Second, because the firing rates of place cells are log-normally distributed (Mizuseki and Buszaki, 2013), some place cells show higher firing rates and produce large weight changes with large biases. However, we have found that phase precession hardly affects the weight biases (Figure 5B and 5C). All these points are explained in paragraph two of subsection “Bias effects induced by spike trains during run”.</p><p>Furthermore, simulations in 2-D space have indicated the role of theta sequences for reading out the learned paths towards the goal (Figure 10), as suggested in experiments (Johnson and Redish, 2007; Wikenheiser and Redish, 2015). These points are explained in paragraph three of subsection “Unbiased sequence propagation enhances goal-directed behavior in a 2-D space”.</p><disp-quote content-type="editor-comment"><p>2) The authors must address concerns about apparent inconsistency with the experimental literature. These include the time-course of excitatory input, the presence of forward replays in many studies, the conjunctive coding of space and direction of motion by place cells on linear tracks, and whether replay should correlate with previous experience or future navigation. There are also concerns about whether the learning rules are appropriate for hippocampus, and whether the firing patterns in the model look like in-vivo place cell patterns.</p></disp-quote><p>As for the time-course of excitatory input, we have included simulation data to show that the bias to the reverse direction occurs even without NMDA current and with shorter AMPA and inhibitory time constants. Furthermore, we have evaluated the weight biases generated by realistic place-cell activity with phase precession, as mentioned above. We have added discussion on the directionality of place cells and the related experimental results (Davidson et al., 2009, Pfeiffer and Foster, 2013 and Pfeiffer, 2017) in paragraph two of subsection “Some limitations of the present model”.</p><p>Especially, to connect our model to Pfeiffer and Foster, 2013 and Pfeiffer, 2017, we have additionally simulated learning in a 2D open-field using a 2D neural network (see Figure 9). In a 2D open-field, the directions of propagation of firing sequences from a reward site are often isotropic in our model, and are not limited to the (reverse) direction of the path that the animal has just experienced. This isotropic propagation will create connections converging to the reward site and bias both replays and theta sequences towards the reward site from an arbitrary surrounding point on the field. We suggest that these properties of our model account for experimental observations in open-field exploration tasks (Pfeiffer and Foster, 2013). We have added a new subsection &quot;Unbiased sequence propagation enhances goal-directed behavior in a 2-D space&quot; to explain all these results together with a quantitative evaluation of the directional biases in replay and theta sequences.</p><disp-quote content-type="editor-comment"><p>3) The authors should make some more testable predictions, for example, the effect of NMDA knockdown on reverse replay.</p></disp-quote><p>Experimental evidence suggests that NMDA knockdown impairs the plasticity in the hippocampus and hence degrades the formation of replay (Silva et al., 2016) and the performance of spatial learning task (Morris et al., 1986). In that case, all replay events including reverse replay will disappear and they will become ineffective for learning, whatever the roles of these events are. Therefore, we think that predictions in such a condition may not be meaningful enough. Below, we list other possible predictions of the model, which we have included in the subsection &quot;Testable predictions of the model&quot;.</p><p>Now, selective control of reverse replay is possible by using the techniques of real-time decoding feedback (Ciliberti and Kloosterman, 2017; Ciliberti, Michon and Kloosterman, 2016). First, our model predicts the consequence of such a control. For instance, if we selectively block reverse replay at a reward site, prospective firing sequences tend to propagate away from the spatial site, and accordingly the animal’s preference to the reward location will be abolished.</p><p>Second, as shown in Figure 1A-D, our model predicts that the modulation of STDP by short-term depression is crucial for the preferential strengthening of synaptic pathways reversal to the preceding activity propagation. In addition, based on the plasticity mechanisms shown in Figure 1E and 1F, we expect that this preference should be further enhanced in our model if the time window of symmetric STDP is extended into the acausal temporal domain (t<sub>post</sub> &lt; t<sub>pre</sub>). We speculate that some neuromodulators (e.g., dopamine or acetylcholine) may cause such a meta-plasticity effect in the STDP of CA3.</p><p>Third, modulation of triggering replay events (or sharp-wave ripples) is crucial for goal-directed learning in our model. Recently, it has been revealed that CA2 (Oliva et al., 2016) and dentate gyrus (Sasaki et al., 2018) trigger the significant amount of sharp-wave ripples in the awake state. Therefore, we predict that CA2 and dentate gyrus also play active roles in the goal selection of hippocampal path learning.</p><disp-quote content-type="editor-comment"><p>These concerns and other suggestions from the reviewers are attached to help the authors.</p><p>Reviewer #1:</p><p>In this study, the authors show that one can obtain reverse replay in 1 and</p><p>2-D networks. This relies on symmetric STDP in combination with various forms of STP or postsynaptic afterdepolarization. The authors also map their learning rules to a T-maze context using a 2-D network and state that the network learns to do goal-directed path learning through reverse sequences. They examine how network connections organize following such learning. In principle this study is interesting as an implementation of a plasticity-driven approach to the emergence offorward and reverse replay, and provides a way to link it to goal planning.</p><p>The initial logic of the paper builds up nicely from Figure 1 through 5. One can see how to obtain reverse replay, there is evidence that this is reasonably robust, and one can see conditions where the replay will erase itself due to plasticity.</p></disp-quote><p>We thank the reviewer for their overall positive comments on our work.</p><disp-quote content-type="editor-comment"><p>Figure 6 is a key figure, applying the learning rule to a 2-D network upon which the authors place a T maze. This is a key figure and unfortunately is very confusing.</p></disp-quote><p>We apologize that our figure was confusing. We have improved the data presentation in the revised manuscript as shown below. Please note that the previous Figure 6 is shown as Figure 7 in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>1) The authors talk about early and late trials. I am going to assume that only trial 9 and 10 are late trials, but the authors must clarify this point.</p></disp-quote><p>Late trials referred to trial 5 to 10 because sequences from D1 to D2 already appear in trial 5. However, we agree that the usage of early and late trials was not clear enough. In the revised manuscript, we showed linearized plots only for trial 5 and 6, which contain all types of sequences we want to discuss. In Figure 7, we have indicated the sequences referred to in the text by colored (red, blue and black) arrows.</p><disp-quote content-type="editor-comment"><p>2) There is a listing of positions A, B, C1, C2, D1, D2 in Panel A mapping to positions 0, 1, 2, 3, 4, 5 in panels C and D. It is strange to have to jump around with the naming within a single figure.</p><p>3) Worse, the mapping is _different_ in odd trials and even trails because position 3 from panel C can either be mapped to D1 (panel A) or to B (panel A). Similarly, position B of panel A could be either position 1 or position 3 of Panels C and D. This makes no sense.</p></disp-quote><p>These confusions were caused because we mapped two branches of a two-dimensional maze onto a one-dimensional axis. As a consequence, the portions 0→1, 1→3 and 3→5 in the linearized plot refer to the portions A→B, B→D1 and B→D2, respectively, of the actual maze. Thus, the correspondence between the two labeling schemes is not one-to-one, which confused the reviewer. As illustrated in Figure 7C-E, we have improved the data presentation by using the color scheme introduced originally in a related experimental paper (Wu and Foster, 2014).</p><disp-quote content-type="editor-comment"><p>4) The authors make several statements about the reverse replay sequences that are hard to identify in the figure. They should individually highlight specific reverse sequences that they want to talk about.</p></disp-quote><p>We have identified the examples of replay events in all the panels (Figure 7D and 7E) we mention in the text. The following three comments raised by the reviewer have been also clarified in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>5) I do not see any case in the later trials where sequences travel to D2 except possibly in the first couple of spontaneous responses in trial 9 and one spontaneous trial in 10. Each of these occurs before the training run. Instead almost all the cases, e.g., in Trial 10, start from D2 and go to B. This is a perfectly reasonable reverse replay but is not presented as such in the text.</p></disp-quote><p>We apologize to the reviewer for our misleading presentation of replay events. In Figure 7, sequences traveling from A to D2 are the sequences propagating from neuron #1 to #20 (A→B) and successively from neuron #61 to #100 (B→D2) at the initial stages of trials 5 and 6. These sequences are indicated by black arrows. Note that the previous panels for trials 9 and 10 have been removed from the figure and novel panels have been included (Figure 7F-H) to show some quantitative evaluations of the relative frequencies among different firing sequences.</p><disp-quote content-type="editor-comment"><p>6) I do not see any case where backward sequences start from D1 and go to D2, unless the authors are conflating position 3 with D1, rather than B. If so then it is the 3 cases (2 in Trial 9 and 1 in Trial 10, which occur before the training run) which fit the bill. If so, those 3 cases look like forward sequences to me.</p></disp-quote><p>Examples of such sequences are sequences involving neuron #60 to #21 (D1 → B) and neuron #61 to neuron #100 (B → D2). This sequential firing pattern represents one compound sequence. The end point of such a sequence is indicated by a blue arrow in trial 5.</p><disp-quote content-type="editor-comment"><p>7) The text says that some of the reverse replay sequences from D1 propagate into D2 instead of the stem arm. I do not see any instances of this, except again if the authors have confused the identity of position 3.</p></disp-quote><p>Replay events from D2 to D1 is represented by slanted lines starting from neuron #100 and ending at neuron #61 (D2 to B) or by lines starting from neuron #21 and ending at neuron #60 (B to D1). This means that the sequence jumps from neuron #61 to # 21 in the linearized plots. The start point of such a sequence is indicated by a blue arrow in trial 6.</p><disp-quote content-type="editor-comment"><p>8) The supplementary video looks interesting but lacks annotation to give clarity. Its value is considerably diminished as a result. Nevertheless, my impression on watching it is that my interpretation of Figure 6 is correct, and that the authors have confused position B and position D1.</p></disp-quote><p>We have added explanations of each trial to the movie (e.g. the structure of the track, the trial number, the schedule of rat’s movement, reward ON/OFF, explanation of important activity patterns).</p><disp-quote content-type="editor-comment"><p>9) The key paragraph three in subsection “Goal-directed path learning through reverse replay<bold>”</bold> is very anecdotal. For every statement of a certain kind of replay, the authors need to first, point to examples, and second, give statistics for how often such replays occur in a series of randomized runs.</p></disp-quote><p>We have clearly pointed the examples of replay events in a 2-D, and then given the statistics of replay events in the simulations performed with different random seeds and different visiting orders of two arms in paragraph three of subsection “Goal-directed path learning through reverse replay”.</p><disp-quote content-type="editor-comment"><p>It may well be that I am quite misunderstanding this figure, in which case the authors should explain it more clearly. Otherwise I think the figure and movie do not support the text.</p></disp-quote><p>We should agree that the figures and movie were hard to interpret. We hope the improved manuscript resolves all the doubts raised by the reviewer.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>[…] The most critical assumption is not, in my opinion, the &quot;rapid modulation of STDP&quot; by synaptic depression, but rather the persistence of neural activity behind the immediate wave-front. Because of profound synaptic depletion, the fact is that there is no reverberant activity that would support the packet and cause neurons to continue to be active.</p><p>The trick appears to lie in a time constant of τ<sup>exc</sup> =10 ms with which the excitatory input is convolved (Equation 3) Or, in the spiking network, an NMDA time constant of 150 ms (Equation 16), wherein the peak conductance for NMDA is slaved to the AMPA conductance.</p><p>The value of 10 ms for the time constant is, at the very least, debatable. Going back to classic papers (Koch, Rapp, Segev, 1996) or Treves (1993), the real excitatory synaptic time constant (as opposed to the membrane time constant of 10-20 ms) is extraordinarily short and on the order of 2 ms. With that kind of time constant, though, I believe the entire mechanism might collapse.</p></disp-quote><p>We built the model on the basis of bump attractor network models (e.g. Samsonovich and Mcnaughton, 1997; Romani and Tsodyks, 2014). In such models, the generation of localized activity packets (bumps) mainly depends on the distribution of connection weights (e.g., strong localized excitation and weak global inhibition), but the time constant is not important. As for the structure of connection weights, some experiments (e.g., Takahashi et al., 2010; Guzman et al., 2016) suggested that the clusters of strong excitatory connections are overexpressed in CA3, which supports the assumption of strong localized excitation necessary for our model. To show our learning mechanism does not depend on the synaptic time constants, we performed additional simulations with removed NMDA current and shorten AMPA and inhibitory time constants (Figure 2—figure supplement 1).</p><disp-quote content-type="editor-comment"><p>The second critique I would levy is that the model inhabits an intermediate realm: it is neither minimalist, nor veridically detailed.</p><p>In particular:</p><p>i) Equation 5-6 cover both facilitation and depression. As far as I can tell, facilitation is not at all necessary for the mechanism. Why is facilitation then included?</p></disp-quote><p>As the reviewer pointed out, facilitation is not necessary for our proposed mechanism. However, we implemented it to evaluate the model’s performance under a realistic situation because strong facilitation is observed in the hippocampus (e.g. Guzman et al., 2016). We could show that our learning mechanism reliably works with a physiologically realistic range of short-term facilitation (Figure 4). We wish to note that in the simulations of the 2D network the facilitation contributes to the generation of theta sequences (Wang et al., 2014).</p><disp-quote content-type="editor-comment"><p>ii) Equation 12-13 describe the Izhikevich, 2003 model with the parameter set for the regular spiking cell (though the fact that it is the parameter set for RS is not explicitly mentioned). The only possible advantage of the Izhikevich model over an integrate-and-fire model might lie in the adaptation of the firing. But is this important in the model?</p></disp-quote><p>In our model, the choice of spiking neuron model is relatively arbitrary because the proposed mechanism does not crucially depend on the specific spiking patterns. Therefore, the use of Izhikevich model is not required. However, the adaptation of firing prevents the persistence of activity packets within the same neuron group, hence making their sequential propagation easier. We briefly mentioned this point in subsection “Potentiation of reverse synaptic transmissions by STDP” in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>iii) Going from 1D to 2D in subsection “Goal-directed path learning through reverse replay<bold>”</bold>, the idea of theta modulation and theta sequences is sprung upon the reader, but it never became clear to me whether Equation 36 (for the theta-modulated current input) is really necessary or not.</p></disp-quote><p>We apologize for the confusion. We have performed additional simulations to discuss the effect of theta sequences on the proposed mechanisms. Simulation results are shown in the subsection &quot;Bias effects induced by spike trains during run&quot;, and suggest that theta sequences have almost no effects on learning in our model (Figure 5). However, as suggested in Johnson and Redish, 2007 and Wikenheiser and Redish, 2015, theta sequences are useful for the readout of the learned paths towards the goal. Namely, once synaptic connections are biased towards the position of reward, theta sequences also tend to extend towards the reward, which gives information on the adequate paths to the animal. We have shown this role of theta sequences by simulations in a 2D open-field (Figure 10). We have included references to phase precession and theta sequence (e.g. O’Keefe and Recce, 1993; Dragoi and Buzsaki, 2006; Foster and Wilson, 2007).</p><disp-quote content-type="editor-comment"><p>The third critique reflects the color scheme. Throughout, inactivity is represented by black, which makes the figures hard to read in a print-out or even on the screen. Please choose another color scheme that results in a white (or light-colored) background. Figure 6 is confusing, as it mixes letters on the W-shaped track (which, for some reason, is called a T-shaped track), but then the panels use numeric labels; the mapping is only explained in the last sentence of the caption. On some panels of Supplementary Figure 2, the tick-labels on the y-axes cannot be read.</p></disp-quote><p>We apologize that some figures were not clear enough and Figure 6 (Figure 7 in the revised manuscript) was confusing. Following your suggestions, we have changed the color scheme and labels in the related panels, explained mapping in the linearized plots in a more comprehensive manner. We also corrected the labels in Figure 4—figure supplement 1 (previous Supplementary Figure 2).</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>The paper describes a modified version of spike-timing dependent long-term plasticity (STDP) modulated by short-term synaptic plasticity (STP). The main advantage of this modulation is to be able to obtain an effectively asymmetric STDP rule starting from a symmetric one (symmetric STDP has been recently observed in hippocampus). The authors show for instance how an imposed sequential activation of neurons can modify synapses in a network, so that a network can spontaneously &quot;replay&quot; the sequence in the opposite order, as observed in place cells.</p><p>I think that the results nicely characterize the properties of the hypothesized plasticity rule and show a potential application in neural networks.</p></disp-quote><p>We thank the reviewer for their positive comments on the STDP learning rule proposed in the manuscript.</p><disp-quote content-type="editor-comment"><p>I have two major concerns:</p><p>1) The connection with dynamics of hippocampal place cell activity strongly focuses on reverse replays, but there might be other aspects to consider more carefully:</p><p>i) Forward replays: The modeling presented in the first part of the paper, where a reverse replay is elicited by the stimulation of place cell coding for the middle of the track, should be probably compared to the results of Davidson et al., 2009. In that paper, the rodents frequently stop away from the two ends of the track; this more closely resembles the scenario depicted in the manuscript. The results of the paper indicated that forward replays were as (or more) likely to occur compared to backward replays (similar to Diba and Buzsaki, 2007), and the propagation speed of forward and backward replays was comparable. How can one reconcile the results reported in the manuscript with these observations?</p></disp-quote><p>As suggested by the reviewer, our model may explain the weak bias towards forward replays observed in the neural activity recorded in the early stage of learning (Davidson et al., 2009). Once the rat got a reward at the end of the track and reverse replay generated a bias towards the reward site, we expect, from the results of simulations of our model, to observe more forward replays in the middle of the track. Because reverse replay can be observed immediately after the first lap (Foster and Wilson 2006; Wu and Foster, 2014), the bias to the forward direction (i.e., towards the reward) can appear during the very early stage of learning. On the other hand, our evaluation of the bias effect with Poisson spike trains suggests that the bias to the reverse direction is stochastic (not 100% reliable). Therefore, we speculate that the consolidation of strong bias requires repeated experiences. However, we also note that the situation studied in Davidson et al., 2009 is more complex than our simulation setting because they used a very long track to observe long replay sequences across multiple ripples. We briefly mentioned these points in paragraph one of subsection “Testable predictions of the model” and paragraph two of subsection “Some limitations of the present model” in the revised manuscript. We wish to study this interesting problem in the future.</p><p>We also wish to leave the problem of propagation speed for our future study because the speed depends on many factors. Propagation speed is directly affected by weight biases in our simple model. However, in the hippocampus, many other factors such as oscillation and dendritic spikes (Jahnke et al., 2015) can affect the propagation speed. Furthermore, some experiment suggests that the propagation speed can be actively controlled without changing sensory inputs (Patalkova et al., 2008). We feel that taking all these factors into account is beyond the scope of this study.</p><disp-quote content-type="editor-comment"><p>ii) Directionality of firing in linear tracks: It is generally observed that place cells code conjunctively for spatial location and direction of motion in 1D. This aspect of place field firing has not been discussed and it's not entirely clear to me how to interpret the authors’ results in light of this experimental observation.</p></disp-quote><p>A straightforward interpretation of our results under unidirectionality is that a 1D track is represented by two subnetworks of unidirectional place cells encoding opposite movement directions at each location. In that case, learning an experienced path (e.g. A to D2 in Figure. 7) is possible in one of the subnetworks through the mechanism we have shown. However, to learn an unexperienced path by combination of multiple paths with different directionality (e.g. D1 to D2 in Figure 7), joint replay through the two subnetworks (B to D1 and B to D2) is necessary. Such replay is experimentally observed (Davidson et al., 2009; Wu and Foster, 2014). The previous studies proposed that Hebbian plasticity supports the generation of joint replay by connecting multiple unidirectional place cells at the junction (Brunel and Trullier, 1998; Káli and Dayan, 2000; Buzsaki, 2005). This issue is related to how the hippocampus connects together and generalizes multiple different episodes and chunks in information streams. We have briefly discussed this issue in paragraph two of subsection “Some limitations of the present model” in the revised manuscript. We will investigate this interesting problem in the future.</p><disp-quote content-type="editor-comment"><p>iii) Replays in 2D: Pfeiffer and Foster, 2013 reported replays that generally did not correlate with the previous experience of the animal, rather there was a correlation with the immediate future navigational behavior of the rodent. In those experiments, the goal location was moved from session to session, and those sequences were observed within the first few trials. In a follow-up commentary (Pfeiffer, 2017), it is argued that &quot;reverse replay does not facilitate learning in a familiar environment&quot;. It would be useful to see those results and claims more carefully discussed in the manuscript.</p></disp-quote><p>In our example of 2D neural network, the task was essentially 1D. Therefore, the previous simulations were not really adequate for discussing the implications of our model in navigating a 2D open field. In a 2D open-field, we observed in our model that firing sequences often propagate isotropically from a reward site irrespective of the previous experience. Such an isotropic activity propagation creates 2D connections that converge to the reward site, and hence biases the directions of both forward replays and theta sequences towards the reward site from any position on the field. We think that these properties of our model correspond to the experimental observation in open fields (Pfeiffer and Foster, 2013). In the revised manuscript, we have presented the simulation results of a 2D open-field in Figures 9 and 10 and have discussed the relationship to Pfeiffer and Foster, 2013 and Pfeiffer, 2018 in the subsection &quot;Unbiased sequence propagation enhances goal-directed behavior in a 2-D space&quot;. A brief discussion is also found in subsection “Some limitations of the present model” in the Discussion.</p><disp-quote content-type="editor-comment"><p>iv) Theta sequences: During running, fast sequential activity (forward direction) of place cells within individual cycles of the theta oscillation are observed. I guess that before replays, these sequences could help in building up the asymmetric connections that later generates reverse replays. But what happens to theta sequences after the synapses are modified? Would they be less likely to occur? In general, I found the few references to theta sequences in the manuscript to be confusing.</p></disp-quote><p>We have added references for theta sequences (e.g. O’Keefe and Recce 1993; Dragoi and Buzsaki, 2006; Foster and Wilson, 2007). We have performed simulation of place cell activity with phase precession in Figure 5, and the results suggest that the bias is not affected by the existence of phase precession (or theta sequences). The subsection &quot;Bias effect induced by spike trains during run&quot; is devoted to these points. However, we think that theta sequences assist the readout of the learned paths towards the goal (Johnson &amp; Redish 2007; Wikenheiser and Redish, 2015). This is because after synaptic connections are biased, theta sequences tend to spread towards the reward site and gives the animal useful information on the rewarding paths. We have shown this role of theta sequences by simulating navigation in a 2D open-field (Figure 10).</p><p><italic>2) The plasticity rule is loosely based on previous work in visual cortical synapses (Froemke et al., 2006). As such there is no evidence that this rule quantitatively captures the dynamics of synapses in neo-cortex or hippocampus. It would be helpful to test the plasticity rules with firing patterns more closely resembling the activity of</italic> in vivo <italic>place cells (e.g., fields of ~1s durations, peak firing ~10Hz, phase precessing) and realistic learning rates.</italic></p><p>In the revised manuscript, we have evaluated the weight biases generated by place-cell-like activity with phase precession. Our results suggest that biases towards reverse direction are reliably induced when peak firing rate during theta precession firing is greater than 20 Hz. This rate seems to be higher than the average peak firing rate over place cell population. However, summing up bias effects induced in multiple place cells with overlapping place fields resulted in significant bias in the realistic mean firing rate setting (Figure 5B). Furthermore, because the firing rates of place cells are log-normally distributed (Mizuseki and Buszaki, 2013), a small fraction of place cells with high firing rates (~30Hz) will contribute to the generation of weight biases. Our results also suggest that phase precession does not significantly affect the weight bias. This is because the time windows of STDP (70ms) are long enough to eliminate the small influences of different theta-phases in spiking such that only coarse-grained firing rates (place fields) determine the effect of synaptic plasticity (Figure 5—figure supplement 1). These points are discussed in the second paragraph of subsection “Bias effects induced by spike trains during run<bold>”</bold>.</p></body></sub-article></article>