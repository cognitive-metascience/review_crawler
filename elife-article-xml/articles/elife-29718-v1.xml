<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">29718</article-id><article-id pub-id-type="doi">10.7554/eLife.29718</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Neural computations underlying inverse reinforcement learning in the human brain</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-90476"><name><surname>Collette</surname><given-names>Sven</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-0234-1867</contrib-id><email>sven.collette@gmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/><xref ref-type="other" rid="dataset1"/></contrib><contrib contrib-type="author" id="author-91408"><name><surname>Pauli</surname><given-names>Wolfgang M</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/><xref ref-type="other" rid="dataset1"/></contrib><contrib contrib-type="author" id="author-91409"><name><surname>Bossaerts</surname><given-names>Peter</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/><xref ref-type="other" rid="dataset1"/></contrib><contrib contrib-type="author" id="author-33500"><name><surname>O'Doherty</surname><given-names>John</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/><xref ref-type="other" rid="dataset1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Division of Humanities and Social Sciences</institution><institution>California Institute of Technology</institution><addr-line><named-content content-type="city">Pasadena</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Computation and Neural Systems Program</institution><institution>California Institute of Technology</institution><addr-line><named-content content-type="city">Pasadena</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Florey Institute of Neuroscience and Mental Health</institution><institution>The University of Melbourne</institution><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff><aff id="aff4"><label>4</label><institution>California Institute of Technology</institution><addr-line><named-content content-type="city">Pasadena</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-29804"><name><surname>Badre</surname><given-names>David</given-names></name><role>Reviewing Editor</role><aff><institution>Brown University</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>30</day><month>10</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e29718</elocation-id><history><date date-type="received" iso-8601-date="2017-06-19"><day>19</day><month>06</month><year>2017</year></date><date date-type="accepted" iso-8601-date="2017-10-11"><day>11</day><month>10</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Collette et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Collette et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-29718-v1.pdf"/><related-object ext-link-type="url" xlink:href="https://elifesciences.org/articles/e29718v1"><date date-type="v1" iso-8601-date="2017-10-30"><day>30</day><month>10</month><year>2017</year></date></related-object><abstract><object-id pub-id-type="doi">10.7554/eLife.29718.001</object-id><p>In inverse reinforcement learning an observer infers the reward distribution available for actions in the environment solely through observing the actions implemented by another agent. To address whether this computational process is implemented in the human brain, participants underwent fMRI while learning about slot machines yielding hidden preferred and non-preferred food outcomes with varying probabilities, through observing the repeated slot choices of agents with similar and dissimilar food preferences. Using formal model comparison, we found that participants implemented inverse RL as opposed to a simple imitation strategy, in which the actions of the other agent are copied instead of inferring the underlying reward structure of the decision problem. Our computational fMRI analysis revealed that anterior dorsomedial prefrontal cortex encoded inferences about action-values within the value space of the agent as opposed to that of the observer, demonstrating that inverse RL is an abstract cognitive process divorceable from the values and concerns of the observer him/herself.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>reinforcement learning</kwd><kwd>reverse inference</kwd><kwd>fMRI</kwd><kwd>social neuroscience</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution>NIMH Caltech Conte Center for the Neurobiology of Social Decision Making</institution></institution-wrap></funding-source><award-id>P50MH094258</award-id><principal-award-recipient><name><surname>O'Doherty</surname><given-names>John</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The human brain is capable of implementing inverse reinforcement learning, where an observer infers the hidden reward structure of a decision problem solely through observing another individual take actions.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>When learning through observing others’ actions, two major strategies have been proposed: in imitation learning, an individual simply learns about the actions of an observed agent, in essence by learning to copy the agent’s behavior. An alternative strategy called inverse reinforcement-learning (inverse RL) is to use the agent’s actions to infer the hidden or unobservable properties of the environment, such as the reward outcomes available for pursuing particular actions. Then the observer can use that knowledge to compute his/her own subjective expected value for taking distinct actions in the same environment. While in imitation learning, the observer learns nothing about the structure of the environment other than the action tendencies of the agents they observe, in inverse RL the observer has acquired knowledge of the world which becomes ultimately abstracted from the actions of the agent they observe. Although imitation learning can work well under a number of situations, particularly where the agent can be assumed to have similar preferences to the observer, inverse RL offers greater flexibility to learn from diverse agents, even under the situation where the agent has very distinct preferences or goals to that observer.</p><p>The computational framework of inverse RL was originally developed by researchers in the artificial intelligence community (<xref ref-type="bibr" rid="bib25">Ng and Russell, 2000</xref>; <xref ref-type="bibr" rid="bib1">Abbeel and Ng, 2004</xref>). Unlike in forward problems of reinforcement learning (RL) (<xref ref-type="bibr" rid="bib34">Sutton and Barto, 1998</xref>), the link between action and reward is lost and the goal becomes to infer, from the agent’s behavior and knowledge of the agent’s preferences, relevant information about the reward function which can then be used in turn to maximize one’s own reward.</p><p>In the realm of cognitive sciences, the application of computational modeling tools have surged as a means of gaining insight into social behavior. Observational learning has recently been formalized as an inverse problem, where observed behavior is used to infer the hidden structure at the root of that behavior under the assumption that observed choices are goal-directed (<xref ref-type="bibr" rid="bib3">Baker et al., 2009</xref>, <xref ref-type="bibr" rid="bib4">Baker et al., 2011</xref>; <xref ref-type="bibr" rid="bib16">Goodman et al., 2009</xref>; <xref ref-type="bibr" rid="bib33">Shafto et al., 2012</xref>). Recent computational modeling work has focused on how humans create an understanding of other’s preferences and the similarity to one’s own past choices, to guide future behavior (<xref ref-type="bibr" rid="bib15">Gershman et al., 2017</xref>). Computing abstract social inferences has been characterized as emerging already in early infancy (<xref ref-type="bibr" rid="bib22">Lucas et al., 2009</xref>; <xref ref-type="bibr" rid="bib18">Jara-Ettinger et al., 2016</xref>). There is empirical evidence that subjective preferences emerge in toddlers as early as 16 to 18 months (<xref ref-type="bibr" rid="bib29">Repacholi and Gopnik, 1997</xref>; <xref ref-type="bibr" rid="bib23">Ma and Xu, 2011</xref>), and by the age of three children use inferences about social preferences to guide their own decisions (<xref ref-type="bibr" rid="bib13">Fawcett and Markson, 2010</xref>).</p><p>Within the nascent sub-field of social computational neuroscience, a number of studies have utilized computational fMRI in order to gain insight into the neural mechanisms underlying observational learning. When learning through observation from an agent’s actions and outcomes, evidence for a process called vicarious reinforcement learning (RL) has been found whereby reward prediction errors generated by observing the rewards obtained by another as opposed to being received by oneself have been reported in the striatum (<xref ref-type="bibr" rid="bib8">Burke et al., 2010</xref>; <xref ref-type="bibr" rid="bib9">Cooper et al., 2012</xref>). However, vicarious RL can only ever work under situations where the rewards being obtained by another agent can be directly observed. The problem focused on here is the situation in which the actions of the other agent can be observed, but the reward outcomes cannot.</p><p>Other studies have found evidence for the engagement of several brain structures when making inferences about the hidden intentions and traits of another agent. In particular, regions of the brain often referred to as the mentalizing network which includes the dorsomedial prefrontal cortex (dmPFC) have been implicated in this type of inference (<xref ref-type="bibr" rid="bib14">Frith and Frith, 2006</xref>; <xref ref-type="bibr" rid="bib17">Hampton et al., 2008</xref>; <xref ref-type="bibr" rid="bib26">Nicolle et al., 2012</xref>), whereas posterior superior temporal sulcus (pSTS) and adjacent temporoparietal junction (TPJ) has been found to reflect learning signals about relevant attributes of other individuals’ behavior (<xref ref-type="bibr" rid="bib17">Hampton et al., 2008</xref>; <xref ref-type="bibr" rid="bib6">Behrens et al., 2009</xref>; <xref ref-type="bibr" rid="bib7">Boorman et al., 2013</xref>; <xref ref-type="bibr" rid="bib11">Dunne and O'Doherty, 2013</xref>). Yet, these studies have not addressed the capacity to make inferences about the structure of the environment through observing an agent beyond mentalizing about the intentions/traits of that agent him/herself. This capacity is the essence of inverse RL that we investigate in the present study.</p><p>To address this issue, we implemented a novel functional magnetic resonance imaging (fMRI) experiment involving participants (always the observers) and social agents (the agents). After having learned about food preferences of two observable agents, one with similar and another one with dissimilar preferences to themselves, the participants observed these same agents perform on a slot machine task, in which the agents learned to obtain their preferred food outcomes. Importantly, participants never got to see the food outcomes themselves. In order to assess what participants had learned from observing the choices of the other agents, we asked participants to play the same slot machine task.</p><p>We hypothesized that regions of the brain traditionally implicated in mentalizing such as the TPJ/pSTS and dmPFC would be involved in implementing inverse RL, and in subsequently utilizing knowledge about the outcome distributions acquired through inverse RL to guide behavior. More specifically, building on previous findings of a key role for TPJ/pSTS in encoding of updating signals or prediction errors during social learning (<xref ref-type="bibr" rid="bib17">Hampton et al., 2008</xref>; <xref ref-type="bibr" rid="bib7">Boorman et al., 2013</xref>), we hypothesized that those same regions would play a role specifically in the acquisition and updating of information using inverse reinforcement learning through observing the behavior of others, while dmPFC was hypothesized to play a role in using the acquired knowledge to ultimately guide behavior.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Observational slot machine learning paradigm</title><p>43 human participants underwent fMRI while performing an observational learning (OL) task (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), in which on each of two sessions they observed an agent make repeated binary choices between pairs of slot machines, sampled by the computer from a pool of three slot machines. Participants were instructed that each of the slot machines would on each trial deliver one of three different food items as a prize. These food items were selected to differ in their subjective value to the participant (one was a preferred food item, another middle ranked, and another least preferred, drawn from an initial list of 10 food items that were earlier ranked for preference). These items were delivered with differing (but fixed across session) probabilities. The distributions varied across the machines, but participants were instructed that the underlying distribution of these food items was hidden from both the participants and the agents (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). The critical feature of this paradigm is that participants never got to see any outcomes of the slot machines while participants understood that the agents did receive the outcomes. Occasionally (1/3 of trials), the participants themselves were presented with the same slot machines as those played by the agents, and they had to make a choice. The participants were instructed that one of their choice trials would be selected at random at the end of the experiment, that one of the food outcomes would be delivered to the participant according to the probabilities assigned to that chosen slot machine and that they would be asked to consume outcomes. Thus, participants were motivated to ensure that they chose the slot machine with the highest probability of yielding a food outcome that they preferred as opposed to one that they liked the least. Crucially, in a previous preference learning phase (see Materials and methods for details), participants got to learn about the food preferences of the two agents they subsequently got to observe playing on the slot machines. One agent had similar food preferences to the participant while the other agent had dissimilar food preferences. Prior to the onset of the observational learning task, to confirm the efficacy of our preference learning procedure we tested participants’ knowledge of the other agent’s preferences. Each participant correctly identified the preference rankings for each agent over the foods, as well as correctly classifying the agents as similar or dissimilar to themselves (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.29718.002</object-id><label>Figure 1.</label><caption><title>Observational slot machine task with hidden outcomes.</title><p>(<bold>A</bold>) Trial timeline. The first screen signals whether the agent or the participant has to make a choice. Subsequently two slot machines are presented, along with on agent trials a (pseudo) video feed of the agent making a selection, and the choice of the slot machine is revealed after a jittered interval. (<bold>B</bold>) The probabilistic food distribution behind the slot machines: each of the three slot machines is labeled by a unique fractal and yields the same three food items, but at differing stationary probabilities, as indicated in the table. (<bold>C</bold>) Agent and participant choice ratio. Choice ratio is defined as choice frequency of a slot machine given its total number of presentations. Agent performance (grey bars) are collapsed across conditions, and depicted in agent-referential space. Participant performance (cyan for similar, pink for dissimilar) is depicted in self-referential space. Regardless of whether they are observing a similar or dissimilar agent, participants are equally good at choosing their best slot machine, nearly matching the agent’s performance.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-29718-fig1-v1"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.29718.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Additional task information.</title><p>(<bold>A</bold>) Pre-MRI phase and agent preferences construction: Participants first made pairwise food comparisons before entering the MRI sessions. From their actual food rating, we then constructed one similar and one dissimilar agent (<bold>B</bold>) Learning curve of agent (across both conditions, grey) and participant (separately for similar and dissimilar). Dotted line depicts plateau of agent behavior (<bold>C</bold>) Debrief: All participants classified agents correctly as similar, resp. dissimilar.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-29718-fig1-figsupp1-v1"/></fig></fig-group></sec><sec id="s2-2"><title>Behavioral results</title><p>Spearman’s rank correlation coefficients between participants’ choices in self-referential space and agent choices in agent-space, revealed that participants’ choice ratios were generally in line with the agents’: rs_sim = 0.7 (similar condition), rs_dis = 0.6 (dissimilar condition; see Materials and methods for details). These correlations also provide evidence that participants succeeded in learning to choose the slot machine with the highest likelihood of a preferred outcome.</p><p>Yet, learning from a dissimilar agent should be more challenging than learning from a similar agent since in the former case the participant should take into account the fact that the agent has different preferences to themselves and use this information to guide their choices, whereas in the similar condition the agent can either adopt a policy of simply imitating the agent or can easily infer that agent’s preferences as they are similar to themselves. We therefore expected that participants would perform worse in the dissimilar condition compared to the similar condition. Indeed, participants performed significantly worse overall in the dissimilar condition compared to the similar (after Fisher transform: one-tailed p=0.04). We further compared the choice ratio of the slot machines across conditions on trials after the learning of the agent has reached a plateau (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). If participants used a simple imitative behavioral (and/or inverting) strategy, we should observe symmetrical performance changes for the best and worst machine in the dissimilar compared to the similar condition, whereas the mid machine should stay unchanged. In other words there should be an accuracy trade-off, that is, decreased choice frequency for the best machine while at the same time an increase of choices of the worst machine. Here we found that although participants performed equally well in choosing their 'best’ slot machine in both similar and dissimilar conditions (t-test between similar and dissimilar choice ratios: P&gt;0.6), the worst slot machine was picked more often in the dissimilar condition than in the similar (P&lt;0.05) and the mid-ranking machine was chosen significantly less often in the dissimilar condition compared to the similar (P&lt;0.05, <xref ref-type="fig" rid="fig1">Figure 1C</xref>). This non-symmetrical choice difference between observer and agent, that is, equal performance for the best, but not simply reversed for the mid and worst machines, alludes to a more sophisticated strategy than simple imitation behavior.</p></sec><sec id="s2-3"><title>Computational modeling of OL</title><p>To elucidate the computational mechanisms involved in solving the task we implemented an inverse RL algorithm in which participants infer the distribution of outcomes over the slot machines chosen by the agents, given knowledge about the agent’s utility function (the learned preferences) and the observed actions (Materials and methods).</p><p>An alternative strategy is to deploy imitation RL, wherein the participant learns to predict the actions taken by the other agent, based solely on the history of actions taken by that agent. These predictions (which are formulated as value signals) are applied to the participants’ own choices without any need to make an inference about the outcome distribution over the slot machines. In essence this algorithm would implement a pure imitation strategy: simply copying the actions of the opponent. Pure imitation would succeed in the similar case but fail abjectly in the dissimilar case, as the observer would end up choosing slot machines leading to least as opposed to most preferred outcomes. To give this imitation strategy a fighting chance to cope with learning from the dissimilar other, we modified the algorithm so that it also encoded as a free parameter a representation of how similar the agent’s preferences were to oneself (which we could assume was learned before the observational learning task). This similarity metric is used to invert the observer’s value function when choosing from learning the actions of the dissimilar agent. This adapted form of imitation RL can in principle successfully learn from both similar and dissimilar agents, and hence we refer to this adapted model when referring to imitation RL in analyses and figures. We also constructed a different imitation RL model with a counterfactual learning component (cf-imitation RL) that also learned about the value of action not taken on a given trial, while incorporating separate learning rates for those two updating strategies (Methods and Materials for more details).</p><p>Yet another viable strategy for solving this task is for the observer to assume that the agents have distributions over the preference rankings for the different slot machines without considering the outcome distributions per se. A preference-learning algorithm can then simply update the observers’ beliefs about the agent’s machine preferences based on the observed behavior of the agents, and then explores the slot machines using a softmax procedure (Materials and methods for model details, and comparisons in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>.</p><p>We tested which algorithm provides the best account of participants’ behavior by using a Bayesian Model Selection (BMS) process (Materials and methods). Out of all tested models, inverse RL was found to outperform Imitation RL overall (<xref ref-type="fig" rid="fig2">Figure 2A</xref>) and in almost all individual subjects (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). The model similarly also outperformed the other candidate algorithms (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). The choices estimated by the inverse RL model match participants’ behavior very well when plotting model predictions against participants’ actual (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.29718.004</object-id><label>Figure 2.</label><caption><title>Model comparison.</title><p>(<bold>A</bold>) Bar plots illustrating the results of the Bayesian Model Selection (BMS) for the two main model frameworks. The inverse RL algorithm performs best, across both conditions (similar and dissimilar). On the left, the plot depicts the BMS between the two models in the similar condition; on the right the plot shows the BMS in the dissimilar condition (BMS analysis of auxiliary models are shown in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>). (<bold>B</bold>) Scatter plots depicting direct model comparisons for all participants. The lower the Bayesian Information Criterion (BIC), the better the model performs, hence if a participant’s point lies over the diagonal, the inverse RL explains the behavior better. The figure on the left illustrates the similar condition; the plot on the right depicts the dissimilar condition. (<bold>C</bold>) Confusion matrix of the two models to evaluate the performance of the BMS, in the dissimilar condition. Each square depicts the frequency with which each behavioral model wins based on data generated under each model and inverted by itself and all other models. The matrix illustrates that the two models are not 'confused’, hence they capture different specific strategies. Confusion matrices of the similar condition and for auxiliary models are shown in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>) (<bold>D</bold>) Scatter plots depict the participant choice ratio of the mid slot machine plotted against the predictions of the inverse and imitation RL models.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-29718-fig2-v1"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.29718.005</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Additional model information.</title><p>(<bold>A</bold>) Bayesian Model Selection with additional models: the imitation RL with counterfactuals as described in the main text, and the PRO model (probabilistic rank order): In the PRO model, the observer assumes that the agents have distributions over the preference rankings for the different slot machines without considering the outcome distributions per se. Each rank-order has a certain likelihood of being the actual agent’s preferences over the n slot machines to be ranked. At feedback, the beliefs over the rank orders are updated in a Bayesian fashion, according to the likelihood of each rank order to be correct given the observed choice of the agent. Subsequently the participant’s choice is expressed as a soft-max function between the expected rank value of the chosen and the unchosen slot machine, with a free parameter <inline-formula><mml:math id="inf1"><mml:mi>β</mml:mi></mml:math></inline-formula> characterizing the choice stochasticity. We find again that the inverse RL gives a better explanation of participant behavior, especially in the dissimilar condition. (<bold>B</bold>) mean choice ratio for participants (black) and choice probability for fitted models, separately for similar and dissimilar conditions (<bold>C</bold>) Confusion matrix of these four models to evaluate the performance of the BMS. Each square depicts the frequency with which each behavioral model wins based on data generated under each model and inverted by itself and all other models. The matrix illustrates that the four models are not 'confused’, especially in the dissimilar condition, hence they capture different specific strategies.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-29718-fig2-figsupp1-v1"/></fig></fig-group><p>To demonstrate that our two main competing models specify unique behavioral strategies as opposed to making similar predictions about behavior, we constructed confusion matrices, where each cell depicts the frequency with which each model wins based on behavior generated under each model, and inverted by itself and all other models. If there is a high probability that a model is confused with another, we should observe high exceedance probabilities in the off-diagonal cells. However this comparison framework shows that our main models are indeed not confused, and hence make different predictions (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p><p>Building on these initial model comparison results, we next aimed to elucidate the qualitative difference in the performance of the models. When comparing model choice predictions and participant choice ratios. While both imitation RL and inverse RL do quite reasonably in predicting choices for the most and least preferred slot machine, we found that the behavior that discriminates the model predictions the most is with regard to participants’ behavior to the middle preferred slot machine when learning from the dissimilar other. There was considerable variation across individuals in the selection of the middle preferred slot machine: this variation was much more effectively captured by inverse RL compared to imitation RL (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). A more detailed explanation for why inverse RL would be expected to perform better than imitation RL in capturing participants’ choice behavior especially for the middle preferred slot is given in Materials and Methods.</p></sec><sec id="s2-4"><title>Neural representation of outcome prediction in agent-referential preference space</title><p>To determine whether participants’ neural signals tracked value for the observed actions in self-referential or agent-referential preference space, we constructed two regressors with trial-by-trial value predictions for the actions taken by the similar and dissimilar other. To obtain an estimate of the value from the perspective of the agent, the agent’s preferences over the outcomes were multiplied by the outcome probabilities estimated by inverse RL (cf. Materials and methods). We tested for regions correlating with these value signals across the whole brain. If value signals are represented in the observer’s brain in the preference space of the other agents, then we would expect significant positive correlations with the observee’s value signal for both the similar and dissimilar agents. On the other hand, if the value signals are represented with respect to the observer’s own (self-referential) preferences and not those of the agent (agent-referential), then we would expect to find a significant positive correlation with the value regressor in the similar condition and a significant negative correlation with the value regressor in the dissimilar condition, because the dissimilar agent’s preferences are opposite to those of the observer.</p><p>We found no evidence of a region exhibiting correlations for value signals in self-referential space anywhere in the brain. Instead, we found a significant cluster in the dmPFC (<xref ref-type="fig" rid="fig3">Figure 3A</xref>; peak x = 0, y = 40, z = 40, whole brain cluster corrected threshold of FWE at p&lt;0.05 with a height threshold of p&lt;0.001) correlating positively with the agent’s value signals in the similar condition, as well as positively with the agent’s value signals in the dissimilar condition (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, parameter estimates extracted via a leave-one-out approach to avoid a non-independence bias [<xref ref-type="bibr" rid="bib12">Esterman et al., 2010</xref>]). Further, no statistical difference was found between conditions (t-test p&gt;0.5). These results indicate that expected value signals for outcomes are represented in agent-referential preference space.</p><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.29718.006</object-id><label>Figure 3.</label><caption><title>Outcome prediction signals in agent-referential preference space.</title><p>(<bold>A</bold>) Neural response to parametric changes in inverse RL outcome prediction in agent-referential space. Activity in dmPFC at the time of presumptive agent decision significantly correlated with outcome prediction inferred from the inverse RL model, independent of condition. All depicted clusters survive whole brain cluster correction FWE at p&lt;0.05, with a height threshold of p&lt;0.001. Z-score map threshold as indicated, for illustrative purposes. (<bold>B</bold>) Effect sizes of the outcome prediction correlation in dmPFC cluster separately for each condition (similar = blue, dissimilar = green, parameter estimates are extracted with a leave-one-out procedure, mean ±SEM across participants, p&lt;0.05 for both conditions). (<bold>C</bold>) Group-level exceedance probability map of the Bayesian Model Selection, comparing predictions from the imitation RL against inverse RL voxelwise in an anatomically defined dmPFC region. The depicted map was thresholded to show voxels where the exceedance probability for the inverse RL model is greater than p=0.95, revealing that the anterior part of dmPFC is much more likely to encode inverse RL computations.</p><p><supplementary-material id="fig3sdata1"><object-id pub-id-type="doi">10.7554/eLife.29718.007</object-id><label>Figure 3—source data 1.</label><caption><title>areas exhibiting significant changes in BOLD associated with predicted outcome in similar and dissimilar.</title><p>OFC: orbitofrontal cortex, dmPFC: dorsomedial prefrontal cortex. x y z in MNI coordinates.</p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-29718-fig3-data1-v1.docx"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-29718-fig3-v1"/></fig><p>Next, we aimed to test if inverse RL best explained the correlation within dmPFC, or if the imitation RL model also captured this activity. We therefore performed a Bayesian Model Selection (BMS) analysis to compare the model correlations within an anatomically defined dmPFC region where we would expect inverse RL related computations to be implemented (<xref ref-type="bibr" rid="bib11">Dunne and O'Doherty, 2013</xref>; <xref ref-type="bibr" rid="bib2">Apps et al., 2016</xref>). Our results show that the anterior part of the dorsomedial cluster is much more likely to be engaged in computing expectations derived from the inverse RL model, compared to the imitation RL (<xref ref-type="fig" rid="fig3">Figure 3C</xref>, exceedance probability threshold of p&gt;0.95 for inverse RL).</p></sec><sec id="s2-5"><title>Inverse RL signals</title><p>We next tested for brain areas involved in updating beliefs in the inverse RL model at the time of feedback. We computed the KL divergence between posterior and prior outcome distributions for the chosen slot machine at the time of action observation and regressed the divergence signal against the BOLD response. We found significant correlations with the entropy reduction signal in both similar and dissimilar conditions, in TPJ/pSTS (whole brain cluster corrected threshold of FWE at p&lt;0.05 with a height threshold of p&lt;0.001). In addition we found significant correlations with this learning signal in several other brain regions including the pre-SMA and dorsal striatum (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Furthermore no significant difference in the representation of updating signals was found between the similar and dissimilar conditions. Here, we compared the conditional beta values extracted using a leave-one-out method as before. The findings suggest that learning from similar and dissimilar others involves overlapping computational mechanisms involving the same brain regions.</p><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.29718.008</object-id><label>Figure 4.</label><caption><title>Learning signals during action feedback.</title><p>(<bold>A</bold>) Z-statistic map of the inverse RL entropy signals during agent choice revelation is presented, relating to the update of the food distributions within the chosen slot machine. From left to right slices depict pre-SMA, striatum and TPJ/pSTS. All depicted clusters survive whole brain cluster correction FWE at p&lt;0.05, with a height threshold of p&lt;0.001. Maps are thresholded at Z-statistic values as indicated, for display purposes. (<bold>B</bold>) Effect sizes of the entropy correlations for all clusters, separately for each condition (similar = blue, dissimilar = green, L1O procedure, mean ±SEM across participants, all p &lt; 0.05 for both conditions).</p><p><supplementary-material id="fig4sdata1"><object-id pub-id-type="doi">10.7554/eLife.29718.009</object-id><label>Figure 4—source data 1.</label><caption><title>areas exhibiting significant changes in BOLD associated with entropy signals.</title><p>Pre-SMA: pre-supplementary motor area. TPJ: temporo-parietal junction. dlPFC: dorsolateral prefrontal cortex. x y z in MNI coordinates.</p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-29718-fig4-data1-v1.docx"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-29718-fig4-v1"/></fig><p>We also looked at the neural correlations with the prediction error signal from the imitation RL model in a separate GLM. However no cluster survived the predefined threshold (whole brain cluster corrected threshold of FWE at p&lt;0.05 with a height threshold of p&lt;0.001).</p></sec><sec id="s2-6"><title>Value correlations in dmPFC predict behavioral performance</title><p>To test whether BOLD responses in the brain while learning from the dissimilar agent is ultimately predictive of performance on the slot machine task, we extracted activity from the dmPFC region found to encode expected value in the agent space. We computed a behavioral index that measured the degree of success in integrating preference information about the dissimilar agent in order to guide personal choices, namely, the degree to which the participant matched the performance of the agent. We found a significant correlation between this social information integration index (SI index, Materials and methods) and the extent to which dmPFC represented learned values for the dissimilar other (<xref ref-type="fig" rid="fig5">Figure 5A</xref>, p&lt;0.01, R = 0.39). For comparison, we performed the same correlation against activity in the TPJ/pSTS, and we found no such significant correlation (<xref ref-type="fig" rid="fig5">Figure 5B</xref>).</p><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.29718.010</object-id><label>Figure 5.</label><caption><title>dmPFC signal predicts performance in slot machine game.</title><p>(<bold>A</bold>) Scatter plot showing beta estimates of outcome prediction signals in the dmPFC ROI across participants, plotted against the social information integration index (SI index), which characterizes each participant’s performance in the slot machine game. The higher the score, the better the participants are at inferring the best option for themselves from observing the other. (<bold>B</bold>) Scatter plot of entropy update signals in the TPJ/pSTS ROI across participants plotted against the social information integration index.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-29718-fig5-v1"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Here, we implemented a novel fMRI experiment to shed light on how, at the computational and neural level, humans deploy knowledge about the preferences of other agents when learning about the environment through observing the actions of those agents. We designed our experiment in order to discriminate between two distinct strategies for implementing learning through observation. The simplest strategy is to learn about which action to take by imitating, or avoiding, the actions of the other agent. A more sophisticated strategy is to make an inference about the distribution of reward features available on the actions being pursued by the other agent and use this knowledge to guide one’s own choices. We dissociated between these two strategies by exposing observers to three slot machines with hidden outcomes and two different agents, one who had similar preferences over available foods as the observer, and another one whose food preferences differed. While imitation could work effectively when learning from an agent with similar preferences, we hypothesized that such a strategy would not be effective enough when learning from observing the actions of an agent with dissimilar preferences.</p><p>Using this experimental design, we were able to show that participants used the more sophisticated strategy of inferring, from the agent’s actions, the hidden distribution of food outcomes for each choice. This inverse RL algorithm provided a better account of the observer’s behavior even if we altered the competing model, the imitation RL model, to accommodate diverging preferences between observer and agent. The inverse RL model continued to outperform the imitative learning model even if we added the capacity to learn from counterfactual actions. Finally, inverse RL also outperformed a slightly more sophisticated algorithm than imitation, in which the observer was assumed to learn the agent’s ranking of the three available slot machines, without explicitly learning about the distribution of outcomes available on those actions. Taken together, these findings suggest that the human brain implements a mechanism akin to inverse reinforcement learning, and that the knowledge acquired through this mechanism is used to guide behavior.</p><p>Utilizing computational fMRI, we illuminated the brain systems involved in inverse RL. Two brain networks appear to be implicated: the mentalizing network, including TPJ/pSTS and dmPFC, as well as a network of brain regions implicated in goal-directed learning, including the anterior dorsal striatum and pre-SMA (<xref ref-type="bibr" rid="bib19">Kolling et al., 2012</xref>; <xref ref-type="bibr" rid="bib7">Boorman et al., 2013</xref>). The signals encoded in these areas associated with inverse RL go beyond prior reports about the involvement of regions of the mentalizing network and reward-learning network in observational learning. In previous studies implicating regions of the mentalizing network in social learning, the computational signals identified were about learning about the beliefs, traits and intentions of others, such as for example predictions about the other agent’s beliefs in a competitive interaction (<xref ref-type="bibr" rid="bib17">Hampton et al., 2008</xref>). Here, we focus on a quite distinct type of computation, the capacity to infer the distribution of rewards available on actions in the environment through observing the behavior of other agents. Furthermore, while previous studies such as Cooper et al. (<xref ref-type="bibr" rid="bib9">Cooper et al., 2012</xref>) have found evidence for a role of the dorsal striatum in encoding reward prediction errors during observational learning, those signals were invoked when observing the rewards experienced by another agent i.e. vicarious reinforcement. Crucially in the present situation, the outcomes experienced are hidden away from the observer and must be inferred. Thus, the computations being revealed in the present are very distinct from those that have been reported previously in the literature.</p><p>Within the mentalizing network, the dmPFC was found to be involved in encoding the expected value of the actions chosen by the other agent, at the time that the agent’s choice was being observed. The expected value of the action is computed using the observer’s estimates of the distribution of outcomes over the chosen action. Importantly, there are two different ways in which the observer might represent expected values for the observed actions. One possibility would be to represent the value of actions in their own, observer-centric space, that is based on the value of subjective preferences the observer him/herself has for the food outcomes. Alternatively, the observer could represent the value of the food outcomes using acquired knowledge of the agent’s preferences. Because observers were given the opportunity to learn from observing the actions of agents with similar and with dissimilar preferences, we were able to dissociate these alternatives. We found that the observer was representing the value of the observed actions in the agent’s value space as opposed to their own. In other words, the observer was simulating ‘what it would be like’ to be the agent. This signal was represented in the dmPFC regardless of whether the agent was similar or dissimilar. These findings illustrate that the dmPFC can flexibly acquire knowledge about the outcome distributions through knowledge of the agent’s preferences. The ability to do inference in agent-referential preference space, in contrast to self-referential, shows that participants approach social inference learning abstractly rather than concretely; in other words, the environment valuation variables are represented in the acting observee’s perspective, in contrast to a simpler self-centered representation which would be directly relevant to their own choice situation.</p><p>Activity in an overlapping region of TPJ/pSTS was found to reflect the degree to which the observer updated his/her knowledge of the distribution of food outcomes on the different slot machines. Our findings build on previous studies using computational models to implicate TPJ/pSTS in updating predictions about other people’s behavior, such as in the encoding of prediction errors about the influence one’s action will have on the opponent’s next game move (<xref ref-type="bibr" rid="bib17">Hampton et al., 2008</xref>), prediction errors about others’ intentions (<xref ref-type="bibr" rid="bib35">Suzuki et al., 2012</xref>) or prediction errors about an agent’s expertise (<xref ref-type="bibr" rid="bib7">Boorman et al., 2013</xref>). The finding that this region is involved to a similar degree in updating the observer’s knowledge for both similar and dissimilar social agents, and that it is not predictive of the observer’s performance possibly suggests a more general role for this area in learning about hidden states in a social situation.</p><p>Beyond the mentalizing network, several other brain regions were found to be involved in learning about the outcome distributions, including the dorsal striatum, lateral prefrontal cortex and pre-SMA. Although we report signals referring to a reduction of entropy in these regions, it is important to note that, in our model, these variables are also related to value updates in accordance with previous findings, since the agent is concerned about the update of posterior mean values of the slot machines. Dorsal striatum has previously been implicated in learning about the value of actions, both in experiential learning tasks as well as in observational learning (<xref ref-type="bibr" rid="bib27">O'Doherty et al., 2004</xref>; <xref ref-type="bibr" rid="bib31">Schönberg et al., 2007</xref>; <xref ref-type="bibr" rid="bib9">Cooper et al., 2012</xref>). Dorsolateral prefrontal cortex has previously been implicated in encoding representations of goal outcomes during decision-making (<xref ref-type="bibr" rid="bib24">McNamee et al., 2015</xref>), as well as update signals of outcome estimates (<xref ref-type="bibr" rid="bib5">Barraclough et al., 2004</xref>), implicating this structure in goal-directed decision-making during experiential learning. Therefore, the fact that this region is involved in updating knowledge of outcome distributions that are inferred through observing others, is broadly consistent with a role for this region in representing and performing inference over outcomes whether those outcomes are being learned through direct experience or through observation. Finally, pre-SMA is a region that has previously been implicated in action-based decision making and in encoding the values of actions at the time of decision-making during experiential learning (<xref ref-type="bibr" rid="bib32">Seo and Lee, 2007</xref>; <xref ref-type="bibr" rid="bib37">Wunderlich et al., 2011</xref>; <xref ref-type="bibr" rid="bib36">Wunderlich et al., 2009</xref>; <xref ref-type="bibr" rid="bib19">Kolling et al., 2012</xref>; <xref ref-type="bibr" rid="bib20">Kolling et al., 2014</xref>). Consequently, it appears that the capacity to acquire knowledge about outcome distributions through inverse RL depends on areas that may be specifically involved in social inference, as well as regions involved in action-based decision-making and experiential learning more generally.</p><p>We further found that the degree to which BOLD activity in the observer’s dmPFC correlated with the values of the agent predicted the observer’s success guiding their own behavior. We computed a numerical score (SI index, see Materials and methods for details) that captured the degree to which an individual observer was able to successfully incorporate knowledge of the dissimilar agent, and it exhibited a significant relationship with activation in dmPFC. These findings suggest that the more successfully an observer can represent the other agent’s action-values in dmPFC, the better the observer can utilize these representations to guide their own behavior. These findings suggest a direct relationship between dmPFC activity and the capacity to integrate knowledge of other agents’ preferences into the value computation, to effectively learn hidden outcome distributions.</p><p>At the time that the observer him/herself had to choose between the slot machines, we found evidence for involvement of a cluster in the medial prefrontal cortex (mPFC) positioned more rostrally to the region of dmPFC found to represent the agent’s preferences. This rostromedial PFC sub-region exhibited signals correlating with the participant’s value of the chosen option, specifically in the dissimilar condition. In contrast, at a more liberal statistical threshold we found chosen value signals in the ventral striatum only when observing the similar agent. These findings indicate that the observer is not only capable of representing expected values according to the subjective preferences of the observed agent, but that when the observer is required to make his/her own choices, the observer can use the same knowledge to compute expected values in own preference space, using a network of brain areas involved in social comparisons.</p><p>In conclusion, here we showed that the human brain is capable of performing a variation of inverse reinforcement learning, whereby one learns through observation of actions of other agents with potentially diverging preferences. By inferring the distribution of outcomes over available actions from the choices of the agent, participants successfully guided their own choices on the same task. We found evidence that a network of regions in the brain, especially areas traditionally implicated in mentalizing and theory of mind, such as the TPJ, pSTS and anterior dmPFC, appear to play a direct role in inverse RL. Importantly, neural signals in dmPFC implied that participants learned by representing action values in agent preference space, not their own, suggesting that their inference was abstract (i.e., disconnected from their own involvement) rather than concrete (i.e., directly relevant to their own choice situation). The findings are consistent with distinct contributions of the mentalizing network in different components of inverse RL. Posterior cortical areas such as the TPJ and adjacent pSTS were found to be especially involved in updating and learning about agent preferences and expectations irrespective of the specifics of the task participants had to fulfill themselves. By contrast, rostral dmPFC was particularly involved in representing agents’ valuations in a way that these could eventually be used to guide own choices. Furthering an understanding of how the brain is capable of performing inverse RL may prove important in subsequent work aimed at identifying the nature of the dysfunction in certain psychiatric and neurological disorders involving deficits in social cognition such as in autism spectrum disorder.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Participants</title><p>50 participants were recruited between the ages of 18 and 40 (mean: 27.1 years ± 4.9, 25 female). All were healthy, had normal/corrected to-normal vision, were free of psychiatric/neurological conditions, and did not report taking any medications that might interfere with fMRI. All participants received $60 compensation, and were asked to remain for 30 min after the end of the MRI sessions, where they were allowed to consume the won food item ad libitum. We excluded seven participants due to excessive head motion or technical difficulties during scanning (leaving 23 male, 20 female). The included participants did not exhibit scan to scan movements of greater than one voxel within a session. The research was approved by the Caltech Institutional Review Board, and all participants provided informed consent prior to their participation.</p></sec><sec id="s4-2"><title>Experimental paradigm</title><p>The experiment is divided into three tasks, one outside the MRI scanner, and two inside. First participants revealed their preferences over 10 food items outside MRI. Second, inside the scanner, the participants learned the food preferences of an agent. Third, participants played an observational learning slot machine game with this agent in order to win a food item they could consume at the end of the experiment. The second and third phase is played once with a similar agent, and once with a dissimilar agent, pseudo-randomized across participants. A debrief after the experiment revealed that all participants thought they were observing real agents. Participants could deduce that both agents were male ('Franky’ and 'Andrew’ were used as names, as well as video-feeds of male agents). Experiments were programmed and displayed with Psychtoolbox within the Mathworks Matlab (RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_001622">SCR_001622</ext-link>) environment.</p><sec id="s4-2-1"><title>Construction of food preferences of social agents</title><p>Before the MRI session, each participant was asked to express his/her food preferences over 10 food items through pairwise comparisons. The ranking we got from this pre-MRI phase was used to pair the participant with two agents: one very similar to her, and the other very dissimilar (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p></sec><sec id="s4-2-2"><title>MRI task 1</title><p>Preference learning. During the first MRI session, the participants learn the preferences of the agent through an observational learning game, and were subsequently asked to recall the agent’s preferences and rate the similarity of their own preference to those of this agent on a scale from 1 to 7 (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). During this observational learning game, participants observed the agent as it expressed its preferences through pairwise comparisons, just as participants had done during the earlier construction of food preferences. The fMRI results from this phase of the experiment are not reported in the current manuscript due to space limitations and in order to maintain the focus of the present manuscript on inverse RL, but the results from this phase will be reported in a subsequent manuscript.</p></sec><sec id="s4-2-3"><title>MRI task 2</title><p>Observational learning of agents with diverse preferences. Following the preference learning of one agent, the participants played a slot machine game with that same agent. The participants observed the choices of the agent. Participants were not informed that the agent was artificial; rather they were instructed that they would be observing another player by live video-feed. Before the game starts, the participants see the three involved slot machines (depicted by different fractals) and the three food items that can be won. They were informed that each slot machine would deliver the three food items, but at different probabilities. However, they have no knowledge about these probabilities. The three food items are chosen from the five items ranked by the other agent: the most preferred, the middle and the least preferred. On each trial two out of the three slot machines were presented for choice. On 2/3 of the trials, participants observed the choice of the agent. Notably, the participants could not see the outcome of the chosen slot machine, however they knew that the agent would see the food outcome. On 1/3 of the trials, participants were asked to choose a slot machine, but here again no outcome was revealed. Importantly, this means that the participants never get to see any food outcomes – hence the choices were based solely on the observer’s capacity to observe and learn from the actions taken by the other agents. This phase of the experiment totaled 150 trials: 100 observations and 50 self-choices. In this phase, the agent was implemented as a softmax learner, which was simulated for each session with a fixed learning rate and temperature. The agent model started with flat priors over the three slot machines (e.g. 1/3 for each machine), it then made a softmax choice over the two displayed machines, and updated the value of the chosen slot machine through a weighted prediction-error, when the food outcome was revealed. In this simulation procedure, the food outcomes were numerically coded according to increasing preference, from 1 to 3. The outcomes were sampled stochastically, according to the fixed probability distributions of the chosen slot machine (cf. <xref ref-type="fig" rid="fig3">Figure 3B</xref>). Thus, the simulated agent exhibited the same behavioral characteristics in the similar and dissimilar condition.</p></sec></sec><sec id="s4-3"><title>Computational models</title><sec id="s4-3-1"><title>Inverse reinforcement learning (inverse RL): general ideas</title><p>Learning policies through a direct approach, that is, imitation or observational learning, where both agent and participant have the same goal, have recently been used in investigations of social phenomena (<xref ref-type="bibr" rid="bib8">Burke et al., 2010</xref>). The aim of inverse RL is to implement an indirect learning approach, where a reward outcome distribution is recovered for which the agent’s choices are optimal, i.e. which explains the agent’s behavior (<xref ref-type="bibr" rid="bib1">Abbeel and Ng, 2004</xref>; <xref ref-type="bibr" rid="bib25">Ng and Russell, 2000</xref>). In our inverse RL approach the participant infers the reward outcome distribution of the slot machines using a framework with a participant-specific likelihood as to how the agent chooses given certain outcomes. Then, rather than mimicking the actions of the agent, the learned reward outcome distributions are subsequently used to construct participants’ own optimal policies.</p></sec><sec id="s4-3-2"><title>Complete inverse RL model</title><p>The design of this task is such that the agent gets outcome information for each chosen action, while the participants only see the agent’s (binary) choice without the outcome. Further, the instructions note that both the participant and the agent will each receive one actual food outcome at the end of the experiment, which is drawn randomly from all their respective outcomes during the game. Note that the approach described here does not guarantee the model to retrieve the true reward distribution, but to find a reward distribution which explains the actions of the agent, supposedly optimal, sufficiently well, relative to his preferences. Our inverse RL solution of the computational problem at hand proposes to incorporate information about the likelihood of choosing a machine given a certain outcome on the reward distribution. In this section we first describe a full model relying on true Bayesian updating, and then we propose a simplification of the updating, which is used in this study.</p><p>Agent. Let us denote <inline-formula><mml:math id="inf2"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> as the 3 × 3 matrix of outcome probabilities (rows: arms; columns: outcomes), and <inline-formula><mml:math id="inf3"><mml:msub><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> the vector of values of outcomes for agent (3 × 1). Prior <inline-formula><mml:math id="inf4"><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf5"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>|<inline-formula><mml:math id="inf6"><mml:mi>θ</mml:mi></mml:math></inline-formula>) is Dirichlet with parameters <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> represents the trial index. Expected value of arms in trial t is denoted <inline-formula><mml:math id="inf8"><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> (3 × 1 vector). It equals:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">[</mml:mo></mml:mrow><mml:mo>∫</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">]</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Choice is softmax (logit), so the chance that arm c is chosen when pair offered is (c,u) is:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>with u as unchosen option; <inline-formula><mml:math id="inf9"><mml:mi>β</mml:mi></mml:math></inline-formula> the exploitation intensity parameter. We write the updating of <inline-formula><mml:math id="inf10"><mml:mi>θ</mml:mi></mml:math></inline-formula> based on outcome o after choice of arm c using Dirichlet updating equations as follows: <disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where denotes the cth row of <inline-formula><mml:math id="inf11"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>. With the Dirichlet distribution, there are no updates on beliefs about the rows of <inline-formula><mml:math id="inf12"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> of the unchosen arm or arm not offered. Let us assume the observer has the same prior as the agent (Dirichlet with same <inline-formula><mml:math id="inf13"><mml:mi>θ</mml:mi></mml:math></inline-formula>), and that she knows this. (It is possible to allow the agent to have a different prior – different value of <inline-formula><mml:math id="inf14"><mml:mi>θ</mml:mi></mml:math></inline-formula> – but this would introduce additional complications).</p><p>The observer does not see outcomes; she only observes choices. Outcomes therefore constitute a sequence of hidden variables, like the 'state vector’ in the Kalman filter. A prior distribution of outcome sequences can be computed however, and with the likelihood of choices given outcomes, the observer can compute a posterior distribution of outcomes, as follows: The likelihood of any choice sequence given an outcome sequence can be obtained by fixing the outcome sequence, then combining the posterior given the outcome (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>) and the value given the posterior (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) with the choice given the value (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>). The prior of an outcome sequence can be obtained in the same way, but instead of taken outcomes as given, one draws outcomes trial-by-trial using the (trial) posterior belief of <inline-formula><mml:math id="inf15"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>. The problem is, of course, that these computations effectively mean that one is estimating hyper-dimensional integrals (over time, and over values of <inline-formula><mml:math id="inf16"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>). Once the observer has formed posterior beliefs of outcomes given choices, she can use those to determine posterior beliefs of <inline-formula><mml:math id="inf17"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> given the choice sequence. This way, she forms expectations of the evolution of agent beliefs over time, and because hers and the agent’s are the same, of own beliefs (of <inline-formula><mml:math id="inf18"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>) as well. Because the complexity of these integrals renders this complete inverse RL model to be computationally intractable in practice, we implemented a reduced form of inverse RL that is capable of performing approximate inverse RL inferences with the advantage of being much more tractable and hence plausible as a model of human inverse RL inference, described below.</p></sec><sec id="s4-3-3"><title>Approximate inverse RL</title><p>A reduced-form version of the updating can be formulated, as follows: To determine choices, the agent (and observer) only uses posterior mean values of <inline-formula><mml:math id="inf19"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). So, the observer is only concerned about tracking the update of the posterior mean. This posterior mean is the same for the observer and agent, since they have the same priors. The observer knows that the agent is solving an exploration/exploitation problem, whereby the agent tends to choose more frequently the arms that he believes provide a higher chance of a more favorable outcome for him (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>). Hence, if an arm is chosen, it is more likely that it generates the – for him – better outcome. If we list the outcomes in order of agent preferences so that elements of <inline-formula><mml:math id="inf20"><mml:msub><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> are decreasing, then it is reasonable for the agent to assume that the posterior mean probabilities of the chosen arm are updated as follows:<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>←</mml:mo><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where i (=1, 2, 3) indexes outcomes, and 0 &gt; <inline-formula><mml:math id="inf21"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>1, <inline-formula><mml:math id="inf22"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>2, <inline-formula><mml:math id="inf23"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>3 &gt; 1 denotes matrix element (c,i).</p><p>By the same token, the unchosen arm is likely to have less favorable chances of generating the good outcomes (from the point of view of the agent) and hence,<disp-formula id="equ5"><mml:math id="m5"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>←</mml:mo><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where u identifies the unchosen option in the pair of arms offered to the agent, and the vector [<inline-formula><mml:math id="inf24"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>1, <inline-formula><mml:math id="inf25"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>2, <inline-formula><mml:math id="inf26"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>3 ] is flipped. The outcome probabilities of the arm that was not offered in the trial is not updated.</p><p>Does it make sense to update beliefs of the row of <inline-formula><mml:math id="inf27"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> corresponding to the unchosen option? Notice that the Bayesian does not do so (see discussion below <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). However, it is not always the case that the agent chooses the most preferred option; he sometimes explores and chooses a lesser-valued arm. This arm tends to produce the outcome with lower value (to him), and his beliefs will evolve accordingly: he will increase the chance of the low-value option. How can we capture this? The lesser-valued arm can be identified by the frequency with which he chooses this arm across trials: more often, it is the unchosen arm. Hence, to capture updates in beliefs about this lesser-valued arm, we increase the probability of lesser-valued outcomes of the unchosen arm in each trial. The updating constants <inline-formula><mml:math id="inf28"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf29"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> depend on the observer’s (and agent’s) prior beliefs of <inline-formula><mml:math id="inf30"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as well as the agent’s exploitation intensity <inline-formula><mml:math id="inf31"><mml:mi>β</mml:mi></mml:math></inline-formula>. Since we don’t know either, we estimate the updating constants from the data (observer and agent choices). On account of its tractability, this approximate inverse RL scheme (as opposed to the complete inverse RL described earlier) was implemented in the analyses reported in the current manuscript.</p></sec><sec id="s4-3-4"><title>Imitation RL model</title><p>A simpler alternative approach is an imitation learning scheme update using a prediction error rule as follows. The imitation value V of each of the three slot machines A,B,C are initialized at VA = VB = VC=0.5. On trials in which (for instance) the slot machine A is chosen, when the agent’s choice is revealed, the update of the chosen slot machine uses a prediction error thus:<disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">_</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">_</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>⋅</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">_</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf32"><mml:mi>η</mml:mi></mml:math></inline-formula> is the learning rate, scaling the impact of the prediction error information. <inline-formula><mml:math id="inf33"><mml:msub><mml:mi>O</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> is the executed choice of slot A on trial t, which takes the value 1. To allow imitation learning more flexibility, we add an inversion parameter <inline-formula><mml:math id="inf34"><mml:mi>θ</mml:mi></mml:math></inline-formula> on self-choice trials, which describes the degree to which the observer inverts the expected values of slot machines before making a choice, based on their belief about the degree of similarity between the agent’s preferences and themselves. Specifically, <inline-formula><mml:math id="inf35"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">_</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">_</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">_</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. For example, in the case of an observer learning from an agent with identical preferences the inversion parameter <inline-formula><mml:math id="inf36"><mml:mi>θ</mml:mi></mml:math></inline-formula> would be close to zero, and hence the observer relies on the same value function as learned from the agent, whereas if the agent is judged to have opposite preferences to the observer, then <inline-formula><mml:math id="inf37"><mml:mi>θ</mml:mi></mml:math></inline-formula> would be close to 1, and the observer will have an inverted value function for the slots compared to the observee. The observer’s choice is then expressed as a soft-max function between the values for the slots, with a free parameter <inline-formula><mml:math id="inf38"><mml:mi>β</mml:mi></mml:math></inline-formula> characterizing the stochasticity of the choices as a function of the value difference between the slots.</p></sec><sec id="s4-3-5"><title>Imitation learning with counterfactuals</title><p>For our counterfactual imitation learner (cf-Imitation RL) in addition to the update of the chosen slot machine, the value of the unchosen (but available) slot machine is updated too, following the same rule, with its own separate learning rate <inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">_</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> and setting Outcome unchosen = 0. Just as with the Imitation RL model, we added an inversion parameter <inline-formula><mml:math id="inf40"><mml:mi>θ</mml:mi></mml:math></inline-formula> on self-choice trials, which describes the degree to which the participants invert the action probabilities of slot machines before making a choice.</p></sec><sec id="s4-3-6"><title>Fitting procedure</title><p>We assumed that the likelihood of participants’ self-choices is given by a softmax function over the value space of the two displayed slot machines. Parameters were fit using Matlab (RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_001622">SCR_001622</ext-link>) optimization under the constraint function fmincon to minimize the log-likelihood of the model fit with regards to the participants’ own choices. This procedure was iterated with three randomly chosen starting points within the constraints to increase the likelihood of finding a global rather than local optimum. Note that the similarity is taken into account implicitly by the likelihoods of the inverse RL model; in our main imitation RL model we included a parameter to weigh the degree to which the observer intents to invert the expected values of slot machines before making a choice. For models including a decay factor, the fmincon fitting was additionally performed iteratively (because of the integer numbers of this parameter). Decay factor was fit with constraints [1 100] (i.e. denoting integer trial numbers), inverting parameter <inline-formula><mml:math id="inf41"><mml:mi>θ</mml:mi></mml:math></inline-formula> with [0 1], choice temperature <inline-formula><mml:math id="inf42"><mml:mi>β</mml:mi></mml:math></inline-formula> (stochasticity) with [2 22].</p></sec><sec id="s4-3-7"><title>Why does inverse RL and imitation RL make different predictions about participants’ choice behavior and why are those predictions especially distinct for choices of the middle preferred slot?</title><p>The agents that we constructed that the observer sees, are artificial agents and those agents have a linear preference function for the most, middle and least preferred foods. As a consequence (assuming a reasonable choice temperature), their behavior will be approximately linear – they will try to choose the best machine most often and the machine associated with the greatest probability of the lowest valued option least often. The middle machine will be approximately in the middle in terms of choice frequency on average. This of course depends on the objective probability distributions over the outcomes available on the given slots, that is, in a case where the middle ranking machine has probabilities much closer to the top ranking machine, the choice probabilities of the agent would end up such that the agent would choose the middle machine with a frequency closer to that of the best machine. But in the case of the present task design and parameters, it is the case that choice probabilities will be approximately linearly ordered over the machines. Now, the imitation RL will essentially learn to mirror those choice probabilities – as it learns solely through observing the choice tendencies of the agent. Let’s consider instead inverse RL. This model is not concerned with learning directly from the choice behavior of the agent, instead it is concerned with inferring the outcome probabilities over the slots. As an observer, assuming I have learned sensibly about those outcome distributions, I can then use my own preference function to guide my choices over the slots. For instance I might really like food A (my most preferred outcome), but I also might be quite partial to food B (my middle preferred outcome), and I might really hate food C (the least preferred outcome). The point is I don’t need to have a linear preference function over the outcomes. My choice proportions over the slots can therefore more flexibly reflect my underlying preferences for the goods – I don’t simply have to mirror the agent’s preference function (or invert it). The free parameters in the inverse RL model can flexibly capture those differences in preferences. Although ostensibly they are used to update beliefs (i.e. as a likelihood function), these parameters can capture individual participants’ flexible preferences over the goods.</p><p>Now why does this difference in model predictions between inverse and imitation RL show up especially for the middle preferred outcome and not the best and worst preferred? The reason is that the best slot is always going to be strongly dominated by the worst, unless people are truly indifferent between the best and worst foods which is not likely. Thus, both imitation and inverse RL should capture that well. However, the middle food might vary a lot more in its relative preference for participants and hence its likely that there is going to be more variance in choices for this across subjects. This is why inverse RL does better in this situation.</p><p>Note that inverse RL will be better equipped to generalize too across different kinds of agents — if the agents were not to have a linear preference function, inverse RL ought to more robust to this — and still enable the observer to learn about the slots in a way that allows the observer to flexibly make their own choices based on their own preference functions.</p><p>Furthermore, inverse RL will also be better able to generalize under situations where new slot machines are introduced — if for example I see the same (or even a different) agent make choices over other unique slot machines in a completely new context — inverse RL will be able to guide choices under situations where those other slots are now presented in pairs with the original slot machines — because the observer can use knowledge of the outcome distributions to compute expected values on the fly for those slots in the novel pairings. Imitation RL would be hopelessly lost here because it’s value signals are relative to the other options available during the learning phase i.e. they are cached values analogous to model-free RL in the experiential domain (<xref ref-type="bibr" rid="bib10">Daw et al., 2005</xref>).</p></sec><sec id="s4-3-8"><title>SI index</title><p>We computed a social information integration index (SI index) to get a general measure of the similarities between the agent’s and the participants’ choice behavior during phase 2. We therefore normalized the distribution of choice ratios for the three slot machines and calculated the entropy between both distributions. For easier understanding we inverted the magnitudes, and hence an SI closer to one indicates very similar choice ratio behavior; for example in the dissimilar condition an SI close to one suggests a good performance of the participant, whereas an SI of 0 would mean that in the dissimilar case the participant mimics the agent, and hence his/her performance would be bad. Note that when correlating the SI post-hoc against slot machine choice ratios, we find a strong correlation between the SI and the mid versus worst ratio, i.e. how often the participant chose mid over worst when these two slot machines were presented.</p></sec></sec><sec id="s4-4"><title>Neuroimaging data acquisition</title><p>The fMRI images were collected using a 3T Siemens Trio scanner located at the Caltech Brain Imaging Center (Pasadena, CA) with a 32-channel radio frequency coil. The BOLD signal was measured using a one-shot T2*-weighted echo planar imaging sequence. Forty-four axial slices were acquired in oblique orientation of 30 degrees to the anterior commissure–posterior commissure line, with a repetition time (TR) of 2780 ms, TE of 30 ms, 80° flip angle, 3 mm isotropic resolution, 192 mm × 192 mm field of view. A high-resolution T1-weighted anatomical image (magnetization-prepared rapid-acquisition gradient echo sequence, 1 × 1 × 1 mm voxels) was acquired at the end of the session.</p></sec><sec id="s4-5"><title>fMRI data analysis</title><p>All image analyses were performed using SPM12 (rev. 6906; <ext-link ext-link-type="uri" xlink:href="http://www.fil.ion.ucl.ac.uk/spm">http://www.fil.ion.ucl.ac.uk/spm</ext-link>, RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_007037">SCR_007037</ext-link>), following a standard preprocessing pipeline. EPI images were realigned and realignment parameters were included in subsequent GLMs. Each subject’s T1 image was segmented into gray matter, white matter, and cerebrospinal fluid, and the segmentation parameters were used to warp the T1 image to the SPM Montreal Neurological Institute (MNI) template using SPM’s DARTEL procedure. The resulting normalization parameters were then applied to the functional data in 2 mm isotropic resolution. Finally, the normalized images were spatially smoothed using an isotropic 6 mm full-width half-maximum Gaussian kernel. Whole brain analyses where performed by defining a general linear model (GLM) for each participant, which contained parametric regressors representing the computational variables at the slot machine onset (outcome prediction in agent-referential space for both options, confidence), at the time the agent’s choice was revealed (update entropy), and at the time of participant choice (outcome prediction for chosen and unchosen slot machine, reaction time). The fMRI results depicted in the main figures are based on an uncorrected threshold of p=0.001 (which is illustrated as z&gt;3.3 in the figures) combined with an FWE-corrected cluster threshold of p=0.05 (here, k = 114). All regression estimates from <xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig4">Figure 4</xref> were conducted based on a leave-one-out procedure (<xref ref-type="bibr" rid="bib21">Kriegeskorte et al., 2009</xref>) to avoid non-independence bias. Specifically we ran a leave-one-subject-out GLM analysis on the group level (<xref ref-type="bibr" rid="bib12">Esterman et al., 2010</xref>), and each GLM defined the cluster for the subject left out. For the Bayesian Model Selection (BMS) analyses during action feedback, we defined a dmPFC region of interest in the Harvard/Oxford atlas (label 103 restricting the ROI to cover only medial areas, i.e. +12 &gt; X &gt; −12). The definition of this ROI was motivated by two recent reviews (<xref ref-type="bibr" rid="bib11">Dunne and O'Doherty, 2013</xref>; <xref ref-type="bibr" rid="bib2">Apps et al., 2016</xref>) which each identified the key dmPFC region involved in social inference. For this analysis we used the first-level Bayesian estimation procedure in SPM12 to compute a voxelwise whole-brain log-model evidence map for every subject and each model (<xref ref-type="bibr" rid="bib28">Penny et al., 2007</xref>; <xref ref-type="bibr" rid="bib30">Rosa et al., 2010</xref>). Both GLMs differed only in one single regressor: the parametric modulator for the prior expectations. Then, to model inference at the group level, we applied a random effects approach at every voxel of the log evidence data falling within the same masks previously used for beta extractions, constructing an exceedance posterior probability (EPP) maps for each model. The imaging results are displayed on a pool-specific structural template created by DARTEL procedure on the anatomical images of all the participants, transformed to MNI space.</p></sec><sec id="s4-6"><title>Data availability</title><p>The full anonymized dataset from this study is available in the NDAR data repository <ext-link ext-link-type="uri" xlink:href="https://ndar.nih.gov/">https://ndar.nih.gov/</ext-link> under the collection ID 2417. Summary information on the data (e.g. additional details about the experiment such as picture files or exact timings of stimuli) is available on the NDA homepage without the need for an NDA account. To request access to detailed human subjects data, you must be sponsored by an NIH recognized institution with a Federalwide Assurance and have a research related need to access NDA data. Further information as to how to request access can be found here <ext-link ext-link-type="uri" xlink:href="https://ndar.nih.gov/access.html">https://ndar.nih.gov/access.html</ext-link>. The fMRI activation maps are available at neurovault (<ext-link ext-link-type="uri" xlink:href="http://neurovault.org/collections/ZZHNHAJU/">http://neurovault.org/collections/ZZHNHAJU/</ext-link>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>This work was supported by the NIMH Caltech Conte Center for the Neurobiology of Social Decision Making (JPO). We thank Tim Armstrong and Lynn K Paul for support with the participant recruitment, and Ralph E Lee and Julian M Tyszka for assistance with the experiments.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Investigation, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Resources, Software, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Supervision, Funding acquisition, Methodology, Writing—original draft, Writing—review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Human subjects: Informed consent, and consent to publish was obtained from all participants prior to their participation. The research was approved by the Caltech Institutional Review Board.</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.29718.011</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-29718-transrepform-v1.pdf"/></supplementary-material><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following datasets were generated:</p><p><related-object content-type="generated-dataset" id="dataset1" source-id="https://ndar.nih.gov/edit_collection.html?id=2417" source-id-type="uri"><collab collab-type="author">Sven Collette</collab><collab collab-type="author">Wolfgang M Pauli</collab><collab collab-type="author">Peter Bossaerts</collab><collab collab-type="author">John O'Doherty</collab><year>2017</year><source>Raw data for Neural computations underlying inverse reinforcement learning in the human brain</source><ext-link ext-link-type="uri" xlink:href="https://ndar.nih.gov/edit_collection.html?id=2417">https://ndar.nih.gov/edit_collection.html?id=2417</ext-link><comment>Accession no. 2417. Please see data availability statement for further access details.</comment></related-object></p><p><related-object content-type="generated-dataset" id="dataset2" source-id="http://neurovault.org/collections/ZZHNHAJU/" source-id-type="uri"><collab collab-type="author">Collette S</collab><collab collab-type="author">Pauli WM</collab><collab collab-type="author">Bossaerts P</collab><collab collab-type="author">O'Doherty JP</collab><year>2017</year><source>Statistical fMRI maps for Neural computations underlying inverse reinforcement learning in the human brain</source><ext-link ext-link-type="uri" xlink:href="http://neurovault.org/collections/ZZHNHAJU/">http://neurovault.org/collections/ZZHNHAJU/</ext-link><comment>The fMRI activation maps are available at neurovault (accession no: ZZHNHAJU)</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abbeel</surname> <given-names>P</given-names></name><name><surname>Ng</surname> <given-names>AY</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Apprenticeship learning via inverse reinforcement learning</article-title><source>Proceedings of the Twenty-First International Conference on Machine Learning</source><pub-id pub-id-type="doi">10.1145/1015330.1015430</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Apps</surname> <given-names>MA</given-names></name><name><surname>Rushworth</surname> <given-names>MF</given-names></name><name><surname>Chang</surname> <given-names>SW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The anterior cingulate gyrus and social cognition: Tracking the motivation of others</article-title><source>Neuron</source><volume>90</volume><fpage>692</fpage><lpage>707</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.04.018</pub-id><pub-id pub-id-type="pmid">27196973</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname> <given-names>CL</given-names></name><name><surname>Saxe</surname> <given-names>R</given-names></name><name><surname>Tenenbaum</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Action understanding as inverse planning</article-title><source>Cognition</source><volume>113</volume><fpage>329</fpage><lpage>349</lpage><pub-id pub-id-type="doi">10.1016/j.cognition.2009.07.005</pub-id><pub-id pub-id-type="pmid">19729154</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Baker</surname> <given-names>CL</given-names></name><name><surname>Saxe</surname> <given-names>R</given-names></name><name><surname>Tenenbaum</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Bayesian theory of mind: Modeling joint belief-desire attribution</article-title><conf-name><italic>Proceedings of the Thirty-Third Annual Conference of the Cognitive Science Society</italic></conf-name><fpage>2469</fpage><lpage>2474</lpage><ext-link ext-link-type="uri" xlink:href="https://escholarship.org/uc/item/5rk7z59q">https://escholarship.org/uc/item/5rk7z59q</ext-link></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barraclough</surname> <given-names>DJ</given-names></name><name><surname>Conroy</surname> <given-names>ML</given-names></name><name><surname>Lee</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Prefrontal cortex and decision making in a mixed-strategy game</article-title><source>Nature Neuroscience</source><volume>7</volume><fpage>404</fpage><lpage>410</lpage><pub-id pub-id-type="doi">10.1038/nn1209</pub-id><pub-id pub-id-type="pmid">15004564</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>Hunt</surname> <given-names>LT</given-names></name><name><surname>Rushworth</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The computation of social behavior</article-title><source>Science</source><volume>324</volume><fpage>1160</fpage><lpage>1164</lpage><pub-id pub-id-type="doi">10.1126/science.1169694</pub-id><pub-id pub-id-type="pmid">19478175</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boorman</surname> <given-names>ED</given-names></name><name><surname>O'Doherty</surname> <given-names>JP</given-names></name><name><surname>Adolphs</surname> <given-names>R</given-names></name><name><surname>Rangel</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The behavioral and neural mechanisms underlying the tracking of expertise</article-title><source>Neuron</source><volume>80</volume><fpage>1558</fpage><lpage>1571</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.10.024</pub-id><pub-id pub-id-type="pmid">24360551</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burke</surname> <given-names>CJ</given-names></name><name><surname>Tobler</surname> <given-names>PN</given-names></name><name><surname>Baddeley</surname> <given-names>M</given-names></name><name><surname>Schultz</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Neural mechanisms of observational learning</article-title><source>PNAS</source><volume>107</volume><fpage>14431</fpage><lpage>14436</lpage><pub-id pub-id-type="doi">10.1073/pnas.1003111107</pub-id><pub-id pub-id-type="pmid">20660717</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cooper</surname> <given-names>JC</given-names></name><name><surname>Dunne</surname> <given-names>S</given-names></name><name><surname>Furey</surname> <given-names>T</given-names></name><name><surname>O'Doherty</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Human dorsal striatum encodes prediction errors during observational learning of instrumental actions</article-title><source>Journal of Cognitive Neuroscience</source><volume>24</volume><fpage>106</fpage><lpage>118</lpage><pub-id pub-id-type="doi">10.1162/jocn_a_00114</pub-id><pub-id pub-id-type="pmid">21812568</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daw</surname> <given-names>ND</given-names></name><name><surname>Niv</surname> <given-names>Y</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Uncertainty-based competition between prefrontal and dorsolateral striatal systems for behavioral control</article-title><source>Nature Neuroscience</source><volume>8</volume><fpage>1704</fpage><lpage>1711</lpage><pub-id pub-id-type="doi">10.1038/nn1560</pub-id><pub-id pub-id-type="pmid">16286932</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunne</surname> <given-names>S</given-names></name><name><surname>O'Doherty</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Insights from the application of computational neuroimaging to social neuroscience</article-title><source>Current Opinion in Neurobiology</source><volume>23</volume><fpage>387</fpage><lpage>392</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2013.02.007</pub-id><pub-id pub-id-type="pmid">23518140</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Esterman</surname> <given-names>M</given-names></name><name><surname>Tamber-Rosenau</surname> <given-names>BJ</given-names></name><name><surname>Chiu</surname> <given-names>YC</given-names></name><name><surname>Yantis</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Avoiding non-independence in fMRI data analysis: leave one subject out</article-title><source>NeuroImage</source><volume>50</volume><fpage>572</fpage><lpage>576</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2009.10.092</pub-id><pub-id pub-id-type="pmid">20006712</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fawcett</surname> <given-names>CA</given-names></name><name><surname>Markson</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Children reason about shared preferences</article-title><source>Developmental Psychology</source><volume>46</volume><fpage>299</fpage><lpage>309</lpage><pub-id pub-id-type="doi">10.1037/a0018539</pub-id><pub-id pub-id-type="pmid">20210491</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frith</surname> <given-names>CD</given-names></name><name><surname>Frith</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The neural basis of mentalizing</article-title><source>Neuron</source><volume>50</volume><fpage>531</fpage><lpage>534</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2006.05.001</pub-id><pub-id pub-id-type="pmid">16701204</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gershman</surname> <given-names>SJ</given-names></name><name><surname>Pouncy</surname> <given-names>HT</given-names></name><name><surname>Gweon</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Learning the Structure of Social Influence</article-title><source>Cognitive Science</source><volume>41 Suppl 3</volume><fpage>545</fpage><lpage>575</lpage><pub-id pub-id-type="doi">10.1111/cogs.12480</pub-id><pub-id pub-id-type="pmid">28294384</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Goodman</surname> <given-names>ND</given-names></name><name><surname>Baker</surname> <given-names>CL</given-names></name><name><surname>Tenenbaum</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Cause and Intent : Social Reasoning in Causal Learning</article-title><conf-name><italic>Proceedings of the Thirty-First Annual Conference of the Cognitive Science Society</italic></conf-name><fpage>2759</fpage><lpage>2764</lpage></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hampton</surname> <given-names>AN</given-names></name><name><surname>Bossaerts</surname> <given-names>P</given-names></name><name><surname>O'Doherty</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Neural correlates of mentalizing-related computations during strategic interactions in humans</article-title><source>PNAS</source><volume>105</volume><fpage>6741</fpage><lpage>6746</lpage><pub-id pub-id-type="doi">10.1073/pnas.0711099105</pub-id><pub-id pub-id-type="pmid">18427116</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jara-Ettinger</surname> <given-names>J</given-names></name><name><surname>Gweon</surname> <given-names>H</given-names></name><name><surname>Schulz</surname> <given-names>LE</given-names></name><name><surname>Tenenbaum</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The Naïve Utility Calculus: Computational Principles Underlying Commonsense Psychology</article-title><source>Trends in Cognitive Sciences</source><volume>20</volume><volume>785</volume><fpage>589</fpage><lpage>604</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2016.05.011</pub-id><pub-id pub-id-type="pmid">27388875</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolling</surname> <given-names>N</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>Mars</surname> <given-names>RB</given-names></name><name><surname>Rushworth</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Neural mechanisms of foraging</article-title><source>Science</source><volume>336</volume><fpage>95</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1126/science.1216930</pub-id><pub-id pub-id-type="pmid">22491854</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolling</surname> <given-names>N</given-names></name><name><surname>Wittmann</surname> <given-names>M</given-names></name><name><surname>Rushworth</surname> <given-names>MFS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Multiple neural mechanisms of decision making and their competition under changing risk pressure</article-title><source>Neuron</source><volume>81</volume><fpage>1190</fpage><lpage>1202</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.01.033</pub-id><pub-id pub-id-type="pmid">24607236</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kriegeskorte</surname> <given-names>N</given-names></name><name><surname>Simmons</surname> <given-names>WK</given-names></name><name><surname>Bellgowan</surname> <given-names>PS</given-names></name><name><surname>Baker</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Circular analysis in systems neuroscience: the dangers of double dipping</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>535</fpage><lpage>540</lpage><pub-id pub-id-type="doi">10.1038/nn.2303</pub-id><pub-id pub-id-type="pmid">19396166</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lucas</surname> <given-names>CG</given-names></name><name><surname>Griffiths</surname> <given-names>TL</given-names></name><name><surname>Fawcett</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A rational model of preference learning and choice prediction by children</article-title><source>Advances in Neural Information Processing Systems</source><volume>21</volume><fpage>1</fpage><lpage>8</lpage></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname> <given-names>L</given-names></name><name><surname>Xu</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Young children's use of statistical sampling evidence to infer the subjectivity of preferences</article-title><source>Cognition</source><volume>120</volume><fpage>403</fpage><lpage>411</lpage><pub-id pub-id-type="doi">10.1016/j.cognition.2011.02.003</pub-id><pub-id pub-id-type="pmid">21353215</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McNamee</surname> <given-names>D</given-names></name><name><surname>Liljeholm</surname> <given-names>M</given-names></name><name><surname>Zika</surname> <given-names>O</given-names></name><name><surname>O'Doherty</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Characterizing the associative content of brain structures involved in habitual and goal-directed actions in humans: a multivariate FMRI study</article-title><source>Journal of Neuroscience</source><volume>35</volume><fpage>3764</fpage><lpage>3771</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4677-14.2015</pub-id><pub-id pub-id-type="pmid">25740507</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ng</surname> <given-names>Ay</given-names></name><name><surname>Russell</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2000">2000</year><chapter-title>Algorithms for inverse reinforcement learning</chapter-title><person-group person-group-type="editor"><name><surname>De Sousa</surname> <given-names>J. P</given-names></name></person-group><source>Proceedings of the Seventeenth International Conference on Machine Learning</source><volume>Vol. 67</volume><publisher-name>Morgan Kaufmann Publishers Inc</publisher-name><fpage>663</fpage><lpage>670</lpage><pub-id pub-id-type="doi">10.2460/ajvr.67.2.323</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nicolle</surname> <given-names>A</given-names></name><name><surname>Klein-Flügge</surname> <given-names>MC</given-names></name><name><surname>Hunt</surname> <given-names>LT</given-names></name><name><surname>Vlaev</surname> <given-names>I</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>An agent independent axis for executed and modeled choice in medial prefrontal cortex</article-title><source>Neuron</source><volume>75</volume><fpage>1114</fpage><lpage>1121</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.07.023</pub-id><pub-id pub-id-type="pmid">22998878</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Doherty</surname> <given-names>J</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name><name><surname>Schultz</surname> <given-names>J</given-names></name><name><surname>Deichmann</surname> <given-names>R</given-names></name><name><surname>Friston</surname> <given-names>K</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Dissociable roles of ventral and dorsal striatum in instrumental conditioning</article-title><source>Science</source><volume>304</volume><fpage>452</fpage><lpage>454</lpage><pub-id pub-id-type="doi">10.1126/science.1094285</pub-id><pub-id pub-id-type="pmid">15087550</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Penny</surname> <given-names>W</given-names></name><name><surname>Flandin</surname> <given-names>G</given-names></name><name><surname>Trujillo-Barreto</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Bayesian comparison of spatially regularised general linear models</article-title><source>Human Brain Mapping</source><volume>28</volume><fpage>275</fpage><lpage>293</lpage><pub-id pub-id-type="doi">10.1002/hbm.20327</pub-id><pub-id pub-id-type="pmid">17133400</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Repacholi</surname> <given-names>BM</given-names></name><name><surname>Gopnik</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Early reasoning about desires: evidence from 14- and 18-month-olds</article-title><source>Developmental Psychology</source><volume>33</volume><fpage>12</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1037/0012-1649.33.1.12</pub-id><pub-id pub-id-type="pmid">9050386</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosa</surname> <given-names>MJ</given-names></name><name><surname>Bestmann</surname> <given-names>S</given-names></name><name><surname>Harrison</surname> <given-names>L</given-names></name><name><surname>Penny</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Bayesian model selection maps for group studies</article-title><source>NeuroImage</source><volume>49</volume><fpage>217</fpage><lpage>224</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2009.08.051</pub-id><pub-id pub-id-type="pmid">19732837</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schönberg</surname> <given-names>T</given-names></name><name><surname>Daw</surname> <given-names>ND</given-names></name><name><surname>Joel</surname> <given-names>D</given-names></name><name><surname>O'Doherty</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Reinforcement learning signals in the human striatum distinguish learners from nonlearners during reward-based decision making</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>12860</fpage><lpage>12867</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2496-07.2007</pub-id><pub-id pub-id-type="pmid">18032658</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seo</surname> <given-names>H</given-names></name><name><surname>Lee</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Temporal filtering of reward signals in the dorsal anterior cingulate cortex during a mixed-strategy game</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>8366</fpage><lpage>8377</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2369-07.2007</pub-id><pub-id pub-id-type="pmid">17670983</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shafto</surname> <given-names>P</given-names></name><name><surname>Goodman</surname> <given-names>ND</given-names></name><name><surname>Frank</surname> <given-names>MC</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Learning from others</article-title><source>Perspectives on Psychological Science</source><volume>7</volume><fpage>341</fpage><lpage>351</lpage><pub-id pub-id-type="doi">10.1177/1745691612448481</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sutton</surname> <given-names>RS</given-names></name><name><surname>Barto</surname> <given-names>AG</given-names></name></person-group><year iso-8601-date="1998">1998</year><source>Reinforcement Learning: An Introduction</source><publisher-loc>Cambridge</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suzuki</surname> <given-names>S</given-names></name><name><surname>Harasawa</surname> <given-names>N</given-names></name><name><surname>Ueno</surname> <given-names>K</given-names></name><name><surname>Gardner</surname> <given-names>JL</given-names></name><name><surname>Ichinohe</surname> <given-names>N</given-names></name><name><surname>Haruno</surname> <given-names>M</given-names></name><name><surname>Cheng</surname> <given-names>K</given-names></name><name><surname>Nakahara</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Learning to simulate others' decisions</article-title><source>Neuron</source><volume>74</volume><fpage>1125</fpage><lpage>1137</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.04.030</pub-id><pub-id pub-id-type="pmid">22726841</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wunderlich</surname> <given-names>K</given-names></name><name><surname>Rangel</surname> <given-names>A</given-names></name><name><surname>O'Doherty</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Neural computations underlying action-based decision making in the human brain</article-title><source>PNAS</source><volume>106</volume><fpage>17199</fpage><lpage>17204</lpage><pub-id pub-id-type="doi">10.1073/pnas.0901077106</pub-id><pub-id pub-id-type="pmid">19805082</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wunderlich</surname> <given-names>K</given-names></name><name><surname>Symmonds</surname> <given-names>M</given-names></name><name><surname>Bossaerts</surname> <given-names>P</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Hedging your bets by learning reward correlations in the human brain</article-title><source>Neuron</source><volume>71</volume><fpage>1141</fpage><lpage>1152</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.07.025</pub-id><pub-id pub-id-type="pmid">21943609</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.29718.016</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Badre</surname><given-names>David</given-names></name><role>Reviewing Editor</role><aff><institution>Brown University</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Neural computations underlying inverse reinforcement learning in the human brain&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom is a member of our Board of Reviewing Editors and the evaluation has been overseen by Timothy Behrens as the Senior Editor. The following individuals involved in review of your submission has agreed to reveal his identity: Samuel J Gershman (Reviewer #1).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>How people learn what actions lead to preferable outcomes is an important question at the intersection of learning and social cognition. This paper presents a behavioral, computational and neural characterization of observational learning in humans, using a paradigm that contrasts an &quot;inverse reinforcement learning&quot; account with an imitation account. The results suggest that people use inverse RL, tracking value in the observed agents value space rather than their own. This function is supported by regions of the brain involved in goal-directed learning, as well as mentalizing.</p><p>Essential revisions:</p><p>Though the reviewers differed on the value of the work for a pure behavioral or cognitive science audience, the reviewers with expertise in neuroscience were in agreement regarding the novelty and value of these findings for that domain. Nevertheless, the reviewers identified several points that would need to be addressed in a revision. These points largely cluster under three major themes and so are summarized accordingly below.</p><p>1) The framing and background need to be fully reworked in order to better situate the present study in the context of the prior cognitive science literature on observational learning and inverse reinforcement learning. Here are some specific examples from the reviewers of relevant literature that was not addressed sufficiently in the report.</p><p>a) Several other papers have also pursued this topic and should be integrated. Baker, Saxe and Tenenbaum, (2009), in an influential paper, showed how a computational theory of goal inference can make very strong and accurate predictions about behavioral judgments, and this was later followed up in many different ways by Jara-Ettinger, Noah Goodman, and others.</p><p>b) Considerable research on preference learning by children likewise pursues this topic.</p><p>Fawcett and Markson, (2010).</p><p>Lucas et al., (2009).</p><p>Lucas, C. G., Griffiths, T. L., Xu, F., Fawcett, C., Gopnik, A., Kushnir, T., Markson, L., &amp; Hu, J. (2014). The Child as Econometrician: A Rational Model of Preference Understanding in Children. PloS ONE 9(3): e92160 doi:10.1371/journal.pone.0092160.</p><p>Ma and Xu, (2011).</p><p>Repacholi and Gopnik (1997). c) There is a large literature on social influence that the paper doesn't touch upon at all.</p><p>d) There is recent work by Gershman, Pouncy and Gweon, (2017) on social learning that may be relevant.</p><p>2) Several of the specific analyses lacked sufficient justification and so either appeared inappropriate or arbitrary.</p><p>a) Much depends on the adequacy of the small volume correction (SVC). Though SVC is an acceptable approach, it is challenging to do in a way that does not introduce hidden degrees of freedom or that is unrealistically specific about the a priori hypotheses. The methods state that SVC was applied to 12mm spheres based on peak voxels from prior work from the authors' lab. This is likely only a modest correction to threshold given the size of these spheres, so it is important to justify such highly specific and small regions. Likewise, the particular choice of prior papers appears arbitrary in the absence of a justification. Thus, it must be clear that these are uniquely justified, were chosen prior seeing the data, and would truly be the only activity in these areas that would have been expected a priori. Indeed, it is not clear such specific predictions can be justified, given that this is the first fMRI study of inverse RL and regions like dmPFC are larger than 12mm. A more reasonable alternative would be a volume encompassing the full anatomically-defined region where observed activation would have been considered consistent with a priori predictions.</p><p>b) It was hard to track what thresholds were used throughout the results, discussion, and figures. For example, the discussion mentions a number of regions beyond dmPFC, like DLPFC, striatum, and TPJ. Were these also SVC based on a priori regions? If so, how many a priori regions were included? If not, how were these corrected? The discussion also mentions regions that were evident at a more lenient statistical threshold, though it was not clear what threshold that was.</p><p>c) It was not clear from the description how the model-based regressors from the inverse RL versus imitation RL were included in the GLM and then used for model selection, making the specifics of the model-based fMRI approach difficult to evaluate. Were they included in separate models or in the same model in the standard SPM way (which enters them ordered in something like a hierarchical regression)? Or were they allowed to compete for variance? Were they correlated? These points are important to clarify in order evaluate this aspect of the methods.</p><p>d) A one-tailed test was applied for some behavioral tests but not others. Though it is understood that the authors might have a directional prediction justifying the use of a one-tailed test, one would have to make an argument why there is a directional prediction for these particular analyses and not for others. The chief concern is that the one-tailed test was chosen after the two-tailed test failed to be significant.</p><p>e) The text notes that participants were removed for movement exceeding 10mm. This seems like a lax movement threshold. Movement more than a voxel is difficult to correct, and presumably voxel sizes were smaller than 10mm. How many participants moved more than a voxel?</p><p>f) It was not clear where the effect sizes appearing the figures come from. Was that based on unbiased ROIs?</p><p>3) Certain aspects of the theoretical models and their predictions were difficult to evaluate based on the description in the text.</p><p>a) There are several missing equations Materials and methods section.</p><p>b) Results section: &quot;If participants used a simple imitative behavioral (and/or inverting) strategy, we should observe symmetrical performance changes (accuracy decreases) for the best and worst machine, compared to the similar condition, whereas the mid machine should stay unchanged.&quot; This prediction is difficult to understand: why is it the case that simple imitation would not produce changes in the mid machine?</p><p>c) It would be useful to see a bar graph like <xref ref-type="fig" rid="fig1">Figure 1C</xref> for the key models. The relevant data is shown in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref> but it's hard to directly compare this to the human data.</p><p>d) It is not clear why the models make different predictions for the middle preferred slot machine, or how the models take into account similarity between the observer and agent.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.29718.017</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>Though the reviewers differed on the value of the work for a pure behavioral or cognitive science audience, the reviewers with expertise in neuroscience were in agreement regarding the novelty and value of these findings for that domain. Nevertheless, the reviewers identified several points that would need to be addressed in a revision. These points largely cluster under three major themes and so are summarized accordingly below.</p><p>1) The framing and background need to be fully reworked in order to better situate the present study in the context of the prior cognitive science literature on observational learning and inverse reinforcement learning. Here are some specific examples from the reviewers of relevant literature that was not addressed sufficiently in the report.</p><p>a) Several other papers have also pursued this topic and should be integrated. Baker, Saxe and Tenenbaum, (2009), in an influential paper, showed how a computational theory of goal inference can make very strong and accurate predictions about behavioral judgments, and this was later followed up in many different ways by Jara-Ettinger, Noah Goodman, and others.</p></disp-quote><p>We thank the reviewers for their helpful comments and their literature suggestions. We have reshaped the Introduction to underline the importance of the computational insights from the field of cognitive science, as follows:</p><p>[…] In the realm of cognitive sciences, the application of computational modeling tools have surged as a means of gaining insight into social behavior. Observational learning has recently been formalized as an inverse problem, where observed behavior is used to infer the hidden structure at the root of that behavior under the assumption that observed choices are goal-directed (Baker, Saxe and Tenenbaum, 2009, 2011; Goodman, Baker and Tenenbaum, 2009; Shafto, Goodman and Frank, 2012). Recent computational modeling work has focused on how humans create an understanding of other’s preferences and the similarity to one’s own past choices, to guide future behavior (Gershman, Pouncy and Gweon, 2017). Computing abstract social inferences has been characterized as emerging already in early infancy (Lucas, Griffiths and Fawcett, 2009; Jara-Ettinger et al., 2016). There is empirical evidence that subjective preferences emerge in toddlers as early as 16 to 18 months (Repacholi and Gopnik, 1997; Ma and Xu, 2011), and by the age of three children use inferences about social preferences to guide their own decisions (Fawcett and Markson, 2010).</p><p>Within the nascent sub-field of social computational neuroscience, a number of studies have utilized computational fMRI in order to gain insight into the neural mechanisms underlying observational learning. […]</p><disp-quote content-type="editor-comment"><p>b) Considerable research on preference learning by children likewise pursues this topic.</p><p>Fawcett and Markson, (2010).</p><p>Lucas et al., (2009).</p><p>Lucas, C. G., Griffiths, T. L., Xu, F., Fawcett, C., Gopnik, A., Kushnir, T., Markson, L., &amp; Hu, J. (2014). The Child as Econometrician: A Rational Model of Preference Understanding in Children. PloS ONE 9(3): e92160 doi:10.1371/journal.pone.0092160.</p><p>Ma and Xu, (2011).</p><p>Repacholi and Gopnik (1997).</p></disp-quote><p>Our Introduction has been adapted to reflect the important research on the roots of social learning in early infancy:</p><p>[…] Computing abstract social inferences has been characterized as emerging already in early infancy (Lucas, Griffiths and Fawcett, 2009; Jara-Ettinger et al., 2016). There is empirical evidence that subjective preferences emerge in toddlers as early as 16 to 18 months (Repacholi and Gopnik, 1997; Ma and Xu, 2011), and by the age of three children use inferences about social preferences to guide their own decisions (Fawcett and Markson, 2010). […]</p><disp-quote content-type="editor-comment"><p>c) There is a large literature on social influence that the paper doesn't touch upon at all.</p></disp-quote><p>In the present work, our goal was to investigate how computational processes underlying reverse inferences in a social setting are implemented in the brain. Traditionally social influence has been referred to changing one’s behavior to match the responses of other individuals or groups, and (Deutsch, M. and Gerard, H. B. (1955) ‘A study of normative and informational social influences upon individual judgment.’, The Journal of Abnormal and Social Psychology, 51(3), pp. 629– 636. doi: 10.1037/h0046408.) proposed an important distinction between normative and informational social influence. The latter is characterized by a desire for accurate understanding of the environment and “correct” behavior, and hence our work might be interpreted loosely within this context (as mentioned in (Gershman, Pouncy and Gweon, 2017), cited in our Introduction). However, we feel that, given this interpretation of social influence, and how it might be interpreted as conformity, we are barely touching this large field of research and hence a deeper dive into this literature might not be justifiable for our Introduction.</p><disp-quote content-type="editor-comment"><p>d) There is recent work by Gershman, Pouncy and Gweon, (2017) on social learning that may be relevant.</p></disp-quote><p>We thank the reviewers for suggesting the recent fine modeling work by Gershman, Pouncy &amp; Gweon (2017), and we adapted our Introduction to reflect the importance of this study:</p><p>[…] Recent computational modeling work has focused on how humans create an understanding of other’s preferences and the similarity to one’s own past choices, to guide future behavior (Gershman, Pouncy and Gweon, 2017). […]</p><disp-quote content-type="editor-comment"><p>2) Several of the specific analyses lacked sufficient justification and so either appeared inappropriate or arbitrary.</p><p>a) Much depends on the adequacy of the small volume correction (SVC). Though SVC is an acceptable approach, it is challenging to do in a way that does not introduce hidden degrees of freedom or that is unrealistically specific about the a priori hypotheses. The methods state that SVC was applied to 12mm spheres based on peak voxels from prior work from the authors' lab. This is likely only a modest correction to threshold given the size of these spheres, so it is important to justify such highly specific and small regions. Likewise, the particular choice of prior papers appears arbitrary in the absence of a justification. Thus, it must be clear that these are uniquely justified, were chosen prior seeing the data, and would truly be the only activity in these areas that would have been expected a priori. Indeed, it is not clear such specific predictions can be justified, given that this is the first fMRI study of inverse RL and regions like dmPFC are larger than 12mm. A more reasonable alternative would be a volume encompassing the full anatomically-defined region where observed activation would have been considered consistent with a priori predictions.</p></disp-quote><p>In addition to surviving SVC as originally reported in the manuscript, in fact, each all of the key results reported in the manuscript shown in <xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig4">4</xref> survive a whole brain cluster corrected threshold of FWE at p&lt;0.05 with a height threshold of p&lt;0.001 in SPM (where k=114). This thresholding approach is known to be robust against false positives (Woo, Krishnan and Wager, 2014; Flandin, G. and Friston, K. J. (2016) ‘Analysis of family-wise error rates in statistical parametric mapping using random field theory’, pp. 1–4. doi: 10.1073/pnas.1602413113.). In addition, the parameter estimate extractions were performed using a leave-one-out procedure to overcome a cluster selection bias.</p><p>We have now updated the text to report this one single whole brain corrected threshold throughout, and we now drop the SVCs, given the reviewer’s concern about possible arbitrariness of the selection criteria for the co-ordinates. The leave-one-out procedure for extraction of the parameter estimates is also now described in more detail in the manuscript.</p><p>We further defined anatomical regions of interest for the purpose of the Bayesian model comparison described under point <bold>c</bold> below. For this we utilized the Harvard/Oxford atlas to define the region of dmPFC where we would expect inverse RL related computations to be implemented. Motivated by two reviews outlining the role of this region in social computations, one by our group (Dunne and O’Doherty, 2013), and another by (Apps, Rushworth and Chang, 2016), we selected region 103 in the Harvard/Oxford atlas, restricting the ROI to cover only medial areas (i.e. +12 &gt; X &gt; -12).</p><p>The thresholding used throughout and details of the anatomical ROI definition are given in the text.</p><disp-quote content-type="editor-comment"><p>b) It was hard to track what thresholds were used throughout the results, discussion, and figures. For example, the discussion mentions a number of regions beyond dmPFC, like DLPFC, striatum, and TPJ. Were these also SVC based on a priori regions? If so, how many a priori regions were included? If not, how were these corrected? The discussion also mentions regions that were evident at a more lenient statistical threshold, though it was not clear what threshold that was.</p></disp-quote><p>We now make it clear throughout that all of the key results described in the manuscript survive whole brain FWE cluster correction. Regarding the regions described as being at a more “lenient” statistical threshold: since these results did not reach corrected significance, we have now excised any specific reference to these results from the revised manuscript for the sake of clarity. Nevertheless, these uncorrected findings are still reported in a supplementary table for future reference by interested researchers.</p><disp-quote content-type="editor-comment"><p>c) It was not clear from the description how the model-based regressors from the inverse RL versus imitation RL were included in the GLM and then used for model selection, making the specifics of the model-based fMRI approach difficult to evaluate. Were they included in separate models or in the same model in the standard SPM way (which enters them ordered in something like a hierarchical regression)? Or were they allowed to compete for variance? Were they correlated? These points are important to clarify in order evaluate this aspect of the methods.</p></disp-quote><p>Specifically, we used the first-level Bayesian estimation procedure in SPM12 to compute a voxelwise whole-brain log-model evidence map for every subject and each model (Penny, Flandin and Trujillo-Barreto, 2007; Rosa et al., 2010). Both GLMs differed only in one single regressor: the parametric modulator for the prior expectations. Then, to model inference at the group level, we applied a random effects approach at every voxel of the log evidence data falling within the same masks previously used for beta extractions, constructing an exceedance posterior probability (EPP) maps for each model. In <xref ref-type="fig" rid="fig3">Figure 3C</xref> we depict voxels with an EPP &gt; 0.95 for the inverse RL model, which shows that the anterior part of the dorsomedial cluster is much more likely to be engaged in computing expectations derived from the inverse RL model, compared to the imitation RL. To avoid any possible circularity in the modal comparison procedure, we now implement this BMS within an anatomical ROI for dmPFC as described in our response to section a.</p><disp-quote content-type="editor-comment"><p>d) A one-tailed test was applied for some behavioral tests but not others. Though it is understood that the authors might have a directional prediction justifying the use of a one-tailed test, one would have to make an argument why there is a directional prediction for these particular analyses and not for others. The chief concern is that the one-tailed test was chosen after the two-tailed test failed to be significant.</p></disp-quote><p>We reported a one-tailed test at p = 0.04 showing that participants performed more poorly in the dissimilar condition. This one-tailed test was well motivated because we expected that participants would perform WORSE in the dissimilar condition compared to the similar condition. This is quite a natural hypothesis since learning from others who have dissimilar preferences ought to be more difficult than learning from a participant with similar preferences to oneself. We have now more clearly described our hypothesis in this regard, and better justified the use of a one-tailed test.</p><disp-quote content-type="editor-comment"><p>e) The text notes that participants were removed for movement exceeding 10mm. This seems like a lax movement threshold. Movement more than a voxel is difficult to correct, and presumably voxel sizes were smaller than 10mm. How many participants moved more than a voxel?</p></disp-quote><p>We agree this was an overly lenient motion correction threshold. However, out of all the participants who were included in the study, no individual exhibited scan to scan movements of greater than one voxel within a session. This is now clarified in the text.</p><disp-quote content-type="editor-comment"><p>f) It was not clear where the effect sizes appearing the figures come from. Was that based on unbiased ROIs?</p></disp-quote><p>We updated our figure text to make it clearer where the effect sizes came from. First, the results depicted in <xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig4">4</xref> survive whole brain correction using FWE cluster correction (p=0.001 voxel threshold, and p=0.05 cluster significance threshold (k=114)), which has shown to be robust against false positives (Woo, Krishnan and Wager, 2014; Flandin and Friston, 2016). Second, for the parameter extraction results, we extracted the parameter values from the clusters surviving the cluster correction for both condition using a leave-one-out procedure.</p><disp-quote content-type="editor-comment"><p>3) Certain aspects of the theoretical models and their predictions were difficult to evaluate based on the description in the text.</p><p>a) There are several missing equations Materials and methods section.</p></disp-quote><p>The equations were not printed in text due to a LateX compilation error during the manuscript submission process. We apologize for failing to notice this. They are now visible in the text. Example: […] Expected value of arms in trial <italic>t</italic> is denoted <italic>V<sub>t</sub></italic> (3 X 1 vector). It equals:</p><p>Vt=∫∆vapt(∆|θ)dθ=[∫∆pt(∆|θ)dθ]va. (1)</p><p>Choice is softmax (logit), so the chance that arm c is chosen when pair offered is (<italic>c,u</italic>) is:</p><p>f(c|pair(c,u))=logit(Vt(c)–Vt(u)|β) (2)</p><p>with <italic>u</italic> as unchosen option; β the exploitation intensity parameter. We write the updating of θ based on outcome <italic>o</italic> after choice of arm <italic>c</italic> using Dirichlet updating equations as follows:</p><p>Pt+1(Δ(c,∙)|o,c;θ)←pt(∆(c,∙)|o,c;θ). (3)</p><p>where c,∙ denotes the <italic>c</italic>th row of Δ.[…]</p><disp-quote content-type="editor-comment"><p>b) Results section: &quot;If participants used a simple imitative behavioral (and/or inverting) strategy, we should observe symmetrical performance changes (accuracy decreases) for the best and worst machine, compared to the similar condition, whereas the mid machine should stay unchanged.&quot; This prediction is difficult to understand: why is it the case that simple imitation would not produce changes in the mid machine?</p></disp-quote><p>The agents that we constructed that the observer sees are artificial agents and those agents have a linear preference function for the most, middle and least preferred foods. As a consequence (assuming a reasonable choice temperature), their behavior will be approximately linear – they will try to choose the best machine most often and the machine associated with the greatest probability of the lowest valued option least often. The middle machine will be approximately in the middle in terms of choice frequency on average. This of course depends on the objective probability distributions over the outcomes available on the given slots, i.e. in a case where the middle ranking machine has probabilities much closer to the top ranking machine, the choice probabilities of the agent would end up such that the agent would choose the middle machine with a frequency closer to that of the best machine. But in the case of the present task design and parameters, it is the case that choice probabilities will be approximately linearly ordered over the machines.</p><p>Now, the imitation RL will essentially learn to mirror those choice probabilities – as it learns solely through observing the choice tendencies of the agent.</p><p>Let’s consider instead inverse RL. This model is not concerned with learning directly from the choice behavior of the agent, instead it is concerned with inferring the outcome probabilities over the slots. As an observer, assuming I have learned sensibly about those outcome distributions, I can then use my own preference function to guide my choices over the slots. For instance, I might really like Cheetos (my most preferred outcome), but I also might be quite partial to Lays Chips (my middle preferred outcome), and I might really hate boiled pigs feet (the least preferred outcome). The point is I don’t need to have a linear preference function over the outcomes. My choice proportions over the slots can therefore more flexibly reflect my underlying preferences for the goods – I don’t simply have to mirror the agent’s preference function (or invert it). The free parameters, epsilon 1,2,3 in the inverse RL model can flexibly capture those differences in preferences. Although ostensibly they are used to update beliefs (i.e. as a likelihood function), these parameters can capture individual participants' flexible preferences over the goods.</p><p>Now why does this difference in model predictions between inverse and inverse RL show up especially for the middle-preferred outcome and not the best and worst preferred? The reason is that the best slot is always going to be strongly dominated by the worst, unless people are truly indifferent between the best and worst foods which is not likely. Thus, both imitation and inverse RL should capture that well. However, the middle food might vary a lot more in its relative preference for participants and hence it is likely that there is going to be more variance in choices for this across subjects. This is why inverse RL does better in this situation.</p><p>Note that inverse RL will be better equipped to generalize too across different kinds of agents — if the agents were not to have a linear preference function, inverse RL ought to more robust to this — and still enable the observer to learn about the slots in a way that allows the observer to flexibly make their own choices based on their own preference functions.</p><p>Furthermore, inverse RL will also be better able to generalize under situations where new slot machines are introduced — if for example I see the same (or even a different) agent make choices over other unique slot machines in a completely new context — inverse RL will be able to guide choices under situations where those other slots are now presented in pairs with the original slot machines — because the observer can use knowledge of the outcome distributions to compute expected values on the fly for those slots in the novel pairings. Imitation RL would be hopelessly lost here because it’s value signals are relative to the other options available during the learning phase i.e. they are cached values analogous to model-free RL in the experiential domain.</p><p>Second, on a computational level, to test whether the models make indeed different qualitative predictions, we added evidence that the models are not confused. One way of doing this is to construct a confusion matrix. The idea behind this is that it should be possible for a model to recover the parameters from behavioral data that was generated from the model itself, i.e. it explains the self-generated data better than any other model. In the confusion matrix, the diagonal elements indicate the likelihood of a better fit on the self-generated data, while the off-diagonals represent the likelihood for other models.</p><p>Passages from the Results section have been updated for clarity and we have now added a completely new section to the Material and methods, which provides the intuitive explanation given here for why the models make different predictions about choice behavior (especially of the middle-preferred option).</p><disp-quote content-type="editor-comment"><p>c) It would be useful to see a bar graph like <xref ref-type="fig" rid="fig1">Figure 1C</xref> for the key models. The relevant data is shown in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref> but it's hard to directly compare this to the human data.</p></disp-quote><p>We have updated Figure 2—supplementary figure 1B for better comparison with human data. This new figure uses the participant data as shown in <xref ref-type="fig" rid="fig2">Figure 2</xref> and shows the choice probability for our main models, i.e. inverse RL and imitation RL. The bar graphs illustrate that the inverse RL is in average closer to the human choice behavior.</p><disp-quote content-type="editor-comment"><p>d) It is not clear why the models make different predictions for the middle preferred slot machine, or how the models take into account similarity between the observer and agent.</p></disp-quote><p>Please see our response to comment (b) above which addressed the concern about why the choices of the middle preferred machine best discriminates between the model predictions.</p><p>In relation to the similarity between the observer and the agent, please see the following which was added into the Material and methods section:</p><p>“The degree of similarity between the agent and observer is taken into account implicitly by the fitted likelihoods of the inverse RL model; in our main imitation RL model we included a parameter to set the degree to which the observer intends to invert the expected values of slot machines before making a choice. […]”</p></body></sub-article></article>