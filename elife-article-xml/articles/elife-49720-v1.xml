<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">49720</article-id><article-id pub-id-type="doi">10.7554/eLife.49720</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Ecology</subject></subj-group></article-categories><title-group><article-title>Multistability and regime shifts in microbial communities explained by competition for essential nutrients</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-105751"><name><surname>Dubinkina</surname><given-names>Veronika</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4844-6795</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-148897"><name><surname>Fridman</surname><given-names>Yulia</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-148896"><name><surname>Pandey</surname><given-names>Parth Pratim</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-63907"><name><surname>Maslov</surname><given-names>Sergei</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3701-492X</contrib-id><email>maslov@illinois.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Bioengineering</institution><institution>University of Illinois at Urbana-Champaign</institution><addr-line><named-content content-type="city">Urbana</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Carl R. Woese Institute for Genomic Biology</institution><institution>University of Illinois at Urbana-Champaign</institution><addr-line><named-content content-type="city">Urbana</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Department of Plasma Technologies</institution><institution>National Research Center &quot;Kurchatov Institute&quot;</institution><addr-line><named-content content-type="city">Moscow</named-content></addr-line><country>Russian Federation</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">National Center for Supercomputing Applications</institution><institution>University of Illinois at Urbana-Champaign</institution><addr-line><named-content content-type="city">Urbana</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Shou</surname><given-names>Wenying</given-names></name><role>Reviewing Editor</role><aff><institution>Fred Hutchinson Cancer Research Center</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Baldwin</surname><given-names>Ian T</given-names></name><role>Senior Editor</role><aff><institution>Max Planck Institute for Chemical Ecology</institution><country>Germany</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>22</day><month>11</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e49720</elocation-id><history><date date-type="received" iso-8601-date="2019-06-27"><day>27</day><month>06</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2019-10-01"><day>01</day><month>10</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Dubinkina et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Dubinkina et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-49720-v1.pdf"/><abstract><p>Microbial communities routinely have several possible species compositions or community states observed for the same environmental parameters. Changes in these parameters can trigger abrupt and persistent transitions (regime shifts) between such community states. Yet little is known about the main determinants and mechanisms of multistability in microbial communities. Here, we introduce and study a consumer-resource model in which microbes compete for two types of essential nutrients each represented by multiple different metabolites. We adapt game-theoretical methods of the stable matching problem to identify all possible species compositions of such microbial communities. We then classify them by their resilience against three types of perturbations: fluctuations in nutrient supply, invasions by new species, and small changes of abundances of existing ones. We observe multistability and explore an intricate network of regime shifts between stable states in our model. Our results suggest that multistability requires microbial species to have different stoichiometries of essential nutrients. We also find that a balanced nutrient supply promotes multistability and species diversity, yet make individual community states less stable.</p></abstract><abstract abstract-type="executive-summary"><title>eLife digest</title><p>In nature, different species of bacteria and fungi often live together in stable microbial communities. Exactly which species are present in the group and in which proportion may vary between communities. Changes in the environment, and in particular in the availability of nutrients, can trigger abrupt, extensive, and long-lasting changes in the composition of a community: these events are known as regime shifts. For instance, when bodies of water receive large quantities of phosphorus and nitrogen, certain algae can start to multiply uncontrollably and take over other species. A given community can have different stable species compositions, but it was unclear exactly how variations in nutrients can influence regime shifts.</p><p>To examine this problem, Dubinkina, Fridman, Pandey and Maslov harnessed mathematical techniques used in game theory and economics and modeled all the possible stable compositions of a community. They could then predict which environmental conditions – in this case, the amount of specific nutrients – were necessary for each stable composition to exist. These models also showed which conditions could trigger a regime shift. Finally, how resilient the communities were to different types of perturbations – for instance, an invasion by new species or changes in nutrient supply – was examined.</p><p>The results show that if competing species require different quantities of the same nutrients, then the community can have several possible stable compositions and it is more likely to go through regime shifts. In addition, a small number of keystone species were identified which can drive regime shifts by preventing other microbes from invading the community. Ultimately, these results suggest ways to control microbial communities in our environment, for example by manipulating nutrient supplies or introducing certain species at the right time. More work is needed however to verify the predictions of the model in real communities of microbes.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>alternative stable states</kwd><kwd>consumer resource models</kwd><kwd>competitive exclusion</kwd><kwd>population dynamics</kwd><kwd>limiting nutrients</kwd><kwd>microbial ecoclogy</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><funding-statement>No external funding was received for this work.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Multistability and regime shifts are common and species diversity is high in microbial communities when nutrient supplies are balanced and competing species have different stoichiometries of essential nutrients.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Recent metagenomics studies revealed that microbial communities living in similar environments are often composed of rather different sets of species (<xref ref-type="bibr" rid="bib63">Zhou et al., 2007</xref>; <xref ref-type="bibr" rid="bib31">Lahti et al., 2014</xref>; <xref ref-type="bibr" rid="bib32">Lozupone et al., 2012</xref>; <xref ref-type="bibr" rid="bib64">Zhou et al., 2013</xref>; <xref ref-type="bibr" rid="bib43">Pagaling et al., 2017</xref>; <xref ref-type="bibr" rid="bib20">Gonze et al., 2017</xref>). It remains unclear to what extent such alternative species compositions are deterministic as opposed to being an unpredictable outcome of communities’ stochastic assembly. Furthermore, changes in environmental parameters may trigger abrupt and persistent transitions between alternative species compositions (<xref ref-type="bibr" rid="bib54">Shade et al., 2012</xref>; <xref ref-type="bibr" rid="bib48">Rocha et al., 2018</xref>; <xref ref-type="bibr" rid="bib50">Scheffer and Carpenter, 2003</xref>). Such transitions, known as ecosystem regime shifts, significantly alter the function of a microbial community and are difficult to reverse. Understanding the mechanisms and principal determinants of alternative species compositions and regime shifts is practically important. Thus, they have been extensively studied over the past several decades (<xref ref-type="bibr" rid="bib56">Sutherland, 1974</xref>; <xref ref-type="bibr" rid="bib25">Holling, 1973</xref>; <xref ref-type="bibr" rid="bib38">May, 1977</xref>; <xref ref-type="bibr" rid="bib61">Tilman et al., 1997</xref>; <xref ref-type="bibr" rid="bib52">Schröder et al., 2005</xref>; <xref ref-type="bibr" rid="bib16">Fukami and Nakajima, 2011</xref>; <xref ref-type="bibr" rid="bib6">Bush et al., 2017</xref>).</p><p>Growth of microbial species is affected by many factors, with availability of nutrients being among the most important ones. Thus, the supply of nutrients and competition for them plays a crucial role in determining the species composition of a microbial community. The majority of modeling approaches explicitly taking nutrients into account are based on the classic MacArthur consumer-resource model and its variants (<xref ref-type="bibr" rid="bib34">MacArthur and Levins, 1964</xref>; <xref ref-type="bibr" rid="bib33">MacArthur, 1970</xref>; <xref ref-type="bibr" rid="bib26">Huisman and Weissing, 1999</xref>; <xref ref-type="bibr" rid="bib59">Tikhonov and Monasson, 2017</xref>; <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Goldford et al., 2018</xref>; <xref ref-type="bibr" rid="bib21">Goyal et al., 2018</xref>; <xref ref-type="bibr" rid="bib7">Butler and O'Dwyer, 2018</xref>). This model assumes that every species co-utilizes several substitutable nutrients of a single type (e.g. carbon sources). However, nutrients required for growth of a species exist in the form of several essential (non-substitutable) types including sources of C, N, P, Fe, etc. Real ecosystems driven by competition for multiple essential nutrients have been extensively experimentally studied (see recent papers; <xref ref-type="bibr" rid="bib14">Fanin et al., 2015</xref>; <xref ref-type="bibr" rid="bib5">Browning et al., 2017</xref>; <xref ref-type="bibr" rid="bib8">Camenzind et al., 2018</xref> and references therein). The theoretical foundation for all existing consumer-resource models capturing this type of growth has been laid in <xref ref-type="bibr" rid="bib60">Tilman (1982)</xref>, where a model with two essential resources has been introduced and studied. Future studies extended Tilman’s approach to three and more essential resources, where it has been shown to sometimes result in oscillations and chaos (<xref ref-type="bibr" rid="bib26">Huisman and Weissing, 1999</xref>; <xref ref-type="bibr" rid="bib27">Huisman and Weissing, 2001</xref>; <xref ref-type="bibr" rid="bib55">Shoresh et al., 2008</xref>). However, all the previously studied models accounted for just <italic>a single metabolite</italic> per each essential nutrient.</p><p>Here, we introduce and study a new consumer-resource model of a microbial community supplied with <italic>multiple metabolites</italic> of two essential types (e.g. C and N or N and P). This ecosystem is populated by microbes selected from a fixed pool of species. We show that our model has a very large number of possible steady states classified by their distinct species compositions. Using game-theoretical methods adapted from the well-known stable marriage (or stable matching) problem (<xref ref-type="bibr" rid="bib17">Gale and Shapley, 1962</xref>; <xref ref-type="bibr" rid="bib23">Gusfield and Irving, 1989</xref>), we predict all these states based only on the ranked lists of competitive abilities of individual species for each of the nutrients. We further classify these states by their dynamic stability, and whether they could be invaded by other species in our pool. We then focus our attention on a set of steady states that are both dynamically stable and resilient with respect to species invasion.</p><p>For each state, we identify its feasibility range of all possible environmental parameters (nutrient supply rates) for which all of state’s species are able to survive. We further demonstrate that for a given set of nutrient supply rates, more than one state could be simultaneously feasible, thereby allowing for multistability. While the overall number of stable states in our model is exponentially large, only very few of them can be realized for a given set of environmental conditions defined by nutrient supply rates. The principal component analysis of predicted microbial abundances in our model shows a separation between the alternative stable states reminiscent of real-life microbial ecosystems. We further explore an intricate network of regime shifts between the alternative stable states in our model triggered by changes in nutrient supply. Our results suggest that multistability requires microbial species to have different stoichiometries of two essential resources. We also find that well-balanced nutrient supply rates matching the average species’ stoichiometry promote multistability and species diversity yet make individual community states less structurally and dynamically stable. These and other insights from our consumer-resource model may help to understand the existing data and provide guidance for future experimental studies of alternative stable states and regime shifts in microbial communities.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Microbial community growing on two types of essential nutrients represented by multiple metabolites</title><p>Our consumer-resource model describes a microbial ecosystem colonized by microbes selected from a pool of <inline-formula><mml:math id="inf1"><mml:mi>S</mml:mi></mml:math></inline-formula> species. Growth of each of these species could be limited by two types of essential resources, to which we refer to as ‘carbon’ and ‘nitrogen’. In principle, these could be any pair of resources essential for life: C, N, P, Fe, etc. A generalization of this model to more than two types of essential resources (e.g. C, N and P) is straightforward. Carbon and nitrogen resources exist in the environment in the form of <inline-formula><mml:math id="inf2"><mml:mi>K</mml:mi></mml:math></inline-formula> distinct metabolites containing carbon , and <inline-formula><mml:math id="inf3"><mml:mi>M</mml:mi></mml:math></inline-formula> other metabolites containing nitrogen. For simplicity, we ignore the possibility of the same metabolite providing both types. We further assume that each of the <inline-formula><mml:math id="inf4"><mml:mi>S</mml:mi></mml:math></inline-formula> species in the pool is a specialist, capable of utilizing only a single pair of nutrients, that is one metabolite containing carbon and one metabolite containing nitrogen.</p><p>We assume that for given environmental concentrations of all nutrients, a growth rate of a species <inline-formula><mml:math id="inf5"><mml:mi>α</mml:mi></mml:math></inline-formula> is limited by a single essential resource via Liebig’s law of the minimum (<xref ref-type="bibr" rid="bib12">de Baar, 1994</xref>):<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo mathvariant="italic" separator="true"> </mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf6"><mml:mi>c</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf7"><mml:mi>n</mml:mi></mml:math></inline-formula> are the environmental concentrations of the unique carbon and nitrogen resources consumed by this species. The coefficients <inline-formula><mml:math id="inf8"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf9"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> are defined as species-specific growth rates per unit of concentration of each of two resources. They quantify the competitive abilities of the species <inline-formula><mml:math id="inf10"><mml:mi>α</mml:mi></mml:math></inline-formula> for its carbon and nitrogen resources, respectively. Indeed, according to the competitive exclusion principle, if two species are limited by the same resource, the one with the larger value of <inline-formula><mml:math id="inf11"><mml:mi>λ</mml:mi></mml:math></inline-formula> wins the competition. Note that according to Liebig’s law, if the carbon source is in short supply so that <inline-formula><mml:math id="inf12"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, it sets the value for this species growth rate. We refer to this situation as <inline-formula><mml:math id="inf13"><mml:mi>c</mml:mi></mml:math></inline-formula>-source <italic>limiting</italic> the growth of the species <inline-formula><mml:math id="inf14"><mml:mi>α</mml:mi></mml:math></inline-formula>. Conversely, when <inline-formula><mml:math id="inf15"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, the <inline-formula><mml:math id="inf16"><mml:mi>n</mml:mi></mml:math></inline-formula>-source is <italic>limiting</italic> the growth of this species. Thus, each species always has exactly one growth-limiting resource and one non-limiting resource.</p><p>In our model, microbes grow in a well-mixed chemostat-like environment subject to a constant dilution rate <inline-formula><mml:math id="inf17"><mml:mi>δ</mml:mi></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig1">Figure 1A</xref> for an illustration). The dynamics of the population density, <inline-formula><mml:math id="inf18"><mml:msub><mml:mi>B</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula>, of a microbial species <inline-formula><mml:math id="inf19"><mml:mi>α</mml:mi></mml:math></inline-formula> is then governed by:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo mathvariant="italic" separator="true"> </mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf20"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf21"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> are the specific pair of nutrients defining the growth rate <inline-formula><mml:math id="inf22"><mml:msub><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula> of this species according to the Liebig’s law (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). These nutrients are externally supplied at fixed rates <inline-formula><mml:math id="inf23"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf24"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and their concentrations follow the equations:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>⋅</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>α</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="normal">c</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>⋅</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>α</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="normal">n</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf25"><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf26"><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> are the growth yields of the species <inline-formula><mml:math id="inf27"><mml:mi>α</mml:mi></mml:math></inline-formula> on its <inline-formula><mml:math id="inf28"><mml:mi>c</mml:mi></mml:math></inline-formula>- and <inline-formula><mml:math id="inf29"><mml:mi>n</mml:mi></mml:math></inline-formula>-resources respectively. Yields quantify the concentration of microbial cells generated per unit of concentration of each of these two consumed resources. The yield ratio <inline-formula><mml:math id="inf30"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> determines the unique C:N stoichiometry of each species.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Community states and different types of their stability.</title><p>(<bold>a</bold>) A schematic depiction of the proposed experimental setup and one of several possible community states in the 2C × 2N × 4S model. Several sources of carbon an nitrogen are supplied at constant rates <inline-formula><mml:math id="inf31"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf32"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> to a chemostat with a dilution rate <inline-formula><mml:math id="inf33"><mml:mi>δ</mml:mi></mml:math></inline-formula>. Red and blue square nodes represent these nutrients inside the chemostat with steady state concentrations <inline-formula><mml:math id="inf34"><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> (for carbon) and <inline-formula><mml:math id="inf36"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf37"><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> (for nitrogen). They are consumed by three microbial species labeled by the pair of carbon (the first index) and nitrogen (the second index) nutrients this species consumes. Shaded ovals connect every species to its unique growth-limiting nutrient. The fourth species <inline-formula><mml:math id="inf38"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is not present in this steady state. (<bold>b</bold>) All seven uninvadable states in our realization of 2C × 2N × 4S model (see <xref ref-type="supplementary-material" rid="supp1">Supplementary files 1</xref>,<xref ref-type="supplementary-material" rid="supp2">2</xref> for the specific parameters). depicted using the same schematic representation as in (<bold>a</bold>). Panels (<bold>c–e</bold>) schematically illustrate three possible types of perturbations of a community state, corresponding to three different types of its stability. (<bold>c</bold>) Changes of nutrient supply rates, that may result in extinction of some of the species. Green shaded area schematically depicts the region of nutrient supply rates where a given state is feasible, red arrows represent the perturbations of nutrient supply rates. (<bold>d</bold>) Introduction of species currently absent from the system, that is invasion, that may change the set of surviving species. (<bold>e</bold>) Small fluctuations in abundances of existing species, that may disturb the dynamic equilibrium of the system and potentially drive it to another state. (<bold>f</bold>) Table that shows which stability criteria are satisfied for 34 possible states in our realization of 2C × 2N × 4S model. Note that these types of stability are in general unrelated to each other.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-49720-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Distribution of volumes for stable and unstable states.</title><p>Log-normal distribution of feasible volumes of 1211 uninvadable states in 6C × 6N × 36S version of our model. Red line is used for 1058 dynamically stable states and blue line for 153 dynamically unstable ones. Distributions are normalized to the total number of states of each type. The natural logarithm of the volume has mean <inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>8.87</mml:mn></mml:mrow><mml:mo>±</mml:mo><mml:mn>0.06</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf40"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2.08</mml:mn><mml:mo>±</mml:mo><mml:mn>0.04</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. There is no significant difference between distributions of volumes of stable and unstable uninvadable states (two-sample Kolmogorov-Smirnov test: p-value = 0.94).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-49720-fig1-figsupp1-v1.tif"/></fig></fig-group><p>A steady state of the microbial ecosystem can be found by setting the right hand sides of <xref ref-type="disp-formula" rid="equ2 equ3">Equations 2-3</xref> to zero and solving them for environmental concentrations of all nutrients <inline-formula><mml:math id="inf41"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf42"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, and abundances <inline-formula><mml:math id="inf43"><mml:msub><mml:mi>B</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula> of all species. We choose to label all possible steady states by the list of species present in the state and <italic>by the growth-limiting nutrient</italic> (<inline-formula><mml:math id="inf44"><mml:mi>c</mml:mi></mml:math></inline-formula><italic>or</italic> <inline-formula><mml:math id="inf45"><mml:mi>n</mml:mi></mml:math></inline-formula>) <italic>for each of these species</italic>. Thus, two identical sets of species, where at least one species is growth limited by a different nutrient are treated as two distinct states of our model. Conversely, our definition of a steady state does not take into account species’ abundances. Examples of such states in a system with two carbon, two nitrogen nutrients and four species (one species for every pair of carbon and nitrogen nutrients) with specific values of species’ competitive abilities <inline-formula><mml:math id="inf46"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf47"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and yields <inline-formula><mml:math id="inf48"><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf49"><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> (see <xref ref-type="supplementary-material" rid="supp1">Supplementary files 1</xref>,<xref ref-type="supplementary-material" rid="supp2">2</xref> for their exact values) are shown in <xref ref-type="fig" rid="fig1">Figure 1B</xref>. For the sake of brevity we refer to this model as 2C × 2N × 4S.</p><p>Because each of the <inline-formula><mml:math id="inf50"><mml:mi>S</mml:mi></mml:math></inline-formula> species in the pool could be absent from a given state, or, if present, could be limited by either its <inline-formula><mml:math id="inf51"><mml:mi>c</mml:mi></mml:math></inline-formula>- or its <inline-formula><mml:math id="inf52"><mml:mi>n</mml:mi></mml:math></inline-formula>-resource, the theoretical maximum of the number of distinct states is 3<sup>S</sup> (equal to 81 in our 2C × 2N × 4S example). However, the actual number of possible steady states is considerably smaller (equal to 34 in this case). Indeed, possible steady states in our model are constrained by a variant of the competitive exclusion principle (<xref ref-type="bibr" rid="bib18">Gause, 1932</xref>) (see Materials and methods for details). One of the universal consequences of this principle is that the number of species present in a steady state of any consumer-resource model cannot exceed K + M − the total number of nutrients.</p><p>We greatly simplified the task of finding all steady states in our model by the discovery of the exact correspondence between our system and a variant of the celebrated stable matching (or stable marriage) problem in game theory and economics (<xref ref-type="bibr" rid="bib17">Gale and Shapley, 1962</xref>; <xref ref-type="bibr" rid="bib23">Gusfield and Irving, 1989</xref>). The matching in our model connect pairs of C and N resources via microbial species using both of them. Unlike in the traditional stable marriage model, a given resource can be involved in more than one matching but cannot be limiting for more than one microbe. Thus, the competitive exclusion principle provides a number of constraints on the set of possible matchings and their stability, which are described in detail in Materials and methods and Appendix 3.</p></sec><sec id="s2-2"><title>Three criteria for stability of microbial communities</title><p>Each of the steady states identified in the previous chapter can be realized only for a certain range of nutrient supply rates. These ranges can be calculated using the steady state solutions of <xref ref-type="disp-formula" rid="equ2 equ3">Equations 2, 3</xref>, governing the dynamics of microbial populations and nutrient concentrations, respectively (see Materials and methods). Among all formal mathematical solutions of these equations we select those, where populations of all species and all nutrient concentrations are non-negative. This imposes constraints on nutrient supply rates, thereby determining their feasible range for a given steady state (shown in green in <xref ref-type="fig" rid="fig1">Figure 1C</xref>). The volume of such feasible range has been previously used to quantify the so-called structural stability of a steady state (<xref ref-type="bibr" rid="bib49">Rohr et al., 2014</xref>; <xref ref-type="bibr" rid="bib22">Grilli et al., 2017</xref>; <xref ref-type="bibr" rid="bib7">Butler and O'Dwyer, 2018</xref>). States with larger feasible volumes generally tend to be more resilient with respect to fluctuations in nutrient supply.</p><p>Stability of a steady state could be also disturbed by a successful invasion of a new species (see <xref ref-type="fig" rid="fig1">Figure 1D</xref>). We can test the resilience of a given state in our model with respect to such invasions. A state is called uninvadable if none of the other species from our pool can survive in the environment shaped by the existing species. <xref ref-type="fig" rid="fig1">Figure 1B</xref> shows all seven states that are uninvadable in our variant of the 2C × 2N × 4S model. Whether or not a given state is uninvadable is determined by the specific choice of parameters <inline-formula><mml:math id="inf53"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="inf54"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>. For example, for parameters listed in the <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> the state in which <inline-formula><mml:math id="inf55"><mml:msub><mml:mi>B</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math></inline-formula> is limited by carbon <inline-formula><mml:math id="inf56"><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf57"><mml:msub><mml:mi>B</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:math></inline-formula> - by carbon <inline-formula><mml:math id="inf58"><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> could be invaded by the species <inline-formula><mml:math id="inf59"><mml:msub><mml:mi>B</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></inline-formula>. Indeed, <inline-formula><mml:math id="inf60"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> of <inline-formula><mml:math id="inf61"><mml:msub><mml:mi>B</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></inline-formula> is larger than that of <inline-formula><mml:math id="inf62"><mml:msub><mml:mi>B</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math></inline-formula>, and the nitrogen concentration <inline-formula><mml:math id="inf63"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> is not limited by any species. Hence, this state is not shown in <xref ref-type="fig" rid="fig1">Figure 1B</xref>. However, the same state may turn out to be uninvadable for a different combination of parameters. The one-to-one correspondence between our model and a variant of the stable matching problem (<xref ref-type="bibr" rid="bib17">Gale and Shapley, 1962</xref>) allows us to identify all uninvadable steady states for a given choice of <inline-formula><mml:math id="inf64"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="inf65"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> describing species competitiveness for resources (see Materials and methods and Appendix 3 ).</p><p>Note that, in the regime of our model, where the supply of all nutrients is high, that is <inline-formula><mml:math id="inf66"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>≫</mml:mo><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, invadability of individual states does not depend on supply rates. Indeed, in this regime the outcome of an attempted invasion is fully determined by the competition between species, which in turn depends only on the rank-order of competitive abilities <inline-formula><mml:math id="inf67"><mml:mi>λ</mml:mi></mml:math></inline-formula> of the invading species relative to the species currently present in the ecosystem (see Materials and methods for details).</p><p>In addition to structural and invasion types of stability described above, there is also a notion of dynamic stability of a steady state actively discussed in the ecosystems literature (see e.g. <xref ref-type="bibr" rid="bib37">May, 1972</xref>; <xref ref-type="bibr" rid="bib1">Allesina and Tang, 2012</xref>; <xref ref-type="bibr" rid="bib7">Butler and O'Dwyer, 2018</xref>). Dynamic stability can be tested by exposing a steady state to small perturbations in populations of all species present in this state (see <xref ref-type="fig" rid="fig1">Figure 1E</xref>). The state is declared dynamically stable if after any such disturbance the system ultimately returns to its initial configuration (see Materials and methods for details of the testing procedure used in our study).</p><p>We classify all the steady states in our model according to these three types of stability. The example of this classification for our realization of 2C × 2N × 4S model is summarized in <xref ref-type="fig" rid="fig1">Figure 1F</xref>. Note, that in general, one type of stability does not imply another. Out of 34 possible steady states realized for different ranges of nutrient supply rates there are only seven uninvadable ones. In the 2C × 2N × 4S model only one of the states (labelled seven in <xref ref-type="fig" rid="fig1">Figure 1B</xref>) turned out to be dynamically unstable, while for the remaining 33 states small perturbations of microbial abundances present in the state do not trigger a change of the state. Unlike two other types of stability, the structural stability has a continuous range. It could be quantified by the fraction of all possible combinations of nutrient supply rates for which a given state is feasible (referred to as state’s normalized feasible range). We estimated the normalized feasible ranges of all states in the 2C × 2N × 4S model using a Monte Carlo procedure described in Materials and methods. The results are reflected in the second column of <xref ref-type="fig" rid="fig1">Figure 1F</xref>, where a structurally stable state is defined as that whose normalized feasible range exceeds 0.1 (an arbitrary threshold). In general we find that normalized feasible ranges of uninvadable states in our model have a broad log-normal distribution (see <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> for details).</p><p>It is natural to focus our attention on steady states that are simultaneously uninvadable and dynamically stable. Indeed, such states correspond to natural endpoints of the microbial community assembly process. They would persist for as long as the nutrient supply rates do not change outside of their structural stability range. Therefore, they represent the states of microbial ecosystems that are likely to be experimentally observed. From now on, we concentrate our study almost exclusively on those states and refer to them simply as stable states.</p></sec><sec id="s2-3"><title>Regime shifts between alternative stable states</title><p>The feasible ranges of nutrient supply of different stable states may or may not overlap with each other (see <xref ref-type="fig" rid="fig2">Figure 2A–B</xref> for a schematic illustration of two different scenarios). Whenever feasible ranges of two or more states overlap (see <xref ref-type="fig" rid="fig2">Figure 2B</xref>) - multistability ensues. Note that the states in the overlapping region of their feasibility ranges constitute true alternative stable states defined and studied in the ecosystems literature (<xref ref-type="bibr" rid="bib56">Sutherland, 1974</xref>; <xref ref-type="bibr" rid="bib25">Holling, 1973</xref>; <xref ref-type="bibr" rid="bib38">May, 1977</xref>; <xref ref-type="bibr" rid="bib16">Fukami and Nakajima, 2011</xref>; <xref ref-type="bibr" rid="bib6">Bush et al., 2017</xref>). The existence of alternative stable states goes hand-in-hand with regime shifts manifesting themselves as large discontinuous and hysteretic changes of species abundances (<xref ref-type="bibr" rid="bib50">Scheffer and Carpenter, 2003</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Regime shifts between alternative stable states.</title><p>(<bold>a</bold>) Shaded green areas schematically depict the feasible ranges of nutrient supply rates for several stable states in our model (#2-#4 in <xref ref-type="fig" rid="fig1">Figure 1B</xref>). The feasible range of the state #4 does not overlap with that of any other state. Feasible ranges of states #2 and #3 also do not overlap but share a common boundary. Panel (<bold>b</bold>) depicts the opposite scenario of overlapping feasible ranges of another pair of stable states (#1 and #2 in <xref ref-type="fig" rid="fig1">Figure 1B</xref>). In the overlapping region (dark green), they form a pair of alternative stable states. (<bold>c</bold>) A smooth transition between two states at the boundary. The population <inline-formula><mml:math id="inf68"><mml:msub><mml:mi>B</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></inline-formula> of the microbial species (1,1) is plotted as a function of changing nutrient supply rate <inline-formula><mml:math id="inf69"><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> (same as the x-axis in panel (<bold>a</bold>)). Vertical gray line corresponds to the boundary between states #3 and #2. (<bold>d</bold>) A regime shift between two states. <inline-formula><mml:math id="inf70"><mml:msub><mml:mi>B</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></inline-formula> is plotted as a function of nutrient supply <inline-formula><mml:math id="inf71"><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> as it sweeps through the overlapping region (gray area) in panel (<bold>b</bold>). Note abrupt changes of <inline-formula><mml:math id="inf72"><mml:msub><mml:mi>B</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></inline-formula> at the boundaries of the overlapping region and its hysteretic behavior as expected for regime shifts. Dashed line corresponds to <inline-formula><mml:math id="inf73"><mml:msub><mml:mi>B</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></inline-formula> in a dynamically unstable state (#7 in <xref ref-type="fig" rid="fig1">Figure 1B</xref>). (<bold>e</bold>) The network of possible regime shifts between pairs of stable states in the 2C × 2N × 4S model. Each red edge represents a possible regime shift between two states it connects (overlap of their feasible ranges as in panel (<bold>d</bold>)). Each blue edge corresponds to a smooth transition between two states while changing the fluxes (as in panel (<bold>c</bold>)). Nodes correspond to six uninvadable and dynamically stable states (state labels are the same as in <xref ref-type="fig" rid="fig1">Figure 1b</xref>). Sizes of nodes reflect relative magnitudes of feasible ranges of states they represent. (<bold>f</bold>) Network of 8633 possible regime shifts between pairs of 893 uninvadable dynamically stable states in the 6C × 6N × 36S model. The size of each node reflects its degree (i.e. the total number of other stable states that a given state can shift into). The color of each node corresponds to its network modularity class calculated as described in Materials and methods.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-49720-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Statistics of pairwise bistability network for 6C × 6N × 36S example.</title><p>(<bold>a</bold>) Degree distribution of the network in <xref ref-type="fig" rid="fig2">Figure 2F</xref>. (<bold>b</bold>) Rank-ordered distribution of weights of network edges from <xref ref-type="fig" rid="fig2">Figure 2F</xref>. The weights of the network in <xref ref-type="fig" rid="fig2">Figure 2F</xref> are given by normalized overlaps between states.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-49720-fig2-figsupp1-v1.tif"/></fig></fig-group><p>Every pair of states with overlapping feasibility ranges in our model corresponds to a possible regime shift between these states as illustrated in <xref ref-type="fig" rid="fig2">Figure 2D</xref> (note abrupt changes in the population <inline-formula><mml:math id="inf74"><mml:msub><mml:mi>B</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></inline-formula> at the boundary of the overlapping region). In general, a discontinuous regime shift happens in our model when one of the species (<inline-formula><mml:math id="inf75"><mml:msub><mml:mi>B</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math></inline-formula> in this example) changes its growth-limiting nutrient thereby making the state invadable. It is then promptly invaded by the species present in the new state (<inline-formula><mml:math id="inf76"><mml:msub><mml:mi>B</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf77"><mml:msub><mml:mi>B</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:math></inline-formula> in our example) which may lead to immediate changes in populations of multiple species. Conversely, when feasible ranges of a pair of states do not overlap with each other but share a boundary (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), the transition between these states is smooth and non-hysteretic (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). It manifests itself in continuous changes in abundances of all microbial species at the boundary between states. Such continuous transitions happen in our model when the growth rate of one of the species (<inline-formula><mml:math id="inf78"><mml:msub><mml:mi>B</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:math></inline-formula> in this example) falls below the dilution rate <inline-formula><mml:math id="inf79"><mml:mi>δ</mml:mi></mml:math></inline-formula>. This species then slowly disappears from the ecosystem thereby changing its state. When this boundary is crossed in the opposite direction, the same species (<inline-formula><mml:math id="inf80"><mml:msub><mml:mi>B</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:math></inline-formula>) gradually appears in the ecosystem.</p><p>As expected for regime shifts, dynamically unstable states always accompany multistable regions in our model (<xref ref-type="bibr" rid="bib50">Scheffer and Carpenter, 2003</xref>) (see below for a detailed discussion of the interplay between multistability and dynamically unstable states). We observed that dynamically unstable state #7 in our 2C × 2N × 4S is feasible in the overlapping region between states #1 and #2 in <xref ref-type="fig" rid="fig2">Figure 2B</xref>. The population <inline-formula><mml:math id="inf81"><mml:msub><mml:mi>B</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></inline-formula> in this state is shown as dashed line in <xref ref-type="fig" rid="fig2">Figure 2D</xref>.</p><p>We identified all possible regime shifts in the 2C × 2N × 4S model by systematically looking for overlaps between the feasible ranges of nutrient supply of all six uninvadable dynamically stable states. These regime shifts can be represented as a network in which nodes correspond to community’s stable states and edges connect states with partially overlapping feasible ranges (see thick red edges in <xref ref-type="fig" rid="fig2">Figure 2E</xref>). One can see that regime shifts are possible only for of nine pairs of uninvadable states. We performed additional simulations (see Materials and mthods) looking for shared boundaries (continuous transitions) between uninvadable states and identified additional four pairs of states bordering each other (thin blue edges in <xref ref-type="fig" rid="fig2">Figure 2E</xref>). The pairs of states #5 - #6 and #3 - #4 do not directly transition to each other either continuously or discontinuously. This indicates that their feasible ranges are too far apart from each other, so that they do not have any overlaps or common boundaries.</p><p>Combining the information in <xref ref-type="fig" rid="fig1">Figure 1B</xref> and <xref ref-type="fig" rid="fig2">Figure 2E</xref> one can find that all states connected by a discontinuous regime shift in our 2C × 2N × 4S model have two distinct sets of keystone species: <inline-formula><mml:math id="inf82"><mml:msub><mml:mi>B</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></inline-formula>-<inline-formula><mml:math id="inf83"><mml:msub><mml:mi>B</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:math></inline-formula> in one state and <inline-formula><mml:math id="inf84"><mml:msub><mml:mi>B</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math></inline-formula>-<inline-formula><mml:math id="inf85"><mml:msub><mml:mi>B</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:math></inline-formula> in another. This is because all regime shifts are driven by the same bistable switch in which these pairs of species compete and mutually exclude each other. The dynamically unstable state #7 is formed by the union of all four keystone species and, when perturbed, collapses into a state with either one or another keystone set. Conversely, states connected by a continuous transition share the same pair of keystone species. One of the ‘satellite’ species, that is species distinct from the keystone, gradually goes extinct when the boundary between these states is crossed. When the nutrient supply is changed in the opposite direction this species gradually invades the system.</p><p><xref ref-type="fig" rid="fig2">Figure 2F</xref> shows a much larger network of 8633 regime shifts between 893 uninvadable dynamically stable states in the 6C × 6N × 36S realization of our model. In this model the microbial community is supplied with six carbon and six nitrogen nutrients and colonized from a pool of 36 microbial species (one for each pair of C and N nutrients) (see <xref ref-type="supplementary-material" rid="supp3">Supplementary files 3</xref>, <xref ref-type="supplementary-material" rid="supp4">4</xref>, <xref ref-type="supplementary-material" rid="supp5">5</xref>, <xref ref-type="supplementary-material" rid="supp6">6</xref> for the values of <inline-formula><mml:math id="inf86"><mml:mi>λ</mml:mi></mml:math></inline-formula>’s and yields). For simplicity, we did not show the remaining 165 uninvadable stable states that have no possible regimes shifts to any other states. The size of a node is proportional to its degree (i.e. the total number of other states it overlaps with) ranging between 1 and 164 with average around 20 (the degree distribution is shown in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p><p>The network modularity analysis (see Materials and methods for details) revealed seven network modules indicating that pairs of states that could possibly undergo a regime shift are clustered together in the multi-dimensional space of nutrient supply rates. This modular structure suggests the existence of distinct sets of keystone species driving regime shifts within each module. However, the complexity of the 6C × 6N × 36S model does not allow a straightforward identification of these drivers (paired sets of keystone species and dynamically unstable states).</p></sec><sec id="s2-4"><title>Patterns of multistability</title><p>In a general case, the number of stable states that are simultaneously feasible for a given set of nutrient supply rates can be more than two. Furthermore, as the number of nutrients increases, the multistability with more than two stable states becomes progressively more common. In <xref ref-type="fig" rid="fig3">Figure 3A</xref>, we quantify the frequency of multistability with <inline-formula><mml:math id="inf87"><mml:mi>V</mml:mi></mml:math></inline-formula> stable states occur in our 6C × 6N × 36S model across all possible nutrient supply rates (see Materials and methods for details of how this was estimated). <inline-formula><mml:math id="inf88"><mml:mrow><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> approximately follows a Poisson distribution (dashed line in <xref ref-type="fig" rid="fig3">Figure 3A</xref>) with <inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.063</mml:mn></mml:mrow></mml:math></inline-formula>. Note that for some supply rates up to five stable states can be simultaneously feasible. However, the probability to encounter such cases is exponentially small.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Patterns of multistability.</title><p>(<bold>a</bold>) The distribution of the number, <inline-formula><mml:math id="inf90"><mml:mi>V</mml:mi></mml:math></inline-formula>, of multistable states across the entire space of nutrient supply rates. The data is based on Monte Carlo sampling of 1 million different environments (combinations of nutrient supply rates) in the 6C × 6N × 36S model. Solid circles show the fraction of all sampled environments for which <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> uninvadable dynamically stable states are simultaneously feasible. The dashed line is the fit to the data with a Poisson distribution for <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>v</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> extra states giving rise to multistability. (<bold>b</bold>) Fraction of multistable cases for different ratios of supply of two essential nutrients. The peak of the distribution is close to the balanced supply (<inline-formula><mml:math id="inf93"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>:</mml:mo><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>≃</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>:</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). (<bold>c</bold>) The PCA plot of relative microbial abundances in the vicinity of the environment, where <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> stable states coexist. Supply rates were randomly sampled within ±10% from the initial environment. Each point shows the first (x-axis) and the second (y-axis) principal components of microbial abundances in every uninvadable state feasible for this combination of supply rates. Colored circles label the original five stable states, black circles - several other stable states, which became feasible for nearby supply rates, and grey crosses - dynamically unstable states feasible in this region of nutrient supply rates.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-49720-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>The PCA plot of fractional microbial abundances.</title><p>These abundances, normalized to 1, were obtained in our simulations for supply rates in the local vicinity of a multistable point where <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> stable states coexist. Panels (<bold>a</bold>) and (<bold>b</bold>) represent the two remaining multistable points in addition to the multistable point shown in <xref ref-type="fig" rid="fig3">Figure 3C</xref>. Axes show the percentage of the variance explained by each principal component. Each point show the first (x-axis) and the second (y-axis) principal coordinates of microbial abundances in an uninvadable state feasible for a given set of nutrient supply rates. The supply rates were chosen to be close (±10%) to the initial multistable point. Colored circles mark the original five stable states, black circles - other stable states which became feasible for nearby supply rates, and grey crosses - dynamically unstable states feasible in this influx region. Note a quasi-1D manifold along which the points of all colors are aligned and the alternating order of points corresponding to stable and unstable states.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-49720-fig3-figsupp1-v1.tif"/></fig></fig-group><p>We further explored the factors that determine whether multistability is possible in resource-limited microbial communities. Like in a simple special case of regime shift between two microbial species studied in <xref ref-type="bibr" rid="bib60">Tilman (1982)</xref>, multistability in our model is only possible if individual microbial species have different C:N stoichiometry. This stoichiometry is given by the ratio of species’ nitrogen and carbon yields. Our numerical simulations and mathematical arguments show that when all species have exactly the same stoichiometry <inline-formula><mml:math id="inf96"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, there is no multistability or dynamical instability in our model (see Appendix 5 ) . That is to say, in this case for every set of nutrient supply rates the community has a unique uninvadable state, and all these states are dynamically stable.</p><p>A complementary question is whether multistable states are more common around particular ratios of carbon and nitrogen supply rates. <xref ref-type="fig" rid="fig3">Figure 3B</xref> shows this to be the case: the likelihood of multistability has a sharp peak around the well-balanced C:N nutrient supply rates. In this region multiple stable states are present for roughly 15% of nutrient supply rate combinations. Note that the average C:N stoichiometry of species in our model is assumed to be 1:1. In case of an arbitrary C:N stoichiometry, by redefining the units of nutrient concentrations and supply rates one can transform any ecosystem to have 1:1 nutrient ratio. Hence, in general, we predict that the highest chance to observe multistability will be when the ratio of nutrient supply rates is close to the average C:N stoichiometry of species in the community.</p><p>To illustrate how multistable states manifest themselves in a commonly performed Principal Component Analysis (PCA) of species’ relative abundances, we picked the environment with <inline-formula><mml:math id="inf97"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> simultaneously feasible stable states in our 6C × 6N × 36S model. In natural environments, nutrient supply usually fluctuates both in time and space. To simulate this we sampled a ±10% range of nutrient supply rates around this chosen environment (see Materials and methods) and calculated species’ relative abundances in each of the uninvadable states feasible for a given nutrient supply. To better understand the relationship between dynamically stable and unstable states we included the latter in our analysis. <xref ref-type="fig" rid="fig3">Figure 3C</xref> shows the first vs the second principal components of relative microbial abundances sampled in this fluctuating environment. (two more examples calculated for different multistable neighborhoods are shown in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A–B</xref>). One can see five distinct clusters, each corresponding to a single dynamically stable uninvadable state. Interestingly, in the PCA plot these states are separated by <inline-formula><mml:math id="inf98"><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> dynamically unstable ones. Furthermore, all states are aligned along a quasi-1D manifold with an alternating order of stable and unstable states. It is tempting to conjecture that some variant of our model may explain similar arrangements of clusters of microbial abundances, commonly seen in PCA plots of real ecosystems. If this is the case, the gaps between neighboring clusters would correspond to dynamically unstable states of the ecosystem, which may be experimentally observable as long transients in community composition.</p></sec><sec id="s2-5"><title>Patterns of diversity and structural stability of states</title><p>Above we demonstrated that multistable states are much more common for balanced nutrient supply rates, that is to say, when the average ratio of carbon and nitrogen supply rates matches the average C:N stoichiometry of species in the community (see <xref ref-type="fig" rid="fig3">Figure 3B</xref>). Interestingly, a balanced supply of nutrients also promotes species diversity. In <xref ref-type="fig" rid="fig4">Figure 4A</xref>, we plot the average number of species in a stable state, referred to as species richness, as a function of the average balance between carbon and nitrogen supplies for 6C × 6N × 36S model. The species richness is the largest (around 10.5) for balanced nutrient supply rates, while dropping down to the absolute minimal value of six in two extreme cases of very large imbalance of supply rates, where the nutrient supplied in excess becomes irrelevant in competition. In this case, only six species that are teh top competitors for carbon metabolites (if nitrogen supply is plentiful) or, respectively nitrogen metabolites (if carbon is large) survive, while the rest of less competitive species are never present in uninvadable states. The number of distinct community states also has a sharp peak at balanced nutrient supply (see 3-orders of magnitude difference in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Patterns of diversity and structural stability of states.</title><p>(<bold>a</bold>) Average species richness (y-axis) of uninvadable stable states feasible for a given <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>:</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> nutrient supply ratio (x-axis). Error bars correspond to standard deviation of species richness of individual states feasible for a given nutrient supply ratio (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> for the number of states contributing to each point). (<bold>b</bold>): Scatter plot of the prevalence (y-axis) of each of the 36 species in the 6C × 6N × 36S model plotted vs its average competitiveness rank for its carbon and nitrogen sources. The latter is calculated from the rank order of <inline-formula><mml:math id="inf100"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf101"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> among all species consuming each resource (rank one corresponds to the largest <inline-formula><mml:math id="inf102"><mml:mi>λ</mml:mi></mml:math></inline-formula> for this resource among all species). Species prevalence is quantified as the fraction of environments where a given species can survive. The dashed line shows the average trend. (<bold>c</bold>) The number of uninvadable dynamically stable (solid line) and unstable (dashed line) states with a particular species richness (x-axis). (<bold>d</bold>) Boxplot of nutrient feasibility ranges of uninvadable stable states plotted as a function of their species richness. All plots were calculated for the 6C × 6N × 36S model.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-49720-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Number of unique uninvadable stable states that are feasible for a given <inline-formula><mml:math id="inf103"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>:</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> nutrient supply ratio (x-axis is binned as in <xref ref-type="fig" rid="fig4">Figure 4A</xref>).</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-49720-fig4-figsupp1-v1.tif"/></fig></fig-group><p>For balanced nutrient supply rates the relationship between species’ competitiveness and its prevalence in the community is much less pronounced than for imbalanced ones. It is shown in <xref ref-type="fig" rid="fig4">Figure 4B</xref>, where we plot the prevalence of the species as a function of its average competitiveness. Here, the <italic>average competitiveness rank</italic> of a species is defined as the mean of its ranks of competitive abilities (<inline-formula><mml:math id="inf104"><mml:mi>λ</mml:mi></mml:math></inline-formula> parameters of the model) for its carbon and nitrogen resources. The rank 1 being assigned to the most competitive species for a given resource (the species with the largest value of <inline-formula><mml:math id="inf105"><mml:mi>λ</mml:mi></mml:math></inline-formula>), while the rank 6 - to the least competitive species for this resource. Species <italic>prevalence</italic> is given by the fraction of all environments where it can survive. Note that all 36 species in our pool are present in some of the environments.</p><p>In general, more competitive species tend to survive in a larger subset of environments (see the dashed curve in <xref ref-type="fig" rid="fig4">Figure 4B</xref>). For example, in our pool there is one species which happens to be the most competitive for both its carbon and nitrogen sources. This species is present in all of the states in every environment. However, we also find that some of the least competitive species (those at the right end of the x-axis in <xref ref-type="fig" rid="fig4">Figure 4B</xref>) survive in a broad range of environments. For example, one species with average competitiveness rank of 5.5 corresponding to the last and next to last rank for its two resources still has relatively high prevalence of around 20%. This illustrates complex ways in which relative competitiveness of all species in the pool shapes their prevalence in a broad range of environments.</p><p>We also explore the relationship between species richness of a state (i.e. its total number of surviving species) and its other properties. <xref ref-type="fig" rid="fig4">Figure 4C</xref> shows an exponential increase of the number of uninvadable states as a function of species richness. In our 6C × 6N × 36S model all uninvadable states with less than 10 species are dynamically stable (solid line in <xref ref-type="fig" rid="fig4">Figure 4C</xref>), while those with 10 or more species can be both stable or unstable (dashed line in <xref ref-type="fig" rid="fig4">Figure 4C</xref>). Overall, the fraction of stable states to dynamically unstable ones decreases with species richness. In other words, the probability for a state to be dynamically unstable increases with the number of species. In this aspect, our model behaves similar to the gLV model in Robert May’s study (<xref ref-type="bibr" rid="bib37">May, 1972</xref>).</p><p>In <xref ref-type="fig" rid="fig4">Figure 4D</xref>, we show a negative correlation between the species richness of a stable state and its feasible range of nutrient supplies. Thus in our model the number of species in an ecosystem has detrimental effect on the structural stability of the community quantifying its robustness to fluctuating nutrient supply (<xref ref-type="bibr" rid="bib49">Rohr et al., 2014</xref>). The empirically observed exponential decay of state’s feasible range with its number of species is well described by a two-fold decrease per each species added (see <xref ref-type="bibr" rid="bib53">Serván et al., 2018</xref> and <xref ref-type="bibr" rid="bib22">Grilli et al., 2017</xref> for related results in the gLV model). Note that the observed decrease in feasible range with species richness goes hand-in-hand with an increase in the overall number of states. Thus, in well-balanced environments a large number of states are carving all possible combinations of nutrient supply into many small and overlapping ranges.</p><p>Overall, the results of our model with a large number of nutrients suggest the following picture. In nutrient-balanced environments, we expect to observe a high diversity of species in the existing communities. These species can form a very large number of possible combinations (uninvadable states). Each of these states could be realized only for a narrow range of nutrient supply rates indicating their low structural stability. Moreover, in such environments we predict common appearance of multistability between some of these states.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The inspiration for our model was the common appearance of alternative stable states in ecosystems in general, and microbial communities in particular (<xref ref-type="bibr" rid="bib56">Sutherland, 1974</xref>; <xref ref-type="bibr" rid="bib61">Tilman et al., 1997</xref>; <xref ref-type="bibr" rid="bib52">Schröder et al., 2005</xref>; <xref ref-type="bibr" rid="bib16">Fukami and Nakajima, 2011</xref>; <xref ref-type="bibr" rid="bib6">Bush et al., 2017</xref>; <xref ref-type="bibr" rid="bib43">Pagaling et al., 2017</xref>; <xref ref-type="bibr" rid="bib20">Gonze et al., 2017</xref>). For example, eutrophication of shallow lakes caused by algal competition for N and P is one of the best studied examples of alternative stable states and regime shifts (<xref ref-type="bibr" rid="bib51">Scheffer and Jeppesen, 2007</xref>). To the best of our knowledge our model is the first consumer-resource model capable of multistability between several states, each characterized by a high diversity of species. We extend Tilman’s scenario (<xref ref-type="bibr" rid="bib60">Tilman, 1982</xref>) in which the growth of two species is limited by a pair of essential resources to the case of multiple nutrients of each type. This allows us to assemble complex communities with large number of co-existing species and provides additional insights into patterns of multistability in such communities.</p><sec id="s3-1"><title>Multistability requires diverse species stoichiometry</title><p>We find that multistability in our model requires a mix of species with different nutrient stoichiometries. In this aspect it is similar to both the Tilman model (<xref ref-type="bibr" rid="bib60">Tilman, 1982</xref>), and the MacArthur model (<xref ref-type="bibr" rid="bib34">MacArthur and Levins, 1964</xref>; <xref ref-type="bibr" rid="bib33">MacArthur, 1970</xref>; <xref ref-type="bibr" rid="bib10">Chesson, 1990</xref>). Common variants of the MacArthur model assume identical biomass yields of different species growing on a given nutrient (<xref ref-type="bibr" rid="bib59">Tikhonov and Monasson, 2017</xref>; <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Goldford et al., 2018</xref>; <xref ref-type="bibr" rid="bib21">Goyal et al., 2018</xref>; <xref ref-type="bibr" rid="bib7">Butler and O'Dwyer, 2018</xref>). In this case, the absence of multistability is guaranteed by a convex Lyapunov function (<xref ref-type="bibr" rid="bib33">MacArthur, 1970</xref>) guiding any dynamical trajectory of the system to its unique minimum. However, a MacArthur model with different nutrient yields of different species is capable of multistability. For some growth functions <inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> multistability is possible even in a community of species with identical nutrient yields/stoichiometries. For example, the growth function <inline-formula><mml:math id="inf107"><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⋅</mml:mo><mml:mi>C</mml:mi><mml:mo>⋅</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> has been numerically studied in the context of autocatalytic polymer growth and shown to be capable of multistability (<xref ref-type="bibr" rid="bib62">Tkachenko and Maslov, 2018</xref>). This model had 1:1 stoichiometry: a ligation always eliminates one left end and one right end of two polymer chains and generates one autocatalytic polymer segment. Another type of growth function with two essential resources has been shown to have bistable solutions even for identical species stoichiometries (see Figure 5C in <xref ref-type="bibr" rid="bib36">Marsland et al., 2019b</xref>). The Minimum Environmental Perturbation Principle introduced in this study may provide additional insights on the necessary conditions for multistability in consumer resource models.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Statistics of multistability for different combinations of yields.</title><p>Heatmap of the fraction of nutrient supply rate combinations that permit multistability for the 2C × 2N × 4S model with the same set of <inline-formula><mml:math id="inf108"><mml:mi>λ</mml:mi></mml:math></inline-formula>’s but different combinations of microbial growth yields (4000 model variants in total). Standard deviations of yields (x-axis) and the fraction of nutrient supply rates with multistability (y-axis) were logarithmically binned into 50 bins along each axis. The color scale represents log10 of the normalized count in each bin. The counts were normalized to add up to 100% in each column (same bin of the x-axis) to approximate the probability distribution of multistability fraction for given standard deviation of species stoichiometry. The bottom row (0) corresponds to 2069 yields combinations where no multistability was observed for any nutrient supply combinations in our Monte-Carlo simulations of 10<sup>6</sup> flux points. The red arrow on the x-axis corresponds to the approximate yield variation for mammalian gut microbes from <xref ref-type="bibr" rid="bib47">Reese et al. (2018)</xref>. The red arrow on y-axis highlights the predicted likelihood of multistability in our model for a microbial community with the same yield variation in our model. Light green arrows show an estimation of these numbers for phytoplankton species from <xref ref-type="bibr" rid="bib15">Finkel et al. (2016)</xref>. Dark green arrows correspond to the soil microbes studied in <xref ref-type="bibr" rid="bib41">Mouginot et al. (2014)</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-49720-fig5-v1.tif"/></fig><p>Given that multistability in our model is impossible in communities of species with identical stoichiometries, it is reasonable to expect that the larger is the variation of C:N ratio of individual microbes, the higher is the likelihood to observe multistability. We investigated this question in the 2C × 2N × 4S model and summarized the results in <xref ref-type="fig" rid="fig5">Figure 5</xref>. It shows that the likelihood of finding nutrient supply rates with multistability systematically decreases with standard deviation of the logarithm of species stoichiometry. We also found that about half of the combinations of species stoichiometries yielded no multistable states at all. Multistability in our model is caused by a complex interplay between species’ competitiveness abilities <inline-formula><mml:math id="inf109"><mml:mi>λ</mml:mi></mml:math></inline-formula> and their C:N stoichiometries <inline-formula><mml:math id="inf110"><mml:mfrac><mml:msup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mfrac></mml:math></inline-formula>. Appendix 4 explains why multistability is impossible for half of yield combinations for which the enumerator in <xref ref-type="disp-formula" rid="equ19">Equation S11</xref> exceeds its denominator.</p><p>Nutrient stoichiometry of phytoplankton species in marine ecosystems has been known to be relatively universal with C:N:P ≃ 106:16:1 known as Redfield ratio (<xref ref-type="bibr" rid="bib46">Redfield, 1958</xref>). Thus species-to-species variability of C:N ratio for phytoplankton is rather small with logarithmic standard deviation estimated to be around 0.05 based on data from <xref ref-type="bibr" rid="bib15">Finkel et al. (2016)</xref>. In this limit, the multistability in our model is rather unlikely (observed in ∼3% of nutrient supply combinations, see green arrow in <xref ref-type="fig" rid="fig5">Figure 5</xref>). The likelihood of multistability is also low (∼1%) for the mammalian gut microbiome, where variability of the logarithm of C:N ratio in different 'keystone’ gut species studied in <xref ref-type="bibr" rid="bib47">Reese et al. (2018)</xref> is around 0.03. The chances of multistability increase in terrestrial ecosystems such as soil, where significant deviations from the Redfield ratio have been reported (<xref ref-type="bibr" rid="bib11">Cleveland and Liptzin, 2007</xref>). For example, using the data for the microbial species from grassland leaf litter community reported in <xref ref-type="bibr" rid="bib41">Mouginot et al. (2014)</xref>, with log(C:N) variability of 0.12 we predict the likelihood of multistability to be around 10%.</p></sec><sec id="s3-2"><title>Multistability requires balanced nutrient supply matching the average species stoichiometry</title><p>Another important factor favoring multistability in our model is the balanced supply of two essential nutrients (see <xref ref-type="fig" rid="fig3">Figure 3B</xref>). It occurs when the average ratio of supply rates of two essential nutrients matches the average C:N stoichiometry of community’s species (see <xref ref-type="fig" rid="fig3">Figure 3B</xref>). When nutrient supplies are balanced, microbial community multistability is relatively common. Furthermore, for balanced nutrients the community can be in one of many different states, characterized by different combinations of limiting nutrients. These states tend to have high species diversity (<xref ref-type="fig" rid="fig4">Figure 4A</xref>) – a trend consistent with lake ecosystems in <xref ref-type="bibr" rid="bib28">Interlandi and Kilham (2001)</xref> – and relatively small range of feasible supply rates (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). Hence, regime shifts can be easily triggered by changes in nutrient supply. The balanced region is characterized by a complex relationship between species competitiveness and survival, so that even relatively poor competitors could occasionally have high prevalence (species in the upper right corner of <xref ref-type="fig" rid="fig4">Figure 4B</xref>).</p><p>In the opposite limit, the supply of nutrients of one type (say nitrogen) greatly exceeds that of another type (say carbon). For such imbalanced supply, the community has a unique uninvadable state, where every carbon nutrient supports the growth of the single most competitive species. Nitrogen nutrients are not limiting the growth of any species and thus have no impact on species survival and community diversity. As a consequence, the average diversity of microbial communities in such nutrient-imbalanced environments is low (about one half of that for balanced supply conditions). This is in agreement with many experimental studies showing that addition of high quantities of one essential nutrient (e.g. as nitrogen fertilizer) tends to decrease species diversity. This has been reported in numerous experimental studies cited in the chapter 'Resource richness and species diversity’ of <xref ref-type="bibr" rid="bib60">Tilman (1982)</xref> as well as in recent experiments in microbial communities (<xref ref-type="bibr" rid="bib39">Mello et al., 2016</xref>).</p></sec><sec id="s3-3"><title>Multistability and the total number of states are affected by tradeoffs</title><p>Species in our model are characterized by their competitiveness abilities <inline-formula><mml:math id="inf111"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf112"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> and nutrient yields <inline-formula><mml:math id="inf113"><mml:msup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf114"><mml:msup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>. As we showed above, the rank order of the former fully defines the total number of stable states and their invadability. On the other hand, multistability highly depends on combination of species’ nutrient yields. While in the current version of our model we did not assume any specific correlations between these parameters, imposing such correlations due to various biologically motivated tradeoffs may affect multistability and the total number of states of the ecosystem.</p><p>One possibility is a negative correlation between the competitive abilities of a given species for different nutrients. Such tradeoff may exist due to a limited amount of internal resources (such as the overall number of transporters) this species can allocate for consumption of all nutrients. This type of tradeoff was shown to result in an increased species diversity in well-balanced environments, but does not lead to multistability (<xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib58">Tikhonov, 2016</xref>). Similar negative (positive) correlations to increase (decrease) the number of stable states in a very different consumer-resource model based on the stable marriage problem (<xref ref-type="bibr" rid="bib21">Goyal et al., 2018</xref>). We expect these results to also apply to our model with tradeoff between <inline-formula><mml:math id="inf115"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf116"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>. Negative correlations between species’ competitive abilities for carbon and nitrogen are expected to increase the total number of stable states in our model, while positive correlations - to decrease it.</p><p>Another possibility is a negative correlation between species’ competitive ability and its yield for the same nutrient. It is known as a ‘growth-yield tradeoff’, which states that microbial species with faster growth on a given nutrient tend to use it less efficiently (have a smaller yield) (<xref ref-type="bibr" rid="bib44">Pfeiffer et al., 2001</xref>; <xref ref-type="bibr" rid="bib3">Beardmore et al., 2011</xref>; <xref ref-type="bibr" rid="bib42">Novak et al., 2006</xref>). Growth-yield tradeoff is expected to increase the likelihood of multistability in our model. It could be demonstrated already in the model of <xref ref-type="bibr" rid="bib60">Tilman (1982)</xref> with two species competing for two essential resources. If the species with the higher growth rate on, say, carbon source has a smaller yield on this resource than the other species - bistability always ensues. Note that, while growth-yield tradeoff is known to be common among microorganisms, the macroscopic (e.g. plant) ecosystems, which are the main focus of <xref ref-type="bibr" rid="bib60">Tilman (1982)</xref>, have the opposite correlation in which species’ yield <inline-formula><mml:math id="inf117"><mml:mi>Y</mml:mi></mml:math></inline-formula> is proportional to its competitive ability <inline-formula><mml:math id="inf118"><mml:mi>λ</mml:mi></mml:math></inline-formula>. This type of tradeoff leads to a relative scarcity of multistability in macroscopic ecosystems. Conversely, multistability is expected to be more common in microbial ecosystems due to the growth-yield tradeoff.</p></sec><sec id="s3-4"><title>Interplay between diversity and stability in ecosystems with multiple essential nutrients</title><p>Ever since Robert May’s provocative question ‘Will a large complex system be stable?’ (<xref ref-type="bibr" rid="bib37">May, 1972</xref>) the focus of many theoretical ecology studies has been on investigating the interplay between dynamic stability and species diversity in real and model ecosystems (<xref ref-type="bibr" rid="bib29">Ives and Carpenter, 2007</xref>). May’s prediction that ecosystems with large number of species tend to be dynamically unstable needs to be reconciled with the fact that we are surrounded by complex and diverse ecosystems that are apparently stable. Thus, it is important to understand the factors affecting stability of ecosystems in general and microbial ecosystems in particular .</p><p>Here, we explored the interplay between diversity and stability in a particular type of microbial ecosystems with multiple essential nutrients. We discussed three criteria for stability of microbial communities shaped by the competition for nutrients: (i) how stable is the species composition of a community to fluctuations in nutrient supply rates; (ii) the extent of community’s resilience to species invasions; and (iii) its dynamical stability to small stochastic changes in abundances of existing species. Naturally-occurring microbial communities may or may not be stable according to either one of these three criteria (<xref ref-type="bibr" rid="bib29">Ives and Carpenter, 2007</xref>). The degree of importance of each single criterion is determined by multiple factors such as how constant are nutrient supply rates in time and space and how frequently new microbial species migrate to the ecosystem.</p><p>Our model provides the following insights into how these three criteria are connected to each other. First, as evident from <xref ref-type="fig" rid="fig1">Figure 1F</xref>, the three types of stability are largely independent from each other. Second, communities growing on a well balanced mix of nutrients tend to have high species diversity (see peak in <xref ref-type="fig" rid="fig4">Figure 4A</xref>). The similar effect was demonstrated in other consumer resource models (<xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib59">Tikhonov and Monasson, 2017</xref>; <xref ref-type="bibr" rid="bib57">Taillefumier et al., 2017</xref>; <xref ref-type="bibr" rid="bib35">Marsland et al., 2019a</xref>). However, each of the community states in this regime tends to have a low structural stability with respect to nutrient fluctuations. In environments with highly variable nutrient supplies the community will frequently shift between these states. That is to say, some of the species will repeatedly go locally extinct and the vacated niches will be repopulated by others. Furthermore, many of the steady states in this regime are dynamically unstable giving rise to multistability and regime shifts. In this sense our model follows the general trend reported in <xref ref-type="bibr" rid="bib37">May (1972)</xref>. Conversely, microbial communities growing on an imbalanced mix of essential nutrients have relatively low diversity (<xref ref-type="fig" rid="fig4">Figure 4A</xref>) but are characterized by a high degree of structural and dynamic stability (see <xref ref-type="fig" rid="fig4">Figure 4D</xref> and <xref ref-type="fig" rid="fig4">Figure 4C</xref> respectively). We expect these trends to apply to a broad variety of consumer-resource models.</p><p>The existence of dynamically unstable states always goes hand in hand with multistability (<xref ref-type="bibr" rid="bib50">Scheffer and Carpenter, 2003</xref>) (see the dashed line in <xref ref-type="fig" rid="fig2">Figure 2D</xref> for an illustration of this effect in our model). Interestingly, in our model we always find <inline-formula><mml:math id="inf119"><mml:mrow><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> dynamically unstable states coexisting with <inline-formula><mml:math id="inf120"><mml:mi>V</mml:mi></mml:math></inline-formula> dynamically stable ones for the same environmental parameters (see <xref ref-type="fig" rid="fig3">Figure 3C</xref> and <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> for some examples). All states (both dynamically stable and unstable) shown in <xref ref-type="fig" rid="fig3">Figure 3C</xref> are positioned along some one-dimensional curve in PCA coordinates. This arrangement hints at the possibility of a non-convex one-dimensional Lyapunov function whose <inline-formula><mml:math id="inf121"><mml:mi>V</mml:mi></mml:math></inline-formula> minima (corresponding to stable states) are always separated by <inline-formula><mml:math id="inf122"><mml:mrow><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> maxima (unstable stable states) as dictated by the Morse theory (<xref ref-type="bibr" rid="bib40">Milnor, 1963</xref>). This should be contrasted with convex multi-dimensional Lyapunov functions used in <xref ref-type="bibr" rid="bib33">MacArthur (1970)</xref>, <xref ref-type="bibr" rid="bib9">Case and Casten (1979)</xref> and <xref ref-type="bibr" rid="bib10">Chesson (1990)</xref>.</p></sec><sec id="s3-5"><title>Extensions of the model</title><p>Our model can be extended to accommodate several additional properties of real-life microbial ecosystems. First, one could include generalist species capable of using more than one nutrient of each type. The growth rate of such species is given by:<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>α</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>α</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="thickmathspace"/></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, the sum over <inline-formula><mml:math id="inf123"><mml:mi>i</mml:mi></mml:math></inline-formula> (respectively <inline-formula><mml:math id="inf124"><mml:mi>j</mml:mi></mml:math></inline-formula>) is carried out over all carbon (nitrogen, respectively) sources that this species is capable of converting to its biomass. One may also consider the possibility of diauxic shifts between substitutable nutrient sources. In this case, each generalist species is following a predetermined preference list of nutrients and uses its carbon and nitrogen resources one-at-a-time, as modelled in <xref ref-type="bibr" rid="bib21">Goyal et al. (2018)</xref>. Since at any state each of the species is using a ‘specialist strategy’, that is to say, it is growing on a single carbon and a single nitrogen source, we expect that many of the results of the current study would be extendable to this model. Interestingly, the stable marriage problem can be used to predict the stable states of microbial communities with diauxic shifts between substitutable resources (<xref ref-type="bibr" rid="bib21">Goyal et al., 2018</xref>) and those in communities growing on a mix of two essential nutrients as in this study. It must be pointed out that these models use rather different variants of the stable marriage model.</p><p>It is straightforward to generalize our model to Monod’s growth equation and to take into account non-zero death rate (or maintenance cost) of individual species (see Appendix 1).</p><p>One can extend our model to include cross-feeding between the species. In this case some of the nutrients are generated as metabolic byproducts by the species in the community. These byproducts should be counted among nutrient sources and thus would allow the number of species to exceed the number of externally supplied resources.</p><p>Above we assumed a fixed size of the species pool. This constraint could be modified in favor of an expanding pool composed of a constantly growing number of species. These new species correspond to either migrants from outside of the community or mutants of the species within the community. This variant of the model would allow one to explore the interplay between ecosystem’s maturity (quantified by the number of species in the pool) and its properties such as multistability and propensity to regime shifts.</p></sec><sec id="s3-6"><title>Control of microbial ecosystems exhibiting multistability and regime shifts</title><p>In many practical situations we would like to be able to control microbial communities in a predictable and robust manner. That is to say, we would like to be able to reliably steer the community into one of its stable states and to maintain it there for as long as necessary. Alternative stable states and regimes shifts greatly complicate the task of manipulation and control of microbial ecosystems. Indeed, multistability means that the environmental parameters alone do not fully define the state of the community. In order to get it to a desired state, one needs to carefully select the trajectory along which one changes the environmental parameters (nutrient supply rates). Changing these parameters could lead to disappearance (local extinction) of some microbial species and open the ecosystem for colonization by others thereby changing its state. However, not all the states could be directly converted to each other in one step due to them being restricted to vastly different environments. Thus, densely interconnected networks of regime shifts shown in <xref ref-type="fig" rid="fig2">Figure 2E–F</xref> can be viewed as maps guiding the selection of the optimal environmental trajectory leading to the desired stable species composition.</p><p>These maps also suggest that microbial ecosystems described by our model might have a relatively small number of key drivers of regime shifts roughly corresponding to network modules (see <xref ref-type="fig" rid="fig2">Figure 2F</xref>). Regime shifts in each of the modules are driven by the competition between two mutually exclusive sets of keystone species. In addition to these keystone species, states also include ‘satellite’ species that do not generally affect the bistable switch. The exploration of different manipulation strategies of microbial ecosystems and the role of keystone and peripheral species in regime shifts is the subject of our future research (Maslov et al., unpublished).</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Identification of all states and classification of them as invadable or uninvadable</title><p>The competitive exclusion principle states that, in general, two species competing for the same growth-limiting nutrient cannot coexist with each other. Accounting for non-limiting nutrients present in our model, the competitive exclusion principle can be reformulated as the following two rules:</p><list list-type="bullet"><list-item><p>Rule 1: In a given steady state each nutrient (either carbon or nitrogen) limits the growth of no more than one species.</p></list-item><list-item><p>Rule 2: Any number of species can use a given nutrient in a non growth-limiting fashion. However, each of such species needs to be able to survive at the steady state concentration of this nutrient set by the growth-limited species. That means that for every nutrient each of the non growth-limited species <inline-formula><mml:math id="inf125"><mml:mi>β</mml:mi></mml:math></inline-formula> needs to be more competitive than the grow-limited species <inline-formula><mml:math id="inf126"><mml:mi>α</mml:mi></mml:math></inline-formula> for the same resource: <inline-formula><mml:math id="inf127"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> (or <inline-formula><mml:math id="inf128"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> in case of a nitrogen nutrient).</p></list-item></list><p>Note that in any state of our model every species has a unique nutrient limiting its growth. By the virtue of the Rule 1, if a nutrient is limiting the growth of any species at all, such species is also unique. Hence, in a given state the relationship between surviving species and their growth-limiting nutrients (marked as shaded ovals in <xref ref-type="fig" rid="fig1">Figure 1A</xref>) is an example of a matching on a graph of resource utilization. Rule two imposes additional limitations on this matching. As we show in the Appendix 2 , uninvadable states correspond to stable matchings in a variant of the celebrated stable marriage problem (<xref ref-type="bibr" rid="bib17">Gale and Shapley, 1962</xref>; <xref ref-type="bibr" rid="bib23">Gusfield and Irving, 1989</xref>).</p><p>Just like in the MacArthur model (<xref ref-type="bibr" rid="bib34">MacArthur and Levins, 1964</xref>) or any other consumer-resource model for that matter, the number of species present in a steady state of the community cannot exceed the total number of nutrients they consume. Any community constructed using Rules 1 and 2 represents a steady state of the ecosystem feasible for a certain range of nutrient supply rates. This state can be either invadable or uninvadable, and either dynamically stable or not.</p><p>For simplicity in our simulations we use equal numbers of C and N resources (<inline-formula><mml:math id="inf129"><mml:mi>L</mml:mi></mml:math></inline-formula> carbons and <inline-formula><mml:math id="inf130"><mml:mi>L</mml:mi></mml:math></inline-formula> nitrogens), with one unique species capable of utilization of every pair of resources (<inline-formula><mml:math id="inf131"><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> species in total). One must reiterate that our theory is not restricted to the specific values of <inline-formula><mml:math id="inf132"><mml:mi>K</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf133"><mml:mi>M</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf134"><mml:mi>S</mml:mi></mml:math></inline-formula>. We first selected the values of <inline-formula><mml:math id="inf135"><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf136"><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> from a uniform random distribution between 10 and 100. Note that in the regime of high nutrient supply (<inline-formula><mml:math id="inf137"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>≫</mml:mo><mml:mfrac><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mfrac></mml:mrow></mml:math></inline-formula>) all steady states of the community can be identified and tested for invadability using only the relative rank order of species’ competitiveness for nutrients. For this we used the following exhaustive search algorithm:</p><p><italic>Step 1</italic> - Select the subset of species whose growth is limited by C (C-limited species). For every carbon nutrient there are <inline-formula><mml:math id="inf138"><mml:mi>L</mml:mi></mml:math></inline-formula> ways to choose a species using this nutrient. There is also an additional possibility that this nutrient is not limiting the growth of any species. Thus, the total number of possibilities is <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for each of <inline-formula><mml:math id="inf140"><mml:mi>L</mml:mi></mml:math></inline-formula> carbon nutrients. There are <inline-formula><mml:math id="inf141"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>L</mml:mi></mml:msup></mml:math></inline-formula> ways to choose the set of C-limited species and our algorithm will exhaustively investigate each of these potential steady states one-by-one.</p><p><italic>Step 2</italic> - Given the set of C-limited species selected in Step 1, we now select the set of N-limited species. We first eliminate from our search any species that doesn’t have enough carbon to grow. That is to say, we go over all carbon nutrients one-by-one and eliminate all species whose <inline-formula><mml:math id="inf142"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> is smaller than that of the C-limited species (if any) for this carbon nutrient. Among the remaining species we go over the nitrogen nutrients one-by-one and look for all possible ways to add a species limited by a given nitrogen source <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> that satisfy the Rule 2. More specifically, we identify all species that use <inline-formula><mml:math id="inf144"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> and can grow on their carbon sources (those are the only species that remained after the elimination procedure described above). We then compare <inline-formula><mml:math id="inf145"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>s of these species to <inline-formula><mml:math id="inf146"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>s of all C-limited species using <inline-formula><mml:math id="inf147"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>. To satisfy the Rule 2 for each <inline-formula><mml:math id="inf148"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> we can add at most one N-limited species and its <inline-formula><mml:math id="inf149"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> has to be smaller than <inline-formula><mml:math id="inf150"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>s of all C-limited species using <inline-formula><mml:math id="inf151"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>. Let <inline-formula><mml:math id="inf152"><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> be the number of such species (<inline-formula><mml:math id="inf153"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> if there are no such species for a given <inline-formula><mml:math id="inf154"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>). The total number of possible steady states of our model for a given combination of C-limited species selected in Step 1 is given by <inline-formula><mml:math id="inf155"><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Here the <inline-formula><mml:math id="inf156"><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> factor in <inline-formula><mml:math id="inf157"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> takes into account an additional possibility to not add any N-limited species for <inline-formula><mml:math id="inf158"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>The unique way to construct an uninvadable state by following this algorithm is to go over all nitrogen sources one-by-one and for each of them add the N-limited species with the largest <inline-formula><mml:math id="inf159"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> among all species using this resource, whose growth is allowed by carbon constraints. If for every <inline-formula><mml:math id="inf160"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> this species is allowed by the Rule 2, that is to say, if its <inline-formula><mml:math id="inf161"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> is smaller than <inline-formula><mml:math id="inf162"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> of all C-limited species using <inline-formula><mml:math id="inf163"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, we successfully constructed a unique uninvadable state for a given set of C-limited species. Indeed, all possible invading species that are allowed to grow by their carbon nutrients will be blocked by their nitrogen nutrients. If, however, for any of <inline-formula><mml:math id="inf164"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, the species with the largest <inline-formula><mml:math id="inf165"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> is not allowed by the Rule 2, that is to say, if its <inline-formula><mml:math id="inf166"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> is larger than <inline-formula><mml:math id="inf167"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> of at least one of the C-limited species, this species would make a successful invader of any state we construct. In this case, there is no uninvadable state for the set of C-limited species selected during the Step 1.</p><p>We used the above procedure to identify all possible steady states and to classify them as invadable and uninvadable for different numbers of resources used in our 2C × 2N × 4S and 6C × 6N × 36S examples. Note that, while this method is computationally feasible for a relatively small number of nutrients (we were able to successfully use it for up to 9 nutrients of each type), for larger systems one should rely on computationally more efficient algorithms based on the stable marriage problem (<xref ref-type="bibr" rid="bib17">Gale and Shapley, 1962</xref>; <xref ref-type="bibr" rid="bib23">Gusfield and Irving, 1989</xref>) as described in the Appendix 3.</p></sec><sec id="s4-2"><title>Monte-Carlo sampling of nutrient supply rates to identify feasible ranges of states</title><p>Given the parameters defining all species (i.e., the set of their <inline-formula><mml:math id="inf168"><mml:mi>λ</mml:mi></mml:math></inline-formula>s and <inline-formula><mml:math id="inf169"><mml:mi>Y</mml:mi></mml:math></inline-formula>s) and the chemostat dilution constant <inline-formula><mml:math id="inf170"><mml:mi>δ</mml:mi></mml:math></inline-formula>, each state <inline-formula><mml:math id="inf171"><mml:mi>p</mml:mi></mml:math></inline-formula> is feasible within a finite region in the nutrient supply space (a <inline-formula><mml:math id="inf172"><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> dimensional space <inline-formula><mml:math id="inf173"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), where all microbial populations and nutrient concentrations are non-negative and the limiting nutrients of every surviving species do not change. It is easy to show that in a steady state our system satisfies mass conservation laws for each of the nutrients:<disp-formula id="equ5"><label>(4)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>α</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac><mml:mspace width="1em"/><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>α</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac><mml:mspace width="1em"/><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To simplify the process of calculating the feasible volumes of all states we worked in the <italic>limit of high nutrient supply</italic> where <inline-formula><mml:math id="inf174"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>≫</mml:mo><mml:mfrac><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf175"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>≫</mml:mo><mml:mfrac><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow></mml:math></inline-formula> for all species <inline-formula><mml:math id="inf176"><mml:mi>α</mml:mi></mml:math></inline-formula>. In this case the concentration <inline-formula><mml:math id="inf177"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> of any nutrient limiting growth of some species (<inline-formula><mml:math id="inf178"><mml:mi>α</mml:mi></mml:math></inline-formula> in this case) is negligible compared to its ‘abiotic concentration’<inline-formula><mml:math id="inf179"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></inline-formula>, that is to say, its concentration before any microbial species were added to the chemostat. In this case one can ignore the terms <inline-formula><mml:math id="inf180"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf181"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ5">Equation 4</xref> for all nutrient limiting growth of some species and leave only the ones that are not limiting the growth of any species. It is convenient to introduce the K + M − dimensional vector <inline-formula><mml:math id="inf182"><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> of microbial abundances and non-limiting nutrient concentrations in a given state <inline-formula><mml:math id="inf183"><mml:mi>p</mml:mi></mml:math></inline-formula>. For example, for the uninvadable state #5 in the 2C × 2N × 4S model we have: <inline-formula><mml:math id="inf184"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>5</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>The mass conservation laws (<xref ref-type="disp-formula" rid="equ5">Equation 4</xref>) can be used to obtain the feasible volumes of all states and can be represented in a compact matrix form for each state <inline-formula><mml:math id="inf185"><mml:mi>p</mml:mi></mml:math></inline-formula>:<disp-formula id="equ6"><label>(5)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>R</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo mathvariant="italic" separator="true"> </mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf186"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> is the vector of <inline-formula><mml:math id="inf187"><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> nutrient supply rates and <inline-formula><mml:math id="inf188"><mml:mover accent="true"><mml:msub><mml:mi>R</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is a matrix composed of inverse yields <inline-formula><mml:math id="inf189"><mml:msup><mml:mi>Y</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> of surviving species and '1’ for each of the non-limiting nutrients in a given state <inline-formula><mml:math id="inf190"><mml:mi>p</mml:mi></mml:math></inline-formula>. For example, for the state #5 in our 2C × 2N × 4S model the <xref ref-type="disp-formula" rid="equ6">Equation 5</xref> expands to:<disp-formula id="equ7"><label>(6)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mtd><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mtd><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Using <xref ref-type="disp-formula" rid="equ6">Equation 5,</xref> it is easy to check if a given state is feasible at a particular nutrient supply rate <inline-formula><mml:math id="inf191"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> by multiplying <inline-formula><mml:math id="inf192"><mml:msup><mml:mover accent="true"><mml:msub><mml:mi>R</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> (the inverse of the matrix <inline-formula><mml:math id="inf193"><mml:mover accent="true"><mml:msub><mml:mi>R</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>) with <inline-formula><mml:math id="inf194"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. If all of the elements of the resulting vector <inline-formula><mml:math id="inf195"><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> are positive, then the state <inline-formula><mml:math id="inf196"><mml:mi>p</mml:mi></mml:math></inline-formula> is feasible at <inline-formula><mml:math id="inf197"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. If the matrix <inline-formula><mml:math id="inf198"><mml:mover accent="true"><mml:msub><mml:mi>R</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is not invertible that is <inline-formula><mml:math id="inf199"><mml:mrow><mml:mrow><mml:mo>det</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>R</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, the state is feasible only on a low-dimensional subset of nutrient supply rates. This is not possible for a general choice of yields <inline-formula><mml:math id="inf200"><mml:mi>Y</mml:mi></mml:math></inline-formula> and is not considered in our study.</p><p>The parameters <inline-formula><mml:math id="inf201"><mml:mi>λ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf202"><mml:mi>Y</mml:mi></mml:math></inline-formula> for 2C × 2N × 4S and 6C × 6N × 36S realizations of the model were drawn from the uniform random distributions and are listed in <xref ref-type="supplementary-material" rid="supp1">Supplementary files 1</xref>,<xref ref-type="supplementary-material" rid="supp2">2</xref> and <xref ref-type="supplementary-material" rid="supp3">3</xref>,<xref ref-type="supplementary-material" rid="supp4">4</xref>,<xref ref-type="supplementary-material" rid="supp5">5</xref>,<xref ref-type="supplementary-material" rid="supp6">6</xref>. For <inline-formula><mml:math id="inf203"><mml:mi>λ</mml:mi></mml:math></inline-formula>’s the distribution ranges between 10 and 100. For <inline-formula><mml:math id="inf204"><mml:mi>Y</mml:mi></mml:math></inline-formula>’s it is between 0.1 and 1.</p><p>In our numerical simulations, for each model realization, we sampled 10<sup>6</sup> random nutrient supply rate combinations <inline-formula><mml:math id="inf205"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. Supply rates of each individual nutrient were independently selected from a uniform distribution on the [10, 1000] interval. We refer to this procedure as Monte Carlo sampling. The lower bound ensures that the system is always in the limit of high nutrient supply since max <inline-formula><mml:math id="inf206"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>≪</mml:mo><mml:mn>10.</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Then we checked the feasibility of each of the 33 possible steady states (both invadable and uninvadable) in the 2C × 2N × 4S model and each of the 1211 uninvadable steady states in the 6C × 6N × 36S model. That is to say, for every set of nutrient supply rates <inline-formula><mml:math id="inf207"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> and for every state <inline-formula><mml:math id="inf208"><mml:mi>p</mml:mi></mml:math></inline-formula> we checked whether all elements of <inline-formula><mml:math id="inf209"><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> are positive. The feasible range of nutrient supply rates of each state was estimated as the fraction of nutrient supply rate combinations (out of 1 million vectors <inline-formula><mml:math id="inf210"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> sampled by our Monte Carlo algorithm) where this state was found to be feasible.</p></sec><sec id="s4-3"><title>The network of regime shifts from overlaps of feasible ranges</title><p>Two stable states are said to be capable of a regime shift if their feasibility ranges overlap with each other, that is if there exists at least one nutrient supply rate combination at which both these states are feasible. We used the data obtained by the Monte-Carlo sampling to look for such cases and to construct networks shown in <xref ref-type="fig" rid="fig2">Figure 2E</xref>, <xref ref-type="fig" rid="fig2">Figure 2F</xref>.</p><p>We performed additional simulations to look for boundaries between uninvadable states in our realization of the 2C × 2N × 4S model. In order to do that, for each state we generated a large ensemble of random vectors of bacterial abundances of surviving species and concentrations of all not-limiting nutrients. The population of one of the species (also randomly selected) was set to be a small negative number (−0.01). This represents continuous gradual extinction of this species upon crossing of the boundary, The populations of state’s other surviving species and the concentrations of its non-limiting nutrients were drawn from the uniform distribution between (0,1]. Using <xref ref-type="disp-formula" rid="equ6">Equation 5,</xref> we calculated the nutrient supply rates <inline-formula><mml:math id="inf211"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> corresponding to this case. For these nutrient supply rates lying just across the feasibility boundary of the originally selected state, we checked the feasibility of other five uninvadable dynamically stable states. If any of these states ended up being feasible, we assumed that this state shares a boundary with the originally selected one. Using these procedure we found four bordering pairs of states shown as red edges in <xref ref-type="fig" rid="fig2">Figure 2E</xref>.</p><p>We used Gephi 0.9.2 software package to visualize the network in <xref ref-type="fig" rid="fig2">Figure 2F</xref> and to perform its modularity analysis. Seven densely interconnected clusters shown with different colors in <xref ref-type="fig" rid="fig2">Figure 2F</xref> were identified using Gephi’s built-in module-detection algorithm (<xref ref-type="bibr" rid="bib4">Blondel et al., 2008</xref>) with the resolution parameter set to 1.5.</p></sec><sec id="s4-4"><title>Dynamic stability of states</title><p>We checked the dynamic stability of every 33 possible steady state (both invadable and uninvadable) (for the 2C × 2N × 4S model) and each of the 1211 uninvadable states (for the 6C × 6N × 36S model) using the following two algorithms:</p><list list-type="order"><list-item><p>Small perturbation analysis For 2C × 2N × 4S example and each of the 33 states we selected many supply rate combination where this state is feasible. For each of these supply rates we generated the populations in our ecosystem to be equal to their steady state values. We then subjected them to small perturbations of of all nutrient concentrations and of all microbial populations of species present in the state. If after some transient period all populations and concentrations returned to their steady state values - the state was declared to be dynamically stable. If they drifted to these in some other steady state - the original state was declared to be dynamically unstable. Based on our numerical simulations the dynamical stability of the state was independent of the nutrient supply rates at which this numerical experiment has been performed. We choose to perturb only the populations of the species present in the state because an invadable state, by definition, would always be dynamically unstable against an addition of a very small population of at least one invading species from the species pool. This instability should not render it dynamically unstable. The numerical integration of the system dynamics following a perturbation was done in C programming language using the CVODE solver library of the SUNDIALS package (<xref ref-type="bibr" rid="bib24">Hindmarsh et al., 2005</xref>).</p></list-item><list-item><p>Inference of state’s dynamic stability from the pattern of its overlaps with other states The number of uninvadable states (1211) in our 6C × 6N × 36S model was too large to be directly tested for dynamic stability as we did for the 2C × 2N × 4S model. Their dynamic stability was instead inferred from our Monte-Carlo simulations listing all feasible uninvadable states for every sampled nutrient supply rate combination. We first identified 1022 uninvadable states, which were the unique feasible state for at least one nutrient supply point. All such states should be dynamically stable, since for every nutrient supply rate there should be at least one uninvadable dynamically stable state representing the end point of system’s dynamics. The remaining 173 uninvadable states, which were feasible for at least one of 1 million sampled nutrient supply rates were labelled as potentially dynamically unstable. Note that in our Monte-Carlo analysis we only sampled a finite (albeit large) number of nutrient supply rate combinations. Thus it is entirely possible that we missed some crucial supply rate combinations for which one of these states was the only uninvadable state. Any such point would have rendered this state as dynamically stable. Such false assignments might lead to a violation of the basic empirical rule in our model stating that <inline-formula><mml:math id="inf212"><mml:mi>V</mml:mi></mml:math></inline-formula> uninvadable stable states are always accompanied by <inline-formula><mml:math id="inf213"><mml:mrow><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> uninvadable dynamically unstable states (<inline-formula><mml:math id="inf214"><mml:mrow><mml:mi>V</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> rule) for some sampled nutrient supply rates. In our Monte Carlo simulations of the 6C × 6N × 36S model the <inline-formula><mml:math id="inf215"><mml:mrow><mml:mi>V</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> rule was violated for only 370 nutrient supply rates combinations out of 1,000,000 sampled points. We believe that these violations were caused by an incorrect identification of dynamically unstable states mentioned above. To iteratively refine the lists of stable and unstable states, we went over all potentially unstable states one-by-one and checked whether reclassifying the state involved in the largest number of violations as stable would reduce the overall number of violations. If it did, we reclassified this state as stable and recalculated the number of violations for all remaining points. By the end of this iterative procedure we were able to completely eliminate violations by reassigning 36 potentially unstable states as dynamically stable. This left us with 1022 + 36 = 1058 dynamically stable and 173 − 36 = 137 dynamically unstable uninvadable states in the 6C × 6N × 36S model. The remaining 1211 − 1058 − 137 = 16 uninvadable states were not feasible for any of 1,000,000 sampled nutrient supply rates. Hence their dynamic stability remains unidentified. Both 36 reassigned states and 16 undetected states are expected to have very small ranges of feasible nutrient supply rates.</p></list-item></list></sec><sec id="s4-5"><title>Multistability as a function of variation in stoichiometric ratios of different species</title><p>To investigate how multistability in our model depends on variation in stoichiometric ratios of different species, we simulated 4000 variants of the 2C × 2N × 4S model. In these variants, we kept the same choice of species competitiveness (quantified by their <inline-formula><mml:math id="inf216"><mml:mi>λ</mml:mi></mml:math></inline-formula>’s) but reassigned their yields <inline-formula><mml:math id="inf217"><mml:mi>Y</mml:mi></mml:math></inline-formula>. To cover a broad range of standard deviations of N:C stoichiometry of different species (their <inline-formula><mml:math id="inf218"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>) we randomly sampled yield combinations from gradually expanding intervals. First we simulated 1000 model variants, where yields of four species were independently drawn from uniform distribution <inline-formula><mml:math id="inf219"><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.45</mml:mn><mml:mo>,</mml:mo><mml:mn>0.55</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. These simulations were followed by 1000 model variants, where yields of four species were drawn from <inline-formula><mml:math id="inf220"><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.3</mml:mn><mml:mo>,</mml:mo><mml:mn>0.7</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, 1000 model variants with yields from <inline-formula><mml:math id="inf221"><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.9</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and, finally, 1000 model variants with yields from <inline-formula><mml:math id="inf222"><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>1.0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In each variant of the model with a particular set of yields of four species, we calculated the fraction of multistable points among 10<sup>5</sup> nutrient supply rate combinations as described in the section 5.2 Monte-Carlo sampling of nutrient supply rates to identify feasible ranges of states of Materials and methods. The results are shown in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p></sec><sec id="s4-6"><title>GitHub repository of the code used in our project</title><p>The PCA analysis, plots and statistical tests were implemented using R version 3.4.4. Other simulations were carried out in C (using compiler gcc version 5.4.0) and Python 3.5.2. Matlab analysis was done using MATLAB and Statistics Toolbox Release 2018a, The MathWorks, Inc, Natick, Massachusetts, United States. The code for both our simulations and statistical analysis can be downloaded from: <ext-link ext-link-type="uri" xlink:href="https://github.com/ssm57/CandN">https://github.com/ssm57/CandN</ext-link> (<xref ref-type="bibr" rid="bib13">Dubinkina and Maslov, 2019</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/CandN">https://github.com/elifesciences-publications/CandN</ext-link>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>Part of this work has been carried out at the University of Padova, Italy, in August 2018, during a scientific visit by one of us (SM). The authors wish to thank Prof. James O’Dwyer, Prof. Seppe Kuehn and Akshit Goyal for a critical reading of an earlier version of the manuscript. The authors also thank reviewers and editors for their comments, that helped to improve the manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Software, Investigation, Visualization, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Software, Investigation, Methodology, Writing—review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Software, Supervision, Funding acquisition, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Values of species’ competitive abilities for carbon and nitrogen in 2C × 2N × 4S model.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-49720-supp1-v1.xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Values of species’ carbon and nitrogen yields in 2C × 2N × 4S model.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-49720-supp2-v1.xlsx"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 3.</label><caption><title>Values of species’ competitive abilities for carbon in 6C × 6N × 36S model.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-49720-supp3-v1.xlsx"/></supplementary-material><supplementary-material id="supp4"><label>Supplementary file 4.</label><caption><title>Values of species’ competitive abilities for nitrogen in 6C × 6N × 36S model.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-49720-supp4-v1.xlsx"/></supplementary-material><supplementary-material id="supp5"><label>Supplementary file 5.</label><caption><title>Values of species’ carbon yields in 6C × 6N × 36S model.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-49720-supp5-v1.xlsx"/></supplementary-material><supplementary-material id="supp6"><label>Supplementary file 6.</label><caption><title>Values of species’ nitrogen yields in 6C × 6N × 36S model.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-49720-supp6-v1.xlsx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-49720-transrepform-v1.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analysed during this study are included in the manuscript and supporting files. The code for both our simulations and statistical analysis can be downloaded from: <ext-link ext-link-type="uri" xlink:href="https://github.com/ssm57/CandN">https://github.com/ssm57/CandN</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/CandN">https://github.com/elifesciences-publications/CandN</ext-link>).</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allesina</surname> <given-names>S</given-names></name><name><surname>Tang</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Stability criteria for complex ecosystems</article-title><source>Nature</source><volume>483</volume><fpage>205</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1038/nature10832</pub-id><pub-id pub-id-type="pmid">22343894</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bader</surname> <given-names>FG</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>Analysis of double-substrate limited growth</article-title><source>Biotechnology and Bioengineering</source><volume>20</volume><fpage>183</fpage><lpage>202</lpage><pub-id pub-id-type="doi">10.1002/bit.260200203</pub-id><pub-id pub-id-type="pmid">630068</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beardmore</surname> <given-names>RE</given-names></name><name><surname>Gudelj</surname> <given-names>I</given-names></name><name><surname>Lipson</surname> <given-names>DA</given-names></name><name><surname>Hurst</surname> <given-names>LD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Metabolic trade-offs and the maintenance of the fittest and the flattest</article-title><source>Nature</source><volume>472</volume><fpage>342</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1038/nature09905</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blondel</surname> <given-names>VD</given-names></name><name><surname>Guillaume</surname> <given-names>J-L</given-names></name><name><surname>Lambiotte</surname> <given-names>R</given-names></name><name><surname>Lefebvre</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Fast unfolding of communities in large networks</article-title><source>Journal of Statistical Mechanics: Theory and Experiment</source><volume>2008</volume><elocation-id>P10008</elocation-id><pub-id pub-id-type="doi">10.1088/1742-5468/2008/10/P10008</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname> <given-names>TJ</given-names></name><name><surname>Achterberg</surname> <given-names>EP</given-names></name><name><surname>Rapp</surname> <given-names>I</given-names></name><name><surname>Engel</surname> <given-names>A</given-names></name><name><surname>Bertrand</surname> <given-names>EM</given-names></name><name><surname>Tagliabue</surname> <given-names>A</given-names></name><name><surname>Moore</surname> <given-names>CM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Nutrient co-limitation at the boundary of an oceanic gyre</article-title><source>Nature</source><volume>551</volume><fpage>242</fpage><lpage>246</lpage><pub-id pub-id-type="doi">10.1038/nature24063</pub-id><pub-id pub-id-type="pmid">29088696</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname> <given-names>T</given-names></name><name><surname>Diao</surname> <given-names>M</given-names></name><name><surname>Allen</surname> <given-names>RJ</given-names></name><name><surname>Sinnige</surname> <given-names>R</given-names></name><name><surname>Muyzer</surname> <given-names>G</given-names></name><name><surname>Huisman</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Oxic-anoxic regime shifts mediated by feedbacks between biogeochemical processes and microbial community dynamics</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>789</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-017-00912-x</pub-id><pub-id pub-id-type="pmid">28986518</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname> <given-names>S</given-names></name><name><surname>O'Dwyer</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Stability criteria for complex microbial communities</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>2970</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-05308-z</pub-id><pub-id pub-id-type="pmid">30061657</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Camenzind</surname> <given-names>T</given-names></name><name><surname>Hättenschwiler</surname> <given-names>S</given-names></name><name><surname>Treseder</surname> <given-names>KK</given-names></name><name><surname>Lehmann</surname> <given-names>A</given-names></name><name><surname>Rillig</surname> <given-names>MC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Nutrient limitation of soil microbial processes in tropical forests</article-title><source>Ecological Monographs</source><volume>88</volume><fpage>4</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1002/ecm.1279</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Case</surname> <given-names>TJ</given-names></name><name><surname>Casten</surname> <given-names>RG</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Global stability and multiple domains of attraction in ecological systems</article-title><source>The American Naturalist</source><volume>113</volume><fpage>705</fpage><lpage>714</lpage><pub-id pub-id-type="doi">10.1086/283427</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chesson</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>MacArthur's consumer-resource model</article-title><source>Theoretical Population Biology</source><volume>37</volume><fpage>26</fpage><lpage>38</lpage><pub-id pub-id-type="doi">10.1016/0040-5809(90)90025-Q</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cleveland</surname> <given-names>CC</given-names></name><name><surname>Liptzin</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>C:n:P stoichiometry in soil: is there a “Redfield ratio” for the microbial biomass?</article-title><source>Biogeochemistry</source><volume>85</volume><fpage>235</fpage><lpage>252</lpage><pub-id pub-id-type="doi">10.1007/s10533-007-9132-0</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Baar</surname> <given-names>HJW</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Von Liebig's law of the minimum and plankton ecology (1899–1991)</article-title><source>Progress in Oceanography</source><volume>33</volume><fpage>347</fpage><lpage>386</lpage><pub-id pub-id-type="doi">10.1016/0079-6611(94)90022-1</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Dubinkina</surname> <given-names>V</given-names></name><name><surname>Maslov</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>CandN</data-title><source>GitHub</source><version designator="f266961">f266961</version><ext-link ext-link-type="uri" xlink:href="https://github.com/ssm57/CandN">https://github.com/ssm57/CandN</ext-link></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fanin</surname> <given-names>N</given-names></name><name><surname>Hättenschwiler</surname> <given-names>S</given-names></name><name><surname>Chavez Soria</surname> <given-names>PF</given-names></name><name><surname>Fromin</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>(A)synchronous availabilities of N and P regulate the activity and structure of the microbial decomposer community</article-title><source>Frontiers in Microbiology</source><volume>6</volume><elocation-id>1507</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2015.01507</pub-id><pub-id pub-id-type="pmid">26779162</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finkel</surname> <given-names>ZV</given-names></name><name><surname>Follows</surname> <given-names>MJ</given-names></name><name><surname>Liefer</surname> <given-names>JD</given-names></name><name><surname>Brown</surname> <given-names>CM</given-names></name><name><surname>Benner</surname> <given-names>I</given-names></name><name><surname>Irwin</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Phylogenetic diversity in the macromolecular composition of microalgae</article-title><source>PLOS ONE</source><volume>11</volume><elocation-id>e0155977</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0155977</pub-id><pub-id pub-id-type="pmid">27228080</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fukami</surname> <given-names>T</given-names></name><name><surname>Nakajima</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Community assembly: alternative stable states or alternative transient states?</article-title><source>Ecology Letters</source><volume>14</volume><fpage>973</fpage><lpage>984</lpage><pub-id pub-id-type="doi">10.1111/j.1461-0248.2011.01663.x</pub-id><pub-id pub-id-type="pmid">21790934</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gale</surname> <given-names>D</given-names></name><name><surname>Shapley</surname> <given-names>LS</given-names></name></person-group><year iso-8601-date="1962">1962</year><article-title>College admissions and the stability of marriage</article-title><source>The American Mathematical Monthly</source><volume>69</volume><fpage>9</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1080/00029890.1962.11989827</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gause</surname> <given-names>GF</given-names></name></person-group><year iso-8601-date="1932">1932</year><article-title>Experimental studies on the struggle for existence: I. mixed population of two species of yeast</article-title><source>Journal of Experimental Biology</source><volume>9</volume><fpage>389</fpage><lpage>402</lpage></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldford</surname> <given-names>JE</given-names></name><name><surname>Lu</surname> <given-names>N</given-names></name><name><surname>Bajić</surname> <given-names>D</given-names></name><name><surname>Estrela</surname> <given-names>S</given-names></name><name><surname>Tikhonov</surname> <given-names>M</given-names></name><name><surname>Sanchez-Gorostiaga</surname> <given-names>A</given-names></name><name><surname>Segrè</surname> <given-names>D</given-names></name><name><surname>Mehta</surname> <given-names>P</given-names></name><name><surname>Sanchez</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Emergent simplicity in microbial community assembly</article-title><source>Science</source><volume>361</volume><fpage>469</fpage><lpage>474</lpage><pub-id pub-id-type="doi">10.1126/science.aat1168</pub-id><pub-id pub-id-type="pmid">30072533</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonze</surname> <given-names>D</given-names></name><name><surname>Lahti</surname> <given-names>L</given-names></name><name><surname>Raes</surname> <given-names>J</given-names></name><name><surname>Faust</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Multi-stability and the origin of microbial community types</article-title><source>The ISME Journal</source><volume>11</volume><fpage>2159</fpage><lpage>2166</lpage><pub-id pub-id-type="doi">10.1038/ismej.2017.60</pub-id><pub-id pub-id-type="pmid">28475180</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goyal</surname> <given-names>A</given-names></name><name><surname>Dubinkina</surname> <given-names>V</given-names></name><name><surname>Maslov</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Multiple stable states in microbial communities explained by the stable marriage problem</article-title><source>The ISME Journal</source><volume>12</volume><fpage>2823</fpage><lpage>2834</lpage><pub-id pub-id-type="doi">10.1038/s41396-018-0222-x</pub-id><pub-id pub-id-type="pmid">30022156</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grilli</surname> <given-names>J</given-names></name><name><surname>Adorisio</surname> <given-names>M</given-names></name><name><surname>Suweis</surname> <given-names>S</given-names></name><name><surname>Barabás</surname> <given-names>G</given-names></name><name><surname>Banavar</surname> <given-names>JR</given-names></name><name><surname>Allesina</surname> <given-names>S</given-names></name><name><surname>Maritan</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Feasibility and coexistence of large ecological communities</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>14389</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms14389</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gusfield</surname> <given-names>D</given-names></name><name><surname>Irving</surname> <given-names>RW</given-names></name></person-group><year iso-8601-date="1989">1989</year><source>The Stable Marriage Problem: Structure and Algorithms</source><publisher-name>MIT press</publisher-name></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hindmarsh</surname> <given-names>AC</given-names></name><name><surname>Brown</surname> <given-names>PN</given-names></name><name><surname>Grant</surname> <given-names>KE</given-names></name><name><surname>Lee</surname> <given-names>SL</given-names></name><name><surname>Serban</surname> <given-names>R</given-names></name><name><surname>Shumaker</surname> <given-names>DE</given-names></name><name><surname>Woodward</surname> <given-names>CS</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Sundials: suite of nonlinear and differential/algebraic equation solvers</article-title><source>ACM Transactions on Mathematical Software</source><volume>31</volume><fpage>363</fpage><lpage>396</lpage></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holling</surname> <given-names>CS</given-names></name></person-group><year iso-8601-date="1973">1973</year><article-title>Resilience and stability of ecological systems</article-title><source>Annual Review of Ecology and Systematics</source><volume>4</volume><fpage>1</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1146/annurev.es.04.110173.000245</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huisman</surname> <given-names>J</given-names></name><name><surname>Weissing</surname> <given-names>FJ</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Biodiversity of plankton by species oscillations and Chaos</article-title><source>Nature</source><volume>402</volume><fpage>407</fpage><lpage>410</lpage><pub-id pub-id-type="doi">10.1038/46540</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huisman</surname> <given-names>J</given-names></name><name><surname>Weissing</surname> <given-names>FJ</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Biological conditions for oscillations and Chaos generated by multispecies competition</article-title><source>Ecology</source><volume>82</volume><fpage>2682</fpage><lpage>2695</lpage><pub-id pub-id-type="doi">10.1890/0012-9658(2001)082[2682:BCFOAC]2.0.CO;2</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Interlandi</surname> <given-names>SJ</given-names></name><name><surname>Kilham</surname> <given-names>SS</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Limiting resources and the regulation of diversity in phytoplankton communities</article-title><source>Ecology</source><volume>82</volume><fpage>1270</fpage><lpage>1282</lpage><pub-id pub-id-type="doi">10.1890/0012-9658(2001)082[1270:LRATRO]2.0.CO;2</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ives</surname> <given-names>AR</given-names></name><name><surname>Carpenter</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Stability and diversity of ecosystems</article-title><source>Science</source><volume>317</volume><fpage>58</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1126/science.1133258</pub-id><pub-id pub-id-type="pmid">17615333</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kovárová-Kovar</surname> <given-names>K</given-names></name><name><surname>Egli</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Growth kinetics of suspended microbial cells: from single-substrate-controlled growth to mixed-substrate kinetics</article-title><source>Microbiology and Molecular Biology Reviews : MMBR</source><volume>62</volume><fpage>646</fpage><lpage>666</lpage><pub-id pub-id-type="pmid">9729604</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lahti</surname> <given-names>L</given-names></name><name><surname>Salojärvi</surname> <given-names>J</given-names></name><name><surname>Salonen</surname> <given-names>A</given-names></name><name><surname>Scheffer</surname> <given-names>M</given-names></name><name><surname>de Vos</surname> <given-names>WM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Tipping elements in the human intestinal ecosystem</article-title><source>Nature Communications</source><volume>5</volume><elocation-id>4344</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms5344</pub-id><pub-id pub-id-type="pmid">25003530</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lozupone</surname> <given-names>CA</given-names></name><name><surname>Stombaugh</surname> <given-names>JI</given-names></name><name><surname>Gordon</surname> <given-names>JI</given-names></name><name><surname>Jansson</surname> <given-names>JK</given-names></name><name><surname>Knight</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Diversity, stability and resilience of the human gut Microbiota</article-title><source>Nature</source><volume>489</volume><fpage>220</fpage><lpage>230</lpage><pub-id pub-id-type="doi">10.1038/nature11550</pub-id><pub-id pub-id-type="pmid">22972295</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacArthur</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1970">1970</year><article-title>Species packing and competitive equilibrium for many species</article-title><source>Theoretical Population Biology</source><volume>1</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1016/0040-5809(70)90039-0</pub-id><pub-id pub-id-type="pmid">5527624</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacArthur</surname> <given-names>R</given-names></name><name><surname>Levins</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1964">1964</year><article-title>Competition, habitat selection, and character displacement in a patchy environment</article-title><source>PNAS</source><volume>51</volume><fpage>1207</fpage><lpage>1210</lpage><pub-id pub-id-type="doi">10.1073/pnas.51.6.1207</pub-id><pub-id pub-id-type="pmid">14215645</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marsland</surname> <given-names>R</given-names></name><name><surname>Cui</surname> <given-names>W</given-names></name><name><surname>Goldford</surname> <given-names>J</given-names></name><name><surname>Sanchez</surname> <given-names>A</given-names></name><name><surname>Korolev</surname> <given-names>K</given-names></name><name><surname>Mehta</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019a</year><article-title>Available energy fluxes drive a transition in the diversity, stability, and functional structure of microbial communities</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1006793</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006793</pub-id><pub-id pub-id-type="pmid">30721227</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Marsland</surname> <given-names>R</given-names></name> <name><surname>Cui</surname> <given-names>W</given-names></name><name><surname>Mehta</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019b</year><article-title>The minimum environmental perturbation principle: a new perspective on niche theory</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1901.09673">https://arxiv.org/abs/1901.09673</ext-link></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>May</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Will a large complex system be stable?</article-title><source>Nature</source><volume>238</volume><fpage>413</fpage><lpage>414</lpage><pub-id pub-id-type="doi">10.1038/238413a0</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>May</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Thresholds and breakpoints in ecosystems with a multiplicity of stable states</article-title><source>Nature</source><volume>269</volume><fpage>471</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1038/269471a0</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mello</surname> <given-names>BL</given-names></name><name><surname>Alessi</surname> <given-names>AM</given-names></name><name><surname>McQueen-Mason</surname> <given-names>S</given-names></name><name><surname>Bruce</surname> <given-names>NC</given-names></name><name><surname>Polikarpov</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Nutrient availability shapes the microbial community structure in sugarcane bagasse compost-derived consortia</article-title><source>Scientific Reports</source><volume>6</volume><elocation-id>38781</elocation-id><pub-id pub-id-type="doi">10.1038/srep38781</pub-id><pub-id pub-id-type="pmid">27941835</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Milnor</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1963">1963</year><source>Morse Theory</source><publisher-name>Princeton university press</publisher-name></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mouginot</surname> <given-names>C</given-names></name><name><surname>Kawamura</surname> <given-names>R</given-names></name><name><surname>Matulich</surname> <given-names>KL</given-names></name><name><surname>Berlemont</surname> <given-names>R</given-names></name><name><surname>Allison</surname> <given-names>SD</given-names></name><name><surname>Amend</surname> <given-names>AS</given-names></name><name><surname>Martiny</surname> <given-names>AC</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Elemental stoichiometry of Fungi and Bacteria strains from grassland leaf litter</article-title><source>Soil Biology and Biochemistry</source><volume>76</volume><fpage>278</fpage><lpage>285</lpage><pub-id pub-id-type="doi">10.1016/j.soilbio.2014.05.011</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Novak</surname> <given-names>M</given-names></name><name><surname>Pfeiffer</surname> <given-names>T</given-names></name><name><surname>Lenski</surname> <given-names>RE</given-names></name><name><surname>Sauer</surname> <given-names>U</given-names></name><name><surname>Bonhoeffer</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Experimental tests for an evolutionary trade-off between growth rate and yield in <italic>E. coli</italic></article-title><source>The American Naturalist</source><volume>168</volume><fpage>242</fpage><lpage>251</lpage><pub-id pub-id-type="doi">10.1086/506527</pub-id><pub-id pub-id-type="pmid">16874633</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pagaling</surname> <given-names>E</given-names></name><name><surname>Vassileva</surname> <given-names>K</given-names></name><name><surname>Mills</surname> <given-names>CG</given-names></name><name><surname>Bush</surname> <given-names>T</given-names></name><name><surname>Blythe</surname> <given-names>RA</given-names></name><name><surname>Schwarz-Linek</surname> <given-names>J</given-names></name><name><surname>Strathdee</surname> <given-names>F</given-names></name><name><surname>Allen</surname> <given-names>RJ</given-names></name><name><surname>Free</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Assembly of microbial communities in replicate nutrient-cycling model ecosystems follows divergent trajectories, leading to alternate stable states</article-title><source>Environmental Microbiology</source><volume>19</volume><fpage>3374</fpage><lpage>3386</lpage><pub-id pub-id-type="doi">10.1111/1462-2920.13849</pub-id><pub-id pub-id-type="pmid">28677203</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname> <given-names>T</given-names></name><name><surname>Schuster</surname> <given-names>S</given-names></name><name><surname>Bonhoeffer</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Cooperation and competition in the evolution of ATP-producing pathways</article-title><source>Science</source><volume>292</volume><fpage>504</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1126/science.1058079</pub-id><pub-id pub-id-type="pmid">11283355</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Posfai</surname> <given-names>A</given-names></name><name><surname>Taillefumier</surname> <given-names>T</given-names></name><name><surname>Wingreen</surname> <given-names>NS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Metabolic Trade-Offs promote diversity in a model ecosystem</article-title><source>Physical Review Letters</source><volume>118</volume><elocation-id>028103</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.118.028103</pub-id><pub-id pub-id-type="pmid">28128613</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Redfield</surname> <given-names>AC</given-names></name></person-group><year iso-8601-date="1958">1958</year><article-title>The biological control of chemical factors in the environment</article-title><source>American Scientist</source><volume>46</volume><fpage>205</fpage><lpage>221</lpage></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reese</surname> <given-names>AT</given-names></name><name><surname>Pereira</surname> <given-names>FC</given-names></name><name><surname>Schintlmeister</surname> <given-names>A</given-names></name><name><surname>Berry</surname> <given-names>D</given-names></name><name><surname>Wagner</surname> <given-names>M</given-names></name><name><surname>Hale</surname> <given-names>LP</given-names></name><name><surname>Wu</surname> <given-names>A</given-names></name><name><surname>Jiang</surname> <given-names>S</given-names></name><name><surname>Durand</surname> <given-names>HK</given-names></name><name><surname>Zhou</surname> <given-names>X</given-names></name><name><surname>Premont</surname> <given-names>RT</given-names></name><name><surname>Diehl</surname> <given-names>AM</given-names></name><name><surname>O'Connell</surname> <given-names>TM</given-names></name><name><surname>Alberts</surname> <given-names>SC</given-names></name><name><surname>Kartzinel</surname> <given-names>TR</given-names></name><name><surname>Pringle</surname> <given-names>RM</given-names></name><name><surname>Dunn</surname> <given-names>RR</given-names></name><name><surname>Wright</surname> <given-names>JP</given-names></name><name><surname>David</surname> <given-names>LA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Microbial nitrogen limitation in the mammalian large intestine</article-title><source>Nature Microbiology</source><volume>3</volume><fpage>1441</fpage><lpage>1450</lpage><pub-id pub-id-type="doi">10.1038/s41564-018-0267-7</pub-id><pub-id pub-id-type="pmid">30374168</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rocha</surname> <given-names>JC</given-names></name><name><surname>Peterson</surname> <given-names>G</given-names></name><name><surname>Bodin</surname> <given-names>Ö</given-names></name><name><surname>Levin</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Cascading regime shifts within and across scales</article-title><source>Science</source><volume>362</volume><fpage>1379</fpage><lpage>1383</lpage><pub-id pub-id-type="doi">10.1126/science.aat7850</pub-id><pub-id pub-id-type="pmid">30573623</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rohr</surname> <given-names>RP</given-names></name><name><surname>Saavedra</surname> <given-names>S</given-names></name><name><surname>Bascompte</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>On the structural stability of mutualistic systems</article-title><source>Science</source><volume>345</volume><elocation-id>1253497</elocation-id><pub-id pub-id-type="doi">10.1126/science.1253497</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheffer</surname> <given-names>M</given-names></name><name><surname>Carpenter</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Catastrophic regime shifts in ecosystems: linking theory to observation</article-title><source>Trends in Ecology &amp; Evolution</source><volume>18</volume><fpage>648</fpage><lpage>656</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2003.09.002</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheffer</surname> <given-names>M</given-names></name><name><surname>Jeppesen</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Regime shifts in shallow lakes</article-title><source>Ecosystems</source><volume>10</volume><fpage>1</fpage><lpage>3</lpage><pub-id pub-id-type="doi">10.1007/s10021-006-9002-y</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schröder</surname> <given-names>A</given-names></name><name><surname>Persson</surname> <given-names>L</given-names></name><name><surname>De Roos</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Direct experimental evidence for alternative stable states: a review</article-title><source>Oikos</source><volume>110</volume><fpage>3</fpage><lpage>19</lpage><pub-id pub-id-type="doi">10.1111/j.0030-1299.2005.13962.x</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Serván</surname> <given-names>CA</given-names></name><name><surname>Capitán</surname> <given-names>JA</given-names></name><name><surname>Grilli</surname> <given-names>J</given-names></name><name><surname>Morrison</surname> <given-names>KE</given-names></name><name><surname>Allesina</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Coexistence of many species in random ecosystems</article-title><source>Nature Ecology &amp; Evolution</source><volume>2</volume><fpage>1237</fpage><lpage>1242</lpage><pub-id pub-id-type="doi">10.1038/s41559-018-0603-6</pub-id><pub-id pub-id-type="pmid">29988167</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shade</surname> <given-names>A</given-names></name><name><surname>Peter</surname> <given-names>H</given-names></name><name><surname>Allison</surname> <given-names>SD</given-names></name><name><surname>Baho</surname> <given-names>DL</given-names></name><name><surname>Berga</surname> <given-names>M</given-names></name><name><surname>Bürgmann</surname> <given-names>H</given-names></name><name><surname>Huber</surname> <given-names>DH</given-names></name><name><surname>Langenheder</surname> <given-names>S</given-names></name><name><surname>Lennon</surname> <given-names>JT</given-names></name><name><surname>Martiny</surname> <given-names>JB</given-names></name><name><surname>Matulich</surname> <given-names>KL</given-names></name><name><surname>Schmidt</surname> <given-names>TM</given-names></name><name><surname>Handelsman</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Fundamentals of microbial community resistance and resilience</article-title><source>Frontiers in Microbiology</source><volume>3</volume><elocation-id>417</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2012.00417</pub-id><pub-id pub-id-type="pmid">23267351</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shoresh</surname> <given-names>N</given-names></name><name><surname>Hegreness</surname> <given-names>M</given-names></name><name><surname>Kishony</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Evolution exacerbates the paradox of the plankton</article-title><source>PNAS</source><volume>105</volume><fpage>12365</fpage><lpage>12369</lpage><pub-id pub-id-type="doi">10.1073/pnas.0803032105</pub-id><pub-id pub-id-type="pmid">18713864</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sutherland</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>Multiple stable points in natural communities</article-title><source>The American Naturalist</source><volume>108</volume><fpage>859</fpage><lpage>873</lpage><pub-id pub-id-type="doi">10.1086/282961</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taillefumier</surname> <given-names>T</given-names></name><name><surname>Posfai</surname> <given-names>A</given-names></name><name><surname>Meir</surname> <given-names>Y</given-names></name><name><surname>Wingreen</surname> <given-names>NS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Microbial consortia at steady supply</article-title><source>eLife</source><volume>6</volume><elocation-id>e22644</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.22644</pub-id><pub-id pub-id-type="pmid">28473032</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tikhonov</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Community-level cohesion without cooperation</article-title><source>eLife</source><volume>5</volume><elocation-id>e15747</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.15747</pub-id><pub-id pub-id-type="pmid">27310530</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tikhonov</surname> <given-names>M</given-names></name><name><surname>Monasson</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Collective phase in resource competition in a highly diverse ecosystem</article-title><source>Physical Review Letters</source><volume>118</volume><elocation-id>048103</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.118.048103</pub-id><pub-id pub-id-type="pmid">28186794</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tilman</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Resource competition and community structure</article-title><source>Monographs in Population Biology</source><volume>17</volume><fpage>1</fpage><lpage>296</lpage><pub-id pub-id-type="pmid">7162524</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tilman</surname> <given-names>D</given-names></name><name><surname>Lehman</surname> <given-names>CL</given-names></name><name><surname>Thomson</surname> <given-names>KT</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Plant diversity and ecosystem productivity: theoretical considerations</article-title><source>PNAS</source><volume>94</volume><fpage>1857</fpage><lpage>1861</lpage><pub-id pub-id-type="doi">10.1073/pnas.94.5.1857</pub-id><pub-id pub-id-type="pmid">11038606</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tkachenko</surname> <given-names>AV</given-names></name><name><surname>Maslov</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Onset of natural selection in populations of autocatalytic heteropolymers</article-title><source>The Journal of Chemical Physics</source><volume>149</volume><elocation-id>134901</elocation-id><pub-id pub-id-type="doi">10.1063/1.5048488</pub-id><pub-id pub-id-type="pmid">30292218</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname> <given-names>X</given-names></name><name><surname>Brown</surname> <given-names>CJ</given-names></name><name><surname>Abdo</surname> <given-names>Z</given-names></name><name><surname>Davis</surname> <given-names>CC</given-names></name><name><surname>Hansmann</surname> <given-names>MA</given-names></name><name><surname>Joyce</surname> <given-names>P</given-names></name><name><surname>Foster</surname> <given-names>JA</given-names></name><name><surname>Forney</surname> <given-names>LJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Differences in the composition of vaginal microbial communities found in healthy caucasian and black women</article-title><source>The ISME Journal</source><volume>1</volume><fpage>121</fpage><lpage>133</lpage><pub-id pub-id-type="doi">10.1038/ismej.2007.12</pub-id><pub-id pub-id-type="pmid">18043622</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname> <given-names>J</given-names></name><name><surname>Liu</surname> <given-names>W</given-names></name><name><surname>Deng</surname> <given-names>Y</given-names></name><name><surname>Jiang</surname> <given-names>YH</given-names></name><name><surname>Xue</surname> <given-names>K</given-names></name><name><surname>He</surname> <given-names>Z</given-names></name><name><surname>Van Nostrand</surname> <given-names>JD</given-names></name><name><surname>Wu</surname> <given-names>L</given-names></name><name><surname>Yang</surname> <given-names>Y</given-names></name><name><surname>Wang</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Stochastic assembly leads to alternative communities with distinct functions in a bioreactor microbial community</article-title><source>mBio</source><volume>4</volume><elocation-id>e00584-12</elocation-id><pub-id pub-id-type="doi">10.1128/mBio.00584-12</pub-id><pub-id pub-id-type="pmid">23462114</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s8" sec-type="appendix"><title>General form of growth laws</title><p>It is straightforward to generalize our model to allow a more general functional form for growth laws than Liebig’s law, <inline-formula><mml:math id="inf223"><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Microbial growth on two essential substrates is thought to normally follow Monod’s equation for the rate-limiting nutrient: <inline-formula><mml:math id="inf224"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (See <xref ref-type="bibr" rid="bib30">Kovárová-Kovar and Egli, 1998</xref> for a discussion of limitations of Monod’s law). For low concentrations of the rate-limiting nutrient, say carbon source, the Monod’s law simplifies to the linear growth law used throughout this study: <inline-formula><mml:math id="inf225"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Microbes’ competitive abilities, also known as their specific affinities towards each substrate, are related to the parameters of Monod’s law via<disp-formula id="equ8"><label>(S1)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>g</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>K</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow><mml:mo rspace="12.5pt">;</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>g</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>K</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>In another variant of growth laws, two essential nutrients at low concentrations jointly affect the growth rate of the microbe: <inline-formula><mml:math id="inf226"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="bibr" rid="bib2">Bader, 1978</xref> for a discussion of these and other forms of double-substrate growth law). For simplicity of mathematical calculation we limited this study to Liebig’s law. However, many of the essential results we obtained (e. g. possible multistability in a system where species have different yields) hold for any growth laws listed above. In fact, the low concentration version of the previous growth law, where <inline-formula><mml:math id="inf227"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> has been studied by one of us in the context of autocatalytic growth of heteropolymers (<xref ref-type="bibr" rid="bib62">Tkachenko and Maslov, 2018</xref>). Instead of exponentially replicating microbial species <xref ref-type="bibr" rid="bib62">Tkachenko and Maslov (2018)</xref> considers pairs of mutually catalytic (and thus exponentially growing) complementary ‘2-mers’ (a specific sequence of two consecutive monomers anywhere within a polymer chain). This minor difference complicates the math, while leaving the basic properties unchanged. Just like in our system, where up to <inline-formula><mml:math id="inf228"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> species (out of <inline-formula><mml:math id="inf229"><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> candidates) may simultaneously survive in the steady state of an ecosystem grown on of <inline-formula><mml:math id="inf230"><mml:mi>L</mml:mi></mml:math></inline-formula> carbon and <inline-formula><mml:math id="inf231"><mml:mi>L</mml:mi></mml:math></inline-formula> nitrogen sources, the polymer systems have no more than <inline-formula><mml:math id="inf232"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> 2-mer ‘species’ (out of <inline-formula><mml:math id="inf233"><mml:msup><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> candidates) surviving in the steady state with polymers having <inline-formula><mml:math id="inf234"><mml:mi>Z</mml:mi></mml:math></inline-formula> possible monomers on their right ends and <inline-formula><mml:math id="inf235"><mml:mi>Z</mml:mi></mml:math></inline-formula> possible monomers on their left ends. Many (but not all) results of this paper are largely consistent with the present study. Note that for polymers the yields of all ‘species’ are equal to 1, that is to say, one new 2-mer is formed upon ligation of one left end of a polymer with one right of another polymer chain. Yet, the model in <xref ref-type="bibr" rid="bib62">Tkachenko and Maslov (2018)</xref> is capable of (at least) bistability. At present, it is not clear if this is due to autocatalytic cycles having length two or this property would survive in a simpler version of the model in which instead of the Equation (1) of <xref ref-type="bibr" rid="bib62">Tkachenko and Maslov (2018)</xref> one has<disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>and the overall fluxes of left and right ends are independent from each other (instead of both being equal to <inline-formula><mml:math id="inf236"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> as in <xref ref-type="bibr" rid="bib62">Tkachenko and Maslov, 2018</xref>).</p><p>Another variant of the model is where each species <inline-formula><mml:math id="inf237"><mml:mi>α</mml:mi></mml:math></inline-formula> has its own unique ‘death’ or ‘maintenance’ rate <inline-formula><mml:math id="inf238"><mml:msub><mml:mi>δ</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula>, playing the role of the same dilution rate <inline-formula><mml:math id="inf239"><mml:mi>δ</mml:mi></mml:math></inline-formula>. The steady states of this model (but not the dynamics leading to these states) can be calculated by dividing both sides of <xref ref-type="disp-formula" rid="equ2">Equations 2</xref> by <inline-formula><mml:math id="inf240"><mml:msub><mml:mi>δ</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula>. This is equivalent by redefining the competitiveness parameters to <inline-formula><mml:math id="inf241"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>λ</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and setting the chemostat dilution rate to <inline-formula><mml:math id="inf242"><mml:mrow><mml:mover accent="true"><mml:mi>δ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. All of our results in the high-flux regime <inline-formula><mml:math id="inf243"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>≫</mml:mo><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> would remain unchanged.</p><p>From (<xref ref-type="disp-formula" rid="equ6">Equation 5</xref>-<xref ref-type="disp-formula" rid="equ7">Equation 6</xref>) one can see that when all species have the same C:N stoichiometry, the maximal number of microbialspecies in a state is equal to the number of nutrients minus 1. Indeed, one can show that a state <inline-formula><mml:math id="inf244"><mml:mi>p</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf245"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> has <inline-formula><mml:math id="inf246"><mml:mrow><mml:mrow><mml:mo>det</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>R</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, which means that the feasible volume of any such state is zero. These states are only possible on a lower-dimensional manifold in the <inline-formula><mml:math id="inf247"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>-dimensional space of supply rates (these results have been already discussed by Tilman in his special case; <xref ref-type="bibr" rid="bib60">Tilman, 1982</xref>).</p><p>Multistability is also possible in a variant of the MacArthur model (<xref ref-type="bibr" rid="bib34">MacArthur and Levins, 1964</xref>; <xref ref-type="bibr" rid="bib33">MacArthur, 1970</xref>; <xref ref-type="bibr" rid="bib10">Chesson, 1990</xref>) in which different species have different yields on individual carbon sources (Maslov, unpublished). A convex Lyapunov function (<xref ref-type="bibr" rid="bib33">MacArthur, 1970</xref>) precluding multistability does not exist in this case.</p></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><sec id="s9" sec-type="appendix"><title>Constraints on steady states from microbial and nutrient dynamics</title><p>A steady state of equations describing the microbial dynamics (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>) is realized when either <inline-formula><mml:math id="inf248"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (the species was absent from the system from the start or subsequently went extinct) or when its growth rate <inline-formula><mml:math id="inf249"><mml:msub><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula> is exactly equal to the chemostat dilution rate <inline-formula><mml:math id="inf250"><mml:mi>δ</mml:mi></mml:math></inline-formula>. This imposes constraints on steady state nutrient concentrations with the number of constraints equal to the number of microbial species present with non-zero concentrations. Since, in general, the number of constraints cannot be larger than the number of constrained variables, no more than <inline-formula><mml:math id="inf251"><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> of species could be simultaneously present in a steady state of the ecosystem. For Liebig’s growth law used in this study, each resource can have no more than one species for which this resource limits its growth, that is to say, which sets the value of the minimum in <inline-formula><mml:math id="inf252"><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> The steady state concentrations of these resources are given by <inline-formula><mml:math id="inf253"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> (if the growth is limited by the carbon source) and <inline-formula><mml:math id="inf254"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> (if the growth is limited by the nitrogen source). Here <inline-formula><mml:math id="inf255"><mml:mi>α</mml:mi></mml:math></inline-formula> is the species whose growth is rate-limited by the resource in question. In a general case, no more than one species can be limited by the same resource (carbon in our example), since the species with the largest <inline-formula><mml:math id="inf256"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> would outcompete other species with smaller values of <inline-formula><mml:math id="inf257"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> by making the steady state concentration <inline-formula><mml:math id="inf258"><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> so low that other species can no longer grow on it. Note however, that multiple species <inline-formula><mml:math id="inf259"><mml:mi>β</mml:mi></mml:math></inline-formula> could consume the same resource as the rate-limiting species <inline-formula><mml:math id="inf260"><mml:mi>α</mml:mi></mml:math></inline-formula>, as long as their growth is not limited by the resource. Each of these species must then be limited by their other nutrient (a nitrogen source in our example). However, their survival requires that carbon concentration set by species <inline-formula><mml:math id="inf261"><mml:mi>α</mml:mi></mml:math></inline-formula> is sufficient for their growth. Thereby, any species growing on a resource in a non-limited fashion must have <inline-formula><mml:math id="inf262"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p><p>Mathematically, it cane be proven by observing that, since species <inline-formula><mml:math id="inf263"><mml:mi>β</mml:mi></mml:math></inline-formula> is limited by its nitrogen resource, one must have <inline-formula><mml:math id="inf264"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. At the same time in a steady state, the concentrations of all rate-limiting resources are determined by the dilution rate <inline-formula><mml:math id="inf265"><mml:mi>δ</mml:mi></mml:math></inline-formula> via <inline-formula><mml:math id="inf266"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf267"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></inline-formula>. Combining the above three expressions one gets: <inline-formula><mml:math id="inf268"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, or simply <inline-formula><mml:math id="inf269"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. The constraints on competitive abilities <inline-formula><mml:math id="inf270"><mml:mi>λ</mml:mi></mml:math></inline-formula> for species present in a steady state in our model are then:</p><list list-type="bullet"><list-item><p>Exclusion Rule 1: Each nutrient (either carbon or nitrogen source) can limit the growth of no more than one species <inline-formula><mml:math id="inf271"><mml:mi>α</mml:mi></mml:math></inline-formula>. From this it follows that the number of species co-existing in any given steady state cannot be larger than <inline-formula><mml:math id="inf272"><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>, the total number of nutrients.</p></list-item><list-item><p>Exclusion Rule 2: Each nutrient (e.g. specific carbon source) can be used by any number of species in a non-rate-limiting fashion (that is to say, where it does not constrain species growth in Liebig’s law). However, any such species <inline-formula><mml:math id="inf273"><mml:mi>β</mml:mi></mml:math></inline-formula> has to have <inline-formula><mml:math id="inf274"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf275"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is the competitive ability of the species whose growth is limited by this nutrient. In case of a nitrogen nutrient, the constraint becomes <inline-formula><mml:math id="inf276"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p></list-item></list><p>Note that the steady state solutions of equations <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> do not depend on populations <inline-formula><mml:math id="inf277"><mml:msub><mml:mi>B</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula> of surviving species. Their steady state populations <inline-formula><mml:math id="inf278"><mml:msubsup><mml:mi>B</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> are instead determined by <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>. Taking into account that, in a steady state, the growth rate of each surviving species is exactly equal to the dilution rate <inline-formula><mml:math id="inf279"><mml:mi>δ</mml:mi></mml:math></inline-formula> of the chemostat, after simplifications one gets:<disp-formula id="equ10"><label>(S2)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∗</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>α</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/></mml:mrow><mml:msub><mml:mi mathvariant="normal">c</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∗</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∗</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>α</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∗</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>As described above, the steady state concentration of resources are given by <inline-formula><mml:math id="inf280"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>c or n</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf281"><mml:mi>α</mml:mi></mml:math></inline-formula> are the species rate-limited by each resource. In the absence of such species, the concentration of a resource is given by anything left after it being consumed by surviving species in a non-rate-limiting manner. One can show that in this case, the resource (e.g. carbon) concentration has to be larger than <inline-formula><mml:math id="inf282"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf283"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is the smallest affinity among microbes utilizing this resource.</p><p>One convenient approximation greatly simplifying working with <xref ref-type="disp-formula" rid="equ10">Equation S2</xref> is the ‘high-flux limit’ in which <inline-formula><mml:math id="inf284"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>≫</mml:mo><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf285"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>≫</mml:mo><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. In this approximation one can approximately set to zero the steady state concentrations of all resources that have a species rate-limited by them. The steady state concentrations of the remaining resources can take any value as long as it is positive. Hence, in this limit the <xref ref-type="disp-formula" rid="equ10">Equation S2</xref> can be viewed as a simple matrix test of whether a given set of surviving species limited by a given set of resources is possible for a given set of nutrient fluxes. Indeed, my multiplying the vector of fluxes with the inverse of the matrix <inline-formula><mml:math id="inf286"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> composed of inverse yields of surviving species and one for nutrients not limiting the growth of any species one formally gets the only possible set of steady state species abundances, <inline-formula><mml:math id="inf287"><mml:msubsup><mml:mi>B</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>, and a subset of non-limiting resource concentrations <inline-formula><mml:math id="inf288"><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf289"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>. If all of them are strictly positive - the steady state is possible. If just one of them enters the negative territory - the steady state cannot be realized for these fluxes of nutrients.</p><p>The above rule can be modified to apply even below the high-flux limit with the following modifications: 1) Instead of <inline-formula><mml:math id="inf290"><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> (or <inline-formula><mml:math id="inf291"><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>), one uses their ‘effective values’ <inline-formula><mml:math id="inf292"><mml:msup><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> (or <inline-formula><mml:math id="inf293"><mml:msup><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>) introduced in <xref ref-type="bibr" rid="bib21">Goyal et al. (2018)</xref>, determined as<disp-formula id="equ11"><label>(S3)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mspace width="1em"/><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf294"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the (unique) species limited by the nutrient <inline-formula><mml:math id="inf295"><mml:mi>i</mml:mi></mml:math></inline-formula>. If the nutrient is not limiting for any os the species in the steady state, <inline-formula><mml:math id="inf296"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the species using the nutrient in a non-limited fashion, which has the <italic>smallest</italic> value of <inline-formula><mml:math id="inf297"><mml:mi>λ</mml:mi></mml:math></inline-formula>. This last rule comes from the observation that in order for a non-limiting resource not to become limiting for a species <inline-formula><mml:math id="inf298"><mml:mi>β</mml:mi></mml:math></inline-formula> currently using it in a non-limiting fashion, its concentration cannot fall below <inline-formula><mml:math id="inf299"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. Thus, when checking the feasibility of a given state, the concentration of a non-limiting resource can be written as <inline-formula><mml:math id="inf300"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:math></inline-formula> a positive number, or (more conveniently) the influx of this resource can be offset as described in <xref ref-type="disp-formula" rid="equ11">Equation S3</xref></p></sec></boxed-text></app><app id="appendix-3"><title>Appendix 3</title><boxed-text><sec id="s10" sec-type="appendix"><title>Stable matching approach for identification and classification of steady states</title><p>First we describe the exact one-to-one mapping between all uninvadable steady states (UIS) in our model and the complete set of ‘stable marriages’ in a variant of a well-known stable marriage or stable allocation problem developed by Gale and Shapley in the 1960s (<xref ref-type="bibr" rid="bib17">Gale and Shapley, 1962</xref>) and awarded the Nobel prize in economics in 2012. This mapping provides us with constructive algorithms to identify and count all uninvadable steady states in our ecosystem.</p><p>We start by considering a special case of our problem with <inline-formula><mml:math id="inf301"><mml:mi>L</mml:mi></mml:math></inline-formula> carbon and <inline-formula><mml:math id="inf302"><mml:mi>L</mml:mi></mml:math></inline-formula> nitrogen sources and a pool of <inline-formula><mml:math id="inf303"><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> species, such that for every pair of sources <inline-formula><mml:math id="inf304"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> (carbon) and <inline-formula><mml:math id="inf305"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> (nitrogen) there is exactly one microbe <inline-formula><mml:math id="inf306"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> capable of using them. For the sake of simplicity we have switched the notation from <inline-formula><mml:math id="inf307"><mml:msub><mml:mi>B</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf308"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, where <inline-formula><mml:math id="inf309"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the unique microbe in our pool capable of growing on <inline-formula><mml:math id="inf310"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf311"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>. Having considered this simpler situation we will return to the most general case of unequal numbers of carbon (<inline-formula><mml:math id="inf312"><mml:mi>K</mml:mi></mml:math></inline-formula>) and nitrogen (<inline-formula><mml:math id="inf313"><mml:mi>M</mml:mi></mml:math></inline-formula>) resources and any number of microbes from a pool of <inline-formula><mml:math id="inf314"><mml:mi>S</mml:mi></mml:math></inline-formula> species competing for a given pair of resources.</p><p>This is where we need to revise in certain ways the network representation of a steady state used in the main text (see <xref ref-type="fig" rid="fig1">Figure 1A</xref>). In the marriage game related theory, the notion of (stable or unstable) matching explicitly refers to a bipartite graph with two distinct sets of vertices and edges arranged in such a way that each one may join only a pair of elements belonging to different sets. In our case, it is natural to consider two sets of resource nodes (vertices), one including all carbon nodes and the other one containing all nitrogen nodes. An edge, or link, will appear between a carbon <inline-formula><mml:math id="inf315"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and nitrogen <inline-formula><mml:math id="inf316"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> node if the microbe <inline-formula><mml:math id="inf317"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> using these two nutrients is present in the state represented by this particular bipartite network.</p><p>Furthermore, the specifics of our version of 'marriage game’, or rather 'residents vs hospitals’, problem requires us to consider <italic>directed</italic> bipartite graphs as the steady state representations in our model. For any species <inline-formula><mml:math id="inf318"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> present in a given state, we choose the direction of the edge joining node <inline-formula><mml:math id="inf319"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> with node <inline-formula><mml:math id="inf320"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> to be pointing from <inline-formula><mml:math id="inf321"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf322"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> if the microbe is limited by its carbon nutrient (and the other way around, from <inline-formula><mml:math id="inf323"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf324"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, on the case of <inline-formula><mml:math id="inf325"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> being nitrogen-limited). <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1A</xref> shows the directed bipartite graph representation of the state #5 of a particular example of 2C × 2N × 4S system considered in the 'Results’ section of the main text.</p><p>In what follows we will refer to a resource as <italic>occupied</italic> if in a given steady state there is a microbe for which this resource is rate-limiting. In our bipartite network representation occupied resources have an outgoing edge (their out-degree is equal to 1), while unoccupied resources have out-degree equal to 0.</p><sec id="s10-1"><title>Review of results about stable matchings in the hospitals/residents problem</title><p>The hospitals/residents problem (<xref ref-type="bibr" rid="bib17">Gale and Shapley, 1962</xref>) is known in various settings. The one directly relevant to our problem is the following. There are <inline-formula><mml:math id="inf326"><mml:mi>L</mml:mi></mml:math></inline-formula> applicants for residency positions in <inline-formula><mml:math id="inf327"><mml:mrow><mml:mi>H</mml:mi><mml:mo>≤</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> hospitals. A hospital number <inline-formula><mml:math id="inf328"><mml:mi>i</mml:mi></mml:math></inline-formula> has <inline-formula><mml:math id="inf329"><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> vacancies for residents to fill, <inline-formula><mml:math id="inf330"><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> ranging from zero to <inline-formula><mml:math id="inf331"><mml:mi>L</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf332"><mml:mrow><mml:mrow><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. Each hospital has a list of preferences in which residency applicants are strictly ordered by their ranks, from 1 (the most desirable) to <inline-formula><mml:math id="inf333"><mml:mi>L</mml:mi></mml:math></inline-formula> , (the least desirable). These lists are generally different for different hospitals. Each applicant has a ranked list of preferred hospitals ranging from 1 (the most desirable) to <inline-formula><mml:math id="inf334"><mml:mi>H</mml:mi></mml:math></inline-formula> (the least desirable). Those lists can also vary between applicants. A <italic>matching</italic> is an assignment of applicants to hospitals such that all applicants got residency and all hospital vacancies are filled. A matching is <italic>unstable</italic> if there is at least one applicant <inline-formula><mml:math id="inf335"><mml:mi>a</mml:mi></mml:math></inline-formula> and hospital <inline-formula><mml:math id="inf336"><mml:mi>h</mml:mi></mml:math></inline-formula> to which <inline-formula><mml:math id="inf337"><mml:mi>a</mml:mi></mml:math></inline-formula> is not assigned such that:</p><list list-type="order"><list-item><p>Condition 1. Applicant <inline-formula><mml:math id="inf338"><mml:mi>a</mml:mi></mml:math></inline-formula> prefers hospital <inline-formula><mml:math id="inf339"><mml:mi>h</mml:mi></mml:math></inline-formula> to his/her assigned hospital;</p></list-item><list-item><p>Condition 2. Hospital <inline-formula><mml:math id="inf340"><mml:mi>h</mml:mi></mml:math></inline-formula> prefers applicant <inline-formula><mml:math id="inf341"><mml:mi>a</mml:mi></mml:math></inline-formula> to at least one of its assigned applicants.</p></list-item></list><p>If such a pair <inline-formula><mml:math id="inf342"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> exists, it is called ‘a blocking pair’ or ‘a pair that blocks the matching’. A <italic>stable</italic> matching by definition has no blocking pairs. Gale and Shapley proved that for any set of applicant/hospital rankings and hospital vacancies there is at least one stable matching (<xref ref-type="bibr" rid="bib17">Gale and Shapley, 1962</xref>). Generally the number of stable matching is larger than one. For example, for stable marriages and random rankings the average number of stable matchings is given by <inline-formula><mml:math id="inf343"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib23">Gusfield and Irving, 1989</xref>). To the best of our knowledge, the dependence of this number on the distribution of hospital vacancies has not been investigated. The fact that the actual number of uninvadable states is rather close to its lower bound indicates that, at least for <inline-formula><mml:math id="inf344"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≤</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula>, the number of stable matchings averaged over all possible in-degree allocations is rather close to 1.</p><p>Gale and Shapely not only proved the existence of at least one stable matching, but also proposed a constructive algorithm on how to find it. Listed below are the main steps in this algorithm optimized for for applicants. Each applicant first submits his/her application to the hospital ranking 1 in his/her preference lists. Each hospital considers all applications it received so far and accepts all of the applicants if their number is less or equal than hospital’s announced number of vacancies, <inline-formula><mml:math id="inf345"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. If the number of applicants exceeds <inline-formula><mml:math id="inf346"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, the hospital gives a conditional admission to the best-ranking <inline-formula><mml:math id="inf347"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> applicants according to hospital’s own preference list. Each applicant not admitted to their top hospital goes a step down on his/her preference list and applies to the second-best hospital. The latter admits this applicant if (1) this hospital has not yet filled all of its vacancies or (2) all vacancies are filled, but among the conditionally admitted applicants there is at least one who ranks lower (according to hospital’s list) than the new applicant. Such lower-ranked applicants are declined admission and replaced with better ones. They subsequently lower their expectations and apply to the next hospital on their list. After a number of iterations all applicants are admitted and all vacancies are filled so that this process stops. As <xref ref-type="bibr" rid="bib17">Gale and Shapley (1962)</xref> proved, the resulting matching is stable. Furthermore, the theorem states that in this matching every applicant gets admitted to the best hospital among all stable matchings, while every hospital gets the worst set of residents among all stable matchings. Later research described in <xref ref-type="bibr" rid="bib23">Gusfield and Irving (1989)</xref> describe more complex constructive algorithms allowing one to efficiently find all of the stable matchings starting with the applicant-optimal one.</p><p>Well developed mathematical apparatus of stable matching problem provides an invaluable help in the task of identifying all uninvadable states in microbial ecosystems. Indeed, without its assistance this task would require exponentially long time. To connect the problem of finding all uninvadable states to that of finding all stable matchings between hospitals and residents, we start with the following three observations:</p><list list-type="order"><list-item><p>In any uninvadable steady state, either all carbon sources or all nitrogen sources (or both) are occupied. Indeed, if in a steady state a carbon source <inline-formula><mml:math id="inf348"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and a nitrogen source <inline-formula><mml:math id="inf349"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> are not-limiting to any microbes, then microbe <inline-formula><mml:math id="inf350"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can always grow and thereby invade this state. Thus uninvadable states can be counted separately: one first counts the states where all nitrogen sources are occupied, and then counts those in which all carbon sources are occupied. Double counting happens when both carbon and all nitrogen sources are occupied. We will keep the possibility of double counting in mind and return to this problem later.</p></list-item><list-item><p>For a pool of species, where for every pair of resources there is exactly one microbe using each (carbon, nitrogen) pair, one can think of each of <inline-formula><mml:math id="inf351"><mml:mi>L</mml:mi></mml:math></inline-formula> carbon (alternatively, nitrogen) sources as if it had a list of ‘preferences’ ranking all nitrogen (correspondingly carbon) sources. Indeed, the ranking of competitive abilities <inline-formula><mml:math id="inf352"><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> of different microbes using the same carbon source <inline-formula><mml:math id="inf353"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> but different nitrogen sources <inline-formula><mml:math id="inf354"><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> can be viewed as the ranking of nitrogen sources <inline-formula><mml:math id="inf355"><mml:mi>k</mml:mi></mml:math></inline-formula> by the carbon source <inline-formula><mml:math id="inf356"><mml:mi>i</mml:mi></mml:math></inline-formula>. Conversely, the ranking of <inline-formula><mml:math id="inf357"><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> with the same <inline-formula><mml:math id="inf358"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> but variable <inline-formula><mml:math id="inf359"><mml:msub><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> can be thought of as ranking of carbon sources <inline-formula><mml:math id="inf360"><mml:msub><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> by the nitrogen source <inline-formula><mml:math id="inf361"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>.</p></list-item><list-item><p>Consider a steady state in which all nitrogen sources are occupied. In our network representation it corresponds to every nitrogen source sending an outgoing link to some carbon source. Let <inline-formula><mml:math id="inf362"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> be the number of microbes using the carbon source <inline-formula><mml:math id="inf363"><mml:mi>i</mml:mi></mml:math></inline-formula> in a non-limiting fashion (the in-degree of these outgoing links ending on <inline-formula><mml:math id="inf364"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, see <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1C</xref>). Then, obviously, <inline-formula><mml:math id="inf365"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (note that some of the terms in this sum might be equal to zero).</p></list-item></list><p>One can prove that if the state is uninvadable, then the matching given by all edges going from nitrogen sources to carbon sources must be stable in the Gale-Shapley sense. To prove this, let’s think of nitrogen sources as ‘applicants’ and carbon sources as ‘hospitals’ with their numbers of ‘vacancies’ given by <inline-formula><mml:math id="inf366"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. Indeed, any unstable matching has at least one blocking pair <inline-formula><mml:math id="inf367"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> such that:</p><list list-type="bullet"><list-item><p>Condition 1. The nitrogen source (‘applicant’) <inline-formula><mml:math id="inf368"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>‘prefers’ the carbon source (‘hospital’) <inline-formula><mml:math id="inf369"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> to its currently assigned carbon source (the one used by the current microbe <inline-formula><mml:math id="inf370"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> limited <inline-formula><mml:math id="inf371"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>). This means that <inline-formula><mml:math id="inf372"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. Thus the microbe <inline-formula><mml:math id="inf373"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can grow on its nitrogen source (provided that it can also grow on its carbon source).</p></list-item><list-item><p>Condition 2. The carbon source (‘hospital’) <inline-formula><mml:math id="inf374"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>‘prefers’ the nitrogen source (‘applicant’) <inline-formula><mml:math id="inf375"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> to at least one of <inline-formula><mml:math id="inf376"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> of its currently assigned carbon sources (the set of microbes using <inline-formula><mml:math id="inf377"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> in a non-rate-limiting fashion). Thereby <inline-formula><mml:math id="inf378"><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> must be larger than the smallest <inline-formula><mml:math id="inf379"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> among these microbes. According to the Exclusion Rule 2, this smallest <inline-formula><mml:math id="inf380"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> is still larger than <inline-formula><mml:math id="inf381"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> of the microbe limited by <inline-formula><mml:math id="inf382"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> (if it exists). Thus the microbe <inline-formula><mml:math id="inf383"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can also grow on its carbon source.</p></list-item></list><p>This proves that the microbe <inline-formula><mml:math id="inf384"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> corresponding to any blocking pair can grow on both its carbon and its nitrogen sources, and thereby can successfully invade the steady state. This finishes the proof that any uninvadable state has to be a stable matching in the Gale-Shapley sense.</p><fig id="app3fig1" position="float"><label>Appendix 3—figure 1.</label><caption><title>Network representation of a state in Stable Marriage analogy.</title><p>(<bold>a</bold>) Schematic representation of state #5 in the 2C × 2N × 4S model (the same state is shown in <xref ref-type="fig" rid="fig1">Figure 1A</xref> in Main text). Here each species represented as an arrow connecting two resources it is utilizing for growth, with the color and direction of arrow representing growth-limitation of a species (red corresponds to C-limited species, blue N-limited one). (<bold>b</bold>)-(<bold>c</bold>) Schematic representation of two-step construction of state #991 in the 6C × 6N × 36S model. (<bold>b</bold>) We first assign all species that are growth-limited by N (blue links outgoing from N sources). The numbers above C sources indicate number of vacancies for a given resource. (<bold>c</bold>) Then for a given set of N-limited species we populate the remaining C-limited ones that are allowed by the Condition 2 (red links outgoing from C sources).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-49720-app3-fig1-v1.tif"/></fig><p>However, this does not prove that any stable matching corresponds to exactly one uninvadable state. To prove this we first notice that, up to this point, our candidate uninvadable state contained only the nitrogen-limited species (See <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1B</xref>) . We will now supplement it with carbon-limited species in such a way that (1) added species do not violate the exclusion rule 2; (2) added species render the state completely uninvadable. Let is introduce a new notation (applicable to our case in which all nitrogen sources are occupied). Let <inline-formula><mml:math id="inf385"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mtext>min</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denote the smallest <inline-formula><mml:math id="inf386"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> among all species using <inline-formula><mml:math id="inf387"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> in a non-rate-limiting fashion. The Gale-Shapley theorem only guarantees the protection of our state from invasion by a species <inline-formula><mml:math id="inf388"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf389"><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> larger than <inline-formula><mml:math id="inf390"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mtext>min</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see the Condition 2 above). To ensure that our state is uninvadable by the rest of the species, one needs to add some carbon-limited species to this state. In order to do this in a systematic way, for each <inline-formula><mml:math id="inf391"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> we compile the list of all species using this carbon source with <inline-formula><mml:math id="inf392"><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mtext>min</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Each of these species is a potential invader. Some species could be crossed off from the list of potential invaders because they cannot grow on their nitrogen source. These species have <inline-formula><mml:math id="inf393"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> below that of the (unique) species limited by their nitrogen source. Among the species that remained on the list of invaders after this procedure, we select that with the largest <inline-formula><mml:math id="inf394"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> and add it to our steady state as a <inline-formula><mml:math id="inf395"><mml:mrow><mml:mi>C</mml:mi><mml:mo>→</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> directed edge, that is to say, as a carbon-limited species. This will prevent all other potential invaders on our list, since they have smaller <inline-formula><mml:math id="inf396"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> and thus, following the addition of our top carbon-limited species, they would no longer be able to grow based on their carbon source. We will go over all <inline-formula><mml:math id="inf397"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and add such carbon-limited species if they are needed. The only scenario when such species is not needed if our list of potential invaders would turn up to be empty. In this case we will leave this carbon source unoccupied. See <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1C</xref> for the illustration of an uninvadabe state constructed by the above procedure in <inline-formula><mml:math id="inf398"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mn>6</mml:mn><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>×</mml:mo><mml:mn>6</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>×</mml:mo><mml:mn>36</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> model. Since for each carbon source the above algorithm selects the carbon-limited species (or selects to add no such species) in a unique fashion, there is a single uninvadable state for every stable matching in the Gale-Shapley sense. We are now in a position to predict and enumerate all uninvadable states in our model.</p></sec><sec id="s10-2"><title>Lower bound on the number of uninvadable states</title><p>To count the number of partitions <inline-formula><mml:math id="inf399"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="inf400"><mml:mrow><mml:mrow><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, one can use a well known combinatorial method. According to this method, one introduces <inline-formula><mml:math id="inf401"><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> identical ‘separators’ (marked with |) which are placed between <inline-formula><mml:math id="inf402"><mml:mi>L</mml:mi></mml:math></inline-formula> identical objects (marked ·) separating them into <inline-formula><mml:math id="inf403"><mml:mi>L</mml:mi></mml:math></inline-formula> (possibly empty) partitions. For example, for <inline-formula><mml:math id="inf404"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> a partition <inline-formula><mml:math id="inf405"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> would be denoted as <inline-formula><mml:math id="inf406"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">⋯</mml:mi></mml:mrow></mml:math></inline-formula>. The combinatorial number of all possible arrangements of separators and objects is obviously <inline-formula><mml:math id="inf407"><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. For every such partition the Gale-Shapley theorem guarantees at least one stable matching (that is, at least one uninvadable steady state). The lower bound on the number of uninvadable steady states has to be doubled to account for reversal of roles of carbons and nitrogens. There is a small possibility that we double counted one partition <inline-formula><mml:math id="inf408"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Indeed, the unique uninvadable stable state corresponding to this partition could in principle be counted both when we start from nitrogen sources and when we start from carbon sources. While such uninvadable steady states can and do occur, if only under rather special circumstances described below, they cannot be obtained by the classical Gale and Shapley resident(nitrogen)-proposing algorithm. Indeed, at the last step of the nitrogen-proposing algorithm all carbon sources except just one carbon sources have all their vacancies already filled. Since the algorithm makes all nitrogen sources to go down their preference lists, at this point none of the carbon source whose outgoing arrow has already been accepted would prefer the last nitrogen with a vacancy to the one they have sent an arrow to. Thus, in terms of our adaptation of the Gale-Shapley algorithm to identify all uninvadable states, the last carbon to receive the incoming link from the last nitrogen does not need to be occupied (send a link from C to N) to prevent an invasion, as there is no one willing to invade it because of nitrogen preferences. Thus, in the uninvadable state identified by the Gale and Shapley nitrogen-proposing algorithm, this carbon source would have an incoming arrow but no outgoing arrow. Such states would not be double counted and would not affect our lower bound on the total number of uninvadable states in the model. A partition in which each carbon and each nitrogen source have exactly one vacancy could have more than two (possibly identical) stable states found by the Gale and Shapley nitrogen-proposing and carbon-proposing algorithms could lead to double counting. Hence, in general one may need to merge a handful of identical states independently found starting from carbon and nitrogen sides.</p><p>Then we have <inline-formula><mml:math id="inf409"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The Sterling approximation for this expression is <inline-formula><mml:math id="inf410"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. Thus the overall lower bound for the number of uninvadable stable states is given by<disp-formula id="equ12"><label>(S4)</label><mml:math id="m12"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>≃</mml:mo><mml:mfrac><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:msqrt><mml:mrow><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msqrt></mml:mfrac><mml:mo mathvariant="italic" separator="true"> </mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>More generally, the number of carbon sources, <inline-formula><mml:math id="inf411"><mml:mi>K</mml:mi></mml:math></inline-formula>, is not equal to the number of nitrogen sources, <inline-formula><mml:math id="inf412"><mml:mi>M</mml:mi></mml:math></inline-formula>. The resource type with a larger number will always have at least one resource left without input. Thus here one never needs to correct for double counting. Using the same reasoning as for <inline-formula><mml:math id="inf413"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, the lower bound on the number of resources in this case is given by <inline-formula><mml:math id="inf414"><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>K</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Here, the first term counts the uninvadable steady states in which all nitrogen sources are occupied and the partition divides <inline-formula><mml:math id="inf415"><mml:mi>M</mml:mi></mml:math></inline-formula> edges sent by nitrogen sources among <inline-formula><mml:math id="inf416"><mml:mi>K</mml:mi></mml:math></inline-formula> carbon sources, which requires <inline-formula><mml:math id="inf417"><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>‘dividers’. The second term counts the number of uninvadable steady states in which all carbon sources are occupied. Denoting the fraction of carbon resources among all resources as <inline-formula><mml:math id="inf418"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and using the Stirling approximation one gets<disp-formula id="equ13"><label>(S5)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>U</mml:mi><mml:mi>I</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≥</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>≃</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>≃</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:msqrt></mml:mfrac><mml:mspace width="2em"/><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In the case of multiple microbial species using the same pairs of resources, our version of the Gale-Shapley resident-oriented algorithm must be further updated. Let <inline-formula><mml:math id="inf419"><mml:mi>M</mml:mi></mml:math></inline-formula> be the number of nitrogen sources, and <inline-formula><mml:math id="inf420"><mml:mi>K</mml:mi></mml:math></inline-formula> — the number of carbon sources in the ecosystem, <inline-formula><mml:math id="inf421"><mml:mi>S</mml:mi></mml:math></inline-formula> the number of species in our pool, each requiring a pair of resources to grow. As now there may be more than one microbe that uses a given pair of resources <inline-formula><mml:math id="inf422"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf423"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, we introduce the notation <inline-formula><mml:math id="inf424"><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> for the <inline-formula><mml:math id="inf425"><mml:mi>r</mml:mi></mml:math></inline-formula>th microbe using the same pair of sources <inline-formula><mml:math id="inf426"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf427"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>. On average, each nitrogen (carbon) source has <inline-formula><mml:math id="inf428"><mml:mrow><mml:mi>S</mml:mi><mml:mo>/</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf429"><mml:mrow><mml:mi>S</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>) microbes, which are capable of using it. As in the traditional Gale-Shapley algorithm, each nitrogen (carbon) source ranks all microbes capable of using it by their <inline-formula><mml:math id="inf430"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> (<inline-formula><mml:math id="inf431"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>).</p><p>The way to identify all uninvadable stable states in this case is determined by a variant of the stable marriage problem (or rather the hospital/resident problem) in which every man (and every woman) may have more than one way to propose marriage to the same woman (man). In our model, this corresponds to more than one microbe (a type of marriage) capable of growing on the same pair of carbon (corresponding to, say, men) and nitrogen (corresponding to women) sources. You may think of it as if each participant has several different ways to propose to the person of the opposite sex (send flowers, take to a restaurant, etc). Each of these proposals is ranked by both parties independent of other ways. As far as we know, this variant has not been considered in the literature yet. However, all of the results of the usual stable marriage (or hospital-resident) problem remain unchanged.</p><p>One can easily see that our lower bound (<xref ref-type="disp-formula" rid="equ13">Equation S5</xref>) on the number of uninvadable states (equal to the number of stable marriages in all partitions) remains unchanged. Indeed, it is given by the number of partitions and hence depends only on <inline-formula><mml:math id="inf432"><mml:mi>K</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf433"><mml:mi>M</mml:mi></mml:math></inline-formula> and not on <inline-formula><mml:math id="inf434"><mml:mi>S</mml:mi></mml:math></inline-formula>. However, for <inline-formula><mml:math id="inf435"><mml:mrow><mml:mi>S</mml:mi><mml:mo>≫</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>⋅</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> one expects to have many more stable marriages for each partition. Thus the lower bound we have established is likely to severely underestimate the actual number of UIS in the ecosystem.</p></sec></sec></boxed-text></app><app id="appendix-4"><title>Appendix 4</title><boxed-text><sec id="s11" sec-type="appendix"><title>Conditions of multistability in the 2C × 2N × 4S ecosystem</title><p>Below we consider the general case of a 2C × 2N × 4S ecosystem. Let’s assume that the selected set of <inline-formula><mml:math id="inf436"><mml:mi>λ</mml:mi></mml:math></inline-formula> parameters allow potentially unstable state in which all four species are present. These species form a single loop in the network representation (like state S7 in our 2C × 2N × 4S example). Without loss of generality we may assume that <inline-formula><mml:math id="inf437"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>–﻿parameters satisfy <inline-formula><mml:math id="inf438"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>11</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>21</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo rspace="5.3pt">;</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>21</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>22</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo rspace="5.3pt">;</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>22</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>12</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo rspace="5.3pt">;</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>12</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>11</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The 4-species loop is then formed by the links <inline-formula><mml:math id="inf439"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf440"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf441"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf442"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> In all other cases we may rename C and N resources until the direction of the loop is as stated above. The system also has two uninvadable steady states (A) in which two microbes (<inline-formula><mml:math id="inf443"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf444"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) are limited by their nitrogen sources and (B) in which two other microbes are limited by their carbon sources (<inline-formula><mml:math id="inf445"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf446"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>). These two states have their regions of feasibility in the influx space. In order for these regions to overlap with each other, thereby resulting in bistability within the overlapping region, the yield parameters of species and nutrient supply rates have to satisfy the following conditions.</p><p>For the state (A), the conservation laws read as<disp-formula id="equ14"><label>(S6)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The last two relations in (<xref ref-type="disp-formula" rid="equ14">Equation S6</xref>) define microbe concentrations as <inline-formula><mml:math id="inf447"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>−</mml:mo><mml:mspace width="thinmathspace"/><mml:mfrac><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf448"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>−</mml:mo><mml:mspace width="thinmathspace"/><mml:mfrac><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Substituting these expressions into the first two relations in (<xref ref-type="disp-formula" rid="equ14">Equation S6</xref>) and invoking the requirements <inline-formula><mml:math id="inf449"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="thickmathspace"/><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> (guaranteeing that neither of two carbons limits microbes’ growth), in the high flux limit we obtain<disp-formula id="equ15"><label>(S7)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd><mml:mtd><mml:mo>&lt;</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd><mml:mtd><mml:mo>&lt;</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The inequality conditions above are only natural given that the microbes use up their nitrogen fluxes very thoroughly in the state (A) while (at least in the high-flux limit) they not getting even close to consuming all of their carbon supply rates .</p><p>The state (B) in the high flux limit will require different conditions, although obtained in a perfectly similar way:<disp-formula id="equ16"><label>(S8)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd><mml:mtd><mml:mo>&lt;</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd><mml:mtd><mml:mo>&lt;</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Combining <xref ref-type="disp-formula" rid="equ15">Equation S7</xref> and <xref ref-type="disp-formula" rid="equ16">Equation S8</xref> one gets<disp-formula id="equ17"><label>(S9)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mspace width="thickmathspace"/><mml:mfrac><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mstyle></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mspace width="thickmathspace"/><mml:mfrac><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mstyle></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Hence, for the carbon fluxes ratio, one would have<disp-formula id="equ18"><label>(S10)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula>which implies that for multistability to be possible at least for some ratio of fluxes the yields have to satisfy the following inequality:<disp-formula id="equ19"><label>(S11)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Note that the <xref ref-type="disp-formula" rid="equ19">Equation S11</xref> is both necessary and sufficient for bistability between (A) and (B) for some set of supply rates. Indeed, if <xref ref-type="disp-formula" rid="equ19">Equation S11</xref> is satisfied, <inline-formula><mml:math id="inf450"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>2</mml:mn><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> can be chosen arbitrarily (the only thing one would have to mind here is the high-flux limit requirements), then <inline-formula><mml:math id="inf451"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> should be chosen in accordance with <xref ref-type="disp-formula" rid="equ18">Equation S10</xref>, and any nitrogen fluxes satisfying <xref ref-type="disp-formula" rid="equ17">Equation S9</xref>. All the procedures are legitimate whenever <xref ref-type="disp-formula" rid="equ19">Equation S11</xref> holds. Once chosen in the way described above, the point <inline-formula><mml:math id="inf452"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo rspace="4.2pt">,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo rspace="4.2pt">,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo rspace="4.2pt">,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the influx space will make both (A) and (B) steady states feasible.</p><p>In a more general case of an arbitrary number of nutrients of each type, the conditions allowing for bistability or even multistability can be expressed by simple inequalities connecting yields and fluxes in combinations dictated by network topology of potentially bistable states in a very similar way to the simple case presented above. Thus the solution to the puzzle of why roughly half of all possible yield combinations has no multistability whatsoever becomes intuitively clear. Indeed, these yields and fluxes must come in ‘dimensionless’ combinations so that any inequality can be written as a function of only C:N stoichiometry <inline-formula><mml:math id="inf453"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>:</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mstyle></mml:mrow></mml:math></inline-formula> for all microbial species present in any of the set of potentially multistable states. Note that should nitrogen and carbon yields exchange places for each of these microbes, the key inequality similar to <xref ref-type="disp-formula" rid="equ19">Equation S11</xref> would be reversed, thus prohibiting multistability where it was permitted and vice versa.</p><p>In the yield space, the proposed swap of carbon and nitrogen yields of all species <inline-formula><mml:math id="inf454"><mml:mrow><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo rspace="5.3pt">,</mml:mo><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is a volume preserving transformation. This means that, for each set of potentially multistable states, the fraction of the yield space favouring multistability is exactly the same as the fraction prohibiting multistability. In a possible (albeit unlikely) scenario when the suggested permutation affects not only the potential multistability in question, but also some other multistable conditions, ‘turning off’ one multistability might in some cases ‘turn on’ others. This is why the ultimate empirical probability of multistability for a given combination of species’ yields might somewhat deviate from 1/2.</p></sec></boxed-text></app><app id="appendix-5"><title>Appendix 5</title><boxed-text><sec id="s12" sec-type="appendix"><title>Proof of the absence of multistability when all species have identical nutrient stoichiometries</title><p>For randomly selected nutrient supply rates, the chance for the system to end up in a given steady state is proportional to the volume of its region of feasibility. In a <inline-formula><mml:math id="inf455"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:math></inline-formula> dimensional space, where each point corresponds to the set of K carbon and M nitrogen nutrient supply rates, regions of feasibility for some uninvadable states may intersect. In this case, the area they have in common defines the initial conditions at which multistability can occur. Naturally, for the effect to be observable, that shared area has to be <inline-formula><mml:math id="inf456"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:math></inline-formula> dimensional, else its volume and, correspondingly, the chance to encounter such a situation in a real ecosystem would be negligibly small.</p><p>In the general case, when the microbes differ in terms of their stoichiometry, the steady state conditions dictate, for carbon supply rates:<disp-formula id="equ20"><label>(S12)</label><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf457"><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac></mml:math></inline-formula> is the abiotic value of the concentration of the nutrient <inline-formula><mml:math id="inf458"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf459"><mml:mi>i</mml:mi></mml:math></inline-formula> ranging from 1 to <inline-formula><mml:math id="inf460"><mml:mi>K</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf461"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, as usual, is the concentration of the microbe growing on <inline-formula><mml:math id="inf462"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf463"><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> (equal to zero if the microbe is absent in the state), <inline-formula><mml:math id="inf464"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> — the yield of the microbe with respect to its carbon source.</p><p>Similarly, for nitrogen supply rates one would have:<disp-formula id="equ21"><label>(S13)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>here <inline-formula><mml:math id="inf465"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> being the abiotic value of the concentration of the nutrient <inline-formula><mml:math id="inf466"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf467"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> – the yield of the microbe using <inline-formula><mml:math id="inf468"><mml:msub><mml:mi>c</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf469"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> with respect to its nitrogen source, <inline-formula><mml:math id="inf470"><mml:mi>j</mml:mi></mml:math></inline-formula> ranging from 1 to <inline-formula><mml:math id="inf471"><mml:mi>M</mml:mi></mml:math></inline-formula>.</p><p>When multistability occurs, there exist at least two different sets of values of <inline-formula><mml:math id="inf472"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf473"><mml:msub><mml:mi>c</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf474"><mml:msub><mml:mi>n</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> such that either of them can fit both <xref ref-type="disp-formula" rid="equ20">Equation S12</xref> and <xref ref-type="disp-formula" rid="equ21">Equation S13</xref> for the same values of nutrient supply rates. After marking one of them with the symbol ∼ for carbon sources one gets:<disp-formula id="equ22"><label>(S14)</label><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>c</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>and for nitrogen sources:<disp-formula id="equ23"><label>(S15)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In the general case, where the microbes differ in their yields, <xref ref-type="disp-formula" rid="equ22">Equation S14</xref> and <xref ref-type="disp-formula" rid="equ23">Equation S15</xref> taken together for all relevant <inline-formula><mml:math id="inf475"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf476"><mml:mi>j</mml:mi></mml:math></inline-formula>, describe a <inline-formula><mml:math id="inf477"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>–dimensional area. Indeed, the nutrient concentration on any occupied resource is fixed to <inline-formula><mml:math id="inf478"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf479"><mml:mi>α</mml:mi></mml:math></inline-formula> is the species limited by this resource. Conversely, for any unoccupied resource nutrient concentration is free to vary as long as it is larger than <inline-formula><mml:math id="inf480"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf481"><mml:mi>β</mml:mi></mml:math></inline-formula> is the species using this resource in a given state which has the smallest value of <inline-formula><mml:math id="inf482"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>. In other words each unoccupied resource contributes one degree of freedom, while occupied resources do not. There is also a positive microbe concentration value for any occupied nutrient source. Thus, the total number of the unknowns is being equal to <inline-formula><mml:math id="inf483"><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> on the left side and <inline-formula><mml:math id="inf484"><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> on the right side of the system of the equations. The total number of the unknowns is thus <inline-formula><mml:math id="inf485"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. The number of restrictions provided by <xref ref-type="disp-formula" rid="equ22">Equation S14</xref> and <xref ref-type="disp-formula" rid="equ23">Equation S15</xref> being <inline-formula><mml:math id="inf486"><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>, the area defined by the system of the equations turns out to be <inline-formula><mml:math id="inf487"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:math></inline-formula> dimensional.</p><p>If the stoichiometry (yields) of all species are equal to each other, without loss of generality one can assume them all to be equal to unity. Indeed, in this case the units of resource concentrations or bacterial abundances can be universally changed to match each other so that one unit of resource is used to make exactly one unit of bacterial abundance.</p><p>For identical stoichiometry of species there is an additional constraint on our <inline-formula><mml:math id="inf488"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> variables. Indeed, after adding up all equations <xref ref-type="disp-formula" rid="equ22">Equation S14</xref> and then, separately, all equations <xref ref-type="disp-formula" rid="equ23">Equation S15</xref>, and comparing the results of these additions we get<disp-formula id="equ24"><label>(S16)</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="2em"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This reflects the fact that for identical stoichiometries both sides of <xref ref-type="disp-formula" rid="equ24">Equation S16</xref> are equal to the total biomass concentration <inline-formula><mml:math id="inf489"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of all surviving microbes. Hence, if the two sets of concentrations satisfying both <xref ref-type="disp-formula" rid="equ22">Equation S14</xref> and <xref ref-type="disp-formula" rid="equ23">Equation S15</xref> exist, under the degenerate stoichiometry condition they must also satisfy an additional constraint<disp-formula id="equ25"><label>(S17)</label><mml:math id="m25"><mml:mrow><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:msub><mml:mi>c</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>m</mml:mi></mml:munder><mml:msub><mml:mi>n</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>p</mml:mi></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>as the difference between the total concentration of carbon nutrients and that of nitrogen nutrients must be the same in both states by the virtue of <xref ref-type="disp-formula" rid="equ24">Equation S16</xref>.</p><p>The additional constraint <xref ref-type="disp-formula" rid="equ25">Equation S17</xref> reduces the dimensionality of the multistability area to <inline-formula><mml:math id="inf490"><mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, so in the <inline-formula><mml:math id="inf491"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:math></inline-formula> dimensional space of nutrient concentrations it has zero volume.</p></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.49720.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Shou</surname><given-names>Wenying</given-names></name><role>Reviewing Editor</role><aff><institution>Fred Hutchinson Cancer Research Center</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Shou</surname><given-names>Wenying</given-names> </name><role>Reviewer</role><aff><institution>Fred Hutchinson Cancer Research Center</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p>Thank you for submitting your article &quot;Multistability and regime shifts in microbial communities explained by competition for essential nutrients&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Wenying Shou as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Ian Baldwin as the Senior Editor.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary</p><p>&quot;Multistability and regime shifts in microbial communities explained by competition for essential nutrients&quot; by Dubinkina et al. explores the presence of diverse, multiple stable states for diverse ecosystems. The model builds on the groups earlier work using results from game theory on the stable marriage problem to ask under what conditions it is possible to have multistability in diverse communities. The authors employ an idealized model of competition for essential nutrients to study patterns of multistability and diversity in microbial ecosystems. By computationally enumerating steady states and classifying them by stability, the authors establish that multistability is a typical feature of resource competition between specialized consumers. Specifically, they show that multistability emerges robustly when nutrient supplies are balanced and competitors have different C:N stoichiometries. The topic of how diversity is maintained in microbial ecosystems is likely to be of broad interest to the readership of <italic>eLife</italic>. While the current model is quite simplified compared to any real multispecies community, the authors do a good job of highlighting general lessons from the model that make testable predictions for natural and experimental systems. Overall, all three reviewers found the work interesting.</p><p>Essential revisions</p><p>Essential revisions fall under three categories:</p><p>1) Present your model more clearly;</p><p>2) Add mechanisms and intuitions (rather than simply describing your data);</p><p>3) Discuss generalizability of the results, including sensitivity to parameter choices.</p><p>To help you revise, we attach the reviews.</p><p><italic>Reviewer #1:</italic></p><p>My main suggestions are as following:</p><p>1) The authors define states by the presence/absence of species, and if present, which nutrient it would be limited in. Out of the theoretical possible states, the authors found all steady states by noting a correspondence of their problem and the stable marriage problem. This correspondence needs to be explained in an accessible form (perhaps in a figure).</p><p>2) Put more emphasis on going through the data and explain what they mean. For example, in Figure 1B: why do we get these states? For the two-species 11, 22 cases, one could imagine a different state where 11 is limited for carbon, and 22 is limited for nitrogen. Why is this case not seen? Does this have something to do with your parameter choices? For Figure 3B, why does the likelihood of multistability peak at C:N supply rates similar to the average C:N stoichiometry? If you change the average C:N stoichiometry ratio by 10-fold, does the peak change by 10-fold? Seems that the authors were simply describing results rather than also giving intuition on why the results arose.</p><p>3) Subsection “Three criteria for stability of microbial communities” paragraph four: not clear why invasion does not depend on nutrient supply rates, given that nutrient supply rates could change growth rates.</p><p>4) Abstract: Multistability requires different stoichiometries of essential nutrients. How different does &quot;different&quot; have to be? It would be good to supplement with previous experimental data on these ratios and discuss.</p><p><italic>Reviewer #2:</italic></p><p>My main concern is really about how much the conclusions from this particular model used by the authors generalize to a more general setting. I think the assumptions of the model are quite stringent (and need to be in order to really use the technical apparatus of game theory/stable marriage problem they use):</p><p>Each species can use only one C and one N resource; a single metabolite cannot provide both C and N (even though we know for example bacteria can and do use amino acids as C sources).</p><p>As the authors point out, this gives rise to non-generic behavior such as the fact:</p><p>&quot;Unlike other consumer resource models, in our model the dynamic stability of a state with respect to species invasions does not depend on nutrient supply rates.&quot;</p><p>At the minimum, the authors have to argue what depends on these assumptions and what does not. Comparing the results to more standard Consumer Resource Models (CRMs) would go a long way at clarifying this. Despite this criticism, I want to emphasize that I think the paper explores and interesting question and gives rise to interesting hypothesis that are interesting and potentially testable.</p><p>I now give more detailed comments:</p><p>Technical Comments:</p><p>The section on Monte-Carlo sampling is extremely unclear. What exactly is the distribution that is sampled? Is this done only in the high-flux regime? What is assumed about the R matrix being invertible? Is this somehow an assumption that the Y are &quot;generic&quot;? It is very unclear to me why one cannot be feasible on a low-dimensional manifold. This is usually a generic situation in most CRMs so why is it excluded here. I would appreciate a much more technical discussion, perhaps with pseudo code so that I can better understand if and when the arguments generalize.</p><p>The equations in subsection “Conditions of multistability in the 2C x 2N x 4S ecosystem” have typos (extra factors of Y).</p><p>I did not understand in the section on lower-bound, why &quot;double counting&quot; can be discarded (either when # of C = # of N or otherwise).</p><p>It is very unclear how sensitive are the results to different &quot;draws&quot; of the λ and Y. There is a particular realization given in SI Tables but it would be nice to have a sense of the fluctuations rather than just for one network.</p><p>Another general way of modeling essential resources is to use a function of the from<disp-formula id="equ27"><mml:math id="m27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>α</mml:mi></mml:munder><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula>where the <inline-formula><mml:math id="inf492"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are constants with the same units as <inline-formula><mml:math id="inf493"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> that encode ratios of resources required for building biomass (see Taillefumier et al., 2017). Recently, it was shown in arxiv:1901.09673 that such functions can also give rise to multi-stability using a Minimum Environmental Perturbation Principle based on measuring distances from the input flux vectors with appropriate distance metric. This suggests it should be possible to generically construct input fluxes into the system with multiple steady-states by finding input vectors that are equally distant from the intersection of all ZGNIs for a different, more traditional class of CRMs where species can eat many resources. This again raises questions about what generalizes from this simple but interesting model. It seems that this would be more in line with the generalization in equation in subsection “Extensions of the model” but it may qualitatively change the results.</p><p>Conceptual Comments:</p><p>I really enjoyed the idea of how by continuously changing the environments one cannot connect very different stable states. This reminds me of old arguments in evolutionary theory on neutralness in adaptation by Fontana and collaborators (PNAS 1996) where very different evolutionary minima could be connected even though they changed differently. This is just a thought/comment not a suggestion for investigation.</p><p>The idea that equalizing resources promotes diversity is now something that has been found in various CRMs (Posfai et al., 2017; Tikhonov et al; Marsland et al., 2019). The idea is that one gets neutral like dynamics. Is there a way to reconcile these ideas with the multi-stability? It is curious that both these dynamics like equalizing resources and I would like to understand what, if any, the authors think the connection is.</p><p>I am really confused as stated above how these results depend on the available resource species pool. In particular, what if I changed the statistics of things were generated, yields, etc.? I think it would be nice to at least understand these things at least semi-quantitatively.</p><p><italic>Reviewer #3:</italic></p><p>1) Existing literature on competition for essential nutrients.</p><p>The authors state that &quot;while real-life ecosystems driven by competition for multiple essential nutrients have been studied experimentally Fanin et al., 2016; Browning et al., 2017; Camenzind et al., 2018, the resource-explicit models capturing this type of growth are not so well developed beyond the foundational work by Tilman, 1982.&quot; Although this is generally true, it would be helpful to reference the work that does exist, to orient the reader as to whether the current results are surprising. Huisman's paper (Nature 402 1999) is relevant, as is the plankton literature more generally.</p><p>2) Assumptions and parameters of the model.</p><p>The assumption of complete specialization to a single carbon and nitrogen resource is very limiting. More care should be taken to justify it in the context of real ecosystems. Would the results hold qualitatively if this assumption were relaxed? Why or why not? Furthermore, each model seems to feature only one realization of the growth coefficient λs. The authors don't need to redo everything for new parameters, but they should confirm that their results are not specific to these parameters. Finally, in the current model a species' λs and Ys (growth yields) are uncorrelated. However, it would be more biologically plausible if these were subject to trade-offs for each species (e.g. high growth rates correspond to low yields). It would be informative if the authors would check the case where λY=constant to confirm that their results do not depend on λ and Y being uncorrelated.</p><p>3) Explanation of Figure 2E-F</p><p>The authors should try to provide an intuitive, mechanistic understanding of these computational results. Why does state 2 have the largest feasibility volume, and why are regime shifts possible between some states and not others? If I understood the simple case of 2e, I would have a better appreciation of 2f. A discussion of the ecological implications would also be welcome here.</p><p>4) 1D manifold in Figure 3C</p><p>In the same spirit as point #3, the authors should try to explain this result and its implications. This is certainly an interesting observation, but as of now it's asserted without any mechanistic understanding.</p><p>5) Competitive rank and diversity</p><p>The &quot;competitive rank&quot; metric is unintuitive, at least as presented. The authors should explain more clearly why ranks run from 1-6 and why they're a species property independent of the environment. The surprising result that a rank 5.5 species is uninvadable 20% of the time should be explained. What is a specific scenario in which this occurs, and why?</p><p>6) Volume in abundance space</p><p>The authors focus on the feasibility volume of a state in the space of nutrients. However, it is also natural to consider the volume of the basins of attraction in the space of species abundances for a particular state in a given environment, when multiple stable states are possible. Does the volume of the basin of attraction for a state relate to its feasibility volume?</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.49720.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>My main suggestions are as following:</p><p>1) The authors define states by the presence/absence of species, and if present, which nutrient it would be limited in. Out of the theoretical possible states, the authors found all steady states by noting a correspondence of their problem and the stable marriage problem. This correspondence needs to be explained in an accessible form (perhaps in a figure).</p></disp-quote><p>We thank the reviewer for this suggestion. To address this we added a paragraph with additional details clarifying the general ideas behind the correspondence between our model and the stable marriage problem (see subsection “Microbial community growing on two types of essential nutrients represented by</p><p>85 multiple metabolites” paragraph six and “Three criteria for stability of microbial communities” paragraph two). These are further explained in the Materials and methods section &quot;Identification of all states and classification of them as invadable or uninvadable”. We also believe that knowing the exact correspondence to the stable marriage problem is not essential for understanding of our main results and may even be distracting to our readers.</p><p>We have thought long and hard if this correspondence could be illustrated in an additional figure in the main text of the article and (after long deliberations) decided to leave it for supplementary materials (see Appendix 3-figure 1). Unlike a straightforward mapping to the stable marriage problem outlined in our previous paper (Goyal et al., 2018), the relation to the stable marriage problem described in this study, while mathematically exact, is a bit more formal. Indeed, as explained in the section &quot;Stable matching approach for identification and classification of steady states&quot; of the supplementary notes, &quot;marriages&quot; in the C:N model are unidirectional and represented by directed arrows between C and N sources. It would be confusing to readers to work with two different graphical representations of the same problem (compare Figure 1A and Appendix 3-figure 1 in the current version of the manuscript).</p><disp-quote content-type="editor-comment"><p>2) Put more emphasis on going through the data and explain what they mean. For example, in Figure 1B: why do we get these states? For the two-species 11, 22 case, one could imagine a different state where 11 is limited for carbon, and 22 is limited for nitrogen. Why is this case not seen? Does this have something to do with your parameter choices?</p></disp-quote><p>We thank the reviewer for bringing this up and helping us to clarify our results. Indeed, the list of uninvadable states illustrated in Figure 1B is determined by our specific choice of model parameters λ quantifying competitiveness of individual microbial species (see Supplementary file 1). For this specific case, the state where the species 11 is limited by carbon, and the species 22 – by nitrogen is always invadable by the species 21 and hence not listed among uninvadable states in Figure 1B. We added the explanation of another case to the main text to provide readers with a specific example and additional understanding of how the relative ranking of lambdas defines the invadability of a state (paragraph two subsection “Three criteria for stability of microbial communities”).</p><disp-quote content-type="editor-comment"><p>For Figure 3B, why does the likelihood of multistability peak at C:N supply rates similar to the average C:N stoichiometry? If you change the average C:N stoichiometry ratio by 10-fold, does the peak change by 10-fold? Seems that the authors were simply describing results rather than also giving intuition on why the results arose.</p></disp-quote><p>The short answer is yes: for a 10:1 stoichiometry the multistability peak in Figure 3B will shift to a 10-fold higher <inline-formula><mml:math id="inf494"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> ratio. In general, the C:N stoichiometry averaged across all species can be renormalized to the 1:1 ratio used in our study by redefining the nutrient concentrations and supply rates. For example if the average stoichiometry is 10:1 one can measure all carbon concentrations c<sub>i</sub> in 10-fold larger units than nitrogen concentrations n<sub>j</sub> thereby renormalizing the stoichiometry to 1:1. We have added a brief explanation of this in paragraph three of subsection “Patterns of multistability”</p><disp-quote content-type="editor-comment"><p>3) Subsection “Three criteria for stability of microbial communities” paragraph four: not clear why invasion does not depend on nutrient supply rates, given that nutrient supply rates could change growth rates.</p></disp-quote><p>Indeed, nutrient supply rates change nutrient concentrations, which in turn, change the growth rates of species. However, they do so proportionally for all species using the same nutrient. Throughout the manuscript and in all our numerical simulations we are working in the high nutrient supply regime. In this regime, all individual microbes would be able to grow as isolates. Hence, when multiple species are introduced, their survival is solely due to the competition between them. In this case, the invadability of a state is fully determined by the rank-order of lambdas of the invading species and all species present in the state. In the opposite regime, where at least some of the supply rates are low the set of uninvadable states may expand beyond what we predict. However, our uninvadable states would remain uninvadable even in the low nutrient supply regime.</p><p>To clarify this argument we have rephrased the text. It now reads:</p><p>&quot;Note that, in the regime of our model, where the supply of all nutrients is high, i.e. <inline-formula><mml:math id="inf495"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>≫</mml:mo><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, invadability of individual states does not depend on supply rates. Indeed, in this regime the outcome of an attempted invasion is fully determined by the competition between species, which in turn depends only on the rank-order of λ's of the invading species relative to the species currently present in the ecosystem“. We also clarified it in the respective subsection in Materials and methods.</p><disp-quote content-type="editor-comment"><p>4) Abstract: Multistability requires different stoichiometries of essential nutrients. How different does &quot;different&quot; have to be? It would be good to supplement with previous experimental data on these ratios and discuss.</p></disp-quote><p>Multistability is possible for arbitrarily small variation of stoichiometry, but in this case, it would be confined to a very narrow region of nutrient supply rates. We have previously illustrated it in what was Figure S3 of the original submission. Inspired by this comment and comments of other reviewers we decided to move this figure to the main text of the manuscript (see Figure 5 in the revised submission). It shows that the smaller is the variance of stoichiometries (the x-axis) – the less likely one is to encounter multistability for randomly selected combination of nutrient supply rates (the y-axis of Figure 5). We have added a discussion of this along with comparison with experimental data in subsection “Multistability requires diverse species stoichiometry”.</p><p>We also showed where the real-life soil microbial ecosystem stoichiometry variation lies on this plot.</p><p>We also added the experimentally determined stoichiometry variance for real ecosystems (mammalian gut, phytoplankton, and soil). This suggests that multistability might not be very rare (up to 10% likelihood for soil). We also wrote supplementary note (Appendix 5) that proves that multistability is impossible if all species have identical nutrient stoichiometries.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>1) My main concern is really about how much the conclusions from this particular model used by the authors generalize to a more general setting. I think the assumptions of the model are quite stringent (and need to be in order to really use the technical apparatus of game theory/stable marriage problem they use):</p><p>Each species can use only one C and one N resource; a single metabolite cannot provide both C and N (even though we know for example bacteria can and do use amino acids as C sources).</p><p>As the authors point out, this gives rise to non-generic behavior such as the fact:</p><p>&quot;Unlike other consumer resource models, in our model the dynamic stability of a state with respect to species invasions does not depend on nutrient supply rates.&quot;</p><p>At the minimum, the authors have to argue what depends on these assumptions and what does not. Comparing the results to more standard Consumer Resource Models (CRMs) would go a long way at clarifying this. Despite this criticism, I want to emphasize that I think the paper explores and interesting question and gives rise to interesting hypothesis that are interesting and potentially testable.</p></disp-quote><p>We agree with the reviewer that the assumptions of our model are both stringent and crucial for the exact mapping to the Stable Marriage Problem. However, the conceptual framework in which we reduce multistability between a pair of states to a problem of overlaps of their feasibility regions is general and applicable to a broad variety of Consumer Resource Models. The extent to which our findings hold in other CRM models is the subject of ongoing research in our lab. We added a paragraph comparing one of the key results in our model to that in other CRMs (subsection “Multistability requires diverse species stoichiometry”). We also emphasized the universality (or lack thereof) of our results in other CRMs in subsection “Interplay between diversity and stability in ecosystems with multiple essential nutrients”. Finally, we cited arxiv:1901.09673, which has a number of additional insights into multistability in CRMs.</p><p>In the end of our manuscript we propose two generalizations of our model that can be investigated numerically: the one in which <inline-formula><mml:math id="inf496"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msubsup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msubsup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (a hybrid of our model with the MacArthur model) and another one in which microbes diauxically shift between resources (a hybrid of our model with our previously published model (Goyal et al., 2018) also mapped onto the Stable Marriage Problem). We expect our mathematical techniques to be at least partially extendable to both of these models.</p><disp-quote content-type="editor-comment"><p>I now give more detailed comments:</p><p>Technical Comments:</p><p>2) The section on Monte-Carlo sampling is extremely unclear. What exactly is the distribution that is sampled? Is this done only in the high-flux regime?</p></disp-quote><p>We Monte-Carlo (MC) sampled our flux space randomly (and uniformly in linear space) between 10 and 1000. For each supply combination point, all nutrients were sampled independently as described in Materials and methods. The lower bound was selected in such a way that all our MC sampling was done for the high nutrient supply regime (indeed our λ’s are &gt;10 and δ=1 giving the lower bound of the high flux regime &lt;0.1 well below the lowest nutrient flux of 10. It is now described in more detail in the Materials and methods section.</p><disp-quote content-type="editor-comment"><p>3) What is assumed about the R matrix being invertible? Is this somehow an assumption that the Y are &quot;generic&quot;?</p></disp-quote><p>Yes, to instantiate our model we randomly generated Y, which all but guaranteed that the matrices <inline-formula><mml:math id="inf497"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in Equations 5,6 are invertible. Thus given nutrient supply rates we can always calculate bacterial abundances and concentrations of all nutrients, which are not limiting to any microbes. The problem is made non-trivial by the feasibility constraint that all of these have to be positive.</p><disp-quote content-type="editor-comment"><p>4) It is very unclear to me why one cannot be feasible on a low-dimensional manifold. This is usually a generic situation in most CRMs so why is it excluded here. I would appreciate a much more technical discussion, perhaps with pseudo code so that I can better understand if and when the arguments generalize.</p></disp-quote><p>One common strategy in CRMs is to work with nutrient supply rates artificially constrained to a low-dimensional manifold (e.g. by adding a constraint that <inline-formula><mml:math id="inf498"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>). Such constraints would not change our results except by reducing all of the dimensions used in our study by 1. For example, it would turn K<sup>+</sup>M dimensional space of <inline-formula><mml:math id="inf499"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> into K<sup>+</sup>M-1 dimensional space of constrained <inline-formula><mml:math id="inf500"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. At the same time the dimensionality of the boundaries between states would go down from K<sup>+</sup>M-1 to K<sup>+</sup>M-2. Hence, a shared boundary between states still would not imply multistability.</p><p>Another argument on why we ignore states feasible only on a lower-dimensional manifold is as follows.</p><p>We evaluate the feasibility of a state separately for each set of nutrient supply rates <inline-formula><mml:math id="inf501"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. If a state is feasible only on a low-dimensional subset of <inline-formula><mml:math id="inf502"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, any small perturbation of these will take the system out of this state. Such a state would be nearly impossible to detect in our Monte Carlo simulations. It is also unlikely to be experimentally observed in real microbial ecosystems unless there is a special reason why nutrient supply rates would satisfy this constraint. This treatment of feasibility volumes is standard (see e.g. Grilli et al., 2016 for GLV model or Butler and O'Dwyer, 2018 for the MacArthur model).</p><disp-quote content-type="editor-comment"><p>The equations in subsection “Conditions of multistability in the 2C x 2N x 4S ecosystem” have typos (extra factors of Y).</p></disp-quote><p>These have been corrected.</p><disp-quote content-type="editor-comment"><p>5) I did not understand in the section on lower-bound, why &quot;double counting&quot; can be discarded (either when # of C = # of N or otherwise).</p></disp-quote><p>We tried to better explain our proof that double counting is impossible for stable states identified by the Gale-Shapley men (nitrogen) -proposing algorithm. These are the only states we use in our calculations of the lower bound on the number of uninvadable states. The modified explanation is in Appendix 3.</p><disp-quote content-type="editor-comment"><p>6) It is very unclear how sensitive are the results to different &quot;draws&quot; of the λ and Y. There is a particular realization given in SI Tables but it would be nice to have a sense of the fluctuations rather than just for one network.</p></disp-quote><p>We agree with the reviewer that the question of how parameters λ and Y affect the set of states in our model is an interesting topic for future investigation. During our preparation of this manuscript, we experimented with different sets of lambdas and Y's. We noticed that while the exact set of dynamically stable and uninvadable states depends on our choice of parameters, their number and statistical properties remain the same. We also noticed that the choice of Y’s has a much stronger influence on multistability, which is the main focus of this study. This influence was illustrated in what was the Figure 3S (now moved as Figure 5 in the main text) with different draws of Y and the same set of λ's in the 2C x 2N x 4S model. Similar parameter sensitivity analysis of the 6C x 6N x 36S model was prohibitively computationally expensive.</p><disp-quote content-type="editor-comment"><p>7) Another general way of modeling essential resources is to use a function of the from</p><p><inline-formula><mml:math id="inf503"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>α</mml:mi></mml:munder><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> where the <inline-formula><mml:math id="inf504"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are constants with the same units as <inline-formula><mml:math id="inf505"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> that encode ratios of resources required for building biomass (see Taillefumier et al., 2017). Recently, it was shown in arxiv:1901.09673 that such functions can also give rise to multi-stability using a Minimum Environmental Perturbation Principle based on measuring distances from the input flux vectors with appropriate distance metric. This suggests it should be possible to generically construct input fluxes into the system with multiple steady-states by finding input vectors that are equally distant from the intersection of all ZGNIs for a different, more traditional class of CRMs where species can eat many resources. This again raises questions about what generalizes from this simple but interesting model. It seems that this would be more in line with the generalization in equation in subsection “Extensions of the model” but it may qualitatively change the results.</p></disp-quote><p>We have now cited arxiv:1901.09673 and the Minimum Environmental Perturbation Principle (MEMP), which may provide new insights on general question of multistability in CRMs. We do not fully understand the connection between our methods and MEMP. For example, our model does not have multistability if the yields of all microbes on a given nutrient are equal to each other (see proof in Appendix 5). That is to say, in this case the feasibility regions of different uninvadable states do not overlap with each other, except on a low-dimensional manifold of nutrient supply rates. The model from arxiv:1901.09673 with <inline-formula><mml:math id="inf506"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>α</mml:mi></mml:munder><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> can demonstrably be multistable (see their Figure 5C). However, it is unclear whether this multistability is limited to a low-dimensional manifold composed of &quot;input vectors that are equally distant from the intersection of all ZGNIs&quot;. If it does, our results agree with arxiv:1901.09673. Overall, we believe that these questions could be fruitfully explored in future extensions of our model and are out of scope for this study.</p><disp-quote content-type="editor-comment"><p>Conceptual Comments:</p><p>8) I really enjoyed the idea of how by continuously changing the environments one cannot connect very different stable states. This reminds me of old arguments in evolutionary theory on neutralness in adaptation by Fontana and collaborators (PNAS 1996) where very different evolutionary minima could be connected even though they changed differently. This is just a thought/comment not a suggestion for investigation.</p></disp-quote><p>We thank the reviewer for this positive feedback. We thought about the analogy between addition of species in our model and addition of mutations allowed by natural selection in models similar to Fontana, 1996. We explained this observation in more detail in our manuscript (see subsection “Control of microbial ecosystems exhibiting multistability and regime shifts”). We also have partially implemented this analogy in a forthcoming manuscript where we explore possible changes in the community state along different trajectories in nutrient supply rates and species additions.</p><disp-quote content-type="editor-comment"><p>9) The idea that equalizing resources promotes diversity is now something that has been found in various CRMs (Posfai et al., 2017; Tikhonov et al; Marsland et al., 2019). The idea is that one gets neutral like dynamics. Is there a way to reconcile these ideas with the multi-stability? It is curious that both these dynamics like equalizing resources and I would like to understand what, if any, the authors think the connection is.</p></disp-quote><p>We have rather good conceptual understanding of this issue. In our model, multistability and species diversity are two sides of the same coin. In the region where nutrient supplies are equalized (well-balanced region in our notation), there is an excess of states with high diversity of species (see our Figure 4A). Some of these states are dynamically stable – in this case, high diversity is maintained. Dynamically unstable states on the other hand break up into bistable pairs of lower-diversity states.</p><p>It is easy to understand this relation using the example of Tilman model with a single C and a single N resource. In this case, the well-balanced region is located near the diagonal of the C-N plane. For such nutrient supplies one has either the coexistence between two species (a high-diversity state) or bistability between two low-diversity ones in which either one or the other species survive. The choice between these two scenarios is dictated by the combination of yields and competitiveness of two species, which determine dynamical stability of the two-species steady state. Similar arguments apply to our model with many C and many N resources. However, since the number of states that could be dynamically unstable is large, there is no mutual exclusivity between multistability and high species diversity in the well-balanced region. We have cited this connection between our model and other CRMs in subsection “Interplay between diversity and stability in ecosystems with multiple essential</p><p>nutrients”.</p><disp-quote content-type="editor-comment"><p>10) I am really confused as stated above how these results depend on the available resource species pool. In particular, what if I changed the statistics of things were generated, yields, etc.? I think it would be nice to at least understand these things at least semi-quantitatively.</p></disp-quote><p>We plan to explore some of these topics in future papers. Mapping to the Stable Marriage Problem proves that the statistics (meaning PDFs) of lambdas does not matter for our model. The relative ranks of lambdas fully determine the set of steady states in our model and their invadability. However, as discussed in the paper and shown in Figure 5 (formerly Figure S3) the standard deviation of yields has a strong impact on the extent of multistability in our model. Moreover, we suspect that tradeoffs or correlations between λ<sup>(c)</sup> and λ<sup>(n)</sup> or λ’s and yields might affect the number of stable states in the model. Indeed, we have demonstrated this in our previous work (Goyal et al., 2018) in a different model also based on the stable marriage problem. We now speculate about potential consequences of different tradeoffs in a dedicated section of the Discussion in subsection “Multistability and the total number of states are affected by tradeoffs”.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>1) Existing literature on competition for essential nutrients.</p><p>The authors state that &quot;while real-life ecosystems driven by competition for multiple essential nutrients have been studied experimentally Fanin et al., 2016; Browning et al., 2017; Camenzind et al., 2018, the resource-explicit models capturing this type of growth are not so well developed beyond the foundational work by Tilman, 1982.&quot; Although this is generally true, it would be helpful to reference the work that does exist, to orient the reader as to whether the current results are surprising. Huisman's paper (Nature 402 1999) is relevant, as is the plankton literature more generally.</p></disp-quote><p>We expanded our literature list with several experimental papers quantifying the variability of nutrient stoichiometry in several real ecosystems (phytoplankton in oceans, microbes in soil, and mammalian gut). These references helped us to put a number on likelihood of multistability in each of these systems, which is now shown in Figure 5 (see subsection “Multistability requires diverse species stoichiometry” for the discussion of this figure). We also added an important reference to the Huisman's paper, which we previously overlooked (see paragraph two of the Introduction).</p><disp-quote content-type="editor-comment"><p>2) Assumptions and parameters of the model.</p><p>The assumption of complete specialization to a single carbon and nitrogen resource is very limiting. More care should be taken to justify it in the context of real ecosystems. Would the results hold qualitatively if this assumption were relaxed? Why or why not?</p></disp-quote><p>The mathematical mapping to the stable marriage problem depends on species' complete specialization to use a single carbon and a single nitrogen resource. However, the conceptual framework in which the multistability between uninvadable states is connected to overlaps of their feasibility regions of nutrient supply rates is completely general. We expect the following findings of our model to hold in a broad variety of consumer resource models and real ecosystems: 1) positive correlation between the likelihood of finding multistable nutrient supply combinations and the variability of nutrient stoichiometry (Figure 5 and discussion in subsection “Multistability requires diverse species stoichiometry”); 2) positive correlation between multistability (Figure 3C), species diversity (Figure 4A) and balanced nutrient supply (see the discussion in response to point 9 by reviewer #2 and subsection “Interplay between diversity and stability in ecosystems with multiple essential nutrients”). The extent to which these and other findings can be extended to other CRM models is the subject of ongoing research in our lab as outlined in Discussion.</p><disp-quote content-type="editor-comment"><p>Furthermore, each model seems to feature only one realization of the growth coefficient λs. The authors don't need to redo everything for new parameters, but they should confirm that their results are not specific to these parameters.</p></disp-quote><p>Mapping to the Stable Marriage Problem proves that the statistics of lambdas does not at all matter for our model. The relative ranks of lambdas fully determine the set of steady states in our model and their invadability in the high nutrient supply regime (see subsection “Three criteria for stability of microbial communities” for explanation). We suspect that tradeoffs or correlations between different lambdas might affect the number of stable states in the model (as discussed in subsection “Multistability and the total number of states are affected by tradeoffs”). Indeed, we have demonstrated this in our previous work (Goyal et al., 2018) in a different model also based on stable marriage problem.</p><p>During the preparation of our manuscript we experimented with different sets of λ's and Y's. We noticed that while the exact set of dynamically stable and uninvadable states depends on our choice of parameters, their statistical properties remain the same. We also noticed that the choice of Y’s has a much stronger influence on multistability, which is the main focus of this study. This influence was illustrated in what was the Figure 3S (now moved as Figure 5 in the main text) with different draws of Y and the same set of λ's in the 2C x 2N x 4S model (see subsection “Multistability requires diverse species stoichiometry” for the discussion of this figure). Similar parameter sensitivity analysis of the 6C x 6N x 36S model was prohibitively computationally expensive.</p><disp-quote content-type="editor-comment"><p>Finally, in the current model a species' λs and Ys (growth yields) are uncorrelated. However, it would be more biologically plausible if these were subject to trade-offs for each species (e.g. high growth rates correspond to low yields). It would be informative if the authors would check the case where λY=constant to confirm that their results do not depend on λ and Y being uncorrelated.</p></disp-quote><p>We thank the reviewer for this comment as it lead us to an important discussion. While we do not study any correlated sets of parameters in the current variant of our model, we added a subsection in the Discussion section that summarizes our ideas on this topic (see subsection “Multistability could be affected by tradeoffs”).</p><disp-quote content-type="editor-comment"><p>3) Explanation of Figure 2E-F</p><p>The authors should try to provide an intuitive, mechanistic understanding of these computational results. Why does state 2 have the largest feasibility volume, and why are regime shifts possible between some states and not others? If I understood the simple case of 2e, I would have a better appreciation of 2f. A discussion of the ecological implications would also be welcome here.</p></disp-quote><p>We thank the reviewer for this comment, as it helped us to improve the manuscript. The states #1 and #2 have the lowest species diversity (2 species as opposed to 3 species in states #3-6), thus they can be realized for a larger number of nutrient supply combinations (this diversity/feasibility dependence is illustrated in Figure 4C and discussed in the manuscript). The fact that the volume of the state #2 is larger than that of the state #1 is purely due to chance and is determined by our specific parameter choice.</p><p>We also added a new type of edges (marked blue) to Figure 2E, which mark continuous, smooth transitions between states without discontinuous regime shifts. These appear due to shared boundaries (instead of overlaps) between the pairs of states. Using the network shown in Figure 2E we developed some mechanistic intuition behind which pairs of states are connected by a bistable regime shifts, which have a shared boundary, and which have no direct transition at all. As one can see, the driver of all bistable switches shown in Figure 2E are the mutual exclusivity of pairs of keystone species (1,1), (2,2) and (1, 2), (2,1) correspondingly. Once one of these pairs is established, it cannot be invaded by another pair. The state #7 with all 4 species present is dynamically unstable and for some nutrient supply rates it spontaneously collapses to one of two states with different keystone species giving rise to bistability. Conversely, a shared boundary is possible for some of the states sharing the pair of keystone species.</p><p>Using the example of our 2C x 2N x 4S model, we can now conjecture the following intuitive view of regime shifts in more complex models including our 6C x6N x 36S model. Every ecosystem has a relatively small number of &quot;drivers of bistability’’ generated by certain dynamically unstable states (like state #7). Each of these states can collapse into mutually exclusive pairs of stable states each with its own set of &quot;keystone&quot; species. In addition to keystone species the states could also include ‘’satellite’’ species that do not generally affect the bistable switch between states.</p><p>Our detailed explanations of these effects were added to the manuscript (see Results and Discussion sections).</p><disp-quote content-type="editor-comment"><p>4) 1D manifold in Figure 3C</p><p>In the same spirit as point #3, the authors should try to explain this result and its implications. This is certainly an interesting observation, but as of now it's asserted without any mechanistic understanding.</p></disp-quote><p>We currently do not have a mechanistic interpretation of these results. We suspect that it is a consequence of some special type of Lyapunov function in our problem (see the Discussion) but we have not found this function and thus cannot answer this question. We added the following text describing possible ecological implications of our results in real microbial ecosystems:</p><p>&quot;It is tempting to conjecture that some variant of our model may explain similar arrangements of clusters of microbial abundances commonly seen in PCA plots of real ecosystems. If this is the case, the gaps between neighboring clusters would correspond to dynamically unstable states of the ecosystem, which may be experimentally observable as long transients in species composition.&quot;</p><disp-quote content-type="editor-comment"><p>5) Competitive rank and diversity</p><p>The &quot;competitive rank&quot; metric is unintuitive, at least as presented. The authors should explain more clearly why ranks run from 1-6 and why they're a species property independent of the environment.</p></disp-quote><p>We clarified our definition of the species competitiveness rank in the manuscript (see subsection “Patterns of diversity and structural stability of states”). The competitive rank of a species for carbon (nitrogen) is given by the rank order of its λ<sup>(c)</sup> (λ<sup>(n)</sup>) among all species using the same carbon (nitrogen) source. Since in our example there are L=6 species using each carbon (nitrogen) resource, the rank varies between 1 for the most competitive species in our pool and 6 for the least competitive species. The average competitiveness rank is the mean of species' carbon and nitrogen ranks. Since the growth rate of a species limited by a resource c is given by λ<sup>(c)</sup>*c, with c – being its environmental concentration, the species with a higher λ<sup>(c)</sup> outcompetes the species with a lower λ<sup>(c)</sup> for the resource limiting to both of them.</p><disp-quote content-type="editor-comment"><p>The surprising result that a rank 5.5 species is uninvadable 20% of the time should be explained. What is a specific scenario in which this occurs, and why?</p></disp-quote><p>The factors deciding species prevalence are complex. In fact, only one of the 3 species with the mean competitiveness rank of 5.5 has high prevalence. It is decided by the interplay between competitiveness of all species in our pool. This particular species using c<sub>1</sub> and n<sub>1</sub> by chance was present as a ``satellite'' species in a state (or several states) with high prevalence. The goal of Figure 4B was to illustrate that the outcome of the competition in our model highly dependent on the composition of the entire species pool. In contrast, in a model with only one type of resource (say C), the species with the rank 1 would always win and all species with lower ranks would have zero prevalence.</p><disp-quote content-type="editor-comment"><p>6) Volume in abundance space</p><p>The authors focus on the feasibility volume of a state in the space of nutrients. However, it is also natural to consider the volume of the basins of attraction in the space of species abundances for a particular state in a given environment, when multiple stable states are possible. Does the volume of the basin of attraction for a state relate to its feasibility volume?</p></disp-quote><p>There is a close relationship between state's feasibility volume in the space of nutrients and its basin of attraction in the space of species abundances. They are identical up to the determinant of the matrix R<sub>p</sub> in Equation 5 in Materials and methods. It could be understood using the specific example in Equation 6 describing the state #5 in our 2C x 2N x 4S model. To calculate the feasibility volume of this state we search for all vectors of <inline-formula><mml:math id="inf507"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for which it is feasible, that is to say, when all values of B and n in the left hand side of this equation are positive. To calculate the basin of attraction of species abundances, one goes in the opposite direction and scans all positive values of B<sub>11</sub>, B<sub>12</sub>, B<sub>22</sub>, and n<sub>2</sub> between, say 0 and some upper bound, and constrain them by the condition <inline-formula><mml:math id="inf508"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for all nutrients. The elementary linear algebra dictates that the volumes of these two searches are connected via det(R<sub>p</sub>). In our manuscript we choose to use the feasibility volume since 1) it is more relevant to possible experiments, where it is easy to control nutrient supply rates but hard – bacterial abundances; 2) it has been previously studied in the literature (Grilli et al., 2016, Butler and O'Dwyer, 2018) and even given a special name &quot;structural stability&quot;.</p></body></sub-article></article>