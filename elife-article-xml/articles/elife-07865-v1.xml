<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">07865</article-id><article-id pub-id-type="doi">10.7554/eLife.07865</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>On the dimensionality of odor space</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-3549"><name><surname>Meister</surname><given-names>Markus</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/><aff id="aff1"><label>1</label><institution content-type="dept">Division of Biology and Biological Engineering</institution>, <institution>California Institute of Technology</institution>, <addr-line><named-content content-type="city">Pasadena</named-content></addr-line>, <country>United States</country></aff></contrib></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-6613"><name><surname>Borst</surname><given-names>Alexander</given-names></name><role>Reviewing editor</role><aff><institution>Max Planck Institute of Neurobiology</institution>, <country>Germany</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><label>*</label>For correspondence: <email>meister@caltech.edu</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>07</day><month>07</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e07865</elocation-id><history><date date-type="received"><day>01</day><month>04</month><year>2015</year></date><date date-type="accepted"><day>16</day><month>06</month><year>2015</year></date></history><permissions><copyright-statement>© 2015, Meister</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Meister</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-07865-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.07865.001</object-id><p>There is great interest in understanding human olfactory experience from a principled and quantitative standpoint. The comparison is often made to color vision, where a solid framework with a three-dimensional perceptual space enabled a rigorous search for the underlying neural pathways, and the technological development of lifelike color display devices. A recent, highly publicized report claims that humans can discriminate at least 1 trillion odors, which exceeds by many orders of magnitude the known capabilities of color discrimination. This claim is wrong. I show that the failure lies in the mathematical method used to infer the size of odor space from a limited experimental sample. Further analysis focuses on establishing how many dimensions the perceptual odor space has. I explore the dimensionality of physical, neural, and perceptual spaces, drawing on results from bacteria to humans, and propose some experimental approaches to better estimate the number of discriminable odors.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.07865.001">http://dx.doi.org/10.7554/eLife.07865.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.07865.002</object-id><title>eLife digest</title><p>Scientists are interested in the number of colors, sounds and smells we can distinguish because this information can shed light onto how our brains process these senses both in health and disease. It is relatively straightforward to determine how many colors we can see or sounds we can hear because these stimuli are well defined by physical properties such as wavelength. We know the range of wavelengths that the eye can see or the ear can hear, and we can also understand how two such stimuli (e.g., red and blue) are arranged perceptually (think of a color wheel). It is harder, however, to do the same for smell because most ‘olfactory stimuli’ consist of mixtures of different odor molecules. Moreover, we understand much less about how olfactory stimuli are arranged perceptually.</p><p>In 2014 researchers at Rockefeller University reported that humans can distinguish more than one trillion smells from one another. To calculate this number the researchers tested the ability of human subjects to discriminate between mixtures of different odor molecules. Each mixture consisted of 10, 20 or 30 molecules selected from a chemical library of 128 different odor molecules. Since each mixture of 10 molecules could contain any 10 of the 128 molecules, more than 200 trillion combinations were possible; the number of possible combinations for the 20- and 30-molecule mixtures were even higher.</p><p>The aim of the experiment was to identify—by sampling from this very large number of combinations—the number of molecules that two mixtures could have in common and still be distinguishable to the typical person. The Rockefeller team used this number and a geometrical analogy to conclude that humans could discriminate at least 1.72 trillion odors, which was much higher than expected from previous reports and anecdotes.</p><p>Now Meister reports that the claims made in the Rockefeller study are unsupported because of flaws in the design and analysis of the experiment. In particular, there are flaws in the mathematical methods used to infer the potential number of all smells that humans can discriminate from the numbers of experimental samples tested. Meister also applies the Rockefeller approach to a well-understood sensory system—the vision system—and finds that it predicts that humans should be able to discriminate an infinite number of colors: however, it is widely agreed that humans can only discriminate several million colors.</p><p>In a separate paper Gerkin and Castro also report that the 1.72 trillion smells claim is unjustified.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.07865.002">http://dx.doi.org/10.7554/eLife.07865.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author keywords</title><kwd>computation</kwd><kwd>olfaction</kwd><kwd>perception</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>E. coli</italic></kwd><kwd>Human</kwd><kwd>Mouse</kwd></kwd-group><funding-group><funding-statement>No external funding was received for this work.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.3</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A recent claim that humans can discriminate 1 trillion odors is found to be unwarranted, and further analysis offers insights into the dimensionality of olfactory perception.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The perceptual space for human color vision has three dimensions. Experimental proof of this dates to the 17th century, when it was found that every color sensation can be matched by mixing together three primary lights, but not if only two lights are available (<xref ref-type="bibr" rid="bib7">Mollon, 2003</xref>). Therefore every color sensation can be fully characterized by three numbers, namely the intensity of the primaries that match it. We now know that color vision is based on three kinds of cone photoreceptors in the retina that differ in their sensitivity to the wavelength spectrum of light. Any pattern of excitation among cones can be matched by an appropriate mix of three primary lights, and this is the basis for RGB color display devices. Cone signals get processed by several circuits in the retina and beyond. This system ultimately has limited resolution, and in practice human subjects can distinguish about 1–2 million different colors (<xref ref-type="bibr" rid="bib6">Masaoka et al., 2013</xref>). Clearly, a quantitative understanding of color perception has both energized the search for the underlying neural circuits and made possible the design of image display technologies that mimic reality.</p><p>One would like to achieve a similarly satisfying understanding of human smell. Human olfaction begins with the binding of odor molecules to olfactory receptors, of which there exist ∼400 types (<xref ref-type="bibr" rid="bib5">Malnic et al., 2004</xref>). It is believed that these receptor types all differ in their relative sensitivity to various odorants. Two odors can only be distinguished if they cause different patterns of activity among these types. Thus the neural space of odors at the very input to the olfactory system would seem to have 400 dimensions, many more than encountered in the color system. But what is the perceptual space for odors? The exact analog of the early color mixing experiments has not been done, but from a quantitative analysis of perceptual similarities it has been argued that the space of odors is dominated by just one or two dimensions (<xref ref-type="bibr" rid="bib8">Secundo et al., 2014</xref>), much fewer than the 400 dimensions at the level of sensory receptors. Similarly the number of discriminable odors is thought to be only 10,000, although this estimate is largely anecdotal (<xref ref-type="bibr" rid="bib3">Gilbert, 2008</xref>). Clearly there is a paradox that remains to be resolved pitting the perceptual space of human smell against the receptor space.</p><p>On this background, a recent article claims that ‘Humans can discriminate one trillion odors’ (<xref ref-type="bibr" rid="bib1">Bushdid et al., 2014</xref>). If correct, this would dramatically reorient thinking in this field. Not least, such a result would dash any realistic hopes for olfactory displays that can mix any odor sensation from a small number of primaries. The result was nominated for ‘Breakthrough of the Year 2014’ and heavily promoted to the popular press. By now many people ‘know’ that humans discriminate a trillion odors, and that our color vision system pales miserably in comparison.</p><p>Remarkably, these claims were based on an experimental study in which humans discriminated successfully only 148 pairs of odors. Clearly some mathematical method was needed to extrapolate from that number to trillions. Here I show that this mathematical method fails, and as a result the claims are without any basis. We will see that the data on human olfaction are equally consistent with a trillion discriminable odors and with just 10 (and anything in between). Moreover, if the same method were applied to human color vision, one would conclude that humans can distinguish at least 10<sup>27</sup> colors, in dramatic conflict with experimental evidence. Beyond correcting the erroneous claims, the analysis of failure in the Bushdid et al. study yields useful insights about the nature of the olfactory code. I follow with some suggestions for an approach to estimate the number of distinguishable odors.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>How not to estimate the number of discriminable stimuli</title><p>The reader is encouraged to read the original report by <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref>. The following is a brief summary of the procedures used in that study. The space of all possible odor stimuli is huge. There are likely several hundred thousand distinct chemicals that smell. Any mixture of those chemicals is a point in odor space. The goal is to find how many of those mixtures produce distinct sensations. What is the largest collection of odors such that any one is discriminable from all the others?</p><p>The reported experiments were limited to a subspace spanned by 128 substances. From these primary odors the authors made mixtures by drawing a number (<italic>N</italic>) of primary odors and mixing those in equal parts. Each primary odor is either present or absent in the mixture. Some of these mixtures are very similar to each other, for example if they share 29 of the 30 primary components. Others are very different, for example when they share none of the primary components. For any two mixtures the number of unshared components can be defined as their ‘distance’. The authors assume that the ability of humans to discriminate two odors improves systematically with this distance.</p><p>The next step is to determine the critical distance at which two odors become discriminable. The authors probe this systematically by making pairs of mixtures with <italic>N</italic> components of which <italic>M</italic> are unshared, and testing those for discrimination by human subjects. Indeed they find that the probability of discrimination increases with <italic>M</italic> (Figure 3B of <xref ref-type="bibr" rid="bib1">Bushdid et al., 2014</xref>). They define the critical distance <italic>D</italic> as that separation <italic>M</italic> at which 50% of the mixture pairs are discriminable.</p><p>With these assumptions, two odors closer than <italic>D</italic> tend to smell the same, whereas two odors separated by more than <italic>D</italic> will smell different. To determine how many discriminable odors there are, the authors ask how many regions of diameter <italic>D</italic> can fit in the original 128-dimensional odor space. This is analogous to the problem of packing spheres in high-dimensional spaces and the authors compute the number of packable spheres of diameter <italic>D</italic> by methods of combinatorics (Figure 3D of <xref ref-type="bibr" rid="bib1">Bushdid et al., 2014</xref>). This yielded the ‘one trillion’ in the title of their paper.</p></sec><sec id="s2-2"><title>Failure on a simple model with three odor responses</title><p>Given a novel analysis method, it can be instructive to test it on a ‘simplest possible’ model, for which the desired answer is known and the calculations are easy. In the present context we need a model of olfactory processing that treats mixtures of many components, can compare pairs of such mixtures, and exhibits a clear performance limit in their discrimination. Imagine a toy microbe that lives in an environment with many odors and has receptors to sense all of them. Pure odors are either attractants (providing a sensory input of +1) or repellents (−1). Following the procedure of <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref>, we choose at random 128 of those as primary odors and combine them to make mixtures containing 30 odors. The microbe responds to a mixture by simply summing the sensory input from the component odors. If the sum is less than −2 it says ‘yuck’; if it is greater than +2 it says ‘yum’; and from −2 to +2 it says ‘meh’. Two odor mixtures are discriminable if the microbe responds differently to them.</p><p>Now we make odor mixtures that share a certain number of odors and plot the fraction of discriminable mixtures vs the odor overlap (<xref ref-type="fig" rid="fig1">Figure 1A</xref>, compare to Figure 3B of <xref ref-type="bibr" rid="bib1">Bushdid et al., 2014</xref>). We find that the critical value of 50% discriminability is reached when the mixtures share 15 of the odors. This leads to an estimate of ∼9·10<sup>11</sup> discriminable odors (<xref ref-type="fig" rid="fig1">Figure 1B,C</xref>, see Figure 3D of <xref ref-type="bibr" rid="bib1">Bushdid et al., 2014</xref>). So by the standards of the proposed analysis, this toy microbe can also discriminate 1 trillion odors. Yet we know by construction that it recognizes only three classes of odors. Thus one can produce at most three odors such that each can be discriminated from all the others.<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.07865.004</object-id><label>Figure 1.</label><caption><title>Model of olfaction in a toy microbe.</title><p>(<bold>A</bold>) This 3-state olfactory system counts how many odors in the mixture are attractants vs repellents, and converts the result into three response categories (see text). Two odor mixtures are discriminable if they cause different responses. A numerical simulation of the response to many odor mixtures yields the fraction of discriminable mixtures as a function of the number of odors, <italic>O</italic>, that they share. Mean ± SD over 1000 repeats using different random assignments of the primary odors. Horizontal dashes: criterion for critical distance (50% discriminable pairs). Vertical dashes: critical distance <italic>D</italic> = 30 − <italic>O</italic> = 15. (<bold>B</bold>) Points in odor space separated by a distance <italic>D</italic> cause different responses at least half the time. Counting how many such points exist in the space is like trying to pack spheres of diameter <italic>D</italic> to fill the space as efficiently as possible. (<bold>C</bold>) The number of such spheres in 128-dimensional space as a function of the discriminable overlap <italic>O</italic> among 30-odor mixtures, computed by the formula given in <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref>. The value <italic>O</italic> = 15 from panel (<bold>A</bold>) yields ∼9 × 10<sup>11</sup> spheres.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.07865.004">http://dx.doi.org/10.7554/eLife.07865.004</ext-link></p></caption><graphic xlink:href="elife-07865-fig1-v1.tif"/></fig></p><p>One gets the sense that something is amiss with the analysis procedure of Bushdid et al. If it fails so dramatically on a crude toy model of odor integration, should one trust it on more complex sensory systems? Nevertheless it is instructive to evaluate the procedure on a more realistic case. For example, the toy microbe actually has a name for each odor in the space (one of three possible names) whereas the human subjects were not asked to name the odor. Furthermore, for any given mixture pair the microbe's response is deterministic, whereas humans varied in their response. Thus I will now test the analysis on a system in which one can more exactly replicate the human psychophysics methods used in the reported odor discrimination tests.</p></sec><sec id="s2-3"><title>Failure on the color vision system</title><p>A prominent claim in <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref> is that olfaction vastly outperforms color vision in terms of discriminable stimuli. Specifically the authors compare their own estimate of a trillion discriminable odors to the literature's estimates of ∼1 million discriminable colors. However, studies of color vision used a very different procedure to determine the number of distinct sensations (more on this below). Here I ask what number the authors' methods would produce. Fortunately we know enough about the rules and mechanisms of color perception to simulate this with great confidence, so there is no need to actually perform new color discrimination trials.</p><p>The space of all colored lights has infinite dimensions. Each light is characterized by its wavelength spectrum <italic>S</italic>(<italic>λ</italic>), which specifies how much power exists at each wavelength <italic>λ</italic>. Because the wavelength can take on any positive real value, the <italic>S</italic>(<italic>λ</italic>) are functions of a continuous variable, and thus have infinite dimensions. However, as introduced above, the sensory space of human color vision has only 3 dimensions (<xref ref-type="bibr" rid="bib10">Wandell, 1995</xref>). For each of the three cone types in the retina, the excitation is determined by the rate of photon absorption by its visual pigment. In turn, that rate is a linear function of the spectrum of the light, namely the projection of the light spectrum onto the absorption spectrum of the pigment. If two lights are mixed together, the resulting excitation is the sum of the effects of the individual lights. Therefore human color vision begins by projecting the infinite space of lights down onto a subspace of just 3 dimensions, spanned by the three cone excitations. This subspace has been probed extensively in psychophysical experiments. Typically the subject is shown two lights side-by-side and asked whether they appear different. By systematic probing of the 3-dimensional space one finds there are upward of 1 million discriminable lights, in the sense that any two of them will look different in a pairwise comparison (<xref ref-type="bibr" rid="bib6">Masaoka et al., 2013</xref>).</p><p>For the purpose of simulation, I will therefore consider a space with three axes: <italic>R</italic>, <italic>G</italic>, and <italic>B</italic> (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), corresponding to the three cone excitations. For simplicity, the three variables will range from 0 (dark) to 1 (bright), so the space is a unit cube. Every physical light stimulus is projected onto a vector in this unit cube. The color vision system adds some noise to that vector along each of the 3 dimensions. As a result, two lights are discriminable if their vectors are separated by more than the noise. The level of noise is chosen so that a difference of 0.01 along any dimension is discriminable, which gives 1 million discriminable vectors in the unit cube.<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.07865.005</object-id><label>Figure 2.</label><caption><title>Model of human color vision.</title><p>(<bold>A</bold>) The RGB color cube with three of the 128 primary colors represented by vectors from the origin. Tick marks represent just noticeable differences, for example, along the <italic>R</italic>-axis. (<bold>B</bold>) The fraction of discriminable 30-light mixtures as a function of their overlap. Mean ± SD over 1000 repeats using different random assignments of the 128 lights. 30 lights per mixture, 20 mixture pairs per class, 26 subjects per pair. Horizontal dashes: criterion for critical distance. Vertical dashes: critical distance. (<bold>C</bold>) As in panel <bold>B</bold> but with the mixture components drawn at random from all possible directions in the space rather than from a preselected set of 128 primaries. The results are almost identical.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.07865.005">http://dx.doi.org/10.7554/eLife.07865.005</ext-link></p></caption><graphic xlink:href="elife-07865-fig2-v1.tif"/></fig></p><p>Now one can implement the procedures of <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref>: Choose at random 128 primary lights in this space and make them of equal intensity. Then produce mixtures of 30 lights from those primaries; design different classes of mixtures that vary in the number of shared components. Within each mixture class, present pairs of stimuli to the model and ask whether they can be discriminated, following an ‘odd-man-out’ procedure. Plot the fraction of discriminable pairs against the mixture overlap. Find the overlap at which that fraction is 50%, and take the number of unshared components as the critical distance <italic>D</italic> for discrimination. Compute how many spheres of size <italic>D</italic> fit in the original 128-dimensional space.</p><p>From this simulation, I find that all 30-light mixtures are discriminable if they differ by as little as one component (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). This is to be expected. Each of the primary lights has a vector length of 1/30 (see ‘Materials and methods’). This means that a single unshared component can separate the two mixture vectors by more than 1/30 in the RGB space. But a separation of just 1/100 along any axis is discriminable. So the critical distance <italic>D</italic> = 1. From this one calculates there are more than 10<sup>27</sup> discriminable colors in the 128-dimensional space probed here (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, see Figures 3D and S1B of <xref ref-type="bibr" rid="bib1">Bushdid et al., 2014</xref>).</p><p>Actually, the number of discriminable colors by this argument is much higher, even infinite. To drop down to the 50% discriminability criterion used by the authors in defining <italic>D</italic>, we have to make much larger mixtures of ∼60 lights that differ by just one component. The number of possible mixtures of that kind is about 10<sup>37</sup>. Furthermore, there is no reason to limit the starting space to just 128 primary lights. There is an infinity of spectra that are physically achievable lights, so we could have started with a subspace of arbitrarily high dimensionality. One can simulate infinite dimensionality by choosing for each of the mixtures a different random set of 30 normalized vectors from the cube (again maintaining the specified overlap among mixture pairs). As shown in <xref ref-type="fig" rid="fig2">Figure 2C</xref>, the critical distance under those conditions is still 1. Thus the methods of <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref> would conclude that humans can discriminate an infinite number of colors. That is much bigger than 1 trillion, so color vision would still win over smell, at least by the internal logic of this analysis. However, the number is also much bigger than the known experimental result, a few million. We can conclude that the analysis method fails the ‘positive control test’, namely the application to a related problem with known solution.</p></sec><sec id="s2-4"><title>Humans can discriminate at least 10 odors</title><p>Given that the analysis of Bushdid et al. can vastly overestimate the number of discriminable stimuli, one wonders whether the human odor discrimination data in that report could equally be explained by a much smaller number of odor percepts. That is indeed the case.</p><p>Let us consider a simple model of odor processing in which there is a very large number of odor stimuli and a large number of associated odor receptors. However, I will suppose that the nervous system ultimately projects all those odors onto a neural representation with a single dimension, and we can use the vectors on the unit circle for that (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). So the 128 primary odors map onto 128 unit vectors with random angles. Furthermore, we will suppose that a mixture of odors gets mapped into the sum vector of all the components, normalized again to unit length. Finally, the angle of this vector gets corrupted by some perceptual noise. Two vectors around the circle will be discriminable if they are separated by more than the noise.<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.07865.003</object-id><label>Figure 3.</label><caption><title>A model simulation of the human smell experiments.</title><p>(<bold>A</bold>) Left: Each primary odor gets mapped into a unit vector (e.g., red, green, blue). Mixtures of odors get mapped into the normalized sum vector (gray). Right: When a subject sniffs an odor vial, the odor angle is corrupted by Gaussian noise and a value is drawn from that distribution. Here three vials were presented, two (<bold>A</bold> and <bold>C</bold>) containing the identical odor and a third (<bold>B</bold>) a different odor. This produced response variables <italic>x</italic><sub>A</sub>, <italic>x</italic><sub>B</sub>, and <italic>x</italic><sub>C</sub>. On this trial, <italic>x</italic><sub>B</sub> and <italic>x</italic><sub>C</sub> are closest to each other, so the subject (incorrectly) identifies <bold>A</bold> as the odd odor. (<bold>B</bold>) Discriminability of odor mixtures under this model (compare to <xref ref-type="bibr" rid="bib1">Bushdid et al., 2014</xref>, Figure 2C). Mixtures were simulated according to the reported procedure with 10, 20, or 30 components and varying overlap. Each mixture pair was presented to 26 subjects, and the fraction of correct identification determined across subjects. Box-and-whisker plot shows the distribution of that fraction with percentiles 10, 25, 50, 75, 90. Average over 1000 repeats of the procedure with different random numbers. Red dashes: chance performance. Black dashes: criterion for discriminability (14/26 correct). (<bold>C</bold>) Fraction of discriminable mixtures as a function of their overlap (compare to <xref ref-type="bibr" rid="bib1">Bushdid et al., 2014</xref>, Figure 3D). This is the fraction of mixture pairs in each class that exceeds 50% correct identification across subjects (above the black line in panel <bold>B</bold>). Lines are mean ± SD. Symbols are data from <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref>. The model used Gaussian noise with a SD of 0.4 radians.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.07865.003">http://dx.doi.org/10.7554/eLife.07865.003</ext-link></p></caption><graphic xlink:href="elife-07865-fig3-v1.tif"/></fig></p><p>This encoding model can simulate the reported human subject experiments in detail (<xref ref-type="fig" rid="fig3">Figure 3B,C</xref>): For every ‘odd-man-out’ trial, three mixtures are presented to the model, of which two are identical and the third is a different target mixture. The model maps all three onto the unit circle, adds noise to each, and asks which two are closest to each other. Then it reports the more distant one as the odd odor. If that corresponds to the target odor, it is a ‘correct’ decision (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). Qualitatively, mixtures that share a large fraction of components produce sum vectors at nearby angles, which makes them less discriminable because of the perceptual noise (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, compare to Figure 2C of <xref ref-type="bibr" rid="bib1">Bushdid et al., 2014</xref>). Again one can compute the fraction of discriminable odor mixture pairs, namely those correctly identified in &gt;50% of all trials.</p><p>In <xref ref-type="fig" rid="fig3">Figure 3C</xref>, I plot the results of this simulation along with the published data (from Figure 3B of <xref ref-type="bibr" rid="bib1">Bushdid et al., 2014</xref>). The model has a single parameter, namely the amount of perceptual noise; nothing else is adjustable. With a noise value of 0.4 (SD of the Gaussian noise measured in radians) the fit to the data is quite good. Almost all the data points are within the 1 SD error bars. At noise = 0.3 the model does somewhat better than the humans, at noise = 0.5 somewhat worse.</p><p>For a noise value of 0.4, how many mutually discriminable stimuli are there? We should use the standard of <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref> for discriminability of an odor pair: 50% correct identification in the ‘odd-man-out’ odor test. With that criterion, one can place at most 10 vectors around the unit circle such that each is discriminable from its neighbors. Therefore, the published measurements are consistent with a model in which humans can distinguish just 10 olfactory stimuli from each other.</p><p>Many of us have experienced more than 10 different smells, so these experiments did not come close to exploring the richness of human olfactory experience. Why is the lower bound from this odor psychophysics study so weak? Actually, the result is just about expected from the effort expended. To confirm that 10 odors are mutually discriminable by brute force one has to compare each odor to every other one. The authors did 260 pairwise comparisons, of which only about half were discriminable. So one expects to find evidence for about <inline-formula><mml:math id="inf1"><mml:mrow><mml:msqrt><mml:mrow><mml:mn>148</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> distinct odors, close to what was obtained.</p><p>The ring model of <xref ref-type="fig" rid="fig3">Figure 3</xref> assumes that odor percepts lie in a 1-dimensional space. If one allows for higher numbers of dimensions, then the predicted number of discriminable odors increases, approximately exponentially with the dimensionality of the perceptual space (L Abbott, E Schaffer, and R Axel, personal communication). Since we do not know the dimensionality of odor space, the results of <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref> are equally consistent with 10 or a trillion discriminable odors or anything in between. In other words, the experiments fail to distinguish alternative hypotheses for the number of discriminable odors, even absurd ones that are clearly incorrect.</p></sec><sec id="s2-5"><title>Where is the flaw?</title><p>In the following discussion I will use the term ‘percept’ to strictly mean <italic>the internal state of the sensory system at the stage where discrimination decisions are made</italic>. For us humans two things have the same percept when they look or smell the same. I will extend the term to toy models, bacteria and mice, without presuming that those creatures engage in the more contemplative aspects of perception. Two stimuli may be physically distinct, yet cause the same percept, and thus become indiscriminable, as is the case for many color spectra. Two stimuli can even be distinct at the level of sensory receptors, and still produce the same percept, as in cases to be discussed below.</p><p>The failure of the method in <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref> occurs after the sphere-packing estimate (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). It involves a step that is never mentioned but implicit in the procedure: the assignment of odor percepts to the different spheres in stimulus space. There are at least two problems that can lead to enormous overestimates of the number of discriminable odors, First, the authors assume that every one of the spheres packed into the space corresponds to a different odor percept. But this is unwarranted. The measurement of critical distance for discrimination only ensures that <italic>neighboring</italic> spheres correspond to different percepts, it says nothing about more distant spheres. Thus the same odor percept may recur over and over again for physically distinct odor mixtures.</p><p>The situation can be understood already in 2 dimensions. <xref ref-type="fig" rid="fig4">Figure 4A</xref> shows a set of close-packed pennies on the desktop. Every penny is different in color from its neighbors. More importantly every penny in the whole space has a different color from every other penny. If the pennies correspond to odor percepts one could legitimately say that this organism discriminates as many odors as there are pennies. However, there are many other ways to color close-packed pennies so that no adjacent ones have the same color. In fact, three colors are sufficient (<xref ref-type="fig" rid="fig4">Figure 4B</xref>), so just three percepts could account for an infinite number of spheres in a 2-dimensional odor space.<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.07865.006</object-id><label>Figure 4.</label><caption><title>Coloring close-packed spheres in 2 dimensions so no nearest neighbors have the same color.</title><p>(<bold>A</bold>) All colors different. (<bold>B</bold>) Three colors suffice. (<bold>C</bold>) Progression of colors in one dimension only.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.07865.006">http://dx.doi.org/10.7554/eLife.07865.006</ext-link></p></caption><graphic xlink:href="elife-07865-fig4-v1.tif"/></fig></p><p>One might object that this is an esoteric arrangement: What kind of olfactory system would produce this strange periodic recurrence of the same percept? However, there is a perfectly natural color progression that also provides enormous savings of colors. In the arrangement of <xref ref-type="fig" rid="fig4">Figure 4C</xref> the percept stays the same along one dimension of the space and varies along the orthogonal dimension, yet all neighboring spheres are distinct. The number of pennies one can pack this way goes as the square of the number of colors available. In 128-dimensional space, the number of hyperspheres one can pack this way will go as the 128th power of the number of percepts.</p><p>So the key logical flaw is the assumption that all the close-packed hyperspheres produce different odor percepts. One can trace this back to the unstated assumption that the odors should systematically become more discriminable at greater distances in this space, <italic>and equally in every direction</italic>. Here I showed that there is a simple and natural way to violate that assumption, namely if the percept depends only on a single function of the coordinates. Then the odors become more discriminable with distance along one dimension, but remain indiscriminable along all other dimensions. More generally, if the percepts live in some low-dimensional space (as is the case, e.g., for color vision and for the hearing of pure tones) and then one embeds that space in 128 dimensions, this will produce a similarly efficient labeling of the close-packed spheres. This is what causes the astronomical overestimates in the analysis of <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref> when applied to the three model simulations above.</p><p>The above arguments cannot fully explain the results obtained with the model of the 3-state microbe. Here there are only three possible percepts (‘yum’, ‘yuck’, and ‘meh’) that can be used to paint the hyperspheres. Yet, in 128-dimensional space every sphere has at least 256 nearest neighbors. Clearly it is impossible to distinguish a sphere from all its nearest neighbors with just three colors. This brings us to a second weakness of the method: the definition of the critical distance <italic>D</italic>. This is taken as the distance at which 50% of odor mixture pairs are discriminable. In other words, two points separated by <italic>D</italic> in odor space only need to produce a different percept 50% of the time. So when assigning percepts to the spheres in 128-dimensional space, we merely have to ensure that each sphere is distinct from 50% of its neighbors. That can be done trivially with just two colors, painting alternating spheres white and black. That makes every sphere different from 50% of all its neighbors. The 3-percept microbe can do a bit better, which is why discriminability rises to almost 2/3 at large distances (<xref ref-type="fig" rid="fig1">Figure 1A</xref>).</p><p>Would it help to raise the criterion for discriminability to a higher percentage of mixture pairs? If one raises it to 90% then 10 odor percepts are sufficient to color the entire space of spheres. A popular estimate for the number of discriminable odors (though without solid scientific basis, as reviewed in <xref ref-type="bibr" rid="bib1">Bushdid et al., 2014</xref>) is around 10,000. To ensure that a sphere-coloring system uses at least 10,000 odors, one would need to raise the criterion for discriminability in the definition of <italic>D</italic> to 99.99%. So there needs to be a data point in Figure 3B of <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref> with an ordinate of 99.99%. This would require human subjects to perform several tens of thousands of pairwise comparisons in just one mixture class, a truly extraordinary experimental effort.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><sec id="s3-1"><title>How to proceed?</title><p>The arguments above illustrate that the mathematical method for exploring sensory spaces advocated in <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref> does not work. Fundamentally the extrapolation presumes that the space of odor percepts has at least 128 dimensions. Furthermore, the 128 primary odors chosen must represent ‘orthogonal’ directions in that space, so that the percept varies with distance in the same manner and independently along each of these dimensions. Nothing in the report suggests why we should believe this, and the assumptions seem implausible <italic>a priori</italic>. Violation of those assumptions, for example if the true dimensionality of odor space is much less than 128, leads to dramatic failure of the estimate. How can one do better?</p><p>To obtain the number of discriminable odors, we need to determine the largest set of stimuli such that every stimulus can be discriminated <italic>from every other one</italic>, not just from nearest neighbors. Classic studies of color vision and tone hearing have achieved that. For color vision, the answer is approximately <italic>n</italic> = 1 million. How can one come to that conclusion without doing <italic>n</italic><sup>2</sup> discrimination tests? This is possible only by taking advantage of the systematic structure of the perceptual space. For example, if light <italic>A</italic> looks more red than light <italic>B</italic> and <italic>B</italic> looks more red than <italic>C</italic>, then one can trust that <italic>A</italic> will look more red than <italic>C</italic>. The same applies in tone hearing: If tone <italic>A</italic> sounds lower than tone <italic>B</italic>, and <italic>B</italic> sounds lower than <italic>C</italic>, then <italic>A</italic> will sound lower than <italic>C</italic>. This transitivity of discrimination means that it is sufficient to measure discrimination of neighboring stimuli to ensure mutual discrimination of all stimuli in the set, which reduces the experimental burden from order(<italic>n</italic><sup>2</sup>) down to order(<italic>n</italic>). Effectively these studies work in a low-dimensional subspace of all stimuli (R, G, B for lights; frequency and amplitude for pure tones), within which the progression of the percepts is monotonic, such that transitivity applies. So success of these percept-counting studies relied entirely on recognizing early on that the perceptual space is low-dimensional.</p></sec><sec id="s3-2"><title>The dimensionality of odor space</title><p>How to apply those insights to olfaction? Clearly one needs to first answer ‘how many dimensions span the perceptual space of odors’? The number of 400 human odorant receptor types certainly sets an upper bound on the dimensionality of the perceptual space. And one commonly hears the argument: ‘Why would Nature make so many receptors, unless it is to discriminate all possible patterns of activation’? However, there may be another explanation: We need this many receptors simply to <italic>sense</italic> the molecules of interest, not to disambiguate all possible mixtures of those molecules.</p><p>The bacterium <italic>Escherichia coli</italic> illustrates this idea: It has five different chemoreceptor proteins with different ligand spectra. In principle, <italic>E. coli</italic> could therefore analyze odor mixtures in 5-dimensional space and react differently to every possible mixture. But it doesn't. The outputs of all five receptors readily converge on a single variable, namely the concentration of the CheY signaling molecule (<xref ref-type="bibr" rid="bib4">Grebe and Stock, 1998</xref>). This single variable controls the bacterium's locomotor decisions, so we may identify it with the odor percept in the present use of the term. <italic>E. coli</italic> projects the 5-dimensional receptor space onto a 1-dimensional perceptual space of attraction/repulsion. Why then does it need five receptors, including different receptor proteins for aspartate and for serine, both amino acids? Presumably it is difficult to make a generic amino acid receptor with high sensitivity. Both the amino and the carboxyl ends of the molecule vary in their charge distribution depending on pH, and a single binding pocket directed at these regions would not offer sufficient affinity under all conditions. Instead, the two receptor proteins focus on other more stable portions of the ligand, but those are also unique between serine and aspartate.</p><p>The same arguments apply to odorants in the human nose. The molecules of interest are there at micromolar concentrations or less, in a mucus soup of other components at millimolar concentration. To sense the odorants separately from the mucus, a receptor needs to bind them with high affinity. That means many contact sites between binding pocket and ligand, which in turn leads to selectivity for the shape of the ligand. Even if the olfactory system just wanted to distinguish odors along one dimension (attractive/repulsive), it would be impossible to make a receptor that is selective just for the attractants. Instead Nature makes many receptors that are each selective for small groups of related molecules and then combines their signals appropriately using the nervous system.</p><p>In this picture the dimensionality of receptor space is determined by molecular principles involving the number of ligands of interest, their relevant concentrations, the energetics of ligand binding, and the design limitations of protein structures. The dimensionality of perceptual space, on the other hand, is governed by behavioral and ecological constraints: the nature of olfactory cues in the environment, the kinds of decisions the animal makes based on odorants, and the need to associate new odors with unusual events. There is no principled reason that this perceptual space should have the same dimensionality as the receptor space. And we have the neural circuits of the olfactory system to create an arbitrary map from one space onto the other.</p><p>Another sensory system serves to illustrate this difference between receptor space and perceptual space: touch. Every hair follicle on our skin contains a sensitive mechanoreceptor, several million altogether (<xref ref-type="bibr" rid="bib12">Zimmerman et al., 2014</xref>). This makes us highly sensitive to touch: we can reliably detect the bending of an individual hair almost anywhere on the body. But clearly we cannot discriminate all patterns of bent hairs. Brushing across your head twice in a row feels very much the same, even though it is certain to cause two different patterns of activity among the touch receptors. As for <italic>E. coli</italic> chemotaxis, there is a benefit to detecting many possible sensory inputs, but no need to discriminate all possible patterns of those inputs.</p><p>Beyond arguments by analogy, some recent studies of human olfaction suggest that the perceptual space for odors may have rather few dimensions. Furthermore, the dominant axes of this perceptual space can be related systematically to the physical characteristics of odorous molecules (<xref ref-type="bibr" rid="bib8">Secundo et al., 2014</xref>). Another relevant observation is that mixtures containing many (&gt;20) diverse odorants tend to smell alike, even if they don't share any molecular components (<xref ref-type="bibr" rid="bib11">Weiss et al., 2012</xref>), a phenomenon that has been termed ‘olfactory white’, in analogy to the ‘white’ percept associated with a mix of many colored lights. This suggests that the dimensionality of odor percepts may be around 20 or less. <xref ref-type="table" rid="tbl1">Table 1</xref> summarizes the number of dimensions of various spaces discussed here.<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.07865.007</object-id><label>Table 1.</label><caption><p>Number of dimensions of various spaces involved in sensory discrimination</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.07865.007">http://dx.doi.org/10.7554/eLife.07865.007</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Toy microbe</th><th>Ring model</th><th>Human color</th><th><italic>E. coli</italic> smell</th><th>Human smell</th></tr></thead><tbody><tr><td>Stimuli</td><td>∞</td><td>∞</td><td>∞</td><td>∞</td><td>∞</td></tr><tr><td>Receptors</td><td>∞</td><td>∞</td><td>3</td><td>5</td><td>∼400</td></tr><tr><td>Percepts</td><td>1</td><td>1</td><td>3</td><td>1</td><td>1–20?</td></tr></tbody></table><table-wrap-foot><fn><p>The symbol ∞ stands for ‘very large or infinite’.</p></fn></table-wrap-foot></table-wrap></p><p>A useful experimental approach might then be to rigorously measure the dimensionality of perceptual space <italic>at least at one point</italic>. For example, choose <italic>N</italic> primary odors, and consider arbitrary mixtures of those as the odor space. Define the ‘white point’ as the mixture of all those odors at half concentration, that is, the odor vector w = (0.5,…,0.5). How does odor perception vary as the stimulus deviates a little from this point? To first order, the discriminability <italic>d</italic> between the white odor at w and an odor at w + x will vary as a quadratic form of the deviation vector x, namely: <italic>d</italic> = x<sup>T</sup> S x. We want to know the sensitivity matrix S. By definition it is positive definite and symmetric, and thus has <italic>N</italic>(<italic>N</italic> + 1)/2 unknown components. So one needs to measure the just-discriminable-distance along <italic>N</italic>(<italic>N</italic> + 1)/2 directions from the white point. Clearly this is an experimental challenge, but it seems plausible at least for <italic>N</italic> = 20. If so, then the structure of the matrix S can reveal the dimensionality: In particular, if it has just a few large eigenvalues, those identify the relevant directions in odor space. By contrast, if all eigenvalues are comparable, then the perceptual space has dimensions higher than <italic>N</italic>.</p><p>Animal studies can play an important role here. Mice are readily trained to distinguish odors, even closely related mixtures. More importantly, they offer an opportunity to stimulate the receptor neurons directly, by optogenetic activation of the olfactory bulb (<xref ref-type="bibr" rid="bib9">Spors et al., 2012</xref>). In a suitably engineered animal one could drive arbitrary activation patterns of the different olfactory receptor types by shining patterned light onto the glomeruli in the olfactory bulb. This approach promises several benefits in a study of odor dimensions: First, it does away with the tedium of olfactory stimulation, such as mixing dozens of vapors, switching valves, flushing tubes, and waiting for odors to dissipate. Using light, a different combination of receptors can be driven with millisecond precision and at high repetition rates. Also, this method allows patterns of stimulation that may not ever occur with natural odorants; one could then test if the perceptual space differs from receptor space, and is shaped to the ecology of real odors.</p><p>In a way, one can think of the olfactory bulb surface as a retina for the smell system. Olfactory objects produce spatio-temporal patterns on this surface, and the downstream neural circuits are busy identifying, discriminating, or learning those spatio-temporal patterns. The optogenetic approach simply takes the analogy one step further by using light as a stimulus. At the same time, there is a parallel effort ongoing in vision science to determine the dimensionality of human pattern vision. It is clear already that the number of dimensions is much lower than the number of receptors on the retina. One can make pairs of visual images that have very different effects on the retina, but look the same to human subjects (<xref ref-type="bibr" rid="bib2">Freeman and Simoncelli, 2011</xref>). And a systematic approach to measuring dimensionality of pattern vision is beginning to yield results (JD Victor, personal communication). Based on these developments, I suggest that pursuing the analogy of smell to pattern vision will be more fruitful than the analogy to color vision.</p><p>Regardless of approach though, determining the dimensionality of the space of odor percepts is a precondition to estimating the number of distinct percepts. The recognition that color space is three-dimensional has had enormous impact in science, art, and technology, as anyone reading this on a color monitor will confirm. The search for a similar basis set for odors has fascinated scientists, engineers, and perfumers for some time (<xref ref-type="bibr" rid="bib3">Gilbert, 2008</xref>). Even proving that a low-dimensional basis does not exist would be a major advance.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>All simulations and graphics were produced with Igor (Wavemetrics, Tigard, OR). Annotated code is available as a supplement to this article (<xref ref-type="supplementary-material" rid="SD1-data">Source Code 1</xref>). Simulation of the three models (<xref ref-type="fig" rid="fig1 fig2 fig3">Figures 1–3</xref>) followed the same process as the human odor tests performed in <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref>:<list list-type="order"><list-item><p>Selection of the 128 primary stimuli. These were drawn at random from the stimulus space. <xref ref-type="fig" rid="fig1">Figure 1</xref>: binary distribution over (−1, +1). <xref ref-type="fig" rid="fig2">Figure 2</xref>: Uniform distribution of R, G, and B over [0, 1], followed by normalization to a length of 1/30. <xref ref-type="fig" rid="fig3">Figure 3</xref>: Uniform distribution on the unit circle. These are conservative choices, in that a random set of primaries does not cover the stimulus space particularly well, and thus will produce mixtures that occupy only a portion of the space. This will therefore underestimate the number of discriminable stimuli. By contrast Bushdid et al. chose odors that were ‘well distributed in both perceptual and physicochemical stimulus space’.</p></list-item><list-item><p>Creation of mixtures. Pairs of mixtures containing <italic>N</italic> primaries of which <italic>O</italic> are shared were created by choosing at random 2<italic>N</italic>-<italic>O</italic> components from the set of primaries, summing the first <italic>N</italic> to mixture 1, and the last <italic>N</italic> to mixture 2. For every class of mixtures (i.e., combination of <italic>N</italic> and <italic>O</italic>), 20 mixture pairs were created. The rules for combining the stimulus values in a mixture were as follows: <xref ref-type="fig" rid="fig1">Figure 1</xref>: Simple addition of the binary stimulus values. <xref ref-type="fig" rid="fig2">Figure 2</xref>: Addition of the primary vectors. <xref ref-type="fig" rid="fig3">Figure 3</xref>: Addition of the unit vectors followed by normalization to unit length. This normalization emulates the elimination of odor intensity cues in <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref>.</p></list-item><list-item><p>Discrimination test. Every pair of mixtures was presented to the model to determine whether it was discriminable or not. <xref ref-type="fig" rid="fig1">Figure 1</xref>: The model classifies every mixture of <italic>N</italic> = 30 odors into the percepts ‘yum’, ‘meh’, or ‘yuck’ depending on whether the sum of stimulus values is &gt;2, from 2 to −2, or &lt;−2 respectively. Two mixtures that fall into different classes are discriminable. <xref ref-type="fig" rid="fig2">Figure 2</xref>: The model performs an odd-man-out discrimination test among three samples as done for human subjects in <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref>. Two of the samples contain mixture 1 and the third contains mixture 2. Perceptual noise was simulated by adding a Gaussian random variable to each of the three coordinates of the mixture vectors. The resulting three sample vectors are inspected and the two with the smallest distance are declared to be the same. For every mixture, this is performed 26 times, with different draws from the noise distribution. A mixture pair is declared discriminable if the model gives the correct response on &gt;50% (14 or more) of those trials (note chance performance is 1/3). In <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref> these 26 trials were performed by 26 different human subjects. There was some indication that different subjects had different abilities, but the analysis merged them all. In my simulation, all trials were done with the same amount of perceptual noise. The noise magnitude was chosen so that stimuli separated by a distance of 0.01 are just discriminable. This leads to ∼1 million distinct percepts in the RGB stimulus space, a conservative choice, because the empirical estimates of that number are somewhat larger. <xref ref-type="fig" rid="fig3">Figure 3</xref>: This followed the same odd-man-out procedure as for <xref ref-type="fig" rid="fig2">Figure 2</xref>. Perceptual noise was simulated by adding a Gaussian random variable to the angle of the mixture vector (<xref ref-type="fig" rid="fig3">Figure 3A</xref>).</p></list-item><list-item><p>Discriminability of mixture classes. For each class of mixtures I computed what fraction of the 20 were discriminable (by the criteria in 3), and plotted this against the mixture overlap (<xref ref-type="fig" rid="fig1">Figures 1A</xref>, <xref ref-type="fig" rid="fig2">2B,C</xref>, <xref ref-type="fig" rid="fig3">3C</xref>). To estimate the reliability of the simulation, the entire procedure was repeated 1000 times (with different random numbers) and the plots show the mean and standard deviation of the outcome. <xref ref-type="fig" rid="fig3">Figure 3C</xref> shows my simulation along with the data from the Bushdid et al.'s human experiments.</p></list-item><list-item><p>Estimating the number of discriminable stimuli. From the graph of discriminability vs overlap, the critical distance <italic>D</italic> was taken to be the number of unshared stimuli that allows 50% discriminability in that class of mixtures. The number of regions of diameter <italic>D</italic> that can fit into the stimulus space was computed using the formula presented in <xref ref-type="bibr" rid="bib1">Bushdid et al. (2014)</xref> (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). If there are <italic>C</italic> primaries total and <italic>N</italic> primaries per mixture, then the number <italic>S</italic> of such regions is claimed to be</p></list-item></list><disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>C</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>N</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>N</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>R</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>C</mml:mi><mml:mi>−</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>R</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>Many thanks to Adam Shai for extended discussions.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The author declares that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>MM, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.07865.008</object-id><label>Source code 1.</label><caption><p>Annotated Igor (Wavemetrics) code.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.07865.008">http://dx.doi.org/10.7554/eLife.07865.008</ext-link></p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-07865-code1-v1.zip"/></supplementary-material></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bushdid</surname><given-names>C</given-names></name><name><surname>Magnasco</surname><given-names>MO</given-names></name><name><surname>Vosshall</surname><given-names>LB</given-names></name><name><surname>Keller</surname><given-names>A</given-names></name></person-group><year>2014</year><article-title>Humans can discriminate more than 1 trillion olfactory stimuli</article-title><source>Science</source><volume>343</volume><fpage>1370</fpage><lpage>1372</lpage><pub-id pub-id-type="doi">10.1126/science.1249168</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freeman</surname><given-names>J</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name></person-group><year>2011</year><article-title>Metamers of the ventral stream</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>1195</fpage><lpage>1201</lpage><pub-id pub-id-type="doi">10.1038/nn.2889</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gilbert</surname><given-names>A</given-names></name></person-group><year>2008</year><source>What the nose knows: the science of scent in everyday life</source><publisher-name>Crown publishing</publisher-name></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grebe</surname><given-names>TW</given-names></name><name><surname>Stock</surname><given-names>J</given-names></name></person-group><year>1998</year><article-title>Bacterial chemotaxis: the five sensors of a bacterium</article-title><source>Current Biology</source><volume>8</volume><fpage>R154</fpage><lpage>R157</lpage><pub-id pub-id-type="doi">10.1016/S0960-9822(98)00098-0</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malnic</surname><given-names>B</given-names></name><name><surname>Godfrey</surname><given-names>PA</given-names></name><name><surname>Buck</surname><given-names>LB</given-names></name></person-group><year>2004</year><article-title>The human olfactory receptor gene family</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>101</volume><fpage>2584</fpage><lpage>2589</lpage><pub-id pub-id-type="doi">10.1073/pnas.0307882100</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masaoka</surname><given-names>K</given-names></name><name><surname>Berns</surname><given-names>RS</given-names></name><name><surname>Fairchild</surname><given-names>MD</given-names></name><name><surname>Moghareh Abed</surname><given-names>F</given-names></name></person-group><year>2013</year><article-title>Number of discernible object colors is a conundrum</article-title><source>Journal of the Optical Society of America. A, Optics, Image Science, and Vision</source><volume>30</volume><fpage>264</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1364/JOSAA.30.000264</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Mollon</surname><given-names>JD</given-names></name></person-group><year>2003</year><article-title>The origins of modern color science</article-title><person-group person-group-type="editor"><name><surname>Shevell</surname><given-names>S</given-names></name></person-group><source>Color science</source><publisher-loc>Washington</publisher-loc><publisher-name>Optical Society of America</publisher-name><fpage>1</fpage><lpage>36</lpage></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Secundo</surname><given-names>L</given-names></name><name><surname>Snitz</surname><given-names>K</given-names></name><name><surname>Sobel</surname><given-names>N</given-names></name></person-group><year>2014</year><article-title>The perceptual logic of smell</article-title><source>Current Opinion in Neurobiology</source><volume>25</volume><fpage>107</fpage><lpage>115</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2013.12.010</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spors</surname><given-names>H</given-names></name><name><surname>Albeanu</surname><given-names>DF</given-names></name><name><surname>Murthy</surname><given-names>VN</given-names></name><name><surname>Rinberg</surname><given-names>D</given-names></name><name><surname>Uchida</surname><given-names>N</given-names></name><name><surname>Wachowiak</surname><given-names>M</given-names></name><name><surname>Friedrich</surname><given-names>RW</given-names></name></person-group><year>2012</year><article-title>Illuminating vertebrate olfactory processing</article-title><source>The Journal of Neuroscience</source><volume>32</volume><fpage>14102</fpage><lpage>14108</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3328-12.2012</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wandell</surname><given-names>BA</given-names></name></person-group><year>1995</year><source>Foundations of vision</source><publisher-name>Sinauer associates Inc</publisher-name></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weiss</surname><given-names>T</given-names></name><name><surname>Snitz</surname><given-names>K</given-names></name><name><surname>Yablonka</surname><given-names>A</given-names></name><name><surname>Khan</surname><given-names>RM</given-names></name><name><surname>Gafsou</surname><given-names>D</given-names></name><name><surname>Schneidman</surname><given-names>E</given-names></name><name><surname>Sobel</surname><given-names>N</given-names></name></person-group><year>2012</year><article-title>Perceptual convergence of multi-component mixtures in olfaction implies an olfactory white</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>109</volume><fpage>19959</fpage><lpage>19964</lpage><pub-id pub-id-type="doi">10.1073/pnas.1208110109</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zimmerman</surname><given-names>A</given-names></name><name><surname>Bai</surname><given-names>L</given-names></name><name><surname>Ginty</surname><given-names>DD</given-names></name></person-group><year>2014</year><article-title>The gentle touch receptors of mammalian skin</article-title><source>Science</source><volume>346</volume><fpage>950</fpage><lpage>954</lpage><pub-id pub-id-type="doi">10.1126/science.1254229</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.07865.009</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Borst</surname><given-names>Alexander</given-names></name><role>Reviewing editor</role><aff><institution>Max Planck Institute of Neurobiology</institution>, <country>Germany</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see <ext-link ext-link-type="uri" xlink:href="http://elifesciences.org/review-process">review process</ext-link>). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers.</p></boxed-text><p>Thank you for submitting your work entitled “On the dimensionality of odor space” for peer review at <italic>eLife</italic>. Your submission has been favorably evaluated by Eve Marder (Senior editor) and three reviewers, one of whom is on our Board of Reviewing Editors.</p><p>The following individuals responsible for the peer review of your submission have agreed to reveal their identity: Axel Borst (Reviewing editor); Frédéric Theunissen (peer reviewer). A further reviewer remains anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>In this manuscript, Meister re-analyzes a paper by <xref ref-type="bibr" rid="bib1">Bushdid et al., 2014</xref>, that claims that humans can discriminate one trillion odors. He shows by different methods that the claim is substantially flawed. To make this point, Meister uses different approaches. In the most immediately convincing approach, he constructs a model organism with 3 different percepts and shows that, subjected to the identical test performed by Bushdid et al., one concludes that the organism can discriminate one trillion odors: however, we know by construction that it only has three odor percepts. I repeated the model simulations myself just to confirm these results. Meister further analyzes the method and demonstrates convincingly that the mistake ‘in depth’ made by Bushdid et al. is that it equates the number of discriminable odor mixtures with the number of volumes that can be packed in high-dimensional odor space as calculated from the average minimal distance in odor space: it is never shown that each of these mixtures represents a unique percept in perceptual space. In the final chapter, he discusses how to measure the dimensionality of perceptual odor space, making an argument that the large number of odorant receptors might exist in order to sense the large number of different odor molecules, rather than to discriminate each one of them from each other. He furthermore advocates for using an optogenetic approach in rodents to avoid a lot of problems associated with producing and handling odorant mixtures.</p><p>The paper is well written and the toy examples intuitively demonstrate the flaw. All reviewers really enjoyed reading the manuscript and found it to be a very nice contribution worth being published in <italic>eLife</italic>. However, there are some remarks made by the reviewers that should be addressed before the paper can be published.</p><p>Essential revisions:</p><p>1) The issue requires great clarity and consistency of definitions. In particular, it concerns a number of different spaces: the space of chemical stimuli, the space(s) of neural activity, “perceptual” space and “action/behavioral” space. Meister sometimes interchanges terminology in such a way that a straight line of thought becomes hard to trace. For example, are “percepts” and “discriminable stimuli” the same thing? In the bacterial example, Meister calls the reactions alternatively “responses” and “percepts”. This quibbling about words does not change the bottom-line of Meister's argumentation, but non-defined terminology weakens it by exposing it to potential counter-arguments. The reviewers suggest to clearly define all the important words used throughout.</p><p>2) The next comment concerns Meister introducing perceptual space for color vision as being 3 dimensional, and those dimensions as being defined by the response spectra of the 3 types of cones found in trichromatic primates. But is this not a shortcut between stimulus-, neural- and perceptual spaces? The dimensions of color perception are, by some classical definitions at least, hue, lightness and saturation. In this space, colors live in a sort of spindle-shaped subspace in which perceptual hue, for example, seems to loop back onto itself, making the mapping between stimulus (say wavelength spectrum) and percept non-trivial (technically speaking, non-homeomorphic). The 3-dimensional space that Meister considers is a neural space, defined by photoreceptor subtypes, and not directly the perceptual space of color or hue. Both happen to be low dimensional, which is probably not a coincidence, and this does not change anything to the importance of quantifying humans' perceptual abilities for color discrimination; but the distinction is important because of the non-trivial nature of the mapping between these different spaces. In fact the topology-of-perceptual-space argument is related to that used by Meister in his <xref ref-type="fig" rid="fig4">Figure 4</xref> and corresponding text. We suggest rewording, so as not to weaken the otherwise valid criticisms. Also, color vision in many animals starts with many more cone types (up to 12 in some southern seas crustaceans). No one really knows how fine or structured color discrimination is in those brains. In the same vein, some human cultures name colors in ways that differ dramatically from ours. The general issue of color perception is thus potentially more complex still, and nothing indicates that the geometry of odor-perception space has much to do with that of color-perception space. Finally there is a great deal of O.R. gene polymorphism among humans, presumably increasing local variance in particular regions of odor-perception space. All this to say that, even though Bushdid et al. made regrettable methodological mistakes, the existence of a relatively simple and well-bounded solution to the problem of trichromatic vision does not guarantee the existence of similar solutions to the problem of color vision in general, or to olfaction. The critique should therefore focus better on the mathematical/statistical mistakes of Bushdid et al.</p><p>3) The third point concerns the bacterial example (“Failure on a simple 3-percept model”). Here, we have a split opinion. While two reviewers actually like the example as it is, one reviewer says the following: “I understand the aim of the example; I understand the need to illustrate the fundamental difficulty of bounding an estimate with small samples; but this particular example ends up looking like a specious construct, based on a trick. The trick is to map all possible discriminable items into three classes (so called: yuck, meh and yum), which Meister calls alternatively ‘responses’ and ‘percepts’. But ignoring for an instant that bacteria probably lack perceptual abilities, the only reason why the discriminating ability of the bacterium is so low is because of a definition that need does not apply to a real nervous system. While I understand the goal of this chapter, I think it is too facetious to be convincing.” We leave it up to the author to decide.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.07865.010</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>1) The issue requires great clarity and consistency of definitions. In particular, it concerns a number of different spaces: the space of chemical stimuli, the space(s) of neural activity, “perceptual” space and “action/behavioral” space. Meister sometimes interchanges terminology in such a way that a straight line of thought becomes hard to trace. For example, are “percepts” and “discriminable stimuli” the same thing? In the bacterial example, Meister calls the reactions alternatively “responses” and “percepts”. This quibbling about words does not change the bottom-line of Meister's argumentation, but non-defined terminology weakens it by exposing it to potential counter-arguments. The reviewers suggest to clearly define all the important words used throughout</italic>.</p><p>Yes, this vocabulary needs to be normalized. I made the following changes:</p><p>Left out reference to “perception” where it's not necessary, e.g. in the section on the toy microbe.</p><p>Precisely defined my use of the term “percept” where it starts to become useful (section “Where is the flaw?”).</p><p>Distinguished different kinds of spaces: stimuli, receptors, percepts. See text around the new <xref ref-type="table" rid="tbl1">Table 1</xref>.</p><p><italic>2) The next comment concerns Meister introducing perceptual space for color vision as being 3 dimensional, and those dimensions as being defined by the response spectra of the 3 types of cones found in trichromatic primates. But is this not a shortcut between stimulus-, neural- and perceptual spaces? The dimensions of color perception are, by some classical definitions at least, hue, lightness and saturation. In this space, colors live in a sort of spindle-shaped subspace in which perceptual hue, for example, seems to loop back onto itself, making the mapping between stimulus (say wavelength spectrum) and percept non-trivial (technically speaking, non-homeomorphic). The 3-dimensional space that Meister considers is a neural space, defined by photoreceptor subtypes, and not directly the perceptual space of color or hue. Both happen to be low dimensional, which is probably not a coincidence, and this does not change anything to the importance of quantifying humans' perceptual abilities for color discrimination; but the distinction is important because of the non-trivial nature of the mapping between these different spaces. In fact the topology-of-perceptual-space argument is related to that used by Meister in his</italic> <xref ref-type="fig" rid="fig4"><italic>Figure 4</italic></xref> <italic>and corresponding text. We suggest rewording, so as not to weaken the otherwise valid criticisms. Also, color vision in many animals starts with many more cone types (up to 12 in some southern seas crustaceans). No one really knows how fine or structured color discrimination is in those brains. In the same vein, some human cultures name colors in ways that differ dramatically from ours. The general issue of color perception is thus potentially more complex still, and nothing indicates that the geometry of odor-perception space has much to do with that of color-perception space. Finally there is a great deal of O.R. gene polymorphism among humans, presumably increasing local variance in particular regions of odor-perception space. All this to say that, even though Bushdid et al. made regrettable methodological mistakes, the existence of a relatively simple and well-bounded solution to the problem of trichromatic vision does not guarantee the existence of similar solutions to the problem of color vision in general, or to olfaction. The critique should therefore focus better on the mathematical/statistical mistakes of Bushdid et al</italic>.</p><p>The reasons to introduce human color vision are twofold: (1) That's what Bushdid et al. did. Their Abstract already claims that the human color vision pales compared to smell. I show that there's no basis for this claim. (2) This is a sensory system where we understand the physical/receptor/perceptual spaces well enough to answer the question posed by Bushdid et al.: how many discriminable stimuli are there? Tracing how this was accomplished offers a useful starting point for trying to do it in another sensory system. There is of course no expectation that the results of the method will be the same when applied to olfaction.</p><p>The descriptors “hue/saturation/lightness” are directly related to “R,G,B” (see e.g. Equation 3 in <xref ref-type="bibr" rid="bib6">Masaoka et al. 2013</xref>). But the details of how humans describe colors (e.g. hue/saturation/lightness or various color words) are not relevant to the problem. The pairwise discrimination tests (two colors presented side by side in a split field) don't require that subjects have a color name or any other descriptor for what they see. Clearly we can discriminate many more colors than we can name. The same is true for odors.</p><p><italic>3) The third point concerns the bacterial example (“Failure on a simple 3-percept model”). Here, we have a split opinion. While two reviewers actually like the example as it is, one reviewer says the following: “I understand the aim of the example; I understand the need to illustrate the fundamental difficulty of bounding an estimate with small samples; but this particular example ends up looking like a specious construct, based on a trick. The trick is to map all possible discriminable items into three classes (so called: yuck, meh and yum), which Meister calls alternatively ‘responses’ and ‘percepts’. But ignoring for an instant that bacteria probably lack perceptual abilities, the only reason why the discriminating ability of the bacterium is so low is because of a definition that need does not apply to a real nervous system. While I understand the goal of this chapter, I think it is too facetious to be convincing.” We leave it up to the author to decide</italic>.</p><p>I still think this toy model plays a useful role as a positive control. The number of discriminable odors is known a priori (3) and the calculations are very easy. More importantly, the model has all the necessary components: it treats mixtures of many stimuli, can compare pairs of such mixtures, and exhibits a clear performance limit in their discrimination. The performance limit is implemented by discretizing stimuli into a small number of classes, as opposed to using a continuous variable corrupted by noise. I fail to see anything facetious or tricky about this simplification. I added a few sentences of introduction and conclusion to this section.</p></body></sub-article></article>