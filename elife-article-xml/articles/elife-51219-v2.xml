<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">51219</article-id><article-id pub-id-type="doi">10.7554/eLife.51219</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Variability in locomotor dynamics reveals the critical role of feedback in task control</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-154102"><name><surname>Uyanik</surname><given-names>Ismail</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3535-5616</contrib-id><email>uyanik@ee.hacettepe.edu.tr</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-156119"><name><surname>Sefati</surname><given-names>Shahin</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-156120"><name><surname>Stamper</surname><given-names>Sarah A</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-156121"><name><surname>Cho</surname><given-names>Kyoung-A</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-156122"><name><surname>Ankarali</surname><given-names>M Mert</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-156123"><name><surname>Fortune</surname><given-names>Eric S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6447-5425</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-27476"><name><surname>Cowan</surname><given-names>Noah J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2502-3770</contrib-id><email>ncowan@jhu.edu</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Department of Electrical and Electronics Engineering, Hacettepe University</institution><addr-line><named-content content-type="city">Ankara</named-content></addr-line><country>Turkey</country></aff><aff id="aff2"><label>2</label><institution>Laboratory of Computational Sensing and Robotics, Johns Hopkins University</institution><addr-line><named-content content-type="city">Baltimore</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Department of Biological Sciences, New Jersey Institute of Technology</institution><addr-line><named-content content-type="city">Newark</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution>Department of Mechanical Engineering, Johns Hopkins University</institution><addr-line><named-content content-type="city">Baltimore</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution>Department of Electrical and Electronics Engineering, Middle East Technical University</institution><addr-line><named-content content-type="city">Ankara</named-content></addr-line><country>Turkey</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Senior Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>23</day><month>01</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e51219</elocation-id><history><date date-type="received" iso-8601-date="2019-08-20"><day>20</day><month>08</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2020-01-21"><day>21</day><month>01</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Uyanik et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Uyanik et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-51219-v2.pdf"/><abstract><p>Animals vary considerably in size, shape, and physiological features across individuals, but yet achieve remarkably similar behavioral performances. We examined how animals compensate for morphophysiological variation by measuring the system dynamics of individual knifefish (<italic>Eigenmannia virescens</italic>) in a refuge tracking task. Kinematic measurements of <italic>Eigenmannia</italic> were used to generate individualized estimates of each fish’s locomotor plant and controller, revealing substantial variability between fish. To test the impact of this variability on behavioral performance, these models were used to perform simulated ‘brain transplants’—computationally swapping controllers and plants between individuals. We found that simulated closed-loop performance was robust to mismatch between plant and controller. This suggests that animals rely on feedback rather than precisely tuned neural controllers to compensate for morphophysiological variability.</p></abstract><abstract abstract-type="executive-summary"><title>eLife digest</title><p>People come in different shapes and sizes, but most will perform similarly well if asked to complete a task requiring fine manual dexterity – such as holding a pen or picking up a single grape. How can different individuals, with different sized hands and muscles, produce such similar movements? One explanation is that an individual’s brain and nervous system become precisely tuned to mechanics of the body’s muscles and skeleton. An alternative explanation is that brain and nervous system use a more “robust” control policy that can compensate for differences in the body by relying on feedback from the senses to guide the movements.</p><p>To distinguish between these two explanations, Uyanik et al. turned to weakly electric freshwater fish known as glass knifefish. These fish seek refuge within root systems, reed grass and among other objects in the water. They swim backwards and forwards to stay hidden despite constantly changing currents. Each fish shuttles back and forth by moving a long ribbon-like fin on the underside of its body. Uyanik et al. measured the movements of the ribbon fin under controlled conditions in the laboratory, and then used the data to create computer models of the brain and body of each fish. The models of each fish’s brain and body were quite different.</p><p>To study how the brain interacts with the body, Uyanik et al. then conducted experiments reminiscent of those described in the story of Frankenstein and transplanted the brain from each computer model into the body of different model fish. These “brain swaps” had almost no effect on the model’s simulated swimming behavior. Instead, these “Frankenfish” used sensory feedback to compensate for any mismatch between their brain and body.</p><p>This suggests that, for some behaviors, an animal’s brain does not need to be precisely tuned to the specific characteristics of its body. Instead, robust control of movement relies on many seemingly redundant systems that provide sensory feedback. This has implications for the field of robotics. It further suggests that when designing robots, engineers should prioritize enabling the robots to use sensory feedback to cope with unexpected events, a well-known idea in control engineering.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>sensorimotor control</kwd><kwd>locomotor dynamics</kwd><kwd>sensory feedback</kwd><kwd><italic>Eigenmannia virescens</italic></kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1557895</award-id><principal-award-recipient><name><surname>Cowan</surname><given-names>Noah J</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1557858</award-id><principal-award-recipient><name><surname>Fortune</surname><given-names>Eric S</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Animals rely on sensory feedback rather than the precise tuning in the nervous system to achieve robust behavioral performances.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Animals routinely exhibit dramatic variations in morphophysiology between individuals but can nevertheless achieve similar performance in sensorimotor tasks (<xref ref-type="bibr" rid="bib43">Sponberg et al., 2015</xref>; <xref ref-type="bibr" rid="bib6">Bullimore and Burn, 2006</xref>). Further, individual animals can experience rapid changes in their own morphophysiological features, such as extreme weight changes that occur during and between bouts of feeding. For example, mosquitoes can consume more than their body weight (<xref ref-type="bibr" rid="bib52">Van Handel, 1965</xref>) and hummingbirds can consume up to 20% of their body weight (<xref ref-type="bibr" rid="bib22">Hou et al., 2015</xref>) in a single feeding. How neural control systems accommodate these changes is not known.</p><p>The behavioral performance of an individual animal is determined via an interplay between its ‘controller’ and ‘plant’ (<xref ref-type="bibr" rid="bib24">Kiemel et al., 2011</xref>; <xref ref-type="bibr" rid="bib51">van der Kooij and Peterka, 2011</xref>; <xref ref-type="bibr" rid="bib8">Cowan et al., 2014</xref>; <xref ref-type="bibr" rid="bib12">Dickinson et al., 2000</xref>; <xref ref-type="bibr" rid="bib20">Hedrick et al., 2009</xref>). The plant typically includes musculoskeletal components that interact with the environment to generate movement (<xref ref-type="bibr" rid="bib21">Hedrick and Robinson, 2010</xref>; <xref ref-type="bibr" rid="bib42">Sefati et al., 2013</xref>; <xref ref-type="bibr" rid="bib31">Maladen et al., 2009</xref>). The controller typically includes sensory systems and neural circuits used to process information to generate motor commands (<xref ref-type="bibr" rid="bib9">Cowan and Fortune, 2007</xref>; <xref ref-type="bibr" rid="bib24">Kiemel et al., 2011</xref>; <xref ref-type="bibr" rid="bib29">Lockhart and Ting, 2007</xref>; <xref ref-type="bibr" rid="bib39">Roth et al., 2014</xref>). From the perspective of control theory, one might expect the dynamics of the controller to be precisely tuned to the dynamics of the plant, resulting in an optimal control law that reduces variability in task performance (<xref ref-type="bibr" rid="bib46">Todorov, 2004</xref>; <xref ref-type="bibr" rid="bib15">Franklin and Wolpert, 2011</xref>; <xref ref-type="bibr" rid="bib1">Bays and Wolpert, 2007</xref>). Were this the case, variations across individuals in morphophysiological features of their plants should manifest in commensurate differences in each animal’s controller. Alternatively, the central nervous system (CNS) may be implementing robust feedback control that attenuates morphophysiological variability at the behavioral level without the need for precise tuning.</p><p>Investigating these relationships requires separate estimates for plants and controllers. However, the classical input–output system identification of behavioral tasks—using only the sensory input and the behavioral output—is limited to generating closed-loop control models of behavioral responses. Data-driven system identification of the underlying neural controllers or locomotor plants requires additional observations such as a measurement of the control output. Electromyograms (EMGs) are the most commonly used proxy for the output of the neural controller. EMGs allow separate data-driven estimates of the controller and plant (<xref ref-type="bibr" rid="bib24">Kiemel et al., 2011</xref>; <xref ref-type="bibr" rid="bib51">van der Kooij and Peterka, 2011</xref>) but require understanding the coordination strategy across multiple groups of muscles that interact in fundamentally nonlinear ways (<xref ref-type="bibr" rid="bib45">Ting and Macpherson, 2005</xref>).</p><p>We studied refuge tracking in a species of weakly electric fish <italic>Eigenmannia virescens</italic> (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), a system that permits identification of input–output dynamics as well as the locomotor plant via behavioral observations alone. Like an ‘aquatic hummingbird’, <italic>Eigenmannia</italic> precisely hover in place, making rapid and nuanced adjustments to its position in response to the movement of the refuge in which it is hiding (<xref ref-type="bibr" rid="bib37">Rose and Canfield, 1993</xref>; <xref ref-type="bibr" rid="bib38">Roth et al., 2011</xref>; <xref ref-type="bibr" rid="bib50">Uyanik et al., 2019b</xref>; <xref ref-type="video" rid="fig1video1">Figure 1—video 1</xref>). During refuge tracking, individual <italic>Eigenmannia</italic> generate fore-aft thrust forces using undulatory motions of their ventral ribbon fin. Undulations are initiated at the rostral and caudal ends of the fin resulting in counter propagating waves that travel towards each other (<xref ref-type="bibr" rid="bib42">Sefati et al., 2013</xref>; <xref ref-type="bibr" rid="bib41">Ruiz-Torres et al., 2013</xref>). The two traveling waves meet at a position along the ribbon fin known as the nodal point (<xref ref-type="video" rid="fig1video2">Figure 1—video 2</xref>). In a task in which the fish maintains position in a stationary refuge, <italic>Eigenmannia</italic> shift the rostrocaudal position of the nodal point as a function of steady-state swimming speed (<xref ref-type="bibr" rid="bib42">Sefati et al., 2013</xref>; <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), providing a behavioral proxy for the controller’s output, without reliance on EMGs.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Experimental analysis of refuge tracking behavior.</title><p>(<bold>A</bold>) <italic>Eigenmannia virescens</italic> maintains its position, <inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, in a moving refuge. <inline-formula><mml:math id="inf2"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the position of the moving refuge. (<bold>B</bold>) A feedback control system model for refuge tracking. The feedback controller <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> maps the error signal, <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, to a control signal, <inline-formula><mml:math id="inf5"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The plant <inline-formula><mml:math id="inf6"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, in turn, generates fore-aft movements <inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We used measurements of the nodal point as <inline-formula><mml:math id="inf8"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to estimate <inline-formula><mml:math id="inf9"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in each fish, which was subsequently used to infer <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. (<bold>C</bold>) <italic>Eigenmannia virescens</italic> partitions its ribbon fin into two counter-propagating waves that generate opposing forces (<xref ref-type="bibr" rid="bib42">Sefati et al., 2013</xref>; <xref ref-type="bibr" rid="bib41">Ruiz-Torres et al., 2013</xref>). The rostral-to-caudal and caudal-to-rostral waves collide at the nodal point (green line). Movements of the nodal point serve as a proxy for the control signal, <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Gray lines indicate the positions of the peaks and troughs of the traveling waves over time. In this trial, the refuge was following a sinusoidal trajectory at 2.05 Hz. (<bold>D</bold>) Movement of the nodal point <inline-formula><mml:math id="inf12"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, position of the fish <inline-formula><mml:math id="inf13"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and position of the refuge <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of 13 trials at 0.95 Hz. Semi-transparent lines represent data from individual trials, green and blue lines are the means.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51219-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Steady-state position of the nodal point.</title><p>Three examples of steady-state, constant-speed swimming that illustrate how the peaks and troughs of the ribbon fin wave propagate toward the nodal point. The purple lines indicate the positions of the peaks and troughs of the traveling waves initiated at the rostral end of the ribbon fin. Orange lines indicate the traveling waves initiated at the caudal end of the ribbon fin. These waves meet at the nodal point (green). (left) Peaks, troughs, and nodal point reference location during station keeping, <inline-formula><mml:math id="inf15"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. (center) The nodal point shifts caudally relative to the reference position during steady-state forward swimming, <inline-formula><mml:math id="inf16"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and (right) shifts rostrally for backward swimming, <inline-formula><mml:math id="inf17"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51219-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Movement of the refuge, fish and nodal point.</title><p>Averaged movements (across all trials for one fish) of the nodal point <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (green) and the fish <inline-formula><mml:math id="inf19"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (blue) with respect to refuge movements <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (red) at (<bold>A</bold>) 0.55 Hz, (<bold>B</bold>) 0.95 Hz, and (<bold>C</bold>) 2.05 Hz.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51219-fig1-figsupp2-v2.tif"/></fig><media id="fig1video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-51219-fig1-video1.mp4"><label>Figure 1—video 1.</label><caption><title>A real-time video recorded at 30 fps from below of an <italic>Eigenmannia virescens</italic> tracking a moving refuge at 0.55 Hz.</title><p>The movement of the refuge and fish are plotted below the video.</p></caption></media><media id="fig1video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-51219-fig1-video2.mp4"><label>Figure 1—video 2.</label><caption><title>A high-speed video recorded at 100 fps from below an <italic>Eigenmannia virescens</italic> while tracking a moving refuge at 2.05 Hz.</title><p>The video is stabilized with respect to fish position to illustrate the movements of the head and tail waves that form the nodal point. The inset shows the rectangular area around the ribbon fin of the fish. The video is played in real-time (10 repetitions), at 0.3 × speed (3 repetitions) and at 0.1 × speed (1 repetition).</p></caption></media></fig-group><p>We measured tracking performance and moment-to-moment position of the nodal point in three fish during a refuge tracking task. Despite the fact that tracking performance of the three fish were similar, there were nevertheless large variations in the movement of the nodal point, reflecting morphophysiological differences between individuals. We used computational techniques, specifically data-driven system identification of feedback control models, to explore how neural control systems cope with individual variability in locomotor dynamics.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>We measured the performance of three fish in a refuge tracking task by comparing the position of the refuge <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with the position of the fish <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). These measurements are used in a feedback control model in which ‘error signal’ <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is defined as the difference between <inline-formula><mml:math id="inf24"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf25"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). To separately estimate the controller <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the plant <inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, a measurement of the control signal <inline-formula><mml:math id="inf28"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is necessary. In <italic>Eigenmannia</italic>, the position of the nodal point can be measured over time (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, <xref ref-type="video" rid="fig1video2">Figure 1—video 2</xref>). During refuge tracking behavior, we observed that the position of the nodal point appears to have a linear relationship to <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> making it a candidate readout of <inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). Using <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we estimated <inline-formula><mml:math id="inf33"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for each fish and calculated their corresponding controllers <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We used <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of each fish to computationally manipulate the interplay between the controller, plant and the sensory feedback.</p><sec id="s2-1"><title>Estimating a data-driven plant model</title><p>We estimated a data-driven model for the plant dynamics <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of each fish. For the purpose of visualizing the plant models graphically, it is useful to treat the plant, <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, as a filter through which motor commands are processed. At a given frequency, <inline-formula><mml:math id="inf39"><mml:mi>ω</mml:mi></mml:math></inline-formula>, the filter’s behavior can be represented as a complex number, called a phasor, that is obtained by evaluating the transfer function <inline-formula><mml:math id="inf40"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at that frequency, namely <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>.</p><p>The locus of phasors as a function of frequency is called the frequency response function. We estimated the frequency responses of the locomotor dynamics of each fish using the position of the fish <inline-formula><mml:math id="inf43"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and its nodal point <inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. To visualize the variability across plants, we used a Nyquist plot. On such a plot, the gain and phase of the response of the plant at a given frequency are represented in polar form, where the <italic>x</italic> axis is the real part and the y axis is the imaginary part—both dimensionless. The gain is the distance from the origin <italic>0+j0</italic>, and the phase is the angle measured counterclockwise from the real axis. Nyquist plots of each individual's estimated plant revealed substantial differences between locomotor plants of individual fish (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). Despite these differences, the frequency responses shared a common structure: the locomotor dynamics of each fish acted as a low-pass filter on the movements of the nodal point. This common structure facilitated the application of parametric modeling, reducing the complexity of analysis while enabling computational manipulations of the model system. We used the physics-based parametric model of locomotor dynamics of <italic>Eigenmannia</italic> described by <xref ref-type="bibr" rid="bib42">Sefati et al. (2013)</xref> for the plant (see Materials and methods for derivation):<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf45"><mml:mi>m</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf46"><mml:mi>k</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf47"><mml:mi>b</mml:mi></mml:math></inline-formula> represent mass, gain, and damping, respectively, and <inline-formula><mml:math id="inf48"><mml:mi>s</mml:mi></mml:math></inline-formula> is complex frequency in Laplace domain (see, e.g. <xref ref-type="bibr" rid="bib39">Roth et al., 2014</xref>). We estimated the parameters in the parametric plant model for each fish based on their individualized frequency responses via numerical optimization (see Materials and methods) (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Frequency responses for the estimated parametric models are illustrated in <xref ref-type="fig" rid="fig2">Figure 2C</xref> (see black lines in <xref ref-type="fig" rid="fig2">Figure 2A</xref> for corresponding Nyquist plots). Finally, we estimated the plant for a ‘merged’ fish, in which the data from the three fish were concatenated as a single fish. The differences in the frequency responses between individuals resulted in substantial differences (about twofold) in estimated model parameters (<xref ref-type="table" rid="table1">Table 1</xref>). Moreover, the merged fish has plant dynamics that differ from each of the individual fish (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, bottom), highlighting the need to use individualized plants for the analysis of the control system of each fish.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>System identification of plant dynamics.</title><p>(<bold>A</bold>) Nyquist plots of the estimated plant models for each individual fish and the merged fish. Blue, green and cyan point clouds correspond to bootstrapped data estimates for the low (0.55 Hz), medium (0.95 Hz) and high (2.05 Hz) frequencies, respectively. Black circles and cross marks represent the mean for measured and bootstrapped data, respectively. Black lines represent the response of the estimated model with diamonds indicating their values at the test frequencies. Each point on the black lines correspond to the complex-valued frequency response of the plant model at a specific frequency. For example, the purple dot on the lower-right panel corresponds to the merged-plant-model’s response at <italic>0.7 Hz</italic>. The gain and phase associated with this response are shown on the associated Bode plots given in (C). (<bold>B</bold>) Reconciliation of physics-based and data-driven models. The solid lines represent the natural feedback control system used by the fish for refuge tracking. The dashed lines represent copies of signals used for parametric system identification. <inline-formula><mml:math id="inf49"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> represents the parametric transfer function for the plant dynamics of the fish with ‘unknown’ system parameters. The parametric system identification estimates these parameters via minimizing the difference (modeling error) between the actual output of the fish <inline-formula><mml:math id="inf50"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the prediction of the model. (<bold>C</bold>) Gain and phase plots of the frequency response functions of the estimated parametric models for each fish and the merged fish corresponding to the black lines in (<bold>A</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51219-fig2-v2.tif"/></fig><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Estimated parameters of the plant model for each fish as well as the merged fish.</title></caption><table frame="hsides" rules="groups"><thead><tr><th/><th><italic>Fish 1</italic></th><th><italic>Fish 2</italic></th><th><italic>Fish 3</italic></th><th><italic>Merged</italic></th></tr></thead><tbody><tr><td><inline-formula><mml:math id="inf51"><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>k</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>0.3228</td><td>0.2200</td><td>0.1622</td><td>0.2385</td></tr><tr><td><inline-formula><mml:math id="inf52"><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>b</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>0.0417</td><td>0.0186</td><td>0.0218</td><td>0.0269</td></tr><tr><td><inline-formula><mml:math id="inf53"><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>m</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>0.0025</td><td>0.0025</td><td>0.0025</td><td>0.0025</td></tr></tbody></table></table-wrap></sec><sec id="s2-2"><title>Examining the effects of feedback on behavioral variability</title><p>Despite the differences in plant dynamics, fish produced remarkably similar tracking performance, consistent with previously published reports (<xref ref-type="bibr" rid="bib9">Cowan and Fortune, 2007</xref>; <xref ref-type="bibr" rid="bib38">Roth et al., 2011</xref>). This behavioral robustness could be achieved via precise tuning between the controller and plant dynamics of each fish. Alternatively, the central nervous system (CNS) may be implementing robust feedback control without the need for precise tuning. To test these hypotheses, we built feedback control models that permit computational manipulation of the relationships between controller and plant. Specifically, we swapped the controllers and plants between fish using these computational models (<xref ref-type="fig" rid="fig3">Figure 3</xref>). If each fish required precise tuning for consistent behavior, we would expect to see increased variability for the swapped models. Alternatively, a robust feedback controller might be insensitive to mismatch between <inline-formula><mml:math id="inf54"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> pairs.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Computational brain swapping between fish.</title><p>We computationally swapped the individually tailored controllers between fish. The feedback control diagrams illustrate computational brain swaps. The controller from the light gray fish, <inline-formula><mml:math id="inf56"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is used to control the plant of the dark gray fish, <inline-formula><mml:math id="inf57"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and vice versa.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51219-fig3-v2.tif"/></fig><p>We used the second order model proposed by <xref ref-type="bibr" rid="bib9">Cowan and Fortune (2007)</xref> to represent the input–output behavioral response of the fish:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>We estimated the model parameters for each fish using the position of the fish <inline-formula><mml:math id="inf58"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the refuge <inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In other words, we generated individualized parametric transfer functions that capture the input–output behavioral performance of each fish. Parameters varied by about 15–20% (<xref ref-type="table" rid="table2">Table 2</xref>).</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Estimated parameters of the second order input-output model for each fish as well as the merged fish.</title></caption><table frame="hsides" rules="groups"><thead><tr><th/><th><italic>Fish 1</italic></th><th><italic>Fish 2</italic></th><th><italic>Fish 3</italic></th><th><italic>Merged</italic></th></tr></thead><tbody><tr><td><inline-formula><mml:math id="inf60"><mml:mi>A</mml:mi></mml:math></inline-formula></td><td>0.53</td><td>0.60</td><td>0.52</td><td>0.57</td></tr><tr><td><inline-formula><mml:math id="inf61"><mml:mi>ξ</mml:mi></mml:math></inline-formula></td><td>0.58</td><td>0.55</td><td>0.52</td><td>0.55</td></tr><tr><td><inline-formula><mml:math id="inf62"><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>ω</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>8.55</td><td>9.51</td><td>7.88</td><td>8.50</td></tr></tbody></table></table-wrap><p>We investigated how the variability in plant dynamics (parameters varied by about twofold; <xref ref-type="table" rid="table1">Table 1</xref>) is mitigated at the level of behavior (parameters varied by 15–20%; <xref ref-type="table" rid="table2">Table 2</xref>). Specifically, we inferred a controller for each fish using models of their respective plant dynamics and input–output behavioral responses. Given the plant <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and behavioral performance <inline-formula><mml:math id="inf64"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of each individual fish, we can infer the controller for each fish using the following equation (see Materials and methods and <xref ref-type="bibr" rid="bib9">Cowan and Fortune, 2007</xref>):<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Estimates of controllers and plants for individual fish allowed us to implement computational manipulations in the system models. Given a model of each fish’s plant and controller, we computed the transfer function of the closed-loop system using each fish’s own controller when matched with its own plant (‘matched’, <xref ref-type="fig" rid="fig4">Figure 4A</xref>), via the equation (see <xref ref-type="disp-formula" rid="equ11">Equation 11</xref>, Materials and methods):<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>matched</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>for <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. Then, to test the hypothesis that the animals rely on precise tuning between their plants and controllers, we substituted the controller of each fish with the plant dynamics of other fish (see ‘swapped’ in <xref ref-type="fig" rid="fig4">Figure 4A</xref>), that is a simulated brain transplant, namely<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>swapped</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>whereby each controller <inline-formula><mml:math id="inf66"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> is paired with another fish’s plant <inline-formula><mml:math id="inf67"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>, for a total of 6 ‘swapped’ cases. If the controllers and plants need to be co-tuned, then we would expect a significant increase in variability in the swapped models.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Effects of feedback on behavioral variability.</title><p>At the top of each column is a control diagram that corresponds to all figures in that column. (<bold>A</bold>) Frequency-response gain and phase plots of the estimated input–output models for the matched (orange), swapped (gray), and merged (green) fish in a feedback control topology. (<bold>B</bold>) Variability of the matched (orange) and swapped (gray) models. Dashed line is the behavioral variability observed in the tracking data across fish. (<bold>C</bold>) Same as in (<bold>B</bold>) but for the loop gain, <inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. (<bold>D</bold>) Same as in (<bold>C</bold>) but for the loop gain, <inline-formula><mml:math id="inf69"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51219-fig4-v2.tif"/></fig><p>To quantify such changes in variability and to evaluate the fitness of a given computational model for explaining biological data, we defined two metrics termed ‘model variability’ and ‘behavioral variability’. Model variability quantifies the variability of the complex-valued frequency responses of matched or swapped models across a range of frequencies. Behavioral variability, on the other hand, provides a conservative estimate of the variability observed across trials in the real fish. See Model variability and Bootstrap estimate of behavioral variability in Materials and methods.</p><p>Using these metrics, we computed the variability of the matched models and compared against the behavioral variability observed in real fish. Unsurprisingly, variability of the matched models (orange region in <xref ref-type="fig" rid="fig4">Figure 4B</xref>) remained well below the behavioral variability across the entire frequency range of interest (dashed line in <xref ref-type="fig" rid="fig4">Figure 4B</xref>). Surprisingly, however, the model variability remained below the behavioral variability even for swapped models (<xref ref-type="fig" rid="fig4">Figure 4B</xref>, gray region versus dashed line). These results highlight the fact that sensory feedback can attenuate the variability of closed-loop models despite mismatch between the controller and plant pairs. In other words, feedback models do not require precise tuning between the controller and plant to achieve the low variability we observed in the behavioral performance of the animals.</p><p>Having established that variability of the closed-loop models is robust to the relations between the plant and controller in a feedback system, we examined the role of feedback. This was achieved by examining the loop gain, that is the dynamic amplification of signals that occurs in feedback systems (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). The only difference between the loop gain model and the closed-loop model is the absence and presence of feedback, respectively. For our model, this was calculated as the product of the plant and controller in both matched and swapped cases. This removal of feedback revealed dramatic variability in the loop gain at frequencies below about 1 Hz (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). This variability was well above the behavioral variability observed in fish. In contrast, at frequencies above 1 Hz, the model variability was slightly reduced. These results indicate that sensory feedback attenuates behavioral variability in the biologically relevant range of tracking frequencies at a cost of slightly increased variability at high frequencies.</p></sec><sec id="s2-3"><title>Parametrizing the range of neural controllers</title><p>As predicted by <xref ref-type="bibr" rid="bib9">Cowan and Fortune (2007)</xref>, each of the feedback controllers obtained above for the averaged fish responses had high-pass filtering characteristics despite the differences in their dynamics (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). What is the range of neural controllers that, when used in this feedback control topology, leads to behavior that is indistinguishable from the real fish? In other words, how well tuned to the plant does the neural controller need to be to achieve these behavioral performances?</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Feedback controllers satisfying the behavioral variability.</title><p>(<bold>A</bold>) Bode plots for the estimated controllers for the matched (orange) and merged (green) fish under feedback control. Each controller exhibits high-pass filter behavior across the frequency range of interest. Gray shaded regions represent the range of controllers that produce behavioral responses consistent with behavioral variability. (<bold>B</bold>) The range of behavioral input–output transfer functions consistent with behavioral variability.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51219-fig5-v2.tif"/></fig><p>We used the Youla-Kučera parametrization to obtain a range of controllers that generate similar behavioral responses (<xref ref-type="bibr" rid="bib26">Kučera, 2011</xref>). Specifically, this parametrization provided a parametric transfer function describing all stabilizing controllers for the merged plant:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mi mathvariant="normal">∅</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf70"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the transfer function of the merged plant and <inline-formula><mml:math id="inf71"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is any stable and proper function.</p><p><xref ref-type="disp-formula" rid="equ6">Equation 6</xref> parametrizes all stabilizing controllers for the merged plant <inline-formula><mml:math id="inf72"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. However, we were interested in finding the subset of controllers that yields indistinguishable behavioral performances from real fish. To achieve this, we computed the range for the input–output system dynamics, <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, of real fish response. Specifically, we calculated the bounds for the gain and phase responses of the 1000 input–output transfer function models estimated while computing the behavioral variability (see Materials and methods). The gray-shaded areas in <xref ref-type="fig" rid="fig5">Figure 5B</xref> serve as the range of frequency responses that are consistent with behavioral variability of the real fish.</p><p>For each of these 1000 transfer functions <inline-formula><mml:math id="inf74"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that were consistent with the behavioral variability of the fish, we selected <inline-formula><mml:math id="inf75"><mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> to generate 1000 corresponding controllers using <xref ref-type="disp-formula" rid="equ6">Equation 6</xref>. The bounds for gain and phase responses of these 1000 controllers (the gray shaded regions) show the breadth of controllers that, when implemented within the feedback control topology, produce behavioral outputs consistent with the performance of the real fish (see <xref ref-type="fig" rid="fig5">Figure 5A</xref>). Note that the controllers calculated in <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> also satisfy the structure of <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> when <inline-formula><mml:math id="inf76"><mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> for the associated plant dynamics <inline-formula><mml:math id="inf77"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of each fish; in other words, the controller estimates are guaranteed to be stabilizing for the associated plants.</p><p>These results indicate that the neural controllers need not be precisely tuned to their associated plant dynamics. We found a wide range of controllers that the fish could implement to generate consistent behavioral performance. We note that each of these controllers had high-pass filtering characteristics.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Feedback-based task control allows animals to cope with dramatic but nevertheless common variations of their plant dynamics between individuals. Further, individuals can experience variations in plant dynamics over time such as instantaneous increases in weight during feeding (<xref ref-type="bibr" rid="bib52">Van Handel, 1965</xref>; <xref ref-type="bibr" rid="bib22">Hou et al., 2015</xref>), muscle fatigue during repetitive behaviors (<xref ref-type="bibr" rid="bib14">Enoka and Stuart, 1992</xref>), or carrying heavy objects (<xref ref-type="bibr" rid="bib53">Zollikofer, 1994</xref>). These changes likely result in variable mismatch between the neural controller and the locomotor plant of individual animals. This mismatch is similar to that induced by swapping plants and controllers across individuals, suggesting that moment-to-moment variability can also be eliminated through sensory feedback.</p><p>Deciphering the interplay between the task plant, behavioral performance, and neurophysiological activity requires understanding the impacts of the closed-loop control topology. Given the range of morphophysiological features observed across individuals within a species, our results suggest that there is also a range of controller dynamics—ultimately manifest as neurophysiological activity—that each individual could use to achieve consistent biologically relevant behavioral performances. As a consequence, we expect to see more variation at the neurophysiological level than is revealed by task performance for behaviors that rely on closed-loop control.</p><sec id="s3-1"><title>Reconciling data-driven and physics-based models of locomotor dynamics</title><p>A key contribution of this work is the identification of a data-driven plant model for the locomotor dynamics of a freely behaving animal based on behavioral observations only. To achieve this, we adopted a grey-box system identification approach that seeks to reconcile a physics-based parametric transfer function model with a non-parametric data-driven model (i.e., the frequency-response function).</p><p>Developing a model from first principles, for example Newton’s laws, is sometimes an effective modeling approach for describing the dynamics of a physical system. For instance, a widely used model in legged locomotion is the spring-loaded inverted pendulum (SLIP) model for describing running dynamics in the sagittal plane (<xref ref-type="bibr" rid="bib5">Blickhan and Full, 1993</xref>; <xref ref-type="bibr" rid="bib16">Full and Koditschek, 1999</xref>). While physics-based models have proven to be successful in modeling the dynamics of biological and mechanical movements, there are limitations. Physics-based approaches for modeling behaviors at lower levels (e.g., the spiking activity of all motor neurons) may lead to a very complex model that does not accurately capture high-level behavior.</p><p>Data-driven system identification approaches are used to directly identify a dynamical model based on empirical data (<xref ref-type="bibr" rid="bib28">Ljung, 1998</xref>; <xref ref-type="bibr" rid="bib24">Kiemel et al., 2011</xref>; <xref ref-type="bibr" rid="bib49">Uyanik et al., 2019a</xref>). In general, data-driven system identification may take a black-box approach in which only a general model structure is assumed (say, an ODE or frequency response function). However, data-driven techniques typically generate numerical transfer function estimates to represent animal behavior.</p><p>Alternatively, the so-called grey-box approach that we adopt in this paper integrates the structure of a specific physics-based model but leaves its parameters free, relying on data-driven system identification to fit those parameters. In this case, prior knowledge about the underlying dynamical model informs and constrains data-driven system identification. Grey-box identification can provide a bridge between top-down, data-driven modeling and bottom-up, physics-based modeling. We utilized the parametric dynamical model of <xref ref-type="bibr" rid="bib42">Sefati et al. (2013)</xref> for the plant but estimated the model parameters using data-driven system identification techniques. Our results show that the data-driven estimates for the plant dynamics match the structure of this model (<xref ref-type="fig" rid="fig2">Figure 2A</xref>).</p></sec><sec id="s3-2"><title>Effects of variability in plant dynamics</title><p>Our results reveal two complementary perspectives on variability in plant dynamics. On the one hand, estimates of the closed-loop controllers were highly sensitive to the dynamics of the plant of individual fish. This was an inevitable consequence of our strategy for estimating the controllers—inferring the controllers from the plant and closed-loop dynamics. On the other hand, our closed-loop control models were robust to variability of either the plant or controller, indicating that precise tuning is not needed for this behavior. A control-theoretic sensitivity analysis demonstrates that these results are not unique to this example but rather are a general property of feedback control systems, see <xref ref-type="bibr" rid="bib10">Csete and Doyle (2002)</xref> for a review.</p><p>Specifically, consider the frequency dependent sensitivity function of the feedback controller <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with respect to plant <inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, in the closed-loop topology:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi>ω</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The sensitivity of the controller to the plant dynamics is a frequency dependent function. It depends on the gain and phase of both the measured closed-loop transfer function <inline-formula><mml:math id="inf80"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as well as the plant model <inline-formula><mml:math id="inf81"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. At low frequencies, fish track extremely well and thus <inline-formula><mml:math id="inf82"><mml:mrow><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. At high frequencies, the low-pass plant <inline-formula><mml:math id="inf83"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is small. Combining these factors, we expect the sensitivity <inline-formula><mml:math id="inf84"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> to be large across frequencies. In other words, there is an inescapable sensitivity to plant dynamics when the controllers are estimated using this computational strategy.</p><p>We conducted a complementary analysis to compute the sensitivity of the closed-loop tracking response <inline-formula><mml:math id="inf85"><mml:mi>G</mml:mi></mml:math></inline-formula> to perturbations in the combined controller and plant dynamics <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula>. We treated the controller–plant pair <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> as a single variable and obtained the frequency-dependent sensitivity function as<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>←</mml:mo><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>At low frequencies, <inline-formula><mml:math id="inf88"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> has nearly unity gain and thus <inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> goes to ∞. As a result, sensitivity <inline-formula><mml:math id="inf90"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>←</mml:mo><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> approaches zero. At high frequencies, <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> goes to zero and thus sensitivity is bounded around 1. Thus, despite the fact that the controller estimates are sensitive to plant variations, the closed-loop transfer function (in the presence of sensory feedback) is robust against variability of controller–plant pairs.</p></sec><sec id="s3-3"><title>Feedback and variability in neural systems</title><p>These findings suggest that a fish could implement a range of controllers in its nervous system for refuge tracking. These controllers must have high-pass filtering characteristics, but their details may be inconsequential. This has two implications for neurophysiological analysis of neural control systems. First, neurophysiological activity within control circuits in open-loop experiments (e.g. playback and anesthetized/immobilized animals) need not appear to be well tuned for the control of a behavioral performance. This poor tuning, which may manifest in variability that appears across levels of functional organization—from variability in neural activity within neurons, variability in tuning across neurons, and variability across individuals—is refined via feedback during behaviors in which the feedback loops are intact. Second, there must be mechanisms by which the controllers are slowly (at time constants greater than that necessary for the moment-to-moment control of the behavior) tuned to the dynamics of the animal’s locomotor plant. For instance, adaptation of cerebellar activity in relation to mismatch between intended versus actual motor performances contribute to the retuning of neural controllers (<xref ref-type="bibr" rid="bib35">Morton and Bastian, 2006</xref>; <xref ref-type="bibr" rid="bib2">Bell et al., 1997</xref>; <xref ref-type="bibr" rid="bib36">Pisotta and Molinari, 2014</xref>).</p><p>Feedback is mediated both through the effects of behavior on sensory receptors and via descending pathways in the brain. Behavior generally results in concomitant activation of receptor types across the animal, which can include, for example, simultaneous stimulation of stretch receptors embedded in muscles and visual receptors in eyes. Correlations in feedback-related activity across sensory modalities likely contribute to robust control (<xref ref-type="bibr" rid="bib40">Roth et al., 2016</xref>). Internal feedback pathways, interestingly, have been recently shown to synthesize sensory filtering properties of behaviorally-relevant stimuli. Descending neural feedback is used to dynamically synthesize responses to movement (<xref ref-type="bibr" rid="bib34">Metzen et al., 2018</xref>; <xref ref-type="bibr" rid="bib23">Huang et al., 2018</xref>; <xref ref-type="bibr" rid="bib7">Clarke and Maler, 2017</xref>).</p><p>How do other animal systems manage variability, broadly speaking, to achieve consistent output? In pyloric neural circuits of crustaceans, the oscillatory output of the system is consistent despite dramatic variations in the dynamics of cellular and membrane properties of neurons within these circuits (<xref ref-type="bibr" rid="bib17">Goaillard et al., 2009</xref>; <xref ref-type="bibr" rid="bib32">Marder and Taylor, 2011</xref>). How these circuits maintain consistent output despite underlying variability remains an open question (<xref ref-type="bibr" rid="bib18">Hamood and Marder, 2014</xref>) but likely relies on feedback regulation that is intrinsic to the neural network itself.</p><p>The mechanisms by which systems maintain consistent output can be assessed through behavioral analysis (<xref ref-type="bibr" rid="bib25">Krakauer et al., 2017</xref>) of responses to systematic perturbations (<xref ref-type="bibr" rid="bib8">Cowan et al., 2014</xref>). For example, perturbations have been used in many species including flying insects (<xref ref-type="bibr" rid="bib3">Bender and Dickinson, 2006</xref>; <xref ref-type="bibr" rid="bib33">Matthews and Sponberg, 2018</xref>), walking sticks (<xref ref-type="bibr" rid="bib11">Dallmann et al., 2019</xref>; <xref ref-type="bibr" rid="bib13">Diederich et al., 2002</xref>), and humans (<xref ref-type="bibr" rid="bib27">Lee and Perreault, 2019</xref>) to reveal how control systems manage mechanical and sensory variation. These analyses and others show that animals rely on sensory feedback to modulate moment-to-moment movement to maintain consistent task performances.</p><p>Ultimately, understanding how robustness emerges in closed loop requires investigating the interplay between plants and controllers, which are inextricably linked (<xref ref-type="bibr" rid="bib9">Cowan and Fortune, 2007</xref>; <xref ref-type="bibr" rid="bib47">Tytell et al., 2011</xref>; <xref ref-type="bibr" rid="bib48">Tytell et al., 2018</xref>). A commonly implemented strategy, for example, is the use of low-pass plant dynamics. This strategy can avoid instabilities that arise from long-latency feedback, an inescapable feature of biological control systems (<xref ref-type="bibr" rid="bib43">Sponberg et al., 2015</xref>; <xref ref-type="bibr" rid="bib30">Madhav and Cowan, 2020</xref>). Specifically, delay introduces phase lag that increases with frequency. As the phase angle of the loop gain <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> approaches −180°, the likelihood of instability increases. A low-pass plant can mitigate this instability by ensuring that the gain of <inline-formula><mml:math id="inf93"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> near this ‘phase crossover frequency.’ In turn, the animal exhibits low behavioral sensitivity, namely <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>≲</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ8">Equation 8</xref>. In short, a well-tuned neuromechanical plant can simplify feedback control by rendering the dynamics passively self-stabilizing (<xref ref-type="bibr" rid="bib20">Hedrick et al., 2009</xref>; <xref ref-type="bibr" rid="bib42">Sefati et al., 2013</xref>), while nevertheless maintaining behavioral flexibility (<xref ref-type="bibr" rid="bib8">Cowan et al., 2014</xref>).</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>All experimental procedures with fish were reviewed and approved by the Johns Hopkins University and Rutgers University Animal Care and Use Committees and followed guidelines for the ethical use of animals in research established by the <italic>National Research Council</italic> and the <italic>Society for Neuroscience</italic>.</p><p>Adult <italic>Eigenmannia virescens</italic>, a species of weakly electric Gymnotiform fish, were obtained through commercial vendors and housed in laboratory tanks. Tanks were maintained at a temperature of approximately 27°C and a conductivity between 50 − 200 μS . We transferred individual fish to the experimental tank about 1 day before experiments for acclimation. Three fish were used in this study.</p><sec id="s4-1"><title>Experimental apparatus</title><p>The experimental apparatus is similar to that used in previous studies (<xref ref-type="bibr" rid="bib44">Stamper et al., 2012</xref>; <xref ref-type="bibr" rid="bib4">Biswas et al., 2018</xref>; <xref ref-type="bibr" rid="bib50">Uyanik et al., 2019b</xref>). A refuge machined from a PVC pipe with a length of 15 cm and 5.08 cm diameter was placed in the experimental tank with the fish. The bottom face of the refuge was removed to allow video recording from below. Six windows, 0.625 cm in width and spaced within 2.5 cm intervals, were machined onto each side to provide visual and electrosensory cues. During experiments, we actuated the refuge using a linear stepper motor with 0.94 μm resolution (IntelLiDrives, Inc Philadelphia, PA, USA) driven via a Stepper motor controller (Copley Controls, Canton, MA, USA). MATLAB (MathWorks, Natick, MA, USA) scripts were used to control the movement of the refuge and to capture video. Video data were captured using a pco.1200s high speed camera (Cooke Corp., Romulus, MI, USA) with a Micro-Nikkor 60 mm f/2.8D lens (Nikon Inc, Melville, NY, USA). All videos used for data analysis were shot at 30 frames per second with 1280 × 1024 pixel resolution. Some videos of ribbon fin motion were shot at 100 frames per second.</p></sec><sec id="s4-2"><title>Experimental procedure</title><p>Refuge movement consisted of single sine waves of amplitude 0.1 cm and of frequencies 0.55, 0.95, and 2.05 Hz. The amplitude of refuge movements was chosen because fish rely on counter propagating waves for tracking in this regime (<xref ref-type="bibr" rid="bib38">Roth et al., 2011</xref>). At higher amplitudes, fish often will use a uni-directional wave in the ribbon fin for locomotion. The frequencies were selected to be within the normal tracking regime as determined in previous studies (<xref ref-type="bibr" rid="bib44">Stamper et al., 2012</xref>; <xref ref-type="bibr" rid="bib4">Biswas et al., 2018</xref>; <xref ref-type="bibr" rid="bib50">Uyanik et al., 2019b</xref>). Trials were randomized with respect to frequency. Each trial lasted 60 seconds. The stimulus amplitude was linearly ramped up over the first ten seconds to prevent startle responses from the fish. During the experimental phase, the stimulus frequency and amplitude were maintained for 40 seconds. Finally, the stimulus amplitude was ramped down during the final ten seconds. Trials were separated by a minimum break of 2 minutes.</p></sec><sec id="s4-3"><title>Derivation of plant model</title><p><xref ref-type="bibr" rid="bib42">Sefati et al. (2013)</xref> developed and tested a second-order, linear, ordinary differential equation that describes how changes in fore-aft position of the animal, <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, relate to changes in position of the nodal point, <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf97"><mml:mi>m</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf98"><mml:mi>k</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf99"><mml:mi>b</mml:mi></mml:math></inline-formula> represent mass, gain, and damping, respectively. This equation follows from Equation S13 in the Supporting Information of <xref ref-type="bibr" rid="bib42">Sefati et al. (2013)</xref>. Note that the present paper uses slightly different nomenclature; in particular <inline-formula><mml:math id="inf100"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf102"><mml:mi>b</mml:mi></mml:math></inline-formula> in the present paper correspond to <inline-formula><mml:math id="inf103"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf105"><mml:mi>β</mml:mi></mml:math></inline-formula>, respectively, in <xref ref-type="bibr" rid="bib42">Sefati et al. (2013)</xref>.</p><p>The Laplace transform provides a computationally convenient means to represent dynamics of linear, time-invariant systems such as the one in <xref ref-type="disp-formula" rid="equ9">Equation 9</xref> (<xref ref-type="bibr" rid="bib39">Roth et al., 2014</xref>). Taking the Laplace transform of both sides of <xref ref-type="disp-formula" rid="equ9">Equation 9</xref>, neglecting initial conditions, and algebraically simplifying, we arrive at the plant model in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>Y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mover><mml:mrow><mml:mover><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>⏞</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s4-4"><title>Inferring controller using plant and closed-loop dynamics</title><p>Given the feedback control topology in <xref ref-type="fig" rid="fig1">Figure 1</xref>, the closed-loop dynamics relating the movement of the refuge to the movement of the fish are given in the Laplace domain by the following equation:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>This equation is also shown in Equation 7 of <xref ref-type="bibr" rid="bib9">Cowan and Fortune (2007)</xref> with a slightly different nomenclature; in particular <inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf107"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in the present paper correspond to <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively, in <xref ref-type="bibr" rid="bib9">Cowan and Fortune (2007)</xref>.</p><p>Given <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf111"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, one can compute the complementary controller <inline-formula><mml:math id="inf112"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> using <xref ref-type="disp-formula" rid="equ11">Equation 11</xref> as<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-5"><title>Reconciling data-driven and physics-based approaches to estimate the locomotor dynamics</title><p>The position of the refuge and fish were tracked for each video using custom software (<xref ref-type="bibr" rid="bib19">Hedrick, 2008</xref>). The videos were analyzed to extract 3 to 10 seconds segments, where the fish used counter propagating waves for refuge tracking. Then, the nodal point was hand clicked in these video segments: 18,000 nodal point measurements were made over a total of 106 segments of data.</p><p>The physics-based plant model in <xref ref-type="bibr" rid="bib42">Sefati et al. (2013)</xref> was previously validated with quasi-static open-loop experiments. Here we reconciled the physics-based plant model from <xref ref-type="bibr" rid="bib42">Sefati et al. (2013)</xref> (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) with the data that were collected in tracking experiments.</p><p>For each frequency of refuge movement, M segments of nodal point data were extracted. Each segment of data consists of the following measurements: nodal point shift <inline-formula><mml:math id="inf113"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> and fish position <inline-formula><mml:math id="inf114"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> as a function of time <inline-formula><mml:math id="inf115"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, where n is the number of samples and <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>We estimated the magnitude and phase of the plant model for each frequency of refuge movement. The average value of nodal point shift and fish position were computed from M data segments per fish for each frequency of refuge movement. We aligned each data segment based on the phase of refuge signals. The segments are not completely overlapping: we selected the largest time window with at least 50 percent overlap of data segments. A sine wave function of the following form was fitted to the average nodal point data, <inline-formula><mml:math id="inf117"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and average fish position data, <inline-formula><mml:math id="inf118"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, as<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where input–output pairs (<inline-formula><mml:math id="inf119"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>), (<inline-formula><mml:math id="inf120"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) and (<inline-formula><mml:math id="inf121"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) correspond to magnitudes, phases and DC offsets in polar coordinates, respectively. Note that this fitting was done separately for each refuge frequency, <inline-formula><mml:math id="inf122"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0.55</mml:mn><mml:mo>,</mml:mo><mml:mn>0.95</mml:mn><mml:mo>,</mml:mo><mml:mn>2.05</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> Hz.</p><p>After computing the magnitude and phase for both the average nodal shift and fish position, we estimated the magnitude and phase for the plant transfer function at <inline-formula><mml:math id="inf123"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> as<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">∠</mml:mi><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We obtained a non-parametric estimate of the plant transfer function for each frequency <inline-formula><mml:math id="inf124"><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, that is <inline-formula><mml:math id="inf125"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by estimating magnitude and phases. We used <inline-formula><mml:math id="inf126"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to estimate the parameters of the transfer function model given in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. In this model, there are three unknown parameters, namely <inline-formula><mml:math id="inf127"><mml:mi>m</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf128"><mml:mi>k</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf129"><mml:mi>b</mml:mi></mml:math></inline-formula>. However, for the fitting purposes we reduced the number of unknown parameters to two by normalizing the ‘gain’ (<inline-formula><mml:math id="inf130"><mml:mi>k</mml:mi></mml:math></inline-formula>) and ‘damping’ (<inline-formula><mml:math id="inf131"><mml:mi>b</mml:mi></mml:math></inline-formula>) by the ‘mass’ (<inline-formula><mml:math id="inf132"><mml:mi>m</mml:mi></mml:math></inline-formula>). The normalized plant transfer function in Fourier domain takes the form<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf133"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. For an ideal deterministic system, for each frequency <inline-formula><mml:math id="inf134"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf135"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> corresponds to the non-parametrically computed frequency response function. For this reason, estimates of transfer function parameters were made by minimizing a cost function using gradient descent method:<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mpadded width="+1.7pt"><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mpadded></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-6"><title>Bootstrap estimate of behavioral variability</title><p>We estimated behavioral variability using bootstrap estimates derived from individual experimental trials at the three test frequencies. Across all three fish, we made 37 observations of the frequency response at <inline-formula><mml:math id="inf136"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.55</mml:mn></mml:mrow></mml:math></inline-formula> Hz, 35 observations at <inline-formula><mml:math id="inf137"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula> Hz, and 34 observations at <inline-formula><mml:math id="inf138"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2.05</mml:mn></mml:mrow></mml:math></inline-formula> Hz, namely:<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mn>0.55</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mn>0.55</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>37</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mn>0.55</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mn>0.95</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mn>0.95</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>35</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mn>0.95</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mn>2.05</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mn>2.05</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>34</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mn>2.05</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To estimate the behavioral variability at frequencies that were not explicitly tested, we used a parametric approach. Specifically, we constructed <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> triplets by randomly selecting one frequency response function from each of the test frequencies in <xref ref-type="disp-formula" rid="equ19">Equation 19</xref>. For each of the 1000 triplets, we estimated a transfer function, <inline-formula><mml:math id="inf140"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>bootstrap</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> of the form in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> using Matlab’s transfer function estimation method ‘tfest’.</p><p>Let <inline-formula><mml:math id="inf142"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> be real and imaginary parts of the complex-valued frequency response function, namely <inline-formula><mml:math id="inf144"><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>bootstrap</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf145"><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is a frequency in the range 0.2 Hz to 2.05 Hz. The covariance matrix for the estimated frequency response function in the complex domain was calculated as<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:msup><mml:mi>Cov</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msubsup></mml:mtd><mml:mtd columnalign="center"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msubsup></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mpadded width="+1.7pt"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msubsup></mml:mpadded><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf146"><mml:msub><mml:mi>μ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf147"><mml:msub><mml:mi>μ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> are mean values of <inline-formula><mml:math id="inf148"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf149"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf150"><mml:mrow><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively. The final bootstrap estimate of behavioral variability was calculated as the largest singular value of the central covariance matrix, <inline-formula><mml:math id="inf151"><mml:msup><mml:mi>Cov</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msup></mml:math></inline-formula>. In addition, the range of the gain and phase of these 1000 transfer function models was plotted in <xref ref-type="fig" rid="fig5">Figure 5B</xref>.</p></sec><sec id="s4-7"><title>Model variability</title><p>The variability across ‘matched’ and ‘swapped’ models was calculated for both the closed-loop transfer function <inline-formula><mml:math id="inf152"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4B</xref>) and the loop gain <inline-formula><mml:math id="inf153"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). We evaluated each of the three fish-specific controllers and plant transfer functions at frequencies between 0.2 Hz and 2.05 Hz; for each frequency <inline-formula><mml:math id="inf154"><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> in this range, we have <inline-formula><mml:math id="inf155"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf156"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf157"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf158"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf159"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf160"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>To calculate the matched closed-loop variability, we first calculated the real (<inline-formula><mml:math id="inf161"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>) and imaginary (<inline-formula><mml:math id="inf162"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>) parts of <inline-formula><mml:math id="inf163"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Using these values, the matched closed-loop variability was calculated as the largest singular value of the central covariance matrix of these ordered pairs. The matched loop-gain variability was calculated similarly, using the real and imaginary parts of <inline-formula><mml:math id="inf164"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. For each of these calculations, <inline-formula><mml:math id="inf165"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, because there are three sets of matched models. The closed-loop and loop-gain swapped variability was calculated identically, except using the <inline-formula><mml:math id="inf166"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> swapped permutations of control–plant pairs. <xref ref-type="fig" rid="fig4">Figure 4B,D</xref> illustrates the variability of the matched and swapped models both for closed-loop control and loop gain.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>This work was supported by a collaborative National Science Foundation (NSF) Award to Noah J Cowan (1557895) and Eric S Fortune (1557858). Figures and Figure Supplements incorporate illustrations drawn by Eatai Roth. We also thank him for his invaluable feedback on the manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Visualization, Methodology</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Data curation, Formal analysis</p></fn><fn fn-type="con" id="con4"><p>Data curation</p></fn><fn fn-type="con" id="con5"><p>Software, Formal analysis</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Resources, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Project administration</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Resources, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Project administration</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Animal experimentation: All experimental procedures used for this study were reviewed and approved by Johns Hopkins (protocol: FI19A178) and Rutgers (protocol: 999900774) Animal Care and Use committees and followed the guidelines given by the National Research Council and the Society for Neuroscience.</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-51219-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>An archived version of the dataset and analysis code is available through the Johns Hopkins University Data Archive.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Uyanik</surname><given-names>I</given-names></name><name><surname>Sefati</surname><given-names>S</given-names></name><name><surname>Stamper</surname><given-names>SA</given-names></name><name><surname>Cho</surname><given-names>K-A</given-names></name><name><surname>Ankarali</surname><given-names>MM</given-names></name><name><surname>Fortune</surname><given-names>Eric S</given-names></name><name><surname>Cowan</surname><given-names>NJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Data associated with Variability in locomotor dynamics reveals the critical role of feedback in task control</data-title><source>Johns Hopkins University Data Archive</source><pub-id assigning-authority="other" pub-id-type="doi">10.7281/T1/UDTJPD</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bays</surname> <given-names>PM</given-names></name><name><surname>Wolpert</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Computational principles of sensorimotor control that minimize uncertainty and variability</article-title><source>The Journal of Physiology</source><volume>578</volume><fpage>387</fpage><lpage>396</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2006.120121</pub-id><pub-id pub-id-type="pmid">17008369</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>C</given-names></name><name><surname>Bodznick</surname> <given-names>D</given-names></name><name><surname>Montgomery</surname> <given-names>J</given-names></name><name><surname>Bastian</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The generation and subtraction of sensory expectations within cerebellum-like structures</article-title><source>Brain, Behavior and Evolution</source><volume>50 Suppl 1</volume><fpage>17</fpage><lpage>31</lpage><pub-id pub-id-type="doi">10.1159/000113352</pub-id><pub-id pub-id-type="pmid">9217991</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bender</surname> <given-names>JA</given-names></name><name><surname>Dickinson</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A comparison of visual and haltere-mediated feedback in the control of body saccades in <italic>Drosophila Melanogaster</italic></article-title><source>Journal of Experimental Biology</source><volume>209</volume><fpage>4597</fpage><lpage>4606</lpage><pub-id pub-id-type="doi">10.1242/jeb.02583</pub-id><pub-id pub-id-type="pmid">17114395</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biswas</surname> <given-names>D</given-names></name><name><surname>Arend</surname> <given-names>LA</given-names></name><name><surname>Stamper</surname> <given-names>SA</given-names></name><name><surname>Vágvölgyi</surname> <given-names>BP</given-names></name><name><surname>Fortune</surname> <given-names>ES</given-names></name><name><surname>Cowan</surname> <given-names>NJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Closed-Loop control of active sensing movements regulates sensory slip</article-title><source>Current Biology</source><volume>28</volume><fpage>4029</fpage><lpage>4036</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2018.11.002</pub-id><pub-id pub-id-type="pmid">30503617</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blickhan</surname> <given-names>R</given-names></name><name><surname>Full</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Similarity in multilegged locomotion: bouncing like a monopode</article-title><source>Journal of Comparative Physiology A</source><volume>173</volume><fpage>509</fpage><lpage>517</lpage><pub-id pub-id-type="doi">10.1007/BF00197760</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bullimore</surname> <given-names>SR</given-names></name><name><surname>Burn</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Dynamically similar locomotion in horses</article-title><source>Journal of Experimental Biology</source><volume>209</volume><fpage>455</fpage><lpage>465</lpage><pub-id pub-id-type="doi">10.1242/jeb.02029</pub-id><pub-id pub-id-type="pmid">16424095</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clarke</surname> <given-names>SE</given-names></name><name><surname>Maler</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Feedback synthesizes neural codes for motion</article-title><source>Current Biology</source><volume>27</volume><fpage>1356</fpage><lpage>1361</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2017.03.068</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cowan</surname> <given-names>NJ</given-names></name><name><surname>Ankarali</surname> <given-names>MM</given-names></name><name><surname>Dyhr</surname> <given-names>JP</given-names></name><name><surname>Madhav</surname> <given-names>MS</given-names></name><name><surname>Roth</surname> <given-names>E</given-names></name><name><surname>Sefati</surname> <given-names>S</given-names></name><name><surname>Sponberg</surname> <given-names>S</given-names></name><name><surname>Stamper</surname> <given-names>SA</given-names></name><name><surname>Fortune</surname> <given-names>ES</given-names></name><name><surname>Daniel</surname> <given-names>TL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Feedback control as a framework for understanding tradeoffs in biology</article-title><source>Integrative and Comparative Biology</source><volume>54</volume><fpage>223</fpage><lpage>237</lpage><pub-id pub-id-type="doi">10.1093/icb/icu050</pub-id><pub-id pub-id-type="pmid">24893678</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cowan</surname> <given-names>NJ</given-names></name><name><surname>Fortune</surname> <given-names>ES</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The critical role of locomotion mechanics in decoding sensory systems</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>1123</fpage><lpage>1128</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4198-06.2007</pub-id><pub-id pub-id-type="pmid">17267567</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Csete</surname> <given-names>ME</given-names></name><name><surname>Doyle</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Reverse engineering of biological complexity</article-title><source>Science</source><volume>295</volume><fpage>1664</fpage><lpage>1669</lpage><pub-id pub-id-type="doi">10.1126/science.1069981</pub-id><pub-id pub-id-type="pmid">11872830</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dallmann</surname> <given-names>CJ</given-names></name><name><surname>Dürr</surname> <given-names>V</given-names></name><name><surname>Schmitz</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Motor control of an insect leg during level and incline walking</article-title><source>The Journal of Experimental Biology</source><volume>222</volume><elocation-id>jeb188748</elocation-id><pub-id pub-id-type="doi">10.1242/jeb.188748</pub-id><pub-id pub-id-type="pmid">30944163</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dickinson</surname> <given-names>MH</given-names></name><name><surname>Farley</surname> <given-names>CT</given-names></name><name><surname>Full</surname> <given-names>RJ</given-names></name><name><surname>Koehl</surname> <given-names>MA</given-names></name><name><surname>Kram</surname> <given-names>R</given-names></name><name><surname>Lehman</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>How animals move: an integrative view</article-title><source>Science</source><volume>288</volume><fpage>100</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1126/science.288.5463.100</pub-id><pub-id pub-id-type="pmid">10753108</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diederich</surname> <given-names>B</given-names></name><name><surname>Schumm</surname> <given-names>M</given-names></name><name><surname>Cruse</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Stick insects walking along inclined surfaces</article-title><source>Integrative and Comparative Biology</source><volume>42</volume><fpage>165</fpage><lpage>173</lpage><pub-id pub-id-type="doi">10.1093/icb/42.1.165</pub-id><pub-id pub-id-type="pmid">21708706</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enoka</surname> <given-names>RM</given-names></name><name><surname>Stuart</surname> <given-names>DG</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Neurobiology of muscle fatigue</article-title><source>Journal of Applied Physiology</source><volume>72</volume><fpage>1631</fpage><lpage>1648</lpage><pub-id pub-id-type="doi">10.1152/jappl.1992.72.5.1631</pub-id><pub-id pub-id-type="pmid">1601767</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franklin</surname> <given-names>DW</given-names></name><name><surname>Wolpert</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Computational mechanisms of sensorimotor control</article-title><source>Neuron</source><volume>72</volume><fpage>425</fpage><lpage>442</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.10.006</pub-id><pub-id pub-id-type="pmid">22078503</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Full</surname> <given-names>RJ</given-names></name><name><surname>Koditschek</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Templates and anchors: neuromechanical hypotheses of legged locomotion on land</article-title><source>The Journal of Experimental Biology</source><volume>202</volume><fpage>3325</fpage><lpage>3332</lpage><pub-id pub-id-type="pmid">10562515</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goaillard</surname> <given-names>JM</given-names></name><name><surname>Taylor</surname> <given-names>AL</given-names></name><name><surname>Schulz</surname> <given-names>DJ</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Functional consequences of animal-to-animal variation in circuit parameters</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>1424</fpage><lpage>1430</lpage><pub-id pub-id-type="doi">10.1038/nn.2404</pub-id><pub-id pub-id-type="pmid">19838180</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamood</surname> <given-names>AW</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Animal-to-Animal variability in neuromodulation and circuit function</article-title><source>Cold Spring Harbor Symposia on Quantitative Biology</source><volume>79</volume><fpage>21</fpage><lpage>28</lpage><pub-id pub-id-type="doi">10.1101/sqb.2014.79.024828</pub-id><pub-id pub-id-type="pmid">25876630</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedrick</surname> <given-names>TL</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Software techniques for two- and three-dimensional kinematic measurements of biological and biomimetic systems</article-title><source>Bioinspiration &amp; Biomimetics</source><volume>3</volume><elocation-id>034001</elocation-id><pub-id pub-id-type="doi">10.1088/1748-3182/3/3/034001</pub-id><pub-id pub-id-type="pmid">18591738</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedrick</surname> <given-names>TL</given-names></name><name><surname>Cheng</surname> <given-names>B</given-names></name><name><surname>Deng</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Wingbeat time and the scaling of passive rotational damping in flapping flight</article-title><source>Science</source><volume>324</volume><fpage>252</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1126/science.1168431</pub-id><pub-id pub-id-type="pmid">19359586</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedrick</surname> <given-names>TL</given-names></name><name><surname>Robinson</surname> <given-names>AK</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Within-wingbeat damping: dynamics of continuous free-flight yaw turns in <italic>Manduca sexta</italic></article-title><source>Biology Letters</source><volume>6</volume><fpage>422</fpage><lpage>425</lpage><pub-id pub-id-type="doi">10.1098/rsbl.2010.0083</pub-id><pub-id pub-id-type="pmid">20181557</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hou</surname> <given-names>L</given-names></name><name><surname>Verdirame</surname> <given-names>M</given-names></name><name><surname>Welch</surname> <given-names>KC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Automated tracking of wild hummingbird mass and energetics over multiple time scales using radio frequency identification (RFID) technology</article-title><source>Journal of Avian Biology</source><volume>46</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1111/jav.00478</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname> <given-names>CG</given-names></name><name><surname>Metzen</surname> <given-names>MG</given-names></name><name><surname>Chacron</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Feedback optimizes neural coding and perception of natural stimuli</article-title><source>eLife</source><volume>7</volume><elocation-id>e38935</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.38935</pub-id><pub-id pub-id-type="pmid">30289387</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiemel</surname> <given-names>T</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Jeka</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Identification of neural feedback for upright stance in humans: stabilization rather than sway minimization</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>15144</fpage><lpage>15153</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1013-11.2011</pub-id><pub-id pub-id-type="pmid">22016548</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krakauer</surname> <given-names>JW</given-names></name><name><surname>Ghazanfar</surname> <given-names>AA</given-names></name><name><surname>Gomez-Marin</surname> <given-names>A</given-names></name><name><surname>MacIver</surname> <given-names>MA</given-names></name><name><surname>Poeppel</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Neuroscience needs behavior: correcting a reductionist Bias</article-title><source>Neuron</source><volume>93</volume><fpage>480</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.12.041</pub-id><pub-id pub-id-type="pmid">28182904</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kučera</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A method to teach the parameterization of all stabilizing controllers</article-title><source>IFAC Proceedings Volumes</source><volume>44</volume><fpage>6355</fpage><lpage>6360</lpage><pub-id pub-id-type="doi">10.3182/20110828-6-IT-1002.01148</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>H</given-names></name><name><surname>Perreault</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Stabilizing stretch reflexes are modulated independently from the rapid release of perturbation-triggered motor plans</article-title><source>Scientific Reports</source><volume>9</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1038/s41598-019-50460-1</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ljung</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="1998">1998</year><source>System Identification: Theory for the User</source><edition>Second</edition><publisher-name>Prentice Hall</publisher-name></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lockhart</surname> <given-names>DB</given-names></name><name><surname>Ting</surname> <given-names>LH</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Optimal sensorimotor transformations for balance</article-title><source>Nature Neuroscience</source><volume>10</volume><fpage>1329</fpage><lpage>1336</lpage><pub-id pub-id-type="doi">10.1038/nn1986</pub-id><pub-id pub-id-type="pmid">17873869</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Madhav</surname> <given-names>MS</given-names></name><name><surname>Cowan</surname> <given-names>NJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The synergy between neuroscience and control theory: the nervous system as inspiration for hard control challenges</article-title><source>Annual Review of Control, Robotics, and Autonomous Systems</source><volume>3</volume><comment>In press</comment><pub-id pub-id-type="doi">10.1016/j.plrev.2016.06.007</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maladen</surname> <given-names>RD</given-names></name><name><surname>Ding</surname> <given-names>Y</given-names></name><name><surname>Li</surname> <given-names>C</given-names></name><name><surname>Goldman</surname> <given-names>DI</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Undulatory swimming in sand: subsurface locomotion of the sandfish lizard</article-title><source>Science</source><volume>325</volume><fpage>314</fpage><lpage>318</lpage><pub-id pub-id-type="doi">10.1126/science.1172490</pub-id><pub-id pub-id-type="pmid">19608917</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname> <given-names>E</given-names></name><name><surname>Taylor</surname> <given-names>AL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Multiple models to capture the variability in biological neurons and networks</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>133</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1038/nn.2735</pub-id><pub-id pub-id-type="pmid">21270780</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matthews</surname> <given-names>M</given-names></name><name><surname>Sponberg</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Hawkmoth flight in the unsteady wakes of flowers</article-title><source>The Journal of Experimental Biology</source><volume>221</volume><elocation-id>jeb179259</elocation-id><pub-id pub-id-type="doi">10.1242/jeb.179259</pub-id><pub-id pub-id-type="pmid">30291159</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metzen</surname> <given-names>MG</given-names></name><name><surname>Huang</surname> <given-names>CG</given-names></name><name><surname>Chacron</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Descending pathways generate perception of and neural responses to weak sensory input</article-title><source>PLOS Biology</source><volume>16</volume><elocation-id>e2005239</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.2005239</pub-id><pub-id pub-id-type="pmid">29939982</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morton</surname> <given-names>SM</given-names></name><name><surname>Bastian</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Cerebellar contributions to locomotor adaptations during splitbelt treadmill walking</article-title><source>Journal of Neuroscience</source><volume>26</volume><fpage>9107</fpage><lpage>9116</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2622-06.2006</pub-id><pub-id pub-id-type="pmid">16957067</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pisotta</surname> <given-names>I</given-names></name><name><surname>Molinari</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Cerebellar contribution to feedforward control of locomotion</article-title><source>Frontiers in Human Neuroscience</source><volume>8</volume><elocation-id>475</elocation-id><pub-id pub-id-type="doi">10.3389/fnhum.2014.00475</pub-id><pub-id pub-id-type="pmid">25009490</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rose</surname> <given-names>GJ</given-names></name><name><surname>Canfield</surname> <given-names>JG</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Longitudinal tracking responses of <italic>Eigenmannia</italic> and <italic>Sternopygus</italic></article-title><source>Journal of Comparative Physiology. A, Sensory, Neural, and Behavioral Physiology</source><volume>173</volume><fpage>698</fpage><lpage>700</lpage><pub-id pub-id-type="doi">10.1007/BF00213075</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roth</surname> <given-names>E</given-names></name><name><surname>Zhuang</surname> <given-names>K</given-names></name><name><surname>Stamper</surname> <given-names>SA</given-names></name><name><surname>Fortune</surname> <given-names>ES</given-names></name><name><surname>Cowan</surname> <given-names>NJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Stimulus predictability mediates a switch in locomotor smooth pursuit performance for <italic>Eigenmannia virescens</italic></article-title><source>Journal of Experimental Biology</source><volume>214</volume><fpage>1170</fpage><lpage>1180</lpage><pub-id pub-id-type="doi">10.1242/jeb.048124</pub-id><pub-id pub-id-type="pmid">21389203</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roth</surname> <given-names>E</given-names></name><name><surname>Sponberg</surname> <given-names>S</given-names></name><name><surname>Cowan</surname> <given-names>NJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A comparative approach to closed-loop computation</article-title><source>Current Opinion in Neurobiology</source><volume>25</volume><fpage>54</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2013.11.005</pub-id><pub-id pub-id-type="pmid">24709601</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roth</surname> <given-names>E</given-names></name><name><surname>Hall</surname> <given-names>RW</given-names></name><name><surname>Daniel</surname> <given-names>TL</given-names></name><name><surname>Sponberg</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Integration of parallel mechanosensory and visual pathways resolved through sensory conflict</article-title><source>PNAS</source><volume>113</volume><fpage>12832</fpage><lpage>12837</lpage><pub-id pub-id-type="doi">10.1073/pnas.1522419113</pub-id><pub-id pub-id-type="pmid">27791056</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruiz-Torres</surname> <given-names>R</given-names></name><name><surname>Curet</surname> <given-names>OM</given-names></name><name><surname>Lauder</surname> <given-names>GV</given-names></name><name><surname>Maciver</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Kinematics of the ribbon fin in hovering and swimming of the electric ghost knifefish</article-title><source>Journal of Experimental Biology</source><volume>216</volume><fpage>823</fpage><lpage>834</lpage><pub-id pub-id-type="doi">10.1242/jeb.076471</pub-id><pub-id pub-id-type="pmid">23197089</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sefati</surname> <given-names>S</given-names></name><name><surname>Neveln</surname> <given-names>ID</given-names></name><name><surname>Roth</surname> <given-names>E</given-names></name><name><surname>Mitchell</surname> <given-names>TR</given-names></name><name><surname>Snyder</surname> <given-names>JB</given-names></name><name><surname>Maciver</surname> <given-names>MA</given-names></name><name><surname>Fortune</surname> <given-names>ES</given-names></name><name><surname>Cowan</surname> <given-names>NJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Mutually opposing forces during locomotion can eliminate the tradeoff between maneuverability and stability</article-title><source>PNAS</source><volume>110</volume><fpage>18798</fpage><lpage>18803</lpage><pub-id pub-id-type="doi">10.1073/pnas.1309300110</pub-id><pub-id pub-id-type="pmid">24191034</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sponberg</surname> <given-names>S</given-names></name><name><surname>Dyhr</surname> <given-names>JP</given-names></name><name><surname>Hall</surname> <given-names>RW</given-names></name><name><surname>Daniel</surname> <given-names>TL</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Luminance-dependent visual processing enables moth flight in low light</article-title><source>Science</source><volume>348</volume><fpage>1245</fpage><lpage>1248</lpage><pub-id pub-id-type="doi">10.1126/science.aaa3042</pub-id><pub-id pub-id-type="pmid">26068850</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stamper</surname> <given-names>SA</given-names></name><name><surname>Roth</surname> <given-names>E</given-names></name><name><surname>Cowan</surname> <given-names>NJ</given-names></name><name><surname>Fortune</surname> <given-names>ES</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Active sensing via movement shapes spatiotemporal patterns of sensory feedback</article-title><source>Journal of Experimental Biology</source><volume>215</volume><fpage>1567</fpage><lpage>1574</lpage><pub-id pub-id-type="doi">10.1242/jeb.068007</pub-id><pub-id pub-id-type="pmid">22496294</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ting</surname> <given-names>LH</given-names></name><name><surname>Macpherson</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>A limited set of muscle synergies for force control during a postural task</article-title><source>Journal of Neurophysiology</source><volume>93</volume><fpage>609</fpage><lpage>613</lpage><pub-id pub-id-type="doi">10.1152/jn.00681.2004</pub-id><pub-id pub-id-type="pmid">15342720</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Todorov</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Optimality principles in sensorimotor control</article-title><source>Nature Neuroscience</source><volume>7</volume><fpage>907</fpage><lpage>915</lpage><pub-id pub-id-type="doi">10.1038/nn1309</pub-id><pub-id pub-id-type="pmid">15332089</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tytell</surname> <given-names>ED</given-names></name><name><surname>Holmes</surname> <given-names>P</given-names></name><name><surname>Cohen</surname> <given-names>AH</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Spikes alone do not behavior make: why neuroscience needs biomechanics</article-title><source>Current Opinion in Neurobiology</source><volume>21</volume><fpage>816</fpage><lpage>822</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.05.017</pub-id><pub-id pub-id-type="pmid">21683575</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tytell</surname> <given-names>ED</given-names></name><name><surname>Carr</surname> <given-names>JA</given-names></name><name><surname>Danos</surname> <given-names>N</given-names></name><name><surname>Wagenbach</surname> <given-names>C</given-names></name><name><surname>Sullivan</surname> <given-names>CM</given-names></name><name><surname>Kiemel</surname> <given-names>T</given-names></name><name><surname>Cowan</surname> <given-names>NJ</given-names></name><name><surname>Ankarali</surname> <given-names>MM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Body stiffness and damping depend sensitively on the timing of muscle activation in lampreys</article-title><source>Integrative and Comparative Biology</source><volume>205</volume><fpage>860</fpage><lpage>873</lpage><pub-id pub-id-type="doi">10.1093/icb/icy042</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uyanik</surname> <given-names>I</given-names></name><name><surname>Saranli</surname> <given-names>U</given-names></name><name><surname>Ankarali</surname> <given-names>MM</given-names></name><name><surname>Cowan</surname> <given-names>NJ</given-names></name><name><surname>Morgul</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2019">2019a</year><article-title>Frequency-Domain subspace identification of linear Time-Periodic (LTP) Systems</article-title><source>IEEE Transactions on Automatic Control</source><volume>64</volume><fpage>2529</fpage><lpage>2536</lpage><pub-id pub-id-type="doi">10.1109/TAC.2018.2867360</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uyanik</surname> <given-names>I</given-names></name><name><surname>Stamper</surname> <given-names>SA</given-names></name><name><surname>Cowan</surname> <given-names>NJ</given-names></name><name><surname>Fortune</surname> <given-names>ES</given-names></name></person-group><year iso-8601-date="2019">2019b</year><article-title>Sensory cues modulate smooth pursuit and active sensing movements</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>13</volume><elocation-id>59</elocation-id><pub-id pub-id-type="doi">10.3389/fnbeh.2019.00059</pub-id><pub-id pub-id-type="pmid">31024269</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Kooij</surname> <given-names>H</given-names></name><name><surname>Peterka</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Non-linear stimulus-response behavior of the human stance control system is predicted by optimization of a system with sensory and motor noise</article-title><source>Journal of Computational Neuroscience</source><volume>30</volume><fpage>759</fpage><lpage>778</lpage><pub-id pub-id-type="doi">10.1007/s10827-010-0291-y</pub-id><pub-id pub-id-type="pmid">21161357</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Handel</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="1965">1965</year><article-title>The obese mosquito</article-title><source>The Journal of Physiology</source><volume>181</volume><fpage>478</fpage><lpage>486</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1965.sp007776</pub-id><pub-id pub-id-type="pmid">5880372</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zollikofer</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Stepping patterns in ants-influence of load</article-title><source>The Journal of Experimental Biology</source><volume>192</volume><fpage>119</fpage><lpage>127</lpage><pub-id pub-id-type="pmid">9317463</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.51219.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Maler</surname><given-names>Len</given-names> </name><role>Reviewer</role><aff><institution>University of Ottawa</institution><country>Canada</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>The authors ask whether the neural controller (used when an animal engages in precise behavior) is optimized for each animal’s particular motor plant properties or whether a generic controller is sufficient and instead robust feedback mechanisms ensure that the generic controller works well despite variations in the motor plant. The authors have found a very clever way to address this problem in the refuge tracking behavior of an electric fish. The CNS controller controls the location of a 'nodal point' along the ribbon fin of these fish. Forward- and backward-directed oscillations of the ribbon fin (opposing forces) meet at the nodal point and the fish can precisely control the location of the nodal point in order to achieve both stability and maneuverability during locomotion. The movement of the nodal point serves as a linear estimate of the controller output of the fish as it tracks the moving refuge. Kinematic measurements were used to generate individualized estimates of each fish's locomotor plant and controller revealing substantial variability between fish. To test the impact of this variability on behavioral performance, these models were used to perform simulated 'brain transplants' – computationally swapping controllers and plants between individuals. The authors conclude that simulated closed-loop performance was robust to mismatch between plant and controller. This seminal observation suggests that animals rely on feedback rather than precisely tuned neural controllers to compensate for morphophysiological variability.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Variability in locomotor dynamics reveals the critical role of feedback in task control&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by Ronald Calabrese as the Senior and Reviewing Editor. The following individual involved in review of your submission has agreed to reveal their identity: Len Maler (Reviewer #1).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This is an impressive paper and builds on a series of impressive papers. The quality of the experiments and analyses is very high. The authors' perspective is from the engineering approach in which the motor activity of, e.g., a robot or weakly electric fish is divided into the mechanics (motor plant) and 'controller' (sensory system and CNS). Furthermore, the mechanics will vary across different animals due to their size etc. The question posed by the authors is whether the controller is optimized for each animal for its particular motor plant properties vs. whether a generic controller is sufficient and robust feedback mechanisms ensure that the generic controller works well despite variations in the motor plant. This is a very general question and one that is hard or impossible to address in most animal models. As carefully argued by the authors, devising separate data-driven models of controller and plant is very difficult for muscle-based plants simply because most motor actions (e.g., stepping) require coordination of many muscles across joints.</p><p>The authors, based on prior papers, have found a very clever way to circumvent this problem in the refuge tracking behavior of a weakly electric fish (<italic>Eigenmannia</italic>). Their earlier studies showed that the CNS controller operated by controlling the location of a 'nodal point' along the ribbon fin of these fish. Forward- and backward-directed oscillations of the ribbon fin (opposing forces) meet at the nodal point and the fish can precisely control the location of the nodal point in order to achieve both stability and maneuverability during locomotion. The position of the nodal point varies as a function of swim speed. The authors argue that the movement of the nodal point can serve as a linear estimate of the controller output of the fish as it tracks the moving refuge. Kinematic measurements of <italic>Eigenmannia</italic> were used to generate individualized estimates of each fish's locomotor plant and controller revealing substantial variability between fish. To test the impact of this variability on behavioral performance, these models were used to perform simulated 'brain transplants' – computationally swapping controllers and plants between individuals. The authors conclude that simulated closed-loop performance was robust to mismatch between plant and controller. This suggests that animals rely on feedback rather than precisely tuned neural controllers to compensate for morphophysiological variability.</p><p>Essential revisions:</p><p>1) There is a consensus that the manuscript is too dense with many points needing to be clarified as detailed in the attached reviews (Reviewer #2 in particular). We do think that this paper should be in a general journal like <italic>eLife</italic>, partially because it is important that neurobiologists become at least familiar with the concepts and, to a limited extent, to the methods of control theory as practiced by engineers. Right now, the manuscript just won't work for most neurobiologists. But it can be written in a much clearer way. The import of the equations should be explained in the text and the derivations placed in a supplementary information section for specialists.</p><p>2) Might the model be tested directly/experimentally by perturbing the motor plant, for example weighting the fish by overfeeding or with a weight belt (Reviewer #3)? There is a realization that these approaches might be unsuitable, but the experimenters are resourceful, and some perturbation might be found, e.g. clipping some of the ribbon fin (caudal quarter maybe).</p><p><italic>Reviewer #1:</italic></p><p>This is an impressive manuscript and built on a series of impressive papers. The quality of the experiments and analyses are very high and I have no serious concerns about the conclusions drawn with one caveat (see below).</p><p>The authors’ perspective is from the engineering approach in which the motor activity of, e.g., a robot or weakly electric fish is divided into the mechanics (motor plant) and 'controller' (sensory system and CNS). Furthermore, the mechanics will vary across different animals due to their size etc. The question posed by the authors is whether the controller is optimized for each animal with respect to its particular motor plant properties vs. whether a generic controller is sufficient and robust feedback mechanisms ensure that the generic controller works well despite variations in the motor plant.</p><p>This is a very general question and also one that is hard or impossible to address in most animal models. As carefully argued by the authors, devising separate data-driven models of controller and plant is very difficult for muscle-based plants simply because most motor actions (e.g., stepping) require coordination of many muscles across joints.</p><p>The authors, based on prior papers, have found a very clever way to circumvent this problem in the refuge tracking behaviour of a weakly electric fish (<italic>Eigenmannia</italic>). Their earlier studies showed that the CNS controller operated by controlling the location of a 'nodal point' along the ribbon fin of these fish. Forward- and backward-directed oscillations of the ribbon fin (opposing forces) meet at the nodal point and the fish can precisely control the location of the nodal point in order to achieve both stability and maneuverability during locomotion. The position of the nodal point varies as a function of swim speed. The authors argue, and I agree, that the movement of the nodal point can serve as a linear estimate of the controller output of the fish as it tracks the moving refuge.</p><p>Given this assumption and the authors’ prior papers, the experiments were well justified and well carried out. The analysis is, I expect, also well carried out. But here I think that the authors simply skipped too many steps in their derivations. This is the major problem that I think must be addressed in a revision.</p><p>1) &quot;We adopted the physics-based parametric model of locomotor dynamics of <italic>Eigenmannia</italic> described by Sefati et al., 2013&quot;, this is the 'controller dynamics'. This is Equation 1 in the Results and gives P(s). I think this is derived from Equation 4 is Sefati et al., 2013 (derived very nicely in the supplementary information). But, I fail to see the derivation. It is true that I did not expend a lot of effort trying to derive Equation 3 from Equation 4; however, I think that a typical reader should not have to make this attempt. The authors should make the derivation explicitly, perhaps in a supplementary information section (as was done in Sefati et al., 2013).</p><p>2) The authors then use a previous paper (Cowan and Fortune, 2007) to represent the behavioural response of the fish (Equation 2); this is well justified and gives G(s). The next point is the most critical and most novel. The authors then 'back calculate' the parameters for the controller, P(s), by using data driven behavioural model encapsulated in G(s). This results in Equation 3. At this point, Cowan and Fortune is cited and I got confused. Their closed loop transfer function, H(s), has an entirely different form from Equation 3. I am presumably missing something here and I think the authors really have to spell out in detail how the do the 'back calculation' and how it connects to Cowan and Fortune's results. Again, this would likely be a fairly detailed derivation and, as in the Sefati et al. paper, could be presented in supplementary information.</p><p>3) Lastly, I was struck by the parallel between the authors' conclusions and that of Marder and colleagues. Dr. Marder and colleagues have shown, over many papers, that the output of the STG pattern generator can be produced by many different (with respect to parameters) STG models. There is no unique STG pattern generator and the average parameters don't match any real STG. A paper by O'Leary and Marder (2016, Current Biology) advances a similar argument to the one in this manuscript – that &quot;The high variability in conductance densities in these neurons [9, 10] appears to contradict the possibility that robustness is achieved through precise tuning of key temperature-dependent processes.&quot;</p><p>This paper uses Ca-dependent global feedback (Ca entry depends on activity) to maintain robust STG activity over a wide range of temperatures, despite the individual ion channels not being tuned for this temperature range. Although the systems are entirely different the principle seems, to me, to be the same. It would be great to add this to the Discussion.</p><p>One overall conclusion of this paper is that &quot;Physics-based approaches for modeling behaviors at lower levels (e.g., the spiking activity of all motor neurons) may lead to a very complex model that does not accurately capture high-level behavior.&quot; I fully agree and I also am convinced that the feedback tuning mechanisms of this manuscript and the O'Leary and Marder paper are the way to go for modelling complex systems – when one is dealing with even the electrosensory system of <italic>Eigenmannia</italic>, there are too many parameters to be estimated for a realistic approach to neural models. This is a powerful conclusion and giving it the wider context – crab STG and <italic>Eigenmannia</italic> electrosensory system and ribbon fin.</p><p><italic>Reviewer #2:</italic></p><p>In this paper the authors build on their prior work examining the neuromechanical control of locomotion in <italic>Eigenmannia</italic> to attack an important and understudied question in motor control – how neural control strategies vary based on individual differences in the motor plant across individuals. To do so, the authors combine detailed behavioral measurements with control-theoretic analysis and simulations to argue that animals use feedback (sensory) signals, rather than precisely-tuned feedforward neural controllers, to robustly control behavior.</p><p>This is a potentially highly impactful paper, however, I have three major concerns as listed below. Also, I should provide the caveat that I am neither an expert in models of fish locomotion nor in the kind of control-theoretic analyses used here. Therefore I must leave the technical evaluation of these aspects to other reviewers.</p><p>1) Comprehensibility of this paper to a general audience of biologists. This is a highly technical paper which the authors are trying to squeeze into 4 main-text figures and the absolute minimum of explanatory text. Because of this choice, I think that this paper will not be comprehensible to most <italic>eLife</italic> readers (in its present state this seems much more appropriate for PLOS Comp Bio or some more specialized computational journal), thereby reducing its potential impact. I think the authors need to expand the text (and possibly include a couple of explanatory figures) to allow readers without control systems expertise to understand the paper. For example, a reader not already familiar with Nyquist or Bode plots will not be able to understand any of the key evidence for the authors' arguments presented in Figures 3 or 4. In the main text, the authors often cite their prior work rather than explaining essential components of their approach. This includes small things like not defining/explaining the variables in Equation 2 as well as explaining the key strengths of their model system – it took me several readings to understand what was meant by the nodal point providing a &quot;linear proxy&quot; for u(t).</p><p>2) Dissociating the role of feedback control from that of plant dynamics. The authors present the study as attempting to distinguish between two alternatives – that behavioral robustness arises from either precise feedforward neural control or well-tuned feedback control. However it's not clear to me whether or how the authors have ruled out a third possibility – that the physics of the plant are such that behavioral output (forward-backward movement in the refuge task) is simply insensitive to variations in the motor command, at least over the range of motor command variations actually produced by the fish. In fact the result shown in Figure 3C would appear to be consistent with this possibility. The authors offer this interpretation:</p><p>&quot;Surprisingly, however, the variability remained below the trial-to-trial variability (Figure 3C, gray region versus dashed line). These results highlight the fact that sensory feedback can attenuate the output variability despite mismatch between the controller and plant pairs. In other words, feedback models do not require precise tuning between the controller and plant to achieve the low variability we observed in the behavioral performance of the animals.&quot;</p><p>It seems to me that an equally plausible explanation is not that sensory feedback is compensating for &quot;mismatch&quot; errors, but rather that the physical plant is simply insensitive to errors. How can the authors rule this out? An analysis quantifying how much the natural variations in u(t) actually cause variations in y(t) would seem critical to answer this. It's possible that this issue is already implicitly addressed in the analyses provided, but if so I can't figure this out and I'd like the authors to clarify.</p><p>3) Expanding on a couple of Discussion points</p><p>The authors conclude the Discussion as follows:</p><p>&quot;The dynamic synthesis of filters based on current sensory information may be a mechanism that shapes neural controllers on two time scales: for the moment-to-moment task dynamics and over the longer term for the maintenance of behavioral performances.&quot;</p><p>I'd suggest that the authors expand on this idea a bit; at present it's not very clear to me how they think their simulation results (e.g. that the synthesis of the high-pass controller and low-pass plant yields a robust system) relate to the question of multiple timescales.</p><p>Also I'd encourage the authors to expand on possible biological implementations of their findings, and speculate a bit on how those implementations might be similar or different from those known in other model systems. For instance, the controller described here is able to produce similar results (i.e., tracking the same stimulus albeit with greater variability) with different parameters (i.e., switched case) and is reminiscent of multifunctional neural circuits such as those characterized in the crustacean pyloric system. In addition, the characterization of how feedback reduces variability is similar to how the role of feedback and CPG entrainment is studied in multiple species including cats, stick insects, and crayfish. To be clear I'm not suggesting that the authors review all of these (or even any of them in great depth), but I'm sure readers will wonder how the authors’ theories relate to ideas from other systems.</p><p><italic>Reviewer #3:</italic></p><p>I've been thinking a lot about this paper and while I argue that it should eventually be published in <italic>eLife</italic>, I think (for this broad readership journal) it could use some expansion regarding pedagogy on the control aspects. I find it very challenging to decide if I believe that the &quot;simulated swapping&quot; tells me anything fundamental about the system, or if it is just a computational exercise. I think it is not, but it is hard for me to evaluate given all the assumptions going into &quot;gray box&quot; model. What if the black box model isn’t the correct one? In particular, since the authors likely have room in terms of word count, and certainly have space in terms of numbers of figures, I think a bit more explanation of the methods to demystify the story would be helpful.</p><p>Based on the first paragraph of the Introduction, I would have expected to see how the controller changes when fish lose or gain weight (or some manipulation). But I am not convinced by their statement &quot;These changes likely result in variable mismatch between the neural controller and the locomotor plant of individual animals. This mismatch is similar to that induced by swapping plants and controllers across individuals, suggesting that moment-to-moment variability can also be eliminated through sensory feedback.&quot; Is this true? Why not do the (obviously harder) experiment of indeed letting the fish eat a lot (or not) and measuring the controller? That way, the authors don't have to do a virtual swap. Even better, why not add weighted &quot;jackets&quot; to the fish as a real &quot;plant&quot; manipulation? I think if they could show this, the paper would become outstanding (instead of &quot;just&quot; very cool as it is now).</p><p>This phrase in the Abstract &quot;virtually indistinguishable between conspecifics&quot; is a bit overwrought. What does &quot;virtually indistinguishable&quot; mean?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.51219.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) There is a consensus that the manuscript is too dense with many points needing to be clarified as detailed in the attached reviews (reviewer #2 in particular). We do think that this paper should be in a general journal like eLife, partially because it is important that neurobiologists become at least familiar with the concepts and, to a limited extent, to the methods of control theory as practiced by engineers. Right now, the manuscript just won't work for most neurobiologists. But it can be written in a much clearer way. The import of the equations should be explained in the text and the derivations placed in a supplementary information section for specialists.</p></disp-quote><p>Initially, we went too far in avoiding being “tutorial”, but we now recognize​ that we missed the mark and that our approaches require far more explanation to be accessible to a general biology audience. We address the details of this Essential Revision in our detailed responses to the individual reviewers.</p><disp-quote content-type="editor-comment"><p>2) Might the model be tested directly/experimentally by perturbing the motor plant, for example weighting the fish by overfeeding or with a weight belt (reviewer #3)? There is a realization that these approaches might be unsuitable, but the experimenters are resourceful, and some perturbation might be found, e.g. clipping some of the ribbon fin (caudal quarter maybe).</p></disp-quote><p>The current paper uses computational models to test the idea that the​ controllers are robust to perturbations in the plant dynamics. However, as the reviewers suggested, one might directly test this idea on the animal itself by adding a weight jacket, overfeeding, or clipping the ribbon fin. Indeed, such experiments are described in Roth, Sponberg, and Cowan, 2014 (see p57, first column, last paragraph therein).</p><p>We have considered trying similar experiments over the last 10 years and have not yet found the silver bullet. First, adding weight to these fish is extremely hard for at least two reasons: (a) any added mass would have to be neutrally buoyant (such as a water balloon), limiting the materials that can be used, and (b) these are very delicate animals, and so suturing or otherwise attaching objects of significant mass to the animal is extremely challenging without potential injury to the animal. Second, we have considered more dramatic measures such as fin clipping, especially since animals often arrive to the lab with damage to their ribbon fins. However, in both of these cases, one would want to perform the mechanical alterations “on the fly” to avoid the longer-time scales of sensorimotor adaptation. Lastly, we are unaware of examples where our fish will eat a significant portion of their body mass in one feeding.</p><p>However, the issue raised by the reviewers is both fundamental and not well explained in the original manuscript. We have added a new discussion point on this subject (subsection “Feedback and Variability in Neural Systems”, fourth paragraph), where we point to studies that perform analogous plant perturbation experiments in other model organisms.</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>[…]</p><p>Given this assumption and the authors prior papers, the experiments were well justified and well carried out. The analysis is, I expect, also well carried out. But here I think that the authors simply skipped too many steps in their derivations. This is the major problem that I think must be addressed in a revision.</p><p>1) &quot;We adopted the physics-based parametric model of locomotor dynamics of Eigenmannia described by Sefati et al., 2013&quot;, this is the 'controller dynamics'. This is Equation 1 in the Results and gives P(s). I think this is derived from Equation 4 is Sefati et al., 2013 (derived very nicely in the supplementary information). But, I fail to see the derivation. It is true that I did not expend a lot of effort trying to derive Equation 3 from Equation 4; however, I think that a typical reader should not have to make this attempt. The authors should make the derivation explicitly, perhaps in a supplementary information section (as was done in Sefati et al., 2013).</p></disp-quote><p>We have added the derivation and some clarifications to the Materials and​ methods. Specifically, we included a new subsection in Materials and methods, “Derivation of Plant Model”, which explains how P(s) is derived.</p><disp-quote content-type="editor-comment"><p>2) The authors then use a previous paper (Cowan and Fortune, 2007) to represent the behavioural response of the fish (Equation 2); this is well justified and gives G(s). The next point is the most critical and most novel. The authors then 'back calculate' the parameters for the controller, P(s), by using data driven behavioural model encapsulated in G(s). This results in Equation 3. At this point, Cowan and Fortune is cited and I got confused. Their closed loop transfer function, H(s), has an entirely different form from Equation 3. I am presumably missing something here and I think the authors really have to spell out in detail how the do the 'back calculation' and how it connects to Cowan and Fortune's results. Again, this would likely be a fairly detailed derivation and, as in the Sefati et al. paper, could be presented in supplementary information.</p></disp-quote><p>Yes, this was particularly confusing as some of the variables, including​ H(s), were renamed between previous publications and this manuscript. These differences have been resolved, and the essential components of the derivation added to the Materials and methods subsection “Inferring Controller using Plant and Closed-Loop Dynamics”.</p><p>Specifically, the closed-loop transfer function in the current manuscript, G(s) in Equation 2 is identical to H(s) in Equation 2 of Cowan and Fortune, 2007. Both manuscripts use the same approach: back-calculation of controllers from the closed-loop transfer function and plant dynamics. However, in the current manuscript we derived the controller for a general closed-loop transfer function G(s) and plant dynamics P(s) to obtain the solution given in Equation 3. This approach differs from Cowan and Fortune, 2007, where they solved for controllers for <italic>hypothetical</italic>​​ (not experimentally estimated) ​plant dynamics. Nevertheless, although the final equations for the controllers look different, they originate from the same derivations.</p><disp-quote content-type="editor-comment"><p>3) Lastly, I was struck by the parallel between the authors' conclusions and that of Marder and colleagues. Dr. Marder and colleagues have shown, over many papers, that the output of the STG pattern generator can be produced by many different (with respect to parameters) STG models. There is no unique STG pattern generator and the average parameters don't match any real STG. A paper by O'Leary and Marder (2016, Current Biology) advances a similar argument to the one in this manuscript – that &quot;The high variability in conductance densities in these neurons [9, 10] appears to contradict the possibility that robustness is achieved through precise tuning of key temperature-dependent processes.&quot;</p><p>This paper uses Ca-dependent global feedback (Ca entry depends on activity) to maintain robust STG activity over a wide range of temperatures, despite the individual ion channels not being tuned for this temperature range. Although the systems are entirely different the principle seems, to me, to be the same. It would be great to add this to the Discussion.</p><p>One overall conclusion of this paper is that &quot;Physics-based approaches for modeling behaviors at lower levels (e.g., the spiking activity of all motor neurons) may lead to a very complex model that does not accurately capture high-level behavior.&quot; I fully agree and I also am convinced that the feedback tuning mechanisms of this manuscript and the O'Leary and Marder paper are the way to go for modelling complex systems – when one is dealing with even the electrosensory system of Eigenmannia, there are too many parameters to be estimated for a realistic approach to neural models. This is a powerful conclusion and giving it the wider context – crab STG and Eigenmannia electrosensory system and ribbon fin.</p></disp-quote><p>Thanks for suggesting the STG work. We are always interacting with people​ in the STG field, but somehow we didn’t make this connection. This is related to reviewer 2’s comments, and the two have been folded together in two new paragraphs at the end of the Discussion (subsection “Feedback and Variability in Neural Systems”, third and fourth paragraphs).</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>[…]</p><p>This is a potentially highly impactful paper, however, I have three major concerns as listed below. Also, I should provide the caveat that I am neither an expert in models of fish locomotion nor in the kind of control-theoretic analyses used here. Therefore I must leave the technical evaluation of these aspects to other reviewers.</p><p>1) Comprehensibility of this paper to a general audience of biologists. This is a highly technical paper which the authors are trying to squeeze into 4 main-text figures and the absolute minimum of explanatory text. Because of this choice, I think that this paper will not be comprehensible to most eLife readers (in its present state this seems much more appropriate for PLOS Comp Bio or some more specialized computational journal), thereby reducing its potential impact. I think the authors need to expand the text (and possibly include a couple of explanatory figures) to allow readers without control systems expertise to understand the paper. For example, a reader not already familiar with Nyquist or Bode plots will not be able to understand any of the key evidence for the authors' arguments presented in Figures 3 or 4. In the main text, the authors often cite their prior work rather than explaining essential components of their approach. This includes small things like not defining/explaining the variables in Equation 2 as well as explaining the key strengths of their model system – it took me several readings to understand what was meant by the nodal point providing a &quot;linear proxy&quot; for u(t).</p></disp-quote><p>We added subsections “Derivation of Plant Model” and “Inferring Controller​ using Plant and Closed-Loop Dynamics” to the Materials and methods that provide step-by-step derivations and applications of the equations.</p><p>In addition, we added and revised sections in the Materials and methods related to calculating variability in the model systems. These new subsections are “Bootstrap Estimate of Behavioral Variability” and “Model Variability.”</p><p>Other changes were made throughout to improve the clarity of the modeling and analysis; see for example, subsection “Estimating a Data-Driven Plant Model”.</p><p>We also reorganized the figures to improve comprehensibility of the paper as follows: the revised Figure 1 now shows the schematic of the system, a feedback diagram, and example data for ribbon-fin location. The revised Figure 2 now shows the plant model, including how model parameters were estimated. The revised Figure 3 focuses on the “computational brain transplant”. The revised Figure 4 presents the primary computational results on the role of feedback on variability. The Figure 5 in the current manuscript is identical to Figure 4 in the previous submission.</p><p>As background, we had two major concerns about describing the math when we were writing the original manuscript. First, we were concerned that too much emphasis on the equations would obscure the critical point that this work is driven by experimental data obtained in animals. That data is a central feature of the paper that is essential for all of the subsequent modeling and analyses. Second, we were concerned that the manuscript might become a form of tutorial on the application of control theory, which was not the primary objective of this manuscript.</p><p>That said, our long-term goal to help bring these concepts and approaches into the general lexicon of biologists who study movement and locomotion. In addressing the reviewers’ concerns, we think that the revised manuscript does a far better job of achieving that long-term goal while avoiding the pitfalls that concerned us before.</p><disp-quote content-type="editor-comment"><p>2) Dissociating the role of feedback control from that of plant dynamics. The authors present the study as attempting to distinguish between two alternatives – that behavioral robustness arises from either precise feedforward neural control or well-tuned feedback control. However it's not clear to me whether or how the authors have ruled out a third possibility – that the physics of the plant are such that behavioral output (forward-backward movement in the refuge task) is simply insensitive to variations in the motor command, at least over the range of motor command variations actually produced by the fish. In fact the result shown in Figure 3C would appear to be consistent with this possibility. The authors offer this interpretation:</p><p>&quot;Surprisingly, however, the variability remained below the trial-to-trial variability (Figure 3C, gray region versus dashed line). These results highlight the fact that sensory feedback can attenuate the output variability despite mismatch between the controller and plant pairs. In other words, feedback models do not require precise tuning between the controller and plant to achieve the low variability we observed in the behavioral performance of the animals.&quot;</p><p>It seems to me that an equally plausible explanation is not that sensory feedback is compensating for &quot;mismatch&quot; errors, but rather that the physical plant is simply insensitive to errors. How can the authors rule this out? An analysis quantifying how much the natural variations in u(t) actually cause variations in y(t) would seem critical to answer this. It's possible that this issue is already implicitly addressed in the analyses provided, but if so I can't figure this out and I'd like the authors to clarify.</p></disp-quote><p>The reviewer is correct that the issue concerning the potential for the plant itself to be insensitive to errors was addressed implicitly in the original manuscript. Namely, if the plant were somehow able to reduce variability, it would manifest in the loop gain, since the loop gain is P(s)C(s). Indeed, the plants for the individual and merged fish are shown in Figure 2 and as can be seen, their gains vary by nearly a factor of 2 (from about 5 to about 10 at the lowest frequency). In addition, a related issue was mentioned in the original manuscript in describing parameter variability: “parameter estimates for the plant models varied two fold, but the parameter estimates for the closed-loop models varied around 15-20%“. Lastly, the plant gains are high (above 2 for low to mid frequencies) which means they will amplify errors. Indeed this is one of the features of robust feedback: open-loop sensitivity provides closed-loop robustness (see e.g. Csete and Doyle, 2002).</p><disp-quote content-type="editor-comment"><p>3) Expanding on a couple of discussion points</p><p>The authors conclude the Discussion as follows:</p><p>&quot;The dynamic synthesis of filters based on current sensory information may be a mechanism that shapes neural controllers on two time scales: for the moment-to-moment task dynamics and over the longer term for the maintenance of behavioral performances.&quot;</p><p>I'd suggest that the authors expand on this idea a bit; at present it's not very clear to me how they think their simulation results (e.g. that the synthesis of the high-pass controller and low-pass plant yields a robust system) relate to the question of multiple timescales.</p></disp-quote><p>We agree that the current study in no way addresses longer time scales of​ adaptation and is only focused on moment-to-moment control. Thus, this discussion point was not well fleshed out, and we decided to eliminate it altogether.</p><disp-quote content-type="editor-comment"><p>Also I'd encourage the authors to expand on possible biological implementations of their findings, and speculate a bit on how those implementations might be similar or different from those known in other model systems. For instance, the controller described here is able to produce similar results (i.e., tracking the same stimulus albeit with greater variability) with different parameters (i.e., switched case) and is reminiscent of multifunctional neural circuits such as those characterized in the crustacean pyloric system. In addition, the characterization of how feedback reduces variability is similar to how the role of feedback and CPG entrainment is studied in multiple species including cats, stick insects, and crayfish. To be clear I'm not suggesting that the authors review all of these (or even any of them in great depth), but I'm sure readers will wonder how the authors theories relate to ideas from other systems.</p></disp-quote><p>We agree this is an interesting connection, and is related to reviewer 1’s comments, which we address in tandem by adding two paragraphs to the end of the Discussion (subsection “Feedback and Variability in Neural Systems”, third and fourth paragraphs). Specifically, the work in stick insects includes perturbations to the mechanical plant (angle of the walking surface) with no changes in the kinematics. This is akin to the suggestion above for new experiments that perturb the animal’s plant.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>I've been thinking a lot about this paper and while I argue that it should eventually be published in eLife, I think (for this broad readership journal) it could use some expansion regarding pedagogy on the control aspects. I find it very challenging to decide if I believe that the &quot;simulated swapping&quot; tells me anything fundamental about the system, or if it is just a computational exercise. I think it is not, but it is hard for me to evaluate given all the assumptions going into &quot;gray box&quot; model. What if the black box model isn’t the correct one? In particular, since the authors likely have room in terms of word count, and certainly have space in terms of numbers of figures, I think a bit more explanation of the methods to demystify the story would be helpful.</p></disp-quote><p>We have expanded our description of the modeling and computational methods. See response to reviewer #2, issue #1.</p><disp-quote content-type="editor-comment"><p>Based on the first paragraph of the Introduction, I would have expected to see how the controller changes when fish lose or gain weight (or some manipulation). But I am not convinced by their statement &quot;These changes likely result in variable mismatch between the neural controller and the locomotor plant of individual animals. This mismatch is similar to that induced by swapping plants and controllers across individuals, suggesting that moment-to-moment variability can also be eliminated through sensory feedback.&quot; Is this true? Why not do the (obviously harder) experiment of indeed letting the fish eat a lot (or not) and measuring the controller. That way, the authors don't have to do a virtual swap? Even better, why not add weighted &quot;jackets&quot; to the fish as a real &quot;plant&quot; manipulation? I think if they could show this, the paper would become outstanding (instead of &quot;just&quot; very cool as it is now).</p></disp-quote><p>We have thought carefully about the types of experiments that we could​ attempt – including feeding, adding neutral buoyancy ballast, fin clips, and virtual reality to modulate feedback. Ultimately we want to make neurophysiological recordings from the neurons that comprise the neural controller in freely swimming fish that are performing tracking while systematically perturbing the locomotor plant.</p><p>To address this concern, we have added references and discussion about other species in which these sorts of manipulations have been made. See subsection “Feedback and Variability in Neural Systems”, third and fourth paragraphs.</p><disp-quote content-type="editor-comment"><p>This phrase in the Abstract &quot;virtually indistinguishable between conspecifics&quot; is a bit overwrought. What does &quot;virtually indistinguishable&quot; mean?</p></disp-quote><p>This imprecise statement has been replaced.</p></body></sub-article></article>