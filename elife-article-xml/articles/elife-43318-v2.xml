<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">43318</article-id><article-id pub-id-type="doi">10.7554/eLife.43318</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Shared behavioral mechanisms underlie <italic>C. elegans</italic> aggregation and swarming</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-124935"><name><surname>Ding</surname><given-names>Siyu Serena</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8590-3908</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-124936"><name><surname>Schumacher</surname><given-names>Linus J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0797-3406</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa1">‡</xref></contrib><contrib contrib-type="author" id="author-124937"><name><surname>Javer</surname><given-names>Avelino E</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa2">§</xref><xref ref-type="fn" rid="pa3">#</xref></contrib><contrib contrib-type="author" corresp="yes" id="author-59669"><name><surname>Endres</surname><given-names>Robert G</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1379-659X</contrib-id><email>r.endres@imperial.ac.uk</email><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-124934"><name><surname>Brown</surname><given-names>André EX</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1324-8764</contrib-id><email>andre.brown@imperial.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Instititue of Clinical Sciences</institution><institution>Imperial College London</institution><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution>MRC London Institute of Medical Sciences</institution><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Department of Life Sciences</institution><institution>Imperial College London</institution><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">MRC Centre for Regenerative Medicine</institution><institution>University of Edinburgh</institution><addr-line><named-content content-type="city">Edinburgh</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="senior_editor"><name><surname>Barkai</surname><given-names>Naama</given-names></name><role>Senior Editor</role><aff><institution>Weizmann Institute of Science</institution><country>Israel</country></aff></contrib><contrib contrib-type="editor"><name><surname>Mignot</surname><given-names>Tâm</given-names></name><role>Reviewing Editor</role><aff><institution>CNRS-Aix Marseille University</institution><country>France</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>‡</label><p>MRC Centre for Regenerative Medicine, University of Edinburgh, Edinburgh, United Kingdom</p></fn><fn fn-type="present-address" id="pa2"><label>§</label><p>Institute of Biomedical Engineering, University of Oxford, Oxford, United Kingdom</p></fn><fn fn-type="present-address" id="pa3"><label>#</label><p>Data Science Institute, University of Oxford, Oxford, United Kingdom</p></fn><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>25</day><month>04</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e43318</elocation-id><history><date date-type="received" iso-8601-date="2018-11-01"><day>01</day><month>11</month><year>2018</year></date><date date-type="accepted" iso-8601-date="2019-04-19"><day>19</day><month>04</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Ding et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Ding et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-43318-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.43318.001</object-id><p>In complex biological systems, simple individual-level behavioral rules can give rise to emergent group-level behavior. While collective behavior has been well studied in cells and larger organisms, the mesoscopic scale is less understood, as it is unclear which sensory inputs and physical processes matter <italic>a priori</italic>. Here, we investigate collective feeding in the roundworm <italic>C. elegans</italic> at this intermediate scale, using quantitative phenotyping and agent-based modeling to identify behavioral rules underlying both aggregation and swarming—a dynamic phenotype only observed at longer timescales. Using fluorescence multi-worm tracking, we quantify aggregation in terms of individual dynamics and population-level statistics. Then we use agent-based simulations and approximate Bayesian inference to identify three key behavioral rules for aggregation: cluster-edge reversals, a density-dependent switch between crawling speeds, and taxis towards neighboring worms. Our simulations suggest that swarming is simply driven by local food depletion but otherwise employs the same behavioral mechanisms as the initial aggregation.</p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.43318.002</object-id><title>eLife digest</title><p>Anyone who has watched a flock of birds maneuver through the sky has probably wondered how so many animals coordinate their movements. Often, these seemingly complex group behaviors can be explained by a few simple rules that govern the behavior of the individuals in the group. For example, if each bird flies and reacts to its neighbors in a certain way, the whole flock’s flight pattern results from these individual choices.</p><p>Computer simulations can help researchers to test how individual behaviors contribute to coordinated group movements. Ding, Schumacher et al. have now used a simulation to uncover the rules that control the behavior of small worms called <italic>Caenorhabditis elegans</italic>, which form large groups while feeding on bacteria.</p><p>To gather the data needed to form the computer model, Ding, Schumacher et al. genetically engineered <italic>C. elegans</italic> worms to produce fluorescent proteins. The fluorescence allows the movements of the worms to be monitored automatically in time-lapse movies made from a series of microscope images. The movies show that worm clusters move together over a patch of food, consuming it as they go. As the food disappears, the whole worm cluster moves to a new area in search of more food.</p><p>The computer simulation that Ding, Schumacher et al. developed to recreate how the clusters move revealed that individual worms in the group interact according to three rules. Firstly, worms slow down when they have more neighbors. Secondly, when a worm leaves its cluster, it will reverse to rejoin the group. And finally, worms will move towards areas with more neighbors.</p><p>It is still not known why the <italic>C. elegans</italic> worms form clusters, but understanding how the individuals in the group interact could help future studies to uncover this reason. Many other organisms benefit from forming similar groups, from single celled bacteria to animals such as birds and fish. The results presented by Ding, Schumacher et al. will therefore help researchers to consider whether there are universal rules that control group behavior.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>quantitative behavior</kwd><kwd>collective behavior</kwd><kwd>animal tracking</kwd><kwd>agent-based modeling</kwd><kwd>aggregation</kwd><kwd>swarming</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>C. elegans</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>Biotechnology and Biological Sciences Research Council</institution></institution-wrap></funding-source><award-id>BB/N00065X/1</award-id><principal-award-recipient><name><surname>Endres</surname><given-names>Robert G</given-names></name><name><surname>Brown</surname><given-names>André EX</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id><institution>Medical Research Council</institution></institution-wrap></funding-source><award-id>MC-A658-5TY30</award-id><principal-award-recipient><name><surname>Brown</surname><given-names>André EX</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Two seemingly distinct behaviors in social <italic>C. elegans</italic> worms, namely aggregating into groups and swarming over food, are driven by the same underlying mechanisms.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Collective behavior has been widely studied in living and non-living systems. While very different in their details, shared principles have begun to emerge, such as the importance of alignment for flocking behavior in both theoretical models and birds (<xref ref-type="bibr" rid="bib7">Bialek et al., 2012</xref>; <xref ref-type="bibr" rid="bib38">Pearce et al., 2014</xref>; <xref ref-type="bibr" rid="bib43">Reynolds, 1987</xref>). Until now, the study of collective behavior has mainly focused on cells and active particles at the microscale, controlled by molecule diffusion and direct contact between cells or particles (<xref ref-type="bibr" rid="bib32">Köhler et al., 2011</xref>; <xref ref-type="bibr" rid="bib19">De Palo et al., 2017</xref>; <xref ref-type="bibr" rid="bib40">Peruani et al., 2012</xref>; <xref ref-type="bibr" rid="bib53">Starruß et al., 2012</xref>), and on animals at the macroscale, aided by long-range visual cues (<xref ref-type="bibr" rid="bib7">Bialek et al., 2012</xref>; <xref ref-type="bibr" rid="bib31">Katz et al., 2011</xref>; <xref ref-type="bibr" rid="bib38">Pearce et al., 2014</xref>). Collective behavior at the intermediate mesoscale is less well-studied, as it is unclear what processes to include <italic>a priori</italic>. At the mesoscale, sensory cues and motility may still be limited by the physics of diffusion and low Reynolds numbers, respectively, yet the inclusion of nervous systems allows for increased signal processing and a greater behavioral repertoire. Do the rules governing collective behavior at this intermediate scale resemble those at the micro- or the macro-scale, some mixture of both, or are new principles required?</p><p><italic>C. elegans</italic> collective behavior can contribute to bridging this scale gap. Some strains of this 1 mm-long roundworm are known to aggregate into groups on food (<xref ref-type="bibr" rid="bib18">de Bono and Bargmann, 1998</xref>); here we also report an additional dynamic swarming phenotype that occurs over longer time periods. <italic>C. elegans</italic> represents an intermediate scale not only in physical size but also in behavioral complexity—crawling with negligible inertia, limited to touch and chemical sensing, yet possessing a compact nervous system with 302 neurons (<xref ref-type="bibr" rid="bib62">White et al., 1986</xref>) that supports a complex behavioral repertoire (<xref ref-type="bibr" rid="bib26">Hart, 2006</xref>; <xref ref-type="bibr" rid="bib48">Schwarz et al., 2015</xref>). Wild <italic>C. elegans</italic> form clusters on food at ambient oxygen concentrations, as do loss-of-function neuropeptide receptor 1 (<italic>npr-1</italic>) mutants. The laboratory reference strain N2, on the other hand, has a gain-of-function mutation in the <italic>npr-1</italic> gene that suppresses aggregation (<xref ref-type="bibr" rid="bib18">de Bono and Bargmann, 1998</xref>), rendering N2 animals solitary feeders. Thus, a small genetic difference (just two base pairs in one gene for the <italic>npr-1(ad609lf)</italic> mutant) has a big effect on the population-level behavioral phenotype. Previous research on collective feeding has focused primarily on the genetics and neural circuits that govern aggregation (<xref ref-type="bibr" rid="bib9">Bretscher et al., 2008</xref>; <xref ref-type="bibr" rid="bib11">Busch et al., 2012</xref>; <xref ref-type="bibr" rid="bib13">Chang et al., 2006</xref>; <xref ref-type="bibr" rid="bib14">Cheung et al., 2005</xref>; <xref ref-type="bibr" rid="bib17">de Bono et al., 2002</xref>; <xref ref-type="bibr" rid="bib18">de Bono and Bargmann, 1998</xref>; <xref ref-type="bibr" rid="bib21">Gray et al., 2004</xref>; <xref ref-type="bibr" rid="bib29">Jang et al., 2017</xref>; <xref ref-type="bibr" rid="bib34">Macosko et al., 2009</xref>), rather than on a detailed understanding of the behavior itself. <xref ref-type="bibr" rid="bib44">Rogers et al. (2006)</xref> is a notable exception and includes an investigation of the behavioral motifs that might lead to cluster formation including direction reversals at the edge of clusters. However, we do not know whether these candidate motifs are sufficient to produce aggregation. We also do not know whether aggregation at short times and swarming at longer times are distinct behaviors or different emergent properties of the same underlying phenomenon.</p><p>In this paper, we use fluorescence imaging and multi-worm tracking to examine individual behavior inside aggregates. We present new and systematic quantification of the aggregation behavior in hyper-social <italic>npr-1(ad609lf)</italic> mutants (henceforth referred to as <italic>npr-1</italic> mutants) and hypo-social N2 worms. Next, we draw on the concept of motility-induced phase transitions to explain aggregation as an emergent phenomenon by modulating only a few biophysical parameters. Unlike aggregation driven by attractive forces, in motility-induced phase transitions individuals can also aggregate simply due to their active movement and non-attractive interactions, such as volume exclusion (avoidance of direct overlap) (<xref ref-type="bibr" rid="bib41">Redner et al., 2013a</xref>). For instance, this concept has contributed understanding to the aggregation of rod-shaped <italic>Myxococcus xanthus</italic> bacteria, which, similar to <italic>C. elegans</italic>, also exhibit reversals during aggregation (<xref ref-type="bibr" rid="bib36">Mercier and Mignot, 2016</xref>; <xref ref-type="bibr" rid="bib40">Peruani et al., 2012</xref>; <xref ref-type="bibr" rid="bib53">Starruß et al., 2012</xref>). We build an agent-based phenomenological model of simplified worm motility and interactions. By mapping out a phase diagram of behavioral phenotypes, we show that modulating cluster-edge reversals and a density-dependent switch between crawling speeds are sufficient to produce some aggregation, but not the compact clusters observed in experiments. We found that medium-range taxis towards neighboring worms is necessary to tighten clusters and increase persistence. Finally, combining this model with food depletion gives rise to swarming over time, suggesting that the same behavioral rules that lead to the initial formation of aggregates also underlie the dynamic swarming reported here.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Dynamic swarming occurs in social worms at long time scales</title><p>Aggregation has most often been characterized as the fraction of worms inside clusters, where individual worms can move in and out of clusters. Here we report an additional dynamic swarming phenotype in aggregating <italic>C. elegans</italic> that occurs on a timescale of hours. Here, swarming refers to the collective movement of a coherent group of worms across a bacterial lawn (<xref ref-type="fig" rid="fig1">Figure 1A</xref>, <xref ref-type="video" rid="video1">Video 1</xref>). Because of the long timescale, this behavior is not obvious from manual observations of worms on a plate, but becomes clear in time lapse videos (<xref ref-type="fig" rid="fig1">Figure 1B and C</xref>, <italic>npr-1</italic> panels). Even though N2 worms do not swarm in our experiments (<xref ref-type="fig" rid="fig1">Figure 1B and C</xref>, N2 panels), they can swarm under appropriate conditions, such as when a clonal population has depleted almost all food (<xref ref-type="bibr" rid="bib28">Hodgkin and Barnes, 1991</xref>) or on unpalatable <italic>Pseudomonas fluorescens</italic> bacterial lawns (personal communication from J. Hodgkin and G.M. Preston). Thus swarming in <italic>C. elegans</italic> does not require loss of <italic>npr-1</italic> function in all environments.</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.43318.003</object-id><label>Figure 1.</label><caption><title><italic>npr-1</italic> but not N2 worms show swarming behavior over time on thin bacterial lawn.</title><p>(<bold>A</bold>) A few hundred <italic>npr-1</italic> mutant worms form dense clusters that move on food over time. Red dashed lines show the food boundary, where area with food is to the right and food-depleted area is to the left; red arrows show the direction of cluster movement. (<bold>B</bold>) Forty <italic>npr-1</italic> mutant worms also cluster and swarm on food. Solid circles encompass the same cluster at different time points; dashed circles show cluster positions prior to the current time point. The same number of N2 worms do not swarm under our experimental conditions, and instead disperse after initial transient aggregation. (<bold>C</bold>) Visualization of persistent swarming over time. One frame was sampled every 30 s over the duration of the videos and binary segmentation was applied using an intensity threshold to separate worm pixels from the background. Blobs with areas above a threshold value were plotted as clusters to show cluster position over time. The same videos as in (B) were used. Dashed circles show the food boundary. Crosses are cluster centroids at each sample frame. (<bold>D</bold>) Centroid speed of persistent <italic>npr-1</italic> clusters, calculated from centroid positions as indicated in (C) and smoothed over 10 min. Shaded area shows standard deviation across five replicates.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.43318.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title><italic>npr-1</italic> swarming on a bigger food patch.</title><p>Forty <italic>npr-1</italic> animals swarm over a big food patch, reminiscent of a persistent random walk. More than one large moving clusters co-exist towards the end of the video (orange and yellow), and a cluster (orange) disperses and re-forms elsewhere (orange and yellow) when it crosses its previous path (blue), presumably due to local food depletion.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.43318.005</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Stereotyped temporal dynamics.</title><p>One-hour fluorescence recordings of <italic>npr-1</italic> animals under our experimental conditions consist of reproducible temporal dynamics encompassing three phases: transient (animals move about the lawn and start to form clusters), aggregation (clusters largely remain stable with individuals entering and exiting), and swarming (worms move across the lawn in persistent clusters) (see sample <xref ref-type="video" rid="video2">Video 2</xref>). Percentage of in-cluster worms remain largely consistent throughout the latter two phases, except that clusters remain in place during the aggregation phase and become dynamic during the swarming phase. Error bars represent standard deviation across 13 (<italic>npr-1</italic>) and 9 (N2) replicates. The average duration of each phase derived from <italic>npr-1</italic> experiments are applied to N2 data to maintain temporal consistency, even though N2 does not exhibit aggregation or swarming. Subsequent quantitative analyses for both strains were restricted to using the data from the aggregation (for all but <xref ref-type="fig" rid="fig1">Figure 1D</xref>) or swarming (for <xref ref-type="fig" rid="fig1">Figure 1D</xref>) phase, in order to reveal the mechanisms necessary for producing aggregation or the dynamics of swarming, respectively.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig1-figsupp2-v2.tif"/></fig></fig-group><media id="video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-43318-video1.mp4"><object-id pub-id-type="doi">10.7554/eLife.43318.006</object-id><label>Video 1.</label><caption><title>Sample video showing <italic>npr-1</italic> collective feeding dynamics (bright field high-number swarming imaging).</title><p>The video plays at 300x the normal speed.</p></caption></media><p>Dynamic swarming occurs with just 40 <italic>npr-1</italic> mutants (<xref ref-type="fig" rid="fig1">Figure 1B</xref>, top row), making it experimentally feasible to study. Usually a single <italic>npr-1</italic> aggregate forms on the food patch and then moves around the lawn in a persistent but not necessarily directed manner (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, left; <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), at a steady speed (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). The onset of this collective movement appears to coincide with local food depletion, and continues until complete food depletion, at which time the cluster disperses. More than one moving cluster may co-exist, and occasionally a cluster may disperse and form elsewhere when it crosses its previous path (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), presumably due to local food depletion. The observed pattern of <italic>npr-1</italic> cluster motion is reminiscent of a self-avoiding, persistent random walk (i.e. not returning to areas that the worms have previously been where there is no food left). By contrast, after initially forming transient clusters on the lawn, N2 worms move radially outwards with no collective movement (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, right).</p></sec><sec id="s2-2"><title>Fluorescence imaging and automated animal tracking allows quantification of dynamics inside and outside of aggregates</title><p>Based on our observation that swarming appears to be driven by food depletion, we hypothesize the phenomenon may be a dynamic extension of the initial aggregation that occurs before depletion. To test this idea, we first sought to identify the mechanisms underlying aggregation.</p><p>The presence of aggregates is clear in bright field images, but it is difficult to track individual animals in these strongly overlapping groups for quantitative behavioral analysis. We therefore labeled the pharynx of worms with green fluorescent protein (GFP) and used fluorescence imaging in order to minimize overlap between animals (<xref ref-type="video" rid="video2">Video 2</xref>), making it possible to track most individuals even when they are inside a dense cluster (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). We also labeled a small number of worms (1–3 animals out of 40 per experiment) with a red fluorescent protein (RFP)-tagged body wall muscle marker instead of pharynx-GFP. These RFP-labeled worms were recorded on a separate channel during simultaneous two-color imaging (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), thus allowing both longer trajectories and the full posture to be obtained in a subset of animals. We wrote a custom module for Tierpsy Tracker (<xref ref-type="bibr" rid="bib30">Javer et al., 2018</xref>) to segment light objects on a dark background and to identify the anterior end of the marked animals automatically, in order to extract trajectories and skeletons of multiple worms from our data (<xref ref-type="fig" rid="fig2">Figure 2C</xref>).</p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.43318.007</object-id><label>Figure 2.</label><caption><title>Fluorescence multi-worm tracking.</title><p>(<bold>A</bold>) <italic>npr-1</italic> mutant and N2 animals exhibit different social behaviors on food, with the former being hyper-social (top left) and the latter being hypo-social (top right). Using a pharynx-GFP label (bottom row), individual animals may be followed inside a cluster. (<bold>B</bold>) In two-color experiments, worms are either labeled with pharynx-GFP (left) or body wall muscle-RFP (middle). As the two colors are simultaneously acquired on separate channels, the selected few RFP-labeled individuals are readily segmented and may be tracked for a long time, even inside a dense cluster. (<bold>C</bold>) Tierpsy Tracker tracks multiple worms simultaneously, generating both centroid trajectories (left, image color inverted for easier visualization; multiple colors show distinct trajectories) and skeletons (middle, pharynx-marked animal; right, body wall muscle-marked animal; red dots denote the head nodes of the skeleton).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig2-v2.tif"/></fig><media id="video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-43318-video2.mp4"><object-id pub-id-type="doi">10.7554/eLife.43318.008</object-id><label>Video 2.</label><caption><title>Sample video showing <italic>npr-1</italic> collective feeding dynamics (fluorescence 40 worm aggregation imaging).</title><p>The video plays at 90x the normal speed.</p></caption></media></sec><sec id="s2-3"><title>Ascarosides and direct adhesion are unlikely to drive different aggregation phenotypes</title><p>We first considered long-range chemotaxis driven by food or diffusible ascaroside pheromone signals as a potential behavioral mechanism. Chemotaxis towards food can likely be ignored as our experiments were performed on thin, even bacterial lawns, and worms are mostly on food during the aggregation phase of the experiments (99.7 ± 0.4% for <italic>npr-1</italic> and 99.8 ± 0.3% for N2, mean ±S.D.). Although ascarosides are important for processes such as mating and dauer formation in <italic>C. elegans</italic> (<xref ref-type="bibr" rid="bib51">Srinivasan et al., 2008</xref>), it is less clear whether long-range signaling via pheromones plays a role in aggregation (<xref ref-type="bibr" rid="bib17">de Bono et al., 2002</xref>; <xref ref-type="bibr" rid="bib34">Macosko et al., 2009</xref>). <italic>daf-22(m130)</italic> mutants do not produce ascarosides, but <italic>daf-22;npr-1</italic> double mutants aggregate similarly to <italic>npr-1</italic> single mutants (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>), consistent with the observation that the hermaphrodite-attractive pheromone icas#3 is attractive to both N2 animals and <italic>npr-1</italic> mutants (<xref ref-type="bibr" rid="bib52">Srinivasan et al., 2012</xref>) and is thus unlikely to explain the difference in their propensity to aggregate. Moreover, attraction between moving objects is known to produce aggregation in active matter systems (<xref ref-type="bibr" rid="bib41">Redner et al., 2013a</xref>), but it is not known whether this applies to worms. Short-range attraction between worms may exist in the form of adhesion mediated through a liquid film (<xref ref-type="bibr" rid="bib20">Gart et al., 2011</xref>), but we have no reason to believe this would differ between <italic>npr-1</italic> and N2 strains.</p></sec><sec id="s2-4"><title>Reversal rates and speed depend on neighbor density more strongly in <italic>npr-1</italic> mutants than in N2</title><p>Having considered long-range food- or ascaroside-mediated attraction and short-range adhesion, we next focused on behavioral responses to nearby neighbors. While postural changes do not seem to be a main driver of aggregation as principal component analysis of lone versus in-cluster <italic>npr-1</italic> worms revealed similar amplitudes in the posture modes (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>), we found experimental evidence for density-dependence of both reversal rates and speed and that these differ between the two strains we studied.</p><p>Reversals have been previously suggested as a behavior that may enable <italic>npr-1</italic> worms to stay in aggregates (<xref ref-type="bibr" rid="bib44">Rogers et al., 2006</xref>). To avoid cluster definitions based on thresholding the distance between worms, we quantified individual worm behavior as a function of local density (<xref ref-type="fig" rid="fig3">Figure 3A</xref>) instead. Calculating the reversal rates relative to that of worms at low densities, we found that <italic>npr-1</italic> mutants reverse more at increased neighbor densities, while N2 animals do not (<xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.43318.009</object-id><label>Figure 3.</label><caption><title>Individual-level behavioral quantification.</title><p>(<bold>A</bold>) Schematic explaining <italic>k</italic>-nearest neighbor density estimation. (<bold>B</bold>) Relative rate of reversals as a function of local density (<italic>k</italic>-nearest neighbor density estimation with <italic>k</italic> = 6) for <italic>npr-1</italic> (blue) and N2 (orange) strains. Lines show means and shaded area shows the standard error (bootstrap estimate, 100 samples with replacement). (<bold>C</bold>) Distributions of crawling speeds at different local neighbor densities for both strains. Lines show histograms of speeds for each density bin, and the color of the line indicates the density (blue is high, magenta is low). (<bold>D</bold>) Midbody absolute speed for manually annotated <italic>npr-1</italic> cluster entry (left, n = 28) and exit events (right, n = 29). Each event was manually identified, with time 0 representing the point where the head or tail of a worm starts to enter (left) or exit (right) an existing cluster. Skeleton <italic>xy</italic>-coordinates were linearly interpolated for missing frames for each event, before being used to calculate midbody speed extending 20 s on both sides of time 0 of the event. Speeds were smoothed over a one-second window. Shading represents standard deviation across events. Each red line shows the midbody absolute speed of a selected event that is shown in <xref ref-type="video" rid="video3">Video 3</xref> (left) or <xref ref-type="video" rid="video4">Video 4</xref> (right).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.43318.010</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Pheromones appear unimportant for aggregation.</title><p><italic>npr-1</italic> and N2 animals with pheromones removed by a <italic>daf-22</italic> mutation aggregate to similar levels as their pheromone-intact counterparts. Top row: snapshots of 40 worms from each strain behaving on a thin, uniform lawn. Bottom left: quantification of cluster area relative to single worm area for each strain; dashed line shows the cut-off values used to generate the violin plot on the bottom right. Bottom right: probability of having a relative cluster area above the threshold value (dashed line on the bottom left). Blob area were extracted as tracking features. For each recording, a random sample (without replacement) of 500 single worms was used to calculate single-worm mean area, which was used to normalize multi-worm cluster areas from that recording. Relative cluster area values for each strain were pooled across recording replicates, and histograms were created with a bin width of 0.5.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.43318.011</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Shape analysis for lone and in-cluster <italic>npr-1</italic> worms.</title><p>Left two panels: first four eigenworms (<xref ref-type="bibr" rid="bib54">Stephens et al., 2008</xref>) plotted in real space for projections of lone worms and in-cluster worms. Right: variance explained as a function of the number of eigenworms. Eigenworms are based on common reference (<xref ref-type="bibr" rid="bib10">Brown et al., 2013</xref>) set for both strains and worm categories.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig3-figsupp2-v2.tif"/></fig></fig-group><p>Next we calculated the speed distributions of individual worms, binned by local neighbor density. We found that both strains slow down when surrounded by many other worms, but the shift is more pronounced for <italic>npr-1</italic> animals. <italic>npr-1</italic> worms move faster than N2 at low densities, showing a distinct peak at high speeds. As neighbor density increases, this high speed peak gradually becomes replaced by a peak at low speeds, so that the overall speed distribution for <italic>npr-1</italic> resembles that of N2 at very high densities. Thus, <italic>npr-1</italic> and N2 animals show different density-dependent changes in their respective speed profiles (<xref ref-type="fig" rid="fig3">Figure 3C</xref>).</p><p>Since the observed transition of the speed profiles could occur due to active behavioral changes as well as restricted movement in clusters, we also considered tracks of individual worms. Using body wall muscle-marked worms allowed us to obtain longer trajectories that could be joined for the duration of an entire video, including cluster entry and exit events. We compared the speed of these tracks with visual assessment of when a worm entered or exited a cluster based on the proximity to pharynx-labeled worms. We found that worms are able to move inside of clusters and observed that speed changes can occur prior to cluster entry and exit events (<xref ref-type="fig" rid="fig3">Figure 3D</xref>, <xref ref-type="video" rid="video3">Video 3</xref> and <xref ref-type="video" rid="video4">Video 4</xref>). This change of speed is neither purely mechanical nor a deterministic response to a certain neighbor density, and suggests a mechanism in which worms probabilistically switch between different speeds.</p><media id="video3" mime-subtype="mp4" mimetype="video" xlink:href="elife-43318-video3.mp4"><object-id pub-id-type="doi">10.7554/eLife.43318.012</object-id><label>Video 3.</label><caption><title>A single event showing switch from high to low motility state prior to cluster entry (fluorescence 40 worm aggregation imaging).</title><p>The red worm at the bottom (arrow) decreases speed before entering a cluster. Inset: midbody absolute speed of that individual with respect to time 0 as the point of the head entering a cluster; open blue circle shows the current speed matched to the video frame.</p></caption></media><media id="video4" mime-subtype="mp4" mimetype="video" xlink:href="elife-43318-video4.mp4"><object-id pub-id-type="doi">10.7554/eLife.43318.013</object-id><label>Video 4.</label><caption><title>A single event showing switch from low to high motility state prior to cluster exit (fluorescence 40 worm aggregation imaging).</title><p>The red worm increases speed before exiting a cluster. Inset: midbody absolute speed of that individual with respect to time 0 as the point of the head exiting a cluster; open blue circle shows the current speed matched to the video frame.</p></caption></media></sec><sec id="s2-5"><title>Spatial statistics show group-level differences between <italic>npr-1</italic> and N2 animals</title><p>The differences in aggregation behavior between <italic>npr-</italic>1 and N2 are visually striking, but previous quantification has typically been limited to the fraction of animals in clusters. Using the tracked positions of pharynx-labeled worms (<xref ref-type="fig" rid="fig4">Figure 4A</xref>), we calculated the pair-correlation function (<xref ref-type="fig" rid="fig4">Figure 4B</xref>), commonly used to quantify aggregation in cellular and physical systems (<xref ref-type="bibr" rid="bib23">Gurry et al., 2009</xref>). We also computed a hierarchical clustering of worm positions (<xref ref-type="fig" rid="fig4">Figure 4C</xref>), which is calculated from the same pairwise distances but emphasizes larger scale structure. Using both measures, we found that as a population, <italic>npr-1</italic> animals show quantifiably higher levels of aggregation than N2, especially at scales up to 1 mm (pair-correlation ‘<italic>S<sub>1</sub></italic>’, <xref ref-type="fig" rid="fig4">Figure 4D</xref>) and 2 mm (hierarchical clustering ‘<italic>S<sub>2</sub></italic>’, <xref ref-type="fig" rid="fig4">Figure 4E</xref>). We also quantified aggregation using scalar spatial statistics, namely the average standard deviation (‘<italic>S<sub>3</sub></italic>’) and kurtosis (‘<italic>S<sub>4</sub></italic>’) of the distribution of positions. This confirms that the positions of <italic>npr-1</italic> worms are less spread-out and more heavy-tailed than those of N2 (<xref ref-type="fig" rid="fig4">Figure 4D</xref>).</p><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.43318.014</object-id><label>Figure 4.</label><caption><title>Population-level behavioral quantification.</title><p>(<bold>A</bold>) Positions of <italic>npr-1</italic> worms in an example frame. (<bold>B</bold>) Schematic explaining pair correlation function (<italic>S<sub>1</sub></italic>), which counts the number of neighbors at a distance <italic>r</italic>, normalized by the expectation for a uniform distribution. (<bold>C</bold>) Example dendrogram from which hierarchical clustering branch length distributions (<italic>S<sub>2</sub></italic>) can be calculated. (<bold>D</bold>) Pair correlation function for <italic>npr-1</italic> (blue) and N2 (orange). Lines show mean and shaded area shows standard error of the mean. (<bold>E</bold>) Hierarchical clustering branch length distributions for <italic>npr-1</italic> (blue) and N2 (orange). Histograms show relative frequency of inter-cluster distances (single linkage distance in agglomerative hierarchical clustering, equivalent to the branch lengths in the example dendrogram in (C)). (<bold>F</bold>) Mean standard deviation (<italic>S<sub>3</sub></italic>) and kurtosis (<italic>S<sub>4</sub></italic>) of the positions of worms, with the mean taken over frames sampled.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig4-v2.tif"/></fig></sec><sec id="s2-6"><title>Agent-based model captures different aggregation phenotypes</title><p>To test whether the individual behavioral differences measured between <italic>npr-1</italic> and N2 worms are sufficient to give rise to the observed differences in aggregation, we constructed a phenomenological model of worm movement and interactions. The model is made up of self-propelled agents (<xref ref-type="fig" rid="fig5">Figure 5A</xref>), and includes density-dependent interactions motivated by the experimental data, namely reversals at the edge of a cluster (<xref ref-type="fig" rid="fig5">Figure 5B</xref>) and a switch between movement at different speeds (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). As a model of collective behavior this differs from those commonly considered in the literature, such as the Vicsek model (<xref ref-type="bibr" rid="bib58">Vicsek et al., 1995</xref>) and its many related variants (<xref ref-type="bibr" rid="bib59">Vicsek and Zafeiris, 2012</xref>; <xref ref-type="bibr" rid="bib63">Yates et al., 2011</xref>). Such models typically feature attractive forces or align the direction of motion at ranges much longer than the size of the moving objects, and result in flocking or clustering with global alignment (<xref ref-type="fig" rid="fig5">Figure 5D</xref>), which we do not observe in our experimental data. In contrast, our model needs to produce dynamic, disordered aggregates (<xref ref-type="fig" rid="fig1">Figure 1B</xref>, <xref ref-type="fig" rid="fig2">Figure 2A</xref> and <xref ref-type="video" rid="video2">Video 2</xref>), and should primarily rely on short-range interactions that are motivated by behaviors measured in our data.</p><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.43318.015</object-id><label>Figure 5.</label><caption><title>Agent-based modeling of emergent behavior.</title><p>(<bold>A</bold>) Schematic of individual worm in the agent-based model. Each worm is made up of <italic>M</italic> nodes (here <italic>M</italic> = 18), connected by springs to enforce non-extensibility. Each node undergoes self-propelled movement, with the head node (red dot) undergoing a persistent random walk, and the rest of the nodes follow in the direction of the body. (<bold>B</bold>) Schematic of simulated reversals upon exiting a cluster. Each worm registers contact at the first and last 10% of its nodes within a short interaction radius. If contact is registered at one end but not the other, the worm is leaving a cluster and thus reverses with a Poisson rate dependent on the local density. (<bold>C</bold>) Schematic of density-dependent switching between movement speeds. Worms stochastically switch between slow and fast movement with Poisson rates <italic>k</italic><sub>slow</sub> and <italic>k</italic><sub>fast</sub>, which increase linearly and decrease exponentially with neighbor density, respectively. (<bold>D</bold>) Snapshots of simulations with commonly considered aggregation mechanisms, which produce unrealistic behavior for worm simulations, with flocking and highly aligned clustering. Arrows indicate the direction of movement of large clusters. (<bold>E</bold>) Phase portrait of model simulations, showing snapshots from the last 10% of each simulation, for different values of the two free parameters: density-dependence of the reversal rate and density-dependence of speed-switching (here <italic>k</italic><sub>slow</sub> = <italic>k</italic><sub>fast</sub>). Blue and orange panels highlight best fit for <italic>npr-</italic>1 and N2 data, respectively. (<bold>F</bold>) Summary statistics <italic>S<sub>1</sub></italic> (pair correlation, top) and <italic>S<sub>2</sub></italic> (hierarchical clustering, bottom) for the simulation which most closely matches the experimental data for the <italic>npr-1</italic> and N2 strains (blue and orange panels in (E), respectively).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig5-v2.tif"/></fig><p>The density-dependence of the reversal rate and speed switching is implemented as follows: The rate of reversals increases linearly with density with slope <italic>r’</italic>, which is a free parameter, and is thus given by <italic>r</italic><sub>rev</sub> = <italic>r’ ρ</italic>. The reversal rate at zero density is zero as we ignored spontaneous reversals outside of clusters as these were only rarely observed under our experimental conditions (see Appendix 1 for further discussion of the model construction). This parameterization of the reversal rate may be unbounded, but we can prevent unrealistically high reversal rates for a given maximum worm number by choosing our prior distribution of the parameter <italic>r’</italic>. The rate of slowing down is similarly approximated as a linear function of density, with free parameter <italic>k</italic><sub>s</sub>’, and is given by <italic>k</italic><sub>slow</sub> = <italic>k</italic><sub>s0</sub>+<italic>k</italic><sub>s</sub>’ <italic>ρ</italic>, where <italic>k</italic><sub>s0</sub> is the slowing rate at zero-density. The rate of speeding up is given by <italic>k</italic><sub>fast</sub> = <italic>k</italic><sub>f0</sub> exp[-<italic>k</italic><sub>f</sub>’ <italic>ρ</italic>], where the exponential decay is chosen to ensure positivity of the rate, and <italic>k</italic><sub>f0</sub> is the rate at zero density. The rates of slowing down and speeding up at zero density (<italic>k</italic><sub>s0</sub>, <italic>k</italic><sub>f0</sub>) were obtained from published single-worm experimental data (<xref ref-type="bibr" rid="bib30">Javer et al., 2018</xref>; <xref ref-type="bibr" rid="bib64">Yemini et al., 2013</xref>).</p><p>We initially ran a coarse parameter sweep, sampling uniformly in the two-dimensional parameter space associated with the density-dependence of reversals and speed switching. As a simplifying assumption, the density-dependence of the speeding-up and slowing-down rates was set equal (<italic>k’</italic><sub>s</sub> = <italic>k’</italic><sub>f</sub> = <italic>k’</italic>). The remaining parameters, <italic>r</italic>’ and <italic>k</italic>’, were varied to explore the global model behavior. This demonstrates that our model can capture different aggregation phenotypes from solitary movement to aggregation (<xref ref-type="fig" rid="fig5">Figure 5E</xref>) by varying just two free parameters, and provides important general insights. Inspection of the model simulations shows that each behavior alone (just reversals or slowing) does not give the same level of aggregation as when both parameters are modulated (<xref ref-type="fig" rid="fig5">Figure 5E</xref>), so that using both behavioral components proves important. Quantifying the aggregation and comparing it to the <italic>npr-1</italic> experiment, however, highlights incomplete quantitative agreement with both the pair correlation function and hierarchical clustering distribution (<xref ref-type="fig" rid="fig5">Figure 5F</xref>). Thus, we reasoned additional interactions may be required to match the experimentally observed behaviors.</p></sec><sec id="s2-7"><title>Adding a medium-range taxis interaction promotes stronger aggregation</title><p>To explore improvements in clustering, we extended the model by an attractive taxis interaction. Attraction should intuitively improve clustering, but we knew from our model exploration that an attractive potential between bodies produces undesirable cluster shapes (<xref ref-type="fig" rid="fig5">Figure 5D</xref>) and reasoned that a long-range interaction may be unrealistic (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Thus, we include taxis towards neighboring worms and model worm movement as an attractive persistent random walk. The taxis contribution to a worm’s motile force has an overall strength controlled by parameter <italic>f</italic><sub>t</sub>, with multiple nearby neighbors contributing cumulatively, weighted by 1/<italic>r</italic>, where <italic>r</italic> is the distance to a neighboring worm. Neighboring worms beyond a cut-off distance equal to the length of a worm have no contribution. Thus, this taxis interaction is acting at a natural intermediate length scale of our system (see Appendix 1 for details).</p><p>The resulting extended model has four free parameters: density-dependent reversals (<italic>r</italic>′), speed-switching rates (<italic>k</italic><sub>s</sub>′, <italic>k</italic><sub>f</sub>′) and taxis (<italic>f</italic><sub>t</sub>). To find the parameter combinations that best describe each strain, as well as the uncertainty in the parameter values, we used an approximate Bayesian inference approach (see Appendix 1). To increase the computational efficiency of our inference pipeline, we excluded infeasible regions of parameter space to reduce the prior distribution of parameters that we need to sample from (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>) (see Appendix 1). We then selected the closest matching simulations from about 27,000 simulations for <italic>npr-</italic>1 and about 13,000 simulations for N2, equally weighting all four summary statistics. Results from our extended model (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, <xref ref-type="video" rid="video5">Video 5</xref> and <xref ref-type="video" rid="video6">Video 6</xref>) show markedly improved quantitative agreement with the experiments (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). The approximated posterior distributions of the parameters (<xref ref-type="fig" rid="fig6">Figure 6C–D</xref>) show the most likely values of the parameters for each strain, as well as the uncertainty associated with the individual and joint marginal parameter distributions. In particular, to achieve <italic>npr-1</italic>-like aggregation, the reversal (<italic>r</italic>’) and taxis (<italic>f</italic><sub>t</sub>) parameters need to be higher than for N2, albeit not too high. The density-dependence of the slowing rate (<italic>k</italic>’<sub>s</sub>) is only subtly different between the two strains, while the dependence of the speeding up rate (<italic>k</italic>’<sub>f</sub>) is greater in <italic>npr-1</italic>, but with broader uncertainty.</p><fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.43318.016</object-id><label>Figure 6.</label><caption><title>Model with taxis captures quantitative aggregation phenotypes.</title><p>(<bold>A</bold>) Sample snapshot of the closest matching simulations for <italic>npr-1</italic> (top) and N2 (bottom). (<bold>B</bold>) Summary statistics for <italic>npr-1</italic> (orange) and N2 (blue): <italic>S<sub>1</sub></italic>: pair correlation function; <italic>S<sub>2</sub></italic>: hierarchical clustering distribution; <italic>S<sub>3</sub></italic>: standard deviation of positions; <italic>S<sub>4</sub></italic>: kurtosis of positions. Solid lines show the closest matching simulations; dashed lines show sample mean over the posterior distribution; and dotted lines show experimental means, with error bars showing standard deviation of 13 (<italic>npr-1</italic>) and 9 (N2) replicates. (<bold>C–D</bold>) Approximate posterior distribution of parameters for <italic>npr-1</italic> (C) and N2 (D). Diagonal plots show marginal distribution of each parameter, off-diagonals show pairwise joint distributions. Parameters are: increase in reversal rate with density, <italic>r</italic>'; increase in rate to slow down, <italic>k</italic>'<sub>s</sub>; decrease in rate to speed up, <italic>k</italic>'<sub>f</sub>; and contribution of taxis to motile force, <italic>f</italic><sub>t</sub>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.43318.017</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Reduced prior distribution used for approximate Bayesian inference of extended model.</title><p>Marginal and joint prior parameter distributions for <italic>npr-1</italic> (<bold>A</bold>) and N2 (<bold>B</bold>), that have been constructed from a set of pilot runs excluding any parameter combinations that lead to stable pairs for either strain, unstable clusters for <italic>npr-1</italic>, and stable clusters for N2. Remaining parameter values were used to construct the prior distributions via kernel-density estimation. See Appendix 1 for details.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.43318.018</object-id><label>Figure 6—figure supplement 2.</label><caption><title>Core model components, but not noise and undulations in movement, are necessary for quantitative agreement with aggregation summary statistics.</title><p>(<bold>A</bold>) Simulation for parameters equal to the mean of the posterior distribution for the <italic>npr-1</italic> strain (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). (<bold>A1</bold>), Sample snapshot of simulation; (<bold>A2</bold>), Pair correlation statistic, averaged over ten simulations (solid line), and standard error of the mean (error bars), with experimental reference (dotted line, as in <xref ref-type="fig" rid="fig6">Figure 6B</xref>); (<bold>A3</bold>), Hierarchical clustering distribution, averaged over ten simulations (solid line), and standard error of the mean (error bars), with experimental reference (dotted line, as in <xref ref-type="fig" rid="fig6">Figure 6B</xref>); (<bold>A4</bold>), Combined score for model agreement with experiment (lower score is better) for summary statistics in (A1) and (A2), calculated as the difference in the logarithm of the summary statistics between experiment and simulation (see Appendix 1 for details). (<bold>B</bold>) As in (A) but with <italic>r</italic>' = 0 (no reversals). (<bold>C</bold>) As in (A) but with worms always moving at the faster speed. (<bold>D</bold>) As in (A) but with <italic>f</italic><sub>t</sub> = 0 (no taxis towards other worms). (<bold>E</bold>) As in (A) but with <italic>η</italic> = 0 (no directional noise in movement). (<bold>F</bold>) As in (A) but with <italic>η</italic> = 0.005. This <italic>η</italic> represents directional noise 10 times lower than in (A). (<bold>G</bold>) As in (A) but with <italic>η</italic> = 0.08. This <italic>η</italic> represents higher noise than in (A), and roughly corresponds to the velocity autocorrelation measured for interacting worms in our experiments (<xref ref-type="fig" rid="fig6s4">Figure 6 – figure supplement 4A2-3</xref>). (<bold>H</bold>) As in (A) but with sinusoidal undulations in the direction of movement, with a frequency similar to that of <italic>npr-1</italic> worms (see Appendix 1 for details).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig6-figsupp2-v2.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.43318.019</object-id><label>Figure 6—figure supplement 3.</label><caption><title>Analysis of orientational and velocity correlations in experiments and simulations.</title><p>(<bold>A</bold>) Orientational correlation quantifies the alignment of the pharynxes (experiments, (A1), or first three nodes (simulations, A2-4) between pairs of worms a given distance apart. A value of 1 corresponds to parallel alignment, and −1 to anti-parallel alignment. Solid lines show the average directional correlation and shaded area shows the 95% confidence interval. (<bold>A1</bold>), Experimental measurements; (<bold>A2</bold>), Simulation for parameters equal to mean of posterior distribution for <italic>npr-1</italic> strain (<xref ref-type="fig" rid="fig6">Figure 6C</xref>); (<bold>A3</bold>), As in (A2) but with <italic>f</italic><sub>t</sub> = 0 (no taxis towards other worms); (<bold>A4</bold>), As in (A2) but with worms always moving at the faster speed. (<bold>B</bold>) Velocity correlation quantifies the alignment of movement directions between pairs of worms a given distance apart. A value of 1 corresponds to worms moving in the same direction, and −1 to worms moving in opposite directions. Solid lines show the average directional correlation and shaded area shows the 95% confidence interval. (<bold>B1</bold>), Experimental measurements; (<bold>B2</bold>), Simulation for parameters equal to the mean of the posterior distribution for the <italic>npr-1</italic> strain (<xref ref-type="fig" rid="fig6">Figure 6C</xref>); (<bold>B3</bold>), As in (B2) but with <italic>f</italic><sub>t</sub> = 0 (no taxis towards other worms). (<bold>C</bold>) Correlation between velocity of a worm and the direction to each neighbor was calculated to quantify the degree of taxis towards other worms. A value of 1 corresponds to worms moving directly towards a neighbor, and −1 to directly moving away from a neighbor. Solid lines show the average directional correlation and shaded area shows the 95% confidence interval. (<bold>C1</bold>), Experimental measurements; (<bold>C2</bold>), Simulation for parameters equal to the mean of the posterior distribution for <italic>npr-1</italic> strain (<xref ref-type="fig" rid="fig6">Figure 6C</xref>); (<bold>C3</bold>), As in (C2) but with <italic>r</italic>' = 0 (no reversals).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig6-figsupp3-v2.tif"/></fig><fig id="fig6s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.43318.020</object-id><label>Figure 6—figure supplement 4.</label><caption><title>Additional comparison of model parameters with experimental measurements.</title><p>(<bold>A</bold>) Velocity autocorrelation. (<bold>A1</bold>), From experiments with body wall muscle-tracked single worms on circular food patches; (<bold>A2</bold>), From experiments with 40 worms, of which a few were body wall muscle-tracked to allow acquisition of longer trajectories; (<bold>A3</bold>), From simulated, non-interacting worms undergoing a persistent random walk for different parameter values of <italic>η</italic>, the strength of the angular noise. The dashed line shows a value of 0.23, corresponding approximately to the expected correlation for choosing angles at random, uniformly distributed between −3/4π and 3/4π, thus representing an almost complete reorientation with respect to the original direction of motion. Note that this level is reached after about 15 s for <italic>η</italic> = 0.05 and for single worms (A1), and after about 8 s for <italic>η</italic> = 0.08 and interacting worms (A2). (<bold>B</bold>) Relative reversal rates at various local densities from experiments (solid lines and shaded 95% confidence interval, same data as in <xref ref-type="fig" rid="fig3">Figure 3B</xref>) and from model equations for reversal rates, parameterized with the mean of posterior distribution (dotted lines). (<bold>C</bold>) Speed switching rates at various local densities. (<bold>C1</bold>), Ratio of worms moving at fast (up to 350 μm/s) versus slow (&lt;100 μm/s for <italic>npr-1</italic>,&lt;50 μm/s for N2) speeds as measured in experiments; (<bold>C2</bold>), Ratio of worms moving at fast versus slow (&lt;100 μm/s for <italic>npr-1</italic>,&lt;50 μm/s for N2) speeds as measured in simulations with posterior mean parameters, showing average over ten (<italic>npr-1</italic>) and eight (N2) simulations, error bars showing error in the mean. The disagreement may indicate that the exponential form of <italic>k</italic><sub>f</sub>(ρ) (see <xref ref-type="fig" rid="fig5">Figure 5C</xref> and main text) is only a rough estimate. For (B) and (C<bold>C</bold>), inferred model parameters were converted to units of worms/mm<sup>2</sup>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig6-figsupp4-v2.tif"/></fig><fig id="fig6s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.43318.021</object-id><label>Figure 6—figure supplement 5.</label><caption><title>Aggregation model requires minimum length of simulated worms, and is robust to introducing volume exclusion.</title><p>(A) Simulations with decreasing length of agents. (<bold>A1</bold>), Snapshot of simulation with posterior mean parameter values for <italic>npr-1</italic>, as in <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2A</xref>. Worms have <italic>M</italic> = 18 nodes and a total length of <italic>L<sub>w</sub></italic> = 1.2 mm; (<bold>A2</bold>), Modified model with <italic>M</italic> = 9 nodes and shorter worms (but same width) still produces aggregation, without readjusting other parameters; (<bold>A3</bold>), As in (A2) but with <italic>M</italic> = 6 nodes per worm and shorter total length; (<bold>A4</bold>), As in (A2) but with <italic>M</italic> = 5 nodes per worm and shorter total length; (<bold>A5</bold>), at <italic>M</italic> = 4 nodes per worm and corresponding length of <italic>L<sub>w</sub></italic> = 0.3211 mm, stable aggregates comprising all worms fail to form. At this worm length, the interaction radii of head and tail nodes start to overlap, and worms require a difference in contact between head and tail to initiate reversals in our simulations. (<bold>B</bold>) Simulations with volume exclusion. (<bold>B1</bold>), Snapshot of simulation where volume exclusion is enforced, such that worms cannot overlap (apart from themselves), without adjusting any other parameters. The number of nodes per worm has been increased to <italic>M</italic> = 45 to ensure sufficient overlap between nodes within a worm. Pair correlation function (<bold>B2</bold>) and hierarchical clustering distribution (<bold>B3</bold>) show that aggregate is spread out and less dense compared to experiments (dotted line). Solid lines show mean over three simulations and error bars show standard deviation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig6-figsupp5-v2.tif"/></fig></fig-group><media id="video5" mime-subtype="mp4" mimetype="video" xlink:href="elife-43318-video5.mp4"><object-id pub-id-type="doi">10.7554/eLife.43318.022</object-id><label>Video 5.</label><caption><title>Sample model (with taxis) simulation describing <italic>npr-1</italic> mutants.</title><p>The video plays at 30x the normal speed.</p></caption></media><media id="video6" mime-subtype="mp4" mimetype="video" xlink:href="elife-43318-video6.mp4"><object-id pub-id-type="doi">10.7554/eLife.43318.023</object-id><label>Video 6.</label><caption><title>Sample model (with taxis) simulation describing N2.</title><p>The video plays at 30x the normal speed.</p></caption></media><p>To address whether all three behaviors (reversals, speed changes, and taxis) were necessary for aggregation we ran additional simulations: starting from the mean of the posterior distribution for <italic>npr-1</italic> (<xref ref-type="fig" rid="fig6">Figure 6C</xref>) as a reference, we removed individual model components by setting the corresponding parameters to zero. These perturbed simulations show that removing speed switching or taxis from the model disrupts aggregation, while removing reversals reduces the overall quantitative agreement with experimental data (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2, B–D</xref>). In some cases, removing individual model behaviors also produced correlations of velocity and orientation between neighbors that are different from what we measure in experiments (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>). Thus, we conclude that we have identified sufficient behavioral components for aggregation, and that these are also necessary to quantitatively match aggregation in <italic>npr-1</italic> mutants.</p><p>Searching for evidence of taxis in the experimental tracking data, we calculated the correlation between worm velocity and the vector towards nearby worms, and found this correlation to be nearly zero in both experiments and simulations for all distances up to 2 mm (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3B1–2</xref>), which is larger than the size of a typical worm cluster. This may not be intuitive, and we suspect the reason is twofold: (a) the taxis effect is only a small influence on the instantaneous direction of the movement of a worm, compared to persistence and noise; and (b) we only tracked the pharynx in our experiments, and reproduced this restriction in our analysis of simulations, but the whole body of the worm is likely giving relevant cues to any chemical or mechanical taxis. Our methodology that enables us to track inside worm clusters therefore brings with it the caveat that there is unseen worm density that affects any potential taxis behavior, but which remains undetectable in our tracking. Thus, our analysis shows that a taxis behavior similar to our simulations may be present in experiments, even if it is difficult to detect with correlation analysis. We compared the other inferred parameters with experimental measurements: The reversal rate shows a similar increase with density that is greater for <italic>npr-1</italic> than N2 (<xref ref-type="fig" rid="fig6s4">Figure 6—figure supplement 4B</xref>). The speed switching rates could only be compared indirectly by calculating the ratio of fraction of worms in fast vs. slow movement in experiments (<xref ref-type="fig" rid="fig6s4">Figure 6—figure supplement 4C1</xref>) and model simulations (<xref ref-type="fig" rid="fig6s4">Figure 6—figure supplement 4C2</xref>). The disagreement may indicate that the exponential form of <italic>k<sub>f</sub></italic>(<italic>ρ</italic>) is only a rough approximation. However, aggregation in the model is not sensitive to speed switching rates, as shown by the broad posterior distributions for the inferred parameters (<xref ref-type="fig" rid="fig6">Figure 6C–D</xref>).</p></sec><sec id="s2-8"><title>Extending the model with food-depletion captures dynamic swarming</title><p>Since we hypothesize that the swarming we observed at longer time scales may be explained as aggregation under food depletion conditions, we further extended the model to allow the local depletion of food. Food is initially distributed uniformly, and becomes depleted locally by worm feeding (see Appendix 1 for details). Absence of food suppresses the switch to slow speeds, thus causing worms to speed up when food is locally depleted. As a result, we hypothesize that worm clusters begin to disperse but reform on nearby food, leading to sweeping.</p><p>Selecting the parameter combination best matching the <italic>npr-</italic>1 strain (<xref ref-type="fig" rid="fig6">Figure 6</xref>) and an appropriate food depletion rate (chosen such that all food was depleted no faster than observed in experiments), the resulting simulation produced long-time dynamics qualitatively representative of the experimentally observed swarming (<xref ref-type="fig" rid="fig7">Figure 7A–B</xref>, <xref ref-type="video" rid="video7">Video 7</xref>). Worm clusters undergo a persistent but not necessarily directed random walk, can disperse and re-form elsewhere, and multiple clusters may co-exist, all of which we observe experimentally. Tracking the centroid of worms in our simulations, we find a comparable cluster speed as the median experimental value of 172 μm/min (<xref ref-type="fig" rid="fig1">Figure 1D</xref>) for a range of feeding rates (<xref ref-type="fig" rid="fig7">Figure 7C</xref>) (feeding rate is an unknown parameter as our model only accounts for relative food concentration). Thus, the model indicates that dynamic swarming of <italic>npr-1</italic> aggregates may be explained as an emergent phenomenon resulting from individual locomotion, and that the same behavioral mechanisms that produce the initial aggregates, when coupled with local food depletion, give rise to the observed swarming behavior.</p><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.43318.024</object-id><label>Figure 7.</label><caption><title>Simulations capture dynamic swarming.</title><p>(<bold>A</bold>) Snapshots of aggregation simulation with food depletion. Background color shows relative food concentration with white indicating high food and black indicating no food. (<bold>B</bold>) Visualization of worm positions in (A) over time, showing cluster displacement. Note the periodic boundary conditions. (<bold>C</bold>) Cluster speed at various feeding rates relative to lawn thickness (other parameters equal to mean of posterior distribution for <italic>npr-1</italic>). The upward trend is expected: smaller lawn thickness leads to faster movement as worms run out of food quicker and need to re-form clusters on nearby food. Cluster speed is calculated the same way as in <xref ref-type="fig" rid="fig1">Figure 1D</xref>; error bars show median absolute deviation over five simulations. Dashed line indicates experimentally-derived median cluster speed (from <xref ref-type="fig" rid="fig1">Figure 1D</xref>) for comparison.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-fig7-v2.tif"/></fig><media id="video7" mime-subtype="mp4" mimetype="video" xlink:href="elife-43318-video7.mp4"><object-id pub-id-type="doi">10.7554/eLife.43318.025</object-id><label>Video 7.</label><caption><title>Sample swarming simulation describing <italic>npr-1</italic> mutants.</title><p>Background color shows relative food concentration with white indicating high food and black indicating no food.The video plays at 30x the normal speed.</p></caption></media></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We have investigated the mechanisms of aggregation and swarming in <italic>C. elegans</italic> collective feeding using quantitative imaging and computational modeling. We show that while a combination of increased reversals upon leaving aggregates and a neighbor density-dependent increase in speed switching rates is sufficient to produce aggregation, the addition of taxis towards neighbors improves the quantitative agreement between simulations and experiments. Removing any one of the core behavioral mechanisms (reversals, speed changes, taxis) from our model either disrupts aggregation or otherwise reduces the quantitative agreement with experiments (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 2–3</xref>). The proposed taxis might be driven by a shallow O<sub>2</sub> or CO<sub>2</sub> gradient created by a worm cluster (discussed further below), to additional chemical signals unaffected by <italic>daf-22</italic> loss of function, or to another unknown mechanism. By extending the aggregation model to include food depletion, we show that the same behavioral mechanisms also underlie dynamic swarming in the hyper-social <italic>C. elegans</italic> strain, reminiscent of wild fires and other self-avoiding dynamics.</p><p>We focused on identifying phenomenological behavioral components giving rise to aggregation, while remaining agnostic as to the sensory cues causing the behaviors. The density-dependent interactions could arise from local molecular signaling, or be mediated through contact-sensing, and the 1/<italic>r</italic> dependence of the taxis interaction is compatible with a diffusible, non-degrading factor (such as CO<sub>2</sub>, or O<sub>2</sub> depletion; dependence would likely be different for a pheromone depending on its degradation rate). Given that aggregates break up when ambient O<sub>2</sub> concentration is reduced to 7% (<xref ref-type="bibr" rid="bib21">Gray et al., 2004</xref>), the preferred concentration of <italic>npr-1</italic> mutants, the most obvious candidate for the sensory cue guiding aggregation is O<sub>2</sub> (<xref ref-type="bibr" rid="bib44">Rogers et al., 2006</xref>). A simple hypothesis would be that oxygen consumption by worms locally lowers O<sub>2</sub> concentration to the 5–12% preferred by <italic>npr-1</italic> mutants, promoting their aggregation. To support this, <xref ref-type="bibr" rid="bib44">Rogers et al. (2006)</xref> report low O<sub>2</sub> concentrations inside worm clusters. However, non-aggregating N2 worms also prefer O<sub>2</sub> concentrations lower than atmospheric (5–15%) (<xref ref-type="bibr" rid="bib21">Gray et al., 2004</xref>). Furthermore, a strong reduction of oxygen concentration inside an aggregate to near 7% is unlikely based on reaction-diffusion calculations: the diffusion of oxygen through worm tissue, or their oxygen consumption, would need to be several orders of magnitude different from estimated values to create O<sub>2</sub> gradients as steep as reported by Rogers <italic>et al.</italic> (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>). However, as worms have been reported to respond even to small changes in oxygen concentration (<xref ref-type="bibr" rid="bib35">McGrath et al., 2009</xref>), aggregation may still be mediated through a shallower local oxygen gradient.</p><p>In this scenario, high ambient O<sub>2</sub> concentration serves as a permissive signal for aggregation and a shallow oxygen gradient induces worms to stay inside aggregates. Our agent-based simulations are entirely compatible with this picture. Further experiments would be required to test the hypothesis that oxygen is playing such a dual role. One possibility would be to introduce mutations leading to aerobic metabolism deficiencies into <italic>npr-1</italic> mutants. Such mutants would still be able to sense ambient oxygen, but are expected to produce an even weaker oxygen gradient in an aggregate. The resulting phenotype could then be compared quantitatively to model predictions, for example with reduced taxis and/or modified rates of density-dependent reversal and speed switching. Additionally, one may seek evidence for the ability of worms to sense a shallow oxygen gradient by repeating the gas-phase aerotaxis experiment described in <xref ref-type="bibr" rid="bib21">Gray et al. (2004)</xref>, but with a much smaller gradient (19–21%) in the light of our new calculations, to see if worms can sense and move towards environments where oxygen levels are only slightly below ambient concentrations. Further work quantifying the behavior of individual worms at different oxygen concentrations, such as during oxygen-shift experiments inside flow chambers where single animals experience acute switches between 21% and 19% oxygen, may also help to distinguish oxygen as a direct cue or part of the ‘sensory triggers that can initiate social behavior by activating chemotaxis or mechanotaxis’ (<xref ref-type="bibr" rid="bib21">Gray et al., 2004</xref>).</p><p>The model of worm movement and interactions presented here was chosen for a balance of simplicity and realism, and is not necessarily unique. Our model comprises a persistent random walk of chain-like worms, which were loosely inspired by work on bacterial systems (<xref ref-type="bibr" rid="bib3">Balagam and Igoshin, 2015</xref>). We have adopted Bayesian parameter inference to capture the uncertainty in our parameter estimates, and to enable flexible extension to additional experimental data or comparison of different models in future work. An alternative approach is to be entirely data-driven in the construction of the model and compute interactions between worms directly based on their tracked positions at every time step, as has been done in collective behavior of <italic>Myxococcus xanthus</italic> (<xref ref-type="bibr" rid="bib15">Cotter et al., 2017</xref>; <xref ref-type="bibr" rid="bib65">Zhang et al., 2018</xref>). This approach may require higher worm numbers and improved tracking, to ensure comparably large statistical sample sizes with bacterial studies. We have used experimental data to inform our modeling framework where appropriate (size, shape, speed of agents, and reversal and speed change rates at zero density), and verified that the aggregation outcome is robust and quantitatively similar to experimental results regardless of the amount of noise in the persistent random walk (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2E–G</xref>), or the presence of undulations in agent movement (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2H</xref>). We have further verified that aggregation still occurs with shorter simulated worms (and fewer nodes per worm), given they are long enough to detect a contact difference between head and tail when exiting a cluster, which is required to initiate reversals (<xref ref-type="fig" rid="fig6s5">Figure 6—figure supplement 5A</xref>). Lastly, in the model presented here, we have allowed for overlap between worms to reflect a degree of overlap in clusters when worms can crawl over each other. With volume exclusion our model still produces aggregation, although the clusters are less dense and more extended (<xref ref-type="fig" rid="fig6s5">Figure 6—figure supplement 5B</xref>).</p><p>One advantage of using <italic>C. elegans</italic> to study animal collective behavior is the opportunity to experimentally control and perturb the system. It should be possible to experimentally modify the key behavioral parameters identified in this paper with mutations or acute stimulus delivery in order to test our model. For example, one can introduce a reversal phenotype with <italic>unc-4</italic> mutations, or alter the speed switching rates with mutations that affect the roaming-dwelling transition. Controlled stimulus delivery has already been used in previous oxygen-shift experiments. The resultant experimental outcomes may then be compared to theoretical predictions. Thus, there are ample opportunities for future studies to further integrate experimental and theoretical methods in the study of <italic>C. elegans</italic> collective behavior.</p><p>Despite its extensive study in the lab, it is still uncertain whether aggregation and swarming have a function in the wild. Aggregation may serve to protect <italic>C. elegans</italic> from desiccation or UV radiation associated with the surface environment (<xref ref-type="bibr" rid="bib12">Busch and Olofsson, 2012</xref>). <italic>C. elegans</italic> swarming on unpalatable bacteria may also facilitate predation, perhaps through the collective action of secreted molecules that overcome bacterial defenses (personal communication from J. Hodgkin and G.M. Preston) in a manner similar to the well-described cooperative predation strategy used by <italic>Myxobacteria xanthus</italic> (<xref ref-type="bibr" rid="bib37">Muñoz-Dorado et al., 2016</xref>; <xref ref-type="bibr" rid="bib39">Pérez et al., 2016</xref>). Moreover, social versus solitary foraging strategies may confer selective advantages in different food abundance, food quality, and population density environments (<xref ref-type="bibr" rid="bib18">de Bono and Bargmann, 1998</xref>). The observation that aggregating strains are less fit in laboratory conditions (<xref ref-type="bibr" rid="bib2">Andersen et al., 2014</xref>) suggested that social feeding is not an efficient strategy at least in abundant food conditions. However, the observed fitness difference between aggregating and non-aggregating strains is actually dissociable from the feeding strategy in the lab (<xref ref-type="bibr" rid="bib66">Zhao et al., 2018</xref>), leaving the question unresolved. Furthermore, in other systems, social feeding can increase fitness in natural environments via improved food detection and intake (<xref ref-type="bibr" rid="bib16">Cvikel et al., 2015</xref>; <xref ref-type="bibr" rid="bib33">Li et al., 2014</xref>; <xref ref-type="bibr" rid="bib50">Snijders et al., 2018</xref>). It would be time consuming to experimentally measure the feeding efficiency of different behavioral strategies for a wide range of food patch sizes, distributions, and qualities. The agent-based model used in this study presents an opportunity to use a complementary approach to finding conditions that may favor social feeding.</p><p><italic>C. elegans</italic> bridges the gap between the commonly studied micro- and macro-scales, and finding the behavioral rules underlying this mesoscale system allows us to consider principles governing collective behavior across scales. Indeed, key behavioral rules identified here for <italic>C. elegans</italic> aggregation have been observed at other scales. Spontaneous reversals have been implicated in bacterial aggregation at the microscale (<xref ref-type="bibr" rid="bib36">Mercier and Mignot, 2016</xref>; <xref ref-type="bibr" rid="bib53">Starruß et al., 2012</xref>; <xref ref-type="bibr" rid="bib56">Thutupalli et al., 2015</xref>). By contrast, aggregating worms reverse mainly in response to leaving a cluster rather than spontaneously, thus requiring more complex sensory processing and behavioral response than seen in bacterial systems. Furthermore, changes in movement speed are a common feature in motility-induced phase transitions (<xref ref-type="bibr" rid="bib22">Großmann et al., 2016</xref>; <xref ref-type="bibr" rid="bib42">Redner et al., 2013b</xref>; <xref ref-type="bibr" rid="bib1">Abaurrea Velasco et al., 2018</xref>). The emergent phenomena observed in models of interacting particles generally range from diffusion-limited aggregation to jamming at high volume fractions to flocking of self-propelled rods through volume exclusion (in two-dimensions). In contrast, aggregation in <italic>C. elegans</italic> occurs at much lower numbers of objects (tens of worms) and lower densities (area fraction of 4–6%) than typically studied in this field (thousands of objects at area fractions of 20–80%), and the density dependence of motility changes again emphasizes the role of more complex sensing and behavioral modulations common in macroscale animal groups such as fish shoals (<xref ref-type="bibr" rid="bib60">Ward et al., 2011</xref>). Thus, collective behavior of <italic>C. elegans</italic> at the mesoscale indeed draws from both ends of the size scale and complexity spectrum, linking the physical mechanisms familiar from microscopic cellular and active matter systems with the behavioral repertoire of larger multicellular organisms.</p><p>Our approach of decomposing aggregation into component behaviors through modeling may also have applications in quantitative genetics beyond the scope of our current study. While hyper-social <italic>npr-1</italic> mutants and hypo-social N2 worms show phenotypic extremes, wild isolates of <italic>C. elegans</italic> aggregate to different degrees (<xref ref-type="bibr" rid="bib18">de Bono and Bargmann, 1998</xref>). Previous work has shown that even a very small increase in the phenotypic dimensionality (from one to two) can reveal independent behavior-modifying loci (<xref ref-type="bibr" rid="bib6">Bendesky et al., 2012</xref>). Thus inferring model parameters for data from multiple wild <italic>C. elegans</italic> strains would produce behavioral parameterizations that might serve as a powerful set of traits for finding further behavior-modifying loci.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th valign="top">Resource</th><th valign="top">Designation</th><th valign="top">Source or reference</th><th valign="top">Identifiers</th><th valign="top">Additional <break/>information</th></tr></thead><tbody><tr><td valign="top">Strain <break/>(<italic>C. elegans</italic>)</td><td valign="top">N2</td><td valign="top"><italic>Caenorhabditis</italic> <break/>Genetics Centre</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/WB-STRAIN:N2">WB-STRAIN:N2</ext-link></td><td valign="top">Laboratory <break/>reference strain.</td></tr><tr><td valign="top">Strain <break/>(<italic>C. elegans</italic>)</td><td valign="top">DA609</td><td valign="top"><italic>Caenorhabditis</italic> <break/>Genetics Centre</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/WB-STRAIN:DA609">WB-STRAIN:DA609</ext-link></td><td valign="top">Genotype: <italic>npr-1(ad609)X.</italic></td></tr><tr><td valign="top">Strain <break/>(<italic>C. elegans</italic>)</td><td valign="top">OMG2</td><td valign="top">this paper</td><td valign="top"/><td valign="top">Genotype: <italic>mIs12[myo-2p::GFP]II;</italic> <break/> <italic>npr-1(ad609)X.</italic> Originated from <break/>CB5584 and DA609.</td></tr><tr><td valign="top">Strain <break/>(<italic>C. elegans</italic>)</td><td valign="top">OMG10</td><td valign="top">this paper</td><td valign="top"/><td valign="top">Genotype: <italic>mIs12[myo-2p::GFP]II</italic>. <break/>Originated from CB5584; <break/>outcrossed 6x to CGC N2.</td></tr><tr><td valign="top">Strain <break/>(<italic>C. elegans</italic>)</td><td valign="top">OMG19</td><td valign="top">this paper</td><td valign="top"/><td valign="top">Genotype: <italic>rmIs349[myo3p::RFP];</italic> <break/><italic>npr-1(ad609)X</italic>. Originated from <break/>AM1065 and DA609.</td></tr><tr><td valign="top">Strain <break/>(<italic>C. elegans</italic>)</td><td valign="top">OMG24</td><td valign="top">this paper</td><td valign="top"/><td valign="top">Genotype: <italic>rmIs349[myo3p::RFP]</italic>. <break/>Originated from AM1065; <break/>outcrossed 6x to CGC N2.</td></tr><tr><td valign="top">Strain <break/>(<italic>C. elegans</italic>)</td><td valign="top">DR476</td><td valign="top"><italic>Caenorhabditis</italic> <break/>Genetics Centre</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/WB-STRAIN:DR476">WB-STRAIN:DR476</ext-link></td><td valign="top">Genotype: <italic>daf-22(m130)II.</italic></td></tr><tr><td valign="top">Strain <break/>(<italic>C. elegans</italic>)</td><td valign="top">AX994</td><td valign="top">Mario de Bono <break/>(MRC Laboratory of <break/>Molecular Biology)</td><td valign="top"/><td valign="top">Genotype: <italic>daf-22(m130)II;</italic> <break/><italic>npr-1(ad609)X</italic>.</td></tr><tr><td valign="top">Software</td><td valign="top">Tierpsy Tracker (v 1.3)</td><td valign="top"><xref ref-type="bibr" rid="bib30">Javer et al., 2018</xref></td><td valign="top"/><td valign="top">Software available at ver228. <break/>github.io/tierpsy-tracker.</td></tr><tr><td valign="top">Software</td><td valign="top">wormTrackingAnalysis</td><td valign="top">this paper</td><td valign="top"/><td valign="top">Software available <break/>at <break/><ext-link ext-link-type="uri" xlink:href="http://github.com/ljschumacher/wormTrackingAnalysis">github.com/ljschumacher/wormTrackingAnalysis</ext-link>.</td></tr><tr><td valign="top">Software</td><td valign="top">sworm-model</td><td valign="top">this paper</td><td valign="top"/><td valign="top">Software available at <break/><ext-link ext-link-type="uri" xlink:href="https://github.com/ljschumacher/sworm-model">github.com/ljschumacher/sworm-model</ext-link>.</td></tr></tbody></table></table-wrap><sec id="s4-1"><title>Animal maintenance and synchronization</title><p><italic>C. elegans</italic> strains used in this study are listed in Key Resources Table above. All animals were grown on <italic>E. coli</italic> OP50 at 20°C as mixed-stage cultures and maintained as described (<xref ref-type="bibr" rid="bib8">Brenner, 1974</xref>). All animals used in imaging experiments were synchronized young adults obtained by bleaching gravid hermaphrodites grown on <italic>E. coli</italic> OP50 under uncrowded and unstarved conditions, allowing isolated eggs to hatch and enter L1 diapause on unseeded plates overnight, and re-feeding starved L1’s for 65–72 hr on OP50.</p></sec><sec id="s4-2"><title>Bright field high-number swarming imaging</title><p>The strain used here (<xref ref-type="fig" rid="fig1">Figure 1A</xref> and <xref ref-type="video" rid="video1">Video 1</xref>) is DA609. On imaging day, synchronized adults were collected and washed in M9 buffer twice before several hundred animals were transferred to a seeded 90 mm NGM plate using a glass pipette. After M9 is absorbed into the media, ten-hour time-lapse recordings were taken with a Dino-Lite camera (AM-7013MT) at room temperature (20°C) using the DinoCapture 2.0 software (v1.5.3.c) for maximal field of view. Two independent replicates were performed.</p></sec><sec id="s4-3"><title>Bright field standard swarming imaging</title><p>Step-by-step protocol is available at dx.doi.org/10.17504/protocols.io.vybe7sn. All recordings from this dataset are listed in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>.</p><p>The strains used here (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) are DA609 and N2. Prior to collecting the full dataset, a single batch of OP50 was grown overnight, diluted to OD<sub>600</sub> = 0.75, aliquoted for use on each imaging day, and stored at 4°C until use. Imaging plates were 35 mm Petri dishes containing 3.5 mL low peptone (0.013% Difco Bacto) NGM agar (2% Bio/Agar, BioGene) to limit bacteria growth. A separate batch of plates was poured exactly seven days before each imaging day, stored at 4°C, and dried at 37°C overnight with the agar side down before imaging. The center of an imaging plate was seeded with a single 20 μL spot of cold diluted OP50 one to three hours before imaging. The overnight plate drying step allowed the bacteria to quickly dry atop the media in order to achieve a more uniform lawn by minimizing the ‘coffee ring’ effect that would thicken the circular edge of the bacterial lawn. For each imaging day, synchronized young adults were collected and washed in M9 buffer twice before 40 animals were transferred to a seeded imaging plate using a glass pipette.</p><p>Imaging commenced immediately following animal transfer in a liquid drop, on a custom-built six-camera rig equipped with Dalsa Genie cameras (G2-GM10-T2041). Seven-hour recordings with red illumination (630 nm LED illumination, CCS Inc) were taken at 25 Hz using Gecko software (v2.0.3.1), whilst the rig maintained the imaging plates at 20°C throughout the recording durations. Images were segmented in real time by the Gecko software. The recordings were manually truncated post-acquisition to retain aggregation and swarming dynamics only. The start time was defined as the moment when the liquid dried and the all the worms crawled out from the initial location of the drop, and the end time was when the food was depleted and worms dispersed with increased crawling speed. Twelve independent replicates were performed for each strain.</p></sec><sec id="s4-4"><title>Bright field big patch swarming imaging</title><p>Step-by-step protocol is available at dx.doi.org/10.17504/protocols.io.vyhe7t6. All recordings from this dataset are listed in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>.</p><p>The experiments here (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>) are identical to those in the bright field standard swarming imaging, except for two differences. First, the imaging plates were seeded with a 75 μL spot of diluted OP50 (OD<sub>600</sub> = 0.38) and allowed to inoculate overnight at room temperature before being used for imaging the next day. Second, recordings were taken over 20 hr instead of seven. Eight independent replicates were performed for each strain.</p></sec><sec id="s4-5"><title>Bright field pheromone imaging</title><p>Step-by-step protocol is available at dx.doi.org/10.17504/protocols.io.vyie7ue. All recordings from this dataset are listed in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>.</p><p>The strains used here (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>) are DA609, N2, DR476, and AX994. Bacteria aliquots and imaging plates were prepared as in the bright field standard swarming imaging assay. For each imaging day, synchronized young adults were collected and washed in M9 buffer twice before 40 animals were transferred to a seeded imaging plate using a glass pipette. After M9 was absorbed into the media following worm transfer in liquid, imaging plates containing the animals were subjected to a gentle vibration at 600 rpm for 10 s on a Vortex Genie two shaker (Scientific Industries) to disperse animals and synchronize aggregation start across replicates. Imaging commenced 20 s after the vibration finish, using the same rig set-up as swarming imaging above, except one-hour recordings were taken. Images were segmented in real time by the Gecko software. At least eight independent replicates were performed for each strain. Automated animal tracking was performed post-acquisition using Tierpsy Tracker software (<ext-link ext-link-type="uri" xlink:href="http://ver228.github.io/tierpsy-tracker/">http://ver228.github.io/tierpsy-tracker/</ext-link>, v1.3), which we developed in-house (<xref ref-type="bibr" rid="bib30">Javer et al., 2018</xref>). Images with were tracked with customized parameters to create centroid trajectories, 49-point worm skeletons, and a battery of features.</p></sec><sec id="s4-6"><title>Fluorescence aggregation imaging</title><p>Step-by-step protocol is available at dx.doi.org/10.17504/protocols.io.vzje74n. All recordings from this dataset are listed in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>.</p><p>The strains used here (<xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="video" rid="video2">Videos 2</xref>–<xref ref-type="video" rid="video4">4</xref>) are OMG2, OMG10, OMG19, and OMG24. One-color imaging consisted of pharynx-GFP labeled worms only, whereas two-color imaging also included a small number of body wall muscle-RFP labeled worms that were recorded simultaneously on a separate channel (thus readily segmented from the rest of the worms). The latter was necessary to follow individuals over a long period of time, particularly while inside a cluster, as frequent pharynx collisions inside clusters lead to lost individual identities and broken trajectories. For two-color imaging, animals with different fluorescent markers were mixed in desired proportion (1–3 red animals out of 40 per experiment) during the washing stage before being transferred together for imaging.</p><p>The data collection paradigm was identical to the bright field pheromone imaging assay in terms of bacteria aliquots, imaging plate preparation, and vibration implementation following animal transfer. The difference is that image acquisition was performed on a DMI6000 inverted microscope (Leica) equipped with a 1.25x PL Fluotar objective (Leica), a TwinCam LS image splitter (Cairn) with a dichroic cube (Cairn), and two Zyla 5.5 cameras (Andor) to enable simultaneous green-red imaging with maximal field of view. One-hour recordings were taken with constant blue (470 nm, 0.8A) and green (cool white, 1.4A) OptoLED illumination (Cairn), and images were acquired with 100 ms exposure at 9 Hz using Andor Solis software (v4.29.30005.0). The microscopy room was maintained at 21°C throughout the recording durations. Ten or more independent replicates were performed for each strain. We were able to reproduce stereotyped aggregation dynamics across replicates under our experimental paradigm (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). Image segmentation and automated animal tracking was performed post-acquisition using Tierpsy Tracker software (v1.3) with customized parameters, to create centroid trajectories, obtain two-point skeleton from pharynx-labeled individuals and 49-point midline skeletons from body wall muscle-marked ones, and extract various features. For body wall muscle-marked animals, trajectories were manually joined where broken due to tracking errors.</p></sec><sec id="s4-7"><title>Fluorescence aggregation tracking data analysis</title><p>The code for tracking data analysis is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ljschumacher/wormTrackingAnalysis">https://github.com/ljschumacher/wormTrackingAnalysis</ext-link> (<xref ref-type="bibr" rid="bib47">Schumacher et al., 2019</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/wormTrackingAnalysis">https://github.com/elifesciences-publications/wormTrackingAnalysis</ext-link>).</p><p>Tracked blobs were filtered for minimum fluorescence intensity and maximum area, to exclude any larvae and tracking artifacts, respectively, which appeared on the occasional plate. Local worm densities around each individual were calculated using <italic>k</italic>-nearest neighbor density estimation, where the density is <italic>k</italic> divided by the area of a circle encompassing the <italic>k</italic>-th nearest neighbor. We chose <inline-formula><mml:math id="inf1"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn><mml:mo>≈</mml:mo> <mml:mi/><mml:mo>√</mml:mo><mml:mi>N</mml:mi></mml:math></inline-formula> and verified based on visual assessment that the overall distribution of local densities changes very little with increasing <italic>k</italic>.</p><p>Reversals were detected based on a change of sign of speed from positive to negative, which was calculated from the dot-product of the skeleton vector (of the pharynx) and the velocity vector, and smoothed with a moving average over half a second. We only counted reversals that were at least 50 µm in length, and that moved at least half a pixel per frame before and after the reversal. Reversal events thus detected where binned by their local density. For each density bin, reversal rate was estimated as the number of events divided by the time spent in forward motion for that bin. The variability was estimated using a subsampling bootstrap: the reversal rate was estimated 100 times, sampling worm-frames with replacement, and estimating mean and standard deviation.</p><p>Speed profiles were generated by binning the measured speed values for local density, and then creating a histogram of speed values for each density bin.</p><p>Summary statistics of aggregation, such as pair-correlation and hierarchical clustering, where calculated as described in Appendix 1.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Camille Straboni for her contributions in the early stages of this project, Mario de Bono for his gift of strain AX994, Richard Morimoto for his gift of strain AM1065, Chad Whilding and Dirk Dormann for help with setting up the imaging system, Ivan Croydon Veleslavov for contributing to the code for parameter inference, Jochen Kursawe for helpful discussions, and Suhail Islam for computational support. Some strains were provided by the CGC, which is funded by NIH Office of Research Infrastructure Programs (P40 OD010440). This work has made use of the resources provided by the Imperial College Research Computing Service (DOI: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.14469/hpc/2232">10.14469/hpc/2232</ext-link>) and the Edinburgh Compute and Data Facility (ECDF) (<ext-link ext-link-type="uri" xlink:href="http://www.ecdf.ed.ac.uk/">http://www.ecdf.ed.ac.uk/</ext-link>).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Data curation, Software</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Resources, Formal analysis, Supervision, Funding acquisition, Investigation, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Resources, Software, Supervision, Funding acquisition, Investigation, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><object-id pub-id-type="doi">10.7554/eLife.43318.026</object-id><label>Supplementary file 1.</label><caption><title>Model parameters.</title></caption><media mime-subtype="x-tex" mimetype="application" xlink:href="elife-43318-supp1-v2.tex"/></supplementary-material><supplementary-material id="supp2"><object-id pub-id-type="doi">10.7554/eLife.43318.027</object-id><label>Supplementary file 2.</label><caption><title>Imaging datasets used in this study.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-43318-supp2-v2.csv"/></supplementary-material><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.43318.028</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-43318-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated and analysed during this study is deposited on the Open Worm Movement Database community page (<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/communities/open-worm-movement-database/">https://zenodo.org/communities/open-worm-movement-database/</ext-link>). Each recording has a separate DOI, which can be found in Supplementary file 2. The code for model simulations is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ljschumacher/sworm-model">https://github.com/ljschumacher/sworm-model</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/sworm-model">https://github.com/elifesciences-publications/sworm-model</ext-link>).</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abaurrea Velasco</surname> <given-names>C</given-names></name><name><surname>Abkenar</surname> <given-names>M</given-names></name><name><surname>Gompper</surname> <given-names>G</given-names></name><name><surname>Auth</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Collective behavior of self-propelled rods with quorum sensing</article-title><source>Physical Review E</source><volume>98</volume><elocation-id>022605</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.98.022605</pub-id><pub-id pub-id-type="pmid">30253508</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andersen</surname> <given-names>EC</given-names></name><name><surname>Bloom</surname> <given-names>JS</given-names></name><name><surname>Gerke</surname> <given-names>JP</given-names></name><name><surname>Kruglyak</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A variant in the neuropeptide receptor npr-1 is a major determinant of caenorhabditis elegans growth and physiology</article-title><source>PLOS Genetics</source><volume>10</volume><elocation-id>e1004156</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1004156</pub-id><pub-id pub-id-type="pmid">24586193</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balagam</surname> <given-names>R</given-names></name><name><surname>Igoshin</surname> <given-names>OA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Mechanism for collective cell alignment in myxococcus xanthus bacteria</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004474</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004474</pub-id><pub-id pub-id-type="pmid">26308508</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barnes</surname> <given-names>CP</given-names></name><name><surname>Filippi</surname> <given-names>S</given-names></name><name><surname>Stumpf</surname> <given-names>MPH</given-names></name><name><surname>Thorne</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Considerate approaches to constructing summary statistics for ABC model selection</article-title><source>Statistics and Computing</source><volume>22</volume><fpage>1181</fpage><lpage>1197</lpage><pub-id pub-id-type="doi">10.1007/s11222-012-9335-7</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beaumont</surname> <given-names>MA</given-names></name><name><surname>Zhang</surname> <given-names>W</given-names></name><name><surname>Balding</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Approximate bayesian computation in population genetics</article-title><source>Genetics</source><volume>162</volume><fpage>2025</fpage><lpage>2035</lpage><pub-id pub-id-type="pmid">12524368</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bendesky</surname> <given-names>A</given-names></name><name><surname>Pitts</surname> <given-names>J</given-names></name><name><surname>Rockman</surname> <given-names>MV</given-names></name><name><surname>Chen</surname> <given-names>WC</given-names></name><name><surname>Tan</surname> <given-names>MW</given-names></name><name><surname>Kruglyak</surname> <given-names>L</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Long-range regulatory polymorphisms affecting a GABA receptor constitute a quantitative trait locus (QTL) for social behavior in Caenorhabditis Elegans</article-title><source>PLOS Genetics</source><volume>8</volume><elocation-id>e1003157</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003157</pub-id><pub-id pub-id-type="pmid">23284308</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>Cavagna</surname> <given-names>A</given-names></name><name><surname>Giardina</surname> <given-names>I</given-names></name><name><surname>Mora</surname> <given-names>T</given-names></name><name><surname>Silvestri</surname> <given-names>E</given-names></name><name><surname>Viale</surname> <given-names>M</given-names></name><name><surname>Walczak</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Statistical mechanics for natural flocks of birds</article-title><source>PNAS</source><volume>109</volume><fpage>4786</fpage><lpage>4791</lpage><pub-id pub-id-type="doi">10.1073/pnas.1118633109</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brenner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>The genetics of Caenorhabditis elegans</article-title><source>Genetics</source><volume>77</volume><fpage>71</fpage><lpage>94</lpage><pub-id pub-id-type="pmid">4366476</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bretscher</surname> <given-names>AJ</given-names></name><name><surname>Busch</surname> <given-names>KE</given-names></name><name><surname>de Bono</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A carbon dioxide avoidance behavior is integrated with responses to ambient oxygen and food in Caenorhabditis elegans</article-title><source>PNAS</source><volume>105</volume><fpage>8044</fpage><lpage>8049</lpage><pub-id pub-id-type="doi">10.1073/pnas.0707607105</pub-id><pub-id pub-id-type="pmid">18524954</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname> <given-names>AE</given-names></name><name><surname>Yemini</surname> <given-names>EI</given-names></name><name><surname>Grundy</surname> <given-names>LJ</given-names></name><name><surname>Jucikas</surname> <given-names>T</given-names></name><name><surname>Schafer</surname> <given-names>WR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A dictionary of behavioral motifs reveals clusters of genes affecting Caenorhabditis elegans locomotion</article-title><source>PNAS</source><volume>110</volume><fpage>791</fpage><lpage>796</lpage><pub-id pub-id-type="doi">10.1073/pnas.1211447110</pub-id><pub-id pub-id-type="pmid">23267063</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Busch</surname> <given-names>KE</given-names></name><name><surname>Laurent</surname> <given-names>P</given-names></name><name><surname>Soltesz</surname> <given-names>Z</given-names></name><name><surname>Murphy</surname> <given-names>RJ</given-names></name><name><surname>Faivre</surname> <given-names>O</given-names></name><name><surname>Hedwig</surname> <given-names>B</given-names></name><name><surname>Thomas</surname> <given-names>M</given-names></name><name><surname>Smith</surname> <given-names>HL</given-names></name><name><surname>de Bono</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Tonic signaling from O₂ sensors sets neural circuit activity and behavioral state</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>581</fpage><lpage>591</lpage><pub-id pub-id-type="doi">10.1038/nn.3061</pub-id><pub-id pub-id-type="pmid">22388961</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Busch</surname> <given-names>KE</given-names></name><name><surname>Olofsson</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Should I stay or should I go?</article-title><source>Worm</source><volume>1</volume><fpage>182</fpage><lpage>186</lpage><pub-id pub-id-type="doi">10.4161/worm.20464</pub-id><pub-id pub-id-type="pmid">24058845</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname> <given-names>AJ</given-names></name><name><surname>Chronis</surname> <given-names>N</given-names></name><name><surname>Karow</surname> <given-names>DS</given-names></name><name><surname>Marletta</surname> <given-names>MA</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A distributed chemosensory circuit for oxygen preference in C. elegans</article-title><source>PLOS Biology</source><volume>4</volume><elocation-id>e274</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0040274</pub-id><pub-id pub-id-type="pmid">16903785</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheung</surname> <given-names>BH</given-names></name><name><surname>Cohen</surname> <given-names>M</given-names></name><name><surname>Rogers</surname> <given-names>C</given-names></name><name><surname>Albayram</surname> <given-names>O</given-names></name><name><surname>de Bono</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Experience-dependent modulation of C. elegans behavior by ambient oxygen</article-title><source>Current Biology</source><volume>15</volume><fpage>905</fpage><lpage>917</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2005.04.017</pub-id><pub-id pub-id-type="pmid">15916947</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cotter</surname> <given-names>CR</given-names></name><name><surname>Schüttler</surname> <given-names>HB</given-names></name><name><surname>Igoshin</surname> <given-names>OA</given-names></name><name><surname>Shimkets</surname> <given-names>LJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Data-driven modeling reveals cell behaviors controlling self-organization during <italic>Myxococcus xanthus</italic> development</article-title><source>PNAS</source><volume>114</volume><fpage>E4592</fpage><lpage>E4601</lpage><pub-id pub-id-type="doi">10.1073/pnas.1620981114</pub-id><pub-id pub-id-type="pmid">28533367</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cvikel</surname> <given-names>N</given-names></name><name><surname>Egert Berg</surname> <given-names>K</given-names></name><name><surname>Levin</surname> <given-names>E</given-names></name><name><surname>Hurme</surname> <given-names>E</given-names></name><name><surname>Borissov</surname> <given-names>I</given-names></name><name><surname>Boonman</surname> <given-names>A</given-names></name><name><surname>Amichai</surname> <given-names>E</given-names></name><name><surname>Yovel</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Bats aggregate to improve prey search but might be impaired when their density becomes too high</article-title><source>Current Biology</source><volume>25</volume><fpage>206</fpage><lpage>211</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2014.11.010</pub-id><pub-id pub-id-type="pmid">25578909</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Bono</surname> <given-names>M</given-names></name><name><surname>Tobin</surname> <given-names>DM</given-names></name><name><surname>Davis</surname> <given-names>MW</given-names></name><name><surname>Avery</surname> <given-names>L</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Social feeding in Caenorhabditis elegans is induced by neurons that detect aversive stimuli</article-title><source>Nature</source><volume>419</volume><fpage>899</fpage><lpage>903</lpage><pub-id pub-id-type="doi">10.1038/nature01169</pub-id><pub-id pub-id-type="pmid">12410303</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Bono</surname> <given-names>M</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Natural variation in a neuropeptide Y receptor homolog modifies social behavior and food response in C. elegans</article-title><source>Cell</source><volume>94</volume><fpage>679</fpage><lpage>689</lpage><pub-id pub-id-type="doi">10.1016/S0092-8674(00)81609-8</pub-id><pub-id pub-id-type="pmid">9741632</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Palo</surname> <given-names>G</given-names></name><name><surname>Yi</surname> <given-names>D</given-names></name><name><surname>Endres</surname> <given-names>RG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A critical-like collective state leads to long-range cell communication in Dictyostelium discoideum aggregation</article-title><source>PLOS Biology</source><volume>15</volume><elocation-id>e1002602</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002602</pub-id><pub-id pub-id-type="pmid">28422986</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gart</surname> <given-names>S</given-names></name><name><surname>Vella</surname> <given-names>D</given-names></name><name><surname>Jung</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The collective motion of nematodes in a thin liquid layer</article-title><source>Soft Matter</source><volume>7</volume><elocation-id>2444</elocation-id><pub-id pub-id-type="doi">10.1039/c0sm01236j</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gray</surname> <given-names>JM</given-names></name><name><surname>Karow</surname> <given-names>DS</given-names></name><name><surname>Lu</surname> <given-names>H</given-names></name><name><surname>Chang</surname> <given-names>AJ</given-names></name><name><surname>Chang</surname> <given-names>JS</given-names></name><name><surname>Ellis</surname> <given-names>RE</given-names></name><name><surname>Marletta</surname> <given-names>MA</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Oxygen sensation and social feeding mediated by a C. elegans guanylate cyclase homologue</article-title><source>Nature</source><volume>430</volume><fpage>317</fpage><lpage>322</lpage><pub-id pub-id-type="doi">10.1038/nature02714</pub-id><pub-id pub-id-type="pmid">15220933</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Großmann</surname> <given-names>R</given-names></name><name><surname>Peruani</surname> <given-names>F</given-names></name><name><surname>Bär</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Mesoscale pattern formation of self-propelled rods with velocity reversal</article-title><source>Physical Review E</source><volume>94</volume><fpage>1</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1103/PhysRevE.94.050602</pub-id><pub-id pub-id-type="pmid">27967147</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gurry</surname> <given-names>T</given-names></name><name><surname>Kahramanoğullari</surname> <given-names>O</given-names></name><name><surname>Endres</surname> <given-names>RG</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Biophysical mechanism for ras-nanocluster formation and signaling in plasma membrane</article-title><source>PLOS ONE</source><volume>4</volume><elocation-id>e6148</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0006148</pub-id><pub-id pub-id-type="pmid">19587789</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hannezo</surname> <given-names>E</given-names></name><name><surname>Scheele</surname> <given-names>C</given-names></name><name><surname>Moad</surname> <given-names>M</given-names></name><name><surname>Drogo</surname> <given-names>N</given-names></name><name><surname>Heer</surname> <given-names>R</given-names></name><name><surname>Sampogna</surname> <given-names>RV</given-names></name><name><surname>van Rheenen</surname> <given-names>J</given-names></name><name><surname>Simons</surname> <given-names>BD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A unifying theory of branching morphogenesis</article-title><source>Cell</source><volume>171</volume><fpage>242</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.08.026</pub-id><pub-id pub-id-type="pmid">28938116</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Harrison</surname> <given-names>JU</given-names></name><name><surname>Baker</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>An automatic adaptive method to combine summary statistics in approximate bayesian computation</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1703.02341">https://arxiv.org/abs/1703.02341</ext-link></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hart</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Behavior</article-title><source>WormBook</source><pub-id pub-id-type="doi">10.1895/wormbook.1.87.1</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heyes</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Thermodynamic stability of soft-core Lennard-Jones fluids and their mixtures</article-title><source>The Journal of Chemical Physics</source><volume>132</volume><elocation-id>064504</elocation-id><pub-id pub-id-type="doi">10.1063/1.3319510</pub-id><pub-id pub-id-type="pmid">20151748</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hodgkin</surname> <given-names>J</given-names></name><name><surname>Barnes</surname> <given-names>TM</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>More is not better: brood size and population growth in a self-fertilizing nematode</article-title><source>Proceedings. Biological Sciences</source><volume>246</volume><fpage>19</fpage><lpage>24</lpage><pub-id pub-id-type="doi">10.1098/rspb.1991.0119</pub-id><pub-id pub-id-type="pmid">1684664</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jang</surname> <given-names>H</given-names></name><name><surname>Levy</surname> <given-names>S</given-names></name><name><surname>Flavell</surname> <given-names>SW</given-names></name><name><surname>Mende</surname> <given-names>F</given-names></name><name><surname>Latham</surname> <given-names>R</given-names></name><name><surname>Zimmer</surname> <given-names>M</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Dissection of neuronal gap junction circuits that regulate social behavior in <italic>Caenorhabditis Elegans</italic></article-title><source>PNAS</source><volume>114</volume><fpage>E1263</fpage><lpage>E1272</lpage><pub-id pub-id-type="doi">10.1073/pnas.1621274114</pub-id><pub-id pub-id-type="pmid">28143932</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Javer</surname> <given-names>A</given-names></name><name><surname>Currie</surname> <given-names>M</given-names></name><name><surname>Lee</surname> <given-names>CW</given-names></name><name><surname>Hokanson</surname> <given-names>J</given-names></name><name><surname>Li</surname> <given-names>K</given-names></name><name><surname>Martineau</surname> <given-names>CN</given-names></name><name><surname>Yemini</surname> <given-names>E</given-names></name><name><surname>Grundy</surname> <given-names>LJ</given-names></name><name><surname>Li</surname> <given-names>C</given-names></name><name><surname>Ch'ng</surname> <given-names>Q</given-names></name><name><surname>Schafer</surname> <given-names>WR</given-names></name><name><surname>Nollen</surname> <given-names>EAA</given-names></name><name><surname>Kerr</surname> <given-names>R</given-names></name><name><surname>Brown</surname> <given-names>AEX</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>An open-source platform for analyzing and sharing worm-behavior data</article-title><source>Nature Methods</source><volume>15</volume><fpage>645</fpage><lpage>646</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0112-1</pub-id><pub-id pub-id-type="pmid">30171234</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katz</surname> <given-names>Y</given-names></name><name><surname>Tunstrøm</surname> <given-names>K</given-names></name><name><surname>Ioannou</surname> <given-names>CC</given-names></name><name><surname>Huepe</surname> <given-names>C</given-names></name><name><surname>Couzin</surname> <given-names>ID</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Inferring the structure and dynamics of interactions in schooling fish</article-title><source>PNAS</source><volume>108</volume><fpage>18720</fpage><lpage>18725</lpage><pub-id pub-id-type="doi">10.1073/pnas.1107583108</pub-id><pub-id pub-id-type="pmid">21795604</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Köhler</surname> <given-names>S</given-names></name><name><surname>Schaller</surname> <given-names>V</given-names></name><name><surname>Bausch</surname> <given-names>AR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Collective dynamics of active cytoskeletal networks</article-title><source>PLOS ONE</source><volume>6</volume><elocation-id>e23798</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0023798</pub-id><pub-id pub-id-type="pmid">21887321</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>L</given-names></name><name><surname>Peng</surname> <given-names>H</given-names></name><name><surname>Kurths</surname> <given-names>J</given-names></name><name><surname>Yang</surname> <given-names>Y</given-names></name><name><surname>Schellnhuber</surname> <given-names>HJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Chaos-order transition in foraging behavior of ants</article-title><source>PNAS</source><volume>111</volume><fpage>8392</fpage><lpage>8397</lpage><pub-id pub-id-type="doi">10.1073/pnas.1407083111</pub-id><pub-id pub-id-type="pmid">24912159</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macosko</surname> <given-names>EZ</given-names></name><name><surname>Pokala</surname> <given-names>N</given-names></name><name><surname>Feinberg</surname> <given-names>EH</given-names></name><name><surname>Chalasani</surname> <given-names>SH</given-names></name><name><surname>Butcher</surname> <given-names>RA</given-names></name><name><surname>Clardy</surname> <given-names>J</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A hub-and-spoke circuit drives pheromone attraction and social behaviour in C. elegans</article-title><source>Nature</source><volume>458</volume><fpage>1171</fpage><lpage>1175</lpage><pub-id pub-id-type="doi">10.1038/nature07886</pub-id><pub-id pub-id-type="pmid">19349961</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGrath</surname> <given-names>PT</given-names></name><name><surname>Rockman</surname> <given-names>MV</given-names></name><name><surname>Zimmer</surname> <given-names>M</given-names></name><name><surname>Jang</surname> <given-names>H</given-names></name><name><surname>Macosko</surname> <given-names>EZ</given-names></name><name><surname>Kruglyak</surname> <given-names>L</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Quantitative mapping of a digenic behavioral trait implicates globin variation in C. elegans sensory behaviors</article-title><source>Neuron</source><volume>61</volume><fpage>692</fpage><lpage>699</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.02.012</pub-id><pub-id pub-id-type="pmid">19285466</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mercier</surname> <given-names>R</given-names></name><name><surname>Mignot</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Regulations governing the multicellular lifestyle of Myxococcus xanthus</article-title><source>Current Opinion in Microbiology</source><volume>34</volume><fpage>104</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1016/j.mib.2016.08.009</pub-id><pub-id pub-id-type="pmid">27648756</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muñoz-Dorado</surname> <given-names>J</given-names></name><name><surname>Marcos-Torres</surname> <given-names>FJ</given-names></name><name><surname>García-Bravo</surname> <given-names>E</given-names></name><name><surname>Moraleda-Muñoz</surname> <given-names>A</given-names></name><name><surname>Pérez</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Myxobacteria: moving, killing, feeding, and surviving together</article-title><source>Frontiers in Microbiology</source><volume>7</volume><pub-id pub-id-type="doi">10.3389/fmicb.2016.00781</pub-id><pub-id pub-id-type="pmid">27303375</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pearce</surname> <given-names>DJ</given-names></name><name><surname>Miller</surname> <given-names>AM</given-names></name><name><surname>Rowlands</surname> <given-names>G</given-names></name><name><surname>Turner</surname> <given-names>MS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Role of projection in the control of bird flocks</article-title><source>PNAS</source><volume>111</volume><fpage>10422</fpage><lpage>10426</lpage><pub-id pub-id-type="doi">10.1073/pnas.1402202111</pub-id><pub-id pub-id-type="pmid">25002501</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pérez</surname> <given-names>J</given-names></name><name><surname>Moraleda-Muñoz</surname> <given-names>A</given-names></name><name><surname>Marcos-Torres</surname> <given-names>FJ</given-names></name><name><surname>Muñoz-Dorado</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Bacterial predation: 75 years and counting!</article-title><source>Environmental Microbiology</source><volume>18</volume><fpage>766</fpage><lpage>779</lpage><pub-id pub-id-type="doi">10.1111/1462-2920.13171</pub-id><pub-id pub-id-type="pmid">26663201</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peruani</surname> <given-names>F</given-names></name><name><surname>Starruss</surname> <given-names>J</given-names></name><name><surname>Jakovljevic</surname> <given-names>V</given-names></name><name><surname>Søgaard-Andersen</surname> <given-names>L</given-names></name><name><surname>Deutsch</surname> <given-names>A</given-names></name><name><surname>Bär</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Collective motion and nonequilibrium cluster formation in colonies of gliding bacteria</article-title><source>Physical Review Letters</source><volume>108</volume><elocation-id>098102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.108.098102</pub-id><pub-id pub-id-type="pmid">22463670</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Redner</surname> <given-names>GS</given-names></name><name><surname>Baskaran</surname> <given-names>A</given-names></name><name><surname>Hagan</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2013">2013a</year><article-title>Reentrant phase behavior in active colloids with attraction</article-title><source>Physical Review E</source><volume>88</volume><elocation-id>012305</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.88.012305</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Redner</surname> <given-names>GS</given-names></name><name><surname>Hagan</surname> <given-names>MF</given-names></name><name><surname>Baskaran</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013b</year><article-title>Structure and dynamics of a Phase-Separating active colloidal fluid</article-title><source>Physical Review Letters</source><volume>110</volume><fpage>1</fpage><lpage>5</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.110.055701</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynolds</surname> <given-names>CW</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Flocks, herds and schools: A distributed behavioral model</article-title><source>ACM SIGGRAPH Computer Graphics</source><volume>21</volume><fpage>25</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1145/37402.37406</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rogers</surname> <given-names>C</given-names></name><name><surname>Persson</surname> <given-names>A</given-names></name><name><surname>Cheung</surname> <given-names>B</given-names></name><name><surname>de Bono</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Behavioral motifs and neural pathways coordinating O2 responses and aggregation in C. elegans</article-title><source>Current Biology</source><volume>16</volume><fpage>649</fpage><lpage>659</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2006.03.023</pub-id><pub-id pub-id-type="pmid">16581509</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salvador</surname> <given-names>LCM</given-names></name><name><surname>Bartumeus</surname> <given-names>F</given-names></name><name><surname>Levin</surname> <given-names>SA</given-names></name><name><surname>Ryu</surname> <given-names>WS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mechanistic analysis of the search behaviour of caenorhabditis elegans</article-title><source>Journal of the Royal Society Interface</source><volume>11</volume><elocation-id>20131092</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2013.1092</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Schumacher</surname> <given-names>LJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>sworm-model</data-title><source>GitHub</source><version designator="1e7ae42">1e7ae42</version><ext-link ext-link-type="uri" xlink:href="https://github.com/ljschumacher/sworm-model">https://github.com/ljschumacher/sworm-model</ext-link></element-citation></ref><ref id="bib47"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Schumacher</surname> <given-names>L</given-names></name><name><surname>Ding</surname> <given-names>SS</given-names></name><name><surname>Veleslavov</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>wormTrackingAnalysis</data-title><version designator="220d1e3">220d1e3</version><publisher-name>GitHub</publisher-name><ext-link ext-link-type="uri" xlink:href="https://github.com/ljschumacher/wormTrackingAnalysis">https://github.com/ljschumacher/wormTrackingAnalysis</ext-link></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwarz</surname> <given-names>RF</given-names></name><name><surname>Branicky</surname> <given-names>R</given-names></name><name><surname>Grundy</surname> <given-names>LJ</given-names></name><name><surname>Schafer</surname> <given-names>WR</given-names></name><name><surname>Brown</surname> <given-names>AE</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Changes in postural syntax characterize sensory modulation and natural variation of C. elegans locomotion</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004322</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004322</pub-id><pub-id pub-id-type="pmid">26295152</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shoyama</surname> <given-names>T</given-names></name><name><surname>Shimizu</surname> <given-names>Y</given-names></name><name><surname>Suda</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Decline in oxygen consumption correlates with lifespan in long-lived and short-lived mutants of caenorhabditis elegans</article-title><source>Experimental Gerontology</source><volume>44</volume><fpage>784</fpage><lpage>791</lpage><pub-id pub-id-type="doi">10.1016/j.exger.2009.09.006</pub-id><pub-id pub-id-type="pmid">19808088</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Snijders</surname> <given-names>L</given-names></name><name><surname>Kurvers</surname> <given-names>R</given-names></name><name><surname>Krause</surname> <given-names>S</given-names></name><name><surname>Ramnarine</surname> <given-names>IW</given-names></name><name><surname>Krause</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Individual- and population-level drivers of consistent foraging success across environments</article-title><source>Nature Ecology &amp; Evolution</source><volume>2</volume><fpage>1610</fpage><lpage>1618</lpage><pub-id pub-id-type="doi">10.1038/s41559-018-0658-4</pub-id><pub-id pub-id-type="pmid">30177801</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srinivasan</surname> <given-names>J</given-names></name><name><surname>Kaplan</surname> <given-names>F</given-names></name><name><surname>Ajredini</surname> <given-names>R</given-names></name><name><surname>Zachariah</surname> <given-names>C</given-names></name><name><surname>Alborn</surname> <given-names>HT</given-names></name><name><surname>Teal</surname> <given-names>PE</given-names></name><name><surname>Malik</surname> <given-names>RU</given-names></name><name><surname>Edison</surname> <given-names>AS</given-names></name><name><surname>Sternberg</surname> <given-names>PW</given-names></name><name><surname>Schroeder</surname> <given-names>FC</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A blend of small molecules regulates both mating and development in Caenorhabditis elegans</article-title><source>Nature</source><volume>454</volume><fpage>1115</fpage><lpage>1118</lpage><pub-id pub-id-type="doi">10.1038/nature07168</pub-id><pub-id pub-id-type="pmid">18650807</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srinivasan</surname> <given-names>J</given-names></name><name><surname>von Reuss</surname> <given-names>SH</given-names></name><name><surname>Bose</surname> <given-names>N</given-names></name><name><surname>Zaslaver</surname> <given-names>A</given-names></name><name><surname>Mahanti</surname> <given-names>P</given-names></name><name><surname>Ho</surname> <given-names>MC</given-names></name><name><surname>O'Doherty</surname> <given-names>OG</given-names></name><name><surname>Edison</surname> <given-names>AS</given-names></name><name><surname>Sternberg</surname> <given-names>PW</given-names></name><name><surname>Schroeder</surname> <given-names>FC</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A modular library of small molecule signals regulates social behaviors in Caenorhabditis elegans</article-title><source>PLOS Biology</source><volume>10</volume><elocation-id>e1001237</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1001237</pub-id><pub-id pub-id-type="pmid">22253572</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Starruß</surname> <given-names>J</given-names></name><name><surname>Peruani</surname> <given-names>F</given-names></name><name><surname>Jakovljevic</surname> <given-names>V</given-names></name><name><surname>Søgaard-Andersen</surname> <given-names>L</given-names></name><name><surname>Deutsch</surname> <given-names>A</given-names></name><name><surname>Bär</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Pattern-formation mechanisms in motility mutants of Myxococcus xanthus</article-title><source>Interface Focus</source><volume>2</volume><fpage>774</fpage><lpage>785</lpage><pub-id pub-id-type="doi">10.1098/rsfs.2012.0034</pub-id><pub-id pub-id-type="pmid">24312730</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname> <given-names>GJ</given-names></name><name><surname>Johnson-Kerner</surname> <given-names>B</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>Ryu</surname> <given-names>WS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Dimensionality and dynamics in the behavior of C. elegans</article-title><source>PLOS Computational Biology</source><volume>4</volume><elocation-id>e1000028</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000028</pub-id><pub-id pub-id-type="pmid">18389066</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suda</surname> <given-names>H</given-names></name><name><surname>Shouyama</surname> <given-names>T</given-names></name><name><surname>Yasuda</surname> <given-names>K</given-names></name><name><surname>Ishii</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Direct measurement of oxygen consumption rate on the nematode caenorhabditis elegans by using an optical technique</article-title><source>Biochemical and Biophysical Research Communications</source><volume>330</volume><fpage>839</fpage><lpage>843</lpage><pub-id pub-id-type="doi">10.1016/j.bbrc.2005.03.050</pub-id><pub-id pub-id-type="pmid">15809072</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thutupalli</surname> <given-names>S</given-names></name><name><surname>Sun</surname> <given-names>M</given-names></name><name><surname>Bunyak</surname> <given-names>F</given-names></name><name><surname>Palaniappan</surname> <given-names>K</given-names></name><name><surname>Shaevitz</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Directional reversals enable Myxococcus xanthus cells to produce collective one-dimensional streams during fruiting-body formation</article-title><source>Journal of The Royal Society Interface</source><volume>12</volume><fpage>20150049</fpage><pub-id pub-id-type="doi">10.1098/rsif.2015.0049</pub-id><pub-id pub-id-type="pmid">26246416</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Vaart</surname> <given-names>E</given-names></name><name><surname>Johnston</surname> <given-names>ASA</given-names></name><name><surname>Sibly</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Predicting how many animals will be where: How to build, calibrate and evaluate individual-based models</article-title><source>Ecological Modelling</source><volume>326</volume><fpage>113</fpage><lpage>123</lpage><pub-id pub-id-type="doi">10.1016/j.ecolmodel.2015.08.012</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vicsek</surname> <given-names>T</given-names></name><name><surname>Czirók</surname> <given-names>A</given-names></name><name><surname>Ben-Jacob</surname> <given-names>E</given-names></name><name><surname>Cohen</surname> <given-names>I</given-names></name><name><surname>Shochet</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Novel type of phase transition in a system of self-driven particles</article-title><source>Physical Review Letters</source><volume>75</volume><fpage>1226</fpage><lpage>1229</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.75.1226</pub-id><pub-id pub-id-type="pmid">10060237</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vicsek</surname> <given-names>T</given-names></name><name><surname>Zafeiris</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Collective motion</article-title><source>Physics Reports</source><volume>517</volume><fpage>71</fpage><lpage>140</lpage><pub-id pub-id-type="doi">10.1016/j.physrep.2012.03.004</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ward</surname> <given-names>AJ</given-names></name><name><surname>Herbert-Read</surname> <given-names>JE</given-names></name><name><surname>Sumpter</surname> <given-names>DJ</given-names></name><name><surname>Krause</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Fast and accurate decisions through collective vigilance in fish shoals</article-title><source>PNAS</source><volume>108</volume><fpage>2312</fpage><lpage>2315</lpage><pub-id pub-id-type="doi">10.1073/pnas.1007102108</pub-id><pub-id pub-id-type="pmid">21262802</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weitz</surname> <given-names>S</given-names></name><name><surname>Deutsch</surname> <given-names>A</given-names></name><name><surname>Peruani</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Self-propelled rods exhibit a phase-separated state characterized by the presence of active stresses and the ejection of polar clusters</article-title><source>Physical Review E</source><volume>92</volume><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1103/PhysRevE.92.012322</pub-id><pub-id pub-id-type="pmid">26274176</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname> <given-names>JG</given-names></name><name><surname>Southgate</surname> <given-names>E</given-names></name><name><surname>Thomson</surname> <given-names>JN</given-names></name><name><surname>Brenner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>The structure of the nervous system of the nematode Caenorhabditis elegans</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>314</volume><fpage>1</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1098/rstb.1986.0056</pub-id><pub-id pub-id-type="pmid">22462104</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yates</surname> <given-names>CA</given-names></name><name><surname>Baker</surname> <given-names>RE</given-names></name><name><surname>Erban</surname> <given-names>R</given-names></name><name><surname>Maini</surname> <given-names>PK</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Refining self-propelled particle models for collective behaviour</article-title><source>The Canadian Applied Mathematics Quarterly</source><volume>18</volume><fpage>299</fpage><lpage>350</lpage></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yemini</surname> <given-names>E</given-names></name><name><surname>Jucikas</surname> <given-names>T</given-names></name><name><surname>Grundy</surname> <given-names>LJ</given-names></name><name><surname>Brown</surname> <given-names>AE</given-names></name><name><surname>Schafer</surname> <given-names>WR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A database of Caenorhabditis elegans behavioral phenotypes</article-title><source>Nature Methods</source><volume>10</volume><fpage>877</fpage><lpage>879</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2560</pub-id><pub-id pub-id-type="pmid">23852451</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>Z</given-names></name><name><surname>Igoshin</surname> <given-names>OA</given-names></name><name><surname>Cotter</surname> <given-names>CR</given-names></name><name><surname>Shimkets</surname> <given-names>LJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Agent-Based modeling reveals possible mechanisms for observed aggregation cell Behaviors</article-title><source>Biophysical Journal</source><volume>115</volume><fpage>2499</fpage><lpage>2511</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2018.11.005</pub-id><pub-id pub-id-type="pmid">30514635</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname> <given-names>Y</given-names></name><name><surname>Long</surname> <given-names>L</given-names></name><name><surname>Xu</surname> <given-names>W</given-names></name><name><surname>Campbell</surname> <given-names>RF</given-names></name><name><surname>Large</surname> <given-names>EE</given-names></name><name><surname>Greene</surname> <given-names>JS</given-names></name><name><surname>McGrath</surname> <given-names>PT</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Changes to social feeding behaviors are not sufficient for fitness gains of the <italic>Caenorhabditis elegans</italic> N2 reference strain</article-title><source>eLife</source><volume>7</volume><elocation-id>e38675</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.38675</pub-id><pub-id pub-id-type="pmid">30328811</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.43318.029</object-id><sec id="s8" sec-type="appendix"><title>1 Agent-based simulations</title><p>We aim to create a model of worm locomotion and interaction that recapitulates aggregation and swarming behavior. Many mechanical models of worm locomotion exist in the literature, but we aim for a simpler representation of each individual worm, so that computationally inexpensive simulations of tens to hundreds of worms allow rapid hypothesis exploration and testing.</p><sec id="s8-1"><title>1.1 SPP worm model</title><p>Each agent is represented by <inline-formula><mml:math id="inf2"><mml:mi>M</mml:mi></mml:math></inline-formula> nodes connected linearly by <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> segments. Each node moves as a self-propelled particle with a preferred speed <inline-formula><mml:math id="inf4"><mml:mi>v</mml:mi></mml:math></inline-formula>. At each time-step, the direction of movement is updated based on phenomenological forces representing active movement, interactions with other worms, and constrains to ensure the worm does not extend in length or bend excessively. Nodes follow forces in the over-damped regime, <inline-formula><mml:math id="inf5"><mml:mrow><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="bold">𝐅</mml:mi></mml:mrow></mml:math></inline-formula>, with periodic boundary conditions.</p><p>The code for model simulations is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ljschumacher/sworm-model">github.com/ljschumacher/sworm-model</ext-link> (<xref ref-type="bibr" rid="bib46">Schumacher, 2019</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/sworm-model">https://github.com/elifesciences-publications/sworm-model</ext-link>).</p><sec id="s8-1-1"><title>1.1.1 Self-propelled movement</title><p>The self-propulsion is modeled as a motile force, <inline-formula><mml:math id="inf6"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">𝐅</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, on node 1, that is the head node. Note that for notational convenience we ignore the constant of proportionality, implicitly writing <inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf8"><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> has units of force and <inline-formula><mml:math id="inf9"><mml:mi>F</mml:mi></mml:math></inline-formula> has units of velocity.</p><p>To mimic a worm’s persistent movement with directional changes over time (<xref ref-type="bibr" rid="bib45">Salvador et al., 2014</xref>), we add a stochastic contribution to the head node’s movement, given by <inline-formula><mml:math id="inf10"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ξ</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf11"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the orientation of node <inline-formula><mml:math id="inf12"><mml:mi>i</mml:mi></mml:math></inline-formula> with respect to the <inline-formula><mml:math id="inf13"><mml:mi>x</mml:mi></mml:math></inline-formula>-axis, <inline-formula><mml:math id="inf14"><mml:mi>η</mml:mi></mml:math></inline-formula> is the noise strength, and <inline-formula><mml:math id="inf15"><mml:mi>ξ</mml:mi></mml:math></inline-formula> is a normally distributed random variable. The noise is parameterized by analyzing the directional auto-correlation of single worm simulations, and set so that the autocorrelation after 25 s (roughly the time it takes an npr-1 worm to cross the 8.5 mm food patch) is, on average, less than 0.23. This value is equivalent to a random reorientation between <inline-formula><mml:math id="inf16"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf17"><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, and thus reflects that over a distance equivalent to the food patch size, worms should lose all memory of their orientation. For N2 simulations, which move at a lower speed, the noise strength is scaled by a factor of <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msqrt><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mrow><mml:mtext mathvariant="italic">npr-</mml:mtext></mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula>, which results in the same condition.</p><p>For the nodes following the head node, the direction of movement is given by the tangent vector towards the next node. For node <inline-formula><mml:math id="inf19"><mml:mi>i</mml:mi></mml:math></inline-formula>, the tangent vector is calculated as <inline-formula><mml:math id="inf20"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, that is the average between the direction towards the previous node and the direction from the next node. The motile force on node <inline-formula><mml:math id="inf21"><mml:mi>i</mml:mi></mml:math></inline-formula> is then given by <inline-formula><mml:math id="inf22"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">𝐅</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>After forces have been applied and the nodes’ positions updated, the headings are updated to reflect the direction of the displacement for calculating the movement in the next time step.</p></sec><sec id="s8-1-2"><title>1.1.2 Undulations</title><p>To mimic more worm-like movement (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2H</xref>), we impose a sinusoidal contribution to the direction of the head node’s movement. If <inline-formula><mml:math id="inf23"><mml:mi>θ</mml:mi></mml:math></inline-formula> is the direction of movement in the worm’s reference frame, and <inline-formula><mml:math id="inf24"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> the orientation of node <inline-formula><mml:math id="inf25"><mml:mi>i</mml:mi></mml:math></inline-formula> with respect to the <inline-formula><mml:math id="inf26"><mml:mi>x</mml:mi></mml:math></inline-formula>-axis, we assume the heading of the worm internally oscillates with angular frequency <inline-formula><mml:math id="inf27"><mml:mi>ω</mml:mi></mml:math></inline-formula> and amplitude <inline-formula><mml:math id="inf28"><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, so that<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>ω</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This prescribes the change in direction for the head node at every time step, such that<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ξ</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ξ</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>×</mml:mo><mml:mn>0.6</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf30"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and the <inline-formula><mml:math id="inf31"><mml:mi>m</mml:mi></mml:math></inline-formula>th node’s internal oscillator is phase-shifted by <inline-formula><mml:math id="inf32"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>11.76</mml:mn><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s8-1-3"><title>1.1.3 Taxis</title><p>To investigate the effect of taxis in our simulations, we treat the movement of the head node as an attracting walk with respect to other worm’s nodes within an interaction radius <inline-formula><mml:math id="inf33"><mml:msub><mml:mi>R</mml:mi><mml:mi>taxis</mml:mi></mml:msub></mml:math></inline-formula> (see <xref ref-type="bibr" rid="bib24">Hannezo et al., 2017</xref>, SI). This was implemented as an additional term <inline-formula><mml:math id="inf34"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐩</mml:mi><mml:mi>taxis</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> added to the motile force that affects its direction as well as its the magnitude (reflecting additive contribution from multiple neighboring worms). The parameter <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>f</mml:mi><mml:mi>taxis</mml:mi></mml:msub></mml:math></inline-formula> controls the strength of taxis per other worm. The taxis force is additionally weighted by <inline-formula><mml:math id="inf36"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> to reflect that nearby neighbors exert a stronger attraction, that is as if mediated by a non-degrading, diffusible factor, such as oxygen or CO<sub>2</sub>. The vector <inline-formula><mml:math id="inf37"><mml:msub><mml:mi mathvariant="bold">𝐩</mml:mi><mml:mi>taxis</mml:mi></mml:msub></mml:math></inline-formula> is the sum of the directions towards other worms’ nodes within the interaction radius, <inline-formula><mml:math id="inf38"><mml:msub><mml:mi>R</mml:mi><mml:mi>taxis</mml:mi></mml:msub></mml:math></inline-formula>, so that for worm <inline-formula><mml:math id="inf39"><mml:mi>k</mml:mi></mml:math></inline-formula>, the taxis contribution to the motile force is<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐩</mml:mi><mml:mrow><mml:mi>taxis</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mo>[</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>taxis</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>-</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The sum is over all nodes of other worms, and the force is normalized by <inline-formula><mml:math id="inf40"><mml:mi>M</mml:mi></mml:math></inline-formula> to make it independent on the number of nodes in a worm. To prevent excessive overlap of worms, the taxis force become repulsive for worms that overlap, hence the negative second term.</p></sec><sec id="s8-1-4"><title>1.1.4 Length constraints</title><p>To enforce approximately constant length of the worm, each node is connected by non-linear springs of rest length <inline-formula><mml:math id="inf41"><mml:msub><mml:mi>l</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> that resist an extension <inline-formula><mml:math id="inf42"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf43"><mml:mi>l</mml:mi></mml:math></inline-formula> is the length of the segment, with opposing force<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐅</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">𝐥</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which points along the direction of the segment, <inline-formula><mml:math id="inf44"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">𝐥</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐥</mml:mi><mml:mo>/</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s8-1-5"><title>1.1.5 Volume exclusion</title><p>For supplementary simulations with volume exclusion (<xref ref-type="fig" rid="fig6s5">Figure 6—figure supplement 5B</xref>), the forces are modified as follows when two nodes are overlapping: Any two nodes <inline-formula><mml:math id="inf45"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf46"><mml:mi>j</mml:mi></mml:math></inline-formula> of different objects that are closer than <inline-formula><mml:math id="inf47"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> exert contact forces onto each other (nodes within the same object can overlap without contact forces). The total force acting on node <inline-formula><mml:math id="inf48"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf49"><mml:msub><mml:mi mathvariant="bold">𝐅</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is projected onto the connecting line between the nodes, and if this projected force is pointing towards node <inline-formula><mml:math id="inf50"><mml:mi>j</mml:mi></mml:math></inline-formula> (pushing rather than pulling), it is added to <inline-formula><mml:math id="inf51"><mml:msub><mml:mi mathvariant="bold">𝐅</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>. The contact force of <inline-formula><mml:math id="inf52"><mml:mi>j</mml:mi></mml:math></inline-formula> onto <inline-formula><mml:math id="inf53"><mml:mi>i</mml:mi></mml:math></inline-formula> is calculated mutatis mutandis.</p></sec><sec id="s8-1-6"><title>1.1.6 Adhesion</title><p>To assess how aggregation is affected by a moderate adhesion (equal to both strains), such as could arise through liquid film forces (<xref ref-type="bibr" rid="bib20">Gart et al., 2011</xref>), we implemented a soft-core version of the Lennard-Jones potential. This gives rise to a force between any two nodes of <italic>different</italic> worms that is repulsive at short distances, attractive at intermediate distances, and zero at long distances. The force between two nodes separated by <inline-formula><mml:math id="inf54"><mml:mrow><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:mrow><mml:mn>3.75</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (the cut-off was chosen to limit adhesive force to nearest neighbors) is given by a soft-core potential of a generalized Lennard-Jones form (<xref ref-type="bibr" rid="bib27">Heyes, 2010</xref>):<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>8</mml:mn><mml:mo>⁢</mml:mo><mml:mfrac><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mi>σ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>σ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf55"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. The parameter <inline-formula><mml:math id="inf56"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> was chosen so that the force becomes attractive at a distance greater than the node particle size, the exponent of the attractive term was chosen as -1 to reflect the <inline-formula><mml:math id="inf57"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> dependence estimated for liquid film tension between two worms (<xref ref-type="bibr" rid="bib20">Gart et al., 2011</xref>), and the exponent of the repulsive term was set as -2 to win over the attractive term at short distances (to ensure volume exclusion). Note that adhesion is not used in any of the results of this work and was only used to illustrate its unrealistic effects on aggregation (<xref ref-type="fig" rid="fig5">Figure 5D</xref>).</p></sec><sec id="s8-1-7"><title>1.1.7 Switching between slow and fast movement</title><p>Worms stochastically switch between movement at speeds <inline-formula><mml:math id="inf58"><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf59"><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> with rates that depend on the local density of worms surrounding them. In the absence of other worms, the (Poisson) rates are <inline-formula><mml:math id="inf60"><mml:msub><mml:mi>k</mml:mi><mml:mi>s0</mml:mi></mml:msub></mml:math></inline-formula> to slow down from <inline-formula><mml:math id="inf61"><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf62"><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf63"><mml:msub><mml:mi>k</mml:mi><mml:mi>f0</mml:mi></mml:msub></mml:math></inline-formula> to speed up from <inline-formula><mml:math id="inf64"><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf65"><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. These rates increase and decrease, respectively, with the number of neighboring worm nodes within <inline-formula><mml:math id="inf66"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> of any node of the worm, such that<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>slow</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>s0</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the linear dependence is chosen for simplicity, and <inline-formula><mml:math id="inf67"><mml:msubsup><mml:mi>k</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math></inline-formula> is a free parameter, and<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>fast</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>f0</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the exponential decay with decay constant <inline-formula><mml:math id="inf68"><mml:msubsup><mml:mi>k</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math></inline-formula> was chosen to provide a lower bound of 0 for the rate. Note that the rate of switching to fast movement is related to the duration of a period of slow movement via <inline-formula><mml:math id="inf69"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>slow</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>fast</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (for Poisson rates).</p><p>The local density <inline-formula><mml:math id="inf70"><mml:mi>ρ</mml:mi></mml:math></inline-formula> is estimated by counting the average number of other worms’ nodes in a radius <inline-formula><mml:math id="inf71"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> around each node of the current worm.<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>m</mml:mi><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf72"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> is the distance from the current node <inline-formula><mml:math id="inf73"><mml:mi>m</mml:mi></mml:math></inline-formula> to node <inline-formula><mml:math id="inf74"><mml:mi>j</mml:mi></mml:math></inline-formula> of worm <inline-formula><mml:math id="inf75"><mml:mi>n</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf76"><mml:mi mathvariant="normal">Θ</mml:mi></mml:math></inline-formula> is the Heaviside step function (such that <inline-formula><mml:math id="inf77"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), and the sum over other worms skips the index of the current worm.</p><p>For simulations with undulations, when a worm has slowed down to <inline-formula><mml:math id="inf79"><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula>, the angular frequency of its internal oscillators slows down accordingly to <inline-formula><mml:math id="inf80"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>ω</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s8-1-8"><title>1.1.8 Reversals</title><p>To model reverse movement, we switch the direction of the nodes for the duration of the reversal, such that movement originates from the tail and the rest of the body follows. Reversals events are generated stochastically, with Poisson-rate <inline-formula><mml:math id="inf81"><mml:msub><mml:mi>r</mml:mi><mml:mi>rev</mml:mi></mml:msub></mml:math></inline-formula>, which depends on the local density via<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>rev</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf82"><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> is a free parameter, and <inline-formula><mml:math id="inf83"><mml:mi>ρ</mml:mi></mml:math></inline-formula> is the local density as estimated above. Once a reversal rate has started, it lasts for <inline-formula><mml:math id="inf84"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>rev</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>s, unless otherwise aborted (see Contact-dependent reversal events).</p></sec><sec id="s8-1-9"><title>1.1.9 Reversals with undulations</title><p>Upon reversals, we have also to reset the phase of the internal oscillator prescribing the undulating movement of the worm to match its current shape (as the phase may have decoupled from the shape during movement). Recall that the internal orientation of a node with index <inline-formula><mml:math id="inf85"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf86"><mml:mi>s</mml:mi></mml:math></inline-formula> is the arc-length along the worm, is changing with the node’s internal oscillator according to<disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>ω</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ψ</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and the derivative with respect of arc length, <inline-formula><mml:math id="inf87"><mml:mi>s</mml:mi></mml:math></inline-formula>, differentiating towards the head, that is decreasing <inline-formula><mml:math id="inf88"><mml:mi>s</mml:mi></mml:math></inline-formula>, gives<disp-formula id="equ11"><mml:math id="m11"><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ψ</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>ω</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ψ</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Both the angle, <inline-formula><mml:math id="inf89"><mml:mi>θ</mml:mi></mml:math></inline-formula>, and the curvature, <inline-formula><mml:math id="inf90"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>, are needed to estimate the phase uniquely, using<disp-formula id="equ12"><mml:math id="m12"><mml:mrow><mml:mrow><mml:mfrac><mml:mi>θ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>l</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mi>tan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>ω</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ψ</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which we re-arrange to get the phase, that is the node’s oscillator’s internal time,<disp-formula id="equ13"><label>(10)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>ω</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ψ</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>θ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>l</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We use this expression to set the phase of the head/tail node after a reversal starts/ends, and set the phase of the rest of the worm according to <inline-formula><mml:math id="inf91"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s8-1-10"><title>1.1.10 Contact-dependent reversal events</title><p>The rate of reversal events depends on whether the head and tail are in close proximity with other worms, being <inline-formula><mml:math id="inf92"><mml:msub><mml:mi>r</mml:mi><mml:mi>rev</mml:mi></mml:msub></mml:math></inline-formula> when only the head or tail is in close proximity to another worm, but not both, and zero otherwise. Head and tail nodes are specified as the first and last 10 percent of the nodes (rounded), respectively. Contact is registered if any other worm’s nodes are within <inline-formula><mml:math id="inf93"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> of the head/tail nodes. If the worm is going forward and the tail is in contact, but the head is not, reversals occur with rate <inline-formula><mml:math id="inf94"><mml:msub><mml:mi>r</mml:mi><mml:mi>rev</mml:mi></mml:msub></mml:math></inline-formula>. If the worm is already reversing, and the tail is not in contact, but the head is, reversals stop with the same rate. If both or neither head and tail are in contact, no reversals occur (adding reversal rates as measured for freely moving worms did not qualitatively change the aggregation outcome of simulations).</p></sec><sec id="s8-1-11"><title>1.1.11 Adaptive time-step</title><p>The time-step of simulations is chosen adaptively to maintain accuracy at higher forces. To achieve this the time-step scales inversely with the maximum magnitude of forces in the system, <inline-formula><mml:math id="inf95"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The precise scaling is chosen so that the node with the highest force acting on it moves no further in one time-step than <inline-formula><mml:math id="inf96"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> of the node radius.</p></sec></sec><sec id="s8-2"><title>1.2 Food depletion</title><p>For simulations with food depletion, food is initialized uniformly on a grid of size <inline-formula><mml:math id="inf97"><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf98"><mml:msub><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> is the node radius. Food concentration is set equal to 100 in arbitrary units. Before worm movement is calculated, food concentrations are checked. If the food is depleted at the grid-point closest to the head node of a worm, the worm moves at the faster speed <inline-formula><mml:math id="inf99"><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, regardless of other interactions (i.e. does not slow down and speeds up if previously slowed down). After worm movements, food is consumed in each grid-point by an amount <inline-formula><mml:math id="inf100"><mml:msub><mml:mi>r</mml:mi><mml:mi>feed</mml:mi></mml:msub></mml:math></inline-formula> per worm-head in that grid-point, with a minimum of zero food.</p></sec></sec><sec id="s9" sec-type="appendix"><title>2 Parameter inference</title><sec id="s9-1"><title>2.1 Inference scheme</title><p>We employ approximate Bayesian inference with rejection sampling (<xref ref-type="bibr" rid="bib5">Beaumont et al., 2002</xref>; <xref ref-type="bibr" rid="bib57">van der Vaart et al., 2016</xref>). We sample from our prior distribution of the parameters (see Reduction to feasible parameter space) and run simulations for these samples. Similarity to the experimental data is then computed based on summary statistics (see Summary statistics), and the closest fraction <inline-formula><mml:math id="inf101"><mml:mi>α</mml:mi></mml:math></inline-formula> of the simulations are chosen. To estimate the posterior distribution from these chosen parameter samples, we construct a kernel density estimation, with the weight for each sample chosen inversely proportional to the distance from the experimental data.</p></sec><sec id="s9-2"><title>2.2 Reduction to feasible parameter space</title><p>For the four-parameter model, with density-dependent reversals (<inline-formula><mml:math id="inf102"><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula>), speed-switching rates (<inline-formula><mml:math id="inf103"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>) and taxis interactions (<inline-formula><mml:math id="inf104"><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub></mml:math></inline-formula>), we employ a strategy to exclude unfeasible regions of parameter space before running long simulations. Our reasoning is that interactions must be such that pairs of worms should not be stable for long times, and cluster of worms should be stable/unstable for npr-1/N2. We first sample parameters for pilot simulations from a regular grid, with <inline-formula><mml:math id="inf105"><mml:msup><mml:mn>10</mml:mn><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> samples, where <inline-formula><mml:math id="inf106"><mml:mi>d</mml:mi></mml:math></inline-formula> is the dimensionality of our parameter space. We then run simulations of worms starting as an overlapping pair, and assess whether they are within 1 mm of each other after 1 min of simulation (taking the median of 10 repeated simulations). If their separation is below the threshold, we discard the parameter sample. The remaining parameter samples are used to run simulations in which worms start out in a cluster (by confining their initial positions to a circle of 1.8 mm radius). These simulations are run for 300 s, after which stability of the cluster is assessed by calculating the radius of gyration of the head-nodes of the worms. If the radius of gyration is above 3 mm (which corresponds approximately to worms being uniformly distributed within a square of 7.5 mm side length), the cluster is deemed not stable and the parameter sample is discarded for npr-1 simulations, and kept for N2 simulations. Both the pair- and cluster-stability thresholds are chosen conservatively to include rather than exclude potential parameter samples. Never the less, only a few percent of the initial parameter space remain as feasible for further inference. The remaining parameter samples are used to construct a prior distribution via kernel density estimation, that is centering a Gaussian distribution on each sample.</p><p>For the N2 parameterization, only pilot runs with <inline-formula><mml:math id="inf107"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>taxis</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> were accepted, so we chose to sample this parameter on a <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></inline-formula>-scale for both strains. When constructing the approximate posterior distribution this change in prior <inline-formula><mml:math id="inf109"><mml:mi>π</mml:mi></mml:math></inline-formula> was taken into account by weighting each sample with the appropriate importance factor of <inline-formula><mml:math id="inf110"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>new</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>old</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s9-3"><title>2.3 Summary statistics</title><p>We use the following summary statistics to quantify aggregation and compute the similarity between simulations and the experimental data:</p><list list-type="order"><list-item><p>The pair-correlation function compares the density of neighbors at a distance <inline-formula><mml:math id="inf111"><mml:mi>r</mml:mi></mml:math></inline-formula> to that expected under a uniform random distribution (<xref ref-type="bibr" rid="bib23">Gurry et al., 2009</xref>):<disp-formula id="equ14"><label>(11)</label><mml:math id="m14"><mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>A</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi><mml:mi>N</mml:mi></mml:msubsup><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msub><mml:mn>𝟏</mml:mn><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf112"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the distance between objects <inline-formula><mml:math id="inf113"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf114"><mml:mi>j</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> is the size of the simulation domain, chosen to match the estimated are of the food patch in experiments.</p></list-item><list-item><p>Hierarchical clustering (as implemented in Matlab’s linkage function) quantifies the structure of a point pattern through agglomerative clustering. Each frame results in a dendrogram, or clustering tree. We summarize the distribution of these clustering trees through the overall distribution of branch lengths, <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>.</p></list-item><list-item><p>The standard deviation of the positions, <inline-formula><mml:math id="inf117"><mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, is a simple way to quantify the spread of points <inline-formula><mml:math id="inf118"><mml:mrow><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which we average over time to give<disp-formula id="equ15"><label>(12)</label><mml:math id="m15"><mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></list-item><list-item><p>The kurtosis or the sharpness of the distribution of positions,<disp-formula id="equ16"><label>(13)</label><mml:math id="m16"><mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>Kurt</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></list-item></list><p>To compute these summary statistics, we randomly sample frames from experiments and simulations such that on average we have one frame every three seconds. To mimic the partial information about a worm’s position obtained from the pharynx-labelled imaging, we restricted the simulation analysis to the first 16 percent of the nodes (based on measurements of pharynx size relative to worm body length), from which centroid positions for each worm were obtained. We also computed the nematic order parameter (<xref ref-type="bibr" rid="bib61">Weitz et al., 2015</xref>), but found these to be low (<inline-formula><mml:math id="inf119"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>) for both strains, and hence not an informative summary statistic of aggregation in our system.</p><p>Note that when calculating summary statistics for simulation outputs, periodic boundary conditions have to be taken into account. This means calculating any distances <inline-formula><mml:math id="inf120"><mml:mi>r</mml:mi></mml:math></inline-formula> as <inline-formula><mml:math id="inf121"><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and furthermore calculating the mean positions, <inline-formula><mml:math id="inf122"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, in dimension <inline-formula><mml:math id="inf123"><mml:mi>i</mml:mi></mml:math></inline-formula> (used in <inline-formula><mml:math id="inf124"><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf125"><mml:msub><mml:mi>S</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula>) as<disp-formula id="equ17"><label>(14)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>c</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf126"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf127"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> is the four-quadrant inverse tangent.</p><sec id="s9-3-1"><title>2.3.1 Distance function</title><p>Before combining the summary statistics into a single distance function, we scale them for their overall magnitude and dimensionality as follows: We take the log-ratio of the summary statistics from experiments and simulations (<xref ref-type="bibr" rid="bib4">Barnes et al., 2012</xref>) to adjust both for the different scale of bins within distributions, and the different scales of summary statistics overall, such that each statistic is weighted approximately equally, irrespective of its average magnitude.</p><p>We further note that higher dimensional summary statistics result in larger distance values, even if the difference in each dimension is equal to that of a lower dimensional statistic. We choose to normalize for this by dividing the distance by the square root of the dimensionality.</p><p>Thus, our distance function for summary statistic <inline-formula><mml:math id="inf129"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> with dimensionality <inline-formula><mml:math id="inf130"><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is given by<disp-formula id="equ18"><label>(15)</label><mml:math id="m18"><mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo fence="true">||</mml:mo><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>obs</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>sim</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo fence="true">||</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msqrt><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msqrt></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using <inline-formula><mml:math id="inf131"><mml:mi>log</mml:mi></mml:math></inline-formula>-ratios can cause infinite distances if any of the <inline-formula><mml:math id="inf132"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>sim</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. To avoid this, we cap the simulation data 0.005, that is we set <inline-formula><mml:math id="inf133"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>sim</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>sim</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0.005</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. This limits the penalizing effect of empty bins and the tails of a distribution on the overall distance function.</p></sec><sec id="s9-3-2"><title>2.3.2 Alternative weighting of summary statistics</title><p>We explored optimizing the weighting of summary statistics to maximize the distance between our prior and posterior distribution over the parameters (<xref ref-type="bibr" rid="bib25">Harrison and Baker, 2017</xref>), but this led to weighting of the summary statistics (with all the weight concentrated in <inline-formula><mml:math id="inf134"><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf135"><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula>) which did not match with visual inspection of the closest matching simulations. In other words, equally weighting all summary statistics returned simulations that better reflected our intuition for what constitutes a good match, in particular for the npr-1 parameterization. In the interest of completeness we describe here the method of <xref ref-type="bibr" rid="bib25">Harrison and Baker (2017)</xref> applied to our data, as it informed our thinking, even though we did not use the results.</p><p>To try and optimize the weighting of our summary statistics, we optimized the Hellinger distance between our prior and posterior distribution over the parameters (<xref ref-type="bibr" rid="bib25">Harrison and Baker, 2017</xref>), with weak regularization (<inline-formula><mml:math id="inf136"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) of the parameters included in the objective function. Distributions are calculated using kernel density estimation as described above, and as an optimization procedure we use the genetic algorithm provided in Matlab’s global optimization toolbox. With the weightings <inline-formula><mml:math id="inf137"><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> for each summary statistic thus optimized, the overall distance is <inline-formula><mml:math id="inf138"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>This method of adaptively weighting summary statistics is still sensitive to the choice of statistics. Our choices are by no means exhaustive, and we chose to focus on statistics commonly used to quantify aggregation (pair-correlation function and hierarchical clustering) and the shape of distributions (variance and kurtosis).</p><p>To ensure that the same summary statistics are chosen for the parameter inference for either strains, we jointly optimize the posterior distribution for both strains, by minimizing the objective function <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf140"><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the Hellinger distance between the prior and the posterior for strain <inline-formula><mml:math id="inf141"><mml:mi>i</mml:mi></mml:math></inline-formula>.</p></sec></sec><sec id="s9-4"><title>2.4 Kernel density estimation</title><p>For plotting the marginal joint distributions between pairs of parameters, we use ksdensity (Matlab, R2018a). For constructing the higher-dimensional parameter distributions to sample from, we implement the kernel density estimation using <monospace>gmdistribution</monospace> (Matlab, R2018a) with Silverman’s rule of thumb for the bandwidths.</p></sec><sec id="s9-5"><title>2.5 Sampling sequence</title><p>We first sampled 100,000 samples from our prior, resulting in 11,214 simulations for npr-1 and 1394 simulations for N2 (only a fraction of parameter samples resulted in full simulations because samples resulting in stable pairs and stable/unstable clusters were rejected for N2/npr-1, see Reduction to feasible parameter space). To improve the successful sampling rate, we constructed an approximate posterior distribution from the initial samples, and continued sampling from this posterior distribution, thus ensuring the samples were concentrated in the appropriate regions of parameter space. This change in the sampling distribution was accounted for when constructing the final posterior (<xref ref-type="fig" rid="fig6">Figure 6D</xref>) distributions through weighting by the ratio of the initial prior distribution to the proposal distribution (with a small regularization to avoid division by near-zero weight for outlier samples). In this second round of sampling we generated 13,341 simulations for N2 and 27,384 samples for npr-1.</p></sec></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.43318.030</object-id><fig id="app2fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.43318.031</object-id><label>Appendix 2—figure 1.</label><caption><title>Oxygen consumption-diffusion calculations predict shallow O<sub>2</sub> concentration gradients.</title><p>(<sc><bold>A</bold></sc>) Plot of feasible oxygen gradients inside worm aggregates. The oxygen concentration decays with length constant <inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msqrt><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>μ</mml:mi></mml:msqrt><mml:mo>≈</mml:mo><mml:mn>1</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, with diffusion constant <inline-formula><mml:math id="inf143"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">D</mml:mi><mml:mo>≈</mml:mo><mml:mn mathvariant="bold">2.1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn mathvariant="bold">10</mml:mn><mml:mrow><mml:mo mathvariant="bold">−</mml:mo><mml:mn mathvariant="bold">5</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>s</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> (in water) and oxygen consumption rate <inline-formula><mml:math id="inf144"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mn mathvariant="bold">0.14</mml:mn></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (estimated as an upper bound for 200 pl/min [<xref ref-type="bibr" rid="bib49">Shoyama et al., 2009</xref>; <xref ref-type="bibr" rid="bib55">Suda et al., 2005</xref>] at 21% oxygen and 8000 pl worm volume). The thinnest dimension of a cluster is relevant for diffusion, which is its thickness. We can approximate the cluster geometry either as flat, which results in a 1D diffusion gradient (solid line), or as hemispherical, which we approximate by spherically symmetric diffusion in 3D (dashed line). In either case the reaction-diffusion equation <inline-formula><mml:math id="inf145"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">D</mml:mi><mml:msup><mml:mi mathvariant="bold">Δ</mml:mi><mml:mn mathvariant="bold">2</mml:mn></mml:msup><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> was solved at steady state. (<bold>B</bold>) Gradient of diffusible, non-degrading signal, ∂t for example CO<sub>2</sub>, outside a point source. Without decay, this problem is equivalent to calculating the λ potential around a point charge, and the concentration would be <inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mo mathvariant="bold">=</mml:mo><mml:mfrac><mml:mi mathvariant="bold-italic">λ</mml:mi><mml:mrow><mml:mn mathvariant="bold">4</mml:mn><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>, in 3D, where λ is the production rate times the volume of a worm, 0.14/min (equal and opposite to the O<sub>2</sub> consumption, based on mass conservation). A point source represents the contribution of a short section of a worm, and the contributions of many worms in an aggregate would integrate to give an approximately logarithmic gradient of signal outside the aggregate.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-43318-app2-fig1-v2.tif"/></fig></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.43318.033</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Mignot</surname><given-names>Tâm</given-names></name><role>Reviewing Editor</role><aff><institution>CNRS-Aix Marseille University</institution><country>France</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Hodgkin</surname><given-names>Jonathan</given-names> </name><role>Reviewer</role></contrib><contrib contrib-type="reviewer"><name><surname>Igoshin</surname><given-names>Oleg A</given-names></name><role>Reviewer</role><aff><institution>Rice University</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Shared behavioral mechanisms underlie <italic>C. elegans</italic> aggregation and swarming&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by two peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Naama Barkai as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Jonathan Hodgkin and Oleg A Igoshin.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>The manuscript of Ding et al. investigates collective feeding in the roundworm <italic>C. elegans</italic> with combination of time-lapse imaging, image analysis and mathematical modeling. It's a very well-written paper that presents broadly interesting and intriguing set of observation. Combination of experimental, quantitative analysis and modeling is the major strength of the paper. The authors study a prey-induced worm collective motility behavior called &quot;swarming&quot; and propose a mechanistic basis for this phenomenon. Both individual and population-level behaviors are quantified. Subsequent modeling is used to identify three key behaviors that drive aggregation: edge reversals, a density-dependent switches in speeds, and taxis towards neighboring worms. The same models can account for swarming when local food depletion is taken into account.</p><p>Major points:</p><p>1) Importantly, the modeling approach could be improved given the wealth of the experimental data. Specifically, it is surprising that the authors chose a fully phenomenological approach to construct their agent-based models that uses very little of the quantified data. Furthermore, authors do little to quantitatively compare resulting behaviors of agents in the model to those of tracked worms. Therefore, the reviewers are not fully convinced that identified behaviors in the model are either necessary or sufficient (given considerable noise in individual behaviors) for the observed population behaviors.</p><p>To circumvent this issue, measured individual worm behaviors should be used in constructing and/or constraining their model (see for example References PMID: 30514635, PMID: 28533367). Importantly, the noise and variability of the movement of agent match those of worms. It is not clear if this is the case in the current model. Furthermore, comparison of the resulting behaviors of agents and worms would allow testing the model. For example, is there correlation (e.g. between the agent velocity and the vector to nearby worm) that can quantify the degree of taxis? Can this correlation be compared between the model and experiments? Similar quantitative characteristics of other proposed 'key behaviors&quot; need to be compared. Can changes in worm behaviors in nutrient-rich vs depleted regions be quantified and fit into the model? Either of the two approaches or some combination of them is needed to show convincingly that the postulated behaviors are indeed observed and responsible for the observed population self-organization.</p><p>2) The authors discuss possible neuronal mechanisms underlying their behavioural rules. Ideally, it would be good to apply or at least suggest possible experimental tests of these mechanisms, in particular of the proposed important medium-range taxis between neighbouring worms. It is suggested that this might be O2 tension mediated: how might this be tested? They do provide convincing experiments that exclude any significant contribution of ascaroside pheromones to swarming.</p><p>Other comments:</p><p>- The work also mainly compares behaviour in the standard lab strain N2, which is 'hypo-social', to behaviour in a 'hyper-social' npr-1 mutant of N2. Neither of these exactly corresponds to the natural state of almost all wild <italic>C. elegans</italic>, so the analysis is somewhat artificial; this might be more explicitly admitted.</p><p>- The authors state that to their knowledge &quot;this swarming phenotype has not been reported in <italic>C. elegans</italic> previously&quot;, which betrays ignorance. For example, the following observation in Hodgkin and Barnes (2002, PMID: 1684664): &quot;When a population has consumed almost all the bacteria, the worms… form a swarming mass that moves as a wave across the remaining bacterial lawn, and then disperses when all the bacteria have been consumed.&quot; This indicates that N2 swarms under appropriate conditions, perhaps of higher bacterial food density. The authors' experiments were performed only on &quot;thin, even bacterial lawns&quot;.</p><p>- They also state that &quot;it is still unclear whether aggregation and swarming have a function in the wild&quot;. Swarming is almost certainly naturally advantageous in predation on pathogenic or repellent bacteria, as a result of the 'wolfpack' effect that has been studied in myxobacterial swarms, to which some reference should be made. This reviewer, and others working on interactions between <italic>C. elegans</italic> and soil bacteria, have often observed N2 swarming at the edge of unpalatable bacterial lawns. These swarms appear to allow the worms to overcome bacterial defences by collective action of digestive enzymes or other secretions.</p><p>- Do worms in the experiments move in purely 2D, i.e. never crawl on top of one another and never overlap? Is this true for the agents in the simulations?</p><p>- Better justification of the level of complexity chosen to model worms with agent-based approach is necessary. Why would simple &quot;vector particle&quot; models fail? How important is that each worm is multi-segmented? How important are the elastic properties of the worm? Does the assumption of the propulsive force generation at the head vs throughout the body affects the motion?</p><p>- By comparison with the bacterial literature, the term swarming used by the authors could be somewhat confusing (e.g. by comparison with the widespread phenomenon referred to as bacterial swarming, e.g. PMID: 20694026). It is also probably acceptable to use the term &quot;swarming&quot; in the worm field, but a clear definition should be added in the Introduction.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.43318.034</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Major points:</p><p>1) Importantly, the modeling approach could be improved given the wealth of the experimental data. Specifically, it is surprising that the authors chose a fully phenomenological approach to construct their agent-based models that uses very little of the quantified data.</p></disp-quote><p>We thank the reviewers for their suggestions, however we believe that a phenomenological approach is more appropriate in our case. We lack a single-worm model that is accurate and simple enough for inference. We have recently shown that we can simulate accurate locomotion using a neural network (https://www.biorxiv.org/content/10.1101/222208v1), but achieving this accuracy requires hundreds of parameters. We feel a more appropriate level of description for modeling collective worm behavior is the persistent random walk, which has previously been shown to work well for single-worm foraging (Salvador et al., 2014 – now cited in Appendix 1 under “self-propelled movement”). At the level of this more tractable effective model, we thoroughly considered previously available single worm data to parametrize the size of our agents, rates of slowing, and the duration of slow movement periods at zero neighbor density. Other data on the frequency of undulations and worm shapes were ultimately not considered, as we did not find them relevant to the aggregation mechanism (see for example Figure 6—figure supplement 2H, where we add undulations).</p><disp-quote content-type="editor-comment"><p>Furthermore, authors do little to quantitatively compare resulting behaviors of agents in the model to those of tracked worms. Therefore, the reviewers are not fully convinced that identified behaviors in the model are either necessary or sufficient (given considerable noise in individual behaviors) for the observed population behaviors.</p></disp-quote><p>To address the question of necessity of the observed behaviors, we have run additional simulations and added Figure 6—figure supplements 2 and 3 in response to the reviewers’ suggestion. Starting from parameter values obtained from the mean of the posterior distribution as a reference, we removed or perturbed individual model behaviors. These simulations show that removing speed switching or taxis from the model disrupts aggregation, while removing reversals reduces the overall quantitative agreement with experimental data (Figure 6—figure supplement 2B-D). In some cases, removing individual model behaviors also produces a different correlation of velocity and orientation between neighbors from what we measure in experiments (Figure 6—figure supplement 3).</p><disp-quote content-type="editor-comment"><p>To circumvent this issue, measured individual worm behaviors should be used in constructing and/or constraining their model (see for example References PMID: 30514635, PMID: 28533367).</p></disp-quote><p>We appreciate the reviewers’ suggestions and have considered this approach. However, we favor a Bayesian inference approach instead of feeding the model at every time-step with observed tracking data (which in our case is imperfect), as other work on bacterial systems has done, including the suggested references. The inference approach not only gives us the most likely model parameters and their uncertainty, but also has several additional advantages, such as providing information on model identifiability or “sloppiness”, automatically adjusting for model complexity when sampling in higher dimensional parameter spaces, and being easily extensible to incorporate multiple sources of experimental data. In response to your suggestions, we now discuss the data-driven approach as an alternative (Discussion, fourth paragraph).</p><disp-quote content-type="editor-comment"><p>Importantly, the noise and variability of the movement of agent match those of worms. It is not clear if this is the case in the current model.</p></disp-quote><p>Noise and variability of movement have indeed already been considered when parameterizing the angular noise of movement relative to the size of food patch. In our experiments, long-term persistence of movement is disrupted when worms reach the edge of the food lawn. Thus the noise parameter was chosen to ensure an almost complete reorientation (velocity autocorrelation of 0.23, corresponding to choosing a random angle between ± 3/4π) after a time it takes a single worm to move across a food lawn (about 25 seconds for <italic>npr-1</italic> mutants moving at 330 μm/s). This is described in Appendix 1 under “self-propelled movement” and the velocity autocorrelation for our simulation is in Figure 6—figure supplement 4A3. To further compare whether the noise and variability of movement matches that of worms in our experiments, we analyzed the velocity autocorrelation in our worm tracking data. These show similar decay in velocity autocorrelation for individually tracked <italic>npr-1</italic> and N2 worms (Figure 6—figure supplement 4A1), and a stronger decay for <italic>npr-1</italic> worms in 40-worm experiments (Figure 6—figure supplement 4A2). The latter are thus interacting and expected to have less persistent movement as a result. We have further verified that the model behavior is robust to changing the noise parameter to as low as 0 and as high as 0.08 (which roughly corresponds to the autocorrelation measured for interacting worms in our experiments (Figure 6—figure supplement 4A2); higher noise values not tested), as can be seen in Figure 6—figure supplement 2E-G. These results show that aggregation in our model is robust to noise.</p><disp-quote content-type="editor-comment"><p>Furthermore, comparison of the resulting behaviors of agents and worms would allow testing the model. For example, is there correlation (e.g. between the agent velocity and the vector to nearby worm) that can quantify the degree of taxis? Can this correlation be compared between the model and experiments?</p></disp-quote><p>We have calculated the correlation of agent velocity and the vector to nearby worms to quantify the degree of taxis (Figure 6—figure supplement 3B). In our experiments, this correlation is nearly zero for all distances up to 2 mm, which is larger than the size of a typical worm cluster. This may not be intuitive, but the correlation was comparably low when we quantified the same statistic in our simulations, which have a low but non-zero taxis parameter. We suspect the reason is twofold: a) the taxis effect is only a small influence on the instantaneous direction of movement of a worm, compared to persistence and noise; and b) we only tracked the pharynx in our experiments, and reproduced this restriction in our analysis of simulations, but the whole body of the worm is likely giving relevant cues to any chemical or mechanical taxis. This brings with it the caveat that there is unseen worm density that affects any potential taxis behavior, but which remains undetectable in our tracking. Thus, our analysis shows that the attractive taxis is important for aggregation and may be non-zero (as it is in the parameterized simulations), even if it is difficult to detect with correlation analysis. Our modeling approach thus clearly predicts taxis, or a phenomenologically equivalent behavior, to be an important factor in aggregation, while our analysis also shows that this would have likely been missed by a purely data-driven approach.</p><disp-quote content-type="editor-comment"><p>Similar quantitative characteristics of other proposed 'key behaviors&quot; need to be compared.</p></disp-quote><p>We now compare our inferred parameters for reversal and speed switching rates with our measured data (Figure 6—figure supplement 4B-C). The agreement of the reversal rate is imperfect, which may be in part due to the sensitivity of experimental analysis. When quantifying reversals, we had to make a choice as to when a reversal is substantial enough, for which we imposed a minimum absolute speed and a total path length of the reversal of 50 μm (roughly one worm width). Shorter reversals may more likely be due to noisy tracking or small head-movements. However, many reversals are not tracked from the beginning to the end, especially at higher densities; therefore any threshold on path length may falsely exclude partially tracked reversals.</p><p>To compare speed switching rates <italic>k</italic><sub>f</sub> and <italic>k</italic><sub>s</sub>, we unfortunately cannot reliably measure these experimentally. However, we have quantified the ratio of worms moving at fast (up to 350 μm/s) versus slow (&lt;100 μm/s for <italic>npr-1</italic>, &lt;50 μm/s for N2) speeds in experiments and simulations at various local densities. The disagreement (Figure 6—figure supplement 4C) may indicate that the exponential form of <italic>k<sub>f</sub>(ρ</italic>) (see Figure 5C and main text) is not the best approximation. However, aggregation in the model is not sensitive to speed switching rates, as shown by the broad posterior distributions for the inferred parameters (Figure 6C-D), thus we leave it for future work to consider different functional forms of <italic>k</italic><sub>f</sub>(<italic>ρ</italic>).</p><disp-quote content-type="editor-comment"><p>Can changes in worm behaviors in nutrient-rich vs depleted regions be quantified and fit into the model?</p></disp-quote><p>We have used the fact that worms speed up when off food to demonstrate that the aggregation mechanism also leads to swarming, and the fact that movement on food is persistent in order to parameterize noise for the model. Otherwise, our model mostly concerns on-food behavior, as 99.7 ± 0.4% (<italic>npr-1</italic>, mean ± S.D.) and 99.8 ± 0.3% (N2, mean ± S.D.) of the worms are on food during the aggregation phase of the experiments.</p><disp-quote content-type="editor-comment"><p>Either of the two approaches or some combination of them is needed to show convincingly that the postulated behaviors are indeed observed and responsible for the observed population self-organization.</p></disp-quote><p>As described above, we have kept the phenomenological model construction and Bayesian parameter inference approaches, but have now added substantial quantitative comparisons between experimental and theoretical outcomes to better illustrate the utility and limitations of our model.</p><disp-quote content-type="editor-comment"><p>2) The authors discuss possible neuronal mechanisms underlying their behavioural rules. Ideally, it would be good to apply or at least suggest possible experimental tests of these mechanisms, in particular of the proposed important medium-range taxis between neighbouring worms. It is suggested that this might be O2 tension mediated: how might this be tested? They do provide convincing experiments that exclude any significant contribution of ascaroside pheromones to swarming.</p></disp-quote><p>We have now suggested several experiments to test the neuronal mechanisms underlying our core behavioral components (Discussion, third paragraph). To elucidate the role of a shallow oxygen gradient in taxis, we suggest introducing mutations leading to aerobic metabolism deficiencies into <italic>npr-1</italic> mutants. Such mutants would still be able to sense ambient oxygen, but are expected to produce an even weaker oxygen gradient in an aggregate. A quantitative comparison of the resulting phenotype to model predictions (e.g. with reduced taxis and/or modified rates of density-dependent reversal and speed switching) would be informative. Additionally, one may perform aerotaxis and oxygen-shift experiments (using a much smaller oxygen gradient than previous works have used) to seek evidence for the ability of worms to sense and move towards environments where oxygen levels are only slightly below ambient concentrations. We also discuss the possibility of perturbing reversals and speed-switching rates using mutations.</p><disp-quote content-type="editor-comment"><p>Other comments:</p><p>- The work also mainly compares behaviour in the standard lab strain N2, which is 'hypo-social', to behaviour in a 'hyper-social' npr-1 mutant of N2. Neither of these exactly corresponds to the natural state of almost all wild <italic>C. elegans</italic>, so the analysis is somewhat artificial; this might be more explicitly admitted.</p></disp-quote><p>We have now added relevant wording to emphasize that <italic>npr-1</italic> and N2 worms show extreme aggregation phenotypes (Discussion, final paragraph).</p><disp-quote content-type="editor-comment"><p>- The authors state that to their knowledge &quot;this swarming phenotype has not been reported in <italic>C. elegans</italic> previously&quot;, which betrays ignorance. For example, the following observation in Hodgkin and Barnes (2002, PMID: 1684664): &quot;When a population has consumed almost all the bacteria, the worms… form a swarming mass that moves as a wave across the remaining bacterial lawn, and then disperses when all the bacteria have been consumed.&quot; This indicates that N2 swarms under appropriate conditions, perhaps of higher bacterial food density. The authors' experiments were performed only on &quot;thin, even bacterial lawns&quot;.</p></disp-quote><p>We have now included the fact that N2 swarms under appropriate conditions in our text (Results, first paragraph). We have also modified our text in appropriate places to clarify that swarming in this paper refers to that of <italic>npr-1</italic> mutants.</p><disp-quote content-type="editor-comment"><p>- They also state that &quot;it is still unclear whether aggregation and swarming have a function in the wild&quot;. Swarming is almost certainly naturally advantageous in predation on pathogenic or repellent bacteria, as a result of the 'wolfpack' effect that has been studied in myxobacterial swarms, to which some reference should be made. This reviewer, and others working on interactions between <italic>C. elegans</italic> and soil bacteria, have often observed N2 swarming at the edge of unpalatable bacterial lawns. These swarms appear to allow the worms to overcome bacterial defences by collective action of digestive enzymes or other secretions.</p></disp-quote><p>We thank the reviewers for sharing these insights and have now included them (Discussion, sixth paragraph). While swarming may be likely to have an ecological role, without a better understanding of the fitness effects and indeed whether it occurs in nature, we would prefer to remain cautious about the function of aggregation and swarming.</p><disp-quote content-type="editor-comment"><p>- Do worms in the experiments move in purely 2D, i.e. never crawl on top of one another and never overlap? Is this true for the agents in the simulations?</p></disp-quote><p>In our experiments, worms move in 2D on agar and rarely burrow. When multiple worms are interacting, they can be observed to crawl over each other, whilst also restricting each other’s movement. This phenomenology does not perfectly correspond to full volume exclusion or free overlap, and thus is difficult to implement in simulations. We chose not to enforce volume exclusion as we suspect the degree of overlap between worms in aggregates to be considerable. Thus, the worms can also overlap in the model, although with taxis direct overlap is discouraged – the direction of taxis reverses (becomes repulsive) if worms overlap, which was chosen to reflect some extent of physical hindrance. We had originally also tried simulations with volume exclusion, but had chosen not to show these as it was not required to achieve aggregation and the aggregates seemed more spread out than in experiments. We now show an example of this in Figure 6—figure supplement 5B.</p><disp-quote content-type="editor-comment"><p>- Better justification of the level of complexity chosen to model worms with agent-based approach is necessary. Why would simple &quot;vector particle&quot; models fail? How important is that each worm is multi-segmented? How important are the elastic properties of the worm? Does the assumption of the propulsive force generation at the head vs throughout the body affects the motion?</p></disp-quote><p>Simple vector-particle models would not have a front and back to detect when particles are exiting a cluster, which seems to be an important behavioral trigger. Though this could be fixed by including a memory, a particle leaving an aggregate ceases to be an interaction partner for particles in the aggregate unless there are long-range interactions. We chose agents with a long shape as we were initially looking for purely local (i.e. short range) interactions that lead to clustering. However, we believe this is still close in simplicity to the “vector particle” model, as our simulated worms really are just “vector particles with a tail”, or equivalently, a chain of vector particles.</p><p>The multi-segmented representation of the worms in our model may not be essential, and we suspect that equivalent phenomenology could be captured with rigid rods and different inferred parameters, as long as the rods are allowed to overlap. However, rigid rods have the undesirable property that the tail swings out upon turning, which is not observed in worms. Hence, we chose a persistent random walker with a tail as a more plausible representation in our current approach.</p><p>In the model presented here, elastic effects play no importance apart from enforcing non-extensibility of the chain-like worms.</p><p>The propulsive force is not generated only at the head; rather, each node of the chain is a self-propelled particle. The head node undergoes a persistent random walk, whereas the other nodes follow the line of the body (and all nodes are subject to non-extensibility constraints). These are described in Figure 5A legend and Appendix 1 under “SPP worm model”.</p><p>To investigate whether our model still works with simplified agents, we ran further simulations (starting from the posterior mean parameterization for <italic>npr-1</italic>) with fewer nodes per worm (and correspondingly shorter total worm length, because the size of the nodes was not changed to keep the width the same). We found that aggregation was robust to shortening worms up to a point (Figure 6—figure supplement 5A). With 4 nodes per worm aggregation only formed transiently and with fewer worms per aggregate, indicating that the worms need to be longer than this threshold length. This can be explained by the fact that at this worm length, the interaction radii (set to 3 node radii) of the head and tail nodes start to overlap, and in our simulations worms require a difference in contact between head and tail to initiate reversals. Thus, as worms become shorter than <italic>M</italic>=5 nodes, the head and tail nodes increasingly have the same degree of contact within a cluster, and thus more often fail to sense when they are exiting a cluster (while also having a shorter time window in which to initiate a reversal whilst leaving a cluster).</p><disp-quote content-type="editor-comment"><p>- By comparison with the bacterial literature, the term swarming used by the authors could be somewhat confusing (e.g. by comparison with the widespread phenomenon referred to as bacterial swarming, e.g. PMID: 20694026). It is also probably acceptable to use the term &quot;swarming&quot; in the worm field, but a clear definition should be added in the Introduction.</p></disp-quote><p>We have added an operational definition for <italic>C. elegans</italic> swarming (Results, first paragraph).</p></body></sub-article></article>