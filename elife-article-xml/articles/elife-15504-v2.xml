<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">15504</article-id><article-id pub-id-type="doi">10.7554/eLife.15504</article-id><article-categories><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Continuous lateral oscillations as a core mechanism for taxis in <italic>Drosophila</italic> larvae</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-53234"><name><surname>Wystrach</surname><given-names>Antoine</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-44423"><name><surname>Lagogiannis</surname><given-names>Konstantinos</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9349-801X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-53232"><name><surname>Webb</surname><given-names>Barbara</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">School of Informatics</institution>, <institution>University of Edinburgh</institution>, <addr-line><named-content content-type="city">Edinburgh</named-content></addr-line>, <country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Centre de recherche sur la cognition animal</institution>, <institution>CNRS, Universite de Toulouse</institution>, <addr-line><named-content content-type="city">Toulouse</named-content></addr-line>, <country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>VijayRaghavan</surname><given-names>K</given-names></name><role>Reviewing editor</role><aff id="aff3"><institution>Tata Institute for Fundamental Research</institution>, <country>India</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>klagogia@inf.ed.ac.uk</email></corresp><fn fn-type="con" id="equal-contrib"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>18</day><month>10</month><year>2016</year></pub-date><pub-date pub-type="collection"><year>2016</year></pub-date><volume>5</volume><elocation-id>e15504</elocation-id><history><date date-type="received"><day>24</day><month>02</month><year>2016</year></date><date date-type="accepted"><day>17</day><month>10</month><year>2016</year></date></history><permissions><copyright-statement>© 2016, Wystrach et al</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Wystrach et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-15504-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.15504.001</object-id><p>Taxis behaviour in <italic>Drosophila</italic> larva is thought to consist of distinct control mechanisms triggering specific actions. Here, we support a simpler hypothesis: that taxis results from direct sensory modulation of continuous lateral oscillations of the anterior body, sparing the need for ‘action selection’. Our analysis of larvae motion reveals a rhythmic, continuous lateral oscillation of the anterior body, encompassing all head-sweeps, small or large, without breaking the oscillatory rhythm. Further, we show that an agent-model that embeds this hypothesis reproduces a surprising number of taxis signatures observed in larvae. Also, by coupling the sensory input to a neural oscillator in continuous time, we show that the mechanism is robust and biologically plausible. The mechanism provides a simple architecture for combining information across modalities, and explaining how learnt associations modulate taxis. We discuss the results in the light of larval neural circuitry and make testable predictions.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.001">http://dx.doi.org/10.7554/eLife.15504.001</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>Drosophila Larva</kwd><kwd>taxis</kwd><kwd>sensorimotor loop</kwd><kwd>neural oscillator</kwd><kwd>insect orientation</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004963</institution-id><institution>Seventh Framework Programme</institution></institution-wrap></funding-source><award-id>FP7-618045</award-id><principal-award-recipient><name><surname>Wystrach</surname><given-names>Antoine</given-names></name><name><surname>Lagogiannis</surname><given-names>Konstantinos</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Analysis of crawling <italic>Drosophila</italic> larva and agent based simulations suggest that an intrinsic rhythm rather than distinct actions underlie taxis behaviour, providing a core mechanism on which both sensory and memory pathways can converge.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The larvae of <italic>Drosophila</italic> display taxis behaviours by spontaneously crawling towards or away from the source of stimuli such as odours, or more generally, up or down stimulus gradients, including chemical, light and temperature gradients (<xref ref-type="bibr" rid="bib46">Luo et al., 2010</xref>; <xref ref-type="bibr" rid="bib25">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib23">Gomez-Marin and Louis, 2012</xref>; <xref ref-type="bibr" rid="bib24">Gomez-Marin and Louis, 2014</xref>; <xref ref-type="bibr" rid="bib33">Kane et al., 2013</xref>; <xref ref-type="bibr" rid="bib36">Klein et al., 2015</xref>). This behavioural tendency is flexible and can be altered by associative learning if the stimulus is presented together with a positive or negative reinforcer (<xref ref-type="bibr" rid="bib57">Scherer et al., 2003</xref>; <xref ref-type="bibr" rid="bib20">Gerber et al., 2004</xref>; <xref ref-type="bibr" rid="bib1">Ache and Young, 2005</xref>; <xref ref-type="bibr" rid="bib15">Diegelmann et al., 2013</xref>; <xref ref-type="bibr" rid="bib58">Schleyer et al., 2015a</xref>). The development of both a rich genetic manipulation toolkit and sophisticated behavioural assays have provided the basis for a recent explosion of studies targeting the biological underpinnings of larval taxis, as an ideal model system for investigating the neural basis of sensorimotor control and learning.</p><p>Larval chemotaxis, in particular, has been extensively studied. The main chemosensory organ is located on the head, and the small spatial separation of the bilateral olfactory receptors makes it unlikely that the animal can detect the instantaneous odour gradient. In fact, it has been shown that larvae can still chemotax with a single active receptor (<xref ref-type="bibr" rid="bib17">Fishilevich et al., 2005</xref>; <xref ref-type="bibr" rid="bib22">Gomez-Marin et al., 2010</xref>; <xref ref-type="bibr" rid="bib45">Louis et al., 2008</xref>). The key information used by the larva appears to be the change in odour concentration experienced as it moves forward and/or casts its head sideways (<xref ref-type="bibr" rid="bib22">Gomez-Marin et al., 2010</xref>). Olfactory sensory neurons are well suited to carry this information as they have been shown to give strong transient responses during changes in odour concentration (<xref ref-type="bibr" rid="bib14">De Palo et al., 2013</xref>; <xref ref-type="bibr" rid="bib48">Nagel and Wilson, 2011</xref>; <xref ref-type="bibr" rid="bib35">Kim et al., 2011</xref>; <xref ref-type="bibr" rid="bib60">Schulze et al., 2015</xref>) and the frequency and direction of turns (large body bends leading to a new trajectory direction) appears correlated to decreases or increases in the perceived concentration (<xref ref-type="bibr" rid="bib29">Hernandez-Nunez et al., 2015</xref>; <xref ref-type="bibr" rid="bib60">Schulze et al., 2015</xref>). Other sensory modalities could in principle use spatially separated sensors to detect instantaneous gradients across the body to direct steering, but recent studies reveal substantial similarity in the characteristics of larval taxis behaviour across different modalities (<xref ref-type="bibr" rid="bib19">Gepner et al., 2015</xref>; <xref ref-type="bibr" rid="bib4">Bellmann et al., 2010</xref>; <xref ref-type="bibr" rid="bib40">Lahiri et al., 2011</xref>). This suggests it may be possible to provide a more general account that elucidates the nature of the sensory-motor transformation during all forms of taxis, and how multiple stimuli combine.</p><p>Several models have been designed to capture quantitatively the observed larval behaviour during its approach to an odour source (<xref ref-type="bibr" rid="bib13">Davies et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Hernandez-Nunez et al., 2015</xref>; <xref ref-type="bibr" rid="bib58">Schleyer et al., 2015a</xref>; <xref ref-type="bibr" rid="bib19">Gepner et al., 2015</xref>). These models typically assume the expression of taxis consists of multiple behavioural states with state transitions that are biased by sensory stimuli. In <xref ref-type="bibr" rid="bib13">Davies et al. (2015)</xref>; a model closely based on the behavioural analyses in <xref ref-type="bibr" rid="bib40">Lahiri et al. (2011)</xref>; <xref ref-type="bibr" rid="bib24">Gomez-Marin and Louis (2014)</xref>; <xref ref-type="bibr" rid="bib25">Gomez-Marin et al. (2011)</xref>; <xref ref-type="bibr" rid="bib50">Ohashi et al. (2014)</xref> reproduces many characteristics of larval chemotaxis by combining three mechanisms: biased forward runs (weathervaning), increased probability to stop runs when odour concentration decreases (klinokinesis), and increased probability to resume running when a head cast is in a direction that increases the experienced odour concentration (klinotaxis). Each contributes to the improvement of odour taxis performance, and in theory, each could be individually modulated by sensory stimuli characteristics, context, other stimuli, or learning, in a manner that modifies the observed odour preferences. However, behavioural observation shows rather strong similarities in the behavioural modulations resulting from apparently unrelated conditions, such as odour-tastant associative learning and variation of stimulus concentration (<xref ref-type="bibr" rid="bib58">Schleyer et al., 2015a</xref>), which simultaneously modulate both the klinokinetic and klinotactic responses (weathervaning was not assessed in this study). Also, a recent attempt to categorise larval behavioural states using an unsupervised method based on the animal’s posture suggests the existence of a continuum rather than clear-cut categories (<xref ref-type="bibr" rid="bib61">Szigeti et al., 2015</xref>).</p><p>It remains possible that the apparent repertoire of taxis behaviours seen in the larvae is, in fact, the result of a single underlying mechanism. In this paper, we take a bottom-up, synthetic approach (<xref ref-type="bibr" rid="bib7">Braitenberg, 1986</xref>) to investigate whether a simpler sensorimotor control scheme can give rise to the observed phenomena of taxis. We combined a detailed observation of the larva’s crawling motions with an agent-based simulation to explore the behaviours that can emerge from the interaction between brain, body, and environment.</p><p>Specifically, inspired by the description in larvae of frequent low amplitude head sweeps, which modulate run direction (<xref ref-type="bibr" rid="bib24">Gomez-Marin and Louis, 2014),</xref> and the idea that closed-loop sensory modulation of an intrinsic motor pattern can be a particularly efficient neural mechanism for flexible behavioural control (<xref ref-type="bibr" rid="bib32">Izquierdo and Lockery, 2010</xref>; <xref ref-type="bibr" rid="bib34">Kanzaki, 1996</xref>; <xref ref-type="bibr" rid="bib44">Levi et al., 2005</xref>; <xref ref-type="bibr" rid="bib66">Willis and Arbas, 1997b</xref>), we investigated the hypothesis that taxis in larvae results from continuous anterior body oscillations modulated by immediate sensory inputs.</p><p>Our analysis reveals that larvae indeed display continuous anterior body oscillation. We show, in both a simple discrete-time model and a neural model in continuous time, that direct sensory modulation of oscillation amplitude is sufficient to reproduce many specific larval taxis signatures, without requiring specific parameter tuning to different conditions. Finally, we discuss the biological relevance of our proposed mechanism and how it could provide a simple and robust solution for combining information across modalities, or from learnt and innate pathways, to modulate taxis.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Evidence for continuous anterior body oscillation in larvae</title><p>We used previously recorded tracks of 42 wild-type larvae performing innate chemotaxis (<xref ref-type="bibr" rid="bib25">Gomez-Marin et al., 2011</xref>) to analyse the body-bend, the anterior body angular velocity and the forward speed. This reveals a continuous alternation between left and right turns, which appears most clearly in the angular velocity of the anterior part of the body (<xref ref-type="fig" rid="fig1">Figure 1A</xref> ‘blue line’). Larvae are known to regularly stop their forward peristalsis motion and display large lateral head sweeps (<xref ref-type="bibr" rid="bib25">Gomez-Marin et al., 2011</xref>). A closer look shows that these head sweeps do not seem to break the continuous alternation between left and right turns, i.e., if the larva’s head was moving left before stopping the peristalsis motion, the first head sweep after stopping will be to the right, and vice versa (<xref ref-type="fig" rid="fig1">Figure 1B</xref> and <xref ref-type="fig" rid="fig2">Figure 2A,B</xref>). Thus, these head sweeps appear to be part of a continuous oscillation rather than individual motor actions triggered independently. Also, the distribution of body bending, anterior body angular velocity and acceleration, as well as the extent of each lateral oscillation of the anterior body, show a smooth curve with no signs of bimodality (<xref ref-type="fig" rid="fig2">Figure 2D</xref>) suggesting a continuum of turning modulation rather than a discrete set of distinguishable actions.<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.15504.002</object-id><label>Figure 1.</label><caption><title>Examples of individual larva motion dynamics during chemotaxis show lateral oscillations.</title><p>Left side panels show the angular speed of the anterior part of the body (blue), body bending (black), and peristaltic steps (grey dotted lines) based on tail speed (green) corresponding to the paths shown on the right. Events of interest are labeled by numbers. (<bold>A</bold>) Path section with no peristalsis inhibition. The larva shows a continuous alternation between left and right, but turning is biased in both amplitude and duration towards positive angles, resulting in a left curve. (<bold>B</bold>) Path section with an intermediate (1) and two stronger (2 and 3) peristalsis inhibition events that do not interrupt the turning alternation. (<bold>C</bold>) Path section with a peristalsis inhibition event covering two successive turns (4 and 5). The green vertical bars (1 and 2) indicate moments at which the body bending decreases (from left to right) even though the larva anterior body is still slightly swinging towards the left. This is due to the simultaneous forward peristalsis motion bringing the posterior part of the body towards the axis of the anterior part. The angular speed of the anterior body provides thus a better proxy than body bend to infer the control commands involved. (<bold>B</bold>,<bold>C</bold>) Red dotted lines indicate the onset of peristalsis inhibition (conservatively late measure) which occurs before any strong changes in angular speed or body bending.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.002">http://dx.doi.org/10.7554/eLife.15504.002</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-15504-fig1-v2"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.15504.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Peristalsis and lateral oscillation rhythms appear decoupled.</title><p>(<bold>A</bold>) During forward crawling, the speed of the tail, middle spine point and head show a strongly correlated rhythm characteristic of the peristalsis motion (note that some individuals display a continuous alternation between a strong and a weak step). We used tail speed to characterise peristalsis motion as it is the least sensitive to the lateral motion of the anterior body. (<bold>B</bold>,<bold>C</bold>) Anterior body angular velocity and, to a lesser extent body bending, are representative of the rhythmic activity of the continuous lateral oscillations displayed by the larva (see <xref ref-type="fig" rid="fig3">Figure 3</xref>). However, the distribution of anterior body angular velocities (<bold>B</bold>); and body bending angles (<bold>C</bold>) is similar whether sampled across all frames or during specific phases of the peristalsis rhythm, such as peaks of tail speed. (<bold>D</bold>) Similarly, the distribution of tail speed during forward motion (tail speed &lt; 0.4) is similar whether sampled across all frames or during specific phases of the anterior body angular velocity and body bending activities. Together with the fact the mean frequencies of the two rhythms are not harmonics (<xref ref-type="fig" rid="fig3">Figure 3D</xref>), this suggests that that the peristalsis and lateral oscillation rhythms are generated independently.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.003">http://dx.doi.org/10.7554/eLife.15504.003</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-15504-fig1-figsupp1-v2"/></fig></fig-group><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.15504.004</object-id><label>Figure 2.</label><caption><title>Group statistics of larva motion dynamics during chemotaxis support the existence of an intrinsic lateral oscillatory rhythm.</title><p>(<bold>A</bold>,<bold>B</bold>) Average (±95%CI) dynamics of the anterior body angular velocity (blue), body bending (black) and tail velocities (green) displayed before and after the onset of peristalsis inhibition events aligned at <inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (dashed red line, when tail speed drops to a minimum), and categorised according to whether the larva is sweeping towards the left (<bold>A</bold>) or right (<bold>B</bold>) at <inline-formula><mml:math id="inf2"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Drops in forward crawling speed tend to be accompanied by a large head sweep, as shown previously (<xref ref-type="bibr" rid="bib29">Hernandez-Nunez et al., 2015</xref>) (see <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Large head sweeps are preceded by low-amplitude head casts in the opposite direction (arrows), suggesting the large head cast direction is dependent on the state of the oscillation. (<bold>C</bold>) Fourier analysis of the angular velocity of the anterior body (blue) and tail speed (green) across all larvae (see inset for a single individual). Tail speed (peristalsis) rhythm is fairly constant across larvae at around 1.0 Hz, with slight harmonics of the tail speed at 0.5 Hz, which results from the tendency of some larvae to alternate continuously between a weaker and stronger peristalsis wave (see <xref ref-type="fig" rid="fig1">Figure 1A</xref>'s tail speed for an example). The angular velocity of the anterior body (blue) shows a slower rhythm than the peristalsis, with a higher variation across and within individuals. Note that the rhythms are not multiples of each other, suggesting that they are operating independently (see also <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). (<bold>D</bold>) Distributions of markers of the anterior body sweeps (see inset for logarithmic scale) reveal no sign of bimodality, suggesting a continuum of turning modulations rather than the triggering of distinct specific actions. (<bold>E</bold>,<bold>F</bold>) Distributions of individual head-sweep’s duration (<bold>E</bold>) and maximum angular speed (<bold>F</bold>). Head sweeps are defined as the period between the two successive points in time where the anterior body angular speed crosses zero. (<bold>F</bold>) Head sweeps tend to reach higher angular velocity during stop phases (dash grey) than during crawling phases (grey) (i.e. when tail speed average during head sweep is &lt;0.3 mm/s and &gt;0.7 mm/s, respectively). (<bold>E</bold>) Head sweep durations can vary; however, the distributions of duration are similar during stop phases (dash grey) and forward crawling phases (grey), suggesting a shared underlying oscillatory rhythm (<bold>E</bold>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.004">http://dx.doi.org/10.7554/eLife.15504.004</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-15504-fig2-v2"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.15504.005</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Correlation of head sweep statistics to tail speed.</title><p>Head sweep statistics [from left to right: anterior body angular velocity; body bending; extent of anterior body turns (i.e. angular extent from one side to the other) and anterior body angular acceleration] are plotted against tail speed for a random selection of points across all larvae track (blue). Full red line shows the ratio of data that are higher than the current <inline-formula><mml:math id="inf3"><mml:mi>x</mml:mi></mml:math></inline-formula> value. Black line shows the ratio of such data (higher than current <inline-formula><mml:math id="inf4"><mml:mi>x</mml:mi></mml:math></inline-formula> value) that are below the tail speed threshold (black dash line). Tail speed below the threshold is considered as a proxy for peristalsis inhibition. Peristalsis inhibition correlates well with high head-sweep velocity, acceleration, and angular extent. However, large body-bending is a less powerful predictor of peristalsis inhibition. This suggests that peristalsis inhibition is not a mere physical consequence of large body bending. Rather, peristalsis inhibition seems controlled by a signal sent simultaneously to the signal modulating lateral oscillations.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.005">http://dx.doi.org/10.7554/eLife.15504.005</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-15504-fig2-figsupp1-v2"/></fig></fig-group></p><p>A Fourier analysis confirms the existence of an oscillatory rhythm with a mean frequency around 0.3 Hz; that is roughly one turn left and one turn right every 3.3 s (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, blue). This turning oscillation seems decoupled from the peristalsis motion (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), which operates around a mean frequency of 1.1 Hz (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, green). The peristalsis rhythm appears remarkably constant, perhaps because of biomechanical constraints (<xref ref-type="bibr" rid="bib54">Ross et al., 2015</xref>). Therefore, a direct coupling between peristalsis and turning oscillation would constrain the larvae to spend as much time sweeping left as sweeping right, which would restrict the flexibility in trajectory alterations. By having the lateral oscillations decoupled from peristalsis, however, the relative duration between left and right sweeps can vary. This is indeed what we observed in larvae. A curving path to the left for instance, is achieved by spending slightly more time (and also increasing the angular speed of the head sweep) sweeping left than sweeping right (<xref ref-type="fig" rid="fig1">Figure 1A</xref> ‘blue region’: Time spent turning right = 12.9 s; Time spent turning left = 22.9 s; Ratio right/left = 0.64. Integral left = 179.3 degrees; Integral right = −64.6 degrees; Total = 114.7 degrees left; Ratio right/left = 0.73). Even-though larvae show larger and quicker head sweeps when the peristalsis motion has stopped (<xref ref-type="fig" rid="fig2">Figure 2F</xref>), the head sweep duration is similar between crawling phases and stop phases (<xref ref-type="fig" rid="fig2">Figure 2E</xref>), suggesting again the existence of a shared underlying oscillatory rhythm.</p><p>To summarise, our observations support the hypothesis that a continuous lateral oscillation of the anterior body sits at the core of the chemotaxis mechanism, and that its rhythm is decoupled to the peristaltic rhythm thus allowing more freedom to adjust the head-turning velocity and amplitude.</p></sec><sec id="s2-2"><title>Hypotheses and modelling assumptions</title><p>We embedded the idea that continuous lateral oscillation of the anterior body sit at the core of the taxis mechanism in two simple agent-based models, one running in discrete and the other in continuous time. Our hypotheses are:</p><list list-type="bullet"><list-item><p>‘Small amplitude head-casts’ and ‘large amplitude head-casts’ (<xref ref-type="bibr" rid="bib24">Gomez-Marin and Louis, 2014</xref>) are manifestations of a single underlying mechanism that continuously drives a lateral oscillation of the anterior body (head casts).</p></list-item><list-item><p>The <italic>direction</italic> (left or right) of a head-cast at a given time-step is determined only by the current state of an intrinsic oscillator rather than the sensory input or its history, or an active choice by the larva to probe the environment.</p></list-item><list-item><p>The <italic>amplitude</italic> of each of these alternating head-casts is continuously modulated by the stimulus perceived.</p></list-item></list><p>We sought to simplify our models as far as possible so as to establish the nature of the essential sensorimotor components that could underlie the emergence of chemotactic signatures observed in larvae. Our implemented models therefore also make the following simplifying assumptions:</p><list list-type="bullet"><list-item><p>Stopping (inhibition of forward peristalsis) is not essential for taxis, except insofar as it aids reorientation by enabling larger turns or tighter curvature of paths. Hence, we neglect stops, and in our model, the agent is continuously stepping forward, even when displaying large turns. Note that we address the limits of this assumption, and how stopping could be introduced to the model, in the discussion.</p></list-item><list-item><p>As the anterior body bearing determines the forward step direction in larvae, we assume it is the crucial variable for taxis, and not the actual bend of the body. Therefore, we limit our model to a single oriented point in space, representing the position of the larva as a whole along with its current bearing. The control mechanism then determines the trajectory of that point through space. This way of abstracting the larval trajectory has been previously used in biological analysis (<xref ref-type="bibr" rid="bib45">Louis et al., 2008)</xref> and enables us to compare our model to larval trajectory statistics.</p></list-item></list></sec><sec id="s2-3"><title>A simple oscillatory agent reproduces taxis</title><p>We first embedded the above ideas into a discrete-time agent (see 'Materials and methods'). At each time-step, the point agent rotates on the spot (by an amount <inline-formula><mml:math id="inf5"><mml:mi>α</mml:mi></mml:math></inline-formula>, see <xref ref-type="fig" rid="fig3">Figure 3A</xref>, grey arrow) and makes a step forward of a fixed size <inline-formula><mml:math id="inf6"><mml:mi>λ</mml:mi></mml:math></inline-formula> = 1 mm in this new direction (<xref ref-type="fig" rid="fig3">Figure 3A</xref>).<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.15504.006</object-id><label>Figure 3.</label><caption><title>Discrete-time agent model.</title><p>(<bold>A</bold>) The agent consists of an oriented point (black dot) from which the odour concentration is sampled, the grey arrow indicates its orientation and the red line indicates the motion trail. At each time step, the agent performs a rotation (<inline-formula><mml:math id="inf7"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>α</mml:mi><mml:mo>≤</mml:mo><mml:mn>180</mml:mn></mml:mrow></mml:math></inline-formula> deg) on the spot alternating between left and right rotations (‘L’ and ‘R’) so as to set a new orientation (grey arrow), and then moves forward by 1 mm. (<bold>B</bold>) In the absence of stimulation, the extent of this rotation is set according to a constant baseline <inline-formula><mml:math id="inf8"><mml:msub><mml:mi>θ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> (typically <inline-formula><mml:math id="inf9"><mml:msub><mml:mi>θ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> =10 deg), which is alternated between L and R causing movement in a zig-zag fashion. In the presence of stimulation, the extent of the rotation (e.g., towards the right) is modulated by the change of stimulus intensity (blue line, <inline-formula><mml:math id="inf10"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>) perceived between the previous <inline-formula><mml:math id="inf11"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and current <inline-formula><mml:math id="inf12"><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> position. The modulation is simplified down to a linear constant gain <inline-formula><mml:math id="inf13"><mml:mi>g</mml:mi></mml:math></inline-formula>; so that the extent of the rotation (here towards the right) is: <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. As a result, when <inline-formula><mml:math id="inf15"><mml:mrow><mml:mi>g</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, an increase in stimulus intensity perceived (<inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) would decrease the extent of the rotation towards 0 degrees (i.e. the agent goes straight), whereas a decrease in stimulus intensity perceived (<inline-formula><mml:math id="inf17"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), would increase the rotation up towards 180 degrees (i.e. agent makes a U-turn). Effectively, a negative gain (<inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>g</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) yields attraction towards higher stimulus intensity. Inversely, a positive gain (<inline-formula><mml:math id="inf19"><mml:mrow><mml:mi>g</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) yields aversion (<bold>D</bold>) (<inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> results in neither). (<bold>C</bold>,<bold>D</bold>) Section path examples from agent simulation in an odour gradient, with line colours as in (<bold>A</bold>). The underlying dark continuous line indicates the overall path taken by the agent. The blue lines indicate the isoclines of the odour concentration.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.006">http://dx.doi.org/10.7554/eLife.15504.006</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-15504-fig3-v2"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.15504.007</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Model’s robustness to change in baseline angle.</title><p>The baseline angle corresponds to the extent of the spontaneous lateral oscillatory turns effected in the absence of sensory stimulation. In our abstract model, the baseline is set to 10 degrees to fit roughly the data observed in larvae, but taxis emerges even for extreme values such as 160 degrees, showing that the principle behind our model (i.e. sensory modulation of continuous lateral oscillation) provides a robust way of achieving taxis. Up-regulating turn towards 180 degrees (i.e. when a negative transient is perceived) appears more important than down-regulating turn towards 0 degrees (i.e. when a positive transient is perceived); however, taxis still emerges by only down-regulating turns when the baseline angle is large and leaves enough range for modulation. We have reasons to think that larvae achieve taxis by dual regulation, that is, by performing both up-regulation and down-regulation of turns (see for Discussion our supplemental text: ‘Depolarisation and hyperpolarisation rather than ON and OFF cells’).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.007">http://dx.doi.org/10.7554/eLife.15504.007</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-15504-fig3-figsupp1-v2"/></fig></fig-group></p><p>The <italic>direction</italic> of these re-orientations alternates between left and right on each time-step (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). This represents the continuous heading oscillation observed in larvae (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p><p>The <italic>amplitude</italic> (<inline-formula><mml:math id="inf21"><mml:mi>α</mml:mi></mml:math></inline-formula>) of these left/right alternating re-orientations is bounded from above and below (<xref ref-type="disp-formula" rid="equ2">Equation 7</xref>). For most results reported in this paper the lower bound is 0 degrees (prevents a ‘right’ turn becoming a ‘left’ turn or vice versa) and the upper bound 180 degrees to represent the maximum possible re-orientation given the larva body bending constraints (<xref ref-type="fig" rid="fig3">Figure 3A,B</xref> dashed line).</p><p>In the absence of any stimulus, the <italic>amplitude</italic> (<inline-formula><mml:math id="inf22"><mml:mi>α</mml:mi></mml:math></inline-formula>) of these re-orientations has a baseline angle <inline-formula><mml:math id="inf23"><mml:msub><mml:mi>θ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>. In the main results, we set <inline-formula><mml:math id="inf24"><mml:msub><mml:mi>θ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> = 10 deg, so as to roughly match the apparent small amplitude oscillations observed in larva <xref ref-type="fig" rid="fig1">Figure 1A</xref>. However, we show that the value of this parameter is not crucial for the emergence of taxis (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p><p>In the presence of stimulation, such as a gradient of odour concentration, the <italic>amplitude</italic> (<inline-formula><mml:math id="inf25"><mml:mi>α</mml:mi></mml:math></inline-formula>) of each of these re-orientations is modulated by the stimulus perceived. The stimulus perceived is taken as the difference in stimulus intensity between the previous and current location (in our model: <inline-formula><mml:math id="inf26"><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>) (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). The <italic>amplitude</italic> (<inline-formula><mml:math id="inf27"><mml:mi>α</mml:mi></mml:math></inline-formula>) of the rotation is determined by a simple linear function: <inline-formula><mml:math id="inf28"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is multiplied by a constant gain <inline-formula><mml:math id="inf29"><mml:mi>g</mml:mi></mml:math></inline-formula>, and this is then added to the baseline intrinsic oscillations <inline-formula><mml:math id="inf30"><mml:msub><mml:mi>θ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). Thus, bearing angle can be bidirectionally modulated, that is, the signal perceived can lead to an increase or decrease in the amplitude of the next turn, as compared to the baseline angle <inline-formula><mml:math id="inf31"><mml:msub><mml:mi>θ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, depending on the sign of <inline-formula><mml:math id="inf32"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and the constant gain <inline-formula><mml:math id="inf33"><mml:mi>g</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p><p>The gain <inline-formula><mml:math id="inf34"><mml:mi>g</mml:mi></mml:math></inline-formula> is taken to represent the sensorimotor transformation, which gives a linear relationship between perceived sensory stimulation and motor command. What this linear transformation could imply for the larva is considered in the discussion.</p><p><xref ref-type="fig" rid="fig3">Figure 3C,D</xref> shows that this simple agent is sufficient for taxis to emerge. The behaviour is very robust to the choice of baseline turning angle <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>θ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> or gain values (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Effectively, a negative gain (<inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>g</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) yields attraction towards higher stimulus intensity because decreasing stimulation (<inline-formula><mml:math id="inf37"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) triggers strong re-orientations, while increasing stimulation (<inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) straightens the path (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). Inversely, a positive gain (<inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>g</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) yields aversion (<xref ref-type="fig" rid="fig3">Figure 3D</xref>), and a null gain (<inline-formula><mml:math id="inf40"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) yields neither attraction nor repulsion. While the sign of the gain <inline-formula><mml:math id="inf41"><mml:mi>g</mml:mi></mml:math></inline-formula> determines attraction or repulsion, the magnitude determines its strength: the larger the gain, the stronger the agent’s reaction to the sensory stimulation is, and thus stronger attraction or aversion emerges in the resulting trajectories (see <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, first row).</p><p>In the following sections, we examine the ability of this basic model to capture the typical chemotactic signatures observed in larvae, including path shapes, bearing to odour distribution shapes, sensory history, and their qualitative change resulting from typical manipulations such as change in stimulus concentration or associative learning.</p></sec><sec id="s2-4"><title>Characteristic taxis trajectories</title><p>An emergent property of our agent model is that for an attractive odour (i.e. a negative gain) the distribution of bearing angle to the odour’s source shows two peaks around 90 and −90 degrees (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Therefore, the agent tends to spend more time with the odour on its sides rather than directly in front or behind it. Interestingly, this is also true with real larvae (<xref ref-type="fig" rid="fig4">Figure 4</xref>).<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.15504.008</object-id><label>Figure 4.</label><caption><title>Typical path signatures for larvae and simulation.</title><p>(<bold>A</bold>,<bold>B</bold>) Example of paths. (<bold>C</bold>,<bold>D</bold>) Distributions of bearings to odour. Both larvae and simulated agents tend to spend most time with the odour located on their sides (−90 and 90 degrees), orbiting the source. In both larvae and simulation, orbital behaviour is emphasized during peristalsis forward motion (turn &lt; 30 degrees for the model) (<bold>C</bold> blue curve), and when the larvae/agent is more than 1cm away from the odour (<bold>D</bold> green curve). Crossing-over trajectories, by contrast, are constituted of regular large turns that happen mostly while the larvae/agent is heading away from the odour (<bold>C</bold> red curve) and is rather apparent when the larvae/agent is close to the odour (<bold>D</bold> blue curve).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.008">http://dx.doi.org/10.7554/eLife.15504.008</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-15504-fig4-v2"/></fig></p><p>For both larval and the agent generated paths, this tendency is emphasised while displaying no large turns (<xref ref-type="fig" rid="fig4">Figure 4C</xref> blue line) and large turns tend to happen while the odour is located behind (<xref ref-type="fig" rid="fig4">Figure 4C</xref> red line), a result consistent with previous findings (<xref ref-type="bibr" rid="bib25">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib59">Schleyer et al., 2015b</xref>). Spending time with the odour located 90 degrees on the side translates into orbiting around the odour source. This ‘orbital behaviour’ can be observed clearly in simulated trajectories from the deterministic (absence of random noise) version of our agent model (<xref ref-type="fig" rid="fig4">Figures 4B</xref> and <xref ref-type="fig" rid="fig5">5B</xref>).<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.15504.009</object-id><label>Figure 5.</label><caption><title>Modulation of the chemotactic response.</title><p>(<bold>A</bold>) Time occupancy spatial maps for genotypes with re-engineered peripheral olfactory circuits tested in the near-source paradigm (30 mM odour source): wild type (N = 42 flies), Or42a ectopically expressed in the 21 intact ORNs (all neuron pairs active, N = 38), Or42a single-functional ORN (one pair of neuron active, N = 37), and Orco null (anosmic flies, N = 55) adapted from <xref ref-type="bibr" rid="bib25">Gomez-Marin et al. (2011)</xref>. (<bold>B</bold>) The simulated agent can capture the patterns observed in larvae by changing <inline-formula><mml:math id="inf42"><mml:mi>g</mml:mi></mml:math></inline-formula>, suggesting that OSN activity acts collectively to increase the turning modulation signal. (<bold>C</bold>) Effect of odour concentration and appetitive conditioning on turn-rate (larva data from <xref ref-type="bibr" rid="bib59">Schleyer et al., 2015b</xref>). (<bold>D</bold>) In our simulation (shows mean <inline-formula><mml:math id="inf43"> <mml:mo>± </mml:mo></mml:math></inline-formula> std. dev.), turning events were categorised as large turns if &gt; 30 degrees and not followed by another large turn. Changes in stimulus intensity were obtained by multiplying the gradient by a factor 0, 1 or 2. Learning was modelled as a change in gain (<inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf46"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). The same qualitative changes in turn-angle and turn-rate relative to odour bearing are observed. (<bold>E</bold>) Preference index (<inline-formula><mml:math id="inf47"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM174"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) for 30 simulated larvae after 3 min, for different gains (larva data from <xref ref-type="bibr" rid="bib59">Schleyer et al., 2015b</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.009">http://dx.doi.org/10.7554/eLife.15504.009</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-15504-fig5-v2"/></fig></p><p>However, in our models, increasing the gain (towards higher negative values) results in a qualitative change to the shape of agent’s trajectories from circular orbits to those characterized by straight crossings over the odour source, and sharp re-orientation events once the peak has been passed over, that is, when the odour source is now located behind the agent (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). When further away from the odour source, the perceived changes in concentration (<inline-formula><mml:math id="inf48"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>) are smaller so, as during orbital behaviour, the agent tends to spend time with the odour on its side. As a result, the model predicts different statistics depending on the proximity to the odour: when close to the odour, crossing-over paths occur, resulting in a flattening of the bearing-to-odour distribution curve. Examination of actual larvae paths reveals similar signature: crossing-over trajectories emerge when close to the odour source [except for the Or42a single receptor mutant larvae, that show an orbital behaviour (see below)], which indeed results in a flattening of the distribution curve (<xref ref-type="fig" rid="fig4">Figure 4A,D</xref>).</p></sec><sec id="s2-5"><title>Modulation of the chemotactic response as a simple change in gain</title><p>Chemotaxis in larvae can be altered in several ways. For instance, genetic alterations of the peripheral olfactory circuits that reduce the number of functional OSNs (<xref ref-type="bibr" rid="bib45">Louis et al., 2008</xref>; <xref ref-type="bibr" rid="bib25">Gomez-Marin et al., 2011</xref>) or receptor diversity (<xref ref-type="bibr" rid="bib25">Gomez-Marin et al., 2011</xref>) increase the spread of trajectories around a source, and can produce trajectories that seem to maintain a distance from the source (<xref ref-type="fig" rid="fig5">Figure 5A</xref>).</p><p>A change in gain parameter <inline-formula><mml:math id="inf49"><mml:mi>g</mml:mi></mml:math></inline-formula> of our model is sufficient to generate trajectories that capture these path signatures (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). As the gain is reduced, the spread of trajectories increases, and orbital trajectories eventually arise: the agent maintains a radial distance from the source. Critically, these are not due to active repulsion (<xref ref-type="bibr" rid="bib25">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib39">Kreher et al., 2008</xref>; <xref ref-type="bibr" rid="bib2">Asahina et al., 2009</xref>) but due to a weak sensory-to-turn gain <inline-formula><mml:math id="inf50"><mml:mi>g</mml:mi></mml:math></inline-formula> that does not allow the agent to perform sufficiently large reorientations to track the peak concentration as the agent moves in the arena.</p><p><xref ref-type="bibr" rid="bib59">Schleyer et al. (2015b)</xref> describe in detail the effects of changing the concentration of the odour source on the statistics of larval chemotaxis. Perhaps surprisingly, they show that similar behavioural effects are obtained after associative learning (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). Here also, a change in stimulus intensity or a change in gain <inline-formula><mml:math id="inf51"><mml:mi>g</mml:mi></mml:math></inline-formula> in our model closely captures these effects (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). The explanation of why both kinds of changes yield similar effects is straightforward in our model as a change in stimuli intensity perceived <inline-formula><mml:math id="inf52"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> or gain <inline-formula><mml:math id="inf53"><mml:mi>g</mml:mi></mml:math></inline-formula> both directly affect the next head-sweep amplitude (see <xref ref-type="disp-formula" rid="equ1">Equation 6</xref>).</p><p>A widely used summary measure of chemotaxis is the performance index: the proportion of a group of larva that is near the odour source after some period of time. In our model, the performance index increases quite linearly with change in gain (<xref ref-type="fig" rid="fig5">Figure 5E</xref>) and can therefore account for the continuum of performance indices observed in larvae across experiments. This was not necessarily the case in previous agent simulation models, where small changes in parameter values would yield drastic changes in performance index (<xref ref-type="bibr" rid="bib13">Davies et al., 2015</xref>).</p><p>It thus seems that our model can capture a variety of effects observed in path signatures, detailed motor changes and performance indices by changing in a single parameter (<inline-formula><mml:math id="inf54"><mml:mi>g</mml:mi></mml:math></inline-formula>). In the discussion, we reflect on possible implications of this result for the architecture underlying chemotaxis in larvae.</p></sec><sec id="s2-6"><title>Sensory history preceding turns</title><p>The average sensory history perceived before the occurrence of large turns shows a slow monotonic decrease in concentration which extends up to 10s prior to the large turn. This has been reported for larvae during chemotaxis (<xref ref-type="bibr" rid="bib25">Gomez-Marin et al., 2011</xref>) or as a response to white noise optogenetic stimulation of olfactory receptor (<xref ref-type="bibr" rid="bib19">Gepner et al., 2015</xref>), and can also be observed in our model (<xref ref-type="fig" rid="fig6">Figure 6</xref>).<fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.15504.010</object-id><label>Figure 6.</label><caption><title>Sensory history and monotonic decrease in concentration.</title><p>(<bold>A</bold>,<bold>B</bold>) Example of simulated path and the associated sensory history given the absolute (<inline-formula><mml:math id="inf55"><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>) and relative (<inline-formula><mml:math id="inf56"><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>) odour concentration perceived. (<bold>C</bold>) Average (±95%CI) and individual’s example of the sensory history experienced before and after large turn events (&gt;90 degrees) in our simulation, for all large turns (black), or only the large turns that result in experiencing a positive (red) or a negative <inline-formula><mml:math id="inf57"><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> (blue). A slow monotonic decrease in concentration precedes large turns even though turns are the consequence of the signal experienced during the previous step only.(<inline-formula><mml:math id="inf58"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, noise = 10 deg).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.010">http://dx.doi.org/10.7554/eLife.15504.010</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-15504-fig6-v2"/></fig></p><p>In larvae, this may suggest the existence of a low-pass filter enabling larvae to integrate monotonic decreases over relatively long time scales to increase the probability of triggering a large turn (<xref ref-type="bibr" rid="bib25">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib13">Davies et al., 2015</xref>; <xref ref-type="bibr" rid="bib19">Gepner et al., 2015</xref>). However, our model does not possess such a low-pass filter: large turns occur as the consequence of the stimulus change perceived during the last time-step only. Here, the amplitude of a turn correlates with the size the stimulus change <inline-formula><mml:math id="inf59"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, with maximum change occurring when the agent moves directly down-gradient. The re-orientation towards down-gradient causes a progressive decrease of the stimulus perceived, which is reflected in the stimulus history. Since turns are more likely to be triggered when the larva faces away from the odour then averaging the stimulus around these turn events will reflect this history of monotonic sensory decrease. Therefore, the monotonic sensory decrease can result from the structure of the environment, and not from a low-pass filter in the larva.</p><p>However, we cannot give a sufficient explanation as for why the monotonic decrease is also seen under white noise optogenetic stimulation (<xref ref-type="bibr" rid="bib19">Gepner et al., 2015</xref>). Our agent is a point in space, and therefore does not capture the details of head sweep movements through space. Further investigation of dynamics at this level would require implementing our agent into a more elaborate model that accounts for the larva’s body, which promises to be an interesting endeavour. Nonetheless, the emergence of this monotonic decrease from the interaction between our reactive agent and the environment suggests caution is needed when interpreting the causal implications of sensory history prior to actions.</p></sec><sec id="s2-7"><title>First-turn bias</title><p>Larvae show a slight tendency to bias their first head cast (after a stop event) towards the side of the attractive stimulus (i.e. the odour side (<xref ref-type="bibr" rid="bib25">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib23">Gomez-Marin and Louis, 2012</xref>) or darker side during negative phototaxis (<xref ref-type="bibr" rid="bib33">Kane et al., 2013</xref>), or towards preferred temperatures (<xref ref-type="bibr" rid="bib46">Luo et al., 2010</xref>). This may suggest the involvement of bilateral sensing to obtain gradient information, or a memory of gradient information obtained during the run. But if we identify ‘turns’ in our model as those re-orientation angles exceeding the threshold that is usually associated with stopping in the larva, the agent also reveals a tendency to bias its first ‘turns’ towards the odour source (<xref ref-type="fig" rid="fig7">Figure 7</xref>), despite having no gradient information other than the change from one time step to the next. This tendency arises because of the oscillatory nature of the agent. Given an attractive odour (i.e. a negative gain <inline-formula><mml:math id="inf60"><mml:mrow><mml:mi>g</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), large re-orientations are more likely to be triggered when a negative <inline-formula><mml:math id="inf61"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> has been perceived during the previous step. And since a negative <inline-formula><mml:math id="inf62"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is more likely to be perceived when turning away from the odour, the subsequent turn, in the opposite direction, is thus more likely to be directed towards the odour side.<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.15504.011</object-id><label>Figure 7.</label><caption><title>First turn bias towards the correct side.</title><p>The model's first turns were categorised as large turns (&gt;30 degrees) that were not preceded by a large turn in the previous timestep. (<bold>A</bold>) Probability of turning to the correct side (i.e. towards the odour; 1st column ‘C’) and wrong side (second column ‘W’). Higher signals (i.e. increased concentration or stronger gain <inline-formula><mml:math id="inf63"><mml:mi>g</mml:mi></mml:math></inline-formula>) increase the bias. (<bold>B</bold>) Turning direction (mean ± standard deviation) given the bearing to odour. Green and red zones indicate turns towards (i.e. correct side) or away (i.e. wrong side) from the odour respectively. Noise <inline-formula><mml:math id="inf64"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>. Time <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>800</mml:mn></mml:mrow></mml:math></inline-formula>. larvae (<inline-formula><mml:math id="inf66"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>25000</mml:mn></mml:mrow></mml:math></inline-formula> for each group).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.011">http://dx.doi.org/10.7554/eLife.15504.011</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-15504-fig7-v2"/></fig></p><p>Nonetheless, this bias is weak and requires a large dataset to appear significant. Our model predicts that the bias should increase together with increasing odour attraction, whether from stronger gain due to appetitive learning; stronger sensory input due to increased odour concentration, or both (<xref ref-type="fig" rid="fig7">Figure 7A</xref>); it should also become more apparent when the odour is located on one side of the larvae (<xref ref-type="fig" rid="fig7">Figure 7B</xref>).</p></sec><sec id="s2-8"><title>A neural implementation of oscillation</title><p>So far, we have used a simple discrete time model to examine whether the basic principle of continuous lateral oscillations, modulated in amplitude by the stimuli perceived, can account for larval taxis. The discrete-time sensorimotor model assumed that head-sweeps and sensory perception are instantaneous and synchronized, which might imply that the descending sensory signal in the larvae may require precise timing in order to interact with the ongoing motor control of the oscillation.</p><p>Here, we aim to investigate whether our hypothesis can be verified in continuous time given the biophysical constraints of a neural implementation. The agent is again abstracted to an oriented point-sensor but now, critically, the change in heading is driven by a neural oscillator in continuous time, while sensory stimuli are continuously updated under the agent’s motion through the environment.</p><p>For our purposes, we adapted (see 'Materials and methods' ) a spike-rate neural model of a central pattern generator (CPG) that has been successfully used to model lamprey locomotion (<xref ref-type="bibr" rid="bib12">Cohen et al., 1992</xref>; <xref ref-type="bibr" rid="bib41">Lansner and Griller, 1997</xref>) see <xref ref-type="bibr" rid="bib47">Marder and Calabrese, 1996</xref>. The CPG consists of a pair of compartments, here taken to be driving the changes in the agent’s heading (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). Each compartment has a pool of self-connected excitatory neurons (<inline-formula><mml:math id="inf67"><mml:mi>E</mml:mi></mml:math></inline-formula>), and a cross-inhibitory interneuron (<inline-formula><mml:math id="inf68"><mml:mi>C</mml:mi></mml:math></inline-formula>) projecting to the other compartment. This produces a regular alternation in firing bursts between left and right sides that can be modified by the additional bilateral inputs, <inline-formula><mml:math id="inf69"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf70"><mml:mi>S</mml:mi></mml:math></inline-formula>. The <inline-formula><mml:math id="inf71"><mml:mi>A</mml:mi></mml:math></inline-formula> unit represents descending sensory signals either processed or direct, while the <inline-formula><mml:math id="inf72"><mml:mi>S</mml:mi></mml:math></inline-formula> unit represents a modulatory signal. The spike rates from both compartments drive the changes in heading angle via a simple mechanical model (<xref ref-type="fig" rid="fig8">Figure 8B</xref>) , see 'Materials and methods'). Note this agent, like the discrete-time model, does not incorporate stops. It moves forward at a constant speed in the direction pointed by the heading angle. In the absence of stimuli arriving from the input unit <inline-formula><mml:math id="inf73"><mml:mi>A</mml:mi></mml:math></inline-formula>, the parameters of the system have been set so that it produces a regular ±10 degrees oscillation in the heading at around 0.3 Hz. The sensory input allows this oscillation to be perturbed, modifying the amplitude and phase relationships between the bursts of each side, resulting in a change in the agent's heading.<fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.15504.012</object-id><label>Figure 8.</label><caption><title>Neural model in continuous time.</title><p>(<bold>A</bold>) Central pattern generator modelled with neurons of mean firing rates (adapted from <xref ref-type="bibr" rid="bib67">Wilson, 1999</xref>). Arrows indicate excitatory connections, a bar denotes an inhibitory connection and circle denotes a neuromodulatory connection. Cross inhibitory connections go to all neurons of the opposite compartment. The <inline-formula><mml:math id="inf74"><mml:mi>A</mml:mi></mml:math></inline-formula> unit represents mean firing rate of an OSN, and it projects to both compartments. The <inline-formula><mml:math id="inf75"><mml:mi>S</mml:mi></mml:math></inline-formula> unit represents a neuromodulatory neuron which modulates the half-response threshold of the <inline-formula><mml:math id="inf76"><mml:mi>E</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf77"><mml:mi>C</mml:mi></mml:math></inline-formula> neurons to effectively imitate the effects of a slow adapting current. We denote the left and right <inline-formula><mml:math id="inf78"><mml:mi>E</mml:mi></mml:math></inline-formula> as <inline-formula><mml:math id="inf79"><mml:msub><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf80"><mml:msub><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> respectively. (<bold>B</bold>) A torsional spring is acting on the agent heading change to represent the restoring viscoelastic forces of the larva body bends. The red arrow indicates the direction from which the agent is coming, and the grey arrow indicates its heading direction. (<bold>C</bold>) Frequency spectrum of heading velocity oscillations that are comparable to larval data. (<bold>D</bold>) Example taxis trajectories in a virtual odour gradient with different gain. (<bold>E</bold>) Sample oscillator dynamics during chemotaxis, showing <inline-formula><mml:math id="inf81"><mml:msub><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf82"><mml:msub><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> alternating, while the <inline-formula><mml:math id="inf83"><mml:mi>A</mml:mi></mml:math></inline-formula> input as influenced zig-zag motion of the agent in the environment. Under high-gain the turns appear sharper as required. (<bold>F</bold>) Effects of unit-step perturbations on bearing angle across oscillator phase. Panels below show the simultaneous state of the heading angular velocity, an example step-up in the firing rate of <inline-formula><mml:math id="inf84"><mml:mi>A</mml:mi></mml:math></inline-formula> and the respective state of neural bursts from <inline-formula><mml:math id="inf85"><mml:msub><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf86"><mml:msub><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> (here shown unperturbed by the step-input <inline-formula><mml:math id="inf87"><mml:mi>A</mml:mi></mml:math></inline-formula>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.012">http://dx.doi.org/10.7554/eLife.15504.012</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-15504-fig8-v2"/></fig></p><p>We evaluated the effect of stimulus timing against oscillator phase on the ability of this model to express overt bearing changes, by delivering perturbations to the input <inline-formula><mml:math id="inf88"><mml:mi>A</mml:mi></mml:math></inline-formula> (note both sides <inline-formula><mml:math id="inf89"><mml:mi>L</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf90"><mml:mi>R</mml:mi></mml:math></inline-formula> receive the same perturbation) at different points in the oscillation cycle. Measuring the overall change in bearing against a bilateral step-input of magnitude <inline-formula><mml:math id="inf91"><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> across different times <inline-formula><mml:math id="inf92"><mml:msub><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> showed that the larva can be steered in a direction determined by the sign of <inline-formula><mml:math id="inf93"><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> and, crucially the state of the oscillator at time <inline-formula><mml:math id="inf94"><mml:msub><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula>. The resulting steering varied smoothly across the oscillator phase and therefore it is not critically dependent on the precise timing of the perturbation (see <xref ref-type="fig" rid="fig8">Figure 8F</xref>).</p><p>In a virtual odour environment, the continuous agent also produces curved paths when further away from the odour source, characteristic of larval behaviour, that subsequently become orbits around the odour source (<xref ref-type="fig" rid="fig8">Figure 8D</xref>). The parameters of the model have been set such that the frequency of oscillation is within the ranges observed in larva (see <xref ref-type="fig" rid="fig8">Figure 8C</xref>), and thus when measuring the mean frequency of the heading velocity over such trajectories we obtain a noisy frequency spectrum comparable to the larval trajectory data. Further, we established that a doubling of the gain (from <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>70</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>140</mml:mn></mml:mrow></mml:math></inline-formula>), which effectively doubles the input due to the sensory induced perturbations from the input <inline-formula><mml:math id="inf97"><mml:mi>A</mml:mi></mml:math></inline-formula>, results in a qualitatively comparable change from orbital to crossing-over trajectories, as observed with the discrete-time agent (<xref ref-type="fig" rid="fig4">Figure 4</xref>). The heading velocity dynamics emerging from the model (<xref ref-type="fig" rid="fig8">Figure 8E</xref>) are reminiscent of the experimental data of anterior body angular velocity (<xref ref-type="fig" rid="fig1">Figure 1</xref>) in terms that in both there is a baseline rhythm while heading velocity increases under larger re-orientations (see <xref ref-type="fig" rid="fig1">Figure 1</xref>).</p><p>The sensory stimuli during a change in heading naturally fall into a fixed phase relationship to the oscillator activity since the turn direction depends on which oscillator compartment is active. Therefore, the input perturbation perceived in the virtual odour environment relates to the turning motion, as these two variables are in a closed-loop. Consequently, increasing the gain also increases heading angular velocity and thus results in sharper re-orientation maneuvres, which in turn result in larger sensory perturbations.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><sec id="s3-1"><title>Oscillation as a principle of larval locomotion</title><p>Rhythmic behaviour is ubiquitous in biological systems. Producing oscillations during locomotion is widespread in biological systems, from multisegmented animals (<xref ref-type="bibr" rid="bib31">Iino and Yoshida, 2009</xref>; <xref ref-type="bibr" rid="bib32">Izquierdo and Lockery, 2010</xref>; <xref ref-type="bibr" rid="bib41">Lansner and Griller, 1997</xref>) down to single cells (<xref ref-type="bibr" rid="bib70">Yang et al., 2011</xref>), and may have advantages for sensorimotor control when tracking up an odour trail or plume (<xref ref-type="bibr" rid="bib28">Hangartner, 1969</xref>; <xref ref-type="bibr" rid="bib16">Farkas and Shorey, 1972</xref>; <xref ref-type="bibr" rid="bib8">Budick and Dickinson, 2006</xref>; <xref ref-type="bibr" rid="bib65">Willis and Arbas, 1997a</xref>; <xref ref-type="bibr" rid="bib9">Cardé and Willis, 2008</xref>).</p><p>We have presented evidence from tracking of Drosophila larva that their locomotion also contains a rhythmic lateral oscillation (<xref ref-type="fig" rid="fig1">Figures 1</xref> and <xref ref-type="fig" rid="fig2">2</xref>), which is apparently uncorrelated with the peristaltic rhythm (<xref ref-type="fig" rid="fig1">Figure 1</xref>). We take this continuous oscillation to be the underlying basis for larval behaviours that are often treated as distinct states triggered by dedicated sensory motor processes (see <xref ref-type="bibr" rid="bib27">Green et al., 1983</xref>; <xref ref-type="bibr" rid="bib56">Sawin et al., 1994</xref>; <xref ref-type="bibr" rid="bib11">Cobb, 1999</xref>; <xref ref-type="bibr" rid="bib63">Vogelstein et al., 2014</xref>; <xref ref-type="bibr" rid="bib50">Ohashi et al., 2014</xref>; <xref ref-type="bibr" rid="bib23">Gomez-Marin and Louis, 2012</xref>, <xref ref-type="bibr" rid="bib24">2014</xref>; <xref ref-type="bibr" rid="bib29">Hernandez-Nunez et al., 2015</xref>; <xref ref-type="bibr" rid="bib19">Gepner et al., 2015</xref>). That is, we suggest running/weathervaning and casting/turning all result from the same underlying and continuously active oscillatory mechanism (<xref ref-type="fig" rid="fig9">Figure 9C,D</xref>), and that taxis involves continuous and direct sensory modulation of the oscillation amplitude. We show that models embodying this hypothesis, despite their simplicity, are sufficient to capture a range of taxis phenomena observed in larvae (<xref ref-type="fig" rid="fig4">Figures 4</xref>, <xref ref-type="fig" rid="fig5">5</xref>, <xref ref-type="fig" rid="fig7">7</xref>, <xref ref-type="fig" rid="fig8">8</xref>).<fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.15504.013</object-id><label>Figure 9.</label><caption><title>Oscillation and peristalsis modulation.</title><p>(<bold>A</bold>) Real larvae tail velocities show a bimodal distribution, with the first peak corresponding to peristalsis inhibition events. Inset illustrates the extraction of maxima peaks (red curve) of tail velocities. (<bold>B</bold>) Average (±95%CI) of the tail velocities (green) and absolute values for the anterior body angular velocity (blue) and body bending (black) displayed before and after peristalsis inhibition events (aligned at t = 0, when tail speed dropped to a minimum). Red line highlights that average tail speed velocity (green) starts dropping before the occurrence of a large increase in body bending (black) or anterior body angular velocity (blue). This suggests that tail speed is not a mere physical consequence of a large turning event. (<bold>C</bold>) Conceptual scheme illustrating our overall view: all modalities, innate and learnt, are integrated at the zone of convergence. The summed signal is sent to both the neural oscillator mediating turning of the anterior body (blue), and to neurons mediating peristalsis inhibition (green). Associative center (Asso center), such as the mushroom body, where signal weightings can be modulated given the co-activation of a reinforcer neuron (R). Note that our scheme allows for sensory inputs to bypass the zone of convergence, and send their signals directly onto local control of the oscillator and/or the peristalsis motion. (<bold>D</bold>) Qualitative depiction of how apparently distinct behaviours could emerge from a continuous modulation signal. Growing signal strength increases anterior body angular velocity (blue) and inhibits crawling speed (green) simultaneously. If the signal is sufficiently strong peristalsis disruption happens (arrow), leading to an abrupt drop of tail speed velocities. The relaxing of the peristaltic synchronous left-right body contraction enhances the reaction to the thoracic left-right asynchronous oscillatory contraction, thus resulting in sharp increase in head sweep amplitude. Peristalsis spontaneously resumes when the sensory command lowers below peristalsis disruption threshold. The combinations of these two parameters (blue and green) can lead to the emergence of straight runs (light green area), curved runs (light blue area) and the stop and head-casts (light red area) behaviours as observed in larvae.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.013">http://dx.doi.org/10.7554/eLife.15504.013</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-15504-fig9-v2"/></fig></p><p>In this oscillatory taxis mechanism, ‘directed’ motion by the animal towards a target does not require a lateralised descending signal, nor does it include any switch between states or actions. Robust steering simply emerges from the closed-loop nature of the system: the oscillations control the exposure of the sensor to the stimuli, and the sensory signal controls the oscillations by perturbing the stable cyclic dynamics of the oscillator. A CPG is believed to operate within the thoracic and abdominal segments of larvae, executing a motor program for exploratory locomotion (<xref ref-type="bibr" rid="bib30">Hughes and Thomas, 2007</xref>; <xref ref-type="bibr" rid="bib5">Berni et al., 2012</xref>; <xref ref-type="bibr" rid="bib43">Lemon et al., 2015</xref>), while a recurrent CPG circuit generating oscillations is consistent with cross-connections in the ventral nerve cord of the larva (<xref ref-type="bibr" rid="bib37">Kohsaka et al., 2012</xref>; <xref ref-type="bibr" rid="bib53">Rickert et al., 2011</xref>). Indeed, genetic disruption of the mid-line connection pattern, particularly in the anterior segments (T1, T2, T3), disrupts lateral body bending (<xref ref-type="bibr" rid="bib6">Berni, 2015</xref>). This requirement echoes the essential neural architecture to implement our hypothesized oscillator.</p></sec><sec id="s3-2"><title>A simple sensorimotor mapping</title><p>We propose that the key mapping underlying taxis behaviour is a direct relationship of the perceived sensory signal to the modulation of oscillation amplitude. This direct relationship can thus be modelled as a single parameter: the gain <inline-formula><mml:math id="inf98"><mml:mi>g</mml:mi></mml:math></inline-formula>. In our models, both the valence (attractive or aversive) and salience (strength of attraction or aversion) of the oriented response along a gradient of stimulus intensity are determined by the value of <inline-formula><mml:math id="inf99"><mml:mi>g</mml:mi></mml:math></inline-formula>. For instance, in our abstract discrete-time agent, a high negative gain leads to a strong attraction, whereas a low but positive gain will lead to a moderate aversion (<xref ref-type="fig" rid="fig5">Figure 5C</xref>).</p><p>This ‘gain’ is only a model parameter and does not represent any specific neuro-anatomical feature in larvae. Rather, it could be seen as the net effect of the complete pathway from the stimulation of sensory receptors to muscle contraction. However, the fact that a single degree of freedom is sufficient to capture a substantial range of characteristics of the animal’s behaviour, including the path signatures (<xref ref-type="fig" rid="fig4">Figures 4</xref>) as well as the effect of odour-tastant associations, or reductions in the number of ORs (<xref ref-type="fig" rid="fig5">Figure 5</xref>) can be informative for reconstructing the neural architecture underlying chemotaxis in larvae.</p><p>A simple picture emerges as to how larvae may modulate their chemotactic response, whether as a result of habituation (<xref ref-type="bibr" rid="bib10">Cobb and Domain, 2000</xref>; <xref ref-type="bibr" rid="bib42">Larkin et al., 2010</xref>), learning (<xref ref-type="bibr" rid="bib1">Ache and Young, 2005</xref>; <xref ref-type="bibr" rid="bib57">Scherer et al., 2003</xref>; <xref ref-type="bibr" rid="bib20">Gerber et al., 2004</xref>; <xref ref-type="bibr" rid="bib15">Diegelmann et al., 2013</xref>; <xref ref-type="bibr" rid="bib58">Schleyer et al., 2015a</xref>), motivation (<xref ref-type="bibr" rid="bib64">Wang et al., 2013</xref>), developmental maturation (<xref ref-type="bibr" rid="bib26">Gong et al., 2010</xref>; <xref ref-type="bibr" rid="bib38">Krashes et al., 2009</xref>) or by integrating multiple stimuli. All parallel sensory pathways simply need to converge and sum their signals (<xref ref-type="fig" rid="fig9">Figure 9C</xref>), whether inhibitory or excitatory. The net sum will determine the valence (attraction or repulsion) and the strength of the chemotactic response.</p><p>For example, associative learning is believed to be based on experience-driven plasticity of the mushroom body (MB) pathway (<xref ref-type="bibr" rid="bib20">Gerber et al., 2004</xref>) and here learning is seen as a change in the effective signal transmission of this pathway, which runs parallel to the innate one, before both converge onto the motor system. The effective strength of signal transmission is changed by synaptic plasticity that may result in inverting the relative balance between the MB outputs that control attraction vs. aversion (as in the adult [<xref ref-type="bibr" rid="bib3">Aso et al., 2014</xref>, <xref ref-type="bibr" rid="bib52">Owald et al., 2015</xref>]) in an odour-specific manner. After convergence with the other pathways, a net inversion would correspond to a change in the sign of the gain in our model (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><p>This is consistent with the results of <xref ref-type="bibr" rid="bib58">Schleyer et al. (2015a)</xref> showing that learning and changes in odour concentration yield similar motor effects; as well as the results of <xref ref-type="bibr" rid="bib19">Gepner et al. (2015)</xref> suggesting that larvae combine olfactory and visual signals upstream of the decision to turn. It also explains the apparent similarity of taxis behaviours observed across modalities (compare for odour: <xref ref-type="bibr" rid="bib25">Gomez-Marin et al., 2011</xref>; light: <xref ref-type="bibr" rid="bib33">Kane et al., 2013</xref>, temperature: <xref ref-type="bibr" rid="bib40">Lahiri et al., 2011</xref>, and why when aversive light stimulus and attractive olfactory stimulation are perfectly synchronized their antagonistic effects appear to blend smoothly (see <xref ref-type="bibr" rid="bib4">Bellmann et al., 2010</xref>, Figure 1C). A state-based model, by contrast, needs to postulate that all these factors have equivalent and parallel effects on multiple mechanisms to account for these results (<xref ref-type="bibr" rid="bib13">Davies et al., 2015</xref>).</p></sec><sec id="s3-3"><title>Integrating lateral oscillation with peristaltic motion</title><p>In the current work, we examined chemotaxis behaviour in the absence of a mechanism for stopping. The models’ results show that peristalsis inhibition is not crucial for the emergence of the taxis signatures discussed above. However, it is clear that crawling speed in larvae can be reduced down to zero, and this is correlated with large body bends (<xref ref-type="fig" rid="fig1">Figure 1</xref> tail speed), and thus has an impact on chemotaxis behaviour. We here briefly speculate on how crawling speed might be included in our model in future.</p><p>An initial hypothesis is that stopping could be a by-product of making large turns, i.e., that the physical constraints of body bending lead to the peristaltic wave being disrupted. However, our analysis (consistent with <xref ref-type="bibr" rid="bib19">Gepner et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Hernandez-Nunez et al., 2015</xref>) shows that the inhibition of the forward motion is triggered on average at the onset of the turn and is thus not a mere consequence of large body bends (<xref ref-type="fig" rid="fig9">Figure 9B</xref>). We also note from our analysis that speed reduction is graded (<xref ref-type="fig" rid="fig1">Figure 1B,C</xref>), although contrary to turning amplitude (<xref ref-type="fig" rid="fig2">Figure 2D</xref>), the tail speed distribution is bimodal (<xref ref-type="fig" rid="fig9">Figure 9A</xref>). This is not necessarily indicative of a bimodal control signal (‘decision to stop’); however, as such discontinuities (<xref ref-type="fig" rid="fig9">Figure 9D</xref>) can be explained by the non-linear dynamics arising from simple models of peristaltic wave propagation (<xref ref-type="bibr" rid="bib54">Ross et al., 2015</xref>) as the speed is reduced. Our simple suggestion, then, is that the same signal that changes the oscillation amplitude could also directly change the peristalsis speed, which below some threshold results in a stop.</p><p>There is some experimental data suggesting that average speed, frequency of stopping events and average body-bending amplitude co-vary across stimuli conditions. Larva both reduce their crawling speed and increase their turn-rate in response to large step increases in CO<sub>2 </sub>(<xref ref-type="bibr" rid="bib21">Gershow et al., 2012</xref>). Larvae tend to accelerate when moving up a chemical gradient (<xref ref-type="bibr" rid="bib24">Gomez-Marin and Louis, 2014</xref>) which is correlated with a reduced turn-rate (<xref ref-type="bibr" rid="bib58">Schleyer et al., 2015a</xref>). Fast escape responses involve reduced head sweeping and rapid crawling (<xref ref-type="bibr" rid="bib51">Ohyama et al., 2015</xref>). In some paradigms, crawling speed and turning amplitude are not so clearly inversely correlated, e.g., large step increases in ethyl acetate concentration decrease turn-rate but reveal only a weak non-significant increase in speed (<xref ref-type="bibr" rid="bib21">Gershow et al., 2012</xref>); however, in the same paper, when the larvae move in a spatial gradient, the inverse correlation between speed and turn-rate is observed. In addition, peristalsis and head sweeps cease together under some conditions, e.g., sudden light offsets (<xref ref-type="bibr" rid="bib33">Kane et al., 2013</xref>), but this may be a freezing reaction unrelated to normal taxis behaviour.</p></sec><sec id="s3-4"><title>Predictions</title><p>We have proposed a model in which re-orientation is always active during taxis, as part of an oscillatory sensorimotor program. This mechanism makes predictions that differ from taxis arising from the alternation of discrete-action motor programs (<xref ref-type="bibr" rid="bib25">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib24">Gomez-Marin and Louis, 2014</xref>; <xref ref-type="bibr" rid="bib33">Kane et al., 2013</xref>), as implemented in alternative state-based models (<xref ref-type="bibr" rid="bib13">Davies et al., 2015</xref>; <xref ref-type="bibr" rid="bib59">Schleyer et al., 2015b</xref>; <xref ref-type="bibr" rid="bib50">Ohashi et al., 2014</xref>).</p><p>We have assumed that all head-sweeps are under the control of the same oscillator, independently if the animal has stopped or is running. The head-sweep amplitude should decrease under favourable changes, such as moving up-gradient towards an attractive odour, and increase under unfavourable changes. It also follows that ‘stop and head-cast’ events should be preceded by a smaller head-sweep in the opposite direction, which indeed agrees with our analysis of larval tracks in (<xref ref-type="fig" rid="fig1">Figures 1B</xref> and <xref ref-type="fig" rid="fig2">2A,B</xref>), whatever the conditions. This relationship implies that ‘stop and head-cast’ and ‘weathervaning’ behaviours are not independent mechanisms, and hence, for example, it should not be possible to obtain neurogenetic control over one without affecting the other.</p><p>The oscillator hypothesis predicts that stimulus elicited responses are timing dependent. Specifically, the continuous model predicts that experimentally varying the timing of stimulus exposure, for example via optogenetically induced olfactory stimulation, would trigger head-sweeps whose magnitude and direction vary as a function of the state of the oscillator at the time of stimulation. In contrast, a state-based model would predict that a step stimulus during re-orientation could trigger a termination of the head-sweep and a transition to the run state, thus ‘accepting’ a new heading direction. Thus, it does not predict a similar relationship between the stimulus timing, nor its strength, and the amplitude of the head-sweeps.</p><p>Our model also has potential consequences for learning. Current theory supports the view that memory expression is due to efficacy changes in synapses converging to mushroom body output neurons (MBONs) that encode valence; stimulating these neurons can elicit attraction or aversion (<xref ref-type="bibr" rid="bib3">Aso et al., 2014</xref>; <xref ref-type="bibr" rid="bib55"> Sachse and Beshel, 2016</xref>). However, our model suggests that the mushroom body pathway is yet another pathway that converges to modify the effective gain in the motor system, and thus MBON valence would also be sensitive to activation timing. That is, it should not be possible to yield a change in odour attraction behaviour via optogenetic activation of a target MBON unless the stimulus respects the timing sensitivity of the larval oscillator, mimicking a closed-loop motor action-stimulation.</p></sec><sec id="s3-5"><title>Conclusion</title><p>Larval taxis behaviour has been characterised as transitions between discrete states, or actions (<xref ref-type="bibr" rid="bib27">Green et al., 1983</xref>; <xref ref-type="bibr" rid="bib56">Sawin et al., 1994</xref>; <xref ref-type="bibr" rid="bib11">Cobb, 1999</xref>; <xref ref-type="bibr" rid="bib23">Gomez-Marin and Louis, 2012</xref>) requiring ‘action-selection’ or ‘decision-making’ processes (<xref ref-type="bibr" rid="bib24">Gomez-Marin and Louis, 2014</xref>). Here, we presented an alternative hypothesis according to which taxis results from a single simple sensory-motor process (<xref ref-type="fig" rid="fig9">Figure 9C</xref>): sensory signals directly modulate the continuous lateral oscillations of the anterior body, which we observed in larvae (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Despite their simplicity, our models capture a remarkable number of taxis phenomena observed in larvae and suggest an elegant picture in which all types of sensory signals, mono or multi-modal, can combine by simply converging on the single process that lies at the core of taxis: a turning oscillator. Additional new features such as different sensory receptors or intermediate relays, such as the MB pathway, can be directly integrated, and their respective influence can be modulated by simply changing the intensity of their signals.</p><p>It has been argued that over long time scales, natural selection favours not merely effective innovations, but systems that flexibly enable the incorporation of innovations (<xref ref-type="bibr" rid="bib62">Vermeij, 1973</xref>). The modularity of the system described here could provide such an evolutionary flexibility since it allows for behaviour to adapt by simply plugging in or removing input modalities. In future work, we will investigate the algorithmic nature of the proposed mechanism, how it operates within the complexity of larvae body mechanics and its robustness under increasing neural realism and additional processes required for the various tasks larvae perform in natural environments.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Real larvae path analysis</title><p>We analysed the tracks from 42 wild-type larvae, the data recorded for <xref ref-type="bibr" rid="bib25">Gomez-Marin et al. (2011)</xref>, which was supplied by Matthieu Louis. Each 3rd-instar foraging-larva path was recorded for 5 min at 7fps after releasing each larva on a rectangular agarose slab opposite to an odour source given by an ethyl butyrate droplet suspended from the lid. Tail, centroid, and head positions were extracted from each frame of the video using custom tracking software. Having obtained the processed data we used Matlab to analyse the tracks. Body bending was calculated as the angle formed between the tail-to-centroid axis and centroid-to-head axis. The variable ‘angular velocity of the anterior part of the body’ was obtained as the derivative across time of the centroid-to-head axis orientation. Specifics of the path analysis are presented where appropriate in the result sections.</p></sec><sec id="s4-2"><title>Agent-based simulation in discrete time steps</title><p>The agent model is an abstract description of the mechanism we believe larvae use to move up or down stimulus gradients. It consists of a point with position <inline-formula><mml:math id="inf100"><mml:mrow><mml:msub id="XM28"><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM29"><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and an associated orientation <inline-formula><mml:math id="inf101"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mrow id="XM30"><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>κ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM31"><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>κ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The model runs in discrete time <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow id="XM32"><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">⋯</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with each time-step representing an iteration of an algorithm. The agent’s algorithm is simple, and we provide a MATLAB implementation for download (<xref ref-type="bibr" rid="bib69">Wystrach et al., 2016</xref>). It is summarised by the following state-update equations that need to be executed in their order of appearance :<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd id="mjx-eqn-1"><mml:mtext>(1)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-2_1"><mml:mtext>(2)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-3_1"><mml:mtext>(3)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-4_1"><mml:mtext>(4)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo stretchy="false">←</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-5_1"><mml:mtext>(5)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-6_1"><mml:mtext>(6)</mml:mtext></mml:mtd><mml:mtd><mml:mi>n</mml:mi></mml:mtd><mml:mtd><mml:mi/><mml:mo stretchy="false">←</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>assuming initial conditions for sensory input <inline-formula><mml:math id="inf103"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and a random initial position set for <inline-formula><mml:math id="inf104"><mml:mrow><mml:msub id="XM45"><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM46"><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and orientation angle <inline-formula><mml:math id="inf105"><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>.</p><p>At each time-step the agent moves distance <inline-formula><mml:math id="inf106"><mml:mi>λ</mml:mi></mml:math></inline-formula>, in the updated direction <inline-formula><mml:math id="inf107"><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>, which depends on the intrinsic turning pattern, alternating left or right for odd or even time-steps. The baseline amplitude of the lateral oscillation is set to the baseline angle <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>θ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>. In the presence of environmental stimulation, the baseline angle is modified by sensory input <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> determined by the concentration <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM47"><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM48"><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at the current location. This includes a phasic signal <inline-formula><mml:math id="inf111"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, which corresponds to the change of stimulus intensity perceived between two time-steps, and, optionally, a tonic signal <inline-formula><mml:math id="inf112"><mml:msub><mml:mi>s</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula>, which corresponds to the absolute stimulus intensity perceived at a given step. The strength of modulation depends on the gain <inline-formula><mml:math id="inf113"><mml:mi>g</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf114"><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM49">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a hard-limit function:<disp-formula id="equ2"><label>(7)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>x</mml:mi></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext> if </mml:mtext></mml:mstyle><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:mi>π</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>π</mml:mi></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext> if </mml:mtext></mml:mstyle><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>π</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext> if </mml:mtext></mml:mstyle><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>A negative gain <inline-formula><mml:math id="inf115"><mml:mi>g</mml:mi></mml:math></inline-formula> with a positive <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> (i.e. an increase in concentration perceived) on one step would lead to a decrease in turning away at the next step (up to the lower boundary of <inline-formula><mml:math id="inf117"><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM51">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), while a negative <inline-formula><mml:math id="inf118"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> (i.e. a decrease in concentration perceived) will lead to an increase in turning away on the next step (up to the higher boundary of <inline-formula><mml:math id="inf119"><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM52">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>). Thus, with a negative <inline-formula><mml:math id="inf120"><mml:mi>g</mml:mi></mml:math></inline-formula>, the resulting paths tend to be directed towards the odour source, while a positive <inline-formula><mml:math id="inf121"><mml:mi>g</mml:mi></mml:math></inline-formula> would mediate repulsion.</p><p>The function <inline-formula><mml:math id="inf122"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM53">x</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM54">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> could be a fixed odour-gradient map, or a bivariate normal distribution (see <xref ref-type="disp-formula" rid="equ11">Equation 25</xref>) that can be used to represent the distribution of odour concentration around an odour source. The maps of odour gradients used in our simulations have been provided by Matthieu Louis’ Lab, as recorded in (<xref ref-type="bibr" rid="bib24">Gomez-Marin and Louis, 2014</xref>). Stronger odour source concentrations were modelled by simply scaling the gradient map. If the agent hits the boundary of the odour gradient map, a new orientation is randomly assigned so the agent keeps within the boundaries.</p><p>In some conditions, we added noise (see results). The additive noise is modelled simply as :<disp-formula id="equ3"><label>(8)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf123"><mml:msub><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> is drawn from normal distribution and then added to the agent’s current heading angle.</p></sec><sec id="s4-3"><title>Agent-based simulation in continuous time</title><p>The continuous agent is abstracted to an oriented point-sensor (as in the discrete-time model) but now, critically, the change in heading displays inertial moments and is driven by a model of coupled neural oscillators. The model attempts to capture the dynamics of heading change in continuous time, given that the stimuli are integrated by the driving non-linear oscillator and that re-orientation motion is constrained by some form of muscle-body constraints.</p><p>We use the single-segment model of the lamprey (<xref ref-type="bibr" rid="bib41">Lansner and Griller, 1997</xref>) to represent the neural oscillator driving the change in heading of the agent. The CPG consists of a pair of compartments, here taken to driving changes in heading of the agent (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). Each compartment contains a pool of excitatory neurons <inline-formula><mml:math id="inf124"><mml:mi>E</mml:mi></mml:math></inline-formula> and a cross-inhibitory interneuron <inline-formula><mml:math id="inf125"><mml:mi>C</mml:mi></mml:math></inline-formula>, which projects to the opposite compartment. The <inline-formula><mml:math id="inf126"><mml:mi>E</mml:mi></mml:math></inline-formula> unit of <xref ref-type="fig" rid="fig8">Figure 8A</xref> with its self-connection, therefore, stands for the activity of a pool of excitatory neurons that interconnect within the compartment and project to the <inline-formula><mml:math id="inf127"><mml:mi>C</mml:mi></mml:math></inline-formula> inhibitory neuron, while both <inline-formula><mml:math id="inf128"><mml:mi>E</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf129"><mml:mi>C</mml:mi></mml:math></inline-formula> receive an inhibitory connection from the <inline-formula><mml:math id="inf130"><mml:mi>C</mml:mi></mml:math></inline-formula> neuron of the opposite compartment. Further the <inline-formula><mml:math id="inf131"><mml:mi>E</mml:mi></mml:math></inline-formula> neurons of both compartments receive input from the <inline-formula><mml:math id="inf132"><mml:mi>A</mml:mi></mml:math></inline-formula> unit, which represents pooled sensory input, and a modulatory influence from the <inline-formula><mml:math id="inf133"><mml:mi>S</mml:mi></mml:math></inline-formula> unit, whose effects will be described shortly.</p><p>Our model is based on the version of <xref ref-type="bibr" rid="bib67">Wilson (1999)</xref> of the lamprey simplified model (<xref ref-type="bibr" rid="bib41">Lansner and Griller, 1997</xref>) according to which the neuronal responses are given at the spike-rate level given by the <xref ref-type="bibr" rid="bib49">Naka and Rushton (1966)</xref> function:<disp-formula id="equ4"><label>(9)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:mi>x</mml:mi><mml:mtext> </mml:mtext><mml:mo>≥</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:mi>x</mml:mi><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>which maps the stimulus intensity <inline-formula><mml:math id="inf134"><mml:mi>x</mml:mi></mml:math></inline-formula> of the net synaptic input to the expected spike-rate response of a neuron. The parameter <inline-formula><mml:math id="inf135"><mml:mi>h</mml:mi></mml:math></inline-formula> sets the half-response threshold while <inline-formula><mml:math id="inf136"><mml:mi>n</mml:mi></mml:math></inline-formula> sets the steepness of the response, which we take here to be <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. Spike-rates can only take positive values and therefore the function is constrained to lie in the positive integers up to the maximum <inline-formula><mml:math id="inf138"><mml:mi>m</mml:mi></mml:math></inline-formula>, which here will be set to <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> throughout. Each neuron also accounts for a spike-rate adaptation effect due to a slow after-hyperpolarization potential current <inline-formula><mml:math id="inf140"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, which operates by raising the half-response threshold <inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM61">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of <xref ref-type="disp-formula" rid="equ4">Equation 9</xref>. The equations for the left side of the coupled oscillators that we examined are as follows :<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd id="mjx-eqn-10_6"><mml:mtext>(10)</mml:mtext></mml:mtd><mml:mtd><mml:mi>τ</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>64</mml:mn><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-11_6"><mml:mtext>(11)</mml:mtext></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-12_6"><mml:mtext>(12)</mml:mtext></mml:mtd><mml:mtd><mml:mi>τ</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>64</mml:mn><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-13_6"><mml:mtext>(13)</mml:mtext></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf142"><mml:mrow><mml:msub id="XM82"><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM83"><mml:mi>C</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represent the excitatory and cross-inhibitory neuron of the left compartment in <xref ref-type="fig" rid="fig8">Figure 8A</xref>, while the <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>H</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:math></inline-formula> represents the dynamics of the <inline-formula><mml:math id="inf144"><mml:msub><mml:mi>I</mml:mi><mml:mtext>AHP</mml:mtext></mml:msub></mml:math></inline-formula> of a neuron, <inline-formula><mml:math id="inf145"><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM84">x</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM85">h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the <xref ref-type="bibr" rid="bib49">Naka and Rushton (1966)</xref> function of <xref ref-type="disp-formula" rid="equ4">Equation 9</xref>, and <inline-formula><mml:math id="inf146"><mml:msub><mml:mi>W</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> are the synaptic weights shown in <xref ref-type="fig" rid="fig8">Figure 8A</xref>. On the same figure, we see that the neuromodulatory unit <inline-formula><mml:math id="inf147"><mml:mi>S</mml:mi></mml:math></inline-formula> connects to both compartments, its effects are exerted via modifying the time constant and gain of the <inline-formula><mml:math id="inf148"><mml:msub><mml:mi>I</mml:mi><mml:mtext>AHP</mml:mtext></mml:msub></mml:math></inline-formula>:<disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd id="mjx-eqn-14_3"><mml:mtext>(14)</mml:mtext></mml:mtd><mml:mtd><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mn>6</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0.09</mml:mn><mml:mi>A</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-15_3"><mml:mtext>(15)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mfrac><mml:mn>35</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>0.04</mml:mn><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where an increase in the input from <inline-formula><mml:math id="inf149"><mml:mi>A</mml:mi></mml:math></inline-formula> will result in an increase of the <inline-formula><mml:math id="inf150"><mml:msub><mml:mi>I</mml:mi><mml:mtext>AHP</mml:mtext></mml:msub></mml:math></inline-formula> gain and a decrease in its time constant <inline-formula><mml:math id="inf151"><mml:msub><mml:mi>τ</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:math></inline-formula>. The neural model has the respective equations for the right compartment, containing <inline-formula><mml:math id="inf152"><mml:msub><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf153"><mml:msub><mml:mi>C</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> for the right side oscillator:<disp-formula id="equ7"><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd id="mjx-eqn-16_4"><mml:mtext>(16)</mml:mtext></mml:mtd><mml:mtd><mml:mi>τ</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>64</mml:mn><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-17_4"><mml:mtext>(17)</mml:mtext></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-18_4"><mml:mtext>(18)</mml:mtext></mml:mtd><mml:mtd><mml:mi>τ</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>64</mml:mn><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-19_4"><mml:mtext>(19)</mml:mtext></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To represent the biophysical constraints on re-orientation due to body-bending in real larvae, we used an idealized linear spring-mass-damper acting on the change in heading of the agent see <xref ref-type="fig" rid="fig8">Figure 8B</xref>. The system uses a pivoting spring-damper-mass on a joint to represent the elastic and damping forces exerted by the surrounding cuticle under the influence of opposing muscle forces driving body-bending in the larva. The muscles would normally be driven by motor neurons, but here, we simplify by assuming that the motor neurons replicate the activity of the <inline-formula><mml:math id="inf154"><mml:msub><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf155"><mml:msub><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> pre-motor neurons and thus the later can be directly used.</p><p>The agent continuously moves at speed of 1 mm/s in the direction indicated by the body angle <inline-formula><mml:math id="inf156"><mml:mi>θ</mml:mi></mml:math></inline-formula>. This simplification is justified in terms of our finding that the peristaltic wave peaks are uncorrelated with the body bending and thus can be taken as slow motion of the posterior body segment following the heading direction indicated. However, our model does not capture the straightening of the body bend due to this motion, or the friction forces exerted from the contact with the ground withholding the restoration. Given that the oscillation is driven by the premotor neuron activity and that the larva is assumed to continuously move at constant speed, the details of how the body bending is restored have been simplified out in our model to be driven by restorative elastic forces of the body. We take a non-dimensionalized approach writing the muscle model driving the head as second order system of idealized spring-mass-damper (see <xref ref-type="bibr" rid="bib18">Fung, 2013</xref>):<disp-formula id="equ8"><label>(20)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM114">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM115">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM116">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM119"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM117">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM118">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:mi>k</mml:mi><mml:mi>γ</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> defines the damping ratio, with <inline-formula><mml:math id="inf158"><mml:mi>η</mml:mi></mml:math></inline-formula> the damping force coefficient, <inline-formula><mml:math id="inf159"><mml:mi>k</mml:mi></mml:math></inline-formula> the stiffness coefficient of a linear spring and <inline-formula><mml:math id="inf160"><mml:mi>γ</mml:mi></mml:math></inline-formula> the muscle gain. We assume muscles on each side of the body work against each other to change the heading and thus, in this two-dimensional model, the net torque produced is taken to be the difference in spike rates of the premotor neurons <inline-formula><mml:math id="inf161"><mml:mrow><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM120">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM121">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> driving the muscles on each side. Evidently, the system is not representative of the larval muscle activity but the change in orientation caused by this activity. Nevertheless, it allows us to examine an embodied sensory-motor process during chemotaxis in continuous time avoiding the use of a detailed body that in essence would still only describe the motion of the olfactory sensor at the larva model which is needed for our demonstration. Further, writing the system in this form allows us to avoid having to consider specific values for the parameters and examine a generic system described by a level of damping, for which we have chosen an intermediate value <inline-formula><mml:math id="inf162"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. The bearing <inline-formula><mml:math id="inf163"><mml:mi>B</mml:mi></mml:math></inline-formula> is calculated via an integration of the change of heading angle <inline-formula><mml:math id="inf164"><mml:mi>θ</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ8">Equation 20</xref>. The continuous forward motion towards the current bearing is then converted to Cartesian coordinates to indicate the position of the head as a point:<disp-formula id="equ9"><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd id="mjx-eqn-21_4"><mml:mtext>(21)</mml:mtext></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>10</mml:mn></mml:mfrac></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-22_4"><mml:mtext>(22)</mml:mtext></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>10</mml:mn></mml:mfrac></mml:mrow></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-23_4"><mml:mtext>(23)</mml:mtext></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>10</mml:mn></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>the factors of 10 are simply used here to scale-down the motion of the agent so it looks similar to the scale used in the discrete agent model. Lastly, we define the <inline-formula><mml:math id="inf165"><mml:mi>A</mml:mi></mml:math></inline-formula> neuron’s activity pattern which we assumed to be representative of an olfactory sensory neuron. <inline-formula><mml:math id="inf166"><mml:mi>A</mml:mi></mml:math></inline-formula>’s output is a combination of a tonic output <inline-formula><mml:math id="inf167"><mml:msub><mml:mi>b</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula>, which is required to maintain the oscillation but also influences the oscillation frequency <xref ref-type="bibr" rid="bib41">Lansner and Griller (1997)</xref>, along with the derivative of the odour concentration <inline-formula><mml:math id="inf168"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM128">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> superimposed :<disp-formula id="equ10"><label>(24)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf169"><mml:mi>g</mml:mi></mml:math></inline-formula> defines the gain defining how much the derivative of the sensory stimuli alters the firing rate of input <inline-formula><mml:math id="inf170"><mml:mi>A</mml:mi></mml:math></inline-formula>, which perturbs the motor patterns and in turn influences the sensed stimulus in a closed-loop such that the rhythmic behaviour generates input for adaptive control (<xref ref-type="bibr" rid="bib65">Willis and Arbas, 1997a</xref>). The sensory stimuli is drawn from a virtual odour gradient that is simply taken to be a scaled bivariate normal distribution:<disp-formula id="equ11"><label>(25)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>with <inline-formula><mml:math id="inf171"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>Cov</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM139">x</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM140">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> being the correlation of <inline-formula><mml:math id="inf172"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf173"><mml:mi>y</mml:mi></mml:math></inline-formula>. The sensory information as a function of time is then given by :<disp-formula id="equ12"><label>(26)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM141">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM144"><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM142">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM145"><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM143">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The model system was evaluated numerically, with the parameter set and initial conditions listed in <xref ref-type="table" rid="tbl1">Table 1</xref>, using mathematics software from Wolfram Research, Inc. (2015) (for an example file see <xref ref-type="bibr" rid="bib69">Wystrach et al., 2016</xref>. For our purposes, the choice of parameters was broad and any arbitrary set that has sufficiently strong contralateral inhibition <inline-formula><mml:math id="inf174"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> such that the left-right oscillators quickly lock in antiphase while the frequency of the oscillation falls approximately within the larval range of 0.5 Hz, was sufficient.<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.15504.014</object-id><label>Table 1.</label><caption><p>CPG model parameter set and initial conditions. <inline-formula><mml:math id="inf175"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM161">x</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM162">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the multinomial distribution of <xref ref-type="disp-formula" rid="equ11">Equation 25</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.15504.014">http://dx.doi.org/10.7554/eLife.15504.014</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th colspan="2">Parameters</th></tr></thead><tbody><tr><th><inline-formula><mml:math id="inf176"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><td>4</td></tr><tr><th><inline-formula><mml:math id="inf177"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><td>1/10</td></tr><tr><th><inline-formula><mml:math id="inf178"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><td>3</td></tr><tr><th><inline-formula><mml:math id="inf179"><mml:msub><mml:mi>b</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula></th><td>19</td></tr><tr><th><inline-formula><mml:math id="inf180"><mml:mi>τ</mml:mi></mml:math></inline-formula></th><td>1/10</td></tr><tr><th><inline-formula><mml:math id="inf181"><mml:mi>m</mml:mi></mml:math></inline-formula></th><td><inline-formula><mml:math id="inf182"><mml:msup><mml:mn>10</mml:mn><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula></td></tr><tr><th><inline-formula><mml:math id="inf183"><mml:mi>n</mml:mi></mml:math></inline-formula></th><td><inline-formula><mml:math id="inf184"><mml:mn>2</mml:mn></mml:math></inline-formula></td></tr><tr><th><inline-formula><mml:math id="inf185"><mml:mi>c</mml:mi></mml:math></inline-formula></th><td><inline-formula><mml:math id="inf186"><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:math></inline-formula></td></tr><tr><th><inline-formula><mml:math id="inf187"><mml:mi>ρ</mml:mi></mml:math></inline-formula></th><td>1/5</td></tr><tr><th><inline-formula><mml:math id="inf188"><mml:mi>ζ</mml:mi></mml:math></inline-formula></th><td>1/2</td></tr><tr><th><inline-formula><mml:math id="inf189"><mml:mi>k</mml:mi></mml:math></inline-formula></th><td>1</td></tr></tbody></table><table frame="hsides" rules="groups"><thead><tr><th colspan="2">Initial Conditions</th></tr></thead><tbody><tr><th><inline-formula><mml:math id="inf190"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th><td>0</td></tr><tr><th><inline-formula><mml:math id="inf191"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th><td>80</td></tr><tr><th><inline-formula><mml:math id="inf192"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th><td>20</td></tr><tr><th><inline-formula><mml:math id="inf193"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th><td>0</td></tr><tr><th><inline-formula><mml:math id="inf194"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th><td>0</td></tr><tr><th><inline-formula><mml:math id="inf195"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th><td>0</td></tr><tr><th><inline-formula><mml:math id="inf196"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th><td>0</td></tr><tr><th><inline-formula><mml:math id="inf197"><mml:mrow><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th><td>0</td></tr><tr><th><inline-formula><mml:math id="inf198"><mml:mrow><mml:mi>B</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th><td>0</td></tr><tr><th><inline-formula><mml:math id="inf199"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th><td><inline-formula><mml:math id="inf200"><mml:msub><mml:mi>b</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula></td></tr><tr><th><inline-formula><mml:math id="inf201"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th><td><inline-formula><mml:math id="inf202"><mml:mrow><mml:mn>6</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM152"><mml:mrow><mml:mn>9</mml:mn><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn id="XM151">0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mn>100</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula></td></tr><tr><th><inline-formula><mml:math id="inf203"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th><td><inline-formula><mml:math id="inf204"><mml:mrow><mml:mn>35</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM154"><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mn>0.04</mml:mn><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn id="XM153">0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><th><inline-formula><mml:math id="inf205"><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th><td><inline-formula><mml:math id="inf206"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM157"><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn id="XM155">0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM158"><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn id="XM156">0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr></tbody></table></table-wrap></p><p>Further, we examined the change of bearing in response to a step change in the input firing rate of <inline-formula><mml:math id="inf207"><mml:mi>A</mml:mi></mml:math></inline-formula>. For these results, input from the odour gradient was ignored and the change of bearing was examined in response to a step increase of amplitude <inline-formula><mml:math id="inf208"><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> in the input at various time points <inline-formula><mml:math id="inf209"><mml:msub><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula>:<disp-formula id="equ13"><label>(27)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM146">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM147"><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf210"><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM148">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the unit step function with an onset time at <inline-formula><mml:math id="inf211"><mml:msub><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula>. The change of bearing was measured by integrating the head angle for long enough time for it to settle back to its cycle of zero-average change of bearing. Each curve of <xref ref-type="fig" rid="fig8">Figure 8F</xref> consists of <inline-formula><mml:math id="inf212"><mml:msup><mml:mn>10</mml:mn><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> points covering <inline-formula><mml:math id="inf213"><mml:msub><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> timing over a full cycle of oscillation (ie. from one peak of <inline-formula><mml:math id="inf214"><mml:msub><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> burst to the next), while each curve differs in the step amplitude <inline-formula><mml:math id="inf215"><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula>.</p><sec id="s4-3-1"><title>Obtaining the frequency spectrum of head velocities</title><p>We sample the heading speed of each larva trajectory at <inline-formula><mml:math id="inf216"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and then perform a discrete Fourier transform of each of the heading speed vectors <inline-formula><mml:math id="inf217"><mml:msup><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:math></inline-formula> of trajectory <inline-formula><mml:math id="inf218"><mml:mi>j</mml:mi></mml:math></inline-formula> :<disp-formula id="equ14"><label>(28)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>i</mml:mi><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The spectrum plot shown in <xref ref-type="fig" rid="fig8">Figure 8C</xref> represents the mean spectrum out from the speed vectors of <inline-formula><mml:math id="inf219"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math></inline-formula> trajectories. The starting point of each trajectory is distributed according to a squared matrix of points centred on the odour source (see starting positions in <xref ref-type="fig" rid="fig8">Figure 8D</xref>). Each trajectory’s initial point condition <inline-formula><mml:math id="inf220"><mml:mrow><mml:mrow id="XM171"><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn id="XM169">0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM172"><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn id="XM170">0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is set to point on this square matrix with a horizontal and vertical distance of 10mm between each point.</p></sec></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We are grateful to Matthieu Louis for providing us with larval tracking data and for his feedback on our manuscript. We would also like to thank Daniel Malagarriga for his comments and corrections on our manuscript, Bertram Gerber and Michael Schleyer for the useful discussions. This work was supported by the EU FET-Open grant MINIMAL.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>AW, Conception, Design and analysis of discrete agent model, Analysis of tracking data, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>KL, Conception, Design and analysis of discrete and continuous agent model, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>BW, Supervision of project, Including input into interpretation of data and design of work, Drafting or revising the article</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ache</surname><given-names>BW</given-names></name><name><surname>Young</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Olfaction: diverse species, conserved principles</article-title><source>Neuron</source><volume>48</volume><fpage>417</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.10.022</pub-id><pub-id pub-id-type="pmid">16269360</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Asahina</surname><given-names>K</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name><name><surname>Piccinotti</surname><given-names>S</given-names></name><name><surname>Vosshall</surname><given-names>LB</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A circuit supporting concentration-invariant odor perception in Drosophila</article-title><source>Journal of Biology</source><volume><bold>8</bold></volume><fpage>9</fpage><pub-id pub-id-type="doi">10.1186/jbiol108</pub-id><pub-id pub-id-type="pmid">19171076</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aso</surname><given-names>Y</given-names></name><name><surname>Sitaraman</surname><given-names>D</given-names></name><name><surname>Ichinose</surname><given-names>T</given-names></name><name><surname>Kaun</surname><given-names>KR</given-names></name><name><surname>Vogt</surname><given-names>K</given-names></name><name><surname>Belliart-Guérin</surname><given-names>G</given-names></name><name><surname>Plaçais</surname><given-names>PY</given-names></name><name><surname>Robie</surname><given-names>AA</given-names></name><name><surname>Yamagata</surname><given-names>N</given-names></name><name><surname>Schnaitmann</surname><given-names>C</given-names></name><name><surname>Rowell</surname><given-names>WJ</given-names></name><name><surname>Johnston</surname><given-names>RM</given-names></name><name><surname>Ngo</surname><given-names>TT</given-names></name><name><surname>Chen</surname><given-names>N</given-names></name><name><surname>Korff</surname><given-names>W</given-names></name><name><surname>Nitabach</surname><given-names>MN</given-names></name><name><surname>Heberlein</surname><given-names>U</given-names></name><name><surname>Preat</surname><given-names>T</given-names></name><name><surname>Branson</surname><given-names>KM</given-names></name><name><surname>Tanimoto</surname><given-names>H</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mushroom body output neurons encode valence and guide memory-based action selection in Drosophila</article-title><source>eLife</source><volume><bold>3</bold></volume><elocation-id>e04580</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.04580</pub-id><pub-id pub-id-type="pmid">25535794</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bellmann</surname><given-names>D</given-names></name><name><surname>Richardt</surname><given-names>A</given-names></name><name><surname>Freyberger</surname><given-names>R</given-names></name><name><surname>Nuwal</surname><given-names>N</given-names></name><name><surname>Schwärzel</surname><given-names>M</given-names></name><name><surname>Fiala</surname><given-names>A</given-names></name><name><surname>Störtkuhl</surname><given-names>KF</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Optogenetically induced olfactory stimulation in Drosophila larvae reveals the neuronal basis of odor-aversion behavior</article-title><source>Frontiers in Behavioral Neuroscience</source><volume><bold>4</bold></volume><elocation-id>27</elocation-id><pub-id pub-id-type="doi">10.3389/fnbeh.2010.00027</pub-id><pub-id pub-id-type="pmid">20577637</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berni</surname><given-names>J</given-names></name><name><surname>Pulver</surname><given-names>SR</given-names></name><name><surname>Griffith</surname><given-names>LC</given-names></name><name><surname>Bate</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Autonomous circuitry for substrate exploration in freely moving Drosophila larvae</article-title><source>Current Biology</source><volume><bold>22</bold></volume><fpage>1861</fpage><lpage>1870</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2012.07.048</pub-id><pub-id pub-id-type="pmid">22940472</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berni</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Genetic dissection of a regionally differentiated network for exploratory behavior in Drosophila larvae</article-title><source>Current Biology</source><volume><bold>25</bold></volume><fpage>1319</fpage><lpage>1326</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2015.03.023</pub-id><pub-id pub-id-type="pmid">25959962</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="book"><person-group person-group-type="author"><name> <surname>Braitenberg</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="1986">1986</year><source>Vehicles: Experiments in Synthetic Psychology</source><publisher-name>MIT press.</publisher-name><publisher-loc> Cambridge, MA</publisher-loc></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Budick</surname><given-names>SA</given-names></name><name><surname>Dickinson</surname><given-names>MH</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Free-flight responses of Drosophila melanogaster to attractive odors</article-title><source>Journal of Experimental Biology</source><volume><bold>209</bold></volume><fpage>3001</fpage><lpage>3017</lpage><pub-id pub-id-type="doi">10.1242/jeb.02305</pub-id><pub-id pub-id-type="pmid">16857884</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cardé</surname><given-names>RT</given-names></name><name><surname>Willis</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Navigational strategies used by insects to find distant, wind-borne sources of odor</article-title><source>Journal of Chemical Ecology</source><volume><bold>34</bold></volume><fpage>854</fpage><lpage>866</lpage><pub-id pub-id-type="doi">10.1007/s10886-008-9484-5</pub-id><pub-id pub-id-type="pmid">18581182</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cobb</surname><given-names>M</given-names></name><name><surname>Domain</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Olfactory coding in a simple system: adaptation in Drosophila larvae</article-title><source>PNAS</source><volume><bold>267</bold></volume><fpage>2119</fpage><lpage>2125</lpage><pub-id pub-id-type="doi">10.1098/rspb.2000.1258</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cobb</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>What and how do maggots smell?</article-title><source>Biological Reviews of the Cambridge Philosophical Society</source><volume><bold>74</bold></volume><fpage>425</fpage><lpage>459</lpage><pub-id pub-id-type="doi">10.1017/S0006323199005393</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>AH</given-names></name><name><surname>Ermentrout</surname><given-names>GB</given-names></name><name><surname>Kiemel</surname><given-names>T</given-names></name><name><surname>Kopell</surname><given-names>N</given-names></name><name><surname>Sigvardt</surname><given-names>KA</given-names></name><name><surname>Williams</surname><given-names>TL</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Modelling of intersegmental coordination in the lamprey central pattern generator for locomotion</article-title><source>Trends in Neurosciences</source><volume><bold>15</bold></volume><fpage>434</fpage><lpage>438</lpage><pub-id pub-id-type="doi">10.1016/0166-2236(92)90006-T</pub-id><pub-id pub-id-type="pmid">1281350</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davies</surname><given-names>A</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A model of Drosophila larva chemotaxis</article-title><source>PLoS Computational Biology</source><volume><bold>11</bold></volume><elocation-id>e1004606</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004606</pub-id><pub-id pub-id-type="pmid">26600460</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Palo</surname><given-names>G</given-names></name><name><surname>Facchetti</surname><given-names>G</given-names></name><name><surname>Mazzolini</surname><given-names>M</given-names></name><name><surname>Menini</surname><given-names>A</given-names></name><name><surname>Torre</surname><given-names>V</given-names></name><name><surname>Altafini</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Common dynamical features of sensory adaptation in photoreceptors and olfactory sensory neurons</article-title><source>Scientific Reports</source><volume><bold>3</bold></volume><elocation-id>1251</elocation-id><pub-id pub-id-type="doi">10.1038/srep01251</pub-id><pub-id pub-id-type="pmid">23409242</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diegelmann</surname><given-names>S</given-names></name><name><surname>Klagges</surname><given-names>B</given-names></name><name><surname>Michels</surname><given-names>B</given-names></name><name><surname>Schleyer</surname><given-names>M</given-names></name><name><surname>Gerber</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Maggot learning and Synapsin function</article-title><source>Journal of Experimental Biology</source><volume><bold>216</bold></volume><fpage>939</fpage><lpage>951</lpage><pub-id pub-id-type="doi">10.1242/jeb.076208</pub-id><pub-id pub-id-type="pmid">23447663</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farkas</surname><given-names>SR</given-names></name><name><surname>Shorey</surname><given-names>HH</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Chemical trail-following by flying insects: a mechanism for orientation to a distant odor source</article-title><source>Science</source><volume><bold>178</bold></volume><fpage>67</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1126/science.178.4056.67</pub-id><pub-id pub-id-type="pmid">17754740</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fishilevich</surname><given-names>E</given-names></name><name><surname>Domingos</surname><given-names>AI</given-names></name><name><surname>Asahina</surname><given-names>K</given-names></name><name><surname>Naef</surname><given-names>F</given-names></name><name><surname>Vosshall</surname><given-names>LB</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Chemotaxis behavior mediated by single larval olfactory neurons in Drosophila</article-title><source>Current Biology</source><volume><bold>15</bold></volume><fpage>2086</fpage><lpage>2096</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2005.11.016</pub-id><pub-id pub-id-type="pmid">16332533</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fung</surname><given-names>YC</given-names></name></person-group><year iso-8601-date="2013">2013</year><source>Biomechanics: Mechanical Properties of Living Tissues</source><publisher-loc>New York</publisher-loc><publisher-name>Springer Science &amp; Business Media</publisher-name><pub-id pub-id-type="isbn">978-1-4757-2257-4</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gepner</surname><given-names>R</given-names></name><name><surname>Mihovilovic Skanata</surname><given-names>M</given-names></name><name><surname>Bernat</surname><given-names>NM</given-names></name><name><surname>Kaplow</surname><given-names>M</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Computations underlying <italic>Drosophila</italic> photo-taxis, odor-taxis, and multi-sensory integration</article-title><source>eLife</source><volume><bold>4</bold></volume><elocation-id>e06229</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.06229</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerber</surname><given-names>B</given-names></name><name><surname>Tanimoto</surname><given-names>H</given-names></name><name><surname>Heisenberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>An engram found? evaluating the evidence from fruit flies</article-title><source>Current Opinion in Neurobiology</source><volume><bold>14</bold></volume><fpage>737</fpage><lpage>744</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2004.10.014</pub-id><pub-id pub-id-type="pmid">15582377</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Berck</surname><given-names>M</given-names></name><name><surname>Mathew</surname><given-names>D</given-names></name><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>Kane</surname><given-names>EA</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Controlling airborne cues to study small animal navigation</article-title><source>Nature Methods</source><volume><bold>9</bold></volume><fpage>290</fpage><lpage>296</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1853</pub-id><pub-id pub-id-type="pmid">22245808</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gomez-Marin</surname><given-names>A</given-names></name><name><surname>Duistermars</surname><given-names>BJ</given-names></name><name><surname>Frye</surname><given-names>MA</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Mechanisms of odor-tracking: multiple sensors for enhanced perception and behavior</article-title><source>Frontiers in Cellular Neuroscience</source><volume><bold>4</bold></volume><elocation-id>6</elocation-id><pub-id pub-id-type="doi">10.3389/fncel.2010.00006</pub-id><pub-id pub-id-type="pmid">20407585</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gomez-Marin</surname><given-names>A</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Active sensation during orientation behavior in the Drosophila larva: more sense than luck</article-title><source>Current Opinion in Neurobiology</source><volume><bold>22</bold></volume><fpage>208</fpage><lpage>215</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.11.008</pub-id><pub-id pub-id-type="pmid">22169055</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gomez-Marin</surname><given-names>A</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Multilevel control of run orientation in Drosophila larval chemotaxis</article-title><source>Frontiers in Behavioral Neuroscience</source><volume><bold>8</bold></volume><elocation-id>38</elocation-id><pub-id pub-id-type="doi">10.3389/fnbeh.2014.00038</pub-id><pub-id pub-id-type="pmid">24592220</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gomez-Marin</surname><given-names>A</given-names></name><name><surname>Stephens</surname><given-names>GJ</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Active sampling and decision making in Drosophila chemotaxis</article-title><source>Nature Communications</source><volume><bold>2</bold></volume><elocation-id>441</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms1455</pub-id><pub-id pub-id-type="pmid">21863008</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gong</surname><given-names>Z</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Guo</surname><given-names>C</given-names></name><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Teng</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Two pairs of neurons in the central brain control Drosophila innate light preference</article-title><source>Science</source><volume><bold>330</bold></volume><fpage>499</fpage><lpage>502</lpage><pub-id pub-id-type="doi">10.1126/science.1195993</pub-id><pub-id pub-id-type="pmid">20966250</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname><given-names>CH</given-names></name><name><surname>Burnet</surname><given-names>B</given-names></name><name><surname>Connolly</surname><given-names>KJ</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Organization and patterns of inter- and intraspecific variation in the behaviour of Drosophila larvae</article-title><source>Animal Behaviour</source><volume><bold>31</bold></volume><fpage>282</fpage><lpage>291</lpage><pub-id pub-id-type="doi">10.1016/S0003-3472(83)80198-5</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hangartner</surname><given-names>W</given-names></name></person-group><year iso-8601-date="1969">1969</year><article-title>Structure and variability of the individual odor trail in Solenopsis geminata Fabr. (Hymenoptera, Formicidae)</article-title><source>Journal of Comparative Physiology </source><volume><bold>62</bold></volume><fpage>111</fpage><lpage>120</lpage><pub-id pub-id-type="doi">10.1007/BF00298046</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hernandez-Nunez</surname><given-names>L</given-names></name><name><surname>Belina</surname><given-names>J</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Si</surname><given-names>G</given-names></name><name><surname>Claus</surname><given-names>L</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Reverse-correlation analysis of navigation dynamics in Drosophila larva using optogenetics</article-title><source>eLife</source><volume><bold>4</bold></volume><elocation-id>e06225</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.06225</pub-id><pub-id pub-id-type="pmid">25942453</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hughes</surname><given-names>CL</given-names></name><name><surname>Thomas</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A sensory feedback circuit coordinates muscle activity in Drosophila</article-title><source>Molecular and Cellular Neuroscience</source><volume><bold>35</bold></volume><fpage>383</fpage><lpage>396</lpage><pub-id pub-id-type="doi">10.1016/j.mcn.2007.04.001</pub-id><pub-id pub-id-type="pmid">17498969</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iino</surname><given-names>Y</given-names></name><name><surname>Yoshida</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Parallel use of two behavioral mechanisms for chemotaxis in caenorhabditis elegans</article-title><source>Journal of Neuroscience</source><volume><bold>29</bold></volume><fpage>5370</fpage><lpage>5380</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3633-08.2009</pub-id><pub-id pub-id-type="pmid">19403805</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izquierdo</surname><given-names>EJ</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Evolution and analysis of minimal neural circuits for klinotaxis in caenorhabditis elegans</article-title><source>Journal of Neuroscience</source><volume><bold>30</bold></volume><fpage>12908</fpage><lpage>12917</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2606-10.2010</pub-id><pub-id pub-id-type="pmid">20881110</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kane</surname><given-names>EA</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Afonso</surname><given-names>B</given-names></name><name><surname>Larderet</surname><given-names>I</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Carter</surname><given-names>AR</given-names></name><name><surname>de Bivort</surname><given-names>BL</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name><name><surname>Samuel</surname><given-names>ADT</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Sensorimotor structure of Drosophila larva phototaxis</article-title><source>PNAS</source><volume><bold>110</bold></volume><fpage>E3868</fpage><lpage>E3877</lpage><pub-id pub-id-type="doi">10.1073/pnas.1215295110</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanzaki</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Behavioral and neural basis of instinctive behavior in insects: Odor-source searching strategies without memory and learning</article-title><source>Robotics and Autonomous Systems</source><volume><bold>18</bold></volume><fpage>33</fpage><lpage>43</lpage><pub-id pub-id-type="doi">10.1016/0921-8890(95)00081-X</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>AJ</given-names></name><name><surname>Lazar</surname><given-names>AA</given-names></name><name><surname>Slutskiy</surname><given-names>YB</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>System identification of Drosophila olfactory sensory neurons</article-title><source>Journal of Computational Neuroscience</source><volume><bold>30</bold></volume><fpage>143</fpage><lpage>161</lpage><pub-id pub-id-type="doi">10.1007/s10827-010-0265-0</pub-id><pub-id pub-id-type="pmid">20730480</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Afonso</surname><given-names>B</given-names></name><name><surname>Vonner</surname><given-names>AJ</given-names></name><name><surname>Hernandez-Nunez</surname><given-names>L</given-names></name><name><surname>Berck</surname><given-names>M</given-names></name><name><surname>Tabone</surname><given-names>CJ</given-names></name><name><surname>Kane</surname><given-names>EA</given-names></name><name><surname>Pieribone</surname><given-names>VA</given-names></name><name><surname>Nitabach</surname><given-names>MN</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Garrity</surname><given-names>PA</given-names></name><name><surname>Samuel</surname><given-names>ADT</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Sensory determinants of behavioral dynamics in Drosophila thermotaxis</article-title><source>PNAS</source><volume><bold>112</bold></volume><fpage>E220</fpage><lpage>E229</lpage><pub-id pub-id-type="doi">10.1073/pnas.1416212112</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kohsaka</surname><given-names>H</given-names></name><name><surname>Okusawa</surname><given-names>S</given-names></name><name><surname>Itakura</surname><given-names>Y</given-names></name><name><surname>Fushiki</surname><given-names>A</given-names></name><name><surname>Nose</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Development of larval motor circuits in Drosophila</article-title><source>Development, Growth &amp; Differentiation</source><volume><bold>54</bold></volume><fpage>408</fpage><lpage>419</lpage><pub-id pub-id-type="doi">10.1111/j.1440-169X.2012.01347.x</pub-id><pub-id pub-id-type="pmid">22524610</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krashes</surname><given-names>MJ</given-names></name><name><surname>DasGupta</surname><given-names>S</given-names></name><name><surname>Vreede</surname><given-names>A</given-names></name><name><surname>White</surname><given-names>B</given-names></name><name><surname>Armstrong</surname><given-names>JD</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A neural circuit mechanism integrating motivational state with memory expression in Drosophila</article-title><source>Cell</source><volume><bold>139</bold></volume><fpage>416</fpage><lpage>427</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2009.08.035</pub-id><pub-id pub-id-type="pmid">19837040</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kreher</surname><given-names>SA</given-names></name><name><surname>Mathew</surname><given-names>D</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Translation of sensory input into behavioral output via an olfactory system</article-title><source>Neuron</source><volume><bold>59</bold></volume><fpage>110</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.06.010</pub-id><pub-id pub-id-type="pmid">18614033</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lahiri</surname><given-names>S</given-names></name><name><surname>Shen</surname><given-names>K</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Tang</surname><given-names>A</given-names></name><name><surname>Kane</surname><given-names>E</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Garrity</surname><given-names>P</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Two alternating motor programs drive navigation in <italic>Drosophila</italic> larva</article-title><source>PLoS One</source><volume><bold>6</bold></volume><elocation-id>e23180</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0023180</pub-id><pub-id pub-id-type="pmid">21858019</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lansner</surname><given-names>A</given-names></name><name><surname>Grillner</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Realistic modeling of burst generation and swimming in lamprey</article-title><source>Neurons, Networks and Motor Behavior</source><fpage>165</fpage><lpage>171</lpage></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larkin</surname><given-names>A</given-names></name><name><surname>Karak</surname><given-names>S</given-names></name><name><surname>Priya</surname><given-names>R</given-names></name><name><surname>Das</surname><given-names>A</given-names></name><name><surname>Ayyub</surname><given-names>C</given-names></name><name><surname>Ito</surname><given-names>K</given-names></name><name><surname>Rodrigues</surname><given-names>V</given-names></name><name><surname>Ramaswami</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Central synaptic mechanisms underlie short-term olfactory habituation in Drosophila larvae</article-title><source>Learning &amp; Memory</source><volume><bold>17</bold></volume><fpage>645</fpage><lpage>653</lpage><pub-id pub-id-type="doi">10.1101/lm.1839010</pub-id><pub-id pub-id-type="pmid">21106688</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lemon</surname><given-names>WC</given-names></name><name><surname>Pulver</surname><given-names>SR</given-names></name><name><surname>Höckendorf</surname><given-names>B</given-names></name><name><surname>McDole</surname><given-names>K</given-names></name><name><surname>Branson</surname><given-names>K</given-names></name><name><surname>Freeman</surname><given-names>J</given-names></name><name><surname>Keller</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Whole-central nervous system functional imaging in larval Drosophila</article-title><source>Nature Communications</source><volume><bold>6</bold></volume><elocation-id>7924</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms8924</pub-id><pub-id pub-id-type="pmid">26263051</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levi</surname><given-names>R</given-names></name><name><surname>Varona</surname><given-names>P</given-names></name><name><surname>Arshavsky</surname><given-names>YI</given-names></name><name><surname>Rabinovich</surname><given-names>MI</given-names></name><name><surname>Selverston</surname><given-names>AI</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The role of sensory network dynamics in generating a motor program</article-title><source>Journal of Neuroscience</source><volume><bold>25</bold></volume><fpage>9807</fpage><lpage>9815</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2249-05.2005</pub-id><pub-id pub-id-type="pmid">16237184</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louis</surname><given-names>M</given-names></name><name><surname>Huber</surname><given-names>T</given-names></name><name><surname>Benton</surname><given-names>R</given-names></name><name><surname>Sakmar</surname><given-names>TP</given-names></name><name><surname>Vosshall</surname><given-names>LB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Bilateral olfactory sensory input enhances chemotaxis behavior</article-title><source>Nature Neuroscience</source><volume><bold>11</bold></volume><fpage>187</fpage><lpage>199</lpage><pub-id pub-id-type="doi">10.1038/nn2031</pub-id><pub-id pub-id-type="pmid">18157126</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Rosenzweig</surname><given-names>M</given-names></name><name><surname>Kang</surname><given-names>K</given-names></name><name><surname>Fang-Yen</surname><given-names>C</given-names></name><name><surname>Garrity</surname><given-names>PA</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Navigational decision making in Drosophila thermotaxis</article-title><source>Journal of Neuroscience</source><volume><bold>30</bold></volume><fpage>4261</fpage><lpage>4272</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4090-09.2010</pub-id><pub-id pub-id-type="pmid">20335462</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Calabrese</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Principles of rhythmic motor pattern generation</article-title><source>Physiological Reviews</source><volume><bold>76</bold></volume><fpage>687</fpage><lpage>717</lpage><pub-id pub-id-type="pmid">8757786</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagel</surname><given-names>KI</given-names></name><name><surname>Wilson</surname><given-names>RI</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Biophysical mechanisms underlying olfactory receptor neuron dynamics</article-title><source>Nature Neuroscience</source><volume><bold>14</bold></volume><fpage>208</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1038/nn.2725</pub-id><pub-id pub-id-type="pmid">21217763</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naka</surname><given-names>KI</given-names></name><name><surname>Rushton</surname><given-names>WA</given-names></name></person-group><year iso-8601-date="1966">1966</year><article-title>S-potentials from colour units in the retina of fish (Cyprinidae)</article-title><source>The Journal of Physiology</source><volume><bold>185</bold></volume><fpage>536</fpage><lpage>555</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1966.sp008001</pub-id><pub-id pub-id-type="pmid">5918058</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohashi</surname><given-names>S</given-names></name><name><surname>Morimoto</surname><given-names>T</given-names></name><name><surname>Suzuki</surname><given-names>Y</given-names></name><name><surname>Miyakawa</surname><given-names>H</given-names></name><name><surname>Aonishi</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A novel behavioral strategy, continuous biased running, during chemotaxis in Drosophila larvae</article-title><source>Neuroscience Letters</source><volume><bold>570</bold></volume><fpage>10</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1016/j.neulet.2014.04.011</pub-id><pub-id pub-id-type="pmid">24747684</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohyama</surname><given-names>T</given-names></name><name><surname>Schneider-Mizell</surname><given-names>CM</given-names></name><name><surname>Fetter</surname><given-names>RD</given-names></name><name><surname>Aleman</surname><given-names>JV</given-names></name><name><surname>Franconville</surname><given-names>R</given-names></name><name><surname>Rivera-Alba</surname><given-names>M</given-names></name><name><surname>Mensh</surname><given-names>BD</given-names></name><name><surname>Branson</surname><given-names>KM</given-names></name><name><surname>Simpson</surname><given-names>JH</given-names></name><name><surname>Truman</surname><given-names>JW</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A multilevel multimodal circuit enhances action selection in Drosophila</article-title><source>Nature</source><volume><bold>520</bold></volume><fpage>633</fpage><lpage>-9</lpage><pub-id pub-id-type="doi">10.1038/nature14297</pub-id><pub-id pub-id-type="pmid">25896325</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Owald</surname><given-names>D</given-names></name><name><surname>Felsenberg</surname><given-names>J</given-names></name><name><surname>Talbot</surname><given-names>CB</given-names></name><name><surname>Das</surname><given-names>G</given-names></name><name><surname>Perisse</surname><given-names>E</given-names></name><name><surname>Huetteroth</surname><given-names>W</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Activity of defined mushroom body output neurons underlies learned olfactory behavior in Drosophila</article-title><source>Neuron</source><volume><bold>86</bold></volume><fpage>417</fpage><lpage>427</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.03.025</pub-id><pub-id pub-id-type="pmid">25864636</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rickert</surname><given-names>C</given-names></name><name><surname>Kunz</surname><given-names>T</given-names></name><name><surname>Harris</surname><given-names>KL</given-names></name><name><surname>Whitington</surname><given-names>PM</given-names></name><name><surname>Technau</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Morphological characterization of the entire interneuron population reveals principles of neuromere organization in the ventral nerve cord of Drosophila</article-title><source>Journal of Neuroscience</source><volume><bold>31</bold></volume><fpage>15870</fpage><lpage>15883</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4009-11.2011</pub-id><pub-id pub-id-type="pmid">22049430</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ross</surname><given-names>D</given-names></name><name><surname>Lagogiannis</surname><given-names>K</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><chapter-title>A model of larval biomechanics reveals exploitable passive properties for efficient locomotion</chapter-title><source> Biomimetic and Biohybrid Systems</source><publisher-name>Springer</publisher-name><fpage>1</fpage><lpage>12</lpage></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sachse</surname><given-names>S</given-names></name><name><surname>Beshel</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The good, the bad, and the hungry: how the central brain codes odor valence to facilitate food approach in Drosophila</article-title><source>Current Opinion in Neurobiology</source><volume><bold>40</bold></volume><fpage>53</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.06.012</pub-id><pub-id pub-id-type="pmid">27393869</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sawin</surname><given-names>EP</given-names></name><name><surname>Harris</surname><given-names>LR</given-names></name><name><surname>Campos</surname><given-names>AR</given-names></name><name><surname>Sokolowski</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Sensorimotor transformation from light reception to phototactic behavior inDrosophila larvae (Diptera: Drosophilidae)</article-title><source>Journal of Insect Behavior</source><volume><bold>7</bold></volume><fpage>553</fpage><lpage>567</lpage><pub-id pub-id-type="doi">10.1007/BF02025449</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scherer</surname><given-names>S</given-names></name><name><surname>Stocker</surname><given-names>RF</given-names></name><name><surname>Gerber</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Olfactory learning in individually assayed drosophila larvae</article-title><source>Learning &amp; Memory</source><volume><bold>10</bold></volume><fpage>217</fpage><lpage>225</lpage><pub-id pub-id-type="doi">10.1101/lm.57903</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schleyer</surname><given-names>M</given-names></name><name><surname>Miura</surname><given-names>D</given-names></name><name><surname>Tanimura</surname><given-names>T</given-names></name><name><surname>Gerber</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015a</year><article-title>Learning the specific quality of taste reinforcement in larval Drosophila</article-title><source>eLife</source><volume><bold>4</bold></volume><elocation-id>e04711</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.04711</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schleyer</surname><given-names>M</given-names></name><name><surname>Reid</surname><given-names>SF</given-names></name><name><surname>Pamir</surname><given-names>E</given-names></name><name><surname>Saumweber</surname><given-names>T</given-names></name><name><surname>Paisios</surname><given-names>E</given-names></name><name><surname>Davies</surname><given-names>A</given-names></name><name><surname>Gerber</surname><given-names>B</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015b</year><article-title>The impact of odor-reward memory on chemotaxis in larval Drosophila</article-title><source>Learning &amp; Memory</source><volume><bold>22</bold></volume><fpage>267</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1101/lm.037978.114</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulze</surname><given-names>A</given-names></name><name><surname>Gomez-Marin</surname><given-names>A</given-names></name><name><surname>Rajendran</surname><given-names>VG</given-names></name><name><surname>Lott</surname><given-names>G</given-names></name><name><surname>Musy</surname><given-names>M</given-names></name><name><surname>Ahammad</surname><given-names>P</given-names></name><name><surname>Deogade</surname><given-names>A</given-names></name><name><surname>Sharpe</surname><given-names>J</given-names></name><name><surname>Riedl</surname><given-names>J</given-names></name><name><surname>Jarriault</surname><given-names>D</given-names></name><name><surname>Trautman</surname><given-names>ET</given-names></name><name><surname>Werner</surname><given-names>C</given-names></name><name><surname>Venkadesan</surname><given-names>M</given-names></name><name><surname>Druckmann</surname><given-names>S</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dynamical feature extraction at the sensory periphery guides chemotaxis</article-title><source>eLife</source><volume><bold>4</bold></volume><elocation-id>e06694</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.06694</pub-id><pub-id pub-id-type="pmid">26077825</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szigeti</surname><given-names>B</given-names></name><name><surname>Deogade</surname><given-names>A</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Searching for motifs in the behaviour of larval Drosophila melanogaster and Caenorhabditis elegans reveals continuity between behavioural states</article-title><source>Journal of the Royal Society Interface</source><volume><bold>12</bold></volume><elocation-id>20150899</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2015.0899</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vermeij</surname><given-names>GJ</given-names></name></person-group><year iso-8601-date="1973">1973</year><article-title>Adaptation, versatility, and evolution</article-title><source>Systematic Zoology</source><volume><bold>22</bold></volume><fpage>466</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.2307/2412953</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vogelstein</surname><given-names>JT</given-names></name><name><surname>Park</surname><given-names>Y</given-names></name><name><surname>Ohyama</surname><given-names>T</given-names></name><name><surname>Kerr</surname><given-names>RA</given-names></name><name><surname>Truman</surname><given-names>JW</given-names></name><name><surname>Priebe</surname><given-names>CE</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Discovery of brainwide neural-behavioral maps via multiscale unsupervised structure learning</article-title><source>Science</source><volume><bold>344</bold></volume><fpage>386</fpage><lpage>392</lpage><pub-id pub-id-type="doi">10.1126/science.1250298</pub-id><pub-id pub-id-type="pmid">24674869</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Pu</surname><given-names>Y</given-names></name><name><surname>Shen</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Neuropeptide-gated perception of appetitive olfactory inputs in Drosophila larvae</article-title><source>Cell Reports</source><volume><bold>3</bold></volume><fpage>820</fpage><lpage>830</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2013.02.003</pub-id><pub-id pub-id-type="pmid">23453968</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Willis</surname><given-names>M</given-names></name><name><surname>Arbas</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1997">1997a</year><chapter-title>Centrally patterned behavior generates sensory input for adaptive control</chapter-title><source>Neurons, Networks, and Motor Behavior</source><publisher-loc>Cambridge, Massachusetts</publisher-loc><publisher-name>MIT Press</publisher-name><fpage>269</fpage><lpage>275</lpage></element-citation></ref><ref id="bib66"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Willis</surname><given-names>MA</given-names></name><name><surname>Arbas</surname><given-names>EA</given-names></name></person-group><year iso-8601-date="1997">1997b</year><chapter-title>Active behavior and reflexive responses: another perspective on odor-modulated locomotion</chapter-title><source>Insect Pheromone Research</source><fpage>304</fpage><lpage>319</lpage><publisher-name>Springer US</publisher-name><publisher-loc>Boston, MA</publisher-loc></element-citation></ref><ref id="bib67"><element-citation publication-type="book"><person-group person-group-type="author"><name> <surname>Wilson</surname> <given-names>HR</given-names></name></person-group><year iso-8601-date="1999">1999</year><source>Spikes, Decisions, and Actions: Dynamical Foundations of Neuroscience</source><publisher-name>Oxford University Press</publisher-name><publisher-loc>New York</publisher-loc><pub-id pub-id-type="isbn">978-0198524304</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="web"><person-group person-group-type="author"><collab>Wolfram Research, Inc</collab></person-group><year iso-8601-date="2015">2015</year><article-title>Mathematica 10.1</article-title><ext-link ext-link-type="uri" xlink:href="https://www.wolfram.com">https://www.wolfram.com</ext-link></element-citation></ref><ref id="bib69"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Wystrach</surname><given-names>A</given-names></name><name><surname>Lagogiannis</surname><given-names>K</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Article’s resource repository. GitHub</article-title><ext-link ext-link-type="uri" xlink:href="https://github.com/InsectRobotics/larvaTaxisOscillator">https://github.com/InsectRobotics/larvaTaxisOscillator</ext-link></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>TD</given-names></name><name><surname>Park</surname><given-names>JS</given-names></name><name><surname>Choi</surname><given-names>Y</given-names></name><name><surname>Choi</surname><given-names>W</given-names></name><name><surname>Ko</surname><given-names>TW</given-names></name><name><surname>Lee</surname><given-names>KJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Zigzag turning preference of freely crawling cells</article-title><source>PLoS One</source><volume><bold>6</bold></volume><elocation-id>e20255</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0020255</pub-id><pub-id pub-id-type="pmid">21687729</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.15504.015</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>VijayRaghavan</surname><given-names>K</given-names></name><role>Reviewing editor</role><aff id="aff4"><institution>Tata Institute for Fundamental Research</institution>, <country>India</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Continuous lateral oscillations as a core mechanism for taxis in <italic>Drosophila</italic> larvae&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by two peer reviewers, and the evaluation has been overseen by K VijayRaghavan as the Senior Editor and Reviewing Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Eduardo J Izquierdo (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Wystrach et al. present a simple model for navigation and show that simulations of this model produce trajectories that are consistent with those observed in some measurements of larval <italic>Drosophila</italic> chemotaxis. The paper is clear and well-written, and it is relatively easy to follow the authors' main arguments. The paper provides support for the hypothesis that taxis behavior in <italic>Drosophila</italic> larva is the result of modulation of a single behavior (i.e., a continuous lateral oscillation in the anterior body). Some claims are overstated and there needs to be some work on the Discussion (see below).</p><p>The authors provide experimental evidence through analysis of the larva's body bends showing the presence of continuous lateral oscillation. They then use an idealized computational model to test the hypothesis that modulation of such oscillation in the head is sufficient to reproduce the different orientation strategies observed in the larva (weathervaning, klinotaxis, and klinokinesis). This result is significant because larval taxis has been typically characterized as transitions between multiple behaviors, and this computational model shows a proof of concept that such an assumption is not necessary – and that a simpler strategy is sufficient to account for the observed behavior. The authors present a second model that is continuous in time, to further validate their hypothesis. One of the interesting insights is that the descending sensory signals that control the behavior do not need to be stronger on the different sides of the body. This result echoes the model presented by Izquierdo and Lockery, 2009, as the authors acknowledge.</p><p>Strengths: Overall, the goal, assumptions and insights from the model are rather well presented and easy to follow. Both a discrete and continuous time model are presented. Both make testable predictions that can be compared to existing or easily acquired data. The authors also explain some quantitative measures made in other experiments through the lens of their model.</p><p>Essential revisions:</p><p>Weaknesses and important suggestions for improvement:</p><p>The paper could do a better job of enumerating and consolidating these predictions and especially that the authors would emphasize where their model makes different predictions from existing models of taxis. Instead the emphasis seems to be on showing that their model can produce agreement with existing data. There are two problems with this approach: first, just because a simulation can reproduce an experimental result does not prove the simulation to be correct. Second, the authors have made some odd choices of experimental results with which to compare their model, with emphasis seeming to be on making very broad claims about the model's power, rather than stringently testing its powers of predictions (see technical discussion). Some attention needs to be paid to the citations, which are incomplete and sometimes off-target.</p><p>The authors should be clearer how it is that the model addresses klinokinesis. It is not clear how modulation of the oscillatory pattern can modulate the probability to run/stop. Also, typically klinokinesis involves random reorientation of the heading – is this also accounted for by the modulation of the oscillatory pattern?</p><p>One minor issue with the paper is that it might be lengthier than necessary. While <italic>eLife</italic> does not have a length limit, the authors could do one more pass at the writing to find suitable places to make the wording more succinct. The Discussion section is particularly lengthy.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Continuous lateral oscillations as a core mechanism for taxis in <italic>Drosophila</italic> larvae&quot; for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by K VijayRaghavan as Senior Editor, a Reviewing Editor, and one reviewer.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</p><p>Many of these could have been addressed as they were clearly mentioned in the first set of reviews.</p><p>While we appreciate that the authors have made an effort towards improving this paper, we cannot recommend that it be published in <italic>eLife</italic> as currently written, because it still contains significant flaws that were not corrected in revision. The authors still need to do the following:</p><p>a) Fix notation.</p><p>\nabla s is universally understood to be the gradient of s – a vector of the spatial derivatives of s. Writing (section “4.2 Agent-based simulation in discrete time steps”) &quot;\nabla s_{n-1} = s_{n-1} – s_{n-2} represents the change in the sampled stimulus between time steps n-1 and n-2&quot; is to equate this vector with a scalar difference in the value at two time points. Were it to be published in this form, it would cause great confusion and possibly cause readers to question the mathematical competency of the authors. It is astounding that after this basic error was pointed out gently to the authors, they failed to correct it.</p><p><xref ref-type="disp-formula" rid="equ1">Equation 1</xref> on the same section is open to misinterpretation, because of confusing notation – H(…) is a function, but g(…) represents multiplication by a scalar. The authors put a note below, but it would me much more effective to place a symbol (e.g. g*(…)) to indicate multiplication.</p><p>b) Shorten the manuscript, focusing on significant new results and testable predictions that differentiate the model from existing ones.</p><p>The strengths of this paper are first the novelty of the suggestion that small continuous lateral head movements and larger &quot;head-sweeps&quot; or &quot;head-casts&quot; are in fact the same basic behavior and that modulation of the amplitude of these oscillations is the sole computation underlying navigational behaviors and second the presentation of two numerical model that embody this suggestion. This hypothesis leads to a number of testable predictions about the movements of larvae performing chemotaxis, and publication of this work will likely provoke interesting experimental work to test these predictions. This is why I support publication of the paper in <italic>eLife</italic>.</p><p>As an example of the testable predictions that I hope would be emphasized in a revised paper, consider lines 210-214: The agent tends to spend more time with the odour on its sides. Is this true only for radially symmetric odorant distributions created by diffusion from droplets (in which case this may be a geometric effect), or in a linear gradient would we expect that larvae would also be more likely to orient at angles to the direction of highest concentration? Run and tumble models would predict that in a linear gradient, the most probable orientation would be directly towards higher concentration, so this is a significant prediction that differentiates this model from others.</p><p>The second paragraph of the section “4.2 Agent-based simulation in discrete time steps” details another prediction that can test the model: if you provide a sharp stimulus change at a particular point in the oscillatory cycle, you should evoke a particular pattern of movement that is different from what would be predicted by the head-sweep acceptance model. I think this prediction could be extended or amplified – does it imply a resonant frequency at which an applied stimulus would evoke the greatest changes?</p><p>The third paragraph of the section “4.2 Agent-based simulation in discrete time steps” on the other hand does not present a test of the model: although lateralized sensing is not required for the model to function, it does not follow that the larva cannot have a lateralized internal representation of body posture, any more than the fact that the model does not include cessation of forward movement means that the larva cannot stop. So being able to condition a larva to turn left would not falsify the model; conversely the failure of lateralized operant conditioning could indeed be due to a lack of lateralized internal representation but also to a number of other causes (to my knowledge, no one has demonstrated that larvae can be operantly conditioned in any context). It is also not clear that the competing &quot;run and tumble&quot; model based on state transitions requires a lateralized internal representation.</p><p>c) Greatly reduce discussion of effects of changing gain and eliminate speculation about circuit function.</p><p>The simple model presented here – response to odor is linear in odor change with rectification and saturation – is not a complete description of chemotaxis. For instance, invariant response to odor over orders of magnitude concentration requires that the gain be a function of concentration, but this is not incorporated in mathematical description of the model in section 4. Further, current research indicates that olfactory receptor neurons do not respond linearly to odor concentrations (or to changes in odor concentration) and that behavioral responses to olfactory neuron activity are also nonlinear. It's completely fine to present a simplified model, especially if it makes it easier to understand the main features, but too much of the paper then focuses on the trivial results of adjusting these simplified model parameters.</p><p>Any model of olfaction necessarily has a &quot;gain,&quot; a conversion from odor concentration (measured in number or mass per volume) to sensory neuron activity (measured in spikes per second, membrane voltage, inward current, etc.). For reduced models that do not attempt to represent the full neural pathway, the &quot;gain&quot; may instead represent a transformation from odor concentration to activity in some downstream neuron or a more generalized neural representation of odor quality and quantity. In the case, as presented here, that the gain simply multiplies the input stimulus, inverting the gain is mathematically equivalent to inverting the input stimulus, with the effect that taxis towards high concentration becomes taxis towards low concentration and vice versa. It is a completely trivial result that a switch from attraction to aversion can be effected by inverting the gain; to understand learning the interesting research question, not addressed in this work, is how this inversion is accomplished, especially in an odor-specific manner.</p><p>To be clear, &quot;gain&quot; is a model fit parameter. It has a well-defined meaning only in the context of section 4.2, <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> and section 4.3 <xref ref-type="disp-formula" rid="equ9">Equation 23</xref>. Discussion about learning changing gain, olfactory receptor neurons summing gain, motivation or habituation modifying gain, etc. are simply repeating the fact that changing this model parameter changes the behavior of the model. The authors should go back over their manuscript and remove (or shorten to at most a few sentences of discussion in total) any part that discusses the effect of changing the gain, unless they also present a testable, quantitative, and mechanistic explanation of how this change is accomplished.</p><p>The authors should also remove the discussion of neuroanatomical circuit elements. Nothing in the model as written directly represents any part of the larva's nervous system (even the continuous time model uses a simplified CPG model adapted from lamprey, with no evidence that such a system actually exists in <italic>Drosophila</italic> larvae). Attempting to place abstract and generalized model features into specific circuit contexts only leads to confusion and contradiction.</p><p>As an example, in section 3.5, it is proposed that ORNs respond with an ORN-odor-specific gain and that these gains are summed together to produce the overall response to an odor. (This is not entirely consistent with the existing understanding of <italic>Drosophila</italic>'s olfactory system, which includes mutual inhibition mediated by local interneurons in the (larval) antennal lobe.) In section 2.6, learning is modeled as a change in gain. Taken together, 2.6 and 3.5 imply learning results from changes in responses of ORNs to odors. This contradicts both the current consensus of the field and the discussion in the later parts of section 3, which place learning at the mushroom bodies.</p><p>We recommend that section(s) 2.5 be shortened significantly, 2.6-2.8 eliminated entirely, 3.5 and 3.6 eliminated entirely, and 3.8 refocused on testable behavioral predictions, not on circuit architecture. In the rest of the manuscript, the authors should take the opportunity presented by another round of revision to consider what is most essential about this work and shorten the manuscript so that these important features are not lost. The Discussion currently occupies 10 manuscript pages (1/3 of the paper excluding Methods). I would recommend that it be shortened to at the very most 5 pages, and preferably 3.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.15504.016</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>[…] Essential revisions:</italic> </p><p><italic>Weaknesses and important suggestions for improvement:</italic> </p><p><italic>The paper could do a better job of enumerating and consolidating these predictions and especially that the authors would emphasize where their model makes different predictions from existing models of taxis. Instead the emphasis seems to be on showing that their model can produce agreement with existing data. There are two problems with this approach: first, just because a simulation can reproduce an experimental result does not prove the simulation to be correct.</italic> </p><p>We have now explicitly consolidated the predictions of our model in a new section of the discussion dedicated to predictions (3.8), which also attempts a comparison to previous models.</p><p>To our knowledge the only explicit simulation models of larval chemotaxis published to date are Schleyer et al. 2015, Davies et al. 2015 and Ohashi et al. 2014. All three have in common that they can be formulated as a markovian state transition model, assuming a switch between a turning (re- orientation) state, during which the larva is stopped, and a run state. However, only the Davies et al. 2015 gives a mechanistic account of how chemotaxis operates (state transition probabilities being functions of recent sensory input which is dependent on movement of a sensor through the gradient).</p><p>The Schleyer et al. 2015 and Ohashi et al. 2014 models instead are using an agent to either evaluate if measured variables can explain changes in chemotaxis performance (e.g. in Schleyer et al. 2015 the agent's head- turn angle is randomly chosen by sampling an empirical distribution at a region defined by bearing-to-odour and distance from odour source) or to examine the contribution of weathervaning (biased runs) to chemotaxis performance. As such, direct comparison of predictions is difficult.</p><p>Nonetheless, with this new prediction section, we believe it is now clear that our model does not just confirm existing results but provide new and unexpected predictions, some of which we could actually test through our new analysis of the data presented here.</p><p><italic>Second, the authors have made some odd choices of experimental results with which to compare their model, with emphasis seeming to be on making very broad claims about the model's power, rather than stringently testing its powers of predictions (see technical discussion).</italic> </p><p>We have now clarified our choice of experimental results, which include both specific predictions, and exploration of the broader explanatory power, which we think is particularly important given the simplicity of the underlying concept. See further response under technical discussion.</p><p><italic>Some attention needs to be paid to the citations, which are incomplete and sometimes off-target.</italic> </p><p>Indeed, we have added Ohashi et al. 2014, Gershow et al. 2012 in relevance to the Davies et al. 2015 model, and also the work on temperature gradients (Klein et al., 2014; Luo et al. 2010) as suggested. Also, Asahina et al. 2009 and Gomez-Marin et al. 2011 were added to the discussion on ORN saturation and the conversion to repulsion.</p><p><italic>The authors should be clearer how it is that the model addresses klinokinesis. It is not clear how modulation of the oscillatory pattern can modulate the probability to run/stop. Also, typically klinokinesis involves random reorientation of the heading – is this also accounted for by the modulation of the oscillatory pattern?</italic> </p><p>The models presented in this paper do not include (do not address) klinokinesis (stopping). This was a deliberate decision as our goal is to understand the extent to which the oscillatory mechanism alone could produce chemotaxis phenomena, and we have now clarified this point. Nevertheless, it is reasonable to ask how stopping behaviour, which is apparent in larval chemotaxis, could be integrated into the model in future. As such, in the Discussion (3.7) we tentatively suggest a mechanism for stopping (Figure 12D) that could combine with oscillation. We have now revised this section of the Discussion to clarify the extent to which this mechanism is, and is not, consistent with existing experimental data (we included the suggested citations) and what it would predict.</p><p><italic>One minor issue with the paper is that it might be lengthier than necessary. While eLife does not have a length limit, the authors could do one more pass at the writing to find suitable places to make the wording more succinct. The Discussion section is particularly lengthy.</italic> </p><p>We have tried to improve the wording to make the paper more concise.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p><italic>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</italic> </p><p><italic>Many of these could have been addressed as they were clearly mentioned in the first set of reviews.</italic> </p><p><italic>While we appreciate that the authors have made an effort towards improving this paper, we cannot recommend that it be published in eLife as currently written, because it still contains significant flaws that were not corrected in revision. The authors still need to do the following:</italic> </p><p> <italic>a) Fix notation.</italic></p><p><italic>\nabla s is universally understood to be the gradient of s – a vector of the spatial derivatives of s. Writing (section “4.2 Agent-based simulation in discrete time steps”) &quot;\nabla s_{n-1} = s_{n-1} – s_{n-2} represents the change in the sampled stimulus between time steps n-1 and n-2&quot; is to equate this vector with a scalar difference in the value at two time points. Were it to be published in this form, it would cause great confusion and possibly cause readers to question the mathematical competency of the authors. It is astounding that after this basic error was pointed out gently to the authors, they failed to correct it.</italic> </p><p>We now appreciate that this use of \nabla may be confusing to some readers and we have removed it from the manuscript and modified <xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig9">9</xref> accordingly.</p><p>Our use of \nabla was referring to the backwards operator as used in discrete mathematics and the mathematics of finite differences to denote differences: \nabla f(t) = f(t) – f(t-dt), or \nabla x_n = x_n – x_{n-1} (see [1]), whereas the</p><p>operator \Delta is meant to denote forward differences \Delta s_n = s_{n+1} – s_n. Therefore, we believe using \Delta may also be confusing to some readers as this would require us to adjust the indexing of the algorithm to read\Delta s_{n-2} at step n (i.e. a value from two steps back).</p><p>In order to avoid any unnecessary confusion, we have decided to define a new variable p_n = s_n – s_{n-1}, and added a step to the algorithm to assign this new variable.</p><p><italic><xref ref-type="disp-formula" rid="equ1">Equation (1)</xref> on the same section is open to misinterpretation, because of confusing notation – H(…) is a function, but g(…) represents multiplication by a scalar. The authors put a note below, but it would me much more effective to place a symbol (e.g. g*(…)) to indicate multiplication.</italic> </p><p>We have introduced the \times symbol to clarify multiplication.</p><p> <italic>b) Shorten the manuscript, focusing on significant new results and testable predictions that differentiate the model from existing ones.</italic></p><p><italic>The strengths of this paper are first the novelty of the suggestion that small continuous lateral head movements and larger &quot;head-sweeps&quot; or &quot;head-casts&quot; are in fact the same basic behavior and that modulation of the amplitude of these oscillations is the sole computation underlying navigational behaviors and second the presentation of two numerical model that embody this suggestion. This hypothesis leads to a number of testable predictions about the movements of larvae performing chemotaxis, and publication of this work will likely provoke interesting experimental work to test these predictions. This is why I support publication of the paper in eLife.</italic> </p><p><italic>As an example of the testable predictions that I hope would be emphasized in a revised paper, consider lines 210-214: The agent tends to spend more time with the odour on its sides. Is this true only for radially symmetric odorant distributions created by diffusion from droplets (in which case this may be a geometric effect), or in a linear gradient would we expect that larvae would also be more likely to orient at angles to the direction of highest concentration? Run and tumble models would predict that in a linear gradient, the most probable orientation would be directly towards higher concentration, so this is a significant prediction that differentiates this model from others.</italic> </p><p>Indeed, such experiments would be ideal, as they would allow a clear cut and an accessible way to discriminate models. Given our agent's behaviour in gradients is rather predictable however, we believe the example proposed would not be able to discriminate between models. Our agent stops re-orienting when the change in sensory stimuli is balanced between the left and the right part of the oscillation. Thus, it will re-orient itself towards the high-gradient, in essence operating as a gradient ascent algorithm tracking the odour-peak. In this sense it is indeed the radial distributions that give rise to the orbital behaviour and the agent spending more time with the odour on its side.</p><p><italic>The second paragraph of the section “4.2 Agent-based simulation in discrete time steps” details another prediction that can test the model: if you provide a sharp stimulus change at a particular point in the oscillatory cycle, you should evoke a particular pattern of movement that is different from what would be predicted by the head-sweep acceptance model. I think this prediction could be extended or amplified – does it imply a resonant frequency at which an applied stimulus would evoke the greatest changes?</italic> </p><p>Correctly so, here we point to the model's general prediction that responses would be stimulus-timing depend against the oscillation phase. This is a general property arising from the coupled neural oscillator implementation; according to which stimuli perturb the oscillator dynamics and the response will depend on state of the oscillator at the time of stimulation.</p><p>However, the neurons we have used in this implementation are simplified spike-rate models and we expect that introducing spiking neural models, either phenomenological or biologically inspired ones would produce richer and more complicated stimulus responses. Thus, the idea that there may be particular stimulation patterns that resonate with the dynamics to amplify head-sweeps is very interesting, however we believe such predictions should be deferred for when some of the neural dynamics of the oscillator (which we suggest could be located in the VNC) have been identified so we can produce richer models and more specific predictions on stimulus-response.</p><p><italic>The third paragraph of the section “4.2 Agent-based simulation in discrete time steps” on the other hand does not present a test of the model: although lateralized sensing is not required for the model to function, it does not follow that the larva cannot have a lateralized internal representation of body posture, any more than the fact that the model does not include cessation of forward movement means that the larva cannot stop. So being able to condition a larva to turn left would not falsify the model; conversely the failure of lateralized operant conditioning could indeed be due to a lack of lateralized internal representation but also to a number of other causes (to my knowledge, no one has demonstrated that larvae can be operantly conditioned in any context). It is also not clear that the competing &quot;run and tumble&quot; model based on state transitions requires a lateralized internal representation.</italic> </p><p>We have removed this paragraph.</p><p> <italic>c) Greatly reduce discussion of effects of changing gain and eliminate speculation about circuit function.</italic></p><p><italic>The simple model presented here – response to odor is linear in odor change with rectification and saturation – is not a complete description of chemotaxis. For instance, invariant response to odor over orders of magnitude concentration requires that the gain be a function of concentration, but this is not incorporated in mathematical description of the model in section 4. Further, current research indicates that olfactory receptor neurons do not respond linearly to odor concentrations (or to changes in odor concentration) and that behavioral responses to olfactory neuron activity are also nonlinear. It's completely fine to present a simplified model, especially if it makes it easier to understand the main features, but too much of the paper then focuses on the trivial results of adjusting these simplified model parameters.</italic> </p><p>The sections examining and/ or discussing the effects of gain change have been significantly reduced (see later comments on removal of sections).</p><p><italic>Any model of olfaction necessarily has a &quot;gain,&quot; a conversion from odor concentration (measured in number or mass per volume) to sensory neuron activity (measured in spikes per second, membrane voltage, inward current, etc.). For reduced models that do not attempt to represent the full neural pathway, the &quot;gain&quot; may instead represent a transformation from odor concentration to activity in some downstream neuron or a more generalized neural representation of odor quality and quantity. In the case, as presented here, that the gain simply multiplies the input stimulus, inverting the gain is mathematically equivalent to inverting the input stimulus, with the effect that taxis towards high concentration becomes taxis towards low concentration and vice versa. It is a completely trivial result that a switch from attraction to aversion can be effected by inverting the gain; to understand learning the interesting research question, not addressed in this work, is how this inversion is accomplished, especially in an odor-specific manner.</italic> </p><p>In section 3.2 we clarify our view of how odour-specific gain inversion can be implemented in learning. In short, it is synaptic plasticity from Kenyon Cells (KCs) to mushroom body output neurons (MBONs) that can modify the effectiveness of the MB pathway to relay sensory signals, in an odour-specific way. A change in the sign of the gain corresponds to altering the balance between signal transmission via attractive and aversive MBONs enough such that, after convergence with the other pathways, the sign of the net sum is also inverted leading to inverting motor system responses to sensory stimuli (aversion vs. attraction).</p><p><italic>To be clear, &quot;gain&quot; is a model fit parameter. It has a well-defined meaning only in the context of section 4.2, <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> and section 4.3 <xref ref-type="disp-formula" rid="equ9">Equation 23</xref>. Discussion about learning changing gain, olfactory receptor neurons summing gain, motivation or habituation modifying gain, etc. are simply repeating the fact that changing this model parameter changes the behavior of the model. The authors should go back over their manuscript and remove (or shorten to at most a few sentences of discussion in total) any part that discusses the effect of changing the gain, unless they also present a testable, quantitative, and mechanistic explanation of how this change is accomplished.</italic> </p><p>We agree that the gain is only a model parameter, and we have clarified this in the manuscript: “This ‘gain’ is only a model parameter and does not represent any specific neuro-anatomical feature in larvae. Rather it could be seen as the net sum of all pathways from the stimulation of sensory receptors to muscle contraction.” (see section 3.2, which has now been shortened).</p><p>In contrast to other models we think what is important to stress here is that this model requires only one degree of freedom to capture a substantial range of characteristics of the animal's behaviour, under various conditions and this is potentially significant for understanding the underlying mechanism of chemotaxis.</p><p>The crucial conceptual point is that this variety of effects may simply &quot;sum up&quot;. This idea, if correct, has strong consequences for the underlying circuits.</p><p>We now try to convey this idea succinctly in section 3.2 (simple sensory mapping), and transferred the gist of the results into a single result section 2.5 and associated <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p><p>Note that we removed entirely the story about fructose, phasic and tonic connections (ex-sections 2.8 and 3.4).</p><p><italic>The authors should also remove the discussion of neuroanatomical circuit elements. Nothing in the model as written directly represents any part of the larva's nervous system (even the continuous time model uses a simplified CPG model adapted from lamprey, with no evidence that such a system actually exists in Drosophila larvae). Attempting to place abstract and generalized model features into specific circuit contexts only leads to confusion and contradiction.</italic> </p><p><italic>As an example, in section 3.5, it is proposed that ORNs respond with an ORN-odor-specific gain and that these gains are summed together to produce the overall response to an odor. (This is not entirely consistent with the existing understanding of Drosophila's olfactory system, which includes mutual inhibition mediated by local interneurons in the (larval) antennal lobe.) In section 2.6, learning is modeled as a change in gain. Taken together, 2.6 and 3.5 imply learning results from changes in responses of ORNs to odors. This contradicts both the current consensus of the field and the discussion in the later parts of section 3, which place learning at the mushroom bodies.</italic> </p><p>We have now removed most instances and clarified the connection between the model and 'circuit speculation' to prevent confusion. Much of it was already gone with the deleted sections (see above). However, as we argued above, we believe that discussion of neuroanatomical circuits should not be removed entirely, as it may yield specific predictions for neuro- biologists; for example, in our predictions we have the following sentence (which we were asked to elaborate on): “…our model suggests that the mushroom body pathway is yet another pathway that converges to modify the effective gain in the motor system, and thus MBON valence would also be sensitive to activation timing.”</p><p>We also kept a short Discussion in section 3.1 on evidence towards a CPG in the ventral nerve cord and how lateral bending is linked to cross-connections, which serves to materialize the nature of our oscillator.</p><p>Otherwise we removed the general discussion about OSN, CPGs, as well as the subesophageal zone as a potential candidate for the convergence of the multiple sensory inputs.</p><p><italic>We recommend that section(s) 2.5 be shortened significantly, 2.6-2.8 eliminated entirely, 3.5 and 3.6 eliminated entirely, and 3.8 refocused on testable behavioral predictions, not on circuit architecture. In the rest of the manuscript, the authors should take the opportunity presented by another round of revision to consider what is most essential about this work and shorten the manuscript so that these important features are not lost. The Discussion currently occupies 10 manuscript pages (1/3 of the paper excluding Methods). I would recommend that it be shortened to at the very most 5 pages, and preferably 3.</italic> </p><p>We removed as suggested, the sections 2.5 2.6, 2.7, 2.8 (and their respective figures) and also the respective Discussion ex-section 3.4,</p><p>3.5 and 3.6, and changed the section title of 2.5 to encompass discussion on change of gain which we rewrote for terseness. Our Discussion was 3300 words is now 1800 words.</p></body></sub-article></article>