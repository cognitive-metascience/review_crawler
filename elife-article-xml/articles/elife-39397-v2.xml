<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">39397</article-id><article-id pub-id-type="doi">10.7554/eLife.39397</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Learning protein constitutive motifs from sequence data</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-115548"><name><surname>Tubiana</surname><given-names>Jérôme</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8878-5620</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-116451"><name><surname>Cocco</surname><given-names>Simona</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1852-7789</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-37041"><name><surname>Monasson</surname><given-names>Rémi</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4459-0204</contrib-id><email>monasson@lpt.ens.fr</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Laboratory of Physics of the Ecole Normale Supérieure</institution><institution>CNRS UMR 8023 &amp; PSL Research</institution><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Colwell</surname><given-names>Lucy J</given-names></name><role>Reviewing Editor</role><aff><institution>Cambridge University</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role>Senior Editor</role><aff><institution>Max Planck Institute for Developmental Biology</institution><country>Germany</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>12</day><month>03</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e39397</elocation-id><history><date date-type="received" iso-8601-date="2018-10-03"><day>03</day><month>10</month><year>2018</year></date><date date-type="accepted" iso-8601-date="2019-02-24"><day>24</day><month>02</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Tubiana et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Tubiana et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-39397-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.39397.001</object-id><p>Statistical analysis of evolutionary-related protein sequences provides information about their structure, function, and history. We show that Restricted Boltzmann Machines (RBM), designed to learn complex high-dimensional data and their statistical features, can efficiently model protein families from sequence information. We here apply RBM to 20 protein families, and present detailed results for two short protein domains (Kunitz and WW), one long chaperone protein (Hsp70), and synthetic lattice proteins for benchmarking. The features inferred by the RBM are biologically interpretable: they are related to structure (residue-residue tertiary contacts, extended secondary motifs (α-helixes and β-sheets) and intrinsically disordered regions), to function (activity and ligand specificity), or to phylogenetic identity. In addition, we use RBM to design new protein sequences with putative properties by composing and 'turning up' or 'turning down' the different modes at will. Our work therefore shows that RBM are versatile and practical tools that can be used to unveil and exploit the genotype–phenotype relationship for protein families.</p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.39397.002</object-id><title>eLife digest</title><p>Almost every process that keeps a cell alive depends on the activities of several proteins. All proteins are made from chains of smaller molecules called amino acids, and the specific sequence of amino acids determines the protein’s overall shape, which in turn controls what the protein can do. Yet, the relationships between a protein’s structure and its function are complex, and it remains unclear how the sequence of amino acids in a protein actually determine its features and properties.</p><p>Machine learning is a computational approach that is often applied to understand complex issues in biology. It uses computer algorithms to spot statistical patterns in large amounts of data and, after 'learning' from the data, the algorithms can then provide new insights, make predictions or even generate new data.</p><p>Tubiana et al. have now used a relatively simple form of machine learning to study the amino acid sequences of 20 different families of proteins. First, frameworks of algorithms –known as Restricted Boltzmann Machines, RBM for short – were trained to read some amino-acid sequence data that coded for similar proteins. After ‘learning’ from the data, the RBM could then infer statistical patterns that were common to the sequences. Tubiana et al. saw that many of these inferred patterns could be interpreted in a meaningful way and related to properties of the proteins. For example, some were related to known twists and loops that are commonly found in proteins; others could be linked to specific activities. This level of interpretability is somewhat at odds with the results of other common methods used in machine learning, which tend to behave more like a ‘black box’.</p><p>Using their RBM, Tubiana et al. then proposed how to design new proteins that may prove to have interesting features. In the future, similar methods could be applied across computational biology as a way to make sense of complex data in an understandable way.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>sequence analysis</kwd><kwd>machine learning</kwd><kwd>coevolution</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007649</institution-id><institution>École Normale Supérieure</institution></institution-wrap></funding-source><award-id>Allocation Specifique</award-id><principal-award-recipient><name><surname>Tubiana</surname><given-names>Jérôme</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>CE30-0021-01 RBMPro</award-id><principal-award-recipient><name><surname>Cocco</surname><given-names>Simona</given-names></name><name><surname>Monasson</surname><given-names>Rémi</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A new machine-learning toolbox unveils coevolutionary protein motifs related to structure, function, and phylogeny from sequence information only.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>In recent years, the sequencing of many organisms' genomes has led to the collection of a huge number of protein sequences, which are catalogued in databases such as UniProt or PFAM <xref ref-type="bibr" rid="bib22">Finn et al., 2014</xref>). Sequences that share a common ancestral origin, defining a family (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), are likely to code for proteins with similar functions and structures, providing a unique window into the relationship between genotype (sequence content) and phenotype (biological features). In this context, various approaches have been introduced to infer protein properties from sequence data statistics, in particular amino-acid conservation and coevolution (correlation) (<xref ref-type="bibr" rid="bib79">Teppa et al., 2012</xref>; <xref ref-type="bibr" rid="bib16">de Juan et al., 2013</xref>).</p><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.003</object-id><label>Figure 1.</label><caption><title>Reverse and forward modeling of proteins.</title><p>(<bold>A</bold>) Example of Multiple-Sequence Alignment (MSA), here of the WW domain (PF00397). Each column <inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> corresponds to a site on the protein, and each line to a different sequence in the family. The color code for amino acids is as follows: red = negative charge (E,D), blue = positive charge (H, K, R), purple = non charged polar (hydrophilic) (N, T, S, Q), yellow = aromatic (F, W, Y), black = aliphatic hydrophobic (I, L, M, V), green = cysteine (C), grey = other, small amino acids (A, G, P). (<bold>B</bold>) In a Restricted Boltzmann Machine (RBM), weights <inline-formula><mml:math id="inf2"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> connect the visible layer (carrying protein sequences <inline-formula><mml:math id="inf3"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula>) to the hidden layer (carrying representations <inline-formula><mml:math id="inf4"><mml:mi mathvariant="bold">𝐡</mml:mi></mml:math></inline-formula>). Biases on the visible and hidden units are introduced by the local potentials <inline-formula><mml:math id="inf5"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf6"><mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Owing to the bipartite nature of the weight graph, hidden units are conditionally independent given a visible configuration, and vice versa. (<bold>C</bold>) Sequences <inline-formula><mml:math id="inf7"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> in the MSA (dots in sequence space, left) code for proteins with different phenotypes (dot colors). RBM define a probabilistic mapping from sequences <inline-formula><mml:math id="inf8"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> onto the representation space <inline-formula><mml:math id="inf9"><mml:mi mathvariant="bold">𝐡</mml:mi></mml:math></inline-formula> (right), which is indicative of the phenotype of the corresponding protein and encoded in the conditional distribution <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐡</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ3">Equation (3)</xref> (black arrow). The reverse mapping from representations to sequences is <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐡</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref> (black arrow). In turn, sampling a subspace in the representation space (colored domains) defines a complex subset of the sequence space, and allows the design of sequences with putative phenotypic properties that are either found in the MSA (green circled dots) or not encountered in Nature (arrow out of blue domain). (<bold>D</bold>) Three examples of potentials <inline-formula><mml:math id="inf12"><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi></mml:math></inline-formula> defining the hidden-unit type in RBM (see <xref ref-type="disp-formula" rid="equ1">Equation (1)</xref> and panel (B)): quadratic (black, <inline-formula><mml:math id="inf13"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) and double Rectified Linear Unit (dReLU) (dReLU1 (green), <inline-formula><mml:math id="inf15"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>; and dReLU2 (purple), <inline-formula><mml:math id="inf17"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf18"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf19"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf20"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math></inline-formula>) potentials. In practice, the parameters of the hidden unit potentials are fixed through learning of the sequence data. (<bold>E</bold>) Average activity of hidden unit <inline-formula><mml:math id="inf21"><mml:mi>h</mml:mi></mml:math></inline-formula>, calculated from <xref ref-type="disp-formula" rid="equ3">Equation (3)</xref>, as a function of the input <inline-formula><mml:math id="inf22"><mml:mi>I</mml:mi></mml:math></inline-formula> defined in <xref ref-type="disp-formula" rid="equ2">Equation (2)</xref>. The three curves correspond to the three choices of potentials in panel (A). For the quadratic potential (black), the average activity is a linear function of <inline-formula><mml:math id="inf23"><mml:mi>I</mml:mi></mml:math></inline-formula>. For dReLU1 (green), small inputs <inline-formula><mml:math id="inf24"><mml:mi>I</mml:mi></mml:math></inline-formula> barely activate the hidden unit, whereas dReLU2 (Purple) essentially binarizes the inputs <inline-formula><mml:math id="inf25"><mml:mi>I</mml:mi></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-fig1-v2.tif"/></fig><p>A major objective of these approaches is to identify positions carrying amino acids that have critical impact on the protein function, such as catalytic sites, binding sites, or specificity-determining sites that control ligand specificity. Principal component analysis (PCA) of the sequence data can be used to unveil groups of coevolving sites that have a specific functional role <xref ref-type="bibr" rid="bib66">Russ et al., 2005</xref>; <xref ref-type="bibr" rid="bib61">Rausell et al., 2010</xref>; <xref ref-type="bibr" rid="bib28">Halabi et al., 2009</xref>. Other methods rely on phylogeny <xref ref-type="bibr" rid="bib65">Rojas et al., 2012</xref>, entropy (variability in amino-acid content) <xref ref-type="bibr" rid="bib62">Reva et al., 2007</xref>, or a hybrid combination of both <xref ref-type="bibr" rid="bib52">Mihalek et al., 2004</xref>; <xref ref-type="bibr" rid="bib4">Ashkenazy et al., 2016</xref>.</p><p>Another objective is to extract structural information, such as the contact map of the three-dimensional fold. Considerable progress was brought by maximum-entropy methods, which rely on the computation of direct couplings between sites reproducing the pairwise coevolution statistics in the sequence data <xref ref-type="bibr" rid="bib43">Lapedes et al., 1999</xref>; <xref ref-type="bibr" rid="bib83">Weigt et al., 2009</xref>; <xref ref-type="bibr" rid="bib36">Jones et al., 2012</xref>; <xref ref-type="bibr" rid="bib15">Cocco et al., 2018</xref>. Direct couplings provide very good estimators of contacts <xref ref-type="bibr" rid="bib55">Morcos et al., 2011</xref>; <xref ref-type="bibr" rid="bib31">Hopf et al., 2012</xref>; <xref ref-type="bibr" rid="bib37">Kamisetty et al., 2013</xref>; <xref ref-type="bibr" rid="bib18">Ekeberg et al., 2014</xref> and capture the pairwise epistasis effects necessary to model the fitness changes that result from mutations <xref ref-type="bibr" rid="bib48">Mann et al., 2014</xref>; <xref ref-type="bibr" rid="bib21">Figliuzzi et al., 2016</xref>; <xref ref-type="bibr" rid="bib32">Hopf et al., 2017</xref>.</p><p>Despite these successes, we still do not have a unique, accurate framework that is capable of extracting the structural and functional features common to a protein family, as well as the phylogenetic variations specific to sub-families. Hereafter, we consider Restricted Boltzmann Machines (RBM) for this purpose. RBM are a powerful concept coming from machine learning <xref ref-type="bibr" rid="bib1">Ackley et al., 1987</xref>; <xref ref-type="bibr" rid="bib30">Hinton, 2012</xref>; they are unsupervised (sequence data need not be annotated) and generative (able to generate new data). Informally speaking, RBM learn complex data distributions through their statistical features (<xref ref-type="fig" rid="fig1">Figure 1B</xref>).</p><p>In the present work, we have developed a method to train efficiently RBM from protein sequence data. To illustrate the power and versatility of RBM, we have applied our approach to the sequence alignments of 20 different protein families. We report the results of our approach, with special emphasis on four families — the Kunitz domain (a protease inhibitor that is historically important for protein structure determination <xref ref-type="bibr" rid="bib3">Ascenzi et al., 2003</xref>, the WW domain (a short module binding different classes of ligands (<xref ref-type="bibr" rid="bib76">Sudol et al., 1995</xref>, Hsp70 (a large chaperone protein <xref ref-type="bibr" rid="bib11">Bukau and Horwich, 1998</xref>), and lattice-protein in silico data <xref ref-type="bibr" rid="bib69">Shakhnovich and Gutin, 1990</xref>; <xref ref-type="bibr" rid="bib53">Mirny and Shakhnovich, 2001</xref> — to benchmark our approach on exactly solvable models <xref ref-type="bibr" rid="bib34">Jacquin et al., 2016</xref>. Our study shows that RBM are able to capture: (1) structure-related features, be they local (such as tertiary contacts), extended such as secondary structure motifs (<inline-formula><mml:math id="inf26"><mml:mi>α</mml:mi></mml:math></inline-formula>-helix and <inline-formula><mml:math id="inf27"><mml:mi>β</mml:mi></mml:math></inline-formula>-sheet)) or characteristic of intrinsically disordered regions; (2) functional features, that is groups of amino acids controling specificity or activity; and (3) phylogenetic features, related to sub-families sharing evolutionary determinants. Some of these features involve only two residues (as direct pairwise couplings do), others extend over large and not necessarily contiguous portions of the sequence (as in collective modes extracted with PCA). The pattern of similarities of each sequence with the inferred features defines a multi-dimensional representation of this sequence, which is highly informative about the biological properties of the corresponding protein (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Focusing on representations of interest allows us, in turn, to design new sequences with putative functional properties. In summary, our work shows that RBM offer an effective computational tool that can be used to characterize and exploit quantitatively the genotype–phenotype relationship that is specific to a protein family.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Restricted Boltzmann Machines</title><sec id="s2-1-1"><title>Definition</title><p>A Restricted Boltzmann Machine (RBM) is a joint probabilistic model for sequences and representations (see <xref ref-type="fig" rid="fig1">Figure 1C</xref>). It is formally defined on a bipartite, two-layer graph (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Protein sequences <inline-formula><mml:math id="inf28"><mml:mrow><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are displayed on the Visible layer, and representations <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi mathvariant="bold">𝐡</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> on the Hidden layer. Each visible unit takes one out of 21 values (20 amino acids + 1 alignment gap). Hidden-layer unit values <inline-formula><mml:math id="inf30"><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> are real. The joint probability distribution of <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">𝐡</mml:mi></mml:mrow></mml:math></inline-formula> is:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">𝐡</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="210%" minsize="210%">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="210%" minsize="210%" rspace="7.5pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>up to a normalization constant. Here, the weight matrix <inline-formula><mml:math id="inf32"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> couples the visible and the hidden layers, and <inline-formula><mml:math id="inf33"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf34"><mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are local potentials biasing the values of, respectively, the visible and the hidden variables (<xref ref-type="fig" rid="fig1">Figure 1B,D</xref>).</p></sec><sec id="s2-1-2"><title>From sequence to representation, and back</title><p>Given a sequence <inline-formula><mml:math id="inf35"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> on the visible layer, the hidden unit receives the input<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo rspace="7.5pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This expression is analogous to the score of a sequence with a position-specific weight matrix. Large positive or negative <inline-formula><mml:math id="inf36"><mml:msub><mml:mi>I</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> values signal a good match between the sequence and, respectively, the positive and the negative components of the weights attached to unit <inline-formula><mml:math id="inf37"><mml:mi>μ</mml:mi></mml:math></inline-formula>, whereas small <inline-formula><mml:math id="inf38"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> values correspond to a bad match.</p><p>The input <inline-formula><mml:math id="inf39"><mml:msub><mml:mi>I</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> determines, in turn, the conditional probability of the activity <inline-formula><mml:math id="inf40"><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> of the hidden unit,<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="120%" minsize="120%" rspace="7.5pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>up to a normalization constant. The nature of the potential <inline-formula><mml:math id="inf41"><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi></mml:math></inline-formula> is crucial in determining how the average activity <inline-formula><mml:math id="inf42"><mml:mi>h</mml:mi></mml:math></inline-formula> varies with the input <inline-formula><mml:math id="inf43"><mml:mi>I</mml:mi></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig1">Figure 1E</xref> and below).</p><p>In turn, given a representation (set of activities) <inline-formula><mml:math id="inf44"><mml:mi mathvariant="bold">𝐡</mml:mi></mml:math></inline-formula> on the hidden layer, the residues on site <inline-formula><mml:math id="inf45"><mml:mi>i</mml:mi></mml:math></inline-formula> are distributed according to:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐡</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="210%" minsize="210%">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="210%" minsize="210%" rspace="7.5pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Hidden units with large activities <inline-formula><mml:math id="inf46"><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> strongly bias this probability, and favor values of <inline-formula><mml:math id="inf47"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> corresponding to large weights <inline-formula><mml:math id="inf48"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Use of <xref ref-type="disp-formula" rid="equ3">Equation (3)</xref> allows us to sample the representation space given a sequence, while <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref> defines the sampling of sequences given a representation (see both directions in <xref ref-type="fig" rid="fig1">Figure 1C</xref>). Iterating this process generates high-probability representations, which, in turn, produce very likely sequences, and so on.</p></sec><sec id="s2-1-3"><title>Probability of a sequence</title><p>The probability of a sequence, <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is obtained by summing (integrating) <inline-formula><mml:math id="inf50"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">𝐡</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> over all its possible representations <inline-formula><mml:math id="inf51"><mml:mi mathvariant="bold">𝐡</mml:mi></mml:math></inline-formula>.<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">𝐡</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="210%" minsize="210%">[</mml:mo><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="210%" minsize="210%" rspace="7.5pt">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf52"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mrow><mml:mo rspace="0pt">𝑑</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>h</mml:mi></mml:mpadded></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>h</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the cumulant-generating function associated with the potential <inline-formula><mml:math id="inf53"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> and is a function of the input to hidden unit <inline-formula><mml:math id="inf54"><mml:mi>μ</mml:mi></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ2">Equation (2))</xref>.</p><p>For quadratic potentials <inline-formula><mml:math id="inf55"><mml:mrow><mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1E</xref>), the conditional probability <inline-formula><mml:math id="inf56"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is Gaussian, and the RBM is said to be Gaussian. The cumulant-generating functions <inline-formula><mml:math id="inf57"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> are quadratic, and their sum in <xref ref-type="disp-formula" rid="equ5">Equation (5)</xref> gives rise to effective pairwise couplings between the visible units, <inline-formula><mml:math id="inf58"><mml:mrow><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>μ</mml:mi></mml:msub><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Hence, a Gaussian RBM is equivalent to a Hopfield-Potts model <xref ref-type="bibr" rid="bib14">Cocco et al., 2013</xref>, where the number <inline-formula><mml:math id="inf59"><mml:mi>M</mml:mi></mml:math></inline-formula> of hidden units plays the role of the number of Hopfield-Potts ‘patterns’.</p><p>Non-quadratic potentials <inline-formula><mml:math id="inf60"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula>, and, hence, non-quadratic <inline-formula><mml:math id="inf61"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, introduce couplings to <italic>all orders</italic> between the visible units, all generated from the weights <inline-formula><mml:math id="inf62"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. RBM thus offer a practical way to go beyond pairwise models, and express complex, high-order dependencies between residues, based on the inference of a limited number of interaction parameters (controlled by <inline-formula><mml:math id="inf63"><mml:mi>M</mml:mi></mml:math></inline-formula>). In practice, for each hidden unit, we consider the class of 4-parameter potentials,<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:msub><mml:mi>h</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mpadded></mml:mrow></mml:mrow><mml:mo rspace="12.5pt">,</mml:mo><mml:mtext>where</mml:mtext></mml:mrow></mml:mrow><mml:mo mathvariant="italic" separator="true"> </mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo rspace="7.5pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="12.5pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo rspace="7.5pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>hereafter called double Rectified Linear Unit (dReLU) potentials (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). Varying the parameters allows us to span a wide class of behaviors, including quadratic potentials, double-well potentials (leading to bimodal distributions for <inline-formula><mml:math id="inf64"><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula>) and hard constraints (e.g. preventing <inline-formula><mml:math id="inf65"><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> from being negative).</p><p>RBM can thus be thought of both as a framework to extract representations from sequences through <xref ref-type="disp-formula" rid="equ3">Equation (3)</xref>, and as a way to model complex interactions between residues in sequences through <xref ref-type="disp-formula" rid="equ5">Equation (5)</xref>. They constitute a natural candidate to unify (and improve) PCA-based and direct-coupling-based approaches to protein modeling.</p></sec><sec id="s2-1-4"><title>Learning</title><p>The weights <inline-formula><mml:math id="inf66"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the defining parameters of the potentials <inline-formula><mml:math id="inf67"><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf68"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> are learned by maximizing the average log-probability <inline-formula><mml:math id="inf69"><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of the sequences <inline-formula><mml:math id="inf70"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> in the Multiple Sequence Alignment (MSA). In practice, estimating the gradients of the average log-probability with respect to these parameters requires sampling from the model distribution <inline-formula><mml:math id="inf71"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which is done through Monte Carlo simulation of the RBM (see 'Materials and methods').</p><p>We also introduce penalty terms over the weights <inline-formula><mml:math id="inf72"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (and the local potentials <inline-formula><mml:math id="inf73"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> on visible units) to avoid overfitting and to promote sparse weights. Sparsity facilitates the biological interpretation of weights and, thus, emphasizes the correspondence between representation and phenotypic spaces (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Crucially, imposing sparsity also forces the RBM to learn a so-called compositional representation, in which each sequence is characterized by a subset of strongly activated hidden units, which are of size large compared to 1 but small compared to <inline-formula><mml:math id="inf74"><mml:mi>M</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib82">Tubiana and Monasson, 2017</xref>. All technical details about the learning procedure are reported in the 'Materials and methods'.</p><p>In the next sections, we present results for selected values of the number of hidden units and of the regularization penalty. The values of these (hyper-)parameters are justified afterwards.</p></sec></sec><sec id="s2-2"><title>Kunitz domain</title><sec id="s2-2-1"><title>Description</title><p>The majority of natural proteins are obtained by concatenating functional building blocks, called protein domains. The Kunitz domain, with a length of about 50–60 residues (protein family PF00014 <xref ref-type="bibr" rid="bib22">Finn et al., 2014</xref>)) is present in several genes and its main function is to inhibit serine proteases such as trypsin. Kunitz domains play a key role in the regulation of many important processes in the body, such as tissue growth and remodeling, inflammation, body coagulation and fibrinolysis. They are implicated in several diseases, such as tumor growth, Alzheimer's disease, and cardiovascular and inflammatory diseases and, therefore, have been largely studied and shown to have a large potential in drug design <xref ref-type="bibr" rid="bib70">Shigetomi et al., 2010</xref>; <xref ref-type="bibr" rid="bib5">Bajaj et al., 2001</xref>).</p><p>Some examples of proteins containing a Kunitz-domain include the Basic Pancreatic Trypsin Inhibitor (BPTI, which has one Kunitz domain), Bikunin (two domains) <xref ref-type="bibr" rid="bib25">Fries and Blom, 2000</xref>, Hepatocyte growth factor activator inhibitor (HAI, two domains) and tissue factor pathway inhibitor (TFPI, three domains) <xref ref-type="bibr" rid="bib70">Shigetomi et al., 2010</xref>; <xref ref-type="bibr" rid="bib5">Bajaj et al., 2001</xref>).</p><p><xref ref-type="fig" rid="fig2">Figure 2A</xref> shows the MSA sequence logo and the secondary structure of the Kunitz domain. It is characterized by two <inline-formula><mml:math id="inf75"><mml:mi>α</mml:mi></mml:math></inline-formula> helices and two <inline-formula><mml:math id="inf76"><mml:mi>β</mml:mi></mml:math></inline-formula> strands. cysteine-cysteine disulfide bridges largely contribute to the thermodynamic stability of the domain, as frequently observed in small proteins. The structure of BPTI was the first one ever resolved (<xref ref-type="bibr" rid="bib3">Ascenzi et al., 2003</xref>, and is often used to benchmark folding predictions on the basis of simulations <xref ref-type="bibr" rid="bib45">Levitt and Warshel, 1975</xref>) and coevolutionary approaches <xref ref-type="bibr" rid="bib55">Morcos et al., 2011</xref>; <xref ref-type="bibr" rid="bib31">Hopf et al., 2012</xref>; <xref ref-type="bibr" rid="bib37">Kamisetty et al., 2013</xref>; <xref ref-type="bibr" rid="bib14">Cocco et al., 2013</xref>; <xref ref-type="bibr" rid="bib29">Haldane et al., 2018</xref>. We train a RBM with <inline-formula><mml:math id="inf77"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> dReLU on the MSA of PF00014, constituted by <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>8062</mml:mn></mml:mrow></mml:math></inline-formula> sequences with <inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>53</mml:mn></mml:mrow></mml:math></inline-formula> consensus sites.</p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.004</object-id><label>Figure 2.</label><caption><title>Modeling Kunitz Domain with RBM.</title><p>(<bold>A</bold>) Sequence logo and secondary structure of the Kunitz domain (PF00014), showing two α-helices and two <inline-formula><mml:math id="inf80"><mml:mi>β</mml:mi></mml:math></inline-formula>-strands. Note the presence of the three C-C disulfide bridges between positions 11&amp;35, 2&amp;52 and 27&amp;48. (<bold>B</bold>) Weight logos for five hidden units(see text). Positive and negative weights are shown by letters located, respectively, above and below the zero axis. Values of the norms <inline-formula><mml:math id="inf81"><mml:mrow><mml:msub><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>∥</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> are given. The color code for the amino acids is the same as that in <xref ref-type="fig" rid="fig1">Figure 1A</xref>. (<bold>C</bold>) Top: distribution of inputs <inline-formula><mml:math id="inf82"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> over the sequences <inline-formula><mml:math id="inf83"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> in the MSA (dark blue), and average activity vs. input function (full line, left scale); red points correspond to the activity levels used for design in <xref ref-type="fig" rid="fig5">Figure 5</xref>. Bottom: histograms of Hamming distances between sequences in the MSA (grey) and between the 20 sequences (light blue) with largest (for unit 2,3,4) or smallest (1,5) <inline-formula><mml:math id="inf84"><mml:msub><mml:mi>I</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula>. (<bold>D</bold> 3D visualization of the weights, shown on PDB structure 2knt <xref ref-type="bibr" rid="bib51">Merigeau et al., 1998</xref> using VMD <xref ref-type="bibr" rid="bib33">Humphrey et al., 1996</xref>. White spheres denote the positions of the three disulfide bridges in the wildtype sequence. Green spheres locate residues <inline-formula><mml:math id="inf85"><mml:mi>i</mml:mi></mml:math></inline-formula> such that <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, with <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula> for hidden units <inline-formula><mml:math id="inf88"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>1.25</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf90"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-fig2-v2.tif"/></fig></sec><sec id="s2-2-2"><title>Inferred weights and interpretations</title><p><xref ref-type="fig" rid="fig2">Figure 2B</xref> shows the weights <inline-formula><mml:math id="inf93"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> attached to five selected hidden units. Each logo identifies the amino-acid motifs in the sequences <inline-formula><mml:math id="inf94"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> that give rise to large (positive or negative) inputs (<inline-formula><mml:math id="inf95"><mml:mi>I</mml:mi></mml:math></inline-formula>) onto the associated hidden unit( see <xref ref-type="disp-formula" rid="equ2">Equation (2))</xref>.</p><p>Weight 1 in <xref ref-type="fig" rid="fig2">Figure 2B</xref> has large components on sites 45 and 49 that are in contact in the final <inline-formula><mml:math id="inf96"><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> helix (<xref ref-type="fig" rid="fig2">Figure 2A and D</xref>). The distribution of the inputs (<inline-formula><mml:math id="inf97"><mml:msub><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>) partitions the MSA into three subfamilies (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, top panel, dark blue histogram). The two peaks in <inline-formula><mml:math id="inf98"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≃</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>2.5</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf99"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≃</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula> identify sequences in which the contact is due to an electrostatic interaction with, respectively, <inline-formula><mml:math id="inf100"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf101"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> charged amino acids on sites 45 and 49; the other peak in <inline-formula><mml:math id="inf102"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≃</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> identifies sequences realizing the contact differently, for example with an aromatic amino acid on site 45. Weight 1 also shows a weaker electrostatic component on site 53 <xref ref-type="fig" rid="fig2">(Figure 2B</xref>); the four-site separation interval between sites 45, 49– and 53 fits well with the average helix turn of 3.6 amino acids (<xref ref-type="fig" rid="fig2">Figure 2D</xref>).</p><p>Weight 2 focuses on the contact between residues 11 and 35, realized in most sequences by a C-C disulfide bridge (<xref ref-type="fig" rid="fig2">Figure 2B</xref> and a negative <inline-formula><mml:math id="inf103"><mml:msub><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> peak in <xref ref-type="fig" rid="fig2">Figure 2C</xref> (top). A minority of sequences in the MSA, corresponding to <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and mostly coming from nematode organisms (<xref ref-type="fig" rid="app1fig19">Appendix 1—figure 19</xref>), do not show the C-C bridge. A subset of these sequences strongly and positively activate hidden unit 3 (<xref ref-type="fig" rid="app1fig19">Appendix 1—figure 19</xref> and <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> peak in <xref ref-type="fig" rid="fig2">Figure 2C</xref>). Positive components in the weight 3 logo suggest that these proteins stabilize their structure through electrostatic interactions between sites 10 (<inline-formula><mml:math id="inf106"><mml:mo>-</mml:mo></mml:math></inline-formula> charge) and site 33–36 (+ charges both) (see <xref ref-type="fig" rid="fig2">Figure 2B and D</xref>) that compensates for the absence of a C–C bridge on the neighbouring sites 11–35.</p><p>Weight 4 describes a feature that is mostly localized on the loop preceding the β<sub>1</sub>-β<sub>2</sub> strands (sites 7 to 16) (see <xref ref-type="fig" rid="fig2">Figure 2B and D</xref>). Structural studies of the trypsin–trypsin inhibitor complex have shown that this loop binds to proteases <xref ref-type="bibr" rid="bib50">Marquart et al., 1983</xref>): site 12 is in contact with the active site of the protease and is therefore key to the inhibitory activity of the Kunitz domain. The two amino acids (R, K) having a large positive contribution to weight 4 in position 12 are basic and bind to negatively charged residues (D, E) on the active site of trypsin-like serine proteases. Although several Kunitz domains with known trypsin inhibitory activity, such as BPTI, TFPI, TPPI-2 and so on, give rise to large and positive inputs (<inline-formula><mml:math id="inf107"><mml:msub><mml:mi>I</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula>), Kunitz domains with no trypsin/chymotrypsin inhibition activity, such as those associated with the <italic>COL7A1</italic> and <italic>COL6A3</italic> genes <xref ref-type="bibr" rid="bib13">Chen et al., 2001</xref>; <xref ref-type="bibr" rid="bib42">Kohfeldt et al., 1996</xref>, correspond to negative or vanishing values of <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>I</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula>. Hence, hidden unit 4 possibly separates the Kunitz domains that have trypsin-like protease inhibitory activity from the others.</p><p>This interpretation is also in agreement with mutagenesis experiments carried out on sites 7 to 16 to test the inhibitory effects of Kunitz domains BPT1, HAI-1, and TFP1 against trypsine-like proteases <xref ref-type="bibr" rid="bib5">Bajaj et al., 2001</xref>; <xref ref-type="bibr" rid="bib41">Kirchhofer et al., 2003</xref>; <xref ref-type="bibr" rid="bib70">Shigetomi et al., 2010</xref>; <xref ref-type="bibr" rid="bib27">Grzesiak et al., 2000</xref>; <xref ref-type="bibr" rid="bib12">Chand et al., 2004</xref>). <xref ref-type="bibr" rid="bib41">Kirchhofer et al. (2003)</xref> showed that mutation R12A on the first domain (out of two) of HAI-1 destroyed its inhibitory activity; a similar effect was observed with R12X, where X is a non-basic residue, in the first two domains (out of three) of TFP1 as discussed by <xref ref-type="bibr" rid="bib5">Bajaj et al. (2001)</xref>. <xref ref-type="bibr" rid="bib27">Grzesiak et al. (2000)</xref> showed that for BPTI, the mutations G9F, G9S, G9P reduced its affinity with human serine proteases . Conversely, in <xref ref-type="bibr" rid="bib42">Kohfeldt et al. (1996)</xref> it was shown that the set of mutations P10R, D13A &amp; F14R could convert the COL6A3 domain into a trypsin inhibitor. All of these results are in agreement with the above interpretation and the logo of weight 4. Note that, although several sequences have large <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>I</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula> (top histogram in <xref ref-type="fig" rid="fig2">Figure 2C</xref>), many correspond to small or negative values. This may be explained by the facts that (i) many of the Kunitz domains analyzed are present in two or more copies, and as such, not all of them need to bind strongly to trypsin (<xref ref-type="bibr" rid="bib5">Bajaj et al., 2001</xref> and (ii) a Kunitz domain may have other specificities that are encoded by other hidden units. In particular, weight 34 in 'Supporting Information', displays on site 12 large components that are associated with medium- to large-sized hydrophobic residues (L, M, Y), and is possibly related to other serine protease specificity classes such as chymotrypsin (<xref ref-type="bibr" rid="bib2">Appel, 1986</xref>).</p><p>Weight 5 codes for a complex extended mode. To interpret this feature, we display in <xref ref-type="fig" rid="fig2">Figure 2C</xref> (bottom histogram) the distributions of Hamming distances between all pairs of sequences in the MSA (gray histograms) and between the 100 sequences <inline-formula><mml:math id="inf110"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> in the MSA with largest inputs <inline-formula><mml:math id="inf111"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> to the corresponding hidden unit (light blue histograms). For hidden unit 5, the distances between those top-input sequences are smaller than those between random sequences in the MSA, suggesting that weight 5 is characteristic of a cluster of closely related sequences. Here, these sequences correspond to the protein Bikunin, which is present in most mammals and some other vertebrates <xref ref-type="bibr" rid="bib70">Shigetomi et al., 2010</xref>. Conversely, for other hidden units (e.g. 1,2), both histograms are quite similar, showing that the corresponding weight motifs are found in evolutionary distant sequences.</p><p>The five weights above were chosen on the basis of several criteria. (i) Weight norm, which is a proxy for the relevance of the hidden unit. Hidden units with larger weight norms contribute more to the likelihood, whereas weights with low norms may arise from noise or overfitting. (ii) Weight sparsity. Hidden units with sparse weights are more easily interpretable in terms of structural or functional constraints. (iii) Shape of input distributions. Hidden units with multimodal input distributions separate the family into subfamilies, and are therefore potentially interesting. (iv) Comparison with available literature. (v) Diversity. The remaining 95 inferred weights are shown in the 'Supporting Information'. We find a variety of both structural features, (for example pairwise contacts as in weights 1 and 2, that are also reminiscent of the localized, low-eigenvalue modes of the Hopfield-Potts model <xref ref-type="bibr" rid="bib14">Cocco et al., 2013</xref>)) and phylogenetic features (activated by evolutionary related sequences as hidden unit 5). The latter, in particular, include stretches of gaps, mostly located at the extremities of the sequence <xref ref-type="bibr" rid="bib14">Cocco et al., 2013</xref>. Several weights have strong components on the same sites as weight 4, showing the complex pattern of amino acids that controls binding affinity.</p></sec></sec><sec id="s2-3"><title>WW domain</title><sec id="s2-3-1"><title>Description</title><p>WW is a protein–protein interaction domain, found in many eukaryotes and human signaling proteins, that is involved in essential cellular processes such as transcription, RNA processing, protein trafficking, and receptor signaling. WW is a short domain of length 30–40 amino-acids (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, PFAM PF00397, <inline-formula><mml:math id="inf112"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>7503</mml:mn></mml:mrow></mml:math></inline-formula> sequences, <inline-formula><mml:math id="inf113"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>31</mml:mn></mml:mrow></mml:math></inline-formula> consensus sites), which folds into a three-stranded antiparallel <inline-formula><mml:math id="inf114"><mml:mi>β</mml:mi></mml:math></inline-formula>-sheet. The domain name stems from the two conserved tryptophans (W) at positions 5–28 (<xref ref-type="fig" rid="fig3">Figure 3A</xref>), which serve as anchoring sites for the ligands. WW domains bind to a variety of proline (P)-rich peptide ligands, and can be divided into four groups on the basis of their preferential binding affinity (<xref ref-type="bibr" rid="bib77">Sudol and Hunter, 2000</xref>. Group I binds specifically to the PPXY motif, where X is any amino acid; Group II to PPLP motifs; Group III to proline-arginine-containing sequences (PR); Group IV to phosphorylated serine/threonine-proline sites (p(S/T)P). The modulation of binding properties allow hundreds of WW domain to specifically interact with hundreds of putative ligands in mammalian proteomes.</p><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.005</object-id><label>Figure 3.</label><caption><title>Modeling the WW domain with RBM.</title><p>(<bold>A</bold>) Sequence logo and secondary structure of the WW domain (PF00397), which includes three <inline-formula><mml:math id="inf115"><mml:mi>β</mml:mi></mml:math></inline-formula>-strands. Note the two conserved W amino acids in positions 5 and 28. (<bold>B</bold>) Weight logos for four representative hidden units. (<bold>C</bold>) Corresponding inputs, average activities and distances between the top-20 feature-activating sequences. (<bold>D</bold>) 3D visualization of the features, shown on the PDB structure 1e0m <xref ref-type="bibr" rid="bib46">Macias et al., 2000</xref>. White spheres locate the two W amino acids. Green spheres locate residues <inline-formula><mml:math id="inf116"><mml:mi>i</mml:mi></mml:math></inline-formula> such that <inline-formula><mml:math id="inf117"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0.7</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for each hidden unit <inline-formula><mml:math id="inf118"><mml:mi>μ</mml:mi></mml:math></inline-formula>. (<sc><bold>E</bold></sc>) Scatter plot of inputs <inline-formula><mml:math id="inf119"><mml:msub><mml:mi>I</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> vs. <inline-formula><mml:math id="inf120"><mml:msub><mml:mi>I</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula>. Gray dots represent the sequences in the MSA; they cluster into three main groups. Colored dots show artificial or natural sequences whose specificities, given in the legend, were tested experimentally. Upper triangle: natural, from <xref ref-type="bibr" rid="bib66">Russ et al. (2005)</xref>. Lower triangle: artificial, from <xref ref-type="bibr" rid="bib66">Russ et al. (2005)</xref>. Diamond: natural, from <xref ref-type="bibr" rid="bib59">Otte et al. (2003)</xref>. Crosses: YAP1 (0) and variants (1 and 2 mutations from YAP1), from <xref ref-type="bibr" rid="bib19">Espanel and Sudol (1999)</xref>. The three clusters match the standard ligand-type classification.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-fig3-v2.tif"/></fig></sec><sec id="s2-3-2"><title>Inferred weights and interpretation</title><p>Four weight logos of the inferred RBM are shown in <xref ref-type="fig" rid="fig3">Figure 3B</xref>; the remaining 96 weights are given in the 'Supporting Information'. Weight 1 codes for a contact between sites 4 &amp; 22, which is realized either by two amino acids with oppositive charges (<inline-formula><mml:math id="inf121"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) or by one small and one negatively charged amino acid (<inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). Weight 2 shows a <inline-formula><mml:math id="inf123"><mml:mi>β</mml:mi></mml:math></inline-formula>-sheet–related feature, with large entries defining a set of mostly hydrophobic (<inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) or hydrophilic (<inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) residues localized on the <inline-formula><mml:math id="inf126"><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf127"><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> strands (<xref ref-type="fig" rid="fig3">Figure 3B</xref>) and in contact on the 3D fold (see <xref ref-type="fig" rid="fig3">Figure 3D</xref>). The activation histogram in <xref ref-type="fig" rid="fig3">Figure 3C</xref>, with a large peak on negative <inline-formula><mml:math id="inf128"><mml:msub><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, suggests that this part of the WW domain is exposed to the solvent in most, but not all, natural sequences.</p><p>Weights 3 and 4 are supported by sites on the <inline-formula><mml:math id="inf129"><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>-<inline-formula><mml:math id="inf130"><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> binding pocket and on the <inline-formula><mml:math id="inf131"><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>-<inline-formula><mml:math id="inf132"><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> loop of the WW domain. The distributions of activities in <xref ref-type="fig" rid="fig3">Figure 3C</xref> highlight different groups of sequences in the MSA that strongly correlate with experimental ligand-type identification (see <xref ref-type="fig" rid="fig3">Figure 3E</xref>). We find that: (i) Type I domains are characterized by <inline-formula><mml:math id="inf133"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; (ii) Type II/III domains are characterized by <inline-formula><mml:math id="inf135"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf136"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; (iii) there is no clear distinction between Type II and Type III domains; and (iv) Type IV domains are characterized by <inline-formula><mml:math id="inf137"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. These findings are in good agreement with various studies:</p><list list-type="roman-lower"><list-item><p>Mutagenesis experiments have shown the importance of sites 19, 21, 24 and 26 for binding specificity <xref ref-type="bibr" rid="bib19">Espanel and Sudol, 1999</xref>; <xref ref-type="bibr" rid="bib24">Fowler et al., 2010</xref>). For the YAP1 WW domain, as confirmed by various studies (see table 2 in <xref ref-type="bibr" rid="bib24">Fowler et al., 2010</xref>), the mutations H21X and T26X reduce the binding affinity to Type I ligands, whereas Q24R increases it and S12X has no effect. This is in agreement with the negative components of weight 3 (<xref ref-type="fig" rid="fig3">Figure 3B</xref>): <inline-formula><mml:math id="inf139"><mml:msub><mml:mi>I</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> increases upon mutations H21X and T26X, decreases upon Q24R and is unaffected by S12X. Moreover the mutation L19W alone, or in combination with H21[D/G/K/R/S] could switch the specificity from Type I to Type II/III <xref ref-type="bibr" rid="bib19">Espanel and Sudol, 1999</xref>. These results are consistent with <xref ref-type="fig" rid="fig3">Figure 3E</xref>: YAP1 (blue cross) is of Type I but one or two mutations move it to the right side, closer to the other cluster (orange crosses). <xref ref-type="bibr" rid="bib19">Espanel and Sudol (1999)</xref> also proposed that Type II/III specifity required the presence of an aromatic amino acid (W/F/Y) on site 19, in good agreement with weight 3.</p></list-item><list-item><p>The distinction between Types II and III is unclear in the literature, because WW domains often have high affinity with both ligand types.</p></list-item><list-item><p>Several studies <xref ref-type="bibr" rid="bib66">Russ et al., 2005</xref>; <xref ref-type="bibr" rid="bib38">Kato et al., 2002</xref>; <xref ref-type="bibr" rid="bib35">Jäger et al., 2006</xref>) have demonstrated the importance of the <inline-formula><mml:math id="inf140"><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>-<inline-formula><mml:math id="inf141"><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> loop for achieving Type IV specificity, which requires a longer, more flexible loop, as opposed to a short rigid loop for other types. The length of the loop is encoded in weight 4 through the gap symbol on site 13: short and long loops correspond to, respectively, positive and negative <inline-formula><mml:math id="inf142"><mml:msub><mml:mi>I</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula>. The importance of residues R11 and R13 was shown by <xref ref-type="bibr" rid="bib38">Kato et al. (2002)</xref> and <xref ref-type="bibr" rid="bib66">Russ et al. (2005)</xref>, where removing R13 of Type IV hPin1 WW domain reduced its binding affinity to [p(S/T)P] ligands. These observations agree with the logo of weight 4, which authorizes substitutions between K and R on sites 11 and 13.</p></list-item><list-item><p>A specificity-related sector of eight sites was identified in <xref ref-type="bibr" rid="bib66">Russ et al. (2005)</xref>, five of which carry the top entries of weight 3 (green balls in <xref ref-type="fig" rid="fig3">Figure 3D</xref>). Our approach not only provides another specificity-related feature (weight 4) but also the motifs of amino acids that affectType I and IV specificity, in good agreement with the experimental findings of <xref ref-type="bibr" rid="bib66">Russ et al. (2005)</xref>.</p></list-item></list></sec></sec><sec id="s2-4"><title>Hsp70 protein</title><sec id="s2-4-1"><title>Description</title><p>70-kDa heat shock proteins (Hsp70) form a highly-conserved family that is represented in essentially all organisms. Hsp70, together with other chaperone proteins, perform a variety of essential functions in the cell: they can assist the folding and assembly of newly synthetized proteins, trigger refolding cycles of misfolded proteins, transport unfolded proteins through organelle membranes, and when necessary, deliver non-functional proteins to the proteasome, endosome or lysosome for recycling <xref ref-type="bibr" rid="bib11">Bukau and Horwich, 1998</xref>; <xref ref-type="bibr" rid="bib84">Young et al., 2004</xref>; <xref ref-type="bibr" rid="bib85">Zuiderweg et al., 2017</xref>. There are 13 HSP70s protein-encoding genes in humans, differing by where (nucleus/cytoplasm, mitochondria or endoplasmic reticulum) and when they are expressed. Some, such as HSPA8 (Hsc70), are constitutively expressed whereas others, such as HSPA1 and HSPA5, are stress-induced (respectively by heat shock and glucose deprivation). Notably, Hsc70 can make up to 3% of the total total mass of proteins within the cell, and thus is one of its most important housekeeping genes. Structurally, Hsp70 are multi-domain proteins of ength of 600–670 sites (631 for the <italic>E. coli</italic> DNaK gene). They consist of:</p><list list-type="bullet"><list-item><p>A Nucleotide Binding Domain (NBD, 400 sites) that can bind and hydrolyse ATP.</p></list-item><list-item><p>A Substrate Binding Domain (SBD sites), folded in a beta-sandwich structure, which binds to the target peptide or protein.</p></list-item><list-item><p>A flexible, hydrophobic interdomain-linker linking the NBD and the SBD.</p></list-item><list-item><p>A LID domain, constituted by several (up to 5) <inline-formula><mml:math id="inf143"><mml:mi>α</mml:mi></mml:math></inline-formula> helices, which encapsulates the target protein and blocks its release.</p></list-item><list-item><p>An unstructured C-terminal tail of variable length, which is important for detection and interaction with other co-chaperones, such as Hop proteins (<xref ref-type="bibr" rid="bib68">Scheufler et al., 2000</xref>.</p></list-item></list><p>Hsp70 functions by adopting two different conformations (see <xref ref-type="fig" rid="fig4">Figure 4A and B</xref>). When the NBD is bound to ATP, the NBD and the SBD are held together and the LID is open, such that the protein has low binding affinity for substrate peptides. After the hydrolysis of ATP to ADP, the NBD and the SBD detach from one another, and the LID is closed, yielding high binding affinity and effectively trapping the peptides between the SBD and the LID. By cycling between both conformations, Hsp70 can bind to misfolded proteins, unfold them by stretching (e.g. with two Hsp70 molecules bound at two ends of the protein) and release them for refold cycles. Since Hsp70 alone have low ATPase activity, this cycle requires another type of co-chaperone, J-protein, which simultaneously binds to the target protein and the Hsp70 to stimulate the ATPase activity of Hsp70, as well as a Nucleotide Exchange Factor (NEF) that favors conversion of the ADP back to ATP and hence release of the target protein (see <xref ref-type="fig" rid="fig1">Figure 1</xref> in <xref ref-type="bibr" rid="bib85">Zuiderweg et al. (2017)</xref>).</p><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.006</object-id><label>Figure 4.</label><caption><title>Modeling HSP70 with RBM.</title><p>(<bold>A, B</bold>) 3D structures of the DNaK <italic>E. coli</italic> HSP70 protein in the ADP-bound (A: PDB: 2kho <xref ref-type="bibr" rid="bib7">Bertelsen et al., 2009</xref>) and ATP-bound (B: PDB: 4jne <xref ref-type="bibr" rid="bib60">Qi et al., 2013</xref>) conformations. The colored spheres show the sites carrying the largest entries in the weights in panel (C). (<bold>C</bold>) Weight logos for hidden units <inline-formula><mml:math id="inf144"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, 2 and 5 (see <xref ref-type="fig" rid="app1fig21">Appendix 1—figure 21</xref> for the other hidden units). Owing to the large protein length, we show only weights for positions <inline-formula><mml:math id="inf145"><mml:mi>i</mml:mi></mml:math></inline-formula> with large weights (<inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0.4</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:msub><mml:mi mathvariant="normal">x</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), with surrounding positions up to ±5 sites away; dashed lines vertical locate the left edges of the intervals. Protein backbone colors: blue = NBD; cyan = linker; red = SBD; gray = LID. Colors: orange = Unit 1 (NBD loop); black = Unit 2 (SBD β strand); green = Unit 3 (SBD/LID); yellow = Unit 4 (Allosteric). (<bold>D</bold>) Scatter plot of inputs <inline-formula><mml:math id="inf147"><mml:msub><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> vs. <inline-formula><mml:math id="inf148"><mml:msub><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>. Gray dots represent the sequences in the MSA, and cluster into four main groups. Colored dots represent the main sequence categories based on gene phylogeny, function and expression. (<bold>E</bold>) Histogram of input <inline-formula><mml:math id="inf149"><mml:msub><mml:mi>I</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula>, showing separation between allosteric and non-allosteric protein sequences in the MSA.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-fig4-v2.tif"/></fig><p>We constructed an MSA for HSP70 with <inline-formula><mml:math id="inf150"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>675</mml:mn></mml:mrow></mml:math></inline-formula> consensus sites and <inline-formula><mml:math id="inf151"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>170</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> sequences, starting from the seeds of <xref ref-type="bibr" rid="bib47">Malinverni et al. (2015)</xref>, and queried SwissProt and Trembl UniprotKB databases using HMMER3 <xref ref-type="bibr" rid="bib17">Eddy, 2011</xref>. Annotated sequences were grouped on the basis of their phylogenetic origin and functional role. Prokaryotes mainly express two Hsp70 proteins: DnaK (<inline-formula><mml:math id="inf152"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>17</mml:mn><mml:mo>,</mml:mo><mml:mn>118</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> sequences in the alignment), which are the prototype Hsp70, and HscA (<inline-formula><mml:math id="inf153"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>897</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>), which are specialized in chaperoning of iron-sulfur cluster containing proteins. Eukaryotes' Hsp70 were grouped by their location of expression (mitochondria, <inline-formula><mml:math id="inf154"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>851</mml:mn></mml:mrow></mml:math></inline-formula>; chloroplasts, <inline-formula><mml:math id="inf155"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>416</mml:mn></mml:mrow></mml:math></inline-formula>; endoplasmic reticulum, <inline-formula><mml:math id="inf156"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>433</mml:mn></mml:mrow></mml:math></inline-formula>; nucleus or cytoplasm and others, <inline-formula><mml:math id="inf157"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>452</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). We also singled out Hsp110 sequences, which, despite the high homology with Hsp70, correspond to non-allosteric proteins (<inline-formula><mml:math id="inf158"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>294</mml:mn></mml:mrow></mml:math></inline-formula>). We then trained a dReLU RBM over the full MSA with <inline-formula><mml:math id="inf159"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula> hidden units. We show below the weight logos, structures and input distributions for ten selected hidden units (see <xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="app1fig21">Appendix 1—figures 21</xref>–<xref ref-type="fig" rid="app1fig26">26</xref>).</p></sec><sec id="s2-4-2"><title>Inferred weights and interpretation</title><p>Weight 1 encodes a variability of the length of the loop within the IIB subdomain of the NBD, see stretch of gaps from sites 301 to 306. As shown in <xref ref-type="fig" rid="fig4">Figure 4D</xref> (projection along x axis), it separates prokaryotic DNaK proteins (for which the loop is 4–5 sites longer) from most eukaryotic Hsp70 proteins and from prokaryotic HscA. An additional hidden unit (Weight 6 in <xref ref-type="fig" rid="app1fig21">Appendix 1—figure 21</xref>) further separates eukaryotic Hsp70 from HscA proteins, whose loops are 4–5 sites shorter (distribution of inputs <inline-formula><mml:math id="inf160"><mml:msub><mml:mi>I</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:math></inline-formula> in <xref ref-type="fig" rid="app1fig26">Appendix 1—figure 26</xref>). This structural difference between the three families was previously reported and is of high functional importance to the NBD (<xref ref-type="bibr" rid="bib10">Buchberger et al., 1994</xref>; <xref ref-type="bibr" rid="bib8">Brehmer et al., 2001</xref>. Shorter loops increase the nucleotide exchange rates (and thus the release of target protein) in the absence of NEF, and the loop size controls interactions with NEF proteins <xref ref-type="bibr" rid="bib8">Brehmer et al., 2001</xref>; <xref ref-type="bibr" rid="bib9">Briknarová et al., 2001</xref>; <xref ref-type="bibr" rid="bib74">Sondermann et al., 2001</xref>). Hsp70 proteins that have long and intermediate loop sizes interact specifically with GrpE and Bag-1 NEF proteins, respectively, whereas short, HscA-like loops do not interact with any of them. This cochaperone specificity allows for functional diversification within the cell; for instance, eukaryotic Hsp70 proteins that are expressed within mitochondria and chloroplasts, such as the human gene HSPA9 and the <italic>Chlamydomonas reinhardtii</italic> HSP70B, share the long loop with prokaryotic DNaK proteins, and therefore do not interact with Bag proteins. Within the DNaK subfamily, two main variants of the loop can be isolated as well (Weight 7 in <xref ref-type="fig" rid="app1fig22">Appendix 1—figure 22</xref>), hinting at more NEF-protein specificities.</p><p>Weight 2 encodes a small collective mode localized on <inline-formula><mml:math id="inf161"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> strands, at the edge of the β sandwich within the SBD. The weights are quite large (<inline-formula><mml:math id="inf162"><mml:mrow><mml:mi>w</mml:mi><mml:mo>∼</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>), and the input distribution is bimodal, notably separating HscA and chloroplast Hsp70 (<inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) from mitochondrial Hsp70 and the other eukaryotic Hsp70 (<inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). We note also a similarity in structural location and amino-acid content with weight 3 of the WW–domain, which controls binding specificity (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). Although we have found no trace of this motif in the literature, this evidence suggests that it could be important for substrate binding specificity. Endoplasmic-reticulum-specific Hsp70 proteins can also be separated from the other eukaryotic proteins by looking at appropriate hidden units (see Weight 8 in <xref ref-type="fig" rid="app1fig22">Appendix 1—figure 22</xref> and the distribution of input <inline-formula><mml:math id="inf165"><mml:msub><mml:mi>I</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></inline-formula> in <xref ref-type="fig" rid="app1fig26">Appendix 1—figure 26</xref>).</p><p>RBM can also extract collective modes of coevolution spanning multiple domains, as shown by Weight 3 (<xref ref-type="fig" rid="app1fig21">Appendix 1—figure 21</xref>). The residues supporting Weight 3 (green spheres in <xref ref-type="fig" rid="fig4">Figure 4A and B</xref>) are physically contiguous in the ADP conformation, but not in the ATP conformation. Hence, Weight 3 captures inter-domain coevolution between the SBD and the LID domains.</p><p>Weight 4 (sequence logo in <xref ref-type="fig" rid="app1fig21">Appendix 1—figure 21</xref>) also codes for a wide, inter–domain collective mode, which is localized at the interface between the SBD and the NBD domains. When the Hsp70 protein is in the ATP conformation, the sites carrying weight 4 are physically contiguous, whereas in the ADP state they are far apart (see yellow spheres in <xref ref-type="fig" rid="fig4">Figure 4A and B</xref>). Moreover, its input distribution (shown in <xref ref-type="fig" rid="fig4">Figure 4E</xref>), separates the non-allosteric Hsp110 subfamily (<inline-formula><mml:math id="inf166"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) from the other subfamilies (<inline-formula><mml:math id="inf167"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula>), suggesting that this motif is important for allostery. Several mutational studies have highlighted 21 important sites for allostery within <italic>E. coli</italic> DNaK <xref ref-type="bibr" rid="bib73">Smock et al., 2010</xref>; seven of these positions carry the top entries of Weight 3, four appear in another Hsp110-specific hidden unit (Weight 9 in <xref ref-type="fig" rid="app1fig22">Appendix 1—figure 22</xref>), and several others are highly conserved and do not coevolve at all.</p><p>Last, Weight 5 (<xref ref-type="fig" rid="fig4">Figure 4C</xref>) codes for a collective mode that is located mainly on the unstructured C-terminal tail, with a few sites on the LID domain. Its amino-acid content is strikingly similar across all sites: positive weights for hydrophilic residues (in particular, lysine) and negative weights for tiny, hydrophobic residues. Hydrophobic-rich or hydrophilic-rich sequences are found in the MSA (see <xref ref-type="fig" rid="app1fig28">Appendix 1—figure 28</xref>). This motif is consistent with the role of the tail in cochaperone interaction: hydrophobic residues are important for the formation of Hsp70–Hsp110 complexes via the Hop protein <xref ref-type="bibr" rid="bib68">Scheufler et al., 2000</xref>. High-charge content is also frequently encountered, and is the basis of a recognition mechanism, in intrinsically disordered protein regions <xref ref-type="bibr" rid="bib58">Oldfield and Dunker, 2014</xref>. This could suggest the existence of different protein partners.</p><p>Some of the results presented here were previously obtained with other coevolutionary methods. In <xref ref-type="bibr" rid="bib47">Malinverni et al. (2015)</xref>, the authors showed that Direct Coupling Analysis could detect conformation-specific contacts; these are similar to hidden units 3 and 4 presented here which are located on contiguous sites in the ADP-bound and ATP-bound conformations, respectively. In <xref ref-type="bibr" rid="bib73">Smock et al. (2010)</xref>, an inter-domain sector of sites discriminating between allosteric and non-allosteric sequences was found. This sector shares many sites with our weight 4, and is also localized at the SBD/NBD edge. However, only a sector could be retrieved with sector analysis, whereas many other meaningful collective modes could be extracted using RBM.</p></sec></sec><sec id="s2-5"><title>Sequence design</title><p>The biological interpretation of the features inferred by the RBM guides us to sample new sequences <inline-formula><mml:math id="inf168"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> with putative functionalities. In practice, we sample from the conditional distribution <inline-formula><mml:math id="inf169"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐡</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref>, where a few hidden-unit activities in the representation <inline-formula><mml:math id="inf170"><mml:mi mathvariant="bold">𝐡</mml:mi></mml:math></inline-formula> are fixed to desired values, whereas the others are sampled from <xref ref-type="disp-formula" rid="equ3">Equation (3)</xref>. For WW domains, we condition on the activities of hidden units 3 and 4, which are related to binding specificity. Fixing <inline-formula><mml:math id="inf171"><mml:msub><mml:mi>h</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf172"><mml:msub><mml:mi>h</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula> to levels corresponding to the peaks in the histograms of inputs in <xref ref-type="fig" rid="fig3">Figure 3C</xref> allows us to generate sequences belonging specifically to each one of the three ligand-specificity clusters (see <xref ref-type="fig" rid="fig5">Figure 5A</xref>).</p><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.007</object-id><label>Figure 5.</label><caption><title>Sequence design with RBM.</title><p>(<bold>A</bold>) Conditional sampling of WW domain-modeling RBM. Sequences are drawn according to <xref ref-type="disp-formula" rid="equ3">Equation (3)</xref>, with activities <inline-formula><mml:math id="inf173"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> fixed to <inline-formula><mml:math id="inf174"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>4</mml:mn><mml:mo>-</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>4</mml:mn><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf175"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>3</mml:mn><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>4</mml:mn><mml:mo>-</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf176"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>3</mml:mn><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>4</mml:mn><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf177"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>3</mml:mn><mml:mo>-</mml:mo></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>4</mml:mn><mml:mo>-</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, see red points indicating the values of <inline-formula><mml:math id="inf178"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mn>3</mml:mn><mml:mo>±</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>4</mml:mn><mml:mo>±</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig3">Figure 3C</xref>. Natural sequences in the MSA are shown with gray dots, and generated sequences with colored dots. Four clusters of sequences are obtained; the first three are putatively associated to, respectively, ligand-specific groups I, II/III and IV. The sequences in the bottom left cluster, obtained through very strong conditioning, do not resemble any of the natural sequences in the MSA; their binding specificity is unknown. (<sc><bold>B</bold></sc>) Sequence logo of the red sequences in panel (A), with ‘long <inline-formula><mml:math id="inf179"><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>-<inline-formula><mml:math id="inf180"><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> loop’ and ‘type I’ features. (<bold>C</bold>) Conditional sampling of Kunitz domain-modeling RBM, with activities <inline-formula><mml:math id="inf181"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> fixed to <inline-formula><mml:math id="inf182"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>2</mml:mn><mml:mo>±</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>5</mml:mn><mml:mo>±</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, see red dots indicating <inline-formula><mml:math id="inf183"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mn>2</mml:mn><mml:mo>±</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>5</mml:mn><mml:mo>±</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig2">Figure 2C</xref>. Red sequences combine the absence of the 11–35 disulfide bridge and a strong activation of the Bikunin-AMBP feature, although these two phenotypes are never found together in natural sequences. (<bold>D</bold>) Sequence logo of the red sequences in panel (C), with ‘no disulfide bridge’ and ‘bikunin’ features. (<bold>E</bold>) Scatter plot of the number of mutations to the closest natural sequence vs log-probability, for natural (gray) and artificial (colored) WW domain sequences. The color code is the same as that in panel (A); dark dots were generated with the high-probability trick, based on duplicated RBM (see 'Materials and methods'). Note the existence of many high-probability artificial sequences far away from the natural ones. (<bold>F</bold>) The same scatter plot as in panel (E) for natural and artificial Kunitz-domain sequences.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-fig5-v2.tif"/></fig><p>In addition, sequences with combinations of activities that are not encountered in the natural MSA can be engineered. As an illustration, we used conditional sampling to generate hybrid WW-domain sequences with strongly negative values of <inline-formula><mml:math id="inf184"><mml:msub><mml:mi>h</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf185"><mml:msub><mml:mi>h</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula>, corresponding to a Type I-like <inline-formula><mml:math id="inf186"><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>-<inline-formula><mml:math id="inf187"><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> binding pocket and a long, Type IV-like <inline-formula><mml:math id="inf188"><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>-<inline-formula><mml:math id="inf189"><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> loop (see <xref ref-type="fig" rid="fig5">Figure 5A and B</xref>).</p><p>For Kunitz domains, the property ‘no 11–35 disulfide bond’ holds only for some sequences of nematode organisms, whereas the Bikunin-AMBP gene is present only in vertebrates; the two corresponding motifs are thus never observed simultaneously in natural sequences. Sampling our RBM conditioned to appropriate levels of <inline-formula><mml:math id="inf190"><mml:msub><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf191"><mml:msub><mml:mi>h</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math></inline-formula> allows us to generate sequences with both features activated (see <xref ref-type="fig" rid="fig5">Figure 5C and D</xref>).</p><p>The sequences designed by RBM are far away from all natural sequences in the MSA, but have comparable probabilities (see <xref ref-type="fig" rid="fig5">Figure 5E</xref> (WW) and <xref ref-type="fig" rid="fig5">Figure 5F</xref> (Kunitz)). Their probabilities estimated with pairwise direct-coupling models (trained on the same data), whose ability to identify functional and artificial sequences has already been tested (<xref ref-type="bibr" rid="bib6">Balakrishnan et al., 2011</xref>; <xref ref-type="bibr" rid="bib15">Cocco et al., 2018</xref> andare also large (see <xref ref-type="fig" rid="app1fig7">Appendix 1—figure 7</xref>).</p><p>Our RBM framework can also be modified to design sequences with very high probabilities, even larger than in the MSA, by appropriate duplication of the hidden units (see 'Materials and methods'). This trick can be combined with conditional sampling (see <xref ref-type="fig" rid="fig5">Figure 5E and F</xref>).</p></sec><sec id="s2-6"><title>Contact predictions</title><p>As illustrated above, the co-occurrence of large weight components in highly sparse features often corresponds to nearby sites on the 3D fold. To extract structural information in a systematic way, we use our RBM to derive effective pairwise interactions between sites, which can then serve as estimators for contacts as approaches that are based on direct-coupling <xref ref-type="bibr" rid="bib15">Cocco et al., 2018</xref>. The derivation is sketched in <xref ref-type="fig" rid="fig6">Figure 6A</xref>. We consider a sequence <inline-formula><mml:math id="inf192"><mml:msup><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> with residues <italic>a</italic> and <italic>b</italic> on, respectively, sites <italic>i</italic> and <italic>j</italic>. Single mutations <inline-formula><mml:math id="inf193"><mml:mrow><mml:mi>a</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf194"><mml:mrow><mml:mi>b</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> on, respectively, site <italic>i</italic> or <italic>j</italic> are accompanied by changes in the log probability of the sequence (indicated by the full arrows in <xref ref-type="fig" rid="fig6">Figure 6A</xref>). Comparison of the change resulting from the double mutation with the sum of the changes resulting from the two single mutations provides our RBM-based estimate of the epistatic interaction (see <xref ref-type="disp-formula" rid="equ16 equ17">Equations (15,16)</xref> in 'Materials and methods'). These interactions are well correlated with the outcomes of the Direct-Coupling Analysis (see <xref ref-type="fig" rid="app1fig9">Appendix 1—figure 9</xref>).</p><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.008</object-id><label>Figure 6.</label><caption><title>Contact predictions using RBM.</title><p>(<bold>A</bold>) Sketch of the derivation with RBM of effective epistatic interactions between residues. The change in log probability resulting from a double mutation (purple arrow) is compared to the sum of the changes accompanying the single mutations (blue and red arrows) (see text and 'Materials and methods', <xref ref-type="disp-formula" rid="equ16 equ17">Equations (15,16))</xref>. (<bold>B</bold>) Positive Predictive Value (PPV) vs. pairs <inline-formula><mml:math id="inf195"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> of residues, ranked according to their scores for the Kunitz domain. RBM predictions with quadratic (Gaussian RBM) and dReLU potentials are compared to direct coupling-based methods, namely the Pseudo-Likelihood Method (plmDCA) <xref ref-type="bibr" rid="bib18">Ekeberg et al., 2014</xref>) and Boltzmann Machine (BM) learning <xref ref-type="bibr" rid="bib78">Sutto et al., 2015</xref>). (<bold>C</bold>) Same as panel (B) for the WW domain. (<bold>D</bold>) Distant contact predictions for the 17 protein domains used to benchmark plmDCA in <xref ref-type="bibr" rid="bib18">Ekeberg et al. (2014)</xref> obtained using fixed regularization <inline-formula><mml:math id="inf196"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf197"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn><mml:mo>×</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>N</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>×</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. PPV for contacts between residues separated by at least five sites along the protein backbone vs. ranks of the corresponding couplings, expressed as fractions of the protein length <inline-formula><mml:math id="inf198"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>; solid lines indicate the median PPV and colored areas the corresponding 1/3 to 2/3 quantiles.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-fig6-v2.tif"/></fig><p><xref ref-type="fig" rid="fig6">Figure 6</xref> shows that the quality of the prediction of the contact maps of the Kunitz (<xref ref-type="fig" rid="fig6">Figure 6B</xref>) and the WW (<xref ref-type="fig" rid="fig6">Figure 6C</xref>) domains with RBM is comparable to state-of-the-art methods based on direct couplings (<xref ref-type="bibr" rid="bib55">Morcos et al., 2011</xref>); predictions for long-range contacts are reported in <xref ref-type="fig" rid="app1fig10">Appendix 1—figure 10</xref>. The quality of contact prediction with RBM:</p><list list-type="bullet"><list-item><p>Does not seem to depend much on the choice of the hidden-unit potential see the Gaussian and dReLU PPV performances in <xref ref-type="fig" rid="fig6">Figure 6B,C and D</xref>, although the latter have better performance in terms of sequence scoring than the former (see <xref ref-type="fig" rid="app1fig1">Appendix 1—figures 1</xref>, <xref ref-type="fig" rid="app1fig2">2</xref> and <xref ref-type="fig" rid="app1fig5">5</xref>).</p></list-item><list-item><p>Strongly increases with the number of hidden units (see <xref ref-type="fig" rid="app1fig11">Appendix 1—figures 11,12</xref>). This dependence is not surprising, as the number <inline-formula><mml:math id="inf199"><mml:mi>M</mml:mi></mml:math></inline-formula> of hidden units acts in practice as a regularizor over the effective coupling matrix between residues. In the case of Gaussian RBM, the value of <inline-formula><mml:math id="inf200"><mml:mi>M</mml:mi></mml:math></inline-formula> fixes the maximal rank of the matrix <inline-formula><mml:math id="inf201"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see 'Materials and methods'). The value <inline-formula><mml:math id="inf202"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> of the number of hidden units is small compared to the maximal ranks <inline-formula><mml:math id="inf203"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> of the couplings matrices of the Kunitz (<inline-formula><mml:math id="inf204"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>1060</mml:mn></mml:mrow></mml:math></inline-formula>) and WW (<inline-formula><mml:math id="inf205"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>620</mml:mn></mml:mrow></mml:math></inline-formula>) domains, and explains why Direct-Coupling Analysis gives slightly better performance than RBM in the contact predictions of <xref ref-type="fig" rid="fig6">Figure 6B and C</xref>.</p></list-item><list-item><p>Worsens with stronger weight-sparsifying regularizations (see <xref ref-type="fig" rid="app1fig12">Appendix 1—figure 12</xref>) as expected.</p></list-item></list><p>We further tested RBM distant contact predictions in a fully blind setting on the 17 protein families (the Kunitz domain plus 16 other domains) that were used for to benchmark plmDCA (<xref ref-type="bibr" rid="bib18">Ekeberg et al., 2014</xref>), a state-of-the-art procedure for inferring pairwise couplings in Direct-Coupling Analysis. The number of idden units was fixed to <inline-formula><mml:math id="inf206"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>0.3</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, that is proportionally to the domain lengths, and the regularization strength was fixed to <inline-formula><mml:math id="inf207"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>. Contact predictions averaged over all families are reported in <xref ref-type="fig" rid="fig6">Figure 6D</xref> for different choices of the hidden-unit potentials (Gaussian and dReLU). We find that performances are comparable to those of plmDCA, but the computational cost of training RBM is substantially higher.</p></sec><sec id="s2-7"><title>Benchmarking on lattice proteins</title><p>Lattice protein (LP) models were introduced in the <inline-formula><mml:math id="inf208"><mml:mrow><mml:msup><mml:mn>90</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> to study protein folding and design (<xref ref-type="bibr" rid="bib53">Mirny and Shakhnovich, 2001</xref>. In one of those models <xref ref-type="bibr" rid="bib69">Shakhnovich and Gutin, 1990</xref>, a ‘protein’ of <inline-formula><mml:math id="inf209"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>27</mml:mn></mml:mrow></mml:math></inline-formula> amino acids may fold into <inline-formula><mml:math id="inf210"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> distinct structures on a <inline-formula><mml:math id="inf211"><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> cubic lattice, with probabilities depending on its sequence (see 'Materials and methods' and <xref ref-type="fig" rid="fig7">Figure 7A and B</xref>). LP sequence data were used to benchmark the Direct-Coupling Analysis in <xref ref-type="bibr" rid="bib34">Jacquin et al. (2016)</xref>, and we follow the same approach here to assess the performances of RBM in a case where the ground truth is known. We first generate a MSA containing sequences that have large probabilities (<inline-formula><mml:math id="inf212"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0.99</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) of folding into one structure shown in <xref ref-type="fig" rid="fig7">Figure 7A</xref> (<xref ref-type="bibr" rid="bib34">Jacquin et al., 2016</xref>). A RBM with <inline-formula><mml:math id="inf213"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> dReLU hidden units is then learned, (see Appendix 1 for details about regularization and cross-validation).</p><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.009</object-id><label>Figure 7.</label><caption><title>Benchmarking RBM with lattice proteins.</title><p>(<bold>A</bold>) <inline-formula><mml:math id="inf214"><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>, one of the 103,406 distinct structures that a 27-mer can adopt on the cubic lattice <xref ref-type="bibr" rid="bib69">Shakhnovich and Gutin, 1990</xref>. Circled sites are related to the features shown in <xref ref-type="fig" rid="fig6">Figure 6C</xref>. (<bold>B</bold>)<inline-formula><mml:math id="inf215"><mml:msub><mml:mi>S</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math></inline-formula>, another fold with a contact map (set of neighbouring sites) close to <inline-formula><mml:math id="inf216"><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> <xref ref-type="bibr" rid="bib34">Jacquin et al., 2016</xref>. (<bold>C</bold>) Four weight logos for a RBM inferred from sequences folding into <inline-formula><mml:math id="inf217"><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>, see 'Supporting Information' for the remaining 96 weights. Weight 1 corresponds to the contact between sites 3 and 26, see black dashed contour in panel (A). The contact can be realized by amino acids of opposite (-+) charges (<inline-formula><mml:math id="inf218"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) or by hydrophobic residues (<inline-formula><mml:math id="inf219"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). Weights 2 and 3 are related to, respectively, the triplets of amino acids 8-15-27 and 2-16-25, each realizing two overlapping contacts on <inline-formula><mml:math id="inf220"><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> (blue dashed contours). Weight 4 codes for electrostatic contacts between sites 3 &amp; 26, 1 &amp; 18 and 1 &amp; 20, and imposes the conditon that the charges of amino acids 1 and 26 have the same sign. The latter constraint is not due to the native fold (1 and 26 are ‘far away’ on <inline-formula><mml:math id="inf221"><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>) but because folding must be impeded in the ‘competing’ structure, <inline-formula><mml:math id="inf222"><mml:msub><mml:mi>S</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig7">Figure 7B</xref> and 'Materials and methods') in which sites 1 and 26 are neighbours <xref ref-type="bibr" rid="bib34">Jacquin et al., 2016</xref>). (<bold>D</bold>) Distributions of inputs (<inline-formula><mml:math id="inf223"><mml:mi>I</mml:mi></mml:math></inline-formula>) and average activities (full line, left scale). All features are activated across the entire sequence space (not shown). (<bold>E</bold>) Conditional sampling with activities <inline-formula><mml:math id="inf224"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> fixed to <inline-formula><mml:math id="inf225"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>±</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>±</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, see red dots in panel (D). Designed sequences occupy specific clusters in the sequence space, corresponding to different realizations of the overlapping contacts encoded by weights 2 and 3 (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). Conditioning to <inline-formula><mml:math id="inf226"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> makes it possible to generate sequences combining features that are not found together in the MSA (see bottom left corner), even with very high probabilities (see 'Materials and methods'). (<bold>F</bold>) Scatter plot of the number of mutations to the closest natural sequence vs. the probability <inline-formula><mml:math id="inf227"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of folding into structure <inline-formula><mml:math id="inf228"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (see <xref ref-type="bibr" rid="bib34">Jacquin et al., 2016</xref> for a precise definition) for natural (gray) and artificial (colored) sequences. Note the large diversity and the existence of sequences with higher <inline-formula><mml:math id="inf229"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> than those in the training sample.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-fig7-v2.tif"/></fig><p>Various structural LP features are encoded by the weights as in real proteins, including complex negative-design related modes (see <xref ref-type="fig" rid="fig7">Figure 7C and D</xref> and the remaining weights in 'Supporting Information'). The performances in terms of contact predictions are comparable to state-of-the art methods on LP (see <xref ref-type="fig" rid="app1fig11">Appendix 1—figure 11</xref>).</p><p>The capability of RBM to design new sequences that have desired features and high values of fitness, exactly computable in LP as the probability of folding into the native structure in <xref ref-type="fig" rid="fig7">Figure 7A</xref>, can be quantitatively assessed. Conditional sampling allows us to design sequences with specific hidden-unit activity levels, or combinations of features that are not found in the MSA (<xref ref-type="fig" rid="fig7">Figure 7E</xref>). These designed sequences are diverse and have large fitnesses, comparable to those of the MSA sequences and even higher when generated by duplicated RBM (<xref ref-type="fig" rid="fig7">Figure 7F</xref>), and well correlated with the RBM probabilities <inline-formula><mml:math id="inf230"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref>).</p></sec><sec id="s2-8"><title>Cross-validation of the model and interpretability of the representations</title><p>Each RBM was trained on a randomly chosen subset of 80% of the sequences in the MSA, while the remaining 20% (the test set) were used for validation of its predictive power. In practice, we compute the average log-probability of the test set to assess the performances of the RBM for various values of the number <inline-formula><mml:math id="inf231"><mml:mi>M</mml:mi></mml:math></inline-formula> of hidden units, for the regularization strength <inline-formula><mml:math id="inf232"><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> and for different hidden-unit potentials. Results for the WW and Kunitz domains and for Lattice Proteins are reported in <xref ref-type="fig" rid="fig8">Figure 8</xref> and in Appendix 2 (Model Selection). The dReLU potential, which includes quadratic and Bernoulli (another popular choice for RBM) potentials as special cases, is consistently better than the quadratic and Bernoulli potentials individually. As expected, increasing <inline-formula><mml:math id="inf233"><mml:mi>M</mml:mi></mml:math></inline-formula> allows RBM to capture more features in the data distribution and, therefore, improves performances up to a point, after which overfitting starts to occur.</p><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.010</object-id><label>Figure 8.</label><caption><title>Nature of the representations built by RBM and interpretability of weights.</title><p>(<bold>A</bold>) The effect of sparsifying regularization. Left: log-probability (see , <xref ref-type="disp-formula" rid="equ5">Equation (5)</xref>) as a function of the regularization strength <inline-formula><mml:math id="inf234"><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> (square root scale) for RBM with <inline-formula><mml:math id="inf235"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> hidden units trained on WW domain sequence data. Right: the weights attached to three representative hidden units are shown for <inline-formula><mml:math id="inf236"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (no regularization) and 0.03 (optimal log-likelihood for the test set, see left panel); weights shown in <xref ref-type="fig" rid="fig3">Figure 3</xref> were obtained at higher regularization <inline-formula><mml:math id="inf237"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula>. For larger regularization, too many weights vanish, and the log-likelihood diminishes. (<bold>B</bold>) Sequences (purple dots) in the MSA attached to a protein family define a highly sparse subset of the sequence space (symbolized by the blue square), from which a RBM model is inferred. The RBM then defines a distribution over the entire sequence space, with high scores for natural sequences and over many more other sequences putatively belonging to the protein family. The representations of the sequence space by RBM can be of different types, three examples of which are sketched in the following panels. (<bold>C</bold>) <italic>Mixture model:</italic> each hidden unit focuses on a specific region in sequence space (color ellipses, different colors correspond to different units), and the attached weights form a template for this region. The representation of a sequence thus involves one (or a few) strongly activated hidden units, while all remaining units are inactive. (<bold>D</bold>) <italic>Entangled model:</italic> all hidden units are moderatly active across the sequence space. The pattern of activities vary from one sequence to another in a complex manner. (<bold>E</bold>) <italic>Compositional model:</italic> a moderate number of hidden units are activated for each protein sequence, each recognizing one of the motifs (shown by colors) in the sequence and controling one of the protein's biological properties. Composing the different motifs in various ways (right circled compositions) generates a large diversity of sequences.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-fig8-v2.tif"/></fig><p>The impact of the regularization strength <inline-formula><mml:math id="inf238"><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> favoring weight sparsity (see definition in 'Materials and methods' <xref ref-type="disp-formula" rid="equ8">Equation (8)</xref>) is two-fold (see <xref ref-type="fig" rid="fig8">Figure 8A</xref> for the WW domain). In the absence of regularization (<inline-formula><mml:math id="inf239"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) weights have components on all sites and residues, and the RBM overfit the data, as illustrated by the large difference between the log-probabilities of the training and test sets. Overfitting notably results in generated sequences that are close to the natural ones and not very diverse, as seen from the entropy of the sequence distribution (<xref ref-type="fig" rid="app1fig8">Appendix 1—figure 8</xref>). Imposing mild regularization allows the RBM to avoid overfitting and maximizes the log-probability of the test set (<inline-formula><mml:math id="inf240"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig8">Figure 8A</xref>), but most sites and residues carry non-zero weights. Interestingly, imposing stronger regularizations has low impact on the generalization abilities of RBM (resulting in a small decrease in the test set log-probability), while making weights much sparser (<inline-formula><mml:math id="inf241"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig3">Figure 3</xref>). For regularizations that are too large, too few non-zero weights remain available and the RBM is not powerful enough to model the data adequately (causing a drop in log-probability of the test set).</p><p>Favoring sparser weights in exchange for a small loss in log-probability has a deep impact on the nature of the representation of the sequence space by the RBM (see <xref ref-type="fig" rid="fig8">Figure 8B</xref>). Good representations are expected to capture the invariant properties of sequences across evolutionarily divergent organisms, rather than idiosyncratic features that are attached to a limited set of sequences (mixture model in <xref ref-type="fig" rid="fig8">Figure 8C</xref>). For sparse-enough weights, the RBM is driven into the compositional representation regime (see <xref ref-type="bibr" rid="bib82">Tubiana and Monasson, 2017</xref>) of <xref ref-type="fig" rid="fig8">Figure 8E</xref>, in which each hidden unit encodes a limited portion of a sequence and the representation of a sequence is defined by the set of hidden units with strong inputs. Hence, the same hidden unit (e.g. weights 1 and 2 coding for the realizations of contacts in the Kunitz domain in <xref ref-type="fig" rid="fig2">Figure 2B</xref>) can be recruited in many parts of the sequence space corresponding to very diverse organisms (see bottom histograms attached to weights 1 and 2 in <xref ref-type="fig" rid="fig2">Figure 2C</xref>, which shows that the sequences corresponding to strong inputs are scattered all over the sequence space). In addition, silencing or activating one hidden unit affects only a limited number of residues (contrary to the entangled regime of <xref ref-type="fig" rid="fig8">Figure 8D</xref>), and a large diversity of sequences can be generated through combinatorial choices of the activity states of the hidden units, an approach that guarantees efficient sequence design.</p><p>In addition, inferring sparse weights makes their comparison across many different protein families easier. In <xref ref-type="fig" rid="fig9">Figure 9 and 10</xref>, we show some representative weights that were obtained after training RBMs with the MSAs of the 16 families considered by <xref ref-type="bibr" rid="bib18">Ekeberg et al. (2014)</xref> (the 17th family, the Kunitz domain, is shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>), which were chosen to illustrate the broad classes of encountered motifs; see 'Supporting information' for the other top weights of the 16 families. We find that weights may code for a variety of structural properties:</p><fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.011</object-id><label>Figure 9.</label><caption><title>Representative weights of the protein families selected in <xref ref-type="bibr" rid="bib18">Ekeberg et al. (2014)</xref>.</title><p>RBM parameters: <inline-formula><mml:math id="inf242"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf243"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. The format is the same as that used in <xref ref-type="fig" rid="fig2">Figures 2B</xref>, <xref ref-type="fig" rid="fig3">3B</xref> and <xref ref-type="fig" rid="fig4">4B</xref>. Weights are ordered by similarity, from top to bottom: Sushi domain (PF00084), Heat shock protein Hsp20 (PF00011), SH3 Domain (PF00018), Homeodomain protein (PF00046), Zinc finger–C4 type (PF00105), Cyclic nucleotide-binding domain (PF00027), and RNA recognition motif (PF00076). Green spheres show the sites that carry the largest weights on the 3D folds (in order, PDB: 1elv, 2bol, 2hda, 2vi6, 1gdc, 3fhi, 1g2e). The ten weights with largest norms in each family are shown in <xref ref-type="supplementary-material" rid="supp5">Supplementary files 5</xref>–<xref ref-type="supplementary-material" rid="supp6">6</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-fig9-v2.tif"/></fig><list list-type="bullet"><list-item><p>Pairwise contacts on the corresponding structures, realized by various types of residue-residue physico-chemical interactions (see <xref ref-type="fig" rid="fig9">Figure 9A and B</xref>). These motifs are similar to weights 2 of the Kunitz domain (<xref ref-type="fig" rid="fig2">Figure 2B</xref>) and weight 1 of the WW domain (<xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p></list-item><list-item><p>Structural triplets, carrying residues in proximity either on the tertiary structure or on the secondary structure (see <xref ref-type="fig" rid="fig9">Figure 9C,D,E and F</xref>). Many such triplets arise from electrostatic interactions and carry amino acids with alternating charges (<xref ref-type="fig" rid="fig9">Figure 9C,D and E</xref>); they are often found in α-helices and reflect their <inline-formula><mml:math id="inf244"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>-site periodicity (<xref ref-type="fig" rid="fig9">Figure 9E</xref> and last two sites in <xref ref-type="fig" rid="fig9">Figure 9D</xref>), in agreement with weight 1 of the Kunitz domain (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Triplets may also involve residues with non-electrostatic interactions (<xref ref-type="fig" rid="fig9">Figure 9F</xref>).</p></list-item><list-item><p>Other structural motifs involving four or more residues, for example between β-strands (see <xref ref-type="fig" rid="fig9">Figure 9G</xref>). Such motifs were also found in the WW domain (see weight 2 in <xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p></list-item></list><p>In addition, weights may also reflect non-structural properties, such as:</p><list list-type="bullet"><list-item><p>Stretches of gaps at the extremities of the sequences, indicating the presence of subfamilies containing shorter proteins (see <xref ref-type="fig" rid="fig10">Figure 10A and B</xref>).</p></list-item><list-item><p>Stretches of gaps in regions corresponding to internal loops of the proteins (see <xref ref-type="fig" rid="fig10">Figure 10C and D</xref>). These motifs control the length of these loops, similarly to weight 1 of HSP70 (see <xref ref-type="fig" rid="fig4">Figure 4C</xref>).</p></list-item><list-item><p>Contiguous residue motifs on loops (<xref ref-type="fig" rid="fig10">Figure 10E and F</xref>) and β<italic>–</italic>strands (<xref ref-type="fig" rid="fig10">Figure 10G</xref>). These motifs could be involved in binding specificity, as found in the Kunitz and WW domains (weights 4 in <xref ref-type="fig" rid="fig2">Figure 2B and 3B</xref>).</p></list-item><list-item><p>Phylogenetic properties shared by a subset of evolutionary close sequences (see bottom histograms <xref ref-type="fig" rid="fig10">Figure 10H and I</xref>), contrary to the motifs listed above. These motifs are generally less sparse and scattered over the protein sequence, as weight 5 of the Kunitz domain in <xref ref-type="fig" rid="fig2">Figure 2B</xref>.</p></list-item></list><p>For all those motifs, the top histograms of the inputs on the corresponding hidden units indicate how the protein families cluster into distinct subfamilies with respect to the features.</p><fig id="fig10" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.012</object-id><label>Figure 10.</label><caption><title>Representative weights of the protein families selected in <xref ref-type="bibr" rid="bib18">Ekeberg et al. (2014)</xref>.</title><p>RBM parameters: <inline-formula><mml:math id="inf245"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf246"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.05</mml:mn><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. The format is the same as that used in <xref ref-type="fig" rid="fig2">Figures 2B</xref>, <xref ref-type="fig" rid="fig3">3B</xref> and <xref ref-type="fig" rid="fig4">4B</xref>. Weights are ordered by similarity (from top to bottom): SH2 domain (PF00017), superoxide dismutase (PF00081), K homology domain (PF00013), fibronectin type III domain (PF00041), double-stranded RNA-binding motif (PF00035), zinc-binding dehydrogenase (PF00107), cadherin (PF00028), glutathione S-transferase, C-terminal domain (PF00043), and 2Fe-2S iron-sulfur cluster binding domain (PF00111). Green spheres show the sites that carry the largest weights on the 3D folds (in order, PDB: 1o47, 3bfr, 1wvn, 1bqu, 1o0w, 1a71, 2o72, 6gsu, 1a70). The ten weights with largest norms in each family are shown in <xref ref-type="supplementary-material" rid="supp5">Supplementary files 5</xref>–<xref ref-type="supplementary-material" rid="supp6">6</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-fig10-v2.tif"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In summary, we have shown that RBM are a promising, versatile, and unifying method for modeling and generating protein sequences. RBM, when trained on protein sequence data, reveal a wealth of structural, functional and evolutionary features. To our knowledge, no other method used to date has been able to extract such detailed information in a unique framework. In addition, RBM can be used to design new sequences: hidden units can be seen as representation-controling knobs, that are tunable at will to sample specific portions of the sequence space corresponding to desired functionalities. A major and appealing advantage of RBM is that the two-layer architecture of the model embodies the very concept of genotype-phenotype mapping (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Codes for learning and visualizing RBM are attached to this publication (see 'Materials and methods').</p><p>From a machine-learning point of view, the values of RBM that define parameters (such as class of potentials and number <inline-formula><mml:math id="inf247"><mml:mi>M</mml:mi></mml:math></inline-formula> of hidden units, or regularization penalties) were selected on the basis of the log-probability of a test set of natural sequences not used for training and on the interpretability of the model. The dReLU potentials that we introduced in this work (<xref ref-type="disp-formula" rid="equ6">Equation (6)</xref>) consistently outperform other potentials for generative purposes. As expected, increasing <inline-formula><mml:math id="inf248"><mml:mi>M</mml:mi></mml:math></inline-formula> improves likelihood up to some level, after which overfitting starts to occur. Adding sparsifying regularization not only prevents overfitting but also facilitates the biological interpretation of weights (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). It is thus an effective way to enhance the correspondence between representation and phenotypic spaces (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). It also allows us to drive the RBM operation point at which most features can be activated across many regions of the sequence space (<xref ref-type="fig" rid="fig8">Figure 8E</xref>); examples are provided by hidden units 1 and 2 for the Kunitz domain in <xref ref-type="fig" rid="fig2">Figure 2B and C</xref> and hidden unit 3 for the WW domain in <xref ref-type="fig" rid="fig3">Figure 3B and C</xref>. Combining these features allows us to generate a variety of new sequences with high probabilities, such as those shown in <xref ref-type="fig" rid="fig5">Figure 5</xref>. Note that some inferred features, such as hidden unit 5 in <xref ref-type="fig" rid="fig2">Figure 2C and D</xref> and, to a lesser extent, hidden unit 2 in <xref ref-type="fig" rid="fig3">Figure 3B and C</xref>, are, by contrast, activated by evolutionary close sequences. Our inferred RBMs thus share some partial similarity with the mixture models of <xref ref-type="fig" rid="fig8">Figure 8C</xref>. Interestingly, the identification of specific sequence motifs with structural, functional or evolutionary meaning does not seem to be restricted to a few protein domains or proteins, but could be a generic property as suggested by our study of 16 additional families (<xref ref-type="fig" rid="fig9">Figure 9 and 10</xref>).</p><p>Despite the algorithmic improvements developed in the present work (see 'Materials and methods'), training RBM is challenging as it requires intensive sampling. Generative models that are alternatives to RBM, and that do not require Markov Chain sampling, exist in machine learning; they include Generative Adversarial Networks (<xref ref-type="bibr" rid="bib26">Goodfellow et al., 2014</xref>) and Variational Auto–encoders (VAE) (<xref ref-type="bibr" rid="bib40">Kingma and Welling, 2013</xref>. VAE were recently applied to protein sequence data for fitness prediction (<xref ref-type="bibr" rid="bib72">Sinai et al., 2017</xref>; <xref ref-type="bibr" rid="bib64">Riesselman et al., 2018</xref>. Our work differs in several impo rtant points: our RBM is an extension of direct-based coupling approaches, requires much less hidden units (about 10 to 50 times fewer than were used in <xref ref-type="bibr" rid="bib72">Sinai et al., 2017</xref> and <xref ref-type="bibr" rid="bib64">Riesselman et al., 2018</xref>), has a simple architecture with two layers carrying sequences and representations, infers interpretable weights with biological relevance, and can be easily tweaked to design sequences with desired statistical properties. We have shown that RBM can successfully model small domains (of a few tens of amino acids) as well as much longer proteins (of several hundreds of residues). The reason is that, even for very large proteins, the computational effort can be controlled through the number <inline-formula><mml:math id="inf249"><mml:mi>M</mml:mi></mml:math></inline-formula> of hidden units (see 'Materials and methods' for discussion about the running time of our learning algorithm). Choosing moderate values of <inline-formula><mml:math id="inf250"><mml:mi>M</mml:mi></mml:math></inline-formula> makes the number of parameters to be learned reasonable and avoids overfitting, yet allows for the discovery of important functional and structural features. It is, however, unclear how <inline-formula><mml:math id="inf251"><mml:mi>M</mml:mi></mml:math></inline-formula> should scale with <inline-formula><mml:math id="inf252"><mml:mi>N</mml:mi></mml:math></inline-formula> to unveil ‘all’ the functional features of very complex and rich proteins (such as Hsp70).</p><p>From a computational biology point of view, RBM unifies and extends previous approaches in the context of protein coevolutionary analysis. From the one hand, the features extracted by RBM identify ‘collective modes’ that control the biological functionalities of the protein, in a similar way to the so-called sectors extracted by statistical coupling analysis (<xref ref-type="bibr" rid="bib28">Halabi et al., 2009</xref>). However, contrary to sectors, the collective modes are not disjoint: a site may participate in different features, depending on the value of the residue it carries. On the other hand, RBM coincide with direct-coupling analysis (<xref ref-type="bibr" rid="bib55">Morcos et al., 2011</xref> when the potential <inline-formula><mml:math id="inf253"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is quadratic in <inline-formula><mml:math id="inf254"><mml:mi>h</mml:mi></mml:math></inline-formula>. For non-quadratic potentials <inline-formula><mml:math id="inf255"><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi></mml:math></inline-formula>, couplings to all orders between the visible units are present. The presence of high-order interactions allows for a significantly better description of gap modes <xref ref-type="bibr" rid="bib20">Feinauer et al., 2014</xref>, of multiple long-range couplings due to ligand binding, and of outliers sequences (<xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref>). Our dReLU RBM model offers an efficient way to go beyond pairwise coupling models, without an explosion in the number of interaction parameters to be inferred, as all high-order interactions (whose number, <inline-formula><mml:math id="inf256"><mml:msup><mml:mpadded lspace="3.3pt" width="+3.3pt"><mml:mi>q</mml:mi></mml:mpadded><mml:mi>N</mml:mi></mml:msup></mml:math></inline-formula>, is exponentially large in <inline-formula><mml:math id="inf257"><mml:mi>N</mml:mi></mml:math></inline-formula>) are effectively generated from the same <inline-formula><mml:math id="inf258"><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math></inline-formula> weights <inline-formula><mml:math id="inf259"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. RBM also outperforms the Hopfield-Potts framework <xref ref-type="bibr" rid="bib14">Cocco et al., 2013</xref>, an approach previously introduced to capture both collective and localized structural modes. Hopfield-Potts ’patterns’ were derived with no sparsity regularization and within the mean-field approximation, which made the Hopfield-Potts model insufficiently accurate for sequence design (see <xref ref-type="fig" rid="app1fig14">Appendix 1—figures 14</xref>–<xref ref-type="fig" rid="app1fig18">18</xref>).</p><p>The weights shown in <xref ref-type="fig" rid="fig2">Figures 2B</xref>, <xref ref-type="fig" rid="fig3">3B</xref> and <xref ref-type="fig" rid="fig4">4B</xref> are stable with respect to subsampling (<xref ref-type="fig" rid="app1fig13">Appendix 1—figure 13</xref>) and could be unambiguously interpreted and related to existing literature. However, the biological significance of some of the inferred features remains unclear, and would require experimental investigation. Similarly, the capability of RBM to design new functional sequences need experimental validation besides the comparison with past design experiments (<xref ref-type="fig" rid="fig5">Figure 5E</xref>) and the benchmarking on in silico proteins (<xref ref-type="fig" rid="fig7">Figure 7</xref>). Although recombining different parts of natural proteins sequences from different organisms is a well recognized procedure for protein design (<xref ref-type="bibr" rid="bib75">Stemmer, 1994</xref>; <xref ref-type="bibr" rid="bib39">Khersonsky and Fleishman, 2016</xref>, RBM innovates in a crucial aspect. Traditional approaches cut sequences into fragments at fixed positions on the basis of secondary structure considerations, but such parts are learned and need not be contiguous along the primary sequence in RBM models. We believe that protein design with detailed computational modeling methods, such as Rosetta (<xref ref-type="bibr" rid="bib71">Simons et al., 1997</xref>; <xref ref-type="bibr" rid="bib39">Khersonsky and Fleishman, 2016</xref>, could be efficiently guided by our RBM-based approach, in much the same way as protein folding greatly benefited from the inclusion of long-range contacts found by direct-coupling analysis (<xref ref-type="bibr" rid="bib49">Marks et al., 2011</xref>; <xref ref-type="bibr" rid="bib31">Hopf et al., 2012</xref>.</p><p>Future projects include developing systematic methods for identifying function-determining sites, and analyzing more protein families. As suggested by the analysis of the 16 families shown in <xref ref-type="fig" rid="fig9">Figure 9 and 10</xref>, such a study could help to establish a general classification of motifs into broad classes with structural or functional relevance, shared by distinct proteins. In addition, it would be very interesting to use RBM to determine evolutionary paths between two, or more, protein sequences in the same family, but with distinct phenotypes. In principle, RBM could reveal how functionalities continuously change along the paths, and could provide a measure of viability of intermediary sequences.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Data preprocessing</title><p>We use the PFAM sequence alignments of the V31.0 release (March 2017) for both Kunitz (PF00014) and WW (PF00397) domains. All columns with insertions are discarded, then duplicate sequences are removed. We are left with, respectively, <inline-formula><mml:math id="inf260"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>53</mml:mn></mml:mrow></mml:math></inline-formula> sites and <inline-formula><mml:math id="inf261"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>8062</mml:mn></mml:mrow></mml:math></inline-formula> unique sequences for Kunitz, and <inline-formula><mml:math id="inf262"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>31</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf263"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>7503</mml:mn></mml:mrow></mml:math></inline-formula> for WW; each site can carry <inline-formula><mml:math id="inf264"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:math></inline-formula> different symbols. To correct for the heterogeneous sampling of the sequence space, a reweighting procedure is applied: each sequence <inline-formula><mml:math id="inf265"><mml:msup><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mi mathvariant="normal">ℓ</mml:mi></mml:msup></mml:math></inline-formula> with <inline-formula><mml:math id="inf266"><mml:mrow><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is assigned a weight <inline-formula><mml:math id="inf267"><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="normal">ℓ</mml:mi></mml:msub></mml:math></inline-formula> equal to the inverse of the number of sequences with more than 90% amino-acid identity (including itself). In all that follows, the average over the sequence data of a function <inline-formula><mml:math id="inf268"><mml:mi>f</mml:mi></mml:math></inline-formula> is defined as<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>B</mml:mi></mml:munderover><mml:mrow><mml:mpadded width="+2.8pt"><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="normal">ℓ</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mi mathvariant="normal">ℓ</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo mathsize="210%" stretchy="false">/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>B</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="normal">ℓ</mml:mi></mml:msub></mml:mrow><mml:mo rspace="7.5pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-2"><title>Learning procedure</title><sec id="s4-2-1"><title>Objective function and gradients</title><p>Training is performed by maximizing, through stochastic gradient ascent, the difference between the log-probability of the sequences in the MSA and the regularization costs,<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:mpadded width="+5pt"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mpadded></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Regularization terms include a standard <inline-formula><mml:math id="inf269"><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> penalty for the potentials acting on the visible units, and a custom <inline-formula><mml:math id="inf270"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> penalty for the weights. The latter penalty corresponds to an effective <inline-formula><mml:math id="inf271"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> regularization with an adaptive strength that increases with the weights, thus promoting homogeneity among hidden units. (This can be seen from the gradient of the regularization term, which reads <inline-formula><mml:math id="inf272"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mtext>sign</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.) Besides, it prevents hidden units from ending up entirely disconnected (<inline-formula><mml:math id="inf273"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>0</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>), and makes the determination of the penalty strength <inline-formula><mml:math id="inf274"><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> more robust (see <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>).</p><p>According to <xref ref-type="disp-formula" rid="equ5">Equation (5)</xref>, the probability of a sequence <inline-formula><mml:math id="inf275"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> can be written as,<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>eff</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo mathsize="210%" stretchy="false">/</mml:mo><mml:mrow><mml:mo maxsize="210%" minsize="210%">(</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>eff</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo maxsize="210%" minsize="210%" rspace="7.5pt">)</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="12.5pt">,</mml:mo><mml:mtext>where</mml:mtext></mml:mrow></mml:mrow><mml:mo mathvariant="italic" separator="true"> </mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>eff</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>is the effective ‘energy’ of the sequence, which depends on all the model parameters. The gradient of <inline-formula><mml:math id="inf276"><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> over one of these parameters, denoted generically by <inline-formula><mml:math id="inf277"><mml:mi>ψ</mml:mi></mml:math></inline-formula>, is therefore<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mrow><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>eff</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mpadded width="+5pt"><mml:msub><mml:mrow><mml:mo maxsize="210%" minsize="210%">⟨</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>eff</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo maxsize="210%" minsize="210%">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mpadded></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Hence, the gradient is the difference between the average values of the derivative of <inline-formula><mml:math id="inf278"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> with respect to <inline-formula><mml:math id="inf279"><mml:mi>ψ</mml:mi></mml:math></inline-formula> over the model and the data distributions.</p></sec><sec id="s4-2-2"><title>Moment evaluation</title><p>Several methods have been developed to evaluate the model average in the gradient ( see <xref ref-type="disp-formula" rid="equ10">Equation (10))</xref> <xref ref-type="bibr" rid="bib23">Fischer and Igel, 2012</xref>. The naive approach is to run for each gradient iteration a full Markov Chain Monte Carlo (MCMC) simulation of the RBM until the samples reach equilibrium, then use these samples to compute the model average <xref ref-type="bibr" rid="bib1">Ackley et al., 1987</xref>. A more efficient approach is the Persistent Constrastive Divergence <xref ref-type="bibr" rid="bib80">Tieleman, 2008</xref>: the samples obtained from the previous simulation are used to initialize for the next MCMC simulation, and only a small number of Gibbs updates (<inline-formula><mml:math id="inf280"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>) are performed between each gradient evaluation. If the model parameters evolve slowly, the samples are always at equilibrium, and we obtain the same accuracy as that provided the naive approach at a fraction of the computational cost. In practice, the Persistent Contrastive Divergence (PCD) algorithm succeeds if the mixing rate of the Markov Chain — which depends on the nature and dimension of the data, and the model parameters — is fast enough. In our training sessions, PCD proved sufficient to learn relevant features and good generative models for small proteins and regularized RBM.</p></sec><sec id="s4-2-3"><title>Stochastic gradient ascent</title><p>The optimization is carried out by Stochastic Gradient Ascent. At each step, the gradient is evaluated using a mini-batch of the data, as well as a small number of MCMC configurations. In most of our training sessions, we used the same batch size (=100) for both sets. The model is initialized as follows:</p><list list-type="bullet"><list-item><p>Weights <inline-formula><mml:math id="inf281"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are randomly and independently drawn from a Gaussian distribution with zero mean and variance equal to <inline-formula><mml:math id="inf282"><mml:mfrac><mml:mn>0.1</mml:mn><mml:mi>N</mml:mi></mml:mfrac></mml:math></inline-formula>. The scaling factor <inline-formula><mml:math id="inf283"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac></mml:math></inline-formula> ensures that the initial input distribution has variance of the order of <inline-formula><mml:math id="inf284"><mml:mn>1</mml:mn></mml:math></inline-formula>.</p></list-item><list-item><p>The potentials <inline-formula><mml:math id="inf285"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are given their values in the independent-site model: <inline-formula><mml:math id="inf286"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>⟩</mml:mo></mml:mrow><mml:mtext>MSA</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf287"><mml:mi>δ</mml:mi></mml:math></inline-formula> denotes the Kronecker function.</p></list-item><list-item><p>For all hidden-unit potentials, we set <inline-formula><mml:math id="inf288"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf289"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p></list-item></list><p>The learning rate is initially set to <inline-formula><mml:math id="inf290"><mml:mn>0.1</mml:mn></mml:math></inline-formula>, and decays exponentially after a fraction of the total training time (e.g. 50%) until it reaches a final, small value, for example 10<sup>-4</sup>.</p></sec><sec id="s4-2-4"><title>Dynamic reparametrization</title><p>For Gaussian and dReLU potentials, there is a redundancy between the slope of the hidden unit average activity and the global amplitude of the weight vector. Indeed, for the Gaussian potential, the model distribution is invariant under rescaling transformations <inline-formula><mml:math id="inf291"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf292"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf293"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and offset transformation <inline-formula><mml:math id="inf294"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf295"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>μ</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Though we can set <inline-formula><mml:math id="inf296"><mml:mrow><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo rspace="5.3pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>0</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∀</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> without loss of generality, it can lead either to numerical instability (at high learning rate) or slow learning (at low learning rate). A significantly better choice is to adjust the slope and offset dynamically so that <inline-formula><mml:math id="inf297"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf298"><mml:mrow><mml:mrow><mml:mtext>Var</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∼</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> at all times. This new approach, reminiscent of batch normalization for deep networks, is implemented in the training algorithm released with this work. Detailed equations and benchmarks will be available online soon.</p></sec><sec id="s4-2-5"><title>Gauge choice</title><p>Since the conditional probability <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> is normalized, the transformations <inline-formula><mml:math id="inf299"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf300"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> leave the conditional probability invariant. We choose the zero-sum gauges, defined by <inline-formula><mml:math id="inf301"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf302"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Since the regularization penalties over the fields and weight depend on the gauge choice, the gauge must be enforced throughout all training and not only at the end. The updates on the fields leave the gauge invariant, so the transformation <inline-formula><mml:math id="inf303"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> can be used only once, after initialization. On the other hand, this is not the case for the updates on the weights, so the transformation <inline-formula><mml:math id="inf304"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> must be applied after each gradient update.</p></sec><sec id="s4-2-6"><title>Evaluating the partition function</title><p>Evaluating <inline-formula><mml:math id="inf305"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> requires knowledge of the partition function <inline-formula><mml:math id="inf306"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi></mml:munder></mml:mstyle><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>eff</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (see denominator in <xref ref-type="disp-formula" rid="equ9">Equation (9)).</xref> The later expression, which involves summing over <inline-formula><mml:math id="inf307"><mml:msup><mml:mi>q</mml:mi><mml:mi>N</mml:mi></mml:msup></mml:math></inline-formula> terms is not tractable. Instead, we estimate <inline-formula><mml:math id="inf308"><mml:mi>Z</mml:mi></mml:math></inline-formula> using the Annealed Importance Sampling algorithm (AIS) <xref ref-type="bibr" rid="bib57">Neal, 2001</xref>; <xref ref-type="bibr" rid="bib67">Salakhutdinov and Murray, 2008</xref>. Briefly, the idea is to estimate partition function ratios. Let <inline-formula><mml:math id="inf309"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf310"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>0</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula> be two probability distributions with partition functions <inline-formula><mml:math id="inf311"><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf312"><mml:msub><mml:mi>Z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. Then:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>0</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo>∼</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>0</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>0</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>Z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>Z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Therefore, provided that <inline-formula><mml:math id="inf313"><mml:msub><mml:mi>Z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is known (e.g. if <inline-formula><mml:math id="inf314"><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is an independent model with no couplings), one can in principle estimate <inline-formula><mml:math id="inf315"><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> through Monte Carlo sampling. The difficulty lies in the variance of the estimator: if <inline-formula><mml:math id="inf316"><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf317"><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> are very different from one another, then some configurations can be very likely for <inline-formula><mml:math id="inf318"><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and have very low probability with <inline-formula><mml:math id="inf319"><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>; these configurations almost never appear in the Monte Carlo estimate of <inline-formula><mml:math id="inf320"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mo>.</mml:mo><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, but the probability ratio can be exponentially large. In Annealed Importance Sampling, we address this problem by constructing a continuous path of interpolating distributions <inline-formula><mml:math id="inf321"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mpadded width="+2.8pt"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>β</mml:mi></mml:msup></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and estimate <inline-formula><mml:math id="inf322"><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> as a product of the ratios of the partition functions:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:msub></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:msub><mml:mi>Z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mrow><mml:mo>×</mml:mo><mml:mpadded width="+5pt"><mml:msub><mml:mi>Z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mpadded></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where we choose a linear set of interpolating inverse temperatures of the form <inline-formula><mml:math id="inf323"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>l</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula>. To evaluate the successive expectations, we use a fixed number <inline-formula><mml:math id="inf324"><mml:mi>C</mml:mi></mml:math></inline-formula> of samples initially drawn from <inline-formula><mml:math id="inf325"><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, and gradually anneal them from <inline-formula><mml:math id="inf326"><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf327"><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> by successive applications of Gibbs sampling at <inline-formula><mml:math id="inf328"><mml:msub><mml:mi>P</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:math></inline-formula>. Moreover, all computations are done in logarithmic scales for numerical stability purposes: we estimate <inline-formula><mml:math id="inf329"><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mfrac><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>Z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mrow><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>0</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo>∼</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, which is justified if <inline-formula><mml:math id="inf330"><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf331"><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> are close. In practice, we used <inline-formula><mml:math id="inf332"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> chains, <inline-formula><mml:math id="inf333"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> steps. For the initial distribution <inline-formula><mml:math id="inf334"><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, we take the closest (in terms of KL divergence) independent model to the data distribution <inline-formula><mml:math id="inf335"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The visible layer fields are those of the independent model inferred from the MSA, and the weights are <inline-formula><mml:math id="inf336"><mml:mrow><mml:msup><mml:mi mathvariant="bold">𝐰</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. For the hidden potential values, we infer the parameters from the statistics of the hidden layer activity conditioned to the data.</p></sec><sec id="s4-2-7"><title>Explicit formula for sampling and training RBM</title><p>Training, sampling and computing the probability of sequences with RBM requires: (1) sampling from <inline-formula><mml:math id="inf337"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐡</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, (2) sampling from <inline-formula><mml:math id="inf338"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐡</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and (3) evaluating the effective energy <inline-formula><mml:math id="inf339"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>eff</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and its derivatives. This is done as follows:</p><list list-type="order"><list-item><p>Each sequence site <inline-formula><mml:math id="inf340"><mml:mi>i</mml:mi></mml:math></inline-formula> is encoded as a categorical variable taking integer values <inline-formula><mml:math id="inf341"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with each integer corresponding to one of the 20 amino-acids + 1 gap. Similarly, the fields and weights are encoded as a <inline-formula><mml:math id="inf342"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:math></inline-formula> matrix and a <inline-formula><mml:math id="inf343"><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:math></inline-formula> tensor, respectively. Owing to the bipartite structure of the graph, <inline-formula><mml:math id="inf344"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐡</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∏</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mi mathvariant="bold">𝐢</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐡</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ4">Equation (4))</xref>. Therefore, sampling from <inline-formula><mml:math id="inf345"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐡</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is done in three steps: compute the inputs received from the hidden layer, then the conditional probabilities <inline-formula><mml:math id="inf346"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐡</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> given the inputs, and sample each visible unit independently the corresponding conditional distributions.</p></list-item><list-item><p>The conditional probability <inline-formula><mml:math id="inf347"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐡</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> factorizes. Given a visible configuration <inline-formula><mml:math id="inf348"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula>, each hidden unit is sampled independently from the others via <inline-formula><mml:math id="inf349"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ3">Equation (3))</xref>. For a quadratic potential <inline-formula><mml:math id="inf350"><mml:mrow><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, this conditional distribution is Gaussian. For the dReLU potential <inline-formula><mml:math id="inf351"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ6">Equation (6)</xref>, we introduce first<disp-formula id="equ13"><mml:math id="m13"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mtext>erf</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mi>x</mml:mi><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msqrt><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:msqrt></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Some useful properties of <inline-formula><mml:math id="inf352"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> are:</p><p>  • <inline-formula><mml:math id="inf353"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>  • <inline-formula><mml:math id="inf354"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mn>1</mml:mn><mml:mi>x</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>  • <inline-formula><mml:math id="inf355"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>To avoid numerical issues, <inline-formula><mml:math id="inf356"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> is computed in practice with its definition for <inline-formula><mml:math id="inf357"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and with its asymptotic expansion otherwise. We also write <inline-formula><mml:math id="inf358"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒯</mml:mi><mml:mo>⁢</mml:mo><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the truncated Gaussian distribution of mode <inline-formula><mml:math id="inf359"><mml:mi>μ</mml:mi></mml:math></inline-formula>, width <inline-formula><mml:math id="inf360"><mml:mi>σ</mml:mi></mml:math></inline-formula> and support <inline-formula><mml:math id="inf361"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>.</p><p>Then, <inline-formula><mml:math id="inf362"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is given by a mixture of two truncated Gaussians:<disp-formula id="equ14"><label>(13)</label><mml:math id="m14"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mi class="ltx_font_mathcaligraphic">𝒯</mml:mi><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mi class="ltx_font_mathcaligraphic">𝒯</mml:mi><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mrow><mml:msup><mml:mi>γ</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mfrac><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>γ</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mfrac><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf363"><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mo>±</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mo>∓</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mo>±</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:msqrt><mml:msup><mml:mi>γ</mml:mi><mml:mo>±</mml:mo></mml:msup></mml:msqrt></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:msup><mml:mi>γ</mml:mi><mml:mo>±</mml:mo></mml:msup></mml:msqrt></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf364"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>±</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>Z</mml:mi><mml:mo>±</mml:mo></mml:msup><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>Evaluating <inline-formula><mml:math id="inf365"><mml:msub><mml:mi>E</mml:mi><mml:mtext>eff</mml:mtext></mml:msub></mml:math></inline-formula> and its derivatives requires an explicit expression for the cumulant–generating function <inline-formula><mml:math id="inf366"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. For quadratic potentials, <inline-formula><mml:math id="inf367"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is quadratic too. For dReLU potentials, we have <inline-formula><mml:math id="inf368"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf369"><mml:msup><mml:mi>Z</mml:mi><mml:mo>±</mml:mo></mml:msup></mml:math></inline-formula> is defined above.</p></list-item></list></sec><sec id="s4-2-8"><title>Computational complexity</title><p>The computational complexity is of the order of <inline-formula><mml:math id="inf370"><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula>, with more accurate variants taking more time. The algorithm scales reasonably to large protein sizes, and was tested successfully for <inline-formula><mml:math id="inf371"><mml:mi>N</mml:mi></mml:math></inline-formula> up to <inline-formula><mml:math id="inf372"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mn>700</mml:mn></mml:mrow></mml:math></inline-formula>, taking in the order of 1–2 days on an Intel Xeon Phi processor with 2 <inline-formula><mml:math id="inf373"><mml:mo>×</mml:mo></mml:math></inline-formula> 28 cores.</p></sec></sec><sec id="s4-3"><title>Sampling procedure</title><p>Sampling from <inline-formula><mml:math id="inf374"><mml:mi>P</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ5">Equation (5)</xref> is done with Markov Chain Monte Carlo methods, with the standard alternate Gibbs sampler described in the main text and in <xref ref-type="bibr" rid="bib23">Fischer and Igel (2012)</xref>. Conditional sampling, that is sampling from <inline-formula><mml:math id="inf375"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>μ</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is straightforward with RBM: it is achieved by the same Gibbs sampler while keeping <inline-formula><mml:math id="inf376"><mml:msub><mml:mi>h</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> fixed.</p><p>The RBM architecture can be modified to generate sequences with high probabilities (as in <xref ref-type="fig" rid="fig5">Figure 5E&amp;F</xref>). The trick is to duplicate the hidden units, the weights, and the local potentials acting on the visible units, as shown in <xref ref-type="fig" rid="fig11">Figure 11</xref>. By doing so, the sequences <inline-formula><mml:math id="inf377"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> are distributed according to<disp-formula id="equ15"><label>(14)</label><mml:math id="m15"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+2.8pt"><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐡</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐡</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mpadded></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Hence, with the duplicated RBM, sequences with high probabilities in the original RBM model are given a boost when compared to low-probability sequences (<xref ref-type="fig" rid="fig11">Figure 11</xref>). Note that more subtle biases can be introduced by duplicating some (but not all) of the hidden units in order to give more importance in the sampling to the associated statistical features.</p><fig id="fig11" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.013</object-id><label>Figure 11.</label><caption><title>Duplicate RBM for biasing sampling toward high-probability sequences.</title><p>Visible-unit configurations <inline-formula><mml:math id="inf378"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> are sampled from <inline-formula><mml:math id="inf379"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>∝</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-fig11-v2.tif"/></fig></sec><sec id="s4-4"><title>Contact map estimation</title><p>RBM can be used for contact prediction in a manner similar to pairwise coupling models, after derivation of an effective coupling matrix <inline-formula><mml:math id="inf380"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>eff</mml:mtext></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Consider a sequence <inline-formula><mml:math id="inf381"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula>, and two sites <inline-formula><mml:math id="inf382"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>. Define the set of mutated sequences <inline-formula><mml:math id="inf383"><mml:msup><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> with amino acid content: <inline-formula><mml:math id="inf384"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf385"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf386"><mml:mi>a</mml:mi></mml:math></inline-formula> if <inline-formula><mml:math id="inf387"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf388"><mml:mi>b</mml:mi></mml:math></inline-formula> if <inline-formula><mml:math id="inf389"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). The differential likelihood ratio<disp-formula id="equ16"><label>(15)</label><mml:math id="m16"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo>;</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo rspace="7.5pt">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>P</italic> is the marginal distribution in <xref ref-type="disp-formula" rid="equ5">Equation (5)</xref>, measures epistatic contributions to the double mutation <inline-formula><mml:math id="inf390"><mml:mrow><mml:mi>a</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf391"><mml:mrow><mml:mi>b</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> on sites <italic>i</italic> and <italic>j</italic>, respectively, in the background defined by sequence <inline-formula><mml:math id="inf392"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig6">Figure 6A</xref>). The effective coupling matrix is then defined as<disp-formula id="equ17"><label>(16)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>eff</mml:mtext></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mpadded width="+5pt"><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mo>;</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mpadded></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the average is taken over the sequences <inline-formula><mml:math id="inf393"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> in the MSA. For a pairwise model, <inline-formula><mml:math id="inf394"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> does not depend on the background sequence <inline-formula><mml:math id="inf395"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula>, and <xref ref-type="disp-formula" rid="equ17">Equation (16)</xref> coincides with the true coupling in the zero-sum gauge. Contact estimators are based on the Frobenius norms of <inline-formula><mml:math id="inf396"><mml:msup><mml:mi>J</mml:mi><mml:mtext>eff</mml:mtext></mml:msup></mml:math></inline-formula>, with the Average Product Correction (see <xref ref-type="bibr" rid="bib15">Cocco et al., 2018</xref>).</p></sec><sec id="s4-5"><title>Code availability</title><p>The Python 2.7 package for training and visualizing RBMs, which was used to obtain the results reported in this work, is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/jertubiana/ProteinMotifRBM">https://github.com/jertubiana/ProteinMotifRBM</ext-link> (<xref ref-type="bibr" rid="bib81">Tubiana, 2019</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/ProteinMotifRBM">https://github.com/elifesciences-publications/ProteinMotifRBM</ext-link>). In addition, Jupyter notebooks are provided for reproducing most of the figures in this article.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgments</title><p>We thank D Chatenay for useful comments on the manuscript and L Posani for his help on lattice proteins.</p> </ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><object-id pub-id-type="doi">10.7554/eLife.39397.014</object-id><label>Supplementary file 1.</label><caption><title>Weight logo for all hidden units inferred from the Kunitz domain MSA.</title></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-39397-supp1-v2.pdf"/></supplementary-material><supplementary-material id="supp2"><object-id pub-id-type="doi">10.7554/eLife.39397.015</object-id><label>Supplementary file 2.</label><caption><title>Weight logo for all hidden units inferred from the WW domain MSA.</title></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-39397-supp2-v2.pdf"/></supplementary-material><supplementary-material id="supp3"><object-id pub-id-type="doi">10.7554/eLife.39397.016</object-id><label>Supplementary file 3.</label><caption><title>Weight logo for all hidden units inferred from the LP MSA.</title></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-39397-supp3-v2.pdf"/></supplementary-material><supplementary-material id="supp4"><object-id pub-id-type="doi">10.7554/eLife.39397.017</object-id><label>Supplementary file 4.</label><caption><title>Weight logo of 12 Hopfield-Potts pattern inferred from the Hsp70 protein MSA.</title><p>The format is the same as that used for <xref ref-type="fig" rid="app1fig14">Appendix 1—figures 14</xref>–<xref ref-type="fig" rid="app1fig16">16</xref>.</p></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-39397-supp4-v2.pdf"/></supplementary-material><supplementary-material id="supp5"><object-id pub-id-type="doi">10.7554/eLife.39397.018</object-id><label>Supplementary file 5.</label><caption><title>Weight logo and associated structures of the 10 weights with highest norms, excluding the gap modes for each of the 16 additional domains shown in <xref ref-type="fig" rid="fig9">Figure 9</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-39397-supp5-v2.zip"/></supplementary-material><supplementary-material id="supp6"><object-id pub-id-type="doi">10.7554/eLife.39397.019</object-id><label>Supplementary file 6.</label><caption><title>Weight logo and associated structures of the 10 sparse (i.e. within the 30% most sparse weights of the RBM) weights with highest norms, excluding the gap modes for each of the 16 additional domains shown in <xref ref-type="fig" rid="fig9">Figure 9</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-39397-supp6-v2.zip"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>The Python 2.7 package for training and visualizing RBMs, used to obtained the results reported in this work, is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/jertubiana/ProteinMotifRBM">https://github.com/jertubiana/ProteinMotifRBM</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/ProteinMotifRBM">https://github.com/elifesciences-publications/ProteinMotifRBM</ext-link>). It can be readily used for any protein family. Moreover, all four multiple sequence alignments presented in the text, as well as the code for reproducing each panel are also included. Jupyter notebooks are provided for reproducing most figures of the article.</p><p>The following previously published datasets were used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Merigeau</surname><given-names>K</given-names></name><name><surname>Arnoux</surname><given-names>B</given-names></name><name><surname>Ducruix</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1997">1997</year><data-title>THE 1.2 ANGSTROM STRUCTURE OF KUNITZ TYPE DOMAIN C5</data-title><source>Protein Data Bank</source><pub-id assigning-authority="RCSB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/2KNT">2KNT</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Macias</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2000">2000</year><data-title>PROTOTYPE WW domain</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/1e0m">1E0M</pub-id></element-citation></p><p><element-citation id="dataset3" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Zuiderweg</surname><given-names>ERP</given-names></name><name><surname>Bertelsen</surname><given-names>EB</given-names></name></person-group><year iso-8601-date="2009">2009</year><data-title>NMR-RDC / XRAY structure of E. coli HSP70 (DNAK) chaperone (1-605) complexed with ADP and substrate</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/2KHO">2KHO</pub-id></element-citation></p><p><element-citation id="dataset4" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Qi</surname><given-names>R</given-names></name><name><surname>Sarbeng</surname><given-names>EB</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Le</surname><given-names>KQ</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2013">2013</year><data-title>Allosteric opening of the polypeptide-binding site when an Hsp70 binds ATP</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/4JNE">4JNE</pub-id></element-citation></p><p><element-citation id="dataset5" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Gaboriaud</surname><given-names>C</given-names></name><name><surname>Rossi</surname><given-names>V</given-names></name><name><surname>Bally</surname><given-names>I</given-names></name><name><surname>Arlaud</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2001">2001</year><data-title>CRYSTAL STRUCTURE OF THE CATALYTIC DOMAIN OF HUMAN COMPLEMENT C1S PROTEASE</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/1ELV">1ELV</pub-id></element-citation></p><p><element-citation id="dataset6" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Stamler</surname><given-names>RJ</given-names></name><name><surname>Kappe</surname><given-names>G</given-names></name><name><surname>Boelens</surname><given-names>WC</given-names></name><name><surname>Slingsby</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2005">2005</year><data-title>CRYSTAL STRUCTURE AND ASSEMBLY OF TSP36, A METAZOAN SMALL HEAT SHOCK PROTEIN</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/2BOL">2BOL</pub-id></element-citation></p><p><element-citation id="dataset7" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Camara-Artigas</surname><given-names>A</given-names></name><name><surname>Luque</surname><given-names>I</given-names></name><name><surname>Ruiz-Sanz</surname><given-names>J</given-names></name><name><surname>Mateo</surname><given-names>PL</given-names></name><name><surname>Martin-Garcia</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2007">2007</year><data-title>Yes SH3 domain</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/2HDA">2HDA</pub-id></element-citation></p><p><element-citation id="dataset8" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Jauch</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2008">2008</year><data-title>Crystal Structure of the Nanog Homeodomain</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/2VI6">2VI6</pub-id></element-citation></p><p><element-citation id="dataset9" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Baumann</surname><given-names>H</given-names></name><name><surname>Paulsen</surname><given-names>K</given-names></name><name><surname>Kovacs</surname><given-names>H</given-names></name><name><surname>Berglund</surname><given-names>H</given-names></name><name><surname>Wright</surname><given-names>APH</given-names></name><name><surname>Gustafsson</surname><given-names>J-A</given-names></name><name><surname>Hard</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1994">1994</year><data-title>REFINED SOLUTION STRUCTURE OF THE GLUCOCORTICOID RECEPTOR DNA-BINDING DOMAIN</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/1GDC">1GDC</pub-id></element-citation></p><p><element-citation id="dataset10" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2009">2009</year><data-title>Crystal structure of a complex between the catalytic and regulatory (RI{alpha}) subunits of PKA</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/3FHI">3FHI</pub-id></element-citation></p><p><element-citation id="dataset11" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Hall</surname><given-names>TMT</given-names></name></person-group><year iso-8601-date="2001">2001</year><data-title>CRYSTAL STRUCTURE OF HUD AND AU-RICH ELEMENT OF THE TUMOR NECROSIS FACTOR ALPHA RNA</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/1G2E">1G2E</pub-id></element-citation></p><p><element-citation id="dataset12" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Lange</surname><given-names>G</given-names></name><name><surname>Loenze</surname><given-names>P</given-names></name><name><surname>Liesum</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2004">2004</year><data-title>CRYSTAL STRUCTURE OF SH2 IN COMPLEX WITH RU82209</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/1O47">1O47</pub-id></element-citation></p><p><element-citation id="dataset13" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>He</surname><given-names>Y-X</given-names></name><name><surname>Zhao</surname><given-names>M-X</given-names></name><name><surname>Zhou</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2008">2008</year><data-title>The crystal structure of Sod2 from Saccharomyces cerevisiae</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/3BFR">3BFR</pub-id></element-citation></p><p><element-citation id="dataset14" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Wilce</surname><given-names>MCJ</given-names></name><name><surname>Wilce</surname><given-names>JA</given-names></name><name><surname>Sidiqu</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><data-title>Crystal Structure of domain 3 of human alpha polyC binding protein</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/1WVN">1WVN</pub-id></element-citation></p><p><element-citation id="dataset15" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Bravo</surname><given-names>J</given-names></name><name><surname>Staunton</surname><given-names>D</given-names></name><name><surname>Heath</surname><given-names>JK</given-names></name><name><surname>Jones</surname><given-names>EY</given-names></name></person-group><year iso-8601-date="1998">1998</year><data-title>CYTOKYNE-BINDING REGION OF GP130</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/1BQU">1BQU</pub-id></element-citation></p><p><element-citation id="dataset16" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Joint</surname><given-names>Center for Structural Genomics</given-names></name></person-group><year iso-8601-date="2002">2002</year><data-title>Crystal structure of Ribonuclease III (TM1102) from Thermotoga maritima at 2.0 A resolution</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/1O0W">1O0W</pub-id></element-citation></p><p><element-citation id="dataset17" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Colby</surname><given-names>TD</given-names></name><name><surname>Bahnson</surname><given-names>BJ</given-names></name><name><surname>Chin</surname><given-names>JK</given-names></name><name><surname>Klinman</surname><given-names>JP</given-names></name><name><surname>Goldstein</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="1998">1998</year><data-title>TERNARY COMPLEX OF AN ACTIVE SITE DOUBLE MUTANT OF HORSE LIVER ALCOHOL DEHYDROGENASE, PHE93=&gt;TRP, VAL203=&gt;ALA WITH NAD AND TRIFLUOROETHANOL</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/1A71">1A71</pub-id></element-citation></p><p><element-citation id="dataset18" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Parisini</surname><given-names>E</given-names></name><name><surname>Wang</surname><given-names>J-H</given-names></name></person-group><year iso-8601-date="2007">2007</year><data-title>Crystal Structure Analysis of human E-cadherin (1-213)</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/2O72">2O72</pub-id></element-citation></p><p><element-citation id="dataset19" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Xiao</surname><given-names>G</given-names></name><name><surname>Ji</surname><given-names>X</given-names></name><name><surname>Armstrong</surname><given-names>RN</given-names></name><name><surname>Gilliland</surname><given-names>GL</given-names></name></person-group><year iso-8601-date="1996">1996</year><data-title>FIRST-SPHERE AND SECOND-SPHERE ELECTROSTATIC EFFECTS IN THE ACTIVE SITE OF A CLASS MU GLUTATHIONE TRANSFERASE</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/6gsu">6GSU</pub-id></element-citation></p><p><element-citation id="dataset20" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Binda</surname><given-names>C</given-names></name><name><surname>Coda</surname><given-names>A</given-names></name><name><surname>Mattevi</surname><given-names>A</given-names></name><name><surname>Aliverti</surname><given-names>A</given-names></name><name><surname>Zanetti</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1998">1998</year><data-title>SPINACH FERREDOXIN</data-title><source>Protein Data Bank</source><pub-id assigning-authority="PDB" pub-id-type="accession" xlink:href="https://www.rcsb.org/structure/1A70">1A70</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ackley</surname> <given-names>DH</given-names></name><name><surname>Hinton</surname> <given-names>GE</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="1987">1987</year><chapter-title>A learning algorithm for boltzmann machines</chapter-title><source>Readings in Computer Vision</source><publisher-name>Elsevier</publisher-name><fpage>522</fpage><lpage>533</lpage></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Appel</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Chymotrypsin: molecular and catalytic properties</article-title><source>Clinical Biochemistry</source><volume>19</volume><fpage>317</fpage><lpage>322</lpage><pub-id pub-id-type="doi">10.1016/S0009-9120(86)80002-9</pub-id><pub-id pub-id-type="pmid">3555886</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ascenzi</surname> <given-names>P</given-names></name><name><surname>Bocedi</surname> <given-names>A</given-names></name><name><surname>Bolognesi</surname> <given-names>M</given-names></name><name><surname>Spallarossa</surname> <given-names>A</given-names></name><name><surname>Coletta</surname> <given-names>M</given-names></name><name><surname>De Cristofaro</surname> <given-names>R</given-names></name><name><surname>Menegatti</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The bovine basic pancreatic trypsin inhibitor (Kunitz inhibitor): a milestone protein</article-title><source>Current Protein &amp; Peptide Science</source><volume>4</volume><fpage>231</fpage><lpage>251</lpage><pub-id pub-id-type="doi">10.2174/1389203033487180</pub-id><pub-id pub-id-type="pmid">12769721</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashkenazy</surname> <given-names>H</given-names></name><name><surname>Abadi</surname> <given-names>S</given-names></name><name><surname>Martz</surname> <given-names>E</given-names></name><name><surname>Chay</surname> <given-names>O</given-names></name><name><surname>Mayrose</surname> <given-names>I</given-names></name><name><surname>Pupko</surname> <given-names>T</given-names></name><name><surname>Ben-Tal</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>ConSurf 2016: an improved methodology to estimate and visualize evolutionary conservation in macromolecules</article-title><source>Nucleic Acids Research</source><volume>44</volume><fpage>W344</fpage><lpage>W350</lpage><pub-id pub-id-type="doi">10.1093/nar/gkw408</pub-id><pub-id pub-id-type="pmid">27166375</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bajaj</surname> <given-names>MS</given-names></name><name><surname>Birktoft</surname> <given-names>JJ</given-names></name><name><surname>Steer</surname> <given-names>SA</given-names></name><name><surname>Bajaj</surname> <given-names>SP</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Structure and biology of tissue factor pathway inhibitor</article-title><source>Thrombosis and Haemostasis</source><volume>86</volume><fpage>959</fpage><lpage>972</lpage><pub-id pub-id-type="doi">10.1055/s-0037-1616518</pub-id><pub-id pub-id-type="pmid">11686353</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balakrishnan</surname> <given-names>S</given-names></name><name><surname>Kamisetty</surname> <given-names>H</given-names></name><name><surname>Carbonell</surname> <given-names>JG</given-names></name><name><surname>Lee</surname> <given-names>SI</given-names></name><name><surname>Langmead</surname> <given-names>CJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Learning generative models for protein fold families</article-title><source>Proteins: Structure, Function, and Bioinformatics</source><volume>79</volume><fpage>1061</fpage><lpage>1078</lpage><pub-id pub-id-type="doi">10.1002/prot.22934</pub-id><pub-id pub-id-type="pmid">21268112</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bertelsen</surname> <given-names>EB</given-names></name><name><surname>Chang</surname> <given-names>L</given-names></name><name><surname>Gestwicki</surname> <given-names>JE</given-names></name><name><surname>Zuiderweg</surname> <given-names>ER</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Solution conformation of wild-type E. coli Hsp70 (DnaK) chaperone complexed with ADP and substrate</article-title><source>PNAS</source><volume>106</volume><fpage>8471</fpage><lpage>8476</lpage><pub-id pub-id-type="doi">10.1073/pnas.0903503106</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brehmer</surname> <given-names>D</given-names></name><name><surname>Rüdiger</surname> <given-names>S</given-names></name><name><surname>Gässler</surname> <given-names>CS</given-names></name><name><surname>Klostermeier</surname> <given-names>D</given-names></name><name><surname>Packschies</surname> <given-names>L</given-names></name><name><surname>Reinstein</surname> <given-names>J</given-names></name><name><surname>Mayer</surname> <given-names>MP</given-names></name><name><surname>Bukau</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Tuning of chaperone activity of Hsp70 proteins by modulation of nucleotide exchange</article-title><source>Nature Structural Biology</source><volume>8</volume><fpage>427</fpage><lpage>432</lpage><pub-id pub-id-type="doi">10.1038/87588</pub-id><pub-id pub-id-type="pmid">11323718</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Briknarová</surname> <given-names>K</given-names></name><name><surname>Takayama</surname> <given-names>S</given-names></name><name><surname>Brive</surname> <given-names>L</given-names></name><name><surname>Havert</surname> <given-names>ML</given-names></name><name><surname>Knee</surname> <given-names>DA</given-names></name><name><surname>Velasco</surname> <given-names>J</given-names></name><name><surname>Homma</surname> <given-names>S</given-names></name><name><surname>Cabezas</surname> <given-names>E</given-names></name><name><surname>Stuart</surname> <given-names>J</given-names></name><name><surname>Hoyt</surname> <given-names>DW</given-names></name><name><surname>Satterthwait</surname> <given-names>AC</given-names></name><name><surname>Llinás</surname> <given-names>M</given-names></name><name><surname>Reed</surname> <given-names>JC</given-names></name><name><surname>Ely</surname> <given-names>KR</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Structural analysis of BAG1 cochaperone and its interactions with Hsc70 heat shock protein</article-title><source>Nature Structural Biology</source><volume>8</volume><fpage>349</fpage><lpage>352</lpage><pub-id pub-id-type="doi">10.1038/86236</pub-id><pub-id pub-id-type="pmid">11276257</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buchberger</surname> <given-names>A</given-names></name><name><surname>Schröder</surname> <given-names>H</given-names></name><name><surname>Büttner</surname> <given-names>M</given-names></name><name><surname>Valencia</surname> <given-names>A</given-names></name><name><surname>Bukau</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>A conserved loop in the ATPase domain of the DnaK chaperone is essential for stable binding of GrpE</article-title><source>Nature Structural &amp; Molecular Biology</source><volume>1</volume><fpage>95</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1038/nsb0294-95</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bukau</surname> <given-names>B</given-names></name><name><surname>Horwich</surname> <given-names>AL</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>The Hsp70 and Hsp60 chaperone machines</article-title><source>Cell</source><volume>92</volume><fpage>351</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1016/S0092-8674(00)80928-9</pub-id><pub-id pub-id-type="pmid">9476895</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chand</surname> <given-names>HS</given-names></name><name><surname>Schmidt</surname> <given-names>AE</given-names></name><name><surname>Bajaj</surname> <given-names>SP</given-names></name><name><surname>Kisiel</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Structure-function analysis of the reactive site in the first Kunitz-type domain of human tissue factor pathway inhibitor-2</article-title><source>Journal of Biological Chemistry</source><volume>279</volume><fpage>17500</fpage><lpage>17507</lpage><pub-id pub-id-type="doi">10.1074/jbc.M400802200</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>M</given-names></name><name><surname>Keene</surname> <given-names>DR</given-names></name><name><surname>Costa</surname> <given-names>FK</given-names></name><name><surname>Tahk</surname> <given-names>SH</given-names></name><name><surname>Woodley</surname> <given-names>DT</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>The carboxyl terminus of type VII collagen mediates antiparallel dimer formation and constitutes a new antigenic epitope for epidermolysis bullosa acquisita autoantibodies</article-title><source>Journal of Biological Chemistry</source><volume>276</volume><fpage>21649</fpage><lpage>21655</lpage><pub-id pub-id-type="doi">10.1074/jbc.M100180200</pub-id><pub-id pub-id-type="pmid">11274208</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cocco</surname> <given-names>S</given-names></name><name><surname>Monasson</surname> <given-names>R</given-names></name><name><surname>Weigt</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>From principal component to direct coupling analysis of coevolution in proteins: low-eigenvalue modes are needed for structure prediction</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003176</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003176</pub-id><pub-id pub-id-type="pmid">23990764</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cocco</surname> <given-names>S</given-names></name><name><surname>Feinauer</surname> <given-names>C</given-names></name><name><surname>Figliuzzi</surname> <given-names>M</given-names></name><name><surname>Monasson</surname> <given-names>R</given-names></name><name><surname>Weigt</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Inverse statistical physics of protein sequences: a key issues review</article-title><source>Reports on Progress in Physics</source><volume>81</volume><fpage>032601</fpage><pub-id pub-id-type="doi">10.1088/1361-6633/aa9965</pub-id><pub-id pub-id-type="pmid">29120346</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Juan</surname> <given-names>D</given-names></name><name><surname>Pazos</surname> <given-names>F</given-names></name><name><surname>Valencia</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Emerging methods in protein co-evolution</article-title><source>Nature Reviews Genetics</source><volume>14</volume><fpage>249</fpage><lpage>261</lpage><pub-id pub-id-type="doi">10.1038/nrg3414</pub-id><pub-id pub-id-type="pmid">23458856</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eddy</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Accelerated profile HMM searches</article-title><source>PLOS Computational Biology</source><volume>7</volume><elocation-id>e1002195</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002195</pub-id><pub-id pub-id-type="pmid">22039361</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ekeberg</surname> <given-names>M</given-names></name><name><surname>Hartonen</surname> <given-names>T</given-names></name><name><surname>Aurell</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Fast pseudolikelihood maximization for direct-coupling analysis of protein structure from many homologous amino-acid sequences</article-title><source>Journal of Computational Physics</source><volume>276</volume><fpage>341</fpage><lpage>356</lpage><pub-id pub-id-type="doi">10.1016/j.jcp.2014.07.024</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Espanel</surname> <given-names>X</given-names></name><name><surname>Sudol</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>A single point mutation in a group I WW domain shifts its specificity to that of group II WW domains</article-title><source>Journal of Biological Chemistry</source><volume>274</volume><fpage>17284</fpage><lpage>17289</lpage><pub-id pub-id-type="doi">10.1074/jbc.274.24.17284</pub-id><pub-id pub-id-type="pmid">10358088</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feinauer</surname> <given-names>C</given-names></name><name><surname>Skwark</surname> <given-names>MJ</given-names></name><name><surname>Pagnani</surname> <given-names>A</given-names></name><name><surname>Aurell</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Improving contact prediction along three dimensions</article-title><source>PLOS Computational Biology</source><volume>10</volume><elocation-id>e1003847</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003847</pub-id><pub-id pub-id-type="pmid">25299132</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Figliuzzi</surname> <given-names>M</given-names></name><name><surname>Jacquier</surname> <given-names>H</given-names></name><name><surname>Schug</surname> <given-names>A</given-names></name><name><surname>Tenaillon</surname> <given-names>O</given-names></name><name><surname>Weigt</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Coevolutionary landscape inference and the Context-Dependence of mutations in Beta-Lactamase TEM-1</article-title><source>Molecular Biology and Evolution</source><volume>33</volume><fpage>268</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1093/molbev/msv211</pub-id><pub-id pub-id-type="pmid">26446903</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finn</surname> <given-names>RD</given-names></name><name><surname>Bateman</surname> <given-names>A</given-names></name><name><surname>Clements</surname> <given-names>J</given-names></name><name><surname>Coggill</surname> <given-names>P</given-names></name><name><surname>Eberhardt</surname> <given-names>RY</given-names></name><name><surname>Eddy</surname> <given-names>SR</given-names></name><name><surname>Heger</surname> <given-names>A</given-names></name><name><surname>Hetherington</surname> <given-names>K</given-names></name><name><surname>Holm</surname> <given-names>L</given-names></name><name><surname>Mistry</surname> <given-names>J</given-names></name><name><surname>Sonnhammer</surname> <given-names>EL</given-names></name><name><surname>Tate</surname> <given-names>J</given-names></name><name><surname>Punta</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Pfam: the protein families database</article-title><source>Nucleic Acids Research</source><volume>42</volume><fpage>D222</fpage><lpage>D230</lpage><pub-id pub-id-type="doi">10.1093/nar/gkt1223</pub-id><pub-id pub-id-type="pmid">24288371</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fischer</surname> <given-names>A</given-names></name><name><surname>Igel</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><chapter-title>An introduction to restricted boltzmann machines</chapter-title><source>Iberoamerican Congress on Pattern Recognition</source><publisher-name>Springer</publisher-name><fpage>14</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1007/978-3-642-33275-3_2</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fowler</surname> <given-names>DM</given-names></name><name><surname>Araya</surname> <given-names>CL</given-names></name><name><surname>Fleishman</surname> <given-names>SJ</given-names></name><name><surname>Kellogg</surname> <given-names>EH</given-names></name><name><surname>Stephany</surname> <given-names>JJ</given-names></name><name><surname>Baker</surname> <given-names>D</given-names></name><name><surname>Fields</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>High-resolution mapping of protein sequence-function relationships</article-title><source>Nature Methods</source><volume>7</volume><fpage>741</fpage><lpage>746</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1492</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fries</surname> <given-names>E</given-names></name><name><surname>Blom</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Bikunin--not just a plasma proteinase inhibitor</article-title><source>The International Journal of Biochemistry &amp; Cell Biology</source><volume>32</volume><fpage>125</fpage><lpage>137</lpage><pub-id pub-id-type="doi">10.1016/S1357-2725(99)00125-9</pub-id><pub-id pub-id-type="pmid">10687949</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Goodfellow</surname> <given-names>I</given-names></name><name><surname>Pouget-Abadie</surname> <given-names>J</given-names></name><name><surname>Mirza</surname> <given-names>M</given-names></name><name><surname>Xu</surname> <given-names>B</given-names></name><name><surname>Warde-Farley</surname> <given-names>D</given-names></name><name><surname>Ozair</surname> <given-names>S</given-names></name><name><surname>Courville</surname> <given-names>A</given-names></name><name><surname>Bengio</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014</year><chapter-title>Generative adversarial nets</chapter-title><source>Advances in Neural Information Processing Systems</source><publisher-name>MIT Press</publisher-name><fpage>2672</fpage><lpage>2680</lpage></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grzesiak</surname> <given-names>A</given-names></name><name><surname>Krokoszynska</surname> <given-names>I</given-names></name><name><surname>Krowarsch</surname> <given-names>D</given-names></name><name><surname>Buczek</surname> <given-names>O</given-names></name><name><surname>Dadlez</surname> <given-names>M</given-names></name><name><surname>Otlewski</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Inhibition of six serine proteinases of the human coagulation system by mutants of bovine pancreatic trypsin inhibitor</article-title><source>Journal of Biological Chemistry</source><volume>275</volume><fpage>33346</fpage><lpage>33352</lpage><pub-id pub-id-type="doi">10.1074/jbc.M006085200</pub-id><pub-id pub-id-type="pmid">10930417</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Halabi</surname> <given-names>N</given-names></name><name><surname>Rivoire</surname> <given-names>O</given-names></name><name><surname>Leibler</surname> <given-names>S</given-names></name><name><surname>Ranganathan</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Protein sectors: evolutionary units of three-dimensional structure</article-title><source>Cell</source><volume>138</volume><fpage>774</fpage><lpage>786</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2009.07.038</pub-id><pub-id pub-id-type="pmid">19703402</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haldane</surname> <given-names>A</given-names></name><name><surname>Flynn</surname> <given-names>WF</given-names></name><name><surname>He</surname> <given-names>P</given-names></name><name><surname>Levy</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Coevolutionary landscape of kinase family proteins: sequence probabilities and functional motifs</article-title><source>Biophysical Journal</source><volume>114</volume><fpage>21</fpage><lpage>31</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2017.10.028</pub-id><pub-id pub-id-type="pmid">29320688</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hinton</surname> <given-names>GE</given-names></name></person-group><year iso-8601-date="2012">2012</year><chapter-title>A practical guide to training restricted boltzmann machines</chapter-title><source>Neural Networks: Tricks of the Trade</source><publisher-name>Springer</publisher-name><fpage>599</fpage><lpage>619</lpage><pub-id pub-id-type="doi">10.1007/978-3-642-35289-8_32</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hopf</surname> <given-names>TA</given-names></name><name><surname>Colwell</surname> <given-names>LJ</given-names></name><name><surname>Sheridan</surname> <given-names>R</given-names></name><name><surname>Rost</surname> <given-names>B</given-names></name><name><surname>Sander</surname> <given-names>C</given-names></name><name><surname>Marks</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Three-dimensional structures of membrane proteins from genomic sequencing</article-title><source>Cell</source><volume>149</volume><fpage>1607</fpage><lpage>1621</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2012.04.012</pub-id><pub-id pub-id-type="pmid">22579045</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hopf</surname> <given-names>TA</given-names></name><name><surname>Ingraham</surname> <given-names>JB</given-names></name><name><surname>Poelwijk</surname> <given-names>FJ</given-names></name><name><surname>Schärfe</surname> <given-names>CP</given-names></name><name><surname>Springer</surname> <given-names>M</given-names></name><name><surname>Sander</surname> <given-names>C</given-names></name><name><surname>Marks</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Mutation effects predicted from sequence co-variation</article-title><source>Nature Biotechnology</source><volume>35</volume><fpage>128</fpage><lpage>135</lpage><pub-id pub-id-type="doi">10.1038/nbt.3769</pub-id><pub-id pub-id-type="pmid">28092658</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Humphrey</surname> <given-names>W</given-names></name><name><surname>Dalke</surname> <given-names>A</given-names></name><name><surname>Schulten</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>VMD: visual molecular dynamics</article-title><source>Journal of Molecular Graphics</source><volume>14</volume><fpage>33</fpage><lpage>38</lpage><pub-id pub-id-type="doi">10.1016/0263-7855(96)00018-5</pub-id><pub-id pub-id-type="pmid">8744570</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacquin</surname> <given-names>H</given-names></name><name><surname>Gilson</surname> <given-names>A</given-names></name><name><surname>Shakhnovich</surname> <given-names>E</given-names></name><name><surname>Cocco</surname> <given-names>S</given-names></name><name><surname>Monasson</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Benchmarking inverse statistical approaches for protein structure and design with exactly solvable models</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1004889</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004889</pub-id><pub-id pub-id-type="pmid">27177270</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jäger</surname> <given-names>M</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Bieschke</surname> <given-names>J</given-names></name><name><surname>Nguyen</surname> <given-names>H</given-names></name><name><surname>Dendle</surname> <given-names>M</given-names></name><name><surname>Bowman</surname> <given-names>ME</given-names></name><name><surname>Noel</surname> <given-names>JP</given-names></name><name><surname>Gruebele</surname> <given-names>M</given-names></name><name><surname>Kelly</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Structure-function-folding relationship in a WW domain</article-title><source>PNAS</source><volume>103</volume><fpage>10648</fpage><lpage>10653</lpage><pub-id pub-id-type="doi">10.1073/pnas.0600511103</pub-id><pub-id pub-id-type="pmid">16807295</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>DT</given-names></name><name><surname>Buchan</surname> <given-names>DW</given-names></name><name><surname>Cozzetto</surname> <given-names>D</given-names></name><name><surname>Pontil</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>PSICOV: precise structural contact prediction using sparse inverse covariance estimation on large multiple sequence alignments</article-title><source>Bioinformatics</source><volume>28</volume><fpage>184</fpage><lpage>190</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr638</pub-id><pub-id pub-id-type="pmid">22101153</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kamisetty</surname> <given-names>H</given-names></name><name><surname>Ovchinnikov</surname> <given-names>S</given-names></name><name><surname>Baker</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Assessing the utility of coevolution-based residue-residue contact predictions in a sequence- and structure-rich era</article-title><source>PNAS</source><volume>110</volume><fpage>15674</fpage><lpage>15679</lpage><pub-id pub-id-type="doi">10.1073/pnas.1314045110</pub-id><pub-id pub-id-type="pmid">24009338</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kato</surname> <given-names>Y</given-names></name><name><surname>Ito</surname> <given-names>M</given-names></name><name><surname>Kawai</surname> <given-names>K</given-names></name><name><surname>Nagata</surname> <given-names>K</given-names></name><name><surname>Tanokura</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Determinants of ligand specificity in groups I and IV WW domains as studied by surface plasmon resonance and model building</article-title><source>Journal of Biological Chemistry</source><volume>277</volume><fpage>10173</fpage><lpage>10177</lpage><pub-id pub-id-type="doi">10.1074/jbc.M110490200</pub-id><pub-id pub-id-type="pmid">11751914</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khersonsky</surname> <given-names>O</given-names></name><name><surname>Fleishman</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Why reinvent the wheel? building new proteins based on ready-made parts</article-title><source>Protein Science</source><volume>25</volume><fpage>1179</fpage><lpage>1187</lpage><pub-id pub-id-type="doi">10.1002/pro.2892</pub-id><pub-id pub-id-type="pmid">26821641</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Kingma</surname> <given-names>DP</given-names></name><name><surname>Welling</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Auto-encoding variational bayes</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1312.6114">https://arxiv.org/abs/1312.6114</ext-link></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kirchhofer</surname> <given-names>D</given-names></name><name><surname>Peek</surname> <given-names>M</given-names></name><name><surname>Li</surname> <given-names>W</given-names></name><name><surname>Stamos</surname> <given-names>J</given-names></name><name><surname>Eigenbrot</surname> <given-names>C</given-names></name><name><surname>Kadkhodayan</surname> <given-names>S</given-names></name><name><surname>Elliott</surname> <given-names>JM</given-names></name><name><surname>Corpuz</surname> <given-names>RT</given-names></name><name><surname>Lazarus</surname> <given-names>RA</given-names></name><name><surname>Moran</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Tissue expression, protease specificity, and Kunitz domain functions of hepatocyte growth factor activator inhibitor-1B (HAI-1B), a new splice variant of HAI-1</article-title><source>Journal of Biological Chemistry</source><volume>278</volume><fpage>36341</fpage><lpage>36349</lpage><pub-id pub-id-type="doi">10.1074/jbc.M304643200</pub-id><pub-id pub-id-type="pmid">12815039</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kohfeldt</surname> <given-names>E</given-names></name><name><surname>Göhring</surname> <given-names>W</given-names></name><name><surname>Mayer</surname> <given-names>U</given-names></name><name><surname>Zweckstetter</surname> <given-names>M</given-names></name><name><surname>Holak</surname> <given-names>TA</given-names></name><name><surname>Chu</surname> <given-names>ML</given-names></name><name><surname>Timpl</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Conversion of the Kunitz-type module of collagen VI into a highly active trypsin inhibitor by site-directed mutagenesis</article-title><source>European Journal of Biochemistry</source><volume>238</volume><fpage>333</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1111/j.1432-1033.1996.0333z.x</pub-id><pub-id pub-id-type="pmid">8681942</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lapedes</surname> <given-names>AS</given-names></name><name><surname>Giraud</surname> <given-names>BG</given-names></name><name><surname>Liu</surname> <given-names>L</given-names></name><name><surname>Stormo</surname> <given-names>GD</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Correlated mutations in models of protein sequences: phylogenetic and structural effects</article-title><source>Lecture Notes-Monograph Series,</source><volume>33</volume><fpage>236</fpage><lpage>256</lpage><pub-id pub-id-type="doi">10.1214/lnms/1215455556</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Roux</surname> <given-names>N</given-names></name><name><surname>Bengio</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Representational power of restricted boltzmann machines and deep belief networks</article-title><source>Neural Computation</source><volume>20</volume><fpage>1631</fpage><lpage>1649</lpage><pub-id pub-id-type="doi">10.1162/neco.2008.04-07-510</pub-id><pub-id pub-id-type="pmid">18254699</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levitt</surname> <given-names>M</given-names></name><name><surname>Warshel</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Computer simulation of protein folding</article-title><source>Nature</source><volume>253</volume><fpage>694</fpage><lpage>698</lpage><pub-id pub-id-type="doi">10.1038/253694a0</pub-id><pub-id pub-id-type="pmid">1167625</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macias</surname> <given-names>MJ</given-names></name><name><surname>Gervais</surname> <given-names>V</given-names></name><name><surname>Civera</surname> <given-names>C</given-names></name><name><surname>Oschkinat</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Structural analysis of WW domains and design of a WW prototype</article-title><source>Nature Structural Biology</source><volume>7</volume><fpage>375</fpage><lpage>379</lpage><pub-id pub-id-type="doi">10.1038/75144</pub-id><pub-id pub-id-type="pmid">10802733</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malinverni</surname> <given-names>D</given-names></name><name><surname>Marsili</surname> <given-names>S</given-names></name><name><surname>Barducci</surname> <given-names>A</given-names></name><name><surname>De Los Rios</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Large-Scale conformational transitions and dimerization are encoded in the Amino-Acid sequences of Hsp70 chaperones</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004262</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004262</pub-id><pub-id pub-id-type="pmid">26046683</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mann</surname> <given-names>JK</given-names></name><name><surname>Barton</surname> <given-names>JP</given-names></name><name><surname>Ferguson</surname> <given-names>AL</given-names></name><name><surname>Omarjee</surname> <given-names>S</given-names></name><name><surname>Walker</surname> <given-names>BD</given-names></name><name><surname>Chakraborty</surname> <given-names>A</given-names></name><name><surname>Ndung'u</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The fitness landscape of HIV-1 gag: advanced modeling approaches and validation of model predictions by in vitro testing</article-title><source>PLOS Computational Biology</source><volume>10</volume><elocation-id>e1003776</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003776</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marks</surname> <given-names>DS</given-names></name><name><surname>Colwell</surname> <given-names>LJ</given-names></name><name><surname>Sheridan</surname> <given-names>R</given-names></name><name><surname>Hopf</surname> <given-names>TA</given-names></name><name><surname>Pagnani</surname> <given-names>A</given-names></name><name><surname>Zecchina</surname> <given-names>R</given-names></name><name><surname>Sander</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Protein 3D structure computed from evolutionary sequence variation</article-title><source>PLOS ONE</source><volume>6</volume><elocation-id>e28766</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0028766</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marquart</surname> <given-names>M</given-names></name><name><surname>Walter</surname> <given-names>J</given-names></name><name><surname>Deisenhofer</surname> <given-names>J</given-names></name><name><surname>Bode</surname> <given-names>W</given-names></name><name><surname>Huber</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>The geometry of the reactive site and of the peptide groups in trypsin, trypsinogen and its complexes with inhibitors</article-title><source>Acta Crystallographica Section B Structural Science</source><volume>39</volume><fpage>480</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1107/S010876818300275X</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merigeau</surname> <given-names>K</given-names></name><name><surname>Arnoux</surname> <given-names>B</given-names></name><name><surname>Perahia</surname> <given-names>D</given-names></name><name><surname>Norris</surname> <given-names>K</given-names></name><name><surname>Norris</surname> <given-names>F</given-names></name><name><surname>Ducruix</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>1.2 Å refinement of the Kunitz-type domain from the α3 chain of human type VI collagen</article-title><source>Acta Crystallographica Section D Biological Crystallography</source><volume>54</volume><fpage>306</fpage><lpage>312</lpage><pub-id pub-id-type="doi">10.1107/S0907444997010846</pub-id><pub-id pub-id-type="pmid">9761897</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mihalek</surname> <given-names>I</given-names></name><name><surname>Res</surname> <given-names>I</given-names></name><name><surname>Lichtarge</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>A family of evolution-entropy hybrid methods for ranking protein residues by importance</article-title><source>Journal of Molecular Biology</source><volume>336</volume><fpage>1265</fpage><lpage>1282</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2003.12.078</pub-id><pub-id pub-id-type="pmid">15037084</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirny</surname> <given-names>L</given-names></name><name><surname>Shakhnovich</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Protein folding theory: from lattice to all-atom models</article-title><source>Annual Review of Biophysics and Biomolecular Structure</source><volume>30</volume><fpage>361</fpage><lpage>396</lpage><pub-id pub-id-type="doi">10.1146/annurev.biophys.30.1.361</pub-id><pub-id pub-id-type="pmid">11340064</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miyazawa</surname> <given-names>S</given-names></name><name><surname>Jernigan</surname> <given-names>RL</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Residue-residue potentials with a favorable contact pair term and an unfavorable high packing density term, for simulation and threading</article-title><source>Journal of Molecular Biology</source><volume>256</volume><fpage>623</fpage><lpage>644</lpage><pub-id pub-id-type="doi">10.1006/jmbi.1996.0114</pub-id><pub-id pub-id-type="pmid">8604144</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morcos</surname> <given-names>F</given-names></name><name><surname>Pagnani</surname> <given-names>A</given-names></name><name><surname>Lunt</surname> <given-names>B</given-names></name><name><surname>Bertolino</surname> <given-names>A</given-names></name><name><surname>Marks</surname> <given-names>DS</given-names></name><name><surname>Sander</surname> <given-names>C</given-names></name><name><surname>Zecchina</surname> <given-names>R</given-names></name><name><surname>Onuchic</surname> <given-names>JN</given-names></name><name><surname>Hwa</surname> <given-names>T</given-names></name><name><surname>Weigt</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title><source>PNAS</source><volume>108</volume><fpage>E1293</fpage><lpage>E1301</lpage><pub-id pub-id-type="doi">10.1073/pnas.1111471108</pub-id><pub-id pub-id-type="pmid">22106262</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Nair</surname> <given-names>V</given-names></name><name><surname>Hinton</surname> <given-names>GE</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Rectified linear units improve restricted boltzmann machines</article-title><conf-name>Proceedings of the 27th international conference on machine learning (ICML-10)</conf-name><fpage>807</fpage><lpage>814</lpage></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neal</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Annealed importance sampling</article-title><source>Statistics and Computing</source><volume>11</volume><fpage>125</fpage><lpage>139</lpage><pub-id pub-id-type="doi">10.1023/A:1008923215028</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oldfield</surname> <given-names>CJ</given-names></name><name><surname>Dunker</surname> <given-names>AK</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Intrinsically disordered proteins and intrinsically disordered protein regions</article-title><source>Annual Review of Biochemistry</source><volume>83</volume><fpage>553</fpage><lpage>584</lpage><pub-id pub-id-type="doi">10.1146/annurev-biochem-072711-164947</pub-id><pub-id pub-id-type="pmid">24606139</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otte</surname> <given-names>L</given-names></name><name><surname>Wiedemann</surname> <given-names>U</given-names></name><name><surname>Schlegel</surname> <given-names>B</given-names></name><name><surname>Pires</surname> <given-names>JR</given-names></name><name><surname>Beyermann</surname> <given-names>M</given-names></name><name><surname>Schmieder</surname> <given-names>P</given-names></name><name><surname>Krause</surname> <given-names>G</given-names></name><name><surname>Volkmer-Engert</surname> <given-names>R</given-names></name><name><surname>Schneider-Mergener</surname> <given-names>J</given-names></name><name><surname>Oschkinat</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>WW domain sequence activity relationships identified using ligand recognition propensities of 42 WW domains</article-title><source>Protein Science</source><volume>12</volume><fpage>491</fpage><lpage>500</lpage><pub-id pub-id-type="doi">10.1110/ps.0233203</pub-id><pub-id pub-id-type="pmid">12592019</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qi</surname> <given-names>R</given-names></name><name><surname>Sarbeng</surname> <given-names>EB</given-names></name><name><surname>Liu</surname> <given-names>Q</given-names></name><name><surname>Le</surname> <given-names>KQ</given-names></name><name><surname>Xu</surname> <given-names>X</given-names></name><name><surname>Xu</surname> <given-names>H</given-names></name><name><surname>Yang</surname> <given-names>J</given-names></name><name><surname>Wong</surname> <given-names>JL</given-names></name><name><surname>Vorvis</surname> <given-names>C</given-names></name><name><surname>Hendrickson</surname> <given-names>WA</given-names></name><name><surname>Zhou</surname> <given-names>L</given-names></name><name><surname>Liu</surname> <given-names>Q</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Allosteric opening of the polypeptide-binding site when an Hsp70 binds ATP</article-title><source>Nature Structural &amp; Molecular Biology</source><volume>20</volume><fpage>900</fpage><lpage>907</lpage><pub-id pub-id-type="doi">10.1038/nsmb.2583</pub-id><pub-id pub-id-type="pmid">23708608</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rausell</surname> <given-names>A</given-names></name><name><surname>Juan</surname> <given-names>D</given-names></name><name><surname>Pazos</surname> <given-names>F</given-names></name><name><surname>Valencia</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Protein interactions and ligand binding: from protein subfamilies to functional specificity</article-title><source>PNAS</source><volume>107</volume><fpage>1995</fpage><lpage>2000</lpage><pub-id pub-id-type="doi">10.1073/pnas.0908044107</pub-id><pub-id pub-id-type="pmid">20133844</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reva</surname> <given-names>B</given-names></name><name><surname>Antipin</surname> <given-names>Y</given-names></name><name><surname>Sander</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Determinants of protein function revealed by combinatorial entropy optimization</article-title><source>Genome Biology</source><volume>8</volume><elocation-id>R232</elocation-id><pub-id pub-id-type="doi">10.1186/gb-2007-8-11-r232</pub-id><pub-id pub-id-type="pmid">17976239</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reva</surname> <given-names>B</given-names></name><name><surname>Antipin</surname> <given-names>Y</given-names></name><name><surname>Sander</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Predicting the functional impact of protein mutations: application to cancer genomics</article-title><source>Nucleic Acids Research</source><volume>39</volume><elocation-id>e118</elocation-id><pub-id pub-id-type="doi">10.1093/nar/gkr407</pub-id><pub-id pub-id-type="pmid">21727090</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riesselman</surname> <given-names>AJ</given-names></name><name><surname>Ingraham</surname> <given-names>JB</given-names></name><name><surname>Marks</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Deep generative models of genetic variation capture the effects of mutations</article-title><source>Nature Methods</source><volume>15</volume><fpage>816</fpage><lpage>822</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0138-4</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rojas</surname> <given-names>AM</given-names></name><name><surname>Fuentes</surname> <given-names>G</given-names></name><name><surname>Rausell</surname> <given-names>A</given-names></name><name><surname>Valencia</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The ras protein superfamily: evolutionary tree and role of conserved amino acids</article-title><source>The Journal of Cell Biology</source><volume>196</volume><fpage>189</fpage><lpage>201</lpage><pub-id pub-id-type="doi">10.1083/jcb.201103008</pub-id><pub-id pub-id-type="pmid">22270915</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Russ</surname> <given-names>WP</given-names></name><name><surname>Lowery</surname> <given-names>DM</given-names></name><name><surname>Mishra</surname> <given-names>P</given-names></name><name><surname>Yaffe</surname> <given-names>MB</given-names></name><name><surname>Ranganathan</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Natural-like function in artificial WW domains</article-title><source>Nature</source><volume>437</volume><fpage>579</fpage><lpage>583</lpage><pub-id pub-id-type="doi">10.1038/nature03990</pub-id><pub-id pub-id-type="pmid">16177795</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Salakhutdinov</surname> <given-names>R</given-names></name><name><surname>Murray</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>On the quantitative analysis of deep belief networks</article-title><conf-name>Proceedings of the 25th International Conference on Machine Learning</conf-name><fpage>872</fpage><lpage>879</lpage><pub-id pub-id-type="doi">10.1145/1390156.1390266</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheufler</surname> <given-names>C</given-names></name><name><surname>Brinker</surname> <given-names>A</given-names></name><name><surname>Bourenkov</surname> <given-names>G</given-names></name><name><surname>Pegoraro</surname> <given-names>S</given-names></name><name><surname>Moroder</surname> <given-names>L</given-names></name><name><surname>Bartunik</surname> <given-names>H</given-names></name><name><surname>Hartl</surname> <given-names>FU</given-names></name><name><surname>Moarefi</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Structure of tpr domain–peptide complexes: critical elements in the assembly of the hsp70–hsp90 multichaperone machine</article-title><source>Cell</source><volume>101</volume><pub-id pub-id-type="doi">10.1016/S0092-8674(00)80830-2</pub-id><pub-id pub-id-type="pmid">10786835</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shakhnovich</surname> <given-names>E</given-names></name><name><surname>Gutin</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Enumeration of all compact conformations of copolymers with random sequence of links</article-title><source>The Journal of Chemical Physics</source><volume>93</volume><fpage>5967</fpage><lpage>5971</lpage><pub-id pub-id-type="doi">10.1063/1.459480</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shigetomi</surname> <given-names>H</given-names></name><name><surname>Onogi</surname> <given-names>A</given-names></name><name><surname>Kajiwara</surname> <given-names>H</given-names></name><name><surname>Yoshida</surname> <given-names>S</given-names></name><name><surname>Furukawa</surname> <given-names>N</given-names></name><name><surname>Haruta</surname> <given-names>S</given-names></name><name><surname>Tanase</surname> <given-names>Y</given-names></name><name><surname>Kanayama</surname> <given-names>S</given-names></name><name><surname>Noguchi</surname> <given-names>T</given-names></name><name><surname>Yamada</surname> <given-names>Y</given-names></name><name><surname>Oi</surname> <given-names>H</given-names></name><name><surname>Kobayashi</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Anti-inflammatory actions of serine protease inhibitors containing the Kunitz domain</article-title><source>Inflammation Research</source><volume>59</volume><fpage>679</fpage><lpage>687</lpage><pub-id pub-id-type="doi">10.1007/s00011-010-0205-5</pub-id><pub-id pub-id-type="pmid">20454830</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simons</surname> <given-names>KT</given-names></name><name><surname>Kooperberg</surname> <given-names>C</given-names></name><name><surname>Huang</surname> <given-names>E</given-names></name><name><surname>Baker</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Assembly of protein tertiary structures from fragments with similar local sequences using simulated annealing and bayesian scoring functions</article-title><source>Journal of Molecular Biology</source><volume>268</volume><fpage>209</fpage><lpage>225</lpage><pub-id pub-id-type="doi">10.1006/jmbi.1997.0959</pub-id><pub-id pub-id-type="pmid">9149153</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Sinai</surname> <given-names>S</given-names></name><name><surname>Kelsic</surname> <given-names>E</given-names></name><name><surname>Church</surname> <given-names>GM</given-names></name><name><surname>Novak</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Variational auto-encoding of protein sequences</article-title><source>Arxiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1712.03346">https://arxiv.org/abs/1712.03346</ext-link></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smock</surname> <given-names>RG</given-names></name><name><surname>Rivoire</surname> <given-names>O</given-names></name><name><surname>Russ</surname> <given-names>WP</given-names></name><name><surname>Swain</surname> <given-names>JF</given-names></name><name><surname>Leibler</surname> <given-names>S</given-names></name><name><surname>Ranganathan</surname> <given-names>R</given-names></name><name><surname>Gierasch</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>An interdomain sector mediating allostery in Hsp70 molecular chaperones</article-title><source>Molecular Systems Biology</source><volume>6</volume><pub-id pub-id-type="doi">10.1038/msb.2010.65</pub-id><pub-id pub-id-type="pmid">20865007</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sondermann</surname> <given-names>H</given-names></name><name><surname>Scheufler</surname> <given-names>C</given-names></name><name><surname>Schneider</surname> <given-names>C</given-names></name><name><surname>Hohfeld</surname> <given-names>J</given-names></name><name><surname>Hartl</surname> <given-names>FU</given-names></name><name><surname>Moarefi</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Structure of a bag/Hsc70 complex: convergent functional evolution of Hsp70 nucleotide exchange factors</article-title><source>Science</source><volume>291</volume><fpage>1553</fpage><lpage>1557</lpage><pub-id pub-id-type="doi">10.1126/science.1057268</pub-id><pub-id pub-id-type="pmid">11222862</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stemmer</surname> <given-names>WP</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Rapid evolution of a protein in vitro by DNA shuffling</article-title><source>Nature</source><volume>370</volume><fpage>389</fpage><lpage>391</lpage><pub-id pub-id-type="doi">10.1038/370389a0</pub-id><pub-id pub-id-type="pmid">8047147</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sudol</surname> <given-names>M</given-names></name><name><surname>Chen</surname> <given-names>HI</given-names></name><name><surname>Bougeret</surname> <given-names>C</given-names></name><name><surname>Einbond</surname> <given-names>A</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Characterization of a novel protein-binding module--the WW domain</article-title><source>FEBS Letters</source><volume>369</volume><fpage>67</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1016/0014-5793(95)00550-S</pub-id><pub-id pub-id-type="pmid">7641887</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sudol</surname> <given-names>M</given-names></name><name><surname>Hunter</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>NeW wrinkles for an old domain</article-title><source>Cell</source><volume>103</volume><fpage>1001</fpage><lpage>1004</lpage><pub-id pub-id-type="doi">10.1016/S0092-8674(00)00203-8</pub-id><pub-id pub-id-type="pmid">11163176</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sutto</surname> <given-names>L</given-names></name><name><surname>Marsili</surname> <given-names>S</given-names></name><name><surname>Valencia</surname> <given-names>A</given-names></name><name><surname>Gervasio</surname> <given-names>FL</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>From residue coevolution to protein conformational ensembles and functional dynamics</article-title><source>PNAS</source><volume>112</volume><fpage>13567</fpage><lpage>13572</lpage><pub-id pub-id-type="doi">10.1073/pnas.1508584112</pub-id><pub-id pub-id-type="pmid">26487681</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teppa</surname> <given-names>E</given-names></name><name><surname>Wilkins</surname> <given-names>AD</given-names></name><name><surname>Nielsen</surname> <given-names>M</given-names></name><name><surname>Buslje</surname> <given-names>CM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Disentangling evolutionary signals: conservation, specificity determining positions and coevolution. Implication for catalytic residue prediction</article-title><source>BMC Bioinformatics</source><volume>13</volume><elocation-id>235</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2105-13-235</pub-id><pub-id pub-id-type="pmid">22978315</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Tieleman</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Training restricted boltzmann machines using approximations to the likelihood gradient</article-title><conf-name>Proceedings of the 25th International Conference on Machine Learning</conf-name><fpage>1064</fpage><lpage>1071</lpage><pub-id pub-id-type="doi">10.1145/1390156.1390290</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Tubiana</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Learning Protein Constitutive Motifs from Sequence Data: RBM toolbox</data-title><version designator="cf7a0d4">cf7a0d4</version><publisher-name>GitHub</publisher-name><ext-link ext-link-type="uri" xlink:href="https://github.com/jertubiana/ProteinMotifRBM">https://github.com/jertubiana/ProteinMotifRBM</ext-link></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tubiana</surname> <given-names>J</given-names></name><name><surname>Monasson</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Emergence of compositional representations in restricted boltzmann machines</article-title><source>Physical Review Letters</source><volume>118</volume><pub-id pub-id-type="doi">10.1103/PhysRevLett.118.138301</pub-id><pub-id pub-id-type="pmid">28409983</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weigt</surname> <given-names>M</given-names></name><name><surname>White</surname> <given-names>RA</given-names></name><name><surname>Szurmant</surname> <given-names>H</given-names></name><name><surname>Hoch</surname> <given-names>JA</given-names></name><name><surname>Hwa</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Identification of direct residue contacts in protein-protein interaction by message passing</article-title><source>PNAS</source><volume>106</volume><fpage>67</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1073/pnas.0805923106</pub-id><pub-id pub-id-type="pmid">19116270</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname> <given-names>JC</given-names></name><name><surname>Agashe</surname> <given-names>VR</given-names></name><name><surname>Siegers</surname> <given-names>K</given-names></name><name><surname>Hartl</surname> <given-names>FU</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Pathways of chaperone-mediated protein folding in the cytosol</article-title><source>Nature Reviews Molecular Cell Biology</source><volume>5</volume><fpage>781</fpage><lpage>791</lpage><pub-id pub-id-type="doi">10.1038/nrm1492</pub-id><pub-id pub-id-type="pmid">15459659</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zuiderweg</surname> <given-names>ER</given-names></name><name><surname>Hightower</surname> <given-names>LE</given-names></name><name><surname>Gestwicki</surname> <given-names>JE</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The remarkable multivalency of the Hsp70 chaperones</article-title><source>Cell Stress and Chaperones</source><volume>22</volume><fpage>173</fpage><lpage>189</lpage><pub-id pub-id-type="doi">10.1007/s12192-017-0776-y</pub-id><pub-id pub-id-type="pmid">28220454</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s8" sec-type="appendix"><title>Supporting methods and figures </title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.39397.020</object-id><sec id="s9"><title>Lattice-protein synthetic sequences </title><p>LP models have been introduced in the <inline-formula><mml:math id="inf397"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>′</mml:mo><mml:mn>90</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> to investigate the uniqueness of folding shared by the majority of real proteins <xref ref-type="bibr" rid="bib69">Shakhnovich and Gutin, 1990</xref>, and have been more recently used to benchmark graphical models inferred from sequence data <xref ref-type="bibr" rid="bib34">Jacquin et al., 2016</xref>). There are <inline-formula><mml:math id="inf398"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>103</mml:mn><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>406</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> possible folds, that is self-avoiding paths of the 27 amino-acid-long chains, on <inline-formula><mml:math id="inf399"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>3</mml:mn><mml:mspace width="thinmathspace"/><mml:mo>×</mml:mo><mml:mn>3</mml:mn><mml:mspace width="thinmathspace"/><mml:mo>×</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>3</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> a lattice cube <xref ref-type="bibr" rid="bib69">Shakhnovich and Gutin, 1990</xref>. The probability that the protein sequence <inline-formula><mml:math id="inf400"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mn>27</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> folds in one of these, say, <inline-formula><mml:math id="inf401"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, is<disp-formula id="equ18"><label>(17)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>;</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="script">ℰ</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>;</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="script">ℰ</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>;</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where the energy of sequence <inline-formula><mml:math id="inf402"><mml:mi mathvariant="bold">𝐯</mml:mi></mml:math></inline-formula> in structure <inline-formula><mml:math id="inf403"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is given by <disp-formula id="equ19"><label>(18)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">ℰ</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>;</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="thickmathspace"/><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In the formula above, <inline-formula><mml:math id="inf404"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the contact map: <inline-formula><mml:math id="inf405"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> if the pair of sites <inline-formula><mml:math id="inf406"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is in contact, that is <inline-formula><mml:math id="inf407"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf408"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are nearest neighbors on the lattice, and zero otherwise. The pairwise energy <inline-formula><mml:math id="inf409"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> represents the amino-acid physico-chemical interactions, given by the the Miyazawa-Jernigan (MJ) knowledge-based potential <xref ref-type="bibr" rid="bib54">Miyazawa and Jernigan, 1996</xref>. </p><p>A collection of 36,000 sequences that specifically fold on structure <inline-formula><mml:math id="inf410"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig7">Figure 7A</xref>) with high probability <inline-formula><mml:math id="inf411"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0.995</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> were generated by Monte Carlo simulations as described in <xref ref-type="bibr" rid="bib34">Jacquin et al. (2016)</xref>. Like real MSA, Lattice Protein data feature short- and long-range correlations between amino-acid on different sites, as well as high-order interactions that arise from competition between folds <xref ref-type="bibr" rid="bib34">Jacquin et al., 2016</xref>). </p></sec><sec id="s10"><title>Model selection </title><p>We discuss here the choice of parameters (strength of regularization, number of hidden units, shape of hidden-unit potentials, …) for the RBM used in the main text. Our goal is to achieve good generative performances and to learn biologically interpretable representations. We estimate the accuracy of the fit to the data distribution using the average log-likelihood, divided by the number of visible units <inline-formula><mml:math id="inf412"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. For visible-unit variables with <inline-formula><mml:math id="inf413"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> possible values (i.e. 20 amino acids + gap symbol), this number typically ranges from <inline-formula><mml:math id="inf414"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mn>21</mml:mn><mml:mo>≃</mml:mo><mml:mo>−</mml:mo><mml:mn>3.04</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (uniform distribution) to 0. Evaluating <inline-formula><mml:math id="inf415"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (Methods <xref ref-type="disp-formula" rid="equ1">Equation (1)</xref>) requires knowledge of the partition function, <inline-formula><mml:math id="inf416"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:munder><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (see section titled 'Evaluating the partition function'). </p></sec><sec id="s11"><title>Number of hidden units </title><p>The number of hidden units is critical for the generative performance. We trained RBMs on the Lattice Protein data set for various potentials (Bernoulli, quadratic and dReLU), numbers of hidden units (1–400) and regularizations (<inline-formula><mml:math id="inf417"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf418"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.025</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). The likelihood estimation shows that, as expected, the larger <inline-formula><mml:math id="inf419"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the better the ability to fit the training data (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>). Overfitting resulting in a decrease in test set performance may occur for large <inline-formula><mml:math id="inf420"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. For the regularized case, the likelihood saturates at about 100 hidden units. Similar results were obtained for WW (see <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>).</p><fig id="app1fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.021</object-id><label>Appendix 1—figure 1.</label><caption><title>Model selection for RBM trained on the Lattice Proteins MSA.</title><p>Likelihood estimates for various potentials and number of hidden units, evaluated on train and held-out test sets. Top row: without regularization (<inline-formula><mml:math id="inf421"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). Bottom row: with regularization (<inline-formula><mml:math id="inf422"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.025</mml:mn></mml:mrow></mml:math></inline-formula>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig1-v2.tif"/></fig><fig id="app1fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.022</object-id><label>Appendix 1—figure 2.</label><caption><title>Model selection for RBM trained on the WW domain MSA.</title><p>Likelihood estimates for various potentials and number of hidden units, evaluated on train and held-out test sets. Top row: without regularization (<inline-formula><mml:math id="inf423"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). Bottom row: with regularization (<inline-formula><mml:math id="inf424"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig2-v2.tif"/></fig><p>Besides generative performance, the representation also changes as <italic>M</italic> increases. For very low values of <italic>M</italic>, each hidden unit tries to explain as much covariation as possible and its corresponding weight vector is extended, as in PCA. For larger numbers of hidden units, weights tend to become more sparse; they stabilize at some point, after which new hidden units simply duplicate previous ones.</p></sec><sec id="s12"><title>Sparse regularization</title><p>We first investigate the importance of the sparsifying penalty term. Our study shows that, unlike in the case of MNIST digit data (<xref ref-type="bibr" rid="bib82">Tubiana and Monasson, 2017</xref>), sparsity does not arise naturally from training RBM on protein sequences but requires the introduction of a specific sparsifying regularization (see <xref ref-type="fig" rid="fig8">Figure 8</xref>). On the one hand, sparse weights, such as those shown in <xref ref-type="fig" rid="fig2">Figures 2</xref>, <xref ref-type="fig" rid="fig3">3</xref>, <xref ref-type="fig" rid="fig4">4</xref> and <xref ref-type="fig" rid="fig7">7</xref>, are easier to interpret, but, on the other hand, regularization generally leads to a decrease in the generative performance. We show below that the choice of regularization strength used in this work is a good compromise between sparsity and generative performance.</p><p>We train several RBM on the Lattice Proteins MSA, with a fixed number of hidden units (<inline-formula><mml:math id="inf425"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>), fixed potential, and varying strength of the sparse penalty <inline-formula><mml:math id="inf426"><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> (defined in 'Materials and methods, <xref ref-type="disp-formula" rid="equ8">Equation (8)</xref>), and evaluate their likelihoods. We repeat the same procedure using the standard <inline-formula><mml:math id="inf427"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> regularization (<inline-formula><mml:math id="inf428"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>) instead of <inline-formula><mml:math id="inf429"><mml:msubsup><mml:mi>L</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>. Results are shown in <xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>. In both cases, the likelihood on the test set decreases mildly with the regularization strength. However, for <inline-formula><mml:math id="inf430"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> regularization, several hidden units become disconnected (<italic>i.e. </italic><inline-formula><mml:math id="inf431"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf432"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math></inline-formula>) as we increase the penalty strength. The <inline-formula><mml:math id="inf433"><mml:msubsup><mml:mi>L</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> penalty achieves sparse weights without disconnecting hidden units when the penalty is too large, hence it is more robust and requires less fine tuning.</p><fig id="app1fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.023</object-id><label>Appendix 1—figure 3.</label><caption><title>Sparsity-generative performance trade-off for RBM trained on the MSA of the Lattice Protein <inline-formula><mml:math id="inf434"><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>.</title><p>(<bold>A–D</bold>) Likelihood as function of regularization strength, for <inline-formula><mml:math id="inf435"><mml:msubsup><mml:mi>L</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> (top) and <inline-formula><mml:math id="inf436"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> (bottom) sparse penalties, on train(left) and test (middle) sets. (<bold>E</bold>) Number <inline-formula><mml:math id="inf437"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of connected hidden units (such that <inline-formula><mml:math id="inf438"><mml:mrow><mml:mrow><mml:msub><mml:mi>max</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) against effective strength penalty, for <inline-formula><mml:math id="inf439"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf440"><mml:msubsup><mml:mi>L</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> penalties. For <inline-formula><mml:math id="inf441"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> penalty, <inline-formula><mml:math id="inf442"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>; for <inline-formula><mml:math id="inf443"><mml:msubsup><mml:mi>L</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="inf444"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig3-v2.tif"/></fig></sec><sec id="s13"><title>Hidden-unit potentials</title><p>Last, we discuss the choice of the hidden-unit potentials. A priori, the major difference between Bernoulli, quadratic and dReLU potentials are that: (i) the Bernoulli hidden unit takes discrete values whereas quadratic and dReLU hidden units take continuous ones; and (ii) after marginalization, quadratic potentials create pairwise effective interactions whereas Bernoulli and dReLU potentials create non-pairwise ones. It was shown in the context of image processing and text mining that non-pairwise models are more efficient in practice, and theoretical arguments also highlight the importance of high-order interactions (<xref ref-type="bibr" rid="bib82">Tubiana and Monasson, 2017</xref>).</p><p>In terms of generative performance, our results on Lattice Proteins and WW domain MSAs show that, for the same number of parameters, dReLU RBM perform better than Gaussian and Bernoulli RBM. Similar results, not shown, were obtained for the Kunitz domain MSA. Although RBM with Bernoulli hidden units are known to be universal approximators as <inline-formula><mml:math id="inf445"><mml:mrow><mml:mi>M</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula> </p><fig id="app1fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.024</object-id><label>Appendix 1—figure 4.</label><caption><title>Hidden layer representation redundancy as a function of the hidden-unit potentials.</title><p>Distribution of Pearson correlation coeffcients between hidden-unit average activities, for RBM trained with <inline-formula><mml:math id="inf446"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>, on (<bold>a</bold>) Lattice Proteins MSA, (<bold>b</bold>) Kunitz domain MSA, and (<bold>c</bold>) WW domain MSA. Bernoulli RBM feature the highest correlations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig4-v2.tif"/></fig><p>One of the key aspects that explains the difference in performance between dReLU and Gaussian RBM is the ability of the former to better model ’outlier’ sequences, with rare extended features such as Bikunin-AMBP (Weight 5 in the main text, <xref ref-type="fig" rid="fig2">Figure 2</xref>) or the non-aromatic W28-substitution feature (Weight 3 in the main text, <xref ref-type="fig" rid="fig3">Figure 3</xref>). Indeed, thanks to the thresholding effect of the average activity, dReLU (unlike quadratic potentials) can account for outliers without altering the distribution for the bulk of the other sequences. To illustrate this property, in <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref>, we compare the likelihoods for all sequences of two RBMs trained with quadratic (resp. dReLU) potentials, <inline-formula><mml:math id="inf447"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf448"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula> on the Kunitz domain MSA. The color coding indicates the degree of anomaly of the sequence, which is obtained as follows:</p><list list-type="order"><list-item><p>Compute the average activity <inline-formula><mml:math id="inf449"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:math></inline-formula> of dReLU RBM for all data sequences <inline-formula><mml:math id="inf450"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></list-item><list-item><p>Normalize (z-score) each dimension: <inline-formula><mml:math id="inf451"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>h</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msqrt><mml:mtext>Var</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></list-item><list-item><p>Define:<disp-formula id="equ20"><label>(19)</label><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:mo>⁡</mml:mo><mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>h</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p></list-item></list><fig id="app1fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.025</object-id><label>Appendix 1—figure 5.</label><caption><title>Comparison of Gaussian and dReLU RBM with <inline-formula><mml:math id="inf452"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> trained on the Kunitz domain MSA.</title><p>Scatter plot of likelihoods for each model, where each point represents a sequence of the MSA. The color code is defined in <xref ref-type="disp-formula" rid="equ20">Equation 19</xref>; hot colors indicate ’outlier’ sequences.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig5-v2.tif"/></fig><p>For instance, a sequence <inline-formula><mml:math id="inf453"><mml:msup><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> with <inline-formula><mml:math id="inf454"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> has at least one hidden-unit average activity that is 10 standard deviations away from the mean. Clearly, most sequences have very similar likelihood but the outlier sequences are better modeled by dReLU potentials.</p><p>The features that are extracted are fairly robust with respect to the choice of potential when regularization is used. Clearly, the nature of the potentials does not matter for finding contacts features because for any potential, a hidden unit connected to only two sites will create only pairwise effective interaction. For larger collective modes, some difference arise. As discussed above, Bernoulli features are more redundant, and Gaussian RBM tend to miss outlier features.</p></sec><sec id="s14"><title>Summary</title><p>To summarize, the systematic study suggests that:</p><list list-type="bullet"><list-item><p>More general potentials, such as dReLU, perform better than the simpler quadratic and Bernoulli potentials.</p></list-item><list-item><p>There exist values of sparsity regularization penalties that allow for both good generative performance and interpretability.</p></list-item><list-item><p>As the number of hidden units increases, more features are captured and generative performance improves. Beyond some point, increasing <italic>M</italic> simply adds duplicate hidden units and does not enhance performance.</p></list-item></list></sec><sec id="s15"><title>Sequence generation</title><p>We use Lattice Proteins to check that our RBM is a good generative model, that is able to generate sequences that have both high fitness and high diversity (far away from one another and from the sequences provided in the training data set), as was done for Boltzmann Machines <xref ref-type="bibr" rid="bib34">Jacquin et al., 2016</xref>). Various RBM are trained, sequences are generated for each RBM and scored using the ground truth <inline-formula><mml:math id="inf455"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (see <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref>). We find that: (i) RBMs with low likelihood (Bernoulli and/or small <italic>M</italic>) generate low-quality sequences; (ii) unregularized BMs and RBMs, which tend to overfit, generate sequences with higher fitness but low diversity; and (iii) the true fitness function is predicted well by the inferred log probability. Moreover, conditional sampling also generates high-quality sequences, even when conditioning on unseen combination of features.</p><fig id="app1fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.026</object-id><label>Appendix 1—figure 6.</label><caption><title>Quantitative quality assessment of sequences generated by RBM trained on the Lattice Protein MSA.</title><p>(<bold>a</bold>) Distributions of the probability <inline-formula><mml:math id="inf456"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of folding into the native structure <inline-formula><mml:math id="inf457"><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ15">Equation (14)</xref> in 'Materials and methods'), for sequences generated by various models. The horizontal bars locate the average values of <inline-formula><mml:math id="inf458"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mrow><mml:mtext>n</mml:mtext><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Models with higher capacity (more parameters, less regularization) generate sequences with higher quality but lower diversity. (<bold>b</bold>) Distribution of distances from a randomly selected wildtype. The unregularized BM samples have lower diversity, whereas the regularized RBM samples better reproduce the data distribution. (<bold>c</bold>) Log-probability of dReLU RBM <inline-formula><mml:math id="inf459"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> shown in the main text (<xref ref-type="fig" rid="fig7">Figure 7</xref>) vs true fitness evaluated on sequences from the MSA used (train) or not (test) for training.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig6-v2.tif"/></fig><p>For RBMs trained on real proteins sequences, no ground-truth fitness is available and sequence quality cannot be assessed numerically. <xref ref-type="fig" rid="app1fig7">Appendix 1—figure 7</xref> shows nonetheless that the generated sequences, including those with recombined features that do not appear in nature, are consistent with a pairwise model trained on the same data.</p><fig id="app1fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.027</object-id><label>Appendix 1—figure 7.</label><caption><title>Quality assessment of sequences generated by RBM trained on (<bold>a</bold>) the Kunitz domain MSA and (<bold>b</bold>) the WW domain MSA.</title><p>Scatter plot of the number of mutations to the closest natural sequence vs log-probability of a BM trained on the same data, for natural (gray) and RBM-generated (colored) WW domain sequences. The color code is that same as that used in <xref ref-type="fig" rid="fig5">Figure 5A</xref>. Note similar likelihoods values for RBM-generated sequences and natural ones, including the unseen <inline-formula><mml:math id="inf460"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>4</mml:mn><mml:mo>-</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>5</mml:mn><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> combinations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig7-v2.tif"/></fig><p>Finally, in <xref ref-type="fig" rid="app1fig8">Appendix 1—figure 8</xref>, we show the role of regularization and sequence reweighting on sequence generation. Sequences drawn from the unregularized model are closer to those of the training data, and the corresponding sequence distribution has significantly lower entropy <inline-formula><mml:math id="inf461"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (i.e. the average negative log-probability of the generated sequences). There are respectively about <inline-formula><mml:math id="inf462"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mi>S</mml:mi></mml:msup><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>12</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf463"><mml:msup><mml:mn>10</mml:mn><mml:mn>18</mml:mn></mml:msup></mml:math></inline-formula> distinct sequences for the unregularized and regularized models, respectively. We find that sequence reweighting plays a similar role as regularization: with reweighting, sequences are slightly further away from the training set and the model has higher entropy.</p><fig id="app1fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.028</object-id><label>Appendix 1—figure 8.</label><caption><title>Evaluating the role of regularization and sequence reweighting on generated sequence diversity for the WW domain.</title><p>The y-axis indicates the log-likelihood of the data generated by the model; entropy is the negative average log-likelihood.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig8-v2.tif"/></fig></sec><sec id="s16"><title>Contact predictions</title><p>Since RBMs learn a full energy landscape, they can predict epistatic interactions (see 'Materials and methods'), and therefore contacts, as shown in <xref ref-type="fig" rid="fig6">Figure 6</xref>. The effective couplings derived with RBM are consistent with those inferred from a pairwise model (see <xref ref-type="fig" rid="app1fig9">Appendix 1—figure 9</xref>). Predictions for distant contacts in the Kunitz domain are shown in <xref ref-type="fig" rid="app1fig10">Appendix 1—figure 10</xref>, and are slightly worse than with DCA.</p><fig id="app1fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.029</object-id><label>Appendix 1—figure 9.</label><caption><title>Pairwise couplings learned from Kunitz domain MSA.</title><p>Scatter plot of inferred pairwise direct couplings learned by BM vs effective pairwise couplings computed from the RBM through <xref ref-type="disp-formula" rid="equ16">Equation (15)</xref> in the 'Materials and methods'.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig9-v2.tif"/></fig><fig id="app1fig10" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.030</object-id><label>Appendix 1—figure 10.</label><caption><title>Contact map and contact predictions for the Kunitz domain.</title><p>(<bold>a</bold>) Lower diagonal: the 551 pairs of residues at <inline-formula><mml:math id="inf464"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0.8</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> nm in the structure. Upper diagonal: top 551 contacts predicted by dReLU RBM with <inline-formula><mml:math id="inf465"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. (<bold>b</bold>) Positive Predicted Value vs rank for distant contacts <inline-formula><mml:math id="inf466"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>4</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for RBM (<inline-formula><mml:math id="inf467"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) and pairwise models. Distant contacts are well predicted, including those involved in the secondary structure.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig10-v2.tif"/></fig><p>We briefly discuss the best set of parameters for contact prediction. As seen from <xref ref-type="fig" rid="app1fig11">Appendix 1—figure 11</xref>, all RBMs can predict contacts maps on Lattice Proteins more or less accurately. As for the likelihood and generative performance, increasing the number of hidden units significantly improves contact prediction. The best hidden unit potentials for predicting contacts are dReLU and quadratic.</p><fig id="app1fig11" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.031</object-id><label>Appendix 1—figure 11.</label><caption><title>Contact predictions for Lattice Proteins, with (<bold>a</bold>) Bernoulli (<bold>b</bold>) Gaussian (<bold>c</bold>) dReLU RBM and (<bold>d</bold>) BM potentials.</title><p>Models with quadratic or dReLU potentials and large number of hidden units are typically similar in performance to pairwise models, trained either with Monte Carlo or Pseudo-likelihood Maximization.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig11-v2.tif"/></fig><fig id="app1fig12" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.032</object-id><label>Appendix 1—figure 12.</label><caption><title>Contact predictions as a function of RBM parameters for (<bold>a</bold>) Kunitz and (<bold>b</bold>) WW domains.</title><p>Both panels show the area under curve metric (integrated up to the true number of contacts) for various trainings, with different training parameters, regularization choice and hidden units number/potentials, against the weight sparsity. In both cases, large sparse regularization and a high number of hidden units reproduce the performance of the pairwise models.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig12-v2.tif"/></fig><p>We also studied how constraints on the sparsity of weights, tuned by the regularization penalty <inline-formula><mml:math id="inf468"><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>, influenced the performance. Because weights are never exactly zero, proxies are required for an appropriate definition of sparsity. In order to avoid arbitrary thresholds, we use Participation Ratios. The Participation Ratio <inline-formula><mml:math id="inf469"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of a vector <inline-formula><mml:math id="inf470"><mml:mrow><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is<disp-formula id="equ21"><label>(20)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mfrac><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo mathvariant="bold" stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo mathvariant="bold" stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo mathvariant="bold" stretchy="false">)</mml:mo><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo mathvariant="bold" stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo mathvariant="bold" stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn mathvariant="bold">2</mml:mn><mml:mi mathvariant="bold">e</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>If <inline-formula><mml:math id="inf471"><mml:mi mathvariant="bold">𝐱</mml:mi></mml:math></inline-formula> has <italic>K</italic> nonzero and equal (in modulus) components, PR is equal to <italic>K</italic> for any <italic>e</italic>. In practice, we use the values <italic>e</italic> = 2 and 3: the higher <italic>e</italic> is, the more small components are discounted against strong components in <inline-formula><mml:math id="inf472"><mml:mi mathvariant="bold">𝐱</mml:mi></mml:math></inline-formula>. Also note that it is invariant under rescaling of <inline-formula><mml:math id="inf473"><mml:mi mathvariant="bold">𝐱</mml:mi></mml:math></inline-formula>. We then define the weight sparsity <inline-formula><mml:math id="inf474"><mml:msub><mml:mi>p</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> of a hidden unit, through<disp-formula id="equ22"><label>(21)</label><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo mathvariant="bold" stretchy="false">)</mml:mo><mml:mspace width="1em"/><mml:mtext mathvariant="bold">with</mml:mtext><mml:mspace width="1em"/><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo mathvariant="bold" stretchy="false">)</mml:mo><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:msqrt><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi mathvariant="bold">w</mml:mi><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:msup><mml:mo mathvariant="bold" stretchy="false">)</mml:mo><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mspace linebreak="newline"/></mml:mrow></mml:mstyle></mml:math></disp-formula>and average it over <inline-formula><mml:math id="inf475"><mml:mi>μ</mml:mi></mml:math></inline-formula> to get a unique estimator of weight sparsity across the RBM. The results are reported in <xref ref-type="fig" rid="app1fig12">Appendix 1—figure 12</xref>, and show that performance strongly worsens when sparsity increases, both in Lattice Proteins and in real families.</p></sec><sec id="s17"><title>Feature robustness</title><p>To assess feature robustness, we repeat the training on WW using only one of the two halves of the sequences data, and look for the closest features to those shown in the main text. The closest features, shown below, are quite similar to the original ones.</p></sec><sec id="s18"><title>Comparison with the Hopfield-Potts model</title><p>The Hopfield-Potts model is a special case of RBM with: (i) quadratic potentials for hidden units, ii) no regularization but orthogonality constraints on the weights, and (iii) mean-field inference rather than PCD Monte Carlo learning. The consequences are that: (i) we cannot model high-order interactions, (ii) we do not observe a compositional regime in which the weights are sparse and typical configurations are obtained by combinations of these weights, instead, the representation is entangled and the weights attached to high eigenvalues are extended over most sites of the protein; and (iii) the model is not generative, that is, it does not reproduce the data moments and cannot generate a diverse set of sequences. To illustrate this fact, we show:</p><list list-type="bullet"><list-item><p>Examples of weights inferred from the the Kunitz and WW domains, and for Lattice Proteins (weights corresponding to Hsp70 can be found in a 'Supporting information' file). Low-eigenvalue weights are sparse, as reported in <xref ref-type="bibr" rid="bib14">Cocco et al. (2013)</xref>, but high eigenvalue weights that encode collective modes are extended, and therefore hard to interpret and to relate to function.</p></list-item><list-item><p>Contact predictions with Hopfield-Potts, showing worse performance than RBM or plmDCA.</p></list-item><list-item><p>Benchmarking of generated sequences with Hopfield-Potts on Lattice Proteins (similar to <xref ref-type="fig" rid="fig7">Figure 7F</xref>). Using a small pseudo-count, sequences are very poor (have a very low folding probability). Using a larger pseudo-count, sequences have reasonable fitness <inline-formula><mml:math id="inf476"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>nat</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, although lower than those for high-<inline-formula><mml:math id="inf477"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> RBM, but quite low diversity. This phenomenon is characteristic of sequences generated with mean-field models (see figure 3A in <xref ref-type="bibr" rid="bib34">Jacquin et al. (2016)</xref>. We also note that the Lattice Protein benchmark is actually optimistic for the Hopfield-Potts model, as the pseudo-count trick does not work as well whenever a sequence has many conserved sites.</p></list-item></list><fig id="app1fig13" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.033</object-id><label>Appendix 1—figure 13.</label><caption><title>Features inferred using the first and second half of the sequences.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig13-v2.tif"/></fig><fig id="app1fig14" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.034</object-id><label>Appendix 1—figure 14.</label><caption><title>Top 12 patterns with highest contributions to the log-probability, see eqn (23) in <xref ref-type="bibr" rid="bib14">Cocco et al. (2013)</xref>, inferred by the Hopfield-Potts model on the Kunitz domain.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig14-v2.tif"/></fig><fig id="app1fig15" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.035</object-id><label>Appendix 1—figure 15.</label><caption><title>Top 12 patterns with the highest contributions to the log-probability (see equation (23) in <xref ref-type="bibr" rid="bib14">Cocco et al. (2013)</xref>), inferred by the Hopfield-Potts model on the WW domain.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig15-v2.tif"/></fig><fig id="app1fig16" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.036</object-id><label>Appendix 1—figure 16.</label><caption><title>Top 12 patterns with the highest contributions to the log-probability (see equation (23) in <xref ref-type="bibr" rid="bib14">Cocco et al. (2013)</xref>, inferred by the Hopfield-Potts model on the Lattice Proteins data.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig16-v2.tif"/></fig><fig id="app1fig17" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.037</object-id><label>Appendix 1—figure 17.</label><caption><title>Hopfield-Potts model for sequence generation.</title><p>(<bold>A</bold>) Fitness <inline-formula><mml:math id="inf478"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>nat</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> against distance to closest sequence for the Hopfield-Potts model with pseudo-count 0.01 or 0.5, sampled with or without the high <inline-formula><mml:math id="inf479"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> bias. Gray ellipses denote the corresponding values for the RBM. (<bold>B</bold>) Distribution of distances between generated sequences.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig17-v2.tif"/></fig><fig id="app1fig18" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.038</object-id><label>Appendix 1—figure 18.</label><caption><title>Contact prediction for 17 protein families including the Hopfield-Potts model. </title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig18-v2.tif"/></fig></sec><sec id="s19"><title>Additional figure: hidden-input distribution for the Kunitz domain, separated by phylogenetic identity and genes</title><fig id="app1fig19" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.039</object-id><label>Appendix 1—figure 19.</label><caption><title>Phylogenetic identity of feature-activating Kunitz sequences with the RBM shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>.</title><p>(<bold>A</bold>) Scatter plot of inputs of hidden units 2 and 3; color depicts the organisms' position in the phylogenic tree of species. Most of the sequences that lack the disulfide bridge are nematodes. (<bold>B</bold>) Sequence logo of the 137 sequences above the dashed line (<inline-formula><mml:math id="inf480"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>3</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), showing the electrostatic triangle that putatively replaces the disulfide bridge.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig19-v2.tif"/></fig><fig id="app1fig20" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.040</object-id><label>Appendix 1—figure 20.</label><caption><title>Distribution of inputs for the five features shown in main text plus hidden unit 34.</title><p>Distributions of inputs for Kunitz domains belonging to specific genes are shown.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig20-v2.tif"/></fig></sec><sec id="s20"><title>Additional figure: weight logos, 3D visualizations, input distributions of 10 hidden units for Hsp70</title><p>Hidden unit numbering: 1 = short vs long loop; 2 = function feature on SBD; 3 = LID/SBD interdomain; 4 = NBD/SBD interdomain and non-allosteric specific; 5 = unstructured tail; 6 = short/long vs very short loop; 7 = long loop variant; 8 = ER specific; 9 = second non-allosteric specific; 10 = dimer contacts.</p><fig id="app1fig21" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.041</object-id><label>Appendix 1—figure 21.</label><caption><title>Truncated weight logo of 10 selected HSP70 hidden units (1/2).</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig21-v2.tif"/></fig><fig id="app1fig22" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.042</object-id><label>Appendix 1—figure 22.</label><caption><title>Truncated weight logo of 10 selected HSP70 hidden units (2/2).</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig22-v2.tif"/></fig><fig id="app1fig23" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.043</object-id><label>Appendix 1—figure 23.</label><caption><title>Corresponding structures (1/3).</title><p>Left: ADP-bound conformation (PDB: 2kho). Right: ATP-bound conformation (PDB: 4jne). For the last hidden unit, we show the structure of the dimer Hsp70–Hsp70 in ATP conformation (PDB: 4JNE), highlighting dimeric contacts.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig23-v2.tif"/></fig><fig id="app1fig24" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.044</object-id><label>Appendix 1—figure 24.</label><caption><title>Corresponding structures (2/3).</title><p>Left: ADP-bound conformation (PDB: 2kho). Right: ATP-bound conformation (PDB: 4jne). For the last hidden unit, we show the structure of the dimer Hsp70–Hsp70 in ATP conformation (PDB: 4JNE), highlighting dimeric contacts.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig24-v2.tif"/></fig><fig id="app1fig25" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.045</object-id><label>Appendix 1—figure 25.</label><caption><title>Corresponding structures (3/3).</title><p>Left: ADP-bound conformation (PDB: 2kho). Right: ATP-bound conformation (PDB: 4jne). For the last hidden unit, we show the structure of the dimer Hsp70–Hsp70 in ATP conformation (PDB: 4JNE), highlighting dimeric contacts.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig25-v2.tif"/></fig><fig id="app1fig26" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.046</object-id><label>Appendix 1—figure 26.</label><caption><title>Corresponding input distributions.</title><p>Note that both hidden unit 4 and 9 discriminate the non-allosteric subfamily from the rest; and that hidden unit 8 discriminates eukaryotic Hsp expressed in the endoplasmic reticulum from the rest.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig26-v2.tif"/></fig><fig id="app1fig27" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.047</object-id><label>Appendix 1—figure 27.</label><caption><title>Some scatter plots of inputs for the 10 hidden units shown.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig27-v2.tif"/></fig><fig id="app1fig28" position="float"><object-id pub-id-type="doi">10.7554/eLife.39397.048</object-id><label>Appendix 1—figure 28.</label><caption><title>Statistics of the length and amino-acid content of the unstructured tail of Hsp70.</title><p>Hidden unit 5 defines a set of sites, mostly located on the unstructured tail of Hsp70; its sequence logo and input distribution suggests that for a given sequence, the tail can be enriched either in tiny (A, G)or hydrophilic amino-acids (E,D,K,R,T,S,N,Q). This is qualitatively confirmed by the non-gaussian statistics of the distributions of the fractions of tiny and hydrophilic amino-acids in the tail (blue histograms and top left contour plots). This effect could, however, be due to the variable length of the loop (bottom histogram). To assess this enrichment, we built a null model where the tail size was random (same statistics as Hsp70), and each amino-acid was drawn randomly, independently from the others, using the same amino-acid frequency as that in the tail of Hsp70. The null model statistics (orange histograms and lower left contour plots) are clearly different, validating the collective mode.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-39397-app1-fig28-v2.tif"/></fig></sec></boxed-text></sec></app></app-group></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.39397.090</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Colwell</surname><given-names>Lucy J</given-names></name><role>Reviewing Editor</role><aff><institution>Cambridge University</institution><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Learning protein constitutive motifs from sequence data&quot; for consideration at <italic>eLife</italic>. Your article has been favorably evaluated by three reviewers, one of whom served as a guest Reviewing Editor, and the evaluation has been overseen by Aviv Regev as the Senior Editor.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>1) There is a difference of opinion among the reviewers about whether your methodology needs to be compared with other protein structures, and in particular examples that are not so well known and annotated. However the consensus opinion is that the manuscript would benefit from additional comparisons. Reviewer 3 explicitly calls out the possibility that there is overfitting involved, and it is hard to dismiss this out of hand without more effort to compare to the types of examples that they mention. Reviewer 3 makes reasonable suggestions of other examples you might compare to – and I look forward to seeing how these work in the revised manuscript.</p><p>2) All of the reviewers have major comments for clarifications and addressing these will improve the manuscript. For example, reviewer 1 asks you to comment on the weights (how they are chosen, how they depend on model hyperparameters, etc.); Reviewer 2 points out that the methodology is not fully developed in this manuscript, but instead will be described elsewhere. The consensus view of the reviewers is that it is important for the methods to be fully described in this paper so that the results are reproducible by others, and a promise of publishing these elsewhere is insufficient.</p><p>3) There are other explicit comments included in these reviews about ways of clarifying the manuscript that I trust you will address in a revised version.</p><p><italic>Reviewer #1:</italic> </p><p>In this manuscript Tubiana et al. show that Restricted Boltzman Machines are able to learn models of protein families from sequence data. The authors observe two contrasting approaches to building models from protein family sequence data that have been shown in the literature to either (i) identify functionally important groups of sequence positions, or ii) provide information about sequence positions that are close in 3D protein structure. Approach (i) often involves applying PCA type approaches to large sets of protein sequences, and examining the weights assigned to different sequence positions on those principal components with largest eigenvalues, while versions of approach (ii) such as DCA have been motivated by maximum-entropy based modelling.</p><p>The authors note that a unique framework that can extract both structurally and functionally important features of a protein family is still missing, and propose Restricted Boltzmann Machines as a solution. In the manuscript, they report a method to efficiently learn RBM from sequence data, and describe applications to three diverse protein families, in addition to data generated using a lattice-protein model. Much of the manuscript is devoted to describing the sets of sequence positions that are structurally and/or functionally important in these protein families, and that can be identified by examining the weight coefficients of the RBM.</p><p>Within the main text, the authors cite their previous publication, from 2013, in which they propose the Hopfield-Potts model as a means of naturally interpolating between PCA-based approaches to identifying functionally important groups of residues, and DCA-type approaches. There they also observed sparse modes (or patterns) that correspond to contacts in 3D structure, and in addition less sparse modes that correspond to features such as conserved sequence positions that form spatially connected and functionally important regions in the folded protein that are reminiscent of protein sectors, or positions at which many gap symbols are found in the alignments.</p><p>This makes me question whether there is really no framework that can extract both structurally and functionally important features of a protein family. I think the authors should be careful to accurately place this manuscript in the context of prior work. Moreover, there appear to be some similarities between the energy function of an RBM, and that of a Hopfield model – this would be an interesting point for the authors to discuss. It would be interesting to understand from the main text why the authors feel that the modeling assumptions of the RBM are applicable to protein sequence data.</p><p>My major comment is that the new manuscript focuses on a rather detailed description of how a small number of RBM weights correspond to structurally and functionally important sequence positions. Almost no time at all in the main text describing how they were able to efficiently learn RBM from sequence data, which seems to be the novel contribution of this work. The authors also do not provide any comparison between the weights of RBM and patterns learned from sequence data in prior work, such as their own 2013 paper. Specifically, did the patterns derived from the Hopfield-Potts model differ significantly from those found in the RBM weights? A thorough comparison to prior work is necessary to distinguish the advances made in this work.</p><p>Beyond this, I would ask the authors to at least comment on how the diverse weights are chosen, and what happens to the weights as the number of hidden units in the model is varied. Moreover, it would be interesting to understand how the weights change as the number, and diversity of sequences in the protein family alignment is varied. In addition, the authors pay only passing attention to the fact that the protein sequences contained in the alignment are chosen uniformly at random from some underlying distribution, but rather are biased by their shared evolutionary history. The authors should provide some insight into how this affects the ability of the model to generalize.</p><p><italic>Reviewer #2:</italic> </p><p>This manuscript introduces restricted Boltzmann machines (RBMs) for protein sequence analysis. There has been a recent revolution in inferring 3D protein structure by statistical analysis of pairwise residue covariations in deep protein sequence alignments, mostly using a class of models called Potts models; these authors have helped pioneer that work. Here the authors show that RBMs can efficiently capture effective pairwise couplings (as Potts models do), while also capturing even higher-order correlation patterns that arise as a result of phylogenetic and functional constraint. The math is well-principled and presented clearly and concisely. The paper shows a well-chosen set of illustrative biological examples that connect this work to the body of related previous work with Potts models and other methods.</p><p>This is a mathematical manuscript that introduces a compelling new analysis approach, but there isn't (yet) a new biological result. Maybe it won't have immediate impact on a wide <italic>eLife</italic> audience of biologists, although biologists should be able to get the gist. I expect there might be a discussion amongst reviewers and editors of whether it needs to be buttressed with more explicit biological relevance and biological results. My view is no. I believe this manuscript will be important and influential as it stands. I would compare it to the 1994 Anders Krogh and David Haussler JMB paper that introduced profile hidden Markov models, or the 2009 Martin Weight and Terry Hwa paper that introduced Potts models. These papers ignited new areas of computational biology research that later led to important biological results. The Krogh paper was weakened and diluted in its review process by JMB reviewers and editors asking for more biology. Many of us in the field worked from a pre-dilution preprint more than the final published JMB version. I would advise not similarly diluting this strong manuscript. <italic>eLife</italic> should publish mathematical/technical papers occasionally, when the math is well-principled and clear, and where there's a good chance of founding a new important direction in biological data analysis. This manuscript is a nice example.</p><p>- At the beginning of Results, it would help to see even more intuitive rationale for the strengths of RBMs over Potts models, before diving in. For example, Materials and methods has an important line 'RBM&lt;s&gt; offer a practical way to go beyond pairwise models without an explosion in the number of interaction parameters'. Move this line up and clarify. I got a fair way into the paper thinking that RBMs would have to give up detailed pairwise correlation structure, in return for capturing phylogenetic and functional many-residue correlation structure.</p><p>- One weakness of the paper is that it does not fully describe the method. In particular, I don't know how to calculate the partition function from reading this paper; I would have to refer to other cited work (Tieleman, 2009; Fischer and Igel, 2012), which might be fair enough. However, Materials and methods says that 'practical details… including several improvements to the standard Persistent Contrastive Divergence algorithm… will be presented elsewhere'. If those details are essential for the results, they need to be in the paper somewhere.</p><p>- '(precise Github address here)': I assume that's an oversight, and that code will be provided. Indeed that would go a long way towards addressing the above weakness, as far as I'm concerned.</p><p><italic>Reviewer #3:</italic> </p><p>This manuscript describes a novel generative machine learning model called RBM (Restricted Boltzmann Machines) for multiple protein sequence alignment (MSA). Through RBM, a protein sequence can be generated from some hidden nodes trained from the MSA. A unique feature of this RBM model is that each hidden node may represent a small set of residues which may not be adjacent to one another along the primary sequence, but may form contacts or a functional motif. This is very different from the widely-used Potts model, in which mainly pairwise residue correlation is considered. The authors have shown that their RBM model can be used to detect motifs and inter-residue contact prediction.</p><p>A major concern is that the authors tested their RBM model on only 4 natural proteins with solved structures and good functional annotations. By testing on very few proteins with solved structures, it is hard to convince the readers that the authors did not overfit their model. There are a few ways to address this issue:</p><p>1) Apply the model to analyze proteins without solved structures and then verify their results after the solved structures are available. For example, the authors may test their methods through the online benchmark CAMEO for protein contact prediction. Each week CAMEO will send out some test sequences for prediction. The native structures of these test proteins are not publicly available during the test, but will be public after 4-5 days.</p><p>2) The authors may also test their method on a large set of proteinswith solved structures for contact prediction, but using a simple way to choose M (the number of hidden nodes) and the regularization factor for all the test proteins. The authors may compare their result with currently popular contact prediction methods such as Evfold and CCMpred. It will also be interesting to study the relationship between accuracy and the number of effective sequences in MSA.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.39397.091</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>1) There is a difference of opinion among the reviewers about whether your methodology needs to be compared with other protein structures, and in particular examples that are not so well known and annotated. However the consensus opinion is that the manuscript would benefit from additional comparisons. Reviewer 3 explicitly calls out the possibility that there is overfitting involved, and it is hard to dismiss this out of hand without more effort to compare to the types of examples that they mention. Reviewer 3 makes reasonable suggestions of other examples you might compare to – and I look forward to seeing how these work in the revised manuscript.</p></disp-quote><p>To answer the concerns about overfitting, we have followed the suggestion of reviewer 3, and have further tested our modeling approach on 16 more families, used as a benchmark for contact predictions by plmDCA (an important inference method in the context of Direct-Coupling Analysis – DCA) in the standard 2014 paper by Ekeberg et al. This new analysis allows us to:</p><p>a) Carry out a statistical study of the performance of RBM with respect to DCA for contact prediction. The new panel in Figure 6 shows that the performances of RBM under fixed regularization and with a number of hidden units proportional to the maximal rank (M=0.3 R) are comparable with the ones obtained by plmDCA.</p><p>b) Compare the most significant weights (with largest norms) across the 16 families, and extract broad classes of structural and functional motifs repeated in many families, including the proteins we had presented in the first version of the manuscript. A new figure (Figure 9) has been added to report these results, accompanied by a discussion in the section “Cross- validation of the model and interpretability of the representations”.</p><p>We believe that these new results provide convincing evidence that our approach is not limited to a few “good” proteins or protein domains, but can be applied to any protein (with performances depending, of course, on the number of available sequences).</p><disp-quote content-type="editor-comment"><p>2) All of the reviewers have major comments for clarifications and addressing these will improve the manuscript. For example, reviewer 1 asks you to comment on the weights (how they are chosen, how they depend on model hyperparameters, etc.); Reviewer 2 points out that the methodology is not fully developed in this manuscript, but instead will be described elsewhere. The consensus view of the reviewers is that it is important for the methods to be fully described in this paper so that the results are reproducible by others, and a promise of publishing these elsewhere is insufficient.</p></disp-quote><p>We have added a detailed description of the main steps of the training algorithm in the Materials and methods section, as requested by reviewer 2. In particular, in the subsection &quot;Learning Procedure&quot;, we now give the general structure of the equations for the gradient of the log-probability, the tricks used for moment evaluations, and the procedure followed to estimate the partition function. We also better present the main algorithmic innovations of the present paper, that is, the extension of RBM to multi-categorical Potts-like variables, and the introduction of general non-quadratic hidden-unit potentials, interpolating between quadratic, double-well (Bernoulli) and Rectified Linear Unit potentials (with hard-wall constraints). Readers should have no problem in understanding our code for training RBM, which is made available here, together with the scripts necessary to reproduce the figures in our manuscript. In addition, we have expanded the paragraph entitled “Learning” in the main text (section “Restricted Boltzmann Machines”); this paragraph lists the main ingredients of our training procedure, and is intended for readers not interested in the technical details presented in the Materials and methods section.</p><p>We have also added a discussion on the comparison of RBM with the Hopfield- Potts approach, another procedure for extracting simultaneously structural and functional information from sequence data proposed by two of us and collaborators in 2013, as required by reviewer 1. We have better developed the discussion on how the hyperparameters of the RBM should be chosen to learn efficiently interpretable features. Following reviewer 1’s request, we now explain how weights are selected, and study the stability of the extracted features under undersampling.</p><disp-quote content-type="editor-comment"><p>3) There are other explicit comments included in these reviews about ways of clarifying the manuscript that I trust you will address in a revised version.</p></disp-quote><p>Reviewer #1:</p><disp-quote content-type="editor-comment"><p>[…] Within the main text, the authors cite their previous publication, from 2013, in which they propose the Hopfield-Potts model as a means of naturally interpolating between PCA-based approaches to identifying functionally important groups of residues, and DCA-type approaches. There they also observed sparse modes (or patterns) that correspond to contacts in 3D structure, and in addition less sparse modes that correspond to features such as conserved sequence positions that form spatially connected and functionally important regions in the folded protein that are reminiscent of protein sectors, or positions at which many gap symbols are found in the alignments.</p><p>This makes me question whether there is really no framework that can extract both structurally and functionally important features of a protein family. I think the authors should be careful to accurately place this manuscript in the context of prior work. Moreover, there appear to be some similarities between the energy function of an RBM, and that of a Hopfield model – this would be an interesting point for the authors to discuss.</p></disp-quote><p>We fully agree that the Hopfield-Potts model (Cocco, Monasson and Weigt, 2013) was an attempt to extract simultaneously structural and functional information from sequence data, and, in this regard, is conceptually similar to RBM (with the notable exception that the idea of representation was essentially lacking). Actually, the connection between RBM and Hopfield-Potts model is quite deep, as the latter is a particular case of the former, obtained when the hidden-unit potentials are quadratic functions of their arguments h. This connection, which is clearly emphasized in the new manuscript (see section “Restricted Boltzmann Machines”, in between Equations 5 and 6) was, indeed, a major incentive for us to start studying RBM. Some of the results found with RBM, such as very localized modes on two sites coding for contacts or extended modes due to stretches of gaps at the sequence extremities, were already found with Hopfield-Potts models. But, despite those similarities, the work on the Hopfield- Potts approach cited above suffered from several drawbacks (which we feel free to list, being among the authors of this work…):</p><p>1) the patterns (here, the weights) w were inferred within the mean-field hypothesis, known to be fast but inaccurate. In particular, 2-point statistics are not reproduced. As a consequence, the inferred Hopfield-Potts model cannot be used to generate new sequences in practice; it is simply too poor an approximation of the underlying sequence distribution.</p><p>2) the quadratic nature of the interactions made the patterns not uniquely defined, as they could be rotated in the mu-space with no change on the probability distribution of the sequences. To avoid this problem, we artificially imposed orthogonality between the weight vectors. There was (and there is) no justification for this procedure. The same problem arises in Independent Component Analysis: it is well known that identification of independent components cannot be done based on quadratic moments only, and requires knowledge of higher-order moments (captured in RBM by non-quadratic potentials).</p><p>3) the importance of sparsity was not recognized. While some inferred patterns were sparse in practice (such as the ones corresponding to contacts), most were not (see middle panel in Figure 2 of the above-mentioned paper) and could not be interpreted.</p><p>We have added in Appendix 1 several figures (for Kunitz, WW, and LP; results for HSP70 are given in a separate file in Appenndix 1) to illustrate these points, and showing in particular:</p><p>1) Some of the patterns inferred for the protein families presented in the main text. Low-eigenvalue patterns are sparse (as reported in the 2013 PLoS Comp Bio paper), but high-eigenvalue patterns coding for collective modes are extended, and therefore hard to relate to function.</p><p>ii) Contact predictions with the Hopfield-Potts model, showing worse performances than RBM (for the same number of hidden units).</p><p>iii) Benchmarking of generated sequences with Hopfield Potts on Lattice Proteins, similar to what is shown in Figure 7F for RBM. With a small pseudo-count, sequences generated by the Hopfield-Potts model are very bad. Using a larger pseudo-count, sequences have decent folding probabilities, but very low diversity (in agreement with findings by Jacquin et al., 2016).</p><p>Our current work on RBM does not suffer from any of these problems, and we are convinced that RBM are much more accurate and controlled ways to infer sequence motifs than the Hopfield-Potts approach. Yet, we agree with reviewer 1 that proper acknowledgements about previous works are required, and we have modified the Discussion accordingly.</p><disp-quote content-type="editor-comment"><p>It would be interesting to understand from the main text why the authors feel that the modeling assumptions of the RBM are applicable to protein sequence data.</p></disp-quote><p>RBM are natural candidates to interpolate between PCA-based and DCA-based approaches are they can be thought as either a method for extracting modes/representations (which goes beyond PCA) or an effective way to model complex (pairwise and higher-order) interactions between residues (which extends DCA). We have added a sentence in the section on RBM to explain this important point.</p><disp-quote content-type="editor-comment"><p>My major comment is that the new manuscript focuses on a rather detailed description of how a small number of RBM weights correspond to structurally and functionally important sequence positions. Almost no time at all in the main text describing how they were able to efficiently learn RBM from sequence data, which seems to be the novel contribution of this work.</p></disp-quote><p>As reviewer 1 emphasizes, we primarily aimed at convincing readers that RBM could learn structurally and functionally relevant motifs in protein sequences. This is made possible by:</p><p>1) the introduction of parametric class of non-quadratic potentials, called double Rectified Linear Unit potentials, which spans a large variety of behaviors, allowing hidden units to have smooth, bimodal, or constrained (e.g. positive- valued) conditional probabilities. We have added a formula (numbered 6) for dReLU potentials in the main text.</p><p>2) the introduction of the so-called L1/L2 sparsity regularization, which is an adaptive L1 penalty on the weights. This regularization is briefly described in the Results sections, and details are given in the Materials and methods section. We also discuss at length in the section &quot;Cross-validation of model and interpretability of representations&quot; how the choice of the regularization strength is crucial to obtain meaningful weights.</p><p>3) the selection of hyperparameters (in particular, the number of hidden units) and how they affect performance (for instance, for contact prediction) is also discussed in the main text and in Appendix.</p><disp-quote content-type="editor-comment"><p>The authors also do not provide any comparison between the weights of RBM and patterns learned from sequence data in prior work, such as their own 2013 paper. Specifically, did the patterns derived from the Hopfield-Potts model differ significantly from those found in the RBM weights? A thorough comparison to prior work is necessary to distinguish the advances made in this work.</p><p>Beyond this, I would ask the authors to at least comment on how the diverse weights are chosen?</p></disp-quote><p>The weights shown in Figures 2, 3, 4 were selected manually based on several criteria:</p><p>i) Weight norm, which is a proxy for the importance of the corresponding hidden unit. Hidden units with larger weight norms contribute more to the likelihood, whereas low-weight norms may arise from noise/overfitting.</p><p>ii) Weight sparsity. Hidden units with sparse weights are easier to interpret in terms of structural/functional constraints.</p><p>iii) Shape of input distribution. Hidden units with bimodal input distribution separate the family in two subfamilies and are therefore potentially interesting.</p><p>iv) Comparison with available literature, in particular mutagenesis experiments.</p><p>v) Diversity of features in the weights (many weights correspond to contacts, and we do show all of them).</p><p>We have made these criteria explicit in the manuscript.</p><p>The weights shown in Figure 9 (one for each one of the 16 families) were picked up arbitrarily among the top (having the largest norms) 10 weights of each family to illustrate the different broad classes of motifs. A large scale, statistical approach would be necessary to better define those classes, as underlined in Discussion.</p><disp-quote content-type="editor-comment"><p>And what happens to the weights as the number of hidden units in the model is varied.</p></disp-quote><p>At low number M of hidden units (and fixed large regularization), the weights are not sparse, which is similar to what is found with PCA or Hopfield-Potts. As M increases, weights get sparser, as more hidden units are available to code for the various statistical features of the data. Above a certain value of M, the weights stabilize, and extra hidden units are essentially copies of the previous ones. The results shown here correspond to after the compositional regime emergence, prior to the ‘copy’ regime.</p><disp-quote content-type="editor-comment"><p>Moreover, it would be interesting to understand how the weights change as the number, and diversity of sequences in the protein family alignment is varied.</p></disp-quote><p>To show how the weights change with sampling, we have trained again our RBM after random removal of 50% the sequences in the MSA of the WW domain. We compare in Appendix 1—figure 13 the inferred weights to the ones obtained with the full MSA and shown in Figure 3B. We find that the weights are quite robust despite the removal of half of the data. Not surprisingly, weights with small norms (and not selected according to criterion i) above) are more sensitive to sampling noise.</p><p>The question on diversity is related to the presence of evolutionary correlations between sequences; the less diverse the sequences are, the stronger should be the reweighting factor, see point below.</p><disp-quote content-type="editor-comment"><p>In addition, the authors pay only passing attention to the fact that the protein sequences contained in the alignment are chosen uniformly at random from some underlying distribution, but rather are biased by their shared evolutionary history. The authors should provide some insight into how this affects the ability of the model to generalize.</p></disp-quote><p>Reviewer 1 is right that the sequences sampled in databases are not independent. This problem is shared by all sequence analysis methods such as Hidden Markov Models or DCA. We treat this dependence here in a rough way: each sequence S is assigned a weight factor (subsequently used for computing averages over data) proportional to the inverse of the number of neighbor sequences S’ in the alignment; S’ and S are considered as neighbors if their Hamming distance is smaller than a cut- off, generally 20% of the sequence length. This flattening procedure is known to improve contact prediction with DCA.</p><p>For RBM, this flattening reduces overfitting as well. To see this, we have repeated the training on the WW domain sequence data without reweighting (or regularization). We have generated sequences and plotted their log-probabilities vs. their distances to closest sequences in the MSA (same as Figures 5E and F). Without regularization or reweighting, the generated sequences are closer to the set of natural sequences, and their log-probability is higher, meaning that they are less diverse. We have added a comment in the &quot;Cross-validation…&quot; section and the corresponding figure in the Appendix.</p><p>We stress that reweighting is not necessary for <italic>well</italic> sampled sequences, i.e. for rather uniformly distributed sequences. In particular, for Lattice Proteins where we have full control and can sample sequences by Monte Carlo at equilibrium, reweighting does not improve performance, e.g. for contact prediction. Conversely, when the sampling of sequences is biased around a given (wild type) sequence, reweighting is needed to get back to good performance levels, see Jacquin et al., 2016.</p><p>Reviewer #2:</p><disp-quote content-type="editor-comment"><p>[…] At the beginning of Results, it would help to see even more intuitive rationale for the strengths of RBMs over Potts models, before diving in. For example, Materials and methods has an important line 'RBM&lt;s&gt; offer a practical way to go beyond pairwise models without an explosion in the number of interaction parameters'. Move this line up and clarify. I got a fair way into the paper thinking that RBMs would have to give up detailed pairwise correlation structure, in return for capturing phylogenetic and functional many-residue correlation structure.</p></disp-quote><p>We agree that this sentence was unclear. As one key advantage of RBMs with respect to Potts models is that they can capture higher-order interactions, we have now expanded this notion in two places in the manuscript. First, we have expanded the section on the distribution of sequences in the section “Restricted Boltzmann Machines”; we now explain that RBMs reduce to pairwise interaction models when the hidden-unit potentials are quadratic, and offer a possibility to take into account higher-order interactions with non-quadratic potentials. We have introduced a new formula (numbered 6) to explicitly show the class of (dReLU) potentials considered in our work and fitted from the sequence data. Secondly, we come back on this notion in the Discussion and explain why RBM are efficient ways of introducing high-order interactions (whose number is a priori exponential in the sequence length N) from a limited number of parameters (the weights w).</p><disp-quote content-type="editor-comment"><p>- One weakness of the paper is that it does not fully describe the method. In particular, I don't know how to calculate the partition function from reading this paper; I would have to refer to other cited work (Tieleman, 2009; Fischer and Igel, 2012), which might be fair enough. However, Materials and methods says that 'practical details… including several improvements to the standard Persistent Contrastive Divergence algorithm… will be presented elsewhere'. If those details are essential for the results, they need to be in the paper somewhere.</p></disp-quote><p>We agree with reviewer 2 that the paper should be self-contained. We have therefore added a detailed description of the main steps of the training algorithm in the Materials and methods section. In particular, in the subsection &quot;Learning Procedure&quot;, we now give the general structure of the equations for the gradient of the log-probability, the tricks used for moment evaluations, and the procedure followed to estimate the partition function (with a paragraph explaining the principle of the Annealed Importance Sampling algorithm). We also better present the main algorithmic innovations of the present paper, that is, the extension of RBM to multi-categorical Potts-like variables, and the introduction of general non-quadratic hidden-unit potentials, interpolating between quadratic, double-well (Bernoulli) and Rectified Linear Unit potentials (with hard-wall constraints). Readers should have no problem in understanding our code for training RBM, which is made available here, together with the scripts necessary to reproduce the figures in our manuscript. In addition, we have expanded the paragraph entitled “Learning” in the main text (section “Restricted Boltzmann Machines”); this paragraph lists the main ingredients of our training procedure, and is intended for readers not interested in the technical details presented in the Methods section.</p><disp-quote content-type="editor-comment"><p>- '(precise Github address here)': I assume that's an oversight, and that code will be provided. Indeed that would go a long way towards addressing the above weakness, as far as I'm concerned.</p></disp-quote><p>Yes, all the codes (training algorithm and scripts for reproducing the figures of the paper) are provided.</p><p>Reviewer #3:</p><disp-quote content-type="editor-comment"><p>[…] A major concern is that the authors tested their RBM model on only 4 natural proteins with solved structures and good functional annotations. By testing on very few proteins with solved structures, it is hard to convince the readers that the authors did not overfit their model. There are a few ways to address this issue:</p><p>1) Apply the model to analyze proteins without solved structures and then verify their results after the solved structures are available. For example, the authors may test their methods through the online benchmark CAMEO for protein contact prediction. Each week CAMEO will send out some test sequences for prediction. The native structures of these test proteins are not publicly available during the test, but will be public after 4-5 days.</p><p>2) The authors may also test their method on a large set of proteinswith solved structures for contact prediction, but using a simple way to choose M (the number of hidden nodes) and the regularization factor for all the test proteins. The authors may compare their result with currently popular contact prediction methods such as Evfold and CCMpred. It will also be interesting to study the relationship between accuracy and the number of effective sequences in MSA.</p></disp-quote><p>We understand the concerns about overfitting expressed by reviewer 3. Following his/her second suggestion we have further analyzed 16 protein families that were used to benchmark plmDCA by Ekeberg et al. in their original paper (Ekeberg, Hartonen and Aurell, 2014), which is exactly the same method as Evfold and CCMpred: Evfold directly uses the plmDCA code, and CCMpred is a GPU implementation of plmDCA.</p><p>This new analysis allows us to:</p><p>1) Carry out a statistical study of the performance of RBM with respect to DCA for contact prediction. The new panel in Figure 6 shows that the performances of RBM under fixed regularization and with a number of hidden units proportional to the maximal rank (<italic>M=0.3 R</italic>) are comparable with the ones obtained by plmDCA.</p><p>2) Compare the most significant weights (with largest norms) across the 16 families, and extract broad classes of structural and functional motifs repeated in many families, including the proteins we had presented in the first version of the manuscript. A new figure (Figure 9) has been added to report these results, accompanied by a discussion in the section “Cross-validation of the model and interpretability of the representations”.</p><p>We believe that these new results provide convincing evidence that our approach is not limited to a few “good” proteins or protein domains, but can be applied to any protein (with performances depending of course on the number of available sequences).</p></body></sub-article></article>